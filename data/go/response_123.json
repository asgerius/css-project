[{"tags": ["string", "go", "comparison"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1495064891, "post_id": 44036426, "comment_id": 75099494, "body": "Convert them both to lower case, then compare."}, {"owner": {"reputation": 7745, "user_id": 3926995, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2l63X.jpg?s=128&g=1", "display_name": "Chiheb Nexus", "link": "https://stackoverflow.com/users/3926995/chiheb-nexus"}, "edited": false, "score": 0, "creation_date": 1495065435, "post_id": 44036426, "comment_id": 75099647, "body": "what&#39;s the meaning of asking a question then answering it in less than 6 min ?"}, {"owner": {"reputation": 3488, "user_id": 477035, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cYpss.jpg?s=128&g=1", "display_name": "RedGrittyBrick", "link": "https://stackoverflow.com/users/477035/redgrittybrick"}, "edited": false, "score": 0, "creation_date": 1495103230, "post_id": 44036426, "comment_id": 75115730, "body": "Must &quot;&#223;&quot; == &quot;SS&quot; also?"}, {"owner": {"reputation": 54248, "user_id": 95190, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/a58c0b44762885ca46ecee7f5b379f3d?s=128&d=identicon&r=PG", "display_name": "WiredPrairie", "link": "https://stackoverflow.com/users/95190/wiredprairie"}, "edited": false, "score": 0, "creation_date": 1495103691, "post_id": 44036426, "comment_id": 75116014, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24836044/case-insensitive-string-search-in-golang\">Case insensitive string search in golang</a>"}], "answers": [{"comments": [{"owner": {"reputation": 40805, "user_id": 30280, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/b40900d96489d4e8e042596efc912d47?s=128&d=identicon&r=PG", "display_name": "Bevan", "link": "https://stackoverflow.com/users/30280/bevan"}, "edited": false, "score": 1, "creation_date": 1588309101, "post_id": 44036482, "comment_id": 108853678, "body": "Converting strings to lowercase or uppercase only gives an approximately correct result - Unicode isn&#39;t this simple. Research the &quot;Turkish i&quot; problem for a starting point on diving down the rabbithole."}], "tags": [], "owner": {"reputation": 71, "user_id": 5587331, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nt6hqnlzPiU/AAAAAAAAAAI/AAAAAAAAA7M/YxYYxk7Ry0I/photo.jpg?sz=128", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/5587331/prasanna"}, "is_accepted": false, "score": -1, "last_activity_date": 1495065190, "creation_date": 1495065190, "answer_id": 44036482, "question_id": 44036426, "link": "https://stackoverflow.com/questions/44036426/how-to-compare-two-string-values-in-go-in-a-case-insensitive-manner/44036482#44036482", "title": "How to compare two string values in Go in a case insensitive manner?", "body": "<p>Found the answer. Convert both strings to either lowercase or upper case and compare.\n<code>\nimport \"strings\"\nstrings.ToUpper(str1) == strings.ToUpper(str2)\n</code></p>\n"}, {"comments": [{"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "edited": false, "score": 1, "creation_date": 1543482970, "post_id": 44036521, "comment_id": 93938476, "body": "Note: assumes <code>utf-8</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 21, "last_activity_date": 1495065599, "creation_date": 1495065599, "answer_id": 44036521, "question_id": 44036426, "link": "https://stackoverflow.com/questions/44036426/how-to-compare-two-string-values-in-go-in-a-case-insensitive-manner/44036521#44036521", "title": "How to compare two string values in Go in a case insensitive manner?", "body": "<p>There is a <a href=\"https://golang.org/pkg/strings/#EqualFold\" rel=\"noreferrer\"><code>strings.EqualFold()</code></a> function which performs case insensitive string comparison.</p>\n\n<p>For example:</p>\n\n<pre><code>fmt.Println(strings.EqualFold(\"aa\", \"Aa\"))\nfmt.Println(strings.EqualFold(\"aa\", \"AA\"))\nfmt.Println(strings.EqualFold(\"aa\", \"Ab\"))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/f0cdf0XFcD\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>true\ntrue\nfalse\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1450, "user_id": 602719, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/NeKpd.jpg?s=128&g=1", "display_name": "lunicon", "link": "https://stackoverflow.com/users/602719/lunicon"}, "is_accepted": false, "score": -2, "last_activity_date": 1584026124, "creation_date": 1584026124, "answer_id": 60656980, "question_id": 44036426, "link": "https://stackoverflow.com/questions/44036426/how-to-compare-two-string-values-in-go-in-a-case-insensitive-manner/60656980#60656980", "title": "How to compare two string values in Go in a case insensitive manner?", "body": "<p>strings.EqualFold() is not compare, some times you need sign of compare</p>\n\n<pre><code>func compareNoCase(i, j string) int {\n    is, js := []rune(i), []rune(j)\n    il, jl := len(is), len(js)\n\n  ml := il\n    if ml &gt; jl {\n        ml = jl\n    }\n\n    for n := 0; n &lt; ml; n++ {\n        ir, jr := unicode.ToLower(is[n]), unicode.ToLower(js[n])\n        if ir &lt; jr {\n            return -1\n        } else if ir &gt; jr {\n            return 1\n        }\n    }\n\n    if il &lt; jl {\n        return -1\n    }\n    if il &gt; jl {\n        return 1\n    }\n    return 0\n}\n\nfunc equalsNoCase(i, j string) bool {\n    return compareNoCase(i, j) == 0\n}\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 5587331, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nt6hqnlzPiU/AAAAAAAAAAI/AAAAAAAAA7M/YxYYxk7Ry0I/photo.jpg?sz=128", "display_name": "Prasanna", "link": "https://stackoverflow.com/users/5587331/prasanna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5125, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1584026124, "creation_date": 1495064805, "last_edit_date": 1495066169, "question_id": 44036426, "link": "https://stackoverflow.com/questions/44036426/how-to-compare-two-string-values-in-go-in-a-case-insensitive-manner", "title": "How to compare two string values in Go in a case insensitive manner?", "body": "<p>How to compare two strings with case insensitivity?\nFor example: Both <code>\"a\" == \"a\"</code> and <code>\"a\" == \"A\"</code> must return <code>true</code>.</p>\n"}, {"tags": ["go", "chess", "alpha-beta-pruning"], "comments": [{"owner": {"reputation": 545, "user_id": 4678667, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M0qxt.jpg?s=128&g=1", "display_name": "micsthepick", "link": "https://stackoverflow.com/users/4678667/micsthepick"}, "edited": false, "score": 0, "creation_date": 1574287729, "post_id": 44036416, "comment_id": 104183360, "body": "this code seems to have a problem, see <a href=\"https://stackoverflow.com/questions/48846642/is-there-something-wrong-with-my-quiescence-search\" title=\"is there something wrong with my quiescence search\">stackoverflow.com/questions/48846642/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 32156, "user_id": 783510, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/fgbAM.png?s=128&g=1", "display_name": "Philipp Cla&#223;en", "link": "https://stackoverflow.com/users/783510/philipp-cla%c3%9fen"}, "is_accepted": true, "score": 1, "last_activity_date": 1496867966, "creation_date": 1496867966, "answer_id": 44422345, "question_id": 44036416, "link": "https://stackoverflow.com/questions/44036416/chess-quiescence-search-dominating-runtime/44422345#44422345", "title": "Chess: quiescence search dominating runtime", "body": "<p>If I read your code correctly, you are searching all captures. What you can do to save work, is to prune the hopeless captures move. It turns out that it is quite common that moves are so bad that it is safe to skip them, so the technique is quite safe.</p>\n\n<p>For example, take a look at this position:</p>\n\n<p><a href=\"https://i.stack.imgur.com/ZLKu9.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZLKu9.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>FEN: <code>rnbqkbnr/pppppppp/8/8/8/8/1PP1PPP1/RNBQKBNR w KQkq - 0 1</code></p>\n\n<p>There are three captures:</p>\n\n<ul>\n<li>Rxa7</li>\n<li>Qxd7+</li>\n<li>Rxh7</li>\n</ul>\n\n<p>Let us assume the engine first tries the capture move with the queen. Black has four ways to capture back, but any of these moves will likely result in a cutoff.</p>\n\n<p>For instance, black plays Bxd7. Now white has two captures in the resulting position, Rxa7 or Rxh7.</p>\n\n<p>Here, most engines will recognize that white has already fallen back in material (in comparison to beta) that even capturing a pawn will not help. So, both of this rook captures are unlikely to result in a cutoff.</p>\n\n<p>Here, your current search would still continue to search these moves. Detecting such cases and skipping these moves will save a lot of work.</p>\n\n<p>There are further optimizations. For example, strong engines with <a href=\"https://chessprogramming.wikispaces.com/Static+Exchange+Evaluation\" rel=\"nofollow noreferrer\">static exchange evaluation</a> will immediately see that Qxd7 will win one pawn but will loose the queen. As this is a bad trade, the engine can immediately skip this move. The same goes for the other two rook captures.</p>\n\n<p>As always, there is a trade-off, though. If you prune too aggressively, you will eventually prune good moves, too. In general, I would recommend to spend more time in the normal search, not in the quiescence search, so aggressive pruning should be fine.</p>\n"}], "owner": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 412, "favorite_count": 0, "accepted_answer_id": 44422345, "answer_count": 1, "score": 1, "last_activity_date": 1496867966, "creation_date": 1495064768, "question_id": 44036416, "link": "https://stackoverflow.com/questions/44036416/chess-quiescence-search-dominating-runtime", "title": "Chess: quiescence search dominating runtime", "body": "<p>I have implemented an alpha-beta search with quiescence search for my chess engine. However, in most positions, the quiescence search is taking 80-90% of the total execution time, as indicated by my profiler. Do I have a bug with my pruning?</p>\n\n<p>I have included both the alpha-beta routine and the quiescence routine.</p>\n\n<p>My quiescence search is based directly on <a href=\"https://chessprogramming.wikispaces.com/Quiescence+Search\" rel=\"nofollow noreferrer\">this pseudocode</a>.</p>\n\n<pre><code>// Perform the alpha-beta search.\nfunc ab(b *dragontoothmg.Board, alpha int16, beta int16, depth int8, halt chan bool, stop *bool) (int16, dragontoothmg.Move) {\n    nodeCount++\n\n    if *stop {\n        return alpha, 0\n    }\n\n    found, tableMove, tableEval, tableDepth, tableNodeType := transtable.Get(b)\n    if found &amp;&amp; tableDepth &gt;= depth {\n        if tableNodeType == transtable.Exact {\n            return tableEval, tableMove\n        } else if tableNodeType == transtable.LowerBound {\n            alpha = max(alpha, tableEval)\n        } else { // upperbound\n            beta = min(beta, tableEval)\n        }\n        if alpha &gt;= beta {\n            return tableEval, tableMove\n        }\n    }\n    if depth == 0 {\n        //return eval.Evaluate(b), 0\n        return quiesce(b, alpha, beta, stop), 0\n    }\n\n    alpha0 := alpha\n    bestVal := int16(negInf) \n    moves := b.GenerateLegalMoves()\n    var bestMove dragontoothmg.Move\n    if len(moves) &gt; 0 {\n        bestMove = moves[0] // randomly pick some move\n    }\n    for _, move := range moves {\n        unapply := b.Apply(move)\n        var score int16\n        score, _ = ab(b, -beta, -alpha, depth-1, halt, stop)\n        score = -score\n        unapply()\n        if score &gt; bestVal {\n            bestMove = move\n            bestVal = score\n        }\n        alpha = max(alpha, score)\n        if alpha &gt;= beta {\n            break\n        }\n    }\n\n    if *stop {\n        return bestVal, bestMove\n    }\n\n    var nodeType uint8\n    if bestVal &lt;= alpha0 {\n        nodeType = transtable.UpperBound\n    } else if bestVal &gt;= beta {\n        nodeType = transtable.LowerBound\n    } else {\n        nodeType = transtable.Exact\n    }\n    transtable.Put(b, bestMove, bestVal, depth, nodeType)\n    return bestVal, bestMove\n}\n\nfunc quiesce(b *dragontoothmg.Board, alpha int16, beta int16, stop *bool) int16 {\n    nodeCount++\n    if *stop {\n        return alpha\n    }\n    var standPat int16\n    found, _, evalresult, _, ntype := transtable.Get(b)\n    if found &amp;&amp; ntype == transtable.Exact {\n        standPat = evalresult\n    } else {\n        standPat = eval.Evaluate(b)\n        transtable.Put(b, 0, standPat, 0, transtable.Exact)\n    }\n    if standPat &gt;= beta {\n        return beta\n    }\n    if alpha &lt; standPat {\n        alpha = standPat\n    }\n    moves := b.GenerateLegalMoves()\n    if len(moves) == 0 { // TODO(dylhunn): What about stalemate?\n        return negInf\n    }\n    for _, move := range moves {\n        if !isCapture(move, b) {\n            continue\n        }\n        unapply := b.Apply(move)\n        score := -quiesce(b, -beta, -alpha, stop)\n        unapply()\n        if score &gt;= beta {\n            return beta\n        }\n        if score &gt; alpha {\n            alpha = score\n        }\n    }\n    return alpha\n}\n\nfunc isCapture(m dragontoothmg.Move, b *dragontoothmg.Board) bool {\n    toBitboard := (uint64(1) &lt;&lt; m.To())\n    return (toBitboard&amp;b.White.All != 0) || (toBitboard&amp;b.Black.All != 0)\n}\n</code></pre>\n"}, {"tags": ["go", "apache-kafka", "message-hub"], "answers": [{"tags": [], "owner": {"reputation": 511, "user_id": 5317866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45b9bf1eae2d61aef7c9b2478ec7f172?s=128&d=identicon&r=PG&f=1", "display_name": "Edoardo Comar", "link": "https://stackoverflow.com/users/5317866/edoardo-comar"}, "is_accepted": false, "score": 0, "last_activity_date": 1495068675, "creation_date": 1495068675, "answer_id": 44036912, "question_id": 44036400, "link": "https://stackoverflow.com/questions/44036400/kafka-golang-client-fails-to-connect-to-message-hub-service/44036912#44036912", "title": "Kafka Golang Client fails to connect to Message Hub Service", "body": "<p>Message Hub requires TLS v.1.2.</p>\n\n<p>From your error message it may well be that the tls version used on the two machines differs.</p>\n\n<p>librdkafka mentions the property <code>ssl.cipher.suites</code>\n<a href=\"https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md\" rel=\"nofollow noreferrer\">https://github.com/edenhill/librdkafka/blob/master/CONFIGURATION.md</a>\nI never had to set it, for C or node clients.</p>\n\n<p>If you're using a Mac, make sure that librdkafka is using the openssl library that is installed with Homebrew and not the on from Apple.\nOn my Mac I compile librdkafka after having exported\n<code>\nCPPFLAGS=-I/usr/local/opt/openssl/include\nLDFLAGS=-L/usr/local/opt/openssl/lib\n</code></p>\n"}], "owner": {"reputation": 1, "user_id": 8028021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d6c35654eb336363537452804820129?s=128&d=identicon&r=PG&f=1", "display_name": "Stephanie Reaves", "link": "https://stackoverflow.com/users/8028021/stephanie-reaves"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 264, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495068675, "creation_date": 1495064639, "last_edit_date": 1495542381, "question_id": 44036400, "link": "https://stackoverflow.com/questions/44036400/kafka-golang-client-fails-to-connect-to-message-hub-service", "title": "Kafka Golang Client fails to connect to Message Hub Service", "body": "<p>This is a code snippet of what I'm running:</p>\n\n<pre><code>err := godotenv.Load()\n  if err != nil {\n    log.Fatal(\"Error loading .env file\")\n  }\nbroker := os.Getenv(\"BROKER\")\ntopic := os.Getenv(\"TOPIC\")\nusername := os.Getenv(\"USERNAME\")\npassword := os.Getenv(\"PASSWORD\")\ncalocation := os.Getenv(\"CALOCATION\")\n\np, err := kafka.NewProducer(&amp;kafka.ConfigMap{\n    \"metadata.broker.list\": broker,\n    \"security.protocol\":    \"sasl_ssl\",\n    \"sasl.username\":        username,\n    \"sasl.password\":        password,\n    \"sasl.mechanisms\":      \"PLAIN\",\n    \"ssl.ca.location\":      calocation,\n    \"api.version.request\":  true})\n\nif err != nil {\n    fmt.Printf(\"Failed to create producer: %s\\n\", err)\n    os.Exit(1)\n}\n</code></pre>\n\n<p>Basically, this runs successfully on one machine, but not another. The error that I'm receiving on the machine that isn't working is the following: </p>\n\n<pre><code>'SSL handshake failed: /SourceCache/OpenSSL098/OpenSSL098-52.40.1/src/ssl/s23_clnt.c:593: error:1407742E:SSL routines:SSL23_GET_SERVER_HELLO:tlsv1 alert protocol version:'\n</code></pre>\n\n<p>Not sure if this issue could be linked to this issue: <a href=\"https://stackoverflow.com/questions/39411756/why-kafka-python-fails-to-connect-to-bluemix-message-hub-service\">Why kafka-python fails to connect to Bluemix message hub service?</a>... Don't think so as the exact code is running on one machine but not the other. Any help is appreciated!</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 0, "creation_date": 1495416417, "post_id": 44036358, "comment_id": 75226931, "body": "Problem solved?"}, {"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "reply_to_user": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 0, "creation_date": 1500872433, "post_id": 44036358, "comment_id": 77508494, "body": "@RicardoBranco really sorry for the delay"}], "answers": [{"comments": [{"owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "edited": false, "score": 0, "creation_date": 1500872635, "post_id": 44038511, "comment_id": 77508558, "body": "Great greate answer. It works without <code>#define _GNU_SOURCE 1</code> for me. go version number is 1.8, and os is macOS el capitan."}], "tags": [], "owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "is_accepted": true, "score": 1, "last_activity_date": 1495081517, "last_edit_date": 1495081517, "creation_date": 1495081124, "answer_id": 44038511, "question_id": 44036358, "link": "https://stackoverflow.com/questions/44036358/cannot-access-c-variables-in-cgo/44038511#44038511", "title": "Cannot access c variables in cgo", "body": "<p>#define's are problematic with CGo. I could get it to work with Go 1.8.1 on Linux amd64 like this:</p>\n\n<pre><code>package main\n\nimport \"os\"\n\n/*\n#define _GNU_SOURCE 1\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;utmpx.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n\nchar *path_utmpx = UTMPX_FILE;\n\ntypedef struct utmpx utmpx;\n*/\nimport \"C\"\n\ntype record C.utmpx\n\nfunc main() {\n    path := C.GoString(C.path_utmpx)\n    fd, err := os.Open(path)\n    if err != nil {\n        panic(\"bad\")\n    }\n    fd.Close()\n}\n</code></pre>\n\n<ol>\n<li>I had to define _GNU_SOURCE to get the UTMPX_FILE definition.</li>\n<li>I had to create the path_utmpx variable to get around the #define problems with CGo.</li>\n<li>I had to do the typedef to get <code>type record C.utmpx</code> compile.</li>\n<li>With Go, you can't use C strings directly.  You must convert them to Go strings.  Similarly, if you want to call C functions with Go strings, you must convert them to C strings (and free the space allocated in the heap).  </li>\n</ol>\n\n<p>A few pointers:</p>\n\n<ul>\n<li><a href=\"https://blog.golang.org/c-go-cgo\" rel=\"nofollow noreferrer\">https://blog.golang.org/c-go-cgo</a></li>\n<li><a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">https://golang.org/cmd/cgo/</a></li>\n</ul>\n\n<p>Good luck!</p>\n"}], "owner": {"reputation": 355, "user_id": 5819540, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh4.googleusercontent.com/-qhhiN4wB3Fg/AAAAAAAAAAI/AAAAAAAAABg/agaXzdWPuSU/photo.jpg?sz=128", "display_name": "GZ Xue", "link": "https://stackoverflow.com/users/5819540/gz-xue"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "accepted_answer_id": 44038511, "answer_count": 1, "score": 0, "last_activity_date": 1495084379, "creation_date": 1495064326, "last_edit_date": 1495084379, "question_id": 44036358, "link": "https://stackoverflow.com/questions/44036358/cannot-access-c-variables-in-cgo", "title": "Cannot access c variables in cgo", "body": "<p>I'm trying to access a c struct in cgo, but go this </p>\n\n<blockquote>\n  <p>could not determine kind of name for C.utmpx</p>\n</blockquote>\n\n<p>utmpx is a c struct </p>\n\n<p>here is the go code:</p>\n\n<pre><code>/*\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;utmpx.h&gt;\n#include &lt;fcntl.h&gt;\n#include &lt;unistd.h&gt;\n*/\nimport \"C\"\n\ntype record C.utmpx\n\nfd, err := os.Open(C._PATH_UTMPX) // this works\nfd, err := os.Open(C.UTMPX_FILE)  // error\n</code></pre>\n\n<p>In the utmpx.h file , there is </p>\n\n<pre><code> #define    _PATH_UTMPX     \"/var/run/utmpx\"\n #define    UTMPX_FILE  _PATH_UTMPX\n</code></pre>\n\n<p>I can use _PATH_UTMPX but get the same warn when using UTMPX_FILE, why?</p>\n\n<p>It seems that I cannot access these variables declared in .h file\nHow can i do this ?</p>\n\n<p>platform: macOS sirria,go 1.8</p>\n"}, {"tags": ["pointers", "go", "data-structures"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1495057493, "post_id": 44035193, "comment_id": 75097236, "body": "Show the actual code you&#39;re using. You are calling <code>Rename</code> with a nil receiver, but it&#39;s now shown here."}, {"owner": {"reputation": 3703, "user_id": 2127296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kjm9H.png?s=128&g=1", "display_name": "Iv&#225;n Rodr&#237;guez Torres", "link": "https://stackoverflow.com/users/2127296/iv%c3%a1n-rodr%c3%adguez-torres"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1495058047, "post_id": 44035193, "comment_id": 75097449, "body": "@JimB I can&#39;t show the actual code. I tried to reproduce it as best as possible editing the code shown before. Thanks for your help"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1495058585, "post_id": 44035193, "comment_id": 75097649, "body": "@JimB is right, if the error is coming from where you&#39;re saying it is, then <code>c</code> is <code>nil</code>. Instead of checking the type of <code>c.Name</code> you should check that <code>c</code> is not <code>nil</code> inside the <code>Rename</code> method."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1495058796, "post_id": 44035193, "comment_id": 75097720, "body": "@Iv&#225;nRodr&#237;guezTorres here&#39;s an example <a href=\"https://play.golang.org/p/5YiDL3ucc6\" rel=\"nofollow noreferrer\">play.golang.org/p/5YiDL3ucc6</a>"}, {"owner": {"reputation": 3703, "user_id": 2127296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kjm9H.png?s=128&g=1", "display_name": "Iv&#225;n Rodr&#237;guez Torres", "link": "https://stackoverflow.com/users/2127296/iv%c3%a1n-rodr%c3%adguez-torres"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1495058832, "post_id": 44035193, "comment_id": 75097730, "body": "@mkopriva din-din We have a winner. First day programing on go. Write an answer and I will accept it. Thanks very much"}], "answers": [{"tags": [], "owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "is_accepted": false, "score": 1, "last_activity_date": 1495061275, "last_edit_date": 1495061275, "creation_date": 1495058242, "answer_id": 44035412, "question_id": 44035193, "link": "https://stackoverflow.com/questions/44035193/trouble-asigning-value-in-go/44035412#44035412", "title": "Trouble asigning value in GO", "body": "<p>I see no problem with the code.  Maybe just the code style and the method name.  To make it work I added some return values that you should adjust and removed the C++ style comments.</p>\n\n<p>Note that the problem with a nil receiver is not an issue because of the <code>p := &amp;Pets{}</code> assignment.</p>\n\n<p><a href=\"https://play.golang.org/p/bavuUn9IpT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bavuUn9IpT</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\ntype (\n\n    Cat struct {\n        Name string \n    }\n\n    Dog struct {\n        Name string \n    }\n\n    Pets struct{\n        c *Cat\n        d *Dog\n    }\n)\n\nfunc (c *Cat) Rename(d Dog) (string, error) {\n     name := strings.TrimSpace(d.Name)\n     c.Name = name\n     return \"\", nil\n}\n\nfunc (p *Pets) SomeFunction() (err error){\n    p.d = &amp;Dog{} \n    p.c = &amp;Cat{}\n\n    p.d.Name = \" Foo \"\n\n    p.c.Rename(*p.d)\n    return nil\n}\n\nfunc main(){\n    p := &amp;Pets{}\n    p.SomeFunction()\n    fmt.Printf(\"%s\\n\", p.c.Name)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3703, "user_id": 2127296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kjm9H.png?s=128&g=1", "display_name": "Iv&#225;n Rodr&#237;guez Torres", "link": "https://stackoverflow.com/users/2127296/iv%c3%a1n-rodr%c3%adguez-torres"}, "edited": false, "score": 0, "creation_date": 1495059713, "post_id": 44035638, "comment_id": 75098028, "body": "Thanks for clarify @JimB answer."}, {"owner": {"reputation": 4611, "user_id": 7511971, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Byz18.jpg?s=128&g=1", "display_name": "Ricardo Branco", "link": "https://stackoverflow.com/users/7511971/ricardo-branco"}, "edited": false, "score": 0, "creation_date": 1495061070, "post_id": 44035638, "comment_id": 75098449, "body": "The problem with the nil receiver doesn&#39;t ocurr in my example with the assignation <code>p := &amp;Pets{}</code>"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1495059337, "creation_date": 1495059337, "answer_id": 44035638, "question_id": 44035193, "link": "https://stackoverflow.com/questions/44035193/trouble-asigning-value-in-go/44035638#44035638", "title": "Trouble asigning value in GO", "body": "<p>As @JimB already pointed out in his comment</p>\n\n<blockquote>\n  <p>You are calling <code>Rename</code> with a nil receiver</p>\n</blockquote>\n\n<p>which means that, since you're getting the error at <code>c.Name = name</code>, the <code>c</code> receiver inside the <code>Rename</code> method is <code>nil</code>. You need to make sure to initialize <code>c</code> before calling <code>Rename</code>.</p>\n\n<p><a href=\"https://play.golang.org/p/5YiDL3ucc6\" rel=\"nofollow noreferrer\">Example</a></p>\n"}], "owner": {"reputation": 3703, "user_id": 2127296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kjm9H.png?s=128&g=1", "display_name": "Iv&#225;n Rodr&#237;guez Torres", "link": "https://stackoverflow.com/users/2127296/iv%c3%a1n-rodr%c3%adguez-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 44035638, "answer_count": 2, "score": 0, "last_activity_date": 1495061275, "creation_date": 1495057219, "last_edit_date": 1495057971, "question_id": 44035193, "link": "https://stackoverflow.com/questions/44035193/trouble-asigning-value-in-go", "title": "Trouble asigning value in GO", "body": "<p>I'm trying to understand why I'm getting the error: <code>invalid memory address or nil pointer dereference</code></p>\n\n<p>Let's say I have this code (this is not the real one but similar):</p>\n\n<pre><code>type (\n\n    Cat struct {\n        Name string \n    }\n\n    Dog struct {\n        Name string \n    }\n\n    Pets struct{\n        c *Cat\n        d *Dog\n    }\n)\n\nfunc (c *Cat) Rename(d Dog) string {\n     err := SomeErrorChecks()\n     name := strings.TrimSpace(d.Name)\n     c.Name = name // In this line is where I get the error\n\n     return err         \n}\n\nfunc (p *Pets) SomeFunction() string{\n    p.d = &amp;Dog{} \n    p.c = &amp;Cat{}\n\n    p.d.Name = \" Foo \"\n\n    err := p.c.Rename(*p.d)\n\n    return err\n}\n\nfunc main(){\n    //some code\n\n    err := SomeFunction()\n\n    //some error handling not relevant\n}\n</code></pre>\n\n<p>I've checked that <code>strings.TrimSpace(d.Name)</code> returns de desired string. And I've checked that the type of <code>c.Name</code> is string. So, why I can't assing <code>name</code> to <code>c.Name</code> if both are the same type?</p>\n"}, {"tags": ["go", "intellij-idea", "goland"], "answers": [{"comments": [{"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1495054863, "post_id": 44034595, "comment_id": 75096037, "body": "hi! :) thank you for your response. I saw that you chose a package instead of a file and you chose i&#39;m guessing a github repository that contains this project. I didn&#39;t upload my project to github yet, and I can&#39;t choose &#39;main&#39; as the package name. so what do i do ?"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "reply_to_user": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1495056694, "post_id": 44034595, "comment_id": 75096863, "body": "You don&#39;t need to have your package on Github. As long as it&#39;s on your computer in the correct GOPATH place, that&#39;s enough for Go (and the IDE) to work.  If you look at the video it shows in the output and you can see the project path at the beginning when I&#39;m editing the Run Configuration from file to package."}], "tags": [], "owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "is_accepted": true, "score": 2, "last_activity_date": 1495054366, "creation_date": 1495054366, "answer_id": 44034595, "question_id": 44033612, "link": "https://stackoverflow.com/questions/44033612/run-debug-go-application-with-more-then-one-file-on-the-main-package-with-goglan/44034595#44034595", "title": "run/debug go application with more then one file on the main package with gogland", "body": "<p>I've created the following video <a href=\"https://youtu.be/ko-wKntCLjg\" rel=\"nofollow noreferrer\">https://youtu.be/ko-wKntCLjg</a> to better demonstrate how to achieve this.</p>\n\n<p>There are two options that are also shows in the video:</p>\n\n<ul>\n<li>the click on the link for adding the ldflags parameter: this is needed for Windows applications in order to allow them to be debugged as well as sometimes in CGO apps (or on OSX) for the same purposes. This is an issue with Go, not the IDE or the the debugger</li>\n<li>the second option is the one that says Single instance only. I prefer my run configurations as such since they allow me to run them a single time and press the same shortcut to restart them when needed.</li>\n</ul>\n\n<p>Depending on your operating system or application type, the first one might be needed, while the second one is purely functional for various use-cases (and as I've said, personal preference).</p>\n\n<p>Hope this helps.</p>\n"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 452, "favorite_count": 0, "accepted_answer_id": 44034595, "answer_count": 1, "score": 0, "last_activity_date": 1495054366, "creation_date": 1495050575, "question_id": 44033612, "link": "https://stackoverflow.com/questions/44033612/run-debug-go-application-with-more-then-one-file-on-the-main-package-with-goglan", "title": "run/debug go application with more then one file on the main package with gogland", "body": "<p>I downloaded latest Gogland in order to run/debug Go 1.8.1 applications.</p>\n\n<p>I have the exact problem in Latest Intellij Ultimate EAP.</p>\n\n<p>my project's <code>main</code> package contains several files, when I try to run/debug it as a <code>Go Application</code>, it acts as a <code>Go Single File</code>.</p>\n\n<p>which means that when I try to run the application while choosing the main go file, it complains about missing variables definitions from other files on that same directory that are in the <code>main</code> package as well.</p>\n\n<p>in the <code>Run Configuration</code> when I choose <code>Package</code> instead of <code>File</code>, I can't choose the <code>main</code> package.</p>\n\n<p>so how do I run/debug my project properly ?</p>\n\n<p>thanks! :)</p>\n"}, {"tags": ["go", "websocket", "google-cloud-platform", "kubernetes", "google-kubernetes-engine"], "comments": [{"owner": {"reputation": 7660, "user_id": 2350684, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yuQa5.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/2350684/oliver"}, "edited": false, "score": 0, "creation_date": 1495074076, "post_id": 44033191, "comment_id": 75101608, "body": "Could it be the load balancer that kills the connection after 30 seconds?"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1495114939, "post_id": 44033191, "comment_id": 75124172, "body": "what did you use for your custom ingress controller?"}, {"owner": {"reputation": 115, "user_id": 8027387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d52388203ce0f34c80b57f8a0a0596?s=128&d=identicon&r=PG", "display_name": "Jeremy Gordon", "link": "https://stackoverflow.com/users/8027387/jeremy-gordon"}, "edited": false, "score": 1, "creation_date": 1495170763, "post_id": 44033191, "comment_id": 75148412, "body": "I don&#39;t know how I missed it, but the backend settings of the GCP load balancer has a timeout for &quot;How long to wait for the backend service to respond before considering it a failed request&quot; defaulting to 30s.   The WebSocket is not unresponsive. It&#39;s sending/receiving ping/pongs and msgs right up until getting killed at 30s, which I see in browser and golang logs.  If I set the load balancer timeout to 30000 seconds, things &quot;work&quot;.   Not a real fix IMO as other traffic through the load balancer will never become unresponsive; the load balancer will continue to send them traffic."}, {"owner": {"reputation": 981, "user_id": 1206767, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479660471a2d649706d82b11d2b29b60?s=128&d=identicon&r=PG", "display_name": "jmartins", "link": "https://stackoverflow.com/users/1206767/jmartins"}, "edited": false, "score": 2, "creation_date": 1495707075, "post_id": 44033191, "comment_id": 75369966, "body": "We have the exact same issue and can confirm it is a problem with the loadbalancer and not Kubernetes/GKE. We have switched from TCP to HTTPS loadbalancer and have just noticed that socket connections were timing out at 30s. Tried changing the above mentioned setting but are still seeing connections dropped"}], "answers": [{"comments": [{"owner": {"reputation": 115, "user_id": 8027387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d52388203ce0f34c80b57f8a0a0596?s=128&d=identicon&r=PG", "display_name": "Jeremy Gordon", "link": "https://stackoverflow.com/users/8027387/jeremy-gordon"}, "edited": false, "score": 0, "creation_date": 1496816492, "post_id": 44382066, "comment_id": 75808914, "body": "Thanks for the link to the github discussion! As I mention in my post, I&#39;m not using Kubernetes to load balance, so unless I&#39;m missing something, I don&#39;t care about the affinity afforded by OnlyLocal but yes, as per my update, the timeout on the GCP load balancer was the key. That said, it&#39;s not a &quot;real&quot; solution because it means that it won&#39;t time out *actually&quot; un-responsive connections."}, {"owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "reply_to_user": {"reputation": 115, "user_id": 8027387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d52388203ce0f34c80b57f8a0a0596?s=128&d=identicon&r=PG", "display_name": "Jeremy Gordon", "link": "https://stackoverflow.com/users/8027387/jeremy-gordon"}, "edited": false, "score": 0, "creation_date": 1497040028, "post_id": 44382066, "comment_id": 75929199, "body": "Updated my response with an example to be more accurate."}, {"owner": {"reputation": 12849, "user_id": 1218281, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/2a7d7e9fa2049d4dbf9a508e5eccdb0a?s=128&d=identicon&r=PG", "display_name": "Cyral", "link": "https://stackoverflow.com/users/1218281/cyral"}, "reply_to_user": {"reputation": 305, "user_id": 743752, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/6e0e2d414ac0ce7e96262799e893afcc?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/743752/chris"}, "edited": false, "score": 0, "creation_date": 1514413199, "post_id": 44382066, "comment_id": 82967056, "body": "@Chris I&#39;ve updated the link (<a href=\"https://github.com/kubernetes/ingress-gce/tree/master/examples/websocket\" rel=\"nofollow noreferrer\">github.com/kubernetes/ingress-gce/tree/master/examples/&hellip;</a>)"}, {"owner": {"reputation": 373, "user_id": 4497144, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2596043dfc32e6a8559dbf8f4863b6b8?s=128&d=identicon&r=PG&f=1", "display_name": "PoorBob", "link": "https://stackoverflow.com/users/4497144/poorbob"}, "edited": false, "score": 1, "creation_date": 1551895516, "post_id": 44382066, "comment_id": 96811710, "body": "Dead links again :&#39;("}, {"owner": {"reputation": 659, "user_id": 3979172, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JWyPF.jpg?s=128&g=1", "display_name": "tudorprodan", "link": "https://stackoverflow.com/users/3979172/tudorprodan"}, "edited": false, "score": 0, "creation_date": 1559553316, "post_id": 44382066, "comment_id": 99443329, "body": "Example was removed but here is from a reference commit: <a href=\"https://github.com/kubernetes/ingress-gce/tree/b0603c69382a39d097063eab8e3d9e30ca1cdf7b/examples/websocket\" rel=\"nofollow noreferrer\">github.com/kubernetes/ingress-gce/tree/&hellip;</a>   Also the original PR: <a href=\"https://github.com/kubernetes/ingress-nginx/pull/834/files\" rel=\"nofollow noreferrer\">github.com/kubernetes/ingress-nginx/pull/834/files</a>"}], "tags": [], "owner": {"reputation": 34574, "user_id": 54929, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/2jr8M.jpg?s=128&g=1", "display_name": "AhmetB - Google", "link": "https://stackoverflow.com/users/54929/ahmetb-google"}, "is_accepted": false, "score": -2, "last_activity_date": 1514413184, "last_edit_date": 1514413184, "creation_date": 1496727386, "answer_id": 44382066, "question_id": 44033191, "link": "https://stackoverflow.com/questions/44033191/gke-websocket-nodeport-30s-dropped-connections/44382066#44382066", "title": "GKE + WebSocket + NodePort 30s dropped connections", "body": "<p>Check out the following example: <a href=\"https://github.com/kubernetes/ingress-gce/tree/master/examples/websocket\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/ingress-gce/tree/master/examples/websocket</a></p>\n"}, {"tags": [], "owner": {"reputation": 44, "user_id": 8096214, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hjtxF.png?s=128&g=1", "display_name": "brugz", "link": "https://stackoverflow.com/users/8096214/brugz"}, "is_accepted": true, "score": 3, "last_activity_date": 1496905640, "creation_date": 1496905640, "answer_id": 44428886, "question_id": 44033191, "link": "https://stackoverflow.com/questions/44033191/gke-websocket-nodeport-30s-dropped-connections/44428886#44428886", "title": "GKE + WebSocket + NodePort 30s dropped connections", "body": "<p>I think this may be Working as Intended. Google just updated the documentation today (about an hour ago).</p>\n\n<p><a href=\"https://cloud.google.com/compute/docs/load-balancing/http/#websocket_proxy_support\" rel=\"nofollow noreferrer\">LB Proxy Support docs</a></p>\n\n<p><a href=\"https://cloud.google.com/compute/docs/load-balancing/http/backend-service#backend_service_components\" rel=\"nofollow noreferrer\">Backend Service Components docs</a></p>\n\n<p>Cheers,</p>\n\n<p>Matt</p>\n"}], "owner": {"reputation": 115, "user_id": 8027387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86d52388203ce0f34c80b57f8a0a0596?s=128&d=identicon&r=PG", "display_name": "Jeremy Gordon", "link": "https://stackoverflow.com/users/8027387/jeremy-gordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5427, "favorite_count": 4, "accepted_answer_id": 44428886, "answer_count": 2, "score": 10, "last_activity_date": 1514413184, "creation_date": 1495049018, "last_edit_date": 1495171172, "question_id": 44033191, "link": "https://stackoverflow.com/questions/44033191/gke-websocket-nodeport-30s-dropped-connections", "title": "GKE + WebSocket + NodePort 30s dropped connections", "body": "<p>I have a golang service that implements a WebSocket client using gorilla that is exposed to a Google Container Engine (GKE)/k8s cluster via a NodePort (30002 in this case).</p>\n\n<p>I've got a manually created load balancer (i.e. NOT at k8s ingress/load balancer) with HTTP/HTTPS frontends (i.e. 80/443) that forward traffic to nodes in my GKE/k8s cluster on port 30002.</p>\n\n<p>I can get my JavaScript WebSocket implementation in the browser (Chrome 58.0.3029.110 on OSX) to connect, upgrade and send / receive messages.</p>\n\n<p>I log ping/pongs in the golang WebSocket client and all looks good until 30s in. 30s after connection my golang WebSocket client gets an EOF / close 1006 (abnormal closure) and my JavaScript code gets a close event. As far as I can tell, neither my Golang or JavaScript code is initiating the WebSocket closure.</p>\n\n<p>I don't particularly care about session affinity in this case AFAIK, but I have tried both IP and cookie based affinity in the load balancer with long lived cookies.</p>\n\n<p>Additionally, this exact same set of k8s deployment/pod/service specs and golang service code works great on my KOPS based k8s cluster on AWS through AWS' ELBs.</p>\n\n<p>Any ideas where the 30s forced closures might be coming from? Could that be a k8s default cluster setting specific to GKE or something on the GCE load balancer?</p>\n\n<p>Thanks for reading!</p>\n\n<p>-- UPDATE --</p>\n\n<p>There is a backend configuration timeout setting on the load balancer which is for \"How long to wait for the backend service to respond before considering it a failed request\".</p>\n\n<p>The WebSocket is not unresponsive. It is sending ping/pong and other messages right up until getting killed which I can verify by console.log's in the browser and logs in the golang service.</p>\n\n<p>That said, if I bump the load balancer backend timeout setting to 30000 seconds, things \"work\".</p>\n\n<p>Doesn't feel like a real fix though because the load balancer will continue to feed <em>actual</em> unresponsive services traffic inappropriately, never mind if the WebSocket <em>does</em> become unresponsive.</p>\n\n<p>I've isolated the high timeout setting to a specific backend setting using a path map, but hoping to come up with a real fix to the problem.</p>\n"}, {"tags": ["jquery", "go"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1495048621, "post_id": 44032886, "comment_id": 75092638, "body": "It might not like your path for jquery. Have you checked your console for errors? You might also need to add the right Content-Type to the response headers when serving content files."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1495052946, "last_edit_date": 1495052946, "creation_date": 1495052635, "answer_id": 44034147, "question_id": 44032886, "link": "https://stackoverflow.com/questions/44032886/golang-javascript-ui-issue/44034147#44034147", "title": "golang javascript ui issue", "body": "<p>When you open the HTML file directly in the browser, the browser will look for the jquery file in your file system. When you view the page by navigating to <code>localhost:8000/...</code> the browser will look for the jquery file at <code>localhost:8000/...</code>.</p>\n\n<hr>\n\n<p>Your Go app can handle requests to only those two paths that your registered. The html page it renders will make a request to <code>localhost:8000/jquery-1.7.min.js</code> to download the jquery file but you did not register a handler to handle such a request...</p>\n\n<p>That is, you're missing something like this:</p>\n\n<pre><code>router.HandleFunc(\"/jquery-1.7.min.js\", serveJQuery)\n</code></pre>\n\n<p>In the real world though you probably will want to serve more than just a single file, so have a look at <code>gorilla/mux</code>'s readme on <a href=\"https://github.com/gorilla/mux#static-files\" rel=\"nofollow noreferrer\">static files</a> for a more complete solution.</p>\n"}], "owner": {"reputation": 387, "user_id": 4777642, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/c9f699765f124ae794d7393348c91467?s=128&d=identicon&r=PG&f=1", "display_name": "mg03", "link": "https://stackoverflow.com/users/4777642/mg03"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 130, "favorite_count": 0, "accepted_answer_id": 44034147, "answer_count": 1, "score": 1, "last_activity_date": 1495052946, "creation_date": 1495047725, "question_id": 44032886, "link": "https://stackoverflow.com/questions/44032886/golang-javascript-ui-issue", "title": "golang javascript ui issue", "body": "<p>Following html works standalone</p>\n\n<p>\n</p>\n\n<pre><code>&lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n\n    &lt;script type=\"text/javascript\" src=\"./jquery-1.7.min.js\"&gt;&lt;/script&gt;\n    &lt;script type=\"text/javascript\"&gt;\n        $(document).ready(function(){\n\n            $('.del').live('click',function(){\n                $(this).parent().parent().remove();\n            });\n\n            $('.add').live('click',function(){\n                $(this).val('Delete');\n                $(this).attr('class','del');\n                var appendTxt = \"&lt;tr&gt;&lt;td&gt;&lt;input type='text' name='name[]' /&gt;&lt;/td&gt; &lt;td&gt;&lt;input type='text' name='value[]' /&gt;&lt;/td&gt; &lt;td&gt;&lt;input type='checkbox' name='regex[]' /&gt;&lt;/td&gt;&lt;td&gt;&lt;input type='button' class='add' value='Add More' /&gt;&lt;/td&gt;&lt;/tr&gt;\";\n                $(\"tr:last\").after(appendTxt);\n            });\n        });\n    &lt;/script&gt;\n    &lt;style&gt;\n        table {\n          table-layout: fixed;\n          width:1200px;\n        }\n        input{\n          width:285px;\n        }\n    &lt;/style&gt;\n &lt;/head&gt;\n\n&lt;body&gt;\n    &lt;form method=\"post\" action=\"/silencealert\"&gt;\n    &lt;table id=\"options-table\"&gt;\n        &lt;tr&gt;\n            &lt;td&gt;Name&lt;/td&gt;\n            &lt;td&gt;Value&lt;/td&gt;\n            &lt;td&gt;Regex&lt;/td&gt;\n            &lt;td&gt;&amp;nbsp;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;input type=\"text\"   name=\"name[]\" /&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;input type=\"text\"   name=\"value[]\" /&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;input type=\"checkbox\"  name=\"regex[]\" /&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;input type=\"button\" class='del' value='Delete' /&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n        &lt;tr&gt;\n            &lt;td&gt;&lt;input type=\"text\"   name=\"name[]\" /&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;input type=\"text\"   name=\"value[]\" /&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;input type=\"checkbox\"   name=\"regex[]\" /&gt;&lt;/td&gt;\n            &lt;td&gt;&lt;input type=\"button\" class=\"add\" value=\"Add More\" /&gt;&lt;/td&gt;\n        &lt;/tr&gt;\n    &lt;/table&gt;\n    &lt;br&gt;\n    &lt;label for=\"number\"&gt; Expires(Days[1-30]): &lt;/label&gt;\n    &lt;input type=\"number\" min=\"1\" max=\"30\" value=\"\" name=\"days\"&gt;\n    &lt;br&gt;&lt;br&gt;\n&lt;button type=\"submit\"&gt;SilenceAlert&lt;/button&gt;\n  &lt;/form&gt;\n    &lt;hr&gt;\n    &lt;small&gt;User: %s&lt;/small&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p></p>\n\n<p>With the above file when i click on Add More a new table row gets added and when i click delete a table row gets deleted. which is the expected behaiour.</p>\n\n<p>I am using the above html in a golang project (file - main.go)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n)\n\nconst manage_alertsPage = `\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD XHTML 1.0 Transitional//EN\" \"http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd\"&gt;\n&lt;html xmlns=\"http://www.w3.org/1999/xhtml\"&gt;\n\n    &lt;head&gt;\n        &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt;\n\n        &lt;script type=\"text/javascript\" src=\"./jquery-1.7.min.js\"&gt;&lt;/script&gt;\n        &lt;script type=\"text/javascript\"&gt;\n            $(document).ready(function(){\n\n                $('.del').live('click',function(){\n                    $(this).parent().parent().remove();\n                });\n\n                $('.add').live('click',function(){\n                    $(this).val('Delete');\n                    $(this).attr('class','del');\n                    var appendTxt = \"&lt;tr&gt;&lt;td&gt;&lt;input type='text' name='name[]' /&gt;&lt;/td&gt; &lt;td&gt;&lt;input type='text' name='value[]' /&gt;&lt;/td&gt; &lt;td&gt;&lt;input type='checkbox' name='regex[]' /&gt;&lt;/td&gt;&lt;td&gt;&lt;input type='button' class='add' value='Add More' /&gt;&lt;/td&gt;&lt;/tr&gt;\";\n                    $(\"tr:last\").after(appendTxt);\n                });\n            });\n        &lt;/script&gt;\n        &lt;style&gt;\n            table {\n              table-layout: fixed;\n              width:1200px;\n            }\n            input{\n              width:285px;\n            }\n        &lt;/style&gt;\n     &lt;/head&gt;\n\n    &lt;body&gt;\n        &lt;form method=\"post\" action=\"/silencealert\"&gt;\n        &lt;table id=\"options-table\"&gt;\n            &lt;tr&gt;\n                &lt;td&gt;Name&lt;/td&gt;\n                &lt;td&gt;Value&lt;/td&gt;\n                &lt;td&gt;Regex&lt;/td&gt;\n                &lt;td&gt;&amp;nbsp;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;&lt;input type=\"text\"   name=\"name[]\" /&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;input type=\"text\"   name=\"value[]\" /&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;input type=\"checkbox\"  name=\"regex[]\" /&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;input type=\"button\" class='del' value='Delete' /&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n            &lt;tr&gt;\n                &lt;td&gt;&lt;input type=\"text\"   name=\"name[]\" /&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;input type=\"text\"   name=\"value[]\" /&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;input type=\"checkbox\"   name=\"regex[]\" /&gt;&lt;/td&gt;\n                &lt;td&gt;&lt;input type=\"button\" class=\"add\" value=\"Add More\" /&gt;&lt;/td&gt;\n            &lt;/tr&gt;\n        &lt;/table&gt;\n        &lt;br&gt;\n        &lt;label for=\"number\"&gt; Expires(Days[1-30]): &lt;/label&gt;\n        &lt;input type=\"number\" min=\"1\" max=\"30\" value=\"\" name=\"days\"&gt;\n        &lt;br&gt;&lt;br&gt;\n    &lt;button type=\"submit\"&gt;SilenceAlert&lt;/button&gt;\n      &lt;/form&gt;\n        &lt;hr&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n`\n\nfunc manage_alertsPageHandler(response http.ResponseWriter, request *http.Request) {\n    fmt.Fprintf(response, manage_alertsPage)\n}\n\nfunc silencealertPageHandler(response http.ResponseWriter, request *http.Request) {\n\n    err := request.ParseForm()\n  if err != nil {\n      // Handle error here via logging and then return     \n    fmt.Fprintf(response, \"There was an error processing form: \" + err.Error()) \n    return      \n  }\n  fmt.Printf(\"%+v\\n\", request.Form)\n\n    fmt.Fprintf(response, manage_alertsPage)\n}\n\n// server main method\n\nvar router = mux.NewRouter()\n\nfunc main() {\n\n  router.HandleFunc(\"/manage_alerts\", manage_alertsPageHandler)\n    router.HandleFunc(\"/silencealert\", silencealertPageHandler)\n\n    http.Handle(\"/\", router)\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>The folder structure for the go project is </p>\n\n<pre><code>src/web\n - main.go\n - jquery-1.7.min.js\n</code></pre>\n\n<p>when i run the go project:</p>\n\n<pre><code>go run main.go\n</code></pre>\n\n<p>Browse to</p>\n\n<pre><code>localhost:8000/manage_alerts\n</code></pre>\n\n<p>Click on Add More or Delete button, nothing happens</p>\n\n<p>Need some help to figure out why javascript code is not executing here when it was executing just fine outside of the golang code.</p>\n"}, {"tags": ["curl", "cookies", "go"], "comments": [{"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1495061508, "post_id": 44031601, "comment_id": 75098582, "body": "<code>cj := http.CookieJar{}</code> <code>client := http.Client{Jar: cj}</code> <code>client.Get(...)</code>"}, {"owner": {"reputation": 1, "user_id": 8027000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/204127a05ca19c1b174165067fb52387?s=128&d=identicon&r=PG&f=1", "display_name": "GoogleLove", "link": "https://stackoverflow.com/users/8027000/googlelove"}, "reply_to_user": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1495064197, "post_id": 44031601, "comment_id": 75099333, "body": "where is filename path?! this how store cookies in file? may say sample code?"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8027000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/204127a05ca19c1b174165067fb52387?s=128&d=identicon&r=PG&f=1", "display_name": "GoogleLove", "link": "https://stackoverflow.com/users/8027000/googlelove"}, "edited": false, "score": 0, "creation_date": 1495091692, "post_id": 44036517, "comment_id": 75107922, "body": "tank you <a href=\"https://play.golang.org/p/kQR736EJTu\" rel=\"nofollow noreferrer\">play.golang.org/p/kQR736EJTu</a> , have error : <code>use of package cookiejar without selector</code>"}, {"owner": {"reputation": 1211, "user_id": 2949565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VmP0X.jpg?s=128&g=1", "display_name": "abuzze", "link": "https://stackoverflow.com/users/2949565/abuzze"}, "edited": false, "score": 0, "creation_date": 1591189965, "post_id": 44036517, "comment_id": 109960635, "body": "That worked, thank you. But how can i read the cookie again, to use it in a second request?"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 2, "last_activity_date": 1495091783, "last_edit_date": 1495091783, "creation_date": 1495065549, "answer_id": 44036517, "question_id": 44031601, "link": "https://stackoverflow.com/questions/44031601/how-can-make-a-curl-store-cookie-in-golang/44036517#44036517", "title": "How can make a Curl Store Cookie in Golang?", "body": "<p>You don't need to save cookies to a file, just keep your go process running.  If you really wanted to, you would do something like:</p>\n\n<pre><code>import \"net/http/cookiejar\"\nimport \"net/http\"\nimport \"encoding/json\"\nimport \"io/ioutil\"\n\ncookies := make(map[string][]*http.Cookie)\njar, _ := cookiejar.New(nil)\nclient := http.Client{Jar: jar}\nr, _ := client.Get(/* do whatever */)\nsiteCookies := jar.Cookies(r.Request.URL)\ncookies[r.Request.URL.String()] = siteCookies\ndata, _ := json.Marshal(cookies)\nioutil.WriteFile(\"/path/to/cookies.txt\", data, 0644)\n</code></pre>\n\n<p>And then when you start, you would read that file, for each key call <code>url.Parse</code>, and then use that to call <code>jar.SetCookies</code>.</p>\n\n<p><a href=\"https://play.golang.org/p/gQ_n6rPsdl\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gQ_n6rPsdl</a></p>\n"}], "owner": {"reputation": 1, "user_id": 8027000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/204127a05ca19c1b174165067fb52387?s=128&d=identicon&r=PG&f=1", "display_name": "GoogleLove", "link": "https://stackoverflow.com/users/8027000/googlelove"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1394, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1495091783, "creation_date": 1495042934, "last_edit_date": 1495043259, "question_id": 44031601, "link": "https://stackoverflow.com/questions/44031601/how-can-make-a-curl-store-cookie-in-golang", "title": "How can make a Curl Store Cookie in Golang?", "body": "<p>I want send a post/get request and can store cookies in a file near on Program.</p>\n\n<h2>Sample Php Code:</h2>\n\n<pre><code>$___path=\"\";\nfunction send($url,$fields=array(),$reffer=false,$get=false)\n{\n    global $___path;\n    $cookie_file_path = $___path.\"cookie.txt\";//this file of cookies.\n    $agent            = \"Mozilla/5.0 (Windows NT 6.1; WOW64; rv:40.0) Gecko/20100101 Firefox/40.1\";\n    $ch = curl_init(); \n    $headers[] = \"Accept: */*\";\n    $headers[] = \"Connection: Keep-Alive\";\n    curl_setopt($ch, CURLOPT_HTTPHEADER,  $headers);\n    curl_setopt($ch, CURLOPT_HEADER,  0);\n    curl_setopt($ch, CURLOPT_SSL_VERIFYHOST, 0);\n    curl_setopt($ch, CURLOPT_SSL_VERIFYPEER, false);         \n    if($reffer == false){}\n    else\n    {\n        curl_setopt($ch,CURLOPT_REFERER,$reffer);\n    }\n    curl_setopt($ch, CURLOPT_USERAGENT, $agent);\n    curl_setopt($ch, CURLOPT_RETURNTRANSFER, 1);\n    curl_setopt($ch, CURLOPT_FOLLOWLOCATION, 1); \n    curl_setopt($ch, CURLOPT_COOKIEFILE, $cookie_file_path); \n    curl_setopt($ch, CURLOPT_COOKIEJAR, $cookie_file_path); \n    curl_setopt($ch, CURLOPT_URL, $url);\n    if($get)\n    {\n        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, \"GET\"); \n    }\n    else\n    {\n        curl_setopt($ch, CURLOPT_CUSTOMREQUEST, \"POST\");\n        curl_setopt($ch, CURLOPT_POST, 1);\n        if(count($fields) &gt;= 1)\n        {\n            $POSTFIELDS = http_build_query($fields);\n            curl_setopt($ch, CURLOPT_POSTFIELDS, $POSTFIELDS);\n        }\n    }\n    $result = curl_exec($ch); \n    return $result;\n}\n</code></pre>\n\n<p>may help me to work with cookie jar store?</p>\n\n<p>this not have a sample : <a href=\"https://github.com/juju/persistent-cookiejar\" rel=\"nofollow noreferrer\">https://github.com/juju/persistent-cookiejar</a></p>\n\n<p>may a person write a sample about <a href=\"https://golang.org/pkg/net/http/#CookieJar\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#CookieJar</a> ?</p>\n"}, {"tags": ["testing", "go", "revel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1495036389, "post_id": 44029345, "comment_id": 75085707, "body": "Unit tests must be in the same package, which means the same directory. You can only do blackbox testing from a separate directory."}, {"owner": {"reputation": 898, "user_id": 1890157, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/e3Ivi.png?s=128&g=1", "display_name": "Camway", "link": "https://stackoverflow.com/users/1890157/camway"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1495036727, "post_id": 44029345, "comment_id": 75085929, "body": "That&#39;s what I was afraid of, thanks for the info."}], "answers": [{"comments": [{"owner": {"reputation": 898, "user_id": 1890157, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/e3Ivi.png?s=128&g=1", "display_name": "Camway", "link": "https://stackoverflow.com/users/1890157/camway"}, "edited": false, "score": 0, "creation_date": 1495037717, "post_id": 44029855, "comment_id": 75086565, "body": "How does this work inside revel. Right now all of the tests are attached to the AppTest e.g. <code>func (t *AppTest) TestMethodName(){}</code>."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "reply_to_user": {"reputation": 898, "user_id": 1890157, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/e3Ivi.png?s=128&g=1", "display_name": "Camway", "link": "https://stackoverflow.com/users/1890157/camway"}, "edited": false, "score": 0, "creation_date": 1495038282, "post_id": 44029855, "comment_id": 75086901, "body": "Sorry, I thought you meant running via <code>go test</code> on the command line (that&#39;s where the <code>...</code> thing works, I guess the <code>revel</code> cli also supports it?). If you&#39;re only using revel style tests, it runs things in a non-standard way, so you&#39;ll basically have to instantiate <a href=\"https://godoc.org/github.com/revel/revel/testing#TestSuite\" rel=\"nofollow noreferrer\"><code>revel&#47;testing.TestSuite</code></a> and invoke the methods on that, but the same logic applies - tests are just functions and you can make them reuse each other."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "reply_to_user": {"reputation": 898, "user_id": 1890157, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/e3Ivi.png?s=128&g=1", "display_name": "Camway", "link": "https://stackoverflow.com/users/1890157/camway"}, "edited": false, "score": 0, "creation_date": 1495038439, "post_id": 44029855, "comment_id": 75086997, "body": "Correction initialize the embedded <code>TestSuite</code> inside of <code>AppTest</code>, and invoke the methods on <code>AppTest</code>, obviously"}, {"owner": {"reputation": 898, "user_id": 1890157, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/e3Ivi.png?s=128&g=1", "display_name": "Camway", "link": "https://stackoverflow.com/users/1890157/camway"}, "edited": false, "score": 0, "creation_date": 1495039897, "post_id": 44029855, "comment_id": 75087798, "body": "Can you adjust your above code to suit it, I&#39;m either getting circular imports or undefined &#39;AppTest&#39; when I run it."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "reply_to_user": {"reputation": 898, "user_id": 1890157, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/e3Ivi.png?s=128&g=1", "display_name": "Camway", "link": "https://stackoverflow.com/users/1890157/camway"}, "edited": false, "score": 0, "creation_date": 1495041823, "post_id": 44029855, "comment_id": 75088977, "body": "Well, my example was simply meant to show that you can call code that behaves as tests even if it&#39;s not in a test file, so depending on how you structure your code...  Revel itself uses <a href=\"https://github.com/revel/modules/blob/master/testrunner/app/controllers/testrunner.go#L96\" rel=\"nofollow noreferrer\">reflection</a> to invoke individual test methods by name. You can use this approach to invoke tests from other tests. But my suggestion was meant more generally: structure your test code so that you can call it arbitrarily, instead of trying to get it called by some mechanism that is a black box (<code>go test</code> or revel)"}], "tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1495037082, "creation_date": 1495037082, "answer_id": 44029855, "question_id": 44029345, "link": "https://stackoverflow.com/questions/44029345/organizing-revel-tests-into-sub-packages/44029855#44029855", "title": "Organizing revel tests into sub packages", "body": "<p>You can move the tests themselves into an importable package (i.e. not in a <code>_test.go</code> file), and then use them twice. The <code>_test.go</code> files in the subdirectories can be something like:</p>\n\n<pre><code>package subdir_test\n\nimport \"github.com/blah/project/parent/subdir/tests\"\n\nfunc TestPackage(t *testing.T) {\n    tests.Run(t)\n}\n</code></pre>\n\n<p>Using <a href=\"https://golang.org/pkg/testing/#hdr-Subtests_and_Sub_benchmarks\" rel=\"nofollow noreferrer\"><code>TB.Run</code></a> you can make things play nice with <code>go test</code> command line arguments:</p>\n\n<pre><code>package tests // subdir\n\nimport \"testing\"\n\nfunc Run(t *testing.T) {\n    for _, test := range testCases { // or whatever\n        test.Run(t)\n    }\n}\n</code></pre>\n\n<p>And of course parent directories can just call their child directories' <code>Run</code> methods:</p>\n\n<pre><code>package parent_test\n\nimport (\n    \"testing\"\n    p \"github.com/blah/project/parent/tests\"\n    s \"github.com/blah/project/parent/subdir/tests\"\n)\n\nfunc TestPackage(t *testing.T) {\n    p.Run(t)\n}\n\nfunc TestSubPackages(t *testing.T) {\n    s.Run(t)\n}\n</code></pre>\n\n<p>I would recommend avoiding variants of <code>go list ./...</code> etc as lots of the tooling is not really prepared to handled that gracefully (for example running that with coverage does not produce a single combined report, complicating things for large projects, and it also lists vendored code which might not always make sense)</p>\n"}], "owner": {"reputation": 898, "user_id": 1890157, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/e3Ivi.png?s=128&g=1", "display_name": "Camway", "link": "https://stackoverflow.com/users/1890157/camway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 274, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495037082, "creation_date": 1495035649, "question_id": 44029345, "link": "https://stackoverflow.com/questions/44029345/organizing-revel-tests-into-sub-packages", "title": "Organizing revel tests into sub packages", "body": "<p>We are currently working with a revel project, and the number of tests are already getting out of hand. I'm wanting to create a few packages under the <code>tests</code> directory to separate out controller tests from model tests and so on (e.g. <code>tests/controllers/</code>, <code>tests/models/</code>, etc).</p>\n\n<p>When I do this the revel test command stops seeing these files.</p>\n\n<p>I found a recommendation online to trail my test command with <code>...</code>, but when I do this I get an error saying it failed to import my project.</p>\n\n<p>Is this possible to do, or do all test files have to be within the <code>tests</code> directory? If it's possible, how do you run the tests in the sub-packages?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 5721095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxwZ1.jpg?s=128&g=1", "display_name": "comebacknader", "link": "https://stackoverflow.com/users/5721095/comebacknader"}, "edited": false, "score": 0, "creation_date": 1495034769, "post_id": 44028680, "comment_id": 75084494, "body": "Using executeTemplate() in my post handler just renders a blank page, not the template. I&#39;ve edited my question with the code to clarify."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 43, "user_id": 5721095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxwZ1.jpg?s=128&g=1", "display_name": "comebacknader", "link": "https://stackoverflow.com/users/5721095/comebacknader"}, "edited": false, "score": 0, "creation_date": 1495034923, "post_id": 44028680, "comment_id": 75084618, "body": "ExecuteTemplate returns an error and you&#39;re not checking it - that would be my first step, see what&#39;s happening when you execute the template."}, {"owner": {"reputation": 43, "user_id": 5721095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxwZ1.jpg?s=128&g=1", "display_name": "comebacknader", "link": "https://stackoverflow.com/users/5721095/comebacknader"}, "edited": false, "score": 0, "creation_date": 1495036035, "post_id": 44028680, "comment_id": 75085419, "body": "Ahhhh! it was a little spelling error! I did what you said, checked the error, and found the problem. YOU ROCK. thank you!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1495033759, "creation_date": 1495033759, "answer_id": 44028680, "question_id": 44028578, "link": "https://stackoverflow.com/questions/44028578/render-a-template-upon-failed-post-request-golang/44028680#44028680", "title": "Render a template upon failed POST request [golang]", "body": "<p>The answer is in the question:</p>\n\n<blockquote>\n  <p>Is there a way to executeTemplate() and re-render the html page with the form?</p>\n</blockquote>\n\n<p>Yes, use <code>executeTemplate</code> to re-render the form. <code>http.Error()</code> is for returning HTTP errors, not form validation errors. If the form fails validation and you want to redisplay it, do just that - render the form out to the browser again, with whatever validation errors/prepopulation/whatever you want to display.</p>\n"}], "owner": {"reputation": 43, "user_id": 5721095, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dxwZ1.jpg?s=128&g=1", "display_name": "comebacknader", "link": "https://stackoverflow.com/users/5721095/comebacknader"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "accepted_answer_id": 44028680, "answer_count": 1, "score": 0, "last_activity_date": 1495034696, "creation_date": 1495033522, "last_edit_date": 1495034696, "question_id": 44028578, "link": "https://stackoverflow.com/questions/44028578/render-a-template-upon-failed-post-request-golang", "title": "Render a template upon failed POST request [golang]", "body": "<p>I want to handle the errors of a POST request and re-render the form with the errors displayed above it, but the only solution to handling errors I see is http.Error() but this returns a plaintext response, not an HTML page. Is there a way to executeTemplate() and re-render the html page with the form? Am I supposed to redirect the user to the same page? If so, how do I pass the error information to that redirected page? </p>\n\n<p>Edit: So, when I use this code, and try to executeTemplate, the Post request returns a 200 status code (which is wrong) and it re-renders blank page, not the template I specified. </p>\n\n<pre><code>func PostSignup(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\nif r.Method != http.MethodPost {\n    http.Error(w, http.StatusText(405), http.StatusMethodNotAllowed)\n    return\n}\n\nusr := users.User{}\nusr.Username = r.FormValue(\"username\")\nusr.Email = r.FormValue(\"email\")\nusr.Hash = r.FormValue(\"password\")\n\nerrors := CredErrors{}\nerrors.Error = \"Username cannot be blank\"\nif usr.Username == \"\" {\n    // http.Error(w, \"Username cannot be blank.\", 400)\n    tpl.ExecuteTemplate(w, \"signup.gothml\", errors)\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "xml-parsing", "request", "buffer", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1495036241, "post_id": 44028438, "comment_id": 75085596, "body": "An http.ResponseWriter is only valid during the life of the request. There&#39;s no reason for an async callback pattern like this in Go."}], "answers": [{"comments": [{"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1495096533, "post_id": 44029522, "comment_id": 75111036, "body": "Hi @nothingmuch. Thanks for your answer. Let me explain a little better. The thing is that I don&#180;t make multiple request... I only make one request and the other server sends me many xml responses (please, look at what I have edited in the body of the question about how the server responses), in this way I need the callback function to be called once for each xml. If I use <code>callback(message_aux)</code> instead <code>go callback(message_aux)</code> it works."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "reply_to_user": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1495195665, "post_id": 44029522, "comment_id": 75163244, "body": "It doesn&#39;t change anything as far as I can tell, in both cases you&#39;ll need to wait at the end of <code>RequestAsynch</code>, and wait until all the goroutines you started have finished. You can do this by using a <code>sync.WaitGroup</code>, or by having them send their results over a channel instead of using the response writer directly, but the fact remains that you cannot use the response writer after the HTTP handler returns"}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1495444239, "post_id": 44029522, "comment_id": 75237235, "body": "Hi again @nothingmuch. And... why does it work if I remove this line: ` _, err := xmlpath.Parse( reader )` in the callBackFunction?? Thanks."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "reply_to_user": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "edited": false, "score": 0, "creation_date": 1495455644, "post_id": 44029522, "comment_id": 75244697, "body": "Probably because then the goro is executed quickly enough to write h the output before it&#39;s flushed to the client. This is a kind of race condition."}], "tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1495036146, "creation_date": 1495036146, "answer_id": 44029522, "question_id": 44028438, "link": "https://stackoverflow.com/questions/44028438/invalid-memory-address-using-gorutine-golang/44029522#44029522", "title": "Invalid memory address using gorutine (golang)", "body": "<p>According to your stack trace, it appears the problem is that the HTTP response is being written out as soon as the parent function returns, by the time the new goroutine gets a chance to try, the writer is no longer usable.</p>\n\n<p>This is part of the design of <code>net/http</code>, so I suspect your <code>RequestAsynch</code> can't be written as it was intended. Why does it need to be asynchronous? Each request is already handled in its own goroutine.</p>\n\n<p>BTW, <code>strings.NewReader</code> is probably more appropriate than <code>bytes.NewBufferString</code>, since you don't need the full buffer interface.</p>\n"}], "owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 828, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495096659, "creation_date": 1495033177, "last_edit_date": 1495096659, "question_id": 44028438, "link": "https://stackoverflow.com/questions/44028438/invalid-memory-address-using-gorutine-golang", "title": "Invalid memory address using gorutine (golang)", "body": "<p>I am working with a code that works only if I make it run as a blocking routine... but if I use <code>go executeTheFunction</code> I always get <code>panic: runtime error: invalid memory address or nil pointer dereference</code>. To summarize the code a little would be something like that.</p>\n\n<pre><code>func (c App) Index() revel.Result {\n    app = c; //this is a \"global\" variable to be used in callBackFunction \n    options = \"foo\";\n    client  = NewClient()\n    client.RequestAsynch(options, callBackFunction);\n}\nfunc callBackFunction(message string){\n    reader := bytes.NewBufferString(message)\n    _, err := xmlpath.Parse( reader )\n    if err != nil {\n        panic(err)\n    }\n    flusher, ok := airshopping.Response.Out.(http.Flusher)\n    if !ok {\n      panic(\"expected http.ResponseWriter to be an http.Flusher\")\n    }\n\n    fmt.Fprintf(airshopping.Response.Out, \"whatever\")\n    flusher.Flush()\n}\n\nfunc (client * Client)RequestAsynch(message Message, callback func(string)) {\n    Response := client.Request(message)\n\n    message_aux := \"\"\n    reader := bufio.NewReader(Response.Body)\n    for {\n        line, err := reader.ReadBytes('\\n')\n        if err==nil {\n            message_aux = message_aux + string(line)\n            if strings.Contains(message_aux, \"&lt;!-- AG-EOM --&gt;\"){\n                go callback(message_aux)\n                message_aux = \"\"\n            }\n        }else{fmt.Println(\"ERROR\", err);break;}\n    }\n}\n</code></pre>\n\n<p>Ok... I am going to explain a little. The <code>RequestAsynch</code> is in a different package and what it launchs a request to other server. This other server reponse with multiple xml... the body of these xml looks like:</p>\n\n<pre><code>&lt;!-- Header status:ok --&gt;\n&lt;all_the_xml_response&gt;\n&lt;!-- AG-EOM --&gt;\n</code></pre>\n\n<p>So... when the line by line loop detect this <code>\"&lt;!-- AG-EOM --&gt;\"</code> is that one of the xml is completely received, and the callBack functions should be executed (with a gorutine). The mission of this callBack function is parse the xml and, after a process of parsing, send some data back to the javascript in the client side.</p>\n\n<p>The error I am always getting is this:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x20 pc=0x4f8c09]\n\ngoroutine 80 [running]:\nbufio.(*Writer).Write(0xc042454540, 0xc0422d4000, 0x11076, 0x12000, 0xc04202fb30, 0x4683b7, 0x11076)\n    C:/Go/src/bufio/bufio.go:598 +0x149\nnet/http.(*response).write(0xc04234d0a0, 0x11076, 0xc0422d4000, 0x11076, 0x12000, 0x0, 0x0, 0xc0422d4000, 0x0, 0x0)\n    C:/Go/src/net/http/server.go:1525 +0x157\nnet/http.(*response).Write(0xc04234d0a0, 0xc0422d4000, 0x11076, 0x12000, 0x0, 0x0, 0xc042824000)\n    C:/Go/src/net/http/server.go:1495 +0x6b\nfmt.Fprintf(0xb65e80, 0xc04234d0a0, 0xc042824000, 0x11076, 0x0, 0x0, 0x0, 0xc0421445f0, 0xb, 0xc0422f5e00)\n    C:/Go/src/fmt/print.go:182 +0xb0\nndc-console-test/app/controllers/ndcmethods.GetOffers_AS(0xc042594000, 0xef7f)\n    F:/Proyectos_Trabajo/work/src/ndc-console-    test/app/controllers/ndcmethods/airshopping.go:98 +0x7a1\ncreated by github.com/open-ndc/ndc-go-sdk.(*Client).RequestAsynch\n    F:/Proyectos_Trabajo/work/src/github.com/open-ndc/ndc-go-sdk/ndc_client.go:143 +0x25c\n2017/05/17 16:42:56 reverseproxy.go:316: http: proxy error: dial tcp [::1]:55058: connectex:A connection can not be established because the target computer expressly denied the connection.\n</code></pre>\n\n<p>And after this error... I need to restart the server, because it doesn\u00b4t allow make a new connection.  </p>\n\n<p>One of the things I saw, is that if I remove this line <code>_, err := xmlpath.Parse( reader )</code> in the callBackFunction it works fine. And of course if I change this line: <code>go callback(message_aux)</code> for <code>callback(message_aux)</code> (without the goroutine) it works fine too and it has no problem to parse the xml.  </p>\n\n<p>Does anyone know a solution about how to avoid this error using goroutines??</p>\n\n<p>Thank you very much.</p>\n\n<h2>EDIT</h2>\n\n<p>I think I did not express myself well with how the other server responds, this is how looks the (multiple) responses:</p>\n\n<pre><code>&lt;!-- Header status:ok --&gt;\n&lt;the_xml_response_of_one_response_or_one_chunk&gt;\n&lt;!-- AG-EOM --&gt;\n&lt;!-- Header status:ok --&gt;\n&lt;other_xml_response&gt;\n&lt;!-- AG-EOM --&gt;\n&lt;!-- Header status:ok --&gt;\n&lt;other_more_xml_response&gt;\n&lt;!-- AG-EOM --&gt;\n</code></pre>\n"}, {"tags": ["go", "dependency-management", "package-managers"], "answers": [{"tags": [], "owner": {"reputation": 100, "user_id": 6327558, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/01b8925872d8f56bb13b030a977d298e?s=128&d=identicon&r=PG&f=1", "display_name": "zhexuany", "link": "https://stackoverflow.com/users/6327558/zhexuany"}, "is_accepted": true, "score": 2, "last_activity_date": 1495503980, "creation_date": 1495503980, "answer_id": 44124516, "question_id": 44028337, "link": "https://stackoverflow.com/questions/44028337/what-are-the-major-differences-between-glide-and-godep/44124516#44124516", "title": "What are the major differences between glide and godep?", "body": "<p><code>glide</code> will download and store it at a directory name <code>vendor</code>. Godep simply <code>go get</code> dependencies and checkout to the commit you specify in <code>GoDep</code> file. I recommend <code>glide</code>. It has more flexibility. </p>\n"}], "owner": {"reputation": 1550, "user_id": 3281900, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/100000487316008/picture?type=large", "display_name": "Pig", "link": "https://stackoverflow.com/users/3281900/pig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 913, "favorite_count": 0, "accepted_answer_id": 44124516, "answer_count": 1, "score": 3, "last_activity_date": 1495503980, "creation_date": 1495032884, "question_id": 44028337, "link": "https://stackoverflow.com/questions/44028337/what-are-the-major-differences-between-glide-and-godep", "title": "What are the major differences between glide and godep?", "body": "<p>I have been trying out godep and find it quite useful. However many people have suggested Glide instead, which seems more or less the same to me. Therefore I am wondering the differences between the two.</p>\n"}, {"tags": ["string", "go", "struct", "interface", "slice"], "answers": [{"comments": [{"owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "edited": false, "score": 0, "creation_date": 1495038139, "post_id": 44027953, "comment_id": 75086807, "body": "Thanks; didn&#39;t thought about using fmt.Sprint. Working fine now!"}, {"owner": {"reputation": 637, "user_id": 1349484, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b9b085cc296dae832e8d4ec2020c2d91?s=128&d=identicon&r=PG", "display_name": "Alireza Soori", "link": "https://stackoverflow.com/users/1349484/alireza-soori"}, "edited": false, "score": 1, "creation_date": 1576567666, "post_id": 44027953, "comment_id": 104931675, "body": "wow, this helped me so much... but still I hope for a more robust way with assertion"}, {"owner": {"reputation": 744, "user_id": 1392953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/111f7728dfee50bdca97cb8dcf195e9f?s=128&d=identicon&r=PG", "display_name": "Eric Lindsey", "link": "https://stackoverflow.com/users/1392953/eric-lindsey"}, "reply_to_user": {"reputation": 637, "user_id": 1349484, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/b9b085cc296dae832e8d4ec2020c2d91?s=128&d=identicon&r=PG", "display_name": "Alireza Soori", "link": "https://stackoverflow.com/users/1349484/alireza-soori"}, "edited": false, "score": 2, "creation_date": 1577523698, "post_id": 44027953, "comment_id": 105191104, "body": "@AlirezaSoori you can have this with type assertion: just change <code>fmt.Sprint(v)</code> with <code>v.(string)</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 28, "last_activity_date": 1495031931, "last_edit_date": 1495540039, "creation_date": 1495031931, "answer_id": 44027953, "question_id": 44027826, "link": "https://stackoverflow.com/questions/44027826/convert-interface-to-string-in-golang/44027953#44027953", "title": "Convert []interface to []string in Golang", "body": "<p>You can't simply convert <code>[]interface{}</code> to <code>[]string</code> even if all the values are of concrete type <code>string</code>, because those 2 types have different memory layout / representation. For details see <a href=\"https://stackoverflow.com/questions/12990338/cannot-convert-string-to-interface\">Cannot convert []string to []interface {}</a>.</p>\n\n<p>You have to define how you want values of different types to be represented by <code>string</code> values.</p>\n\n<p>The easiest and sensible way would be to iterate over the values, and use <a href=\"https://golang.org/pkg/fmt/#Sprint\" rel=\"noreferrer\"><code>fmt.Sprint()</code></a> to obtain a <code>string</code> representation of each, e.g.:</p>\n\n<pre><code>t := []interface{}{\n    \"zero\",\n    1, 2.0, 3.14,\n    []int{4, 5},\n    struct{ X, Y int }{6, 7},\n}\nfmt.Println(t)\n\ns := make([]string, len(t))\nfor i, v := range t {\n    s[i] = fmt.Sprint(v)\n}\nfmt.Println(s)\nfmt.Printf(\"%q\\n\", s)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/NP36eHPvHf\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[zero 1 2 3.14 [4 5] {6 7}]\n[zero 1 2 3.14 [4 5] {6 7}]\n[\"zero\" \"1\" \"2\" \"3.14\" \"[4 5]\" \"{6 7}\"]\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17512, "favorite_count": 4, "accepted_answer_id": 44027953, "answer_count": 1, "score": 18, "last_activity_date": 1495033530, "creation_date": 1495031607, "last_edit_date": 1495033530, "question_id": 44027826, "link": "https://stackoverflow.com/questions/44027826/convert-interface-to-string-in-golang", "title": "Convert []interface to []string in Golang", "body": "<p>I'm using the <a href=\"http://github.com/fatih/structs\" rel=\"noreferrer\">github.com/fatih/structs</a> package to convert values of all fields of a struct into <code>[]interface{}</code> with the <code>toValues()</code> function. See <a href=\"https://github.com/fatih/structs/blob/master/structs.go#L174\" rel=\"noreferrer\">here</a>. This works fine, but eventually I want to write the values to a csv file by using the csv package. The <code>csv.Write()</code> function requires <code>[]string</code> as input.</p>\n\n<p>So in short: how can I easily convert the output of <code>toValues()</code> into an array of strings?</p>\n"}, {"tags": ["arrays", "string", "go", "random"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 3, "creation_date": 1495029307, "post_id": 44026823, "comment_id": 75080161, "body": "<a href=\"http://stackoverflow.com/questions/12264789/shuffle-array-in-go\">stackoverflow.com/questions/12264789/shuffle-array-in-go</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1495029408, "post_id": 44026823, "comment_id": 75080233, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/43157290/randomize-order-of-a-mongodb-query-in-go/43166390#43166390\">Randomize order of a MongoDB query in Go</a>."}, {"owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "edited": false, "score": 0, "creation_date": 1495031462, "post_id": 44026823, "comment_id": 75081885, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/12264789/shuffle-array-in-go\">shuffle array in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 67, "user_id": 7986350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18717c456821a90015a6cf613c92063f?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Topaz", "link": "https://stackoverflow.com/users/7986350/dr-topaz"}, "edited": false, "score": 0, "creation_date": 1495117395, "post_id": 44027777, "comment_id": 75126234, "body": "I thought about using your first example and it doesn&#39;t work.Everytime i run the code ,it always says Left 4 Dead. PS ( i changed the value of rand.Intn(10) to rand.Intn(9) as arrays begin at 0."}, {"owner": {"reputation": 309, "user_id": 4546150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzJYT.jpg?s=128&g=1", "display_name": "denis.lobanov", "link": "https://stackoverflow.com/users/4546150/denis-lobanov"}, "reply_to_user": {"reputation": 67, "user_id": 7986350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18717c456821a90015a6cf613c92063f?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Topaz", "link": "https://stackoverflow.com/users/7986350/dr-topaz"}, "edited": false, "score": 1, "creation_date": 1495117715, "post_id": 44027777, "comment_id": 75126483, "body": "Did you call something like <code>rand.Seed(time.Now().UTC().UnixNano())</code> before <code>rand.Intn()</code>? Otherwise it will always generate the same number: 5"}, {"owner": {"reputation": 67, "user_id": 7986350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18717c456821a90015a6cf613c92063f?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Topaz", "link": "https://stackoverflow.com/users/7986350/dr-topaz"}, "edited": false, "score": 0, "creation_date": 1495118390, "post_id": 44027777, "comment_id": 75127005, "body": "whoaaa whoa whoa whoa ; i added it just now and it works :-) ,thanks man"}, {"owner": {"reputation": 67, "user_id": 7986350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18717c456821a90015a6cf613c92063f?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Topaz", "link": "https://stackoverflow.com/users/7986350/dr-topaz"}, "edited": false, "score": 0, "creation_date": 1495118451, "post_id": 44027777, "comment_id": 75127051, "body": "can you please explain why is it neccesary to add it before rand.Intn()"}, {"owner": {"reputation": 67, "user_id": 7986350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18717c456821a90015a6cf613c92063f?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Topaz", "link": "https://stackoverflow.com/users/7986350/dr-topaz"}, "edited": false, "score": 0, "creation_date": 1495119193, "post_id": 44027777, "comment_id": 75127650, "body": "so i tried to implement it to my real code(the user defined) and it works to man,it shuffles the strings.Thanks @denis.lobanov"}, {"owner": {"reputation": 309, "user_id": 4546150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzJYT.jpg?s=128&g=1", "display_name": "denis.lobanov", "link": "https://stackoverflow.com/users/4546150/denis-lobanov"}, "reply_to_user": {"reputation": 67, "user_id": 7986350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18717c456821a90015a6cf613c92063f?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Topaz", "link": "https://stackoverflow.com/users/7986350/dr-topaz"}, "edited": false, "score": 1, "creation_date": 1495127349, "post_id": 44027777, "comment_id": 75132897, "body": "<code>rand</code> is a  <b>pseudo</b> random number generator - given a starting number an algorithm will generate other numbers which appear random (hard to guess the next one). Because its an algorithm, if you start on the same number (seed), the next will always be the same. So you need to seed it before first use"}], "tags": [], "owner": {"reputation": 309, "user_id": 4546150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzJYT.jpg?s=128&g=1", "display_name": "denis.lobanov", "link": "https://stackoverflow.com/users/4546150/denis-lobanov"}, "is_accepted": true, "score": 0, "last_activity_date": 1495127362, "last_edit_date": 1495127362, "creation_date": 1495031498, "answer_id": 44027777, "question_id": 44026823, "link": "https://stackoverflow.com/questions/44026823/how-to-shuffle-strings-in-arrays-in-golang/44027777#44027777", "title": "How to shuffle strings in arrays in golang?", "body": "<p>Well, literally for your problem why not use <code>rand.Intn()</code> to choose a random number and print the game rather than make the user pick a number?</p>\n\n<pre><code>isArray := [10]string{\"Paladins\", \"Overwatch\", \"CS:GO\", \"Tanki\", \"Left 4 Dead\", \"Rocket League\", \"Call Of Duty : AW\", \"Portal\", \"Star Citizen\", \"Star Wars : Battlefront\"}\nn := rand.Intn(9)\nfmt.Printf(\"You Should Play : %s\\n\", isArray[n])\n</code></pre>\n\n<p>But if you want to shuffle strings in an array for the sake of it, then you can do it in place like this:</p>\n\n<pre><code>// Shuffle array in place\nl := len(isArray)-1\nfor i := 0; i &lt;=l; i++ {\n    n := rand.Intn(l)\n    // swap\n    x := isArray[i]\n    isArray[i] = isArray[n]\n    isArray[n] = x\n}\n</code></pre>\n\n<p>This should be O(n), though I'm not sure about the complexity of <code>Intn</code>. If you really want to be fancy, you could:</p>\n\n<ol>\n<li>Create a second array (<code>randomArray</code>) of touples, containing a random number and element position in <code>isArray</code>. </li>\n<li>Sort this array by the random number</li>\n<li>Create a new array, copying elements of <code>isArray</code>, but ordered by our <code>randomArray</code></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 1550, "user_id": 3913060, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c6bbcd80e31e89efcac616ba0cf841a4?s=128&d=identicon&r=PG&f=1", "display_name": "Mallory-Erik", "link": "https://stackoverflow.com/users/3913060/mallory-erik"}, "edited": false, "score": 0, "creation_date": 1520741778, "post_id": 46114302, "comment_id": 85437163, "body": "A tidbit, <code>UnixNano</code> returns a UTC time value so there&#39;s actually no need for <code>.UTC()</code> in the seed."}], "tags": [], "owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "is_accepted": false, "score": 2, "last_activity_date": 1504866253, "creation_date": 1504866253, "answer_id": 46114302, "question_id": 44026823, "link": "https://stackoverflow.com/questions/44026823/how-to-shuffle-strings-in-arrays-in-golang/46114302#46114302", "title": "How to shuffle strings in arrays in golang?", "body": "<pre><code> package main\n\n import (\n         \"fmt\"\n         \"math/rand\"\n         \"time\"\n )\n\n func shuffle(src []string) []string {\n         final := make([]string, len(src))\n         rand.Seed(time.Now().UTC().UnixNano())\n         perm := rand.Perm(len(src))\n\n         for i, v := range perm {\n                 final[v] = src[i]\n         }\n         return final\n }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3548, "user_id": 7742981, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b3ec6d8d493c843316a3435ce02b5b6?s=128&d=identicon&r=PG&f=1", "display_name": "Simon.S.A.", "link": "https://stackoverflow.com/users/7742981/simon-s-a"}, "edited": false, "score": 0, "creation_date": 1544385491, "post_id": 53695608, "comment_id": 94247580, "body": "Welcome to stackoverflow. Please fully explain your answer. Just posting code does not help other users understand your answer."}], "tags": [], "owner": {"reputation": 1, "user_id": 10767771, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MA5G27OB4X8/AAAAAAAAAAI/AAAAAAAAABM/22IYgNzB8Ls/photo.jpg?sz=128", "display_name": "Sathish Kumar Pothuri", "link": "https://stackoverflow.com/users/10767771/sathish-kumar-pothuri"}, "is_accepted": false, "score": 0, "last_activity_date": 1544381613, "creation_date": 1544381613, "answer_id": 53695608, "question_id": 44026823, "link": "https://stackoverflow.com/questions/44026823/how-to-shuffle-strings-in-arrays-in-golang/53695608#53695608", "title": "How to shuffle strings in arrays in golang?", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\ntype list []string\n\nfunc main() {\n\n    s := list{\n        \"Tanki\",\n        \"Left 4 Dead\",\n        \"Rocket League\",\n        \"Call Of Duty : AW\",\n    }\n    s.shuffle()\n    s.print()\n}\n\nfunc (l list) print() {\n    for i, v := range l {\n        fmt.Println(i, v)\n    }\n}\n\nfunc (l list) shuffle() list {\n    src := rand.NewSource(time.Now().UnixNano())\n    r := rand.New(src)\n    for i := range l {\n        n := r.Intn(len(l) - 1)\n        l[i], l[n] = l[n], l[i]\n    }\n    return l\n}\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 7986350, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/18717c456821a90015a6cf613c92063f?s=128&d=identicon&r=PG&f=1", "display_name": "Dr.Topaz", "link": "https://stackoverflow.com/users/7986350/dr-topaz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2379, "favorite_count": 0, "accepted_answer_id": 44027777, "answer_count": 3, "score": 2, "last_activity_date": 1544381613, "creation_date": 1495029038, "last_edit_date": 1495029367, "question_id": 44026823, "link": "https://stackoverflow.com/questions/44026823/how-to-shuffle-strings-in-arrays-in-golang", "title": "How to shuffle strings in arrays in golang?", "body": "<p>So I created a program to help me decide which game to play. Before I start my problem let me show you my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"time\"\n)\n\nfunc main() {\n    isArray := [10]string{\"Paladins\", \"Overwatch\", \"CS:GO\", \"Tanki\", \"Left 4 Dead\", \"Rocket League\", \"Call Of Duty : AW\", \"Portal\", \"Star Citizen\", \"Star Wars : Battlefront\"}\n    fmt.Print(\"0,1,2,3,4,5,6,7,8,9 := \")\n\n    var (\n        va string\n        ar string\n    )\n\n    fmt.Scanln(&amp;va)\n    i, _ := strconv.Atoi(va)\n\n    fmt.Print(\"You Should Play : \")\n    fmt.Print(isArray[i], \"\\n\")\n    fmt.Print(\"[Y/N] := \")\n    fmt.Scanln(&amp;ar)\n\n    if ar != \"N\" || ar != \"n\" {\n        fmt.Print(\"OK\")\n    }\n\n    time.Sleep(3 * time.Second)\n}\n</code></pre>\n\n<p>So the problems start when I already know which number would trigger a game, if I use it twice. So I am trying to make the strings random, like shuffling each time I use it, how can I do that?</p>\n"}, {"tags": ["go", "caddy"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1495022982, "post_id": 44022741, "comment_id": 75075141, "body": "&quot;I want to make some changes to the Go crypto/tls standard library.&quot; I hope you don&#39;t."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 1, "creation_date": 1495025412, "post_id": 44022741, "comment_id": 75076985, "body": "You will not be able to get the types to match for all code that uses the built in <code>crypto&#47;tls</code>, because as far as Go is concerned, it&#39;s a different package. This might work if you also vendor caddy. If you really need to modify <code>crypto&#47;tls</code> (I also hope you don&#39;t), i think it would be simpler to handle this by e.g. building a container with a patched version of go (I guess you could call that vendoring the standard library?)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1495029164, "post_id": 44022741, "comment_id": 75080030, "body": "It&#39;s going to be all-or-nothing - if you want to use a modified version of stdlib (any part of it), you must fork Go; that&#39;s what makes it the <i>standard</i> library. Also a third vote for not modifying crypto/tls."}], "answers": [{"tags": [], "owner": {"reputation": 407, "user_id": 1095292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/380f81966ae6c98bd3eb0c87ecf17948?s=128&d=identicon&r=PG", "display_name": "Petar Donchev", "link": "https://stackoverflow.com/users/1095292/petar-donchev"}, "is_accepted": false, "score": 0, "last_activity_date": 1495098958, "last_edit_date": 1495098958, "creation_date": 1495090303, "answer_id": 44040567, "question_id": 44022741, "link": "https://stackoverflow.com/questions/44022741/vendoring-a-standard-library-crypto-tls/44040567#44040567", "title": "Vendoring a standard library (crypto/tls)", "body": "<p>I actually had to do that. The most practical way is to copy and modify the package (as well as its internal dependencies) - this includes some import paths. And it is not really vendored (vendoring is basically using unmodified packages, otherwise vendoring tools will not work), it is a fork, under a different name. I would guess that caddy does not need the modified version - if it does, you need to fork and modify caddy as well.</p>\n\n<p>It goes without saying, but be extremely careful when modifying crypto/tls package - I for example has to make a minimal change that does not really modify TLS operation (I needed to be able to derive key material from the session master secret and randoms).</p>\n\n<p>Also, you have to fully realize that this has significant cost - when a new version of go is out, one that potentially has updates for the crypto/tls package or its dependencies, you will have to apply your changes once again, manually. Committing a diff between the vanilla version and your version helps. I don't think this is at all practical for non-trivial changes (mine were quite limited - a new public field in Config, few lines of code in handshakes, a new interface).</p>\n"}], "owner": {"reputation": 129, "user_id": 3340499, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a7e043fa179ec7689e0998fd2a11350?s=128&d=identicon&r=PG&f=1", "display_name": "user3340499", "link": "https://stackoverflow.com/users/3340499/user3340499"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 265, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1495098958, "creation_date": 1495018191, "last_edit_date": 1495021460, "question_id": 44022741, "link": "https://stackoverflow.com/questions/44022741/vendoring-a-standard-library-crypto-tls", "title": "Vendoring a standard library (crypto/tls)", "body": "<p>I want to make some changes to the Go crypto/tls standard library.</p>\n\n<p>Is making a copy of crypto/tls in the vendor folder a good way to do this?</p>\n\n<p>It almost works, it seems the vendored is copy used when I compile the application (Caddy webserver). Apart from one error I get:</p>\n\n<blockquote>\n  <p>go/src/github.com/user/caddy/caddytls/httphandler.go:40: cannot use \"vendor/crypto/tls\".Config literal (type *\"vendor/crypto/tls\".Config) as type *\"crypto/tls\".Config in field value</p>\n</blockquote>\n\n<p>Is there a way of casting to get around this one error? Doesn't sound like good practice to me though.</p>\n\n<p>I would have thought that the vendored copy would always be used, but it seems something is still using the standard crypto/tls library? (I think \"net/http\" is. Do I have to vendor this too?)</p>\n"}, {"tags": ["go", "channels"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1495013777, "post_id": 44020814, "comment_id": 75068918, "body": "Select chooses one runnable case randomly. If you don&#39;t want this random selection you must not have two cases but just the one sending to rabbitQ. If this case cannot run you hit the default case and send to sqs (probably in a nested select to allow failour logging)."}], "answers": [{"tags": [], "owner": {"reputation": 347, "user_id": 641267, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/077a483beb39db9d5884ee6f012f7b6e?s=128&d=identicon&r=PG", "display_name": "JohnnyD", "link": "https://stackoverflow.com/users/641267/johnnyd"}, "is_accepted": false, "score": 1, "last_activity_date": 1495017051, "creation_date": 1495017051, "answer_id": 44022346, "question_id": 44020814, "link": "https://stackoverflow.com/questions/44020814/go-buffered-channel-falls-through-select/44022346#44022346", "title": "Go buffered channel falls through select", "body": "<p>Per Voker's comment, this is what I came up with:</p>\n\n<pre><code>func dispatchMessage(params map[string]interface{}) {\n\n    //log.Debugf(\"Failover: %t, Len: %d\", shouldFailoverToSQS, len(rabbitQ))\n\n    if !shouldFailoverToSQS {\n        select {\n        case rabbitQ &lt;- params:\n            sentToRabbitMQ++\n        default:\n            select {\n            case sqsQ &lt;- params:\n                sentToSQS++\n            default:\n                log.Error(\"Failed to dispatch mesaage to either RabbitMQ or SQS\")\n            }\n        }\n    } else {\n        select {\n        case sqsQ &lt;- params:\n            sentToSQS++\n        default:\n            log.Error(\"Failed to dispatch mesaage to either RabbitMQ or SQS\")\n        }\n    }\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": false, "score": 0, "last_activity_date": 1495028827, "creation_date": 1495028827, "answer_id": 44026740, "question_id": 44020814, "link": "https://stackoverflow.com/questions/44020814/go-buffered-channel-falls-through-select/44026740#44026740", "title": "Go buffered channel falls through select", "body": "<p>For a concise answer (it looks like you already have it from your answer + the thread comment), your select will choose at random. Per the docs:</p>\n\n<blockquote>\n  <p>If one or more of the communications can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection. Otherwise, if there is a default case, that case is chosen. If there is no default case, the \"select\" statement blocks until at least one of the communications can proceed.</p>\n</blockquote>\n\n<p>In addition, I figured I would provide you with an answer that doesn't use selects at all. Using len, you can determine how many values are queued up in a channel. Sure it's no different than what you're doing now, but I figured I would offer something different:</p>\n\n<pre><code>const MaxChan = 1000\nfunc dispatchMessage(params map[string]interface{}) {\n    if !shouldFailoverToSQS {\n        if len(rabbitQ) &lt; MaxChan {\n            sentToRabbitMQ++\n        } else if len(sqsQ) &lt; MaxChan {\n            sentToSQS++\n        } else {\n            log.Error(\"Failed to dispatch mesaage to either RabbitMQ or SQS\")\n        }\n    } else {\n        if len(sqsQ) &lt; MaxChan {\n            sentToRabbitMQ++\n        } else if len(rabbitQ) &lt; MaxChan {\n            sentToSQS++\n        } else {\n            log.Error(\"Failed to dispatch mesaage to either RabbitMQ or SQS\")\n        }\n    }\n}\n</code></pre>\n\n<p>Supporting docs:\n<a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Select_statements</a></p>\n"}, {"tags": [], "owner": {"reputation": 3609, "user_id": 3763102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2439148d94bddcda4415797c8f6afefa?s=128&d=identicon&r=PG", "display_name": "gipsy", "link": "https://stackoverflow.com/users/3763102/gipsy"}, "is_accepted": false, "score": 0, "last_activity_date": 1495029349, "creation_date": 1495029349, "answer_id": 44026948, "question_id": 44020814, "link": "https://stackoverflow.com/questions/44020814/go-buffered-channel-falls-through-select/44026948#44026948", "title": "Go buffered channel falls through select", "body": "<pre><code>func dispatchMessage(params map[string]interface{}) {\n\n    if !shouldFailoverToSQS {\n        select {\n        case rabbitQ &lt;- params:\n            sentToRabbitMQ++\n        case &lt;-time.After(time.Millisecond * 10.0): // rabbit is blocked and 10 milli sec passed.\n            select {\n            case sqsQ &lt;- params:\n                sentToSQS++  \n            default:\n            log.Error(\"Failed to dispatch mesaage to either RabbitMQ or SQS\")\n            }\n        }\n    } else {\n        sqsQ &lt;- params\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 347, "user_id": 641267, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/077a483beb39db9d5884ee6f012f7b6e?s=128&d=identicon&r=PG", "display_name": "JohnnyD", "link": "https://stackoverflow.com/users/641267/johnnyd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 263, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1495029349, "creation_date": 1495013284, "question_id": 44020814, "link": "https://stackoverflow.com/questions/44020814/go-buffered-channel-falls-through-select", "title": "Go buffered channel falls through select", "body": "<p>I have 2 buffered channels servicing inbound requests:</p>\n\n<pre><code>rabbitQ = make(chan map[string]interface{}, 1000)\nsqsQ = make (chan map[string]interface{}, 1000)\n</code></pre>\n\n<p>My dispatcher function looks like this:</p>\n\n<pre><code>func dispatchMessage(params map[string]interface{}) {\n\n    if !shouldFailoverToSQS {\n        select {\n        case rabbitQ &lt;- params:\n            sentToRabbitMQ++\n        case sqsQ &lt;- params:\n            sentToSQS++\n        default:\n            log.Error(\"Failed to dispatch mesaage to either RabbitMQ or SQS\")\n        }\n    } else {\n        sqsQ &lt;- params\n    }\n\n}\n</code></pre>\n\n<p>I would expect that messages would always be sent to rabbitQ unless the buffer was at capacity but I'm finding that the call is falling through and sending messages to sqsQ about half the time. This is not what I want - I only want to send to sqsQ if rabbitQ is full.</p>\n\n<p>How can I enforce this?</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"tags": [], "owner": {"reputation": 132, "user_id": 1429861, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4bbbc1330f01613ef097bdd742e3ed64?s=128&d=identicon&r=PG", "display_name": "Bear0x3f", "link": "https://stackoverflow.com/users/1429861/bear0x3f"}, "is_accepted": true, "score": 1, "last_activity_date": 1495096298, "creation_date": 1495096298, "answer_id": 44042537, "question_id": 44020148, "link": "https://stackoverflow.com/questions/44020148/unable-to-call-unsafe-pointerpointed-to-c-function-as-function/44042537#44042537", "title": "Unable to Call unsafe.Pointer(Pointed to C Function) as Function", "body": "<p>I can solve my problem, according to <a href=\"https://golang.org/cmd/cgo/#hdr-Go_references_to_C\" rel=\"nofollow noreferrer\">Go references to C</a>. </p>\n\n<blockquote>\n  <p>Calling C function pointers is currently not supported, however you\n  can declare Go variables which hold C function pointers and pass them\n  back and forth between Go and C. C code may call function pointers\n  received from Go.</p>\n</blockquote>\n\n<p>It's looks like I have to create a <code>bridge function</code> for call C function pointer</p>\n\n<pre><code>package main\n\n/*\nint add(int a, int b) {\n  return a+b;\n}\nint sub(int a, int b) {\n  return a-b;\n}\n\ntypedef int(*math_fp)(int, int);\n\nconst int len_operator = 2;\n\nmath_fp math_operators[2] = {\n    add, sub\n};\n\nint do_math(math_fp op, int a, int b) {\n    return op(a, b);\n}\n*/\nimport \"C\"\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var fnCnt C.int = 2\n    var i C.int\n    for i = 0; i &lt; fnCnt; i++ {\n        op := C.math_fp(C.math_operators[i])\n        fmt.Printf(\"Result: %d\\n\", C.do_math(op, 1, 2))\n    }\n}\n</code></pre>\n\n<p>Return expected result</p>\n\n<pre><code>$ go run src/test.go \nResult: 3  \nResult: -1\n</code></pre>\n"}], "owner": {"reputation": 132, "user_id": 1429861, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/4bbbc1330f01613ef097bdd742e3ed64?s=128&d=identicon&r=PG", "display_name": "Bear0x3f", "link": "https://stackoverflow.com/users/1429861/bear0x3f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 902, "favorite_count": 0, "accepted_answer_id": 44042537, "answer_count": 1, "score": 1, "last_activity_date": 1495096298, "creation_date": 1495011613, "last_edit_date": 1495020198, "question_id": 44020148, "link": "https://stackoverflow.com/questions/44020148/unable-to-call-unsafe-pointerpointed-to-c-function-as-function", "title": "Unable to Call unsafe.Pointer(Pointed to C Function) as Function", "body": "<p>I'm trying to call C function with same signature they take 2 int arguments. and this error <code>cannot call non-function f (type unsafe.Pointer)</code> appear during compile.</p>\n\n<pre><code>package main\n\n/*\nint add(int a, int b) {\n  return a+b;\n}\nint sub(int a, int b) {\n  return a-b;\n}\n*/\nimport \"C\"\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\nfunc main() {\n    a := C.int(1)\n    b := C.int(2)\n    fx := make([]unsafe.Pointer, 2)\n    fx[0] = C.add\n    fx[1] = C.sub\n    for _, f := range fx {\n        fmt.Printf(\"Result: %d\\n\", f(a, b))\n    }\n}\n</code></pre>\n\n<p>Now I'm working around with wrap C function with go function and add go function into slice instead like this</p>\n\n<pre><code>package main\n\n/*\nint add(int a, int b) {\n  return a+b;\n}\nint sub(int a, int b) {\n  return a-b;\n}\n*/\nimport \"C\"\nimport (\n    \"fmt\"\n)\n\nfunc add(a, b int) int {\n    return (int)(C.add(C.int(a), C.int(b)))\n}\n\nfunc sub(a, b int) int {\n    return (int)(C.sub(C.int(a), C.int(b)))\n}\n\nfunc main() {\n    fx := [](func(int, int) int){\n        add, sub,\n    }\n    for _, f := range fx {\n        fmt.Printf(\"Result: %d\\n\", f(1, 2))\n    }\n}\n</code></pre>\n\n<p>Is there any way to call C function from <code>unsafe.Pointer</code>, I'm using GO 1.8.1 Linux</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1495005382, "post_id": 44017927, "comment_id": 75063219, "body": "Well, Go has a nice keyword for running things concurrently, it&#39;s called <code>go</code>. I&#39;d recommend working through the Tour of Go which explains this stuff much better than any SO answer could do."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1495006198, "post_id": 44017927, "comment_id": 75063757, "body": "assuming you refer to tour.golang.org/concurrency then I think it&#39;s the first place anyone (including myself) go to.. but in my case that (as well as the online articles I&#39;ve read wasn&#39;t enough)"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1495006794, "post_id": 44017927, "comment_id": 75064126, "body": "and assuming you meant simply adding &#39;go&#39; in front of the function calls, then I&#39;m 99% sure it doesn&#39;t result in batch pull so it&#39;s still making X requests (in this case 3) instead of doing it with 1 request"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1495006985, "post_id": 44017927, "comment_id": 75064232, "body": "Uuum, what about: 1. fetch 2. store <code>req.Body</code> 3. run <code>json.NewDecoder(req.Body).Decode(target)</code> for each struct you want on the stored body"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1495007134, "post_id": 44017927, "comment_id": 75064331, "body": "I guess I don&#39;t understand because I thought that&#39;s what I do with getURLToTarget?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1495008917, "post_id": 44017927, "comment_id": 75065424, "body": "@fisker in your question you asked <code>how can I make all these http requests perform simultaneously when I run: ...</code>, @Volker&#39;s comment is spot on, prefix your function call with the <code>go</code> keyword and those 3 functions will be executed simultaneously. From your comments though, you seem to want to make only <b>1</b> HTTP request instead of <b>3</b>, which is not possible if the api to which you are making those requests doesn&#39;t provide an endpoint for batch resources."}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1495009151, "post_id": 44017927, "comment_id": 75065584, "body": "Oh okay, that makes sense.. guess I was being stupid again.. thanks a lot &lt;3"}], "answers": [{"comments": [{"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1495008127, "post_id": 44018795, "comment_id": 75064939, "body": "Maybe I&#39;m being stupid but I think this way will still send 3 requests instead of 1? I think there&#39;s a concept related to batching http requests so that instead of sending X separate requests (which happens in parallel with your answer), then you just send 1 request to do it all?"}, {"owner": {"reputation": 26, "user_id": 5680343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba18c489bbb516833c81ce8145ad5200?s=128&d=identicon&r=PG&f=1", "display_name": "Maiah", "link": "https://stackoverflow.com/users/5680343/maiah"}, "reply_to_user": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1495009441, "post_id": 44018795, "comment_id": 75065758, "body": "Sorry, maybe I don&#39;t get your requirement, here you want to have just 1 http call for 3 different http requests?"}, {"owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "edited": false, "score": 0, "creation_date": 1495009652, "post_id": 44018795, "comment_id": 75065920, "body": "Yeah but @mkopriva says it&#39;s not possible (at least not the way I thought it was) so I guess your answer achieves the best possible outcome given the circumstances :)"}], "tags": [], "owner": {"reputation": 26, "user_id": 5680343, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ba18c489bbb516833c81ce8145ad5200?s=128&d=identicon&r=PG&f=1", "display_name": "Maiah", "link": "https://stackoverflow.com/users/5680343/maiah"}, "is_accepted": true, "score": 1, "last_activity_date": 1495007717, "creation_date": 1495007717, "answer_id": 44018795, "question_id": 44017927, "link": "https://stackoverflow.com/questions/44017927/http-batch-get-from-multiple-apis-and-save-to-struct/44018795#44018795", "title": "HTTP Batch Get from multiple APIs and save to struct", "body": "<p>There are many ways to achieve this and it's based on what you need to happen.</p>\n\n<p>The basic one is to use goroutines and wg.WaitGroup to do http call in parallel/concurrent and wait for all of it to finish before exiting the program. For example:</p>\n\n<pre><code>func main() {\n  apikey := \"some api key\"\n\n  var wg sync.WaitGroup\n  wg.Add(3)\n\n  go func() {\n    GetCustomerByID(apikey, \"43279843\")\n    wg.Done()\n  }()\n\n  go func() {\n    GetCustomerDiscounts(apikey, \"43279843\")\n    wg.Done()\n  }()\n\n  go func() {\n    GetProductByID(apikey, \"32124\")\n    wg.Done()\n  }()\n\n  wg.Wait()\n}\n</code></pre>\n\n<p>Another approach is to use go channel if you want to inspect the result of each http call. For example:</p>\n\n<pre><code>func GetCustomerByID(APIKey, cusID string) Customer {\n  cus := new(Customer)\n  getURLToTarget(fmt.Sprintf(\"http://someurl.com/%s/customerbyid/:%s\", APIKey, cusID), &amp;cus)\n  return cus\n}\n\nfunc main() {\n  apikey := \"some api key\"\n\n  c := make(chan Customer, 3)\n\n  go func() {\n    cus := GetCustomerByID(apikey, \"43279843\")\n    c &lt;- cus\n  }()\n\n  go func() {\n    cus := GetCustomerDiscounts(apikey, \"43279843\")\n    c &lt;- cus\n  }()\n\n  go func() {\n    cus := GetProductByID(apikey, \"32124\")\n    c &lt;- cus\n  }()\n\n  // Print the result\n  var i int\n  for cus := range c {\n    fmt.Printf(\"%#v\\n\", cus)\n    i++\n\n    if i == 3 {\n      break\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 699, "user_id": 7530061, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/67d9f10184bc61745882732a1cc6b570?s=128&d=identicon&r=PG&f=1", "display_name": "fisker", "link": "https://stackoverflow.com/users/7530061/fisker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1161, "favorite_count": 1, "accepted_answer_id": 44018795, "answer_count": 1, "score": 0, "last_activity_date": 1495007717, "creation_date": 1495005003, "question_id": 44017927, "link": "https://stackoverflow.com/questions/44017927/http-batch-get-from-multiple-apis-and-save-to-struct", "title": "HTTP Batch Get from multiple APIs and save to struct", "body": "<p>I have the following function that I use to get a URL and return the data to an interface (e.g. struct/int/whatever):</p>\n\n<pre><code>var httpClient = &amp;http.Client{Timeout: 10 * time.Second}\n\nfunc getURLToTarget(url string, target interface{}) error {\n    req, err := httpClient.Get(url)\n    if err != nil {\n        return err\n    }\n    defer req.Body.Close()\n    return json.NewDecoder(req.Body).Decode(target)\n}\n</code></pre>\n\n<p>then I have several functions that look like this:</p>\n\n<pre><code>func GetCustomerByID(APIKey, cusID string) {\n  cus := new(Customer)\n  getURLToTarget(fmt.Sprintf(\"http://someurl.com/%s/customerbyid/:%s\", APIKey, cusID), &amp;cus)\n}\n</code></pre>\n\n<p>which in this case will save the json response into a struct like this:</p>\n\n<pre><code>type Customer struct {\n  Name string\n  Email string\n  Address string\n}\n</code></pre>\n\n<p>Now my question is, how can I make all these http requests perform simultaneously when I run:</p>\n\n<pre><code>func main() {\n  apikey := \"some api key\"\n  GetCustomerByID(apikey, \"43279843\")\n  GetCustomerDiscounts(apikey, \"43279843\")\n  GetProductByID(apikey, \"32124\")\n}\n</code></pre>\n\n<p>I am pretty sure I need to use channels but I can't figure out how.. any help would be much appreciated</p>\n"}, {"tags": ["function", "go"], "comments": [{"owner": {"reputation": 4897, "user_id": 4573839, "user_type": "registered", "accept_rate": 89, "profile_image": "https://lh4.googleusercontent.com/-wLBU0P4GoTk/AAAAAAAAAAI/AAAAAAAAAPM/8Xy7C9d-XoU/photo.jpg?sz=128", "display_name": "yu yang Jian", "link": "https://stackoverflow.com/users/4573839/yu-yang-jian"}, "edited": false, "score": 0, "creation_date": 1525074271, "post_id": 44017725, "comment_id": 87208286, "body": "I found that if your function has multi return value, and you don&#39;t use bracket wrap, such as <code>func Somefunc(test input) string, error</code> you will get this error, after you use bracket wrap <code>func Somefunc(test input) (string, error)</code> the error disappear."}], "answers": [{"tags": [], "owner": {"reputation": 329, "user_id": 610605, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52676a7f64a6723d917d6cc7be176ec8?s=128&d=identicon&r=PG", "display_name": "Paul Bentley", "link": "https://stackoverflow.com/users/610605/paul-bentley"}, "is_accepted": false, "score": 3, "last_activity_date": 1495005008, "creation_date": 1495005008, "answer_id": 44017930, "question_id": 44017725, "link": "https://stackoverflow.com/questions/44017725/missing-function-body/44017930#44017930", "title": "Missing function body", "body": "<p><code>acos</code> and <code>Acos</code> are different functions, with differing implementations.  The same with your <code>Generate()</code> and <code>generate()</code>.</p>\n\n<p>The <code>acos</code> method is implemented in assembly, and this is just the method prototype.  You do not need to pre-declare your UUID generation function, as the compiler is multi-pass.</p>\n"}], "owner": {"reputation": 315, "user_id": 6559250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4ed53de34f736f2196ac1a26c36dc8d?s=128&d=identicon&r=PG", "display_name": "ahmdrz", "link": "https://stackoverflow.com/users/6559250/ahmdrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16416, "favorite_count": 0, "closed_date": 1495007083, "answer_count": 1, "score": 1, "last_activity_date": 1495005008, "creation_date": 1495004364, "question_id": 44017725, "link": "https://stackoverflow.com/questions/44017725/missing-function-body", "closed_reason": "Duplicate", "title": "Missing function body", "body": "<p>When I saw <code>math.Sin</code> in Golang , I wondered because it was two functions with same names but first function have not function body.\nSee below :</p>\n\n<p>For example <code>math.Acos</code> :</p>\n\n<pre><code>// Acos returns the arccosine, in radians, of x.\n//\n// Special case is:\n//  Acos(x) = NaN if x &lt; -1 or x &gt; 1\nfunc Acos(x float64) float64\n\nfunc acos(x float64) float64 {\n    return Pi/2 - Asin(x)\n}\n</code></pre>\n\n<p>But when I want to create a very very simple <code>uuid</code> package with below statements :</p>\n\n<pre><code>package uuid\n\nimport (\n    \"crypto/rand\"\n    \"fmt\"\n    \"io\"\n)\n\n// Generate generates a random UUID according to RFC 4122\nfunc Generate() (string, error)\n\nfunc generate() (string, error) {\n    uuid := make([]byte, 16)\n    n, err := io.ReadFull(rand.Reader, uuid)\n    if n != len(uuid) || err != nil {\n        return \"\", err\n    }\n    uuid[8] = uuid[8]&amp;^0xc0 | 0x80\n    uuid[6] = uuid[6]&amp;^0xf0 | 0x40\n    return fmt.Sprintf(\"%x-%x-%x-%x-%x\", uuid[0:4], uuid[4:6], uuid[6:8], uuid[8:10], uuid[10:]), nil\n}\n</code></pre>\n\n<p>I've got an error that said <code>missing function body for \"Generate\"</code></p>\n\n<p>So how can I write functions like <code>math.Acos</code> ?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 2241, "user_id": 6284825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z7dY9qEIYqY/AAAAAAAAAAI/AAAAAAAAABE/DUXNdvdCo9I/photo.jpg?sz=128", "display_name": "Abhilekh Singh", "link": "https://stackoverflow.com/users/6284825/abhilekh-singh"}, "is_accepted": false, "score": -1, "last_activity_date": 1495004140, "creation_date": 1495004140, "answer_id": 44017654, "question_id": 44017428, "link": "https://stackoverflow.com/questions/44017428/golang-with-compile-error-undefined-strings-in-strings-trim/44017654#44017654", "title": "golang with compile error: undefined: strings in strings.trim", "body": "<p>If you import <code>strings</code> package with different name then it will cause issue as it is used by the wrapper code to run the function completely. </p>\n\n<p>No need to import <code>strings</code> package again. It will be added.</p>\n\n<p>Just use it directly.</p>\n\n<pre><code>func reverseWords(s string) string {\n    words := strings.Split(s,\" \");\n    res := \"\";\n    for i:=0; i &lt; len(words);i++{\n        curWord := strings.Split(words[i],\"\");\n        for j:=len(curWord)-1; j &gt;= 0;j--{\n            res += curWord[j];\n        }\n        if(i!=len(words)-1){\n            res += \" \";\n        }\n    }\n    return res;\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 4, "last_activity_date": 1583769284, "last_edit_date": 1583769284, "creation_date": 1495029579, "answer_id": 44027051, "question_id": 44017428, "link": "https://stackoverflow.com/questions/44017428/golang-with-compile-error-undefined-strings-in-strings-trim/44027051#44027051", "title": "golang with compile error: undefined: strings in strings.trim", "body": "<p>You're importing strings under an alias:</p>\n\n<pre><code>import  ss \"strings\"\n</code></pre>\n\n<p>That means that everywhere in that file, instead of referring to <code>strings</code> you must refer to <code>ss</code>, for example:</p>\n\n<pre><code>words := ss.Split(s,\" \")\n</code></pre>\n\n<p>If you use the default import:</p>\n\n<pre><code>import \"strings\"\n</code></pre>\n\n<p>Then you can refer to it as <code>strings</code> as normal.</p>\n\n<p>Note that the currently accepted answer is wrong about two things: you can absolutely use the alias as you have it, you just have to refer to the package with the aliased name. It will not cause any issues if you use the name you gave it. Second, you absolutely do need to import the <code>strings</code> package - with or without an alias, your choice - if you want to refer to it.</p>\n\n<p>On a completely unrelated side note, you should strongly consider running <code>go fmt</code> on your code, as it does not follow Go coding standards; for example, standard Go code omits the vast majority of semicolons. The code will work regardless, but you'll have an easier time getting help from other Go developers if your code is formatted the way everyone else is used to seeing it.</p>\n"}], "owner": {"reputation": 1887, "user_id": 6514989, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7cc849ff19574490024b6e12ef33c82b?s=128&d=identicon&r=PG&f=1", "display_name": "nail fei", "link": "https://stackoverflow.com/users/6514989/nail-fei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8323, "favorite_count": 0, "accepted_answer_id": 44027051, "answer_count": 2, "score": 6, "last_activity_date": 1583769284, "creation_date": 1495003421, "question_id": 44017428, "link": "https://stackoverflow.com/questions/44017428/golang-with-compile-error-undefined-strings-in-strings-trim", "title": "golang with compile error: undefined: strings in strings.trim", "body": "<p>I try to use <strong>golang</strong> deal with this problem <a href=\"https://leetcode.com/problems/reverse-words-in-a-string-iii/#/description\" rel=\"noreferrer\">557. Reverse Words in a String III </a> \nmy code as below:</p>\n\n<pre><code>import \"fmt\"\nimport  ss \"strings\"\n\nfunc reverseWords(s string) string {\n    words := ss.Split(s,\" \");\n    res := \"\";\n    for i:=0; i &lt; len(words);i++{\n        curWord := ss.Split(words[i],\"\");\n        for j:=len(curWord)-1; j &gt;= 0;j--{\n            res += curWord[j];\n        }\n        if(i!=len(words)-1){\n            res += \" \";\n        }\n    }\n    return res;\n}\n\nfunc main(){\n    s := \"Let's take LeetCode contest\";\n    fmt.Println(reverseWords(s));\n}\n</code></pre>\n\n<p>Everything is ok in my pc, it can pass compile at least. <br>\n<strong>However</strong>, when I submit in leetcode it tell me :</p>\n\n<pre><code> Line 67: undefined: strings in strings.Trim \n</code></pre>\n\n<p>I google this error but get nothing relevant info. As a beginner in golang, I need help. Everything will be appreciated.</p>\n"}, {"tags": ["html", "xml", "go", "xml-parsing", "html-parsing"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1495003280, "post_id": 44017285, "comment_id": 75061941, "body": "Read about &quot;,innerxml&quot; in <a href=\"https://golang.org/pkg/encoding/xml/#Unmarshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/xml/#Unmarshal</a>"}, {"owner": {"reputation": 85, "user_id": 7052790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ATWXB.jpg?s=128&g=1", "display_name": "smartydoc", "link": "https://stackoverflow.com/users/7052790/smartydoc"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1495003534, "post_id": 44017285, "comment_id": 75062078, "body": "read already, but didn&#39;t catch the value :("}, {"owner": {"reputation": 85, "user_id": 7052790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ATWXB.jpg?s=128&g=1", "display_name": "smartydoc", "link": "https://stackoverflow.com/users/7052790/smartydoc"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1495003717, "post_id": 44017285, "comment_id": 75062185, "body": "still get an error in XML. Goplay link <a href=\"https://play.golang.org/p/6wF0O_ORMO\" rel=\"nofollow noreferrer\">play.golang.org/p/6wF0O_ORMO</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1495029735, "post_id": 44017285, "comment_id": 75080499, "body": "You&#39;re escaping quotes inside backticks, which defeats the purpose of the backticks in Go. It inserts literal backslashes into your HTML before the quotes, which makes it invalid as HTML, let alone XML."}], "answers": [{"comments": [{"owner": {"reputation": 85, "user_id": 7052790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ATWXB.jpg?s=128&g=1", "display_name": "smartydoc", "link": "https://stackoverflow.com/users/7052790/smartydoc"}, "edited": false, "score": 0, "creation_date": 1495005713, "post_id": 44017931, "comment_id": 75063455, "body": "thank you. As i mention earlier, i&#39;ve got a raw html and try to simplify parsing using standard xml unmarshal. Seems like i need to change solution way and don&#39;t use xml lib with dynamic html tables. Anyway, your suggestion is quite full for me!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1495027034, "last_edit_date": 1495027034, "creation_date": 1495005008, "answer_id": 44017931, "question_id": 44017285, "link": "https://stackoverflow.com/questions/44017285/golang-xml-unmarshal-html-table/44017931#44017931", "title": "Golang xml unmarshal html table", "body": "<h3>Sticking to the standard lib</h3>\n\n<p>Your input is not valid XML, so even if you model it right, you won't be able to parse it.</p>\n\n<p>First, you're using a raw <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">string literal</a> to define your input HTML as a <code>string</code>, and raw string literals cannot contain escapes. For example this:</p>\n\n<pre><code>&lt;form action=\\\"/addedUrl/;jsessionid=KJHSDFKJLSDF293847odhf\" method=POST&gt;\n</code></pre>\n\n<p>You can't use <code>\\\"</code> in a raw string literal (you can, but it will mean exactly those 2 characters), and you don't have to, use a simple quotation mark: <code>\"</code>.</p>\n\n<p>Next, in XML you cannot have attributes without putting their values in quotes.</p>\n\n<p>Third, each element must have a matching closing element, your <code>&lt;input&gt;</code> elements are not closed.</p>\n\n<p>So for example this line:</p>\n\n<pre><code>&lt;input type=hidden name=acT value=\\\"Dev\\\"&gt;\n</code></pre>\n\n<p>Must be changed to:</p>\n\n<pre><code>&lt;input type=\"hidden\" name=\"acT\" value=\"Dev\" /&gt;\n</code></pre>\n\n<p>Ok, after these the input is a valid XML now.</p>\n\n<p>How to model it? Simple as this:</p>\n\n<pre><code>type XMLTable struct {\n    Rows []struct {\n        Cell string `xml:\",innerxml\"`\n    } `xml:\"TR&gt;TD\"`\n}\n</code></pre>\n\n<p>And the full code to parse and print contents of <code>&lt;TD&gt;</code> elements:</p>\n\n<pre><code>raw_html_table := `\n&lt;TABLE&gt;&lt;TR&gt;\n&lt;TD&gt;lalalal&lt;/TD&gt;\n&lt;TD&gt;papapap&lt;/TD&gt;\n&lt;TD&gt;fafafa&lt;/TD&gt;\n&lt;TD&gt;\n&lt;form action=\"/addedUrl/;jsessionid=KJHSDFKJLSDF293847odhf\" method=\"POST\"&gt;\n&lt;input type=\"hidden\" name=\"acT\" value=\"Dev\" /&gt;\n&lt;input type=\"hidden\" name=\"acA\" value=\"Anyval\" /&gt;\n&lt;input type=\"submit\" name=\"submit\" value=\"Stop\" /&gt;\n&lt;/form&gt;\n&lt;/TD&gt;\n&lt;/TR&gt;\n&lt;/TABLE&gt;`\n\ntable := XMLTable{}\nerr := xml.Unmarshal([]byte(raw_html_table), &amp;table)\nif err != nil {\n    fmt.Printf(\"error: %v\\n\", err)\n}\n\nfmt.Println(\"count:\", len(table.Rows))\nfor _, row := range table.Rows {\n    fmt.Println(\"TD content:\", row.Cell)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/G0oEy30fQL\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>count: 4\nTD content: lalalal\nTD content: papapap\nTD content: fafafa\nTD content: \n    &lt;form action=\"/addedUrl/;jsessionid=KJHSDFKJLSDF293847odhf\" method=\"POST\"&gt;\n    &lt;input type=\"hidden\" name=\"acT\" value=\"Dev\" /&gt;\n    &lt;input type=\"hidden\" name=\"acA\" value=\"Anyval\" /&gt;\n    &lt;input type=\"submit\" name=\"submit\" value=\"Stop\" /&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<h3>Using a proper HTML parser</h3>\n\n<p>If you can't or don't want to change the input HTML, or you want to handle all HTML input not just valid XMLs, you should use a proper HTML parser instead of treating the input as XML.</p>\n\n<p>Check out <a href=\"https://godoc.org/golang.org/x/net/html\" rel=\"nofollow noreferrer\">https://godoc.org/golang.org/x/net/html</a> for an HTML5-compliant tokenizer and parser.</p>\n"}, {"tags": [], "owner": {"reputation": 1819, "user_id": 2779871, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/noisZ.png?s=128&g=1", "display_name": "Jules Sam. Randolph", "link": "https://stackoverflow.com/users/2779871/jules-sam-randolph"}, "is_accepted": false, "score": 1, "last_activity_date": 1518816314, "creation_date": 1518816314, "answer_id": 48835082, "question_id": 44017285, "link": "https://stackoverflow.com/questions/44017285/golang-xml-unmarshal-html-table/48835082#48835082", "title": "Golang xml unmarshal html table", "body": "<p>Once your input is valid HTML (your snippet is missing quotes in attributes), you can configure a <code>xml.Decoder</code> with entities and autoclose maps (and make it non-strict), which will end up working :</p>\n\n<p><a href=\"https://play.golang.org/p/UsuLsYhMRZm\" rel=\"nofollow noreferrer\">Run my modified version here</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype XMLTable struct {\n    Rows []struct {\n        Cell string `xml:\",innerxml\"`\n    } `xml:\"TR&gt;TD\"`\n}\n\nfunc main() {\n    raw_html_table := `\n    &lt;TABLE&gt;&lt;TR&gt;\n    &lt;TD&gt;lalalal&lt;/TD&gt;\n    &lt;TD&gt;papapap&lt;/TD&gt;\n    &lt;TD&gt;fafafa&lt;/TD&gt;\n    &lt;TD&gt;\n    &lt;form action=\"/addedUrl/;jsessionid=KJHSDFKJLSDF293847odhf\" method=\"POST\"&gt;\n    &lt;input type=\"hidden\" name=\"acT\" value=\"Dev\"&gt;\n    &lt;input type=\"hidden\" name=\"acA\" value=\"Anyval\"&gt;\n    &lt;input type=\"submit\" name=\"submit\" value=\"Stop\"&gt;\n    &lt;/form&gt;\n    &lt;/TD&gt;\n    &lt;/TR&gt;\n    &lt;/TABLE&gt;`\n\n    table := XMLTable{}\n    decoder := xml.NewDecoder(strings.NewReader(raw_html_table))\n    decoder.Entity = xml.HTMLEntity\n    decoder.AutoClose = xml.HTMLAutoClose   \n    decoder.Strict = false\n\n    err := decoder.Decode(&amp;table)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n    }\n    fmt.Printf(\"%#v\\n\", table)\n}\n</code></pre>\n"}], "owner": {"reputation": 85, "user_id": 7052790, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ATWXB.jpg?s=128&g=1", "display_name": "smartydoc", "link": "https://stackoverflow.com/users/7052790/smartydoc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2034, "favorite_count": 0, "accepted_answer_id": 44017931, "answer_count": 2, "score": 1, "last_activity_date": 1518816314, "creation_date": 1495002974, "last_edit_date": 1495006141, "question_id": 44017285, "link": "https://stackoverflow.com/questions/44017285/golang-xml-unmarshal-html-table", "title": "Golang xml unmarshal html table", "body": "<p>I have a simple HTML table, and want to get all cell values even if it's  HTML code inside.</p>\n\n<p>Trying to use xml unmarshal, but didn't get the right struct tags, values or attributes.</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"encoding/xml\"\n)\n\ntype XMLTable struct {\nXMLName xml.Name `xml:\"TABLE\"`\n    Row []struct{\n        Cell string `xml:\"TD\"`\n    }`xml:\"TR\"`\n}\n\nfunc main() {\n    raw_html_table := `\n    &lt;TABLE&gt;&lt;TR&gt;\n    &lt;TD&gt;lalalal&lt;/TD&gt;\n    &lt;TD&gt;papapap&lt;/TD&gt;\n    &lt;TD&gt;fafafa&lt;/TD&gt;\n    &lt;TD&gt;\n    &lt;form action=\\\"/addedUrl/;jsessionid=KJHSDFKJLSDF293847odhf\" method=POST&gt;\n    &lt;input type=hidden name=acT value=\\\"Dev\\\"&gt;\n    &lt;input type=hidden name=acA value=\\\"Anyval\\\"&gt;\n    &lt;input type=submit name=submit value=Stop&gt;\n    &lt;/form&gt;\n    &lt;/TD&gt;\n    &lt;/TR&gt;\n    &lt;/TABLE&gt;`\n\n    table := XMLTable{}\n    fmt.Printf(\"%q\\n\", []byte(raw_html_table)[:15])\n    err := xml.Unmarshal([]byte(raw_html_table), &amp;table)\n    if err != nil {\n        fmt.Printf(\"error: %v\", err)\n    }\n}\n</code></pre>\n\n<p>As an additional info, I don't care about cell content if it's HTML code (take only <code>[]byte</code> / <code>string</code> values). So I may delete cell content before unmarshaling, but this way is also not so easy.</p>\n\n<p>Any suggestions with standard golang libs would be welcome.</p>\n"}, {"tags": ["go", "concurrency", "deadlock", "goroutine"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1495005548, "post_id": 44017241, "comment_id": 75063326, "body": "Just as a side note, you should definitely not be calling <code>rand.Seed</code> for every random number generated."}, {"owner": {"reputation": 117, "user_id": 6482586, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-ko_HakixCcU/AAAAAAAAAAI/AAAAAAAAAFU/MCt5ZXTsLrk/photo.jpg?sz=128", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/6482586/abhinav-sharma"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1495015903, "post_id": 44017241, "comment_id": 75070394, "body": "@hobbs, so apart from violating DRY, does it have a major effect on performance?"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1495035040, "post_id": 44017241, "comment_id": 75084697, "body": "Not on performance, only on correctness. It makes your random numbers much less random."}, {"owner": {"reputation": 117, "user_id": 6482586, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-ko_HakixCcU/AAAAAAAAAAI/AAAAAAAAAFU/MCt5ZXTsLrk/photo.jpg?sz=128", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/6482586/abhinav-sharma"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1495092695, "post_id": 44017241, "comment_id": 75108622, "body": "Ah, I see. Thanks :+1:"}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 6482586, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-ko_HakixCcU/AAAAAAAAAAI/AAAAAAAAAFU/MCt5ZXTsLrk/photo.jpg?sz=128", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/6482586/abhinav-sharma"}, "edited": false, "score": 0, "creation_date": 1495015918, "post_id": 44017582, "comment_id": 75070404, "body": "Thanks @abhink :)"}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 0, "last_activity_date": 1495003912, "creation_date": 1495003912, "answer_id": 44017582, "question_id": 44017241, "link": "https://stackoverflow.com/questions/44017241/how-to-avoid-deadlock-in-printing-alphanumeric-numbers-concurrently/44017582#44017582", "title": "How to avoid deadlock in printing alphanumeric numbers concurrently", "body": "<p>Your current code is not concurrent at all. All the alphanumeric codes are generated sequentially in a single <code>for</code> loop running in the sole goroutine you are creating besides <code>main</code>.</p>\n\n<p>You are adding <code>len(alphabets) == 26</code> to <code>wg.Wait</code>. That means you need to call 26 <code>wg.Done</code> for the call to <code>wg.Wait</code> to complete. Each <code>wg.Done</code> call reduces the waitgroup counter by one.</p>\n\n<p>In your code, you are calling <code>wg.Done</code> only once. That means waitgroup counter stays at 25 once your goroutine returns and the call to <code>wg.Wait</code> would never return since no other goroutine is running that may reduce the waitgroup counter by making further calls to <code>wg.Done</code>.</p>\n\n<p>To (vaguely) get what you want, you can try something like this:</p>\n\n<pre><code>// ...\n\nn := 10 // number of codes you want to print\n\nwg.Add(n)\n\nfor i := 0; i &lt; n; i++ {\n  go func(numbers []string, alphabets []string) {\n    defer wg.Done()\n    makeAleph(numbers, alphabets)\n  }(numbers, alphabets)\n\nwg.Wait()\n\n// ...\n</code></pre>\n\n<p>Now, <code>n</code> goroutines will be spawned, each responsible for printing one code by calling <code>makeAleph</code>. As soon as a goroutine returns, <code>wg.Done</code> is called. A total <code>n</code> <code>wg.Done</code>s are called allowing call to <code>wg.Wait</code> in <code>main</code> to complete.</p>\n"}], "owner": {"reputation": 117, "user_id": 6482586, "user_type": "registered", "accept_rate": 71, "profile_image": "https://lh5.googleusercontent.com/-ko_HakixCcU/AAAAAAAAAAI/AAAAAAAAAFU/MCt5ZXTsLrk/photo.jpg?sz=128", "display_name": "Abhinav Sharma", "link": "https://stackoverflow.com/users/6482586/abhinav-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 48, "favorite_count": 0, "accepted_answer_id": 44017582, "answer_count": 1, "score": 0, "last_activity_date": 1495004700, "creation_date": 1495002806, "last_edit_date": 1495004700, "question_id": 44017241, "link": "https://stackoverflow.com/questions/44017241/how-to-avoid-deadlock-in-printing-alphanumeric-numbers-concurrently", "title": "How to avoid deadlock in printing alphanumeric numbers concurrently", "body": "<p>I'm new to golang and I just wish to print out 10 alphanumeric numbers combining elements from numeber-range and character-range. </p>\n\n<p>I decided to do it concurrently, but I've been running into an error regarding deadlock.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/rand\"\n    \"sync\"\n    \"time\"\n)\n\ntype alphanumeric struct {\n    anAlphabet string\n    aNumber    string\n}\n\nfunc (someStruct alphanumeric) pairAlphanumeric() string {\n\n    return someStruct.aNumber + someStruct.anAlphabet\n\n}\n\nfunc main() {\n\n    var wg sync.WaitGroup\n\n    numbers := []string{\"1\", \"2\", \"3\", \"4\", \"5\", \"6\", \"7\", \"8\", \"9\", \"10\"}\n    alphabets := []string{\"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\", \"h\", \"i\", \"j\", \"k\", \"l\", \"m\", \"n\", \"o\", \"p\", \"q\", \"r\", \"s\", \"t\", \"u\", \"v\", \"w\", \"x\", \"y\", \"z\"}\n\n    //var aleph alphanumeric\n    //var alephS []alphanumeric\n\n    wg.Add(len(alphabets))\n    go func(numbers []string, alphabets []string) {\n        defer wg.Done()\n        for i := 0; i &lt; 10; i++ {\n            makeAleph(numbers, alphabets)\n        }\n    }(numbers, alphabets)\n\n    wg.Wait()\n} // end of main()\n\nfunc makeAleph(numbers []string, alphabets []string) {\n\n    var aleph alphanumeric\n\n    aleph.anAlphabet = aNum(numbers)\n    aleph.aNumber = anAlph(alphabets)\n\n    fmt.Println(aleph.pairAlphanumeric())\n\n    //return aleph.pairAlphanumeric()\n}\n\nfunc randomIndex() int {\n    randTime := time.Time.UnixNano(time.Now())\n\n    rand.Seed(randTime)\n\n    return rand.Intn(10)\n}\n\nfunc aNum(numbers []string) string {\n\n    return numbers[randomIndex()]\n\n}\n\nfunc anAlph(alphabets []string) string {\n\n    return alphabets[randomIndex()]\n\n}\n</code></pre>\n\n<p>And the error that it throws after printing the required numbers correctly is: </p>\n\n<pre><code>\u276f go run aleph.go\nfatal error: all goroutines are asleep - deadlock!\n\ngoroutine 1 [semacquire]:\nsync.runtime_Semacquire(0xc42000e2dc)\n    /Users/eklavya/.gvm/gos/go1.8/src/runtime/sema.go:47 +0x34\nsync.(*WaitGroup).Wait(0xc42000e2d0)\n    /Users/eklavya/.gvm/gos/go1.8/src/sync/waitgroup.go:131 +0x7a\nmain.main()\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:38 +0x14c\n\ngoroutine 5 [chan receive (nil chan)]:\nmain.makeAleph(0xc420084000, 0xa, 0xa, 0xc420001520, 0x1a, 0x1a)\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:61 +0x134\nmain.main.func1(0xc42000e2d0, 0xc420084000, 0xa, 0xa, 0xc420001520, 0x1a, 0x1a)\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:35 +0x94\ncreated by main.main\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:37 +0x13e\n\ngoroutine 6 [chan send (nil chan)]:\nmain.aNum(0x0, 0xc420084000, 0xa, 0xa)\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:79 +0x5b\nmain.makeAleph.func1(0xc42000e2e0, 0x0, 0xc420084000, 0xa, 0xa)\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:51 +0x73\ncreated by main.makeAleph\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:52 +0xad\n\ngoroutine 7 [chan send (nil chan)]:\nmain.anAlph(0x0, 0xc420001520, 0x1a, 0x1a)\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:85 +0x5b\nmain.makeAleph.func2(0xc42000e2e0, 0x0, 0xc420001520, 0x1a, 0x1a)\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:56 +0x73\ncreated by main.makeAleph\n    /Users/eklavya/Projects/Polyglot/TedTalks/goTED/experiments/async/aleph.go:57 +0xff\nexit status 2\n</code></pre>\n\n<p>How can I avoid deadlock in printing alphanumeric numbers concurrently?</p>\n"}, {"tags": ["bash", "go", "pipe", "stdin", "read-eval-print-loop"], "comments": [{"owner": {"reputation": 8269, "user_id": 588734, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/o3CVI.jpg?s=128&g=1", "display_name": "Eamonn McEvoy", "link": "https://stackoverflow.com/users/588734/eamonn-mcevoy"}, "edited": false, "score": 0, "creation_date": 1495002745, "post_id": 44016980, "comment_id": 75061643, "body": "Show your code."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1495029881, "post_id": 44016980, "comment_id": 75080623, "body": "I don&#39;t think you can do that - when you pipe a file into a program, the file contents <i>are</i> stdin. After it reaches EOF, it doesn&#39;t hand stdin back to the terminal. You could pass the file path as a CLI argument instead, read the file yourself, and use stdin to read from the terminal."}], "answers": [{"tags": [], "owner": {"reputation": 14947, "user_id": 900078, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/83stK.jpg?s=128&g=1", "display_name": "pynexj", "link": "https://stackoverflow.com/users/900078/pynexj"}, "is_accepted": true, "score": 1, "last_activity_date": 1495006579, "creation_date": 1495006579, "answer_id": 44018428, "question_id": 44016980, "link": "https://stackoverflow.com/questions/44016980/reading-all-of-stdin-at-program-start-prevents-reading-from-stdin-during-the-pro/44018428#44018428", "title": "Reading all of stdin at program start prevents reading from stdin during the program", "body": "<p>(I suppose the <em>stdin</em> you mentioned as in <em>\"I can no longer accept input from <strong>stdin</strong> for the main repl loop\"</em> is referring to the interactive user input.)</p>\n\n<p>Try like this:</p>\n\n<pre class=\"lang-none prettyprint-override\"><code>[STEP 101] # cat foo.sh\nwhile read line; do\n    printf '&gt; %s\\n' \"$line\"\ndone\n\n# close stdin\nexec 0&lt;&amp;-\n# reopen stdin to /dev/tty\nexec 0&lt; /dev/tty\n\nread -p 'Input something: ' v\nprintf 'You inputted: %s\\n' \"$v\"\n[STEP 102] # printf '%s\\n' foo bar | bash ./foo.sh\n&gt; foo\n&gt; bar\nInput something: hello world\nYou inputted: hello world\n[STEP 103] #\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 4992884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc7726350700fa333372e61878e3e52e?s=128&d=identicon&r=PG&f=1", "display_name": "Josiah Grace", "link": "https://stackoverflow.com/users/4992884/josiah-grace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 44018428, "answer_count": 1, "score": 4, "last_activity_date": 1495006579, "creation_date": 1495001941, "question_id": 44016980, "link": "https://stackoverflow.com/questions/44016980/reading-all-of-stdin-at-program-start-prevents-reading-from-stdin-during-the-pro", "title": "Reading all of stdin at program start prevents reading from stdin during the program", "body": "<p>I have a golang program that makes a simple repl for <a href=\"https://stedolan.github.io/jq/manual/\" rel=\"nofollow noreferrer\">jq</a>. I'd like to be able to read input from stdin at program start into a temporary file, so I can use the repl with piped input.</p>\n\n<p><code>cat file.json | jqrepl</code></p>\n\n<p>However, when I read from stdin, either using a scanner or a reader, I reach the EOF for stdin, and then I can no longer accept input from stdin for the main repl loop. Readline fails immediately because it's at EOF.</p>\n\n<p>I've tried deferring a Reader.UnreadByte, Closing the scanner, and a multitude of \"seek(0)\", and other raw operations on stdin. </p>\n\n<p>Is there a way to reset the stdin so that it can be read from again? Ideally I would read until EOF, save that to a temporary file, and then enter the repl mode.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "edited": false, "score": 1, "creation_date": 1494988172, "post_id": 44014309, "comment_id": 75056885, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/42530538/how-to-pass-pointer-to-slice-to-c-function\">How to pass pointer to slice to C function</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1494989023, "post_id": 44014309, "comment_id": 75057086, "body": "Why do you want to pass a slice header to C? Even if it were allowed, there&#39;s really no reason. Pass in the data, or a pointer to the data."}, {"owner": {"reputation": 659, "user_id": 5944467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c0106fda691ceb8ba3dafd6a980e8d60?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5944467/rahul"}, "edited": false, "score": 0, "creation_date": 1494996190, "post_id": 44014309, "comment_id": 75058934, "body": "Actually, this is part of the problem I was trying to solve. Following is a simplified description of my requirement. I want to create a slice in go and pass it to C code. The C code would call back into a go function multiple times by passing the slice as first argument and a string as second argument. The second go function would append the string to the slice. When the control returns back to the first go function, it would have a list of strings in the slice. So, the slice has to travel go -&gt; C -&gt; go and back."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1495026208, "post_id": 44014309, "comment_id": 75077620, "body": "@Rahul: You can&#39;t pass a slice to a C function without disabling the cgo safety checks, so just start with the correct types to do it in C to avoid the risk of losing the referenced memory to the garbage collector."}, {"owner": {"reputation": 659, "user_id": 5944467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c0106fda691ceb8ba3dafd6a980e8d60?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5944467/rahul"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1495083736, "post_id": 44014309, "comment_id": 75103974, "body": "@JimB: I have my code working by passing unsafe.Pointer(&amp;myslice) to my C function accepting &quot;void *&quot; and from C function to the go function. I just wanted to avoid passing &quot;void *&quot; pointers around and wanted to rely on the compiler to check argument types for me. Since that does not seem to be possible, I&#39;ll stick to the &quot;void *&quot; for now."}, {"owner": {"reputation": 659, "user_id": 5944467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c0106fda691ceb8ba3dafd6a980e8d60?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5944467/rahul"}, "reply_to_user": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "edited": false, "score": 0, "creation_date": 1495084108, "post_id": 44014309, "comment_id": 75104096, "body": "@eugenioy: in the question you refer to, the OP wants to modify a go datastructure in C. I don&#39;t want to do that in my program. I just want to pass it to the C function so that it can be passed to a go callback. I put this extra piece of information in my comment above. Sorry if my original question was incomplete."}], "owner": {"reputation": 659, "user_id": 5944467, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c0106fda691ceb8ba3dafd6a980e8d60?s=128&d=identicon&r=PG&f=1", "display_name": "Rahul", "link": "https://stackoverflow.com/users/5944467/rahul"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 721, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1494986579, "creation_date": 1494986579, "question_id": 44014309, "link": "https://stackoverflow.com/questions/44014309/passing-goslice-directly-to-c", "title": "passing GoSlice directly to C", "body": "<p>I am trying to understand cgo. I can call C functions from go and the other way also. I tried doing something different and it didn't work.</p>\n\n<p>go code:</p>\n\n<pre><code>// main.go\n\npackage main\n\n/*\nextern void myfunction(GoSlice s);\n*/\nimport \"C\"\n\nfunc main() {\n    var s [5]byte\n    C.myfunction(s[:])\n}\n</code></pre>\n\n<p>C code:</p>\n\n<pre><code>// main.c\n\n#include \"_cgo_export.h\"\n\n#include &lt;stdint.h&gt;\n\nvoid myfunction(GoSlice s)\n{\n    for (int i = 0; i &lt; s.len; i++)\n        printf(\"%hhu \", ((uint8_t *)s.data)[i]);\n}\n</code></pre>\n\n<p>The compilation fails because GoSlice is not defined at the time of the C function declaration in main.go. Also, I can't include _cgo_export.h in main.go to get the definition. Is there any way I can get this working ? Note that I can get the functionality working using C compatible data types. But I want to directly use go data type here.</p>\n"}, {"tags": ["google-chrome", "selenium", "docker", "go"], "answers": [{"comments": [{"owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "edited": false, "score": 0, "creation_date": 1609287848, "post_id": 44016194, "comment_id": 115802724, "body": "could you please share your docker file?"}], "tags": [], "owner": {"reputation": 377, "user_id": 6723763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/1r3OV.gif?s=128&g=1", "display_name": "Rtsne42", "link": "https://stackoverflow.com/users/6723763/rtsne42"}, "is_accepted": false, "score": 0, "last_activity_date": 1494998355, "creation_date": 1494998355, "answer_id": 44016194, "question_id": 44013029, "link": "https://stackoverflow.com/questions/44013029/golang-selenium-package-connect-to-selenium-server-and-headless-chrome/44016194#44016194", "title": "Golang Selenium package - connect to selenium server and headless chrome", "body": "<p>After some debugging I found out that the issue was due to the fact that my Docker container did not have the X server inside it.</p>\n\n<p>When the selenium package tried to send input it would generate this error message:</p>\n\n<pre><code>unknown error: unknown error: an X display is required for keycode conversions, consider using Xvfb\n  (Session info: headless chrome=60.0.3095.5)\n  (Driver info: chromedriver=2.29.461571 (8a88bbe0775e2a23afda0ceaf2ef7ee74e822cc5),platform=Linux 4.4.0-77-generic x86_64) (WARNING: The server did not provide any stacktrace information)\nCommand duration or timeout: 40 milliseconds\nBuild info: version: '3.3.1', revision: '5234b32', time: '2017-03-10 09:04:52 -0800'\nSystem info: host: 'e3bf5382c62d', ip: '171.14.0.3', os.name: 'Linux', os.arch: 'amd64', os.version: '4.4.0-77-generic', java.version: '1.8.0_121'\nDriver info: org.openqa.selenium.chrome.ChromeDriver\nCapabilities [{applicationCacheEnabled=false, rotatable=false, mobileEmulationEnabled=false, networkConnectionEnabled=false, chrome={chromedriverVersion=2.29.461571 (8a88bbe0775e2a23afda0ceaf2ef7ee74e822cc5), userDataDir=/tmp/.org.chromium.Chromium.mFhqlU}, takesHeapSnapshot=true, pageLoadStrategy=normal, databaseEnabled=false, handlesAlerts=true, hasTouchScreen=false, version=60.0.3095.5, platform=LINUX, browserConnectionEnabled=false, nativeEvents=true, acceptSslCerts=true, locationContextEnabled=true, webStorageEnabled=true, browserName=chrome, takesScreenshot=true, javascriptEnabled=true, cssSelectorsEnabled=true, unexpectedAlertBehaviour=}]\nSession ID: 681f9de5f91baeaaa3100cf297767a2d\n</code></pre>\n\n<p>I have not yet installed the X server inside the Docker container but I'm confident that it will fix the error that occurs when sending input to the headless chrome instance via selenium.</p>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 6336157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RDpZ4oFM-KE/AAAAAAAAAAI/AAAAAAAAD3w/MEk42oNaEXw/photo.jpg?sz=128", "display_name": "Mayne Wong", "link": "https://stackoverflow.com/users/6336157/mayne-wong"}, "is_accepted": false, "score": 0, "last_activity_date": 1517217048, "creation_date": 1517217048, "answer_id": 48497711, "question_id": 44013029, "link": "https://stackoverflow.com/questions/44013029/golang-selenium-package-connect-to-selenium-server-and-headless-chrome/48497711#48497711", "title": "Golang Selenium package - connect to selenium server and headless chrome", "body": "<p>I also use selenium in Docker, it can run by this:</p>\n\n<p><code>wd, err := selenium.NewRemote(caps, \"http://127.0.0.1:4444/wd/hub\")</code></p>\n"}, {"tags": [], "owner": {"reputation": 1869, "user_id": 404145, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d6a64c6cbea7b83cfc703e18c418eb97?s=128&d=identicon&r=PG", "display_name": "DiveInto", "link": "https://stackoverflow.com/users/404145/diveinto"}, "is_accepted": false, "score": 1, "last_activity_date": 1557677714, "creation_date": 1557677714, "answer_id": 56101118, "question_id": 44013029, "link": "https://stackoverflow.com/questions/44013029/golang-selenium-package-connect-to-selenium-server-and-headless-chrome/56101118#56101118", "title": "Golang Selenium package - connect to selenium server and headless chrome", "body": "<p>try run it in headless mode:</p>\n\n<pre><code>caps := selenium.Capabilities{\"browserName\": \"chrome\"}\n\nchromeCaps := chrome.Capabilities{\n    Path:  \"\",\n    Args: []string{\n        \"--headless\", // &lt;&lt;&lt;\n        \"--no-sandbox\",\n        \"--user-agent=Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) AppleWebKit/604.4.7 (KHTML, like Gecko) Version/11.0.2 Safari/604.4.7\",\n    },\n}\ncaps.AddChrome(chromeCaps)\n\nwd, err := selenium.NewRemote(caps, fmt.Sprintf(\"http://127.0.0.1:%d\", port))\n</code></pre>\n"}], "owner": {"reputation": 377, "user_id": 6723763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/1r3OV.gif?s=128&g=1", "display_name": "Rtsne42", "link": "https://stackoverflow.com/users/6723763/rtsne42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3153, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1557677714, "creation_date": 1494976149, "last_edit_date": 1494981857, "question_id": 44013029, "link": "https://stackoverflow.com/questions/44013029/golang-selenium-package-connect-to-selenium-server-and-headless-chrome", "title": "Golang Selenium package - connect to selenium server and headless chrome", "body": "<p>I'm using the Go selenium package <a href=\"https://godoc.org/github.com/tebeka/selenium\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/tebeka/selenium</a></p>\n\n<p>And I'm running headless chrome + selenium-server inside a docker container on <code>localhost:4444</code></p>\n\n<p>The server seems to be fine since I can access the web console via <a href=\"http://localhost:4444/wd/hub/static/resource/hub.html\" rel=\"nofollow noreferrer\">http://localhost:4444/wd/hub/static/resource/hub.html</a></p>\n\n<p>But I'm trying to get the \"Hello world\" example to work with the existing docker container. </p>\n\n<p>This is the example from the GoDocs page for the selenium driver:</p>\n\n<pre><code>// Run some code on play.golang.org and display the result\npackage main\n\nimport (\n    \"fmt\"\n    \"time\"\n\n    \"github.com/tebeka/selenium\"\n)\n\nvar code = `\npackage main\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"Hello WebDriver!\\n\")\n}\n`\n\n// Errors are ignored for brevity.\n\nfunc main() {\n    // Connect to the selenium server\n    caps := selenium.Capabilities{\"browserName\": \"firefox\"}\n    wd, err := selenium.NewRemote(caps, \"http://127.0.0.1:4444\")\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer wd.Quit()\n\n    // Get simple playground interface\n    wd.Get(\"http://play.golang.org/?simple=1\")\n\n    // Enter code in textarea\n    elem, _ := wd.FindElement(selenium.ByCSSSelector, \"#code\")\n    elem.Clear()\n    elem.SendKeys(code)\n\n    // Click the run button\n    btn, _ := wd.FindElement(selenium.ByCSSSelector, \"#run\")\n    btn.Click()\n\n    // Get the result\n    div, _ := wd.FindElement(selenium.ByCSSSelector, \"#output\")\n\n    output := \"\"\n    // Wait for run to finish\n    for {\n        output, _ = div.Text()\n        if output != \"Waiting for remote server...\" {\n            break\n        }\n        time.Sleep(time.Millisecond * 100)\n    }\n\n    fmt.Printf(\"Got: %s\\n\", output)\n}\n</code></pre>\n\n<p>I tried changing the <code>\"browserName\"</code> to <code>\"chrome\"</code> but I get this error:</p>\n\n<pre><code>panic: got content type \"text/html\", expected \"application/json\"\n\ngoroutine 1 [running]:\nmain.main()\n    /home/user01/Code/golang_src/golang_exercises/33_selenium/selenium.go:28 +0x457\nexit status 2\n</code></pre>\n\n<p>I can't find anything in the GoDoc selenium documentation regarding the chrome browser and how to connect to it via the selenium-server.</p>\n\n<p>I would appreciate any hints as to what might be going wrong here.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>It seems that removing the URL address and leaving it empty has fixed the connection problems:</p>\n\n<pre><code>wd, err := selenium.NewRemote(caps, \"\")\n</code></pre>\n\n<p>That said, I'm still having issues with the example. Mainly it seems like it connects to the Go Playground website, gets the right elements, but when it comes to sending the input <code>elem.SendKeys(code)</code> it doesn't send it properly and the text box is empty. Resulting in bad output from the Playground:</p>\n\n<pre><code>Got: can't load package: package main: \ntmp/sandbox573608783/main.go:1:1: expected 'package', found 'EOF'\n\nProgram exited.\n</code></pre>\n"}, {"tags": ["go", "biginteger", "bigint"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "edited": false, "score": 0, "creation_date": 1494975164, "post_id": 44012835, "comment_id": 75053894, "body": "Thank you. That makes perfect sense."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 7, "last_activity_date": 1494974965, "creation_date": 1494974965, "answer_id": 44012835, "question_id": 44012681, "link": "https://stackoverflow.com/questions/44012681/golang-odd-big-int-behavior/44012835#44012835", "title": "Golang: odd big Int behavior", "body": "<p>The lines </p>\n\n<pre><code>l = i\n</code></pre>\n\n<p>and </p>\n\n<pre><code>pl = l\n</code></pre>\n\n<p>aren't doing what you think they are.</p>\n\n<p><code>l</code>, <code>pl</code>, and <code>i</code> are pointers, and assigning them to each other copies the pointer value, not the <code>big.Int</code> value. </p>\n\n<p>After executing <code>l = i</code>, <code>l</code> is now the same <em>pointer</em> value as <code>i</code>, pointing to the same <code>big.Int</code>. When you use <code>l.Set(i)</code>, it sets <code>l</code>'s <code>big.Int</code> value to <code>i</code>'s <code>big.Int</code> value, but <code>l</code> and <code>i</code> still point to two separate values.</p>\n"}], "owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1494974965, "creation_date": 1494974084, "question_id": 44012681, "link": "https://stackoverflow.com/questions/44012681/golang-odd-big-int-behavior", "title": "Golang: odd big Int behavior", "body": "<p>So I am new to Go and fairly inexperienced with programming in general so I hope I don't get downvoted again for asking stupid questions. \nI am working my way through the project euler problems and at problem 25 \"1000-digit Fibonacci number\" I encountered what seems to be strange behavior. The following is the code I wrote that resulted in this behavior.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    index := 2\n    l := new(big.Int)\n    pl := big.NewInt(1)\n    i := big.NewInt(1)\n    for {\n        l = i\n        i.Add(i, pl)\n        pl = l\n        index++\n        if len(i.String()) == 1000 {\n            break\n        }\n    }\n    fmt.Println(i, \"\\nindex: \", index)\n}\n</code></pre>\n\n<p>Naturally this did not generate the correct answer so in the process of determining why I discovered that I had inadvertently discovered a neat way to generate powers of 2. I made the following changes and this did generate the correct result.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc main() {\n    index := 2\n    l := new(big.Int)\n    pl := big.NewInt(1)\n    i := big.NewInt(1)\n    for {\n        l.Set(i)\n        i.Add(i, pl)\n        pl.Set(l)\n        index++\n        if len(i.String()) == 1000 {\n            break\n        }\n    }\n    fmt.Println(i, \"\\nindex: \", index)\n} \n</code></pre>\n\n<p>My question is what is happening in the first example that causes each big Int variable to be set to the value of i and why this did not generate an error if this was not the correct way to assign a big Int var value? Is i = l, etc a legitimate big Int operation that is simply incorrect for this situation?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1494971872, "post_id": 44011905, "comment_id": 75052651, "body": "Pay attention to the types. Is <code>{&quot;3306&quot;:&quot;3306&quot;}</code> a string? No. Is <code>{&quot;3306&quot;:&quot;3306&quot;}</code> an object with a field named <code>Values</code>? No."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1494970649, "creation_date": 1494970649, "answer_id": 44012006, "question_id": 44011905, "link": "https://stackoverflow.com/questions/44011905/parse-dynamic-json-object/44012006#44012006", "title": "Parse dynamic json object", "body": "<p>Use this type:</p>\n\n<pre><code>type Ports struct {\n    Ports map[string]map[string]string\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/WEp5J1Drez\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>Notes: </p>\n\n<ul>\n<li>The field names much match. I used field name \"Ports\" to match the name used in the JSON text.</li>\n<li>The Go types should have the same level of nesting in the JSON.  A struct and map each count for one level of nesting. The first attempt does not have enough nesting, the second attempt has one too many levels of nesting (the struct with Values field).</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 1, "last_activity_date": 1494971539, "last_edit_date": 1494971539, "creation_date": 1494971115, "answer_id": 44012120, "question_id": 44011905, "link": "https://stackoverflow.com/questions/44011905/parse-dynamic-json-object/44012120#44012120", "title": "Parse dynamic json object", "body": "<p>You can parse it like this.</p>\n\n<p><a href=\"https://play.golang.org/p/09VDJidAVs\" rel=\"nofollow noreferrer\">https://play.golang.org/p/09VDJidAVs</a></p>\n\n<pre><code>type Ports struct {\n    Ports map[string]*Port `json:\"ports\"`\n}\n\ntype Port map[string]string\n\n\nfunc main() {\n    p := &amp;Ports{}\n    err := json.Unmarshal([]byte(ports),p)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    // using\n\n    // if you need to sort by the number value, get the keys in a slice\n    keys := make([]string, 0, len(p.Ports))\n    for k, _ := range p.Ports {\n        keys = append(keys, k)\n    }\n    // sort here\n\n    for i := range keys {\n        fmt.Printf(\"%+v\\n\",p.Ports[keys[i]])\n    }\n\n    // if you don't care to sort\n    for _, v := range p.Ports {\n        for k, v := range *v {\n            fmt.Printf(\"%s: %s\\n\", k,v)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3484, "user_id": 1016425, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GLTjc.gif?s=128&g=1", "display_name": "lloiacono", "link": "https://stackoverflow.com/users/1016425/lloiacono"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 278, "favorite_count": 0, "accepted_answer_id": 44012006, "answer_count": 2, "score": -2, "last_activity_date": 1495133629, "creation_date": 1494970184, "last_edit_date": 1495133629, "question_id": 44011905, "link": "https://stackoverflow.com/questions/44011905/parse-dynamic-json-object", "title": "Parse dynamic json object", "body": "<p>How can I parse this json object:</p>\n\n<pre><code>{\n    \"ports\": {\n        \"0\": {\n            \"3306\": \"3306\"\n        },\n        \"1\": {\n            \"3307\": \"9908\"\n        }\n    }\n}\n</code></pre>\n\n<p>I can have N ports, and the values for each port will always be a key:value pair.</p>\n\n<p>So far I've tried this:</p>\n\n<pre><code>type Ports struct {\n    Port map[string]string\n}\n</code></pre>\n\n<p>With this I get the keys (0, 1) but the values are empty.</p>\n\n<p>I also tried this:</p>\n\n<pre><code>type Ports struct {\n    Port map[string]struct{\n        Values map[string]string\n    }\n}\n</code></pre>\n\n<p>But also not working.</p>\n\n<p>This is how I am decoding the json object:</p>\n\n<pre><code>var requestBody Ports\ndecoder := json.NewDecoder(body)\nerr := decoder.Decode(&amp;requestBody)\n</code></pre>\n"}, {"tags": ["api", "authentication", "web", "go", "service"], "answers": [{"comments": [{"owner": {"reputation": 333, "user_id": 7352226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b7f77d9d96cfe301db80eb8265331a9?s=128&d=identicon&r=PG&f=1", "display_name": "fallaway", "link": "https://stackoverflow.com/users/7352226/fallaway"}, "edited": false, "score": 0, "creation_date": 1495060231, "post_id": 44011608, "comment_id": 75098205, "body": "Thanks! However, does that mean the package that wrap the handler function will essentially handle the authentication process? Should authentication be handled by controllers instead of models?"}], "tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": true, "score": 6, "last_activity_date": 1494968927, "creation_date": 1494968927, "answer_id": 44011608, "question_id": 44011446, "link": "https://stackoverflow.com/questions/44011446/how-to-check-authentication-for-hundreds-and-thousands-of-api-endpoints/44011608#44011608", "title": "How to check authentication for hundreds and thousands of API endpoints?", "body": "<p>Gorilla has a router you can use. You can then wrap the router with authentication checking. Something like this would work:</p>\n\n<pre><code>func checkPermissions(h http.Handler) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        authCheck := true //implement the actual checking\n\n        if authCheck {\n            w.WriteError(w, 400, \"error\")\n            return\n        }\n\n        h.ServeHttp(w, r)\n    }\n}\n\nfunc main() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/\", HomeHandler)\n    r.HandleFunc(\"/products\", ProductsHandler)\n    r.HandleFunc(\"/articles\", ArticlesHandler)\n    http.Handle(\"/\", checkPermissions(r))\n}\n</code></pre>\n\n<p>Supporting links:</p>\n\n<p><a href=\"https://godoc.org/github.com/gorilla/mux#NewRouter\" rel=\"noreferrer\">https://godoc.org/github.com/gorilla/mux#NewRouter</a></p>\n\n<p><a href=\"https://github.com/gorilla/mux\" rel=\"noreferrer\">https://github.com/gorilla/mux</a></p>\n"}], "owner": {"reputation": 333, "user_id": 7352226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b7f77d9d96cfe301db80eb8265331a9?s=128&d=identicon&r=PG&f=1", "display_name": "fallaway", "link": "https://stackoverflow.com/users/7352226/fallaway"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 44011608, "answer_count": 1, "score": 4, "last_activity_date": 1494968927, "creation_date": 1494968224, "question_id": 44011446, "link": "https://stackoverflow.com/questions/44011446/how-to-check-authentication-for-hundreds-and-thousands-of-api-endpoints", "title": "How to check authentication for hundreds and thousands of API endpoints?", "body": "<p>I am currently building a web application in golang (with Gorilla) and have implemented a handful of API endpoints. However, I noticed that every time I implement a function like </p>\n\n<pre><code>func CreateUserHandler(w http.ResponseWriter, r *http.Request) {}\n</code></pre>\n\n<p>I have to add the function below to the body of handler functions to check if request is authorized:</p>\n\n<pre><code>func checkAuthorizedUser (r * http.Request) error {\n    uid, err := CheckRequestUser (r.Cookie(\"uid\"))\n    if err != nil {\n        return errors.New(\"Can't find cookie value for uid\")\n    }\n    if !IsValidUser (uid.Value) { \n        return errors.New(\"Not a valid user\")\n    }\n    return nil\n}\n</code></pre>\n\n<p>What happens to me right now is that I have to add <code>checkAuthorizedUser()</code> to every handler function, and I have already have a lot of handler functions so far. I wonder if there is a better way to check whether a client is authorized to access certain endpoint other than explicitly checking authentication in every handler function.</p>\n"}, {"tags": ["go", "reflection", "error-handling"], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494966152, "post_id": 44010885, "comment_id": 75050017, "body": "Aww... too slow. Good answer :)"}, {"owner": {"reputation": 457, "user_id": 609295, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/lPOCA.png?s=128&g=1", "display_name": "Dave Appleton", "link": "https://stackoverflow.com/users/609295/dave-appleton"}, "edited": false, "score": 0, "creation_date": 1494966563, "post_id": 44010885, "comment_id": 75050216, "body": "Thanks - a lot better than       if apiF.Kind() != reflect.Func   which I was trying"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 457, "user_id": 609295, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/lPOCA.png?s=128&g=1", "display_name": "Dave Appleton", "link": "https://stackoverflow.com/users/609295/dave-appleton"}, "edited": false, "score": 1, "creation_date": 1494966739, "post_id": 44010885, "comment_id": 75050308, "body": "@DaveAppleton the reason that wasn&#39;t working was because <code>Zero</code> was creating a zero <code>Value</code> but, of course, they wouldn&#39;t <code>==</code> each other because it was creating a NEW zero <code>Value</code>."}], "tags": [], "owner": {"reputation": 75, "user_id": 4526883, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/37bb3bde0f6159bf68945c9fe800e349?s=128&d=identicon&r=PG&f=1", "display_name": "Grant Seltzer", "link": "https://stackoverflow.com/users/4526883/grant-seltzer"}, "is_accepted": false, "score": 3, "last_activity_date": 1494966117, "creation_date": 1494966117, "answer_id": 44010885, "question_id": 44010827, "link": "https://stackoverflow.com/questions/44010827/how-to-check-if-the-actual-function-exists-using-methodbyname/44010885#44010885", "title": "How to check if the actual function exists using MethodByName?", "body": "<p>From standard docs:</p>\n\n<blockquote>\n  <p>The zero Value represents no value. Its IsValid method returns false, its Kind method returns Invalid, its String method returns \"\"</p>\n</blockquote>\n\n<p>So you want to use the IsValid method on the returned value from MethodByName. If it's false there was an error. </p>\n"}], "owner": {"reputation": 457, "user_id": 609295, "user_type": "registered", "accept_rate": 47, "profile_image": "https://i.stack.imgur.com/lPOCA.png?s=128&g=1", "display_name": "Dave Appleton", "link": "https://stackoverflow.com/users/609295/dave-appleton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 620, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494966117, "creation_date": 1494965816, "question_id": 44010827, "link": "https://stackoverflow.com/questions/44010827/how-to-check-if-the-actual-function-exists-using-methodbyname", "title": "How to check if the actual function exists using MethodByName?", "body": "<p>I am using reflection as a quick &amp; dirty script handler but I can't figure out the error checking </p>\n\n<p>How do I check that MethodByName has found a valid method? </p>\n\n<p>Docs say zero value - what zero value?</p>\n\n<p>anybody able to  help?</p>\n\n<p><a href=\"https://play.golang.org/p/ogypx-wLay\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ogypx-wLay</a></p>\n\n<pre><code>type step struct {\n  Action    string\n  Parameter string\n  Second    string\n}\n\nfunc doStep(little step) (err error) {\n  apiR := reflect.ValueOf(skript{})\n\n  apiF := apiR.MethodByName(little.Action)\n  if apiF == reflect.Zero(reflect.TypeOf(skript.Approve)) {\n    return errors.New(\"xxx\")\n  }\n  args := []reflect.Value{reflect.ValueOf(little.Parameter), reflect.ValueOf(little.Second)}\n  apiF.Call(args)\n  return nil\n}\n\ntype skript struct{}\n\nfunc (skript) Approve(who string, dummy string) {\n  fmt.Println(\"Approve \", who, dummy)\n}\n\nfunc main() {\n  st1 := step{\"Approve\", \"me\", \"ok\"}\n  st2 := step{\"Block\", \"me\", \"ok\"}\n  doStep(st1)\n  doStep(st2)\n}\n</code></pre>\n"}, {"tags": ["go", "compiler-construction"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 6408190, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sOufnokxiGU/AAAAAAAAAAI/AAAAAAAAADY/lCx3JcSCyRY/photo.jpg?sz=128", "display_name": "Julian Voigt", "link": "https://stackoverflow.com/users/6408190/julian-voigt"}, "edited": false, "score": 0, "creation_date": 1495014332, "post_id": 44010697, "comment_id": 75069324, "body": "Seem right on the first look. I&#39;ll take detailed look later today."}, {"owner": {"reputation": 41, "user_id": 6408190, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sOufnokxiGU/AAAAAAAAAAI/AAAAAAAAADY/lCx3JcSCyRY/photo.jpg?sz=128", "display_name": "Julian Voigt", "link": "https://stackoverflow.com/users/6408190/julian-voigt"}, "edited": false, "score": 0, "creation_date": 1495043441, "post_id": 44010697, "comment_id": 75089907, "body": "Thank you, thats what i was searching for,"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 5, "last_activity_date": 1494965329, "creation_date": 1494965329, "answer_id": 44010697, "question_id": 44010453, "link": "https://stackoverflow.com/questions/44010453/where-is-the-defer-statement-implemented/44010697#44010697", "title": "Where is the defer statement implemented?", "body": "<p>Begin reading here <a href=\"https://github.com/golang/go/blob/d089a6c7187f1ff85277515405ec6c641588a7ff/src/runtime/panic.go#L70\" rel=\"noreferrer\">https://github.com/golang/go/blob/d089a6c7187f1ff85277515405ec6c641588a7ff/src/runtime/panic.go#L70</a></p>\n\n<p>You can also search the repository for the term \"deferreturn\" to find more results.</p>\n\n<p>Assembly for defer jumps here <a href=\"https://github.com/golang/go/blob/master/src/runtime/asm_amd64.s#L550\" rel=\"noreferrer\">https://github.com/golang/go/blob/master/src/runtime/asm_amd64.s#L550</a></p>\n"}], "owner": {"reputation": 41, "user_id": 6408190, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-sOufnokxiGU/AAAAAAAAAAI/AAAAAAAAADY/lCx3JcSCyRY/photo.jpg?sz=128", "display_name": "Julian Voigt", "link": "https://stackoverflow.com/users/6408190/julian-voigt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 2, "accepted_answer_id": 44010697, "answer_count": 1, "score": 3, "last_activity_date": 1494965329, "creation_date": 1494964436, "question_id": 44010453, "link": "https://stackoverflow.com/questions/44010453/where-is-the-defer-statement-implemented", "title": "Where is the defer statement implemented?", "body": "<p>I would like to know how and why the defer-Statement works and where it is implemented(in Compiler Source Code).</p>\n\n<p>I found the package about parsing the defer-Statement and building it in the syntax-tree</p>\n\n<p>But I'm interestetd in the actual exection of defer at runtime.\nMy guess is, that it's somewhere inside the \"src/runtime\"</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494963024, "post_id": 44009786, "comment_id": 75048211, "body": "With the question as-is, I have no idea what you are trying to do. Your variable <code>a</code> is of type <code>map[int]Page</code> which you cannot insert into a <code>map[int]Page</code> with your line <code>z := map[int]Page{a}</code>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494963097, "post_id": 44009786, "comment_id": 75048269, "body": "Oh wait, I think I see what is going on. You are getting an <code>interface{}</code> type back. I&#39;ll answer the question."}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 1, "last_activity_date": 1494964395, "last_edit_date": 1494964395, "creation_date": 1494963324, "answer_id": 44010120, "question_id": 44009786, "link": "https://stackoverflow.com/questions/44009786/golang-remap-interface-go-cache/44010120#44010120", "title": "Golang remap interface go-cache", "body": "<p>You get an <code>interface{}</code> type back, but you know what it is, so you need to use a type assertion to cast it back to a <code>map[int]Page</code>. Here is a quick external resource. <a href=\"https://newfivefour.com/golang-interface-type-assertions-switch.html\" rel=\"nofollow noreferrer\">https://newfivefour.com/golang-interface-type-assertions-switch.html</a></p>\n\n<p>Here is an example</p>\n\n<p><a href=\"https://play.golang.org/p/lGseg88K1m\" rel=\"nofollow noreferrer\">https://play.golang.org/p/lGseg88K1m</a></p>\n\n<pre><code>type Page struct {\n    title string\n    url   string\n}\n\nfunc main() {\n    m := make(map[int]Page)\n    m[1] = Page{\"hi\", \"there\"}\n    iface := makeIface(m)\n\n    // use type assertion to cast it back to a map\n    if mapAgain, ok := iface.(map[int]Page); ok {\n        // it really is a map[int]Page\n        fmt.Printf(\"%+v\\n\", mapAgain)\n    } else {\n        // its not actually a map[int]Page\n        fmt.Println(\"oops\")\n    }\n\n    // alternatively use a type-switch if it could be multiple types\n    switch v := iface.(type) {\n        case map[int]Page:\n            //yay\n            fmt.Printf(\"%+v\\n\", v)\n        case string:\n            // its a string\n            fmt.Println(v)\n        default:\n            // something we didn't account for\n\n    }\n\n}\n\nfunc makeIface(m map[int]Page) interface{} {\n    return m\n}\n</code></pre>\n\n<p>Edit: as a side note, you probably want to make your map type <code>map[int]*Page</code> because if you did something like this:</p>\n\n<pre><code>page := m[1]\npage.url = \"different\"\nfmt.Println(page) // prints url=\"different\"\nfmt.Println(m[1].url) // remains unchanged\n</code></pre>\n\n<p>Because <code>page</code> would be a copy of what is in the map, not the <code>Page</code> in the map itself.</p>\n"}], "owner": {"reputation": 175, "user_id": 912029, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/88ded1684fe7e4cb07512fb9ce5615e2?s=128&d=identicon&r=PG&f=1", "display_name": "dasHannon", "link": "https://stackoverflow.com/users/912029/dashannon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 0, "accepted_answer_id": 44010120, "answer_count": 1, "score": 0, "last_activity_date": 1494964395, "creation_date": 1494962125, "question_id": 44009786, "link": "https://stackoverflow.com/questions/44009786/golang-remap-interface-go-cache", "title": "Golang remap interface go-cache", "body": "<p>I've got a struct like below:</p>\n\n<pre><code>type Page struct {\n    title string\n    url   string\n}\n</code></pre>\n\n<p>and a map of structs:     </p>\n\n<pre><code> var mostViewed = make(map[int]Page)\n</code></pre>\n\n<p>With go-cache, I store the map with a TTL time.</p>\n\n<pre><code>c.Set(\"data\", mostViewed, 60*time.Minute)    \n</code></pre>\n\n<p>But, once I recover \"data\" key, how could I assing it back to a map?</p>\n\n<pre><code>a, _ := c.Get(\"data\")\nfmt.Printf(\"%+v\\n\", a)\n\nout: map[17:{title:xxx, url:yyy}]\n</code></pre>\n\n<p>I tried something like: </p>\n\n<pre><code> z := map[int]Page{a}\n</code></pre>\n\n<p>Any clue? It's like \"remapping\" a mapped string.</p>\n"}, {"tags": ["csv", "go"], "answers": [{"tags": [], "owner": {"reputation": 20315, "user_id": 963881, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e82a2a2b9ddf6fb580a9c34b2eca65f4?s=128&d=identicon&r=PG&f=1", "display_name": "syntagma", "link": "https://stackoverflow.com/users/963881/syntagma"}, "is_accepted": false, "score": 0, "last_activity_date": 1494962861, "creation_date": 1494962861, "answer_id": 44009999, "question_id": 44009431, "link": "https://stackoverflow.com/questions/44009431/golang-while-processing-csv-reformat-single-line/44009999#44009999", "title": "Golang: While processing CSV, reformat single line?", "body": "<p>Looking at the implementation of <a href=\"https://golang.org/src/encoding/csv/reader.go?s=4875:4927#L140\" rel=\"nofollow noreferrer\"><code>csv.Read()</code></a> you cannot do what you are looking for with the <code>csv</code> package. It uses a module-private function <code>parseRecord()</code> which does the hard work.</p>\n\n<p>I think what you need is write your own CSV reader which will handle this cases or simply preprocess the file line by line so that malformed items would be for example replaced from <code>\"</code> to <code>\\\"</code> (which <code>csv</code> package could handle correctly). </p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 0, "last_activity_date": 1494963388, "creation_date": 1494963388, "answer_id": 44010136, "question_id": 44009431, "link": "https://stackoverflow.com/questions/44009431/golang-while-processing-csv-reformat-single-line/44010136#44010136", "title": "Golang: While processing CSV, reformat single line?", "body": "<p>As far as I can tell <code>encoding/csv</code> doesn't provide any such functionality, so you can either look for some 3rd party csv package that does that, or you can implement a solution yourself.</p>\n\n<p>If you want to go the DIY route I can offer you a tip, whether it's a good tip that you should implement is up to you.</p>\n\n<p>You could implement an <code>io.Reader</code> that wraps your file and tracks the last line read, then every time you encouter an error because of malformed csv you can use your reader to reread that line, massage it, add it to the results, and have the loop continue as if nothing happened.</p>\n\n<p>Here's an example of how your <code>processCSV</code> would change:</p>\n\n<pre><code>func processCSV(path string){\n\n    file := utils.OpenFile(path)\n    myreader := NewMyReader(file)\n    reader := csv.NewReader(myreader)\n    reader.LazyQuotes = true\n\n    cs:= []*Collision{} //defined elsewhere\n\n    for {\n\n        line, err := reader.Read()\n\n        //Kill processing if we're at EOF\n        if err == io.EOF {\n            break\n        }\n\n        // malformed csv\n        if err != nil {\n            // Just reread the last line and on the next iteration of\n            // the loop myreader.Read should continue returning bytes \n            // that come after this malformed line to the csv.Reader.\n            l, err := myreader.CurrentLine()\n            if err != nil {\n                panic(err)\n            }\n\n            // massage the malformed csv line\n            line = fixcsv(l) \n        }\n\n        c := get(line) //defined elsewhere\n        cs= append(cs, c)\n    }\n\n    //Do other stuff...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "is_accepted": false, "score": 0, "last_activity_date": 1495121295, "creation_date": 1495121295, "answer_id": 44051948, "question_id": 44009431, "link": "https://stackoverflow.com/questions/44009431/golang-while-processing-csv-reformat-single-line/44051948#44051948", "title": "Golang: While processing CSV, reformat single line?", "body": "<p>I \"solved\" this problem using a hint from mkopriva and blatant copying from Go's CSV parsing code. If I read it right, Go's CSV parser is rather clever about what it considers a line. When I've written a naive CSV parser, I've split files on new lines, and then processed them. Go's parser is smarter, and includes the possibility that a quoted field might itself contain a new line. In those cases, my code would fail and theirs would work. </p>\n\n<p>Feeding \"lines\" to Go's parser is a bit tricky, as it's reading through a stream looking for line-beginning-and-ending patterns and extracting fields along the way. What I did was hijack the code and add a variable that tracks the beginning and end of the stream that the code considers a line. My additions probably have problems, but seem to work for me. If it helps, here are the steps I took:</p>\n\n<p>1) Copy the <a href=\"https://golang.org/src/encoding/csv/reader.go\" rel=\"nofollow noreferrer\">CSV source</a> and paste into my project in its entirety.</p>\n\n<p>2) Add a new field to type Reader struct {}:</p>\n\n<pre><code>type Reader struct {\n    ...\n    // The i'th field starts at offset fieldIndexes[i] in lineBuffer.\n    fieldIndexes []int\n\n    CurrentLine []byte //Added struct field to hold onto the line\n\n    ...\n}\n</code></pre>\n\n<p>3) In readRune(), capture bytes as they come in, like so:</p>\n\n<pre><code>func (r *Reader) readRune() (rune, error) {\n    r1, _, err := r.r.ReadRune()\n    r.CurrentLine = append(r.CurrentLine, byte(r1)) //added: stores bytes as processed\n    ...\n}\n</code></pre>\n\n<p>4) in Read(), reset CurrentLine for each line, like so:</p>\n\n<pre><code>func (r *Reader) Read() (record []string, err error) {\n\n    r.CurrentLine = []byte{} //added: reset line capturing\n\n    ...\n}\n</code></pre>\n\n<p>With these items added, I can then grab the current line when there's a parsing error, as per mkopriva's suggestion:</p>\n\n<pre><code>...\nif err != nil {\n\n    line = fixCSV(csvReader.CurrentLine)\n    continue\n\n}\n...\n</code></pre>\n"}], "owner": {"reputation": 673, "user_id": 363042, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d158e0063c0d368abbca8e7f99a153af?s=128&d=identicon&r=PG", "display_name": "Brent", "link": "https://stackoverflow.com/users/363042/brent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1296, "favorite_count": 0, "accepted_answer_id": 44010136, "answer_count": 3, "score": 1, "last_activity_date": 1495121295, "creation_date": 1494960928, "question_id": 44009431, "link": "https://stackoverflow.com/questions/44009431/golang-while-processing-csv-reformat-single-line", "title": "Golang: While processing CSV, reformat single line?", "body": "<p>My golang CSV processing routine copies almost exactly from the <a href=\"https://golang.org/pkg/encoding/csv/\" rel=\"nofollow noreferrer\">Package CSV</a> example: </p>\n\n<pre><code>func processCSV(path string){\n\n    file:= utils.OpenFile(path)\n    reader:= csv.NewReader(file)\n    reader.LazyQuotes = true\n\n    cs:= []*Collision{} //defined elsewhere\n\n    for {\n\n        line, err := reader.Read()\n\n        //Kill processing if we're at EOF\n        if err == io.EOF {\n            break\n        }\n\n        c := get(line) //defined elsewhere\n        cs= append(cs, c)\n    }\n\n    //Do other stuff...\n}\n</code></pre>\n\n<p>The code works great until it encounters a malformed (?) line of CSV, which generally looks something like this:</p>\n\n<p>item1,item2,\"item3,\"has odd quoting\"\",\"item4\",item5</p>\n\n<p>The csvReader.LazyQuotes = true option doesn't seem to offer enough tolerance to read this line as I need it.</p>\n\n<p>My question is this: can I ask the csv reader for the original line so that I can \"massage\" it to pull out what I need? The files I'm working with are moderately large (~150mb) and I'm not sure I want to re-do them, especially as only a few lines per file have such problems.</p>\n\n<p>Thanks for any tips!</p>\n"}, {"tags": ["go", "escaping"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1494959856, "post_id": 44009102, "comment_id": 75046425, "body": "Without more context of where you are inserting your string, we cannot tell which of the <code>contexts</code> are executed. See <a href=\"https://godoc.org/html/template#hdr-Contexts\" rel=\"nofollow noreferrer\">godoc.org/html/template#hdr-Contexts</a>"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1494960234, "post_id": 44009102, "comment_id": 75046661, "body": "This is probably what you need to do. <a href=\"https://godoc.org/html/template#hdr-Typed_Strings\" rel=\"nofollow noreferrer\">godoc.org/html/template#hdr-Typed_Strings</a> (AKA read the documentation!)."}, {"owner": {"reputation": 109, "user_id": 5344384, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bad467927039d2841970ef04ae11ea32?s=128&d=identicon&r=PG&f=1", "display_name": "WORMrus", "link": "https://stackoverflow.com/users/5344384/wormrus"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494960480, "post_id": 44009102, "comment_id": 75046792, "body": "@RayfenWindspear I will update my question soon, thanks for your reply"}, {"owner": {"reputation": 109, "user_id": 5344384, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bad467927039d2841970ef04ae11ea32?s=128&d=identicon&r=PG&f=1", "display_name": "WORMrus", "link": "https://stackoverflow.com/users/5344384/wormrus"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494960594, "post_id": 44009102, "comment_id": 75046867, "body": "@RayfenWindspear in this example <code>&lt;</code> is escaped as <code>&amp;lt</code> which is not my case. <code>template.HTML</code> is not working for me"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 5344384, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bad467927039d2841970ef04ae11ea32?s=128&d=identicon&r=PG&f=1", "display_name": "WORMrus", "link": "https://stackoverflow.com/users/5344384/wormrus"}, "edited": false, "score": 1, "creation_date": 1494961743, "post_id": 44009278, "comment_id": 75047487, "body": "It worked, thank you. But I must choose the @mkmkopriva &#39;s answer since he is 1 minute faster. Still upvoted though"}], "tags": [], "owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "is_accepted": false, "score": 4, "last_activity_date": 1494960336, "creation_date": 1494960336, "answer_id": 44009278, "question_id": 44009102, "link": "https://stackoverflow.com/questions/44009102/how-to-stop-html-template-from-escaping/44009278#44009278", "title": "How to stop html template from escaping", "body": "<p>Try setting the type of <code>JS</code> to <code>template.JS</code>:</p>\n\n<pre><code>import \"html/template\"\n\ntype x struct {\n        JS template.JS\n}\n</code></pre>\n\n<p>Documentation can be found <a href=\"https://golang.org/pkg/html/template/#JS\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 10, "last_activity_date": 1494960384, "creation_date": 1494960384, "answer_id": 44009288, "question_id": 44009102, "link": "https://stackoverflow.com/questions/44009102/how-to-stop-html-template-from-escaping/44009288#44009288", "title": "How to stop html template from escaping", "body": "<p>Either change the field's type to <a href=\"https://golang.org/pkg/html/template/#JS\" rel=\"noreferrer\">template.JS</a> like so:</p>\n\n<pre><code>type Tmpl struct {\n    // ...\n    JS template.JS\n}\n</code></pre>\n\n<p>Or declare a simple function that converts a <code>string</code> to the <code>template.JS</code> type like so:</p>\n\n<pre><code>func toJS(s string) template.JS {\n    return template.JS(s)\n}\n</code></pre>\n\n<p>And then register the function with the <a href=\"https://golang.org/pkg/html/template/#Template.Funcs\" rel=\"noreferrer\">Funcs</a> method and use it in your template like so:</p>\n\n<pre><code>{{toJS .JS}}\n</code></pre>\n"}], "owner": {"reputation": 109, "user_id": 5344384, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bad467927039d2841970ef04ae11ea32?s=128&d=identicon&r=PG&f=1", "display_name": "WORMrus", "link": "https://stackoverflow.com/users/5344384/wormrus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3568, "favorite_count": 1, "accepted_answer_id": 44009288, "answer_count": 2, "score": 3, "last_activity_date": 1562326732, "creation_date": 1494959612, "last_edit_date": 1562326732, "question_id": 44009102, "link": "https://stackoverflow.com/questions/44009102/how-to-stop-html-template-from-escaping", "title": "How to stop html template from escaping", "body": "<p>I have an html template where i want to insert some JavaScript code from outside of template itself. In my template data struct i have created a string field <code>JS string</code> and call it with <code>{{.JS}}</code>. The problem is that everything in browser is escaped:</p>\n\n<p>newlines are <code>\\n</code></p>\n\n<p><code>&lt;</code> and <code>&gt;</code> are <code>\\u003c</code> and <code>\\u003e</code></p>\n\n<p><code>\"</code> is <code>\\\"</code></p>\n\n<p>Same symbols inside of a template are fine. If I Print my <code>JS</code> field into console it is also fine. I have seen some similar problems solved by using <code>template.HTML</code> type instead of <code>string</code>. In my case it does not work at all. </p>\n\n<p><strong>EDIT 1</strong></p>\n\n<p>The actual context is </p>\n\n<pre><code>&lt;script language=\"JavaScript\"&gt;\n    var options = {\n        {{.JS}}\n    };\n&lt;/script&gt;\n</code></pre>\n"}, {"tags": ["regex", "string", "go", "replace"], "comments": [{"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 6, "creation_date": 1494957780, "post_id": 44008517, "comment_id": 75045219, "body": "What have you tried? could you share some code?"}], "answers": [{"tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": true, "score": 9, "last_activity_date": 1494960429, "last_edit_date": 1494960429, "creation_date": 1494958089, "answer_id": 44008660, "question_id": 44008517, "link": "https://stackoverflow.com/questions/44008517/golang-remove-all-characters-except-from-string/44008660#44008660", "title": "Golang: Remove all characters except | from string", "body": "<p>Use regex.ReplaceAllString:</p>\n\n<blockquote>\n  <p>ReplaceAllStringFunc returns a copy of src in which all matches of the Regexp have been replaced by the return value of function repl applied to the matched substring. The replacement returned by repl is substituted directly, without using Expand.</p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>reg := regexp.MustCompile(\"[^| ]+\")\norigStr := \"|| ||| |||| || ||||| ||| || |||| hello |\"\nreplaceStr := reg.ReplaceAllString(origStr, \"\")\n</code></pre>\n\n<p>Docs:\n<a href=\"https://golang.org/pkg/regexp/#Regexp.ReplaceAllString\" rel=\"noreferrer\">https://golang.org/pkg/regexp/#Regexp.ReplaceAllString</a></p>\n\n<p>GoPlay:\n<a href=\"https://play.golang.org/p/rfZFuQMrNJ\" rel=\"noreferrer\">https://play.golang.org/p/rfZFuQMrNJ</a></p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 15, "last_activity_date": 1494961602, "last_edit_date": 1494961602, "creation_date": 1494959973, "answer_id": 44009184, "question_id": 44008517, "link": "https://stackoverflow.com/questions/44008517/golang-remove-all-characters-except-from-string/44009184#44009184", "title": "Golang: Remove all characters except | from string", "body": "<blockquote>\n  <p>\"I suppose it is tempting, if the only tool you have is a hammer, to\n  treat everything as if it were a nail.\" Abrahanm Maslow, The Psychology of \n  Science, 1966.</p>\n</blockquote>\n\n<p>Programmers from other languages sometimes think of regular expressions as a hammer and treat all text as a nail.</p>\n\n<p>In Go, keep it simple and efficient, for example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"unicode\"\n)\n\nfunc remove(s string) string {\n    return strings.Map(\n        func(r rune) rune {\n            if r == '|' || unicode.IsSpace(r) {\n                return r\n            }\n            return -1\n        },\n        s,\n    )\n}\n\nfunc main() {\n    s := \"|| ||| |||| || ||||| ||| || |||| hello |\"\n    fmt.Println(s)\n    s = remove(s)\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>|| ||| |||| || ||||| ||| || |||| hello |\n|| ||| |||| || ||||| ||| || ||||  |\n</code></pre>\n\n<p>A simple benchmark:</p>\n\n<pre><code>package main\n\nimport (\n    \"regexp\"\n    \"testing\"\n)\n\nvar (\n    s = \"|| ||| |||| || ||||| ||| || |||| hello |\"\n    t string\n)\n\nfunc BenchmarkMap(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        t = remove(s)\n    }\n}\n\nfunc BenchmarkRegexp(b *testing.B) {\n    reg := regexp.MustCompile(\"[^| ]+\")\n    for i := 0; i &lt; b.N; i++ {\n        t = reg.ReplaceAllString(s, \"\")\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>BenchmarkMap         5000000           337 ns/op\nBenchmarkRegexp      1000000          2068 ns/op\n</code></pre>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/strings/\" rel=\"noreferrer\">Package strings</a></p>\n  \n  <p><a href=\"https://golang.org/pkg/strings/#Map\" rel=\"noreferrer\">func Map</a></p>\n\n<pre><code>func Map(mapping func(rune) rune, s string) string\n</code></pre>\n  \n  <p>Map returns a copy of the string s with all its characters modified\n  according to the mapping function. If mapping returns a negative\n  value, the character is dropped from the string with no replacement.</p>\n</blockquote>\n"}], "owner": {"reputation": 135, "user_id": 5892013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BpIz_wZA__Y/AAAAAAAAAAI/AAAAAAAAAHI/7F3QzbvKQCA/photo.jpg?sz=128", "display_name": "SYZYGY-DEV 333", "link": "https://stackoverflow.com/users/5892013/syzygy-dev-333"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7008, "favorite_count": 1, "closed_date": 1495509672, "accepted_answer_id": 44008660, "answer_count": 2, "score": -2, "last_activity_date": 1494961602, "creation_date": 1494957658, "question_id": 44008517, "link": "https://stackoverflow.com/questions/44008517/golang-remove-all-characters-except-from-string", "closed_reason": "Not suitable for this site", "title": "Golang: Remove all characters except | from string", "body": "<p>I need to Remove all characters except \"|\" and whitespace from a string. I don't understand how to do this in Go. Please help.</p>\n\n<p>The string could look like this:</p>\n\n<pre><code>|| ||| |||| || ||||| ||| || |||| hello |\n</code></pre>\n\n<p>and I need it to return this:</p>\n\n<pre><code>|| ||| |||| || ||||| ||| || ||||  |\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["go", "data-structures", "structure"], "answers": [{"tags": [], "owner": {"reputation": 4588, "user_id": 1895328, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/75c88191a4c9de0f547e51c5f9e4bea8?s=128&d=identicon&r=PG", "display_name": "RoninDev", "link": "https://stackoverflow.com/users/1895328/ronindev"}, "is_accepted": false, "score": 1, "last_activity_date": 1494951271, "creation_date": 1494951271, "answer_id": 44006609, "question_id": 44006551, "link": "https://stackoverflow.com/questions/44006551/what-is-the-advantage-of-using-a-pointer-to-a-string-instead-of-a-string-in-go/44006609#44006609", "title": "What is the advantage of using a pointer to a string instead of a string in Go", "body": "<p><code>*</code> means pointer.<br>\nIn your case, <code>Name</code> is a field of type pointer to string. </p>\n\n<p>See <a href=\"http://www.golang-book.com/books/intro/8\" rel=\"nofollow noreferrer\">http://www.golang-book.com/books/intro/8</a></p>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1494952060, "creation_date": 1494952060, "answer_id": 44006852, "question_id": 44006551, "link": "https://stackoverflow.com/questions/44006551/what-is-the-advantage-of-using-a-pointer-to-a-string-instead-of-a-string-in-go/44006852#44006852", "title": "What is the advantage of using a pointer to a string instead of a string in Go", "body": "<p>The <code>*</code> declares a <a href=\"https://golang.org/ref/spec#Pointer_types\" rel=\"nofollow noreferrer\">pointer type</a>.  A pointer to a string is sometimes used when decoding JSON to distinguish the following JSON:</p>\n\n<pre><code>JSON        value of the Name field\n{ }         nil\n{name: \"\"}  pointer to \"\"\n</code></pre>\n\n<p>Without the pointer, it's not possible to distinguish a missing value from a blank value in the decoded result.</p>\n\n<p>If the application does not need to make this distinction, then use the second form shown in the question. It's more convenient.</p>\n"}, {"tags": [], "owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "is_accepted": false, "score": 1, "last_activity_date": 1494952452, "creation_date": 1494952452, "answer_id": 44006983, "question_id": 44006551, "link": "https://stackoverflow.com/questions/44006551/what-is-the-advantage-of-using-a-pointer-to-a-string-instead-of-a-string-in-go/44006983#44006983", "title": "What is the advantage of using a pointer to a string instead of a string in Go", "body": "<p>The <code>*</code> is a pointer.</p>\n\n<blockquote>\n  <p>A pointer type denotes the set of all pointers to variables of a given\n  type, called the base type of the pointer. The value of an\n  uninitialized pointer is nil.</p>\n</blockquote>\n\n<p>This is coming from the <a href=\"https://golang.org/ref/spec#Pointer_types\" rel=\"nofollow noreferrer\">Go Spec</a>. I would suggest reading it all.</p>\n"}], "owner": {"reputation": 3703, "user_id": 2127296, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/kjm9H.png?s=128&g=1", "display_name": "Iv&#225;n Rodr&#237;guez Torres", "link": "https://stackoverflow.com/users/2127296/iv%c3%a1n-rodr%c3%adguez-torres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 0, "closed_date": 1494953581, "accepted_answer_id": 44006852, "answer_count": 3, "score": 1, "last_activity_date": 1494955376, "creation_date": 1494951126, "last_edit_date": 1494955376, "question_id": 44006551, "link": "https://stackoverflow.com/questions/44006551/what-is-the-advantage-of-using-a-pointer-to-a-string-instead-of-a-string-in-go", "closed_reason": "Duplicate", "title": "What is the advantage of using a pointer to a string instead of a string in Go", "body": "<p>Reviewing some go code I came across this:</p>\n\n<pre><code>Person struct {\n    Name *string `json:\"name\"`\n}\n</code></pre>\n\n<p>and then some where I saw:</p>\n\n<pre><code>Animal struct {\n    Name string `json:\"name\"`\n} \n</code></pre>\n\n<p>What is the advantage of the pointer here?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1494956538, "post_id": 44005937, "comment_id": 75044478, "body": "Please take the <a href=\"https://stackoverflow.com/tour\">tour</a>,   learn asking good questions stackoverflow.com/help/how-to-ask,   make a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>.  The mcve should be compilable without errors, if your question is not about the occurring error. Use comments to insert your pseudo code, e.g. <code>&#47;* BOXVALUES *&#47;</code>. Also show code to illustrate how you would like to use the resulting struct. I.e. write some compilable code which accesses the member &quot;string&quot; inside a variable of type textbox. Accompanied by another pseudocode in comment to show your idea of how to access the member &quot;x&quot; inside the variable."}, {"owner": {"reputation": 21147, "user_id": 7733418, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b08876b87c096cd006f66820ffc67f27?s=128&d=identicon&r=PG", "display_name": "Yunnosch", "link": "https://stackoverflow.com/users/7733418/yunnosch"}, "edited": false, "score": 0, "creation_date": 1494956634, "post_id": 44005937, "comment_id": 75044533, "body": "What keeps you from declaring a member of type box inside the struct textbox and access it as <code>MyTextboxVariable.BoxMember.x</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1494954684, "post_id": 44006068, "comment_id": 75043457, "body": "This answer is inaccurate in terms of go syntax on two counts - { on its own line is not valid syntax like in C, and the lone identifier <code>BOXVALUES</code> inside of a struct can refer to a struct or interface type, in which case the field name is the same as the type name (though these are called anonymous fields)"}], "tags": [], "owner": {"reputation": 1881, "user_id": 1246051, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/b5e124a8eac8f04f24c5fecde4576c1e?s=128&d=identicon&r=PG", "display_name": "Dan P", "link": "https://stackoverflow.com/users/1246051/dan-p"}, "is_accepted": false, "score": -1, "last_activity_date": 1494949742, "creation_date": 1494949742, "answer_id": 44006068, "question_id": 44005937, "link": "https://stackoverflow.com/questions/44005937/create-struct-containing-fields-of-another-struct/44006068#44006068", "title": "create struct containing fields of another struct", "body": "<p>Not familiar with GO...but given the syntax it looks like you want</p>\n\n<pre><code>struct textbox\n{\n    BOXVALUES box\n    text string\n}\n</code></pre>\n\n<p>According to the syntax you gave which is all have to go on at the moment the struct should consist of a</p>\n\n<pre><code>fieldname DataType\n</code></pre>\n\n<p>In your example for the Textbox you are missing the DataType...like int, string, float, etc.  Your box struct is basically a new DataType so you can use it in place of where you would a DataType.</p>\n"}, {"tags": [], "owner": {"reputation": 1362, "user_id": 5699570, "user_type": "registered", "accept_rate": 67, "profile_image": "https://lh6.googleusercontent.com/-fRpOyxCifSQ/AAAAAAAAAAI/AAAAAAAAAWA/NtmKw1pR05c/photo.jpg?sz=128", "display_name": "kien bui", "link": "https://stackoverflow.com/users/5699570/kien-bui"}, "is_accepted": true, "score": 1, "last_activity_date": 1495382966, "last_edit_date": 1495382966, "creation_date": 1494949910, "answer_id": 44006120, "question_id": 44005937, "link": "https://stackoverflow.com/questions/44005937/create-struct-containing-fields-of-another-struct/44006120#44006120", "title": "create struct containing fields of another struct", "body": "<p>We have least 2 way:</p>\n\n<p>case 1: called Embed</p>\n\n<pre><code>struct textbox {\n    box\n    text string\n}\n</code></pre>\n\n<p>case 2: include child struct</p>\n\n<pre><code>struct textbox {\n    boxValue box\n    text string\n}\n</code></pre>\n\n<p>But I  think you should learn basic lesson. This is a basic concept.</p>\n"}, {"tags": [], "owner": {"reputation": 309, "user_id": 4546150, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HzJYT.jpg?s=128&g=1", "display_name": "denis.lobanov", "link": "https://stackoverflow.com/users/4546150/denis-lobanov"}, "is_accepted": false, "score": 3, "last_activity_date": 1494950212, "creation_date": 1494950212, "answer_id": 44006240, "question_id": 44005937, "link": "https://stackoverflow.com/questions/44005937/create-struct-containing-fields-of-another-struct/44006240#44006240", "title": "create struct containing fields of another struct", "body": "<p>Go doesn't have the concept of inheritance like say Java, where you can say that textbox is a child of box and thus inherits its fields.</p>\n\n<p>So you can do this:\n    type box struct {\n      x int\n      y int\n    }</p>\n\n<pre><code>type textbox struct {\n  box\n  text string\n}\n</code></pre>\n\n<p>By specifying type <code>box</code> without a struct field name you copy the fields defined in the <code>box</code> struct <em>int</em> <code>textbox</code>. However during construction you still have to explicitly initialise <code>box</code> fields as:</p>\n\n<pre><code>t := textbox {\n  box: box{\n    x: 1,\n    y: 2,\n  },\n  text: \"aoeu\",\n}\n</code></pre>\n\n<p>However you no longer need to reference <code>box</code> within <code>textbox</code> for access, for example:</p>\n\n<pre><code>println(t.x)\n</code></pre>\n\n<p>Go is a little weird in that regards, as <code>struct</code> isnt an object so <code>textbox</code> doesnt actually inherit from <code>box</code>, but rather have it copied into it whith some syntactical sugar for access.</p>\n"}], "owner": {"reputation": 139, "user_id": 7903682, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/2bb447d483be033ad6bf17197bd6c7ae?s=128&d=identicon&r=PG&f=1", "display_name": "user7903682", "link": "https://stackoverflow.com/users/7903682/user7903682"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 199, "favorite_count": 0, "accepted_answer_id": 44006120, "answer_count": 3, "score": -1, "last_activity_date": 1495382966, "creation_date": 1494949369, "question_id": 44005937, "link": "https://stackoverflow.com/questions/44005937/create-struct-containing-fields-of-another-struct", "title": "create struct containing fields of another struct", "body": "<p>How can I make a struct with fields of another struct</p>\n\n<pre><code>struct box {\n    x int\n    y int\n}\n\nstruct textbox {\n    BOXVALUES\n    text string\n}\n</code></pre>\n"}, {"tags": ["go", "x509", "pki"], "answers": [{"comments": [{"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1494954958, "post_id": 44004946, "comment_id": 75043599, "body": "I hope you&#39;re not using this to actually establish the root of some trust chain, since anyone can claim they are a CA, determining whether or not a certificate is a root certificate is an operational decision that is up to whoever is running the service but often delegated to software/OS vendors."}, {"owner": {"reputation": 1221, "user_id": 5056459, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ffc78034c187d9f5e94ff1ed1dfce7db?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Williams", "link": "https://stackoverflow.com/users/5056459/adam-williams"}, "reply_to_user": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 1, "creation_date": 1495046865, "post_id": 44004946, "comment_id": 75091758, "body": "Haha, no. But thanks for the comment! I&#39;m actually using this to figure out which certs to throw away in the list of those that are sent by the server. Verification always delegates to the system root store, by setting the VerifyOptions.Roots pool to <code>nil</code>"}, {"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "edited": false, "score": 0, "creation_date": 1516894125, "post_id": 44004946, "comment_id": 83884726, "body": "You may want to verify the certificate was signed by the public key stored within it. This wouldn&#39;t be the case if you&#39;ve been sent an &quot;OldWithNew&quot; or &quot;NewWithOld&quot; certificate, as per RFC 4210. Although, perhaps they wouldn&#39;t have <code>IsCA</code> set..."}], "tags": [], "owner": {"reputation": 1221, "user_id": 5056459, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ffc78034c187d9f5e94ff1ed1dfce7db?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Williams", "link": "https://stackoverflow.com/users/5056459/adam-williams"}, "is_accepted": true, "score": 3, "last_activity_date": 1576801624, "last_edit_date": 1576801624, "creation_date": 1494946626, "answer_id": 44004946, "question_id": 44004435, "link": "https://stackoverflow.com/questions/44004435/detecting-root-x509-certificates-in-go/44004946#44004946", "title": "Detecting root x509 certificates in Go", "body": "<p>Checking both the <code>IsCA</code> flag and whether the subject == the issuer appears to work.</p>\n\n<pre><code>block, _ := pem.Decode([]byte(\"-----BEGIN CERTIFICATE-----\\nMIIFazCCA1OgAwIBAgIRAIIQz7DSQONZRGPgu2OCiwAwDQYJKoZIhvcNAQELBQAw\\nTzELMAkGA1UEBhMCVVMxKTAnBgNVBAoTIEludGVybmV0IFNlY3VyaXR5IFJlc2Vh\\ncmNoIEdyb3VwMRUwEwYDVQQDEwxJU1JHIFJvb3QgWDEwHhcNMTUwNjA0MTEwNDM4\\nWhcNMzUwNjA0MTEwNDM4WjBPMQswCQYDVQQGEwJVUzEpMCcGA1UEChMgSW50ZXJu\\nZXQgU2VjdXJpdHkgUmVzZWFyY2ggR3JvdXAxFTATBgNVBAMTDElTUkcgUm9vdCBY\\nMTCCAiIwDQYJKoZIhvcNAQEBBQADggIPADCCAgoCggIBAK3oJHP0FDfzm54rVygc\\nh77ct984kIxuPOZXoHj3dcKi/vVqbvYATyjb3miGbESTtrFj/RQSa78f0uoxmyF+\\n0TM8ukj13Xnfs7j/EvEhmkvBioZxaUpmZmyPfjxwv60pIgbz5MDmgK7iS4+3mX6U\\nA5/TR5d8mUgjU+g4rk8Kb4Mu0UlXjIB0ttov0DiNewNwIRt18jA8+o+u3dpjq+sW\\nT8KOEUt+zwvo/7V3LvSye0rgTBIlDHCNAymg4VMk7BPZ7hm/ELNKjD+Jo2FR3qyH\\nB5T0Y3HsLuJvW5iB4YlcNHlsdu87kGJ55tukmi8mxdAQ4Q7e2RCOFvu396j3x+UC\\nB5iPNgiV5+I3lg02dZ77DnKxHZu8A/lJBdiB3QW0KtZB6awBdpUKD9jf1b0SHzUv\\nKBds0pjBqAlkd25HN7rOrFleaJ1/ctaJxQZBKT5ZPt0m9STJEadao0xAH0ahmbWn\\nOlFuhjuefXKnEgV4We0+UXgVCwOPjdAvBbI+e0ocS3MFEvzG6uBQE3xDk3SzynTn\\njh8BCNAw1FtxNrQHusEwMFxIt4I7mKZ9YIqioymCzLq9gwQbooMDQaHWBfEbwrbw\\nqHyGO0aoSCqI3Haadr8faqU9GY/rOPNk3sgrDQoo//fb4hVC1CLQJ13hef4Y53CI\\nrU7m2Ys6xt0nUW7/vGT1M0NPAgMBAAGjQjBAMA4GA1UdDwEB/wQEAwIBBjAPBgNV\\nHRMBAf8EBTADAQH/MB0GA1UdDgQWBBR5tFnme7bl5AFzgAiIyBpY9umbbjANBgkq\\nhkiG9w0BAQsFAAOCAgEAVR9YqbyyqFDQDLHYGmkgJykIrGF1XIpu+ILlaS/V9lZL\\nubhzEFnTIZd+50xx+7LSYK05qAvqFyFWhfFQDlnrzuBZ6brJFe+GnY+EgPbk6ZGQ\\n3BebYhtF8GaV0nxvwuo77x/Py9auJ/GpsMiu/X1+mvoiBOv/2X/qkSsisRcOj/KK\\nNFtY2PwByVS5uCbMiogziUwthDyC3+6WVwW6LLv3xLfHTjuCvjHIInNzktHCgKQ5\\nORAzI4JMPJ+GslWYHb4phowim57iaztXOoJwTdwJx4nLCgdNbOhdjsnvzqvHu7Ur\\nTkXWStAmzOVyyghqpZXjFaH3pO3JLF+l+/+sKAIuvtd7u+Nxe5AW0wdeRlN8NwdC\\njNPElpzVmbUq4JUagEiuTDkHzsxHpFKVK7q4+63SM1N95R1NbdWhscdCb+ZAJzVc\\noyi3B43njTOQ5yOf+1CceWxG1bQVs5ZufpsMljq4Ui0/1lvh+wjChP4kqKOJ2qxq\\n4RgqsahDYVvTH9w7jXbyLeiNdd8XM2w9U/t7y0Ff/9yi0GE44Za4rF2LN9d11TPA\\nmRGunUHBcnWEvgJBQl9nJEiU0Zsnvgc/ubhPgXRR4Xq37Z0j4r7g1SgEEzwxA57d\\nemyPxgcYxn/eR44/KJ4EBs+lVDR3veyJm+kXQ99b21/+jh5Xos1AnX5iItreGCc=\\n-----END CERTIFICATE-----\"))\ncert, _ := x509.ParseCertificate(block.Bytes)\n\nif bytes.Equal(cert.RawIssuer, cert.RawSubject) &amp;&amp; cert.IsCA {\n    println(\"It's a CA\")\n}\n</code></pre>\n"}], "owner": {"reputation": 1221, "user_id": 5056459, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ffc78034c187d9f5e94ff1ed1dfce7db?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Williams", "link": "https://stackoverflow.com/users/5056459/adam-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 676, "favorite_count": 1, "accepted_answer_id": 44004946, "answer_count": 1, "score": 2, "last_activity_date": 1576801624, "creation_date": 1494945293, "question_id": 44004435, "link": "https://stackoverflow.com/questions/44004435/detecting-root-x509-certificates-in-go", "title": "Detecting root x509 certificates in Go", "body": "<p>I have an X509 certificate obtained using something like this:</p>\n\n<pre><code>block, additionalData := pem.Decode([]byte(str))\ncert, err := x509.ParseCertificate(block.Bytes)\n</code></pre>\n\n<p>I'd like to check if the certificate is a root certificate. I've tried checking <code>IsCA</code>, but this appears to be true for intermediate certificates too. I've also tried something like this:</p>\n\n<pre><code>if cert.KeyUsage &amp; x509.KeyUsageCertSign { //.....\n</code></pre>\n\n<p>But this is also true for intermediates, since they are permitted to sign the leaf certs.</p>\n\n<p>Should I be doing something else? Perhaps comparing <code>RawSubject</code> and <code>RawIssuer</code> byte for byte and expecting identical contents (won't this false positive for self-signed leaves)?</p>\n"}, {"tags": ["json", "go", "go-gorm"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1494943272, "post_id": 44003152, "comment_id": 75035597, "body": "Either have separate models for what you&#39;re going to be returning and storing in the database, don&#39;t export the field, or you can use a json attribute to ignore the field i.e. <code>Password []byte `json:&#39;-&#39;`</code>"}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1494943617, "post_id": 44003152, "comment_id": 75035871, "body": "@Gavin, is it even possible to change those attributes on an external struct?"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1494948513, "post_id": 44003152, "comment_id": 75039523, "body": "@william.taylor.09 When was the struct mentioned to be external?"}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1494949485, "post_id": 44003152, "comment_id": 75040264, "body": "gorm.Model contains anonymous fields within the User struct. I&#39;m assuming OP wants to restrict visibility to those fields."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1494950080, "post_id": 44003152, "comment_id": 75040723, "body": "@william.taylor.09 Ah, yeah you&#39;re right. I would probably make a separate model for the response then. That sounds like the easiest solution and also separates the database specific information from what the end user sees."}], "answers": [{"tags": [], "owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "is_accepted": true, "score": 5, "last_activity_date": 1494952910, "creation_date": 1494952910, "answer_id": 44007128, "question_id": 44003152, "link": "https://stackoverflow.com/questions/44003152/hide-fields-in-golang-gorm/44007128#44007128", "title": "Hide fields in Golang Gorm", "body": "<p>As Gavin said, I would suggest having two separate models and giving the model the ability to convert to the correct return type.</p>\n\n<p><em>models/user.go</em></p>\n\n<pre><code>package models\n\ntype User struct {\n    gorm.Model\n    Password []byte\n    Active bool\n    Email string\n    ActivationToken string\n    RememberPasswordToken string\n}\n\nfunc (u *User) UserToUser() app.User {\n    return app.User{\n        Email: u.Email\n    }\n}\n</code></pre>\n\n<p><em>app/user.go</em></p>\n\n<pre><code>package app\n\ntype User struct {\n    Email string\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 139, "user_id": 2358664, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4231d094a089c16e79084e7718b62073?s=128&d=identicon&r=PG", "display_name": "mikemaal", "link": "https://stackoverflow.com/users/2358664/mikemaal"}, "is_accepted": false, "score": 10, "last_activity_date": 1525844177, "creation_date": 1525844177, "answer_id": 50246178, "question_id": 44003152, "link": "https://stackoverflow.com/questions/44003152/hide-fields-in-golang-gorm/50246178#50246178", "title": "Hide fields in Golang Gorm", "body": "<p>If you want to have a fixed object to return, you can change the tags with <code>json:\"-\"</code> to decide the elements to send with json.\nFor the elements in the gorm.Model:</p>\n\n<pre><code>type Model struct {\n    ID        uint `gorm:\"primary_key\"`\n    CreatedAt time.Time\n    UpdatedAt time.Time\n    DeletedAt *time.Time `sql:\"index\"`\n}\n</code></pre>\n\n<p>You can substitute them for your own struct:</p>\n\n<pre><code>type OwnModel struct {\n    ID        uint       `gorm:\"primary_key\"`\n    CreatedAt time.Time  `json:\"-\"`\n    UpdatedAt time.Time  `json:\"-\"`\n    DeletedAt *time.Time `json:\"-\";sql:\"index\"`\n}\n</code></pre>\n\n<p>So, your User struct would be like that:</p>\n\n<pre><code>type User struct {\n    OwnModel\n    Password []byte\n    Active bool\n    Email string\n    ActivationToken string\n    RememberPasswordToken string\n}\n\nThe other User fields is your decision to add or not `json:\"-\"` tag.\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 7256917, "user_type": "registered", "profile_image": "https://graph.facebook.com/220807141659982/picture?type=large", "display_name": "Anatolii Kurotych", "link": "https://stackoverflow.com/users/7256917/anatolii-kurotych"}, "is_accepted": false, "score": 6, "last_activity_date": 1552478929, "creation_date": 1552478929, "answer_id": 55141566, "question_id": 44003152, "link": "https://stackoverflow.com/questions/44003152/hide-fields-in-golang-gorm/55141566#55141566", "title": "Hide fields in Golang Gorm", "body": "<p>For me helped add <code>json:\"-\"</code> to gorm.Model </p>\n\n<p>For example:</p>\n\n<pre><code>type User struct {\n    gorm.Model `json:\"-\"`\n    Password []byte\n    Active bool\n    Email string\n    ActivationToken string\n    RememberPasswordToken string\n}\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4431, "favorite_count": 1, "accepted_answer_id": 44007128, "answer_count": 3, "score": 3, "last_activity_date": 1552478929, "creation_date": 1494941981, "question_id": 44003152, "link": "https://stackoverflow.com/questions/44003152/hide-fields-in-golang-gorm", "title": "Hide fields in Golang Gorm", "body": "<p>I am using Gorm in my Golang project. Exctly I have a Rest-API and I get a request make the process and return an object, so, for example I have a struct User like this:</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    Password []byte\n    Active bool\n    Email string\n    ActivationToken string\n    RememberPasswordToken string\n}\n</code></pre>\n\n<p>Now, when I create a User I am encoding it to JSON with:</p>\n\n<pre><code>json.NewEncoder(w).Encode(user)\n</code></pre>\n\n<p>But in the client side I am receiving some fields that I don't really want to send/receive, for example: Created_At, Deleted_At, Updated_At, Password. So, what is the best way to ignore or hide that fields in the response? I saw that I can use a library called Reflect, but it seems to be a lot of work for a simple thing and I want to know if there's another way. Thank you very much</p>\n"}, {"tags": ["file", "http", "go", "download"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1494941426, "post_id": 44002888, "comment_id": 75034135, "body": "Is there any reason not to use http.ServeFile? <a href=\"https://golang.org/pkg/net/http/#ServeFile\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#ServeFile</a>"}, {"owner": {"reputation": 151, "user_id": 4327137, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFus_oADaiY/AAAAAAAAAAI/AAAAAAAAAEo/Z0vwjb8eHPo/photo.jpg?sz=128", "display_name": "Peng Yang", "link": "https://stackoverflow.com/users/4327137/peng-yang"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1494942149, "post_id": 44002888, "comment_id": 75034733, "body": "Thanks! tried this <code>settings.WriteDebugLog(time.Now()) \thttp.ServeFile(w, r, Filename) \tsettings.WriteDebugLog(time.Now())</code> Took 5 seconds to show up for 1GB file"}], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 6882114, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-YxH-NmrJZdE/AAAAAAAAAAI/AAAAAAAAABI/aUiJgfFRDTw/photo.jpg?sz=128", "display_name": "Zeyit Ba\u015far", "link": "https://stackoverflow.com/users/6882114/zeyit-ba%c5%9far"}, "is_accepted": false, "score": 0, "last_activity_date": 1494975376, "creation_date": 1494975376, "answer_id": 44012903, "question_id": 44002888, "link": "https://stackoverflow.com/questions/44002888/how-to-transfer-large-file-to-http-client-in-golang/44012903#44012903", "title": "How to transfer large file to http client in golang", "body": "<p>You can do by directing the download to the file server</p>\n\n<p>Please note, that the filename or path you use is relative to your current working directory.</p>\n\n<p><a href=\"https://play.golang.org/p/RXVtjZnmMQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RXVtjZnmMQ</a></p>\n"}], "owner": {"reputation": 151, "user_id": 4327137, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nFus_oADaiY/AAAAAAAAAAI/AAAAAAAAAEo/Z0vwjb8eHPo/photo.jpg?sz=128", "display_name": "Peng Yang", "link": "https://stackoverflow.com/users/4327137/peng-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1640, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494975376, "creation_date": 1494941348, "last_edit_date": 1494941704, "question_id": 44002888, "link": "https://stackoverflow.com/questions/44002888/how-to-transfer-large-file-to-http-client-in-golang", "title": "How to transfer large file to http client in golang", "body": "<p>I have a handler function which looks like below:</p>\n\n<pre><code>func DownloadFileHandler(w http.ResponseWriter, r *http.Request) {\n    SetResponseHeaders(w, r)\n    if r.Method == \"OPTIONS\" {\n        return\n    }\n    var err error\n    var responseCode int = http.StatusBadRequest\n    vars := mux.Vars(r)\n    file := vars[\"file\"]\n    var n int64 = 0\n    var reader io.Reader\n    Filename := \"images/\" + file\n    f, err := os.Open(Filename)\n    if err != nil {\n        err = errors.New(\"File not found\")\n        goto Error\n    }\n    reader = bufio.NewReader(f)\n    settings.WriteDebugLog(time.Now())\n    n, err = io.Copy(w, reader) // this takes a long time if the file is large\n    settings.WriteDebugLog(time.Now())\n    settings.WriteDebugLog(n / 1024 / 1024)\n    responseCode = http.StatusOK\n    settings.WriteLog(r, responseCode, nil, GetCurrentFuncName())\n    return\nError:\n    WriteErrorResponse(w, responseCode, err)\n    settings.WriteLog(r, responseCode, err, GetCurrentFuncName())\n}\n</code></pre>\n\n<p>But if it is a large file (more than 1GB), the io.Copy takes quite a long time (best case: 1G 13 seconds shown below) and the download process in browser doesn't show up until the process of io.Copy completes. Is there a way to achieve my goal more efficiently? I want the download process to show up in my browser right after I send the download request. </p>\n\n<pre><code>2017/05/16 22:32:29 Debug: 2017-05-16 22:32:29.967499719 +0900 JST\n2017/05/16 22:32:36 Debug: 2017-05-16 22:32:36.980914163 +0900 JST\n2017/05/16 22:32:36 Debug: 1097\n</code></pre>\n\n<p>I tried calling io.Copy with \"go io.Copy\" then the download process shows up soon but the file size is 0.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": false, "score": 3, "last_activity_date": 1494938810, "creation_date": 1494938810, "answer_id": 44001907, "question_id": 44001849, "link": "https://stackoverflow.com/questions/44001849/how-do-i-call-variable-in-sql-open-function-of-golang/44001907#44001907", "title": "How do I call variable in sql.open function of golang", "body": "<p>Instead of using the hardcoded string, use fmt.Sprintf:</p>\n\n<pre><code>pwd := \"password\"\ndb, err := sql.Open(\"mysql\", fmt.Sprintf(\"root:%s@/events\", pwd))\n</code></pre>\n\n<p>Docs:\n<a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/#Sprintf</a></p>\n\n<p>Simple GoPlay:\n<a href=\"https://play.golang.org/p/TKSvTuD8BY\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TKSvTuD8BY</a></p>\n"}], "owner": {"reputation": 7, "user_id": 8019652, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/caf95b54fa2f850d0b31d84f2f531b66?s=128&d=identicon&r=PG&f=1", "display_name": "S.Kiran", "link": "https://stackoverflow.com/users/8019652/s-kiran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1494938810, "creation_date": 1494938668, "question_id": 44001849, "link": "https://stackoverflow.com/questions/44001849/how-do-i-call-variable-in-sql-open-function-of-golang", "title": "How do I call variable in sql.open function of golang", "body": "<p>How do I achieve replacing of the practice of calling actual password in above code with a variable.</p>\n\n<pre><code>pwd := \"password\"\n    db, err := sql.Open(\"mysql\", \"root:pwd@/events\")\nif err != nil {\n    fmt.Printf(\"Error: Failed to connect events schema. \\n\")\n    return\n}\ndefer db.Close()\n</code></pre>\n"}, {"tags": ["c++", "go", "xsd-validation", "cgo", "xerces-c"], "owner": {"reputation": 717, "user_id": 4445988, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/HPoQw.jpg?s=128&g=1", "display_name": "GwydionFR", "link": "https://stackoverflow.com/users/4445988/gwydionfr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 378, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1494938229, "creation_date": 1494938229, "question_id": 44001684, "link": "https://stackoverflow.com/questions/44001684/c-xerces-program-compile-error-with-go-build", "title": "C++ xerces program compile error with go build", "body": "<p>I try to embed a little c++ xerces program in my go application in order to validate xml against xsd.\nThe program compiles and runs fine when I use g++ with the following command:</p>\n\n<p><code>g++ test-xerces.cpp -o xercesTest -v -lxerces-c\n./xercesTest\n</code></p>\n\n<p>However, when using <code>go build</code>, I get the following output:</p>\n\n<pre><code>go build validation-xerces.go \n    # command-line-arguments\n    In file included from \n    /usr/local/include/xercesc/util/RefHashTableOf.hpp:252:0,\n                 from \n    /usr/local/include/xercesc/internal/XSerializeEngine.hpp:25,\n                 from \n    /usr/local/include/xercesc/internal/XSerializable.hpp:25,\n                 from /usr/local/include/xercesc/util/QName.hpp:30,\n                 from /usr/local/include/xercesc/framework/XMLAttr.hpp:26,\n                 from \n    /usr/local/include/xercesc/framework/XMLDocumentHandler.hpp:27,\n                 from \n    /usr/local/include/xercesc/parsers/AbstractDOMParser.hpp:26,\n                 from \n    /usr/local/include/xercesc/parsers/XercesDOMParser.hpp:26,\n                 from ./validation-xerces.go:10:\n    /usr/local/include/xercesc/util/RefHashTableOf.c:33:15: fatal error: new: No such file or directory\n    #include &lt;new&gt;\n               ^\ncompilation terminated.\n</code></pre>\n\n<p>The program in question (I've stolen almost every part of it from people smarter than me):</p>\n\n<pre><code>package main\n/*\n#cgo LDFLAGS: lxerces-c\n\n#include &lt;stdio.h&gt;\n\n#include &lt;xercesc/util/XMLString.hpp&gt;\n#include &lt;xercesc/parsers/XercesDOMParser.hpp&gt;\n#include &lt;xercesc/framework/LocalFileInputSource.hpp&gt;\n#include &lt;xercesc/sax/ErrorHandler.hpp&gt;\n#include &lt;xercesc/sax/SAXParseException.hpp&gt;\n#include &lt;xercesc/sax/EntityResolver.hpp&gt;\n\nXERCES_CPP_NAMESPACE_USE\n\nclass ParserErrorHandler : public ErrorHandler\n{\nprivate:\n    void reportParseException(const SAXParseException&amp; ex)\n    {\n        char* msg = XMLString::transcode(ex.getMessage());\n        fprintf(stderr, \"at line %llu column %llu, %s\\n\",\n                ex.getColumnNumber(), ex.getLineNumber(), msg);\n        XMLString::release(&amp;msg);\n    }\n\npublic:\n    void warning(const SAXParseException&amp; ex)\n    {\n        reportParseException(ex);\n    }\n\n    void error(const SAXParseException&amp; ex)\n    {\n        reportParseException(ex);\n    }\n\n    void fatalError(const SAXParseException&amp; ex)\n    {\n        reportParseException(ex);\n    }\n\n    void resetErrors()\n    {\n    }\n};\n\nvoid ValidateSchema(const char* xmlFilePath)\n{\n    XercesDOMParser domParser;\n\n    ParserErrorHandler parserErrorHandler;\n    domParser.setErrorHandler(&amp;parserErrorHandler);\n    domParser.setValidationScheme(XercesDOMParser::Val_Auto);\n    domParser.setDoNamespaces(true);\n    domParser.setDoSchema(true);\n    domParser.setValidationConstraintFatal(true);\n\n    domParser.parse(xmlFilePath);\n    if (domParser.getErrorCount() == 0)\n        printf(\"XML file validated against the schema successfully\\n\");\n    else\n        printf(\"XML file doesn't conform to the schema\\n\");\n}\n\nint Cmain(int argc, const char *argv[])\n{\n    if (argc != 2)\n    {\n        printf(\"SchemaValidator &lt;xml file&gt;\\n\");\n        return 0;\n    }\n\n    XMLPlatformUtils::Initialize();\n\n    ValidateSchema(argv[1]);\n\n    XMLPlatformUtils::Terminate();\n\n    return 0;\n}\n*/\nimport \"C\"\nimport (\n    \"unsafe\"\n)\n\nfunc main() {\n    argv := [][]byte{\n        []byte(`/path/to/my/file.xml`),\n    }\n    c_argc := C.int(len(argv))\n\n    var b *C.char\n    ptrSize := unsafe.Sizeof(b)\n    c_argv := C.malloc(C.size_t(len(argv)) * C.size_t(ptrSize))\n    defer C.free(unsafe.Pointer(c_argv))\n\n    // Assign each byte slice to its appropriate offset.\n    for i := 0; i &lt; len(argv); i++ {\n        element := (**C.char)(unsafe.Pointer(uintptr(c_argv) + uintptr(i)*ptrSize))\n        *element = (*C.char)(unsafe.Pointer(&amp;argv[i][0]))\n    }\n\n    C.Cmain(c_argc, (**C.char)(c_argv))\n}\n</code></pre>\n"}, {"tags": ["go", "google-api", "bazel"], "answers": [{"tags": [], "owner": {"reputation": 2542, "user_id": 1009896, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4871abd0c41343cb16346aa9729b9873?s=128&d=identicon&r=PG", "display_name": "hlopko", "link": "https://stackoverflow.com/users/1009896/hlopko"}, "is_accepted": true, "score": 1, "last_activity_date": 1496215718, "creation_date": 1496215718, "answer_id": 44278364, "question_id": 44000686, "link": "https://stackoverflow.com/questions/44000686/how-to-use-google-apis-with-go-in-bazel/44278364#44278364", "title": "How to use Google APIs with Go in Bazel", "body": "<p>I asked the go team and the answer was:</p>\n\n<blockquote>\n  <p><a href=\"https://github.com/bazelbuild/rules_go/blob/master/proto/go_proto_library.bzl\" rel=\"nofollow noreferrer\">https://github.com/bazelbuild/rules_go/blob/master/proto/go_proto_library.bzl</a> does not have a good solution for this case where the .proto is in a  completely different location from the .pb.go files other than using a genrule to copy the .proto file from its source and then a go_proto_library to operate on it.</p>\n  \n  <p><a href=\"https://github.com/pubref/rules_protobuf/blob/master/go/rules.bzl\" rel=\"nofollow noreferrer\">https://github.com/pubref/rules_protobuf/blob/master/go/rules.bzl</a> has a go_proto_library that allows the .proto from one place and the .pb.go from another, but disclaimer: this code is not owned or maintained by Google.</p>\n  \n  <p>As to the questions:</p>\n  \n  <p>1) No</p>\n  \n  <p>2) No idea</p>\n  \n  <p>3) See 2</p>\n  \n  <p>4) bazel always recommends generating from the source (in this case the .proto files)</p>\n  \n  <p>5) Not yet</p>\n</blockquote>\n"}], "owner": {"reputation": 11210, "user_id": 725937, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/32cba7500e49d4c491289f9e101c693b?s=128&d=identicon&r=PG", "display_name": "abergmeier", "link": "https://stackoverflow.com/users/725937/abergmeier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 442, "favorite_count": 1, "accepted_answer_id": 44278364, "answer_count": 1, "score": 1, "last_activity_date": 1496215718, "creation_date": 1494935460, "question_id": 44000686, "link": "https://stackoverflow.com/questions/44000686/how-to-use-google-apis-with-go-in-bazel", "title": "How to use Google APIs with Go in Bazel", "body": "<p>I am currently trying to consume Google APIs (for now only due to the annotation options) in Go from Bazel.</p>\n\n<p>There is the <a href=\"https://github.com/googleapis/googleapis\" rel=\"nofollow noreferrer\">official repo</a> for the proto API. There they redirect Go users to <a href=\"https://github.com/google/go-genproto\" rel=\"nofollow noreferrer\">special go variant</a>.</p>\n\n<p>Both have only a stub Bazel package defined. Thus none seems to be directly usable.</p>\n\n<p>So one way to do this would be to fork <a href=\"https://github.com/google/go-genproto\" rel=\"nofollow noreferrer\">the latter</a>, introduce Packages to build <code>go_proto_libraries</code> and hope that the directory structure appeases the <a href=\"https://github.com/bazelbuild/rules_go\" rel=\"nofollow noreferrer\">go rules</a>.\nQuestions:</p>\n\n<ol>\n<li>Is there already another repository, which can be used simply?</li>\n</ol>\n\n<p>If not:</p>\n\n<ol start=\"2\">\n<li>The latter repo is marked as experimental. How likely are changes?</li>\n<li>Is the latter repo kept in sync?</li>\n<li>Should the sources in the latter repo be used or new ones built with Bazel from scratch?</li>\n<li>Is there a better way of doing this?</li>\n</ol>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 3, "user_id": 7905903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5efd0b4e5ce76ee36078d5cf0a17383?s=128&d=identicon&r=PG&f=1", "display_name": "jimy", "link": "https://stackoverflow.com/users/7905903/jimy"}, "edited": false, "score": 0, "creation_date": 1494934529, "post_id": 44000340, "comment_id": 75028903, "body": "err messages of MySQL:2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_insert Exec err:Error 1040: Too many connections. 2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_update Exec err:Error 1040: Too many connections. 2017-05-16 16:37:56 &lt;LL_ERROR&gt; Query err:Error 1040: Too many connections. 2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_del Exec err:Error 1040: Too many connections. 2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_insert Exec err:Error 1040: Too many connections. 2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_update Exec err:Error 1040: Too many connections"}, {"owner": {"reputation": 3, "user_id": 7905903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5efd0b4e5ce76ee36078d5cf0a17383?s=128&d=identicon&r=PG&f=1", "display_name": "jimy", "link": "https://stackoverflow.com/users/7905903/jimy"}, "edited": false, "score": 0, "creation_date": 1494934747, "post_id": 44000340, "comment_id": 75029067, "body": "MySQL setting: max_connections  10050 set global  wait_timeout = 30;     set global interactive_timeout = 30;"}, {"owner": {"reputation": 3, "user_id": 7905903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5efd0b4e5ce76ee36078d5cf0a17383?s=128&d=identicon&r=PG&f=1", "display_name": "jimy", "link": "https://stackoverflow.com/users/7905903/jimy"}, "edited": false, "score": 0, "creation_date": 1494934885, "post_id": 44000340, "comment_id": 75029163, "body": "it&#39;s a memory table and had 5 indexes:  KEY <code>index1</code> (<code>session_key</code>),   KEY <code>index2</code> (<code>Nas-IP</code>),   KEY <code>index3</code> (<code>user_name</code>),   KEY <code>index4</code> (<code>nat_ip</code>),   KEY <code>index5</code> (<code>frame_ip</code>)"}, {"owner": {"reputation": 4806, "user_id": 1945697, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/bGRTK.jpg?s=128&g=1", "display_name": "Sloan Thrasher", "link": "https://stackoverflow.com/users/1945697/sloan-thrasher"}, "edited": false, "score": 2, "creation_date": 1494935343, "post_id": 44000340, "comment_id": 75029459, "body": "Don&#39;t put more info in the comments, especially code. Edit your question and add the info at the end."}, {"owner": {"reputation": 3609, "user_id": 3763102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2439148d94bddcda4415797c8f6afefa?s=128&d=identicon&r=PG", "display_name": "gipsy", "link": "https://stackoverflow.com/users/3763102/gipsy"}, "edited": false, "score": 0, "creation_date": 1494935345, "post_id": 44000340, "comment_id": 75029460, "body": "Why you want to defer the closing of your statements?. Try closing them immediately after the use."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1494935363, "post_id": 44000340, "comment_id": 75029467, "body": "Try closing <code>row</code> at the end of the loop explicitly, calling <code>defer</code> inside a loop will not call the deferred func at the end of the loop but when the outer func terminates."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7905903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5efd0b4e5ce76ee36078d5cf0a17383?s=128&d=identicon&r=PG&f=1", "display_name": "jimy", "link": "https://stackoverflow.com/users/7905903/jimy"}, "edited": false, "score": 0, "creation_date": 1495006877, "post_id": 44002587, "comment_id": 75064165, "body": "also great thanks to peterSO @peterSO, you are so kind helping me edit the format of my first question here"}], "tags": [], "owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "is_accepted": true, "score": 1, "last_activity_date": 1494940562, "creation_date": 1494940562, "answer_id": 44002587, "question_id": 44000340, "link": "https://stackoverflow.com/questions/44000340/mysql-connection-err-with-golang-too-many-connections-too-many-8000-more-s/44002587#44002587", "title": "MySQL connection err (with golang): too many connections, too many (8000 more) sleep connections running show processlist", "body": "<p>You have a defer inside of a loop, which just pushes the row.Close function onto the stack, and will execute when the function returns. You probably want something like this instead:</p>\n\n<pre><code>for i:=0;i&lt;500000;i++{\n    ...\n    sql := \"SELECT * FROM memDB1 where session_key='\" + session_key+\"'\"\n    row, err := db.Query(sql)\n    if err != nil {\n        Log(LL_ERROR, \"Query err:\", err.Error(), \".\")\n        continue\n    }\n    row.Close()\n    ...\n}\n</code></pre>\n\n<p>Supporting docs:\n<a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">https://blog.golang.org/defer-panic-and-recover</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7905903, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5efd0b4e5ce76ee36078d5cf0a17383?s=128&d=identicon&r=PG&f=1", "display_name": "jimy", "link": "https://stackoverflow.com/users/7905903/jimy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1827, "favorite_count": 0, "accepted_answer_id": 44002587, "answer_count": 1, "score": 0, "last_activity_date": 1494940562, "creation_date": 1494934416, "last_edit_date": 1494935403, "question_id": 44000340, "link": "https://stackoverflow.com/questions/44000340/mysql-connection-err-with-golang-too-many-connections-too-many-8000-more-s", "title": "MySQL connection err (with golang): too many connections, too many (8000 more) sleep connections running show processlist", "body": "<p>Execute insert, update, query and delete sequentially in for loop for 500,000 times, \"too many connections\" occurs after running for ten seconds even I set max connection of MySQL to 10,000. When running 'show processlist', the number of sleep status connections quickly raise up to around 10,000. (but it's fine when executing CURD separately, very quick to finish 1000,000 times of loop).</p>\n\n<p>Only execute for loop for one time works fine: 2017-05-16 17:10:26  total cost time5.241008ms.</p>\n\n<p>below is the code:</p>\n\n<pre><code>func insertUnis(db *sql.DB, name string){\n    stmt_insert, err := db.Prepare(\"insert into memDB1 values(?,?,'world.cnworld.cnworld.cnworld.cn',?,'ee02:123::af01:9231:df18:8998:ee02:123::af01:9231:df18:8998:abcd','2017070035|2703258|1943|0|0|10.121.205.248|088:abcd:e02:123::/64','Framed-Interface-Id`varchar(64)COLLATEutf8_binNOTNULLdefaultthah','varchar(64)COLLATEutf8_binNOTNULLdefault0xBF019231DF18899934hdas','Call-From-Id`varchar(32)COLLATEd',?,'Current-Bandwidt','NAS-Port-Idvarchar(256)COLLATEutf8_binNOTNULLdefaultsrunk 6/0/36:33.351 0/0/0/0/0/0NAS-Port-Idvarchar(256)COLLATEutf8_binNOTNULLdefaultsrunk 6/0/36:33.351 0/0/0/0/0/0NAS-Port-Idvarchar(256)COLLATEutf8_binNOTNULLdefaultsrunk 6/0/36:33.351 0/0/0/0/0/0sefiuhu',48204,57239,2458787490,2458787490,2458787490,'Static-Bandwidthvhar(24)','Bas-Bandwidth` varchar(64) COLLATE utf8_bin NOT NULL defaultegse','Session-Id varchar(64) COLLATE utf8_bin NOT NULL defaultlasefjie','Coa-Session-Id` varchar(64) COLLATE utf8_bin NOT NULL defaultsdf','macaddr`varchar(32) COLLATE utf8',?,65535,45656,'Reseverd1` varchar(32) COLLATE u',4294967292)\")\n    if err != nil {\n        Log(LL_ERROR, \"stmt_insert Prepare err:\", err.Error(), \".\")\n    }\n    defer stmt_insert.Close()\n    stmt_update, err := db.Prepare(\"update memDB1 set user_name=? where session_key=?\")\n    if err != nil {\n        Log(LL_ERROR, \"stmt_update Prepare err:\", err.Error(), \".\")\n    }   \n    defer stmt_update.Close()\n    stmt_del, err := db.Prepare(\"delete from memDB1 where session_key=?\")\n        if err != nil {\n            Log(LL_ERROR, \"stmt_del Prepare err:\", err.Error(), \".\")\n    }\n    defer stmt_del.Close() \n    for i:=0;i&lt;500000;i++{\n        session_key:=string(Krand(64,3))\n        user_name := string(Krand(64,3))\n        frame_ip := string(Krand(32,3))     \n        Nas_IP := string(Krand(32,3))   \n        nat_ip := string(Krand(32,3))   \n\n        _, err = stmt_insert.Exec(session_key,user_name,frame_ip,Nas_IP,nat_ip)\n        if err != nil {\n            Log(LL_ERROR, \"stmt_insert Exec err:\", err.Error(), \".\")\n        }\n\n        _, err = stmt_update.Exec(string(Krand(64,3)), session_key)\n        if err != nil {\n            Log(LL_ERROR, \"stmt_update Exec err:\", err.Error(), \".\")\n        }\n        sql := \"SELECT * FROM memDB1 where session_key='\" + session_key+\"'\"\n        row, err := db.Query(sql)\n        defer row.Close()\n        if err != nil {\n            Log(LL_ERROR, \"Query err:\", err.Error(), \".\")\n        }\n        _, err = stmt_del.Exec(session_key)\n         if err != nil {\n            Log(LL_ERROR, \"stmt_del Exec err:\", err.Error(), \".\")\n        }\n    }\n    common_package.WgDay.Done()\n    return\n}\n</code></pre>\n\n<p>The MySQL process list:</p>\n\n<pre><code>mysql&gt; show full processlist;\n...............\n| 1292138 | cid  | localhost:46799 | ciddb | Sleep   |    0 |          | NULL                  |\n| 1292139 | cid  | localhost:46800 | ciddb | Sleep   |    0 |          | NULL                  |\n| 1292140 | cid  | localhost:46801 | ciddb | Sleep   |    0 |          | NULL                  |\n| 1292141 | cid  | localhost:46802 | ciddb | Sleep   |    0 |          | NULL                  |\n+---------+------+-----------------+-------+---------+------+----------+-----------------------+\n8719 rows in set (0.04 sec)\n</code></pre>\n\n<p>MySQL error messages:</p>\n\n<pre><code>2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_insert Exec err:Error 1040: Too many connections. \n2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_update Exec err:Error 1040: Too many connections. \n2017-05-16 16:37:56 &lt;LL_ERROR&gt; Query err:Error 1040: Too many connections. 2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_del Exec err:Error 1040: Too many connections. \n2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_insert Exec err:Error 1040: Too many connections. \n2017-05-16 16:37:56 &lt;LL_ERROR&gt; stmt_update Exec err:Error 1040: Too many connections \n</code></pre>\n\n<p>MySQL setting: <code>max_connections 10050 set global wait_timeout = 30; set global interactive_timeout = 30;</code> </p>\n\n<p>it's a memory table and had 5 indexes: <code>KEY index1 (session_key), KEY index2 (Nas-IP), KEY index3 (user_name), KEY index4 (nat_ip), KEY index5 (frame_ip)</code></p>\n"}, {"tags": ["javascript", "go", "publish-subscribe", "channel"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1494940284, "post_id": 44000215, "comment_id": 75033181, "body": "You could use a worker queue. <a href=\"http://nesv.github.io/golang/2014/02/25/worker-queues-in-go.html\" rel=\"nofollow noreferrer\">nesv.github.io/golang/2014/02/25/worker-queues-in-go.html</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3609, "user_id": 3763102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2439148d94bddcda4415797c8f6afefa?s=128&d=identicon&r=PG", "display_name": "gipsy", "link": "https://stackoverflow.com/users/3763102/gipsy"}, "is_accepted": false, "score": 1, "last_activity_date": 1494977826, "last_edit_date": 1494977826, "creation_date": 1494944863, "answer_id": 44004288, "question_id": 44000215, "link": "https://stackoverflow.com/questions/44000215/pubsub-alternative-in-golang/44004288#44004288", "title": "pubsub alternative in golang", "body": "<p>Just to give you an idea, not necessarily your real use case. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype Publisher struct {\n    subscription map[string]chan string\n}\n\nfunc (p *Publisher)Subscribe(interest string) chan string{\n    if p.subscription == nil {\n        p.subscription = make(map[string]chan string)\n    }\n    p.subscription[interest] = make(chan string)\n    return p.subscription[interest]\n}\n\nfunc (p *Publisher) Add(val string) {\n    if p.subscription[val] != nil {\n        fmt.Println(\"Adding \" + val)\n        p.subscription[val] &lt;- \"added \" + val\n    }\n}\nfunc (p *Publisher) Remove(val string) {\n    if p.subscription[val] != nil {\n        p.subscription[val] &lt;- \"removed \" + val\n    }\n}\n\ntype Subscriber struct {\n    subscriptions [] chan string\n    publisher *Publisher\n}\n\nfunc (s *Subscriber) RegisterInterest(interest string){\n    s.subscriptions = append(s.subscriptions, s.publisher.Subscribe(interest))\n}\nfunc (s *Subscriber) run(channel chan string) {\n    for  {\n        fmt.Println(\"Waiting for message\")\n        m := &lt;- channel\n        fmt.Println(\"Got message : \" + m)\n    }\n}\nfunc (s *Subscriber) Listen()  {\n    for _, elem := range s.subscriptions {\n        go s.run(elem)\n    }\n\n}\nfunc main() {\n    pub := Publisher{}\n    sub := &amp;Subscriber{publisher: &amp;pub}\n    sub.RegisterInterest(\"m\")\n    sub.RegisterInterest(\"n\")\n    sub.Listen()\n    pub.Add(\"m\")\n    pub.Add(\"n\")\n    pub.Remove(\"m\")\n    pub.Remove(\"n\")\n    time.Sleep(time.Second * 10)\n}\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 660, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1494977826, "creation_date": 1494934054, "question_id": 44000215, "link": "https://stackoverflow.com/questions/44000215/pubsub-alternative-in-golang", "title": "pubsub alternative in golang", "body": "<p>I have simple task that already done in javascript using pubsub, here is the task:</p>\n\n<p>I have object let say <code>A</code> and another 2 object that have interest in some element(string in this case), let say <code>Foo</code> interest in element <code>m, n</code> and <code>Bar</code> interest in element <code>n, o, p</code>. The interest can intersect.</p>\n\n<p>The A object have method adding/remove element and when that object contain <code>m, n</code> element which <code>Foo</code> interest in, then that object stored in <code>Foo</code> here's the pseudo code in javascript using pubsub</p>\n\n<pre><code>var A = {};\n\nvar Foo = {\n    interests: ['m', 'n'],\n    storedObj: {},\n    tempObj: {}\n};\n\n// Bar same as Foo with different interest ['n', 'o', 'p']\n\n// somewhere in Foo and Bar constructor\n// Foo and Bar subscribe too each interests element\n// for each interests when add\nsubscribe('add'+interest, function(obj) {\n    // store this obj in tempObj and increment until satisfy all \n    // interest\n    tempObj[obj]++;\n\n    // if this obj satisfy all interest then store it in array of obj\n    if(tempObj[obj] === len(interests)) {\n        storedObj[obj] = true;\n    }\n});\n\n// for each interests when remove\nsubscribe('remove'+interest, function(obj) {\n    // remove from storedObj\n    delete storedObj[obj];\n\n    // decrement tempObj so it can be used for later if the interest \n    // is adding again\n    tempObj[obj]--;\n});\n\n// inside A prototype\nprototype.add = function(interest) {\n    publish('add'+interest, this);\n    return this;\n}\nprototype.remove = function(interest) {\n    publish('remove'+interest, this);\n    return this;\n}\n\n// implementation\nA.add('m')\n .add('n')\n .add('o')\n\n// then A is stored inside Foo but not in Bar because A doesn't have \n// `p`, but it still stored Bar.tempObj and have value 2 and waiting \n// for `p` to be add\n\nA.remove('m')\n .add('p')\n\n// then A is removed from Foo and stored in Bar\n</code></pre>\n\n<p>I want to porting this task into golang but i don't want using pubsub, i want more idiomatic to golang way. NOTE: i already done using pubsub in golang as well.</p>\n\n<p>Can you show me how to do it in golang? i'm thingking using channel, but and can't find the solution.</p>\n"}, {"tags": ["javascript", "go", "server"], "comments": [{"owner": {"reputation": 4288, "user_id": 1519836, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2852ae66cfd8671011c61239be84e25?s=128&d=identicon&r=PG", "display_name": "GottZ", "link": "https://stackoverflow.com/users/1519836/gottz"}, "edited": false, "score": 3, "creation_date": 1494934795, "post_id": 44000154, "comment_id": 75029096, "body": "since go never went upstream in major browsers its highly doubtable you can use go without compiling it to javascript first anyways."}, {"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 1, "creation_date": 1494936506, "post_id": 44000154, "comment_id": 75030296, "body": "It depends how the site checks for JS. Do you have some code example?"}, {"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1494937833, "post_id": 44000154, "comment_id": 75031264, "body": "@apxp you mean the sites code? don&#39;t have that, as for my code its a precise  duplicate of the request sent from the browser (headers wise)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494948467, "post_id": 44000154, "comment_id": 75039497, "body": "The site&#39;s code would be the relevant part. How to get around it depends on how it&#39;s being done in the first place."}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 2981904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08200a764edc239f888b61e027aca04e?s=128&d=identicon&r=PG", "display_name": "makhov", "link": "https://stackoverflow.com/users/2981904/makhov"}, "is_accepted": false, "score": 0, "last_activity_date": 1494936804, "creation_date": 1494936804, "answer_id": 44001145, "question_id": 44000154, "link": "https://stackoverflow.com/questions/44000154/is-it-possible-to-get-a-webpage-that-requires-js-in-golang/44001145#44001145", "title": "Is it possible to get a webpage that requires JS in Golang?", "body": "<p>Use Headless Chrome.\nHere is an <a href=\"https://github.com/YijinLiu/headless-chromium\" rel=\"nofollow noreferrer\">example</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 495, "user_id": 5934834, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/263e6d6ad912197d1f650c8fead44bba?s=128&d=identicon&r=PG&f=1", "display_name": "Gonzalez", "link": "https://stackoverflow.com/users/5934834/gonzalez"}, "is_accepted": false, "score": 1, "last_activity_date": 1495019762, "creation_date": 1495019762, "answer_id": 44023297, "question_id": 44000154, "link": "https://stackoverflow.com/questions/44000154/is-it-possible-to-get-a-webpage-that-requires-js-in-golang/44023297#44023297", "title": "Is it possible to get a webpage that requires JS in Golang?", "body": "<p>Try PhantomJS for Go <a href=\"https://github.com/k4s/phantomgo\" rel=\"nofollow noreferrer\">https://github.com/k4s/phantomgo</a></p>\n\n<p>I tried it once and it worked for me, maybe it'll help you.</p>\n"}, {"comments": [{"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 1, "creation_date": 1578743921, "post_id": 59668697, "comment_id": 105543494, "body": "thanks, a legit answer for this question so marking it as selected for future comers. As for my self - a lot of time passed since.. for scraping I prefer to use js <a href=\"https://github.com/puppeteer/puppeteer\" rel=\"nofollow noreferrer\">Puppeteer</a> these days.. if the server is in <code>node</code> great if in <code>Go</code> or any other language (for me) its better to create a micro service with Puppeteer. it uses its own browser and is a very mature and packed scraper solution.. my 2 cents"}, {"owner": {"reputation": 479, "user_id": 2763060, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yBb54.png?s=128&g=1", "display_name": "ranu", "link": "https://stackoverflow.com/users/2763060/ranu"}, "reply_to_user": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 1, "creation_date": 1578744120, "post_id": 59668697, "comment_id": 105543538, "body": "Nice to know about that. PhantomJS is about to be discontinued so I\u2019m glad that you shared the information about Puppeteer. I myself use Go for scrapping and I was looking for a embedded browser solution and Chromium + Godet also seems to be a reasonable solution."}, {"owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "edited": false, "score": 1, "creation_date": 1578744330, "post_id": 59668697, "comment_id": 105543576, "body": "Oh sure, happy to help :) try out Puppeteer they solve sooo many things that will really long time to implement yourself - and for complex websites/ apps an embedded browser is the only way to go, as there are so many requests and responses going on that doing all of those manually will be a living (and un sustainable) nightmare"}], "tags": [], "owner": {"reputation": 479, "user_id": 2763060, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yBb54.png?s=128&g=1", "display_name": "ranu", "link": "https://stackoverflow.com/users/2763060/ranu"}, "is_accepted": true, "score": 1, "last_activity_date": 1607738529, "last_edit_date": 1607738529, "creation_date": 1578588637, "answer_id": 59668697, "question_id": 44000154, "link": "https://stackoverflow.com/questions/44000154/is-it-possible-to-get-a-webpage-that-requires-js-in-golang/59668697#59668697", "title": "Is it possible to get a webpage that requires JS in Golang?", "body": "<p>Yes, it is possible. Like Gonzalez mentioned earlier, PhantomJS is a good choice. But there are some things I would like to clarify, first there is a problem using the phantomgo repository on Linux as the developer doesn't provide the binary of the PanthomJS for Linux.</p>\n<p>The way this repository is used should be using the following instructions:</p>\n<ol>\n<li><code>go get github.com/k4s/phantomgo</code></li>\n<li><code>go get github.com/k4s/webrowser</code></li>\n<li>Download the pre-compiled binary for your platform of PhantomJS on <a href=\"https://phantomjs.org/download.html\" rel=\"nofollow noreferrer\">this page</a>.</li>\n<li>Add the binary to the <code>$GOPATH/src/github.com/k4s/phantomgo/phantomgojs</code> folder.</li>\n</ol>\n<pre><code>import (\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;net/http&quot;\n\n    . &quot;github.com/k4s/webrowser&quot;\n)\n\nfunc main() {\n    p := &amp;Param{\n        Method:       &quot;GET&quot;,\n        Url:          &quot;http://google.com&quot;,\n        Header:       http.Header{&quot;Cookie&quot;: []string{&quot;your cookie&quot;}},\n        UsePhantomJS: true,\n    }\n    brower := NewWebrowse()\n    resp, err := brower.Download(p)\n    if err != nil {\n        fmt.Println(err)\n    }\n    body, err := ioutil.ReadAll(resp.Body)\n    fmt.Println(string(body))\n    fmt.Println(resp.Cookies())\n}\n\n</code></pre>\n"}], "owner": {"reputation": 1700, "user_id": 5674583, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/8WOaR.png?s=128&g=1", "display_name": "Blue Bot", "link": "https://stackoverflow.com/users/5674583/blue-bot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1989, "favorite_count": 0, "accepted_answer_id": 59668697, "answer_count": 3, "score": 2, "last_activity_date": 1607738529, "creation_date": 1494933859, "last_edit_date": 1578744514, "question_id": 44000154, "link": "https://stackoverflow.com/questions/44000154/is-it-possible-to-get-a-webpage-that-requires-js-in-golang", "title": "Is it possible to get a webpage that requires JS in Golang?", "body": "<p>Creating a micro service that gets couple websites main pages html. \nOne of them performs a check for enabled JS and redirects to error page \nif no JS was detected.</p>\n\n<p>Is there a way around it with Golang?</p>\n\n<p>EDIT: attempted to play with <a href=\"https://github.com/robertkrimen/otto\" rel=\"nofollow noreferrer\">this package (JavaScript interpreter)</a> but with no luck..</p>\n\n<p>EDIT2: its 2020, moved to use js <a href=\"https://github.com/puppeteer/puppeteer\" rel=\"nofollow noreferrer\">Puppeteer</a></p>\n\n<p>It uses embedded browser and is a very mature and packed with utilities library. for complex web apps embedded browser is really the only one to go</p>\n\n<p>For backends written in other the js I would still use 'Puppeteer' as a micro service </p>\n\n<p>hope this helps anyone  in the future</p>\n\n<p>thanks</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 3, "last_activity_date": 1494941340, "last_edit_date": 1494941340, "creation_date": 1494933178, "answer_id": 43999900, "question_id": 43999733, "link": "https://stackoverflow.com/questions/43999733/return-value-pointer-syntax/43999900#43999900", "title": "Return value pointer syntax", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">Conversions</a></p>\n  \n  <p>Conversions are expressions of the form <code>T(x</code>) where <code>T</code> is a type and\n  <code>x</code> is an expression that can be converted to type <code>T</code>.</p>\n</blockquote>\n\n<pre><code>type boolValue bool\n\nfunc newBoolValue(val bool, p *bool) *boolValue {\n    *p = val\n    return (*boolValue)(p)\n}\n</code></pre>\n\n<p><code>(*boolValue)(p)</code> is doing a type conversion from <code>*bool</code>, the type of <code>p</code>, to <code>*boolValue</code>, the type of the <code>newBoolValue</code> function return value. Go requires explicit conversions. The conversion is allowed because <code>bool</code> is the underlying type of <code>boolValue</code>.</p>\n\n<p>If you simply write <code>return p</code> without the conversion the compiler error message explains the problem:</p>\n\n<pre><code>return p\n\nerror: cannot use p (type *bool) as type *boolValue in return argument\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494948142, "post_id": 43999924, "comment_id": 75039243, "body": "Technically, it&#39;s converting, not casting.  As JimB likes to point out, Go doesn&#39;t have type casting, only type conversion. <a href=\"http://stackoverflow.com/questions/4049580/what-is-the-difference-between-typecasting-and-typeconversion-in-c-or-java\" title=\"what is the difference between typecasting and typeconversion in c or java\">stackoverflow.com/questions/4049580/&hellip;</a> <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Conversions</a>"}], "tags": [], "owner": {"reputation": 33, "user_id": 5796382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b116228f7900c2955278fb8e1b06ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Costa", "link": "https://stackoverflow.com/users/5796382/ivan-costa"}, "is_accepted": false, "score": 1, "last_activity_date": 1494933226, "creation_date": 1494933226, "answer_id": 43999924, "question_id": 43999733, "link": "https://stackoverflow.com/questions/43999733/return-value-pointer-syntax/43999924#43999924", "title": "Return value pointer syntax", "body": "<p>It is casting the variable <code>p</code> of type <code>*bool</code> to type <code>*boolValue</code>, in order to match the return argument value. It would throw an error otherwise.</p>\n"}, {"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1494937002, "post_id": 44000540, "comment_id": 75030661, "body": "Or, even easier, you could do what the compiler does. Look at the return type in the function declaration. It&#39;s <code>*boolValue</code> in <code>package main</code>. No programming required."}], "tags": [], "owner": {"reputation": 1468, "user_id": 2931765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/eiU4j.jpg?s=128&g=1", "display_name": "Arun G", "link": "https://stackoverflow.com/users/2931765/arun-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1494935012, "creation_date": 1494935012, "answer_id": 44000540, "question_id": 43999733, "link": "https://stackoverflow.com/questions/43999733/return-value-pointer-syntax/44000540#44000540", "title": "Return value pointer syntax", "body": "<p>Type is strict in go. If you see below program which I have crafted it to your change, the Output will be of type <code>*main.boolValue</code>. That's why you are type casting <code>bool</code> type to <code>boolValue</code> type in the return statement.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype boolValue bool\n\nfunc main() {\n    var a bool = true\n    b := &amp;a\n    rtnVal := newBoolValue(a, b)\n    fmt.Println(\"The type of rtnVal is \", reflect.TypeOf(rtnVal))\n}\n\nfunc newBoolValue(val bool, p *bool) *boolValue {\n    *p = val\n    return (*boolValue)(p)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>The type of rtnVal is  *main.boolValue\n</code></pre>\n"}], "owner": {"reputation": 2623, "user_id": 5241780, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/8542490e5ecda0cf556cb0e7403f0812?s=128&d=identicon&r=PG&f=1", "display_name": "chefcurry7", "link": "https://stackoverflow.com/users/5241780/chefcurry7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 1, "accepted_answer_id": 43999900, "answer_count": 3, "score": 0, "last_activity_date": 1494941340, "creation_date": 1494932752, "question_id": 43999733, "link": "https://stackoverflow.com/questions/43999733/return-value-pointer-syntax", "title": "Return value pointer syntax", "body": "<p>In the following code:</p>\n\n<pre><code>type boolValue bool\n\nfunc newBoolValue(val bool, p *bool) *boolValue {\n    *p = val\n    return (*boolValue)(p)\n}\n</code></pre>\n\n<p>What is the last line doing? </p>\n"}, {"tags": ["go", "mocking"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1494931810, "post_id": 43999078, "comment_id": 75026965, "body": "Are you looking for this <a href=\"https://godoc.org/github.com/DATA-DOG/go-sqlmock#ExpectedQuery.WithArgs\" rel=\"nofollow noreferrer\">godoc.org/github.com/DATA-DOG/go-sqlmock#ExpectedQuery.WithA&zwnj;&#8203;rgs</a>? Or do you want to inspect the arguments yourself? If the latter <code>sqlmock</code> does not seem provide an api for that."}, {"owner": {"reputation": 33, "user_id": 5796382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b116228f7900c2955278fb8e1b06ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Costa", "link": "https://stackoverflow.com/users/5796382/ivan-costa"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1494932159, "post_id": 43999078, "comment_id": 75027232, "body": "I wanted to inspect them, thought there should be some way, either with sqlmock or not. The documentation on sqlmock is not too extensive, and I wasn&#39;t able to find what I wanted, so I though that maybe someone have faced the same problem. Thanks anyway :)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1494933650, "post_id": 43999078, "comment_id": 75028266, "body": "If you want to inspect the args anyway, you can write your own mock implementation of the db driver."}], "answers": [{"tags": [], "owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "is_accepted": false, "score": 0, "last_activity_date": 1531303709, "creation_date": 1531303709, "answer_id": 51282744, "question_id": 43999078, "link": "https://stackoverflow.com/questions/43999078/get-argument-value-in-sql-query-with-go-sqlmock/51282744#51282744", "title": "Get argument value in SQL query with go-sqlmock", "body": "<p>You can wrap the real driver with instrumentation to log the values.</p>\n\n<p>Use package <a href=\"https://github.com/luna-duclos/instrumentedsql\" rel=\"nofollow noreferrer\">github.com/luna-duclos/instrumentedsql</a>.</p>\n"}], "owner": {"reputation": 33, "user_id": 5796382, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22b116228f7900c2955278fb8e1b06ed?s=128&d=identicon&r=PG&f=1", "display_name": "Ivan Costa", "link": "https://stackoverflow.com/users/5796382/ivan-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1057, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1531303709, "creation_date": 1494930903, "question_id": 43999078, "link": "https://stackoverflow.com/questions/43999078/get-argument-value-in-sql-query-with-go-sqlmock", "title": "Get argument value in SQL query with go-sqlmock", "body": "<p>I'm currently using <a href=\"https://github.com/DATA-DOG/go-sqlmock/\" rel=\"nofollow noreferrer\">go-sqlmock</a> to mock my database.</p>\n\n<p>Is there any way to get the values that have been passed to the sql driver when performing a query?. Like the <code>arg</code> variable that is been passing as argument here:</p>\n\n<pre><code>import (\n   \"database/sql\"\n)\n\nfunc retrieveInfo(){\n    // this function returns an initialized instance of type *sql.DB\n    DbDriver := initDb()\n\n    query := \"my query\"\n    arg := 3\n    rows, err := Db_driver.Query(query, arg)\n    // ...\n}\n</code></pre>\n\n<p>Then I want to test the function, and I would like to know the value of the variable <code>arg</code> while testing. I think it should be possible, since it is passed to the \"fake\" driver that go-sqlmock creates. My test logic looks like this:</p>\n\n<pre><code>import \"github.com/DATA-DOG/go-sqlmock\"\n\n// Inits mock and overwrites the original driver\ndb, mock, err := sqlmock.New()\nDb_driver = db\n\nfunc TestRetrieveInfo(t *testing.T){\n   // query that matchs the one in retrieveInfo()\n   query := \"...\"\n   queryRows := sqlmock.NewRows([]string{\"column1, column2\"}).FromCSVString(\"value1, value2\")\n   mock.ExpectQuery(query).WillReturnRows(queryRows)\n}\n</code></pre>\n"}, {"tags": ["go", "garbage-collection"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1494924404, "post_id": 43995901, "comment_id": 75021588, "body": "Did you ever implement a compacting GC? Any idea how complicated compactification is?"}, {"owner": {"reputation": 47, "user_id": 7165868, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-5pCTSdM2SPY/AAAAAAAAAAI/AAAAAAAAABE/svWvDoyQc0Q/photo.jpg?sz=128", "display_name": "Bling", "link": "https://stackoverflow.com/users/7165868/bling"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494925071, "post_id": 43995901, "comment_id": 75022014, "body": "@Volker I&#39;m not an expert on gc. But many people  and golang author are. Do you mean it is too difficult to implement for golang expert? Or there are other considerations."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494925318, "post_id": 43995901, "comment_id": 75022174, "body": "Yes. too complicated to get right (correct and low latency)."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1539094413, "post_id": 43995901, "comment_id": 92371598, "body": "Don&#39;t know why you&#39;re getting downvoted (I upvoted you); this is a perfectly reasonable question to ask. I know this has been explained somewhere in the past, but I forget the details. Go&#39;s GC is not generational because the generational hypothesis is less-true for Go (which allocates much on the stack or in continguous blocks) than for pointer-based languages. Not sure about the &#39;compacting&#39; part."}], "answers": [{"comments": [{"owner": {"reputation": 47, "user_id": 7165868, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-5pCTSdM2SPY/AAAAAAAAAAI/AAAAAAAAABE/svWvDoyQc0Q/photo.jpg?sz=128", "display_name": "Bling", "link": "https://stackoverflow.com/users/7165868/bling"}, "edited": false, "score": 0, "creation_date": 1494990041, "post_id": 43996298, "comment_id": 75057341, "body": "Thanks for your reply"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 1, "last_activity_date": 1494923622, "creation_date": 1494923622, "answer_id": 43996298, "question_id": 43995901, "link": "https://stackoverflow.com/questions/43995901/why-golang-garbage-collector-not-implement-generational-and-compact-gc/43996298#43996298", "title": "Why golang garbage-collector not implement Generational and Compact gc?", "body": "<p>I'm not a GC expert, but here are a few links that seem to explain the desig:</p>\n\n<p><a href=\"https://blog.golang.org/go15gc\" rel=\"nofollow noreferrer\">https://blog.golang.org/go15gc</a></p>\n\n<p><a href=\"https://www.youtube.com/watch?v=aiv1JOfMjm0\" rel=\"nofollow noreferrer\">https://www.youtube.com/watch?v=aiv1JOfMjm0</a></p>\n\n<p><a href=\"https://github.com/golang/proposal/blob/master/design/17503-eliminate-rescan.md\" rel=\"nofollow noreferrer\">https://github.com/golang/proposal/blob/master/design/17503-eliminate-rescan.md</a></p>\n"}, {"tags": [], "owner": {"reputation": 47, "user_id": 7165868, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-5pCTSdM2SPY/AAAAAAAAAAI/AAAAAAAAABE/svWvDoyQc0Q/photo.jpg?sz=128", "display_name": "Bling", "link": "https://stackoverflow.com/users/7165868/bling"}, "is_accepted": false, "score": 1, "last_activity_date": 1494989948, "creation_date": 1494989948, "answer_id": 44014771, "question_id": 43995901, "link": "https://stackoverflow.com/questions/43995901/why-golang-garbage-collector-not-implement-generational-and-compact-gc/44014771#44014771", "title": "Why golang garbage-collector not implement Generational and Compact gc?", "body": "<p>Here is the patient and enlightening reply from golang-nuts.</p>\n\n<p><a href=\"https://groups.google.com/forum/#!topic/golang-nuts/KJiyv2mV2pU\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/KJiyv2mV2pU</a></p>\n"}], "owner": {"reputation": 47, "user_id": 7165868, "user_type": "registered", "accept_rate": 25, "profile_image": "https://lh6.googleusercontent.com/-5pCTSdM2SPY/AAAAAAAAAAI/AAAAAAAAABE/svWvDoyQc0Q/photo.jpg?sz=128", "display_name": "Bling", "link": "https://stackoverflow.com/users/7165868/bling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 529, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494989948, "creation_date": 1494922431, "question_id": 43995901, "link": "https://stackoverflow.com/questions/43995901/why-golang-garbage-collector-not-implement-generational-and-compact-gc", "title": "Why golang garbage-collector not implement Generational and Compact gc?", "body": "<p>Generational and Compact gc have already been thought best practice. But golang doesn't adopt it. Who can tell me the reason?</p>\n"}, {"tags": ["go", "gorethink"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1494929746, "post_id": 43995683, "comment_id": 75025555, "body": "<code>Filter</code> returns a new <code>Term</code> so to fix your second problem you need to re-assign <code>q</code> like so: <code>q = q.Filter(some_filter) ...</code>."}, {"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1494934351, "post_id": 43995683, "comment_id": 75028774, "body": "@mkopriva add this as answer. You saved my day :)"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 0, "last_activity_date": 1494934786, "creation_date": 1494934786, "answer_id": 44000473, "question_id": 43995683, "link": "https://stackoverflow.com/questions/43995683/why-contains-in-filterfunc-is-not-working-in-gorethink-and-parts-of-query-g/44000473#44000473", "title": "Why Contains in .Filter(func()) is not working in gorethink and parts of query get ignored?", "body": "<p>Since the <a href=\"https://godoc.org/github.com/GoRethink/gorethink#Term.Filter\" rel=\"nofollow noreferrer\">Filter</a> method returns a new <a href=\"https://godoc.org/github.com/GoRethink/gorethink#Term\" rel=\"nofollow noreferrer\">Term</a>, which will contain the expression of the previous term, you need to re-assing the result back to <code>q</code>.</p>\n\n<pre><code>if some_condition {\n   q = q.Filter(some_filter)\n}\n\nif some_other_condition {\n   q = q.Filter(some_other_filter)\n}\n</code></pre>\n"}], "owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 231, "favorite_count": 0, "accepted_answer_id": 44000473, "answer_count": 1, "score": 1, "last_activity_date": 1494934786, "creation_date": 1494921729, "question_id": 43995683, "link": "https://stackoverflow.com/questions/43995683/why-contains-in-filterfunc-is-not-working-in-gorethink-and-parts-of-query-g", "title": "Why Contains in .Filter(func()) is not working in gorethink and parts of query get ignored?", "body": "<p>I am trying to do this:</p>\n\n<pre><code>r.table(table).filter(\n  function (doc) {\n    return r.expr(array)\n            .contains(doc(\"name\"));\n  }\n)\n</code></pre>\n\n<p>written in golang that is</p>\n\n<pre><code>rethink.Table(table).GetAllByIndex(index, value).Filter(func(row rethink.Term) interface {}{\n\n    return rethink.Expr([]string{}).Contains(row.Field(\"type\"))\n})\n</code></pre>\n\n<p>I am not sure but it is like rethink.Expr is ignored.\nThat is first problem.</p>\n\n<p>Second problem is next. If I have query written like this:</p>\n\n<pre><code>query := rethink.Table(table).GetAllByIndex(index, value)\n</code></pre>\n\n<p>and then try to do next:</p>\n\n<pre><code>if some_condition {\n   q.Filter(some_filter)\n}\n\nif some_other_condition {\n   q.Filter(some_other_filter)\n}\n</code></pre>\n\n<p>when i print out <code>q.String()</code> i got only that first part and everything else is ignored <code>rethink.Table(table).GetAllByIndex(index, value)</code></p>\n"}, {"tags": ["go", "gocql", "scylla"], "answers": [{"tags": [], "owner": {"reputation": 1042, "user_id": 4717332, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh6.googleusercontent.com/-zblXDEPPjlc/AAAAAAAAAAI/AAAAAAAAA1o/sLmKrBChnYM/photo.jpg?sz=128", "display_name": "Avi Kivity", "link": "https://stackoverflow.com/users/4717332/avi-kivity"}, "is_accepted": true, "score": 2, "last_activity_date": 1495029329, "last_edit_date": 1495029329, "creation_date": 1494926909, "answer_id": 43997532, "question_id": 43992997, "link": "https://stackoverflow.com/questions/43992997/make-a-blocking-consistent-predictable-reply-request-on-scylladb-via-gocql/43997532#43997532", "title": "Make a blocking/consistent/predictable reply/request on ScyllaDB via GoCQL", "body": "<p><code>DROP TABLE</code> and <code>CREATE TABLE</code> can take a lot longer than ordinary queries.  You can try to increase the timeouts for these queries.</p>\n\n<p>For example: <code>clust.Timeout = 8 * time.Second</code></p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 1, "accepted_answer_id": 43997532, "answer_count": 1, "score": 1, "last_activity_date": 1495029329, "creation_date": 1494911590, "question_id": 43992997, "link": "https://stackoverflow.com/questions/43992997/make-a-blocking-consistent-predictable-reply-request-on-scylladb-via-gocql", "title": "Make a blocking/consistent/predictable reply/request on ScyllaDB via GoCQL", "body": "<p>Sometimes when running a command it shows a timeout (<code>gocql: no response received from cassandra within timeout period</code>), for example: </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"github.com/gocql/gocql\"\nimport \"time\"\nimport \"log\"\n\nfunc main() {\n    clust := gocql.NewCluster(`172.17.0.2`) // docker@localhost\n    clust.Keyspace = `test4`\n    clust.RetryPolicy = &amp;gocql.SimpleRetryPolicy{NumRetries: 3}\n    db, err := clust.CreateSession()\n    defer db.Close()\n    if err != nil {\n        log.Fatal(err)\n        return\n    }\n    fmt.Println(`test4: scylladb`)\n\n    if err := db.Query(`DROP TABLE test4`).Exec(); err != nil {\n        log.Println(err)\n    }\n    if err := db.Query(`CREATE TABLE test4 (bucket text, k text, v TEXT, PRIMARY KEY(bucket,k))`).Exec(); err != nil {\n        log.Fatal(err)\n        return\n    }\n\n    const max = 999\n    const jump = 40\n    t := time.Now()\n    for x := 1; x &lt;= max; x++ {\n        err = db.Query(fmt.Sprintf(`INSERT INTO test4(bucket,k,v)VALUES('foo','%05d','%05d')`, x, x)).Exec()\n        if err != nil {\n            log.Fatal(err)\n            return\n        }\n        if x % 200 == 0 {\n            fmt.Print(`.`)\n        }\n    }\n    dur := time.Now().Sub(t)\n    fmt.Printf(\"INSERT: %v (%.2f ms/op)\\n\", dur, float64(dur.Nanoseconds()) / 1000000 / max)\n\n    t = time.Now()\n    for x := 1; x &lt;= max; x++ {\n        err = db.Query(fmt.Sprintf(`UPDATE test4 SET v = '%06d' WHERE bucket = 'foo' AND k = '%05d'`, x, x)).Exec()\n        if err != nil {\n            log.Fatal(err)\n            return\n        }\n        if x % 200 == 0 {\n            fmt.Print(`.`)\n        }\n    }\n    dur = time.Now().Sub(t)\n    fmt.Printf(\"UPDATE: %v (%.2f ms/op)\\n\", dur, float64(dur.Nanoseconds()) / 1000000 / max)\n\n    t = time.Now()\n    ops := int64(0)\n    for y := 2; y &lt; jump; y++ {\n        for x := max - 1; x &gt; 0; x -= y {\n            ops++\n            iter := db.Query(fmt.Sprintf(`SELECT k, v FROM test4 WHERE bucket = 'foo' AND  k &gt;= '%05d' ORDER BY k ASC LIMIT %d`, x, y * y)).Iter()\n            for {\n                m := map[string]interface{}{}\n                if !iter.MapScan(m) {\n                    break\n                }\n            }\n            iter.Close()\n            if ops % 500 == 0 {\n                fmt.Print(`.`)\n            }\n        }\n        for x := 1; x &lt; max; x += y {\n            ops++\n            iter := db.Query(fmt.Sprintf(`SELECT k, v FROM test4 WHERE bucket = 'foo' AND k &lt;= '%05d' ORDER BY k DESC LIMIT %d`, x, y * y)).Iter()\n            for {\n                m := map[string]interface{}{}\n                if !iter.MapScan(m) {\n                    break\n                }\n            }\n            iter.Close()\n            if ops % 500 == 0 {\n                fmt.Print(`.`)\n            }\n        }\n    }\n    dur = time.Now().Sub(t)\n    fmt.Printf(\"SELECT: %v (%.2f ms/op)\\n\", dur, float64(dur.Nanoseconds()) / 1000000 / float64(ops))\n\n}\n</code></pre>\n\n<p>It shows inconsistent output:</p>\n\n<pre><code>$ go run scylla.go\ntest4: scylladb\n2017/05/16 12:09:05 gocql: no response received from cassandra within timeout period\n2017/05/16 12:09:05 gocql: no response received from cassandra within timeout period\nexit status 1\n\n$ go run scylla.go \ntest4: scylladb\n....INSERT: 188.277521ms (0.19 ms/op)\n....UPDATE: 150.403282ms (0.15 ms/op)\n.............SELECT: 5.357779756s (0.82 ms/op)\n\n$ go run scylla.go \ntest4: scylladb\n2017/05/16 12:09:50 gocql: no response received from cassandra within timeout period\n....INSERT: 142.91132ms (0.14 ms/op)\n....UPDATE: 144.272872ms (0.14 ms/op)\n.............SELECT: 5.268130283s (0.81 ms/op)\n\n$ go run scylla.go \ntest4: scylladb\n2017/05/16 12:10:00 gocql: no response received from cassandra within timeout period\n2017/05/16 12:10:00 gocql: no response received from cassandra within timeout period\nexit status 1\n\n$ go run scylla.go \ntest4: scylladb\n....INSERT: 184.402052ms (0.18 ms/op)\n....UPDATE: 158.200184ms (0.16 ms/op)\n.............SELECT: 5.345212835s (0.82 ms/op)\n</code></pre>\n\n<p>How to make it consistent? I need to be sure if a command completed successfully.. Or should I loop the <code>DROP TABLE/CREATE TABLE</code> command manually?</p>\n"}, {"tags": ["go", "append"], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 3, "last_activity_date": 1494906772, "creation_date": 1494906772, "answer_id": 43992202, "question_id": 43991754, "link": "https://stackoverflow.com/questions/43991754/why-golang-append-same-slice-result-will-share-one-memory-address/43992202#43992202", "title": "Why golang append same slice result will share one memory address?", "body": "<p>Append will only allocate a new array if there isn't sufficient capacity in the slice you're appending to. If you need to have a separate array, use <code>make</code> to create a new slice and use <code>copy</code> to copy whatever you need from the original slice.</p>\n\n<p><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">This article</a> gives a good explanation of how slices work.</p>\n"}], "owner": {"reputation": 6317, "user_id": 2849157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/81de56159f8a6f58c78e3e7d88d7fbe5?s=128&d=identicon&r=PG&f=1", "display_name": "roger", "link": "https://stackoverflow.com/users/2849157/roger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 198, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1494906772, "creation_date": 1494903338, "question_id": 43991754, "link": "https://stackoverflow.com/questions/43991754/why-golang-append-same-slice-result-will-share-one-memory-address", "title": "Why golang append same slice result will share one memory address?", "body": "<p>I thought <code>append</code> in go, will return a new result, but I find that append in same slice will return same memory address:</p>\n\n<pre><code>func TestRuneAppend3(t *testing.T) {\n    r := make([][]rune, 256)\n    r[0] = append(r[0], 99)  // c\n    r[1] = append(r[0], 100) // d\n    r[2] = append(r[0], 101) // e\n    // I thought it would be \"c cd ce\", but it is \"c ce ce\"\n    log.Println(string(r[0]), string(r[1]), string(r[2]))\n}\n</code></pre>\n\n<p>So what is the best way if I want to the result is <code>c cd ce</code>?</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1494883051, "post_id": 43988866, "comment_id": 75007089, "body": "That function doesn&#39;t do anything, it&#39;s effectively the same as direct assignment"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1494884134, "post_id": 43988866, "comment_id": 75007537, "body": "Are you trying to create a new slice header that points to the same underlying array?  If so, as @JimB pointed out, just subslice directly (ex. <code>newS := s[1:7]</code>).  If you want it to <i>copy</i> that subslice&#39;s data to a different underlying array (so changes to either one don&#39;t affect the other), use the built-in <code>copy()</code> function."}, {"owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "edited": false, "score": 0, "creation_date": 1494885144, "post_id": 43988866, "comment_id": 75007937, "body": "Ok I get it. I am new to go so I guess I misinterpreted what was happening there. That explains why I have not seen that technique before."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 1, "creation_date": 1494896401, "post_id": 43988866, "comment_id": 75010802, "body": "Read through the <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">go blog post on slices</a>, it&#39;s good to have a solid understanding of how slices and arrays relate to each other, otherwise you could have some surprises."}], "answers": [{"tags": [], "owner": {"reputation": 23687, "user_id": 473625, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/b3c0cab2d4cafff293f8f4f69f141de1?s=128&d=identicon&r=PG", "display_name": "BentOnCoding", "link": "https://stackoverflow.com/users/473625/bentoncoding"}, "is_accepted": false, "score": 0, "last_activity_date": 1494900890, "creation_date": 1494900890, "answer_id": 43991487, "question_id": 43988866, "link": "https://stackoverflow.com/questions/43988866/golang-is-this-an-acceptable-way-to-create-a-slice-from-part-of-another-slice/43991487#43991487", "title": "Golang: Is this an acceptable way to create a Slice from part of another Slice?", "body": "<p>A slice can be created with the built-in function called make, which has the signature,</p>\n\n<pre><code>func make([]T, len, cap) []T\n</code></pre>\n\n<p>Recommended Reading : </p>\n\n<p><a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-slices-usage-and-internals</a></p>\n"}], "owner": {"reputation": 83, "user_id": 7975221, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/1701896196493929/picture?type=large", "display_name": "Stephen Adams", "link": "https://stackoverflow.com/users/7975221/stephen-adams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 294, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1494900890, "creation_date": 1494882612, "question_id": 43988866, "link": "https://stackoverflow.com/questions/43988866/golang-is-this-an-acceptable-way-to-create-a-slice-from-part-of-another-slice", "title": "Golang: Is this an acceptable way to create a Slice from part of another Slice?", "body": "<p>I have searched around and have not found another example of this being done but I inadvertently discovered that I was able to create a slice from a fragment of another slice by simply passing that fragment to a function that accepts a slice and returning that slice.</p>\n\n<p>Example:</p>\n\n<pre><code>   package main\n\nimport \"fmt\"\n\nfunc makeSliceFrom(s []int) []int {\n    return s\n}\n\nfunc main() {\n    s := []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n    newS := makeSliceFrom(s[1:7])\n    fmt.Println(newS)\n}\n</code></pre>\n\n<p>I am not asking if this works, because I know it works and seems to work well, I am asking if this is supported or has some unforeseen cost that I am not aware of. It seems odd that I have not seen any examples of this being done.  </p>\n"}, {"tags": ["go", "eclipse-che", "delve"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494877401, "post_id": 43987476, "comment_id": 75004485, "body": "You are suppose to supply a package name to <code>debug</code>. It defaults to the main package if you omit it."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494878331, "post_id": 43987476, "comment_id": 75004839, "body": "This may be unrelated, but on install I got this warning <code>If you get &quot;could not launch process: could not fork&#47;exec&quot;, you need to try in a new terminal.</code>"}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1494921225, "post_id": 43987476, "comment_id": 75019511, "body": "Thanks @RayfenWindspear same thing package or not. Did you start the docker container with --privileged."}, {"owner": {"reputation": 470, "user_id": 2331089, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/758cee5a720d8e644a7a047386e4b998?s=128&d=identicon&r=PG&f=1", "display_name": "bianchi", "link": "https://stackoverflow.com/users/2331089/bianchi"}, "edited": false, "score": 0, "creation_date": 1513784681, "post_id": 43987476, "comment_id": 82790876, "body": "Were you able to do that same in a Docker container? Let&#39;s take Che out of equation for a while."}, {"owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "edited": false, "score": 0, "creation_date": 1513797591, "post_id": 43987476, "comment_id": 82793643, "body": "Yes, it works in docker container - make sure that you have the same versions on host and in container."}], "answers": [{"tags": [], "owner": {"reputation": 128, "user_id": 1640888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b004a98592b8394a1d8d5e19a2696782?s=128&d=identicon&r=PG", "display_name": "gaal", "link": "https://stackoverflow.com/users/1640888/gaal"}, "is_accepted": false, "score": 0, "last_activity_date": 1507039176, "creation_date": 1507039176, "answer_id": 46546456, "question_id": 43987476, "link": "https://stackoverflow.com/questions/43987476/unable-to-run-delve-in-eclipse-che-could-not-launch-process-operation-not-per/46546456#46546456", "title": "unable to run delve in eclipse che - could not launch process, operation not permitted", "body": "<p>Adding --privileged adds capabilities to Eclipse Che CLI only.\nInstead of that add <code>CHE_DOCKER_PRIVILEGED=true</code> line to che.env file inside of Che data directory mounted to <code>/data</code> </p>\n"}], "owner": {"reputation": 18037, "user_id": 699215, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dac451eeb6941e002e455f5a4e48bf9b?s=128&d=identicon&r=PG", "display_name": "Chris G.", "link": "https://stackoverflow.com/users/699215/chris-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 259, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1513784681, "creation_date": 1494876926, "question_id": 43987476, "link": "https://stackoverflow.com/questions/43987476/unable-to-run-delve-in-eclipse-che-could-not-launch-process-operation-not-per", "title": "unable to run delve in eclipse che - could not launch process, operation not permitted", "body": "<p>I am trying to use <a href=\"https://github.com/derekparker/delve\" rel=\"nofollow noreferrer\">delve</a> in Eclipse Che</p>\n\n<p>Running Eclipse Che in docker with</p>\n\n<pre><code>--privileged\n</code></pre>\n\n<p>is not helping</p>\n\n<pre><code>docker run -it  --privileged --rm -v /var/run/docker.sock:/var/run/docker.sock -v $(pwd):/data eclipse/che start\n</code></pre>\n\n<p>When running <code>dlv debug main.go</code> I get <code>could not launch process: fork/exec /projects/desktop-go-simple/debug: operation not permitted</code></p>\n\n<p>Can you run dlv debugger in Eclipse Che</p>\n"}, {"tags": ["parsing", "go", "time", "timezone"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494866913, "post_id": 43984453, "comment_id": 74998785, "body": "What TZ do you want it to be associated with in the end? UTC or local?"}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1494866938, "post_id": 43984453, "comment_id": 74998797, "body": "@peterSO Question is clear and doesn&#39;t require any code to me. If you disagree, you can downvote."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1494866960, "post_id": 43984453, "comment_id": 74998814, "body": "What is the exact format in your database? Is there a TZ explicitly associated with it at all?"}], "answers": [{"comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494868075, "post_id": 43984806, "comment_id": 74999461, "body": "Thanks that&#39;s a good lead. Any thoughts about DST with this ? I guess there is no way to know about it since the MySQL datetime type does not store any tz/offset."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494868297, "post_id": 43984806, "comment_id": 74999580, "body": "Ug. Time is the worst. You really have local timestamps that adjust to DST without notating anything about their timezone info? If so, I can&#39;t think of a way other than checking dates and adjusting the offset."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1494868504, "post_id": 43984806, "comment_id": 74999694, "body": "Storing timestamps without timezone information really should be a capital offense..."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 1, "creation_date": 1494868546, "post_id": 43984806, "comment_id": 74999715, "body": "Storing anything other than utc at all is just asking for trouble."}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1494868568, "post_id": 43984806, "comment_id": 74999735, "body": "Yes, the mysql server is inserting dates based on its configured timezone which is Europe/Paris and sadly the datetime type does not carry any tz/offset. Anyway I&#39;m goind to mark yhis as accepted since it fit my request. I didn&#39;t though about that in the first place. @Kaedys I agree, but this is a very old legacy DB for which I have little control."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 0, "last_activity_date": 1494866637, "creation_date": 1494866637, "answer_id": 43984806, "question_id": 43984453, "link": "https://stackoverflow.com/questions/43984453/change-time-time-timezone-without-reparsing/43984806#43984806", "title": "Change time.Time timezone without reparsing", "body": "<p>Can you just <code>Add</code> a fixed offest to them?</p>\n\n<pre><code>t,_ := time.Parse(...)\nt = t.Add(-4 * time.Hour) // or whatever offset makes it work\n\n// t is now correct utc time\n// In should work less badly:\nlocalTime := t.In(myRealLocation)\n</code></pre>\n"}], "owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "accepted_answer_id": 43984806, "answer_count": 1, "score": -1, "last_activity_date": 1494866637, "creation_date": 1494865412, "question_id": 43984453, "link": "https://stackoverflow.com/questions/43984453/change-time-time-timezone-without-reparsing", "title": "Change time.Time timezone without reparsing", "body": "<p>I am dealing with time.Time objects that has been parsed with the wrong timezone. They internally have a UTC tz but the original data come from a legacy MySQL database that internally store datetimes with the timezone Europe/Paris.</p>\n\n<p>I would like to change the internal timezone of the time without reparsing it. I have tried the time.In() function but it does not solve my use case because it return the same time for another timezone.</p>\n\n<p>My ultimate solution would be to use <a href=\"https://golang.org/pkg/time/#ParseInLocation\" rel=\"nofollow noreferrer\">https://golang.org/pkg/time/#ParseInLocation</a> to recreate the date from the value of the original with the proper location. However if this could be avoided this would be better.</p>\n\n<p>Any thoughts ?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "flatbuffers"], "answers": [{"tags": [], "owner": {"reputation": 4578, "user_id": 17419, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JU9iE.jpg?s=128&g=1", "display_name": "Aardappel", "link": "https://stackoverflow.com/users/17419/aardappel"}, "is_accepted": false, "score": 1, "last_activity_date": 1494865558, "creation_date": 1494865558, "answer_id": 43984502, "question_id": 43983274, "link": "https://stackoverflow.com/questions/43983274/dynamic-flatbuffers-delimiter/43984502#43984502", "title": "Dynamic FlatBuffers delimiter", "body": "<p>FlatBuffers does not include a length field by design, since in most context the length is an implicit part of the storage or transfer of a buffer.</p>\n\n<p>If you have no way to know the size of a buffer, or you are streaming buffers, the best is to simply pre-fix any buffer with a 32bit length field, so you can use that to read the rest of the data.</p>\n\n<p>In the C++ API this is even built-in (see <code>SizePrefixed</code> functions), but this hasn't been ported to Go yet, so you'd have to do it manually.</p>\n"}], "owner": {"reputation": 415, "user_id": 7844239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4592b2e5235c0a47eb851d1a58d942?s=128&d=identicon&r=PG&f=1", "display_name": "J Aamish", "link": "https://stackoverflow.com/users/7844239/j-aamish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 306, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494865558, "creation_date": 1494861949, "question_id": 43983274, "link": "https://stackoverflow.com/questions/43983274/dynamic-flatbuffers-delimiter", "title": "Dynamic FlatBuffers delimiter", "body": "<p>I'm using flatbuffer to send binary data over unix socket. The flatbuffer that I send is of dynamic length. The problem I'm facing is, how to know how many bytes I have to read for one table. </p>\n\n<p>Is there something like a delimiter that can be appended while sending, which I can use to determine the end of the flatbuffer. </p>\n\n<p>When I tried with a smaller size</p>\n\n<pre><code>    buf := make([]byte, 512)\n    nr, err := c.Read(buf)\n    if err != nil {\n        fmt.Println(\"exit echo\")\n        return\n    }\n</code></pre>\n\n<p>And if the flatbuffer that is bigger than 512 bytes is read, then this results in failure.</p>\n\n<p>When I read by growing my buffer, then I'm not able to find the end of the read</p>\n\n<pre><code>var n, nr int\nvar err error\nbuf := make([]byte, 0, 4096) // big buffer\ntmp := make([]byte, 512)\nfor {\n    n, err = c.Read(tmp)\n    if err != nil {\n        break\n    }\n    nr += n\n    if nr &gt;= 4096 {\n        err = errOverrun\n        break\n    }\n    buf = append(buf, tmp[:n]...)\n}\nif err != nil {\n    fmt.Println(\"read error:\", err)\n    break\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1494859253, "post_id": 43982182, "comment_id": 74993712, "body": "You must provide <b>much</b> <b>more</b> <b>details</b>. 20&#39;000 lines of code is not per se too much, but 20&#39;000 lines of string concatenations might be a problem. Try to come up with a much smaller code base and increase until the break happens."}, {"owner": {"reputation": 1, "user_id": 8014841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61a26c207f19e9eb02b0d17b17383d6?s=128&d=identicon&r=PG&f=1", "display_name": "Petran Den", "link": "https://stackoverflow.com/users/8014841/petran-den"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494859513, "post_id": 43982182, "comment_id": 74993910, "body": "Sorry, two files are 315000. I do not have such a big string."}, {"owner": {"reputation": 165027, "user_id": 1902010, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/a19f9308334d07d4be19c8f6d11151ff?s=128&d=identicon&r=PG", "display_name": "ceejayoz", "link": "https://stackoverflow.com/users/1902010/ceejayoz"}, "edited": false, "score": 2, "creation_date": 1494859729, "post_id": 43982182, "comment_id": 74994083, "body": "Why does your application need 630,000 lines of auto-generated code? This seems like an <a href=\"http://xyproblem.info/\" rel=\"nofollow noreferrer\">XY problem</a>."}, {"owner": {"reputation": 1, "user_id": 8014841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61a26c207f19e9eb02b0d17b17383d6?s=128&d=identicon&r=PG&f=1", "display_name": "Petran Den", "link": "https://stackoverflow.com/users/8014841/petran-den"}, "edited": false, "score": 0, "creation_date": 1494861783, "post_id": 43982182, "comment_id": 74995572, "body": "The application tries to parse a DSL (pseudocode) definition files and translated to Go code. I can&#39;t write myself the code for 50000 files so i created a parser that translates him at go"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 8014841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61a26c207f19e9eb02b0d17b17383d6?s=128&d=identicon&r=PG&f=1", "display_name": "Petran Den", "link": "https://stackoverflow.com/users/8014841/petran-den"}, "edited": false, "score": 0, "creation_date": 1494861348, "post_id": 43982763, "comment_id": 74995310, "body": "I created parser for DSL (pseudocode) files and translated to Go code. At first i had about 3 huge files and man smaller ones (those i created myself and they contained the functions ,functionality of the parsed code). With those 3 huge files the compile time wa sabout 1-2 minutes (go install).  When i added 9 more generated files the compiler run for at least one hour and freezes my system."}, {"owner": {"reputation": 1, "user_id": 8014841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61a26c207f19e9eb02b0d17b17383d6?s=128&d=identicon&r=PG&f=1", "display_name": "Petran Den", "link": "https://stackoverflow.com/users/8014841/petran-den"}, "edited": false, "score": 0, "creation_date": 1494861422, "post_id": 43982763, "comment_id": 74995358, "body": "When i tried go build it returned me after some time compiler signal killed.."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1494860480, "creation_date": 1494860480, "answer_id": 43982763, "question_id": 43982182, "link": "https://stackoverflow.com/questions/43982182/slow-build-time/43982763#43982763", "title": "Slow build time", "body": "<p>Large Go projects are not necessarily a problem. For example, Canonical's Juju is large:</p>\n\n<blockquote>\n  <p>As of this writing, the main repo for Juju,\n  <a href=\"http://github.com/juju/juju\" rel=\"nofollow noreferrer\">http://github.com/juju/juju</a>, is 3542 files, with 540,000 lines of Go\n  code (not included in that number is 65,000 lines of comments).\n  Counting all dependencies except the standard library, Juju is 9523\n  files, holding 1,963,000 lines of Go code (not including comments,\n  which clock in at 331,000 lines).</p>\n  \n  <p><a href=\"https://npf.io/2017/03/3.5yrs-500k-lines-of-go/\" rel=\"nofollow noreferrer\">3.5 Years, 500k Lines of Go (Part 1)</a></p>\n</blockquote>\n\n<p>Compile times seem reasonable, less than 500 seconds: <a href=\"https://groups.google.com/forum/#!topic/golang-dev/DpMyPbclI3o\" rel=\"nofollow noreferrer\">Compiler performance with a huge project</a>.</p>\n\n<p>What are you doing exactly, and why? Why are you using such a small machine?</p>\n"}], "owner": {"reputation": 1, "user_id": 8014841, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d61a26c207f19e9eb02b0d17b17383d6?s=128&d=identicon&r=PG&f=1", "display_name": "Petran Den", "link": "https://stackoverflow.com/users/8014841/petran-den"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 1, "closed_date": 1494875514, "answer_count": 1, "score": -8, "last_activity_date": 1494875497, "creation_date": 1494858847, "last_edit_date": 1494875497, "question_id": 43982182, "link": "https://stackoverflow.com/questions/43982182/slow-build-time", "closed_reason": "Not suitable for this site", "title": "Slow build time", "body": "<p>I've created an application in Go. It contains 12 huge  files, 6 of them 20000 line of codes and 6 of them 50000 lines of code. There are other files with smaller code. The large files are generated from pseudocode.\nI try to compile and the time is greater than 1 hour and it did't get completed. I stopped it myself.\nThis time is houge for development.\nIt this behavior normal? What can i do to reduce the time?</p>\n\n<p>My system is I3 with 8GB RAM</p>\n"}, {"tags": ["go", "graph", "cycle"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6842413, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nJC6Db4g_wo/AAAAAAAAAAI/AAAAAAAAAAw/iNltHEwImjg/photo.jpg?sz=128", "display_name": "Nour saadallah", "link": "https://stackoverflow.com/users/6842413/nour-saadallah"}, "edited": false, "score": 0, "creation_date": 1494942130, "post_id": 43983203, "comment_id": 75034715, "body": "Okay thank you, i found that question previously but since i&#39;m new and couldn&#39;t comment i&#39;m gonna ask it here :    How does this DFS algorithm keep the cycle in memory (i can&#39;t seem to know how to return the cycle once it&#39;s found)?  dfs(adj,node,visited):      if (visited[node]):         if (node == start):           &quot;found a path&quot;         return;       visited[node]=YES;       for child in adj[node]:         dfs(adj,child,visited)     visited[node]=NO;"}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1494959079, "post_id": 43983203, "comment_id": 75045995, "body": "A cycle can be represented as a path, an ordered sequence of edges, such that <code>edges[0].start == edges[len(edges)].end</code>"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 2, "last_activity_date": 1494861775, "last_edit_date": 1495541899, "creation_date": 1494861775, "answer_id": 43983203, "question_id": 43982089, "link": "https://stackoverflow.com/questions/43982089/find-all-cycles-in-a-directed-graph-golang/43983203#43983203", "title": "Find all cycles in a directed Graph Golang", "body": "<p>There are two parts to the question.</p>\n\n<p>Regarding algorithms to detect all cycles in a graph, take a look at this related question (since this is not go-specific), there are useful explanations and pseudo-code that you can use to implement your solution.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/546655/finding-all-cycles-in-a-directed-graph\">Finding all cycles in a directed graph</a></p>\n\n<p>As per specific go code, there are several libraries out there that work with graphs, you can take a look at their documentation and source code (they might even provide functionality that you can use out-of-the-box to solve your problem).</p>\n\n<p>For example: <a href=\"https://godoc.org/github.com/twmb/algoimpl/go/graph\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/twmb/algoimpl/go/graph</a></p>\n"}, {"tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": false, "score": 0, "last_activity_date": 1494862571, "last_edit_date": 1495535469, "creation_date": 1494862571, "answer_id": 43983512, "question_id": 43982089, "link": "https://stackoverflow.com/questions/43982089/find-all-cycles-in-a-directed-graph-golang/43983512#43983512", "title": "Find all cycles in a directed Graph Golang", "body": "<p>I would suggest starting with defining what a cycle is - for example let's suppose it is a traversal through the graph that starts and ends in the same node.</p>\n\n<p>To enumerate all cycles with this definition, you'll need to consider all paths starting from all nodes, and check if any of those paths go back to their start point.</p>\n\n<p>However, observe that this definition can actually count each cyclical subgraph many times - any node along a cyclical path - is that one cycle or several? And things get even more complicated if the paths of several cycles intersect, the number of cyclical paths increases drastically, and it's not very clear which cycles are \"the same\".</p>\n\n<p>I hope it's easy to see that a brute force approach is intractable for anything but very small and simple graphs, and that something concerned with say minimal cycles or even just identifying cyclic subgraphs is enough for your purposes. </p>\n\n<p>As already mentioned by @eugenioy, this has been <a href=\"https://stackoverflow.com/questions/546655/finding-all-cycles-in-a-directed-graph\">asked before</a> and you can probably narrow down your question by looking at the answers in that thread.</p>\n\n<p>So, depending on what you mean by \"all\" and what you mean by \"cycles\", you can probably find an algorithm that defines cycles in the same way that you are interested in, and, and ask a more focused question if you're having trouble translating it to Go, which I don't think your question is really about at the moment.</p>\n"}], "owner": {"reputation": 1, "user_id": 6842413, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nJC6Db4g_wo/AAAAAAAAAAI/AAAAAAAAAAw/iNltHEwImjg/photo.jpg?sz=128", "display_name": "Nour saadallah", "link": "https://stackoverflow.com/users/6842413/nour-saadallah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1938, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1494862571, "creation_date": 1494858554, "last_edit_date": 1494860661, "question_id": 43982089, "link": "https://stackoverflow.com/questions/43982089/find-all-cycles-in-a-directed-graph-golang", "title": "Find all cycles in a directed Graph Golang", "body": "<p>I'm trying to generate all the cycles contained in a directed graph using Golang (or at least a few).<br>\nI currently have two structs :  </p>\n\n<pre><code>Node : { ID (string), resolved (bool), edges ([]Edge) }  \nEdge : { ID (string), start (Node), end (Node), weight (Float64)}  \n</code></pre>\n\n<p>The cycle weight is not an issue (for the moment).\nI've found some answers regarding how to detect cycles, or find shortest path etc. but i didn't find an algorithm that can quite help me.<br>\nHow shall I proceed? (any suggestion is welcome)  </p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1494855221, "creation_date": 1494855221, "answer_id": 43980966, "question_id": 43979440, "link": "https://stackoverflow.com/questions/43979440/how-to-reach-route-parameters-in-middleware/43980966#43980966", "title": "How to reach route parameters in middleware?", "body": "<p>The way you have it setup you will not be able to access the <code>username</code>. The reason for that is that your <code>AuthMiddleware</code> is executed <strong>before</strong> the path parameters are extracted by the <code>router</code> since it is wrapped inside your middleware (<code>AuthMiddleware(router)</code>).</p>\n\n<p>You need use your middleware to wrap your handlers and then register it with the router like so:</p>\n\n<pre><code>router := mux.NewRouter().StrictSlash(true)\nrouter.HandleFunc(\"/{username}/accounts\", AuthMiddleware(AccountListHandler))\n\nlog.Fatal(http.ListenAndServe(\":8080\", router))\n</code></pre>\n\n<p>If you have many handlers that you want to wrap with your middleware without having to repeat yourself too much you can write a simple loop like so:</p>\n\n<pre><code>var handlers = map[string]http.HandlerFunc{\n    \"/{username}/accounts\": AccountListHandler,\n    // ...\n}\n\nrouter := mux.NewRouter().StrictSlash(true)    \nfor pattern, handler := range handlers {\n    router.HandleFunc(pattern, AuthMiddleware(handler))\n}\n\nlog.Fatal(http.ListenAndServe(\":8080\", router))\n</code></pre>\n"}], "owner": {"reputation": 2236, "user_id": 1027507, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3gfz.jpg?s=128&g=1", "display_name": "Mesut Tasci", "link": "https://stackoverflow.com/users/1027507/mesut-tasci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 831, "favorite_count": 0, "accepted_answer_id": 43980966, "answer_count": 1, "score": 2, "last_activity_date": 1494855221, "creation_date": 1494850923, "question_id": 43979440, "link": "https://stackoverflow.com/questions/43979440/how-to-reach-route-parameters-in-middleware", "title": "How to reach route parameters in middleware?", "body": "<p>I am using gorilla mux for request routing.\nI wrote a basic middleware which I want to add <code>user</code> variable to context for reach in handlers. But I chould not found how can I get route parameter in the middleware:</p>\n\n<pre><code>router := mux.NewRouter().StrictSlash(true)\nrouter.HandleFunc(\"/{username}/accounts\", AccountListHandler)\n\nlog.Fatal(http.ListenAndServe(\":8080\", AuthMiddleware(router)))\n</code></pre>\n\n<p>Middleware code:</p>\n\n<pre><code>func AuthMiddleware(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // params := mux.Vars(r)\n        // fmt.Printf(\"%v\", params[\"username\"])\n        user := User{Username: \"myUsername\"}\n        ctx := context.WithValue(r.Context(), \"user\", user)\n        h.ServeHTTP(w, r.WithContext(ctx))\n    })\n}\n</code></pre>\n\n<p>I want to reach <code>username</code> paramter in the middleware. How can I do this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 3, "creation_date": 1494849420, "post_id": 43978124, "comment_id": 74986849, "body": "Show some code."}, {"owner": {"reputation": 912, "user_id": 6012434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MZcOa.png?s=128&g=1", "display_name": "Robo", "link": "https://stackoverflow.com/users/6012434/robo"}, "reply_to_user": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494884138, "post_id": 43978124, "comment_id": 75007541, "body": "The full source is linked in the question. <a href=\"https://github.com/patrobinson/go-fish\" rel=\"nofollow noreferrer\">github.com/patrobinson/go-fish</a>"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1494888546, "post_id": 43978124, "comment_id": 75008992, "body": "Don&#39;t expect that everyone go to the project and look every file to see which part doesn&#39;t work, at least write an example to reproduce the problem."}, {"owner": {"reputation": 912, "user_id": 6012434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MZcOa.png?s=128&g=1", "display_name": "Robo", "link": "https://stackoverflow.com/users/6012434/robo"}, "edited": false, "score": 0, "creation_date": 1494900682, "post_id": 43978124, "comment_id": 75011795, "body": "Sure, I&#39;ll put up a simpler example shortly"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 1, "creation_date": 1495009745, "post_id": 43978124, "comment_id": 75065977, "body": "A way to fix the execution is use different types in each plugin like <code>type pluginA string</code> and <code>type pluginB string</code> to prevent  the type collision."}], "answers": [{"tags": [], "owner": {"reputation": 912, "user_id": 6012434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MZcOa.png?s=128&g=1", "display_name": "Robo", "link": "https://stackoverflow.com/users/6012434/robo"}, "is_accepted": true, "score": 0, "last_activity_date": 1495093018, "last_edit_date": 1495542883, "creation_date": 1495093018, "answer_id": 44041447, "question_id": 43978124, "link": "https://stackoverflow.com/questions/43978124/golang-1-8-plugin-lookup-only-loads-first-plugin/44041447#44041447", "title": "Golang 1.8 plugin.Lookup only loads first plugin", "body": "<p>This is a Golang bug (see <a href=\"https://github.com/golang/go/issues/20376\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/20376</a>)</p>\n\n<p>The workaround, as pointed out by <a href=\"https://stackoverflow.com/users/7187655/motakjuq\">Motakjuq</a>, is to change the name of the type so each plugin has a different type. This avoids the collision.</p>\n"}], "owner": {"reputation": 912, "user_id": 6012434, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MZcOa.png?s=128&g=1", "display_name": "Robo", "link": "https://stackoverflow.com/users/6012434/robo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 212, "favorite_count": 0, "accepted_answer_id": 44041447, "answer_count": 1, "score": 1, "last_activity_date": 1495093018, "creation_date": 1494847122, "last_edit_date": 1494927371, "question_id": 43978124, "link": "https://stackoverflow.com/questions/43978124/golang-1-8-plugin-lookup-only-loads-first-plugin", "title": "Golang 1.8 plugin.Lookup only loads first plugin", "body": "<p>I'm writing a <a href=\"https://github.com/patrobinson/go-fish\" rel=\"nofollow noreferrer\">Rules Engine</a> in Golang. My tests involve building and loading two plugins that do some very simple string comparison. I load the plugins by doing a fileglob and calling <code>plugin.Open()</code>, so far so good we get two different objects back. But when I call <code>plug.Lookup(symbol)</code> the symbol returned is always a reference to the first plugin.</p>\n\n<pre><code>DEBU[0000] Starting A rule\n\nDEBU[0000] Starting A rule\n</code></pre>\n\n<p>I've debugged back to make sure the plugins are different objects, which they are, but the symbol lookup isn't working as expected.</p>\n\n<p>Here's a contrived working example:</p>\n\n<p>main.go\n    package main</p>\n\n<pre><code>import \"plugin\"\nimport \"fmt\"\n\nfunc main() {\n    aPlug, _ := plugin.Open(\"testdata/plugins/a.so\")\n    aSymPlug, _ := aPlug.Lookup(\"Rule\")\n    fmt.Printf(\"Plugin: %v loaded\\n\", aSymPlug)\n\n    bPlug, _ := plugin.Open(\"testdata/plugins/b.so\")\n    bSymPlug, _ := bPlug.Lookup(\"Rule\")\n    fmt.Printf(\"Plugin: %v loaded\\n\", bSymPlug)\n}\n</code></pre>\n\n<p>a.go plugin</p>\n\n<pre><code>package main\n\ntype plugin string\n\nfunc init() {\n    Rule = \"a\"\n}\n\nfunc (p plugin) String() string {\n    return string(p)\n}\n\nvar Rule plugin\n</code></pre>\n\n<p>b.go plugin</p>\n\n<pre><code>package main\n\ntype plugin string\n\nfunc init() {\n    Rule = \"b\"\n}\n\nfunc (p plugin) String() string {\n        return string(p)\n}\n\nvar Rule plugin\n</code></pre>\n\n<p>BUT when I change the plugin to return the string \"a\" or \"b\" (doesn't matter which plugin, either or both) instead of <code>p</code> then it loads the wrong plugin! i.e.</p>\n\n<pre><code>package main\n\ntype plugin string\n\nfunc init() {\n    Rule = \"b\"\n}\n\nfunc (p plugin) String() string {\n        return \"b\"\n}\n\nvar Rule plugin\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>Plugin: a loaded\nPlugin: a loaded\n</code></pre>\n\n<p>EDIT: Added example code</p>\n"}, {"tags": ["go", "ffmpeg"], "comments": [{"owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 1, "creation_date": 1494847783, "post_id": 43978018, "comment_id": 74985820, "body": "Can&#39;t you just check the exit code for 0? File check is dependable if size &gt; 0. Actually, there are a couple of edge cases, but they involve wonky input rather than processing errors."}, {"owner": {"reputation": 693, "user_id": 1752516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9a7dc0642e0a6408d22d570c7502a6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jya", "link": "https://stackoverflow.com/users/1752516/jya"}, "reply_to_user": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1494847948, "post_id": 43978018, "comment_id": 74985910, "body": "@Mulvya Yes I can check exit code but I don&#39;t know if it will be accurate. I am hoping for a reliable way to do it. Is it something you would do with confidance?"}, {"owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1494848477, "post_id": 43978018, "comment_id": 74986228, "body": "Yes, 0 will be success. Failure otherwise."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1494849490, "post_id": 43978018, "comment_id": 74986905, "body": "It might be an overkill but there are Go bindings to libav, and you can just open the file with it and analyze it"}], "answers": [{"comments": [{"owner": {"reputation": 693, "user_id": 1752516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9a7dc0642e0a6408d22d570c7502a6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jya", "link": "https://stackoverflow.com/users/1752516/jya"}, "edited": false, "score": 0, "creation_date": 1494853672, "post_id": 43980180, "comment_id": 74989713, "body": "Thank you, this is great. More than I wanted :-). One thing I noticed is that it doesn&#39;t have a line between each section as shown above. But no problem."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 693, "user_id": 1752516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9a7dc0642e0a6408d22d570c7502a6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jya", "link": "https://stackoverflow.com/users/1752516/jya"}, "edited": false, "score": 0, "creation_date": 1494854292, "post_id": 43980180, "comment_id": 74990136, "body": "You&#39;re welcome. About the new line, I mentioned it in the answer i.e. I added the blank line for clarity. You can split the section using <code>progress=...</code>. Or, in addition to the main program, create simple tcp server with golang to retrieve the progress info."}, {"owner": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 1, "creation_date": 1494856924, "post_id": 43980180, "comment_id": 74992013, "body": "Have you checked whether this logs error if it occurs?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 1, "creation_date": 1494858829, "post_id": 43980180, "comment_id": 74993379, "body": "@Mulvya Error message is not recorded in the progress output. Instead, it will be available through <code>stderr</code> (what will be shown depends on <code>-loglevel</code> option) or if <code>-report</code> option is specified, all the console output will be written to a log file. If error occurs or <code>ffmpeg</code> is terminated before finishing the job, the progress output will not contains <code>progress=end</code> line or it will be empty."}, {"owner": {"reputation": 693, "user_id": 1752516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9a7dc0642e0a6408d22d570c7502a6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jya", "link": "https://stackoverflow.com/users/1752516/jya"}, "reply_to_user": {"reputation": 61761, "user_id": 5726027, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a15e6b3536ef969cf3a9828a0542aac2?s=128&d=identicon&r=PG", "display_name": "Gyan", "link": "https://stackoverflow.com/users/5726027/gyan"}, "edited": false, "score": 0, "creation_date": 1495022753, "post_id": 43980180, "comment_id": 75074985, "body": "@Mulvya Thanks for asking. I am currently checking if <code>progress=end</code> is present"}, {"owner": {"reputation": 4109, "user_id": 41728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/4fcab9e6b801d7f775b4b3a8ee81846d?s=128&d=identicon&r=PG", "display_name": "Collin Allen", "link": "https://stackoverflow.com/users/41728/collin-allen"}, "edited": false, "score": 0, "creation_date": 1550003726, "post_id": 43980180, "comment_id": 96107973, "body": "Of note: When using an HTTP URL for <code>-progress</code>, progress information is transmitted in a single request using chunked transfer encoding. Chunks are sent periodically as the encode progresses, but many HTTP servers wait for the entire request to arrive (i.e. all chunks) before processing the request, making it seem as though the request is only sent at the end of the encode."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 5, "last_activity_date": 1494853056, "creation_date": 1494853056, "answer_id": 43980180, "question_id": 43978018, "link": "https://stackoverflow.com/questions/43978018/ffmpeg-get-machine-readable-output/43980180#43980180", "title": "ffmpeg get machine readable output", "body": "<p>Add <code>-progress url</code> to the <a href=\"https://ffmpeg.org/ffmpeg.html\" rel=\"noreferrer\"><code>ffmpeg</code> options</a>, then you will get progress information (machine readable <code>key=value</code> format) every second. You can specify <code>filename, tcp://, http://</code> etc. as the url. Last key in the progress information is always <code>progress=...</code> The following is an example output (for clarity, blank line is added between progress information). </p>\n\n<pre><code>frame=13164\nfps=127.9\nstream_0_0_q=29.0\nbitrate= 508.9kbits/s\ntotal_size=27962256\nout_time_ms=439600181\nout_time=00:07:19.600181\ndup_frames=0\ndrop_frames=0\nspeed=4.27x\nprogress=continue\n\nframe=13245\nfps=128.0\nstream_0_0_q=29.0\nbitrate= 507.5kbits/s\ntotal_size=28064283\nout_time_ms=442386576\nout_time=00:07:22.386576\ndup_frames=0\ndrop_frames=0\nspeed=4.28x\nprogress=continue\n\nframe=13298\nfps=127.6\nstream_0_0_q=-1.0\nbitrate= 516.9kbits/s\ntotal_size=28675700\nout_time_ms=443779773\nout_time=00:07:23.779773\ndup_frames=0\ndrop_frames=0\nspeed=4.26x\nprogress=end\n</code></pre>\n\n<p>Example command:</p>\n\n<ol>\n<li>Progress info to file: <code>ffmpeg -progress progressinfo.txt ...</code></li>\n<li>Progress info to local TCP server in port 8910: <code>ffmpeg -progress tcp://127.0.0.1:8910 ...</code> </li>\n</ol>\n"}], "owner": {"reputation": 693, "user_id": 1752516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9a7dc0642e0a6408d22d570c7502a6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jya", "link": "https://stackoverflow.com/users/1752516/jya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1747, "favorite_count": 0, "accepted_answer_id": 43980180, "answer_count": 1, "score": 2, "last_activity_date": 1494853056, "creation_date": 1494846793, "question_id": 43978018, "link": "https://stackoverflow.com/questions/43978018/ffmpeg-get-machine-readable-output", "title": "ffmpeg get machine readable output", "body": "<p>I am trying to find a way to get FFmpeg to return a machine readable output. basically, I just want to know if video conversion was successfull.</p>\n\n<p>I am calling FFmpeg from go code.</p>\n\n<pre><code>output, err := exec.Command(\"ffmpeg\", \"-i\", source, \"-vcodec\", \"h264\", \"-acodec\", \"aac\", \"-strict\", \"-2\", destination).CombinedOutput()\n</code></pre>\n\n<p>The above code executes this command :</p>\n\n<pre><code>ffmpeg -i /tmp/pitchVideo-1494844705-102.mp4 -vcodec h264 -acodec aac -strict -2 /tmp/1494844705.mp4\n</code></pre>\n\n<p>I get the following output:</p>\n\n<pre><code>ffmpeg version 2.4.3-1ubuntu1~trusty6 Copyright (c) 2000-2014 the FFmpeg developers\n  built on Nov 22 2014 17:07:19 with gcc 4.8 (Ubuntu 4.8.2-19ubuntu1)\n  configuration: --prefix=/usr --extra-version='1ubuntu1~trusty6' --build-suffix=-ffmpeg --toolchain=hardened --extra-cflags= --extra-cxxflags= --libdir=/usr/lib/x86_64-linux-gnu --shlibdir=/usr/lib/x86_64-linux-gnu --incdir=/usr/include/x86_64-linux-gnu --enable-gpl --enable-shared --disable-stripping --enable-avresample --enable-avisynth --enable-fontconfig --enable-gnutls --enable-ladspa --enable-libass --enable-libbluray --enable-libbs2b --enable-libcaca --enable-libcdio --enable-libflite --enable-libfreetype --enable-libfribidi --enable-libgme --enable-libgsm --enable-libmodplug --enable-libmp3lame --enable-libopenjpeg --enable-libopus --enable-libpulse --enable-librtmp --enable-libschroedinger --enable-libshine --enable-libspeex --enable-libssh --enable-libtheora --enable-libtwolame --enable-libvorbis --enable-libvpx --enable-libwavpack --enable-libwebp --enable-opengl --enable-x11grab --enable-libxvid --enable-libx265 --enable-libdc1394 --enable-libiec61883 --enable-libzvbi --enable-libzmq --enable-frei0r --enable-libx264 --enable-libsoxr --enable-openal --enable-libopencv\n  libavutil      54.  7.100 / 54.  7.100\n  libavcodec     56.  1.100 / 56.  1.100\n  libavformat    56.  4.101 / 56.  4.101\n  libavdevice    56.  0.100 / 56.  0.100\n  libavfilter     5.  1.100 /  5.  1.100\n  libavresample   2.  1.  0 /  2.  1.  0\n  libswscale      3.  0.100 /  3.  0.100\n  libswresample   1.  1.100 /  1.  1.100\n  libpostproc    53.  0.100 / 53.  0.100\nInput #0, mov,mp4,m4a,3gp,3g2,mj2, from '/tmp/pitchVideo-1494844705-102.mp4':\n  Metadata:\n    major_brand     : isom\n    minor_version   : 512\n    compatible_brands: isomiso2avc1mp41\n    encoder         : Lavf56.40.101\n  Duration: 00:00:39.28, start: 0.000000, bitrate: 2300 kb/s\n    Stream #0:0(und): Video: h264 (Constrained Baseline) (avc1 / 0x31637661), yuv420p, 640x480, 2231 kb/s, 25 fps, 25 tbr, 90k tbn, 50 tbc (default)\n    Metadata:\n      handler_name    : VideoHandler\n    Stream #0:1(und): Audio: aac (mp4a / 0x6134706D), 48000 Hz, mono, fltp, 64 kb/s (default)\n    Metadata:\n      handler_name    : SoundHandler\n[libx264 @ 0x1e12640] using cpu capabilities: MMX2 SSE2Fast SSSE3 SSE4.2 AVX LZCNT\n[libx264 @ 0x1e12640] profile High, level 3.0\n[libx264 @ 0x1e12640] 264 - core 142 r2389 956c8d8 - H.264/MPEG-4 AVC codec - Copyleft 2003-2014 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=1 lookahead_threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 bluray_compat=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=crf mbtree=1 crf=23.0 qcomp=0.60 qpmin=0 qpmax=69 qpstep=4 ip_ratio=1.40 aq=1:1.00\nOutput #0, mp4, to '/tmp/new.mp4':\n  Metadata:\n    major_brand     : isom\n    minor_version   : 512\n    compatible_brands: isomiso2avc1mp41\n    encoder         : Lavf56.4.101\n    Stream #0:0(und): Video: h264 (libx264) ([33][0][0][0] / 0x0021), yuv420p, 640x480, q=-1--1, 25 fps, 12800 tbn, 25 tbc (default)\n    Metadata:\n      handler_name    : VideoHandler\n      encoder         : Lavc56.1.100 libx264\n    Stream #0:1(und): Audio: aac ([64][0][0][0] / 0x0040), 48000 Hz, mono, fltp, 128 kb/s (default)\n    Metadata:\n      handler_name    : SoundHandler\n      encoder         : Lavc56.1.100 aac\nStream mapping:\n  Stream #0:0 -&gt; #0:0 (h264 (native) -&gt; h264 (libx264))\n  Stream #0:1 -&gt; #0:1 (aac (native) -&gt; aac (native))\nPress [q] to stop, [?] for help\nframe=  983 fps= 27 q=28.0 Lsize=    4134kB time=00:00:39.24 bitrate= 863.0kbits/s dup=1 drop=0    \nvideo:3542kB audio:565kB subtitle:0kB other streams:0kB global headers:0kB muxing overhead: 0.646525%\n[libx264 @ 0x1e12640] frame I:9     Avg QP:19.44  size:  9936\n[libx264 @ 0x1e12640] frame P:664   Avg QP:23.58  size:  4839\n[libx264 @ 0x1e12640] frame B:310   Avg QP:25.50  size:  1045\n[libx264 @ 0x1e12640] consecutive B-frames: 56.0%  4.3%  5.2% 34.6%\n[libx264 @ 0x1e12640] mb I  I16..4: 33.9% 53.6% 12.5%\n[libx264 @ 0x1e12640] mb P  I16..4:  6.7% 10.2%  0.9%  P16..4: 50.7%  8.3%  3.0%  0.0%  0.0%    skip:20.2%\n[libx264 @ 0x1e12640] mb B  I16..4:  0.4%  0.4%  0.0%  B16..8: 41.7%  1.4%  0.1%  direct: 1.3%  skip:54.7%  L0:46.9% L1:50.4% BI: 2.8%\n[libx264 @ 0x1e12640] 8x8 transform intra:56.8% inter:76.1%\n[libx264 @ 0x1e12640] coded y,uvDC,uvAC intra: 37.0% 60.5% 13.9% inter: 17.8% 26.0% 0.3%\n[libx264 @ 0x1e12640] i16 v,h,dc,p: 23% 35% 15% 27%\n[libx264 @ 0x1e12640] i8 v,h,dc,ddl,ddr,vr,hd,vl,hu: 25% 27% 21%  4%  4%  4%  4%  5%  5%\n[libx264 @ 0x1e12640] i4 v,h,dc,ddl,ddr,vr,hd,vl,hu: 32% 26% 14%  4%  5%  5%  5%  5%  4%\n[libx264 @ 0x1e12640] i8c dc,h,v,p: 53% 22% 19%  6%\n[libx264 @ 0x1e12640] Weighted P-Frames: Y:8.7% UV:3.5%\n[libx264 @ 0x1e12640] ref P L0: 73.8% 15.7%  8.4%  2.0%  0.1%\n[libx264 @ 0x1e12640] ref B L0: 92.9%  6.2%  0.9%\n[libx264 @ 0x1e12640] ref B L1: 96.1%  3.9%\n[libx264 @ 0x1e12640] kb/s:737.84\n</code></pre>\n\n<p>Edit 1: Maybe I can just check if new video file was generated. But I don't know if that is a dependable way to do it.</p>\n"}, {"tags": ["json", "validation", "go", "optional"], "comments": [{"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494849775, "post_id": 43977640, "comment_id": 74987076, "body": "If I understad you, you want to know if the JSON payload contains others fields that are not defined in you schema, right ?"}, {"owner": {"reputation": 55, "user_id": 2004063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dbf031754bce2274d64885827463a92?s=128&d=identicon&r=PG", "display_name": "jenny_flynn", "link": "https://stackoverflow.com/users/2004063/jenny-flynn"}, "reply_to_user": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494850841, "post_id": 43977640, "comment_id": 74987767, "body": "Yes. I need the validation to fail if there are extra fields in the payload that aren&#39;t defined by the schema for example: typos, didn&#39;t update schema when we changed the JSON response payload."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1494851458, "post_id": 43977640, "comment_id": 74988190, "body": "Unmarshal to e.g. map[string]interface{} and check the keys. Dead simple, no tooling needed."}, {"owner": {"reputation": 1308, "user_id": 4709839, "user_type": "registered", "accept_rate": 93, "profile_image": "https://lh6.googleusercontent.com/-4w1KKdkUNJk/AAAAAAAAAAI/AAAAAAAAABc/Xg55afDDwjk/photo.jpg?sz=128", "display_name": "William Poussier", "link": "https://stackoverflow.com/users/4709839/william-poussier"}, "edited": false, "score": 0, "creation_date": 1494851972, "post_id": 43977640, "comment_id": 74988549, "body": "Yeah I&#39;ll probably go with what Volker proposed. Maybe you can find a lib that can give you all the fields of a JSON schema, and you compare those with the fields of your payload unmarshaled to a map."}, {"owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "edited": false, "score": 0, "creation_date": 1494863196, "post_id": 43977640, "comment_id": 74996548, "body": "Though operationally simple, checking this externally to JSON schema when it already supports that is a form of <a href=\"http://wiki.c2.com/?InformationLoss\" rel=\"nofollow noreferrer\">information loss</a>"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 2004063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dbf031754bce2274d64885827463a92?s=128&d=identicon&r=PG", "display_name": "jenny_flynn", "link": "https://stackoverflow.com/users/2004063/jenny-flynn"}, "edited": false, "score": 0, "creation_date": 1494932511, "post_id": 43983691, "comment_id": 75027478, "body": "Thank you. This was the most helpful solution and simplest to implement."}], "tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": true, "score": 2, "last_activity_date": 1494863720, "last_edit_date": 1494863720, "creation_date": 1494863029, "answer_id": 43983691, "question_id": 43977640, "link": "https://stackoverflow.com/questions/43977640/json-schema-validation-of-optional-fields-using-golang/43983691#43983691", "title": "JSON schema validation of optional fields using Golang", "body": "<p>JSON Schema defines <a href=\"http://json-schema.org/latest/json-schema-validation.html#rfc.section.6.20\" rel=\"nofollow noreferrer\"><code>additionalProperties</code></a> for this purpose, something like this schema should work:</p>\n\n<pre><code>{\n    \"type\": \"object\",\n    \"additionalProperties\": false,\n    \"properties\":{\n        \"pet\": ...,\n        \"name\": ...,\n        \"license\": ...,\n    },\n}\n</code></pre>\n\n<p>This is <a href=\"https://github.com/xeipuuv/gojsonschema/search?utf8=%E2%9C%93&amp;q=additionalProperties&amp;type=\" rel=\"nofollow noreferrer\">implemented</a> but not documented as such in <code>gojsonschema</code>.</p>\n\n<p>Note that <code>additionalProperties</code> is a schema, not just a boolean, i.e. you can do arbitrary validation of unknown properties, not just disallow them.</p>\n"}], "owner": {"reputation": 55, "user_id": 2004063, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8dbf031754bce2274d64885827463a92?s=128&d=identicon&r=PG", "display_name": "jenny_flynn", "link": "https://stackoverflow.com/users/2004063/jenny-flynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4146, "favorite_count": 0, "accepted_answer_id": 43983691, "answer_count": 1, "score": 0, "last_activity_date": 1494863720, "creation_date": 1494845576, "last_edit_date": 1494850898, "question_id": 43977640, "link": "https://stackoverflow.com/questions/43977640/json-schema-validation-of-optional-fields-using-golang", "title": "JSON schema validation of optional fields using Golang", "body": "<p>Golang JSON schema validation libraries validate that required fields on the schema are present in the service request/response. </p>\n\n<p>I need to validate that any field in a service request or response must be a property on the schema. If a property in the payload does not exist in the schema, the validation should fail.</p>\n\n<p>For example: a <em>GET</em> response:</p>\n\n<pre><code>{\n   \"pet\": \"dog\",\n   \"name\": \"Scooby\",\n   \"licence\": \"123-123\"\n}\n</code></pre>\n\n<p>In my sample JSON schema, none of the fields are required. However, if I changed the field \"pet\" to \"petBreed\" in my service, it will not be caught by a JSON schema validator (e.g. <a href=\"https://github.com/xeipuuv/gojsonschema\" rel=\"nofollow noreferrer\">https://github.com/xeipuuv/gojsonschema</a>).</p>\n\n<p>Making all fields required is not an option. Can anyone suggest a library in Go that will:</p>\n\n<ol>\n<li>validate that all the response fields are in the schema</li>\n<li>not fail if a field from the schema isn't in the response</li>\n</ol>\n"}, {"tags": ["go", "gorilla", "mux"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1494846029, "creation_date": 1494846029, "answer_id": 43977776, "question_id": 43976539, "link": "https://stackoverflow.com/questions/43976539/run-middleware-after-gorilla-mux-handling/43977776#43977776", "title": "Run middleware after Gorilla mux handling", "body": "<p>Use     </p>\n\n<pre><code>http.ListenAndServe(\":8000\", runsAfter(runsbefore(r)))\n</code></pre>\n\n<p>and fix the error in <code>runsAfter</code>:</p>\n\n<pre><code>func runsafter(h http.Handler) http.Handler {\n  fn := func(w http.ResponseWriter, r *http.Request) {\n    h.ServeHTTP(w, r)\n    w.Write([]byte(\"run after, \"))\n  }\n\n  return http.HandlerFunc(fn)\n}\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 676402, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/8b8b338e41613179654ea52e21497f30?s=128&d=identicon&r=PG", "display_name": "bertt", "link": "https://stackoverflow.com/users/676402/bertt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2227, "favorite_count": 0, "accepted_answer_id": 43977776, "answer_count": 1, "score": 2, "last_activity_date": 1494846029, "creation_date": 1494842344, "last_edit_date": 1494844158, "question_id": 43976539, "link": "https://stackoverflow.com/questions/43976539/run-middleware-after-gorilla-mux-handling", "title": "Run middleware after Gorilla mux handling", "body": "<p>I'm trying to use Golang middleware to run <strong>after</strong> handling Gorilla Mux routing, in order to change the response of each request.</p>\n\n<p>Code sample see below. Currently it returns 'run before, run test', goal is to return 'run before, run test, run after' using the runsafter middleware.</p>\n\n<p>Is something like this possible with Gorilla Mux? </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/gorilla/mux\"\n    \"net/http\"\n)\n\nfunc runsbefore(h http.Handler) http.Handler {\n    fn := func(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"run before, \"))\n        h.ServeHTTP(w, r)\n    }\n\n    return http.HandlerFunc(fn)\n}\n\nfunc runsafter(h http.Handler) http.Handler {\n    fn := func(w http.ResponseWriter, r *http.Request) {\n        w.Write([]byte(\"run after, \"))\n        h.ServeHTTP(w, r)\n    }\n\n    return http.HandlerFunc(fn)\n}\n\nfunc runtest(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"run test, \"))\n}\n\nfunc main() {\n    fmt.Println(\"Server starting on port 8000\")\n    r := mux.NewRouter()\n    r.HandleFunc(\"/\", runtest).Methods(\"GET\")\n    http.ListenAndServe(\":8000\", runsbefore(r))\n    // something like: http.ListenAndServe(\":8000\", runsbefore(r(runsafter)))\n}\n</code></pre>\n"}, {"tags": ["http", "go", "error-handling", "server"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1494842023, "post_id": 43976140, "comment_id": 74982202, "body": "&quot;Should I check the error returned ...&quot; The answer depends on your requirements. How do you intend to react if an error occurs? If you check for an error and on error all you do is &quot;No idea what to do now... let&#39;s log to /dev/null and call it handled.&quot; then you could ignore the error es well. General advice can be given on general problems. Your&#39;s isn&#39;t general."}], "answers": [{"comments": [{"owner": {"reputation": 10642, "user_id": 1251684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iX2Jq.png?s=128&g=1", "display_name": "BentCoder", "link": "https://stackoverflow.com/users/1251684/bentcoder"}, "edited": false, "score": 0, "creation_date": 1569521465, "post_id": 43976633, "comment_id": 102633556, "body": "Based on what I&#39;ve seen in a few posts the &quot;tip for auto-logging errors&quot; option could be ditched. An explanation can be found here: <a href=\"https://blog.merovius.de/2017/07/30/the-trouble-with-optional-interfaces.html\" rel=\"nofollow noreferrer\">blog.merovius.de/2017/07/30/&hellip;</a>"}, {"owner": {"reputation": 10642, "user_id": 1251684, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iX2Jq.png?s=128&g=1", "display_name": "BentCoder", "link": "https://stackoverflow.com/users/1251684/bentcoder"}, "edited": false, "score": 0, "creation_date": 1569525625, "post_id": 43976633, "comment_id": 102635415, "body": "Although it is already mentioned in the answer &quot;But care must be taken when passing ....&quot; I just wanted to drop the link here for those who want to know what exactly issue is so the answer is +1."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 22, "last_activity_date": 1494846635, "last_edit_date": 1494846635, "creation_date": 1494842610, "answer_id": 43976633, "question_id": 43976140, "link": "https://stackoverflow.com/questions/43976140/check-errors-when-calling-http-responsewriter-write/43976633#43976633", "title": "Check errors when calling http.ResponseWriter.Write()", "body": "<p>It's up to you. My advice is that unless the documentation of some method / function explicitly states that it never returns a non-<code>nil</code> error (such as <a href=\"https://golang.org/pkg/bytes/#Buffer.Write\" rel=\"noreferrer\"><code>bytes.Buffer.Write()</code></a>), always check the error and the least you can do is log it, so if an error occurs, it will leave some mark which you can investigate should it become a problem later.</p>\n\n<p>This is also true for writing to <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"noreferrer\"><code>http.ResponseWriter</code></a>.</p>\n\n<p>You might think <code>ResponseWriter.Write()</code> may only return errors if sending the data fails (e.g. connection closed), but that is not true. The concrete type that implements <code>http.ResponseWriter</code> is the unexported <code>http.response</code> type, and if you check the unexported <code>response.write()</code> method, you'll see it might return a non-<code>nil</code> error for a bunch of other reasons.</p>\n\n<p><strong>Reasons why <code>ResponseWriter.Write()</code> may return a non-<code>nil</code> error:</strong></p>\n\n<ul>\n<li>If the connection was hijacked (see <a href=\"https://golang.org/pkg/net/http/#Hijacker\" rel=\"noreferrer\"><code>http.Hijacker</code></a>): <code>http.ErrHijacked</code></li>\n<li>If content length was specified, and you attempt to write more than that: <code>http.ErrContentLength</code></li>\n<li>If the HTTP method and / or HTTP status does not allow a response body at all, and you attempt to write more than 0 bytes: <code>http.ErrBodyNotAllowed</code></li>\n<li>If writing data to the actual connection fails.</li>\n</ul>\n\n<p>Even if you can't do anything with the error, logging it may be of great help debugging the error later on. E.g. you (or someone else in the handler chain) hijacked the connection, and you attempt to write to it later; you get an error (<code>http.ErrHijacked</code>), logging it will reveal the cause immediately.</p>\n\n<h3>Tip for \"easy\" logging errors</h3>\n\n<p>If you can't do anything with the occasional error and it's not a \"showstopper\", you may create and use a simple function that does the check and logging, something like this:</p>\n\n<pre><code>func logerr(n int, err error) {\n    if err != nil {\n        log.Printf(\"Write failed: %v\", err)\n    }\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>logerr(w.Write(data))\n</code></pre>\n\n<h3>Tip for \"auto-logging\" errors</h3>\n\n<p>If you don't even want to use the <code>logerr()</code> function all the time, you may create a wrapper for <code>http.ResponseWriter</code> which does this \"automatically\":</p>\n\n<pre><code>type LogWriter struct {\n    http.ResponseWriter\n}\n\nfunc (w LogWriter) Write(p []byte) (n int, err error) {\n    n, err = w.ResponseWriter.Write(p)\n    if err != nil {\n        log.Printf(\"Write failed: %v\", err)\n    }\n    return\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>func SomeHandler(w http.ResponseWriter, r *http.Request) {\n    w = LogWriter{w}\n    w.Write([]byte(\"hi\"))\n}\n</code></pre>\n\n<p>Using <code>LogWriter</code> as a wrapper around <code>http.ResponseWriter</code>, should writes to the original <code>http.ResponseWriter</code> fail, it will be logged automatically.</p>\n\n<p>This also has the great benefit of not expecting a logger function to be called, so you can pass a value of your <code>LogWriter</code> \"down\" the chain, and everyone who attempts to write to it will be monitored and logged, they don't have to worry or even know about this.</p>\n\n<p>But care must be taken when passing <code>LogWriter</code> down the chain, as there's also a downside to this: a value of <code>LogWriter</code> will not implement other interfaces the original <code>http.ResponseWriter</code> might also do, e.g. <code>http.Hijacker</code> or <a href=\"https://golang.org/pkg/net/http/#Pusher\" rel=\"noreferrer\"><code>http.Pusher</code></a>.</p>\n\n<p>Here's an example on the <a href=\"https://play.golang.org/p/VtPmgtbhP5\" rel=\"noreferrer\"><strong>Go Playground</strong></a> that shows this in action, and also shows that <code>LogWriter</code> will not implement other interfaces; and also shows a way (using 2 \"nested\" type assertions) how to still get out what we want from <code>LogWriter</code> (an <code>http.Pusher</code> in the example).</p>\n"}], "owner": {"reputation": 572, "user_id": 1451794, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/f682ac306d65d34f0450df5710ba3314?s=128&d=identicon&r=PG", "display_name": "Dumitru", "link": "https://stackoverflow.com/users/1451794/dumitru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5369, "favorite_count": 0, "accepted_answer_id": 43976633, "answer_count": 1, "score": 9, "last_activity_date": 1494846635, "creation_date": 1494841306, "last_edit_date": 1494843549, "question_id": 43976140, "link": "https://stackoverflow.com/questions/43976140/check-errors-when-calling-http-responsewriter-write", "title": "Check errors when calling http.ResponseWriter.Write()", "body": "<p>Say I have this http handler:</p>\n\n<pre><code>func SomeHandler(w http.ResponseWriter, r *http.Request) {\n    data := GetSomeData()\n    _, err := w.Write(data)\n}\n</code></pre>\n\n<p>Should I check the error returned by <code>w.Write</code>? Examples I've seen just ignore it and do nothing. Also, functions like <code>http.Error()</code> do not return an error to be handled.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 3, "creation_date": 1494819697, "post_id": 43971205, "comment_id": 74972296, "body": "We don&#39;t know why <i>you</i> in <i>your code</i> instruct a program to exit if a request in cancelled."}, {"owner": {"reputation": 247, "user_id": 586891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca7a9ae67cd92958fb9b5ed948134c7b?s=128&d=identicon&r=PG", "display_name": "Muz", "link": "https://stackoverflow.com/users/586891/muz"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494823331, "post_id": 43971205, "comment_id": 74973104, "body": "Yeah, I actually call log.Fatalf() deep inside the code. It seems my lack of understanding of how context cancelling works makes it difficult to debug the problem. Thanks for your help."}], "answers": [{"tags": [], "owner": {"reputation": 247, "user_id": 586891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca7a9ae67cd92958fb9b5ed948134c7b?s=128&d=identicon&r=PG", "display_name": "Muz", "link": "https://stackoverflow.com/users/586891/muz"}, "is_accepted": false, "score": 0, "last_activity_date": 1494823269, "creation_date": 1494823269, "answer_id": 43971701, "question_id": 43971205, "link": "https://stackoverflow.com/questions/43971205/why-my-go-server-app-exits-if-i-cancel-an-ongoing-http-request-on-the-client-sid/43971701#43971701", "title": "Why my Go server app exits if I cancel an ongoing HTTP request on the client side", "body": "<p>I figured it out.</p>\n\n<p>Apparently, in one place, I call log.Fatalf() when there's an error, causing the app to exit when the context canceled.</p>\n\n<p>Furthermore, my lack of understanding of how context cancelling works makes it difficult to make debug the problem.</p>\n"}], "owner": {"reputation": 247, "user_id": 586891, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca7a9ae67cd92958fb9b5ed948134c7b?s=128&d=identicon&r=PG", "display_name": "Muz", "link": "https://stackoverflow.com/users/586891/muz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1494823269, "creation_date": 1494819192, "question_id": 43971205, "link": "https://stackoverflow.com/questions/43971205/why-my-go-server-app-exits-if-i-cancel-an-ongoing-http-request-on-the-client-sid", "title": "Why my Go server app exits if I cancel an ongoing HTTP request on the client side", "body": "<p>I'm working on a http server using Go.</p>\n\n<p>However I have this weird issue that I don't understand.</p>\n\n<p>When I cancel an ongoing HTTP request on the client (I use Insomnia) side,\nthe server will exit with logs like this:</p>\n\n<blockquote>\n  <p>2017/05/15 11:25:24 context canceled</p>\n  \n  <p>Process finished with exit code 1</p>\n</blockquote>\n\n<p>Can someone help me explain why the server exits itself ?</p>\n\n<p>I use pressly/chi to implement my http handlers.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2131, "user_id": 2343935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/li569.png?s=128&g=1", "display_name": "grooveplex", "link": "https://stackoverflow.com/users/2343935/grooveplex"}, "edited": false, "score": 0, "creation_date": 1494784578, "post_id": 43967130, "comment_id": 74964206, "body": "Do you get any errors?"}, {"owner": {"reputation": 1, "user_id": 7994036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621bee9b45b1c0fb4b66349c95dcec5?s=128&d=identicon&r=PG&f=1", "display_name": "rtgojtr", "link": "https://stackoverflow.com/users/7994036/rtgojtr"}, "reply_to_user": {"reputation": 2131, "user_id": 2343935, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/li569.png?s=128&g=1", "display_name": "grooveplex", "link": "https://stackoverflow.com/users/2343935/grooveplex"}, "edited": false, "score": 0, "creation_date": 1494784775, "post_id": 43967130, "comment_id": 74964276, "body": "undefined: conn in conn.Write @grooveplex"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1494785867, "post_id": 43967130, "comment_id": 74964636, "body": "The function <code>hello</code> cannot refer to the local variable <code>conn</code> in <code>main</code>.  Perhaps you want a package-level variable."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1494786598, "post_id": 43967130, "comment_id": 74964860, "body": "Show what you tried."}, {"owner": {"reputation": 1, "user_id": 7994036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621bee9b45b1c0fb4b66349c95dcec5?s=128&d=identicon&r=PG&f=1", "display_name": "rtgojtr", "link": "https://stackoverflow.com/users/7994036/rtgojtr"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1494786772, "post_id": 43967130, "comment_id": 74964914, "body": "@CeriseLim&#243;n I have update my code"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 7994036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621bee9b45b1c0fb4b66349c95dcec5?s=128&d=identicon&r=PG&f=1", "display_name": "rtgojtr", "link": "https://stackoverflow.com/users/7994036/rtgojtr"}, "edited": false, "score": 0, "creation_date": 1494793091, "post_id": 43967633, "comment_id": 74966724, "body": "for some reason io.WriteString(w, &quot;Hello World&quot;) give me this error: panic: runtime error: invalid memory address or nil pointer dereference [signal 0xc0000005 code=0x0 addr=0x20 pc=0x23323 @Alexey Soshin"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 1, "user_id": 7994036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621bee9b45b1c0fb4b66349c95dcec5?s=128&d=identicon&r=PG&f=1", "display_name": "rtgojtr", "link": "https://stackoverflow.com/users/7994036/rtgojtr"}, "edited": false, "score": 0, "creation_date": 1494805480, "post_id": 43967633, "comment_id": 74969610, "body": "@D.Jow You got the error because there is no client connected to server through port <code>8081</code>."}], "tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": true, "score": 1, "last_activity_date": 1494787746, "creation_date": 1494787746, "answer_id": 43967633, "question_id": 43967130, "link": "https://stackoverflow.com/questions/43967130/golang-http-server-send-r-url-path-over-socket/43967633#43967633", "title": "golang http server send r.URL.Path over socket", "body": "<p>Your problem is actually in the way you try to declare variables.<br>\nIf you want your conn to be on global scope, use <code>var</code></p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"net/http\"\n    \"net\"\n)\n\n\nvar ln, _ = net.Listen(\"tcp\", \":8081\")\nvar conn, _ = ln.Accept()\n\nfunc hello(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello world!\")\n    conn.Write([]byte(r.URL.Path + \"\\n\")) //Here I'm attemping to send it\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", hello)\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7994036, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9621bee9b45b1c0fb4b66349c95dcec5?s=128&d=identicon&r=PG&f=1", "display_name": "rtgojtr", "link": "https://stackoverflow.com/users/7994036/rtgojtr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 564, "favorite_count": 0, "accepted_answer_id": 43967633, "answer_count": 1, "score": -2, "last_activity_date": 1494793551, "creation_date": 1494784388, "last_edit_date": 1494793551, "question_id": 43967130, "link": "https://stackoverflow.com/questions/43967130/golang-http-server-send-r-url-path-over-socket", "title": "golang http server send r.URL.Path over socket", "body": "<p>I have a http server, and I want to send the r.URL.Path text to a client using a socket</p>\n\n<p>I get a error:  undefined: conn in conn.Write\nThis is becauase conn is defined in another function</p>\n\n<p>What I have tried:</p>\n\n<pre><code>package main\n\nimport (\n    \"net\"\n    \"io\"\n    \"net/http\"\n)\n\n\nln, _ := net.Listen(\"tcp\", \":8081\")\nconn, _ := ln.Accept()\n\nfunc hello(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello world!\")\n    conn.Write([]byte(r.URL.Path + \"\\n\")) //Here I'm attemping to send it\n}\n\nfunc main() {\n\n\n    http.HandleFunc(\"/\", hello)\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 0, "creation_date": 1494777235, "post_id": 43965899, "comment_id": 74961789, "body": "Can you post some code?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "edited": false, "score": 0, "creation_date": 1494778300, "post_id": 43965899, "comment_id": 74962166, "body": "Can you please update/edit your question with that code?"}, {"owner": {"reputation": 5714, "user_id": 211197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqXAX.jpg?s=128&g=1", "display_name": "maksimov", "link": "https://stackoverflow.com/users/211197/maksimov"}, "edited": false, "score": 0, "creation_date": 1494778513, "post_id": 43965899, "comment_id": 74962249, "body": "Stupid question: seeing how <code>folder</code> is a global variable, is it possible it didn&#39;t get initialised before the <code>readDir</code> func call?"}, {"owner": {"reputation": 21, "user_id": 8010665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73ca026f6b3ba316cab379ce912d3760?s=128&d=identicon&r=PG&f=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/8010665/alexm"}, "edited": false, "score": 0, "creation_date": 1494778755, "post_id": 43965899, "comment_id": 74962334, "body": "Not really. It still fails if I replace with the string directly. And it is initialized, because y() prints its value."}], "answers": [{"comments": [{"owner": {"reputation": 5714, "user_id": 211197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqXAX.jpg?s=128&g=1", "display_name": "maksimov", "link": "https://stackoverflow.com/users/211197/maksimov"}, "edited": false, "score": 0, "creation_date": 1494778671, "post_id": 43966180, "comment_id": 74962305, "body": "Was just about to suggest to correct the <code>err</code> check"}, {"owner": {"reputation": 5714, "user_id": 211197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zqXAX.jpg?s=128&g=1", "display_name": "maksimov", "link": "https://stackoverflow.com/users/211197/maksimov"}, "edited": false, "score": 0, "creation_date": 1494782668, "post_id": 43966180, "comment_id": 74963564, "body": "@peterSO thanks, my mistake was thinking that <code>infos</code> is unsafe to range in case of error. Was only trying to help."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1494780082, "last_edit_date": 1494780082, "creation_date": 1494778635, "answer_id": 43966180, "question_id": 43965899, "link": "https://stackoverflow.com/questions/43965899/error-listing-folder-contents/43966180#43966180", "title": "Error listing folder contents", "body": "<p>Your <code>err</code> check looks backwards to me. I would have expected:</p>\n\n<pre><code>func readDir() {\n    infos, err := ioutil.ReadDir(folder)\n    if err != nil {\n        log.Fatal(err)\n    }\n    for _, info := range infos {\n        fmt.Println(info)\n    }\n}\n</code></pre>\n\n<p>A more idiomatic version which has <code>folder</code> as a parameter and returns any error is:</p>\n\n<pre><code>func readDir(folder string) error {\n    infos, err := ioutil.ReadDir(folder)\n    if err != nil {\n        return err\n    }\n    for _, info := range infos {\n        fmt.Println(info)\n    }\n    return nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1781434"}, "is_accepted": false, "score": 0, "last_activity_date": 1494778850, "creation_date": 1494778850, "answer_id": 43966217, "question_id": 43965899, "link": "https://stackoverflow.com/questions/43965899/error-listing-folder-contents/43966217#43966217", "title": "Error listing folder contents", "body": "<p>You are checking the error wrongly.</p>\n\n<pre><code>if err != nil {  // if there is an error (!)\n    // do something (as if there was no error)\n} else {\n    log.Fatal(err.Error()) // the dereference happens here, where err == nil.\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8010665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/73ca026f6b3ba316cab379ce912d3760?s=128&d=identicon&r=PG&f=1", "display_name": "AlexM", "link": "https://stackoverflow.com/users/8010665/alexm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 2, "accepted_answer_id": 43966180, "answer_count": 2, "score": 1, "last_activity_date": 1494780082, "creation_date": 1494776900, "last_edit_date": 1494778299, "question_id": 43965899, "link": "https://stackoverflow.com/questions/43965899/error-listing-folder-contents", "title": "Error listing folder contents", "body": "<p>Using Go 1.8.1, I'm trying to write something that handles files. The trouble is, while <code>filepath.Walk(...)</code> works ok, I need something a bit more flexible. So I turn to <code>ioutil.ReadDir(...)</code>, only to be greeted with a spectacular \"<code>panic: runtime error: invalid memory address or nil pointer dereference</code>\". I've tried alternatives (<code>filepath.Glob(...)</code>, <code>file.Readdirnames(...)</code>), they all result in the same error.\nWhat's really puzzling is <code>filepath.Walk(...)</code> uses <code>os.Lstat(...)</code>, but when I try to use <code>os.Lstat(...)</code> directly... I get the same error above.\nI've tried this on an updated Ubuntu 16.04 LTS and on an updated Fedora 25, it made no difference.</p>\n\n<p>My Go-fu is really weak (this is my first application besides \"hello world\"), so any help is appreciated.</p>\n\n<p>Here's some code that fails:</p>\n\n<pre><code>func glob() {\n    infos, err := filepath.Glob(\"*\")\n    if err != nil {\n        for _, info := range infos {\n            fmt.Println(info)\n        }\n    } else {\n        log.Fatal(err.Error())\n    }\n}\n\nfunc y() {\n    file, err := os.Open(folder)\n    println(file.Name())\n    defer file.Close()\n    infos, err := file.Readdirnames(0)\n    //infos, err := ioutil.ReadDir(folder)\n    if err != nil {\n        for _, info := range infos {\n            fmt.Println(info)\n        }\n    } else {\n        log.Fatal(err.Error())\n    }\n}\n\nfunc readDir() {\n    infos, err := ioutil.ReadDir(folder)\n    if err != nil {\n        for _, info := range infos {\n            fmt.Println(info)\n        }\n    } else {\n        log.Fatal(err.Error())\n    }\n}\n</code></pre>\n\n<p>and here's what works:</p>\n\n<pre><code>func walk() {\n    err := filepath.Walk(folder, printWalk)\n    if err != nil {\n        log.Fatal(os.Stderr, \"walk failed with error: %v\\n\", err)\n    }\n}\n\nfunc printWalk(path string, info os.FileInfo, err error) error {\n    if err != nil {\n        return err\n    }\n    fmt.Println(\"path:\", path, \"FileInfo.Name:\", info.Name())\n    return nil\n}\n</code></pre>\n"}, {"tags": ["go", "ncurses"], "answers": [{"comments": [{"owner": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "edited": false, "score": 0, "creation_date": 1495000873, "post_id": 43965693, "comment_id": 75060686, "body": "I thought about it and wondered: it must be bad to have a command line program in a readln state (wait for keyboard input) and then to just come in and hammer it with with a println, when it is already stuck in a readln state (command line/console is not thread safe?).   It could work just by luck, on some platforms, but is it really good practice to throw a println onto a command line program state that is specifically stuck in a read state waiting for keyboard input...   It does seem to work, on Windows, not sure about other platforms. But not sure if it is safe! thanks for answer"}], "tags": [], "owner": {"reputation": 1664, "user_id": 1833511, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/ab0c9cc3bb28498a3e83e5862ab2f5b4?s=128&d=identicon&r=PG", "display_name": "Dirk", "link": "https://stackoverflow.com/users/1833511/dirk"}, "is_accepted": false, "score": 0, "last_activity_date": 1494775783, "creation_date": 1494775783, "answer_id": 43965693, "question_id": 43965556, "link": "https://stackoverflow.com/questions/43965556/how-to-read-a-key-in-go-but-continue-application-if-no-key-pressed-within-x-seco/43965693#43965693", "title": "How to read a key in Go but continue application if no key pressed within x seconds?", "body": "<p>Probably the most \"go-isch\" way to do this is using a goroutine and channels. You start two goroutines, one which waits for input, and one which sleeps until after the timeout period. You then use a <code>select</code> statement in your main goroutine to check what event happened first (the input, or the timeout). Example code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc waitForInput(didInput chan&lt;- bool) {\n    // Wait for a valid input here\n\n    didInput &lt;- true\n}\n\nfunc main() {\n    didInput := make(chan bool, 1)\n    timeout := make(chan bool, 1)\n\n    go func() {\n        time.Sleep(5 * time.Second)\n        timeout &lt;- true\n    }()\n\n    go waitForInput(didInput)\n\n    select {\n    case &lt;-didInput:\n        fmt.Println(\"\")\n        // Continue your application here\n    case &lt;-timeout:\n        // Input timed out, quit your application here\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "edited": false, "score": 0, "creation_date": 1494777738, "post_id": 43965734, "comment_id": 74961987, "body": "Thanks! I will try it and report back. What did people use when there were no such thing as channels, threads, goroutines, etc.? But since go has channels, might as well use them"}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1494937035, "post_id": 43965734, "comment_id": 75030678, "body": "They wrote callbacks and/or reactive code (same thing really). Go &amp; CSP provides a cleaner abstraction IMO.  Notice though that the channel (above) has a one place buffer. In the simplest use-case, this is fine. But if there is a repeating need to read characters with a timeout, some more work is needed to design a way to drop unwanted characters if they miss the timeout."}, {"owner": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "edited": false, "score": 0, "creation_date": 1495001033, "post_id": 43965734, "comment_id": 75060761, "body": "wonder if using multiple threads or routines is a good idea on a possibly non thread safe command line console.... If it is stuck in a read state (waiting for keyboard input), to just come in and do a println when it is in that state, seems almost like breaking the law..   Maybe MS Windows has allowed this to work by luck or on purpose, but I guess console mode programs were never really meant for multi threads/routines , but I&#39;m not sure. I.e. if a readln or read state makes the command line stuck in that state, it seems bad to just force it into a println state when it is in readln."}, {"owner": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "edited": false, "score": 0, "creation_date": 1495001126, "post_id": 43965734, "comment_id": 75060818, "body": "cont&#39;d, so I will have to also look into ncurses to see how they do it without using threads or routines, if that&#39;s what they do... as I know there are console mode apps out there that have such timeouts, but how? But I appreciate both your answer and Dirk&#39;s answer, it does seem to be working on MS Windows either by luck or by design even though my gut tells me that sending a Println to a console (possibly not thread safe) when it is in a readln state, seems dangerous/risky"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "edited": false, "score": 0, "creation_date": 1495079140, "post_id": 43965734, "comment_id": 75102782, "body": "@OverflowingHuman I don&#39;t know what you mean by &quot;possibly non tread safe command line console&quot;, but golang channels are indeed thread safe (that is, you won&#39;t need to worry about race conditions)"}, {"owner": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "reply_to_user": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "edited": false, "score": 0, "creation_date": 1495178138, "post_id": 43965734, "comment_id": 75151771, "body": "@Nevermore yesterday....  it is not AFAIK a matter of whether Go is thread safe, but whether the old dos style console is safe to send a writeln/println when it&#39;s in a readln/scanln state, from another thread... Overwriting a readln/scanln with a println call could have bizarre consequences depending on what operating system. But maybe all operating systems are safe this way nowadays. This would need to be checked. Reminds me why console apps are not worth bothering with when you can build a nice GUI app with a message loop and avoid this 1970&#39;s style mess. But golang is better at console apps"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 5, "last_activity_date": 1494775950, "creation_date": 1494775950, "answer_id": 43965734, "question_id": 43965556, "link": "https://stackoverflow.com/questions/43965556/how-to-read-a-key-in-go-but-continue-application-if-no-key-pressed-within-x-seco/43965734#43965734", "title": "How to read a key in Go but continue application if no key pressed within x seconds?", "body": "<p>You don't need external dependencies to achieve this.</p>\n\n<p>You can use a channel and set a timeout on it.</p>\n\n<p>Here's documentation info about that: <a href=\"https://gobyexample.com/timeouts\" rel=\"noreferrer\">https://gobyexample.com/timeouts</a></p>\n\n<p>The key part is making the input go through the channel in a separate goroutine, so that the main thread does not block waiting. You can then decide how long to wait to receive the input through the channel by setting a timeout in the select clause.</p>\n\n<p>And here's a working sample using your post as a base:</p>\n\n<pre><code>package main \n\nimport (\n    \"bufio\"\n    \"os\"\n    \"log\"\n    \"fmt\"\n    \"time\"\n)\n\nvar reader = bufio.NewReader(os.Stdin)\n\nfunc readKey(input chan rune) {\n    char, _, err := reader.ReadRune()\n    if err != nil {\n        log.Fatal(err)\n    }\n    input &lt;- char\n}\n\nfunc main() {\n    input := make(chan rune, 1)\n    fmt.Println(\"Checking keyboard input...\")\n    go readKey(input)\n    select {\n        case i := &lt;-input:\n            fmt.Printf(\"Input : %v\\n\", i)\n        case &lt;-time.After(5000 * time.Millisecond):\n            fmt.Println(\"Time out!\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 745, "user_id": 4547609, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/108385d869de0f7c3c4e5964d639fe5a?s=128&d=identicon&r=PG", "display_name": "Another Prog", "link": "https://stackoverflow.com/users/4547609/another-prog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1494775950, "creation_date": 1494774913, "last_edit_date": 1494775276, "question_id": 43965556, "link": "https://stackoverflow.com/questions/43965556/how-to-read-a-key-in-go-but-continue-application-if-no-key-pressed-within-x-seco", "title": "How to read a key in Go but continue application if no key pressed within x seconds?", "body": "<p>This is an easy way to read a key from the console</p>\n\n<pre><code>reader := bufio.NewReader(os.Stdin)\n\n// ...\n\nfunc readKey() rune {\n    char, _, err := reader.ReadRune()\n    if err != nil {\n        fmt.Println(\"Error reading key: \", err)\n    }\n    return char\n}\n\n// ...\n\nfmt.Println(\"Checking keyboard input...\")    \n\nloop:\nfor {\n    keyb := readKey()\n    switch keyb {\n    case 'x':\n      fmt.Println(\"x key pressed, exiting loop\")\n      break loop\n    }\n}\n</code></pre>\n\n<p>However the issue is the application always waits for a key to be read. What if you want to wait only 5 seconds for a key to be read, and if no key is read, continue the application?</p>\n\n<p>I'm thinking that I must pull in a dependency maybe, such as <strong>ncurses</strong> or a unit (module) that turbopascal had which was called <strong>crt</strong> and had a readkey function.  But is a dependency really necessary or is there an easy way to do it without? Possibly even some defer() tricks, I don't know.</p>\n"}, {"tags": ["go", "middleware"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6533004, "user_type": "registered", "profile_image": "https://graph.facebook.com/616579678505323/picture?type=large", "display_name": "Rohith Balaji", "link": "https://stackoverflow.com/users/6533004/rohith-balaji"}, "edited": false, "score": 0, "creation_date": 1494771040, "post_id": 43964572, "comment_id": 74959670, "body": "User.CreateUser is of type httprouter.Handle i.e., <code>func (w http.ResponseWriter, r *http.Request, ps httprouter.Params)</code>. I would also consider passing parameters to this function. Also, if I chain multiple middlewares, how does this code change in the parent middleware? i.e., <code>router.POST(&quot;&#47;api&#47;user&#47;create&quot;, middlewares.VerifyCSRF(middlewares.EscapeStringsMiddleware(U&zwnj;&#8203;ser.CreateUser)))</code>"}, {"owner": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "reply_to_user": {"reputation": 33, "user_id": 6533004, "user_type": "registered", "profile_image": "https://graph.facebook.com/616579678505323/picture?type=large", "display_name": "Rohith Balaji", "link": "https://stackoverflow.com/users/6533004/rohith-balaji"}, "edited": false, "score": 0, "creation_date": 1494773122, "post_id": 43964572, "comment_id": 74960314, "body": "@RohithBalaji post a full runnable example with the error, then I can say more"}], "tags": [], "owner": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "is_accepted": true, "score": 16, "last_activity_date": 1494777072, "last_edit_date": 1494777072, "creation_date": 1494769381, "answer_id": 43964572, "question_id": 43964461, "link": "https://stackoverflow.com/questions/43964461/how-to-use-middlewares-when-using-julienschmidt-httprouter-in-golang/43964572#43964572", "title": "How to use middlewares when using julienschmidt/httprouter in goLang?", "body": "<p>This issue is not with your middleware handler. You are getting errs because <code>User.CreateUser</code> is not of type <code>http.Handler</code>.</p>\n\n<p>Try this pattern :</p>\n\n<p>The important bit is to return a <code>http.Handler</code> and wrap <code>func(w http.ResponseWriter, r *http.Request)</code> with <code>http.HandlerFunc</code>.</p>\n\n<pre><code>func Handler() http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // do stuff\n    })\n}\n</code></pre>\n\n<hr>\n\n<p>go source :</p>\n\n<pre><code>// The HandlerFunc type is an adapter to allow the use of\n// ordinary functions as HTTP handlers. If f is a function\n// with the appropriate signature, HandlerFunc(f) is a\n// Handler that calls f.\ntype HandlerFunc func(ResponseWriter, *Request)\n\n// ServeHTTP calls f(w, r).\nfunc (f HandlerFunc) ServeHTTP(w ResponseWriter, r *Request) {\n    f(w, r)\n}\n</code></pre>\n\n<hr>\n\n<p>Based on your feedback:</p>\n\n<p><code>httprouter.Handle</code> does not implement <code>ServeHTTP</code>. It is called directly. For example : <code>next(w, r, ps)</code></p>\n\n<p>Below you will find examples of middleware handlers.</p>\n\n<pre><code>// Middleware without \"github.com/julienschmidt/httprouter\"\nfunc StdToStdMiddleware(next http.Handler) http.Handler {\n\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // do stuff\n        next.ServeHTTP(w, r)\n    })\n}\n\n// Middleware for a standard handler returning a \"github.com/julienschmidt/httprouter\" Handle\nfunc StdToJulienMiddleware(next http.Handler) httprouter.Handle {\n\n    return func(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n        // do stuff\n        next.ServeHTTP(w, r)\n    }\n}\n\n// Pure \"github.com/julienschmidt/httprouter\" middleware\nfunc JulienToJulienMiddleware(next httprouter.Handle) httprouter.Handle {\n\n    return func(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n        // do stuff\n        next(w, r, ps)\n    }\n}\n\nfunc JulienHandler() httprouter.Handle {\n    return func(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n        // do stuff\n    }\n}\n\nfunc StdHandler() http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        // do stuff\n    })\n}\n\nfunc main() {\n    router := httprouter.New()\n    router.POST(\"/api/user/create\", StdToJulienMiddleware(StdHandler()))\n    router.GET(\"/api/user/create\", JulienToJulienMiddleware(JulienHandler()))\n    log.Fatal(http.ListenAndServe(\":8000\", router))\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 168, "user_id": 2553289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f6420773829c839bdb97cb0c7bfe27f?s=128&d=identicon&r=PG", "display_name": "Matjaz Hirsman", "link": "https://stackoverflow.com/users/2553289/matjaz-hirsman"}, "is_accepted": false, "score": 0, "last_activity_date": 1512925738, "creation_date": 1512925738, "answer_id": 47741287, "question_id": 43964461, "link": "https://stackoverflow.com/questions/43964461/how-to-use-middlewares-when-using-julienschmidt-httprouter-in-golang/47741287#47741287", "title": "How to use middlewares when using julienschmidt/httprouter in goLang?", "body": "<p>From <a href=\"https://github.com/cnvrtly/adaptr\" rel=\"nofollow noreferrer\">https://github.com/cnvrtly/adaptr</a> lib where adapters are also added to chain request middleware functions. </p>\n\n<pre><code>func compatibleHandler(h http.Handler, httprParamsCtxKey interface{}) httprouter.Handle {\nreturn toHttpRouterHandle(h, httprParamsCtxKey)\n}\nfunc toHttpRouterHandle(h http.Handler, httprParamsCtxKey interface{}) func(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n   return func(w http.ResponseWriter, r *http.Request, p httprouter.Params) {\n    if httprParamsCtxKey != nil {\n        r = SetCtxValue(r, httprParamsCtxKey, p)\n    }\n    h.ServeHTTP(w, r)\n   }\n}\n</code></pre>\n\n<p>If you are looking for example/idea how to define routes: <a href=\"https://github.com/cnvrtly/golang-appengine-seed\" rel=\"nofollow noreferrer\">https://github.com/cnvrtly/golang-appengine-seed</a></p>\n"}], "owner": {"reputation": 33, "user_id": 6533004, "user_type": "registered", "profile_image": "https://graph.facebook.com/616579678505323/picture?type=large", "display_name": "Rohith Balaji", "link": "https://stackoverflow.com/users/6533004/rohith-balaji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5032, "favorite_count": 3, "accepted_answer_id": 43964572, "answer_count": 2, "score": 3, "last_activity_date": 1512925738, "creation_date": 1494768685, "question_id": 43964461, "link": "https://stackoverflow.com/questions/43964461/how-to-use-middlewares-when-using-julienschmidt-httprouter-in-golang", "title": "How to use middlewares when using julienschmidt/httprouter in goLang?", "body": "<p>What's the best way to chain middlewares while using julienschmidt/httprouter?  </p>\n\n<p>As far as I have googled, http.HandlerFunc accepts functions only in the form <code>func (w ResponseWriter, r *Request)</code> whereas httprouter.Handle functions are of the form <code>func (w http.ResponseWriter, r *http.Request, ps httprouter.Params)</code>.  </p>\n\n<p>How to I chain middlewares without converting the httprouter.Handle function into http.HandlerFunc?</p>\n\n<p>For example:<br>\nMy routes.go is of the form,  </p>\n\n<pre><code>router  :=  httprouter.New()\nrouter.POST(\"/api/user/create\", middlewares.EscapeStringsMiddleware(User.CreateUser))\nlog.Fatal(http.ListenAndServe(\":8000\",  router))\n</code></pre>\n\n<p>How do I write middleware functions for the above mentioned route?</p>\n\n<p><strong>Already tried methods:</strong></p>\n\n<p>1.</p>\n\n<pre><code>func EscapeStringsMiddleware(next http.Handler) httprouter.Handle {\n\n    return func (response http.ResponseWriter, request *http.Request, ps httprouter.Params) {\n        err := request.ParseForm()\n        if err != nil {\n            panic(err)\n        }\n\n        for key, values := range request.Form {\n            for i, value := range values {\n                value = template.HTMLEscapeString(value)\n                value = template.JSEscapeString(value)\n                request.Form[key][i] = value\n            }\n        }\n        next.ServeHTTP(response, request)\n    }\n}\n</code></pre>\n\n<p><strong>Error obtained:</strong></p>\n\n<pre><code>cannot use User.CreateUser (type func(http.ResponseWriter, *http.Request, httprouter.Params)) as type http.Handler in argument to middlewares.EscapeStringsMiddleware:\nfunc(http.ResponseWriter, *http.Request, httprouter.Params) does not implement http.Handler (missing ServeHTTP method)\n</code></pre>\n\n<p>2.</p>\n\n<pre><code>func EscapeStringsMiddleware(next httprouter.Handle) httprouter.Handle {\n\n    return func (response http.ResponseWriter, request *http.Request, ps httprouter.Params) {\n        err := request.ParseForm()\n        if err != nil {\n            panic(err)\n        }\n\n        for key, values := range request.Form {\n            for i, value := range values {\n                value = template.HTMLEscapeString(value)\n                value = template.JSEscapeString(value)\n                request.Form[key][i] = value\n            }\n        }\n        next.ServeHTTP(response, request)\n    }\n}\n</code></pre>\n\n<p><strong>Error obtained:</strong></p>\n\n<pre><code>next.ServeHTTP undefined (type httprouter.Handle has no field or method ServeHTTP)\n</code></pre>\n\n<p>Also how do I chain multiple middleware?</p>\n\n<p>For example,</p>\n\n<pre><code>router.POST(\"/api/user/create\", middlewares.VerifyCSRF(middlewares.EscapeStringsMiddleware(User.CreateUser)))\n</code></pre>\n"}, {"tags": ["authentication", "go", "session-cookies"], "answers": [{"comments": [{"owner": {"reputation": 2157, "user_id": 602272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3cad999bf79f0232f5d60dee3b7bf2a?s=128&d=identicon&r=PG", "display_name": "Jesse Brands", "link": "https://stackoverflow.com/users/602272/jesse-brands"}, "reply_to_user": {"reputation": 1438, "user_id": 1483927, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/67162c81a0c88a1906521d757604cd44?s=128&d=identicon&r=PG", "display_name": "Ajax", "link": "https://stackoverflow.com/users/1483927/ajax"}, "edited": false, "score": 0, "creation_date": 1499237726, "post_id": 43967937, "comment_id": 76813768, "body": "No, it just handles the creation, verification and encryption of them. What you actually do with them and how they are handled are up to you - or by another library. This fits Go&#39;s philosophy of a lot of small libraries doing one thing well."}], "tags": [], "owner": {"reputation": 2157, "user_id": 602272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3cad999bf79f0232f5d60dee3b7bf2a?s=128&d=identicon&r=PG", "display_name": "Jesse Brands", "link": "https://stackoverflow.com/users/602272/jesse-brands"}, "is_accepted": false, "score": 1, "last_activity_date": 1494789666, "creation_date": 1494789666, "answer_id": 43967937, "question_id": 43964428, "link": "https://stackoverflow.com/questions/43964428/sessions-in-variable-vs-sessions-in-database-in-golang/43967937#43967937", "title": "Sessions in variable vs sessions in database in golang", "body": "<p>If you are making a RESTful API as you are, consider using authentication bearer tokens instead. You may wish to consider using <a href=\"https://jwt.io/\" rel=\"nofollow noreferrer\">JSON Web Tokens</a> for that. A RESTful service wants to have as little (preferably none) server side state as possible.</p>\n\n<p>As this is a Go question, a good library for using JWT and JWE is <a href=\"https://github.com/square/go-jose\" rel=\"nofollow noreferrer\">go-jose from Square.</a></p>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494938253, "creation_date": 1494768488, "last_edit_date": 1494938253, "question_id": 43964428, "link": "https://stackoverflow.com/questions/43964428/sessions-in-variable-vs-sessions-in-database-in-golang", "title": "Sessions in variable vs sessions in database in golang", "body": "<p>I am currently working on a Rest-API using Golang. That API includes authentication so I manage to save the sessions id in a map. Everything is working very well, but now am wondering if I should save the sessions id in the database. I am thinking in things like security, memory usage, performance and standars used in the industry.\nSo which is the best approach to make it? Thank you very much</p>\n"}, {"tags": ["go", "concurrency", "redis"], "answers": [{"tags": [], "owner": {"reputation": 3609, "user_id": 3763102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2439148d94bddcda4415797c8f6afefa?s=128&d=identicon&r=PG", "display_name": "gipsy", "link": "https://stackoverflow.com/users/3763102/gipsy"}, "is_accepted": true, "score": 0, "last_activity_date": 1495462309, "last_edit_date": 1495462309, "creation_date": 1494764984, "answer_id": 43963903, "question_id": 43962874, "link": "https://stackoverflow.com/questions/43962874/concurrently-inserting-to-redis/43963903#43963903", "title": "Concurrently inserting to Redis", "body": "<p>More or less every operation on redis is atomic , i.e only one operation will be executing on the redis server at any given time. So in theory if you want to do say 3 million set operations on a redis server all those operations will happen serially.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user8006063"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 215, "favorite_count": 0, "accepted_answer_id": 43963903, "answer_count": 1, "score": 0, "last_activity_date": 1495462309, "creation_date": 1494757902, "question_id": 43962874, "link": "https://stackoverflow.com/questions/43962874/concurrently-inserting-to-redis", "title": "Concurrently inserting to Redis", "body": "<p>I have three elements consisting of 1 million, 2 million and 3 million ints respectively. I want to insert them to redis such that they all happen concurrently and the total execution time is not greater than the execution time of the 3 million ints. I tried using sync.Waitgroup but it doesn't speed up the execution. Here's my basic code.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"strconv\"\n    \"time\"\n\n    \"gopkg.in/redis.v5\"\n)\n\nfunc main() {\n    oneMillion := makeRange(1, 1000000)\n    twoMillion := makeRange(1000001, 3000000)\n    threeMillion := makeRange(3000001, 6000000)\n    elements := [][]int{oneMillion, twoMillion, threeMillion}\n    client := redis.NewClient(&amp;redis.Options{\n        Addr:         \"localhost:6379\",\n        Password:     \"\",\n        DB:           0,\n        DialTimeout:  60 * time.Second,\n        WriteTimeout: 60 * time.Second,\n        ReadTimeout:  60 * time.Second,\n        PoolTimeout:  60 * time.Second,\n    })\n    pipeline := client.Pipeline()\n    for _, elem := range elements {\n        for i := 0; i &lt; len(elem); i++ {\n            key := \"KEY:\" + strconv.Itoa(elem[i])\n            val := \"VAL:\" + strconv.Itoa(elem[i])\n            cmd := pipeline.Set(key, val, 0)\n            if cmd.Err() != nil {\n                log.Fatal(\"cmd error: \", cmd.Err())\n            }\n        }\n        _, err := pipeline.Exec()\n        if err != nil {\n            log.Fatal(\"error: \", err)\n        }\n    }\n}\n\nfunc makeRange(min, max int) []int {\n    a := make([]int, max-min+1)\n    for i := range a {\n        a[i] = min + i\n    }\n    return a\n}\n</code></pre>\n"}, {"tags": ["sockets", "go"], "comments": [{"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1494757741, "post_id": 43962818, "comment_id": 74955946, "body": "Servers don&#39;t connect. Clients connect. Servers listen and accept connections. If you get &#39;address already in use when binding, the address is already in use, possibly by a prior instance of your program, possibly because &#39;abruptly killing&#39; is not the way to terminate it."}, {"owner": {"reputation": 415, "user_id": 7844239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4592b2e5235c0a47eb851d1a58d942?s=128&d=identicon&r=PG&f=1", "display_name": "J Aamish", "link": "https://stackoverflow.com/users/7844239/j-aamish"}, "reply_to_user": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1494757868, "post_id": 43962818, "comment_id": 74955984, "body": "@EJP Wow.. -1 for a typo, where I had written <code>connect</code> instead of <code>listen</code>. That is funny that you say that abruptly killing is not the way to terminate it. I know that. However, when a customer who is using my program somehow kills it, I want to think how to handle it graceful! In C, I can use reuse socket, but how to do that in Go in the question here. Think before you give negative points to a question!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1494762832, "post_id": 43962818, "comment_id": 74957291, "body": "SO_REUSEADDR isn&#39;t relevant here (see <a href=\"http://stackoverflow.com/questions/15716302/so-reuseaddr-and-af-unix\" title=\"so reuseaddr and af unix\">stackoverflow.com/questions/15716302/so-reuseaddr-and-af-uni&zwnj;&#8203;x</a>). Delete the file if you don&#39;t need it and want to bind to that address again."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494763711, "post_id": 43962818, "comment_id": 74957546, "body": "See this <a href=\"http://stackoverflow.com/questions/16681944/how-to-reliably-unlink-a-unix-domain-socket-in-go-programming-language\">related question</a>. In short, also handle <code>os.Kill</code> and <code>syscall.SIGTERM</code> signal in <code>signal.Notify</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494766697, "post_id": 43962818, "comment_id": 74958347, "body": "@putu you can&#39;t handle SIGKILL."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1494767933, "post_id": 43962818, "comment_id": 74958714, "body": "@JimB yes, you&#39;re right, my mistake. As you mentioned simply deleting the file <code>&#47;tmp&#47;go.sock</code> before calling <code>net.Listen</code> should fix the problem."}, {"owner": {"reputation": 752, "user_id": 7496656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zMGuk.jpg?s=128&g=1", "display_name": "Jan Zerebecki", "link": "https://stackoverflow.com/users/7496656/jan-zerebecki"}, "edited": false, "score": 2, "creation_date": 1494791680, "post_id": 43962818, "comment_id": 74966353, "body": "This answer explains how to detect if a working instance is listening, and its question has more details on why to delete the unix domain socket: <a href=\"http://stackoverflow.com/a/13719866/7496656\">stackoverflow.com/a/13719866/7496656</a>"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user1529891"}, "is_accepted": false, "score": 0, "last_activity_date": 1495233216, "creation_date": 1495233216, "answer_id": 44079892, "question_id": 43962818, "link": "https://stackoverflow.com/questions/43962818/go-unix-domain-socket-bind-address-already-in-use/44079892#44079892", "title": "Go Unix Domain Socket: bind address already in use", "body": "<p>You need to catch the signal and cleanup; some example code:</p>\n\n<pre><code>func HandleSIGINTKILL() chan os.Signal {\n    sig := make(chan os.Signal, 1)\n\n    signal.Notify(sig, syscall.SIGINT, syscall.SIGTERM)\n\n    return sig\n}\n\n...\ngo func() {\n    &lt;-HandleSIGINTKILL()\n\n    log.Info(\"Received termination signal\")\n    // Cleanup code here\n\n    os.Exit(0)\n}()\n</code></pre>\n\n<p>This will of course not work if you <code>kill -9</code> the process; you will need to manually remove the socket (or have your init system do it for you).</p>\n"}], "owner": {"reputation": 415, "user_id": 7844239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5f4592b2e5235c0a47eb851d1a58d942?s=128&d=identicon&r=PG&f=1", "display_name": "J Aamish", "link": "https://stackoverflow.com/users/7844239/j-aamish"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2987, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1495233216, "creation_date": 1494757474, "last_edit_date": 1495542393, "question_id": 43962818, "link": "https://stackoverflow.com/questions/43962818/go-unix-domain-socket-bind-address-already-in-use", "title": "Go Unix Domain Socket: bind address already in use", "body": "<p>I'm having the following server code, which listens via unix domain socket</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net\"\n    \"os\"\n    \"os/signal\"\n    \"syscall\"\n)\n\nfunc echoServer(c net.Conn) {\n    for {\n        buf := make([]byte, 512)\n        nr, err := c.Read(buf)\n        if err != nil {\n            return\n        }\n\n        data := buf[0:nr]\n        println(\"Server got:\", string(data))\n        _, err = c.Write(data)\n        if err != nil {\n            log.Fatal(\"Writing client error: \", err)\n        }\n    }\n}\n\nfunc main() {\n    log.Println(\"Starting echo server\")\n    ln, err := net.Listen(\"unix\", \"/tmp/go.sock\")\n    if err != nil {\n        log.Fatal(\"Listen error: \", err)\n    }\n\n    sigc := make(chan os.Signal, 1)\n    signal.Notify(sigc, os.Interrupt, syscall.SIGTERM)\n    go func(ln net.Listener, c chan os.Signal) {\n        sig := &lt;-c\n        log.Printf(\"Caught signal %s: shutting down.\", sig)\n        ln.Close()\n        os.Exit(0)\n    }(ln, sigc)\n\n    for {\n        fd, err := ln.Accept()\n        if err != nil {\n            log.Fatal(\"Accept error: \", err)\n        }\n\n        go echoServer(fd)\n    }\n}\n</code></pre>\n\n<p>When I close it using Ctrl+C, then the signal is captured and the socket is closed. When I rerun the program, everything works fine.</p>\n\n<p>However, if the running process is abruptly killed, and if the program is restarted, the listen fails with the error <code>Listen error: listen unix /tmp/go.sock: bind: address already in use</code></p>\n\n<p>How to graciously handle this?</p>\n\n<p>The reason why I ask this is: I know that abruptly killing is not the normal method, but my program shall be launched automatically as a daemon and if my daemon is restarted, I want to be able to listen to the socket again without this error. </p>\n\n<p>It could also be because of a prior instance running, which I understand. The question here is how to programmatically identify in Go and handle this situation. As pointed in the answer <a href=\"https://stackoverflow.com/a/1592120/7844239\">here</a>, one can use SO_REUSEADDR in C programs. Is there such a possibility in Go? Also, how do C programs handle this multiple instance problem.</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1494746210, "post_id": 43961290, "comment_id": 74953160, "body": "&quot;while there is a difference for the initialization&quot; --- you can initialise them the same way: <code>s2 := &amp;Struct2{ \t\tsample1{&quot;foo&quot;}, \t\tsample2{&quot;bar&quot;} \t}</code>"}, {"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494746495, "post_id": 43961290, "comment_id": 74953226, "body": "@zerkms I appreciate for your advice. For <code>s1</code>, pointer has to be used like <code>s1 := &amp;Struct1{&amp;sample1{&quot;foo&quot;}, &amp;sample2{&quot;bar&quot;}}</code>. <code>s1 := &amp;Struct1{sample1{&quot;foo&quot;}, sample2{&quot;bar&quot;}}</code> occurs an error. So I thought those are difference."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1494746534, "post_id": 43961290, "comment_id": 74953240, "body": "Because for the first one those should be pointers (you declared it so): <code>&amp;sample1</code> and <code>&amp;sample2</code>. It&#39;s totally not a &quot;difference&quot;."}, {"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494747835, "post_id": 43961290, "comment_id": 74953548, "body": "@zerkms This is new information for me. Now I could know that Struct1 and Struct2 are the same. Are there suitable situations for those?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1494749334, "post_id": 43961290, "comment_id": 74953892, "body": "For me - embedding is a design tool. If a type relates to another type via an &quot;is a&quot; relation, then you embed it (but only if it&#39;s necessary). Otherwise you do not. So by default - prefer to never embed."}, {"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1494751143, "post_id": 43961290, "comment_id": 74954337, "body": "@zerkms I appreciate for your great advices. I could understand this problem. I would like to accept this as a solved question. Can you write your answer? Thank you so much for your time."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1494758001, "post_id": 43961290, "comment_id": 74956026, "body": "May I advice you to acquire and read <a href=\"http://www.gopl.io/\" rel=\"nofollow noreferrer\">&quot;The Go Programming language&quot; book</a>? It is IMHO of astonishing quality in delivering the material in gentle and gradual way, and at the same time it deals with all the gory details--including the embedding. (I&#39;m not affiliated with neither the authors nor the sellers.)"}, {"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1494813775, "post_id": 43961290, "comment_id": 74971110, "body": "@kostix Thank you for your advices. I have never known the Book you showed. I always have seen at Google, <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour.golang.org/welcome/1</a> and <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html</a> I would like to also consider such books."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1494841931, "post_id": 43961290, "comment_id": 74982127, "body": "The tour is a very good starting point, and Effective Go is a very good material, but <a href=\"https://github.com/golang/go/wiki/Books\" rel=\"nofollow noreferrer\">there are plenty of books on Go as well</a> (some of them are even free; look for the book by Caleb Doxsey for example). Of those I read, the one I recommended, is unparalleled in the way it presents the material. The only problem one may have with it is that it assumes prior knowledge or a C-like language; complete beginners might get lost in it."}, {"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1494997183, "post_id": 43961290, "comment_id": 75059254, "body": "@kostix Thank you so much for your advices."}], "answers": [{"comments": [{"owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "edited": false, "score": 0, "creation_date": 1494814122, "post_id": 43964784, "comment_id": 74971189, "body": "Thank you for your advices and samples. These samples are very helpful for me. I would like to solve my question with your answer. Thank you again."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1494770550, "creation_date": 1494770550, "answer_id": 43964784, "question_id": 43961290, "link": "https://stackoverflow.com/questions/43961290/differences-of-embedded-and-field/43964784#43964784", "title": "Differences of embedded and field", "body": "<p>As about second question, personally I mostly use embedding to promote methods</p>\n\n<pre><code>//having\ntype Doer interface{\n    Do()\n}\nfunc DoWith(d Doer){}\nfunc (s sample1)Do(){} //implemented\ntype Struct1 struct {\n    sample1\n}\ntype Struct2 struct {\n    Sample1 sample1\n}\nvar s1 Struct1\nvar s2 Struct2\n//you can call\nDoWith(s1) //method promoted so interface satisfied\n//but cannot\nDoWith(s2)\n</code></pre>\n\n<p>and to decode JSON,</p>\n\n<pre><code>//having\ntype Sample1 struct {\n    Data string `json:\"data\"`\n}\ntype Sample2 struct {\n    Number int `json:\"number\"`\n}\n//you can easy and handy compose\ntype Struct1 struct {\n    Sample1\n    Sample2\n}\nvar s1 Struct1\njson.Unmarshal([]byte(`{\"data\": \"foo\", \"number\": 5}`), &amp;s1)\nfmt.Println(s1.Data, s1.Number) //print foo 5\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 7778299, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/7IFHF.png?s=128&g=1", "display_name": "Elsa", "link": "https://stackoverflow.com/users/7778299/elsa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 43964784, "answer_count": 1, "score": 2, "last_activity_date": 1494770550, "creation_date": 1494745748, "last_edit_date": 1592644375, "question_id": 43961290, "link": "https://stackoverflow.com/questions/43961290/differences-of-embedded-and-field", "title": "Differences of embedded and field", "body": "<p>There are embedded struct <code>Struct1</code> and a struct <code>Struct2</code> defined as field. Both <code>fmt.Printf()</code> are same results while there is a difference for the initialization. I confused about this. I'm sorry.</p>\n<ol>\n<li>What differences are these between <code>Struct1</code> and <code>Struct2</code>?</li>\n<li>Which should be used under what situation?</li>\n</ol>\n<h3>Script</h3>\n<pre><code>type sample1 struct {\n    Data string\n}\n\ntype sample2 struct {\n    Data string\n}\n\ntype Struct1 struct {\n    *sample1\n    *sample2\n}\n\ntype Struct2 struct {\n    Sample1 sample1\n    Sample2 sample2\n}\n\nfunc main() {\n    s1 := &amp;Struct1{\n        &amp;sample1{},\n        &amp;sample2{},\n    }\n    s1.sample1.Data = &quot;s1 sample1 data&quot;\n    s1.sample2.Data = &quot;s1 sample2 data&quot;\n\n    s2 := &amp;Struct2{}\n    s2.Sample1.Data = &quot;s2 sample1 data&quot;\n    s2.Sample2.Data = &quot;s2 sample2 data&quot;\n\n    fmt.Printf(&quot;%s, %s\\n&quot;, s1.sample1.Data, s1.sample2.Data)\n    fmt.Printf(&quot;%s, %s\\n&quot;, s2.Sample1.Data, s2.Sample2.Data)\n}\n</code></pre>\n<p><a href=\"https://play.golang.org/p/gUy6gwVJDP\" rel=\"nofollow noreferrer\">https://play.golang.org/p/gUy6gwVJDP</a></p>\n<p>Thank you so much for your time and advices. And I'm sorry for my immature question.</p>\n"}, {"tags": ["go", "command", "exec"], "comments": [{"owner": {"reputation": 905, "user_id": 3781709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4fa60c6b287ee4f006d6c4e320daf5?s=128&d=identicon&r=PG", "display_name": "Pradip Patil", "link": "https://stackoverflow.com/users/3781709/pradip-patil"}, "edited": false, "score": 0, "creation_date": 1494792768, "post_id": 43960281, "comment_id": 74966638, "body": "<code>Go</code> will not expand <code>~</code> to user&#39;s home directory in this case. <a href=\"http://stackoverflow.com/a/17617721/3781709\">stackoverflow.com/a/17617721/3781709</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 1, "last_activity_date": 1494739477, "last_edit_date": 1494739477, "creation_date": 1494738274, "answer_id": 43960558, "question_id": 43960281, "link": "https://stackoverflow.com/questions/43960281/different-result-between-run-bash-command-directly-and-through-exec-command/43960558#43960558", "title": "Different result between run bash command directly and through exec.Command", "body": "<p>If you run the command in a shell (e.g. bash), a <a href=\"https://www.gnu.org/software/bash/manual/html_node/Tilde-Expansion.html\" rel=\"nofollow noreferrer\">tilde-prefix</a> is expanded by the shell before being passed to <code>realpath</code>.</p>\n\n<p>However if you run it in a go application, tilde is left as is and <code>realpath</code> assumes it as a part of the path name. To see the difference, you can try the following command in shell (Linux OS):</p>\n\n<pre><code>//1. correctly expanded\nrealpath './bin'\n\n//2. tilde not expanded\nrealpath '~/bin'\n\n//3. tilde expansion\nrealpath ~/bin\n</code></pre>\n\n<p>The (2) should failed, and the situation in your go application is similar to this. To verify, change your go code as follows:</p>\n\n<pre><code>cmd := exec.Command(\"realpath\", \"~/bin\")\nvar out bytes.Buffer\nvar serr bytes.Buffer\ncmd.Stdout = &amp;out\ncmd.Stderr = &amp;serr\nerr := cmd.Run()\nif err != nil {\n    fmt.Printf(\"Error = %v, %v\\n\", err, serr.String())\n    panic(err)\n}\nfmt.Println(\"Realapth:\", out.String())\n</code></pre>\n\n<p>You should be able to observe error message produced by <code>realpath</code> command.</p>\n"}], "owner": {"reputation": 1585, "user_id": 853038, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/a9773c9d75baea0919e4412aeb4c89f8?s=128&d=identicon&r=PG", "display_name": "Enze Chi", "link": "https://stackoverflow.com/users/853038/enze-chi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 43960558, "answer_count": 1, "score": 2, "last_activity_date": 1494739477, "creation_date": 1494734968, "question_id": 43960281, "link": "https://stackoverflow.com/questions/43960281/different-result-between-run-bash-command-directly-and-through-exec-command", "title": "Different result between run bash command directly and through exec.Command", "body": "<p>On Linux OS, run \"realpath ~/bin\" gives the correct path \"/home/user1/bin\".</p>\n\n<p>But when I run it as bellow:</p>\n\n<pre><code>cmd := exec.Command(\"realpath\", \"~/bin\")\nvar out bytes.Buffer\ncmd.Stdout = &amp;out\nerr := cmd.Run()\nif err != nil {\n    panic(err)\n}\nfmt.Println(\"Realapth:\", out.String())\n</code></pre>\n\n<p>I got <code>panic: exit status 1</code>.</p>\n\n<p>BTW: with command as below:</p>\n\n<pre><code>cmd := exec.Command(\"realpath\", \"--help\")\n</code></pre>\n\n<p>I can get correct help message for <code>realpath</code> command. I think that means it is really in my executable path. </p>\n"}, {"tags": ["image", "go", "draw"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1494732901, "post_id": 43959864, "comment_id": 74951065, "body": "How if you change the <code>color.Alpha{128}</code> to <code>color.Alpha16{32767}</code>?"}, {"owner": {"reputation": 1144, "user_id": 6910451, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YntX4.png?s=128&g=1", "display_name": "ning", "link": "https://stackoverflow.com/users/6910451/ning"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494734609, "post_id": 43959864, "comment_id": 74951278, "body": "@putu Hi, thanks for your suggestion! I&#39;ll have to confirm with you again if it works, because right now both <code>color.Alpha{128}</code> and <code>color.Alpha16{32767}</code> is giving me what I want. It seems the glitch here is less reproducible than I thought... I&#39;ll update you if I can get it to glitch again."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1494737065, "post_id": 43959864, "comment_id": 74951620, "body": "Maybe glitch occurs when the image you&#39;re going to paste to the background has different <code>bpp</code> with the mask, e.g. 16-bit vs 8-bit (color.Alpha), 8-bit vs 16-bit (color.Alpha16) etc. Now let use <code>color.Alpha</code> as the mask. Print the image type you&#39;re going to paste onto the background (<code>i</code> in <code>AddImage</code>) and observe what was the image type when glitch occurs. In addition, you may also need to print the type of decoded image (i.e. map)."}, {"owner": {"reputation": 1144, "user_id": 6910451, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YntX4.png?s=128&g=1", "display_name": "ning", "link": "https://stackoverflow.com/users/6910451/ning"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494762518, "post_id": 43959864, "comment_id": 74957201, "body": "@putu Hi, I&#39;ve converted all images to image.RGBA. Still doesn&#39;t work (I&#39;ve updated my post with the details)."}, {"owner": {"reputation": 1144, "user_id": 6910451, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YntX4.png?s=128&g=1", "display_name": "ning", "link": "https://stackoverflow.com/users/6910451/ning"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1494821895, "post_id": 43959864, "comment_id": 74972744, "body": "@putu Thanks for your help so far. Turns out it was because I was using the wrong interpolation setting in resizing the overlay."}], "answers": [{"tags": [], "owner": {"reputation": 1144, "user_id": 6910451, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YntX4.png?s=128&g=1", "display_name": "ning", "link": "https://stackoverflow.com/users/6910451/ning"}, "is_accepted": true, "score": 2, "last_activity_date": 1494821854, "last_edit_date": 1494821854, "creation_date": 1494819480, "answer_id": 43971231, "question_id": 43959864, "link": "https://stackoverflow.com/questions/43959864/image-glitch-using-golangs-drawmask-with-draw-over/43971231#43971231", "title": "Image glitch using golang&#39;s drawmask with draw.Over", "body": "<p>Thanks to use <code>noethics</code> in the freenode #go-nuts channel for requesting a look at the original overlay, I found the issue while generating the output after each line that manipulates the image.</p>\n\n<p><strong>The issue is not with \"image/draw\", but with an external library I'm using to resize the overlay to the dimensions of the map, \"github.com/nfnt/resize\".</strong></p>\n\n<p>The overlay before resizing:</p>\n\n<p><img src=\"https://i.imgur.com/KdXALdH.png\" alt=\"Original image\"></p>\n\n<p>The overlay after resizing (red &amp; black pixels undesirable):</p>\n\n<p><img src=\"https://i.imgur.com/mus6gHF.png\" alt=\"return resize.Resize(1491, 836, i, resize.Lanczos3)\"></p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>It's not even an issue with \"github.com/nfnt/resize\". I was simply using the wrong interpolation algorithm. Turns out bilinear gives me the best output for the image I am working with. I suspect it's also the one used in the library I used to write my original script in.</p>\n\n<p><img src=\"https://i.imgur.com/IdRI2Qz.png\" alt=\"interpolationComparison\"></p>\n"}], "owner": {"reputation": 1144, "user_id": 6910451, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/YntX4.png?s=128&g=1", "display_name": "ning", "link": "https://stackoverflow.com/users/6910451/ning"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 628, "favorite_count": 1, "accepted_answer_id": 43971231, "answer_count": 1, "score": 1, "last_activity_date": 1494821854, "creation_date": 1494729545, "last_edit_date": 1495541898, "question_id": 43959864, "link": "https://stackoverflow.com/questions/43959864/image-glitch-using-golangs-drawmask-with-draw-over", "title": "Image glitch using golang&#39;s drawmask with draw.Over", "body": "<p>I am rewriting with golang a script I originally wrote in python. The function I am trying to recreate currently takes one image (a coloured overlay) and pastes it on a background (a map) of the same size, with 50% transparency. The desired output, as produced by my python script, is:</p>\n\n<p><img src=\"https://i.imgur.com/udsH5rz.png\" alt=\"Desired Output with Python\"></p>\n\n<p>The golang code I have written to try to replicate this in golang, with reference to <a href=\"https://stackoverflow.com/questions/12484403/setting-opacity-of-image-in-golang\">this stackoverflow thread</a>.</p>\n\n<p><em>In main.go</em></p>\n\n<pre><code>// overlayImg is type image.Image, consists of the coloured overlay\noverlayImg = lib.AddMap(overlayImg)\n// lib.SaveToRecords is a function that saves image.Image overlayImg to path specified by string download.FileName\nlib.SaveToRecords(overlayImg, download.FileName)\n</code></pre>\n\n<p><em>In package myproject/lib</em></p>\n\n<pre><code>func AddMap(i image.Image) image.Image{\n    // mapFile is the background map image\n    mapFile, err := os.Open(\"./res/map.png\")\n    if err != nil { panic(err) }\n    mapImg, _, err := image.Decode(mapFile)\n    if err != nil { panic(err) }\n    mask := image.NewUniform(color.Alpha{128})\n\n    canvas := image.NewRGBA(mapImg.Bounds())\n    draw.Draw(canvas, canvas.Bounds(), mapImg, image.Point{0, 0}, draw.Src)\n\n    draw.DrawMask(canvas, canvas.Bounds(), i, image.Point{0, 0}, mask, image.Point{0, 0}, draw.Over)\n\n    return canvas\n}\n</code></pre>\n\n<p>However, the resulting image is produced with a sort of 'glitch' in parts of the coloured overlay. This colour glitch is reliably reproduced on each run of the script, even with different overlays (the map stays the same throughout, of course). </p>\n\n<p><img src=\"https://i.imgur.com/jYsM4UA.jpg\" alt=\"Output with Golang\"></p>\n\n<p><strong>How do I get rid of the 'glitch'?</strong></p>\n\n<hr>\n\n<p>Things I have tried:</p>\n\n<ul>\n<li>Using <code>draw.Draw</code> in place of <code>draw.DrawMask</code> with <code>draw.Over</code> as the 'op' setting. Results in same colour 'glitch', but without transparency.</li>\n</ul>\n\n<p><img src=\"https://i.imgur.com/09UqaE3.png\" alt=\"draw.Draw with draw.Over\"></p>\n\n<ul>\n<li>Using <code>draw.DrawMask</code>, except with <code>draw.Src</code> as the 'op' setting. Result:</li>\n</ul>\n\n<p><img src=\"https://i.imgur.com/UTRFAjf.png\" alt=\"draw.DrawMask with draw.Src\"></p>\n\n<ul>\n<li>Using <code>draw.Draw</code> in place of <code>draw.DrawMask</code>, and with <code>draw.Src</code> as the 'op' setting. This was with a slightly different overlay image. Result:</li>\n</ul>\n\n<p><img src=\"https://i.imgur.com/8hrqlEL.png\" alt=\"draw.Draw with draw.Src\"></p>\n\n<hr>\n\n<p><strong>Update</strong></p>\n\n<p>I've tried assigning <code>mask := image.NewUniform(color.Alpha16{32767})</code> in place of <code>mask := image.NewUniform(color.Alpha{128})</code> according to <a href=\"https://stackoverflow.com/questions/43959864/image-glitch-using-golangs-drawmask-with-draw-over#comment74951065_43959864\">putu's comment</a>. Glitch still appears. Additionally, this glitch is not as consistent as I thought, showing up at only roughly 10% of the time. It seems the glitch shows up <strong>depending on the content of the image pasted unto the background</strong>.</p>\n\n<p><img src=\"https://i.imgur.com/qpOiiFQ.png\" alt=\"drawMask with draw.Over and Alpha16\"> </p>\n\n<hr>\n\n<p><strong>Update 2</strong></p>\n\n<p>Originally, <code>mapImg</code> was of type *image.NRGBA, <code>i</code> and <code>canvas</code> of type *image.RGBA. Once again following the advice <a href=\"https://stackoverflow.com/questions/43959864/image-glitch-using-golangs-drawmask-with-draw-over#comment74951620_43959864\">in the comments</a>, I converted <code>mapImg</code> to type *image.RGBA to match with the rest. To do this, I used the following few lines of code:</p>\n\n<pre><code>mapImg, _, err := image.Decode(mapFile)\nmapImgRGBA := image.NewRGBA(mapImg.Bounds())\ndraw.Draw(mapImgRGBA, mapImgRGBA.Bounds(), mapImg, image.Point{0, 0}, draw.Src)\n// Use mapImgRGBA in place of mapImg from here\n</code></pre>\n\n<p>Still don't work:</p>\n\n<p><img src=\"https://i.imgur.com/mOZ4NsR.png\" alt=\"Converting mapImg to RGBA\"></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1494722335, "post_id": 43959180, "comment_id": 74949566, "body": "I think you need to add <code>defer response.Body.Close()</code> after <code>http.Post</code> in client side code."}, {"owner": {"reputation": 4557, "user_id": 2561007, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d4ed28d0a70ddcb94b65d3be173aa329?s=128&d=identicon&r=PG", "display_name": "darklord", "link": "https://stackoverflow.com/users/2561007/darklord"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1494726436, "post_id": 43959180, "comment_id": 74950156, "body": "@putu You have right. I added the line but it doesn&#39;t solve the problem."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1494771679, "last_edit_date": 1494771679, "creation_date": 1494726921, "answer_id": 43959673, "question_id": 43959180, "link": "https://stackoverflow.com/questions/43959180/reading-multipart-request-results-in-unexpected-eof-error/43959673#43959673", "title": "Reading multipart request results in Unexpected EOF error", "body": "<p>The error indicates that the reader expected more data after the end of the request body. That missing data is the trailing boundary end line written by the <a href=\"https://godoc.org/mime/multipart#Writer.Close\" rel=\"nofollow noreferrer\">multipart Close</a> method.</p>\n\n<p>Call the Close method after writing all parts and before posting the form. </p>\n\n<pre><code>func syncApk(apkFile *os.File) {\n    defer apkFile.Close()\n    var buffer bytes.Buffer\n    writer := multipart.NewWriter(&amp;buffer)\n    part, err := writer.CreateFormFile(\"apk\", filepath.Base(apkFile.Name()))\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error creating form file: %v\\n\", err)\n        return\n    }\n\n    size, err := io.Copy(part, apkFile)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error copying apk file data: %v\\n\", err)\n        return\n    }\n    fmt.Fprintf(os.Stdout, \"Copied %v bytes for uploading...\\n\", size)\n    writer.Close()\n    response, err := http.Post(\"http://localhost:8080/upload\", writer.FormDataContentType(), &amp;buffer)\n\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error making POST request to sync apk: %v\\n\", err)\n        return\n    }\n    defer response.Body.Clse()\n\n    fmt.Fprintf(os.Stdout, \"Successfully uploaded apk file: %v\\n\", response.StatusCode)\n}\n</code></pre>\n"}], "owner": {"reputation": 4557, "user_id": 2561007, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/d4ed28d0a70ddcb94b65d3be173aa329?s=128&d=identicon&r=PG", "display_name": "darklord", "link": "https://stackoverflow.com/users/2561007/darklord"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3805, "favorite_count": 0, "accepted_answer_id": 43959673, "answer_count": 1, "score": 2, "last_activity_date": 1494771679, "creation_date": 1494720755, "last_edit_date": 1494721818, "question_id": 43959180, "link": "https://stackoverflow.com/questions/43959180/reading-multipart-request-results-in-unexpected-eof-error", "title": "Reading multipart request results in Unexpected EOF error", "body": "<p>Go version: 1.6.3 macos</p>\n\n<p>I am trying to write an api to upload an apk file (several MB in most cases) to the server. Here is the client side code:</p>\n\n<pre><code>func syncApk(apkFile *os.File) {\n    defer apkFile.Close()\n    var buffer bytes.Buffer\n    writer := multipart.NewWriter(&amp;buffer)\n    defer writer.Close()\n    part, err := writer.CreateFormFile(\"apk\", filepath.Base(apkFile.Name()))\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error creating form file: %v\\n\", err)\n        return\n    }\n\n    size, err := io.Copy(part, apkFile)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error copying apk file data: %v\\n\", err)\n        return\n    }\n    fmt.Fprintf(os.Stdout, \"Copied %v bytes for uploading...\\n\", size)\n\n    response, err := http.Post(\"http://localhost:8080/upload\", writer.FormDataContentType(), &amp;buffer)\n\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error making POST request to sync apk: %v\\n\", err)\n        return\n    }\n\n    fmt.Fprintf(os.Stdout, \"Successfully uploaded apk file: %v\\n\", response.StatusCode)\n}\n</code></pre>\n\n<p>Server code:</p>\n\n<pre><code>func main() {\n    server := http.Server{\n        Addr: \":8080\",\n    }\n    http.HandleFunc(\"/upload\", doApkUpload)\n    server.ListenAndServe()\n}\n\nfunc doApkUpload(w http.ResponseWriter, r *http.Request) {\n    file, _, err := r.FormFile(\"apk\")\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error retrieving apk file: %v\\n\", err)\n        return\n    }\n\n    data, err := ioutil.ReadAll(file)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Error reading apk file content: %v\", err)\n        return\n    }\n\n    fmt.Fprintf(os.Stdout, string(data))\n}\n</code></pre>\n\n<p>After I run the server on localhost I run client side code, I get:</p>\n\n<pre><code>Copied 1448401 bytes for uploading...\nSuccessfully uploaded apk file: 200\n</code></pre>\n\n<p>It looks like the multipart file is written correctly. However I see this error on the server side:</p>\n\n<pre><code>Error retrieving apk file: unexpected EOF\n</code></pre>\n\n<p>Any idea where is the problem? Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1494717565, "post_id": 43958297, "comment_id": 74948745, "body": "We need a simple, reproducible example: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1494721367, "post_id": 43959076, "comment_id": 74949406, "body": "&quot;dragonthooth.Move - is it really int16?&quot; No, it&#39;s <code>type Move uint16</code>. See <code>types.go</code> in <code>https:&#47;&#47;github.com&#47;dylhunn&#47;dragontoothmg</code>. Also, <code>type Board struct { Fullmoveno    uint16 }</code>"}, {"owner": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "edited": false, "score": 0, "creation_date": 1494729619, "post_id": 43959076, "comment_id": 74950597, "body": "Your sample code in the playground actually <i>can</i> reproduce the issue: just replace the evaluation <code>8</code> with a <code>-8</code>."}], "tags": [], "owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "is_accepted": false, "score": 0, "last_activity_date": 1494719570, "creation_date": 1494719570, "answer_id": 43959076, "question_id": 43958297, "link": "https://stackoverflow.com/questions/43958297/go-hashtable-casting-without-conversion/43959076#43959076", "title": "Go hashtable: casting without conversion?", "body": "<p>I can't reproduce your resultat in simplified code <a href=\"https://play.golang.org/p/shPN-1waZa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/shPN-1waZa</a>:</p>\n\n<pre><code>func Pack(m, eval int16, depth, ntype uint8) (value uint64) {\n    value = (uint64(eval) |\n        (uint64(m) &lt;&lt; 16) |\n        // (uint64(b.Fullmoveno) &lt;&lt; 32) |  &lt;-- My suspicion is here !\n        (uint64(depth) &lt;&lt; 48) |\n        (uint64(ntype) &lt;&lt; 56))\n    return\n}\nfunc Unpack(value uint64) (move int16, eval int16, depth uint8, ntype uint8) {\n    eval = int16(value &amp; 0xFFFF)\n    move = int16((value &gt;&gt; 16) &amp; 0xFFFF)\n    depth = uint8((value &gt;&gt; 48) &amp; 0xFF)\n    ntype = uint8((value &gt;&gt; 56) &amp; 0xFF)\n    return\n}\n\nfunc main() {\n    m, e, d, n := int16(8), int16(8), uint8(8), uint8(8)\n    packedValue := Pack(m, e, d, n)\n    fmt.Printf(\"%v\\n\", packedValue)\n    move, eval, depth, ntype := Unpack(packedValue)\n    fmt.Printf(\"%v %v %v %v\", move, eval, depth, ntype)\n}\n</code></pre>\n\n<p>But I have suspicions: </p>\n\n<p>a) dragonthooth.Move - is it really <code>int16</code>?  I suppose you have set of consts with values for this type </p>\n\n<p>b) You're packing 5 values and extract 4. Maybe it's not error, but check type of <code>b.Fullmoveno</code> is it <code>int16</code>?</p>\n\n<p>c) I can not judge about correctness of your other code. I just hope that you did not make errors in hash, index, keys, values. </p>\n\n<p>I can't quite understand your remaining code.</p>\n\n<ol>\n<li><p>I suppose you mean <code>value structure</code> and not <code>key structure</code> (because in your code it's value packed)</p></li>\n<li><p>Why did you define 2 keys and values in separate arrays?\nWhy not []{uint64,uint64}? Or even map[uint64]uint64?</p></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "is_accepted": true, "score": 0, "last_activity_date": 1494729568, "creation_date": 1494729568, "answer_id": 43959869, "question_id": 43958297, "link": "https://stackoverflow.com/questions/43958297/go-hashtable-casting-without-conversion/43959869#43959869", "title": "Go hashtable: casting without conversion?", "body": "<p>Thanks to everyone who responded. This was the solution to my issue:</p>\n\n<p><code>uint64(eval)</code> for negative values was moving the sign bit to the most significant bit of the 64-bit int, which then interfered with the data that was supposed to be stored at that bit. I solved it by first converting to <code>uint16</code>:</p>\n\n<p><code>uint64(uint16(eval))</code></p>\n"}], "owner": {"reputation": 764, "user_id": 3367128, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/100000468302976/picture?type=large", "display_name": "dylhunn", "link": "https://stackoverflow.com/users/3367128/dylhunn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 43959869, "answer_count": 2, "score": 0, "last_activity_date": 1494729568, "creation_date": 1494712023, "last_edit_date": 1494712331, "question_id": 43958297, "link": "https://stackoverflow.com/questions/43958297/go-hashtable-casting-without-conversion", "title": "Go hashtable: casting without conversion?", "body": "<p>I am implementing a specialized hashtable. I'm trying store a lot of data in a single 64-bit int key, for space usage and performance reasons.</p>\n\n<p>Each key should have this structure:</p>\n\n<pre><code>// Key structure, from LSB\n// eval result (16 bits)\n// move (16 bits)\n// age (16 bits): the move of the game on which this position would have occurred\n// depth (8 bits)\n// node type (8 bits): from the three constants above\n</code></pre>\n\n<p>Here is a simple implementation:</p>\n\n<pre><code>var keys [1000]uint64\nvar values [1000]uint64\n\nfunc Put(b *dragontoothmg.Board, m dragontoothmg.Move, eval int16, depth uint8, ntype uint8) {\n    var value uint64 = uint64(eval) | (uint64(m) &lt;&lt; 16) | (uint64(b.Fullmoveno) &lt;&lt; 32) |\n        (uint64(depth) &lt;&lt; 48) | (uint64(ntype) &lt;&lt; 56)\n    hash := b.Hash()\n    key := hash ^ value\n    index := hash % uint64(len(keys))\n    keys[index] = key\n    values[index] = value\n}\n\nfunc Get(b *dragontoothmg.Board) (found bool, move dragontoothmg.Move,\n    eval int16, depth uint8, ntype uint8) {\n    hash := b.Hash()\n    index := hash % uint64(len(keys))\n    key := keys[index]\n    value := values[index]\n    found = (hash == (key ^ value))\n    if !found {\n        return false, 0, 0, 0, 0\n    }\n    eval = int16(value &amp; 0xFFFF)\n    move = dragontoothmg.Move((value &gt;&gt; 16) &amp; 0xFFFF)\n    depth = uint8((value &gt;&gt; 48) &amp; 0xFF)\n    ntype = uint8((value &gt;&gt; 56) &amp; 0xFF)\n    return\n}\n</code></pre>\n\n<p>However, when I try to <code>Get()</code> the data, it comes back corrupted. I suspect this might be related to the fact that <code>eval</code> is a signed int, and the cast converts it to a signed uint64. What have I done wrong, and how can I fix it?</p>\n\n<p>This is failing test result:</p>\n\n<pre><code>--- FAIL: TestSimpleTt (0.10s)\n    transtable_test.go:37: Simple ttable test failed. \n        Put data: (board: rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 0) e2e4 -30 6 2 \n         Fetched data: true h8h8 -30 255 255\nFAIL\n</code></pre>\n\n<p><code>h8h8</code> is the maximum value of the field, for what it's worth.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1494717810, "post_id": 43957966, "comment_id": 74948781, "body": "As you can see from the tag on the question, the question is about the Go programming language."}], "tags": [], "owner": {"reputation": 429, "user_id": 6824263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6ed24c5350daf5d22a7fa4e2bfae0c2f?s=128&d=identicon&r=PG&f=1", "display_name": "Christian Frei", "link": "https://stackoverflow.com/users/6824263/christian-frei"}, "is_accepted": false, "score": -2, "last_activity_date": 1494709369, "creation_date": 1494709369, "answer_id": 43957966, "question_id": 43957893, "link": "https://stackoverflow.com/questions/43957893/how-to-separate-numbers-from-a-slice/43957966#43957966", "title": "How to separate numbers from a slice?", "body": "<p>you could make a something like this (sorry for pseudo code)</p>\n\n<pre><code>array = [1, 2, 3, 4, 5, 6, 7, 8, 9, 10]\n\nwhile (array){\n    list = \"\"\n    for($i=1;$i -le 3;$i++){\n    list.add = array[$i]\n    remove from array the array[$i]\n    }\n    your list now here (list)\n\n}\n</code></pre>\n\n<p>you could ask the first 3 values and after that you remove it</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1494727139, "last_edit_date": 1494727139, "creation_date": 1494715971, "answer_id": 43958713, "question_id": 43957893, "link": "https://stackoverflow.com/questions/43957893/how-to-separate-numbers-from-a-slice/43958713#43958713", "title": "How to separate numbers from a slice?", "body": "<p>For example, with n = 3,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    list := []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n    for a, n := list, 3; len(a) &gt;= n; a = a[n:] {\n        slice := a[:n]\n        fmt.Println(slice)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>[1 2 3]\n[4 5 6]\n[7 8 9]\n</code></pre>\n"}], "owner": {"reputation": 212, "user_id": 4584097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-6K_pX8tNuPo/AAAAAAAAAAI/AAAAAAAAAc4/0XJflOsKhVI/photo.jpg?sz=128", "display_name": "Marcus Pereira", "link": "https://stackoverflow.com/users/4584097/marcus-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 1, "accepted_answer_id": 43958713, "answer_count": 2, "score": -2, "last_activity_date": 1494727139, "creation_date": 1494708870, "question_id": 43957893, "link": "https://stackoverflow.com/questions/43957893/how-to-separate-numbers-from-a-slice", "title": "How to separate numbers from a slice?", "body": "<p>Let's say I have a list with 10 numbers:\n[1, 2, 3, 4, 5, 6, 7, 8, 9, 10]</p>\n\n<p>I would like my program to slice every 3 numbers, for example:</p>\n\n<pre><code>[1,2,3]\n[4,5,6]\n[7,8,9]\n</code></pre>\n\n<p>How can I do it?\nGrateful</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "edited": false, "score": 2, "creation_date": 1494706652, "post_id": 43957535, "comment_id": 74946141, "body": "From the error is looks you could be comparing <code>[]string</code> to a <code>string</code>. Maybe your conditional is the issue."}, {"owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "edited": false, "score": 2, "creation_date": 1494706986, "post_id": 43957535, "comment_id": 74946218, "body": "I would suggest logging <code>a.TypeI</code>, <code>a.TypeII</code>, and <code>m[&quot;type&quot;][0]</code> to see what types they are."}, {"owner": {"reputation": 13, "user_id": 5183445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e083d6c7570050e88dc94ab052b594?s=128&d=identicon&r=PG&f=1", "display_name": "Mehmet \u015eerefo\u011flu", "link": "https://stackoverflow.com/users/5183445/mehmet-%c5%9eerefo%c4%9flu"}, "reply_to_user": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "edited": false, "score": 0, "creation_date": 1494710706, "post_id": 43957535, "comment_id": 74947142, "body": "two both are string"}, {"owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "edited": false, "score": 0, "creation_date": 1494712985, "post_id": 43957535, "comment_id": 74947761, "body": "Whehe is your BaseData? print those here, if your your <code>a.TypeI</code> is <code>[]string</code>, you cannot compare it with <code>string</code>. try to get your desired index first and then compare it."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1494719555, "post_id": 43957535, "comment_id": 74949093, "body": "@Mehmet\u015eerefo\u011flu: &quot;two both are string&quot; No. they are not: <code>invalid operation: a.TypeI == m[&quot;type&quot;][0] (mismatched types []string and string)</code>. They are <code>[]string</code> and <code>string</code>."}, {"owner": {"reputation": 13, "user_id": 5183445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e083d6c7570050e88dc94ab052b594?s=128&d=identicon&r=PG&f=1", "display_name": "Mehmet \u015eerefo\u011flu", "link": "https://stackoverflow.com/users/5183445/mehmet-%c5%9eerefo%c4%9flu"}, "edited": false, "score": 0, "creation_date": 1494755310, "post_id": 43957535, "comment_id": 74955365, "body": "i fix my variable like that  <code>for _, a := range basedata.Pokemons {  \t\tif a.TypeI[0] == m[&quot;type&quot;][0] { \t\t\tfmt.Fprintln(w, &quot;dosomething&quot;) \t\t} \t}</code> \t&#39;  but i catching a panic like that. i am still didnt find my mistake"}], "answers": [{"tags": [], "owner": {"reputation": 2157, "user_id": 602272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3cad999bf79f0232f5d60dee3b7bf2a?s=128&d=identicon&r=PG", "display_name": "Jesse Brands", "link": "https://stackoverflow.com/users/602272/jesse-brands"}, "is_accepted": true, "score": 0, "last_activity_date": 1494790387, "last_edit_date": 1494790387, "creation_date": 1494790077, "answer_id": 43967999, "question_id": 43957535, "link": "https://stackoverflow.com/questions/43957535/golang-mismatched-types-string-and-string/43967999#43967999", "title": "GoLang mismatched types []string and string", "body": "<p>Looking at the Go docs for the <code>url</code> package, you want <a href=\"https://golang.org/pkg/net/url/#Values\" rel=\"nofollow noreferrer\"><code>Values.Get</code></a>:</p>\n\n<pre><code>if a.TypeI == m.Get(\"type\") || a.TypeII == m.Get(\"type\") {\n    // do something\n}\n</code></pre>\n\n<p>Furthermore, can you print the value of <code>r.URL.String()</code> for me like this:</p>\n\n<pre><code>fmt.Println(r.URL.String())\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 5183445, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e083d6c7570050e88dc94ab052b594?s=128&d=identicon&r=PG&f=1", "display_name": "Mehmet \u015eerefo\u011flu", "link": "https://stackoverflow.com/users/5183445/mehmet-%c5%9eerefo%c4%9flu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2996, "favorite_count": 0, "accepted_answer_id": 43967999, "answer_count": 1, "score": -3, "last_activity_date": 1494790387, "creation_date": 1494706133, "last_edit_date": 1494710986, "question_id": 43957535, "link": "https://stackoverflow.com/questions/43957535/golang-mismatched-types-string-and-string", "title": "GoLang mismatched types []string and string", "body": "<p>i am trying to write http api on GoLang. When i am comparing 2 string, i am taking this error \"invalid operation: a.TypeI ==  m[\"type\"][0] (mismatched types []string and string)\". How can i fix, can anyone help ?</p>\n\n<pre><code>func listHandler(w http.ResponseWriter, r *http.Request) {\n    u, errUrl := url.Parse(r.URL.String())\n    check(errUrl)\n\n    m, _ := url.ParseQuery(u.RawQuery)\n    dat, err := ioutil.ReadFile(\"data.json\")\n    check(err)\n\n    var basedata BaseData\n    err2 := json.Unmarshal(dat, &amp;basedata)\n    check(err2)\n\n    for _, a := range basedata.Pokemons {\n\n        if a.TypeI == m[\"type\"][0] || a.TypeII == m[\"type\"][0] {\n            fmt.Fprintln(w, \"dosomething\")\n        }\n\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "edited": false, "score": 0, "creation_date": 1494706504, "post_id": 43957516, "comment_id": 74946102, "body": "Have you tried using <code>?</code> instead of <code>$X</code>?"}, {"owner": {"reputation": 3168, "user_id": 1753891, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YEOWR.png?s=128&g=1", "display_name": "duffn", "link": "https://stackoverflow.com/users/1753891/duffn"}, "reply_to_user": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "edited": false, "score": 0, "creation_date": 1494711869, "post_id": 43957516, "comment_id": 74947464, "body": "The placeholder for PostgreSQL is $X, but yes, I&#39;ve even tried ?."}, {"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1494713404, "post_id": 43957516, "comment_id": 74947882, "body": "have you tried only with double quotes <b>&quot;</b> <b>&quot;</b> ?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1494721867, "post_id": 43957516, "comment_id": 74949488, "body": "<code>COPY</code> does not support query parameters, so you need to format the query manually before passing it to <code>Exec</code>."}, {"owner": {"reputation": 462, "user_id": 6602159, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/phhUH.jpg?s=128&g=1", "display_name": "M. Rostami", "link": "https://stackoverflow.com/users/6602159/m-rostami"}, "edited": false, "score": 0, "creation_date": 1586377283, "post_id": 43957516, "comment_id": 108110058, "body": "I had the same problem with <code>(&quot;select * from table where name=?&quot;, name)</code>, <code>(&quot;select * from table where name=&#39;?&#39;&quot;, name)</code>, <code>(&quot;select * from table where name=&#39;$&#39;&quot;, name)</code>, <code>(&quot;select * from table where name=&#39;$1&#39;&quot;, name)</code> but it has solved by =&gt; <code>(&quot;select * from person where name=$1&quot;, name)</code>."}], "owner": {"reputation": 3168, "user_id": 1753891, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/YEOWR.png?s=128&g=1", "display_name": "duffn", "link": "https://stackoverflow.com/users/1753891/duffn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 911, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1494711732, "creation_date": 1494705975, "last_edit_date": 1494711732, "question_id": 43957516, "link": "https://stackoverflow.com/questions/43957516/golang-sql-tx-exec-with-single-quotes-statement-requires-0-parameters", "title": "golang sql.Tx Exec with single quotes - statement requires 0 parameters", "body": "<p>I am using pq and I have a function like this:</p>\n\n<pre><code>func UpdateTable(tx *sql.Tx) error {\n    _, err := tx.Exec(`\n    copy public.mytable FROM\n    's3://mybucket/mytable' credentials\n    'aws_access_key_id=$1;aws_secret_access_key=$2' DELIMITER AS '|'\n    GZIP ESCAPE;`,\n        os.Getenv(\"AWS_ACCESS_KEY_ID\"),\n        os.Getenv(\"AWS_SECRET_ACCESS_KEY\"))\n\n    if err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>When attempting to run the function, I receive the error </p>\n\n<pre><code>pq: got 2 parameters but the statement requires 0\n</code></pre>\n\n<p>Is this due to the raw string and single quotes in the SQL statement? Can I make this work with the string literal?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 191, "user_id": 3309666, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d5b1cc37c01f5dd164cbc75cf26ae49?s=128&d=identicon&r=PG", "display_name": "iamareebjamal", "link": "https://stackoverflow.com/users/3309666/iamareebjamal"}, "is_accepted": false, "score": 2, "last_activity_date": 1494682291, "last_edit_date": 1494682291, "creation_date": 1494680819, "answer_id": 43953498, "question_id": 43953459, "link": "https://stackoverflow.com/questions/43953459/equivalent-of-python-time-time-started-in-golang/43953498#43953498", "title": "Equivalent of python time.time()-started in golang", "body": "<pre><code>import (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    started := time.Now()\n    doProcess()\n    fmt.Println(time.Now().Sub(started).Seconds())\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2241, "user_id": 6284825, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z7dY9qEIYqY/AAAAAAAAAAI/AAAAAAAAABE/DUXNdvdCo9I/photo.jpg?sz=128", "display_name": "Abhilekh Singh", "link": "https://stackoverflow.com/users/6284825/abhilekh-singh"}, "is_accepted": false, "score": 2, "last_activity_date": 1494680968, "creation_date": 1494680968, "answer_id": 43953520, "question_id": 43953459, "link": "https://stackoverflow.com/questions/43953459/equivalent-of-python-time-time-started-in-golang/43953520#43953520", "title": "Equivalent of python time.time()-started in golang", "body": "<pre><code>import (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    begin := time.Now()\n    time.Sleep(10 * time.Millisecond)\n    end := time.Now()\n\n    duration := end.Sub(begin)\n\n    fmt.Println(duration)\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1494682519, "creation_date": 1494682519, "answer_id": 43953769, "question_id": 43953459, "link": "https://stackoverflow.com/questions/43953459/equivalent-of-python-time-time-started-in-golang/43953769#43953769", "title": "Equivalent of python time.time()-started in golang", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">Package time</a></p>\n  \n  <p><a href=\"https://golang.org/pkg/time/#Since\" rel=\"nofollow noreferrer\">func Since</a></p>\n\n<pre><code>func Since(t Time) Duration\n</code></pre>\n  \n  <p>Since returns the time elapsed since t. It is shorthand for\n  time.Now().Sub(t).</p>\n</blockquote>\n\n<p>Your Python example in Go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    started := time.Now()\n    time.Sleep(1 * time.Second)\n    fmt.Println(time.Since(started))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1s\n</code></pre>\n"}], "owner": {"reputation": 415, "user_id": 5319281, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/22148896d125fa2c7357852622e2911d?s=128&d=identicon&r=PG&f=1", "display_name": "AppTest", "link": "https://stackoverflow.com/users/5319281/apptest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 613, "favorite_count": 1, "accepted_answer_id": 43953769, "answer_count": 3, "score": 0, "last_activity_date": 1494682519, "creation_date": 1494680510, "last_edit_date": 1494681294, "question_id": 43953459, "link": "https://stackoverflow.com/questions/43953459/equivalent-of-python-time-time-started-in-golang", "title": "Equivalent of python time.time()-started in golang", "body": "<p>In python I can see how many seconds have elapsed during a specific process like,</p>\n\n<pre><code>started = time.time()\ndoProcess()\nprint(time.time()-started)\n</code></pre>\n\n<p>Whats the equivelent in golang?</p>\n"}, {"tags": ["go", "methods", "specifications"], "comments": [{"owner": {"reputation": 544, "user_id": 1365918, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/e4EoH.jpg?s=128&g=1", "display_name": "kapad", "link": "https://stackoverflow.com/users/1365918/kapad"}, "edited": false, "score": 0, "creation_date": 1598443951, "post_id": 43953187, "comment_id": 112459920, "body": "What exactly does <code>addressable</code> mean? Does it simply mean that the value is NOT <code>nil</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "edited": false, "score": 0, "creation_date": 1494737033, "post_id": 43953536, "comment_id": 74951616, "body": "That&#39;s not what I asked in my third question. I asked if you can give an example of <code>x.m()</code> where <code>x</code> is not addressable. In my code, <code>p</code> is addressable regardless of whether <code>p.FakeScale()</code> is called or <code>p.RealScale()</code> is called."}], "tags": [], "owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "is_accepted": false, "score": -2, "last_activity_date": 1494681061, "creation_date": 1494681061, "answer_id": 43953536, "question_id": 43953187, "link": "https://stackoverflow.com/questions/43953187/go-method-call-shorthand-spec-applicability/43953536#43953536", "title": "Go method call shorthand spec applicability", "body": "<p>Hm. Also I begin to doubt my knowledge of English language but I will try to answer.</p>\n\n<p>You quoted 2 sentences from specification.</p>\n\n<ol>\n<li>Describes conditions for method to be valid.</li>\n<li>Describes shorthand for recievers of pointer types.</li>\n</ol>\n\n<p>Back to your question:</p>\n\n<p>You defined 2 methods for <strong>2 types</strong>: first - reciever of Point and second - receiver of pointer to Point.</p>\n\n<p>Obviously, shorthand definition for pointer types is not applicable for non-pointer types.</p>\n\n<p>So, you're correct in your questions 1 or 2. </p>\n\n<p>And your third question is in fact question 1: FakeScale is valid method but  method with non-pointer type in receiver, so shorthand definition is not applicable.</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1494697846, "last_edit_date": 1495541874, "creation_date": 1494685865, "answer_id": 43954313, "question_id": 43953187, "link": "https://stackoverflow.com/questions/43953187/go-method-call-shorthand-spec-applicability/43954313#43954313", "title": "Go method call shorthand spec applicability", "body": "<p>Unfortunately, language lawyers have to read the entire specification to put a single sentence in context: <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a>.</p>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">Method sets</a></p>\n  \n  <p>A type may have a method set associated with it. The method set of an\n  interface type is its interface. The method set of any other type T\n  consists of all methods declared with receiver type T. The method set\n  of the corresponding pointer type *T is the set of all methods\n  declared with receiver *T or T (that is, it also contains the method\n  set of T). Further rules apply to structs containing anonymous fields,\n  as described in the section on struct types. Any other type has an\n  empty method set. In a method set, each method must have a unique\n  non-blank method name.</p>\n  \n  <p>The method set of a type determines the interfaces that the type\n  implements and the methods that can be called using a receiver of that\n  type.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">Calls</a></p>\n  \n  <p>A method call x.m() is valid if the method set of (the type of) x\n  contains m and the argument list can be assigned to the parameter list\n  of m. If x is addressable and &amp;x's method set contains m, x.m() is\n  shorthand for (&amp;x).m().</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">Address operators</a></p>\n  \n  <p>For an operand x of type T, the address operation &amp;x generates a\n  pointer of type *T to x. The operand must be addressable, that is,\n  either a variable, pointer indirection, or slice indexing operation;\n  or a field selector of an addressable struct operand; or an array\n  indexing operation of an addressable array. As an exception to the\n  addressability requirement, x may also be a (possibly parenthesized)\n  composite literal.</p>\n</blockquote>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Point struct {\n    x int\n    y int\n}\n\nfunc (p Point) FakeScale(s int) {\n    p.x *= s\n    p.y *= s\n}\n\nfunc (p *Point) RealScale(s int) {\n    p.x *= s\n    p.y *= s\n}\n\nfunc main() {\n    p := Point{2, 3}\n\n    p.FakeScale(10)\n    fmt.Println(p)\n\n    p.RealScale(10)\n    fmt.Println(p)\n}\n</code></pre>\n\n<p>The method set of type Point consists of all methods declared with receiver type Point (FakeScale).</p>\n\n<p>A method call p.FakeScale is valid since the method set of (the type of) p (Point) contains FakeScale and the argument list, (10), can be assigned to the parameter list, (int), of FakeScale. </p>\n\n<p>The method set of type *Point consists of all methods declared with receiver type *Point (RealScale).</p>\n\n<p>Since p is addressable (p is a variable) and &amp;p's method set contains RealScale, p.RealScale() is shorthand for (&amp;p).RealScale().</p>\n\n<hr>\n\n<p>Also, see my answer to your earlier question: <a href=\"https://stackoverflow.com/q/43883502/221700\">How to invoke a method with pointer receiver after type assertion?</a>.</p>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 400, "favorite_count": 2, "answer_count": 2, "score": 1, "last_activity_date": 1494751537, "creation_date": 1494678660, "question_id": 43953187, "link": "https://stackoverflow.com/questions/43953187/go-method-call-shorthand-spec-applicability", "title": "Go method call shorthand spec applicability", "body": "<p>From the <em>Calls</em> section of Go spec: <a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Calls</a></p>\n\n<blockquote>\n  <p>A method call <code>x.m()</code> is valid if the method set of (the type of) <code>x</code> contains <code>m</code> and the argument list can be assigned to the parameter list of <code>m</code>. If <code>x</code> is addressable and <code>&amp;x</code>'s method set contains <code>m</code>, <code>x.m()</code> is shorthand for <code>(&amp;x).m()</code></p>\n</blockquote>\n\n<p>My program.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    p := Point{2, 3}\n\n    p.FakeScale(10)\n    fmt.Println(p)\n\n    p.RealScale(10)\n    fmt.Println(p)\n}\n\ntype Point struct {\n    x int\n    y int\n}\n\nfunc (p Point) FakeScale(s int) {\n    p.x *= s\n    p.y *= s\n}\n\nfunc (p *Point) RealScale(s int) {\n    p.x *= s\n    p.y *= s\n}\n</code></pre>\n\n<p>Here is the output.</p>\n\n<pre><code>{2, 3}\n{20, 30}\n</code></pre>\n\n<p>My question is specifically about this part of the spec.</p>\n\n<blockquote>\n  <p>If <code>x</code> is addressable and <code>&amp;x</code>'s method set contains <code>m</code>, <code>x.m()</code> is shorthand for <code>(&amp;x).m()</code></p>\n</blockquote>\n\n<p>My questions.</p>\n\n<ol>\n<li>Is the quoted part applicable to <code>p.FakeScale(10)</code>? My guess is \"No\" because although <code>p</code> is addressable, <code>&amp;p</code>'s method set does not contain <code>FakeScale</code>. <code>p</code>'s method set contains <code>FakeScale</code> because it uses value receiver, but <code>p</code>'s method set does not contain <code>FakeScale</code>, therefore this part of the spec is not applicable to <code>p.FakeScale(10)</code>. Am I correct?</li>\n<li>Is the quoted part applicable to <code>p.RealScale(10)</code>? My guess is \"Yes\" because <code>p</code> is addressable and <code>&amp;p</code>'s method set contains <code>RealScale</code> by virtue of it using a pointer receiver. Therefore, this part of the spec is applicable to <code>p.RealScale(10)</code>. Am I correct?</li>\n<li>Can you provide an example code where <code>x.m()</code> is valid but <code>x</code> is not addressable, and thus this part of the spec is not applicable?</li>\n</ol>\n"}, {"tags": ["jquery", "go", "parsley.js"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1494683697, "last_edit_date": 1494683697, "creation_date": 1494683290, "answer_id": 43953900, "question_id": 43952423, "link": "https://stackoverflow.com/questions/43952423/input-value-not-live-on-parsley-js-addasyncvalidator-method-param/43953900#43953900", "title": "input value not live on parsley.js addAsyncValidator method param", "body": "<p>The reason the email is always the same as what's in the input when your app is first loaded is because that's the value that you are passing in the <code>options</code> object as the last argument to <code>addAsyncValidator</code>.</p>\n\n<p>That means that this code</p>\n\n<pre><code>{\n    \"data\": {\n        \"email\": $(\"#email\").val(),\n        \"id\": \"{{.User.ObjectID.Hex}}\"\n    }\n}\n</code></pre>\n\n<p>Is evaluated to this</p>\n\n<pre><code>{\n    \"data\": {\n        \"email\": \"foo@bar.com\",\n        \"id\": \"some hex value\"\n    }\n}\n</code></pre>\n\n<p>...and then passed to the <code>addAsyncValidator</code> as the last argument.</p>\n\n<p>To put in another way, <code>$(\"#email\").val()</code> is evaluated only once and that's at the time when your js app starts, it is not evaluated every time the validator makes the xhr request.</p>\n\n<hr>\n\n<p>Now as to how to do what you want, please note that I'm not a user of Parsley.js so I may be mistaken here, but from looking at the documentation it seems to me that: </p>\n\n<p>The email's value that you want is already being sent automatically but because you're passing the options object with the same <code>email</code> key you're effectively overwriting the value you want with the value you don't want.</p>\n\n<p>The docs on <code>data-parsley-remote</code> say (emphasis mine):</p>\n\n<blockquote>\n  <p>Define the url that will be called to validate the entered content.\n  e.g. data-parsley-remote=\"http://url.ext\". If the url contains the\n  string \"{value}\", the value will replace it in the URL (typical of\n  RESTful APIs), otherwise <strong>the value will be passed as a data parameter,\n  with the key being the input's name or ID</strong>.</p>\n</blockquote>\n\n<p>So if I understand the docs correctly it should be enough to do this:</p>\n\n<pre><code>$(function () {\n    $(\"#my_form\").parsley();\n\n    $(\"#my_form\").on(\"submit\", function (e) {\n        e.preventDefault();\n        makeFormRequest(this); // Ajax call\n    });\n\n    Parsley.addAsyncValidator(\"checkEmailTaken\", function (xhr) {\n        if (404 === xhr.status) {\n            r = $.parseJSON(xhr.responseText);\n            this.addError(\"remote\", { message: r.error });\n        }\n        return 200 === xhr.status;\n    }, \"/check/email/taken\", {\n        \"data\": {\n            \"id\": \"{{.User.ObjectID.Hex}}\"\n        }\n    });\n});\n</code></pre>\n"}], "owner": {"reputation": 121, "user_id": 4568542, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/fjLXj.jpg?s=128&g=1", "display_name": "emurmotol", "link": "https://stackoverflow.com/users/4568542/emurmotol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 798, "favorite_count": 0, "accepted_answer_id": 43953900, "answer_count": 1, "score": 0, "last_activity_date": 1494683697, "creation_date": 1494673816, "last_edit_date": 1494677295, "question_id": 43952423, "link": "https://stackoverflow.com/questions/43952423/input-value-not-live-on-parsley-js-addasyncvalidator-method-param", "title": "input value not live on parsley.js addAsyncValidator method param", "body": "<p>I'm having a hard time getting the value (live) of an input and pass it on addAsyncValidator method as a data. The addAsyncValidator always gets the value that has been set on the value attribute of an input when the page is rendered instead of the value of the input when it is changed. Here's my code:</p>\n\n<p><strong>Markup</strong></p>\n\n<pre><code>        &lt;form action=\"/edit/email\" method=\"POST\" id=\"my_form\"&gt;\n            &lt;div class=\"row\"&gt;\n                &lt;div class=\"col-lg-4\"&gt;\n                    &lt;div class=\"form-group\"&gt;\n                        &lt;label for=\"email\"&gt;Email&lt;/label&gt;\n                        &lt;input type=\"text\"\n                               class=\"form-control\"\n                               name=\"email\"\n                               id=\"email\"\n                               {{/* value=\"{{.User.Email}}\" */}}\n                               value=\"foo@bar.com\"\n                               data-parsley-required=\"true\"\n                               data-parsley-type=\"email\"\n                               data-parsley-whitespace=\"trim\"\n                               data-parsley-trigger=\"change\"\n                               data-parsley-remote\n                               data-parsley-remote-validator=\"checkEmailTaken\"\n                               data-parsley-remote-message=\"\"&gt;\n                    &lt;/div&gt;\n                &lt;/div&gt;\n            &lt;/div&gt;\n            &lt;button role=\"button\" type=\"submit\" class=\"btn btn-primary\"&gt;Submit&lt;/button&gt;\n        &lt;/form&gt;\n</code></pre>\n\n<p><strong>JQuery</strong></p>\n\n<pre><code>    $(function () {\n        $(\"#my_form\").parsley();\n\n        $(\"#my_form\").on(\"submit\", function (e) {\n            e.preventDefault();\n            makeFormRequest(this); // Ajax call\n        });\n\n        Parsley.addAsyncValidator(\"checkEmailTaken\", function (xhr) {\n            if (404 === xhr.status) {\n                r = $.parseJSON(xhr.responseText);\n                this.addError(\"remote\", { message: r.error });\n            }\n            return 200 === xhr.status;\n        }, \"/check/email/taken\", {\n                \"data\": {\n                    \"email\": $(\"#email\").val(), // The problem here is the val is always \"foo@bar.com\" even when input value is changed by the user\n                    \"id\": \"{{.User.ObjectID.Hex}}\"\n                }\n            });\n    });\n</code></pre>\n"}, {"tags": ["mongodb", "ssl", "go", "ssl-certificate"], "comments": [{"owner": {"reputation": 3158, "user_id": 7925197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M21lU.png?s=128&g=1", "display_name": "papey", "link": "https://stackoverflow.com/users/7925197/papey"}, "edited": false, "score": 0, "creation_date": 1494655481, "post_id": 43949263, "comment_id": 74931778, "body": "Can you add some code please ?"}], "answers": [{"tags": [], "owner": {"reputation": 2303, "user_id": 109274, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a59b0daee5e5570e07a9f976721017e7?s=128&d=identicon&r=PG", "display_name": "mikezter", "link": "https://stackoverflow.com/users/109274/mikezter"}, "is_accepted": true, "score": 1, "last_activity_date": 1494679840, "last_edit_date": 1494679840, "creation_date": 1494673160, "answer_id": 43952320, "question_id": 43949263, "link": "https://stackoverflow.com/questions/43949263/golang-client-fails-to-connect-to-mongo-db-server-sslv3-alert-bad-certificate/43952320#43952320", "title": "golang client fails to connect to mongo db server - sslv3 alert bad certificate", "body": "<p>You can skip TLS security checks using <code>InsecureSkipVerify = true</code>. This allows you to use self-signed certificates. See the code from <a href=\"https://help.compose.com/docs/connecting-to-mongodb#go--golang-mongodb-and-compose\" rel=\"nofollow noreferrer\" title=\"compose help\">compose help</a> below. </p>\n\n<p>Instead of skipping security checks, it is advisable to add the CA used to sign your certificates to the list of trusted CAs of the system.</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/tls\"\n    \"fmt\"\n    \"net\"\n    \"os\"\n    \"strings\"\n\n    \"gopkg.in/mgo.v2\"\n)\n\nfunc main() {\n    uri := os.Getenv(\"MONGODB_URL\")\n    if uri == \"\" {\n        fmt.Println(\"No connection string provided - set MONGODB_URL\")\n        os.Exit(1)\n    }\n    uri = strings.TrimSuffix(uri, \"?ssl=true\")\n</code></pre>\n\n<p>Here:</p>\n\n<pre><code>    tlsConfig := &amp;tls.Config{}\n    tlsConfig.InsecureSkipVerify = true\n\n    dialInfo, err := mgo.ParseURL(uri)\n\n    if err != nil {\n        fmt.Println(\"Failed to parse URI: \", err)\n        os.Exit(1)\n    }\n</code></pre>\n\n<p>And here: </p>\n\n<pre><code>    dialInfo.DialServer = func(addr *mgo.ServerAddr) (net.Conn, error) {\n        conn, err := tls.Dial(\"tcp\", addr.String(), tlsConfig)\n        return conn, err\n    }\n\n    session, err := mgo.DialWithInfo(dialInfo)\n    if err != nil {\n        fmt.Println(\"Failed to connect: \", err)\n        os.Exit(1)\n    }\n\n    defer session.Close()\n\n    dbnames, err := session.DB(\"\").CollectionNames()\n    if err != nil {\n        fmt.Println(\"Couldn't query for collections names: \", err)\n        os.Exit(1)\n    }\n\n    fmt.Println(dbnames)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 794, "user_id": 2665391, "user_type": "registered", "accept_rate": 33, "profile_image": "https://graph.facebook.com/1468977014/picture?type=large", "display_name": "Amal Ts", "link": "https://stackoverflow.com/users/2665391/amal-ts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 997, "favorite_count": 0, "accepted_answer_id": 43952320, "answer_count": 1, "score": 0, "last_activity_date": 1494679840, "creation_date": 1494650662, "question_id": 43949263, "link": "https://stackoverflow.com/questions/43949263/golang-client-fails-to-connect-to-mongo-db-server-sslv3-alert-bad-certificate", "title": "golang client fails to connect to mongo db server - sslv3 alert bad certificate", "body": "<p>I'm trying to connect a go client to mongodb server running with ssl enabled. I get a clear error message indicating that the hand shake failed due to ssl error. I use a self signed certificate on the client side.</p>\n\n<p>Got below from the mongodb server:</p>\n\n<pre><code>2017-05-13T04:38:53.910+0000 I NETWORK  [thread1] connection accepted from 172.17.0.1:51944 #10 (1 connection now open)\n2017-05-13T04:38:53.911+0000 E NETWORK  [conn10] SSL: error:14094412:SSL routines:SSL3_READ_BYTES:sslv3 alert bad certificate\n2017-05-13T04:38:53.911+0000 I -        [conn10] end connection \n</code></pre>\n\n<p>Error from Go client:</p>\n\n<pre><code>Could not connect to mongodb_s1.dev:27017 x509: certificate signed by unknown authority (possibly because of \"crypto/rsa: verification error\" while trying to verify candidate authority certificate \"XYZ\")\n</code></pre>\n\n<p>Tried multiple options, but didn't help</p>\n"}, {"tags": ["go", "reflection"], "answers": [{"tags": [], "owner": {"reputation": 109227, "user_id": 641955, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Hg2nO.jpg?s=128&g=1", "display_name": "janos", "link": "https://stackoverflow.com/users/641955/janos"}, "is_accepted": true, "score": 9, "last_activity_date": 1494633657, "creation_date": 1494633657, "answer_id": 43947934, "question_id": 43947891, "link": "https://stackoverflow.com/questions/43947891/go-how-do-you-change-the-value-of-a-pointer-parameter/43947934#43947934", "title": "Go - How do you change the value of a pointer parameter?", "body": "<p>Not sure if this is what you were looking for,\nbut yes you can change a pointer's value to something else.\nThe <a href=\"https://play.golang.org/p/mRjTWWkI-O\" rel=\"noreferrer\">code below</a> will print 2 and 3:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    i := 1\n\n    testAsAny(&amp;i)\n    fmt.Println(i)\n\n    testAsInt(&amp;i)\n    fmt.Println(i)\n}\n\nfunc testAsAny(ptr interface{}) {\n    *ptr.(*int) = 2\n}\n\nfunc testAsInt(i *int) {\n    *i = 3\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 12786, "user_id": 499125, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1e0971e368bdad6e495b2eafcdeb7796?s=128&d=identicon&r=PG", "display_name": "Some Noob Student", "link": "https://stackoverflow.com/users/499125/some-noob-student"}, "edited": false, "score": 0, "creation_date": 1494643513, "post_id": 43948518, "comment_id": 74930085, "body": "This also works! Turns out I should read The Laws of Reflection."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1494640946, "creation_date": 1494640946, "answer_id": 43948518, "question_id": 43947891, "link": "https://stackoverflow.com/questions/43947891/go-how-do-you-change-the-value-of-a-pointer-parameter/43948518#43948518", "title": "Go - How do you change the value of a pointer parameter?", "body": "<p>Here's now to set the value using the reflect package. The key point is to set the pointer's element, not the pointer itself.</p>\n\n<pre><code>func test(ptr interface{}) {\n  v := reflect.ValueOf(ptr).Elem()\n  v.SetInt(2)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/wKeT2QtaIm\" rel=\"nofollow noreferrer\">playground example</a></p>\n\n<p>Note that the reflect package is not needed for this specific example as shown in another answer.</p>\n"}], "owner": {"reputation": 12786, "user_id": 499125, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/1e0971e368bdad6e495b2eafcdeb7796?s=128&d=identicon&r=PG", "display_name": "Some Noob Student", "link": "https://stackoverflow.com/users/499125/some-noob-student"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3066, "favorite_count": 1, "accepted_answer_id": 43947934, "answer_count": 2, "score": 4, "last_activity_date": 1494640946, "creation_date": 1494633211, "question_id": 43947891, "link": "https://stackoverflow.com/questions/43947891/go-how-do-you-change-the-value-of-a-pointer-parameter", "title": "Go - How do you change the value of a pointer parameter?", "body": "<p>In Golang, is it possible to change a pointer parameter's value to something else?</p>\n\n<p>For example, </p>\n\n<pre><code>func main() {\n    i := 1\n    test(&amp;i)\n}\n\nfunc test(ptr interface{}) {\n    v := reflect.ValueOf(ptr)\n\n    fmt.Println(v.CanSet()) // false\n    v.SetInt(2) // panic\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/3OwGYrb-W-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3OwGYrb-W-</a></p>\n\n<p>Is it possible to have <code>test()</code> change <code>i</code> to point to another value 2?</p>\n"}, {"tags": ["json", "go", "struct", "idioms"], "answers": [{"tags": [], "owner": {"reputation": 139, "user_id": 8005010, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tqnKW.png?s=128&g=1", "display_name": "Bazgrim", "link": "https://stackoverflow.com/users/8005010/bazgrim"}, "is_accepted": false, "score": 0, "last_activity_date": 1494632054, "creation_date": 1494632054, "answer_id": 43947766, "question_id": 43947733, "link": "https://stackoverflow.com/questions/43947733/single-struct-or-multiple-for-nested-json/43947766#43947766", "title": "Single struct or multiple for nested JSON?", "body": "<p>I prefer single structs, just seems cleaner to me, but someone with more network experience might be able to chime in as what is the industry norm.</p>\n"}, {"tags": [], "owner": {"reputation": 737, "user_id": 6275844, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7f9f7071f7e0149f02e945420a120a3f?s=128&d=identicon&r=PG&f=1", "display_name": "Dan 0", "link": "https://stackoverflow.com/users/6275844/dan-0"}, "is_accepted": false, "score": 0, "last_activity_date": 1494636331, "creation_date": 1494636331, "answer_id": 43948167, "question_id": 43947733, "link": "https://stackoverflow.com/questions/43947733/single-struct-or-multiple-for-nested-json/43948167#43948167", "title": "Single struct or multiple for nested JSON?", "body": "<p>This can be really subjective, but it depends on how you're going to use the data and if/how your JSON data may change over time.</p>\n\n<p>If you have a strong belief that your JSON structure will not change, the single struct should be fine.</p>\n\n<p>If you believe that your JSON structure may change over time, especially if you're dealing with large JSON objects that might come from an external source, multiple structs can be more maintainable.</p>\n\n<p>I personally don't like the single struct for a general use case, I almost always find that it gets harder to maintain over time. When I have multiple versions of the JSON struct with varying forms of data, I find it much easier to use anonymous fields.</p>\n"}, {"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 1, "last_activity_date": 1494641010, "creation_date": 1494641010, "answer_id": 43948521, "question_id": 43947733, "link": "https://stackoverflow.com/questions/43947733/single-struct-or-multiple-for-nested-json/43948521#43948521", "title": "Single struct or multiple for nested JSON?", "body": "<p>There is no \"better\" way, both are valid and might be useful depending on your use case.</p>\n\n<p><strong>Single structs</strong></p>\n\n<ul>\n<li>Allow you to see the whole definition in one single place, which might be more clear at times</li>\n<li>Result in more concise definition code</li>\n</ul>\n\n<p><strong>Multiple structs</strong></p>\n\n<ul>\n<li>Allow you to separate \"structure\" (the base struct) from objects (the sub-structs)</li>\n<li>Might make it simpler to change sub-structs</li>\n<li>Allow you to re-use some of the sub-structs if needed</li>\n</ul>\n\n<p>I think that last point (multiple structs allowing you to re-use the sub-structs) is the key difference here, so if your sub-structs might be useful separately you would be better served by multiple structs.</p>\n"}, {"tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 0, "last_activity_date": 1494686365, "last_edit_date": 1495535473, "creation_date": 1494644157, "answer_id": 43948762, "question_id": 43947733, "link": "https://stackoverflow.com/questions/43947733/single-struct-or-multiple-for-nested-json/43948762#43948762", "title": "Single struct or multiple for nested JSON?", "body": "<p>If you want to <strong>test</strong> your JSON then use <strong>multiple structs</strong>.</p>\n\n<p>Otherwise you cannot initialize the struct outside of a function (concisely) for use in <strong>table tests</strong>.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/24809235/initialize-a-nested-struct-in-golang\">Initialize a nested struct in Golang</a> is a question which deals with that...</p>\n\n<p>In any case, there are pluses and minuses to both methods but ultimately <strong>it depends on your use case</strong>:</p>\n\n<p><strong>Multiple Structs</strong></p>\n\n<ul>\n<li>Easier to test</li>\n<li>Modular design can be reused</li>\n</ul>\n\n<p><strong>Nested Anonymous Stucts</strong></p>\n\n<ul>\n<li>Concise </li>\n<li>Everything in one place :)</li>\n</ul>\n\n<p>Effectively, not much of a difference aside from testing. I'd go with multiple explicit structs for that very reason.</p>\n"}], "owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "answer_count": 4, "score": 1, "last_activity_date": 1494686365, "creation_date": 1494631834, "question_id": 43947733, "link": "https://stackoverflow.com/questions/43947733/single-struct-or-multiple-for-nested-json", "title": "Single struct or multiple for nested JSON?", "body": "<p>I often have to work with nested JSON in Go and I'm wondering what's the most correct or idiomatic way to create the struct it's parsed into.</p>\n\n<p><em>Single struct:</em></p>\n\n<pre><code>type myStruct struct {\n    Fields struct {\n        Struct0 struct {\n            Field0 string `json:\"value\"`\n        } `json:\"tag0\"`\n        Struct1 struct {\n            Field0 int `json:\"value\"`\n        } `json:\"tag1\"`\n        Struct2 struct {\n            Field0 int `json:\"value\"`\n        } `json:\"tag2\"`\n    } `json:\"fields\"`\n}\n</code></pre>\n\n<p><em>Multiple structs:</em></p>\n\n<pre><code>type myStruct struct {\n    Fields struct {\n        Struct0 `json:\"tag0\"`\n        Struct1 `json:\"tag1\"`\n        Struct2 `json:\"tag2\"`\n    } `json:\"fields\"`\n}\n\ntype Struct0 struct {\n    Field0 string `json:\"value\"`\n}\n\ntype Struct1 struct {\n    Field0 int `json:\"value\"`\n}\n\ntype Struct2 struct {\n    Field0 int `json:\"value\"`\n}\n</code></pre>\n\n<p>Is one way better than the other?</p>\n"}, {"tags": ["go", "pipe"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1494628934, "post_id": 43947363, "comment_id": 74927584, "body": "Why do you want to block that? Is it actually a <i>problem</i> if someone types the input into their terminal manually, or maybe copy-pastes it or something?"}, {"owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "edited": false, "score": 1, "creation_date": 1494629003, "post_id": 43947363, "comment_id": 74927594, "body": "Maybe you&#39;ve seen this already, but here&#39;s a parallel line of questioning for shell scripts: <a href=\"http://stackoverflow.com/questions/911168/how-to-detect-if-my-shell-script-is-running-through-a-pipe\" title=\"how to detect if my shell script is running through a pipe\">stackoverflow.com/questions/911168/&hellip;</a>"}, {"owner": {"reputation": 211, "user_id": 7734930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/213cca67ab7274dbd681d62b696459d5?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/7734930/florian"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1494630834, "post_id": 43947363, "comment_id": 74928019, "body": "@user2357112 The users input will never end, because there won&#39;t be an EOF, will it?"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1494631040, "post_id": 43947363, "comment_id": 74928062, "body": "@Florian: Ctrl-D, or Ctrl-Z Enter at the beginning of a line on Windows."}], "answers": [{"comments": [{"owner": {"reputation": 211, "user_id": 7734930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/213cca67ab7274dbd681d62b696459d5?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/7734930/florian"}, "edited": false, "score": 1, "creation_date": 1494630189, "post_id": 43947435, "comment_id": 74927887, "body": "Can&#39;t define <code>fi, _ := os.Stdin.Stat()</code> out of a method body, but it works if I use it in the main method. Thanks!"}, {"owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "reply_to_user": {"reputation": 211, "user_id": 7734930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/213cca67ab7274dbd681d62b696459d5?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/7734930/florian"}, "edited": false, "score": 0, "creation_date": 1494630611, "post_id": 43947435, "comment_id": 74927980, "body": "Oops, that was just a typo. Fixed now."}], "tags": [], "owner": {"reputation": 10490, "user_id": 513951, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6cace4406e1ea825e78ec0134a5ea6fd?s=128&d=identicon&r=PG&f=1", "display_name": "user513951", "link": "https://stackoverflow.com/users/513951/user513951"}, "is_accepted": true, "score": 16, "last_activity_date": 1494630602, "last_edit_date": 1494630602, "creation_date": 1494629184, "answer_id": 43947435, "question_id": 43947363, "link": "https://stackoverflow.com/questions/43947363/detect-if-a-command-is-piped-or-not/43947435#43947435", "title": "Detect if a command is piped or not", "body": "<p>You can do this using <code>os.Stdin.Stat()</code>.</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"os\"\n)\n\nfunc main() {\n    fi, _ := os.Stdin.Stat()\n\n    if (fi.Mode() &amp; os.ModeCharDevice) == 0 {\n        fmt.Println(\"data is from pipe\")\n    } else {\n        fmt.Println(\"data is from terminal\")\n    }\n}\n</code></pre>\n\n<p>(Adapted from <a href=\"https://www.socketloop.com/tutorials/golang-check-if-os-stdin-input-data-is-piped-or-from-terminal\" rel=\"noreferrer\">https://www.socketloop.com/tutorials/golang-check-if-os-stdin-input-data-is-piped-or-from-terminal</a>)</p>\n"}], "owner": {"reputation": 211, "user_id": 7734930, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/213cca67ab7274dbd681d62b696459d5?s=128&d=identicon&r=PG&f=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/7734930/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1722, "favorite_count": 5, "accepted_answer_id": 43947435, "answer_count": 1, "score": 13, "last_activity_date": 1494630602, "creation_date": 1494628622, "question_id": 43947363, "link": "https://stackoverflow.com/questions/43947363/detect-if-a-command-is-piped-or-not", "title": "Detect if a command is piped or not", "body": "<p>Is there a way to detect if a command in go is piped or not?</p>\n\n<p>Example:</p>\n\n<pre><code>cat test.txt | mygocommand #Piped, this is how it should be used\nmygocommand # Not piped, this should be blocked\n</code></pre>\n\n<p>I'm reading from the Stdin <code>reader := bufio.NewReader(os.Stdin)</code>.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1242, "user_id": 7061430, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81912bc5ca02376f99a5ee44531dee27?s=128&d=identicon&r=PG", "display_name": "nothingmuch", "link": "https://stackoverflow.com/users/7061430/nothingmuch"}, "is_accepted": true, "score": 4, "last_activity_date": 1494627486, "last_edit_date": 1494627486, "creation_date": 1494627102, "answer_id": 43947140, "question_id": 43947072, "link": "https://stackoverflow.com/questions/43947072/how-do-i-check-the-type-of-an-error/43947140#43947140", "title": "How do I check the type of an error?", "body": "<p>The <a href=\"https://golang.org/pkg/context/#pkg-variables\" rel=\"nofollow noreferrer\">context package exposes this value as a variable</a>.</p>\n\n<p>You can compare <code>err == context.DeadlineExceeded</code>.</p>\n\n<p>However, as <a href=\"https://dave.cheney.net/2016/04/27/dont-just-check-errors-handle-them-gracefully\" rel=\"nofollow noreferrer\">argued by Dave Cheney</a>, you should probably use an interface instead.</p>\n\n<p>Specifically <a href=\"https://golang.org/pkg/net/#Error\" rel=\"nofollow noreferrer\"><code>net.Error</code></a> or <code>interface { Timeout() bool }</code> will work as a type.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 436, "favorite_count": 0, "accepted_answer_id": 43947140, "answer_count": 1, "score": 3, "last_activity_date": 1494627486, "creation_date": 1494626705, "question_id": 43947072, "link": "https://stackoverflow.com/questions/43947072/how-do-i-check-the-type-of-an-error", "title": "How do I check the type of an error?", "body": "<p>I want to check the error type from a function I call to see if it was caused by a deadlineExceededError but I don't see a way to reference it. I suppose I can always check against the <code>.Error()</code> string but I've been told that's frowned upon. </p>\n\n<p>Also it's set to 2 microseconds for debugging purposes, I realize it should be changed to <code>time.Minute</code></p>\n\n<p>Godoc for the function in question: <a href=\"https://godoc.org/github.com/moby/moby/client#Client.ContainerStart\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/moby/moby/client#Client.ContainerStart</a></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>//if the container fails to start after 2 minutes then we should timeout\nctx, cancel := context.WithTimeout(ctx, 2*time.Microsecond)\n\ndefer cancel()\n// Do the actual start\nif err := myClient.ContainerStart(ctx, containerName, types.ContainerStartOptions{}); err != nil {\n    fmt.Printf(\"%v\\n\", err) //prints: 'context deadline exceeded'\n    fmt.Printf(\"%T\\n\", err) //prints: 'context.deadlineExceededError'\n    switch e := err.(type) {\n    case //how do I check for deadlineExceededError:\n         //print that it timed out here\n    }\n    return err\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "edited": false, "score": 0, "creation_date": 1494627210, "post_id": 43947081, "comment_id": 74927152, "body": "I tried this earlier but it still doesn&#39;t seem to work."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1494626744, "creation_date": 1494626744, "answer_id": 43947081, "question_id": 43946993, "link": "https://stackoverflow.com/questions/43946993/mock-context-done-in-unit-test/43947081#43947081", "title": "Mock context.Done() in unit test", "body": "<p>Your <code>mockContext</code> type's <code>Done</code> method will never return done, because nothing ever writes to the channel, so your goroutine sits around forever before it closes the channel, thus triggering the Done state.  If you want it to immediately report done, try this:</p>\n\n<pre><code>func (ctx mockContext) Done() &lt;-chan struct{} {\n    ch := make(chan struct{})\n    close(ch)\n    return ch\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "is_accepted": true, "score": 5, "last_activity_date": 1494686029, "creation_date": 1494686029, "answer_id": 43954344, "question_id": 43946993, "link": "https://stackoverflow.com/questions/43946993/mock-context-done-in-unit-test/43954344#43954344", "title": "Mock context.Done() in unit test", "body": "<p>So, after much trial and error I figured out what I was doing wrong. Instead of trying to create a mock <code>context.Context</code>, I created a new one with an expired deadline and immediately called the returned <code>cancelFunc</code>. I then passed this to <code>req.WithContext()</code> and now it works like a charm!</p>\n\n<pre><code>func TestHandler(t *testing.T) {\n    stream := make(chan data, 1)\n    defer close(stream)\n\n    handler := submitHandler(stream)\n    req, err := http.NewRequest(http.MethodPost, \"/submit\", nil)\n    if err != nil {\n        t.Fatal(err)\n    }\n\n    stream &lt;- data{}\n    ctx, cancel := context.WithDeadline(req.Context(), time.Now().Add(-7*time.Hour))\n    cancel()\n    req = req.WithContext(ctx)\n\n    rec := httptest.NewRecorder()\n    handler.ServeHTTP(rec, req)\n\n    if rec.Code != http.StatusRequestTimeout {\n        t.Errorf(\"expected status code: %d, got: %d\", http.StatusRequestTimeout, rec.Code)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5075, "favorite_count": 1, "accepted_answer_id": 43954344, "answer_count": 2, "score": 5, "last_activity_date": 1495044444, "creation_date": 1494626124, "last_edit_date": 1495044444, "question_id": 43946993, "link": "https://stackoverflow.com/questions/43946993/mock-context-done-in-unit-test", "title": "Mock context.Done() in unit test", "body": "<p>I have a HTTP handler that sets a context deadline on each request:</p>\n\n<pre><code>func submitHandler(stream chan data) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        ctx, cancel := context.WithTimeout(r.Context(), 5*time.Second)\n        defer cancel()\n\n        // read request body, etc.\n\n        select {\n        case stream &lt;- req:\n            w.WriteHeader(http.StatusNoContent)\n        case &lt;-ctx.Done():\n            err := ctx.Err()\n            if err == context.DeadlineExceeded {\n                w.WriteHeader(http.StatusRequestTimeout)\n            }\n            log.Printf(\"context done: %v\", err)\n        }\n    }\n}\n</code></pre>\n\n<p>I am easily able to test the <code>http.StatusNoContent</code> header, but I am unsure about how to test the <code>&lt;-ctx.Done()</code> case in the select statement.</p>\n\n<p>In my test case I have built a mock <code>context.Context</code> and passed it to the <code>req.WithContext()</code> method on my mock <code>http.Request</code>, however, the status code returned is always <code>http.StatusNoContent</code> which leads me to believe the <code>select</code> statement is always falling into the first case in my test.</p>\n\n<pre><code>type mockContext struct{}\n\nfunc (ctx mockContext) Deadline() (deadline time.Time, ok bool) {\n    return deadline, ok\n}\n\nfunc (ctx mockContext) Done() &lt;-chan struct{} {\n    ch := make(chan struct{})\n    close(ch)\n    return ch\n}\n\nfunc (ctx mockContext) Err() error {\n    return context.DeadlineExceeded\n}\n\nfunc (ctx mockContext) Value(key interface{}) interface{} {\n    return nil\n}\n\nfunc TestHandler(t *testing.T) {\n    stream := make(chan data, 1)\n    defer close(stream)\n\n    handler := submitHandler(stream)\n    req, err := http.NewRequest(http.MethodPost, \"/submit\", nil)\n    if err != nil {\n        t.Fatal(err)\n    }\n    req = req.WithContext(mockContext{})\n\n    rec := httptest.NewRecorder()\n    handler.ServeHTTP(rec, req)\n\n    if rec.Code != http.StatusRequestTimeout {\n        t.Errorf(\"expected status code: %d, got: %d\", http.StatusRequestTimeout, rec.Code)\n    }\n}\n</code></pre>\n\n<p>How could I mock the context deadline has exceeded?</p>\n"}, {"tags": ["go", "factory"], "comments": [{"owner": {"reputation": 43, "user_id": 8004952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fTGtyCMA_OU/AAAAAAAAAAI/AAAAAAAAAAs/9mKO5XE51ew/photo.jpg?sz=128", "display_name": "Ryan Krol", "link": "https://stackoverflow.com/users/8004952/ryan-krol"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1494622807, "post_id": 43946267, "comment_id": 74925626, "body": "Literally just worked it out, thanks!"}], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 8004952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fTGtyCMA_OU/AAAAAAAAAAI/AAAAAAAAAAs/9mKO5XE51ew/photo.jpg?sz=128", "display_name": "Ryan Krol", "link": "https://stackoverflow.com/users/8004952/ryan-krol"}, "is_accepted": true, "score": 2, "last_activity_date": 1494622875, "creation_date": 1494622875, "answer_id": 43946404, "question_id": 43946267, "link": "https://stackoverflow.com/questions/43946267/setting-up-a-factory-pattern-in-go/43946404#43946404", "title": "Setting up a Factory Pattern in Go", "body": "<p>The issue was with not using pointers with the car being taken in by the methods:</p>\n\n<p>toyota.go becomes:</p>\n\n<pre><code>package Cars\n\nimport (\n    \"fmt\"\n)\n\ntype toyotaCar struct {\n  carType string\n  colour string\n}\n\nfunc (car *toyotaCar) Initialise(col, carType string){\n\n  car.colour = col\n  car.carType = carType\n\n}\n\nfunc (car *toyotaCar) SayCar(){\n  fmt.Println(car.carType)\n  fmt.Println(car.colour)\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 8004952, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-fTGtyCMA_OU/AAAAAAAAAAI/AAAAAAAAAAs/9mKO5XE51ew/photo.jpg?sz=128", "display_name": "Ryan Krol", "link": "https://stackoverflow.com/users/8004952/ryan-krol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "accepted_answer_id": 43946404, "answer_count": 1, "score": -1, "last_activity_date": 1494622875, "creation_date": 1494622232, "question_id": 43946267, "link": "https://stackoverflow.com/questions/43946267/setting-up-a-factory-pattern-in-go", "title": "Setting up a Factory Pattern in Go", "body": "<p>I have a factory pattern setup at the moment but I'm having trouble getting the returned objects to remember anything when explicitly initialising them.</p>\n\n<p>I have the following files:</p>\n\n<p>carBase.go</p>\n\n<pre><code>package Cars\n\n//base class for car factory\ntype car interface {\n  Initialise(string, string)\n  SayCar()\n}\n</code></pre>\n\n<p>toyota.go</p>\n\n<pre><code>package Cars\n\nimport (\n    \"fmt\"\n)\n\ntype toyotaCar struct {\n  carType string\n  colour string\n}\n\nfunc (car toyotaCar) Initialise(col, carType string){\n\n  car.colour = col\n  car.carType = carType\n\n}\n\nfunc (car toyotaCar) SayCar(){\n  fmt.Println(car.carType)\n  fmt.Println(car.colour)\n}\n</code></pre>\n\n<p>carFactory.go</p>\n\n<pre><code>package Cars\n\nfunc GetCar(carType string) (car) {\n\n  switch carType {\n  case \"toyota\":\n    return new(toyotaCar)\n  }\n\n  return new(toyotaCar)\n\n}\n</code></pre>\n\n<p>and finally main.go</p>\n\n<pre><code>package main\n\nimport (\n  \"FactoryTest/Cars\"\n  \"fmt\"\n)\n\nfunc main() {\n\n  car := Cars.GetCar(\"toyota\")\n  fmt.Println(car)\n  car.Initialise(\"thing\" , \"otherthing\")\n  fmt.Println(car)\n  car.SayCar()\n  fmt.Println(car)\n\n}\n</code></pre>\n\n<p>In each of the <code>fmt.Printn(car)</code> lines, I'm getting <code>&amp;{ }</code> which indicates that nothing is being set. When I run <code>car.SayCar()</code> nothing prints out. </p>\n\n<p>Am I just trying to force the issue here, or is there something simple that I'm missing to make this work?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 435, "user_id": 5967025, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L8xlW.jpg?s=128&g=1", "display_name": "vildhjarta", "link": "https://stackoverflow.com/users/5967025/vildhjarta"}, "edited": false, "score": 1, "creation_date": 1494710643, "post_id": 43945812, "comment_id": 74947125, "body": "Your solution was crystal clear. It was distressed me that not to have built-in one like Python."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 30, "last_activity_date": 1494620066, "creation_date": 1494620066, "answer_id": 43945812, "question_id": 43945675, "link": "https://stackoverflow.com/questions/43945675/division-with-returning-quotient-and-remainder/43945812#43945812", "title": "Division with returning quotient and remainder", "body": "<p>Integer division plus modulus accomplishes this.</p>\n\n<pre><code>func divmod(numerator, denominator int64) (quotient, remainder int64) {\n    quotient = numerator / denominator // integer division, decimals are truncated\n    remainder = numerator % denominator\n    return\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/rimqraYE2B\" rel=\"noreferrer\">https://play.golang.org/p/rimqraYE2B</a></p>\n\n<p>Edit: Definitions</p>\n\n<p><strong>Quotient</strong>, in the context of integer division, is the number of <em>whole</em> times the numerator goes into the denominator.  In other words, it is identical to the decimal statement: <code>FLOOR(n/d)</code></p>\n\n<p><strong>Modulo</strong> gives you the <em>remainder</em> of such a division.  The modulus of a numerator and denominator will always be between 0 and d-1 (where d is the denominator)</p>\n"}, {"tags": [], "owner": {"reputation": 869, "user_id": 5752875, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/5e07eba630b8aa0601d30171f57a667c?s=128&d=identicon&r=PG&f=1", "display_name": "carusyte", "link": "https://stackoverflow.com/users/5752875/carusyte"}, "is_accepted": false, "score": 17, "last_activity_date": 1531277150, "creation_date": 1531277150, "answer_id": 51276511, "question_id": 43945675, "link": "https://stackoverflow.com/questions/43945675/division-with-returning-quotient-and-remainder/51276511#51276511", "title": "Division with returning quotient and remainder", "body": "<p>if you want a one-liner, </p>\n\n<pre><code>quotient, remainder := numerator/denominator, numerator%denominator\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 0, "last_activity_date": 1609783658, "creation_date": 1609783658, "answer_id": 65567628, "question_id": 43945675, "link": "https://stackoverflow.com/questions/43945675/division-with-returning-quotient-and-remainder/65567628#65567628", "title": "Division with returning quotient and remainder", "body": "<p>If you have a 32 bit number, you can do it like this:</p>\n<pre><code>package main\nimport &quot;math/bits&quot;\n\nfunc main() {\n   n := uint(4294967295)\n   // example 1\n   q1, r1 := bits.Div(0, n, 2)\n   // example 2\n   q2, r2 := bits.Div32(0, n, 2)\n   // print\n   println(q1 == n / 2, r1 == 1, q2 == n / 2, r2 == 1)\n}\n</code></pre>\n<p>If you have a 64 bit number, you can do it like this:</p>\n<pre><code>package main\nimport &quot;math/bits&quot;\n\nfunc main() {\n   n := uint64(18446744073709551615)\n   q, r := bits.Div64(0, n, 2)\n   println(q == n / 2, r == 1)\n}\n</code></pre>\n<p>If you have something larger than 64 bit, you can do it like this:</p>\n<pre><code>package main\nimport &quot;math/bits&quot;\n\nfunc main() {\n   q, r := bits.Div64(1, 0, 2)\n   println(q == 9223372036854775808, r == 0)\n}\n</code></pre>\n<ul>\n<li><a href=\"https://golang.org/pkg/math/bits#Div\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/bits#Div</a></li>\n<li><a href=\"https://golang.org/pkg/math/bits#Div32\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/bits#Div32</a></li>\n<li><a href=\"https://golang.org/pkg/math/bits#Div64\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/bits#Div64</a></li>\n</ul>\n"}], "owner": {"reputation": 435, "user_id": 5967025, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/L8xlW.jpg?s=128&g=1", "display_name": "vildhjarta", "link": "https://stackoverflow.com/users/5967025/vildhjarta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26681, "favorite_count": 0, "accepted_answer_id": 43945812, "answer_count": 3, "score": 14, "last_activity_date": 1609783658, "creation_date": 1494619474, "question_id": 43945675, "link": "https://stackoverflow.com/questions/43945675/division-with-returning-quotient-and-remainder", "title": "Division with returning quotient and remainder", "body": "<p>I try to migrate from Python to Golang. I currently do research some math operations and wonder about how can I get both quotient and remainder value with result of a division. I'm going to share below an equivalent of Python code.</p>\n\n<pre><code>hours, remainder = divmod(5566, 3600)\nminutes, seconds = divmod(remainder, 60)\nprint('%s:%s' % (minutes, seconds))\n# 32:46\n</code></pre>\n\n<p>Above will be my aim. Thanks.</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1494855443, "post_id": 43956620, "comment_id": 74990991, "body": "The tutorial code doesn&#39;t include a way for a user to login."}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1494860716, "post_id": 43956620, "comment_id": 74994852, "body": "You&#39;ve already got that part right in your question. Use the <code>LoginURL</code> function from the <code>user</code> package and write it to the index page template. Userscan click that to log in."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1494700213, "creation_date": 1494700213, "answer_id": 43956620, "question_id": 43945213, "link": "https://stackoverflow.com/questions/43945213/is-the-go-appengine-tutorial-missing-loginurl-redirect-statements/43956620#43956620", "title": "Is the Go Appengine tutorial missing LoginURL redirect statements?", "body": "<p>You are correct. To log in a user, you'll have to redirect them to a <code>LoginURL</code> as above. Once a user accesses this URL, app engine will let them log in using their google account.</p>\n\n<p>However, the example code you've linked above does not require a user to be logged in. If a user is logged in, the code gets their ID and uses that as the greeting's author. If not, it just calls the user anonymous, as per the template:</p>\n\n<pre><code>{{with .Author}}\n  &lt;p&gt;&lt;b&gt;{{.}}&lt;/b&gt; wrote:&lt;/p&gt;\n{{else}\n  &lt;p&gt;An anonymous person wrote:&lt;/p&gt;\n{{end}}\n</code></pre>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1494700213, "creation_date": 1494617569, "last_edit_date": 1494634343, "question_id": 43945213, "link": "https://stackoverflow.com/questions/43945213/is-the-go-appengine-tutorial-missing-loginurl-redirect-statements", "title": "Is the Go Appengine tutorial missing LoginURL redirect statements?", "body": "<p>I'm not getting redirected to the Google account sign-in screen when I run the demo code. </p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/go/getting-started/authenticating-users\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/go/getting-started/authenticating-users</a></p>\n\n<p>The tutorial mentions: \"Note that if the user is not signed in, an HTTP status code of 302 Found redirects the browser to the Google account sign-in screen.\"</p>\n\n<pre><code>   func sign(w http.ResponseWriter, r *http.Request) {  \n        // [START new_context]  \n        c := appengine.NewContext(r)  \n        // [END new_context]         \n        g := Greeting{  \n                Content: r.FormValue(\"content\"),  \n                Date:    time.Now(),  \n        }  \n        // [START if_user]  \n        if u := user.Current(c); u != nil {  \n                g.Author = u.String()  \n        }  \n        key := datastore.NewIncompleteKey(c, \"Greeting\", guestbookKey(c))  \n        _, err := datastore.Put(c, key, &amp;g)  \n        if err != nil {  \n                http.Error(w, err.Error(), http.StatusInternalServerError)  \n                return  \n        }\n        http.Redirect(w, r, \"/\", http.StatusFound)\n        // [END if_user]    \n   }\n</code></pre>\n\n<p>Source code:<br>\n<a href=\"https://github.com/GoogleCloudPlatform/appengine-guestbook-go/blob/part4-usingdatastore/hello.go\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/appengine-guestbook-go/blob/part4-usingdatastore/hello.go</a></p>\n\n<p>It seems something is missing e.g.:   </p>\n\n<pre><code>if u == nil {\n                url, _ := user.LoginURL(ctx, \"/\")\n                fmt.Fprintf(w, `&lt;a href=\"%s\"&gt;Sign in or register&lt;/a&gt;`, url)\n                return\n        } \n</code></pre>\n\n<p>If I'm wrong, how does the current code redirect user to the sign-in screen?</p>\n"}, {"tags": ["rest", "cookies", "go"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1494616906, "post_id": 43945042, "comment_id": 74922926, "body": "You can both add cookies to a request, and get cookies from a response. Check out the docs: <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http</a>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1494617071, "post_id": 43945042, "comment_id": 74923006, "body": "@william.taylor.09 you can also add cookies to a response, as indicated in the linked docs, which is what the asker is trying to do."}, {"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "edited": false, "score": 0, "creation_date": 1494618233, "post_id": 43945042, "comment_id": 74923571, "body": "Correct (and without trying to sound sarcastic, I promise I&#39;m not), the user has exactly the information he needs in that link for both functions."}], "answers": [{"tags": [], "owner": {"reputation": 2157, "user_id": 602272, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e3cad999bf79f0232f5d60dee3b7bf2a?s=128&d=identicon&r=PG", "display_name": "Jesse Brands", "link": "https://stackoverflow.com/users/602272/jesse-brands"}, "is_accepted": false, "score": 0, "last_activity_date": 1494627764, "creation_date": 1494627764, "answer_id": 43947242, "question_id": 43945042, "link": "https://stackoverflow.com/questions/43945042/sending-cookie-in-api-rest-golang/43947242#43947242", "title": "sending cookie in API Rest golang", "body": "<p>You can indeed set cookies.</p>\n\n<p>This would feel like it's too short of an answer though. Remember that a REST API is nothing more than a HTTP server with a very strict usage of how it should be called and what it returns. As such, you can safely set cookies.</p>\n\n<p>The question is though, if that is really something you should do, have a look at <a href=\"https://jwt.io/\" rel=\"nofollow noreferrer\">JSON Web Tokens</a> and <a href=\"https://tools.ietf.org/html/rfc7516\" rel=\"nofollow noreferrer\">JSON Web Encryption</a> instead. There are Go libraries available for both. The rationale for using JWE and JWT over cookies is that you usually want a REST API to be as stateless as possible; preferring for the Client to keep state instead.</p>\n\n<p>If you insist on using cookies though, consider using Gorilla's <a href=\"https://github.com/gorilla/securecookie\" rel=\"nofollow noreferrer\">securecookie</a> API instead, as you probably do not want people peeking into your cookie's contents. You can use it as so:</p>\n\n<pre><code>import \"github.com/gorilla/securecookie\"\n\ns := securecoookie.New([]byte(\"very-secret-1234\"), byte[](\"much-hidden-5678\"))\n\nfunc SetCookieHandler(w http.ResponseWriter, r *http.Request) {\n    value := map[string]string{\n        \"foo\": \"bar\",\n    }\n    if encoded, err := s.Encode(\"cookie-name\", value); err == nil {\n        cookie := &amp;http.Cookie{\n            Name:  \"cookie-name\",\n            Value: encoded,\n            Path:  \"/\",\n            Secure: true,\n            HttpOnly: true,\n        }\n        http.SetCookie(w, cookie)\n    }\n}\n</code></pre>\n\n<p>Similarly, you can retrieve the Cookie's contents like this:</p>\n\n<pre><code>func ReadCookieHandler(w http.ResponseWriter, r *http.Request) {\n    if cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n        value := make(map[string]string)\n        if err = s2.Decode(\"cookie-name\", cookie.Value, &amp;value); err == nil {\n            fmt.Fprintf(w, \"The value of foo is %q\", value[\"foo\"])\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2111, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1510643518, "creation_date": 1494616801, "question_id": 43945042, "link": "https://stackoverflow.com/questions/43945042/sending-cookie-in-api-rest-golang", "title": "sending cookie in API Rest golang", "body": "<p>am working in Golang, I am building an API-Rest and am wondering, can I set cookies using restful?\nI am building the methos related to the authentication of the users: login, logout,sign up, etc. and by now am trying to set a cookie in the response with the generated uuid. I have this:</p>\n\n<pre><code>func Login(w http.ResponseWriter, req *http.Request, ps httprouter.Params) {\n              ...some code....\n      c := &amp;http.Cookie{\n        Name:  \"session\",\n        Value: uuid.NewV4().String(),\n      }\n    http.SetCookie(w, c)\n\n    w.Header().Set(\"Content-Type\", \"application/json; charset=UTF-8\")\n    json.NewEncoder(w).Encode(user)\n    w.WriteHeader(fasthttp.StatusOK)\n}\n</code></pre>\n\n<p>But in the response I don't get any cookie, so, if is possible, how is the proper way to make it? Thank you!</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494614744, "post_id": 43944378, "comment_id": 74921899, "body": "When it comes to measuring TLS traffic bytes, are you wanting the actual network traffic, or are you wanting a count of the bytes after they&#39;re decrypted?"}, {"owner": {"reputation": 1123, "user_id": 292623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c3dde75aa8058d1c97503eb1bf6f6d?s=128&d=identicon&r=PG", "display_name": "rob05c", "link": "https://stackoverflow.com/users/292623/rob05c"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494615415, "post_id": 43944378, "comment_id": 74922210, "body": "Network traffic would be ideal, but if that&#39;s not possible, decrypted bytes is better than nothing."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494615432, "post_id": 43944378, "comment_id": 74922219, "body": "Network bytes is actually easier - see my answer below."}], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494616255, "post_id": 43944695, "comment_id": 74922603, "body": "Let me know if you try this because I&#39;m really curious to know if it works but I don&#39;t have the time to set up a whole test while I&#39;m at work..."}, {"owner": {"reputation": 1123, "user_id": 292623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c3dde75aa8058d1c97503eb1bf6f6d?s=128&d=identicon&r=PG", "display_name": "rob05c", "link": "https://stackoverflow.com/users/292623/rob05c"}, "edited": false, "score": 0, "creation_date": 1494617249, "post_id": 43944695, "comment_id": 74923095, "body": "Awesome! It works! Code is here, if you want to add it to your answer <a href=\"https://play.golang.org/p/GskaC-WpbO\" rel=\"nofollow noreferrer\">play.golang.org/p/GskaC-WpbO</a>"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1494615090, "creation_date": 1494615090, "answer_id": 43944695, "question_id": 43944378, "link": "https://stackoverflow.com/questions/43944378/count-sent-and-received-bytes-in-go-in-an-http-handler-servehttp-function/43944695#43944695", "title": "Count sent and received bytes in Go in an http.Handler ServeHTTP function?", "body": "<p>I think it is possible, but I can't say I've done it. However, based on browsing the stdlib implementation of the HTTP server and TLS listener, I don't see why it shouldn't be possible; the key is wrapping the connection <em>before</em> TLS instead of <em>after</em>. This also gets you a more accurate count of bytes on the wire, rather than a count of decrypted bytes.</p>\n\n<p>You've already got an intercepting <code>Listener</code>, you just need to insert it in the right spot. Rather than passing your <code>Listener</code> to <code>http.Serve</code> (or wherever you're inserting it), you want to pass it to <a href=\"https://golang.org/pkg/crypto/tls/#NewListener\" rel=\"nofollow noreferrer\"><code>tls.NewListener</code></a> first, which wraps it in the TLS handler, and then pass the result, which will be a TLS listener (making Go's HTTP/2 support happy) into the HTTP server.</p>\n\n<p>Of course, if you want a count of decrypted bytes rather than wire bytes, you may be SOL - wrapping the <code>net.Conn</code> just won't get you there. You'll likely have to do the best you can with counting headers &amp; body.</p>\n"}], "owner": {"reputation": 1123, "user_id": 292623, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c8c3dde75aa8058d1c97503eb1bf6f6d?s=128&d=identicon&r=PG", "display_name": "rob05c", "link": "https://stackoverflow.com/users/292623/rob05c"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 261, "favorite_count": 0, "accepted_answer_id": 43944695, "answer_count": 1, "score": 2, "last_activity_date": 1494615090, "creation_date": 1494613797, "question_id": 43944378, "link": "https://stackoverflow.com/questions/43944378/count-sent-and-received-bytes-in-go-in-an-http-handler-servehttp-function", "title": "Count sent and received bytes in Go in an http.Handler ServeHTTP function?", "body": "<p>How can sent and received bytes be counted from within a <code>ServeHTTP</code> function in Go?</p>\n\n<p>The count needs to be relatively accurate. Skipping connection establishment is not ideal, but acceptable. But headers must be included.</p>\n\n<p>It also needs to be fast. Iterating is generally too slow.</p>\n\n<p>The counting itself doesn't need to occur within <code>ServeHTTP</code>, as long the count for a given connection can be made available to <code>ServeHTTP</code>.</p>\n\n<p>This must also not break HTTPS or HTTP/2.</p>\n\n<p><strong>Things I've Tried</strong></p>\n\n<p>It's possible to get a rough, slow estimate of received bytes by iterating over the <code>Request</code> headers. This is far too slow, and the Go standard library removes and combines headers, so it's not accurate either.</p>\n\n<p>I tried writing an intercepting <code>Listener</code>, which created an internal <code>tls.Listen</code> or <code>net.Listen</code> Listener, and whose <code>Accept()</code> function got a <code>net.Conn</code> from the internal Listener's <code>Accept()</code>, and then wrapped that in an intercepting <code>net.Conn</code> whose <code>Read</code> and <code>Write</code> functions call the real <code>net.Conn</code> and count their reads and writes. It's then possible to make those counts available to the <code>ServeHTTP</code> function via mutexed shared variables.</p>\n\n<p>The problem is, the intercepting <code>Conn</code> breaks HTTP/2, because Go's internal libraries cast the <code>net.Conn</code> as a <code>*tls.Conn</code> (e.g. <a href=\"https://golang.org/src/net/http/server.go#L1730\" rel=\"nofollow noreferrer\">https://golang.org/src/net/http/server.go#L1730</a>), and it doesn't appear possible in Go to wrap the object while still making that cast succeed (if it is, it would solve this problem).</p>\n\n<p>Counting sent bytes can be done relatively accurately by counting what is written to the <code>ResponseWriter</code>. Counting received bytes in the HTTP body is also achievable, via <code>Request.Body</code>. The critical issue here appears to be quickly and accurately counting request header bytes. Though again, also counting connection establishment bytes would be ideal.</p>\n\n<p>Is this possible? How?</p>\n"}, {"tags": ["linux", "git", "go"], "comments": [{"owner": {"reputation": 693, "user_id": 1752516, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/9a7dc0642e0a6408d22d570c7502a6c8?s=128&d=identicon&r=PG&f=1", "display_name": "Jya", "link": "https://stackoverflow.com/users/1752516/jya"}, "edited": false, "score": 0, "creation_date": 1495190123, "post_id": 43943742, "comment_id": 75159462, "body": "Is there a reason why you are not using ssh key based authentication? I assume this is for some sort of deployment-related application. You can generate deployment keys with read-only permission in some git services."}], "answers": [{"comments": [{"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 0, "creation_date": 1494613994, "post_id": 43943841, "comment_id": 74921500, "body": "i&#39;ve try but doesn t seems to work : <a href=\"https://play.golang.org/p/Ffm3q5h636\" rel=\"nofollow noreferrer\">play.golang.org/p/Ffm3q5h636</a> thks btw"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 0, "creation_date": 1494614340, "post_id": 43943841, "comment_id": 74921698, "body": "Hi, is it not working because you&#39;re using the play ground? Or is it not working on your machine?"}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 0, "creation_date": 1494614537, "post_id": 43943841, "comment_id": 74921797, "body": "not working on my machine , i have on my computer i doubt they have git on the playground :)"}, {"owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "reply_to_user": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 0, "creation_date": 1494614869, "post_id": 43943841, "comment_id": 74921955, "body": "If you don&#39;t check for the error on CombinedOutput, I get     git: &#39;clone <a href=\"https://bb@gitlab.com/bb/fzgs.git\" rel=\"nofollow noreferrer\">bb@gitlab.com/bb/fzgs.git</a>&#39; is not a git command. See &#39;git --help&#39;."}, {"owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "edited": false, "score": 0, "creation_date": 1494615267, "post_id": 43943841, "comment_id": 74922140, "body": "i&#39;ve got this  : go run gitclone.go  Password for &#39;<a href=\"https://bb@gitlab.com\" rel=\"nofollow noreferrer\">bb@gitlab.com</a>&#39;: it asks me for the password :/ (thks again btw)"}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": false, "score": 3, "last_activity_date": 1596048874, "last_edit_date": 1596048874, "creation_date": 1494611736, "answer_id": 43943841, "question_id": 43943742, "link": "https://stackoverflow.com/questions/43943742/answer-to-password-shell-prompt-in-golang/43943841#43943841", "title": "Answer to password shell prompt in golang", "body": "<p>If a user is asked for a password in their shell, you can use golang to <strong>write to the io.Writer</strong> that is <code>os.Stdin</code></p>\n<p><a href=\"https://stackoverflow.com/questions/14803425/properly-passing-data-on-stdin-to-a-command-and-receiving-data-from-stdout-of-th\">Properly passing data on stdin to a command and receiving data from stdout of that command in golang</a></p>\n<p><strong><code>os.Stdin</code></strong> is a <code>os.File</code> created by</p>\n<pre><code>NewFile(uintptr(syscall.Stdin), &quot;/dev/stdin&quot;)\n</code></pre>\n<p>And the password prompt will be reading from this file</p>\n<p>You can execute <code>./passwordtest.sh</code> as in your question, and then write the password to <code>os.Stdin</code>, and the bash script should accept the bytes written by golang as the password.</p>\n<hr>\n<p>Alternatively is actually a method for this in the <code>exec</code> package for the <code>Cmd</code> type.</p>\n<ol>\n<li>Use <strong>cmd</strong> to execute your shell script</li>\n<li>Input the password using <strong>stdin</strong>, or <code>cmd.StdinPip()</code></li>\n<li>Read the shells <strong>output</strong> using <code>cmd.CombinedOutput()</code></li>\n</ol>\n<blockquote>\n<p>Cmd represents an external command being prepared or run.</p>\n</blockquote>\n<p><a href=\"https://golang.org/pkg/os/exec/#Cmd.StdinPipe\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/#Cmd.StdinPipe</a></p>\n<pre><code>cmd := exec.Command(&quot;cat&quot;)\nstdin, err := cmd.StdinPipe()\nif err != nil {\n    log.Fatal(err)\n}\n\ngo func() {\n    defer stdin.Close()\n    io.WriteString(stdin, &quot;values written to stdin are passed to cmd's standard input&quot;)\n}()\n\nout, err := cmd.CombinedOutput()\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(&quot;%s\\n&quot;, out)\n</code></pre>\n<blockquote>\n<p>StdinPipe returns a pipe that will be connected to the command's standard input when the command starts. The pipe will be closed automatically after Wait sees the command exit. A caller need only call Close to force the pipe to close sooner. For example, if the command being run will not exit until standard input is closed, the caller must close the pipe.</p>\n</blockquote>\n<p>Also, your <code>cmd</code> arguments shouldn't combine clone and the url, try instead</p>\n<pre><code>cmd := exec.Command(cmdb, &quot;clone&quot;, url)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 17784, "user_id": 1646322, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/d9fd7a75e0d8ace7bb3276476786c2c0?s=128&d=identicon&r=PG", "display_name": "Ruslan Osmanov", "link": "https://stackoverflow.com/users/1646322/ruslan-osmanov"}, "is_accepted": false, "score": 5, "last_activity_date": 1495427241, "last_edit_date": 1495427241, "creation_date": 1494824842, "answer_id": 43971910, "question_id": 43943742, "link": "https://stackoverflow.com/questions/43943742/answer-to-password-shell-prompt-in-golang/43971910#43971910", "title": "Answer to password shell prompt in golang", "body": "<p>The problem is that you are trying to send the password before Git asks you\nto do so.</p>\n\n<p>And the way Git asks for password depends on whether <a href=\"https://www.kernel.org/pub/software/scm/git/docs/gitcredentials.html\" rel=\"nofollow noreferrer\">credential</a> helper is set. If the credential helper is not set, or doesn't return a password, the user is asked for input.</p>\n\n<h2>Solution #1: Include Password into URI</h2>\n\n<p>In most cases (at least with Github and Bitbucket) the Git server accepts\ncredentials passed via HTTPS URI, e.g. <code>https://user:password@domain.com/repo.git</code>.</p>\n\n<pre><code>cmd := exec.Command(\"git\", \"clone\", \"https://bb:PASSWORD@gitlab.com/bb/fzgs.git\")\n\nenv := os.Environ()\nenv = append(env, \"GIT_ASKPASS=\")\ncmd.Env = env\n\nvar out bytes.Buffer\ncmd.Stdout = &amp;out\n\nerr := cmd.Run()\n</code></pre>\n\n<h2>Solution #2: Custom Credential Helper</h2>\n\n<p>Another way is to make a credential helper script, e.g.:</p>\n\n<pre><code>#!/bin/bash -\nprintf '%s\\n' 'YOUR_PASSWORD'\n</code></pre>\n\n<p>and pass it via <code>GIT_ASKPASS</code>:</p>\n\n<pre><code>cmd := exec.Command(\"git\", \"clone\", \"https://bb@gitlab.com/bb/fzgs.git\")\n\nenv := os.Environ()\nenv = append(env, \"GIT_ASKPASS=/path/to/fzgs-askpass.sh\")\ncmd.Env = env\n\nvar out bytes.Buffer\ncmd.Stdout = &amp;out\n\nerr := cmd.Run()\n</code></pre>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3625, "favorite_count": 1, "answer_count": 2, "score": 13, "last_activity_date": 1596048874, "creation_date": 1494611381, "last_edit_date": 1494825193, "question_id": 43943742, "link": "https://stackoverflow.com/questions/43943742/answer-to-password-shell-prompt-in-golang", "title": "Answer to password shell prompt in golang", "body": "<p>I am searching for a way to answer to a shell password prompt in golang.</p>\n\n<p>like :</p>\n\n<pre><code>bussiere@kus:~/Workspace/rteest$ ./passwordtest.sh\nPassword : \n</code></pre>\n\n<p>I would like to enter the password automatically with my token in golang after launching a shell command / script ...</p>\n\n<p>I've made some script that get a one time token with mfa if everything is ok (in golang). So i need to enter the tempory token to a linux password prompt.</p>\n\n<p>I know that there is the expect command but i would like to compile my program to embed it and have minimal depency.</p>\n\n<p>Thanks and regards</p>\n\n<p>edit thks to @nevermore i've tried this (but it doesn't work) : <a href=\"https://play.golang.org/p/Ffm3q5h636\" rel=\"noreferrer\">https://play.golang.org/p/Ffm3q5h636</a></p>\n\n<pre><code>package main\n\nimport (\n    \"os/exec\"\n    \"fmt\"\n    \"log\"\n    \"io\"\n)\n\nfunc main() {\n    cmdb := \"git\"\n    args := \"clone https://bb@gitlab.com/bb/fzgs.git\"\ncmd := exec.Command(cmdb, args)\nstdin, err := cmd.StdinPipe()\nif err != nil {\nlog.Fatal(err)\n}\n\ngo func() {\ndefer stdin.Close()\nio.WriteString(stdin, \"QSRDFGHJfZERTYU\")\n}()\n\nout, err := cmd.CombinedOutput()\nif err != nil {\nlog.Fatal(err)\n}\n\nfmt.Printf(\"%s\\n\", out)\n\n}\n</code></pre>\n\n<p>it gives me this :</p>\n\n<pre><code>2017/05/12 20:42:36 exit status 1\nexit status 1\n</code></pre>\n\n<p>edit bis  :</p>\n\n<pre><code>    cmdb := \"git\"\n    args := \"https://bb@gitlab.com/bb/fzgs.git\"\ncmd := exec.Command(cmdb, \"clone\", args)\n</code></pre>\n\n<p>it asks for the password :</p>\n\n<p>Password for '<a href=\"https://bb@gitlab.com\" rel=\"noreferrer\">https://bb@gitlab.com</a>': </p>\n"}, {"tags": ["templates", "go", "revel"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1494611997, "post_id": 43943637, "comment_id": 74920399, "body": "Can you show the whole <code>footer</code> template code? Also just before executing the template can you log the contents of <code>c.ViewArgs</code> and ensure that <code>&quot;RunMode&quot;</code> is present and that its a <code>string</code>."}, {"owner": {"reputation": 418, "user_id": 5832798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aphMx.jpg?s=128&g=1", "display_name": "farhan", "link": "https://stackoverflow.com/users/5832798/farhan"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1494612085, "post_id": 43943637, "comment_id": 74920440, "body": "All the footer code is already added. And yes it&#39;s a string."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1494612952, "post_id": 43943637, "comment_id": 74920916, "body": "Can you show what you&#39;re passing to <code>c.Render</code>? And also can you show what <code>c.ViewArgs</code> contains just before calling render and after?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1494613201, "post_id": 43943637, "comment_id": 74921055, "body": "Also I assume footer is a &quot;partial&quot; template called from another template like <code>{{template &quot;footer.html&quot; .something}}</code>, correct? If that&#39;s the case then make sure that <code>something</code> contains <code>&quot;RunMode&quot;</code> and that it&#39;s a <code>string</code>."}, {"owner": {"reputation": 418, "user_id": 5832798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aphMx.jpg?s=128&g=1", "display_name": "farhan", "link": "https://stackoverflow.com/users/5832798/farhan"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1494613218, "post_id": 43943637, "comment_id": 74921066, "body": "I have couple of them. sharing all of it. here  \t                                                                                                           return c.Render(ts) , \treturn c.Render(&amp;models.Lists{})  Will give it a try. Am I asking a right question?"}, {"owner": {"reputation": 418, "user_id": 5832798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aphMx.jpg?s=128&g=1", "display_name": "farhan", "link": "https://stackoverflow.com/users/5832798/farhan"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1494613576, "post_id": 43943637, "comment_id": 74921285, "body": "That worked thank can you add a answer so I can vote."}], "answers": [{"comments": [{"owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "edited": false, "score": 0, "creation_date": 1545154318, "post_id": 43944526, "comment_id": 94524652, "body": "answer explains why but does not provide a way around. This problem gets wonky when comparing untyped dot values."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "edited": false, "score": 0, "creation_date": 1545155196, "post_id": 43944526, "comment_id": 94525130, "body": "@Richard If you read the comments you&#39;ll see that my, according to you, insufficient explanation, resolved the issue OP was having, which leads me to believe that your issue is probably different and you should create a new question if you&#39;re looking for help."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 0, "last_activity_date": 1494614359, "creation_date": 1494614359, "answer_id": 43944526, "question_id": 43943637, "link": "https://stackoverflow.com/questions/43943637/error-invalid-type-for-comparison-in-revel-template/43944526#43944526", "title": "Error: &quot;invalid type for comparison&quot; in revel template", "body": "<p>The error you see arises when one of the arguments to <code>eq</code> is either undefined in the current context or is not of a \"basic type\" (<a href=\"https://golang.org/pkg/text/template/#hdr-Functions\" rel=\"nofollow noreferrer\">see the last paragraph of this section</a>) </p>\n\n<p>So assuming that <code>footer.html</code> is a \"pratial\" template that is associated with other templates which invoke the footer template using the <em>template action</em> you need to ensure that the context passed in to the template invocation contains the <code>.RunMode</code> value and that the value is of a <em>basic type</em>.</p>\n"}, {"tags": [], "owner": {"reputation": 8184, "user_id": 99542, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e94a065789007e8c3301ae1d726e6537?s=128&d=identicon&r=PG", "display_name": "Richard", "link": "https://stackoverflow.com/users/99542/richard"}, "is_accepted": false, "score": 3, "last_activity_date": 1545221816, "creation_date": 1545221816, "answer_id": 53851110, "question_id": 43943637, "link": "https://stackoverflow.com/questions/43943637/error-invalid-type-for-comparison-in-revel-template/53851110#53851110", "title": "Error: &quot;invalid type for comparison&quot; in revel template", "body": "<p>While this question seems to be answered there is plenty missing. First the question is incomplete... WHAT IS THE ERROR?  My guess us that the <code>.RunMode</code> is missing when the template parser/executor was run. There are not best practices for golang templates, however, this is a common problem when overloading templates and not maintaining a dictionary of variables.</p>\n\n<p>One strategy I tend to deploy is:</p>\n\n<pre><code>{{if eq (or .RunMode \"default\") \"dev\"}}\n</code></pre>\n\n<p>This way if <code>.RunMode</code> is NOT assigned a value (nil exception) or an empty string then the <code>eq</code> uses the <code>\"default\"</code> value instead. Think of this as a shorthand like in 'C'</p>\n\n<p>This is an exaggerated example.</p>\n\n<pre><code>a := runmode!=null?runmode:default\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1310, "user_id": 5167801, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Cdcxo.jpg?s=128&g=1", "display_name": "Anum Sheraz", "link": "https://stackoverflow.com/users/5167801/anum-sheraz"}, "is_accepted": false, "score": 0, "last_activity_date": 1598462374, "creation_date": 1598462374, "answer_id": 63602695, "question_id": 43943637, "link": "https://stackoverflow.com/questions/43943637/error-invalid-type-for-comparison-in-revel-template/63602695#63602695", "title": "Error: &quot;invalid type for comparison&quot; in revel template", "body": "<p>You are comparing &quot;string&quot; with a variable <code>.RunMode</code> of some unknown type. How about casting that variable to string ?</p>\n<p><code>{{if eq (.RunMode | toString) &quot;dev&quot;}}</code></p>\n"}], "owner": {"reputation": 418, "user_id": 5832798, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/aphMx.jpg?s=128&g=1", "display_name": "farhan", "link": "https://stackoverflow.com/users/5832798/farhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3330, "favorite_count": 0, "accepted_answer_id": 43944526, "answer_count": 3, "score": 2, "last_activity_date": 1598462374, "creation_date": 1494611008, "last_edit_date": 1494612694, "question_id": 43943637, "link": "https://stackoverflow.com/questions/43943637/error-invalid-type-for-comparison-in-revel-template", "title": "Error: &quot;invalid type for comparison&quot; in revel template", "body": "<p>After creating multple endpoints customizing footer.html, I end up with this error for not apparent this don't effect the functionally of the application, just annoying me. \n Tried: </p>\n\n<pre><code>  revel run revel_app or dev\n</code></pre>\n\n<p>Revel Template Execution Error</p>\n\n<p>: executing \"footer.html\" at : error calling eq: invalid type for comparison.</p>\n\n<pre><code>  {{if eq .RunMode \"dev\"}}\n\n  {{template \"debug.html\" .}}\n\n  {{end}}\n &lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494608817, "post_id": 43943038, "comment_id": 74918558, "body": "Hopefully someone better versed in Gorilla can answer your question. Is there a reason you&#39;re using gorilla mux for this? It seems like the stdlib mux would handle this just fine."}, {"owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494608994, "post_id": 43943038, "comment_id": 74918660, "body": "I don&#39;t think that it&#39;s the library that&#39;s causing issues. I&#39;ve tried this with removing the Gorilla and I&#39;m getting the same issue. Reasoning for Gorilla was to see what it&#39;s all about for the API and Auth service at a later point."}], "answers": [{"comments": [{"owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "edited": false, "score": 0, "creation_date": 1494609204, "post_id": 43943135, "comment_id": 74918780, "body": "Still doesn&#39;t work. The URL in the browser or cURL is <code>http:&#47;&#47;localhost:8000&#47;dist&#47;filename.js</code>. I&#39;ll do some logging to make sure of the request vs the filename maybe."}, {"owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "edited": false, "score": 0, "creation_date": 1494609497, "post_id": 43943135, "comment_id": 74918945, "body": "If the handle URL is the same as the StripPrefix then it removes the <code>&#47;dist&#47;</code> from the URL once you try access the file."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 0, "last_activity_date": 1494609042, "creation_date": 1494609042, "answer_id": 43943135, "question_id": 43943038, "link": "https://stackoverflow.com/questions/43943038/serving-static-content-with-golang-webserver/43943135#43943135", "title": "Serving static content with GoLang Webserver", "body": "<p>There could be an issue with file access path. Try:</p>\n\n<pre><code>// Strip away \"/dist\" instead of \"/dist/\"\nrouter.Handle(\"/dist/\", http.StripPrefix(\"/dist\", http.FileServer(http.Dir(\"dist\"))))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4649, "user_id": 681679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ba1bdfa6ba08225903a74383be42b06?s=128&d=identicon&r=PG", "display_name": "photoionized", "link": "https://stackoverflow.com/users/681679/photoionized"}, "is_accepted": true, "score": 2, "last_activity_date": 1494612108, "creation_date": 1494612108, "answer_id": 43943931, "question_id": 43943038, "link": "https://stackoverflow.com/questions/43943038/serving-static-content-with-golang-webserver/43943931#43943931", "title": "Serving static content with GoLang Webserver", "body": "<p>Per the <a href=\"https://godoc.org/github.com/gorilla/mux\" rel=\"nofollow noreferrer\">gorilla mux docs</a>, the proper way to do this would be a handler registered with <code>PathPrefix</code>, like this:</p>\n\n<pre><code>router.PathPrefix(\"/dist/\").Handler(http.StripPrefix(\"/dist/\", http.FileServer(http.Dir(\"dist\"))))\n</code></pre>\n\n<p>An example can be found if you search the docs for something like <code>PathPrefix(\"/static/\")</code>.</p>\n\n<hr>\n\n<p>This wildcard behavior actually comes by default with the pattern matching mechanism in net/http, so if you weren't using gorilla, but just the default net/http, you could do the following:</p>\n\n<pre><code>http.Handle(\"/dist/\", http.StripPrefix(\"/dist/\", http.FileServer(http.Dir(\"dist\"))))\n</code></pre>\n"}], "owner": {"reputation": 1759, "user_id": 1370060, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/12135517e119f348d7efbc18407cba18?s=128&d=identicon&r=PG", "display_name": "Nick Corin", "link": "https://stackoverflow.com/users/1370060/nick-corin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1719, "favorite_count": 2, "accepted_answer_id": 43943931, "answer_count": 2, "score": 3, "last_activity_date": 1494612108, "creation_date": 1494608647, "question_id": 43943038, "link": "https://stackoverflow.com/questions/43943038/serving-static-content-with-golang-webserver", "title": "Serving static content with GoLang Webserver", "body": "<p>I'm exploring the depths of Go, and I've been trying to write a simple web application to wrap my head around everything. I'm trying to serve a React.js application.</p>\n\n<p>Below is the code of the Go server. I've got the default route of <code>/</code> serving the <code>index.html</code> which is working fine. I'm struggling to allow static files to be served to that index file. I'm allowing the React App to do it's own client side routing, although I need to statically serve the JavaScript / CSS / Media files.</p>\n\n<p>For example, I need to be able to serve the <code>bundle.js</code> file into the <code>index.html</code> for the React application to run. Currently, when I route to <code>localhost:8000/dist/</code> I see the files being listed, but every file/folder that I click from there is throwing a <code>404 Page Not Found</code>. Is there something that I'm missing? A push in the right direction would be greatly appreciated.</p>\n\n<p>Webserver.go</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"log\"\n    \"fmt\"\n    \"os\"\n\n    \"github.com/BurntSushi/toml\"\n    \"github.com/gorilla/mux\"\n)\n\ntype ServerConfig struct {\n    Environment string\n    Host string\n    HttpPort int\n    HttpsPort int\n    ServerRoot string\n    StaticDirectories []string\n}\n\nfunc ConfigureServer () ServerConfig {\n    _, err := os.Stat(\"env.toml\")\n    if err != nil {\n        log.Fatal(\"Config file is missing: env.toml\")\n    }\n\n    var config ServerConfig\n    if _, err := toml.DecodeFile(\"env.toml\", &amp;config); err != nil {\n        log.Fatal(err)\n    }\n\n    return config\n}\n\nfunc IndexHandler (w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"./src/index.html\")\n}\n\nfunc main () {\n    Config := ConfigureServer()\n    router := mux.NewRouter()\n\n    // Configuring static content to be served.\n    router.Handle(\"/dist/\", http.StripPrefix(\"/dist/\", http.FileServer(http.Dir(\"dist\"))))\n\n    // Routing to the Client-Side Application.\n    router.HandleFunc(\"/\", IndexHandler).Methods(\"GET\")\n\n    log.Printf(fmt.Sprintf(\"Starting HTTP Server on Host %s:%d.\", Config.Host, Config.HttpPort))\n\n    if err := http.ListenAndServe(fmt.Sprintf(\"%s:%d\", Config.Host, Config.HttpPort), router); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "encryption", "go", "base64", "aes"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494608901, "post_id": 43942972, "comment_id": 74918606, "body": "The error is in decoding the base64 data, what makes you say the problem is in unmarshalling the JSON?"}, {"owner": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494608991, "post_id": 43942972, "comment_id": 74918659, "body": "because it works with the same decrypt function on the client side. Without any error.  and &quot;unencryptedUrl&quot; on the server looks the same as &quot;string(ciphertext)&quot; on the client.  So I think something went wrong on the way from the client to the server."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494609305, "post_id": 43942972, "comment_id": 74918832, "body": "The variable names are super confusing - <code>unencryptedUrl</code> is the raw input before you call <code>decrypt</code> on it, so it&#39;s actually the encrypted value, right? And the value that comes back out of <code>decrypt</code> is called <code>encryptedUrl</code> but it&#39;s actually the unencrypted value, since it&#39;s the resul of <code>decrypt</code>?"}, {"owner": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494609582, "post_id": 43942972, "comment_id": 74919008, "body": "yeah you are right. I changed that and hope it is less confusing now."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494609863, "post_id": 43942972, "comment_id": 74919150, "body": "What does the JSON look like? Since <code>urlCrypted</code> goes in as a <code>[]byte</code>, I would think it would remain a byte array, which means when you pull the data out, you should just cast it to <code>[]byte</code> instead of casting to <code>string</code>, then casting the string to a <code>[]byte</code>. It&#39;s <i>possible</i> that&#39;s related to the issue."}, {"owner": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494609972, "post_id": 43942972, "comment_id": 74919196, "body": "values := map[string]interface{}{&quot;url&quot;: *getUrl, &quot;urlCrypted&quot;: ciphertext} jsonValue, _ := json.Marshal(values) jsonStr := bytes.NewBuffer(jsonValue)"}, {"owner": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494610122, "post_id": 43942972, "comment_id": 74919274, "body": "I tried casting it to []byte, but go throws the error           interface conversion: interface is string, not []uint8"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494614104, "post_id": 43942972, "comment_id": 74921570, "body": "That seems odd to me. Can you add a sample of the JSON to your question?"}, {"owner": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1494614370, "post_id": 43942972, "comment_id": 74921710, "body": "Not yet but tomorw will be possible. In the mean time you could fork the repo if you want."}], "answers": [{"comments": [{"owner": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "edited": false, "score": 0, "creation_date": 1494838923, "post_id": 43968500, "comment_id": 74980172, "body": "As you may have seen, I&#39;m doing exactly that in the &quot;getRequestContentFromRequest&quot; function."}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "edited": false, "score": 0, "creation_date": 1494851983, "post_id": 43968500, "comment_id": 74988561, "body": "No, you don&#39;t base64 decode in that function. You have to base64 decode <code>requestContent[&quot;urlCrypted&quot;]</code> before calling <code>decrypt</code>"}, {"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "reply_to_user": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "edited": false, "score": 0, "creation_date": 1494864175, "post_id": 43968500, "comment_id": 74997228, "body": "I found several issues in the encrypt/decryp funcs. You have to encode after you encrypt and decode before you decrypt. Otherwise the json marshaller will receive a json string with unprintable characters and will encode in base64 again. If it receives a base64 string, it will send it as is. Check here <a href=\"https://play.golang.org/p/VYE1uFQ5-o\" rel=\"nofollow noreferrer\">play.golang.org/p/VYE1uFQ5-o</a>"}], "tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": true, "score": 0, "last_activity_date": 1494930198, "last_edit_date": 1494930198, "creation_date": 1494793624, "answer_id": 43968500, "question_id": 43942972, "link": "https://stackoverflow.com/questions/43942972/golang-encode-decode-base64-with-json-post-doesnt-work/43968500#43968500", "title": "Golang Encode/Decode base64 with json post doesn&#39;t work", "body": "<p>The problem is that you encode in base64 twice. The first time in the <code>encrypt</code> function and the second time during the JSON marshalling. byte slices are automatically converted into base64 strings by the <code>encoding/json</code> marshaller.</p>\n\n<p>The solution is to decode the base64 string before calling <code>decrypt</code>.</p>\n\n<p>Example on <a href=\"https://play.golang.org/p/taf4_Iofzp\" rel=\"nofollow noreferrer\">the Go PlayGround</a></p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Working solution <a href=\"https://play.golang.org/p/VYE1uFQ5-o\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 119, "user_id": 6869505, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fcb389a5c083052e89563f819e4201ec?s=128&d=identicon&r=PG&f=1", "display_name": "Marcel R&#246;sler", "link": "https://stackoverflow.com/users/6869505/marcel-r%c3%b6sler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4308, "favorite_count": 0, "accepted_answer_id": 43968500, "answer_count": 1, "score": 1, "last_activity_date": 1494930198, "creation_date": 1494608416, "last_edit_date": 1494842185, "question_id": 43942972, "link": "https://stackoverflow.com/questions/43942972/golang-encode-decode-base64-with-json-post-doesnt-work", "title": "Golang Encode/Decode base64 with json post doesn&#39;t work", "body": "<p>I build a client and a server in golang both are using this functions to encrypt/decrypt</p>\n\n<pre><code>func encrypt(text []byte) ([]byte, error) {\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        return nil, err\n    }\n    b := base64.StdEncoding.EncodeToString(text)\n    ciphertext := make([]byte, aes.BlockSize+len(b))\n    iv := ciphertext[:aes.BlockSize]\n    if _, err := io.ReadFull(rand.Reader, iv); err != nil {\n        return nil, err\n    }\n    cfb := cipher.NewCFBEncrypter(block, iv)\n    cfb.XORKeyStream(ciphertext[aes.BlockSize:], []byte(b))\n    return ciphertext, nil\n}\n\nfunc decrypt(text []byte) ([]byte, error) {\n    block, err := aes.NewCipher(key)\n    if err != nil {\n        return nil, err\n    }\n    if len(text) &lt; aes.BlockSize {\n        return nil, errors.New(\"ciphertext too short\")\n    }\n    iv := text[:aes.BlockSize]\n    text = text[aes.BlockSize:]\n    cfb := cipher.NewCFBDecrypter(block, iv)\n    cfb.XORKeyStream(text, text)\n    data, err := base64.StdEncoding.DecodeString(string(text))\n    if err != nil {\n        return nil, err\n    }\n    return data, nil\n}\n</code></pre>\n\n<p>so yeah I make a normal post request </p>\n\n<pre><code>url := \"https://\"+configuration.Server+configuration.Port+\"/get\"\n\n// TODO maybe bugs rest here\nciphertext, err := encrypt([]byte(*getUrl))\nif err != nil {\n    fmt.Println(\"Error: \" + err.Error())\n}\nfmt.Println(string(ciphertext))\n\nvalues := map[string]interface{}{\"url\": *getUrl, \"urlCrypted\": ciphertext}\njsonValue, _ := json.Marshal(values)\njsonStr := bytes.NewBuffer(jsonValue)\n\nreq, err := http.NewRequest(\"POST\", url, jsonStr)\n</code></pre>\n\n<p>and the servercode is as following</p>\n\n<pre><code>requestContent := getRequestContentFromRequest(req)\nurl := requestContent[\"url\"].(string)\n\nundecryptedUrl := requestContent[\"urlCrypted\"].(string)\ndecryptedurl, err := decrypt([]byte(undecryptedUrl))\nif err != nil {\n    fmt.Println(\"Error: \" + err.Error())\n}\nfmt.Println(decryptedurl)\n</code></pre>\n\n<p>where getRequestContentFromRequest is as following</p>\n\n<pre><code>func getRequestContentFromRequest(req *http.Request)                 \n    map[string]interface{} {\n    buf := new(bytes.Buffer)\n    buf.ReadFrom(req.Body)\n    data := buf.Bytes()\n    var requestContent map[string]interface{}\n    err := json.Unmarshal(data, &amp;requestContent)\n    if err != nil {\n        fmt.Println(err)\n    }\n    return requestContent\n}\n</code></pre>\n\n<p>Now to the problem.\nIf I encrypt my string in the client and decrypt it direct after that everything is fine.</p>\n\n<p>But, when I send the encrypted string to the server and try to decrypt it with literrally the same function as in the client, the decrypt function throws an error.</p>\n\n<pre><code>Error: illegal base64 data at input byte 0\n</code></pre>\n\n<p>I think the Problem is the unmarshalling of the JSON.</p>\n\n<p>Thanks for help.</p>\n\n<p>P.S.</p>\n\n<p>Repos are </p>\n\n<p>github.com/BelphegorPrime/goSafeClient and github.com/BelphegorPrime/goSafe</p>\n\n<p>UPDATE</p>\n\n<p>Example JSON</p>\n\n<pre><code>{\"url\":\"facebook2.com\",\"urlCrypted\":\"/}\\ufffd\\ufffd\\ufffdgP\\ufffdN\ubf1e\\ufffd\\u0016\\ufffd)\\ufffd\\ufffd\\ufffdy\\u001c\\u000f\\ufffd\\ufffd\\ufffdep\\ufffd\\rY\\ufffd\\ufffd$\\ufffd\\ufffd\"}\n</code></pre>\n\n<p>UPDATE2</p>\n\n<p>I made a playground <a href=\"https://play.golang.org/p/AHo_KJ5SyF\" rel=\"nofollow noreferrer\">here</a></p>\n"}, {"tags": ["go", "visual-studio-code"], "answers": [{"comments": [{"owner": {"reputation": 138, "user_id": 2534830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed541ce8beafe9a52483b1e1a84e0fe?s=128&d=identicon&r=PG", "display_name": "user2534830", "link": "https://stackoverflow.com/users/2534830/user2534830"}, "edited": false, "score": 0, "creation_date": 1494597993, "post_id": 43939457, "comment_id": 74911682, "body": "I know that go install use the environment variables. My question is how can I take advantage of the inferred <code>GOPATH</code> to create an executable of my code? What&#39;s the point of having an inferred <code>GOPATH</code> and not being able to run your code unless you manually set the <code>GOPATH</code> to be able to create that executable? I think I&#39;m missing something..."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 138, "user_id": 2534830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed541ce8beafe9a52483b1e1a84e0fe?s=128&d=identicon&r=PG", "display_name": "user2534830", "link": "https://stackoverflow.com/users/2534830/user2534830"}, "edited": false, "score": 0, "creation_date": 1494598241, "post_id": 43939457, "comment_id": 74911833, "body": "You can&#39;t, unless the plugin providing the inferred <code>GOPATH</code> also provides some particular facility for doing so. <code>go install</code> uses the environment variables exclusively, there is no other mechanism."}, {"owner": {"reputation": 138, "user_id": 2534830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed541ce8beafe9a52483b1e1a84e0fe?s=128&d=identicon&r=PG", "display_name": "user2534830", "link": "https://stackoverflow.com/users/2534830/user2534830"}, "edited": false, "score": 0, "creation_date": 1494598666, "post_id": 43939457, "comment_id": 74912116, "body": "Exactly. My question is more about if the <code>GO</code> extension provide this functionality or how I can achieve that. I feel like I&#39;m missing something."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 138, "user_id": 2534830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed541ce8beafe9a52483b1e1a84e0fe?s=128&d=identicon&r=PG", "display_name": "user2534830", "link": "https://stackoverflow.com/users/2534830/user2534830"}, "edited": false, "score": 0, "creation_date": 1494598835, "post_id": 43939457, "comment_id": 74912240, "body": "And the answer would appear to be no, and you can achieve it using temporary environment variables, as indicated in the answer. Most <code>GOPATH</code> shenanigans do more harm than good; just use a normal <code>GOPATH</code> and put your projects under it and everything will work as expected."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1494597098, "creation_date": 1494597098, "answer_id": 43939457, "question_id": 43938958, "link": "https://stackoverflow.com/questions/43938958/run-install-go-code-when-gopath-is-inferred/43939457#43939457", "title": "Run (install) go code when GOPATH is inferred", "body": "<p><code>go install</code> will always use the go environment settings, unless you modify the go toolchain. On Linux, you can use the <code>env</code> command to change environment variables for the execution of a single command; on Windows, you can use <code>SET</code> to change environment variables for only the current shell session.</p>\n"}], "owner": {"reputation": 138, "user_id": 2534830, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8ed541ce8beafe9a52483b1e1a84e0fe?s=128&d=identicon&r=PG", "display_name": "user2534830", "link": "https://stackoverflow.com/users/2534830/user2534830"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 291, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1535109964, "creation_date": 1494595771, "last_edit_date": 1535109964, "question_id": 43938958, "link": "https://stackoverflow.com/questions/43938958/run-install-go-code-when-gopath-is-inferred", "title": "Run (install) go code when GOPATH is inferred", "body": "<p>I just installed <a href=\"https://marketplace.visualstudio.com/items?itemName=lukehoban.Go\" rel=\"nofollow noreferrer\">Go extension</a> for Vscode and set <code>\"go.inferGopath\": true</code>, as explained <a href=\"https://github.com/Microsoft/vscode-go/wiki/GOPATH-in-the-VS-Code-Go-extension#gopath-from-goinfergopath-setting\" rel=\"nofollow noreferrer\">here</a>.\nWith autobuild on save my code builds, <code>GOPATH</code> is inferred correctly. \nIs there a way to run my code (<code>go install</code>) with the inferred <code>GOPATH</code> from vscode? When running any Go command from vscode terminal it uses system <code>GOPATH</code> from go env.</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1494592569, "post_id": 43937731, "comment_id": 74907958, "body": "why  `  rf := reflect.ValueOf(f)` is it a requirement  ? <code>&amp;MyError{}</code> is not nil anyways"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1494594226, "last_edit_date": 1494594226, "creation_date": 1494593247, "answer_id": 43938158, "question_id": 43937731, "link": "https://stackoverflow.com/questions/43937731/golang-pass-nil-value-as-an-interface-through-reflection/43938158#43938158", "title": "Golang pass nil value as an interface through reflection", "body": "<p>Use the following to create <code>nilArg</code>:</p>\n\n<pre><code>nilArg := reflect.Zero(reflect.TypeOf((*error)(nil)).Elem())\n</code></pre>\n\n<p>The first approach in the question does not work because the expression <code>reflect.TypeOf((error)(nil))</code> returns <code>nil</code>.  The concrete type of a nil interface value is nil.</p>\n\n<p>The trick is to pass a non-interface value to <code>reflect.TypeOf()</code> and use reflect methods to get the desired <code>reflect.Type</code> from there.  In this answer, I pass a <code>*error</code> to <code>reflect.TypeOf()</code> and call <code>Elem</code> on the result to get the <code>reflect.Type</code> for <code>error</code>.</p>\n\n<p><a href=\"https://play.golang.org/p/XVVfToNAt2\" rel=\"nofollow noreferrer\">playground example</a></p>\n"}, {"comments": [{"owner": {"reputation": 7696, "user_id": 283975, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ymiUl.jpg?s=128&g=1", "display_name": "Grozz", "link": "https://stackoverflow.com/users/283975/grozz"}, "edited": false, "score": 0, "creation_date": 1494593939, "post_id": 43938321, "comment_id": 74908866, "body": "valuable info, however the question is about passing the <code>nil</code> argument, not changing the check inside the function"}, {"owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "reply_to_user": {"reputation": 7696, "user_id": 283975, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ymiUl.jpg?s=128&g=1", "display_name": "Grozz", "link": "https://stackoverflow.com/users/283975/grozz"}, "edited": false, "score": 0, "creation_date": 1494596747, "post_id": 43938321, "comment_id": 74910733, "body": "Thanks for the clarification, glad you found your answer!"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": false, "score": 0, "last_activity_date": 1494593704, "last_edit_date": 1495542377, "creation_date": 1494593704, "answer_id": 43938321, "question_id": 43937731, "link": "https://stackoverflow.com/questions/43937731/golang-pass-nil-value-as-an-interface-through-reflection/43938321#43938321", "title": "Golang pass nil value as an interface through reflection", "body": "<p>You have two options, basically <code>e</code> in the arguments to function <code>f</code> is <code>(*MyError)(nil)</code> not <code>nil</code>. So either assert the interface back to type <code>MyError</code> or use more reflection to check if it's nil.</p>\n\n<pre><code>e.(*MyError) == nil\n</code></pre>\n\n<p>or</p>\n\n<pre><code>reflect.ValueOf(e).IsNil()\n</code></pre>\n\n<p><strong>Runnable Example</strong>: <a href=\"https://play.golang.org/p/2KWguSx618\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2KWguSx618</a></p>\n\n<p>useful links:</p>\n\n<ul>\n<li><p><a href=\"https://stackoverflow.com/questions/13476349/check-for-nil-and-nil-interface-in-go\">Check for nil and nil interface in Go</a></p></li>\n<li><p><a href=\"https://groups.google.com/forum/#!topic/golang-nuts/wnH302gBa4I/discussion\" rel=\"nofollow noreferrer\">https://groups.google.com/forum/#!topic/golang-nuts/wnH302gBa4I/discussion</a></p></li>\n</ul>\n"}], "owner": {"reputation": 7696, "user_id": 283975, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/ymiUl.jpg?s=128&g=1", "display_name": "Grozz", "link": "https://stackoverflow.com/users/283975/grozz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1459, "favorite_count": 0, "accepted_answer_id": 43938158, "answer_count": 2, "score": 2, "last_activity_date": 1494594226, "creation_date": 1494591876, "question_id": 43937731, "link": "https://stackoverflow.com/questions/43937731/golang-pass-nil-value-as-an-interface-through-reflection", "title": "Golang pass nil value as an interface through reflection", "body": "<p>I have a function with interface argument:</p>\n\n<pre><code>func f(e error) {\n    if e == nil {\n        fmt.Println(\"YEY! NIL\") // how to get here?\n    } else {\n        fmt.Println(\"NOT NIL :(\")\n    }\n}\n</code></pre>\n\n<p>How do I pass it a nil value via <code>reflect</code> so that it passes <code>== nil</code> check?</p>\n\n<p>Approach 1:</p>\n\n<pre><code>func main() {\n    rf := reflect.ValueOf(f)\n\n    nilArg := reflect.Zero(reflect.TypeOf((error)(nil))) // panic: reflect: Zero(nil)\n\n    rf.Call([]reflect.Value{nilArg})\n}\n</code></pre>\n\n<p>Approach 2:</p>\n\n<pre><code>type MyError struct{}\nfunc (e MyError) Error() string {\n    return \"\"\n}\n\nfunc main() {\n    rf := reflect.ValueOf(f)\n    nilArg := reflect.Zero(reflect.TypeOf(&amp;MyError{})) // NOT NIL :(\n\n    rf.Call([]reflect.Value{nilArg})\n}\n</code></pre>\n\n<p>Second approach doesn't work due to <a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#nil_error</a></p>\n\n<p>Playground: <a href=\"https://play.golang.org/p/V0bMSPcCKI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/V0bMSPcCKI</a></p>\n"}]