[{"tags": ["go", "cross-compiling", "oci8", "cross-build"], "comments": [{"owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "edited": false, "score": 0, "creation_date": 1537413588, "post_id": 52415395, "comment_id": 91777348, "body": "You can&#39;t build with <code>CGO_ENABLED=0</code> if your application calls out to a C library, whether the C library is static or shared. <a href=\"https://blog.madewithdrew.com/post/statically-linking-c-to-go/\" rel=\"nofollow noreferrer\">blog.madewithdrew.com/post/statically-linking-c-to-go</a> seems describe how it can be solved, though I haven&#39;t actually tried it. Your other options are to ensure that users running your application must have the proper libraries installed, or even better,  build a Docker image with app and its dependencies installed and share that."}, {"owner": {"reputation": 401, "user_id": 5890224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e180e1114196c5e0b833975b2f8139?s=128&d=identicon&r=PG&f=1", "display_name": "rjni", "link": "https://stackoverflow.com/users/5890224/rjni"}, "reply_to_user": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "edited": false, "score": 0, "creation_date": 1537919531, "post_id": 52415395, "comment_id": 91956469, "body": "Yes, I had already tried without CGO_ENABLED=0 but it didn&#39;t actually have any effect. I totally agree with you on docker image - but if the usecase had permitted. This is a small application which is supposed to be plug and play rather than having to do a setup."}], "owner": {"reputation": 401, "user_id": 5890224, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e180e1114196c5e0b833975b2f8139?s=128&d=identicon&r=PG&f=1", "display_name": "rjni", "link": "https://stackoverflow.com/users/5890224/rjni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2024, "favorite_count": 1, "answer_count": 0, "score": 3, "last_activity_date": 1538443210, "creation_date": 1537399096, "last_edit_date": 1538443210, "question_id": 52415395, "link": "https://stackoverflow.com/questions/52415395/how-to-statically-link-external-go-libraries", "title": "How to statically link external Go libraries", "body": "<p>I have a small application written in Golang which uses Oci8 for Oracle database connectivity. When I attempt to run the binary built on my Macbook on another Macbook (same OS version), it fails with the following error:</p>\n\n<pre><code>dyld: Library not loaded: @rpath/libclntsh.dylib.12.1\n  Referenced from: /Users/{username_masked}/Documents/gitRepo/UserRevoke/./user_revoke\n  Reason: image not found\nAbort trap: 6\n</code></pre>\n\n<p>I tried to compile with static library as:</p>\n\n<pre><code>go build -a -ldflags '-extldflags \"-static\"' .\n</code></pre>\n\n<p>It fails with following error:</p>\n\n<blockquote>\n  <p>/usr/local/go/pkg/tool/linux_amd64/link: running gcc failed: exit status 1\n  /usr/bin/ld: cannot find -lclntsh\n  collect2: ld returned 1 exit status</p>\n</blockquote>\n\n<p>I then tried to cross-compile as explained at <a href=\"https://stackoverflow.com/questions/16747021/how-do-you-statically-link-a-c-library-in-go-using-cgo\">How do you statically link a c library in go using cgo?</a> </p>\n\n<p>That is,</p>\n\n<pre><code>CGO_ENABLED=0 go build -a -installsuffix cgo -ldflags '-s' user_revoke.go\n</code></pre>\n\n<p>But, it fails with the following error:</p>\n\n<pre><code># github.com/mattn/go-oci8\n/usr/local/go/src/github.com/mattn/go-oci8/oci8_go18.go:13:10: undefined: OCI8Conn\n</code></pre>\n\n<p>In short, I tried multiple arguments. But, all of them either gives dynamically linked binary or fails to compile at all.</p>\n\n<p>I am not even trying to distribute it between multiple Operating systems. What I am trying to do is build this package for an OS, say Mac, so that it runs on any Mac machines without having to explicitly install the library. </p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1537392479, "post_id": 52414108, "comment_id": 91772587, "body": "<a href=\"https://golang.org/ref/spec#Pointer_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Pointer_types</a> and <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Address_operators</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1537395203, "post_id": 52414334, "comment_id": 91773464, "body": "I&#39;m having a little trouble wrapping my head around that first one with the types. Is the purpose of this to just say &quot;this is pointing to an object with this specific type&quot;?"}, {"owner": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "reply_to_user": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "edited": false, "score": 0, "creation_date": 1537395988, "post_id": 52414334, "comment_id": 91773678, "body": "Yes, that is all it does. Prefixing a type expression with <code>*</code> is just the syntax used to say that in Go (and other languages as well)."}], "tags": [], "owner": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "is_accepted": true, "score": 5, "last_activity_date": 1537392679, "last_edit_date": 1537392679, "creation_date": 1537391880, "answer_id": 52414334, "question_id": 52414108, "link": "https://stackoverflow.com/questions/52414108/go-functions-with-mixed-return-signature-types/52414334#52414334", "title": "Go functions with mixed return/signature types", "body": "<p>The <code>*</code> has 2 uses, one for variables and one for types:</p>\n\n<ul>\n<li>For types, it signifies, that the type is a pointer, not a value directly.</li>\n<li>For variables, it dereferences a pointer, as you already know. (One might also distinguish this use into to two \"sub-uses\", as <code>*</code> on the left side of assignments, as in <code>*ptr = val</code> sets the value the pointer is pointing to, while <code>*</code> usually \"retrieves\" the value the pointer is pointing to.)</li>\n</ul>\n\n<p><code>&amp;</code> on the other hand, can only be used for variables and gets the address of an object in memory.</p>\n\n<p>In your examples, the return <strong>type</strong> <code>*TreeNode</code> and the argument <strong>type</strong> <code>*int</code> signify that you are returning/expecting a pointer, according to the use for <em>types</em>. In contrast, <code>*xPtr = 0</code> dereferences the <strong>variable</strong> <code>xPtr</code>.</p>\n\n<p>To know which use is the correct one in your situation, you must make clear to yourself whether you are dealing with a type or a variable.</p>\n\n<p>For a technical description, you can read the sections of the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">language specifications</a> on <a href=\"https://golang.org/ref/spec#Pointer_types\" rel=\"nofollow noreferrer\">Pointer types</a> and <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">Address operators</a>.</p>\n"}], "owner": {"reputation": 2884, "user_id": 3658166, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/X8dHk.png?s=128&g=1", "display_name": "ninesalt", "link": "https://stackoverflow.com/users/3658166/ninesalt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 79, "favorite_count": 0, "accepted_answer_id": 52414334, "answer_count": 1, "score": 1, "last_activity_date": 1537421467, "creation_date": 1537390603, "last_edit_date": 1537421467, "question_id": 52414108, "link": "https://stackoverflow.com/questions/52414108/go-functions-with-mixed-return-signature-types", "title": "Go functions with mixed return/signature types", "body": "<p>I'm trying to figure out how pointers work in Go and I think I'm starting to get it, but this is confusing me and I don't really know what to search for. Let's say I have the following function:</p>\n\n<pre><code>func createNode(nodeInfo string) *TreeNode {\n    return &amp;TreeNode{info: nodeInfo}\n}\n</code></pre>\n\n<p>I understand that the function is returning the memory address of the created struct instance, but how does the function signature say <code>*TreeNode</code>? According to my understanding, the <code>*</code> is used to dereference pointers to get the value itself, so what is happening here?</p>\n\n<p>Also, here:</p>\n\n<pre><code> func zero(xPtr *int) {\n  *xPtr = 0\n}\n\nfunc main() {\n  x := 5\n  zero(&amp;x)\n}\n</code></pre>\n\n<p>The opposite is happening where the function is accepting an argument with the <code>*</code> operator but the function itself is being called with <code>&amp;</code> operator. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 4, "creation_date": 1537388243, "post_id": 52413551, "comment_id": 91770928, "body": "I&#39;m unable to reproduce your problem. As it stands, this code does what you want it to. I removed the print statements."}, {"owner": {"reputation": 99, "user_id": 9135554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddcd4c670ac9b36aac69a39aa688aae?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/9135554/mark"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1537388625, "post_id": 52413551, "comment_id": 91771074, "body": "@squiguy strange, i&#39;m using the go playground and it still does this"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 1, "creation_date": 1537388685, "post_id": 52413551, "comment_id": 91771100, "body": "I see it waits when it runs in terminal and it does not wait on playground."}, {"owner": {"reputation": 99, "user_id": 9135554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddcd4c670ac9b36aac69a39aa688aae?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/9135554/mark"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1537388804, "post_id": 52413551, "comment_id": 91771153, "body": "@squiguy here is the code that ends abruptly <a href=\"https://play.golang.org/p/j3jUWuJr6VB\" rel=\"nofollow noreferrer\">play.golang.org/p/j3jUWuJr6VB</a> and here is the code that waits 10 seconds <a href=\"https://play.golang.org/p/L_WlXRGUcU9\" rel=\"nofollow noreferrer\">play.golang.org/p/L_WlXRGUcU9</a>"}, {"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 1, "creation_date": 1537389221, "post_id": 52413551, "comment_id": 91771342, "body": "I&#39;m fairly certain the playground has a sandboxed environment so it will limit execution time. Try waiting for one second."}, {"owner": {"reputation": 99, "user_id": 9135554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddcd4c670ac9b36aac69a39aa688aae?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/9135554/mark"}, "reply_to_user": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1537389459, "post_id": 52413551, "comment_id": 91771438, "body": "@squiguy <a href=\"https://play.golang.org/p/EesYvQWvMrW\" rel=\"nofollow noreferrer\">play.golang.org/p/EesYvQWvMrW</a> yeah it&#39;s still not waiting. But okay it seems it&#39;s a bug with playground just wanted to make sure I wasn&#39;t misunderstanding something completely... Thanks for your help"}, {"owner": {"reputation": 1844, "user_id": 4844024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9de342e1ce408f4874eac3f019efb33?s=128&d=identicon&r=PG&f=1", "display_name": "mad.meesh", "link": "https://stackoverflow.com/users/4844024/mad-meesh"}, "edited": false, "score": 0, "creation_date": 1537389695, "post_id": 52413551, "comment_id": 91771552, "body": "yes this is an issue with the go playground.. i created a main.go on my local machine and the code works as expected sans all the fmt calls."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 5, "creation_date": 1537390365, "post_id": 52413551, "comment_id": 91771837, "body": "Technically, it&#39;s a &quot;feature&quot; of the playground. When everything is blocked waiting on time in the playground, time will artificially advance until things unblock... or it decides things are deadlocked. See &quot;Faking Time&quot; section in the playground article <a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">blog.golang.org/playground</a>"}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1537390546, "post_id": 52413551, "comment_id": 91771906, "body": "@RayfenWindspear Your comment should be promoted to answer."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 0, "creation_date": 1537390702, "post_id": 52413551, "comment_id": 91771959, "body": "@Grzegorz\u017bur That can be arranged..."}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 5, "last_activity_date": 1537390829, "last_edit_date": 1537390829, "creation_date": 1537390755, "answer_id": 52414140, "question_id": 52413551, "link": "https://stackoverflow.com/questions/52413551/confused-about-blocking-channels/52414140#52414140", "title": "Confused about blocking channels", "body": "<p>Technically, it's a \"feature\" of the playground. When everything is blocked waiting on time in the playground, time will artificially advance until things unblock... or it decides things really are deadlocked. See \"Faking Time\" section in the <a href=\"https://blog.golang.org/playground#TOC_3.1.\" rel=\"nofollow noreferrer\">Golang Playground article</a>. </p>\n"}], "owner": {"reputation": 99, "user_id": 9135554, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ddcd4c670ac9b36aac69a39aa688aae?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/9135554/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 52414140, "answer_count": 1, "score": 1, "last_activity_date": 1537421629, "creation_date": 1537388000, "last_edit_date": 1537421629, "question_id": 52413551, "link": "https://stackoverflow.com/questions/52413551/confused-about-blocking-channels", "title": "Confused about blocking channels", "body": "<p>I have this block of code that is supposed to wait 10 seconds before the program exits, but it only works if I add some sort of print something for it afterwards. Why is that? I want it to wait 10 seconds without having to uncomment that print statement. </p>\n\n<pre><code>func main() {\n\n  forever := make(chan bool)\n  go func() {\n    fmt.Println(\"why\")\n    time.Sleep(10*time.Second)\n    //fmt.Println(\"here\")\n    forever &lt;- false\n  }()\n  fmt.Println(\"forever\")\n  &lt;- forever\n\n}\n</code></pre>\n\n<p>This also works:</p>\n\n<pre><code>func main() {\n\n  forever := make(chan bool)\n  go func() {\n    fmt.Println(\"why\")\n    time.Sleep(10*time.Second)\n    forever &lt;- false\n  }()\n  fmt.Println(&lt;- forever)\n\n}\n</code></pre>\n\n<hr>\n\n<p>The following program does not wait for 10 seconds when it is run in Go playground:</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n)\n\nfunc main() {\n    forever := make(chan bool)\n    go func() {\n        time.Sleep(10 * time.Second)\n        forever &lt;- false\n    }()\n    &lt;-forever\n}\n</code></pre>\n"}, {"tags": ["c++", "go", "benchmarking"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1537382843, "post_id": 52412334, "comment_id": 91768473, "body": "Any reason you are using Go 1.7.1 instead of a more recent version (and not even the patched version of 1.7)? 1.11 was released about a month ago. <a href=\"https://golang.org/doc/devel/release.html\" rel=\"nofollow noreferrer\">golang.org/doc/devel/release.html</a>"}, {"owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "edited": false, "score": 2, "creation_date": 1537383074, "post_id": 52412334, "comment_id": 91768588, "body": "What happens if you change the for loop in the C++ code to <code>Node a(d); c += a.Check();</code>?"}, {"owner": {"reputation": 1034, "user_id": 2089648, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b29d87d89de9c1abac217464e57b191?s=128&d=identicon&r=PG", "display_name": "user2089648", "link": "https://stackoverflow.com/users/2089648/user2089648"}, "edited": false, "score": 0, "creation_date": 1537383133, "post_id": 52412334, "comment_id": 91768608, "body": "None other than being lazy. The test was performed on my laptop, usually not coding much here - hence never updated."}, {"owner": {"reputation": 8002, "user_id": 1143850, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2927fac544c9960cd5433688fe4cae1d?s=128&d=identicon&r=PG", "display_name": "Serge", "link": "https://stackoverflow.com/users/1143850/serge"}, "edited": false, "score": 0, "creation_date": 1537383413, "post_id": 52412334, "comment_id": 91768726, "body": "or do not delete &#39;a&#39; at all."}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 1, "creation_date": 1537383727, "post_id": 52412334, "comment_id": 91768862, "body": "It shouldn&#39;t make a huge difference, but why did you let go make a 64-bit executable (more registers available, native <code>uint64_t</code>) while you used MinGW-32 to make a 32-bit executable (<code>uint64_t</code> takes multiple instructions, fewer registers and less-efficient stack-args calling conventions, but smaller pointers = smaller cache footprint)?  At least you enabled <code>-O2</code> optimization for MinGW.  <code>-O3 -march=native</code> might be interesting but probably won&#39;t make a difference.  <code>uint64_t</code> math is probably not a major bottleneck, but store/reload might be adding latency in a critical dependency chain."}, {"owner": {"reputation": 1381, "user_id": 4381807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/i4GHo.gif?s=128&g=1", "display_name": "Anty", "link": "https://stackoverflow.com/users/4381807/anty"}, "edited": false, "score": 0, "creation_date": 1537386011, "post_id": 52412334, "comment_id": 91769919, "body": "Out of curiosity - on what CPU it was tested?"}], "answers": [{"comments": [{"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1552003068, "post_id": 55041746, "comment_id": 96858889, "body": "Are you timing a debug build with C++?  Or was <code>cmake-build-debug&#47;main</code> actually built with <code>-O3</code>?  Also note that your Go benchmark kept 2 CPU cores busy for the whole run time.  That seems surprising."}, {"owner": {"reputation": 5149, "user_id": 1689770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/78b5dcbdd9f67f569c6102e091faafeb?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/1689770/jonathan"}, "reply_to_user": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1552011359, "post_id": 55041746, "comment_id": 96860694, "body": "@PeterCordes it was a debug build, but once I saw it was exceptionally faster I didn&#39;t bother to optimize further. I just wanted to verify it was possible"}, {"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1552019842, "post_id": 55041746, "comment_id": 96862449, "body": "Timing debug builds is meaningless.  We have no idea how much faster a normal build of either the C++ or the Go versions would be."}], "tags": [], "owner": {"reputation": 5149, "user_id": 1689770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/78b5dcbdd9f67f569c6102e091faafeb?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/1689770/jonathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1551955110, "creation_date": 1551955110, "answer_id": 55041746, "question_id": 52412334, "link": "https://stackoverflow.com/questions/52412334/binary-tree-benchmark-results/55041746#55041746", "title": "Binary tree benchmark results", "body": "<p>It's something with your computer your ran on, because I'm getting the expected result where C++ is twice as fast as go.</p>\n\n<p>C++</p>\n\n<pre><code>time cmake-build-debug/main\n2097152 trees of depth 4 check: 65011681\n524288 trees of depth 6 check: 66584449\n131072 trees of depth 8 check: 66977281\n32768 trees of depth 10 check: 67074049\n8192 trees of depth 12 check: 67092481\n2048 trees of depth 14 check: 67074049\n512 trees of depth 16 check: 66977281\n128 trees of depth 18 check: 66584449\n32 trees of depth 20 check: 65011681\ncmake-build-debug/main  21.09s user 0.02s system 99% cpu 21.113 total\n</code></pre>\n\n<p>GO</p>\n\n<pre><code> jonny@skyhawk \ue0b0 ~/Projects/benchmark \ue0b0 time ./main           \ue0b2 \u2714 \ue0b2 2604 \ue0b2 02:34:29 \n2097152  trees of depth  4  check:  65011681\n524288  trees of depth  6  check:  66584449\n131072  trees of depth  8  check:  66977281\n32768  trees of depth  10  check:  67074049\n8192  trees of depth  12  check:  67092481\n2048  trees of depth  14  check:  67074049\n512  trees of depth  16  check:  66977281\n128  trees of depth  18  check:  66584449\n32  trees of depth  20  check:  65011681\n./main  48.72s user 0.52s system 197% cpu 24.905 total\n</code></pre>\n\n<p>I built the C++ main.cpp with CLion's mose basic / default settings (this CMakeLists.txt that will build a <code>main.cpp</code>)</p>\n\n<pre><code>cmake_minimum_required(VERSION 3.3)\nproject(test_build)\n\nset(CMAKE_CXX_FLAGS \"${CMAKE_CXX_FLAGS} -std=c++11\")\n\nset(BUILD_1 main)\nset(SOURCE_FILES_1 main.cpp)\nadd_executable(${BUILD_1} ${SOURCE_FILES_1})\n</code></pre>\n"}], "owner": {"reputation": 1034, "user_id": 2089648, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/8b29d87d89de9c1abac217464e57b191?s=128&d=identicon&r=PG", "display_name": "user2089648", "link": "https://stackoverflow.com/users/2089648/user2089648"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 433, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1551955110, "creation_date": 1537382529, "question_id": 52412334, "link": "https://stackoverflow.com/questions/52412334/binary-tree-benchmark-results", "title": "Binary tree benchmark results", "body": "<p>I stumbled upon <a href=\"https://benchmarksgame-team.pages.debian.net/benchmarksgame/faster/go-gpp.html\" rel=\"nofollow noreferrer\">a website making benchmakrs</a>.\nIn this case Golang vs C++, binary trees.</p>\n\n<p>The C++ solution does A LOT better than golang using allocation of a memory pool. \nI can get behind that but wondered how an implementation without that would fare. So I modified it to look more like the Golang-Code and removed concurrency for both.</p>\n\n<p>In this example and on my machine the golang code runs in around 24 seconds.\nThe C++ code takes an average of 126 seconds. I did not expect this result at all. I expected C++ to still be faster or maybe be a bit slower but not by a factor of 5.</p>\n\n<p>Did I make some huge mistake? Or do you know the reason for this? Code for both programs is below:</p>\n\n<p>Built with: </p>\n\n<blockquote>\n  <p>mingw32-g++.exe -Wall -fexceptions -O2  -c D:\\TMP\\Test\\main.cpp -o\n  obj\\Release\\main.o\n  mingw32-g++.exe  -o bin\\Release\\Test.exe obj\\Release\\main.o  -s</p>\n</blockquote>\n\n<pre><code>#include &lt;iostream&gt;\n\nusing namespace std;\n\nclass Node {\npublic:\n    Node(uint64_t d);\n    ~Node();\n    int Check();\nprivate:\n    Node* l;\n    Node* r;\n};\n\nNode::Node(uint64_t d){\n    if (d &gt; 0){\n        l = new Node(d - 1);\n        r = new Node(d - 1);\n    } else {\n        l = 0;\n        r = 0;\n    }\n}\n\nNode::~Node(){\n    if(l){\n        delete l;\n        delete r;\n    }\n}\n\nint Node::Check(){\n    if (l) {\n        return l-&gt;Check() + 1 + r-&gt;Check();\n    } else {\n        return 1;\n    }\n}\n\nint main()\n{\n    uint64_t min_depth = 4;\n    uint64_t max_depth = 21;\n    for (uint64_t d = min_depth; d &lt;= max_depth; d += 2) {\n        uint64_t iterations = 1 &lt;&lt; (max_depth - d + min_depth);\n        uint64_t c = 0;\n        for (uint64_t i = 1; i &lt; iterations; i++) {\n            Node* a = new Node(d);\n            c += a-&gt;Check();\n            delete a; // I tried commenting this line but it made no big impact\n        }\n        cout &lt;&lt; iterations &lt;&lt; \" trees of depth \" &lt;&lt; d &lt;&lt; \" check: \" &lt;&lt; c &lt;&lt; \"\\n\";\n    }\n    return 0;\n}\n</code></pre>\n\n<p>Golang:</p>\n\n<blockquote>\n  <p>go version go1.7.1 windows/amd64</p>\n</blockquote>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n)\n\ntype Node struct {\n    l *Node\n    r *Node\n}\n\nfunc (n *Node) check() int {\n    if n.l != nil {\n        return n.l.check() + 1 + n.r.check()\n    } else {\n        return 1\n    }\n}\n\nfunc make(d uint) *Node {\n    root := new(Node)\n    if d &gt; 0 {\n        root.l = make(d-1)\n        root.r = make(d-1)\n    }\n    return root\n}\n\nfunc main(){\n    min_depth := uint(4)\n    max_depth := uint(21)\n    for d := min_depth; d &lt;= max_depth; d += 2 {\n        iterations := 1 &lt;&lt; (max_depth - d + min_depth)\n        c := 0\n        for i := 1; i &lt; iterations; i++ {\n            a := make(d)\n            c += a.check()\n        }\n        fmt.Println(iterations, \" trees of depth \", d, \" check: \", c)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1403, "user_id": 3923424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7290a8da460efc02e096d4de444bc13?s=128&d=identicon&r=PG&f=1", "display_name": "R2B2", "link": "https://stackoverflow.com/users/3923424/r2b2"}, "edited": false, "score": 0, "creation_date": 1537382762, "post_id": 52412220, "comment_id": 91768421, "body": "Exactly what I was looking for (although I feel really stupid now). Thanks!"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 3, "last_activity_date": 1537382050, "creation_date": 1537382050, "answer_id": 52412220, "question_id": 52411946, "link": "https://stackoverflow.com/questions/52411946/a-flexible-and-elegant-way-to-sort-slices-of-struct-in-go/52412220#52412220", "title": "A flexible and elegant way to sort slices of struct in Go", "body": "<p>Write sort a sort function for each ordering and call from f1, f2 and f3 as appropriate:</p>\n\n<pre><code>func sortByX0AscX1Desc(s []MySuperType) {\n    sort.Slice(s, func(i, j int) bool {\n        switch {\n        case s[i].x0 &lt; s[j].x0:\n            return true\n        case s[i].x0 &gt; s[j].x0:\n            return false\n        case s[i].x1 &gt; s[j].x1:\n            return true\n        default:\n            return false\n        }\n    })\n}\n\nfunc f1(mySuperSlice []MySuperType) {\n    sortByX0AscX1Desc(mySuperSlice)\n    // do something with the sorted list\n}\nfunc f2(mySuperSlice []MySuperType) {\n    sortBySomethingElse(mySuperSlice)\n    // do something with the sorted list\n}\nfunc f3(mySuperSlice []MySuperType) {\n    sortByX0AscX1Desc(mySuperSlice)\n    // do something with the sorted list\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1403, "user_id": 3923424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7290a8da460efc02e096d4de444bc13?s=128&d=identicon&r=PG&f=1", "display_name": "R2B2", "link": "https://stackoverflow.com/users/3923424/r2b2"}, "edited": false, "score": 0, "creation_date": 1537383490, "post_id": 52412444, "comment_id": 91768755, "body": "This is very nice! Hurray for functional programming."}, {"owner": {"reputation": 358, "user_id": 6267238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53d46b675ae20a5956ccc01ec32faa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Carlson", "link": "https://stackoverflow.com/users/6267238/jason-carlson"}, "reply_to_user": {"reputation": 1403, "user_id": 3923424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7290a8da460efc02e096d4de444bc13?s=128&d=identicon&r=PG&f=1", "display_name": "R2B2", "link": "https://stackoverflow.com/users/3923424/r2b2"}, "edited": false, "score": 1, "creation_date": 1537384510, "post_id": 52412444, "comment_id": 91769218, "body": "One nice thing about this method is you can reuse the functions to generate <code>less</code> arguments for other functions in the <code>sort</code> package, like <code>SliceIsSorted</code>."}], "tags": [], "owner": {"reputation": 358, "user_id": 6267238, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53d46b675ae20a5956ccc01ec32faa6?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Carlson", "link": "https://stackoverflow.com/users/6267238/jason-carlson"}, "is_accepted": true, "score": 2, "last_activity_date": 1537382985, "creation_date": 1537382985, "answer_id": 52412444, "question_id": 52411946, "link": "https://stackoverflow.com/questions/52411946/a-flexible-and-elegant-way-to-sort-slices-of-struct-in-go/52412444#52412444", "title": "A flexible and elegant way to sort slices of struct in Go", "body": "<p>@ThunderCat's solution will work. Another option would be to write functions that return <strong>closures</strong> over the slice that match the signature for the <code>less</code> argument of <code>sort.Slice</code>:</p>\n\n<pre><code>func ascX0DescX1(s []MySuperType) (func(int, int) bool) {\n    return func(i, j int) bool {\n        if s[i].x0 == s[j].x0 {\n            return s[i].x1 &gt; s[j].x1\n        }\n        return s[i].x0 &lt; s[j].x0\n    }\n}\n</code></pre>\n\n<p>Then pass that as the <code>less</code> arg to <code>sort.Slice</code>:</p>\n\n<pre><code>sort.Slice(mySuperSlice, ascX0DescX1(mySuperSlice))\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 822, "user_id": 2143547, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5e103e042e03b436cb90826b940d9f1?s=128&d=identicon&r=PG", "display_name": "chriopp", "link": "https://stackoverflow.com/users/2143547/chriopp"}, "is_accepted": false, "score": 0, "last_activity_date": 1537508126, "last_edit_date": 1537508126, "creation_date": 1537383987, "answer_id": 52412689, "question_id": 52411946, "link": "https://stackoverflow.com/questions/52411946/a-flexible-and-elegant-way-to-sort-slices-of-struct-in-go/52412689#52412689", "title": "A flexible and elegant way to sort slices of struct in Go", "body": "<p>You could also omit the extra function and call sort where you need it.  </p>\n\n<pre><code>type MySuperType struct {\n    x0, x1, x2, x3 string\n}\n\nfunc f1() {\n    fields := []MySuperType {\n        { \"a1\", \"b4\", \"c3\", \"d2\" },\n        { \"a2\", \"b1\", \"c2\", \"d3\" },\n        { \"a3\", \"b1\", \"c4\", \"d1\" },\n        { \"a4\", \"b3\", \"c1\", \"d4\" },\n    }\n    sort.SliceStable(fields, func(i, j int) bool {\n        return fields[i].x1 &lt; fields[j].x1 || fields[i].x2 &gt; fields[j].x2\n    })\n    fmt.Println(\"by x1, then x2: \", fields)\n}\n</code></pre>\n\n<p>Result: \nby x1, then x2:  [{a3 b1 c4 d1} {a2 b1 c2 d3} {a4 b3 c1 d4} {a1 b4 c3 d2}]</p>\n"}], "owner": {"reputation": 1403, "user_id": 3923424, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/b7290a8da460efc02e096d4de444bc13?s=128&d=identicon&r=PG&f=1", "display_name": "R2B2", "link": "https://stackoverflow.com/users/3923424/r2b2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 1, "closed_date": 1537417899, "accepted_answer_id": 52412444, "answer_count": 3, "score": 1, "last_activity_date": 1537508126, "creation_date": 1537380915, "question_id": 52411946, "link": "https://stackoverflow.com/questions/52411946/a-flexible-and-elegant-way-to-sort-slices-of-struct-in-go", "closed_reason": "Opinion-based", "title": "A flexible and elegant way to sort slices of struct in Go", "body": "<p>Let us say that we have a fairly complicated <code>struct</code> with numerous fields, that I need to sort in several places according to different criteria, e.g.</p>\n\n<pre><code>type MySuperType struct {\n    x0, x1, x2, x3 xType\n    // possibly even more fields\n}\n// sort 1: ascending x0, then descending x1, then more stuff\n// sort 2: if x4==0 then applyCriteria2a else applyCriteria2b\n\nfunc f1(mySuperSlice []MySuperType) {\n    // sort 'myList' according sort #1\n    // do something with the sorted list\n}\nfunc f2(mySuperSlice []MySuperType) {\n    // sort 'myList' according sort #2\n    // do something with the sorted list\n}\nfunc f3(mySuperSlice []MySuperType) {\n    // sort 'myList' according sort #1, note: we use sort #1 again!\n    // do something with the sorted list\n}\n</code></pre>\n\n<p><strong>Proposed solution 1:</strong><br>\nCreate a new type (alias of <code>[]MySuperType</code>) that implements <code>sort.Interface</code> for each sorting criteria required.<br>\nProblems:\n(i) there is some duplicated code, as the functions <code>Len</code> and <code>Swap</code> are going to be identical\n(ii) there is going to be a bunch of new types lying around that do not help with the overall readability of the program --- these new types don't really represent anything, plus the only thing that really matters is the <code>Less</code> function.</p>\n\n<p><strong>Proposed solution 2:</strong><br>\nUse <code>sort.Slice</code><br>\nIt would be the perfect solution (see <a href=\"https://stackoverflow.com/a/42872183/3923424\">this answer</a>), but from my understanding, the sorting function has to be specified inline (I get an error <code>invalid receiver type []T ([]T is an unnamed type)</code> when I tried to define it elsewhere, which means that I need to define an alias for <code>[]T</code> and we are back to solution 1).<br>\nNow, the problem with defining the function inline is that (i) given the complexity of <code>MySuperType</code>, the function can be very long and (ii) the functions are going to be duplicated in several place (e.g. in <code>f1</code> and <code>f3</code> in my example above) -- much more annoying that in solution 1 as the sorting functions can be long and complex.<br>\n<sub>Note: (i) would not be that much of an issue if we did not have (ii) actually</sub></p>\n\n<p><strong>Question:</strong><br>\nGiven my current understanding and knowledge of Go, I would use solution 1.<br>\nBut does anyone knows a different approach that elegantly solves this problem or suggestions to improve the drawbacks listed above?</p>\n"}, {"tags": ["go", "zip", "zipfile"], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 2, "last_activity_date": 1537382261, "last_edit_date": 1537382261, "creation_date": 1537381204, "answer_id": 52412004, "question_id": 52411569, "link": "https://stackoverflow.com/questions/52411569/zip-a-folder-of-files-with-golang-creates-a-broken-zip/52412004#52412004", "title": "zip a folder of files with golang creates a broken zip", "body": "<p>You need to list and zip the <strong>files</strong>, not the directories. Simply make this adjustment to ignore directories in your <code>listFiles</code> function.</p>\n\n<pre><code>if !info.IsDir() {\n    files = append(files, path)\n}\n</code></pre>\n"}], "owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1727, "favorite_count": 0, "accepted_answer_id": 52412004, "answer_count": 1, "score": 1, "last_activity_date": 1600354973, "creation_date": 1537379316, "last_edit_date": 1537379595, "question_id": 52411569, "link": "https://stackoverflow.com/questions/52411569/zip-a-folder-of-files-with-golang-creates-a-broken-zip", "title": "zip a folder of files with golang creates a broken zip", "body": "<p>how do I zip files in a folder with sub-directories correctly.</p>\n\n<p>I have a local folder with following structure:</p>\n\n<pre><code>folder/hello/\nfolder/hello/world/\nfolder/hello/world/helloword.txt\nfolder/index.txt\n</code></pre>\n\n<p>this is my code: </p>\n\n<pre><code>package main\n\nimport (\n    \"archive/zip\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"path/filepath\"\n)\n\nfunc main() {\n\n    files, err := listFiles(\"./folder\")\n    if err != nil {\n        panic(err)\n    }\n\n    zipMe(files, \"test.zip\")\n\n    for _, f := range files {\n        fmt.Println(f)\n    }\n    fmt.Println(\"Done!\")\n}\n\nfunc listFiles(root string) ([]string, error) {\n    var files []string\n\n    err := filepath.Walk(root, func(path string, info os.FileInfo, err error) error {\n        files = append(files, path)\n        return nil\n    })\n    if err != nil {\n        return nil, err\n    }\n    return files, nil\n\n}\n\nfunc zipMe(filepaths []string, target string) error {\n\n    flags := os.O_WRONLY | os.O_CREATE | os.O_TRUNC\n    file, err := os.OpenFile(target, flags, 0644)\n\n    if err != nil {\n        return fmt.Errorf(\"Failed to open zip for writing: %s\", err)\n    }\n    defer file.Close()\n\n    zipw := zip.NewWriter(file)\n    defer zipw.Close()\n\n    for _, filename := range filepaths {\n        if err := addFileToZip(filename, zipw); err != nil {\n            return fmt.Errorf(\"Failed to add file %s to zip: %s\", filename, err)\n        }\n    }\n    return nil\n\n}\n\nfunc addFileToZip(filename string, zipw *zip.Writer) error {\n    file, err := os.Open(filename)\n\n    if err != nil {\n        return fmt.Errorf(\"Error opening file %s: %s\", filename, err)\n    }\n    defer file.Close()\n\n    wr, err := zipw.Create(filename)\n    if err != nil {\n\n        return fmt.Errorf(\"Error adding file; '%s' to zip : %s\", filename, err)\n    }\n\n    if _, err := io.Copy(wr, file); err != nil {\n        return fmt.Errorf(\"Error writing %s to zip: %s\", filename, err)\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>This creates a broken zip which can not be extracted (I am running on mac os but this should not make a difference).\nI also tried several other examples from stackoverflow and links found through google, but I do always get a broken zip. I get a zip with 135 bytes when I extract it I get 1 binary file with 0 bytes). </p>\n\n<p>It would be great if someone could help me to find out what I am missing here.</p>\n\n<p>Thx</p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 4, "creation_date": 1537376368, "post_id": 52410830, "comment_id": 91765373, "body": "That&#39;s a design decision made by the Go development team, you&#39;d have to ask them."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1537376461, "post_id": 52410830, "comment_id": 91765415, "body": "It reports the failures by test name, and that&#39;s how test names are formatted. As for why, maybe because it&#39;s easier to reference names without spaces in the cli?"}, {"owner": {"reputation": 393, "user_id": 10256932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-krXOS_EoYXs/AAAAAAAAAAI/AAAAAAAAAAc/hhfX3zJyl6E/photo.jpg?sz=128", "display_name": "Ben Johnson", "link": "https://stackoverflow.com/users/10256932/ben-johnson"}, "edited": false, "score": 0, "creation_date": 1537463761, "post_id": 52410830, "comment_id": 91803828, "body": "I wonder if it would be good to reject calls to t.Run() where the name parameter has spaces in it. Maybe that&#39;s just a style thing and shouldn&#39;t be enforced."}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 3, "last_activity_date": 1537421846, "last_edit_date": 1537421846, "creation_date": 1537377962, "answer_id": 52411265, "question_id": 52410830, "link": "https://stackoverflow.com/questions/52410830/why-does-the-golang-testing-package-replace-spaces-with-underscores-when-reporti/52411265#52411265", "title": "Why does the golang testing package replace spaces with underscores when reporting test failures?", "body": "<p>I found the most definitive answer I could, in the code itself, of course. The <code>rewrite</code> function comment reads</p>\n\n<blockquote>\n  <p>rewrite rewrites a subname to having only printable characters and no white space.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/src/testing/match.go#L133\" rel=\"nofollow noreferrer\">https://golang.org/src/testing/match.go#L133</a></p>\n\n<p>As to why? I'm guessing JimB hit the nail on the head with his comment:</p>\n\n<blockquote>\n  <p>As for why, maybe because it's easier to reference names without spaces in the cli? </p>\n</blockquote>\n\n<p>White spaces are bad for cli.</p>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1537467788, "post_id": 52413006, "comment_id": 91805795, "body": "Nice find! This seems like something that <i>should</i> be in the documentation. Then again, they probably consider blog.golang.org to be part of the documentation."}], "tags": [], "owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "is_accepted": true, "score": 2, "last_activity_date": 1537385398, "creation_date": 1537385398, "answer_id": 52413006, "question_id": 52410830, "link": "https://stackoverflow.com/questions/52410830/why-does-the-golang-testing-package-replace-spaces-with-underscores-when-reporti/52413006#52413006", "title": "Why does the golang testing package replace spaces with underscores when reporting test failures?", "body": "<p>It's explained in this blog post: <a href=\"https://blog.golang.org/subtests\" rel=\"nofollow noreferrer\">https://blog.golang.org/subtests</a></p>\n\n<blockquote>\n  <p>The full name of a subtest or sub-benchmark is a slash-separated list of its name and the names of all of its parents, starting with the top-level. The name is the corresponding function name for top-level tests and benchmarks, and the first argument to Run otherwise. To avoid display and parsing issues, a name is sanitized by replacing spaces with underscores and escaping non-printable characters. The same sanitizing is applied to the regular expressions passed to the -run or -bench flags.</p>\n</blockquote>\n\n<p>Some examples could be to make it simpler for automated tools to process the test output, to avoid issues with the shell making regex arguments containing spaces appearing as multiple arguments etc. I'd rather avoid using spaces than deal with this magic renaming.</p>\n"}], "owner": {"reputation": 393, "user_id": 10256932, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-krXOS_EoYXs/AAAAAAAAAAI/AAAAAAAAAAc/hhfX3zJyl6E/photo.jpg?sz=128", "display_name": "Ben Johnson", "link": "https://stackoverflow.com/users/10256932/ben-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 211, "favorite_count": 1, "accepted_answer_id": 52413006, "answer_count": 2, "score": 1, "last_activity_date": 1537421846, "creation_date": 1537376169, "question_id": 52410830, "link": "https://stackoverflow.com/questions/52410830/why-does-the-golang-testing-package-replace-spaces-with-underscores-when-reporti", "title": "Why does the golang testing package replace spaces with underscores when reporting test failures?", "body": "<p>When I run this test and it fails:</p>\n\n<pre><code>func TestCaseA(t *testing.T){\n    t.Run(\"my name with spaces\", func (t *testing.T){\n        t.Error(\"some error message\")\n    })\n}\n</code></pre>\n\n<p>then the name of the test is modified (spaces are changed to underscores) in the output:</p>\n\n<pre><code>--- FAIL: TestCaseA (0.00s)\n    --- FAIL: TestCaseA/my_name_with_spaces (0.00s)\n        main.go:10: some error message\nFAIL\n</code></pre>\n\n<p>Why does it do this?</p>\n\n<p>Here's a working example: <a href=\"https://play.golang.org/p/viZjC60Dazg\" rel=\"nofollow noreferrer\">https://play.golang.org/p/viZjC60Dazg</a></p>\n"}, {"tags": ["docker", "go", "google-cloud-platform", "google-cloud-build"], "answers": [{"tags": [], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "is_accepted": true, "score": 1, "last_activity_date": 1548610194, "creation_date": 1548610194, "answer_id": 54390903, "question_id": 52410487, "link": "https://stackoverflow.com/questions/52410487/how-to-build-a-docker-image-using-cloud-build-with-sdk-in-local-machine-without/54390903#54390903", "title": "How to build a docker image using cloud build with sdk, in local machine without dying trying it", "body": "<p>For users with the same trouble, the big problem is go dependecies \nargs: ['install', 'me/backend'] \n\"install\" was the bottleneck that stoped me to acomplish the build, for some reason, \"install\" does not fetch all dependencies, you need to fetch all dependencies first with this:\nargs: ['get','-d','me/backend/...'], obviusly you change \"me/backend\" for your repositorie you want to build.</p>\n\n<p>How is my local repositorie setup:</p>\n\n<p>-----bin</p>\n\n<p>------pkg</p>\n\n<p>------src</p>\n\n<pre><code> --cloud.google.com #dependency\n --contrib.go.opencensus.io #dependency\n --github.com #dependency\n --go.opencensus.io #dependency\n --golang.org #dependency\n --google.golang.org #dependency\n --me #my code\n    --backend\n       .\n       .\n    --deploy\n      cloudbuild.yaml\n      Dockerfile\n</code></pre>\n\n<p>Also I moved all my code at \"src/me\" to <a href=\"https://cloud.google.com/source-repositories\" rel=\"nofollow noreferrer\">google cloud repositories</a></p>\n\n<pre><code>cloudbuild.yaml:\n    steps:\n    - name: 'gcr.io/cloud-builders/gcloud-slim'\n      args: ['source','repos','clone', '[repositorie name]','src/me','--project=[project name]']  #change [repositorie name] and [project name] for your repositorie name and project name respectively\n    - name: 'gcr.io/cloud-builders/go'\n      args: ['get','-d','me/backend/...']\n    - name: 'gcr.io/cloud-builders/go'\n      args: ['install', 'me/backend']\n      env: ['GOPATH=.']\n    - name: 'gcr.io/cloud-builders/docker'\n      args: ['build', '--tag=gcr.io/[project name]/me/backend', '.'] #change [project name] with your project name\n    images: ['gcr.io/[project name]/me/backend'] #change [project name] with your project name \n    artifacts:\n      objects:\n        location: 'gs://[your bucket name]/backend/' #change [your bucket name] for your bucket name\n        paths: ['./bin/backend']\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM alpine\nCOPY bin/backend /backend\nRUN apk update &amp;&amp; apk add ca-certificates &amp;&amp; rm -rf /var/cache/apk/*\nCMD [\"/backend\"]\nRUN chmod 755 /backend\n</code></pre>\n\n<p>In command line you should(taking my local repositorie example):</p>\n\n<pre><code>cd src/me/deploy\ngcloud builds submit .\n</code></pre>\n"}], "owner": {"reputation": 1655, "user_id": 8682074, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1739167192766622/picture?type=large", "display_name": "John Balvin Arias", "link": "https://stackoverflow.com/users/8682074/john-balvin-arias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 321, "favorite_count": 0, "accepted_answer_id": 54390903, "answer_count": 1, "score": 1, "last_activity_date": 1548610194, "creation_date": 1537374776, "question_id": 52410487, "link": "https://stackoverflow.com/questions/52410487/how-to-build-a-docker-image-using-cloud-build-with-sdk-in-local-machine-without", "title": "How to build a docker image using cloud build with sdk, in local machine without dying trying it", "body": "<p>I'm using <a href=\"https://cloud.google.com/cloud-build/\" rel=\"nofollow noreferrer\">cloud build</a> to build a docker image\nGuiding myself from examples provide at <a href=\"https://github.com/GoogleCloudPlatform/cloud-builders/tree/master/go\" rel=\"nofollow noreferrer\">github</a>:</p>\n\n<p>------bin</p>\n\n<p>------pkg</p>\n\n<p>------src</p>\n\n<pre><code>     --cloud.google.com\n     --contrib.go.opencensus.io\n     --github.com\n     --go.opencensus.io\n     --golang.org\n     --google.golang.org\n     --me\n        --backend\n</code></pre>\n\n<p>------cloudbuild.yaml</p>\n\n<p>------Dockerfile</p>\n\n<p>Where all my code is in src -> me -> backend</p>\n\n<p>Cloud build steps .yaml file content is:</p>\n\n<pre><code>    steps:\n- name: 'gcr.io/cloud-builders/go'\n  args: ['install', 'me/backend']\n  env: ['GOPATH=.']\n- name: 'gcr.io/cloud-builders/docker'\n  args: ['build', '--tag=gcr.io/superpack-213022/me/backend', '.']\nimages: ['gcr.io/superpack-213022/me/backend']\n</code></pre>\n\n<p>Docker File:</p>\n\n<pre><code>FROM scratch\n\nCOPY bin/backend /me/backend\n\nENTRYPOINT [\"/me/backend\"]\n</code></pre>\n\n<p>Gives me this error:</p>\n\n<pre><code>can not find a package golang/x/sys/unix in any of ...\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/MPwGD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MPwGD.png\" alt=\"me\"></a></p>\n\n<p>Guiding myself from examples provide at  <a href=\"https://cloud.google.com/cloud-build/docs/quickstart-go\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<p>------bin</p>\n\n<p>------pkg</p>\n\n<p>------src</p>\n\n<pre><code>     --cloud.google.com\n     --contrib.go.opencensus.io\n     --github.com\n     --go.opencensus.io\n     --golang.org\n     --google.golang.org\n     --me\n        --backend\n          cloudbuild.yaml\n          Dockerfile\n</code></pre>\n\n<p>Where all my code is in src -> me -> backend</p>\n\n<p>Cloud build steps .yaml file content is:</p>\n\n<pre><code>    steps:\n- name: 'gcr.io/cloud-builders/go'\n  args: ['install', '.']\n  env: ['GOPATH=backend']\n- name: 'gcr.io/cloud-builders/docker'\n  args: ['build', '--tag=gcr.io/superpack-213022/backend', '.']\nimages: ['gcr.io/superpack-213022/backend']\n</code></pre>\n\n<p>Docker File:</p>\n\n<pre><code>FROM scratch\n\nCOPY bin/backend /backend\n\nENTRYPOINT [\"backend\"]\n</code></pre>\n\n<p>give me this error: \n    \"can not find package me/backend in any of . and\"\n    and a buch of error with the same, it is not able to find my package\n<a href=\"https://i.stack.imgur.com/mgOvT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mgOvT.png\" alt=\"me2\"></a> <a href=\"https://i.stack.imgur.com/dZSt0.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/dZSt0.png\" alt=\"me3\"></a></p>\n\n<p>So anybody knows what is wrong with the configuration? :( </p>\n"}, {"tags": ["go", "google-cloud-platform", "google-cloud-dataflow", "apache-beam"], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 9764465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dJGOJFqhqE4/AAAAAAAAAAI/AAAAAAAAABU/LKJpoepdO-U/photo.jpg?sz=128", "display_name": "daidokoro", "link": "https://stackoverflow.com/users/9764465/daidokoro"}, "is_accepted": true, "score": 4, "last_activity_date": 1538066900, "creation_date": 1538066900, "answer_id": 52541709, "question_id": 52409740, "link": "https://stackoverflow.com/questions/52409740/does-the-current-golang-sdk-for-google-dataflow-support-autoscaling-and-parallel/52541709#52541709", "title": "Does the current GoLang SDK for Google Dataflow support Autoscaling and Parallel Processing?", "body": "<p>Managed to find an answer for this after actually <a href=\"https://github.com/apache/beam/pull/6484\" rel=\"nofollow noreferrer\">creating my own IO package for the Go SDK</a>.</p>\n\n<p><a href=\"https://beam.apache.org/blog/2017/08/16/splittable-do-fn.html\" rel=\"nofollow noreferrer\">SplitableDoFns</a> are not yet available in the Go SDK. This key bit of functionality is what allows the Python and Java SDKs to perform IO operations in parallel and thus, much faster than the Go SDK at scale.</p>\n"}, {"tags": [], "owner": {"reputation": 63788, "user_id": 747579, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Zq3Qi.jpg?s=128&g=1", "display_name": "Abdennour TOUMI", "link": "https://stackoverflow.com/users/747579/abdennour-toumi"}, "is_accepted": false, "score": 1, "last_activity_date": 1616015929, "creation_date": 1616015929, "answer_id": 66681396, "question_id": 52409740, "link": "https://stackoverflow.com/questions/52409740/does-the-current-golang-sdk-for-google-dataflow-support-autoscaling-and-parallel/66681396#66681396", "title": "Does the current GoLang SDK for Google Dataflow support Autoscaling and Parallel Processing?", "body": "<p>Now (GO 1.16) it's built-in :</p>\n<p><a href=\"https://pkg.go.dev/google.golang.org/api/dataflow/v1b3\" rel=\"nofollow noreferrer\">https://pkg.go.dev/google.golang.org/api/dataflow/v1b3</a></p>\n"}], "owner": {"reputation": 66, "user_id": 9764465, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dJGOJFqhqE4/AAAAAAAAAAI/AAAAAAAAABU/LKJpoepdO-U/photo.jpg?sz=128", "display_name": "daidokoro", "link": "https://stackoverflow.com/users/9764465/daidokoro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1726, "favorite_count": 0, "accepted_answer_id": 52541709, "answer_count": 2, "score": 0, "last_activity_date": 1616015929, "creation_date": 1537372069, "question_id": 52409740, "link": "https://stackoverflow.com/questions/52409740/does-the-current-golang-sdk-for-google-dataflow-support-autoscaling-and-parallel", "title": "Does the current GoLang SDK for Google Dataflow support Autoscaling and Parallel Processing?", "body": "<p>Currently utilising the Google Dataflow with Python for batch processing. This works fine, however, I'm interested in getting a bit more speed out of my Dataflow Jobs without having to deal with Java.</p>\n\n<p>Using the Go SDK, I've implemented a simple pipeline that reads a series <em>100-500mb</em> files from Google Storage (using <em><code>textio.Read</code></em>), does some aggregation and updates CloudSQL with the results. The number of files being read can range from dozens to hundreds.</p>\n\n<p>When I run the pipeline, I can see from the logs that files are being read serially, instead of in parallel, as a result the job takes much longer. The same process executed with the Python SDK triggers autoscaling and runs multiple reads within minutes.</p>\n\n<p>I've tried specifying the number of workers using <code>--num_workers=</code>, however, Dataflow scales the job down to one instance after a few minutes and from the logs no parallel reads take place in the time the instance was running.</p>\n\n<p>Something similar happens if I remove the <code>textio.Read</code> and implement a custom DoFn for reading from GCS. The read process is still run serially.</p>\n\n<p>I'm aware the current Go SDK is experimental and lacks many features, however, I haven't found a direct reference to limitations with Parallel processing, <a href=\"https://docs.google.com/document/d/1yj0_hxq2J1iestjFUUrm_BVQLsFxQiiqtcFhgodzIgM/edit#heading=h.mgr8mrx81tnc\" rel=\"nofollow noreferrer\">here</a>. Does the current incarnation of the Go SDK support parallel processing on Dataflow?</p>\n\n<p>Thanks in advance</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 4, "creation_date": 1537372829, "post_id": 52409341, "comment_id": 91763546, "body": "Hello @abdullah. Please, try to Google it before posting a question here. There tons of tutorials on what you are searching for."}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "is_accepted": true, "score": 0, "last_activity_date": 1537371972, "last_edit_date": 1537371972, "creation_date": 1537371641, "answer_id": 52409611, "question_id": 52409341, "link": "https://stackoverflow.com/questions/52409341/how-to-connect-go-with-mysql-to-save-data-and-render-it-again/52409611#52409611", "title": "How to connect Go with MySQL to save data and render it again?", "body": "<p>To work with mysql you have to connect database. So you need some mysql package of golang:</p>\n\n<pre><code>import \"database/sql\"\nimport _ \"github.com/go-sql-driver/mysql\"\n</code></pre>\n\n<p>and then connect database using <code>sql.Open()</code> like below:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"user:password@/dbname\")\n</code></pre>\n\n<p>Now you have handler like register user, first you have to open a template for insert user details and then post those details to handler then get those inputed data on form, then insert with mysql instance <code>db</code>. </p>\n\n<p>Below code shows, how to render template from go handler:</p>\n\n<pre><code>var register = http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"GET\" {\n        t, _ := template.ParseFiles(\"register.html\")\n        t.Execute(w, p)\n    } else {\n        //get posted data here and insert into mysql.\n    }\n\n})\n</code></pre>\n\n<p>For more details please follow the <a href=\"https://astaxie.gitbooks.io/build-web-application-with-golang/en/04.1.html\" rel=\"nofollow noreferrer\">link</a></p>\n"}], "owner": {"reputation": 13, "user_id": 7336228, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fxdIXBMYloc/AAAAAAAAAAI/AAAAAAAAEy0/yrkBzd0E_gE/photo.jpg?sz=128", "display_name": "abdullah mohamed", "link": "https://stackoverflow.com/users/7336228/abdullah-mohamed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "closed_date": 1544893062, "accepted_answer_id": 52409611, "answer_count": 1, "score": -3, "last_activity_date": 1606132135, "creation_date": 1537370742, "last_edit_date": 1606132135, "question_id": 52409341, "link": "https://stackoverflow.com/questions/52409341/how-to-connect-go-with-mysql-to-save-data-and-render-it-again", "closed_reason": "Needs details or clarity", "title": "How to connect Go with MySQL to save data and render it again?", "body": "<p>I need to know how to connect my template-works with Go with MySQL phpMyAdmin to save data in tables and render it somewhere ?</p>\n\n<p>Can any one help me ?</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1537372965, "post_id": 52409271, "comment_id": 91763622, "body": "what happens when you give your existing file change monitor tool the parent dir of all of above code dirs ?"}, {"owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1537373288, "post_id": 52409271, "comment_id": 91763806, "body": "It says no runnable go files are found"}, {"owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "reply_to_user": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1537373323, "post_id": 52409271, "comment_id": 91763824, "body": "I think I might have to write something that basically looks at each package, and on change, reinstalls the package and then restarts the server..."}], "answers": [{"comments": [{"owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "edited": false, "score": 0, "creation_date": 1537411304, "post_id": 52410747, "comment_id": 91776908, "body": "Thank you. Im going to checkout both of those links. I might end up using something generic - doesn&#39;t have to be go and I&#39;m guessing some other language perhaps has solved this problem."}], "tags": [], "owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "is_accepted": false, "score": 1, "last_activity_date": 1537375869, "creation_date": 1537375869, "answer_id": 52410747, "question_id": 52409271, "link": "https://stackoverflow.com/questions/52409271/setting-up-docker-compose-to-watch-for-changes-with-multi-package-golang-project/52410747#52410747", "title": "Setting up docker-compose to watch for changes with multi-package golang project", "body": "<p>I would push back to that <code>fresh</code> repo and ask them</p>\n\n<p>If your file changes are getting saved to git then you could setup a <a href=\"https://github.com/adnanh/webhook\" rel=\"nofollow noreferrer\">webhook like https://github.com/adnanh/webhook</a>  to listen to these <code>git push</code> actions to trigger your rebuild </p>\n\n<p>However if they are just edits then you could roll your own using something like</p>\n\n<p><a href=\"https://github.com/hpcloud/tail\" rel=\"nofollow noreferrer\">https://github.com/hpcloud/tail</a> </p>\n\n<p>to do the functional equivalent to a <code>tail -f</code> on an arbitrary set of files/dirs which I have found to work nicely (my logs trigger a parse daemon for error checking)</p>\n\n<p>but you're right there might be an easier way given your use case</p>\n"}], "owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 560, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1537375869, "creation_date": 1537370538, "question_id": 52409271, "link": "https://stackoverflow.com/questions/52409271/setting-up-docker-compose-to-watch-for-changes-with-multi-package-golang-project", "title": "Setting up docker-compose to watch for changes with multi-package golang project", "body": "<p>I am using a <a href=\"https://github.com/golang-standards/project-layout\" rel=\"nofollow noreferrer\">standard structure</a> for my go application. </p>\n\n<p>It is built like this:</p>\n\n<pre><code>cmd\n  app\n    main.go\ninternal\n  app\n    server.go\n  pkg\n    users\n      ...\npkg\n  dependency\n    ...\nweb\n  app\n    ...\ndocker-compose.yml\nDockerfile\n</code></pre>\n\n<p>The problem however is that with this structure it's very hard to mount and build the application dependencies. For example, it I use a file watcher such as <a href=\"https://github.com/pilu/fresh\" rel=\"nofollow noreferrer\">fresh</a>, it only watches a single directory and runs a particular file. If I update say <code>pkg/dependency</code>, it will not see those changes. </p>\n\n<p>docker-compose looks like:</p>\n\n<pre><code>version: \"3.1\"\n\nservices:\n  core:\n    build: .\n    depends_on:\n      - mongo\n      - memcached\n    ports:\n      - 8080:8080\n    environment:\n      APP_ENV: dev\n    volumes:\n      - .:/go/src/github.com/me/app\n  mongo:\n    image: mongo\n    ports:\n      - 27017:27017\n  memcached:\n    image: memcached\n    ports:\n      - 11211:11211\n</code></pre>\n\n<p>Dockerfile:</p>\n\n<pre><code>FROM golang:1.10.0\n\nWORKDIR /go/src/github.com/me/app\n\nCOPY . .\n\nRUN go get -u github.com/golang/dep/cmd/dep\nRUN dep ensure\n\nWORKDIR /go/src/github.com/me/app/cmd/app/\nRUN go install\nRUN go get github.com/pilu/fresh\n\nCMD [\"fresh\"]\n</code></pre>\n\n<p>Any help?</p>\n"}, {"tags": ["go", "wget"], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 2, "last_activity_date": 1537368393, "creation_date": 1537368393, "answer_id": 52408591, "question_id": 52407835, "link": "https://stackoverflow.com/questions/52407835/how-to-download-and-save-entire-webpage-using-go-lang/52408591#52408591", "title": "how to download and save entire webpage using go lang", "body": "<p>Follow this example: </p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#example_Get\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#example_Get</a></p>\n\n<p>For your next question, try to do the thing, then post your code and an explanation of what went wrong or where you are stuck. </p>\n"}], "owner": {"reputation": 15, "user_id": 9178575, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7b75f57f797cf005832728d419b68d69?s=128&d=identicon&r=PG&f=1", "display_name": "pina-colada", "link": "https://stackoverflow.com/users/9178575/pina-colada"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 771, "favorite_count": 0, "closed_date": 1537371971, "answer_count": 1, "score": -2, "last_activity_date": 1537368393, "creation_date": 1537366071, "question_id": 52407835, "link": "https://stackoverflow.com/questions/52407835/how-to-download-and-save-entire-webpage-using-go-lang", "closed_reason": "Needs more focus", "title": "how to download and save entire webpage using go lang", "body": "<p>I have been using <code>wget</code> for storing locally entire webpage (html, images, css, js files, etc). </p>\n\n<p>How can I accomplish the same using Go Lang?</p>\n"}, {"tags": ["http", "go", "post", "upload"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1537363824, "post_id": 52406709, "comment_id": 91757792, "body": "&quot;I have already tried so many complicated methods with no luck&quot; - can you show what you&#39;ve tried and what issues you ran into?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1537370408, "post_id": 52406709, "comment_id": 91762113, "body": "<a href=\"https://golang.org/pkg/os/#Open\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#Open</a>, <a href=\"https://golang.org/pkg/net/http/#Post\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#Post</a>"}, {"owner": {"reputation": 880, "user_id": 289254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/87de941f49bc84364304a29ceabc15ee?s=128&d=identicon&r=PG&f=1", "display_name": "Ameer", "link": "https://stackoverflow.com/users/289254/ameer"}, "edited": false, "score": 1, "creation_date": 1537371222, "post_id": 52406709, "comment_id": 91762619, "body": "This was it. <code>os.Open</code> This was the missing simplicity that I was looking for. It worked."}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1537375039, "post_id": 52409710, "comment_id": 91764778, "body": "Don&#39;t forget to Close() the file."}, {"owner": {"reputation": 880, "user_id": 289254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/87de941f49bc84364304a29ceabc15ee?s=128&d=identicon&r=PG&f=1", "display_name": "Ameer", "link": "https://stackoverflow.com/users/289254/ameer"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1537387185, "post_id": 52409710, "comment_id": 91770511, "body": "Thanks for the tip. IMHO Go should have some kind of internal checking for un-closed file handles."}], "tags": [], "owner": {"reputation": 880, "user_id": 289254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/87de941f49bc84364304a29ceabc15ee?s=128&d=identicon&r=PG&f=1", "display_name": "Ameer", "link": "https://stackoverflow.com/users/289254/ameer"}, "is_accepted": true, "score": 1, "last_activity_date": 1537644075, "last_edit_date": 1537644075, "creation_date": 1537371961, "answer_id": 52409710, "question_id": 52406709, "link": "https://stackoverflow.com/questions/52406709/simple-http-post-in-go-with-file-upload/52409710#52409710", "title": "Simple HTTP POST in Go with File Upload", "body": "<p>Here is how I did it. Thanks to <a href=\"https://stackoverflow.com/users/603316/peter\">Peter</a> for pointing out <code>os.Open</code> which was the missing piece for me.</p>\n\n<pre><code>func SendPostRequest(url string, filename string) (string, []byte) {\n    api_key := ReadAPIKey(\"../.api_key\")\n    client := &amp;http.Client{}\n    data, err := os.Open(filename)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req, err := http.NewRequest(\"POST\", url, data)\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.SetBasicAuth(\"api\", api_key)\n    resp, err := client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n    content, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return resp.Status, content\n}\n\nfunc main() {\n    status, content := SendPostRequest(\"https://api.example.com/upload\", \"test.jpg\")\n    fmt.Println(status)\n    fmt.Println(string(content))\n}\n</code></pre>\n"}], "owner": {"reputation": 880, "user_id": 289254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/87de941f49bc84364304a29ceabc15ee?s=128&d=identicon&r=PG&f=1", "display_name": "Ameer", "link": "https://stackoverflow.com/users/289254/ameer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3090, "favorite_count": 0, "closed_date": 1537373246, "accepted_answer_id": 52409710, "answer_count": 1, "score": -3, "last_activity_date": 1537644075, "creation_date": 1537362809, "last_edit_date": 1537363161, "question_id": 52406709, "link": "https://stackoverflow.com/questions/52406709/simple-http-post-in-go-with-file-upload", "closed_reason": "Not suitable for this site", "title": "Simple HTTP POST in Go with File Upload", "body": "<p>I just need to know an <strong>extremely simple</strong> way to send a file to a remote server using HTTP POST, in Go. I have already tried so many complicated methods with no luck. My curl command is this:</p>\n\n<pre><code>curl https://api.example.com/upload \\\n --user api:YOUR_API_KEY \\\n --data-binary @file.jpg \\\n --dump-header apiresponse.txt\n</code></pre>\n\n<p>I would prefer something without using multipart. I would also prefer something which uses io.Reader, so that I can later implement a progress bar easily.</p>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 1, "creation_date": 1537360893, "post_id": 52405844, "comment_id": 91755924, "body": "No there is no need for another parser you just to remove trailing spaces from each parsed line. Please post the code you have tried for us to regenerate the issue."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1537360935, "post_id": 52405844, "comment_id": 91755944, "body": "<code>input = strings.Replace(input, &quot; \\n&quot;, &quot;\\n&quot;, -1)</code>.  Effectively removes the trailing space on each line.  If the last line ends with a space and not a new line, simply follow this call with <code>input = strings.TrimSpace(input)</code>."}, {"owner": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 0, "creation_date": 1537364556, "post_id": 52405844, "comment_id": 91758278, "body": "Please, include some example code in your question what you have tried."}, {"owner": {"reputation": 934, "user_id": 822882, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ec3bb5667672bc1e1866f9ebb1d38800?s=128&d=identicon&r=PG", "display_name": "Vejto", "link": "https://stackoverflow.com/users/822882/vejto"}, "edited": false, "score": 0, "creation_date": 1537367318, "post_id": 52405844, "comment_id": 91760133, "body": "Added some code, the issue is that we don&#39;t read the file line by line. We let the csv-package handle that.. We probably have to change tactic and handle the lines ourselves and only let the csv package parse the rows into a slice."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1537367580, "post_id": 52405844, "comment_id": 91760311, "body": "@Vejto Please add some csv sample of your file so that we can parse the file by removing trailing spaces and tabs."}, {"owner": {"reputation": 934, "user_id": 822882, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ec3bb5667672bc1e1866f9ebb1d38800?s=128&d=identicon&r=PG", "display_name": "Vejto", "link": "https://stackoverflow.com/users/822882/vejto"}, "edited": false, "score": 0, "creation_date": 1537370291, "post_id": 52405844, "comment_id": 91762040, "body": "Added csv sample."}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1537377543, "post_id": 52405844, "comment_id": 91765911, "body": "What does it mean that it breaks ? Are you getting an error ? Did the code panic ? Do you read unexpoected values (if so what did you read and what did you expect )?"}], "answers": [{"comments": [{"owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "edited": false, "score": 0, "creation_date": 1537377836, "post_id": 52410492, "comment_id": 91766060, "body": "This can fail for the edge case where the last byte read was a space but there was a new line just after that, which will be read as the first character in the next Read()."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "edited": false, "score": 1, "creation_date": 1537378187, "post_id": 52410492, "comment_id": 91766254, "body": "@svsd hmm yes, great catch. To workaround this implementation would probably want to detect trailing whitespace in the trimmed byte array, omit it, and prepend it to the subsequent read so the same replacement logic can apply. But I&#39;ll leave that (or a better solution) as an exercise to the reader =P"}, {"owner": {"reputation": 934, "user_id": 822882, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ec3bb5667672bc1e1866f9ebb1d38800?s=128&d=identicon&r=PG", "display_name": "Vejto", "link": "https://stackoverflow.com/users/822882/vejto"}, "edited": false, "score": 0, "creation_date": 1537436901, "post_id": 52410492, "comment_id": 91787420, "body": "I like the idea! It is quite clean but yeah will look into the edge case. Thanks"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 3, "last_activity_date": 1537378785, "last_edit_date": 1537378785, "creation_date": 1537374803, "answer_id": 52410492, "question_id": 52405844, "link": "https://stackoverflow.com/questions/52405844/csv-parser-in-go-breaks-due-to-trailing-space/52410492#52410492", "title": "CSV parser in Go breaks due to trailing space", "body": "<p>One possible solution is to wrap the source file reader in a custom reader whose <code>Read(...)</code> method silently trims trailing whitespace from what the underlying reader actually reads. The <code>csv.Reader</code> could use that type directly.</p>\n\n<p>For example (<a href=\"https://play.golang.com/p/HjaUYNakq3S\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>type TrimReader struct{ io.Reader }\n\nvar trailingws = regexp.MustCompile(` +\\r?\\n`)\n\nfunc (tr TrimReader) Read(bs []byte) (int, error) {\n  // Perform the requested read on the given reader.\n  n, err := tr.Reader.Read(bs)\n  if err != nil {\n    return n, err\n  }\n\n  // Remove trailing whitespace from each line.\n  lines := string(bs[:n])\n  trimmed := []byte(trailingws.ReplaceAllString(lines, \"\\n\"))\n  copy(bs, trimmed)\n  return len(trimmed), nil\n}\n\nfunc main() {\n  file, err := file.Open(\"myfile.csv\")\n  // TODO: handle err...\n\n  csvr := csv.NewReader(TrimReader{file})\n\n  for {\n    record, err := csvr.Read()\n    if err == io.EOF {\n      break\n    }\n    fmt.Printf(\"LINE: record=%#v, err=%v\\n\", record, err)\n  }\n  // LINE: record=[]string{\"RECORD_TYPE\", \"COMPANY_SHORTNAME\"}, err=&lt;nil&gt;\n  // LINE: record=[]string{\"HDR\", \"COMPANY_EXAMPLE\"}, err=&lt;nil&gt;\n}\n</code></pre>\n\n<p>Note that, as commenter @svsd points out, there is a subtle bug here wherein trailing whitespace can still make it through if the line terminator isn't read until the subsequent call. You can workaround by buffering or, perhaps best, simply preprocess these CSV files to remove the trailing whitespace before attempting to parse them.</p>\n"}], "owner": {"reputation": 934, "user_id": 822882, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/ec3bb5667672bc1e1866f9ebb1d38800?s=128&d=identicon&r=PG", "display_name": "Vejto", "link": "https://stackoverflow.com/users/822882/vejto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 0, "accepted_answer_id": 52410492, "answer_count": 1, "score": 1, "last_activity_date": 1537378785, "creation_date": 1537359976, "last_edit_date": 1537370275, "question_id": 52405844, "link": "https://stackoverflow.com/questions/52405844/csv-parser-in-go-breaks-due-to-trailing-space", "title": "CSV parser in Go breaks due to trailing space", "body": "<p>We are trying to parse a csv file using Go's encoding/csv package. This particular csv is a bit peculiar, each row has a trailing space. When trying to decode this csv with quoted fields the package breaks since it expects a newline, separator or quote. The trailing space is not expected. </p>\n\n<p>How would you handle this case? Do you know of another parser that we could use?</p>\n\n<p>Edit:</p>\n\n<pre><code>f,err := os.Open(\"file.go\")\n// err etc..\ncsvr := csv.NewReader(f)\ncsvr.Comma = csvDelimiter\nfor {\n   rowAsSlice, err := csvr.Read()\n   // Handle row and errors etc.\n}\n</code></pre>\n\n<p>Edit 2:\nCSV example, mind the trailing space!</p>\n\n<pre><code>\"RECORD_TYPE\",\"COMPANY_SHORTNAME\" \n\"HDR\",\"COMPANY_EXAMPLE\" \n</code></pre>\n"}, {"tags": ["go", "hugo", "go-templates"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537421697, "post_id": 52405597, "comment_id": 91779511, "body": "What do you mean &quot;ITEM always returns false&quot;?  There&#39;s nothing called ITEM in your code, and there&#39;s nothing returning a boolean... what exactly do you see is &quot;false&quot;?"}, {"owner": {"reputation": 150, "user_id": 1769135, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/44f904d38265cf06c43e9b22f8461fd9?s=128&d=identicon&r=PG", "display_name": "Maharshi Raval", "link": "https://stackoverflow.com/users/1769135/maharshi-raval"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537422008, "post_id": 52405597, "comment_id": 91779652, "body": "@flimzy thanks for your reply. But ITEM I mean the second parameter of the IN function. When I use in function in the first snippet of code I use a string as the second parameter. But in the second snippet I am using a variable as the second parameter. This does not work for some reason."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537422193, "post_id": 52405597, "comment_id": 91779728, "body": "In what way does it not work? What output or error do you see?"}, {"owner": {"reputation": 150, "user_id": 1769135, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/44f904d38265cf06c43e9b22f8461fd9?s=128&d=identicon&r=PG", "display_name": "Maharshi Raval", "link": "https://stackoverflow.com/users/1769135/maharshi-raval"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537422589, "post_id": 52405597, "comment_id": 91779899, "body": "@Flimzy, well it does not give any error the build just works fine.But for the above code it in second snippet <code>if in .Params.categories $display_product_cat</code> must be <code>TRUE</code> but it always returns &#39;FALSE&#39;."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537422716, "post_id": 52405597, "comment_id": 91779962, "body": "That sounds a lot like your <code>.Params.categories</code> list doesn&#39;t contain <code>&quot;New Arrival&quot;</code>, and that your code is actually working."}, {"owner": {"reputation": 150, "user_id": 1769135, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/44f904d38265cf06c43e9b22f8461fd9?s=128&d=identicon&r=PG", "display_name": "Maharshi Raval", "link": "https://stackoverflow.com/users/1769135/maharshi-raval"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537422835, "post_id": 52405597, "comment_id": 91780016, "body": "This is my real dilemma. That is the reason I have posted 2 snippets, the first one works fine where I use a string , but in the second one I assign that string to a variable and it stops working. @Flimzy"}, {"owner": {"reputation": 150, "user_id": 1769135, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/44f904d38265cf06c43e9b22f8461fd9?s=128&d=identicon&r=PG", "display_name": "Maharshi Raval", "link": "https://stackoverflow.com/users/1769135/maharshi-raval"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537423015, "post_id": 52405597, "comment_id": 91780100, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/180407/discussion-between-maharshi-raval-and-flimzy\">continue this discussion in chat</a>."}, {"owner": {"reputation": 379, "user_id": 4948631, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-FyT99NCwTng/AAAAAAAAAAI/AAAAAAAAARY/wmcBOo-0Nmc/photo.jpg?sz=128", "display_name": "charly3pins", "link": "https://stackoverflow.com/users/4948631/charly3pins"}, "edited": false, "score": 0, "creation_date": 1538170372, "post_id": 52405597, "comment_id": 92064265, "body": "I&#39;ve tested your snippet and for me works correctly, I&#39;m on version <code>Hugo Static Site Generator v0.40.2 darwin&#47;amd64</code> and the code snippet that I&#39;ve used <code>{{ $cat := &quot;Tutorial&quot; }} {{ range .Site.Pages }}    {{ if in .Params.categories $cat }}           &lt;li&gt;{{ .Title }}&lt;&#47;li&gt;    {{end}} {{end}}</code>"}], "answers": [{"tags": [], "owner": {"reputation": 602, "user_id": 933972, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/XZTMt.png?s=128&g=1", "display_name": "dmayo", "link": "https://stackoverflow.com/users/933972/dmayo"}, "is_accepted": false, "score": 0, "last_activity_date": 1579214889, "creation_date": 1579214889, "answer_id": 59778942, "question_id": 52405597, "link": "https://stackoverflow.com/questions/52405597/hugo-in-function-not-accepting-variable-as-item/59778942#59778942", "title": "HUGO IN function not accepting variable as ITEM", "body": "<p>You can test what the boolean is by something like:</p>\n\n<pre><code>{{ $i := in .Params.categories \"New Arrival\" }}\n{{ $i }} ## will output true|false\n\n{{ $var := \"New Arrival\" }}\n{{ $j := in .Params.categories $var }}\n{{ $j }} ## will output true|false\n</code></pre>\n\n<p>If it's giving false outcomes, you might need to inspect how your <code>.Params</code> are actually constructed (what pattern are they in, etc.). </p>\n\n<p>Providing more info will allow a better debug for you (like the snippet of your Params).</p>\n"}], "owner": {"reputation": 150, "user_id": 1769135, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/44f904d38265cf06c43e9b22f8461fd9?s=128&d=identicon&r=PG", "display_name": "Maharshi Raval", "link": "https://stackoverflow.com/users/1769135/maharshi-raval"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1579214889, "creation_date": 1537359127, "last_edit_date": 1537421655, "question_id": 52405597, "link": "https://stackoverflow.com/questions/52405597/hugo-in-function-not-accepting-variable-as-item", "title": "HUGO IN function not accepting variable as ITEM", "body": "<p>I am using the <code>IN</code> function of Hugo that can be used as <code>in SET ITEM</code> as defined at <a href=\"https://gohugo.io/functions/in/\" rel=\"nofollow noreferrer\">Hugo Documentation for IN</a></p>\n\n<p>I am trying to filter out posts of a particular category by the below code</p>\n\n<pre><code>{{ range where .Site.Pages \"Section\" \"products\"}}\n   {{ if in .Params.categories \"New Arrival\" }}\n          &lt;li&gt;{{ .Title }}&lt;/li&gt;\n   {{end}}\n{{end}}\n</code></pre>\n\n<p>the above code works completely fine.</p>\n\n<p><strong>But if I use a variable instead of a string for the <code>ITEM</code>. It always returns <code>False</code>.</strong></p>\n\n<pre><code>{{ $display_product_cat := \"New Arrival\" }}\n\n{{ range where .Site.Pages \"Section\" \"products\"}}\n      {{ if in .Params.categories $display_product_cat }}\n          &lt;li&gt;{{ .Title }}&lt;/li&gt;\n      {{end}}\n{{end}}\n</code></pre>\n\n<p><strong>The above code does not work as expected.</strong></p>\n\n<p>Wondering if I am missing something here. Appreciate your time and help.  </p>\n"}, {"tags": ["git", "go", "go-get"], "answers": [{"comments": [{"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1537365868, "post_id": 52407325, "comment_id": 91759160, "body": "Thank you for your answer, the insecure flag work but is not an option since the goal is to have go modules make the go get call"}, {"owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1537366051, "post_id": 52407325, "comment_id": 91759275, "body": "Why is go get making a first call using https when it could do everything with ssh ?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1537367057, "post_id": 52407325, "comment_id": 91759961, "body": "It can&#39;t make an SSH call to a URL to get the HTTP headers for that URL.  <code>go get</code> doesn&#39;t know whether the URL you provided directly points at the repository, or if it&#39;s simply a vanity URL that then forwards to the actual repo via the <code>go-import</code> meta tag.  So it hits the endpoint first using an HTTPS GET query and looks for the tag.  If it&#39;s not present, it tries to clone from that URL.  If it is, it tries to clone the URL present in that meta tag instead.  The meta tag is queried for before <code>git</code> is even called."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "edited": false, "score": 0, "creation_date": 1537367389, "post_id": 52407325, "comment_id": 91760184, "body": "And @BlueMagma you have two options then.  <code>go get</code> calls still work using go modules, they just require the extra <code>go get</code> step instead of just using <code>go build</code> and letting it handle the dependency fetching.  The other option is to figure out what&#39;s causing the cert issue.  I listed the 3 most likely cases in my answer.  Your company&#39;s IT support team would probably be able to tell you which is the case."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 4, "last_activity_date": 1537364529, "creation_date": 1537364529, "answer_id": 52407325, "question_id": 52404171, "link": "https://stackoverflow.com/questions/52404171/go-get-git-settings-are-ignored/52407325#52407325", "title": "go get: Git settings are ignored", "body": "<p>That error occurs before the <code>git clone</code> call.  When you call <code>go get</code>, it makes an HTTPS call out to the URL to check the headers and see if it provides a <code>go get</code> redirect.  That's what's failing.</p>\n\n<p>And it's failing because the certificate provided by the server isn't signed by a Certificate Authority that you have specified as trusted on your local system.  This could be because your internal gitlab is using an unsigned certificate, because the CA used to sign it hasn't been added to your local system, or because your workplace is using a man-in-the-middle style proxy and you don't have <em>that proxy's</em> CA added.  You can either attempt to fix the cert issue, or simply run:</p>\n\n<pre><code>go get -insecure gitlab.mysite.com/group/project\n</code></pre>\n\n<blockquote>\n  <p>The -insecure flag permits fetching from repositories and resolving\n  custom domains using insecure schemes such as HTTP. Use with caution.</p>\n</blockquote>\n\n<p>Notably, this bypasses the validation of the CA used to sign the server's certificate.</p>\n"}], "owner": {"reputation": 2192, "user_id": 1107595, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9f43c090c500a639bdd28c090f573159?s=128&d=identicon&r=PG", "display_name": "BlueMagma", "link": "https://stackoverflow.com/users/1107595/bluemagma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1409, "favorite_count": 0, "accepted_answer_id": 52407325, "answer_count": 1, "score": 0, "last_activity_date": 1537364529, "creation_date": 1537354241, "question_id": 52404171, "link": "https://stackoverflow.com/questions/52404171/go-get-git-settings-are-ignored", "title": "go get: Git settings are ignored", "body": "<p>I try to go get a repository from a private gitlab server, from a mac.</p>\n\n<p>I set the git config (~/.gitconfig) to use ssh instead of https : </p>\n\n<pre><code>[url \"git@gitlab.mysite.com:\"]\n    insteadOf = https://gitlab.mysite.com/\n</code></pre>\n\n<p>When I clone the project using the https url, I get the correct replacement</p>\n\n<pre><code>$ git clone https://gitlab.mysite.com/group/project\n$ cd project\n$ git remote -v\norigin  git@gitlab.mysite.com:group/project (fetch)\norigin  git@gitlab.mysite.com:group/project (push)\n</code></pre>\n\n<p>However, when I use go get, it tries to use the https url, and fail</p>\n\n<pre><code>$ go get gitlab.mysite.com/group/project\npackage gitlab.mysite.com/group/project: unrecognized import path \"gitlab.mysite.com/group/project\" (https fetch: Get https://gitlab.mysite.com/group/project?go-get=1: x509: certificate signed by unknown authority)\n</code></pre>\n\n<p>Why is go get not using my git configuration ? How can I fix that ?</p>\n\n<p><strong>I know the problem is similar to this question : <a href=\"https://stackoverflow.com/questions/47721570/go-get-git-settings-ignored\">go get: Git settings ignored</a> and many other question concerning private repos</strong></p>\n\n<p><strong>my problem is different</strong></p>\n"}, {"tags": ["go", "etcd"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1537353285, "post_id": 52403751, "comment_id": 91751391, "body": "Could be the values are set using version 3 of etcd api. Run <code>export ETCDCTL_API=3</code> before you run etcdctl, as noted at <a href=\"https://coreos.com/etcd/docs/latest/dev-guide/interacting_v3.html\" rel=\"nofollow noreferrer\">coreos.com/etcd/docs/latest/dev-guide/interacting_v3.html</a>"}, {"owner": {"reputation": 521, "user_id": 7015035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/kvZcK.jpg?s=128&g=1", "display_name": "Elia Perantoni", "link": "https://stackoverflow.com/users/7015035/elia-perantoni"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1537353334, "post_id": 52403751, "comment_id": 91751424, "body": "I always ran etcdctl with api v3"}, {"owner": {"reputation": 521, "user_id": 7015035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/kvZcK.jpg?s=128&g=1", "display_name": "Elia Perantoni", "link": "https://stackoverflow.com/users/7015035/elia-perantoni"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1537353480, "post_id": 52403751, "comment_id": 91751516, "body": "Apparently the Go client uses API v2. Running etcdctl with api v2 works. @nos"}], "answers": [{"tags": [], "owner": {"reputation": 521, "user_id": 7015035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/kvZcK.jpg?s=128&g=1", "display_name": "Elia Perantoni", "link": "https://stackoverflow.com/users/7015035/elia-perantoni"}, "is_accepted": true, "score": 1, "last_activity_date": 1537358707, "creation_date": 1537358707, "answer_id": 52405483, "question_id": 52403751, "link": "https://stackoverflow.com/questions/52403751/the-go-client-and-etcdctl-cli-utility-tool-seem-to-be-working-on-different-wor/52405483#52405483", "title": "The Go client and &#39;etcdctl&#39; cli utility tool seem to be working on different workspaces even though they are connected to the same hosts", "body": "<p>The issue was I was using API v2 for the client and v3 for the etcdctl. Different API versions have different key namespaces. To use client v3 in Go import <code>go.etcd.io/etcd/clientv3</code></p>\n"}], "owner": {"reputation": 521, "user_id": 7015035, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/kvZcK.jpg?s=128&g=1", "display_name": "Elia Perantoni", "link": "https://stackoverflow.com/users/7015035/elia-perantoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 52405483, "answer_count": 1, "score": 1, "last_activity_date": 1537358707, "creation_date": 1537352957, "question_id": 52403751, "link": "https://stackoverflow.com/questions/52403751/the-go-client-and-etcdctl-cli-utility-tool-seem-to-be-working-on-different-wor", "title": "The Go client and &#39;etcdctl&#39; cli utility tool seem to be working on different workspaces even though they are connected to the same hosts", "body": "<p>I wrote a little Go program that connects to etcd hosts <code>http://192.168.0.210:2379</code> and <code>http://192.168.0.211:2379</code>, sets a key <code>/foo</code> to <code>bar</code> and then reads it and prints the result. That part is working fine:  </p>\n\n<pre><code>bar &amp;{get {Key: /foo, CreatedIndex: 6, ModifiedIndex: 6, TTL: 0} &lt;nil&gt; 6 67b31bc85ffd6d2b} &lt;nil&gt;\n</code></pre>\n\n<p>the key can also be read using a HTTP GET request</p>\n\n<pre><code>{\n    \"action\": \"get\",\n    \"node\": {\n        \"key\": \"/foo\",\n        \"value\": \"bar\",\n        \"modifiedIndex\": 6,\n        \"createdIndex\": 6\n    }\n}\n</code></pre>\n\n<p>but when I use ectdctl it returns nothing as if the key didn't exist</p>\n\n<pre><code>./etcdctl --endpoints=192.168.0.210:2379,192.168.0.211:2379 get /foo\n</code></pre>\n\n<p>if I instead set <code>/foo</code> using etcdctl, then it works and reads the key correctly. It looks like etcdctl is working on a workspace of its own. Any ideas why this is happening?</p>\n"}, {"tags": ["go", "concurrency", "matrix-multiplication", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "edited": false, "score": 0, "creation_date": 1537352548, "post_id": 52403366, "comment_id": 91750902, "body": "Balancing? It seems very tricky on the caller side, they have to decide when they should use what version, no optimal approach, isn&#39;t it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "edited": false, "score": 1, "creation_date": 1537352643, "post_id": 52403366, "comment_id": 91750955, "body": "@ChangkunOu Yes, no optimal solution. You have to measure performance with different sizes, and decide based on that. For example you may go with the naive solution if <code>N &lt; 50</code>, and launch goroutines for rows otherwise. Also do give a try to a goroutine pool (linked in the answer)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "edited": false, "score": 1, "creation_date": 1537352800, "post_id": 52403366, "comment_id": 91751066, "body": "@ChangkunOu You may consider other factors too. E.g. if in most of the cases you work with large matrices, it might not worth the additional complexity, and just use goroutines all the times; small matrices\u2013although will be slower\u2013might not matter in this case. It also depends on how critical the performance of this is."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1537352557, "last_edit_date": 1537352557, "creation_date": 1537351699, "answer_id": 52403366, "question_id": 52403157, "link": "https://stackoverflow.com/questions/52403157/matrix-multiplication-with-goroutine-drops-performance/52403366#52403366", "title": "Matrix multiplication with goroutine drops performance", "body": "<p>Performing 8x8 matrix multipliciation is relatively small work.</p>\n\n<p>Goroutines (although may be lightweight) do have overhead. If the work they do is \"small\", the overhead of launching, synchronizing and throwing them away may outweight the performance gain of utilizing multiple cores / threads, and overall you might not gain performance by executing such small tasks concurrently (hell, you may even do worse than without using goroutines). Measure.</p>\n\n<p>If we increase the matrix size to 80x80, running the benchmark we already see some performance gain in case of <code>ParalMultNaivePerRow</code>:</p>\n\n<pre><code>BenchmarkMatrixDotNaive/A.MultNaive-4               2000     1054775 ns/op\nBenchmarkMatrixDotNaive/A.ParalMultNaivePerRow-4    2000      709367 ns/op\nBenchmarkMatrixDotNaive/A.ParalMultNaivePerElem-4    100    10224927 ns/op\n</code></pre>\n\n<p>(As you see in the results, I have 4 CPU cores, running it on your 8-core machine might show more performance gain.)</p>\n\n<p>When rows are small, you are using goroutines to do minimal work, you may improve performance by not \"throwing\" away goroutines once they're done with their \"tiny\" work, but you may \"reuse\" them. See related question: <a href=\"https://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go/38172204#38172204\">Is this an idiomatic worker thread pool in Go?</a></p>\n\n<p>Also see related / possible duplicate: <a href=\"https://stackoverflow.com/questions/50179290/vectorise-a-function-taking-advantage-of-concurrency/50179617#50179617\">Vectorise a function taking advantage of concurrency</a></p>\n"}], "owner": {"reputation": 1022, "user_id": 3819460, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oZU0t.png?s=128&g=1", "display_name": "Jakob", "link": "https://stackoverflow.com/users/3819460/jakob"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 556, "favorite_count": 1, "accepted_answer_id": 52403366, "answer_count": 1, "score": 1, "last_activity_date": 1537352557, "creation_date": 1537351081, "last_edit_date": 1537351826, "question_id": 52403157, "link": "https://stackoverflow.com/questions/52403157/matrix-multiplication-with-goroutine-drops-performance", "title": "Matrix multiplication with goroutine drops performance", "body": "<p>I am optimizing matrix multiplication via goroutines in Go.</p>\n\n<p>My benchmark shows, introducing concurrency per row or per element largely drops performance:</p>\n\n<pre><code>goos: darwin\ngoarch: amd64\nBenchmarkMatrixDotNaive/A.MultNaive-8                            2000000               869 ns/op               0 B/op          0 allocs/op\nBenchmarkMatrixDotNaive/A.ParalMultNaivePerRow-8                  100000             14467 ns/op              80 B/op          9 allocs/op\nBenchmarkMatrixDotNaive/A.ParalMultNaivePerElem-8                  20000             77299 ns/op             528 B/op         65 allocs/op\n</code></pre>\n\n<p>I know some basic prior knowledge of cache locality, it make sense that per element concurrency drops performance. However, why per row still drops the performance even in naive version?</p>\n\n<p>In fact, I also wrote a block/tiling optimization, its vanilla version (without goroutine concurrency) even worse than naive version (not present here, let's focus on naive first). </p>\n\n<p>What did I do wrong here? Why? How to optimize here?</p>\n\n<p>Multiplication:</p>\n\n<pre><code>package naive\n\nimport (\n    \"errors\"\n    \"sync\"\n)\n\n// Errors\nvar (\n    ErrNumElements = errors.New(\"Error number of elements\")\n    ErrMatrixSize  = errors.New(\"Error size of matrix\")\n)\n\n// Matrix is a 2d array\ntype Matrix struct {\n    N    int\n    data [][]float64\n}\n\n// New a size by size matrix\nfunc New(size int) func(...float64) (*Matrix, error) {\n    wg := sync.WaitGroup{}\n    d := make([][]float64, size)\n    for i := range d {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            d[i] = make([]float64, size)\n        }(i)\n    }\n    wg.Wait()\n    m := &amp;Matrix{N: size, data: d}\n    return func(es ...float64) (*Matrix, error) {\n        if len(es) != size*size {\n            return nil, ErrNumElements\n        }\n        for i := range es {\n            wg.Add(1)\n            go func(i int) {\n                defer wg.Done()\n                m.data[i/size][i%size] = es[i]\n            }(i)\n        }\n        wg.Wait()\n        return m, nil\n    }\n}\n\n// At access element (i, j)\nfunc (A *Matrix) At(i, j int) float64 {\n    return A.data[i][j]\n}\n\n// Set set element (i, j) with val\nfunc (A *Matrix) Set(i, j int, val float64) {\n    A.data[i][j] = val\n}\n\n// MultNaive matrix multiplication O(n^3)\nfunc (A *Matrix) MultNaive(B, C *Matrix) (err error) {\n    var (\n        i, j, k int\n        sum     float64\n        N       = A.N\n    )\n\n    if N != B.N || N != C.N {\n        return ErrMatrixSize\n    }\n\n    for i = 0; i &lt; N; i++ {\n        for j = 0; j &lt; N; j++ {\n            sum = 0.0\n            for k = 0; k &lt; N; k++ {\n                sum += A.At(i, k) * B.At(k, j)\n            }\n            C.Set(i, j, sum)\n        }\n    }\n    return\n}\n\n// ParalMultNaivePerRow matrix multiplication O(n^3) in concurrency per row\nfunc (A *Matrix) ParalMultNaivePerRow(B, C *Matrix) (err error) {\n    var N = A.N\n\n    if N != B.N || N != C.N {\n        return ErrMatrixSize\n    }\n\n    wg := sync.WaitGroup{}\n    for i := 0; i &lt; N; i++ {\n        wg.Add(1)\n        go func(i int) {\n            defer wg.Done()\n            for j := 0; j &lt; N; j++ {\n                sum := 0.0\n                for k := 0; k &lt; N; k++ {\n                    sum += A.At(i, k) * B.At(k, j)\n                }\n                C.Set(i, j, sum)\n            }\n        }(i)\n    }\n    wg.Wait()\n    return\n}\n\n// ParalMultNaivePerElem matrix multiplication O(n^3) in concurrency per element\nfunc (A *Matrix) ParalMultNaivePerElem(B, C *Matrix) (err error) {\n    var N = A.N\n\n    if N != B.N || N != C.N {\n        return ErrMatrixSize\n    }\n\n    wg := sync.WaitGroup{}\n    for i := 0; i &lt; N; i++ {\n        for j := 0; j &lt; N; j++ {\n            wg.Add(1)\n            go func(i, j int) {\n                defer wg.Done()\n                sum := 0.0\n                for k := 0; k &lt; N; k++ {\n                    sum += A.At(i, k) * B.At(k, j)\n                }\n                C.Set(i, j, sum)\n            }(i, j)\n        }\n    }\n    wg.Wait()\n    return\n}\n</code></pre>\n\n<p>Benchmark:</p>\n\n<pre><code>package naive\n\nimport (\n    \"os\"\n    \"runtime/trace\"\n    \"testing\"\n)\n\ntype Dot func(B, C *Matrix) error\n\nvar (\n    A = &amp;Matrix{\n        N: 8,\n        data: [][]float64{\n            []float64{1, 2, 3, 4, 5, 6, 7, 8},\n            []float64{9, 1, 2, 3, 4, 5, 6, 7},\n            []float64{8, 9, 1, 2, 3, 4, 5, 6},\n            []float64{7, 8, 9, 1, 2, 3, 4, 5},\n            []float64{6, 7, 8, 9, 1, 2, 3, 4},\n            []float64{5, 6, 7, 8, 9, 1, 2, 3},\n            []float64{4, 5, 6, 7, 8, 9, 1, 2},\n            []float64{3, 4, 5, 6, 7, 8, 9, 0},\n        },\n    }\n    B = &amp;Matrix{\n        N: 8,\n        data: [][]float64{\n            []float64{9, 8, 7, 6, 5, 4, 3, 2},\n            []float64{1, 9, 8, 7, 6, 5, 4, 3},\n            []float64{2, 1, 9, 8, 7, 6, 5, 4},\n            []float64{3, 2, 1, 9, 8, 7, 6, 5},\n            []float64{4, 3, 2, 1, 9, 8, 7, 6},\n            []float64{5, 4, 3, 2, 1, 9, 8, 7},\n            []float64{6, 5, 4, 3, 2, 1, 9, 8},\n            []float64{7, 6, 5, 4, 3, 2, 1, 0},\n        },\n    }\n    C = &amp;Matrix{\n        N: 8,\n        data: [][]float64{\n            []float64{0, 0, 0, 0, 0, 0, 0, 0},\n            []float64{0, 0, 0, 0, 0, 0, 0, 0},\n            []float64{0, 0, 0, 0, 0, 0, 0, 0},\n            []float64{0, 0, 0, 0, 0, 0, 0, 0},\n            []float64{0, 0, 0, 0, 0, 0, 0, 0},\n            []float64{0, 0, 0, 0, 0, 0, 0, 0},\n            []float64{0, 0, 0, 0, 0, 0, 0, 0},\n            []float64{0, 0, 0, 0, 0, 0, 0, 0},\n        },\n    }\n)\n\nfunc BenchmarkMatrixDotNaive(b *testing.B) {\n    f, _ := os.Create(\"bench.trace\")\n    defer f.Close()\n    trace.Start(f)\n    defer trace.Stop()\n\n    tests := []struct {\n        name string\n        f    Dot\n    }{\n        {\n            name: \"A.MultNaive\",\n            f:    A.MultNaive,\n        },\n        {\n            name: \"A.ParalMultNaivePerRow\",\n            f:    A.ParalMultNaivePerRow,\n        },\n        {\n            name: \"A.ParalMultNaivePerElem\",\n            f:    A.ParalMultNaivePerElem,\n        },\n    }\n    for _, tt := range tests {\n        b.Run(tt.name, func(b *testing.B) {\n            for i := 0; i &lt; b.N; i++ {\n                tt.f(B, C)\n            }\n        })\n    }\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda"], "comments": [{"owner": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1537356685, "post_id": 52403154, "comment_id": 91753444, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/32241928/sending-html-content-in-aws-snssimple-notification-service-emails-notification\">Sending html content in AWS SNS(Simple Notification Service) emails notifications</a>"}, {"owner": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1537356764, "post_id": 52403154, "comment_id": 91753494, "body": "See here - <a href=\"https://stackoverflow.com/questions/32241928/sending-html-content-in-aws-snssimple-notification-service-emails-notification\" title=\"sending html content in aws snssimple notification service emails notification\">stackoverflow.com/questions/32241928/&hellip;</a>. SNS can only send email in plain text. Use SES for formatted/HTML email."}, {"owner": {"reputation": 322, "user_id": 8399906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b20fa1357bb11e0ba2eab0d5b358ed?s=128&d=identicon&r=PG", "display_name": "CJW", "link": "https://stackoverflow.com/users/8399906/cjw"}, "reply_to_user": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1537359915, "post_id": 52403154, "comment_id": 91755336, "body": "Thanks for the comments. While I appreciate that SNS might not be the best tool for sending an email, the question was more geared around how to push the JSON data anywhere. Moving to SES would still result in the same problem, that I am unaware on how to publish the JSON data received by the Lambda. Truth be told I am probably going to end up sending the SNS to OpsGenie which can handle receiving the JSON blob."}, {"owner": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1537360719, "post_id": 52403154, "comment_id": 91755821, "body": "If OpsGenie exposes an HTTP endpoint like webhooks then you can directly use that instead of email."}, {"owner": {"reputation": 322, "user_id": 8399906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b20fa1357bb11e0ba2eab0d5b358ed?s=128&d=identicon&r=PG", "display_name": "CJW", "link": "https://stackoverflow.com/users/8399906/cjw"}, "reply_to_user": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1537365007, "post_id": 52403154, "comment_id": 91758584, "body": "That would be ideal. Do you have any idea how to push the data received from the SNS to the Lambda out to the SNS that is hooked up to Ops Genie, the SNS configuration part is not an issue, it is just how the code needs to handle the sending of the JSON?"}, {"owner": {"reputation": 1965, "user_id": 508214, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/xKgdj.png?s=128&g=1", "display_name": "titogeo", "link": "https://stackoverflow.com/users/508214/titogeo"}, "edited": false, "score": 0, "creation_date": 1537369412, "post_id": 52403154, "comment_id": 91761451, "body": "I have not worked with OpsGenie. Like you created an email subscription create an HTTP subscription in SNS. Whenever the notification comes SNS will invoke the HTTP (POST) endpoint with the message. Configuring HTTP subscription involves confirming subscription just like email. So if OpsGeinie does not support that then it won&#39;t work."}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 8399906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b20fa1357bb11e0ba2eab0d5b358ed?s=128&d=identicon&r=PG", "display_name": "CJW", "link": "https://stackoverflow.com/users/8399906/cjw"}, "edited": false, "score": 0, "creation_date": 1537437362, "post_id": 52413746, "comment_id": 91787698, "body": "Thank you for the reply! I have attempted to implement the above and I have hit a problem I was hoping you could help with when entering &quot;myjson&quot;, in my case I am attempting to use &quot;snsRecord&quot; or &quot;snsRecord.Message&quot; I am getting the error <code>cannot use snsRecord (type events.SNSEntity) as type *string in field value</code> and <code>cannot use snsRecord.Message (type string) as type *string in field value</code> respectively, when building. Any idea what is causing this?"}], "tags": [], "owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "is_accepted": false, "score": 0, "last_activity_date": 1537388950, "creation_date": 1537388950, "answer_id": 52413746, "question_id": 52403154, "link": "https://stackoverflow.com/questions/52403154/forward-on-json-received-from-sns-to-lambda-golang/52413746#52413746", "title": "Forward on JSON received from SNS to Lambda - GoLang", "body": "<p>From AWS SDK for Go docs:</p>\n\n<pre><code>type PublishInput struct {\n// The message you want to send.\n//\n// If you are publishing to a topic and you want to send the same message to\n// all transport protocols, include the text of the message as a String value.\n// If you want to send different messages for each transport protocol, set the\n// value of the MessageStructure parameter to json and use a JSON object for\n// the Message parameter.\n</code></pre>\n\n<p>So, <code>params</code> would be:</p>\n\n<pre><code>params := &amp;sns.PublishInput{\n        Message: myjson, // json data you want to send\n        TopicArn: aws.String(\"my arn\"),\n        MessageStructure: aws.String(\"json\")\n    }\n</code></pre>\n\n<p><strong>WARNING</strong></p>\n\n<p>Notice the help paragraph says \"use a JSON object for the parameter message\", such JSON object must have a keys that correspond to supported transport protocol That means</p>\n\n<pre><code>{\n  'default': json_message,\n  'email': json_message\n}\n</code></pre>\n\n<p>It will send <code>json_message</code> using both the default and email transports.</p>\n"}], "owner": {"reputation": 322, "user_id": 8399906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4b20fa1357bb11e0ba2eab0d5b358ed?s=128&d=identicon&r=PG", "display_name": "CJW", "link": "https://stackoverflow.com/users/8399906/cjw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1261, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1537388950, "creation_date": 1537351072, "last_edit_date": 1537387117, "question_id": 52403154, "link": "https://stackoverflow.com/questions/52403154/forward-on-json-received-from-sns-to-lambda-golang", "title": "Forward on JSON received from SNS to Lambda - GoLang", "body": "<p>I am trying to achieve the following:\nCloudwatch alarm details are received as JSON to a Lambda\nThe Lambda looks at the JSON to determine if the 'NewStateValue' == \"ALARM\"\nIf it does == \"ALARM\" forward the whole JSON received from the SNS out via another SNS.</p>\n\n<p>I am most of the way towards achieving this and I have the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"encoding/json\"\n\n    \"github.com/aws/aws-lambda-go/events\"\n    \"github.com/aws/aws-lambda-go/lambda\"\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/sns\"\n)\n\nfunc handler(ctx context.Context, snsEvent events.SNSEvent) {\n    for _, record := range snsEvent.Records {\n        snsRecord := record.SNS\n\n//To add in additional fields to publish to the logs add \"snsRecord.'fieldname'\"\n        fmt.Printf(\"Message = %s \\n\", snsRecord.Message) \n        var event CloudWatchAlarm\n        err := json.Unmarshal([]byte(snsRecord.Message), &amp;event)\n        if err != nil {\n            fmt.Println(\"There is an error: \" + err.Error())\n        }\n        fmt.Printf(\"Test Message = %s \\n\", event.NewStateValue)\n        if ( event.NewStateValue == \"ALARM\") {\n            svc := sns.New(session.New())\n  // params will be sent to the publish call included here is the bare minimum params to send a message.\n    params := &amp;sns.PublishInput{\n        Message: Message: aws.String(\"message\"), // This is the message itself (can be XML / JSON / Text - anything you want)\n        TopicArn: aws.String(\"my arn\"),  //Get this from the Topic in the AWS console.\n    }\n\n    resp, err := svc.Publish(params)   //Call to puclish the message\n\n    if err != nil {                    //Check for errors\n        // Print the error, cast err to awserr.Error to get the Code and\n        // Message from an error.\n        fmt.Println(err.Error())\n        return\n    }\n\n    // Pretty-print the response data.\n    fmt.Println(resp)\n}\n        }\n    }\n\n\nfunc main() {\n    lambda.Start(handler)\n}\n</code></pre>\n\n<p>Currently this sends an email to the address set-up in the SNS linked to the ARN above. However I would like the email to include the full, ideally formatted, JSON received by the first SNS. I have the Cloudwatch JSON structure defined in another file, this is being called by <code>var event CloudWatchAlarm</code></p>\n\n<p>Any pointers would be great!</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["javascript", "variables", "go", "communicate"], "comments": [{"owner": {"reputation": 793711, "user_id": 19068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d3229ed1961d2bd81853242493247?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/19068/quentin"}, "edited": false, "score": 2, "creation_date": 1537346634, "post_id": 52401684, "comment_id": 91747229, "body": "Your question is unclear. Where is the Go running? Where is the JavaScript running? Are you talking about writing a module in JavaScript to be used in a Go program? Are you talking about sending messages over a network? Something else?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1537346898, "post_id": 52401684, "comment_id": 91747389, "body": "The short answer is yes. To give the long answer, this question is too broad and also unclear. Obviously you need some kind of communication (between the Go app and the other app that executes the Javascript, e.g. a browser), whether it is simple HTTP requests or websocket or SSE (or something else) is a matter of detail."}, {"owner": {"reputation": 793711, "user_id": 19068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d2d3229ed1961d2bd81853242493247?s=128&d=identicon&r=PG", "display_name": "Quentin", "link": "https://stackoverflow.com/users/19068/quentin"}, "edited": false, "score": 0, "creation_date": 1537346993, "post_id": 52401684, "comment_id": 91747450, "body": "Re edit: Now a <a href=\"https://stackoverflow.com/questions/13840429/what-is-the-difference-between-client-side-and-server-side-programming\">duplicate</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537347359, "post_id": 52401684, "comment_id": 91747653, "body": "Of course there is a way. That&#39;s what networks are for.  But there are literally an infinite number of ways, many common, some uninvented yet. Your question is far too broad.  You might do well to do a little bit of research into AJAX and REST, then come back when you find yourself facing a specific problem."}, {"owner": {"reputation": 21, "user_id": 10082203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d928a320c34c231f0d3ab306a46656?s=128&d=identicon&r=PG", "display_name": "GoPher9", "link": "https://stackoverflow.com/users/10082203/gopher9"}, "edited": false, "score": 0, "creation_date": 1537347570, "post_id": 52401684, "comment_id": 91747776, "body": "Its not a Duplicate thats between php and javascript."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537349441, "post_id": 52401684, "comment_id": 91748910, "body": "No, that question is about client-side vs server-side programming. The languages in use are irrelevant, except as an example."}, {"owner": {"reputation": 21, "user_id": 10082203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d928a320c34c231f0d3ab306a46656?s=128&d=identicon&r=PG", "display_name": "GoPher9", "link": "https://stackoverflow.com/users/10082203/gopher9"}, "edited": false, "score": 0, "creation_date": 1537351914, "post_id": 52401684, "comment_id": 91750469, "body": "I apologies to you all for the lack of clarity in my question. I have done my best to simply my question. Thank you all."}], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 10082203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d928a320c34c231f0d3ab306a46656?s=128&d=identicon&r=PG", "display_name": "GoPher9", "link": "https://stackoverflow.com/users/10082203/gopher9"}, "edited": false, "score": 0, "creation_date": 1537347777, "post_id": 52401866, "comment_id": 91747894, "body": "&quot;This can probably be done by storing the variables in a file rather than in the scripts local storage.&quot; Thank you for your help. I have already successfully used that way. I am specifically asking if it can be done directly between Go and Javascript or if not possible with out the use of things like AJAX and REST and so on."}, {"owner": {"reputation": 21, "user_id": 10082203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d928a320c34c231f0d3ab306a46656?s=128&d=identicon&r=PG", "display_name": "GoPher9", "link": "https://stackoverflow.com/users/10082203/gopher9"}, "edited": false, "score": 0, "creation_date": 1537355030, "post_id": 52401866, "comment_id": 91752463, "body": "I found the answer. <a href=\"https://www.youtube.com/watch?v=IucPdpcyubg\" rel=\"nofollow noreferrer\">youtube.com/watch?v=IucPdpcyubg</a>"}], "tags": [], "owner": {"reputation": 86, "user_id": 7971879, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nxq5O.png?s=128&g=1", "display_name": "Andreto", "link": "https://stackoverflow.com/users/7971879/andreto"}, "is_accepted": true, "score": 1, "last_activity_date": 1537347095, "creation_date": 1537347095, "answer_id": 52401866, "question_id": 52401684, "link": "https://stackoverflow.com/questions/52401684/communicating-variables-between-go-and-javascript/52401866#52401866", "title": "communicating variables between go and javascript", "body": "<p>This can probably be done by storing the variables in a file rather than in the scripts local storage.</p>\n\n<p>When You want to read variable then grab the value from the file and when you want to set variable then write to the file.</p>\n\n<p>The value can be stored in a <em>.txt</em> file but if u have a lot of values that are going to be stored and passed between the programs consider making a <em>.json</em> File.</p>\n"}], "owner": {"reputation": 21, "user_id": 10082203, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8d928a320c34c231f0d3ab306a46656?s=128&d=identicon&r=PG", "display_name": "GoPher9", "link": "https://stackoverflow.com/users/10082203/gopher9"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 385, "favorite_count": 1, "closed_date": 1537347303, "accepted_answer_id": 52401866, "answer_count": 1, "score": -4, "last_activity_date": 1537348644, "creation_date": 1537346476, "last_edit_date": 1537348644, "question_id": 52401684, "link": "https://stackoverflow.com/questions/52401684/communicating-variables-between-go-and-javascript", "closed_reason": "Needs more focus", "title": "communicating variables between go and javascript", "body": "<p>Writing a website connected to a Go backend </p>\n\n<p>I am able to pass data to the html template and thus the front end but can not then use that data for a am missing the code skill in javascript.</p>\n\n<p>How can a Go variable <h3>{{Gopher9}}</h3> be read by javascript code?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 164, "user_id": 4373976, "user_type": "registered", "accept_rate": 67, "profile_image": "https://graph.facebook.com/100000293348468/picture?type=large", "display_name": "Hulii Borys", "link": "https://stackoverflow.com/users/4373976/hulii-borys"}, "edited": false, "score": 0, "creation_date": 1537345715, "post_id": 52401365, "comment_id": 91746674, "body": "Could you share the file with URLs?"}, {"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1537346340, "post_id": 52401365, "comment_id": 91747049, "body": "The panic is at <code>C:&#47;Users&#47;dev&#47;go&#47;src&#47;test&#47;main.go:14</code> or possibly <code>C:&#47;Users&#47;dev&#47;go&#47;src&#47;test&#47;main.go:100</code> , which line in your code is line 14 or line 100 ?"}, {"owner": {"reputation": 19, "user_id": 10289856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aqjWf.jpg?s=128&g=1", "display_name": "Anton Gult", "link": "https://stackoverflow.com/users/10289856/anton-gult"}, "edited": false, "score": 0, "creation_date": 1537346514, "post_id": 52401365, "comment_id": 91747164, "body": "<a href=\"https://pastebin.com/1VnamxSg\" rel=\"nofollow noreferrer\">pastebin.com/1VnamxSg</a> here&#39;s full code"}, {"owner": {"reputation": 3334, "user_id": 204521, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0o1ED.jpg?s=128&g=1", "display_name": "Nikolay", "link": "https://stackoverflow.com/users/204521/nikolay"}, "edited": false, "score": 6, "creation_date": 1537346635, "post_id": 52401365, "comment_id": 91747230, "body": "&quot;\\r\\n&quot; - is end of line symbols in Windows (\\n - in Unixes). You should trim these symbols from end of line. Probably file.txt was created on Windows"}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 1, "last_activity_date": 1537348943, "creation_date": 1537348943, "answer_id": 52402441, "question_id": 52401365, "link": "https://stackoverflow.com/questions/52401365/invalid-character-r-in-host-name-51813/52402441#52402441", "title": "Invalid character &quot;\\r&quot; in host name :51813", "body": "<p>Remove the EOL character.  You may have to use \"\\r\\n\" or \"\\r\"</p>\n\n<pre><code>url += strings.TrimSuffix(array[rand.Intn(len(array))].url, \"\\r\") \n</code></pre>\n"}], "owner": {"reputation": 19, "user_id": 10289856, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aqjWf.jpg?s=128&g=1", "display_name": "Anton Gult", "link": "https://stackoverflow.com/users/10289856/anton-gult"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 728, "favorite_count": 0, "accepted_answer_id": 52402441, "answer_count": 1, "score": -1, "last_activity_date": 1537348943, "creation_date": 1537345436, "last_edit_date": 1537348550, "question_id": 52401365, "link": "https://stackoverflow.com/questions/52401365/invalid-character-r-in-host-name-51813", "title": "Invalid character &quot;\\r&quot; in host name :51813", "body": "<p>Start learning golang with backend aimity. I'm trying to Get.body of webpage at some url. Here's cut of the code.</p>\n\n<pre><code>func AddForm(url string) string {\n    if url == \"\" {\n        data := ReadByIoutil(\"file.txt\") // the file contains several urls\n        array := ParseData(data) // parsing data in T \"Object\" =&gt; Object.url string\n        url = \"https://\"\n        url += array[rand.Intn(len(array))].url // choose randomly 1 among urls\n        log.Print(url)\n    }\n    resp, err := http.Get(url) //get content from url\n    check(err)\n    defer resp.Body.Close()\n    body, err := ioutil.ReadAll(resp.Body)\n    content := string(body)\n    WriteByOs(\"index.html\", content) //save to another file (optionaly)\n    return content\n}\n\n// I practically don't understand this block, but I copied from another place but it works as I wanted\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    url := r.FormValue(\"url\")\n    if url == \"\" {\n        w.Header().Set(\"Content-Type\", \"text/html; charset=utf-8\")\n        url = \"\"\n        //url = \"habr.com\"\n        fmt.Fprint(w, AddForm(url))\n        return\n    }\n}\n</code></pre>\n\n<p>I check structure. Everything is fine => Object.url looks like \"example.com\". Every url in structure is openning well, e.g. google.com, habr.com. Also I get noticed e.g. \"[PREFIX].cppreference.com\" yell error too. But for me it's clear, but still don't understand how to solve this. THE MAIN problem is I got error and not openning url \"stackoverflow.com\":</p>\n\n<pre><code>2018/09/19 12:08:16 https://stackoverflow.com\n2018/09/19 12:08:16 http: panic serving [::1]:51813: parse https://stackoverflow.com\n: invalid character \"\\r\" in host name\ngoroutine 19 [running]:\nnet/http.(*conn).serve.func1(0xc00003c8c0)\n    C:/Go/src/net/http/server.go:1746 +0xd7\npanic(0x665ae0, 0xc0002369f0)\n    C:/Go/src/runtime/panic.go:513 +0x1c7\nmain.check(...)\n    C:/Users/dev/go/src/test/main.go:14\nmain.AddForm(0xc000042800, 0x1b, 0x0, 0x0)\n    C:/Users/dev/go/src/test/main.go:100 +0x2e6\nmain.handler(0x6f1300, 0xc0001447e0, 0xc0000d8c00)\n    C:/Users/dev/go/src/test/main.go:114 +0xb2\nnet/http.HandlerFunc.ServeHTTP(0x6bfb20, 0x6f1300, 0xc0001447e0, 0xc0000d8c00)\n    C:/Go/src/net/http/server.go:1964 +0x4b\nnet/http.(*ServeMux).ServeHTTP(0x899640, 0x6f1300, 0xc0001447e0, 0xc0000d8c00)\n    C:/Go/src/net/http/server.go:2361 +0x12e\nnet/http.serverHandler.ServeHTTP(0xc000048c30, 0x6f1300, 0xc0001447e0, 0xc0000d8c00)\n    C:/Go/src/net/http/server.go:2741 +0xb2\nnet/http.(*conn).serve(0xc00003c8c0, 0x6f1400, 0xc000040280)\n    C:/Go/src/net/http/server.go:1847 +0x64d\ncreated by net/http.(*Server).Serve\n    C:/Go/src/net/http/server.go:2851 +0x2fc\n</code></pre>\n\n<p>what is this? \\r redirect to local language branch? I'm newbie in Network Tech, so still don't know how servers response and what is hidden from users but works with machines.\nSo, comments ask me file.txt. Here (PS. parser works good):</p>\n\n<pre><code>google.com; yandex.ru; habr.com; xakep.ru; stackoverflow.com\n</code></pre>\n"}, {"tags": ["go", "google-bigquery", "avro"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 1623044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d6b75f798bdf88e0e2e3a4568f4d294?s=128&d=identicon&r=PG", "display_name": "jtwatson", "link": "https://stackoverflow.com/users/1623044/jtwatson"}, "is_accepted": false, "score": 1, "last_activity_date": 1537468078, "creation_date": 1537468078, "answer_id": 52431162, "question_id": 52399641, "link": "https://stackoverflow.com/questions/52399641/loading-numeric-data-into-bigquery-with-avro-files-created-with-goavro/52431162#52431162", "title": "Loading Numeric data into BigQuery with Avro files created with goavro", "body": "<p>I figured it out. I need to use bytes.decimal instead of fixed.decimal</p>\n\n<pre><code>{\n  \"type\": \"record\",\n  \"name\": \"MyData\",\n  \"fields\": [\n    {\n      \"name\": \"ID\",\n      \"type\": [\n        \"string\"\n      ]\n    },\n    {\n      \"name\": \"Cost\",\n      \"type\": [\n        \"null\",\n        {\n          \"type\": \"bytes\",\n          \"logicalType\": \"decimal\",\n          \"precision\": 4,\n          \"scale\": 2\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>Then encode similarly </p>\n\n<pre><code>map[string]interface{}{\"bytes.decimal\": big.NewRat(617, 50)}\n</code></pre>\n\n<p>And it works nicely!</p>\n"}], "owner": {"reputation": 43, "user_id": 1623044, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d6b75f798bdf88e0e2e3a4568f4d294?s=128&d=identicon&r=PG", "display_name": "jtwatson", "link": "https://stackoverflow.com/users/1623044/jtwatson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537468078, "creation_date": 1537339236, "last_edit_date": 1537365648, "question_id": 52399641, "link": "https://stackoverflow.com/questions/52399641/loading-numeric-data-into-bigquery-with-avro-files-created-with-goavro", "title": "Loading Numeric data into BigQuery with Avro files created with goavro", "body": "<p>I am trying to figure out how to load dollar values into a Numeric column in BigQuery using an Avro file. I am using golang and the <a href=\"https://github.com/linkedin/goavro\" rel=\"nofollow noreferrer\">goavro</a> package to generate the avro file.</p>\n\n<p>It appears that the appropriate datatype in go to handle money is big.Rat.</p>\n\n<p>BigQuery <a href=\"https://cloud.google.com/bigquery/docs/loading-data-cloud-storage-avro#decimal_logical_type\" rel=\"nofollow noreferrer\">documentation</a> indicates it should be possible to use Avro for this.</p>\n\n<p>I can see from a few <a href=\"https://github.com/linkedin/goavro/blob/05dc57f3d804f985f554fbd6da9011aac77da68e/logical_type_test.go#L82\" rel=\"nofollow noreferrer\">goavro test cases</a> that encoding a *big.Rat into a fixed.decimal type is possible.</p>\n\n<p>I am using a goavro.OCFWriter to encode data using a simple avro schema as follows:</p>\n\n<pre><code>{\n  \"type\": \"record\",\n  \"name\": \"MyData\",\n  \"fields\": [\n    {\n      \"name\": \"ID\",\n      \"type\": [\n        \"string\"\n      ]\n    },\n    {\n      \"name\": \"Cost\",\n      \"type\": [\n        \"null\",\n        {\n          \"type\": \"fixed\",\n          \"size\": 12,\n          \"logicalType\": \"decimal\",\n          \"precision\": 4,\n          \"scale\": 2\n        }\n      ]\n    }\n  ]\n}\n</code></pre>\n\n<p>I am attempting to Append data with the \"Cost\" field as follows:</p>\n\n<pre><code>map[string]interface{}{\"fixed.decimal\": big.NewRat(617, 50)}\n</code></pre>\n\n<p>This is successfully encoded, but the resulting avro file fails to load into BigQuery:</p>\n\n<pre><code>Err: load Table MyTable Job: {Location: \"\"; Message: \"Error while reading data, error message: The Apache Avro library failed to parse the header with the following error: Missing Json field \\\"name\\\": {\\\"logicalType\\\":\\\"decimal\\\",\\\"precision\\\":4,\\\"scale\\\":2,\\\"size\\\":12,\\\"type\\\":\\\"fixed\\\"}\"; Reason: \"invalid\"}\n</code></pre>\n\n<p>So am doing something wrong here... Hoping someone can point me in the right direction.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1537346917, "post_id": 52398682, "comment_id": 91747409, "body": "The first does a copy and returns the address of the copy."}], "answers": [{"comments": [{"owner": {"reputation": 141, "user_id": 1564929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543eec43aec6889bfb4c1f2e83f431dd?s=128&d=identicon&r=PG", "display_name": "uakf.b", "link": "https://stackoverflow.com/users/1564929/uakf-b"}, "edited": false, "score": 1, "creation_date": 1537335710, "post_id": 52398717, "comment_id": 91741658, "body": "Adam Smith, I can&#39;t comment on your answer so I am commenting here. I believe yours shows the same pointer value because you are using nil value of the struct, which is handled specially. If you update the struct to have a field like <code>type G struct { x string }</code>, and then use <code>g := &amp;G{&quot;&quot;}</code>, your same code produces different pointer values."}, {"owner": {"reputation": 141, "user_id": 1564929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543eec43aec6889bfb4c1f2e83f431dd?s=128&d=identicon&r=PG", "display_name": "uakf.b", "link": "https://stackoverflow.com/users/1564929/uakf-b"}, "edited": false, "score": 0, "creation_date": 1537336226, "post_id": 52398717, "comment_id": 91741833, "body": "Actually it produces different pointers even if you use nil value for this non-empty struct, user2357112 wrote the real reason in comment on your answer now."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1537336228, "post_id": 52398717, "comment_id": 91741834, "body": "if you replace &quot;nil value&quot; with  &quot;a value with zero size&quot;, then you are correct."}, {"owner": {"reputation": 141, "user_id": 1564929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543eec43aec6889bfb4c1f2e83f431dd?s=128&d=identicon&r=PG", "display_name": "uakf.b", "link": "https://stackoverflow.com/users/1564929/uakf-b"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1537336270, "post_id": 52398717, "comment_id": 91741850, "body": "ThunderCat: yup thanks, I thought it was for a different reason."}], "tags": [], "owner": {"reputation": 141, "user_id": 1564929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543eec43aec6889bfb4c1f2e83f431dd?s=128&d=identicon&r=PG", "display_name": "uakf.b", "link": "https://stackoverflow.com/users/1564929/uakf-b"}, "is_accepted": true, "score": 6, "last_activity_date": 1537335004, "creation_date": 1537335004, "answer_id": 52398717, "question_id": 52398682, "link": "https://stackoverflow.com/questions/52398682/pointers-in-golang/52398717#52398717", "title": "Pointers in golang", "body": "<p>In the first one, you allocate a new memory region by declaring obj. In the second, you simply reference the value at g, which is just g.</p>\n"}, {"comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 3, "creation_date": 1537335637, "post_id": 52398756, "comment_id": 91741632, "body": "Try it with a <a href=\"https://play.golang.org/p/WFxU4NLYxIK\" rel=\"nofollow noreferrer\">non-empty struct</a>, and you&#39;ll get different results. I&#39;m surprised things turned out the way they did for an empty struct; I can see why that would be valid behavior in some languages, particularly since an empty struct should be immutable, but I&#39;m surprised such behavior is considered valid in Go."}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 7, "creation_date": 1537335957, "post_id": 52398756, "comment_id": 91741735, "body": "Apparently this behavior for empty structs is explicitly allowed by the spec: &quot;Two distinct zero-size variables may have the same address in memory.&quot;"}, {"owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "reply_to_user": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1537387789, "post_id": 52398756, "comment_id": 91770755, "body": "Very interesting! Thanks all!"}], "tags": [], "owner": {"reputation": 44495, "user_id": 3058609, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/2c0357556707713572abbf637a907ef9?s=128&d=identicon&r=PG&f=1", "display_name": "Adam Smith", "link": "https://stackoverflow.com/users/3058609/adam-smith"}, "is_accepted": false, "score": -1, "last_activity_date": 1537335231, "creation_date": 1537335231, "answer_id": 52398756, "question_id": 52398682, "link": "https://stackoverflow.com/questions/52398682/pointers-in-golang/52398756#52398756", "title": "Pointers in golang", "body": "<p>I'm not convinced that it's not the same.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype G struct {\n\n}\n\nfunc foo(g *G) (*G, error) {\n  return &amp;(*g), nil\n}\n\nfunc bar(g *G) (*G, error) {\n  obj := (*g)\n  return &amp;obj, nil\n}\n\nfunc main() {\n  g := &amp;G{}\n\n  a, _ := foo(g)\n  b, _ := bar(g)\n\n  fmt.Printf(\"a: %p, b: %p\\n\", a, b)  // gives the same pointer value\n}\n</code></pre>\n\n<p><a href=\"https://repl.it/repls/ZealousThriftyConditions\" rel=\"nofollow noreferrer\">Try it here</a></p>\n"}], "owner": {"reputation": 3865, "user_id": 4829408, "user_type": "registered", "accept_rate": 49, "profile_image": "https://www.gravatar.com/avatar/9ff8f70cf1f3f172084d5042abf22d64?s=128&d=identicon&r=PG&f=1", "display_name": "Src", "link": "https://stackoverflow.com/users/4829408/src"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 52398717, "answer_count": 2, "score": 1, "last_activity_date": 1537335231, "creation_date": 1537334831, "question_id": 52398682, "link": "https://stackoverflow.com/questions/52398682/pointers-in-golang", "title": "Pointers in golang", "body": "<p>Why this:</p>\n\n<pre><code>obj := *g\nreturn &amp;obj, nil\n</code></pre>\n\n<p>is not equal to this:</p>\n\n<pre><code>return &amp;(*g), nil\n</code></pre>\n\n<p>Shouldn't it be working in the same way (Return pointer that is pointing to the new memory region with the data from <code>g</code> struct)? </p>\n"}, {"tags": ["file", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1537333787, "post_id": 52398388, "comment_id": 91741014, "body": "Find line, write after that line your data, save file.  Have you tried this?"}], "answers": [{"tags": [], "owner": {"reputation": 141, "user_id": 1564929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/543eec43aec6889bfb4c1f2e83f431dd?s=128&d=identicon&r=PG", "display_name": "uakf.b", "link": "https://stackoverflow.com/users/1564929/uakf-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1537334494, "creation_date": 1537334494, "answer_id": 52398626, "question_id": 52398388, "link": "https://stackoverflow.com/questions/52398388/append-in-between-of-a-file-in-golang/52398626#52398626", "title": "Append in between of a file in Golang", "body": "<p>On disk, a file (a sequence of bytes) is stored similarly to an array.</p>\n\n<p>Thus, appending to the middle of the file requires shifting the bytes after the point that you write to.</p>\n\n<p>Then, suppose you have an index <code>idx</code> where you want to append, and some bytes <code>b</code> to write. The simplest (but not necessarily most efficient) way to append in the middle of a file would involve reading the file at <code>f[idx:]</code>, writing <code>b</code> to <code>f[idx:idx+len(b)]</code>, and then writing the bytes that you read in the first step:</p>\n\n<pre><code>// idx is the index you want to write to, b is the bytes you want to write\n\n// warning from https://godoc.org/os#File.Seek:\n// \"The behavior of Seek on a file opened with O_APPEND is not specified.\"\n// so you should not pass O_APPEND when you are using the file this way\nif _, err := f.Seek(idx, 0); err != nil {\n    panic(err)\n}\nremainder, err := ioutil.ReadAll(f)\nif err != nil {\n    panic(err)\n}\nf.Seek(idx, 0)\nf.Write(b)\nf.Write(remainder)\n</code></pre>\n\n<p>Depending on what you're doing, it may make more sense to read the file line by line and write adjusted lines to a new file, and then rename the new file to the old filename.</p>\n"}], "owner": {"reputation": 107, "user_id": 5780608, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f17fa3cec17273e3a38f9bb2817d9da7?s=128&d=identicon&r=PG&f=1", "display_name": "Aditi Singh", "link": "https://stackoverflow.com/users/5780608/aditi-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1240, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537334494, "creation_date": 1537333233, "question_id": 52398388, "link": "https://stackoverflow.com/questions/52398388/append-in-between-of-a-file-in-golang", "title": "Append in between of a file in Golang", "body": "<p>I can append anything new at the end of file in Golang like this</p>\n\n<pre><code>f, err := os.OpenFile(filename, os.O_APPEND|os.O_WRONLY, 0600)\nif err != nil {\n    panic(err)\n}\n\ndefer f.Close()\n\nif _, err = f.WriteString(text); err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>But how can I append something in the middle of a file or after some particular line or text?</p>\n"}, {"tags": ["parsing", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1537333152, "post_id": 52398311, "comment_id": 91740816, "body": "How you decide how many zeros should lead? Why <code>0093</code> and not <code>00930000000</code> or <code>0000000930000000</code>?"}, {"owner": {"reputation": 9, "user_id": 4551562, "user_type": "registered", "profile_image": "https://graph.facebook.com/1599910663574571/picture?type=large", "display_name": "Taimoor Shaukat", "link": "https://stackoverflow.com/users/4551562/taimoor-shaukat"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1537333379, "post_id": 52398311, "comment_id": 91740872, "body": "i need integer in four digits from 0 to 9999. So if got 93 i format it into 0093 string and now i want to this string exact as 0093 in type integer."}, {"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 5, "creation_date": 1537333474, "post_id": 52398311, "comment_id": 91740900, "body": "You have misunderstand what is integer."}, {"owner": {"reputation": 9, "user_id": 4551562, "user_type": "registered", "profile_image": "https://graph.facebook.com/1599910663574571/picture?type=large", "display_name": "Taimoor Shaukat", "link": "https://stackoverflow.com/users/4551562/taimoor-shaukat"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1537333712, "post_id": 52398311, "comment_id": 91740983, "body": "So there is no use case for this in type integer?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 5, "creation_date": 1537335884, "post_id": 52398311, "comment_id": 91741710, "body": "There&#39;s no such thing as a 0-leading integer. However, you <i>can</i> output an integer with leading zeros. But the integer of value 093 is identical to the integer of value 93."}, {"owner": {"reputation": 9, "user_id": 4551562, "user_type": "registered", "profile_image": "https://graph.facebook.com/1599910663574571/picture?type=large", "display_name": "Taimoor Shaukat", "link": "https://stackoverflow.com/users/4551562/taimoor-shaukat"}, "edited": false, "score": 0, "creation_date": 1537339248, "post_id": 52398311, "comment_id": 91743234, "body": "thank you i was looking a solution to get this"}], "answers": [{"tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": true, "score": 2, "last_activity_date": 1537343022, "creation_date": 1537343022, "answer_id": 52400685, "question_id": 52398311, "link": "https://stackoverflow.com/questions/52398311/convert-string-into-exact-same-int/52400685#52400685", "title": "Convert String into exact same Int", "body": "<p>From the docs for the <code>fmt</code> package:</p>\n\n<pre><code>Width is specified by an optional decimal number immediately preceding the verb. If absent, the width is whatever is necessary to represent the value.\n...\nOther flags: \n0   pad with leading zeros rather than spaces;\n    for numbers, this moves the padding after the sign\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/fmt/</a></p>\n\n<p>If you combine these two things then you get the code:</p>\n\n<pre><code>fmt.Printf(\"i=%04d, type: %T\\n\", i, i)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/lR77KoCswv_B\" rel=\"nofollow noreferrer\">https://play.golang.org/p/lR77KoCswv_B</a></p>\n"}], "owner": {"reputation": 9, "user_id": 4551562, "user_type": "registered", "profile_image": "https://graph.facebook.com/1599910663574571/picture?type=large", "display_name": "Taimoor Shaukat", "link": "https://stackoverflow.com/users/4551562/taimoor-shaukat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 52400685, "answer_count": 1, "score": -3, "last_activity_date": 1537343022, "creation_date": 1537332775, "question_id": 52398311, "link": "https://stackoverflow.com/questions/52398311/convert-string-into-exact-same-int", "title": "Convert String into exact same Int", "body": "<p>How can i convert string into integer without removing the 0 digit prefix from start. Use case like this i have a string like \"0093\" and i want to convert same as 0093 in integer. I try strconv but problem is this package remove 00 prefix from 0093 after conversion. can any one have better solution for this problem.</p>\n\n<pre><code>s := \"0093\"\n  if i, err := strconv.Atoi(s); err == nil {\n  fmt.Printf(\"i=%d, type: %T\\n\", i, i)\n}\n</code></pre>\n\n<p>output is 93 but i want exact 0093 in int type.</p>\n"}, {"tags": ["multithreading", "go", "timer", "goroutine"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1537331442, "post_id": 52397775, "comment_id": 91740341, "body": "<a href=\"https://golang.org/ref/spec#Handling_panics\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Handling_panics</a>"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1537360365, "post_id": 52397775, "comment_id": 91755584, "body": "probably worth mentioning that goroutines are not the same as threads"}], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 2, "last_activity_date": 1537351667, "creation_date": 1537351667, "answer_id": 52403359, "question_id": 52397775, "link": "https://stackoverflow.com/questions/52397775/how-to-keep-main-thread-running-even-though-routine-has-runtime-error-occurr/52403359#52403359", "title": "How to &quot;keep main thread running&quot; even though routine has &quot;runtime error&quot; occurred in Golang?", "body": "<p>use the defer/ recover feature</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"math/rand\"\n)\n\nfunc main() {\n\n    ticker := time.NewTicker(1*1000 * time.Millisecond)\n    for _ = range ticker.C {\n        rand.Seed(time.Now().Unix())\n        divisor := rand.Intn(20)\n        go calculate(divisor)\n    }\nfmt.Println(\"that's all\")\n}\n\n\n\nfunc calculate(divisor int){\ndefer func() {\n        if r := recover(); r != nil {\n            fmt.Println(\"Recovered in f\", r)\n        }\n    }()\n    result:= 100/divisor\n    fmt.Printf(\"1/%d=\", divisor)\n    fmt.Println(result)\n}\n</code></pre>\n"}], "owner": {"reputation": 115, "user_id": 10125197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/86b25799321a9bc9e1bdc81648217145?s=128&d=identicon&r=PG&f=1", "display_name": "spartaslave", "link": "https://stackoverflow.com/users/10125197/spartaslave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 643, "favorite_count": 0, "accepted_answer_id": 52403359, "answer_count": 1, "score": 0, "last_activity_date": 1537351667, "creation_date": 1537329194, "last_edit_date": 1537329731, "question_id": 52397775, "link": "https://stackoverflow.com/questions/52397775/how-to-keep-main-thread-running-even-though-routine-has-runtime-error-occurr", "title": "How to &quot;keep main thread running&quot; even though routine has &quot;runtime error&quot; occurred in Golang?", "body": "<p>I am new to Goland and I did Java in the past. I've written a Golang function to calculate the integer number part of the result. What I am thinking is using a timer to do the calculation and generate the random number. But one problem I met is if the routine has some error, the main thread will stop. Is there any way to keep the main thread running? Even though there are errors in routine?</p>\n\n<p>Below is the code for test:</p>\n\n<pre><code>func main() {\n    ticker := time.NewTicker(1*1000 * time.Millisecond)\n    for _ = range ticker.C {\n        rand.Seed(time.Now().Unix())\n        divisor := rand.Intn(20)\n        go calculate(divisor)\n    }\n}\n\nfunc calculate(divisor int){\n    result:= 100/divisor\n    fmt.Print(\"1/\"+strconv.Itoa(divisor)+\"=\")\n    fmt.Println(result)\n}\n</code></pre>\n\n<p>As the error handling for Golang really confused me, as what I am thinking is the error occurs in the \"thread\", the main function is just responsible to create the thread and assign task, it should never mind whether there are exceptions occurs in the \"threads\" and main should always keep going. If I do this in Java, I could use try catch to surround with </p>\n\n<pre><code>try{\n    result = 1/divisor;\n}\ncatch(Exception e){\n    e.printTrace();\n}\n</code></pre>\n\n<p>even every time I give divisor a 0 value in a separate thread, the main progress will not exit, but for Golang, I think </p>\n\n<pre><code>go calculate(divisor)\n</code></pre>\n\n<p>is opening a new \"thread\" and run calculate\ninside the \"thread\", but why the main progress will quit.\nIs there any possible method to prevent the main progress to quit?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "error-handling", "panic"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1537331587, "post_id": 52397049, "comment_id": 91740376, "body": "<a href=\"https://golang.org/ref/spec#Handling_panics\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Handling_panics</a> But you cannot convert errors to panics. And yes. That <i>is</i> bad practice, very bad indeed."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537364294, "post_id": 52397049, "comment_id": 91758104, "body": "Errors are returned for a reason, and not handling them will lead to defects."}], "answers": [{"tags": [], "owner": {"reputation": 6761, "user_id": 664345, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/34de936228acd10be7665e5c73c53d92?s=128&d=identicon&r=PG", "display_name": "Liyan Chang", "link": "https://stackoverflow.com/users/664345/liyan-chang"}, "is_accepted": false, "score": 2, "last_activity_date": 1537327302, "creation_date": 1537327302, "answer_id": 52397529, "question_id": 52397049, "link": "https://stackoverflow.com/questions/52397049/intercepting-errors-and-panics-in-go/52397529#52397529", "title": "Intercepting errors and panics in Go", "body": "<p>Errors are just values in go. Just like there's no way to intercept any time a function returns a string, there's no way to intercept errors.</p>\n"}], "owner": {"reputation": 382, "user_id": 7479934, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100007344395075/picture?type=large", "display_name": "Amanda Ferrari", "link": "https://stackoverflow.com/users/7479934/amanda-ferrari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1537327302, "creation_date": 1537323176, "question_id": 52397049, "link": "https://stackoverflow.com/questions/52397049/intercepting-errors-and-panics-in-go", "title": "Intercepting errors and panics in Go", "body": "<p>I'm creating a CLI just to learn a bit more about Go. Is it possible to intercept all errors and panics, so I can have one unique place to handle them, and also format it and after print to stdout.</p>\n\n<p>Example:</p>\n\n<p>Instead of using:</p>\n\n<pre><code>x, err := doSomething()\nif err != nil {\n  errorHandler.Handler(err)\n}\n</code></pre>\n\n<p>I could just use initialize the code that can intercept all errors before doing anything:</p>\n\n<pre><code>errorHandler.New()\n</code></pre>\n\n<p>And then I could just \"ignore\" all errors:</p>\n\n<pre><code>x, _ := doSomething()\n</code></pre>\n\n<p>Is that a bad practice with Go?</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 2359, "user_id": 405454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/IDzwW.png?s=128&g=1", "display_name": "mhutter", "link": "https://stackoverflow.com/users/405454/mhutter"}, "edited": false, "score": 1, "creation_date": 1537319275, "post_id": 52396248, "comment_id": 91737822, "body": "Out of curiosity, what are you trying to accomplish?"}, {"owner": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "reply_to_user": {"reputation": 2359, "user_id": 405454, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/IDzwW.png?s=128&g=1", "display_name": "mhutter", "link": "https://stackoverflow.com/users/405454/mhutter"}, "edited": false, "score": 1, "creation_date": 1537319437, "post_id": 52396248, "comment_id": 91737849, "body": "Elasticsearch abstraction for queries. The query returns json which I want to convert to struct. The kind of struct is known only at run time."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1537382934, "post_id": 52396248, "comment_id": 91768518, "body": "@joe Do you want to create a slice of the given type, or do you want a slice of []interface{} with values of the given type?"}, {"owner": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "edited": false, "score": 0, "creation_date": 1537383457, "post_id": 52396248, "comment_id": 91768742, "body": "i just want to get list/array of a given type. Basically i want this type to be passed in to a utility function and return a list/slice of that type as result"}], "answers": [{"comments": [{"owner": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "edited": false, "score": 0, "creation_date": 1537319097, "post_id": 52396406, "comment_id": 91737790, "body": "Thanks !! I thought about doing this as a workaround with New(). But I thought there should be a way to do it in one step. I can do this in C in one step!!"}, {"owner": {"reputation": 602, "user_id": 6638523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lb7L5.jpg?s=128&g=1", "display_name": "Xian Shu", "link": "https://stackoverflow.com/users/6638523/xian-shu"}, "reply_to_user": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "edited": false, "score": 0, "creation_date": 1537320024, "post_id": 52396406, "comment_id": 91737979, "body": "@joe, I think there is no another simple way in go like in Js or java lambda. What you want to do is initializing a set object but not a simple obj, so, there is no syntactic sugar to complete your want."}], "tags": [], "owner": {"reputation": 602, "user_id": 6638523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lb7L5.jpg?s=128&g=1", "display_name": "Xian Shu", "link": "https://stackoverflow.com/users/6638523/xian-shu"}, "is_accepted": false, "score": 2, "last_activity_date": 1537317902, "creation_date": 1537317902, "answer_id": 52396406, "question_id": 52396248, "link": "https://stackoverflow.com/questions/52396248/how-to-make-array-of-elements-with-type-specified-at-run-time/52396406#52396406", "title": "How to Make array of elements with type specified at run time", "body": "<p>Just make like :</p>\n\n<pre><code>b := make([]interface{}, 10)\nfor i := range b {\n    b[i] = reflect.Zero(a)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "edited": false, "score": 0, "creation_date": 1537382251, "post_id": 52396661, "comment_id": 91768188, "body": "I think this is near best solution for the question. But it surprises me the level of implementation complexity in go for a seemingly simple requirement. I believe, for the practical purposes @xian Shu&#39;s answer above is better."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "edited": false, "score": 0, "creation_date": 1537383023, "post_id": 52396661, "comment_id": 91768560, "body": "@joe  This answer creates a slice of the given type which I assumed you were asking.  If you want a []interface{}, then the other answer is correct."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "edited": false, "score": 0, "creation_date": 1537383098, "post_id": 52396661, "comment_id": 91768593, "body": "@joe I agree that this is complex, but there&#39;s probably as simpler solution to whatever your higher-level problem is. Applications can usually rely on the json/encoding package to do all of the heavy lifting as far as reflection is concerned."}, {"owner": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "edited": false, "score": 0, "creation_date": 1537383464, "post_id": 52396661, "comment_id": 91768746, "body": "i just want to get list/array of a given type. Basically i want this type to be passed in to a utility function and return a list/slice of that type as result"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "edited": false, "score": 0, "creation_date": 1537386427, "post_id": 52396661, "comment_id": 91770142, "body": "The other answer does not create a slice of the given type. This answer does."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1537335630, "last_edit_date": 1537335630, "creation_date": 1537320075, "answer_id": 52396661, "question_id": 52396248, "link": "https://stackoverflow.com/questions/52396248/how-to-make-array-of-elements-with-type-specified-at-run-time/52396661#52396661", "title": "How to Make array of elements with type specified at run time", "body": "<p>Get the type for a slice given a value of the element type, <code>v</code>:</p>\n\n<pre><code>sliceType := reflect.SliceOf(reflect.TypeOf(v))\n</code></pre>\n\n<p>Create a slice with length and capacity (both 10 here).</p>\n\n<pre><code>slice:= reflect.MakeSlice(sliceType, 10, 10)\n</code></pre>\n\n<p>Depending on what you are doing, you may want to get the actual slice value by calling Interface() on the reflect.Value:</p>\n\n<pre><code>s := slice.Interface()\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/jcGCSEap3z0\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}], "owner": {"reputation": 1033, "user_id": 2841441, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c636f049b64847e01e361422b22f3c22?s=128&d=identicon&r=PG&f=1", "display_name": "joe", "link": "https://stackoverflow.com/users/2841441/joe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 52396661, "answer_count": 2, "score": 0, "last_activity_date": 1537364454, "creation_date": 1537316481, "last_edit_date": 1537364454, "question_id": 52396248, "link": "https://stackoverflow.com/questions/52396248/how-to-make-array-of-elements-with-type-specified-at-run-time", "title": "How to Make array of elements with type specified at run time", "body": "<p>I am trying to create a array of elements with a type known only at the run time (a pkg API gets to retrieve elements in json and convert to struct). I have a helper function something like below, which takes an interface as a param and trying to get the type of interface while calling make. </p>\n\n<p>golang compiler doesn't seems to like it. </p>\n\n<pre><code>var whatAmI = func(i interface{}) { \n        a := reflect.TypeOf(i)\n\n        //var typ reflect.Type = a\n\n        b := make (a, 10)    //10 elem with type of i\n\n        //b := new (typ)\n        fmt.Printf (\"a: %v b: %v\", a, b)\n}\n</code></pre>\n\n<p>prog.go:21:14: a is not a type</p>\n\n<p>I tried various combinations of reflects but no help so far. \nThis seems to me can be a common problem to run in to. How can I solve/workaround this?</p>\n"}, {"tags": ["ssl", "go", "ssl-certificate"], "answers": [{"tags": [], "owner": {"reputation": 1114, "user_id": 8190553, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6OTwb.png?s=128&g=1", "display_name": "will7200", "link": "https://stackoverflow.com/users/8190553/will7200"}, "is_accepted": false, "score": 0, "last_activity_date": 1572890419, "creation_date": 1572890419, "answer_id": 58698792, "question_id": 52396154, "link": "https://stackoverflow.com/questions/52396154/how-do-i-add-trusted-certificate-for-golang/58698792#58698792", "title": "How do I add trusted certificate for golang", "body": "<p>According to the go <a href=\"https://golang.org/pkg/crypto/x509/\" rel=\"nofollow noreferrer\">docs</a></p>\n\n<blockquote>\n  <p>On UNIX systems the environment variables SSL_CERT_FILE and\n  SSL_CERT_DIR can be used to override the system default locations for\n  the SSL certificate file and SSL certificate files directory,\n  respectively.</p>\n</blockquote>\n\n<p>Sample</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>SSL_CERT_FILE=/path/to/x509_encoded_cert_file dep ensure\nSSL_CERT_DIR=/path/to/dir/ dep ensure\n</code></pre>\n"}], "owner": {"reputation": 2483, "user_id": 1701504, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/d92822259e255fc18dcce53ae5403331?s=128&d=identicon&r=PG", "display_name": "Kintar\u014d", "link": "https://stackoverflow.com/users/1701504/kintar%c5%8d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1138, "favorite_count": 1, "answer_count": 1, "score": 4, "last_activity_date": 1572890419, "creation_date": 1537315596, "question_id": 52396154, "link": "https://stackoverflow.com/questions/52396154/how-do-i-add-trusted-certificate-for-golang", "title": "How do I add trusted certificate for golang", "body": "<p>I am trying to use go get or godep to pull some dependency for my project but I see this in my mac</p>\n\n<pre><code>KALEI-M-V11L:election kalei$ dep ensure\nThe following issues were found in Gopkg.toml:\n\n  \u2717 unable to deduce repository and source type for \"k8s.io/apiextensions-apiserver\": unable to read metadata: unable to fetch raw metadata: failed HTTP request to URL \"http://k8s.io/apiextensions-apiserver?go-get=1\": Get https://k8s.io/apiextensions-apiserver?go-get=1: x509: certificate signed by unknown authority\n  \u2717 unable to deduce repository and source type for \"k8s.io/apimachinery\": unable to read metadata: unable to fetch raw metadata: failed HTTP request to URL \"http://k8s.io/apimachinery?go-get=1\": Get https://k8s.io/apimachinery?go-get=1: x509: certificate signed by unknown authority\n  \u2717 unable to deduce repository and source type for \"k8s.io/client-go\": unable to read metadata: unable to fetch raw metadata: failed HTTP request to URL \"http://k8s.io/client-go?go-get=1\": Get https://k8s.io/client-go?go-get=1: x509: certificate signed by unknown authority\n  \u2717 unable to deduce repository and source type for \"sigs.k8s.io/controller-runtime\": unable to read metadata: unable to fetch raw metadata: failed HTTP request to URL \"http://sigs.k8s.io/controller-runtime?go-get=1\": Get https://sigs.k8s.io/controller-runtime?go-get=1: x509: certificate signed by unknown authority\n  \u2717 unable to deduce repository and source type for \"k8s.io/code-generator\": unable to read metadata: unable to fetch raw metadata: failed HTTP request to URL \"http://k8s.io/code-generator?go-get=1\": Get https://k8s.io/code-generator?go-get=1: x509: certificate signed by unknown authority\n  \u2717 unable to deduce repository and source type for \"k8s.io/api\": unable to read metadata: unable to fetch raw metadata: failed HTTP request to URL \"http://k8s.io/api?go-get=1\": Get https://k8s.io/api?go-get=1: x509: certificate signed by unknown authority\n</code></pre>\n\n<p>If I do curl to <a href=\"https://k8s.io/api?go-get=1\" rel=\"nofollow noreferrer\">https://k8s.io/api?go-get=1</a>, it works perfectly so looks like go doesn't trust the cert somehow.</p>\n\n<p>Is there a way to configure it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1537331870, "post_id": 52396076, "comment_id": 91740461, "body": "You read Go code from left to right like normal english (not in spirals like C or kinda backwards like Java). <code>[]</code> &quot;slice of&quot; <code>func</code> function, <code>(</code> &quot;from argument&quot;, <code>*</code> pointer to, <code>someType</code> &quot;someType&quot;, <code>)</code> &quot;returning an&quot;, <code>error</code> &quot;error&quot;. Could not be much simpler."}], "answers": [{"tags": [], "owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "is_accepted": true, "score": 5, "last_activity_date": 1537573701, "last_edit_date": 1537573701, "creation_date": 1537315404, "answer_id": 52396125, "question_id": 52396076, "link": "https://stackoverflow.com/questions/52396076/what-does-a-function-array-syntax-in-go-mean/52396125#52396125", "title": "What does a function array syntax in go mean?", "body": "<p>This declares and initializes a variable <code>list</code> as a <a href=\"https://tour.golang.org/moretypes/7\" rel=\"nofollow noreferrer\">slice</a> whose elements are functions with signature <code>func(*someType) error</code>.</p>\n\n<p>Slices in Go are convenient mechanisms for representing sequences of data of a particular type. They have type <code>[]T</code> for any element type <code>T</code> (but remember Go does not have generics). A slice is defined only by the type of the items it contains; its length is not part of its type definition and can change at runtime. (Arrays in Go, by contrast, are of fixed length - their type is <code>[N]T</code> for length <code>N</code> and element type <code>T</code>).</p>\n\n<p>Under the surface, a slice consists of a backing array, a length of the current data and a capacity. The runtime manages the memory allocation of the array to accommodate all data in the slice.</p>\n"}, {"tags": [], "owner": {"reputation": 602, "user_id": 6638523, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lb7L5.jpg?s=128&g=1", "display_name": "Xian Shu", "link": "https://stackoverflow.com/users/6638523/xian-shu"}, "is_accepted": false, "score": 1, "last_activity_date": 1537316400, "creation_date": 1537316400, "answer_id": 52396242, "question_id": 52396076, "link": "https://stackoverflow.com/questions/52396076/what-does-a-function-array-syntax-in-go-mean/52396242#52396242", "title": "What does a function array syntax in go mean?", "body": "<p><code>func</code> in go is a type like <code>int</code>,<code>string</code>...</p>\n\n<p>So they are sample syntax:</p>\n\n<pre><code>var listInt := []int{1,2,3}\nvar listStr := []string{\"1\",\"2\",\"3\"}\nvar listFunc := []func(param anyType) anyType {\n    func(param anyType) anyType { ... return new(anyType) },\n    func(param anyType) anyType { ... return new(anyType) },\n}\n</code></pre>\n"}], "owner": {"reputation": 4402, "user_id": 2458372, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/2851994e4c578a7caac9e89421522294?s=128&d=identicon&r=PG", "display_name": "JavaDeveloper", "link": "https://stackoverflow.com/users/2458372/javadeveloper"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 52396125, "answer_count": 2, "score": 0, "last_activity_date": 1537573701, "creation_date": 1537314868, "question_id": 52396076, "link": "https://stackoverflow.com/questions/52396076/what-does-a-function-array-syntax-in-go-mean", "title": "What does a function array syntax in go mean?", "body": "<pre><code>var list = []func(*someType) error {\n        ...\n    }\n</code></pre>\n\n<p>I am new to Go and I am trying to understand what does the syntax mean ? \nIs the return of function an array? </p>\n"}, {"tags": ["string", "go", "utf-8", "slice"], "comments": [{"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "edited": false, "score": 1, "creation_date": 1537317221, "post_id": 52395730, "comment_id": 91737427, "body": "You may find <a href=\"https://stackoverflow.com/questions/14387748/proper-way-to-release-string-for-garbage-collection-after-slicing\" title=\"proper way to release string for garbage collection after slicing\">stackoverflow.com/questions/14387748/&hellip;</a> helfpul"}], "answers": [{"comments": [{"owner": {"reputation": 1146, "user_id": 2359945, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZnZP0.jpg?s=128&g=1", "display_name": "Razzle Shazl", "link": "https://stackoverflow.com/users/2359945/razzle-shazl"}, "edited": false, "score": 0, "creation_date": 1537319683, "post_id": 52396083, "comment_id": 91737910, "body": "Great write-up, thank you.  Could you clarify &quot; So making a copy of a slice isn&#39;t a big deal for memory allocation or performance -- it&#39;s when a new array has to be allocated that an impact is felt.&quot; by rephrasing to something like ..."}, {"owner": {"reputation": 1146, "user_id": 2359945, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZnZP0.jpg?s=128&g=1", "display_name": "Razzle Shazl", "link": "https://stackoverflow.com/users/2359945/razzle-shazl"}, "edited": false, "score": 0, "creation_date": 1537319749, "post_id": 52396083, "comment_id": 91737920, "body": "&quot;Reslicing a string allocates no new memory, not even a new slice, rather it just updates the fields of the slice&quot;"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 1146, "user_id": 2359945, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZnZP0.jpg?s=128&g=1", "display_name": "Razzle Shazl", "link": "https://stackoverflow.com/users/2359945/razzle-shazl"}, "edited": false, "score": 0, "creation_date": 1537322272, "post_id": 52396083, "comment_id": 91738440, "body": "@RazzleShazl You are correct that re-slicing, i.e. <code>foo = foo[1:]</code>, does not require a new allocation, just updating the slice &quot;fields&quot;.  I tried to clarify that in my answer.  I expect that is true whether reslicing a string or reslicing an <code>[]int</code> slice or any other slice type."}, {"owner": {"reputation": 1146, "user_id": 2359945, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZnZP0.jpg?s=128&g=1", "display_name": "Razzle Shazl", "link": "https://stackoverflow.com/users/2359945/razzle-shazl"}, "edited": false, "score": 0, "creation_date": 1537326908, "post_id": 52396083, "comment_id": 91739406, "body": "After re-reading, I tend to agree with you that re-slicing merely updates the values of the slice."}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 4, "last_activity_date": 1553527355, "last_edit_date": 1553527355, "creation_date": 1537314910, "answer_id": 52396083, "question_id": 52395730, "link": "https://stackoverflow.com/questions/52395730/does-slice-of-string-perform-copy-of-underlying-data/52396083#52396083", "title": "Does slice of string perform copy of underlying data?", "body": "<h1>Slicing Strings</h1>\n\n<blockquote>\n  <p>does slice of string perform copy of underlying data?</p>\n</blockquote>\n\n<p>No it does not.  See this post by Russ Cox:</p>\n\n<blockquote>\n  <p>A string is represented in memory as a 2-word structure containing a pointer to the string data and a length. Because the string is immutable, it is safe for multiple strings to share the same storage, so slicing s results in a new 2-word structure with a potentially different pointer and length that still refers to the same byte sequence. This means that slicing can be done without allocation or copying, making string slices as efficient as passing around explicit indexes.</p>\n</blockquote>\n\n<p>-- <a href=\"https://research.swtch.com/godata\" rel=\"nofollow noreferrer\">Go Data Structures</a></p>\n\n<h1>Slices, Performance, and Iterating Over Runes</h1>\n\n<p>A slice is basically three things: a length, a capacity, and a pointer to a location in an underlying array.</p>\n\n<p>As such, slices themselves are not very large: ints and a pointer (possibly some other small things in implementation detail).  So the allocation required to make a copy of a slice is very small, and doesn't depend on the size of the underlying array.  And no new allocation is required when you simply update the length, capacity, and pointer location, such as on line 2 of:</p>\n\n<pre><code>foo := []int{3, 4, 5, 6}\nfoo = foo[1:]\n</code></pre>\n\n<p>Rather, it's when a new underlying array has to be allocated that a performance impact is felt.</p>\n\n<p>Strings in Go are immutable.  So to change a string you need to make a new string.  However, strings are closely related to byte slices, e.g. you can create a byte slice from a string with</p>\n\n<pre><code>foo := `here's my string`\nfooBytes := []byte(foo)\n</code></pre>\n\n<p>I believe that will allocate a new array of bytes, because:</p>\n\n<blockquote>\n  <p>a string is in effect a read-only slice of bytes</p>\n</blockquote>\n\n<p>according to the Go Blog (see <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">Strings, bytes, runes and characters in Go</a>).  In general you can use a slice to change the contents of an underlying array, so to produce a usable byte slice from a string you would have to make a copy to keep the user from changing what's supposed to be immutable.</p>\n\n<p>You could use <a href=\"https://golang.org/pkg/runtime/pprof/\" rel=\"nofollow noreferrer\">performance profiling</a> and <a href=\"https://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow noreferrer\">benchmarking</a> to gain further insight into the performance of your program.</p>\n\n<p>Once you have your slice of bytes, <code>fooBytes</code>, reslicing it does not allocate a new array, it just allocates a new slice, which is small.  This appears to be what slicing a string does as well.</p>\n\n<p>Note that you don't need to use the <code>utf8</code> package to count words in a utf8 string, though you may proceed that way if you like.  Go handles utf8 natively.  However if you want to iterate over characters you can't represent the string as a slice of bytes, because you could have multibyte characters.  Instead you need to represent it as a slice of runes:</p>\n\n<pre><code>foo := `here's my string`\nfooRunes := []rune(foo)\n</code></pre>\n\n<p>This operation of converting a string to a slice of runes is fast in my experience (trivial in benchmarks I've done, but there may be an allocation).  Now you can iterate across <code>fooRunes</code> to count words, no <code>utf8</code> package required.  Alternatively, you can skip the explicit <code>[]rune(foo)</code> conversion and do it implicitly by using a <code>for ... range</code> loop on the string, because those are special:</p>\n\n<blockquote>\n  <p>A for range loop, by contrast, decodes one UTF-8-encoded rune on each iteration. Each time around the loop, the index of the loop is the starting position of the current rune, measured in bytes, and the code point is its value.</p>\n</blockquote>\n\n<p>-- <a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">Strings, bytes, runes and characters in Go</a></p>\n"}], "owner": {"reputation": 1146, "user_id": 2359945, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/ZnZP0.jpg?s=128&g=1", "display_name": "Razzle Shazl", "link": "https://stackoverflow.com/users/2359945/razzle-shazl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "accepted_answer_id": 52396083, "answer_count": 1, "score": 5, "last_activity_date": 1615528371, "creation_date": 1537312030, "last_edit_date": 1537335963, "question_id": 52395730, "link": "https://stackoverflow.com/questions/52395730/does-slice-of-string-perform-copy-of-underlying-data", "title": "Does slice of string perform copy of underlying data?", "body": "<p>I am trying to efficiently count runes from a utf-8 <code>string</code> using the <a href=\"https://golang.org/pkg/unicode/utf8/\" rel=\"nofollow noreferrer\">utf8</a> library.  Is this example optimal in that it does not copy the underlying data?<br>\n<a href=\"https://golang.org/pkg/unicode/utf8/#example_DecodeRuneInString\" rel=\"nofollow noreferrer\">https://golang.org/pkg/unicode/utf8/#example_DecodeRuneInString</a>  </p>\n\n<pre><code>func main() {\n    str := \"Hello, \u4e16\u754c\" // let's assume a runtime-provided string\n    for len(str) &gt; 0 {\n        r, size := utf8.DecodeRuneInString(str)\n        fmt.Printf(\"%c %v\\n\", r, size)\n        str = str[size:] // performs copy?\n    }\n}\n</code></pre>\n\n<p>I found <a href=\"https://golang.org/pkg/reflect/#StringHeader\" rel=\"nofollow noreferrer\">StringHeader</a> in the (unsafe) reflect library.  Is this the exact structure of a <code>string</code> in Go?  If so, it is conceivable that slicing a string merely updates <code>Data</code> or allocates a new <code>StringHeader</code> altogether.</p>\n\n<pre><code>type StringHeader struct {\n        Data uintptr\n        Len  int\n}\n</code></pre>\n\n<p><em>Bonus</em>: where can I find the code that performs <code>string</code> slicing so that I could look it up myself?  Any of these?<br>\n<a href=\"https://golang.org/src/runtime/slice.go\" rel=\"nofollow noreferrer\">https://golang.org/src/runtime/slice.go</a><br>\n<a href=\"https://golang.org/src/runtime/string.go\" rel=\"nofollow noreferrer\">https://golang.org/src/runtime/string.go</a></p>\n\n<p>This <a href=\"https://stackoverflow.com/questions/43470284/golang-bytestring-vs-bytestring/43470344#43470344\">related SO answer</a> suggests that runtime-strings incur a copy when converted from <code>string</code> to <code>[]byte</code>.</p>\n"}, {"tags": ["arrays", "go"], "comments": [{"owner": {"reputation": 31012, "user_id": 25398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3690dee254e9aa9d98ff964a70e89f23?s=128&d=identicon&r=PG", "display_name": "Cody Caughlan", "link": "https://stackoverflow.com/users/25398/cody-caughlan"}, "edited": false, "score": 2, "creation_date": 1537310422, "post_id": 52395494, "comment_id": 91736058, "body": "Maybe convert each to a Set and then use the Set comparison methods?"}, {"owner": {"reputation": 99, "user_id": 410245, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f92a642e8a8e77b6b27bd16b2280587f?s=128&d=identicon&r=PG", "display_name": "Richard Hoffman", "link": "https://stackoverflow.com/users/410245/richard-hoffman"}, "reply_to_user": {"reputation": 31012, "user_id": 25398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3690dee254e9aa9d98ff964a70e89f23?s=128&d=identicon&r=PG", "display_name": "Cody Caughlan", "link": "https://stackoverflow.com/users/25398/cody-caughlan"}, "edited": false, "score": 2, "creation_date": 1537311059, "post_id": 52395494, "comment_id": 91736224, "body": "There is no Set type in go."}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 2, "creation_date": 1537311373, "post_id": 52395494, "comment_id": 91736291, "body": "Although <code>map[string]interface{}</code> is a loose surrogate <code>Set</code>"}, {"owner": {"reputation": 31012, "user_id": 25398, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/3690dee254e9aa9d98ff964a70e89f23?s=128&d=identicon&r=PG", "display_name": "Cody Caughlan", "link": "https://stackoverflow.com/users/25398/cody-caughlan"}, "edited": false, "score": 0, "creation_date": 1537398835, "post_id": 52395494, "comment_id": 91774339, "body": "@RichardHoffman this Set type? <a href=\"https://godoc.org/github.com/deckarep/golang-set\" rel=\"nofollow noreferrer\">godoc.org/github.com/deckarep/golang-set</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 4, "last_activity_date": 1537374261, "last_edit_date": 1537374261, "creation_date": 1537310780, "answer_id": 52395589, "question_id": 52395494, "link": "https://stackoverflow.com/questions/52395494/best-way-to-check-if-two-arrays-have-the-same-members/52395589#52395589", "title": "Best way to check if two arrays have the same members", "body": "<p>Given that you are doing a length check, I'm going to go with the assumption that implies that they are 1:1, just ordered differently.</p>\n\n<p>You can do this in one pass (each) using a <code>map[string]bool</code> to check existence in both. This utilizes the fact that the <code>map</code> returns the zero value of a <code>bool</code>, which is <code>false</code>, when the key is not present.</p>\n\n<p><em>Disclaimer:</em> Technically this is order O(n)*O(map). The <a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">Go Programming Language Specification</a> does not make any performance guarantees for map types.</p>\n\n<p><a href=\"https://play.golang.org/p/2LUjN5LkXLL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/2LUjN5LkXLL</a></p>\n\n<pre><code>func unorderedEqual(first, second []string) bool {\n    if len(first) != len(second) {\n        return false\n    }\n    exists := make(map[string]bool)\n    for _, value := range first {\n        exists[value] = true\n    }\n    for _, value := range second {\n        if !exists[value] {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n\n<p>If you want to get nit-picky about memory usage, you could save yourself storing a bunch of <code>bool</code>s (which is usually negligible, but to each their own) by using a <code>map[string]struct{}</code> (the empty struct), and you just check existence a little differently, as in this example.</p>\n\n<p><a href=\"https://play.golang.org/p/MjwP_wCtYZV\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MjwP_wCtYZV</a></p>\n\n<p>Set</p>\n\n<pre><code>exists[value] = struct{}{}\n</code></pre>\n\n<p>Check</p>\n\n<pre><code>if _, ok := exists[value]; !ok {\n    return false\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": false, "score": 0, "last_activity_date": 1537311238, "creation_date": 1537311238, "answer_id": 52395643, "question_id": 52395494, "link": "https://stackoverflow.com/questions/52395494/best-way-to-check-if-two-arrays-have-the-same-members/52395643#52395643", "title": "Best way to check if two arrays have the same members", "body": "<p>Using <a href=\"https://github.com/deckarep/golang-set\" rel=\"nofollow noreferrer\">this</a> dedicated package, you would have to use <code>[]interface{}</code> instead of <code>[]string</code> then proceed as such</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/deckarep/golang-set\"\n)\n\nfunc main() {\n    some := []interface{}{\"a\", \"b\", \"c\"}\n    other := []interface{}{\"a\", \"b\", \"d\"}\n    fmt.Println(\n        mapset.NewThreadUnsafeSetFromSlice(some).\n            Difference(mapset.NewThreadUnsafeSetFromSlice(other)).Cardinality() == 0,\n    )\n    // Output: false\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 954, "user_id": 471548, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/X8hWG.jpg?s=128&g=1", "display_name": "azrahel", "link": "https://stackoverflow.com/users/471548/azrahel"}, "is_accepted": false, "score": 0, "last_activity_date": 1537347396, "last_edit_date": 1537347396, "creation_date": 1537313073, "answer_id": 52395859, "question_id": 52395494, "link": "https://stackoverflow.com/questions/52395494/best-way-to-check-if-two-arrays-have-the-same-members/52395859#52395859", "title": "Best way to check if two arrays have the same members", "body": "<p>Generic, language agnostic:</p>\n\n<ol>\n<li>sort both with fastest available algorithm</li>\n<li>iterate over table A and compare with B[currentIndexFromA]</li>\n<li>first time you spot difference, you know they hold different data - throw!</li>\n<li>you iterated over whole A? - they are the same</li>\n</ol>\n\n<p>I don't know GO, but you seem to be naively searching for each element from A in B. In worst case scenario you get many many iterations over B. Sorting with performant algorithm seems to be way more efficient even though it's additional operation. </p>\n\n<p>I unfortunately will not provide code sample, as I don't know GO.</p>\n"}, {"tags": [], "owner": {"reputation": 674, "user_id": 2843331, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f4607c2756f99ce71aa142a697b21e9b?s=128&d=identicon&r=PG", "display_name": "Husain", "link": "https://stackoverflow.com/users/2843331/husain"}, "is_accepted": false, "score": 0, "last_activity_date": 1537324310, "creation_date": 1537324310, "answer_id": 52397176, "question_id": 52395494, "link": "https://stackoverflow.com/questions/52395494/best-way-to-check-if-two-arrays-have-the-same-members/52397176#52397176", "title": "Best way to check if two arrays have the same members", "body": "<p>You can sort the arrays first and then check by index:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sort\"\n)\n\nfunc main() {\n    s1 := []string{\"first\", \"second\", \"third\"}\n    s2 := []string{\"third\", \"first\", \"second\"}\n\n    if len(s1) != len(s2) {\n        fmt.Println(\"not equal\")\n    }\n    sort.Strings(s1)\n    sort.Strings(s2)\n    for i := 0; i &lt; len(s1); i++ {\n        if s1[i] != s2[i] {\n            fmt.Println(\"not equal\")\n            return\n        }\n    }\n    fmt.Println(\"equal\")\n}\n</code></pre>\n\n<p>Or in <a href=\"https://play.golang.org/p/Bcu1dBv3gSy\" rel=\"nofollow noreferrer\">playground</a>.</p>\n\n<p>The idea with sorting is that it makes the comparison easier and faster. Sorting and then comparing index-wise is O(n log n), while 2-loop checking takes O(n^2).</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 8924947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/akqgR.png?s=128&g=1", "display_name": "hairycoo", "link": "https://stackoverflow.com/users/8924947/hairycoo"}, "is_accepted": false, "score": 0, "last_activity_date": 1610073903, "creation_date": 1610073903, "answer_id": 65622735, "question_id": 52395494, "link": "https://stackoverflow.com/questions/52395494/best-way-to-check-if-two-arrays-have-the-same-members/65622735#65622735", "title": "Best way to check if two arrays have the same members", "body": "<p>Ideally, this would have been a comment, but the TLDR is it is both more correct and faster to use Husain's sort and compare.</p>\n<p>Details.\nFor anyone looking at the RayfenWindspear answer above (currently highest ranked), at first glance it looks right, but be aware that it does not check for exact equal-ness, but rather only that every element in the second list is in the first list. The converse also needs to be true, but is not checked by this method. Hence it fails this test (<code>bb</code> is repeated).:</p>\n<pre><code>assert.False(t, unorderedEqual([]string{&quot;aa&quot;, &quot;cc&quot;, &quot;bb&quot;}, []string{&quot;aa&quot;, &quot;bb&quot;, &quot;bb&quot;}))\n</code></pre>\n<p>Of course you can just run it twice to get the correct result, which is only a linear factor</p>\n<pre><code>func DoubleUnorderedEqual(a, b []string) bool {\n    return unorderedEqual(a, b) &amp;&amp; unorderedEqual(b, a)\n}\n</code></pre>\n<p>The suggestion for the sort-then-check by Husain should possibly be ranked higher, because it is correct, and is also faster for larger lists.</p>\n<p>Here's Husain's code in an exported function:</p>\n<pre><code>func SortCompare(a, b []string) bool {\n    if len(a) != len(b) {\n        return false\n    }\n\n    sort.Strings(a)\n    sort.Strings(b)\n\n    for i, v := range a {\n        if v != b[i] {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n<p>And some tests you can run on it (which it passes)</p>\n<pre><code>func TestSortCompare(t *testing.T) {\n\n    assert.True(t, SortCompare([]string{&quot;aa&quot;}, []string{&quot;aa&quot;}))\n    assert.False(t, SortCompare([]string{&quot;aa&quot;}, []string{&quot;bb&quot;}))\n    assert.False(t, SortCompare([]string{&quot;aa&quot;}, []string{&quot;bb&quot;, &quot;cc&quot;}))\n    assert.True(t, SortCompare([]string{&quot;cc&quot;, &quot;bb&quot;}, []string{&quot;bb&quot;, &quot;cc&quot;}))\n    assert.True(t, SortCompare([]string{&quot;aa&quot;, &quot;cc&quot;, &quot;bb&quot;}, []string{&quot;aa&quot;, &quot;bb&quot;, &quot;cc&quot;}))\n    assert.False(t, SortCompare([]string{&quot;aa&quot;, &quot;cc&quot;, &quot;bb&quot;}, []string{&quot;aa&quot;, &quot;bb&quot;, &quot;bb&quot;}))\n}\n</code></pre>\n<p>And here is some sample benchmarking ....</p>\n<pre><code>func getStrings() ([]string, []string) {\n\n    a := []string{&quot;a&quot;, &quot;foo&quot;, &quot;bar&quot;, &quot;ping&quot;, &quot;pong&quot;}\n    b := []string{&quot;pong&quot;, &quot;foo&quot;, &quot;a&quot;, &quot;bar&quot;, &quot;ping&quot;}\n\n    return a, b\n\n}\n\nfunc BenchmarkSortCompare(b *testing.B) {\n    s0, s1 := getStrings()\n    var outcome bool\n    for n := 0; n &lt; b.N; n++ {\n        outcome = SortCompare(s0, s1)\n    }\n    fmt.Println(outcome)\n}\n\nfunc BenchmarkDoubleUnorderedEqual(b *testing.B) {\n    s0, s1 := getStrings()\n    var outcome bool\n    for n := 0; n &lt; b.N; n++ {\n        outcome = DoubleUnorderedEqual(s0, s1)\n    }\n    fmt.Println(outcome)\n}\n</code></pre>\n<p>With the results ...</p>\n<pre><code>BenchmarkSortCompare-32                  2637952           498 ns/op\nBenchmarkDoubleUnorderedEqual-32         3060261           381 ns/op\n</code></pre>\n<p>So running the map method twice is slightly faster at this small size... but add a few more strings and the sort method wins out by a factor of 10. I did not take into account the impact of the degree of disorder in the strings but they are sufficiently disordered it is not an obviously unfair test at first glance.</p>\n<pre><code>func getStrings2() ([]string, []string) {\n\n    a := []string{&quot;a&quot;, &quot;foo&quot;, &quot;bar&quot;, &quot;ping&quot;, &quot;pong&quot;, &quot;b&quot;, &quot;c&quot;, &quot;g&quot;, &quot;e&quot;, &quot;f&quot;, &quot;d&quot;, &quot;h&quot;, &quot;i&quot;, &quot;j&quot;, &quot;q&quot;, &quot;l&quot;, &quot;n&quot;, &quot;o&quot;, &quot;p&quot;, &quot;k&quot;, &quot;r&quot;, &quot;s&quot;, &quot;t&quot;, &quot;u&quot;, &quot;v&quot;, &quot;w&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;}\n    b := []string{&quot;pong&quot;, &quot;foo&quot;, &quot;a&quot;, &quot;bar&quot;, &quot;ping&quot;, &quot;p&quot;, &quot;r&quot;, &quot;q&quot;, &quot;s&quot;, &quot;u&quot;, &quot;t&quot;, &quot;v&quot;, &quot;j&quot;, &quot;x&quot;, &quot;y&quot;, &quot;z&quot;, &quot;b&quot;, &quot;e&quot;, &quot;d&quot;, &quot;c&quot;, &quot;h&quot;, &quot;g&quot;, &quot;f&quot;, &quot;i&quot;, &quot;w&quot;, &quot;k&quot;, &quot;l&quot;, &quot;n&quot;, &quot;o&quot;}\n\n    return a, b\n\n}\n\nfunc BenchmarkSortCompare2(b *testing.B) {\n    s0, s1 := getStrings2()\n    var outcome bool\n    for n := 0; n &lt; b.N; n++ {\n        outcome = SortCompare(s0, s1)\n    }\n    fmt.Println(outcome)\n}\n\nfunc BenchmarkDoubleUnorderedEqual2(b *testing.B) {\n    s0, s1 := getStrings2()\n    var outcome bool\n    for n := 0; n &lt; b.N; n++ {\n        outcome = DoubleUnorderedEqual(s0, s1)\n    }\n    fmt.Println(outcome)\n}\n</code></pre>\n<p>The results:</p>\n<pre><code>BenchmarkSortCompare2-32                  454641          2797 ns/op\nBenchmarkDoubleUnorderedEqual2-32          44420         26714 ns/op\n</code></pre>\n<p>Conclusion - I'll be using Husain's sort and compare ....</p>\n"}], "owner": {"reputation": 99, "user_id": 410245, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f92a642e8a8e77b6b27bd16b2280587f?s=128&d=identicon&r=PG", "display_name": "Richard Hoffman", "link": "https://stackoverflow.com/users/410245/richard-hoffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1555, "favorite_count": 0, "accepted_answer_id": 52395589, "answer_count": 5, "score": 0, "last_activity_date": 1610073903, "creation_date": 1537310119, "last_edit_date": 1537335998, "question_id": 52395494, "link": "https://stackoverflow.com/questions/52395494/best-way-to-check-if-two-arrays-have-the-same-members", "title": "Best way to check if two arrays have the same members", "body": "<p>I have an array of strings, I need to compare this to another array of strings, but they may be in a different order. What's the best way to compare the two arrays?</p>\n\n<p>This is what I have so far, just wondering if there is a simpler / more efficient way I'm missing.</p>\n\n<pre><code>func unorderedEqual(first, second []string) bool {\n    if len(first) != len(second) {\n        return false\n    }\n    for _, value := range first {\n        if !contains(value, second) {\n            return false\n        }\n    }\n    return true\n}\n\nfunc contains(needle string, haystack []string) bool {\n    for _, matchValue := range haystack {\n        if matchValue == needle {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n"}, {"tags": ["go", "concurrency", "goroutine", "channels"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1537310548, "post_id": 52395214, "comment_id": 91736093, "body": "Use a buffered channel of len 1 for errChan/resChan. Doing so their write operations won t block and the process func will return even if Handle has already returned."}, {"owner": {"reputation": 1, "user_id": 10382561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad73c424deb74f5cc7afcd31bf4d4c0?s=128&d=identicon&r=PG&f=1", "display_name": "memleak", "link": "https://stackoverflow.com/users/10382561/memleak"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1537392498, "post_id": 52395214, "comment_id": 91772591, "body": "Thanks, this solved it. Idk why I was trying to avoid buffered channels :/"}], "owner": {"reputation": 1, "user_id": 10382561, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dad73c424deb74f5cc7afcd31bf4d4c0?s=128&d=identicon&r=PG&f=1", "display_name": "memleak", "link": "https://stackoverflow.com/users/10382561/memleak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537308384, "creation_date": 1537308384, "question_id": 52395214, "link": "https://stackoverflow.com/questions/52395214/go-routine-leak-fix", "title": "Go routine leak fix", "body": "<p>I am working on a small service at the moment. From my testing, the code I've written has the possibility of leaking go routines under certain circumstances pertaining to the context. Is there a good and/or idiomatic way to remedy this? I'm providing some sample code below.</p>\n\n<pre><code>func Handle(ctx context.Context, r *Req) (*Response, error) {\n    ctx, cancel := context.WithTimeout(ctx, time.Second * 5)\n    defer cancel()\n\n    resChan := make(chan Response)\n    errChan := make(chan error)\n\n    go process(r, resChan, errChan)\n\n    select {\n    case ctx.Done():\n        return nil, ctx.Err()\n    case res := &lt;-resChan:\n        return &amp;res, nil\n    case err := &lt;-errChan:\n        return nil, err\n    }\n}\n\nfunc process(r *Req, resChan chan&lt;- Response, errChan chan&lt;- error) {\n    defer close(errChan)\n    defer close(resChan)\n\n    err := doSomeWork()\n    if err != nil {\n        errChan &lt;- err\n        return\n    }\n\n    err = doSomeMoreWork()\n    if err != nil {\n        errChan &lt;- err\n        return\n    }\n\n    res := Response{}\n    resChan &lt;- res\n}\n</code></pre>\n\n<p>Hypothetically, if the client cancelled the context or the timeout occurred before the process func had a chance to send on one of the unbuffered channels (resChan, errChan), there would be no channel readers left from Handle and sending on the channels would block indefinitely with no readers. Since process would not return in this case, the channels would also not be closed.</p>\n\n<p>I came up with the process2 as a solution, but I can't help thinking I'm doing something wrong, or there's a better way to handle this.</p>\n\n<pre><code>func process2(ctx context.Context, r *Req, resChan chan&lt;- Response, errChan chan&lt;- error) {\n    defer close(errChan)\n    defer close(resChan)\n\n    err := doSomeWork()\n    select {\n    case &lt;-ctx.Done():\n        return\n    default:\n        if err != nil {\n            errChan &lt;- err\n            return\n        }\n    }\n\n    err = doSomeMoreWork()\n    select {\n    case &lt;-ctx.Done():\n        return\n    default:\n        if err != nil {\n            errChan &lt;- err\n            return\n        }\n    }\n\n    res := Response{}\n    select{\n    case &lt;-ctx.Done():\n        return\n    default:\n        resChan &lt;- res\n    }\n}\n</code></pre>\n\n<p>This approach makes sure that each time a channel send is attempted, first the context is checked for having been completed or cancelled. If it was, then it does not attempt the send and returns. I'm pretty sure this fixes any go routine leaking happening in the first process func.</p>\n\n<p>Is there a better way? Maybe I have this all wrong.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "is_accepted": false, "score": 2, "last_activity_date": 1537348510, "last_edit_date": 1537348510, "creation_date": 1537306891, "answer_id": 52394967, "question_id": 52394870, "link": "https://stackoverflow.com/questions/52394870/how-to-populate-struct-from-file/52394967#52394967", "title": "How to populate struct from file", "body": "<p>You will need to implement a mechanism which can determine which field is named on the line and match this against the corresponding field in the structure. The field identification is easy: use <code>strings.Split</code> on a line read from the file, split on the space, and retrieve the first value.</p>\n\n<p>Looking this up in the struct can take a couple of approaches. The simplest would explicitly test this in a conditional or similar (I have avoided showing code to read the file, as the crux of your question seems to be the matching with the struct values):</p>\n\n<pre><code>// Struct\nvar myStruct *UrlData = // some instantiation\n\n// Read line from file\nline = // TODO\n\n// Determine the field\nparts := strings.Split(line, \" \")\nname, value := parts[0], parts[1]\n\n// Look up the fields in the struct\nswitch name {\ncase \"as\":\n        return myStruct.As == value\ncase \"iso\":\n        return myStruct.Iso == value\n}\n</code></pre>\n\n<p>It is also possible to use reflection to dynamically look up the struct field from the name in the file, but this will be more complex and should be avoided until you require a truly generic solution (and even then best avoided - reflection is not clear code!).</p>\n"}], "owner": {"reputation": 41, "user_id": 9274330, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e86861db3dfe1ff218cb0d742c46b162?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/9274330/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1537348510, "creation_date": 1537306297, "last_edit_date": 1537336019, "question_id": 52394870, "link": "https://stackoverflow.com/questions/52394870/how-to-populate-struct-from-file", "title": "How to populate struct from file", "body": "<p>I have a <code>struct</code> that is designed like this:</p>\n\n<pre><code>type UrlData struct {\n    As int \n    Iso string \n}\n</code></pre>\n\n<p>I instantiate it and after that I read a text file (see below) so as to check if certain struct field is equal to a value from the txt file (yes, I know that it would be much easier to compare explicitly, but reading the data from file is the requirement to be met)</p>\n\n<p>The txt file has the following format:</p>\n\n<pre><code>as 646\niso us\n</code></pre>\n\n<p>When reading the txt file, I want to know if the *UrlData.As field (in the instantiated item) is equal to the value from file, i.e. 646.</p>\n\n<p>The problem is I don't know how to match current field from the txt file with the name of the struct field. What is the most adequate way to do that?</p>\n"}, {"tags": ["html", "css", "go"], "comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 1, "creation_date": 1537305986, "post_id": 52394783, "comment_id": 91734704, "body": "Remember that <code>html&#47;template</code> is simply a wrapper for <code>text&#47;template</code> - which doesn&#39;t even remotely care if it is parsing CSS, HTML or your grandmothers shopping list."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1537308149, "post_id": 52394783, "comment_id": 91735468, "body": "Use what you already know to change dynamically change CSS, whether the CSS is specified in style attribute of the div or in a separate style element. Example: <code>&lt;div style=&quot;background-image: {{.Image}}&quot;&gt;</code>"}], "owner": {"reputation": 128, "user_id": 9646215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/733b088a1b3ee3615881704aba61c351?s=128&d=identicon&r=PG&f=1", "display_name": "AAvery", "link": "https://stackoverflow.com/users/9646215/aavery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537305814, "creation_date": 1537305814, "question_id": 52394783, "link": "https://stackoverflow.com/questions/52394783/webpage-templates-golang", "title": "Webpage Templates Golang", "body": "<p>I am working on a website with golang as my back end.</p>\n\n<p>I would like to load webpages with a particular background image inside of a div depending on the full URL. I have gotten HTML templates to work well and I am able to dynamically change text and a few other things based on this. </p>\n\n<p>However in HTML5, as you cannot define the background image of a div in anything but CSS, I would like to know how I might have this image change dynamically as well. I do not know how to dynamically change CSS with go(using net/http and html/template), or even if this is possible. Thank you</p>\n"}, {"tags": ["go", "https", "static-content"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 2, "creation_date": 1537305891, "post_id": 52394720, "comment_id": 91734666, "body": "You need to create a https server. Are you using  <code>http.ListenAndServeTLS</code> instead of <code>http.ListenAndServe</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "edited": false, "score": 0, "creation_date": 1537309509, "post_id": 52395003, "comment_id": 91735820, "body": "Not necessarily what I am after, I have updated the question with somewhat longer code. The problem is that I am using my custom mux and cannot throw any additional parameters to the ListenAndServeTLS method apart from cert.pem and key.pem."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "edited": false, "score": 0, "creation_date": 1537330763, "post_id": 52395003, "comment_id": 91740141, "body": "@Maciej21592 Your code works for me, if I change <code>&quot;.&#47;static&quot;</code> to a file that exists. What problem are you having? Is it because <code>.&#47;static</code> is a directory, not a file?"}, {"owner": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "edited": false, "score": 0, "creation_date": 1537341913, "post_id": 52395003, "comment_id": 91744612, "body": "Yes it is indeed a directory containing several javascript/css files."}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "edited": false, "score": 0, "creation_date": 1537375046, "post_id": 52395003, "comment_id": 91764781, "body": "@Maciej21592 And you&#39;re getting a 404 from the server? This is because <code>ServeFile</code> serves a single file."}, {"owner": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "edited": false, "score": 0, "creation_date": 1537406425, "post_id": 52395003, "comment_id": 91775834, "body": "I have managed to come around the issue using;  fs := http.FileServer(http.Dir(&quot;static&quot;)) mux.Handle(&quot;/static/&quot;, http.StripPrefix(&quot;/static/&quot;, fs))  ... the problem is that the file server still serves me the static resources using HTTP 1.1 instead of HTTPS :("}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "edited": false, "score": 0, "creation_date": 1537481168, "post_id": 52395003, "comment_id": 91811593, "body": "@Maciej21592 <a href=\"https://gist.github.com/schwern/b982bf726220458a60724efd67cb795e\" rel=\"nofollow noreferrer\">It Works For Me\u2122</a>. Perhaps you don&#39;t realize that HTTPS is HTTP encrypted with TLS? You will get the normal HTTP/1.1 headers, but now encrypted with TLS. If you connect with <code>curl -v</code> you&#39;ll see the TLS handshake and then the normal HTTP request/response follows."}, {"owner": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "edited": false, "score": 0, "creation_date": 1537481807, "post_id": 52395003, "comment_id": 91811753, "body": "Tested it now on the server and it works just fine, doing it locally is still a lot of pain though! Thank you for your effort put into helping me resolve the issue!"}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 1, "last_activity_date": 1537307099, "creation_date": 1537307099, "answer_id": 52395003, "question_id": 52394720, "link": "https://stackoverflow.com/questions/52394720/how-to-serve-static-files-over-https/52395003#52395003", "title": "How to serve static files over HTTPS", "body": "<p>You need to use <a href=\"https://golang.org/pkg/net/http/#ListenAndServeTLS\" rel=\"nofollow noreferrer\">http.ListenAndServeTLS</a> to start an HTTPS server.</p>\n\n<pre><code>func main() {\n    // Set up the handler to serve a file\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, req *http.Request) {\n        w.Header().Set(\"Content-Type\", \"text/plain; charset=utf-8\")\n        http.ServeFile(w, req, \"./text.txt\")\n    })\n\n    log.Printf(\"About to listen on 8443. Go to https://127.0.0.1:8443/\")\n    log.Fatal(http.ListenAndServeTLS(\":8443\", \"cert.pem\", \"key.pem\", nil))\n}\n</code></pre>\n\n<p>And to start an HTTPS server serving a directory with <code>FileServer</code>...</p>\n\n<pre><code>log.Fatal(http.ListenAndServeTLS(\":8443\", \"cert.pem\", \"key.pem\", http.FileServer(http.Dir(\"./static\"))))\n</code></pre>\n\n<p>You can use <a href=\"https://golang.org/src/crypto/tls/generate_cert.go\" rel=\"nofollow noreferrer\"><code>generate_cert.go</code></a> to create self-signed certificates for testing.</p>\n"}], "owner": {"reputation": 114, "user_id": 9339712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40f36a603ca64f59f2d3acbb5a0a30bd?s=128&d=identicon&r=PG&f=1", "display_name": "Maciej21592", "link": "https://stackoverflow.com/users/9339712/maciej21592"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1235, "favorite_count": 0, "accepted_answer_id": 52395003, "answer_count": 1, "score": 0, "last_activity_date": 1537336032, "creation_date": 1537305491, "last_edit_date": 1537336032, "question_id": 52394720, "link": "https://stackoverflow.com/questions/52394720/how-to-serve-static-files-over-https", "title": "How to serve static files over HTTPS", "body": "<p>I have been scratching my head for way too long with this one - my issue is rather trivial however I cannot really figure it out myself: how does one serve static files over HTTPS in Go?</p>\n\n<p>So far I have tried using both <code>HTTP.ServeFile</code> and <code>mux.Handle</code> with no particular success whatsoever.</p>\n\n<pre><code>func main() {\nmux := http.NewServeMux()\nmux.HandleFunc(\"/\", func(w http.ResponseWriter, req *http.Request) {\n    w.Header().Add(\"Strict-Transport-Security\", \"max-age=63072000; includeSubDomains\")\n    http.ServeFile(w, req, \"./static\")\n})\n\ncfg := &amp;tls.Config{\n    MinVersion:               tls.VersionTLS12,\n    CurvePreferences:         []tls.CurveID{tls.CurveP521, tls.CurveP384, tls.CurveP256},\n    PreferServerCipherSuites: true,\n    CipherSuites: []uint16{\n        tls.TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384,\n        tls.TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,\n        tls.TLS_RSA_WITH_AES_256_GCM_SHA384,\n        tls.TLS_RSA_WITH_AES_256_CBC_SHA,\n    },\n}\nsrv := &amp;http.Server{\n    Addr:         \":8080\",\n    Handler:      mux,\n    TLSConfig:    cfg,\n    TLSNextProto: make(map[string]func(*http.Server, *tls.Conn, http.Handler), 0),\n}\nlog.Fatal(srv.ListenAndServeTLS(\"./server.rsa.crt\", \"./server.rsa.key\"))\n\n}\n</code></pre>\n\n<p>Any help is appreciated, thanks!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "edited": false, "score": 0, "creation_date": 1537301596, "post_id": 52393857, "comment_id": 91733026, "body": "I am not sure if it does what I think, but for the <code>bool</code> and <code>int</code> values, wouldn&#39;t <a href=\"https://golang.org/pkg/sync/atomic/\" rel=\"nofollow noreferrer\"><code>atomic</code></a> be an option as well?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "edited": false, "score": 1, "creation_date": 1537301667, "post_id": 52393857, "comment_id": 91733056, "body": "Yes, but as its documentation states, &quot;These functions require great care to be used correctly. Except for special, low-level applications, synchronization is better done with channels or the facilities of the sync package.&quot;"}, {"owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "edited": false, "score": 0, "creation_date": 1537344087, "post_id": 52393857, "comment_id": 91745773, "body": "@Adrian any example of how could it look using channels instead of the <code>sync</code> packages?"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1537301389, "last_edit_date": 1537301389, "creation_date": 1537301035, "answer_id": 52393857, "question_id": 52393706, "link": "https://stackoverflow.com/questions/52393706/how-to-prevent-race-conditions-when-read-only-a-shared-struct-from-an-http-handl/52393857#52393857", "title": "how to prevent race conditions when read-only a shared struct from an HTTP handler", "body": "<p>You have a couple of options:</p>\n\n<ol>\n<li>Use a mutex, as in your existing example (though a <code>RWMutex</code> will be more efficient if most of the accesses are reads).</li>\n<li>Wrap the same in a helper function, so that rather than having to operate the lock directly, your handlers can just call the function to get the value, and the function will handle the lock/read/unlock logic.</li>\n<li>Turn the logic on its head, letting each routine have its own local copy of the value, and using a channel to notify routines of changes in the authoritative value (sharing by communicating instead of communicating by sharing).</li>\n</ol>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537301389, "creation_date": 1537300460, "question_id": 52393706, "link": "https://stackoverflow.com/questions/52393706/how-to-prevent-race-conditions-when-read-only-a-shared-struct-from-an-http-handl", "title": "how to prevent race conditions when read-only a shared struct from an HTTP handler", "body": "<p>I need to update values from a <code>struct</code> and return (read-only) not writing from an HTTP handler, to avoid having race conditions I am using <code>sync.Mutex</code> this is a basic example:</p>\n\n<p><a href=\"http://play.golang.org/p/21IimsdKP6e\" rel=\"nofollow noreferrer\">http://play.golang.org/p/21IimsdKP6e</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"log\"\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\ntype Counter struct {\n    count uint\n    flag  bool\n    mu    sync.Mutex\n    quit  chan struct{}\n    time  time.Time\n    wg    sync.WaitGroup\n}\n\nfunc (c *Counter) Start() {\n    c.count = 1\n    c.time = time.Now()\n    c.flag = true\n}\n\nfunc (c *Counter) Listen() {\n    srv := &amp;http.Server{\n        Addr:    \":8080\",\n        Handler: http.DefaultServeMux,\n    }\n    http.HandleFunc(\"/\", c.HandleStatus)\n    c.wg.Add(1)\n    go func() {\n        defer c.wg.Done()\n        log.Println(srv.ListenAndServe())\n    }()\n    go func(quit chan struct{}) {\n        &lt;-quit\n        if err := srv.Close(); err != nil {\n            log.Printf(\"HTTP error: %v\", err)\n        }\n    }(c.quit)\n}\n\nfunc (c *Counter) HandleStatus(w http.ResponseWriter, r *http.Request) {\n    c.mu.Lock()\n    defer c.mu.Unlock()\n    status := struct {\n        Count uint   `json:\"count\"`\n        Flag  bool   `json:\"flag\"`\n        Time  string `json:\"time\"`\n    }{\n        Count: c.count,\n        Time:  c.time.UTC().Format(time.RFC3339),\n        Flag:  c.flag,\n    }\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    if err := json.NewEncoder(w).Encode(status); err != nil {\n        log.Println(err)\n    }\n\n}\n\nfunc main() {\n    c := &amp;Counter{\n        quit: make(chan struct{}),\n    }\n    c.Start()\n    c.Listen()\n    timeout := time.After(time.Minute)\n    for {\n        select {\n        case &lt;-time.After(time.Second):\n            c.mu.Lock()\n            c.count += 1\n            c.flag = !c.flag\n            c.mu.Unlock()\n        case &lt;-timeout:\n            close(c.quit)\n            c.wg.Wait()\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>I have more handlers but does where I need to read from the <code>Counter struct</code> I need to add on each:</p>\n\n<pre><code>c.mu.Lock()\ndefer c.mu.Unlock()\n</code></pre>\n\n<p>And where the variables are modified, do something like:</p>\n\n<pre><code>c.mu.Lock()\nc.count += 1\nc.flag = !c.flag\nc.mu.Unlock()\n</code></pre>\n\n<p>Therefore wondering how could I better syncronize/arrange the code to prevent adding on each handler <code>Lock/Unlock</code></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1537297711, "post_id": 52393122, "comment_id": 91731359, "body": "There is no inheritance in Go and the only polymorphism is using interfaces. You cannot &quot;extend&quot; types in the OOP sense."}, {"owner": {"reputation": 1756, "user_id": 7388600, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f045c36d726f88326e0719a2efa39973?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/7388600/alexey"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537297861, "post_id": 52393122, "comment_id": 91731425, "body": "@Adrian, internet says I can, it doesn&#39;t matter OOP sense or something similar. I use word &quot;extend&quot; because it&#39;s pretty close to the needed goal"}, {"owner": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "edited": false, "score": 0, "creation_date": 1537297929, "post_id": 52393122, "comment_id": 91731451, "body": "If you change your struct to use a pointer, <code>&amp;RTree{rtree.NewRTree(nodeCap...)}</code> should work."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1537297960, "post_id": 52393122, "comment_id": 91731470, "body": "&quot;internet&quot; is pretty vague, but anything you saw that claims you can &quot;extend&quot; a type in Go is incorrect. You cannot. You can embed types, you cannot extend them."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "edited": false, "score": 0, "creation_date": 1537298007, "post_id": 52393122, "comment_id": 91731481, "body": "@Leon no, it will still be invalid. The code is still attempting to return an <code>rtree.RTree</code> when the function signature says it returns a <code>main.RTree</code>."}, {"owner": {"reputation": 1756, "user_id": 7388600, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f045c36d726f88326e0719a2efa39973?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/7388600/alexey"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537298212, "post_id": 52393122, "comment_id": 91731564, "body": "@Adrian, ok, but in my case how do I use my own struct <b>RTree</b> with all methods from the imported package? + my own methods. First question is how do I init it at least?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1537298284, "post_id": 52393122, "comment_id": 91731601, "body": "Learning the syntax of Go is best done by taking the Tour of Go. So is not the right place."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1537298307, "post_id": 52393122, "comment_id": 91731613, "body": "You could initialize it as <code>return &amp;RTree{ *(retree.NewRTree(nodeCap...)) }</code> with your existing code. It would expose all methods of <code>rtree.RTree</code> as well. However, you could not pass it to any function expecting a parameter of type <code>rtree.RTree</code>."}, {"owner": {"reputation": 1756, "user_id": 7388600, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f045c36d726f88326e0719a2efa39973?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/7388600/alexey"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537299199, "post_id": 52393122, "comment_id": 91732035, "body": "@Adrian, thanks! Now <code>NewRTree</code> is usable as expected"}], "answers": [{"comments": [{"owner": {"reputation": 1756, "user_id": 7388600, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f045c36d726f88326e0719a2efa39973?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/7388600/alexey"}, "edited": false, "score": 1, "creation_date": 1537300023, "post_id": 52393511, "comment_id": 91732396, "body": "I just need to override a method. And Yes.. I see now that not exposed methods are not available, need to think about a workaround"}, {"owner": {"reputation": 838, "user_id": 9134487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VPebZ.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/9134487/tushar"}, "reply_to_user": {"reputation": 1756, "user_id": 7388600, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f045c36d726f88326e0719a2efa39973?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/7388600/alexey"}, "edited": false, "score": 0, "creation_date": 1537300300, "post_id": 52393511, "comment_id": 91732520, "body": "Well, not sure what you are trying to do. But if a package hasn&#39;t made a method exposed, most probably they don&#39;t want you using it. There must be some other way. Otherwise, the library needs more functionalities."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 4, "creation_date": 1537300491, "post_id": 52393511, "comment_id": 91732609, "body": "Also remember when you do this that the \u201cinner\u201d RTree object doesn\u2019t know anything about the object in which it\u2019s contained.  If you\u2019ve \u201coverridden\u201d some method, and call some other unmodified method which calls the thing you think you\u2019re overriding, it will see the unmodified method in the contained object, not anything in the wrapper."}, {"owner": {"reputation": 838, "user_id": 9134487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VPebZ.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/9134487/tushar"}, "reply_to_user": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1537300812, "post_id": 52393511, "comment_id": 91732731, "body": "@DavidMaze Good one, I had learnt it the hard way.  Some related examples, of calling both over-ridden and over-riding methods(&amp; accessing variables) <a href=\"https://play.golang.org/p/RegLWdmcce7\" rel=\"nofollow noreferrer\">play.golang.org/p/RegLWdmcce7</a>"}, {"owner": {"reputation": 1756, "user_id": 7388600, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f045c36d726f88326e0719a2efa39973?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/7388600/alexey"}, "edited": false, "score": 1, "creation_date": 1537301526, "post_id": 52393511, "comment_id": 91732994, "body": "small fix, there should be <code>return &amp;RTree{ *retree.NewRTree(nodeCap...) }</code> - with a <code>*</code> as imported function returns a pointer"}, {"owner": {"reputation": 838, "user_id": 9134487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VPebZ.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/9134487/tushar"}, "edited": false, "score": 0, "creation_date": 1537302057, "post_id": 52393511, "comment_id": 91733232, "body": "Updated it, to deference the pointer returned by rtee.NewRTree()"}], "tags": [], "owner": {"reputation": 838, "user_id": 9134487, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VPebZ.jpg?s=128&g=1", "display_name": "Tushar", "link": "https://stackoverflow.com/users/9134487/tushar"}, "is_accepted": true, "score": 2, "last_activity_date": 1537301958, "last_edit_date": 1537301958, "creation_date": 1537299423, "answer_id": 52393511, "question_id": 52393122, "link": "https://stackoverflow.com/questions/52393122/how-to-create-extended-type/52393511#52393511", "title": "How to create extended type", "body": "<p>Always remember, Go doesn't support <code>inheritance</code>. It supports <code>composition</code>. </p>\n\n<p>You may <code>call</code> it inheritance, as far as it helps you to logically map between other OOP languages, and Go. Rule of thumb, whenever something doesn't work the way it works in <code>OOP</code> world, think in terms of composition.</p>\n\n<p>But when it comes to writing actual code, always remember that there is no <code>is a</code> relationship in composition, and it's always <code>has a</code>, even if it seems otherwise, because of the fact that you can actually access the member variables and methods of the <code>composed/embedded</code>(still, not inherited) struct. You can even <code>override</code> the method, if you declare the same with the new struct. Here's another catch - You still won't be able to access un-exposed (close to <code>protected</code> from Java-world) variables and functions of a struct in another package, as it seems in your case.</p>\n\n<p>But, your type <code>RTree</code> <code>has</code> <code>rtree.RTree</code>, but is never going to be a <code>rtree.RTree</code>, and will always be a different type for the compiler.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/intdxdt/rtree\"\n)\n\ntype RTree struct {\n    rtree.RTree\n}\n\nfunc NewRTree(nodeCap ...int) *RTree {\n    return &amp;RTree{\n        RTree: *rtree.NewRTree(nodeCap...),\n    }\n}\n</code></pre>\n\n<p>On a separate node, unless you have more parameters to add, why not use <code>rtree.RTree</code> directly? Composing it, will give you all the methods of the enclosing type, but you can't pass it to any function that expects the enclosing type. Good news is, you will implicitly satisfy the interfaces that enclosing type satisfies, and hence you can pass it to functions that accept those interfaces.</p>\n"}], "owner": {"reputation": 1756, "user_id": 7388600, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/f045c36d726f88326e0719a2efa39973?s=128&d=identicon&r=PG&f=1", "display_name": "Alexey", "link": "https://stackoverflow.com/users/7388600/alexey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 52393511, "answer_count": 1, "score": -1, "last_activity_date": 1537336058, "creation_date": 1537297592, "last_edit_date": 1537336058, "question_id": 52393122, "link": "https://stackoverflow.com/questions/52393122/how-to-create-extended-type", "title": "How to create extended type", "body": "<p>I see that it's possible to extend imported packages, for example to add new methods.</p>\n\n<p>However, I try this to create a new instance of my own struct:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/intdxdt/rtree\"\n)\n\ntype RTree struct {\n    rtree.RTree\n}\n\nfunc NewRTree(nodeCap ...int) *RTree {\n    return rtree.NewRTree(nodeCap...)\n}\n</code></pre>\n\n<p>I saw similar example at other question. But I get an error: <strong>cannot use rtree.NewRTree(nodeCap...) (type *rtree.RTree) as type *RTree in return argument</strong>.</p>\n\n<p>The question is - how do I init and use my own struct with my own methods and all imported methods/fields included?</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "edited": false, "score": 3, "creation_date": 1537286133, "post_id": 52390384, "comment_id": 91725900, "body": "There are no diffrence between the output and expected result. Now what you want to do?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 5, "creation_date": 1537286238, "post_id": 52390384, "comment_id": 91725970, "body": "When posting a question, please include the relevant code <i>in the body of the question</i> rather than at an external link."}, {"owner": {"reputation": 180, "user_id": 7543165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a41d90644b267d7583a28aaab9a89a5?s=128&d=identicon&r=PG&f=1", "display_name": "klferreira", "link": "https://stackoverflow.com/users/7543165/klferreira"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537286893, "post_id": 52390384, "comment_id": 91726349, "body": "Thanks for the tip @Adrian, will definitely do that in the next questions."}], "answers": [{"comments": [{"owner": {"reputation": 180, "user_id": 7543165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a41d90644b267d7583a28aaab9a89a5?s=128&d=identicon&r=PG&f=1", "display_name": "klferreira", "link": "https://stackoverflow.com/users/7543165/klferreira"}, "edited": false, "score": 0, "creation_date": 1537286965, "post_id": 52390482, "comment_id": 91726388, "body": "It not only worked perfectly but also helped me understand what happened. Thanks!"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 180, "user_id": 7543165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a41d90644b267d7583a28aaab9a89a5?s=128&d=identicon&r=PG&f=1", "display_name": "klferreira", "link": "https://stackoverflow.com/users/7543165/klferreira"}, "edited": false, "score": 1, "creation_date": 1537288701, "post_id": 52390482, "comment_id": 91727272, "body": "@klferreira it&#39;s worth noting that a more idiomatic approach in golang would be to return the pointer as first return value, and an error value if the city wasn&#39;t found. Same goes for the arguments: I&#39;d pass the <code>State</code> value in first (ie <code>func hasCity(state *State, city string) (*City, error) {}</code>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1537286259, "creation_date": 1537286259, "answer_id": 52390482, "question_id": 52390384, "link": "https://stackoverflow.com/questions/52390384/how-to-define-a-function-that-receives-a-pointer-as-argument-and-returns-a-point/52390482#52390482", "title": "How to define a function that receives a pointer as argument and returns a pointer to one of the argument&#39;s children?", "body": "<p>The function returns the address of the local variable <code>cities</code>.  Change the code to return the address of the slice element:</p>\n\n<pre><code>func hasCity(element string, state *State) (bool, *City) {\n    for i, city := range state.Cities {\n        if city.Name == element {\n            return true, &amp;state.Cities[i]\n        }\n    }\n\n    return false, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 180, "user_id": 7543165, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a41d90644b267d7583a28aaab9a89a5?s=128&d=identicon&r=PG&f=1", "display_name": "klferreira", "link": "https://stackoverflow.com/users/7543165/klferreira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 52390482, "answer_count": 1, "score": -2, "last_activity_date": 1537289794, "creation_date": 1537285931, "last_edit_date": 1537289794, "question_id": 52390384, "link": "https://stackoverflow.com/questions/52390384/how-to-define-a-function-that-receives-a-pointer-as-argument-and-returns-a-point", "title": "How to define a function that receives a pointer as argument and returns a pointer to one of the argument&#39;s children?", "body": "<p>I'm having my first contact with pointers now that I'm learning Go.</p>\n\n<p>But this is getting a little tricky and I'm starting to question whether I'm doing it right or wrong.</p>\n\n<p>The title is my best guess to try and explain what I'm trying to do in a foreign language, so if it's unclear, I can try to explain in a different way.</p>\n\n<p>This is a simplified example of the code: <a href=\"https://play.golang.org/p/eultYp7Cq12\" rel=\"nofollow noreferrer\">https://play.golang.org/p/eultYp7Cq12</a></p>\n\n<pre><code>func hasCity(element string, state *State) (bool, *City) {\n    for _, city := range (*state).Cities {\n        if (city.Name == element) {\n            return true, &amp;city\n        }\n    }\n    return false, nil\n}\n</code></pre>\n\n<p>As you can see, the output is:</p>\n\n<pre><code>true &amp;{Campinas}\n[{SP [{S\u00e3o Paulo} {Barueri}]}]\n</code></pre>\n\n<p>But what I'm actually trying to get is:</p>\n\n<pre><code>true &amp;{Campinas}\n[{SP [{S\u00e3o Paulo} {Campinas}]}]\n</code></pre>\n\n<p>So, what am i doing wrong here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1537281399, "post_id": 52388775, "comment_id": 91722856, "body": "Consider that <code>board[:][:]</code> is the same as <code>board[:]</code> or <code>board[:][:][:]</code>"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1537285214, "post_id": 52388775, "comment_id": 91725294, "body": "Why didn&#39;t you declare the board variable as a slice of slices to begin with? Arrays, in golang, are rarely used. We tend to prefer slices 99% of the time, lest it be something insanely specific."}, {"owner": {"reputation": 3, "user_id": 10004107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9KAGMsK2vE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1TXEwXkqB3AMSyQYaap5HAOtPifw/mo/photo.jpg?sz=128", "display_name": "LaurentPandaOne", "link": "https://stackoverflow.com/users/10004107/laurentpandaone"}, "edited": false, "score": 0, "creation_date": 1537343244, "post_id": 52388775, "comment_id": 91745332, "body": "In fact it&#39;s just because I&#39;m used to Java/Javascript, where slices does not exist."}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 10004107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9KAGMsK2vE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1TXEwXkqB3AMSyQYaap5HAOtPifw/mo/photo.jpg?sz=128", "display_name": "LaurentPandaOne", "link": "https://stackoverflow.com/users/10004107/laurentpandaone"}, "edited": false, "score": 0, "creation_date": 1537280939, "post_id": 52388833, "comment_id": 91722506, "body": "Thank you, but is it possible to avoid giving at least one size in the call ?"}, {"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "reply_to_user": {"reputation": 3, "user_id": 10004107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9KAGMsK2vE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1TXEwXkqB3AMSyQYaap5HAOtPifw/mo/photo.jpg?sz=128", "display_name": "LaurentPandaOne", "link": "https://stackoverflow.com/users/10004107/laurentpandaone"}, "edited": false, "score": 0, "creation_date": 1537280975, "post_id": 52388833, "comment_id": 91722537, "body": "By using slices instead."}, {"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "reply_to_user": {"reputation": 3, "user_id": 10004107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9KAGMsK2vE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1TXEwXkqB3AMSyQYaap5HAOtPifw/mo/photo.jpg?sz=128", "display_name": "LaurentPandaOne", "link": "https://stackoverflow.com/users/10004107/laurentpandaone"}, "edited": false, "score": 0, "creation_date": 1537281001, "post_id": 52388833, "comment_id": 91722552, "body": "Like this: <a href=\"https://play.golang.org/p/buplWcRfoAF\" rel=\"nofollow noreferrer\">play.golang.org/p/buplWcRfoAF</a> It&#39;s simpler and you don&#39;t need to specify any size anywhere."}, {"owner": {"reputation": 3, "user_id": 10004107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9KAGMsK2vE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1TXEwXkqB3AMSyQYaap5HAOtPifw/mo/photo.jpg?sz=128", "display_name": "LaurentPandaOne", "link": "https://stackoverflow.com/users/10004107/laurentpandaone"}, "edited": false, "score": 0, "creation_date": 1537281075, "post_id": 52388833, "comment_id": 91722608, "body": "Oh yes, I managed to omit the first dimension : <a href=\"https://play.golang.org/p/dqQFYEdT5uz\" rel=\"nofollow noreferrer\">playground</a>"}, {"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "reply_to_user": {"reputation": 3, "user_id": 10004107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9KAGMsK2vE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1TXEwXkqB3AMSyQYaap5HAOtPifw/mo/photo.jpg?sz=128", "display_name": "LaurentPandaOne", "link": "https://stackoverflow.com/users/10004107/laurentpandaone"}, "edited": false, "score": 0, "creation_date": 1537281129, "post_id": 52388833, "comment_id": 91722654, "body": "You should probably just use slices instead: <a href=\"https://gobyexample.com/slices\" rel=\"nofollow noreferrer\">gobyexample.com/slices</a> Unless you have a good reason to want to use arrays."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1537281471, "post_id": 52388833, "comment_id": 91722908, "body": "slices consumes more memory and cpu than arrays."}, {"owner": {"reputation": 3, "user_id": 10004107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9KAGMsK2vE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1TXEwXkqB3AMSyQYaap5HAOtPifw/mo/photo.jpg?sz=128", "display_name": "LaurentPandaOne", "link": "https://stackoverflow.com/users/10004107/laurentpandaone"}, "edited": false, "score": 0, "creation_date": 1537281694, "post_id": 52388833, "comment_id": 91723065, "body": "Thank you very much. Indeed, coming from other languages, I forgot that slices are far better."}], "tags": [], "owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "is_accepted": true, "score": 1, "last_activity_date": 1537280961, "last_edit_date": 1537280961, "creation_date": 1537280846, "answer_id": 52388833, "question_id": 52388775, "link": "https://stackoverflow.com/questions/52388775/how-to-pass-a-create-a-slice-of-a-2d-array/52388833#52388833", "title": "How to pass a create a slice of a 2d array", "body": "<p>In go, arrays have fixed sizes contrary to slices, so here you need to specify the size of your array as the argument, otherwise you will get this error:</p>\n\n<p><code>prog.go:13:12: cannot use board (type [2][3]string) as type [][]string in argument to printBoard</code></p>\n\n<p>Here it is <a href=\"https://play.golang.org/p/DACllIIGIMA\" rel=\"nofollow noreferrer\">fixed</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    board := [2][3]string{\n        {\"O\", \"_\", \"O\"},\n        {\"X\", \"O\", \"_\"},\n    }\n\n    printBoard(board)\n}\n\nfunc printBoard(board [2][3]string){\n    for _, line := range board {\n        for _, cell := range line {\n            fmt.Printf(\"%s\", cell)\n        }\n        fmt.Println()\n    }\n}\n</code></pre>\n\n<p>Outputs</p>\n\n<blockquote>\n<pre><code>O_O\nXO_\n</code></pre>\n</blockquote>\n\n<p>I'm not sure why you decided to use arrays but in go, whenever possible you should prefer using slices instead of arrays, as they're more flexible, cleaner and less bug-prone.</p>\n\n<p>Here is the implementation with slices instead:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    board := [][]string{\n        {\"O\", \"_\", \"O\"},\n        {\"X\", \"O\", \"_\"},\n    }\n\n    printBoard(board)\n}\n\nfunc printBoard(board [][]string){\n    for _, line := range board {\n        for _, cell := range line {\n            fmt.Printf(\"%s\", cell)\n        }\n        fmt.Println()\n    }\n}\n</code></pre>\n\n<p>Note that you don't need to change your logic, and you don't need to specify sizes anywhere anymore.</p>\n"}], "owner": {"reputation": 3, "user_id": 10004107, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T9KAGMsK2vE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq1TXEwXkqB3AMSyQYaap5HAOtPifw/mo/photo.jpg?sz=128", "display_name": "LaurentPandaOne", "link": "https://stackoverflow.com/users/10004107/laurentpandaone"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 52388833, "answer_count": 1, "score": 0, "last_activity_date": 1537280961, "creation_date": 1537280673, "last_edit_date": 1537280869, "question_id": 52388775, "link": "https://stackoverflow.com/questions/52388775/how-to-pass-a-create-a-slice-of-a-2d-array", "title": "How to pass a create a slice of a 2d array", "body": "<p>I am having trouble to pass a slice of a 2d array of strings inside a func : this is my playground</p>\n\n<p><a href=\"https://play.golang.org/p/yum_hTXJlh9\" rel=\"nofollow noreferrer\">Golang playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    board := [2][3]string{\n        {\"O\", \"_\", \"O\"},\n        {\"X\", \"O\", \"_\"},\n    }\n\n    printBoard(board[:][:])\n}\n\nfunc printBoard(board [][]string){\n    for _, line := range board {\n        for _, cell := range line {\n            fmt.Printf(\"%s\", cell)\n        }\n        fmt.Println()\n    }\n}\n</code></pre>\n\n<p>It says <code>cannot use board[:][:] (type [][3]string) as type [][]string in argument to printBoard</code></p>\n\n<p>I did not manage to correct it printBoard(board[:][:]).</p>\n\n<p>I tried by removing one/both semicolons inside the call, but did not work either. <strong>I do not want to specify any length if possible</strong></p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1537288759, "post_id": 52387934, "comment_id": 91727301, "body": "You&#39;re clearly connecting to a MySQL DB, why are you importing all of the dialects? Remove all dialect imports except for <code>_ &quot;github.com&#47;jinzhu&#47;gorm&#47;dialects&#47;mysql&quot;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 23, "user_id": 6545506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f90b1946939fd8f1b5c46b420d6958?s=128&d=identicon&r=PG&f=1", "display_name": "yue guan", "link": "https://stackoverflow.com/users/6545506/yue-guan"}, "is_accepted": false, "score": 0, "last_activity_date": 1537279818, "creation_date": 1537279818, "answer_id": 52388491, "question_id": 52387934, "link": "https://stackoverflow.com/questions/52387934/not-belongs-wrong-table/52388491#52388491", "title": "Not() belongs wrong table", "body": "<p>resolved</p>\n\n<p>use </p>\n\n<pre><code>Where(\"B.id not in(?)\", [] {2,3,4,5}) instead of Not()\n</code></pre>\n\n<p>anybody has a better idea?</p>\n"}, {"comments": [{"owner": {"reputation": 23, "user_id": 6545506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f90b1946939fd8f1b5c46b420d6958?s=128&d=identicon&r=PG&f=1", "display_name": "yue guan", "link": "https://stackoverflow.com/users/6545506/yue-guan"}, "edited": false, "score": 0, "creation_date": 1537439942, "post_id": 52391246, "comment_id": 91789236, "body": "yes, i did it finally,too \uff0ci was confused by the given method Not()"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 23, "user_id": 6545506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f90b1946939fd8f1b5c46b420d6958?s=128&d=identicon&r=PG&f=1", "display_name": "yue guan", "link": "https://stackoverflow.com/users/6545506/yue-guan"}, "edited": false, "score": 0, "creation_date": 1537445350, "post_id": 52391246, "comment_id": 91792386, "body": "Given that this is the answer that you eventually went for, would you mind marking it as accepted?"}], "tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 1, "last_activity_date": 1537289277, "creation_date": 1537289277, "answer_id": 52391246, "question_id": 52387934, "link": "https://stackoverflow.com/questions/52387934/not-belongs-wrong-table/52391246#52391246", "title": "Not() belongs wrong table", "body": "<p>First off, as per my comment: You're only using <code>mysql</code> as a DB, and yet you're importing all the dialect packages (which do call their respective init functions. These functions register callbacks that are dialect-specific (e.g. the init func in <a href=\"https://github.com/jinzhu/gorm/blob/master/dialects/mssql/mssql.go#L37\" rel=\"nofollow noreferrer\">the MsSQL package</a>). Remove all the dialects you're not using from your imports:</p>\n\n<pre><code>// remove lines that I've commented out here...\nimport (\n    \"github.com/jinzhu/gorm\"\n    // _ \"github.com/jinzhu/gorm/dialects/mssql\"\n     _ \"github.com/jinzhu/gorm/dialects/mysql\"\n    // _ \"github.com/jinzhu/gorm/dialects/postgres\"\n    // _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n)\n</code></pre>\n\n<p>You could move the <code>NOT IN</code> part of the <code>WHERE</code> clause to the <code>JOIN</code> condition based off of <a href=\"http://doc.gorm.io/crud.html#joins\" rel=\"nofollow noreferrer\">the documentation</a>.</p>\n\n<p>I'd also check any errors that you may encounter, they might give you more debug information on top of the log:</p>\n\n<pre><code>err := db.Table(\"A\").Select(\"A.id,A.age\").\n    Joins(\"LEFT JOIN B on A.id =  B.id AND B.id NOT IN (?)\", []int{2, 3, 4, 5}).\n    Where(\"age = ?\", 28).\n    Scan(&amp;result).Error\nif err != nil {\n    fmt.Fatalf(\"Failed to execute query: %+v\", err)\n}\nfmt.Prinln(result)\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6545506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43f90b1946939fd8f1b5c46b420d6958?s=128&d=identicon&r=PG&f=1", "display_name": "yue guan", "link": "https://stackoverflow.com/users/6545506/yue-guan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 52391246, "answer_count": 2, "score": 1, "last_activity_date": 1537289277, "creation_date": 1537277989, "last_edit_date": 1537285257, "question_id": 52387934, "link": "https://stackoverflow.com/questions/52387934/not-belongs-wrong-table", "title": "Not() belongs wrong table", "body": "<p>I am using go version go1.10.3 linux/amd64 and mysql 5.7.</p>\n\n<p>Need to runnable with GORM's docker compose config or please provides your config.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/mssql\"\n    _ \"github.com/jinzhu/gorm/dialects/mysql\"\n    _ \"github.com/jinzhu/gorm/dialects/postgres\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n)\n\nvar db *gorm.DB\n\nfunc init() {\n    var err error\n\n     db, err = gorm.Open(\"mysql\", \"gorm:gorm@tcp(localhost:9910)/gorm?charset=utf8&amp;parseTime=True\")\n\n    if err != nil {\n        panic(err)\n    }\n    db.LogMode(true)\n}\n\ntype Res {\n    Id int  `gorm:\"column:id\"`\n    age int  `gorm:\"column:age\"`\n}\n\nfunc main() {\n        var result []Res\n    db.Table(\"A\").Select(\"A.id,A.age\").Joins(\"left join B on A.id=B.id\").\n        Where(\"A.age=28\").\n       Not(\"B.id\", []{2,3,4,5}).\n       Scan(&amp;result)\n       fmt.Printf(\"%v\", result)\n}\n</code></pre>\n\n<p>The sql log is:</p>\n\n<blockquote>\n  <p>select A.id,A.age from A left join B on A.id=B.id where a.age=28 and A.B.id not in(2,3,4,5)</p>\n</blockquote>\n\n<p>As can be seen, the not operation is appended for the table A (<code>A.B.id not in ...</code>). How can it be appended to table B (<code>B.id not in ...</code>)?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1537361298, "last_edit_date": 1537361298, "creation_date": 1537270511, "answer_id": 52385701, "question_id": 52385633, "link": "https://stackoverflow.com/questions/52385633/what-is-integertype/52385701#52385701", "title": "What is IntegerType?", "body": "<p>Your function declaration is from the <code>builtin</code> package, <a href=\"https://golang.org/pkg/builtin/#make\" rel=\"nofollow noreferrer\"><code>builtin.make()</code></a></p>\n\n<pre><code>func make(t Type, size ...IntegerType) Type\n</code></pre>\n\n<p>That <code>IntegerType</code> links to: <a href=\"https://golang.org/pkg/builtin/#IntegerType\" rel=\"nofollow noreferrer\"><code>builtin.IntegerType</code></a>:</p>\n\n<blockquote>\n  <p>IntegerType is here for the purposes of documentation only. It is a stand-in for any integer type: int, uint, int8 etc.</p>\n</blockquote>\n\n<p>So it serves a <em>documentation purpose</em>. Since there is no generics in Go, each type that is used in a declaration must be a \"real\" type (not a type parameter). But most builtin functions are <em>special</em>, they allow values of multiple types (or even type \"names\") to be passed.</p>\n\n<p>To express / document this, the <code>builtin</code> package uses the <code>IntegerType</code> as a \"pseudo\" type, a collective type for any integer type.</p>\n\n<p>Similarly, <code>Type</code> links to <a href=\"https://golang.org/pkg/builtin/#Type\" rel=\"nofollow noreferrer\"><code>builtin.Type</code></a>:</p>\n\n<blockquote>\n  <p>Type is here for the purposes of documentation only. It is a stand-in for any Go type, but represents the same type for any given function invocation.</p>\n</blockquote>\n\n<p>This is also for <em>documentation purposes</em>. It is also a \"pseudo\" type that may substitute any types, but Go doesn't support generics to express this using a valid syntax.</p>\n"}, {"tags": [], "owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "is_accepted": false, "score": 5, "last_activity_date": 1537270529, "creation_date": 1537270529, "answer_id": 52385710, "question_id": 52385633, "link": "https://stackoverflow.com/questions/52385633/what-is-integertype/52385710#52385710", "title": "What is IntegerType?", "body": "<p><strong>Integer Type :</strong></p>\n\n<blockquote>\n  <p>IntegerType is here for the purposes of documentation only. It is a\n  stand-in for any integer type: int, uint, int8 etc.</p>\n</blockquote>\n\n<p>Ex : <code>type IntegerType int</code></p>\n\n<p><strong>Type :</strong></p>\n\n<blockquote>\n  <p>Type is here for the purposes of documentation only. It is a stand-in\n  for any Go type, but represents the same type for any given function\n  invocation.</p>\n</blockquote>\n\n<p>Ex: <code>type Type int</code></p>\n\n<p>According to go <a href=\"https://golang.org/pkg/builtin/#IntegerType\" rel=\"noreferrer\">document</a></p>\n"}], "owner": {"reputation": 155, "user_id": 8861788, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TYRNfEXvoNo/AAAAAAAAAAI/AAAAAAAAAx8/fTiREje269k/photo.jpg?sz=128", "display_name": "Ihor Bondartcov", "link": "https://stackoverflow.com/users/8861788/ihor-bondartcov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 187, "favorite_count": 0, "accepted_answer_id": 52385701, "answer_count": 2, "score": 0, "last_activity_date": 1537361298, "creation_date": 1537270304, "last_edit_date": 1537271417, "question_id": 52385633, "link": "https://stackoverflow.com/questions/52385633/what-is-integertype", "title": "What is IntegerType?", "body": "<p>I saw golang core and found this:</p>\n\n<pre><code>func make(t Type, size ...IntegerType) Type\n</code></pre>\n\n<p>What mean IntegerType and Type? It can be C+?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 2, "creation_date": 1537267958, "post_id": 52384911, "comment_id": 91713815, "body": "Use a goroutine?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1537268137, "post_id": 52384911, "comment_id": 91713917, "body": "You only showed the &quot;receiver&quot; side of you logic, there must be a &quot;sender&quot; side, another goroutine that sends values on the <code>value</code> channel, else receiving from it will block."}, {"owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "edited": false, "score": 0, "creation_date": 1537268996, "post_id": 52384911, "comment_id": 91714465, "body": "I thought this was the &quot;sender&quot;. Originally I had a for loop ranging over the chan printing the output but I&#39;m not entirely sure how to do it @izca"}], "answers": [{"comments": [{"owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "edited": false, "score": 0, "creation_date": 1537270335, "post_id": 52385395, "comment_id": 91715303, "body": "Thanks for this and understand the points. Where I&#39;m now stuck is how to keep the updates streaming if I have another break in the application. For example, my main function ends with <code>log.Fatal(http.ListenAndServe(&quot;:3000&quot;, router))</code> and as such the output with the above code is <code>0.1584660140163832 0.31292741197327933 0.45948077900493006 0.5944225451639891 2018&#47;09&#47;18 21:26:31 Server is running at http:&#47;&#47;localhost:3000</code> without any further updates"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "edited": false, "score": 1, "creation_date": 1537270541, "post_id": 52385395, "comment_id": 91715460, "body": "Please post a new question with the relevant code. From what i can understand in your comment you are looking for cancellation patterns, but again its hard to figure out without proper code to think against."}], "tags": [], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "is_accepted": true, "score": 4, "last_activity_date": 1537269474, "creation_date": 1537269474, "answer_id": 52385395, "question_id": 52384911, "link": "https://stackoverflow.com/questions/52384911/streaming-data-over-go-channel/52385395#52385395", "title": "Streaming data over go channel", "body": "<p>There is several mistakes in this code,</p>\n\n<ul>\n<li>the value chan is never drained, so any write will block</li>\n<li>the value chan is never closed, so any drain will be infinite</li>\n</ul>\n\n<p>A channel must always be drained, a channel must be closed at some point.</p>\n\n<p>Also, please post reproducible examples, otherwise it is difficult to diagnose the issue.</p>\n\n<p>This is a slightly modified but working version of the OP code.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n    \"time\"\n)\n\nfunc sineWave(value chan float64) {\n    defer close(value) // A channel must always be closed by the writer.\n    var div float64\n    sinMult := 6.2839\n    i := 0\n    fmt.Println(\"started\")\n\n    for {\n        div = (float64(i+1) / sinMult)\n\n        time.Sleep(100 * time.Millisecond)\n        value &lt;- math.Sin(div)\n\n        i++\n        if i == 4 {\n            // i = 0 // commented in order to quit the loop, thus close the channel, thus end the main for loop\n            break\n        }\n    }\n\n}\n\nfunc main() {\n    value := make(chan float64)\n    go sineWave(value) // start writing the values in a different routine\n    // drain the channel, it will end the loop whe nthe channel is closed\n    for v := range value {\n        fmt.Println(v)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 329, "user_id": 5776617, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/--RV_ptSa9aA/AAAAAAAAAAI/AAAAAAAAAJk/QI2FQ9xZgn0/photo.jpg?sz=128", "display_name": "Alex Turner", "link": "https://stackoverflow.com/users/5776617/alex-turner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 1, "accepted_answer_id": 52385395, "answer_count": 1, "score": -2, "last_activity_date": 1537269474, "creation_date": 1537267856, "question_id": 52384911, "link": "https://stackoverflow.com/questions/52384911/streaming-data-over-go-channel", "title": "Streaming data over go channel", "body": "<p>I'm trying to build a function that I pass a channel to and when run in a go routine it will constantly post updates (in this instance, values of sin) to a channel. When data is sent the the channel, I then want to send it over a web socket.</p>\n\n<pre><code>func sineWave(value chan float64) {\n    var div float64\n    sinMult := 6.2839\n    i := 0\n    log.Println(\"started\")\n\n    for {\n        div = (float64(i+1) / sinMult)\n        log.Println(math.Sin(div))\n        time.Sleep(100 * time.Millisecond)\n        value &lt;- math.Sin(div)\n        // log.Println()\n\n        i++\n        if i == 45 {\n            i = 0\n        }\n    }\n    // log.Println(math.Sin(div * math.Pi))\n}\n</code></pre>\n\n<p>It seems to get stuck at <code>value &lt;- main.Sin(div)</code> stopping the rest of main() from running. How do i get sineWave to run indefinitely in the background and to print its output in another function as they arrive?</p>\n"}, {"tags": ["go", "logging"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537262216, "post_id": 52382968, "comment_id": 91710308, "body": "Please show your current attempt, and explain what problem you&#39;re having."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1537262230, "post_id": 52382968, "comment_id": 91710315, "body": "No you cannot do this. (To simple for an answer)."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1537263584, "post_id": 52382968, "comment_id": 91711162, "body": "The standard logging package (<code>log</code>) provides minimalistic formatting and customization options, see <a href=\"https://golang.org/pkg/log/#SetFlags\" rel=\"nofollow noreferrer\"><code>log.SetFlags()</code></a> and the <a href=\"https://golang.org/pkg/log/#pkg-constants\" rel=\"nofollow noreferrer\">flag constants</a> for details. If you need more or different than that, you may look for a 3rd party logging library (there are plenty for Go)."}, {"owner": {"reputation": 11, "user_id": 10379373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jbaPLsGdJBo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOYyHwwq1Okc0xRaB0nY9nLViuXvQ/mo/photo.jpg?sz=128", "display_name": "Volodymyr Lominskyi", "link": "https://stackoverflow.com/users/10379373/volodymyr-lominskyi"}, "edited": false, "score": 0, "creation_date": 1537263709, "post_id": 52382968, "comment_id": 91711234, "body": "Gotcha. Then I can&#39;t do by using std lib. Thanks a lot."}, {"owner": {"reputation": 11, "user_id": 10379373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jbaPLsGdJBo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOYyHwwq1Okc0xRaB0nY9nLViuXvQ/mo/photo.jpg?sz=128", "display_name": "Volodymyr Lominskyi", "link": "https://stackoverflow.com/users/10379373/volodymyr-lominskyi"}, "edited": false, "score": 2, "creation_date": 1537264397, "post_id": 52382968, "comment_id": 91711683, "body": "Well basically I was wrong <a href=\"https://stackoverflow.com/questions/26120698/how-to-change-the-date-time-format-of-gos-log-package\" title=\"how to change the date time format of gos log package\">stackoverflow.com/questions/26120698/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1537294695, "post_id": 52385675, "comment_id": 91729950, "body": "&#171;the stdlib log package doesn&#39;t do much&#187; not quite true: it makes two important guarantees: 1) A single calls to any outputting method on a logger instance results in a single call to <code>Write</code> on the underlying writer; 2) These calls to the underlying writer are serializer. Hence I&#39;d go with the first option for simplicity."}, {"owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "edited": false, "score": 0, "creation_date": 1537303022, "post_id": 52385675, "comment_id": 91733624, "body": "Yes that was probably a little unfair. It is worth reading the source to see what it does."}], "tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 1, "last_activity_date": 1537270408, "creation_date": 1537270408, "answer_id": 52385675, "question_id": 52382968, "link": "https://stackoverflow.com/questions/52382968/is-there-any-way-to-format-logs-like-describe-below-by-using-golang-std-librar/52385675#52385675", "title": "Is there any way to format logs (like describe below) by using golang std library?", "body": "<p>Two options here: </p>\n\n<p>use log.SetOutput to set a custom writer. </p>\n\n<p>Or use the fmt package instead to just print to stdout or elsewhere - the stdlib log package doesn't do much and it's pretty easy to create your own log package which outputs with custom time format(s) to stdout (or a log file). For example here is such a package in a few lines:</p>\n\n<pre><code>package log\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nvar TimeFormat = \"2006-02-01T15:04:05Z\"\n\nfunc Printf(format string, args ...interface{}) {\n    format = fmt.Sprintf(\"%s %s\", time.Now().Format(TimeFormat), format)\n    fmt.Printf(format, args...)\n}\n</code></pre>\n\n<p>I'd recommend doing this yourself if you have specific needs, and just output to stdout with fmt.Printf. You don't really need a third party log package.</p>\n\n<p><a href=\"https://play.golang.org/p/iPeuGjQqEf4\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iPeuGjQqEf4</a> </p>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 1, "last_activity_date": 1537288238, "last_edit_date": 1537288238, "creation_date": 1537282758, "answer_id": 52389468, "question_id": 52382968, "link": "https://stackoverflow.com/questions/52382968/is-there-any-way-to-format-logs-like-describe-below-by-using-golang-std-librar/52389468#52389468", "title": "Is there any way to format logs (like describe below) by using golang std library?", "body": "<p>You can use <a href=\"https://golang.org/pkg/log/#SetOutput\" rel=\"nofollow noreferrer\"><code>log.SetOutput(...)</code></a> with an argument writer that prints entries using your desired format (such as the builtin RFC3999 or one of your choice), for example:</p>\n\n<pre><code>const timeFormat = time.RFC3339\n\ntype logWriter struct{}\n\nfunc (lw *logWriter) Write(bs []byte) (int, error) {\n  return fmt.Print(time.Now().UTC().Format(timeFormat), \" | \", string(bs))\n}\n\nfunc main() {\n  log.SetFlags(0)               // Omit default prefixes.\n  log.SetOutput(new(logWriter)) // Use our custom writer.\n\n  log.Printf(\"Hello, %s!\", \"World\")\n  // 2018-09-18T14:50:40Z | Hello, World!\n}\n</code></pre>\n\n<p>You can change the timestamp by using a different format, e.g.:</p>\n\n<pre><code>const timeFormat = \"Jan 2, 2006 at 3:04:05pm (UTC)\"\n\n// ...\n  log.Printf(\"Hello, %s!\", \"World\")\n  // Sep 18, 2018 at 2:52:26pm (UTC) | Hello, World!\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10379373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jbaPLsGdJBo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOYyHwwq1Okc0xRaB0nY9nLViuXvQ/mo/photo.jpg?sz=128", "display_name": "Volodymyr Lominskyi", "link": "https://stackoverflow.com/users/10379373/volodymyr-lominskyi"}, "is_accepted": false, "score": 0, "last_activity_date": 1537341641, "creation_date": 1537341641, "answer_id": 52400262, "question_id": 52382968, "link": "https://stackoverflow.com/questions/52382968/is-there-any-way-to-format-logs-like-describe-below-by-using-golang-std-librar/52400262#52400262", "title": "Is there any way to format logs (like describe below) by using golang std library?", "body": "<p><a href=\"https://play.golang.org/p/hPCn3MflkgQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hPCn3MflkgQ</a>\nHere is an answer. You should deal with Writer interface and create new Log by using it</p>\n"}], "owner": {"reputation": 11, "user_id": 10379373, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-jbaPLsGdJBo/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOYyHwwq1Okc0xRaB0nY9nLViuXvQ/mo/photo.jpg?sz=128", "display_name": "Volodymyr Lominskyi", "link": "https://stackoverflow.com/users/10379373/volodymyr-lominskyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "answer_count": 3, "score": -1, "last_activity_date": 1537341641, "creation_date": 1537261751, "last_edit_date": 1537262168, "question_id": 52382968, "link": "https://stackoverflow.com/questions/52382968/is-there-any-way-to-format-logs-like-describe-below-by-using-golang-std-librar", "title": "Is there any way to format logs (like describe below) by using golang std library?", "body": "<ol>\n<li><p>\u200bFeb 1, 2018 at 3:04:05pm (UTC) | This is log message</p></li>\n<li><p>2018-02-01T15:04:05Z | This is log message</p></li>\n</ol>\n\n<p>I found the next formats in go src:\n<a href=\"https://github.com/golang/go/blob/master/src/log/log.go#L37\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/master/src/log/log.go#L37</a>\nBut it seems I couldn't manage to do it by using only those ones..</p>\n"}, {"tags": ["go", "timer", "scheduler"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1537258154, "post_id": 52381764, "comment_id": 91707964, "body": "<a href=\"https://golang.org/pkg/time/#Ticker\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#Ticker</a>"}, {"owner": {"reputation": 142, "user_id": 9830227, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yAdstXPgqRQ/AAAAAAAAAAI/AAAAAAAAAdQ/COp_BAnd7AE/photo.jpg?sz=128", "display_name": "Chidi Williams", "link": "https://stackoverflow.com/users/9830227/chidi-williams"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1537258246, "post_id": 52381764, "comment_id": 91708033, "body": "Hey Peter, I know of the ticker function. My problem is in looping the tickers concurrently."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1537263328, "post_id": 52381764, "comment_id": 91711007, "body": "What have you tried? Include your code. What problems did you encounter?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1537267337, "post_id": 52381764, "comment_id": 91713429, "body": "Just a nit-pick: nothing runs concurrently in JS"}], "answers": [{"comments": [{"owner": {"reputation": 142, "user_id": 9830227, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yAdstXPgqRQ/AAAAAAAAAAI/AAAAAAAAAdQ/COp_BAnd7AE/photo.jpg?sz=128", "display_name": "Chidi Williams", "link": "https://stackoverflow.com/users/9830227/chidi-williams"}, "edited": false, "score": 0, "creation_date": 1537258799, "post_id": 52381907, "comment_id": 91708359, "body": "All good and fine. But in my case, I have a list of n items, where each item is a function-interval pair. For each item, I want to spin up a goroutine calling the function at its interval."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 142, "user_id": 9830227, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yAdstXPgqRQ/AAAAAAAAAAI/AAAAAAAAAdQ/COp_BAnd7AE/photo.jpg?sz=128", "display_name": "Chidi Williams", "link": "https://stackoverflow.com/users/9830227/chidi-williams"}, "edited": false, "score": 0, "creation_date": 1537258893, "post_id": 52381907, "comment_id": 91708419, "body": "@ChidiWilliams So call this <code>schedule()</code> function, passing each of your functions and their intervals, you may use a loop for that."}, {"owner": {"reputation": 142, "user_id": 9830227, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yAdstXPgqRQ/AAAAAAAAAAI/AAAAAAAAAdQ/COp_BAnd7AE/photo.jpg?sz=128", "display_name": "Chidi Williams", "link": "https://stackoverflow.com/users/9830227/chidi-williams"}, "edited": false, "score": 0, "creation_date": 1537263783, "post_id": 52381907, "comment_id": 91711279, "body": "Alright thanks. I came up with this: <a href=\"https://play.golang.org/p/HogqmrdYDSk\" rel=\"nofollow noreferrer\">play.golang.org/p/HogqmrdYDSk</a>. Could you add a loop over an array like that in your answer, so I can mark it as correct?"}, {"owner": {"reputation": 142, "user_id": 9830227, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yAdstXPgqRQ/AAAAAAAAAAI/AAAAAAAAAdQ/COp_BAnd7AE/photo.jpg?sz=128", "display_name": "Chidi Williams", "link": "https://stackoverflow.com/users/9830227/chidi-williams"}, "edited": false, "score": 0, "creation_date": 1537269680, "post_id": 52381907, "comment_id": 91714878, "body": "Perfect! Thanks."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1537268440, "last_edit_date": 1537268440, "creation_date": 1537258333, "answer_id": 52381907, "question_id": 52381764, "link": "https://stackoverflow.com/questions/52381764/run-multiple-functions-concurrently-at-intervals-in-go/52381907#52381907", "title": "Run multiple functions concurrently at intervals in Go", "body": "<p>Use a <a href=\"https://golang.org/pkg/time/#Ticker\" rel=\"noreferrer\"><code>time.Ticker</code></a> to receive \"events\" periodically, which you may use to time the execution of a function. You may obtain a <code>time.Ticker</code> by calling <a href=\"https://golang.org/pkg/time/#NewTicker\" rel=\"noreferrer\"><code>time.NewTicker()</code></a>. The returned ticker has a channel on which values are sent periodically.</p>\n\n<p>Use a goroutine to continuously receive the events and call the function, e.g. with a <code>for range</code> loop.</p>\n\n<p>Let's see 2 functions:</p>\n\n<pre><code>func oneSec() {\n    log.Println(\"oneSec\")\n}\n\nfunc twoSec() {\n    log.Println(\"twoSec\")\n}\n</code></pre>\n\n<p>Here's a simple scheduler that periodically calls a given function:</p>\n\n<pre><code>func schedule(f func(), interval time.Duration) *time.Ticker {\n    ticker := time.NewTicker(interval)\n    go func() {\n        for range ticker.C {\n            f()\n        }\n    }()\n    return ticker\n}\n</code></pre>\n\n<p>Example using it:</p>\n\n<pre><code>func main() {\n    t1 := schedule(oneSec, time.Second)\n    t2 := schedule(twoSec, 2*time.Second)\n    time.Sleep(5 * time.Second)\n    t1.Stop()\n    t2.Stop()\n}\n</code></pre>\n\n<p>Example output (try it on the <a href=\"https://play.golang.org/p/gKAGyVLWqQ6\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2009/11/10 23:00:01 oneSec\n2009/11/10 23:00:02 twoSec\n2009/11/10 23:00:02 oneSec\n2009/11/10 23:00:03 oneSec\n2009/11/10 23:00:04 twoSec\n2009/11/10 23:00:04 oneSec\n</code></pre>\n\n<p>Note that <code>Ticker.Stop()</code> does not close the ticker's channel, so a <code>for range</code> will not terminate; <code>Stop()</code> only stops sending values on the ticker's channel.</p>\n\n<p>If you want to terminate the goroutines used to schedule the function calls, you may do that with an additional channel. And then those goroutines may use a <code>select</code> statement to \"monitor\" the ticker's channel and this <code>done</code> channel, and return if receiving from <code>done</code> succeeds.</p>\n\n<p>For example:</p>\n\n<pre><code>func schedule(f func(), interval time.Duration, done &lt;-chan bool) *time.Ticker {\n    ticker := time.NewTicker(interval)\n    go func() {\n        for {\n            select {\n            case &lt;-ticker.C:\n                f()\n            case &lt;-done:\n                return\n            }\n        }\n    }()\n    return ticker\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>func main() {\n    done := make(chan bool)\n    t1 := schedule(oneSec, time.Second, done)\n    t2 := schedule(twoSec, 2*time.Second, done)\n    time.Sleep(5 * time.Second)\n    close(done)\n    t1.Stop()\n    t2.Stop()\n}\n</code></pre>\n\n<p>Try this one on the <a href=\"https://play.golang.org/p/L9LiFlc87jo\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>Note that even though stopping the tickers is not necessary in this simple example (because <a href=\"https://stackoverflow.com/questions/28958192/no-output-from-goroutine-in-go/28958240#28958240\">when the <code>main</code> goroutine ends, so does the program with it</a>), in real-life examples if the app continues to run, leaving the tickers unstopped wastes resources (they will continue to use a background goroutine, and will continue to try to send values on their channels).</p>\n\n<p><strong>Last words:</strong></p>\n\n<p>If you have a slice of function-interval pairs, simply use a loop to pass each pair to this <code>schedule()</code> function. Something like this:</p>\n\n<pre><code>type pair struct {\n    f        func()\n    interval time.Duration\n}\n\npairs := []pair{\n    {oneSec, time.Second},\n    {twoSec, 2 * time.Second},\n}\n\ndone := make(chan bool)\nts := make([]*time.Ticker, len(pairs))\nfor i, p := range pairs {\n    ts[i] = schedule(p.f, p.interval, done)\n}\n\ntime.Sleep(5 * time.Second)\nclose(done)\n\nfor _, t := range ts {\n    t.Stop()\n}\n</code></pre>\n\n<p>Try this one on the <a href=\"https://play.golang.org/p/5lCpDYrYJ9A\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 142, "user_id": 9830227, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-yAdstXPgqRQ/AAAAAAAAAAI/AAAAAAAAAdQ/COp_BAnd7AE/photo.jpg?sz=128", "display_name": "Chidi Williams", "link": "https://stackoverflow.com/users/9830227/chidi-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3132, "favorite_count": 1, "accepted_answer_id": 52381907, "answer_count": 1, "score": 1, "last_activity_date": 1537268512, "creation_date": 1537257817, "last_edit_date": 1537268512, "question_id": 52381764, "link": "https://stackoverflow.com/questions/52381764/run-multiple-functions-concurrently-at-intervals-in-go", "title": "Run multiple functions concurrently at intervals in Go", "body": "<p>I have a list of functions and their respective intervals. I want to run each function at its interval concurrently.</p>\n\n<p>In JavaScript, I wrote something like:</p>\n\n<pre><code>maps.forEach(({fn, interval}) =&gt; {\n    setInterval(fn, interval)\n})\n</code></pre>\n\n<p>How do I implement this functionality in Golang?</p>\n"}, {"tags": ["for-loop", "if-statement", "go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1537256969, "post_id": 52381395, "comment_id": 91707272, "body": "Code conventions are somebody&#39;s preferences. Not necessary it always has some rationale behind it, what is important is that they are followed by everybody."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 6, "creation_date": 1537257269, "post_id": 52381395, "comment_id": 91707464, "body": "This is not gofmt&#39;ed code. Nobody is interested in reading or discussing un-fmt&#39;ed code."}], "answers": [{"tags": [], "owner": {"reputation": 78771, "user_id": 831878, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/1d1a4823c46ad92f357b4bb7e74a64b0?s=128&d=identicon&r=PG", "display_name": "Ray Toal", "link": "https://stackoverflow.com/users/831878/ray-toal"}, "is_accepted": true, "score": 10, "last_activity_date": 1537256912, "creation_date": 1537256912, "answer_id": 52381495, "question_id": 52381395, "link": "https://stackoverflow.com/questions/52381395/is-it-discouraged-to-use-one-liner-for-loops-or-if-statements-in-go/52381495#52381495", "title": "Is it discouraged to use one-liner for-loops or if-statements in Go?", "body": "<p>Generally, the culture in Go is to format your code the way the command <a href=\"https://blog.golang.org/go-fmt-your-code\" rel=\"noreferrer\"><code>go fmt</code></a> would format it. (The reasons why there is an accepted style are in the linked article.)</p>\n\n<p>To the extent that <code>go fmt</code> puts structured statement bodies on separate lines means that yes, the practice is \"discouraged\" in the community, but only because of a desire to have a common look for as much Go source code as possible.</p>\n\n<p>The reasons <em>why</em> one-liners are not part of <code>go fmt</code> are not as relevant as the fact that <code>go fmt</code> was chosen as the canonical style. If you wish to argue about the pros and cons of one-liners, you can look at the debates made in just about any curly-brace language, as they are not unique to Go. Of course, Go's mandating of braces does make the question slightly different than, say, C or Java, where unbraced bodies means it's harder to \"add a new statement in the body,\" but basically many of the same arguments for readability do apply.</p>\n"}], "owner": {"reputation": 1445, "user_id": 2919875, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/2346973f3237c15ff4ff282f519e64b7?s=128&d=identicon&r=PG&f=1", "display_name": "Leeren", "link": "https://stackoverflow.com/users/2919875/leeren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 0, "accepted_answer_id": 52381495, "answer_count": 1, "score": -2, "last_activity_date": 1537257117, "creation_date": 1537256578, "question_id": 52381395, "link": "https://stackoverflow.com/questions/52381395/is-it-discouraged-to-use-one-liner-for-loops-or-if-statements-in-go", "title": "Is it discouraged to use one-liner for-loops or if-statements in Go?", "body": "<p>For example, a simple check for an empty string:</p>\n\n<pre><code>if s == \"\" { return 0 }\n</code></pre>\n\n<p>Or, a for-loop to pre-fill an array with -1 (I don't think there's an easier way to do this):</p>\n\n<pre><code>for i := range m { m[i] = -1 }\n</code></pre>\n\n<p>Is this generally discouraged, even if these functions are extremely simple altogether? I don't mean to be pedantic, but am generally curious what the sentiment for this is.</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1537256651, "post_id": 52381358, "comment_id": 91707085, "body": "Possible duplicate: <a href=\"https://stackoverflow.com/questions/42952191/is-it-possible-to-mock-a-function-imported-from-a-package-in-golang/42952311#42952311\">Is it possible to mock a function imported from a package in golang?</a>"}, {"owner": {"reputation": 182, "user_id": 4643176, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9127b4dc7cb1bc1d227633311911899e?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay", "link": "https://stackoverflow.com/users/4643176/vinay"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1537257238, "post_id": 52381358, "comment_id": 91707438, "body": "@icza That seems to be different. I might be wrong, but as I am not much used to with the Golang, that is why still I am not able to test the helper method. :( ,("}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1537257319, "post_id": 52381358, "comment_id": 91707485, "body": "If you mock the function in a way described in the linked answer, you can do anything in your mocked version, e.g. you can increment a counter to see how many times it was called."}], "answers": [{"comments": [{"owner": {"reputation": 182, "user_id": 4643176, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9127b4dc7cb1bc1d227633311911899e?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay", "link": "https://stackoverflow.com/users/4643176/vinay"}, "edited": false, "score": 0, "creation_date": 1537257948, "post_id": 52381727, "comment_id": 91707845, "body": "I totally understand your point. But I am stuck in bit odd situation, <code>notifier.notify</code> is not making any <code>database</code> entry or <code>http</code> call, it&#39;s kind of <code>logging</code> mechanism. So I have no control on it. Am I made myself clear?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 182, "user_id": 4643176, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9127b4dc7cb1bc1d227633311911899e?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay", "link": "https://stackoverflow.com/users/4643176/vinay"}, "edited": false, "score": 2, "creation_date": 1537261227, "post_id": 52381727, "comment_id": 91709740, "body": "@Vinay Then you cannot test it. If it doesn&#39;t have any observable effect one could argue that it doesn&#39;t even happen. If your logging system is designed to be not observable than you cannot observe it which means you cannot test it. Some things simply cannot be tested."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 2, "last_activity_date": 1537257681, "creation_date": 1537257681, "answer_id": 52381727, "question_id": 52381358, "link": "https://stackoverflow.com/questions/52381358/test-that-method-is-called-in-handler-in-golang/52381727#52381727", "title": "Test that method is called in handler in Golang", "body": "<blockquote>\n  <p>Want to test that notifier.Notify is called.</p>\n</blockquote>\n\n<p>No you don't. You are interested in that the handler does what it should do and this seems to consist of two things:</p>\n\n<ol>\n<li><p>Return the right response (easy to test with a net/http/httptest.ResponseRecorder), and</p></li>\n<li><p>Has some noticeable side effect, here issue some notification.</p></li>\n</ol>\n\n<p>To test 2. you test that the notification was issued, not that some function was called. \nWhatever notify.Notify results in (e.g. a database entry, a file, some HTTP call) should be tested. Formally this is no longer unit testing but testing for side effects is never strict unit testing.</p>\n\n<p>What you can do: Wrap your handler logic into some object and observe that objects state. Ugly. Don't.</p>\n"}, {"comments": [{"owner": {"reputation": 135, "user_id": 4706045, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YqYFs.jpg?s=128&g=1", "display_name": "ASHMIL HUSSAIN K", "link": "https://stackoverflow.com/users/4706045/ashmil-hussain-k"}, "edited": false, "score": 0, "creation_date": 1586415956, "post_id": 56167394, "comment_id": 108120524, "body": "How to add this handler to the router then, I&#39;m getting error like    -    cannot use MyHandler as type http.HandlerFunc"}], "tags": [], "owner": {"reputation": 16274, "user_id": 672809, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e60b2dc57668b5662ce3f07781e41710?s=128&d=identicon&r=PG", "display_name": "Matthew Rudy", "link": "https://stackoverflow.com/users/672809/matthew-rudy"}, "is_accepted": false, "score": 2, "last_activity_date": 1558005688, "creation_date": 1558005688, "answer_id": 56167394, "question_id": 52381358, "link": "https://stackoverflow.com/questions/52381358/test-that-method-is-called-in-handler-in-golang/56167394#56167394", "title": "Test that method is called in handler in Golang", "body": "<p>This is a good opportunity to use dependency injection and interfaces.</p>\n\n<p>Namely, we need to extract the concept of a <code>Notifier</code></p>\n\n<p>(warning: code not tested directly)</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type Notifier interface {\n    Notify(int, string)() error\n}\n</code></pre>\n\n<p>Now to avoid any confusion with the <code>notifier</code> library, use a local alias.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import \"github.com/myrepo/notifier\" mynotifier\n</code></pre>\n\n<p>Then, because the library you're using exports it as a function, not within a struct, we'll need to make a struct that implements our interface</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type myNotifier struct {}\n\nfunc (mn *myNotifier) Notify(n int, message string) error {\n  return mynotifier.Notify(n, message)\n}\n</code></pre>\n\n<p>Then you modify your function:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func MyHandler(writer http.ResponseWriter, request *http.Request, notifier Notifier) { \n    // ...\n    // ...\n\n    notifier.Notify(4, \"sdfsdf\")\n\n    // ...\n    // ...\n\n}\n</code></pre>\n\n<p>Then in your test, you're now free to send in a spy Notifier</p>\n\n<pre><code>type spyNotifier struct {\n  called boolean\n}\n\nfunc (n *spyNotifier) Notify(n int, msg string) error {\n  n.called = true\n  return\n}\n</code></pre>\n"}], "owner": {"reputation": 182, "user_id": 4643176, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9127b4dc7cb1bc1d227633311911899e?s=128&d=identicon&r=PG&f=1", "display_name": "Vinay", "link": "https://stackoverflow.com/users/4643176/vinay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2917, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1558005688, "creation_date": 1537256453, "last_edit_date": 1537256725, "question_id": 52381358, "link": "https://stackoverflow.com/questions/52381358/test-that-method-is-called-in-handler-in-golang", "title": "Test that method is called in handler in Golang", "body": "<p>I am implementing a API in Golang. I have a endpoint where I am calling a method with parameters of other package. Now I need to check that, that method has been called in the request. </p>\n\n<p>Below is the small similar scenario what I am doing and what I am expecting.</p>\n\n<h1>My handler</h1>\n\n<pre><code>package myPackage\nimport (\n    \"log\"\n    \"github.com/myrepo/notifier\" // my another package\n)\n\nfunc MyHandler(writer http.ResponseWriter, request *http.Request) { \n    // ...\n    // ...\n\n    notifier.Notify(4, \"sdfsdf\")\n\n    // ...\n    // ...\n\n}\n</code></pre>\n\n<h1>Testing handler</h1>\n\n<pre><code>func TestMyHandler(t *testing.T) {\n    // Here I want to \n    req, _ := http.NewRequest(\"GET\", \"/myendpoint\", nil)\n    // ... Want to test that notifier.Notify is called\n    // ...\n}\n</code></pre>\n\n<p>In the TestMyHandler, I want to check that <code>notifier.Notify</code> has called. </p>\n\n<h1>Findings</h1>\n\n<p>I tried to understand the <a href=\"https://godoc.org/github.com/stretchr/testify/mock#Mock.AssertNumberOfCalls\" rel=\"nofollow noreferrer\">AssertNumberOfCalls</a>, <a href=\"https://godoc.org/github.com/stretchr/testify/mock#Mock.Called\" rel=\"nofollow noreferrer\">func (*Mock) Called</a>, and <a href=\"https://godoc.org/github.com/stretchr/testify/mock#Mock.MethodCalled\" rel=\"nofollow noreferrer\">func (*Mock) MethodCalled</a> but I am not sure how to use them :(.</p>\n\n<p>I am a newbie in Golang and really exicted to do that.\nPlease let me know if I missed anything or you may need more information for more understaing.</p>\n"}, {"tags": ["arrays", "pointers", "go", "slice"], "comments": [{"owner": {"reputation": 7445, "user_id": 1564365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2ff53772b33c8b0c305481ecb7e67141?s=128&d=identicon&r=PG", "display_name": "Kyslik", "link": "https://stackoverflow.com/users/1564365/kyslik"}, "edited": false, "score": 0, "creation_date": 1537253099, "post_id": 52380391, "comment_id": 91705109, "body": "I am no expert either but from what I understand from docs I think that if you use <code>%p slice</code>, it prints the address of 0th element (so maybe you can do some pointer arithmetic?!) and <code>%p &amp;slice</code> prints the pointer of the slice including the &quot;wrapper&quot; or &quot;overhead&quot;. I think you read the docs, I just want to make sure <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">golang.org/pkg/fmt</a>"}, {"owner": {"reputation": 41, "user_id": 8510089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7325c561588d606503c1aee968dbfe53?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Yang", "link": "https://stackoverflow.com/users/8510089/jeffrey-yang"}, "reply_to_user": {"reputation": 7445, "user_id": 1564365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2ff53772b33c8b0c305481ecb7e67141?s=128&d=identicon&r=PG", "display_name": "Kyslik", "link": "https://stackoverflow.com/users/1564365/kyslik"}, "edited": false, "score": 0, "creation_date": 1537253774, "post_id": 52380391, "comment_id": 91705451, "body": "just tried! thank you so much :-)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1537254650, "post_id": 52380391, "comment_id": 91705937, "body": "&quot;I am very new on golang&quot; so two advices: The language is called &quot;Go&quot; and always read the full documentation of a function including the package level documentation. Always."}, {"owner": {"reputation": 41, "user_id": 8510089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7325c561588d606503c1aee968dbfe53?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Yang", "link": "https://stackoverflow.com/users/8510089/jeffrey-yang"}, "edited": false, "score": 0, "creation_date": 1537255629, "post_id": 52380391, "comment_id": 91706493, "body": "thank you, Volker!"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 8510089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7325c561588d606503c1aee968dbfe53?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Yang", "link": "https://stackoverflow.com/users/8510089/jeffrey-yang"}, "edited": false, "score": 0, "creation_date": 1537253711, "post_id": 52380546, "comment_id": 91705415, "body": "thank you so much! that&#39;s very clear. I should go to read document then :-)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1537254004, "last_edit_date": 1592644375, "creation_date": 1537253510, "answer_id": 52380546, "question_id": 52380391, "link": "https://stackoverflow.com/questions/52380391/print-address-of-slice-in-golang/52380546#52380546", "title": "Print address of slice in golang", "body": "<p>Slices in Go are small, struct-like data structures, pointing to a backing array that actually holds the elements of the slice. Slice headers can be modeled with the type <a href=\"https://golang.org/pkg/reflect/#SliceHeader\" rel=\"nofollow noreferrer\"><code>reflect.SliceHeader</code></a>:</p>\n<pre><code>type SliceHeader struct {\n        Data uintptr\n        Len  int\n        Cap  int\n}\n</code></pre>\n<p>Quoting from the package doc of <code>fmt</code>, the verb <code>%p</code>:</p>\n<blockquote>\n<h2>Printing:</h2>\n<h3>The Verbs:</h3>\n<p>Slice:</p>\n<pre><code>%p    address of 0th element in base 16 notation, with leading 0x\n</code></pre>\n<p>Pointer:</p>\n<pre><code>%p    base 16 notation, with leading 0x\nThe %b, %d, %o, %x and %X verbs also work with pointers,\nformatting the value exactly as if it were an integer.\n</code></pre>\n</blockquote>\n<p>So indeed, passing a slice value for the <code>%p</code> verb prints the address of the 0th element, which is the 0th element of the backing array, and when you pass <code>&amp;slice</code> for <code>%p</code>, that will print the address of the slice header (because <code>&amp;slice</code> is already a pointer value).</p>\n<p>To verify, also print explicitly the address of the 0th element:</p>\n<pre><code>fmt.Printf(&quot;address of slice %p \\n&quot;, slice)\nfmt.Printf(&quot;address of slice %p \\n&quot;, &amp;slice)\nfmt.Println(&amp;slice[0])\n</code></pre>\n<p>Output will be (try it on the <a href=\"http://address%20of%20slice%200x170460%20%20address%20of%20slice%200x17d0b8%20%200x170460\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>address of slice 0x170460 \naddress of slice 0x17d0b8 \n0x170460\n</code></pre>\n<p>As you can see, <code>&amp;slice[0]</code> is the same value as <code>%p</code> for <code>slice</code>.</p>\n<p>Now let's modify the example to use our own backing array:</p>\n<pre><code>var arr = [4]int{1, 2, 3, 4}\nvar slice = arr[:]\n</code></pre>\n<p>So this way we can also print the address of the 0th element of the backing array:</p>\n<pre><code>fmt.Printf(&quot;address of slice %p \\n&quot;, slice)\nfmt.Printf(&quot;address of slice %p \\n&quot;, &amp;slice)\nfmt.Println(&amp;slice[0])\nfmt.Printf(&quot;Array 0th: %p&quot;, &amp;arr[0])\n</code></pre>\n<p>Output (try it on the <a href=\"https://play.golang.org/p/GS3T6ad1BjG\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>address of slice 0x170460 \naddress of slice 0x183e78 \n0x170460\nArray 0th: 0x170460\n</code></pre>\n<p>And yes, the address of the 0th element of the backing array is indeed the same as the address of the 0th element of the slice, which is the same value printed for <code>slice</code> when passed for the <code>%p</code> verb.</p>\n"}], "owner": {"reputation": 41, "user_id": 8510089, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7325c561588d606503c1aee968dbfe53?s=128&d=identicon&r=PG&f=1", "display_name": "Jeffrey Yang", "link": "https://stackoverflow.com/users/8510089/jeffrey-yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1405, "favorite_count": 0, "accepted_answer_id": 52380546, "answer_count": 1, "score": 3, "last_activity_date": 1537254004, "creation_date": 1537252875, "last_edit_date": 1537253938, "question_id": 52380391, "link": "https://stackoverflow.com/questions/52380391/print-address-of-slice-in-golang", "title": "Print address of slice in golang", "body": "<p>I am very new on golang. Here I have one question confused me a while.\nI know we should use \"&amp;\" to get address, but what if we use printf on slice without \"&amp;\"?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar slice = []int{1, 2, 3, 4}\n\nfunc main() {\n\n   fmt.Printf(\"address of slice %p \\n\", slice)\n\n   fmt.Printf(\"address of slice %p \\n\", &amp;slice)\n\n}\n</code></pre>\n\n<p>The result is like this on my MacBook:</p>\n\n<blockquote>\n  <p>address of slice <strong>0x11354d0</strong></p>\n  \n  <p>address of slice <strong>0x1128be0</strong></p>\n</blockquote>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["go", "pascals-triangle"], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 10314829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e70667a7db2264ea1aeb86706221c80?s=128&d=identicon&r=PG&f=1", "display_name": "NewToGo", "link": "https://stackoverflow.com/users/10314829/newtogo"}, "edited": false, "score": 0, "creation_date": 1537273766, "post_id": 52386116, "comment_id": 91717545, "body": "PascalTriangle[r][c] = *PascalTriangle[r][c].Add(&amp;PascalTriangle[r-1][c-1], &amp;PascalTriangle[r-1][c])                                                                                                 Basically you are assigning the pointer &quot;*PascalTriangle[r][c]&quot; and using addresses at particular cell to add the values in those cells. I don&#39;t know how does this work"}, {"owner": {"reputation": 35, "user_id": 10314829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e70667a7db2264ea1aeb86706221c80?s=128&d=identicon&r=PG&f=1", "display_name": "NewToGo", "link": "https://stackoverflow.com/users/10314829/newtogo"}, "edited": false, "score": 0, "creation_date": 1537274784, "post_id": 52386116, "comment_id": 91718234, "body": "p := 101 p = *p how is that possible"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1537271982, "creation_date": 1537271982, "answer_id": 52386116, "question_id": 52379596, "link": "https://stackoverflow.com/questions/52379596/writing-pascals-triangle-using-big-int-int/52386116#52386116", "title": "Writing Pascal&#39;s Triangle using big.Int int", "body": "<blockquote>\n  <p>I am using big.Int array so cannot use \"Add\" from \"big\" package.</p>\n</blockquote>\n\n<hr>\n\n<p>That claim is false. You can, and you should.</p>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc generatePascalTriangle(n int) [][]big.Int {\n    PascalTriangle := make([][]big.Int, n)\n    for i := range PascalTriangle {\n        PascalTriangle[i] = make([]big.Int, n)\n    }\n    var one big.Int\n    one.SetInt64(1)\n    for r := 0; r &lt; n; r++ {\n        PascalTriangle[r][0] = one\n        PascalTriangle[r][r] = one\n    }\n    for r := 2; r &lt; n; r++ {\n        for c := 1; c &lt; r; c++ {\n            // PascalTriangle[r][c] = PascalTriangle[r-1][c-1] + PascalTriangle[r-1][c]\n            PascalTriangle[r][c] = *PascalTriangle[r][c].Add(&amp;PascalTriangle[r-1][c-1], &amp;PascalTriangle[r-1][c])\n        }\n    }\n    return PascalTriangle\n}\n\nfunc main() {\n    t := generatePascalTriangle(7)\n    for i, r := range t {\n        for _, n := range r[:i+1] {\n            fmt.Print(n.String() + \" \")\n        }\n        fmt.Println()\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/KUGsjr8Mon5\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KUGsjr8Mon5</a></p>\n\n<p>Output:</p>\n\n<pre><code>1 \n1 1 \n1 2 1 \n1 3 3 1 \n1 4 6 4 1 \n1 5 10 10 5 1 \n1 6 15 20 15 6 1 \n</code></pre>\n"}], "owner": {"reputation": 35, "user_id": 10314829, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e70667a7db2264ea1aeb86706221c80?s=128&d=identicon&r=PG&f=1", "display_name": "NewToGo", "link": "https://stackoverflow.com/users/10314829/newtogo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1537272446, "creation_date": 1537249093, "last_edit_date": 1537272446, "question_id": 52379596, "link": "https://stackoverflow.com/questions/52379596/writing-pascals-triangle-using-big-int-int", "title": "Writing Pascal&#39;s Triangle using big.Int int", "body": "<p>I have some code for Pascal's Triangle using <code>big.Int</code>. How do I add the values? I get an error:</p>\n\n<pre><code>invalid operation: \nPascalTriangle[r - 1][c - 1] + PascalTriangle[r - 1][c] \n(operator + not defined on struct)\n</code></pre>\n\n<p>I am using a <code>big.Int</code> array so I cannot use <code>Add</code> from the <code>big</code> package.</p>\n\n<pre><code>func generatePascalTriangle(n int) [][]big.Int {\n    PascalTriangle := make([][]big.Int, n)\n    for i := range PascalTriangle {\n        PascalTriangle[i] = make([]big.Int, n)\n    }\n    var one big.Int\n    one.SetInt64(1)\n    for r := 0; r &lt; n; r++ {\n        PascalTriangle[r][0] = one\n        PascalTriangle[r][r] = one\n    }\n    for r := 2; r &lt; n; r++ {\n        for c := 1; c &lt; r; c++ {\n            PascalTriangle[r][c] = PascalTriangle[r-1][c-1] + PascalTriangle[r-1][c]\n        }\n    }\n    return PascalTriangle\n}\n</code></pre>\n"}, {"tags": ["go", "go-ethereum"], "comments": [{"owner": {"reputation": 91, "user_id": 10378365, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I9TdvOryG2o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNEnLKrlpOkwo7lKzwIXdklhtaeew/mo/photo.jpg?sz=128", "display_name": "Lin Corey", "link": "https://stackoverflow.com/users/10378365/lin-corey"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537250514, "post_id": 52379491, "comment_id": 91703931, "body": "OK, it is my first time to ask question in stackoverflow, so I am not very familiar with it."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1537253047, "post_id": 52379491, "comment_id": 91705086, "body": "&quot;The -n flag causes clean to print the remove commands it would execute, but not run them.&quot;"}, {"owner": {"reputation": 91, "user_id": 10378365, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I9TdvOryG2o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNEnLKrlpOkwo7lKzwIXdklhtaeew/mo/photo.jpg?sz=128", "display_name": "Lin Corey", "link": "https://stackoverflow.com/users/10378365/lin-corey"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1537253893, "post_id": 52379491, "comment_id": 91705516, "body": "Thank you very much.  @Peter I asked a silly question. Just now I tried -x and it works. I will close this question."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537289402, "post_id": 52380780, "comment_id": 91727608, "body": "Don&#39;t close the question because you got an answer--instead accept the correct answer."}, {"owner": {"reputation": 91, "user_id": 10378365, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I9TdvOryG2o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNEnLKrlpOkwo7lKzwIXdklhtaeew/mo/photo.jpg?sz=128", "display_name": "Lin Corey", "link": "https://stackoverflow.com/users/10378365/lin-corey"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537322885, "post_id": 52380780, "comment_id": 91738591, "body": "OK, no problem. @Flimzy"}], "tags": [], "owner": {"reputation": 91, "user_id": 10378365, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I9TdvOryG2o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNEnLKrlpOkwo7lKzwIXdklhtaeew/mo/photo.jpg?sz=128", "display_name": "Lin Corey", "link": "https://stackoverflow.com/users/10378365/lin-corey"}, "is_accepted": false, "score": -1, "last_activity_date": 1537254442, "creation_date": 1537254442, "answer_id": 52380780, "question_id": 52379491, "link": "https://stackoverflow.com/questions/52379491/why-command-go-clean-n-r-i-github-com-ethereum-go-ethereum-does-not-work/52380780#52380780", "title": "Why command &quot;go clean -n -r -i github.com/ethereum/go-ethereum...&quot; does not work?", "body": "<p>The correct answer is actually provided by @Peter in comment. As Peter said \"The -n flag causes clean to print the remove commands it would execute, but not run them.\"</p>\n\n<p>I tried \"-x\" instead of \"-n\", and it works well. Thanks Peter. But you posted your answer in comment section, so I have to post your answer here and close this question.</p>\n"}], "owner": {"reputation": 91, "user_id": 10378365, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-I9TdvOryG2o/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaNEnLKrlpOkwo7lKzwIXdklhtaeew/mo/photo.jpg?sz=128", "display_name": "Lin Corey", "link": "https://stackoverflow.com/users/10378365/lin-corey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537254442, "creation_date": 1537248456, "last_edit_date": 1537253584, "question_id": 52379491, "link": "https://stackoverflow.com/questions/52379491/why-command-go-clean-n-r-i-github-com-ethereum-go-ethereum-does-not-work", "title": "Why command &quot;go clean -n -r -i github.com/ethereum/go-ethereum...&quot; does not work?", "body": "<p>What I did were as follows step by step:</p>\n\n<ol>\n<li><p>Git clone go-ethereum project to my local PC. It is located in\nD:\\GOPATH\\src\\github.com\\ethereum\\go-ethereum. It is the source code\nof go-ethereum</p>\n\n<p>Note: The OS is windows 7. Go has already been installed. And GOPATH env has already been set to \"D:\\GOPATH\"</p></li>\n<li><p>cd /d D:\\GOPATH\\src\\github.com\\ethereum\\go-ethereum. Then execute\n\"go install\". Some exe files were genereated under D:\\GOPATH\\bin\ndirectory, and many pkg file with suffix .a were generated under\nD:\\GOPATH\\pkg directory. Everything seems no problem.</p></li>\n<li>Execute \"go clean -n -r -i github.com/ethereum/go-ethereum...\" to\nremove all the generated exe files and .a files. But something very\ninteresting happened:</li>\n</ol>\n\n<p>In the command's log, it showed that some files are deleted, but actually they are not deleted from disk. </p>\n\n<p>For example, event.a exists under D:\\GOPATH\\pkg\\windows_amd64\\github.com\\ethereum\\go-ethereum, but the log of \"git clean\" shows:\"rm -f D:\\GOPATH\\pkg\\windows_amd64\\github.com\\ethereum\\go-ethereum\\event.a\"</p>\n\n<p>The detailed information is in the attached images.</p>\n\n<p>It is very strange. The log does not match with the actual result:</p>\n\n<p>A small segment of go clean command is as follows(since there are more than 1300 lines in log, I can not paste all of it):</p>\n\n<blockquote>\n  <p>cd D:\\GOPATH\\src\\github.com\\ethereum\\go-ethereum\\event<br />\n  rm -f event.test event.test.exe<br />\n  rm -f D:\\GOPATH\\pkg\\windows_amd64\\github.com\\ethereum\\go-ethereum\\event.a<br />\n  cd D:\\GOPATH\\src\\github.com\\ethereum\\go-ethereum\\common\\mclock<br />\n  rm -f mclock.test mclock.test.exe<br />\n  rm -f D:\\GOPATH\\pkg\\windows_amd64\\github.com\\ethereum\\go-ethereum\\common\\mclock.a<br />\n  cd D:\\GOPATH\\src\\github.com\\ethereum\\go-ethereum\\vendor\\github.com\\aristanetworks\\goarista\\monotime<br />\n  rm -f monotime.test monotime.test.exe<br />\n  rm -f D:\\GOPATH\\pkg\\windows_amd64\\github.com\\ethereum\\go-ethereum\\vendor\\github.com\\aristanetworks\\goarista\\monotime.a<br />\n  cd D:\\GOPATH\\src\\github.com\\ethereum\\go-ethereum\\accounts\\abi<br />\n  rm -f abi.test abi.test.exe<br />\n  rm -f D:\\GOPATH\\pkg\\windows_amd64\\github.com\\ethereum\\go-ethereum\\accounts\\abi.a<br />\n  cd D:\\GOPATH\\src\\github.com\\ethereum\\go-ethereum\\accounts\\abi\\bind<br />\n  rm -f bind.test bind.test.exe<br />\n  rm -f D:\\GOPATH\\pkg\\windows_amd64\\github.com\\ethereum\\go-ethereum\\accounts\\abi\\bind.a<br /></p>\n</blockquote>\n\n<p>But some of the files remain:</p>\n\n<p><a href=\"https://i.stack.imgur.com/aZYVj.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aZYVj.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "gorequest"], "comments": [{"owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "edited": false, "score": 0, "creation_date": 1537247960, "post_id": 52379379, "comment_id": 91702997, "body": "You can do something like this ? <code>request := gorequest.New().Timeout(2*time.Millisecond) resp, body, errs:= request.Get(&quot;http:&#47;&#47;example.com&quot;).End()</code>. You need to handle what should happen when the timeout hits."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537248099, "post_id": 52379379, "comment_id": 91703034, "body": "Did you see the documentation for <a href=\"https://github.com/parnurzeal/gorequest#timeout\" rel=\"nofollow noreferrer\">setting a timeout</a>?"}, {"owner": {"reputation": 835, "user_id": 4008473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/bab2d01a5c2ce91bed8964aabf65527c?s=128&d=identicon&r=PG&f=1", "display_name": "user27111987", "link": "https://stackoverflow.com/users/4008473/user27111987"}, "edited": false, "score": 0, "creation_date": 1537253215, "post_id": 52379379, "comment_id": 91705175, "body": "No I know how to set timeout. I want to detect if the request is timing out or not."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 1, "last_activity_date": 1537259291, "creation_date": 1537259291, "answer_id": 52382188, "question_id": 52379379, "link": "https://stackoverflow.com/questions/52379379/gorequest-package-check-specifically-for-timeout/52382188#52382188", "title": "gorequest package : check specifically for timeout", "body": "<p>Since the Timeout method <a href=\"https://github.com/parnurzeal/gorequest/blob/faf2e78/gorequest.go#L489\" rel=\"nofollow noreferrer\">sets the dealines for dial, read, and write</a>, you can use <a href=\"https://golang.org/pkg/os/#IsTimeout\" rel=\"nofollow noreferrer\">os.IsTimeout</a> (all error types in the net and net/url packages implement <code>Timeout() bool</code>). Contexts are not supported by gorequest, so <a href=\"https://golang.org/pkg/context/#pkg-variables\" rel=\"nofollow noreferrer\">context.Canceled</a> doesn't have to be considered:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"net/http/httptest\"\n    \"time\"\n\n    \"github.com/parnurzeal/gorequest\"\n)\n\nfunc main() {\n    s := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        time.Sleep(time.Second)\n    }))\n\n    request := gorequest.New()\n    _, _, errs := request.Get(s.URL).Timeout(500 * time.Millisecond).End()\n\n    for _, err := range errs {\n        if os.IsTimeout(err) {\n            log.Fatal(\"timeout\")\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 835, "user_id": 4008473, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/bab2d01a5c2ce91bed8964aabf65527c?s=128&d=identicon&r=PG&f=1", "display_name": "user27111987", "link": "https://stackoverflow.com/users/4008473/user27111987"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 193, "favorite_count": 0, "accepted_answer_id": 52382188, "answer_count": 1, "score": -2, "last_activity_date": 1537259291, "creation_date": 1537247734, "last_edit_date": 1537247951, "question_id": 52379379, "link": "https://stackoverflow.com/questions/52379379/gorequest-package-check-specifically-for-timeout", "title": "gorequest package : check specifically for timeout", "body": "<p>I am using the below package to make a outbound http request\n<a href=\"https://github.com/parnurzeal/gorequest\" rel=\"nofollow noreferrer\">https://github.com/parnurzeal/gorequest</a></p>\n\n<p>For eg I am making a GET request like below\n   res, body, errs = goReq.Get(url).End()</p>\n\n<p>My question is how to figure out if there is timeout in the request.</p>\n"}, {"tags": ["firebase", "go", "google-cloud-firestore"], "comments": [{"owner": {"reputation": 2947, "user_id": 10191554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0IbXJ.jpg?s=128&g=1", "display_name": "Angus Tay", "link": "https://stackoverflow.com/users/10191554/angus-tay"}, "edited": false, "score": 1, "creation_date": 1537241857, "post_id": 52378341, "comment_id": 91701503, "body": "Show us what you have done"}], "answers": [{"tags": [], "owner": {"reputation": 1831, "user_id": 4160532, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Ey34JagqMzQ/AAAAAAAAAAI/AAAAAAAAABo/G70W8D2LXM4/photo.jpg?sz=128", "display_name": "Kedarnag Mukanahallipatna", "link": "https://stackoverflow.com/users/4160532/kedarnag-mukanahallipatna"}, "is_accepted": true, "score": 5, "last_activity_date": 1537242219, "last_edit_date": 1537242219, "creation_date": 1537240860, "answer_id": 52378410, "question_id": 52378341, "link": "https://stackoverflow.com/questions/52378341/query-based-on-a-boolean-value-inside-a-document-field-set-as-object/52378410#52378410", "title": "Query based on a boolean value inside a document field set as Object", "body": "<p>Is this what you're looking for ?</p>\n\n<pre><code>documents := client.Collection(\"collection_name\")\n\ndocuments_that_are_true = documents.Where(\"field.flag\", \"==\", true)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 1271257, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9cb7a8800c84b03e579af22c00417eee?s=128&d=identicon&r=PG", "display_name": "Guy", "link": "https://stackoverflow.com/users/1271257/guy"}, "edited": false, "score": 0, "creation_date": 1537277255, "post_id": 52378573, "comment_id": 91719927, "body": "Thx as well. Simplistic way."}], "tags": [], "owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "is_accepted": false, "score": 1, "last_activity_date": 1537242035, "creation_date": 1537242035, "answer_id": 52378573, "question_id": 52378341, "link": "https://stackoverflow.com/questions/52378341/query-based-on-a-boolean-value-inside-a-document-field-set-as-object/52378573#52378573", "title": "Query based on a boolean value inside a document field set as Object", "body": "<p>That should be fairly simple:</p>\n\n<pre><code>query := client.Collection(\"rootCollection\").Where(\"field.flag\", \"==\", true)\n</code></pre>\n"}], "owner": {"reputation": 77, "user_id": 1271257, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/9cb7a8800c84b03e579af22c00417eee?s=128&d=identicon&r=PG", "display_name": "Guy", "link": "https://stackoverflow.com/users/1271257/guy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2238, "favorite_count": 0, "accepted_answer_id": 52378410, "answer_count": 2, "score": -2, "last_activity_date": 1537248137, "creation_date": 1537240268, "last_edit_date": 1537248137, "question_id": 52378341, "link": "https://stackoverflow.com/questions/52378341/query-based-on-a-boolean-value-inside-a-document-field-set-as-object", "title": "Query based on a boolean value inside a document field set as Object", "body": "<p>SO I have a collection set at this :</p>\n\n<blockquote>\n  <p>rootCollection -> document1 -> \"field\" : {\"flag\":true, \"name\" : \"test1\"}</p>\n  \n  <p>rootCollection -> document2 -> \"field\" : {\"flag\":false, \"name\" : \"test2\"}</p>\n  \n  <p>rootCollection -> document3 -> \"field\" : {\"flag\":true, \"name\" : \"test3\"}</p>\n</blockquote>\n\n<p>So my document contains a field \"field1\" which is an object.</p>\n\n<p>I would like to make a query to fetch the valid documents where my \"flag\" is set as true.</p>\n\n<p>Hence returning in this example, only document 1 and 3</p>\n\n<p>How can I achieve that ?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1537239676, "post_id": 52377795, "comment_id": 91701044, "body": "It worked, but I am still trying to understand why it worked. Any more info may help me understand it conceptually"}, {"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "reply_to_user": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 1, "creation_date": 1537242103, "post_id": 52377795, "comment_id": 91701559, "body": "@curiousengineer Well, when you issue a command like <code>sed -i &#39;s&#47;old&#47;new&#47;&#39; file.txt</code> in the shell, first the shell gets to process the arguments, one step of which includes quote removal. What sed gets to see is just <code>-i s&#47;old&#47;new file.txt</code>. I you use quote in Go&#39;s <code>exec.Command()</code>, sed gets to see <code>-i &#39;s&#47;old&#47;new&#39; file.txt</code>, i.e., a command that contains literal single quotes. That&#39;s like issuing this in the shell: <code>sed -i &quot;&#39;s&#47;old&#47;new&#39;&quot; file.txt</code>."}, {"owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "reply_to_user": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1537242210, "post_id": 52377795, "comment_id": 91701589, "body": "@curiousengineer If you&#39;re interested, try running a few commands with <code>set -x</code> in Bash, and it&#39;ll show you what actually gets executed after quote removal &amp; co."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "edited": false, "score": 0, "creation_date": 1537281316, "post_id": 52377795, "comment_id": 91722791, "body": "@curiousengineer -- Benjamin W. explained it well above."}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": true, "score": 3, "last_activity_date": 1537235230, "creation_date": 1537235230, "answer_id": 52377795, "question_id": 52377590, "link": "https://stackoverflow.com/questions/52377590/how-to-exec-command-to-do-sed/52377795#52377795", "title": "How to exec command to do sed", "body": "<p>The <code>exec</code> package doesn't use the shell, so take out all quotes (and escapes).  In your case, remove the single quotes.</p>\n"}], "owner": {"reputation": 1438, "user_id": 4260303, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/e5ffc35d29354418bfb03c44dcf5fae5?s=128&d=identicon&r=PG&f=1", "display_name": "curiousengineer", "link": "https://stackoverflow.com/users/4260303/curiousengineer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "accepted_answer_id": 52377795, "answer_count": 1, "score": -1, "last_activity_date": 1537248260, "creation_date": 1537233087, "last_edit_date": 1537248260, "question_id": 52377590, "link": "https://stackoverflow.com/questions/52377590/how-to-exec-command-to-do-sed", "title": "How to exec command to do sed", "body": "<p>I have the following snippet that is not working. Compiles but does not do what it is supposed to. Executing the same command on bash works. Why?</p>\n\n<pre><code>hash:=\"4ab32de\"\ncmd = \"sed -i -e 's/clt_[0-9a-z]*/clt_\"+hash+\"/g' /tmp/test.env\"\n    parts = strings.Fields(cmd)\n    for _, part :=range parts {\n        fmt.Printf(\"\\n%s\",part)\n    }\n\n    head = parts[0]\n    out, err = exec.Command(head,parts[1:]...).Output()\n    fmt.Printf(\"\\nnew cmd is %s\\n\",cmd)\n    fmt.Printf(\"out:%s\",string(out))\n</code></pre>\n\n<p>The output of parts is perfect, like this</p>\n\n<pre><code>sed\n-i\n-e\n's/clt_[0-9a-z]*/clt_4ab32de/g'\n/tmp/test.env\n</code></pre>\n"}, {"tags": ["go", "proxy", "reverse-proxy", "go-gin"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1537213608, "post_id": 52374659, "comment_id": 91694221, "body": "Is there a particular reason you&#39;re reinventing the wheel, rather than using <a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\">httputil.ReverseProxy</a> for this?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1537214525, "post_id": 52374659, "comment_id": 91694586, "body": "The <code>eanapi.ReverseProxy</code> does probably not doing what you believe. It appears to me it generates get/post request to the remote in the form <code>&#47;somethingaction</code>, those urls does not exist in the remote server."}, {"owner": {"reputation": 183, "user_id": 6332350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/174636bb020880af7f2e579699c297f1?s=128&d=identicon&r=PG&f=1", "display_name": "Nizar AYARI", "link": "https://stackoverflow.com/users/6332350/nizar-ayari"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537215386, "post_id": 52374659, "comment_id": 91694949, "body": "@Flimzy I tried ReverseProxy, same errors!"}, {"owner": {"reputation": 183, "user_id": 6332350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/174636bb020880af7f2e579699c297f1?s=128&d=identicon&r=PG&f=1", "display_name": "Nizar AYARI", "link": "https://stackoverflow.com/users/6332350/nizar-ayari"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1537215592, "post_id": 52374659, "comment_id": 91695045, "body": "@mh-cbon, I tried with &#39;/&#39; but same errors."}, {"owner": {"reputation": 1853, "user_id": 6232665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/41eeea507e28cddc2bc1efc3b2b73c45?s=128&d=identicon&r=PG&f=1", "display_name": "zenwraight", "link": "https://stackoverflow.com/users/6232665/zenwraight"}, "edited": false, "score": 0, "creation_date": 1537217967, "post_id": 52374659, "comment_id": 91696051, "body": "you can take a look into go-micro package, it does mdns and service discovery based on that."}], "answers": [{"comments": [{"owner": {"reputation": 202, "user_id": 2371208, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb513b5f4429544497d6a6b585269322?s=128&d=identicon&r=PG", "display_name": "Mantas Karanauskas", "link": "https://stackoverflow.com/users/2371208/mantas-karanauskas"}, "edited": false, "score": 0, "creation_date": 1592837979, "post_id": 55004891, "comment_id": 110560887, "body": "I had this: req.URL.Host = origin.Host this was missing:  req.Host = origin.Host"}], "tags": [], "owner": {"reputation": 1045, "user_id": 647306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db01d8445d31d0f9218a215ac582c1d8?s=128&d=identicon&r=PG", "display_name": "sirfilip", "link": "https://stackoverflow.com/users/647306/sirfilip"}, "is_accepted": false, "score": 1, "last_activity_date": 1551795484, "creation_date": 1551795484, "answer_id": 55004891, "question_id": 52374659, "link": "https://stackoverflow.com/questions/52374659/golang-reverse-proxy-returns-not-found-or-forbidden-errors/55004891#55004891", "title": "Golang reverse proxy returns Not found or Forbidden Errors", "body": "<p>Not sure if this will help but <a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/httputil/#ReverseProxy</a> you can use the Director function to debug and change the path of the request, inspect the incoming reques. Also make sure to change not only the req.URL.Host but change the req.Host too cause that one is going to be picked up by apache/nginx virtual hosts settings. Dont give up and remember to have fun :)</p>\n"}], "owner": {"reputation": 183, "user_id": 6332350, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/174636bb020880af7f2e579699c297f1?s=128&d=identicon&r=PG&f=1", "display_name": "Nizar AYARI", "link": "https://stackoverflow.com/users/6332350/nizar-ayari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1037, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1551795484, "creation_date": 1537213351, "question_id": 52374659, "link": "https://stackoverflow.com/questions/52374659/golang-reverse-proxy-returns-not-found-or-forbidden-errors", "title": "Golang reverse proxy returns Not found or Forbidden Errors", "body": "<p>I'm trying to create a reverse proxy that takes all requests and redirect them into a target url, like google.com or any other API. Unfortunately, all targets returns errors like page Not Found, or Forbidden Errors</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>func main() {\r\n\tr := gin.Default()\r\n\r\n\teanAPI := api.NewEanAPI()\r\n\r\n\trouters.InitRedirectRoutes(r, eanAPI)\r\n\tport := os.Getenv(\"PORT\")\r\n\tif len(port) == 0 {\r\n\t\tport = \"8000\"\r\n\t}\r\n\tr.Run(\":\" + port)\r\n}\r\n\r\n// InitRedirectRoutes initialize routes redirection.\r\nfunc InitRedirectRoutes(r *gin.Engine, eanAPI api.EanAPI) {\r\n\tr.POST(\"/*action\", eanAPI.ReverseProxy)\r\n\tr.GET(\"/*action\", eanAPI.ReverseProxy)\r\n}\r\n\r\n\r\ntype EanAPI interface {\r\n\tReverseProxy(ctx *gin.Context)\r\n}\r\n\r\ntype eanAPI struct {\r\n\tbaseURL string\r\n}\r\n\r\nfunc NewEanAPI() EanAPI {\r\n\treturn &amp;eanAPI{}\r\n}\r\n\r\nfunc (api *eanAPI) ReverseProxy(ctx *gin.Context) {\r\n    // proxy\r\n    forwardToHost := \"http://httpbin.org/\"\r\n    // I tried with \"https://jsonplaceholder.typicode.com/\" \r\n    \"http://google.com\"\r\n\r\n\treverseProxy := proxy.NewProxy(forwardToHost)\r\n\treverseProxy.Handle(ctx.Writer, ctx.Request, url.Parse(forwardToHost))\r\n}\r\n\r\ntype Prox struct {\r\n\ttarget *url.URL\r\n\tproxy  *httputil.ReverseProxy\r\n}\r\n\r\nfunc NewProxy(target string) *Prox {\r\n\turl, _ := url.Parse(target)\r\n\tfmt.Println(\"url\", url)\r\n\treturn &amp;Prox{target: url, proxy: httputil.NewSingleHostReverseProxy(url)}\r\n}\r\n\r\nfunc (p *Prox) Handle(w http.ResponseWriter, r *http.Request, origin *url.URL) {\r\n\tw.Header().Set(\"Content-Type\", \"application/json; charset=utf-8\")\r\n\tw.Header().Set(\"X-Forwarded-Host\", r.Host)\r\n\tw.Header().Set(\"X-Origin-Host\", origin.Host)\r\n\tr.URL.Scheme = origin.Scheme\r\n\tr.URL.Host = origin.Host\r\n\r\n\tp.proxy.ServeHTTP(w, r)\r\n}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>I spent many days trying to set appropriate headers but nothing worked so far. I think the headers were not set correctly but I don't how to copy headers from client and add it to the proxy.</p>\n\n<p>I'm using a proxy instead of a redirect because I have to do some work with the body request and response!</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["authentication", "go", "azure-sql-database", "azure-active-directory"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1537206846, "post_id": 52373039, "comment_id": 91691233, "body": "The Go standard library contains no <code>database&#47;sql</code> driver to work with DBMSes produced by Microsoft&#174;, so what exactly 3rd-party package are you using as the driver? Is it <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">github.com/denisenkom/go-mssqldb</a>?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1537207034, "post_id": 52373039, "comment_id": 91691340, "body": "If the answer to my question is &quot;yes&quot;, then please read the project&#39;s README file and use an Internet search engine to search for examples. I&#39;d start from reading <a href=\"https://github.com/denisenkom/go-mssqldb/issues?utf8=%E2%9C%93&amp;q=is%3Aissue+in%3Atitle+azure\" rel=\"nofollow noreferrer\">these issues</a>."}, {"owner": {"reputation": 9, "user_id": 10376367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02e3035711ab09ae2873a8bea0c0c94?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Kuperstein", "link": "https://stackoverflow.com/users/10376367/marc-kuperstein"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1537247410, "post_id": 52373039, "comment_id": 91702850, "body": "The answer is yes, based on Microsoft&#39;s post about using GO with SQL.  As for use an Internet search engine -- well, i appreciate sarcasm as much as the next guy but let&#39;s just say my search for the specific authentication i need because of pre-reqs set-up by others turned up not much that was useful.  Could have missed it, so thought I would ask folks who might have seen this.  I get this might not work and I might have to use another language."}], "answers": [{"tags": [], "owner": {"reputation": 260, "user_id": 3761716, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iY3GQ.jpg?s=128&g=1", "display_name": "MarStr", "link": "https://stackoverflow.com/users/3761716/marstr"}, "is_accepted": false, "score": 0, "last_activity_date": 1537211696, "creation_date": 1537211696, "answer_id": 52374375, "question_id": 52373039, "link": "https://stackoverflow.com/questions/52373039/active-directory-authenticatoin-when-connecting-to-azure-sql-database/52374375#52374375", "title": "Active directory authenticatoin when connecting to Azure SQL database", "body": "<p>There's a good article on the subject that can be found at <a href=\"https://docs.microsoft.com/en-us/azure/sql-database/sql-database-aad-authentication-configure#using-an-azure-ad-identity-to-connect-from-a-client-application\" rel=\"nofollow noreferrer\">docs.microsoft.com</a>.</p>\n\n<p>You do have a few options, with various pros and cons. However, the simplest is to inject the AAD username/password into the connection string by setting the property <code>Authentication</code> to <code>Active Directory Password</code> and then providing the properties <code>UID</code> and <code>PWD</code>.</p>\n"}], "owner": {"reputation": 9, "user_id": 10376367, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e02e3035711ab09ae2873a8bea0c0c94?s=128&d=identicon&r=PG&f=1", "display_name": "Marc Kuperstein", "link": "https://stackoverflow.com/users/10376367/marc-kuperstein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1618813848, "creation_date": 1537205593, "last_edit_date": 1537207070, "question_id": 52373039, "link": "https://stackoverflow.com/questions/52373039/active-directory-authenticatoin-when-connecting-to-azure-sql-database", "title": "Active directory authenticatoin when connecting to Azure SQL database", "body": "<p>Need to access an Azure SQL database but because of how it was created I need to use Active Directory-Integrated authentication. </p>\n\n<p>I don't see any samples for go that would be helpful.  If I could use a connection string I know how to do this, but with the GO driver it doesn't seem obvious</p>\n\n<p>Any and all ideas are appreciated</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537205100, "post_id": 52372879, "comment_id": 91690393, "body": "It&#39;s not entirely clear what your issue is here, but if you want the caller to pass in a struct and have its values populated, the function should take a <code>*User</code> instead of a <code>User</code>, and pass that pointer directly through to <code>db.Query()</code>."}, {"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537205279, "post_id": 52372879, "comment_id": 91690488, "body": "thanks, sorry I am not clear.  the struct user needs to be dynamic.  The caller needs to define what the sql results will looks like.  If the statement it passes in is like &quot;select field1, field2, from table;&quot; then the struct user will need to have field1 and field2 defined in it.  (each field is the column name in the database)."}, {"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537205377, "post_id": 52372879, "comment_id": 91690541, "body": "the problem is that the signature will be different each time this pgSql func is called.  the struct is defined out of scope in a different package.    The way go is it requires the struct be defined in the pgsql which makes it not as flexible as I need it to be.   I&#39;m wondering what I can do do work around this limitiation"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1537205454, "post_id": 52372879, "comment_id": 91690577, "body": "The first argument should be of type <code>interface{}</code> then."}], "answers": [{"comments": [{"owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "edited": false, "score": 0, "creation_date": 1537207644, "post_id": 52373118, "comment_id": 91691625, "body": "that is exactly what I was looking for. THANK YOU SO MUCH. I knew it was an interface I needed and thank you for explaining the correct way to reference it.   this made my day!    Have a good one yourself internet friend!"}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 3, "last_activity_date": 1537205970, "creation_date": 1537205970, "answer_id": 52373118, "question_id": 52372879, "link": "https://stackoverflow.com/questions/52372879/pass-receiver-struct-by-reference/52373118#52373118", "title": "pass receiver struct by reference", "body": "<p>If you need a different type to be passed in each time, your argument needs to be an interface and a pointer to the struct to be populated needs to be passed into that interface:</p>\n\n<pre><code>func PgSql(dest interface{}, statement string)(output []string, err error) {\n    _, err = db.Query(dest, statement)\n    // handle error\n}\n\nfunc main() {\n    var user User\n    _, err := PgSql(&amp;user, `SELECT * FROM standard_lookup WHERE pkid_ = 'STATE|AFKDZ'`)\n    // handle error\n}\n</code></pre>\n\n<p>Note that within the <code>PgSql</code> function, you're passing the <code>dest</code> interface variable directly, <em>not</em> a pointer to it.  That's because that interface already <em>holds</em> a pointer (it's called with <code>&amp;user</code>), so you don't need to pass a reference to the interface, just the value of the interface (which itself is a reference to, in this code, the <code>user</code> variable in <code>main()</code>).</p>\n"}], "owner": {"reputation": 938, "user_id": 4192486, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5Rj0W.png?s=128&g=1", "display_name": "buildmaestro", "link": "https://stackoverflow.com/users/4192486/buildmaestro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34, "favorite_count": 0, "accepted_answer_id": 52373118, "answer_count": 1, "score": -1, "last_activity_date": 1537205970, "creation_date": 1537204908, "question_id": 52372879, "link": "https://stackoverflow.com/questions/52372879/pass-receiver-struct-by-reference", "title": "pass receiver struct by reference", "body": "<p>I need a function to return a struct that was passed into the function by the caller.  The struct will be different each time the function is called.</p>\n\n<p>I'm using and ORM postgres driver \"github.com/go-pg/pg\".\nAs I understand it, ORM requires the struct be defined before calling the .Query() which populates the struct with data from the database.</p>\n\n<pre><code>func PgSql(user User, statement string)(output []string, err error) {\n\n_, err = db.Query(&amp;users, `SELECT * FROM standard_lookup WHERE pkid_ = 'STATE|AFKDZ'`)\n\n}\n</code></pre>\n\n<p>The results will be in the user struct.  However, I need this struct defined in a different package and passed into this function.    Is there some sort of interface magic I can do here?</p>\n"}, {"tags": ["http", "curl", "go"], "answers": [{"comments": [{"owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "edited": false, "score": 0, "creation_date": 1537204839, "post_id": 52372840, "comment_id": 91690271, "body": "Perfect. Thanks!"}], "tags": [], "owner": {"reputation": 32690, "user_id": 3266847, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/U0oyt.png?s=128&g=1", "display_name": "Benjamin W.", "link": "https://stackoverflow.com/users/3266847/benjamin-w"}, "is_accepted": true, "score": 4, "last_activity_date": 1537204903, "last_edit_date": 1537204903, "creation_date": 1537204747, "answer_id": 52372840, "question_id": 52372781, "link": "https://stackoverflow.com/questions/52372781/only-returning-first-parameter-in-multiple-get-parameter-request/52372840#52372840", "title": "Only returning first parameter in multiple get parameter request", "body": "<p>If you issue</p>\n\n\n\n<pre class=\"lang-sh prettyprint-override\"><code>curl --request GET http://127.0.0.1/juris?d=11111&amp;a=22222\n</code></pre>\n\n<p>the shell will see</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>curl --request GET http://127.0.0.1/juris?d=11111 &amp; a=22222\n</code></pre>\n\n<p>and run the first command as a background job, that's why the <code>a</code> part was ignored. (It actually resulted in the shell setting the variable <code>a</code> to <code>22222</code>.) To get it to work, you have to escape your URL:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>curl --request GET 'http://127.0.0.1/juris?d=11111&amp;a=22222'\n</code></pre>\n"}], "owner": {"reputation": 8219, "user_id": 135605, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/7c56ff86a79852b167d84b3838756fba?s=128&d=identicon&r=PG", "display_name": "somejkuser", "link": "https://stackoverflow.com/users/135605/somejkuser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 52372840, "answer_count": 1, "score": 0, "last_activity_date": 1537204903, "creation_date": 1537204540, "last_edit_date": 1537204876, "question_id": 52372781, "link": "https://stackoverflow.com/questions/52372781/only-returning-first-parameter-in-multiple-get-parameter-request", "title": "Only returning first parameter in multiple get parameter request", "body": "<p>I have the following api curl request:</p>\n\n<p><code>curl --request GET http://127.0.0.1/juris?d=11111&amp;a=22222</code></p>\n\n<p>Inside my <code>http handler function</code> which has the arguments: <code>w http.ResponseWriter,r *http.Request</code> i have the code:</p>\n\n<pre><code>defer r.Body.Close()\nkeys,ok := r.URL.Query()[\"d\"]   \nif !ok{\n respondWithError(w,http.StatusBadRequest,\"InvalidQuery\")\n return\n}\ndnisQuery := string(keys[0])\nakeys,aok := r.URL.Query()[\"a\"]     \nif !aok{\n respondWithError(w,http.StatusBadRequest,\"InvalidQuery\")\n return\n}\naniQuery := string(akeys[0])\n</code></pre>\n\n<p>It validates and passes the correct value for the first query parameter <code>d</code> but it fails for the second parameter <code>a</code> with an <code>InvalidQuery</code></p>\n\n<p>Not sure what im doing incorrectly.</p>\n"}, {"tags": ["html", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 6, "creation_date": 1537196847, "post_id": 52370716, "comment_id": 91686089, "body": "You can&#39;t call a function on your server directly from the browser. You have to make some kind of HTTP call from the browser (page load, form submission, or AJAX-type call from JavaScript), and have it accepted by a handler on the server, which can then execute any Go code you want."}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10342776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad4f6db090f0a1c2f7264907df4afc4?s=128&d=identicon&r=PG&f=1", "display_name": "Madpeky", "link": "https://stackoverflow.com/users/10342776/madpeky"}, "edited": false, "score": 0, "creation_date": 1537254351, "post_id": 52375225, "comment_id": 91705787, "body": "That is a simple and nice answer. I&#39;ll try today, thank you !"}], "tags": [], "owner": {"reputation": 26, "user_id": 4751761, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ofF67asiOs8/AAAAAAAAAAI/AAAAAAAACCw/v3p5OAjiljo/photo.jpg?sz=128", "display_name": "Pandurang Nayak", "link": "https://stackoverflow.com/users/4751761/pandurang-nayak"}, "is_accepted": false, "score": 1, "last_activity_date": 1537216002, "creation_date": 1537216002, "answer_id": 52375225, "question_id": 52370716, "link": "https://stackoverflow.com/questions/52370716/how-to-add-an-html-button/52375225#52375225", "title": "How to add an HTML button", "body": "<p>Assuming you have a HTTP Handler for your Go program, which is what is serving the page - then you can have the button simply do a window.reload() through JavaScript, which will reload the page in the browser and re-invoke the Go script.</p>\n\n<p>If you want this to happen without a reload, then you'd have to create a different HTTP Route and use AJAX (look up the fetch method in JavaScript), get the results over the network (maybe as JSON) and then update the data in the frontend.</p>\n"}], "owner": {"reputation": 1, "user_id": 10342776, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad4f6db090f0a1c2f7264907df4afc4?s=128&d=identicon&r=PG&f=1", "display_name": "Madpeky", "link": "https://stackoverflow.com/users/10342776/madpeky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 208, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1537254268, "creation_date": 1537196693, "last_edit_date": 1537254268, "question_id": 52370716, "link": "https://stackoverflow.com/questions/52370716/how-to-add-an-html-button", "title": "How to add an HTML button", "body": "<p>I'm building a web app (well at least one page on it) that shows the results of pings to different IPs.</p>\n\n<p>I have no probs on Go displaying them on an HTML page. The simple thing I can't do (and I read so many tuto/threads that I'm lost and don't know what to do....) is to create a button \"Refresh\" that could just call back the \"pingip\" function i created in Go file.</p>\n\n<p>Anyone has a concrete/\"easy\" example on how I could do this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537195976, "post_id": 52370420, "comment_id": 91685462, "body": "At what point are you seeing an issue with the variable not being initialized? And what do you mean by your second question?"}, {"owner": {"reputation": 1561, "user_id": 1340439, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4b9aa7c3409a4c7187b514eb101d8f32?s=128&d=identicon&r=PG", "display_name": "Karesh A", "link": "https://stackoverflow.com/users/1340439/karesh-a"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1537196229, "post_id": 52370420, "comment_id": 91685629, "body": "updated the Test call. calling inside main method after the config load. Sorry. removed the second question. its kind of answer to my first question."}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1537197036, "post_id": 52370420, "comment_id": 91686233, "body": "Can you change the <code>Test</code> function to take either the configuration or the value in question as a parameter, and not rely on the magic global?"}, {"owner": {"reputation": 1561, "user_id": 1340439, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4b9aa7c3409a4c7187b514eb101d8f32?s=128&d=identicon&r=PG", "display_name": "Karesh A", "link": "https://stackoverflow.com/users/1340439/karesh-a"}, "edited": false, "score": 0, "creation_date": 1537197235, "post_id": 52370420, "comment_id": 91686366, "body": "Thanks. I plan to change to function with receivers and create struct with the value x after config loads."}], "answers": [{"tags": [], "owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "is_accepted": false, "score": 1, "last_activity_date": 1537196468, "creation_date": 1537196468, "answer_id": 52370631, "question_id": 52370420, "link": "https://stackoverflow.com/questions/52370420/go-global-variable-initialisation/52370631#52370631", "title": "Go global variable initialisation", "body": "<p><code>x</code> is being defined before your main or test methods are invoked, which means <code>appConfig</code> hasn't been initialized yet (as appConfig is initialized by a call to <code>LoadConfig</code>). </p>\n\n<p>In order for x to be initialize-able in the way that you seem to want, you'd need appConfig to be initialized prior to main/test execution. Instead of calling <code>LoadConfig</code>, you'd instead want to have something like:</p>\n\n<pre><code>var appConfig = NewConfig()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1561, "user_id": 1340439, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4b9aa7c3409a4c7187b514eb101d8f32?s=128&d=identicon&r=PG", "display_name": "Karesh A", "link": "https://stackoverflow.com/users/1340439/karesh-a"}, "edited": false, "score": 0, "creation_date": 1537197118, "post_id": 52370633, "comment_id": 91686299, "body": "Thanks for the detail explanation."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1537196472, "last_edit_date": 1592644375, "creation_date": 1537196472, "answer_id": 52370633, "question_id": 52370420, "link": "https://stackoverflow.com/questions/52370420/go-global-variable-initialisation/52370633#52370633", "title": "Go global variable initialisation", "body": "<p>Per <a href=\"https://golang.org/ref/spec#Program_initialization_and_execution\" rel=\"nofollow noreferrer\">the Go specification</a>, the order of execution is as follows:</p>\n<blockquote>\n<p>Package initialization\u2014variable initialization and the invocation of init functions\u2014happens in a single goroutine, sequentially, one package at a time. An init function may launch other goroutines, which can run concurrently with the initialization code. However, initialization always sequences the init functions: it will not invoke the next one until the previous one has returned.</p>\n<p>Program execution begins by initializing the main package and then invoking the function main. When that function invocation returns, the program exits. It does not wait for other (non-main) goroutines to complete.</p>\n</blockquote>\n<p>Meaning the order is roughly:</p>\n<ol>\n<li>Global variables get initialized</li>\n<li><code>init()</code> functions run</li>\n<li><code>main()</code> runs</li>\n</ol>\n<p>So your global initialization is happening before <code>main()</code> has a chance to load your configuration.</p>\n"}], "owner": {"reputation": 1561, "user_id": 1340439, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/4b9aa7c3409a4c7187b514eb101d8f32?s=128&d=identicon&r=PG", "display_name": "Karesh A", "link": "https://stackoverflow.com/users/1340439/karesh-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 111, "favorite_count": 0, "accepted_answer_id": 52370633, "answer_count": 2, "score": -1, "last_activity_date": 1537196472, "creation_date": 1537195787, "last_edit_date": 1537196189, "question_id": 52370420, "link": "https://stackoverflow.com/questions/52370420/go-global-variable-initialisation", "title": "Go global variable initialisation", "body": "<p>Issue on loading the configuration on file scope global variable.</p>\n\n<p>The config setting and and loading config values inside main method</p>\n\n<pre><code>func main() {\n\n    if err := config.LoadConfig(); err != nil {\n        logrus.Info(\"Unable to read config : \")\n        os.Exit(-1)\n    }\n\n    fmt.Println(config.GetConfig().Value) // print the correct value\n\n    service.Test() // prints 0  \n\n}\n</code></pre>\n\n<p>my config setting. config.go</p>\n\n<pre><code>var appConfig AppConfig\n\nfunc LoadConfig() error {\n  // loads config\n  appConfig = .... \n}\n\nfunc GetConfig() AppConfig {\n    return appConfig\n}\n</code></pre>\n\n<p>I have another service file with global variable defined inside service.go</p>\n\n<pre><code>   var x = config.GetConfig().Value\n\n    func Test(){\n      fmt.Println(x)\n    }\n</code></pre>\n\n<p>Question:</p>\n\n<p>Why my <strong>global variable x inside service.go</strong> is not initialized ?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "reflection", "protocol-buffers"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1537201841, "post_id": 52369213, "comment_id": 91688864, "body": "Build slice of field indexes as you walk the structure in analyze. Store the indexes in ProtoField. Use godoc.org/reflect#Value.FieldByIndex to get field."}], "answers": [{"tags": [], "owner": {"reputation": 835, "user_id": 609972, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/79214eedeeec6ce12fb53f384d50239a?s=128&d=identicon&r=PG", "display_name": "pkazmierczak", "link": "https://stackoverflow.com/users/609972/pkazmierczak"}, "is_accepted": false, "score": 1, "last_activity_date": 1537214001, "creation_date": 1537214001, "answer_id": 52374797, "question_id": 52369213, "link": "https://stackoverflow.com/questions/52369213/setting-values-of-nested-struct-fields-using-reflection-in-go/52374797#52374797", "title": "Setting values of nested struct fields using reflection in Go", "body": "<p>Problem solved. <a href=\"https://stackoverflow.com/questions/52369213/setting-values-of-nested-struct-fields-using-reflection-in-go#comment91688864_52369213\">ThunderCat</a> was right in his comment: the trick is to use <code>FieldByIndex</code>. I didn't notice the signature of that method before, I thought it accepts an integer as an argument, but in fact it takes a <em>slice</em> of integers. It was then easy to modify my <code>analyze</code> function that traverses the structure recursively and now also constructs a slice of indexes as it goes. Now I can just <code>r := reflect.ValueOf(&amp;result).Elem().FieldByIndex(field.Idx)</code> and I'm laughing. </p>\n\n<p>Lesson learned here: if you want to set values of nested <code>struct</code> fields using reflection, don't call them by name; call them by index.</p>\n"}], "owner": {"reputation": 835, "user_id": 609972, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/79214eedeeec6ce12fb53f384d50239a?s=128&d=identicon&r=PG", "display_name": "pkazmierczak", "link": "https://stackoverflow.com/users/609972/pkazmierczak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1520, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1564134240, "creation_date": 1537191863, "question_id": 52369213, "link": "https://stackoverflow.com/questions/52369213/setting-values-of-nested-struct-fields-using-reflection-in-go", "title": "Setting values of nested struct fields using reflection in Go", "body": "<p>I'm trying to create a protobuf structure out of a</p>\n\n<pre><code>type FlatMessage map[string][]byte\n</code></pre>\n\n<p>and I'm struggling with setting values of nested fields. </p>\n\n<p>I have an</p>\n\n<pre><code>func (fm *FlatMessage) Unflatten() (pb.Message, error)\n</code></pre>\n\n<p>method to transform flat message into structured protobuf. </p>\n\n<p>I also have a helper function called <code>analyze</code> which takes a struct of type <code>pb.Message</code> and returns a <code>map[int]*ProtoField</code> where:</p>\n\n<pre><code>type ProtoField struct {\n    Name  string\n    Type  reflect.Type\n}\n</code></pre>\n\n<p>i.e. <code>analyze</code> traverses <code>pb.Message</code> recursively and gathers all the information I need about it. So far so good. </p>\n\n<p>Now when I go key by key through my <code>FlatMessage</code>, the key is an encoded field number of a respective protobuf field, and I can set it using reflection, like this:</p>\n\n<pre><code>r := reflect.ValueOf(&amp;result).Elem().FieldByName(field.Name)\nif r.IsValid() {\n    r.Set(scalarValue)\n}\n</code></pre>\n\n<p>but that works only when the <code>field.Name</code> in question does not refer to a nested field, i.e., setting <code>OldV1Id</code> works fine, but attempting to set <code>Profile.Id</code> or, say, <code>Destination.Address.TypeOfNumber</code>, results in:</p>\n\n<pre><code>panic: reflect: call of reflect.Value.Set on zero Value [recovered]\n    panic: reflect: call of reflect.Value.Set on zero Value\n</code></pre>\n\n<p>I understand that this is due to the fact that my <code>r</code> becomes <code>&lt;invalid Value&gt;</code> when called on a field which is a nested one, but how can I work around it?</p>\n\n<p>My <code>r</code> is of course not <code>valid</code>, not addressable, and not settable. I can make a <code>reflect.New</code> out of it, but I can't figure out how to set that new <code>reflect.Value</code> in such a way that the field of my original structures becomes modified. No matter what I do the my function doesn't modify fields with nested names with this approach. </p>\n\n<p>Another solution I tried is adding a\n        Value reflect.Value\nto my <code>ProtoField</code> structure, and modifying <code>analyze</code> so that it appends a <code>reflect.ValueOf(s).Field(i)</code> where <code>s</code> is the top-level struct <code>interface{}</code> and <code>i</code> is its ith field. Then whenever I encounter a field that is a nested one, I call <code>r := reflect.ValueOf(field.Value)</code>, but then the problem is I'm unable to call <code>r.Set(scalarValue)</code> because of incompatible types. </p>\n\n<p>Any help or insight is much appreciated. </p>\n"}, {"tags": ["go", "tcp", "proxy"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1537190337, "post_id": 52368603, "comment_id": 91681692, "body": "Related / possible duplicate: <a href=\"https://stackoverflow.com/questions/43021058/golang-read-request-body/43021236#43021236\">Golang read request body</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1501, "user_id": 6414477, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6a2c251e715864f098ebf4b4057848b1?s=128&d=identicon&r=PG&f=1", "display_name": "rhillhouse", "link": "https://stackoverflow.com/users/6414477/rhillhouse"}, "edited": false, "score": 0, "creation_date": 1537193231, "post_id": 52369115, "comment_id": 91683687, "body": "Wow, <code>io.MultiReader()</code> is exactly what I was looking for! Thank you"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 3, "last_activity_date": 1537191558, "creation_date": 1537191558, "answer_id": 52369115, "question_id": 52368603, "link": "https://stackoverflow.com/questions/52368603/string-representation-of-byte-in-proxy-handler-function/52369115#52369115", "title": "String representation of []byte in proxy handler function", "body": "<p>You can use <a href=\"https://golang.org/pkg/io/#MultiReader\" rel=\"nofollow noreferrer\">io.MultiReader</a> to concatenate two or more readers. So you can Read() from c1, and then use a MultiReader to \"replay\" the bytes you already read.</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"io\"\n    \"log\"\n    \"net\"\n)\n\nfunc main() {\n    var c1, c2 net.Conn\n\n    buf := make([]byte, 64)\n    n, err := c1.Read(buf)\n    buf = buf[:n]\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // TODO: deal with string(buf)\n\n    errc := make(chan error, 2)\n\n    go func() {\n        // Replay contents of buf, then copy the unread part of c1.\n        _, err := io.Copy(c2, io.MultiReader(bytes.NewReader(buf), c1))\n        errc &lt;- err\n    }()\n\n    go func() {\n        _, err := io.Copy(c1, c2)\n        errc &lt;- err\n    }()\n\n    err = &lt;-errc\n    log.Println(err)\n}\n</code></pre>\n\n<p>Alternatively, simply Write() the bytes before starting to copy:</p>\n\n<pre><code>    go func() {\n        // Replay contents of buf\n        _, err := c2.Write(buf)\n        if err != nil {\n            errc &lt;- err\n            return\n        }\n\n        _, err = io.Copy(c2, c1)\n        errc &lt;- err\n    }()\n</code></pre>\n"}], "owner": {"reputation": 1501, "user_id": 6414477, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6a2c251e715864f098ebf4b4057848b1?s=128&d=identicon&r=PG&f=1", "display_name": "rhillhouse", "link": "https://stackoverflow.com/users/6414477/rhillhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 52369115, "answer_count": 1, "score": 2, "last_activity_date": 1537191558, "creation_date": 1537189924, "question_id": 52368603, "link": "https://stackoverflow.com/questions/52368603/string-representation-of-byte-in-proxy-handler-function", "title": "String representation of []byte in proxy handler function", "body": "<p>I am building a TCP proxy with <code>go</code>, but I am facing a small problem. Before actually handling the connection <code>c1</code> and forwarding it to <code>c2</code>, I want to do some checks. To do this, I need the string representation of the byte slice from <code>c1</code>. Unfortunately, <code>_, err := io.CopyBuffer(w, r, buf)</code> is copying the <code>[]byte</code> directly between the writer and reader, and if I do <code>c1.Read()</code> before the <code>cp</code> function, the <code>[]byte</code> have already been read. </p>\n\n<p>Here is the function containing the connection handling:</p>\n\n<pre><code> func (p *proxy) handle(c1 net.Conn) {\n        p.log.Printf(\"accepted %v\", c1.RemoteAddr())\n        defer p.log.Printf(\"disconnected %v\", c1.RemoteAddr())\n        defer c1.Close()\n        c2, err := dialer.Dial(\"tcp\", p.dial)\n        log.Println(\"DIAL:\", p.dial)\n        if err != nil {\n            p.log.Print(\"C2\", err)\n            return\n        }\n        defer c2.Close()\n\n        errc := make(chan error, 2)\n        cp := func(w io.Writer, r io.Reader) {\n            buf := bufferPool.Get().([]byte)\n            _, err := io.CopyBuffer(w, r, buf)\n            errc &lt;- err\n            bufferPool.Put(buf)\n        }\n        go cp(struct{ io.Writer }{c1}, c2)\n        go cp(c2, struct{ io.Reader }{c1})\n        err = &lt;-errc\n        if err != nil {\n            p.log.Print(\"F-ERROR -&gt;\", err)\n        }\n    }\n</code></pre>\n\n<p>Is there a way to \"duplicate\" the <code>[]byte</code> so that I can use the duplicate to display as a string?</p>\n"}, {"tags": ["unit-testing", "go", "refactoring"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537192732, "post_id": 52368322, "comment_id": 91683344, "body": "I don&#39;t see why you need an interface in place of <code>APITokenHandlerSt</code>, it&#39;s just a slice of values and as a parameter to the function under test, it can be simply passed in to make the test pass/fail."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537193093, "post_id": 52368322, "comment_id": 91683591, "body": "Assuming <code>a.CallServer</code> makes an HTTP request to some server you could use <code>net&#47;http&#47;httptest</code>&#39;s <code>Server</code> type to fake that target server and with it you can easily respond with a 200, 403, etc. and thereby properly exercise the function under test."}, {"owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1537200677, "post_id": 52368322, "comment_id": 91688317, "body": "<code>CallServer</code> does more than just make request to server. In fact, when I attempted to write unit-test, against this method, I got a panic. Updating question with its definition (which, as a unit-tester, should be none of my concern), as well as the test attempt."}, {"owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537201033, "post_id": 52368322, "comment_id": 91688509, "body": "UPDATE: I forgot to initalize the underlying <code>APICoreHandler</code>, and with the <code>fakeServer.URL</code>. That fixed everything"}], "owner": {"reputation": 3022, "user_id": 2027839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f0cdfc83802dff15a73a5c273c1b4154?s=128&d=identicon&r=PG", "display_name": "Mike Warren", "link": "https://stackoverflow.com/users/2027839/mike-warren"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537200815, "creation_date": 1537189058, "last_edit_date": 1537200815, "question_id": 52368322, "link": "https://stackoverflow.com/questions/52368322/making-a-golang-business-method-with-multiple-dependencies-testable", "title": "Making a Golang business method with multiple dependencies testable", "body": "<p>I have a job as a unit-tester, and there's a couple of functions that, as they are, are untestable. I have tried telling my immediate boss this, and he's telling me that I cannot refactor the code to make it testable. I will bring it up in today's meeting, but first, I want to make sure that I have a solid plan on doing the refactoring such that the business use case doesn't change. </p>\n\n<p><strong>The method</strong></p>\n\n<p>The method itself is defined like this: </p>\n\n<pre><code>//SendRequest This is used to contact the apiserver synchronously.\nfunc (apiPath *APIPath) SendRequest(context interface{}, tokenHandler *apiToken.APITokenHandlerSt,\n    header map[string]string,\n    urlParams []string, urlQueries url.Values,\n    jsonBody []byte) apiCore.CallResultSt {\n    if apiToken := tokenHandler.GetToken(apiPath.AuthType, apiPath.Scope); apiToken != nil {\n        return apiPath.APICoreHandler.SendRequest(\n            context,\n            apiToken.Token,\n            apiPath.GetPath(urlParams, urlQueries), apiPath.Type,\n            header, jsonBody)\n    } else {\n        errMsg, _ := json.Marshal(errors.InvalidAuthentication())\n        return apiCore.CallResultSt{DetailObject: errMsg, IsSucceeded: false}\n    }\n}\n</code></pre>\n\n<p>where its receiver object is defined thus:</p>\n\n<pre><code>//APIPath=======================\n//Used for url construction\ntype APIPath struct {\n    APICoreHandler *apiCore.APICoreSt\n    // domain name of API\n    DomainPath string\n    ParentAPI  *APIPath\n    Type       apiCore.APIType\n    // subfunction name\n    SubFunc          string\n    KeyName          string\n    AutoAddKeyToPath bool\n    AuthType         oAuth2.OAuth2Type\n    Scope            string\n}\n</code></pre>\n\n<p><strong>Dependencies</strong></p>\n\n<p>You may have observed at least two of them: <code>tokenHandler.GetToken</code> and <code>APICoreHandler.SendRequest</code></p>\n\n<p>The definitions of those, and their objects are as follows: </p>\n\n<p><em>tokenHandler</em></p>\n\n<pre><code>type APITokenHandlerSt struct {\n    Tokens []APITokenSt\n}\n</code></pre>\n\n<p><em>tokenHandler.GetToken</em></p>\n\n<pre><code>// GetToken returns the token having the specified `tokenType` and `scope`\n//\n// Parameters:\n// - `tokenType`\n// - `scope`\n//\n// Returns:\n// - pointer to Token having `tokenType`,`scope` or nil\nfunc (ath *APITokenHandlerSt) GetToken(tokenType oAuth2.OAuth2Type, scope string) *APITokenSt {\n    if ath == nil {\n        return nil\n    }\n    if i := ath.FindToken(tokenType, scope); i == -1 {\n        return nil\n    } else {\n        return &amp;ath.Tokens[i]\n    }\n}\n</code></pre>\n\n<p><em>APICoreHandler</em></p>\n\n<pre><code>type APICoreSt struct {\n    BaseURL string\n}\n</code></pre>\n\n<p><em>APICoreHandler.SendRequest</em></p>\n\n<pre><code>//Establish the request to send to the server\nfunc (a *APICoreSt) SendRequest(context interface{}, token string, apiURL string, callType APIType, header map[string]string, jsonBody []byte) CallResultSt {\n    if header == nil {\n        header = make(map[string]string)\n    }\n    if header[\"Authorization\"] == \"\" {\n        header[\"Authorization\"] = \"Bearer \" + token\n    }\n    header[\"Scope\"] = GeneralScope\n    header[\"Content-Type\"] = \"application/json; charset=UTF-8\"\n    return a.CallServer(context, callType, apiURL, header, jsonBody)\n}\n</code></pre>\n\n<p><em>APICoreHandler.CallServer</em></p>\n\n<pre><code>//CallServer Calls the server\n//\n// Parameters:\n// - `context` : a context to pass to the server\n// - `apiType` : the HTTP method (`GET`,`POST`,`PUT`,`DELETE`,...)\n// - `apiURL` : the URL to hit\n// - `header` : request header\n// - `jsonBody`: the JSON body to send\n//\n// Returns:\n// - a CallResultSt. This CallResultSt might have an error for its `DetailObject`\nfunc (a *APICoreSt) CallServer(context interface{}, apiType APIType, apiURL string, header map[string]string, jsonBody []byte) CallResultSt {\n\n    var (\n        Url     = a.BaseURL + apiURL\n        err     error\n        res     *http.Response\n        resBody json.RawMessage\n        hc      = &amp;http.Client{}\n        req     = new(http.Request)\n    )\n\n    req, err = http.NewRequest(string(apiType), Url, bytes.NewBuffer(jsonBody))\n    if err != nil {\n        //Use a map instead of errorSt so that it doesn't create a heavy dependency.\n        errorSt := map[string]string{\n            \"Code\":    \"ez020300007\",\n            \"Message\": \"The request failed to be created.\",\n        }\n        logger.Instance.LogError(err.Error())\n        err, _ := json.Marshal(errorSt)\n        return CallResultSt{DetailObject: err, IsSucceeded: false}\n    }\n\n    for k, v := range header {\n        req.Header.Set(k, v)\n    }\n\n    res, err = hc.Do(req)\n    if res != nil {\n        resBody, err = ioutil.ReadAll(res.Body)\n        res.Body = ioutil.NopCloser(bytes.NewBuffer(resBody))\n    }\n    return CallResultSt{resBody, logger.Instance.CheckAndHandleErr(context, res)}\n\n}\n</code></pre>\n\n<p><strong>My progress thus far</strong></p>\n\n<p>Obviously, <code>tokenHandler</code> has no business being passed in as an object, especially when its state is not being used. Thus, making that testable would be as simple as create a one-method interface, and use it instead of the <code>*apiToken.APITokenHandlerSt</code></p>\n\n<p>My concern, however, is with that <code>APICoreHandler</code> and its <code>SendRequest</code> method. I would like to know how to refactor it such that the use case of this code under test doesn't change, whilst allowing me to control this. </p>\n\n<p><strong>This is imperative, because most of the methods I have yet to test, hit <code>apiPath.SendRequest</code> somehow</strong></p>\n\n<p><strong>UPDATE</strong>: I made the following test attempt, which caused panic:</p>\n\n<pre><code>func TestAPIPath_SendRequest(t *testing.T) {\n\n    // create a fake server that returns a string\n    fakeServer := httptest.NewServer(http.HandlerFunc(\n        func(w http.ResponseWriter, r *http.Request) {\n            fmt.Fprintln(w, \"Hello world!\")\n        }))\n    defer fakeServer.Close()\n\n    // define some values\n    scope := \"testing\"\n    authType := oAuth2.AtPassword\n\n    // create a tokenHandler\n    tokenHandler := new(apiToken.APITokenHandlerSt)\n    tokenHandler.Tokens = []apiToken.APITokenSt{\n        apiToken.APITokenSt{\n            Scope:     scope,\n            TokenType: authType,\n            Token:     \"dummyToken\",\n        },\n    }\n\n    // create some APIPaths\n    validAPIPath := &amp;APIPath{\n        Scope:    scope,\n        AuthType: authType,\n    }\n\n    type args struct {\n        context      interface{}\n        tokenHandler *apiToken.APITokenHandlerSt\n        header       map[string]string\n        urlParams    []string\n        urlQueries   url.Values\n        jsonBody     []byte\n    }\n    tests := []struct {\n        name    string\n        apiPath *APIPath\n        args    args\n        want    apiCore.CallResultSt\n    }{}\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := tt.apiPath.SendRequest(tt.args.context, tt.args.tokenHandler, tt.args.header, tt.args.urlParams, tt.args.urlQueries, tt.args.jsonBody); !reflect.DeepEqual(got, tt.want) {\n                t.Errorf(\"APIPath.SendRequest() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n\n    t.Run(\"SanityTest\", func(t *testing.T) {\n        res := validAPIPath.SendRequest(\"context\",\n            tokenHandler,\n            map[string]string{},\n            []string{},\n            url.Values{},\n            []byte{},\n        )\n        assert.True(t,\n            res.IsSucceeded)\n    })\n}\n</code></pre>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1537188534, "post_id": 52367973, "comment_id": 91680444, "body": "You would need lookahead support for that but <code>regexp</code> in Go does not support that either. You may create a kind of a loop to find a match one by one and change the string to  remove group 1 and 2 from it to prepare for the next iteration."}, {"owner": {"reputation": 137, "user_id": 4694193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/690053f5046e186fab6c94ea3e38a90c?s=128&d=identicon&r=PG&f=1", "display_name": "lucio", "link": "https://stackoverflow.com/users/4694193/lucio"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 0, "creation_date": 1537188873, "post_id": 52367973, "comment_id": 91680663, "body": "Unfortunally, some chunks can have quoted strings so near (ie: we&#39;re &quot;really&quot; near &quot;quoted&quot; strings) I&#39;ve to completely rematch it. Plus, I don&#39;t think match and replace/remove groups would be an efficient way..."}], "answers": [{"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": true, "score": 2, "last_activity_date": 1537258503, "last_edit_date": 1537258503, "creation_date": 1537189915, "answer_id": 52368599, "question_id": 52367973, "link": "https://stackoverflow.com/questions/52367973/rematch-same-or-part-of-previous-matched-group/52368599#52368599", "title": "Rematch same or part of previous matched group", "body": "<p>If you go back to the original problem, you need to extract the quotes in context.</p>\n\n<p>Since you don't have lookahead, you could use regexp just to match quotes (or even just strings.Index), and just get byte ranges, then expand to include context yourself by expanding the range (this may require more work if dealing with complex UTF strings). </p>\n\n<p>Something like: </p>\n\n<pre><code>input := `this is a very long text \"with\" some quoted strings I \"need\" to extract in their own context`\n\nre := regexp.MustCompile(`(\".*?\")`)\n\nmatches := re.FindAllStringIndex(input, -1)\n\nfor _, m := range matches {\n    s := m[0] - 20\n    e := m[1] + 20\n    if s &lt; 0 {\n        s = 0\n    }\n    if e &gt;= len(input) {\n        e = -1\n    }\n    fmt.Printf(\"%s\\n\", input[s:e])\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/brH8v6OM-Fx\" rel=\"nofollow noreferrer\">https://play.golang.org/p/brH8v6OM-Fx</a></p>\n"}], "owner": {"reputation": 137, "user_id": 4694193, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/690053f5046e186fab6c94ea3e38a90c?s=128&d=identicon&r=PG&f=1", "display_name": "lucio", "link": "https://stackoverflow.com/users/4694193/lucio"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 52368599, "answer_count": 1, "score": 1, "last_activity_date": 1537258503, "creation_date": 1537187955, "question_id": 52367973, "link": "https://stackoverflow.com/questions/52367973/rematch-same-or-part-of-previous-matched-group", "title": "Rematch same or part of previous matched group", "body": "<p>I'm looking for a way to match part of - or the whole - previously matched group. For instance, assume we've the following text:</p>\n\n<p><code>this is a very long text \"with\" some quoted strings I \"need\" to match in their own context</code></p>\n\n<p>A regex like <code>(.{1,20})(\".*?\")(.{1,20})</code> gives the following output:</p>\n\n<pre><code># | 1st group           |   2nd group   |   3rd group\n------------------------------------------------------------------\n1 | is a very long text |   \"with\"      |   some quoted strings\n2 | I                   |   \"need\"      |   to extract in their\n</code></pre>\n\n<p>The goal's to force the regex to re-match part of the 3rd group from the 1st match - or the whole match when quoted strings are quite near - when is matching the 2nd one. Basically I'd like to have the following output instead:</p>\n\n<pre><code># | 1st group           |   2nd group   |   3rd group\n------------------------------------------------------------------\n1 | is a very long text |   \"with\"      |   some quoted strings\n2 | me quoted strings I |   \"need\"      |   to extract in their\n</code></pre>\n\n<p>Probably, a backreference support would do the trick but go regex engine lacks of it.</p>\n"}, {"tags": ["go", "marshalling"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1537183328, "post_id": 52365867, "comment_id": 91677280, "body": "&quot;Why Golang XML marshaller is ignoring this thing xml:&quot;result&quot; in AccountsList structure?&quot; Because the tag on the xml.Name field of the marshalled type is prefered over the tag on the field containing that type, even if the field is a slice of that type. The order of preference is specified here: <a href=\"https://golang.org/pkg/encoding/xml/#Marshal\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/xml/#Marshal</a>"}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "is_accepted": false, "score": 0, "last_activity_date": 1537182949, "last_edit_date": 1537182949, "creation_date": 1537181679, "answer_id": 52366136, "question_id": 52365867, "link": "https://stackoverflow.com/questions/52365867/how-to-marshal-xml/52366136#52366136", "title": "How to marshal XML", "body": "<p>Please go thorough this below code, I've tested it on go play ground and it doesn't give me any error.</p>\n\n<pre><code>func main() {\nvar al AccountsList\noutput, err := xml.MarshalIndent(al, \"  \", \"    \")\n    fmt.Println(\"Hello, playground\", err)\n    fmt.Println(string(output))\n\n}\n</code></pre>\n\n<p>You can test it too using this <a href=\"https://play.golang.org/p/DGAB0qhGtpH\" rel=\"nofollow noreferrer\">link</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "is_accepted": true, "score": 4, "last_activity_date": 1537183052, "last_edit_date": 1537183052, "creation_date": 1537182260, "answer_id": 52366308, "question_id": 52365867, "link": "https://stackoverflow.com/questions/52365867/how-to-marshal-xml/52366308#52366308", "title": "How to marshal XML", "body": "<p>You can change the field tag name from <code>result</code> to <code>result&gt;account</code>:</p>\n\n<pre><code>type AccountsList struct {\n    XMLName    xml.Name   `xml:\"response\"`\n    ResultCode string     `xml:\"resultCode\"`\n    Accounts   []Accounts `xml:\"result&gt;account\"`\n}\n</code></pre>\n\n<p>This will wrap your <code>accounts</code> slice with <code>result</code> tag.</p>\n\n<p>See: <a href=\"https://play.golang.org/p/E2oJeO81wKh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/E2oJeO81wKh</a></p>\n"}], "owner": {"reputation": 895, "user_id": 4252996, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/c708ad123f5b181bfa47381fa7ea801a?s=128&d=identicon&r=PG&f=1", "display_name": "mondayguy", "link": "https://stackoverflow.com/users/4252996/mondayguy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "accepted_answer_id": 52366308, "answer_count": 2, "score": 0, "last_activity_date": 1537260278, "creation_date": 1537180817, "last_edit_date": 1537260278, "question_id": 52365867, "link": "https://stackoverflow.com/questions/52365867/how-to-marshal-xml", "title": "How to marshal XML", "body": "<p>I have two structs in order to marshal into XML</p>\n\n<pre><code>//Accounts ...\ntype Accounts struct {\n    XMLName     xml.Name `xml:\"account\"`\n    AccNumber   string   `xml:\"iban\"`\n\n}\n\n//Accounts ...\ntype AccountsList struct {\n    XMLName    xml.Name   `xml:\"response\"`\n    ResultCode string     `xml:\"resultCode\"`\n    Accounts   []Accounts `xml:\"result\"`\n}\n</code></pre>\n\n<p>I'm getting next xml structure:</p>\n\n<pre><code>&lt;response&gt;\n    &lt;resultCode&gt;...&lt;/resultCode&gt;\n    &lt;account&gt;\n        &lt;iban&gt;...&lt;/iban&gt;\n    &lt;/account&gt;\n    &lt;account&gt;\n        &lt;iban&gt;...&lt;/iban&gt;\n    &lt;/account&gt;\n&lt;/response&gt;\n</code></pre>\n\n<p>But I need also <code>&lt;result&gt;</code> tag, so I need next xml: </p>\n\n<pre><code>&lt;response&gt;\n    &lt;resultCode&gt;...&lt;/resultCode&gt;\n    &lt;result&gt;\n        &lt;account&gt;\n            &lt;iban&gt;...&lt;/iban&gt;\n        &lt;/account&gt;\n        &lt;account&gt;\n            &lt;iban&gt;...&lt;/iban&gt;\n        &lt;/account&gt;\n    &lt;result&gt;  \n&lt;/response&gt;\n</code></pre>\n\n<p>Why Golang XML marshaller is ignoring this thing <code>xml:\"result\"</code> in <code>AccountsList</code> structure? \n<strong>Is it possible to get result I want without using third structure</strong>?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1537199357, "post_id": 52365769, "comment_id": 91687589, "body": "In addition to other uses, an underscored empty struct field can also be used (and <i>is</i> used by the standard library in places) as a zero-size method of <a href=\"https://dave.cheney.net/2015/10/09/padding-is-hard\" rel=\"nofollow noreferrer\">blocking unkeyed literals</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": false, "score": 1, "last_activity_date": 1537181805, "creation_date": 1537181805, "answer_id": 52366169, "question_id": 52365769, "link": "https://stackoverflow.com/questions/52365769/empty-nested-structure/52366169#52366169", "title": "Empty nested structure", "body": "<p>Its been used for code generation perposes. you can think of it like java which treats everything in it as an object.</p>\n\n<p>example of using it is <a href=\"https://github.com/aws/amazon-ecs-agent/blob/c0defea9598061451cf5ffd452d2ffe3d91dbc5e/agent/gogenerate/awssdk.go#L54\" rel=\"nofollow noreferrer\">here</a></p>\n\n<pre><code>{{ $shapeList := ShapeListWithErrors $ }}\n{{ range $_, $s := $shapeList }}\n{{ if eq $s.Type \"structure\"}}{{ $s.GoCode }}{{ end }}\n{{ end }}\n</code></pre>\n"}], "owner": {"reputation": 131, "user_id": 10374494, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-MSXyipESabs/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOoKzu5jWd32X-Jl-Ate1FrdSw6mw/mo/photo.jpg?sz=128", "display_name": "Hayk Sahakyan", "link": "https://stackoverflow.com/users/10374494/hayk-sahakyan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 102, "favorite_count": 2, "closed_date": 1537185655, "answer_count": 1, "score": 5, "last_activity_date": 1537181805, "creation_date": 1537180436, "last_edit_date": 1537180580, "question_id": 52365769, "link": "https://stackoverflow.com/questions/52365769/empty-nested-structure", "closed_reason": "Duplicate", "title": "Empty nested structure", "body": "<p>I was digging in AWS SDK source codes and came across with the following type declaration:</p>\n\n<pre><code>type Condition struct {\n    _ struct{} `type:\"structure\"`\n\n    // the rest of code is removed\n}\n</code></pre>\n\n<p>Do anybody know purpose/explanation of this kind of embedding?  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 3, "creation_date": 1537172139, "post_id": 52363338, "comment_id": 91670959, "body": "You have a pointer value (<code>*SegmentationFault</code>) and you are trying to use it as a <code>SegmentationFault</code>."}, {"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 1, "creation_date": 1537172179, "post_id": 52363338, "comment_id": 91670972, "body": "Because <code>new(SegmentationFault)</code> returns a <code>*SegmentationFault</code>"}], "answers": [{"tags": [], "owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "is_accepted": true, "score": 1, "last_activity_date": 1537178364, "creation_date": 1537178364, "answer_id": 52365154, "question_id": 52363338, "link": "https://stackoverflow.com/questions/52363338/variable-scope-issue-in-a-switch-statement/52365154#52365154", "title": "Variable scope issue in a switch statement", "body": "<p>Your problem is that you are passing a pointer value (<code>*SegmentationFault</code>) where you just want a value <code>SegmentationFault</code>.</p>\n\n<p>Instead of </p>\n\n<pre><code>sf := new(SegmentationFault)\n</code></pre>\n\n<p>You should do:</p>\n\n<pre><code>sf := SegmentationFault{}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 9274330, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e86861db3dfe1ff218cb0d742c46b162?s=128&d=identicon&r=PG&f=1", "display_name": "Dan", "link": "https://stackoverflow.com/users/9274330/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 248, "favorite_count": 0, "accepted_answer_id": 52365154, "answer_count": 1, "score": -1, "last_activity_date": 1537186975, "creation_date": 1537171769, "last_edit_date": 1537172835, "question_id": 52363338, "link": "https://stackoverflow.com/questions/52363338/variable-scope-issue-in-a-switch-statement", "title": "Variable scope issue in a switch statement", "body": "<p>I have a program that parses a log file and returns a slice of structs with populated data from the file. </p>\n\n<p>Also I have written a function to add a struct item to the aforemetioned list.</p>\n\n<p>But there is an error that says \"Cannot use 'sf' (type *SegmentationFault) as type SegmentationFault\" which stems from this function. How am I to solve this problem?</p>\n\n<pre><code>func (sfList *SegmentationFaultList) AddItem(item SegmentationFault) []SegmentationFault {\n    sfList.Items = append(sfList.Items, item)\n    return sfList.Items\n}\n\nfunc parseLogFile(logPath string) (s *SegmentationFaultList){\n    logFile, err := os.Open(logPath)\n    checkError(err, \"Could not open your log file\")\n    defer logFile.Close()\n\n    scanner := bufio.NewScanner(logFile)\n    parsing := false\n    sf := new(SegmentationFault)\n    sfs := []SegmentationFault{}\n    sfList := SegmentationFaultList{sfs}\n    var beginRegexp = regexp.MustCompile(`(?i).+\\[err\\]:F-(\\d+): Dump: Segmentation fault at ([\\da-z]+)$`)\n    var endRegexp = regexp.MustCompile(`(?i).+\\[info\\]:Engine child with pid \\d+ terminated`)\n    var sfTextRegexp = regexp.MustCompile(`(?i).+\\[err\\]:F-\\d+: Dump:(.+)`)\n\n    for scanner.Scan() {\n        beginMatch := beginRegexp.FindStringSubmatch(scanner.Text())\n        switch {\n        case beginMatch != nil:\n            sf.pid = beginMatch[1]\n            sf.sfAt = beginMatch[2]\n            parsing = true\n        case endRegexp.FindStringSubmatch(scanner.Text()) != nil:\n            parsing = false\n            sfList.AddItem(sf)\n        case parsing:\n            sf.sfText = append(sf.sfText, strings.TrimSpace(sfTextRegexp.FindStringSubmatch(scanner.Text())[1]))\n        }\n    }\n    if err := scanner.Err(); err != nil {\n        log.Fatal(err)\n    }\n    return sfList\n}\n</code></pre>\n"}, {"tags": ["go", "observer-pattern"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1537169694, "post_id": 52362773, "comment_id": 91669779, "body": "Closing a channel to broadcast a singular event to an arbitrary number of parties is a common thing. (IMHO the use of struct{} is overly clever here.)"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1537177470, "post_id": 52362773, "comment_id": 91673930, "body": "It&#39;s a sound approach and precisely how <a href=\"https://golang.org/pkg/context/#Context\" rel=\"nofollow noreferrer\">context.Context</a> works."}], "answers": [{"tags": [], "owner": {"reputation": 728, "user_id": 3348617, "user_type": "registered", "profile_image": "https://graph.facebook.com/1475953069/picture?type=large", "display_name": "zdebra", "link": "https://stackoverflow.com/users/3348617/zdebra"}, "is_accepted": true, "score": 1, "last_activity_date": 1537169865, "creation_date": 1537169865, "answer_id": 52362881, "question_id": 52362773, "link": "https://stackoverflow.com/questions/52362773/closechannel-used-to-implement-the-observer-pattern/52362881#52362881", "title": "close(channel) used to implement the observer pattern", "body": "<p>I would say your way is good enough but lacks some elegance.</p>\n\n<p>You could implement required behavior using <code>sync.Cond</code>:</p>\n\n<p><a href=\"https://golang.org/pkg/sync/#Cond\" rel=\"nofollow noreferrer\">https://golang.org/pkg/sync/#Cond</a><br>\n<a href=\"https://stackoverflow.com/questions/36857167/how-to-correctly-use-sync-cond\">How to correctly use sync.Cond?</a></p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 238, "favorite_count": 0, "accepted_answer_id": 52362881, "answer_count": 1, "score": 0, "last_activity_date": 1537169865, "creation_date": 1537169415, "question_id": 52362773, "link": "https://stackoverflow.com/questions/52362773/closechannel-used-to-implement-the-observer-pattern", "title": "close(channel) used to implement the observer pattern", "body": "<p>I need to stop an HTTP server on demand besides calling other functions as well when receiving the \"quit\" signal in no specific order.</p>\n\n<p>In my try to implement something like the <a href=\"https://en.wikipedia.org/wiki/Observer_pattern\" rel=\"nofollow noreferrer\">observer pattern</a>, I found \"handy\" to create a channel (<code>quit := make(chan struct{})</code>, let's say the \"<strong>subject</strong>\"  and then on each of the goroutines \"<strong>observers</strong>\" listen on that channel <code>&lt;-quit</code> waiting until a change for then to continue.</p>\n\n<p>The way I trigger all the functions at once is by closing the channel <code>close(quit)</code> not by writing into it, I have tried this and so far working, but wondering if there are some cons with this approach or if there are better/idiomatic ways of implementing similar behavior/pattern.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    var wg sync.WaitGroup\n\n    srv := &amp;http.Server{Addr: \":8080\"}\n\n    wg.Add(1)\n    go func() {\n        log.Println(srv.ListenAndServe())\n        wg.Done()\n    }()\n\n    quit := make(chan struct{})\n    go func() {\n        &lt;-quit\n        if err := srv.Close(); err != nil {\n            log.Printf(\"HTTP server Shutdown: %v\", err)\n        }\n    }()\n\n    wg.Add(1)\n    go func() {\n        &lt;-quit\n        log.Println(\"just waiting 1\")\n        wg.Done()\n    }()\n\n    wg.Add(1)\n    go func() {\n        &lt;-quit\n        log.Println(\"just waiting 2\")\n        wg.Done()\n    }()\n\n    &lt;-time.After(2 * time.Second)\n    close(quit)\n    wg.Wait()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/uIfMJfN6xQy\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uIfMJfN6xQy</a></p>\n"}, {"tags": ["go", "bson"], "comments": [{"owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "edited": false, "score": 0, "creation_date": 1537224289, "post_id": 52362225, "comment_id": 91697902, "body": "why the negative vote :/?"}], "answers": [{"tags": [], "owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "is_accepted": false, "score": 1, "last_activity_date": 1537167396, "creation_date": 1537167396, "answer_id": 52362287, "question_id": 52362225, "link": "https://stackoverflow.com/questions/52362225/how-to-flatten-out-a-nested-json-structure-in-go/52362287#52362287", "title": "How to flatten out a nested json structure in go", "body": "<p>You can use basically the same logic as:</p>\n\n<pre><code>package utils\n\n// FlattenIntegers flattens nested slices of integers\nfunc FlattenIntegers(slice []interface{}) []int {\n    var flat []int\n\n    for _, element := range slice {\n        switch element.(type) {\n        case []interface{}:\n            flat = append(flat, FlattenIntegers(element.([]interface{}))...)\n        case []int:\n            flat = append(flat, element.([]int)...)\n        case int:\n            flat = append(flat, element.(int))\n        }\n    }\n\n    return flat\n}\n</code></pre>\n\n<p>(Source: <a href=\"https://gist.github.com/Ullaakut/cb1305ede48f2391090d57cde355074f\" rel=\"nofollow noreferrer\">https://gist.github.com/Ullaakut/cb1305ede48f2391090d57cde355074f</a>)</p>\n\n<p>By adapting it for what's in your JSON. If you want it to be generic, then you'll need to support all of the types it can contain.</p>\n"}, {"comments": [{"owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "edited": false, "score": 0, "creation_date": 1537224731, "post_id": 52362737, "comment_id": 91698013, "body": "Thanks Zak, that&#39;s a pretty clean solution"}], "tags": [], "owner": {"reputation": 4099, "user_id": 6376471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/19290c0ab8b351cf10a7c0b1a9780b4c?s=128&d=identicon&r=PG", "display_name": "Zak", "link": "https://stackoverflow.com/users/6376471/zak"}, "is_accepted": true, "score": 3, "last_activity_date": 1537169288, "creation_date": 1537169288, "answer_id": 52362737, "question_id": 52362225, "link": "https://stackoverflow.com/questions/52362225/how-to-flatten-out-a-nested-json-structure-in-go/52362737#52362737", "title": "How to flatten out a nested json structure in go", "body": "<p>You can implement the <code>json.Unmarshaler</code> interface to add a custom method to unmarshal the json. Then in that method, you can use the nested struct format, but return the flattened one at the end.</p>\n\n<pre><code>func (es *EventStruct) UnmarshalJSON(data []byte) error {\n    // define private models for the data format\n\n    type driverInner struct {\n        EtaToStore int `bson:\"etaToStore\"`\n    }\n\n    type dataInner struct {\n        ID        string      `bson:\"_id\" json:\"_id\"`\n        Driver    driverInner `bson:\"driver\"`\n        CreatedAt int         `bson:\"createdAt\"`\n    }\n\n    type nestedEvent struct {\n        ID   string    `bson:\"_id\"`\n        Data dataInner `bson:\"data\"`\n    }\n\n    var ne nestedEvent\n\n    if err := json.Unmarshal(data, &amp;ne); err != nil {\n        return err\n    }\n\n    // create the struct in desired format\n    tmp := &amp;EventStruct{\n        ID:         ne.ID,\n        DataID:     ne.Data.ID,\n        EtaToStore: ne.Data.Driver.EtaToStore,\n        CreatedAt:  ne.Data.CreatedAt,\n    }\n\n    // reassign the method receiver pointer\n    // to store the values in the struct\n    *es = *tmp\n    return nil\n}\n</code></pre>\n\n<p>Runnable example: <a href=\"https://play.golang.org/p/83VHShfE5rI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/83VHShfE5rI</a></p>\n"}, {"comments": [{"owner": {"reputation": 1304, "user_id": 359954, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0ce6f85483d6570318179cbc27cf4c82?s=128&d=identicon&r=PG", "display_name": "Saad Malik", "link": "https://stackoverflow.com/users/359954/saad-malik"}, "edited": false, "score": 0, "creation_date": 1613425986, "post_id": 60658148, "comment_id": 117066779, "body": "This is exactly what I was looking for. Thanks!"}], "tags": [], "owner": {"reputation": 12023, "user_id": 1462604, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/2152f0665d54a5cfe8bde11b18f91547?s=128&d=identicon&r=PG", "display_name": "Wug", "link": "https://stackoverflow.com/users/1462604/wug"}, "is_accepted": false, "score": 2, "last_activity_date": 1584030179, "creation_date": 1584030179, "answer_id": 60658148, "question_id": 52362225, "link": "https://stackoverflow.com/questions/52362225/how-to-flatten-out-a-nested-json-structure-in-go/60658148#60658148", "title": "How to flatten out a nested json structure in go", "body": "<p>This question is a year and a half old, but I ran into it today while reacting to an API update which put me in the same situation, so here's my solution (which, admittedly, I haven't tested with <code>bson</code>, but I'm assuming the <code>json</code> and <code>bson</code> field tag reader implementations handle them the same way)</p>\n\n<p><strong>Embedded (sometimes referred to as anonymous) fields can capture JSON, so you can compose several structs into a compound one which behaves like a single structure.</strong></p>\n\n<pre><code>{\n    \"_id\" : \"bec7bfaa-7a47-4f61-a463-5966a2b5c8ce\",\n    \"data\" : {\n        \"driver\" : {\n            \"etaToStore\" : 156\n        },\n        \"createdAt\" : 1532590052,\n        \"_id\" : \"07703a33-a3c3-4ad5-9e06-d05063474d8c\"\n    }\n} \n</code></pre>\n\n\n\n<pre><code>type DriverStruct struct {\n    EtaToStore          string      `bson:\"etaToStore\"`\n\ntype DataStruct struct {\n    DriverStruct                    `bson:\"driver\"`\n    DataId              string      `bson:\"_id\"`\n    CreatedAt           int         `bson:\"createdAt\"`\n}\n\ntype EventStruct struct {\n    DataStruct                      `bson:\"data\"`\n    Id                  string      `bson:\"_id\"`\n}\n</code></pre>\n\n<p>You can access the nested fields of an embedded struct as though the parent struct contained an equivalent field, so e.g. <code>EventStructInstance.EtaToStore</code> is a valid way to get at them.</p>\n\n<p>Benefits:</p>\n\n<ul>\n<li>You don't have to implement the <code>Marshaller</code> or <code>Unmarshaller</code> interfaces, which is a little overkill for this problem</li>\n<li>Doesn't require any copying fields between intermediate structs</li>\n<li>Handles both marshalling and unmarshalling for free</li>\n</ul>\n\n<p><a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">Read more about embedded fields here.</a></p>\n"}], "owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2617, "favorite_count": 0, "accepted_answer_id": 52362737, "answer_count": 3, "score": 3, "last_activity_date": 1584030179, "creation_date": 1537167168, "question_id": 52362225, "link": "https://stackoverflow.com/questions/52362225/how-to-flatten-out-a-nested-json-structure-in-go", "title": "How to flatten out a nested json structure in go", "body": "<p>I am getting nested data from mongo and I want to flatten that out in a structure to store it in a csv file.</p>\n\n<p>The data looks like this:</p>\n\n<pre><code>{\n    \"_id\" : \"bec7bfaa-7a47-4f61-a463-5966a2b5c8ce\",\n    \"data\" : {\n        \"driver\" : {\n            \"etaToStore\" : 156\n        },\n        \"createdAt\" : 1532590052,\n        \"_id\" : \"07703a33-a3c3-4ad5-9e06-d05063474d8c\"\n    }\n} \n</code></pre>\n\n<p>And the structure I want to eventually get should be something like this</p>\n\n<pre><code>type EventStruct struct {\n    Id                  string      `bson:\"_id\"`\n    DataId              string      `bson:\"data._id\"`\n    EtaToStore          string      `bson:\"data.driver.etaToStore\"`\n    CreatedAt           int         `bson:\"data.createdAt\"`\n}\n</code></pre>\n\n<p>This doesn't work, so following <a href=\"https://stackoverflow.com/a/25966781/830230\">some SO answers</a> I broke it down into multiple structures:</p>\n\n<pre><code>// Creating a structure for the inner struct that I will receive from the query\ntype DriverStruct struct {\n    EtaToStore  int     `bson:\"etaToStore\"`\n}\n\ntype DataStruct struct {\n    Id          string `bson:\"_id\"`\n    Driver      DriverStruct `bson:\"driver\"`\n    CreatedAt   int `bson:\"createdAt\"`\n}\n// Flattenning out the structure &amp; getting the fields we need only\ntype EventStruct struct {\n    Id                  string      `bson:\"_id\"`\n    Data                DataStruct  `bson:\"data\"`\n}\n</code></pre>\n\n<p>This gets all the data from the Mongo query result but it's nested:</p>\n\n<pre><code>{\n  \"Id\": \"bec7bfaa-7a47-4f61-a463-5966a2b5c8ce\",\n  \"Data\": {\n     \"Id\": a33-a3c3-4ad5-9e06-d05063474d8c,\n     \"Driver\": {\n        \"EtaToStore\": 156\n     },\n     \"CreatedAt\": 1532590052\n  }\n}\n</code></pre>\n\n<p>What I want to end up with is:</p>\n\n<pre><code>{\n  \"Id\": \"bec7bfaa-7a47-4f61-a463-5966a2b5c8ce\",\n  \"DataId\": \"a33-a3c3-4ad5-9e06-d05063474d8c\",\n  \"EtaToStore\": 156,\n  \"CreatedAt\": 1532590052\n}\n</code></pre>\n\n<p>I'm sure there's an easy way to do this but I can't figure it out, help!</p>\n"}, {"tags": ["go", "input", "scanf", "prompt"], "answers": [{"tags": [], "owner": {"reputation": 37, "user_id": 10372559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B31-tOfZ5po/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOLkuN6BACRXbwyER5-ooTpOb2LNw/mo/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/10372559/mike"}, "is_accepted": false, "score": 2, "last_activity_date": 1537145736, "last_edit_date": 1537145736, "creation_date": 1537145354, "answer_id": 52359562, "question_id": 52359503, "link": "https://stackoverflow.com/questions/52359503/how-do-i-add-a-prompt-to-a-scan-statement/52359562#52359562", "title": "How do I add a prompt to a Scan statement?", "body": "<p>I figured it out.<br/>\nHere is one solution in case other people have this problem:<br/>\nuse <strong>fmt.Print</strong> before your scan statement.</p>\n\n<h2>Example:</h2>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n)\n\nfunc main() {\n    var phrase string\n    fmt.Print(\"Enter Phrase: \")\n    fmt.Scanln(&amp;phrase)\n    fmt.Println(\"You typed: \", phrase)\n}\n</code></pre>\n"}], "owner": {"reputation": 37, "user_id": 10372559, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-B31-tOfZ5po/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOLkuN6BACRXbwyER5-ooTpOb2LNw/mo/photo.jpg?sz=128", "display_name": "Mike", "link": "https://stackoverflow.com/users/10372559/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537176135, "creation_date": 1537144318, "last_edit_date": 1537176135, "question_id": 52359503, "link": "https://stackoverflow.com/questions/52359503/how-do-i-add-a-prompt-to-a-scan-statement", "title": "How do I add a prompt to a Scan statement?", "body": "<p>Question: How do I add a prompt to the beginning of a Scan statement in GoLang?</p>\n\n<h2>Current Output:</h2>\n\n<pre><code>Enter Phrase:\nHello World!\nYou typed: Hello world!\n</code></pre>\n\n<h2>Desired Output:</h2>\n\n<pre><code>Enter Phrase: Hello world!\nYou typed: Hello world!\n</code></pre>\n\n<h2>My Code:</h2>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n)\n\nfunc main() {\n    var phrase string\n    fmt.Println(\"Enter Phrase: \")\n    fmt.Scan(&amp;phrase)\n    fmt.Println(\"You typed: \", phrase)\n}\n</code></pre>\n\n<p>P.S. I'm sorry for posting such an elementary question.\nI have spent several hours researching, and I genuinely cannot find the answer.</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-lambda", "serverless-framework"], "comments": [{"owner": {"reputation": 371, "user_id": 8371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a960d78c618a2e95795f9115259a21?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Singh", "link": "https://stackoverflow.com/users/8371320/deepak-singh"}, "edited": false, "score": 0, "creation_date": 1537143975, "post_id": 52359263, "comment_id": 91663374, "body": "So did you used  <code>aws lambda invoke --function-name</code> CLI instead of serverless?"}, {"owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "reply_to_user": {"reputation": 371, "user_id": 8371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a960d78c618a2e95795f9115259a21?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Singh", "link": "https://stackoverflow.com/users/8371320/deepak-singh"}, "edited": false, "score": 0, "creation_date": 1537144131, "post_id": 52359263, "comment_id": 91663398, "body": "@DeepakSingh no, just through the console&#39;s UI I went to the lambda function and ran a test with the same json values"}, {"owner": {"reputation": 371, "user_id": 8371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a960d78c618a2e95795f9115259a21?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Singh", "link": "https://stackoverflow.com/users/8371320/deepak-singh"}, "edited": false, "score": 0, "creation_date": 1537144554, "post_id": 52359263, "comment_id": 91663447, "body": "Okay, Did you tried <code>aws lambda invoke</code>? Refer <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/with-userapp-walkthrough-custom-events-invoke.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/lambda/latest/dg/&hellip;</a>."}, {"owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "reply_to_user": {"reputation": 371, "user_id": 8371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a960d78c618a2e95795f9115259a21?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Singh", "link": "https://stackoverflow.com/users/8371320/deepak-singh"}, "edited": false, "score": 1, "creation_date": 1537144745, "post_id": 52359263, "comment_id": 91663475, "body": "I&#39;d rather stick to the serverless framework because it&#39;ll require less maintenance as it&#39;ll pull the data from the same yml file that&#39;s being used to deploy the function"}, {"owner": {"reputation": 365, "user_id": 1416660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XXT2N.jpg?s=128&g=1", "display_name": "ganapathydselva", "link": "https://stackoverflow.com/users/1416660/ganapathydselva"}, "edited": false, "score": 1, "creation_date": 1537153307, "post_id": 52359263, "comment_id": 91664843, "body": "Seems like a bug with serverless invoke command , similar to reported issue   <a href=\"https://github.com/serverless/serverless/issues/2685\" rel=\"nofollow noreferrer\">link</a>"}, {"owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "reply_to_user": {"reputation": 365, "user_id": 1416660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XXT2N.jpg?s=128&g=1", "display_name": "ganapathydselva", "link": "https://stackoverflow.com/users/1416660/ganapathydselva"}, "edited": false, "score": 0, "creation_date": 1537156889, "post_id": 52359263, "comment_id": 91665508, "body": "Oh, thanks for sharing that @ganapathydselva"}], "answers": [{"tags": [], "owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "is_accepted": true, "score": 1, "last_activity_date": 1537156918, "last_edit_date": 1537156918, "creation_date": 1537144238, "answer_id": 52359492, "question_id": 52359263, "link": "https://stackoverflow.com/questions/52359263/passing-json-when-invoking-function-using-serverless/52359492#52359492", "title": "Passing JSON when invoking function using serverless", "body": "<p>I found a way around this by having my JSON in a file rather than in the command itself, this doesn't solve the issue I'm experiencing in the question but it's a way to invoke the function with Json</p>\n\n<p>I added a <code>events/startAndEnd.json</code> file that contains my json data:</p>\n\n<pre><code>{\n    \"startAt\":1533513600,\n    \"endAt\":1534118399\n}\n</code></pre>\n\n<p>And referenced that file in the invoke command: <code>serverless invoke -f orders --path events/startAndEnd.json</code></p>\n"}], "owner": {"reputation": 3221, "user_id": 830230, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/YMFTp.jpg?s=128&g=1", "display_name": "Naguib Ihab", "link": "https://stackoverflow.com/users/830230/naguib-ihab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1522, "favorite_count": 0, "accepted_answer_id": 52359492, "answer_count": 1, "score": 1, "last_activity_date": 1537194586, "creation_date": 1537140994, "last_edit_date": 1537194586, "question_id": 52359263, "link": "https://stackoverflow.com/questions/52359263/passing-json-when-invoking-function-using-serverless", "title": "Passing JSON when invoking function using serverless", "body": "<p>I am running a lambda function written in Go using Serverless and I want to pass a couple of parameters to it when it's invoked.</p>\n\n<p>Here's the struct I created to receive the request:</p>\n\n<pre><code>type RequestStruct struct {\n    StartAt int `json:\"startAt\"`\n    EndAt   int `json:\"endAt\"`\n}\n</code></pre>\n\n<p>And in the handler I'm trying to print out the values:</p>\n\n<pre><code>func Handler(ctx context.Context,request RequestStruct) (Response, error) {\n    fmt.Printf(\"Request: %v\",request)\n</code></pre>\n\n<p>I tried invoking it using the <code>--raw</code> option, so I tried doing this </p>\n\n<p><code>serverless invoke -f orders --raw -d '{\"startAt\":1533513600,\"endAt\":1534118399}'</code> </p>\n\n<p>and I tried wrapping it in double quotes instead </p>\n\n<p><code>serverless invoke -f orders --raw -d \"{startAt:1533513600,endAt:1534118399}\"</code></p>\n\n<p><code>serverless invoke -f orders --raw -d \"{\\\"startAt\\\":1533513600,\\\"endAt\\\":1534118399}\"</code></p>\n\n<p>I received a marshal error with all three:</p>\n\n<pre><code>{\n    \"errorMessage\": \"json: cannot unmarshal string into Go value of type main.RequestStruct\",\n    \"errorType\": \"UnmarshalTypeError\"\n}\n</code></pre>\n\n<p>I'm not sure what I am doing wrong and I can find any examples for that online, there's only this <a href=\"https://serverless.com/framework/docs/providers/aws/cli-reference/invoke/\" rel=\"nofollow noreferrer\">serverless doc about how to do the invoke</a> and this <a href=\"https://docs.aws.amazon.com/lambda/latest/dg/go-programming-model-handler-types.html\" rel=\"nofollow noreferrer\">aws doc about how to handle the event in Go</a></p>\n\n<p><strong>Update</strong>\nI tried invoking the event from the AWS Console and it worked, so odds are the issue is in the serverless invoke command.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 4462, "user_id": 808603, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f46f9ebbb5f9e66326cdb0ba6c1ece?s=128&d=identicon&r=PG", "display_name": "Jerinaw", "link": "https://stackoverflow.com/users/808603/jerinaw"}, "edited": false, "score": 0, "creation_date": 1537132476, "post_id": 52358338, "comment_id": 91661310, "body": "So there&#39;s a list of uppercase enforced acronyms? Do you know of any documentation that suggests using uppercase for acronyms? I guess I&#39;m wondering if this is just something I&#39;m seeing because of the linter VSC is using, or would something like fmt warn me as well?"}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 4462, "user_id": 808603, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f46f9ebbb5f9e66326cdb0ba6c1ece?s=128&d=identicon&r=PG", "display_name": "Jerinaw", "link": "https://stackoverflow.com/users/808603/jerinaw"}, "edited": false, "score": 1, "creation_date": 1537133017, "post_id": 52358338, "comment_id": 91661426, "body": "I don&#39;t know of any docs that suggest doing it that way. On the go blog they wrote about using camel case but it doesn&#39;t say anything about the acronyms. And <code>gofmt</code> <a href=\"https://golang.org/cmd/gofmt/\" rel=\"nofollow noreferrer\">golang.org/cmd/gofmt</a> doesn&#39;t enforce naming conventions for acronyms, so I guess it&#39;s just the way they implemented it in VSC, but it is the way the standard library is written so if you want to stick to a standard that is probably the one you should use."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 4462, "user_id": 808603, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f46f9ebbb5f9e66326cdb0ba6c1ece?s=128&d=identicon&r=PG", "display_name": "Jerinaw", "link": "https://stackoverflow.com/users/808603/jerinaw"}, "edited": false, "score": 1, "creation_date": 1537133751, "post_id": 52358338, "comment_id": 91661549, "body": "@Jerinaw I found the docs for acronyms naming. See my updated answer."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 4462, "user_id": 808603, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f46f9ebbb5f9e66326cdb0ba6c1ece?s=128&d=identicon&r=PG", "display_name": "Jerinaw", "link": "https://stackoverflow.com/users/808603/jerinaw"}, "edited": false, "score": 0, "creation_date": 1537206686, "post_id": 52358338, "comment_id": 91691141, "body": "@Jerinaw Your IDE is likely using golint, which defines <a href=\"https://github.com/golang/lint/blob/master/lint.go#L749\" rel=\"nofollow noreferrer\">this list</a> of &quot;known initialisms&quot; that it complains about if they aren&#39;t constant-case."}, {"owner": {"reputation": 392, "user_id": 5767484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063da3e00ffcf4d3a001a1329c4e51b8?s=128&d=identicon&r=PG&f=1", "display_name": "NotX", "link": "https://stackoverflow.com/users/5767484/notx"}, "edited": false, "score": 0, "creation_date": 1558457136, "post_id": 52358338, "comment_id": 99104576, "body": "What if I have a cascade of multiple acronyms? In Java that&#39;s why I use names like <code>HttpHttpsSwitcher</code>, but according to this guideline it would be <code>HTTPHTTPSSwitcher</code> (or <code>httphttpsSwitcher</code> for reduced visibility) which is painful to read. Underscores?"}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 392, "user_id": 5767484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063da3e00ffcf4d3a001a1329c4e51b8?s=128&d=identicon&r=PG&f=1", "display_name": "NotX", "link": "https://stackoverflow.com/users/5767484/notx"}, "edited": false, "score": 0, "creation_date": 1558854566, "post_id": 52358338, "comment_id": 99232525, "body": "@NotX I agree that it is painful to read in this but that&#39;s the standard so if you want to follow it that&#39;s the way to go. If you think readability is more important than sticking with the standard I would definitely go the Java way and not use underscores. Underscores are really not used in go and the Java way still complies with the camel case standard just not with the acronym part so it&#39;s not that bad. A comment on your example above: if the field is not exported then it would be <code>httpHTTPSwitcher</code> if you follow the rule."}, {"owner": {"reputation": 63788, "user_id": 747579, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Zq3Qi.jpg?s=128&g=1", "display_name": "Abdennour TOUMI", "link": "https://stackoverflow.com/users/747579/abdennour-toumi"}, "edited": false, "score": 0, "creation_date": 1598141823, "post_id": 52358338, "comment_id": 112361705, "body": "what about the filename ?"}], "tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": true, "score": 18, "last_activity_date": 1537134088, "last_edit_date": 1537134088, "creation_date": 1537131657, "answer_id": 52358338, "question_id": 52358247, "link": "https://stackoverflow.com/questions/52358247/what-are-golang-struct-field-naming-conventions/52358338#52358338", "title": "What are Golang Struct Field Naming Conventions?", "body": "<p>For most cases the naming convention in Go is just to use camel case and start with upper case if it's a public field and lower case if it's not. But in words that are acronyms like API or URL they are written in full upper case eg. <code>func ProxyURL(fixedURL *url.URL)</code> on the <a href=\"https://golang.org/pkg/net/http/#ProxyURL\" rel=\"noreferrer\">http package</a>.</p>\n\n<p><strong>EDIT:</strong> I searched for a little bit more and there are guidelines for acronyms on the <a href=\"https://github.com/golang/go/wiki/CodeReviewComments\" rel=\"noreferrer\">Go Code Review Comments</a>. It talks about acronyms in the <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#initialisms\" rel=\"noreferrer\">Initialisms</a> section:</p>\n\n<blockquote>\n  <p>Words in names that are initialisms or acronyms (e.g. \"URL\" or \"NATO\")\n  have a consistent case. For example, \"URL\" should appear as \"URL\" or\n  \"url\" (as in \"urlPony\", or \"URLPony\"), never as \"Url\". As an example:\n  ServeHTTP not ServeHttp. For identifiers with multiple initialized\n  \"words\", use for example \"xmlHTTPRequest\" or \"XMLHTTPRequest\".</p>\n  \n  <p>This rule also applies to \"ID\" when it is short for \"identifier\", so\n  write \"appID\" instead of \"appId\".</p>\n</blockquote>\n\n<p>So the rule for acronyms is that they should have constant case. In your case because they have to start with uppercase \"A\" you should write them as \"API\".</p>\n\n<p>Also this is just my personal opinion and I know that the code in the example might not be the exact code you are using but if it is, I think it's a bad practice to include the struct name on the field names. You are doing <code>api.APIField</code> but <code>api.Field</code> is easier to read and if you know the object is an API then there is not doubt that the Field belongs to an API.</p>\n"}, {"tags": [], "owner": {"reputation": 2289, "user_id": 3142347, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Tbfqk.jpg?s=128&g=1", "display_name": "tupan", "link": "https://stackoverflow.com/users/3142347/tupan"}, "is_accepted": false, "score": 4, "last_activity_date": 1537133577, "creation_date": 1537133577, "answer_id": 52358564, "question_id": 52358247, "link": "https://stackoverflow.com/questions/52358247/what-are-golang-struct-field-naming-conventions/52358564#52358564", "title": "What are Golang Struct Field Naming Conventions?", "body": "<p>Like mentioned here in your question and in @topo's answer, the convention for variable an function naming is Camel Case (mixed caps). If the name starts with an upper case letter the variable/function can be exported.</p>\n\n<p>Packages are always lower case.</p>\n\n<p>Interfaces should end with <code>-er</code></p>\n\n<p>You can read more in the <a href=\"https://golang.org/doc/effective_go.html#names\" rel=\"nofollow noreferrer\">effective go naming session</a> </p>\n\n<p>Golint on the other hand, goes beyond Go convention for naming. There are a few rules for words and in your case you are hitting one of the rules. You can see the full list here: <a href=\"https://github.com/golang/lint/blob/master/lint.go#L751\" rel=\"nofollow noreferrer\">https://github.com/golang/lint/blob/master/lint.go#L751</a></p>\n"}], "owner": {"reputation": 4462, "user_id": 808603, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/40f46f9ebbb5f9e66326cdb0ba6c1ece?s=128&d=identicon&r=PG", "display_name": "Jerinaw", "link": "https://stackoverflow.com/users/808603/jerinaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13274, "favorite_count": 2, "accepted_answer_id": 52358338, "answer_count": 2, "score": 10, "last_activity_date": 1537134088, "creation_date": 1537130844, "last_edit_date": 1592644375, "question_id": 52358247, "link": "https://stackoverflow.com/questions/52358247/what-are-golang-struct-field-naming-conventions", "title": "What are Golang Struct Field Naming Conventions?", "body": "<p>I'm trying to learn Go, using Visual Studio Code, and I guess it's using a Go linter. I created this struct to map a JSON object into.</p>\n<pre><code>type someAPI struct {\n    ApiEndpoint string   `json:&quot;apiEndpoint&quot;`\n    ApiVersion  string   `json:&quot;apiVersion&quot;`\n    ...\n}\n</code></pre>\n<p>And I get these warnings...</p>\n<blockquote>\n<p>struct field ApiEndpoint should be APIEndpoint</p>\n<p>struct field ApiVersion should be APIVersion</p>\n</blockquote>\n<p>I did some Googling and I can not find any requirements for struct field names regarding this. The most I've found is that if you want to make a field public you have to capitalize it.</p>\n<p>So why is this linter warning me about these names?</p>\n<p>I did some testing by changing <code>Api</code> to <code>Abc</code> and the linter didn't warn me to change it to &quot;ABC&quot;. So I have to assume it's checking for names that start with &quot;Api&quot;.</p>\n<p>What are Go conventions for field names? Or in other words, are there other conventions I should know about?</p>\n"}, {"tags": ["docker", "go", "docker-compose", "dockerfile", "docker-multi-stage-build"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1537126748, "post_id": 52357475, "comment_id": 91659974, "body": "Debugging suggestion: if you temporarily change your final image to be <code>FROM busybox</code>, you can launch a shell in it to see what&#39;s in the image."}], "answers": [{"tags": [], "owner": {"reputation": 1628, "user_id": 8034986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Wi1Kc.jpg?s=128&g=1", "display_name": "Simone Zabberoni", "link": "https://stackoverflow.com/users/8034986/simone-zabberoni"}, "is_accepted": false, "score": 1, "last_activity_date": 1537126878, "creation_date": 1537126878, "answer_id": 52357783, "question_id": 52357475, "link": "https://stackoverflow.com/questions/52357475/docker-multistage-build-for-golang-create-big-image/52357783#52357783", "title": "Docker multistage build for golang create big image", "body": "<p>You should use first a <code>golang:alpine</code> container to build the app, then an <code>alpine</code>to run the compiled app.</p>\n\n<p>Something like this:</p>\n\n<pre><code># builder\nFROM golang:alpine AS builder\nWORKDIR /go/src/tzf\nADD . /go/src/tzf\nRUN CGO_ENABLED=0 go build -ldflags '-extldflags \"-static\"' -o ova tzf\n\n# runner\nFROM alpine\nWORKDIR /app\nCOPY --from=builder /build/main /app/\nCMD [\u201c./ova -v\"]\n</code></pre>\n\n<p>should result in a small footprint container.</p>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "edited": false, "score": 0, "creation_date": 1537128506, "post_id": 52357807, "comment_id": 91660438, "body": "you are amazing :) this solve the issue. thank you very much!!! . one question, is there a simple way which I can look at this container?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "edited": false, "score": 0, "creation_date": 1537128542, "post_id": 52357807, "comment_id": 91660447, "body": "now the size is 11.5 MB, but since this a cli program how can I check that it working?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "edited": false, "score": 0, "creation_date": 1537128626, "post_id": 52357807, "comment_id": 91660466, "body": "when i run it locally I can run command <code>ova -v</code> and it works, I see the version of the cli, how can I check it with docker to see everthing is working?"}, {"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1537143912, "post_id": 52357807, "comment_id": 91663363, "body": "With the uncommented version of the Dockerfile, having built the image, you should be able to <code>docker run imagename -v</code> (everything after the image name gets passed as command-line arguments to the entrypoint).  Remember that the image has only the binary and not, say, a shell, so it&#39;s harder to poke around at it."}, {"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1537208871, "post_id": 52357807, "comment_id": 91692213, "body": "@JennyM one way i&#39;ve used to do a sanity test is to add something like <code>RUN [&quot;&#47;ova&quot;, &quot;-v&quot;]</code> after the copy in the scratch image. The trick is to use the  <code>[]</code> run syntax which will not use a shell."}], "tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": true, "score": 0, "last_activity_date": 1537127127, "creation_date": 1537127127, "answer_id": 52357807, "question_id": 52357475, "link": "https://stackoverflow.com/questions/52357475/docker-multistage-build-for-golang-create-big-image/52357807#52357807", "title": "Docker multistage build for golang create big image", "body": "<p>When you build your final image, be careful to copy only the exact files you want to end up in the image.  It makes sense here to make your binary be the ENTRYPOINT of the image, since there's literally nothing else you can do with it.</p>\n\n<p>I might make a two-stage pipeline like so:</p>\n\n<pre><code># size of this stage doesn't matter; use the standard image\nFROM golang AS builder\nWORKDIR /go/src/tzf\nADD . ./\nRUN CGO_ENABLED=0 go build -ldflags '-extldflags \"-static\"' -o /ova tzf\n\nFROM scratch\n# only copy the one file, may as well put it in /\nCOPY --from=builder /ova /ova\nENTRYPOINT [\"/ova\"]\n# if you want to launch it with default options, you can\n# CMD [\"-v\"]\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 610, "favorite_count": 0, "accepted_answer_id": 52357807, "answer_count": 2, "score": 1, "last_activity_date": 1537127127, "creation_date": 1537124636, "last_edit_date": 1537126054, "question_id": 52357475, "link": "https://stackoverflow.com/questions/52357475/docker-multistage-build-for-golang-create-big-image", "title": "Docker multistage build for golang create big image", "body": "<p>I want to use the multi stage build for my gaoling project, when I build the project locally for linux/windows/Mac\nI got <strong>12.6 mb of size</strong> , I\u2019ve currently small gaoling CLI program.</p>\n\n<p>Now I want to build it with to build from it lightwhigt docker image with the <code>scratch</code> option and build <code>as</code></p>\n\n<p>I use the following, but when I check the image, I see that the size it <code>366MB</code> , any idea what am I missing here?\nIt should be less then 20MB\u2026</p>\n\n<pre><code>#build stage\nFROM golang:alpine as builder\nWORKDIR /go/src/tzf\nADD . /go/src/tzf\nRUN CGO_ENABLED=0 go build -ldflags '-extldflags \"-static\"' -o ova tzf\nRUN apk add --no-cache git\n\n\n\nFROM golang:alpine \nRUN mkdir /build\nADD . /build/\nWORKDIR /build\nRUN CGO_ENABLED=0 go build -ldflags '-extldflags \"-static\"' -o ova tzf\nFROM scratch\nCOPY --from=builder /build/main /app/\nWORKDIR /app\nCMD [\u201c./ova -v\"]\n</code></pre>\n"}, {"tags": ["for-loop", "go", "select", "goroutine"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 2, "creation_date": 1537206848, "post_id": 52356700, "comment_id": 91691237, "body": "@Ullaakut The <code>break</code> applies, in this case, to the <code>select</code> statement, not the <code>for</code> loop, because it&#39;s scoped to a <code>case</code> statement inside the <code>select</code>.  It&#39;s also superfluous, as break is implied when the end of a case is reached (an explicit break is not required in Go like it is in C++)."}], "answers": [{"comments": [{"owner": {"reputation": 543, "user_id": 3742167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6e5cf9050b188cdd0f3da7365f7faf90?s=128&d=identicon&r=PG&f=1", "display_name": "Dimaf", "link": "https://stackoverflow.com/users/3742167/dimaf"}, "edited": false, "score": 0, "creation_date": 1537126518, "post_id": 52357443, "comment_id": 91659936, "body": "Thank you so much for the such detailed and full answer. The question is a little bit stupid. I had thought to try the empty default:, but it looked weird. Now I see why it isn&#39;t."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 543, "user_id": 3742167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6e5cf9050b188cdd0f3da7365f7faf90?s=128&d=identicon&r=PG&f=1", "display_name": "Dimaf", "link": "https://stackoverflow.com/users/3742167/dimaf"}, "edited": false, "score": 1, "creation_date": 1537207103, "post_id": 52357443, "comment_id": 91691377, "body": "@Dimaf another thing is that the <code>time.Sleep()</code> call mandates that <code>quit</code> is only checked once per second.  A better solution is to <code>select</code> over <code>quit</code> and a <code>time.After</code> call.  Notice that this one can exit on a non-whole-second interval as a result: <a href=\"https://play.golang.org/p/fPwiA34Jjnt\" rel=\"nofollow noreferrer\">play.golang.org/p/fPwiA34Jjnt</a>"}, {"owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1537209793, "post_id": 52357443, "comment_id": 91692624, "body": "Thanks @Kaedys, that&#39;s a good point. I&#39;ve edited the answer to add wording to this effect and linked to your playground example."}, {"owner": {"reputation": 543, "user_id": 3742167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6e5cf9050b188cdd0f3da7365f7faf90?s=128&d=identicon&r=PG&f=1", "display_name": "Dimaf", "link": "https://stackoverflow.com/users/3742167/dimaf"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1537218520, "post_id": 52357443, "comment_id": 91696267, "body": "@Kaedys, thanks. That looks as the better solution and more idiomatic Go."}], "tags": [], "owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "is_accepted": true, "score": 11, "last_activity_date": 1537219028, "last_edit_date": 1537219028, "creation_date": 1537124363, "answer_id": 52357443, "question_id": 52356700, "link": "https://stackoverflow.com/questions/52356700/select-statement-inside-of-goroutine-with-for-loop/52357443#52357443", "title": "&quot;Select&quot; statement inside of goroutine with for loop", "body": "\n\n<p>A <code>select</code> statement without a <code>default</code> case is <strong>blocking</strong> until a read or write in at least one of the <code>case</code> statements can be executed. Accordingly, your <code>select</code> will block until a read from the <code>quit</code> channel is possible (either of a value or the zero value if the channel is closed). The language spec provides a <a href=\"https://golang.org/ref/spec#Select_statements\" rel=\"noreferrer\">concrete description</a> of this behavior, specifically:</p>\n\n<blockquote>\n  <p>If one or more of the communications [expressed in the <code>case</code> statements] can proceed, a single one that can proceed is chosen via a uniform pseudo-random selection. Otherwise, if there is a default case, that case is chosen. If there is no default case, the \"select\" statement blocks until at least one of the communications can proceed. </p>\n</blockquote>\n\n<h1>Other code issues</h1>\n\n<h2>Caution! <code>break</code> applies to the <code>select</code> statement</h2>\n\n<p>However, even if you did close the <code>quit</code> channel to signal shutdown of your program, your implementation would likely not have the desired effect. A (unlabelled) call to <code>break</code> will <a href=\"https://golang.org/ref/spec#Break_statements\" rel=\"noreferrer\">terminate execution of the inner-most <code>for</code>, <code>select</code> or <code>switch</code> statement</a> within the function. In this case, the <code>select</code> statement will break and the <code>for</code> loop will run through again. If <code>quit</code> was closed, it will run forever until something else stops the program, otherwise it will block again in <code>select</code> (<a href=\"https://play.golang.org/p/bSVnNGdqPpu\" rel=\"noreferrer\">Playground example</a>)</p>\n\n<h2>Closing <code>quit</code> will (probably) not immediately stop the program</h2>\n\n<p>As noted <a href=\"https://stackoverflow.com/questions/52356700/select-statement-inside-of-goroutine-with-for-loop/52357443#comment91691377_52357443\">in the comments</a>, the call to <code>time.Sleep</code> blocks for a second on each iteration of the loop, so any attempt to stop the program by closing <code>quit</code> will be delayed for up to approximately a second before the goroutine checks <code>quit</code> and escapes. It is unlikely this sleep period must complete in its entirety before the program stops.</p>\n\n<p>More idiomatic Go would block in the <code>select</code> statement on receiving from two channels:</p>\n\n<ul>\n<li>The <code>quit</code> channel</li>\n<li>The channel returned by <a href=\"https://golang.org/pkg/time/#After\" rel=\"noreferrer\"><code>time.After</code></a> \u2013 this call is an abstraction around a <a href=\"https://golang.org/pkg/time/#Timer\" rel=\"noreferrer\"><code>Timer</code></a> which sleeps for a period of time and then writes a value to the provided channel.</li>\n</ul>\n\n<h1>Resolution</h1>\n\n<h2>Solution with minimal changes</h2>\n\n<p>A resolution to fix your immediate issue with minimal changes to your code would be:</p>\n\n<ul>\n<li>Make the read from <code>quit</code> non-blocking by adding a default case to the <code>select</code> statement.</li>\n<li>Ensuring the goroutine <em>actually</em> returns when the read from <code>quit</code> succeeds:\n\n<ul>\n<li>Label the <code>for</code> loop and use a labelled call to <code>break</code>; or</li>\n<li><code>return</code> from the <code>f1</code> function when it is time to quit (preferred)</li>\n</ul></li>\n</ul>\n\n<p>Depending on your circumstances, you may find it more idiomatic Go to use a <a href=\"https://golang.org/pkg/context/#Context\" rel=\"noreferrer\"><code>context.Context</code></a> to signal termination, and to use a <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a> to wait for the goroutine to finish before returning from <code>main</code>.</p>\n\n\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc f1(quit chan bool) {\n    go func() {\n        for {\n            println(\"f1 is working...\")\n            time.Sleep(1 * time.Second)\n\n            select {\n            case &lt;-quit:\n                fmt.Println(\"stopping\")\n                return\n            default:\n            }\n        }\n    }()\n}\n\nfunc main() {\n    quit := make(chan bool)\n    f1(quit)\n    time.Sleep(4 * time.Second)\n    close(quit)\n    time.Sleep(4 * time.Second)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/aDoSzSzkByp\" rel=\"noreferrer\">Working example</a></p>\n\n<p>(Note: I have added an additional <code>time.Sleep</code> call in your <code>main</code> method to avoid this returning immediately after the call to <code>close</code> and terminating the program.)</p>\n\n<h2>Fixing the sleep blocking issue</h2>\n\n<p>To fix the additional issue regarding the blocking sleep preventing immediate quit, move the sleep to a timer in the <code>select</code> block. Modifying your <code>for</code> loop as per this <a href=\"https://play.golang.org/p/fPwiA34Jjnt\" rel=\"noreferrer\">playground example</a> from the comments does exactly this:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>for {\n    println(\"f1 is working...\")\n\n    select {\n    case &lt;-quit:\n        println(\"stopping f1\")\n        return\n    case &lt;-time.After(1 * time.Second):\n        // repeats loop\n    }\n}\n</code></pre>\n\n<h1>Related literature</h1>\n\n<ul>\n<li><a href=\"https://gobyexample.com/non-blocking-channel-operations\" rel=\"noreferrer\">Go-by-example: Non-blocking channel operations</a></li>\n<li><a href=\"https://dave.cheney.net/2014/03/19/channel-axioms\" rel=\"noreferrer\">Dave Cheney's Channel axioms</a>, specifically the fourth axiom \"<em>A receive from a closed channel returns the zero value immediately</em>.\"</li>\n</ul>\n"}], "owner": {"reputation": 543, "user_id": 3742167, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/6e5cf9050b188cdd0f3da7365f7faf90?s=128&d=identicon&r=PG&f=1", "display_name": "Dimaf", "link": "https://stackoverflow.com/users/3742167/dimaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5388, "favorite_count": 0, "accepted_answer_id": 52357443, "answer_count": 1, "score": 3, "last_activity_date": 1537219028, "creation_date": 1537119007, "question_id": 52356700, "link": "https://stackoverflow.com/questions/52356700/select-statement-inside-of-goroutine-with-for-loop", "title": "&quot;Select&quot; statement inside of goroutine with for loop", "body": "<p>Could somebody please explain, why if goroutine has endless <code>for</code> loop and <code>select</code> inside of the loop, a code in the loop is run only one time?</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n)\n\nfunc f1(quit chan bool){\n    go func() {\n        for {\n            println(\"f1 is working...\")\n            time.Sleep(1 * time.Second)\n\n            select{\n            case &lt;-quit:\n            println(\"stopping f1\")\n            break\n            }\n        }   \n    }()\n}\n\nfunc main() {\n    quit := make(chan bool)\n    f1(quit)\n    time.Sleep(4 * time.Second)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>f1 is working...\nProgram exited.\n</code></pre>\n\n<p>But if \"select\" is commented out:</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n)\n\nfunc f1(quit chan bool){\n    go func() {\n        for {\n            println(\"f1 is working...\")\n            time.Sleep(1 * time.Second)\n\n            //select{\n            //case &lt;-quit:\n            //println(\"stopping f1\")\n            //break\n            //}\n        }   \n    }()\n}\n\nfunc main() {\n    quit := make(chan bool)\n    f1(quit)\n    time.Sleep(4 * time.Second)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>f1 is working...\nf1 is working...\nf1 is working...\nf1 is working...\nf1 is working...\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/MxKy2XqQlt8\" rel=\"nofollow noreferrer\">https://play.golang.org/p/MxKy2XqQlt8</a></p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1537116541, "post_id": 52355804, "comment_id": 91657156, "body": "What do you mean you &quot;cannot unmarshal it&quot;? Why not? What is the problem you&#39;re facing?"}, {"owner": {"reputation": 15, "user_id": 8036055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9gUHR.png?s=128&g=1", "display_name": "CRASH", "link": "https://stackoverflow.com/users/8036055/crash"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537118405, "post_id": 52355804, "comment_id": 91657657, "body": "Unmarshal does not return any error, but all maps in the DriveDetailedInformation struct is empty."}], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 8036055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9gUHR.png?s=128&g=1", "display_name": "CRASH", "link": "https://stackoverflow.com/users/8036055/crash"}, "edited": false, "score": 0, "creation_date": 1537167983, "post_id": 52360776, "comment_id": 91668946, "body": "<code>json:&quot;Drive &#47;c0&#47;e31&#47;s1 Device attributes&quot;</code> - is a dynamic key, I can&#39;t hardcode it."}, {"owner": {"reputation": 1, "user_id": 5541397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e56fabb4099946a1951f5892adc0095?s=128&d=identicon&r=PG&f=1", "display_name": "JokerSTACKOVERFLOW", "link": "https://stackoverflow.com/users/5541397/jokerstackoverflow"}, "reply_to_user": {"reputation": 15, "user_id": 8036055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9gUHR.png?s=128&g=1", "display_name": "CRASH", "link": "https://stackoverflow.com/users/8036055/crash"}, "edited": false, "score": 0, "creation_date": 1537169315, "post_id": 52360776, "comment_id": 91669582, "body": "So you only have to nest a few more layers of map [string] * json.RawMessage, which I think is very tedious, so you might as well modify JSON and add a name field.like this:{&quot;Drive&quot;:[{&quot;name&quot;:&quot;Drive /c0/e31/s0&quot;,...}],&quot;Drive Detailed Information&quot;:[{&quot;driveName&quot;:&quot;Drive /c0/e31/s0&quot;,&quot;name&quot;:&quot;Drive /c0/e31/s0 - Detailed Information&quot;,...}]}"}, {"owner": {"reputation": 15, "user_id": 8036055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9gUHR.png?s=128&g=1", "display_name": "CRASH", "link": "https://stackoverflow.com/users/8036055/crash"}, "edited": false, "score": 0, "creation_date": 1537170649, "post_id": 52360776, "comment_id": 91670239, "body": "I can&#39;t modify than json :("}], "tags": [], "owner": {"reputation": 1, "user_id": 5541397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e56fabb4099946a1951f5892adc0095?s=128&d=identicon&r=PG&f=1", "display_name": "JokerSTACKOVERFLOW", "link": "https://stackoverflow.com/users/5541397/jokerstackoverflow"}, "is_accepted": false, "score": 0, "last_activity_date": 1569303011, "last_edit_date": 1569303011, "creation_date": 1537158590, "answer_id": 52360776, "question_id": 52355804, "link": "https://stackoverflow.com/questions/52355804/golang-parse-json-with-unknown-keys/52360776#52360776", "title": "Golang parse JSON with unknown keys", "body": "<p>Because your key value is not correct. Below is the code I modified.</p>\n\n<pre><code>type DriveDetailedInformation struct {\nDriveState            DriveStateStruct `json:\"Drive /c0/e31/s0 State\"`\nDriveDeviceAttributes DriveDeviceAttributesStruct `json:\"Drive /c0/e31/s0 Device attributes\"`\nDrivePoliciesSettings DrivePoliciesSettingsStruct `json:\"Drive /c0/e31/s0 Policies/Settings\"`\nInquiryData           string `json:\"Inquiry Data\"`\n}\n\ntype DriveDetailedInformation1 struct {\n    DriveState            DriveStateStruct `json:\"Drive /c0/e31/s1 State\"`\n    DriveDeviceAttributes DriveDeviceAttributesStruct `json:\"Drive /c0/e31/s1 Device attributes\"`\n    DrivePoliciesSettings DrivePoliciesSettingsStruct `json:\"Drive /c0/e31/s1 Policies/Settings\"`\n    InquiryData           string `json:\"Inquiry Data\"`\n}\nfunc main() {\n    var f jsonStruct\n    err := json.Unmarshal([]byte(jsonData), &amp;f)\n    if err != nil {\n        fmt.Println(\"Error parsing JSON: \", err)\n    }\n\n    for _, controller := range f.Controllers {\n        for k, v := range controller.ResponseData {\n            switch k {\n            case \"Drive /c0/e31/s0\",\"Drive /c0/e31/s1\":\n                var ds []DriveStruct\n                if err := json.Unmarshal(*v, &amp;ds); err == nil {\n                    fmt.Println(k, ds)\n                }\n            case \"Drive /c0/e31/s1 - Detailed Information\":\n                var dds1 DriveDetailedInformation1\n                if err := json.Unmarshal(*v, &amp;dds1); err == nil {\n                    fmt.Println(k, dds1)\n                }\n            case \"Drive /c0/e31/s0 - Detailed Information\":\n                var dds DriveDetailedInformation\n                if err := json.Unmarshal(*v, &amp;dds); err == nil {\n                    fmt.Println(k, dds)\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>I think Response Data can be parsed in a structure.</p>\n"}], "owner": {"reputation": 15, "user_id": 8036055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9gUHR.png?s=128&g=1", "display_name": "CRASH", "link": "https://stackoverflow.com/users/8036055/crash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 783, "favorite_count": 0, "closed_date": 1572693665, "answer_count": 1, "score": -2, "last_activity_date": 1572693689, "creation_date": 1537112932, "question_id": 52355804, "link": "https://stackoverflow.com/questions/52355804/golang-parse-json-with-unknown-keys", "closed_reason": "Duplicate", "title": "Golang parse JSON with unknown keys", "body": "<p>I'm trying to unmarshal json with dynamic field keys to the struct\nThat json returned from storcli utility for linux.\nOne part of the code work well, but if json data contains many structs I can't unmarshal it. \nI think that is because DriveDetailedInformation struct do not have all json tags.\nCan anybody help me?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype jsonStruct struct {\n    Controllers []struct {\n        CommandStatus struct {\n            Controller  int    `json:\"Controller\"`\n            Status      string `json:\"Status\"`\n            Description string `json:\"Description\"`\n        } `json:\"Command Status\"`\n        ResponseData map[string]*json.RawMessage `json:\"Response Data\"`\n    } `json:\"Controllers\"`\n}\n\ntype DriveStruct struct {\n    EIDSlt string `json:\"EID:Slt\"`\n    DID    int    `json:\"DID\"`\n    State  string `json:\"State\"`\n    DG     int    `json:\"DG\"`\n    Size   string `json:\"Size\"`\n    Intf   string `json:\"Intf\"`\n    Med    string `json:\"Med\"`\n    SED    string `json:\"SED\"`\n    PI     string `json:\"PI\"`\n    SeSz   string `json:\"SeSz\"`\n    Model  string `json:\"Model\"`\n    Sp     string `json:\"Sp\"`\n}\n\ntype DriveDetailedInformation struct {\n    DriveState            map[string]DriveStateStruct\n    DriveDeviceAttributes map[string]DriveDeviceAttributesStruct\n    DrivePoliciesSettings map[string]DrivePoliciesSettingsStruct\n    InquiryData           string `json:\"Inquiry Data\"`\n}\n\ntype DriveStateStruct struct {\n    ShieldCounter            int    `json:\"Shield Counter\"`\n    MediaErrorCount          int    `json:\"Media Error Count\"`\n    OtherErrorCount          int    `json:\"Other Error Count\"`\n    BBMErrorCount            int    `json:\"BBM Error Count\"`\n    DriveTemperature         string `json:\"Drive Temperature\"`\n    PredictiveFailureCount   int    `json:\"Predictive Failure Count\"`\n    SMARTAlertFlaggedByDrive string `json:\"S.M.A.R.T alert flagged by drive\"`\n}\n\ntype DriveDeviceAttributesStruct struct {\n    SN               string `json:\"SN\"`\n    ManufacturerID   string `json:\"Manufacturer Id\"`\n    ModelNumber      string `json:\"Model Number\"`\n    NANDVendor       string `json:\"NAND Vendor\"`\n    WWN              string `json:\"WWN\"`\n    FirmwareRevision string `json:\"Firmware Revision\"`\n    RawSize          string `json:\"Raw size\"`\n    CoercedSize      string `json:\"Coerced size\"`\n    NonCoercedSize   string `json:\"Non Coerced size\"`\n    DeviceSpeed      string `json:\"Device Speed\"`\n    LinkSpeed        string `json:\"Link Speed\"`\n    NCQSetting       string `json:\"NCQ setting\"`\n    WriteCache       string `json:\"Write cache\"`\n    SectorSize       string `json:\"Sector Size\"`\n    ConnectorName    string `json:\"Connector Name\"`\n}\n\ntype DrivePoliciesSettingsStruct struct {\n    DrivePosition                            string `json:\"Drive position\"`\n    EnclosurePosition                        int    `json:\"Enclosure position\"`\n    ConnectedPortNumber                      string `json:\"Connected Port Number\"`\n    SequenceNumber                           int    `json:\"Sequence Number\"`\n    CommissionedSpare                        string `json:\"Commissioned Spare\"`\n    EmergencySpare                           string `json:\"Emergency Spare\"`\n    LastPredictiveFailureEventSequenceNumber int    `json:\"Last Predictive Failure Event Sequence Number\"`\n    SuccessfulDiagnosticsCompletionOn        string `json:\"Successful diagnostics completion on\"`\n    SEDCapable                               string `json:\"SED Capable\"`\n    SEDEnabled                               string `json:\"SED Enabled\"`\n    Secured                                  string `json:\"Secured\"`\n    Locked                                   string `json:\"Locked\"`\n    NeedsEKMAttention                        string `json:\"Needs EKM Attention\"`\n    PIEligible                               string `json:\"PI Eligible\"`\n    Certified                                string `json:\"Certified\"`\n    WidePortCapable                          string `json:\"Wide Port Capable\"`\n    PortInformation                          []struct {\n        Port       int    `json:\"Port\"`\n        Status     string `json:\"Status\"`\n        Linkspeed  string `json:\"Linkspeed\"`\n        SASAddress string `json:\"SAS address\"`\n    } `json:\"Port Information\"`\n}\n\nvar jsonData = `\n{\n   \"Controllers\":[\n      {\n         \"Command Status\":{\n            \"Controller\":0,\n            \"Status\":\"Success\",\n            \"Description\":\"Show Drive Information Succeeded.\"\n         },\n         \"Response Data\":{\n            \"Drive /c0/e31/s0\":[\n               {\n                  \"EID:Slt\":\"31:0\",\n                  \"DID\":19,\n                  \"State\":\"Onln\",\n                  \"DG\":0,\n                  \"Size\":\"9.094 TB\",\n                  \"Intf\":\"SATA\",\n                  \"Med\":\"HDD\",\n                  \"SED\":\"N\",\n                  \"PI\":\"N\",\n                  \"SeSz\":\"512B\",\n                  \"Model\":\"ST10000DM0004-1ZC101\",\n                  \"Sp\":\"U\"\n               }\n            ],\n            \"Drive /c0/e31/s0 - Detailed Information\":{\n               \"Drive /c0/e31/s0 State\":{\n                  \"Shield Counter\":0,\n                  \"Media Error Count\":0,\n                  \"Other Error Count\":0,\n                  \"BBM Error Count\":0,\n                  \"Drive Temperature\":\" 25C (77.00 F)\",\n                  \"Predictive Failure Count\":0,\n                  \"S.M.A.R.T alert flagged by drive\":\"No\"\n               },\n               \"Drive /c0/e31/s0 Device attributes\":{\n                  \"SN\":\"            ZA23V0DH\",\n                  \"Manufacturer Id\":\"ATA     \",\n                  \"Model Number\":\"ST10000DM0004-1ZC101\",\n                  \"NAND Vendor\":\"NA\",\n                  \"WWN\":\"5000c500a5ad06b6\",\n                  \"Firmware Revision\":\"DN01    \",\n                  \"Raw size\":\"9.095 TB [0x48c400000 Sectors]\",\n                  \"Coerced size\":\"9.094 TB [0x48c300000 Sectors]\",\n                  \"Non Coerced size\":\"9.094 TB [0x48c300000 Sectors]\",\n                  \"Device Speed\":\"6.0Gb/s\",\n                  \"Link Speed\":\"6.0Gb/s\",\n                  \"NCQ setting\":\"N/A\",\n                  \"Write cache\":\"N/A\",\n                  \"Sector Size\":\"512B\",\n                  \"Connector Name\":\"\"\n               },\n               \"Drive /c0/e31/s0 Policies/Settings\":{\n                  \"Drive position\":\"DriveGroup:0, Span:0, Row:0\",\n                  \"Enclosure position\":0,\n                  \"Connected Port Number\":\"0(path0) \",\n                  \"Sequence Number\":2,\n                  \"Commissioned Spare\":\"No\",\n                  \"Emergency Spare\":\"No\",\n                  \"Last Predictive Failure Event Sequence Number\":0,\n                  \"Successful diagnostics completion on\":\"N/A\",\n                  \"SED Capable\":\"No\",\n                  \"SED Enabled\":\"No\",\n                  \"Secured\":\"No\",\n                  \"Locked\":\"No\",\n                  \"Needs EKM Attention\":\"No\",\n                  \"PI Eligible\":\"No\",\n                  \"Certified\":\"No\",\n                  \"Wide Port Capable\":\"No\",\n                  \"Port Information\":[\n                     {\n                        \"Port\":0,\n                        \"Status\":\"Active\",\n                        \"Linkspeed\":\"6.0Gb/s\",\n                        \"SAS address\":\"0x5003048001927c6c\"\n                     }\n                  ]\n               },\n               \"Inquiry Data\":\"\"\n            },\n            \"Drive /c0/e31/s1\":[\n               {\n                  \"EID:Slt\":\"31:1\",\n                  \"DID\":20,\n                  \"State\":\"Onln\",\n                  \"DG\":0,\n                  \"Size\":\"9.094 TB\",\n                  \"Intf\":\"SATA\",\n                  \"Med\":\"HDD\",\n                  \"SED\":\"N\",\n                  \"PI\":\"N\",\n                  \"SeSz\":\"512B\",\n                  \"Model\":\"ST10000DM0004-1ZC101\",\n                  \"Sp\":\"U\"\n               }\n            ],\n            \"Drive /c0/e31/s1 - Detailed Information\":{\n               \"Drive /c0/e31/s1 State\":{\n                  \"Shield Counter\":0,\n                  \"Media Error Count\":0,\n                  \"Other Error Count\":0,\n                  \"BBM Error Count\":0,\n                  \"Drive Temperature\":\" 25C (77.00 F)\",\n                  \"Predictive Failure Count\":0,\n                  \"S.M.A.R.T alert flagged by drive\":\"No\"\n               },\n               \"Drive /c0/e31/s1 Device attributes\":{\n                  \"SN\":\"            ZA23MCVS\",\n                  \"Manufacturer Id\":\"ATA     \",\n                  \"Model Number\":\"ST10000DM0004-1ZC101\",\n                  \"NAND Vendor\":\"NA\",\n                  \"WWN\":\"5000c500a5acc582\",\n                  \"Firmware Revision\":\"DN01    \",\n                  \"Raw size\":\"9.095 TB [0x48c400000 Sectors]\",\n                  \"Coerced size\":\"9.094 TB [0x48c300000 Sectors]\",\n                  \"Non Coerced size\":\"9.094 TB [0x48c300000 Sectors]\",\n                  \"Device Speed\":\"6.0Gb/s\",\n                  \"Link Speed\":\"6.0Gb/s\",\n                  \"NCQ setting\":\"N/A\",\n                  \"Write cache\":\"N/A\",\n                  \"Sector Size\":\"512B\",\n                  \"Connector Name\":\"\"\n               },\n               \"Drive /c0/e31/s1 Policies/Settings\":{\n                  \"Drive position\":\"DriveGroup:0, Span:0, Row:1\",\n                  \"Enclosure position\":0,\n                  \"Connected Port Number\":\"0(path0) \",\n                  \"Sequence Number\":2,\n                  \"Commissioned Spare\":\"No\",\n                  \"Emergency Spare\":\"No\",\n                  \"Last Predictive Failure Event Sequence Number\":0,\n                  \"Successful diagnostics completion on\":\"N/A\",\n                  \"SED Capable\":\"No\",\n                  \"SED Enabled\":\"No\",\n                  \"Secured\":\"No\",\n                  \"Locked\":\"No\",\n                  \"Needs EKM Attention\":\"No\",\n                  \"PI Eligible\":\"No\",\n                  \"Certified\":\"No\",\n                  \"Wide Port Capable\":\"No\",\n                  \"Port Information\":[\n                     {\n                        \"Port\":0,\n                        \"Status\":\"Active\",\n                        \"Linkspeed\":\"6.0Gb/s\",\n                        \"SAS address\":\"0x5003048001927c6d\"\n                     }\n                  ]\n               },\n               \"Inquiry Data\":\"\"\n            }\n         }\n      }\n   ]\n}\n`\n\nfunc main() {\n    var f jsonStruct\n    err := json.Unmarshal([]byte(jsonData), &amp;f)\n    if err != nil {\n        fmt.Println(\"Error parsing JSON: \", err)\n    }\n\n    for _, controller := range f.Controllers {\n        for k, v := range controller.ResponseData {\n\n            ///THAT IS WORK\n            var ds []DriveStruct\n            if err := json.Unmarshal(*v, &amp;ds); err == nil {\n                fmt.Println(k, ds)\n\n            }\n\n            ///THAT IS NOT WORK WHY?\n            var dds DriveDetailedInformation\n            if err := json.Unmarshal(*v, &amp;dds); err == nil {\n                fmt.Println(k, dds)\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "openssl", "public-key-encryption"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1537096454, "post_id": 52353238, "comment_id": 91651816, "body": "Have you looked at the <a href=\"https://golang.org/pkg/crypto/rsa/\" rel=\"nofollow noreferrer\">rsa</a> package in the standard library? It contains everything you need to perform RSA encryption/decryption and will be a nicer interface than wrappers around openssl."}, {"owner": {"reputation": 387, "user_id": 2432174, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ioAZo.jpg?s=128&g=1", "display_name": "dinu0101", "link": "https://stackoverflow.com/users/2432174/dinu0101"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1537105022, "post_id": 52353238, "comment_id": 91653982, "body": "@Marc, Yes, I have seen and It&#39;s working fine. But the requirement is use Openssl not default one."}], "answers": [{"comments": [{"owner": {"reputation": 387, "user_id": 2432174, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ioAZo.jpg?s=128&g=1", "display_name": "dinu0101", "link": "https://stackoverflow.com/users/2432174/dinu0101"}, "edited": false, "score": 0, "creation_date": 1537105587, "post_id": 52353583, "comment_id": 91654114, "body": "Hi Jrefior, I made a programme that encrypt from RSA Public key &amp; decrypt with private key. But that is from the Golang default. But t he requirement is that we want to use Openssl like this <a href=\"https://sosedoff.com/2015/05/22/data-encryption-in-go-using-openssl.html\" rel=\"nofollow noreferrer\">sosedoff.com/2015/05/22/&hellip;</a>"}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 387, "user_id": 2432174, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ioAZo.jpg?s=128&g=1", "display_name": "dinu0101", "link": "https://stackoverflow.com/users/2432174/dinu0101"}, "edited": false, "score": 0, "creation_date": 1537116201, "post_id": 52353583, "comment_id": 91657061, "body": "@dinu0101 You didn&#39;t describe (or even hint at) that in your question.  So you&#39;re looking to combine RSA with AES somehow? Go does have a standard AES library, and you can use <a href=\"https://golang.org/pkg/crypto/aes/#NewCipher\" rel=\"nofollow noreferrer\"><code>func NewCipher(key []byte) (cipher.Block, error)</code></a> with a 32-byte key argument to select AES-256."}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 1, "last_activity_date": 1537098226, "last_edit_date": 1537098226, "creation_date": 1537096913, "answer_id": 52353583, "question_id": 52353238, "link": "https://stackoverflow.com/questions/52353238/how-to-encrypt-and-decrypt-data-with-openssl-rsa-public-private-key-pair-in-gola/52353583#52353583", "title": "How to encrypt and decrypt data with Openssl RSA public private key pair in Golang?", "body": "<blockquote>\n  <p>I am trying to write a program which encrypts data using a RSA public\n  key and and decrypts data using private key. The RSA keys were\n  generated with openssl tool.</p>\n</blockquote>\n\n<p>You don't need an OpenSSL library package to do this: you just need some of the <code>crypto</code>, <code>encoding</code>, and other packages in the Go standard library.  Namely:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/encoding/pem/\" rel=\"nofollow noreferrer\"><code>encoding/pem</code></a></li>\n<li><a href=\"https://golang.org/pkg/crypto/x509/\" rel=\"nofollow noreferrer\"><code>crypto/x509</code></a></li>\n<li><a href=\"https://golang.org/pkg/math/rand/\" rel=\"nofollow noreferrer\"><code>math/rand</code></a></li>\n<li><a href=\"https://golang.org/pkg/crypto/sha256/\" rel=\"nofollow noreferrer\"><code>crypto/sha256</code></a></li>\n<li><a href=\"https://golang.org/pkg/crypto/rsa/\" rel=\"nofollow noreferrer\"><code>crypto/rsa</code></a></li>\n<li><a href=\"https://golang.org/pkg/encoding/base64/\" rel=\"nofollow noreferrer\"><code>encoding/base64</code></a></li>\n</ul>\n\n<p>Create a PEM block from the key, setting <code>Type</code> to \"RSA PRIVATE KEY\" or \"RSA PUBLIC KEY\", parse the keys with the <code>x509</code> functions (PKIX for public), use a type assertion to make it the appropriate RSA public/private type, encrypt the message using OAEP padding, an SHA-256 hash function, and <code>rand.Reader</code> for a source of entropy, base64 encode the resulting cipher if you're sending it as text rather than binary, then base64 decode it and decrypt it using the same but with the private key on the other side.</p>\n\n<p>See in particular <a href=\"https://golang.org/pkg/crypto/rsa/#EncryptOAEP\" rel=\"nofollow noreferrer\"><code>func EncryptOAEP(hash hash.Hash, random io.Reader, pub *PublicKey, msg []byte, label []byte) ([]byte, error)</code></a>.</p>\n\n<p>Read the documentation in these packages and some general info about encryption and RSA, there are also usage examples for each of these packages on StackOverflow -- though perhaps not put all together.</p>\n\n<p>Every package you need for the described goal is in the Go standard library.</p>\n\n<p>You may need to check that your PKCS function version (e.g. PKCS8) lines up with the private key produced by your OpenSSL version.</p>\n"}], "owner": {"reputation": 387, "user_id": 2432174, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ioAZo.jpg?s=128&g=1", "display_name": "dinu0101", "link": "https://stackoverflow.com/users/2432174/dinu0101"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1413, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537098226, "creation_date": 1537094290, "question_id": 52353238, "link": "https://stackoverflow.com/questions/52353238/how-to-encrypt-and-decrypt-data-with-openssl-rsa-public-private-key-pair-in-gola", "title": "How to encrypt and decrypt data with Openssl RSA public private key pair in Golang?", "body": "<p>I am trying to write a program which encrypts data using a RSA public key and and decrypts data using private key. The RSA keys were generated with openssl tool.</p>\n\n<p>I found Spacemonkeygo Openssl <a href=\"https://github.com/spacemonkeygo/openssl\" rel=\"nofollow noreferrer\">https://github.com/spacemonkeygo/openssl</a> wrapper for this purpose. But unable to find any sample over &amp; also their is no document available for the same. So that I am unable to use. </p>\n\n<p>Please guide me how can I use Openssl in Golang?</p>\n\n<p>I am using first time encryption decryption &amp; Openssl. </p>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["go", "hyperledger-fabric"], "comments": [{"owner": {"reputation": 1759, "user_id": 8708123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dcmM3.jpg?s=128&g=1", "display_name": "Fendi jatmiko", "link": "https://stackoverflow.com/users/8708123/fendi-jatmiko"}, "edited": false, "score": 0, "creation_date": 1537097039, "post_id": 52353217, "comment_id": 91651973, "body": "its better when you show us the whole code.. not just part of it. .also, are you sure you already set your <code>$GOPATH</code> correctly..?"}, {"owner": {"reputation": 110, "user_id": 10086742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a08eba23183def103897ea65339180?s=128&d=identicon&r=PG&f=1", "display_name": "mahdi", "link": "https://stackoverflow.com/users/10086742/mahdi"}, "reply_to_user": {"reputation": 1759, "user_id": 8708123, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dcmM3.jpg?s=128&g=1", "display_name": "Fendi jatmiko", "link": "https://stackoverflow.com/users/8708123/fendi-jatmiko"}, "edited": false, "score": 0, "creation_date": 1537097696, "post_id": 52353217, "comment_id": 91652122, "body": "@FendiD Just import part is needed not the whole code. yes I have set it correctly."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 3789346, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b388038a04b0bed34b26f24a27adde74?s=128&d=identicon&r=PG&f=1", "display_name": "dakdikduk", "link": "https://stackoverflow.com/users/3789346/dakdikduk"}, "is_accepted": false, "score": 1, "last_activity_date": 1537117588, "creation_date": 1537117588, "answer_id": 52356480, "question_id": 52353217, "link": "https://stackoverflow.com/questions/52353217/go-get-not-working-properly-when-trying-to-import-shim-in-golang/52356480#52356480", "title": "Go get not working properly when trying to import shim in Golang", "body": "<p>On your go get, don't put the full path of the library, instead just put the repository path like this.</p>\n\n<blockquote>\n  <p>go get -v github.com/hyperledger/fabric</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7694, "user_id": 5529712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7uvxg.png?s=128&g=1", "display_name": "Gari Singh", "link": "https://stackoverflow.com/users/5529712/gari-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1537120699, "creation_date": 1537120699, "answer_id": 52356930, "question_id": 52353217, "link": "https://stackoverflow.com/questions/52353217/go-get-not-working-properly-when-trying-to-import-shim-in-golang/52356930#52356930", "title": "Go get not working properly when trying to import shim in Golang", "body": "<p>See <a href=\"https://stackoverflow.com/a/49464481/6160507\">https://stackoverflow.com/a/49464481/6160507</a> ... you are likely using the wrong version of Go.  Fabric 1.1 requires Go 1.9 and Fabric 1.2 requires Go 1.10.</p>\n\n<p>The <code>plugin</code> and <code>context</code> packages were not available in earlier versions of Go</p>\n"}], "owner": {"reputation": 110, "user_id": 10086742, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9a08eba23183def103897ea65339180?s=128&d=identicon&r=PG&f=1", "display_name": "mahdi", "link": "https://stackoverflow.com/users/10086742/mahdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "accepted_answer_id": 52356930, "answer_count": 2, "score": 0, "last_activity_date": 1537120699, "creation_date": 1537094040, "last_edit_date": 1537096429, "question_id": 52353217, "link": "https://stackoverflow.com/questions/52353217/go-get-not-working-properly-when-trying-to-import-shim-in-golang", "title": "Go get not working properly when trying to import shim in Golang", "body": "<p>I am trying to use go for developing a chaincode for Hyperledger Fabric. Inside chaincode I have to use shim library which can be imported using<br> \n<code>import \"github.com/hyperledger/fabric/core/chaincode/shim\"</code>\n<br>I want to use go get to add this package to my project so that I can run and debug the code but when trying use go get with the URL it shows thes errors:<br> <code>package plugin: unrecognized import path \"plugin\" (import path does not begin with hostname)\npackage context: unrecognized import path \"context\" (import path does not begin with hostname)</code><br>\nIs there anybody who can help me fix these errors?</p>\n"}, {"tags": ["go", "inheritance"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 7, "creation_date": 1537088207, "post_id": 52352537, "comment_id": 91650029, "body": "No. this is all wrong. Do not try to mimic inheritance based OPP and code reuse in Go: It doesn&#39;t work, no matter how hard you try and you will just get frustrated."}], "answers": [{"comments": [{"owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "reply_to_user": {"reputation": 1445, "user_id": 2672698, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9a0e47bf5cac8940c9d520421b22adc2?s=128&d=identicon&r=PG", "display_name": "Sam Holmes", "link": "https://stackoverflow.com/users/2672698/sam-holmes"}, "edited": false, "score": 0, "creation_date": 1537115304, "post_id": 52352957, "comment_id": 91656797, "body": "@SamHolmes I think your comment should be directed to the original question, not to my answer."}, {"owner": {"reputation": 8972, "user_id": 936651, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b467475c5a06deb854ac8e5114d35b90?s=128&d=identicon&r=PG", "display_name": "SexyMF", "link": "https://stackoverflow.com/users/936651/sexymf"}, "edited": false, "score": 0, "creation_date": 1537165997, "post_id": 52352957, "comment_id": 91668059, "body": "Thanks, that&#39;s what I was eventually did"}], "tags": [], "owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "is_accepted": true, "score": 1, "last_activity_date": 1537091963, "creation_date": 1537091963, "answer_id": 52352957, "question_id": 52352537, "link": "https://stackoverflow.com/questions/52352537/golang-field-inheritance-without-nested-initializing/52352957#52352957", "title": "golang field inheritance without nested initializing", "body": "<p>Per the comment left on your question, there is no way to \"implicitly\" link struct fields to two different structs. </p>\n\n<p>If it's the struct initialization syntax you object to, you could get around this by just writing a convenience function to initialize a new BaseEmployee, e.g.:</p>\n\n<pre><code>func NewBaseEmployee(name string) BaseEmployee {\n    return BaseEmployee{LastName: name}\n}\n\nob := Employee {\n    FirstName: \"Ron\"\n    LastName : NewBaseEmployee(\"Howard\")\n}\n</code></pre>\n"}], "owner": {"reputation": 8972, "user_id": 936651, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/b467475c5a06deb854ac8e5114d35b90?s=128&d=identicon&r=PG", "display_name": "SexyMF", "link": "https://stackoverflow.com/users/936651/sexymf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 52352957, "answer_count": 1, "score": -1, "last_activity_date": 1537092755, "creation_date": 1537088073, "last_edit_date": 1537088169, "question_id": 52352537, "link": "https://stackoverflow.com/questions/52352537/golang-field-inheritance-without-nested-initializing", "title": "golang field inheritance without nested initializing", "body": "<p>Is it possible to inherit without object initializer?</p>\n\n<pre><code>type BaseEmployee struct{\n    LastName string\n}\n\ntype Employee struct {\n Name string,\n BaseEmployee\n}\n</code></pre>\n\n<p>Right now I have this:</p>\n\n<pre><code>ob := Employee {\n  FirstName: \"Ron\"\n  LastName : BaseEmployee {LastName : \"Howard\"}\n}\n</code></pre>\n\n<p>BUT I want to achieve something like this:</p>\n\n<pre><code>ob := Employee {\n  FirstName: \"Ron\"\n  LastName : \"Howard\",//&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;&lt;---- how us that possible?\n}\n</code></pre>\n\n<p>Possible?</p>\n"}, {"tags": ["go", "goroutine", "routines"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1537084708, "post_id": 52351812, "comment_id": 91649258, "body": "Sometime two independent things need to coordinate. E.g. Stop doing things."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 2, "creation_date": 1537103776, "post_id": 52351812, "comment_id": 91653628, "body": "<code>Isn&#39;t the idea that we will run goroutines in an interleaved way.</code>. no. They run in parallel."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1558353654, "post_id": 52351812, "comment_id": 99061539, "body": "@mh-cbon: No, they run <i>concurrently</i>. They may or may not run in parallel, depending on your hardware and configuration. Required reading/watching: <a href=\"https://blog.golang.org/concurrency-is-not-parallelism\" rel=\"nofollow noreferrer\">Concurrency is not parallelism</a>."}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1558354345, "post_id": 52351812, "comment_id": 99061870, "body": "@Flimzy, regarding the runtime internal, i totally agree with you. Would you agree to say that from higher point of view, the worst case scenario applies during the programming of this language, thus the programmer must assume that read/write operations will occur in parallel, and that synchronization failures must be avoided. In that regards saying it is parallel is kind of good enough to give the right understanding to the programmer ?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1558354471, "post_id": 52351812, "comment_id": 99061934, "body": "The programmer must assume that read/write operations occur concurrently. This is true regardless of parallelism."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1558354569, "post_id": 52351812, "comment_id": 99061968, "body": "Saying &quot;parallel&quot; is different than saying &quot;concurrent.&quot; Don&#39;t confuse the two. Don&#39;t teach others they are the same. :)"}], "answers": [{"tags": [], "owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "is_accepted": false, "score": 4, "last_activity_date": 1537089518, "creation_date": 1537089518, "answer_id": 52352687, "question_id": 52351812, "link": "https://stackoverflow.com/questions/52351812/what-is-the-need-to-synchronise-go-routines/52352687#52352687", "title": "What is the need to synchronise Go Routines", "body": "<p>Concurrency doesn't happen in a vacuum. Coordination of the goroutines you start may be required for numerous reasons. In this case, there is one primary one (beyond the example, which is contrived as a demonstration):</p>\n\n<ul>\n<li><p>The Go runtime will quit in the event the end of the <code>main</code> method is reached. At that point, the running program including all other goroutines will be terminated. The coordination here ensures the child goroutine has quiesced before the program is allowed to exit.</p>\n\n<p>I wrote about an example of this yesterday: <a href=\"https://stackoverflow.com/a/52347990/1113760\">https://stackoverflow.com/a/52347990/1113760</a>.</p></li>\n</ul>\n\n<p>You might imagine many other reasons which require coordination between concurrent work (this list is not specific to Go and is non-exhaustive):</p>\n\n<ul>\n<li><p>The goroutines operate on a shared memory region, so require coordination in the form of mutual exclusion to ensure only one routine accesses the critical section at a time.</p></li>\n<li><p>Your continued processing may depend on the output of multiple goroutines, so you wait for consensus before proceeding.</p></li>\n<li><p>Your program may provide a service, and you want to ensure any in-flight requests (processed in separated goroutines) have completed and drained before you shutdown.</p></li>\n</ul>\n\n<p>This question goes beyond Go to consider the computer science difficulties associated with concurrent execution, and the instances in which it is useful, so the literature will have further detail and examples.</p>\n"}, {"tags": [], "owner": {"reputation": 140, "user_id": 5115007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3667e565469ab7020a2a4b6c0aeb4392?s=128&d=identicon&r=PG&f=1", "display_name": "Prabesh P", "link": "https://stackoverflow.com/users/5115007/prabesh-p"}, "is_accepted": false, "score": 0, "last_activity_date": 1537550114, "creation_date": 1537550114, "answer_id": 52448379, "question_id": 52351812, "link": "https://stackoverflow.com/questions/52351812/what-is-the-need-to-synchronise-go-routines/52448379#52448379", "title": "What is the need to synchronise Go Routines", "body": "<p>If processes can be run independently then things are pretty straight forward. We can run each process in a core and things will be easy. Issues comes when processes are dependent (ie process A dependent on process B). </p>\n\n<p>Classical way to achieve this is by sharing a common memory and locking it such that only a process can access it at a given time. Go channel follows a different approach, you can read more about it here </p>\n\n<ul>\n<li><a href=\"https://docs.google.com/document/d/1yIAYmbvL3JxOKOjuCyon7JhW4cSv1wy5hC0ApeGMV9s/pub\" rel=\"nofollow noreferrer\">https://docs.google.com/document/d/1yIAYmbvL3JxOKOjuCyon7JhW4cSv1wy5hC0ApeGMV9s/pub</a></li>\n</ul>\n"}], "owner": {"reputation": 609, "user_id": 2002790, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/6768d52fa30111dbfa56ce06cb497c69?s=128&d=identicon&r=PG", "display_name": "amrx", "link": "https://stackoverflow.com/users/2002790/amrx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "answer_count": 2, "score": -4, "last_activity_date": 1537550114, "creation_date": 1537081695, "last_edit_date": 1537082475, "question_id": 52351812, "link": "https://stackoverflow.com/questions/52351812/what-is-the-need-to-synchronise-go-routines", "title": "What is the need to synchronise Go Routines", "body": "<p>This particular <strong>Go</strong> code uses a channel to synchronise <code>goroutines</code>.</p>\n\n<pre><code>// We can use channels to synchronize execution\n// across goroutines. Here's an example of using a\n// blocking receive to wait for a goroutine to finish.\n\npackage main\n\nimport \"fmt\"\nimport \"time\"\n\n// This is the function we'll run in a goroutine. The\n// `done` channel will be used to notify another\n// goroutine that this function's work is done.\nfunc worker(done chan bool) {\n   fmt.Print(\"working...\")\n   time.Sleep(time.Second)\n   fmt.Println(\"done\")\n\n   // Send a value to notify that we're done.\n   done &lt;- true\n}\n\nfunc main() {\n\n   // Start a worker goroutine, giving it the channel to\n   // notify on.\n   done := make(chan bool, 1)\n   go worker(done)\n\n   // Block until we receive a notification from the\n   // worker on the channel.\n   &lt;-done\n }\n</code></pre>\n\n<p>What is the need to synchronize goroutines? Isn't the idea that we will run goroutines in an interleaved way. Why would we want to introduce synchronization between two or more go routines? Is it for callbacks?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["nginx", "go", "reverse-proxy"], "comments": [{"owner": {"reputation": 17156, "user_id": 5836, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/444c8d7844ba3aed548964c7524208bf?s=128&d=identicon&r=PG", "display_name": "Brettski", "link": "https://stackoverflow.com/users/5836/brettski"}, "edited": false, "score": 0, "creation_date": 1537069283, "post_id": 52350732, "comment_id": 91646775, "body": "Don&#39;t allow port 8000 traffic to the server. The requests are going directly to your go application around your proxy. How is traffic being directed to the server?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1537071971, "post_id": 52350732, "comment_id": 91647082, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41028709/only-accept-http-connections-from-localhost-in-go\" title=\"only accept http connections from localhost in go\">stackoverflow.com/questions/41028709/&hellip;</a>"}, {"owner": {"reputation": 1726, "user_id": 609041, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a1c37f80358135cdd3a310aef075060e?s=128&d=identicon&r=PG", "display_name": "AAA", "link": "https://stackoverflow.com/users/609041/aaa"}, "reply_to_user": {"reputation": 17156, "user_id": 5836, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/444c8d7844ba3aed548964c7524208bf?s=128&d=identicon&r=PG", "display_name": "Brettski", "link": "https://stackoverflow.com/users/5836/brettski"}, "edited": false, "score": 0, "creation_date": 1537074430, "post_id": 52350732, "comment_id": 91647407, "body": "@Brettski If you go to the main site at <code>api.mysite.com</code>, it takes me exactly where I need to be, yet I can still access the web server through My.Server.Ip:8000 ...."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1537083688, "post_id": 52350732, "comment_id": 91649018, "body": "Make the Go server listen on 127.0.0.1:8000 only, not on all addresses."}, {"owner": {"reputation": 1726, "user_id": 609041, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a1c37f80358135cdd3a310aef075060e?s=128&d=identicon&r=PG", "display_name": "AAA", "link": "https://stackoverflow.com/users/609041/aaa"}, "edited": false, "score": 0, "creation_date": 1537101015, "post_id": 52350732, "comment_id": 91652879, "body": "I think I&#39;m getting closer ... now going to the IP address of the server gives me a &quot;Welcome to nginx!&quot; page..."}, {"owner": {"reputation": 1726, "user_id": 609041, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a1c37f80358135cdd3a310aef075060e?s=128&d=identicon&r=PG", "display_name": "AAA", "link": "https://stackoverflow.com/users/609041/aaa"}, "edited": false, "score": 0, "creation_date": 1537130817, "post_id": 52350732, "comment_id": 91660978, "body": "It&#39;s now no longer server on the IP address of port <code>8000</code>. Now I am getting <code>404</code> returned when I navigate to the IP address of the server . (but going to the domain name works). I will post my nginx config."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1537192974, "post_id": 52350732, "comment_id": 91683521, "body": "Something is still listening on &quot;:8000&quot;.  Is an old version of the Go server still running? The nginx config has upstream server at 8001, but Go server is listening on 8000. What&#39;s up with that?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1537194385, "post_id": 52350732, "comment_id": 91684421, "body": "It seems like the original issue was solved by an answer to this question. If you have a new issue, please open a new question rather than just editing this one to add a new question. If the new question is about nginx configuration, consider asking it on ServerFault instead of StackOverflow."}, {"owner": {"reputation": 1726, "user_id": 609041, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a1c37f80358135cdd3a310aef075060e?s=128&d=identicon&r=PG", "display_name": "AAA", "link": "https://stackoverflow.com/users/609041/aaa"}, "edited": false, "score": 0, "creation_date": 1537232085, "post_id": 52350732, "comment_id": 91699557, "body": "No, it wasn&#39;t solved. If you read the bold, I still get a &quot;welcome to nginx&quot; when I navigate to the IP address of the server."}], "answers": [{"comments": [{"owner": {"reputation": 1726, "user_id": 609041, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a1c37f80358135cdd3a310aef075060e?s=128&d=identicon&r=PG", "display_name": "AAA", "link": "https://stackoverflow.com/users/609041/aaa"}, "edited": false, "score": 0, "creation_date": 1537130780, "post_id": 52357257, "comment_id": 91660973, "body": "It&#39;s now no longer server on the IP address of port <code>8000</code>. Now I am getting <code>404</code> returned when I navigate to the IP address of the server . (but going to the domain name works). I will post my nginx config."}], "tags": [], "owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "is_accepted": true, "score": 4, "last_activity_date": 1537122957, "creation_date": 1537122957, "answer_id": 52357257, "question_id": 52350732, "link": "https://stackoverflow.com/questions/52350732/configured-nginx-as-reverse-proxy-on-ports-80-and-443-for-webapp-running-on-8000/52357257#52357257", "title": "Configured nginx as reverse proxy on ports 80 and 443 for webapp running on 8000. How do I disable connections to port 8000?", "body": "<p>You can code your application so that it simply does not answer to every address. Rather it only needs to answer to requests from the local host.</p>\n\n<p>For example:</p>\n\n<pre><code>    log.Fatal(http.ListenAndServe(\"127.0.0.1:8000\", router))\n</code></pre>\n"}], "owner": {"reputation": 1726, "user_id": 609041, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/a1c37f80358135cdd3a310aef075060e?s=128&d=identicon&r=PG", "display_name": "AAA", "link": "https://stackoverflow.com/users/609041/aaa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1392, "favorite_count": 0, "accepted_answer_id": 52357257, "answer_count": 1, "score": 0, "last_activity_date": 1537131062, "creation_date": 1537068981, "last_edit_date": 1537131062, "question_id": 52350732, "link": "https://stackoverflow.com/questions/52350732/configured-nginx-as-reverse-proxy-on-ports-80-and-443-for-webapp-running-on-8000", "title": "Configured nginx as reverse proxy on ports 80 and 443 for webapp running on 8000. How do I disable connections to port 8000?", "body": "<p>I configured nginx as a reverse proxy on ports 80 and 443 and had Certbot automatically manage the SSL certificate.</p>\n\n<p>The Golang webapp I have is running on port 8000. Anyone can access the web app through the non-https IP address to the web server with port <code>:8000</code>. </p>\n\n<p>Besides just blocking all traffic to <code>:8000</code>, what's the proper way to disable the port so that the web server is just serving traffic to <code>80</code> and <code>443</code>?</p>\n\n<p><strong>OK, I had my Go app just serve <code>127.0.0.1:8000</code> instead of <code>:8000</code> and now when I navigate to the IP address of my server, I get a <code>404</code> not found page. I don't want the IP address of my server served at all. How do I configure that in nginx?</strong></p>\n\n<p><strong>Also, the nginx docs say to \"proxy everything\" using <code>@proxy</code>: <a href=\"https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/#proxy-everything\" rel=\"nofollow noreferrer\">https://www.nginx.com/resources/wiki/start/topics/tutorials/config_pitfalls/#proxy-everything</a> (read about it here). Is my config the correct way to do it?</strong></p>\n\n<p>Here is my nginx config for <code>/etc/nginx/nginx.conf</code>:</p>\n\n<pre><code>user nginx;\nworker_processes auto;\nerror_log /var/log/nginx/error.log;\npid /run/nginx.pid;\n\n# Load dynamic modules. See /usr/share/nginx/README.dynamic.\ninclude /usr/share/nginx/modules/*.conf;\n\nevents {\n    worker_connections 20000;\n}\n\nhttp {\n\n    log_format  main  '$remote_addr - $remote_user [$time_local] \"$request\" '\n                      '$status $body_bytes_sent \"$http_referer\" '\n                      '\"$http_user_agent\" \"$http_x_forwarded_for\"';\n\n    access_log  /var/log/nginx/access.log  main;\n\n    sendfile            on;\n    tcp_nopush          on;\n    tcp_nodelay         on;\n    keepalive_timeout   65;\n    types_hash_max_size 2048;\n\n    include             /etc/nginx/mime.types;\n    default_type        application/json;\n\n    # Load modular configuration files from the /etc/nginx/conf.d directory.\n    # See http://nginx.org/en/docs/ngx_core_module.html#include\n    # for more information.\n    include /etc/nginx/conf.d/*.conf;\n\n    # Include server blocks.\n    include /etc/nginx/sites-enabled/*.conf;\n}\n</code></pre>\n\n<p>Here is the nginx config for <code>/etc/nginx/sites-enabled/default_server.conf</code>:</p>\n\n<pre><code>upstream default_server {\n    server 127.0.0.1:8001;\n    keepalive 12;\n}\n\nserver {\n    server_tokens off;\n    server_name api.example.com;\n\n    client_body_buffer_size     32k;\n    client_header_buffer_size   8k;\n    large_client_header_buffers 8 64k;\n    location / {\n        proxy_pass http://127.0.0.1:8001;\n   }\n\n   location @proxy {\n        proxy_set_header X-Real-IP $remote_addr;\n        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n        proxy_set_header X-NginX-Proxy true;\n   }\n\n    listen [::]:443 ssl ipv6only=on; # managed by Certbot\n    listen 443 ssl; # managed by Certbot\n    ssl_certificate /etc/letsencrypt/live/api.example.com/fullchain.pem; # managed by Certbot\n    ssl_certificate_key /etc/letsencrypt/live/api.example.com/privkey.pem; # managed by Certbot\n    include /etc/letsencrypt/options-ssl-nginx.conf; # managed by Certbot\n    ssl_dhparam /etc/letsencrypt/ssl-dhparams.pem; # managed by Certbot\n\n}\n\n\n\nserver {\n    if ($host = api.example.com) {\n        return 301 https://$host$request_uri;\n    } # managed by Certbot\n\n\n    listen 80 default_server;\n    listen [::]:80 default_server;\n    server_name api.example.com;\n    return 404; # managed by Certbot\n\n\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "is_accepted": false, "score": 4, "last_activity_date": 1537073868, "last_edit_date": 1537073868, "creation_date": 1537073404, "answer_id": 52351037, "question_id": 52350602, "link": "https://stackoverflow.com/questions/52350602/the-order-of-goroutines-runs/52351037#52351037", "title": "the order of Goroutines runs", "body": "<p>The only places where there's synchronization is the channel operations. There need not be correlation between the order of operations in the goroutines outside of those statements.</p>\n\n<p>Running your program multiple times, I got the output you have most of the time but sometimes I saw something like this as well:</p>\n\n<pre><code>debugging send... 0\ndebugging send... 1\nReceived  0 true\nReceived  1 true\ndebugging send... 2\ndebugging send... 3\nReceived  2 true\nReceived  3 true\ndebugging send... 4\ndebugging send... 5\nReceived  4 true\nReceived  5 true\ndebugging send... 6\ndebugging send... 7\nReceived  6 true\ndebugging send... 8\nReceived  7 true\nReceived  8 true\ndebugging send... 9\nReceived  9 true\n</code></pre>\n\n<p>Try running this Bash shell script to run the program multiple times and compare its output:</p>\n\n<pre><code>#!/bin/bash\n\n# c.go has your Go program\ngo run c.go &gt; first.txt\ncat first.txt\n\necho \"======\"\nwhile :; do\n    go run c.go &gt; run.txt\n    if ! diff -q run.txt first.txt; then\n        break\n    fi\ndone\n\ncat run.txt\n</code></pre>\n\n<p>Edit: You may find <a href=\"https://golang.org/ref/mem\" rel=\"nofollow noreferrer\">https://golang.org/ref/mem</a> interesting to read about synchronization in Go.</p>\n"}, {"tags": [], "owner": {"reputation": 140, "user_id": 5115007, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3667e565469ab7020a2a4b6c0aeb4392?s=128&d=identicon&r=PG&f=1", "display_name": "Prabesh P", "link": "https://stackoverflow.com/users/5115007/prabesh-p"}, "is_accepted": false, "score": 1, "last_activity_date": 1537509672, "creation_date": 1537509672, "answer_id": 52437484, "question_id": 52350602, "link": "https://stackoverflow.com/questions/52350602/the-order-of-goroutines-runs/52437484#52437484", "title": "the order of Goroutines runs", "body": "<p>it's the way in which go routines communicate. You can use a channel for such synchronisation or some memory lock mechanism for achieving the same.</p>\n\n<p>If you're interested in reading more checkout these links </p>\n\n<ol>\n<li><a href=\"http://www.ardanlabs.com/blog/2018/08/scheduling-in-go-part1.html\" rel=\"nofollow noreferrer\">http://www.ardanlabs.com/blog/2018/08/scheduling-in-go-part1.html</a> </li>\n<li><a href=\"https://rakyll.org/scheduler/\" rel=\"nofollow noreferrer\">https://rakyll.org/scheduler/</a></li>\n<li><a href=\"https://docs.google.com/document/d/1yIAYmbvL3JxOKOjuCyon7JhW4cSv1wy5hC0ApeGMV9s/pub\" rel=\"nofollow noreferrer\">https://docs.google.com/document/d/1yIAYmbvL3JxOKOjuCyon7JhW4cSv1wy5hC0ApeGMV9s/pub</a></li>\n</ol>\n"}], "owner": {"reputation": 1611, "user_id": 4128453, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/VnU6d.png?s=128&g=1", "display_name": "Chris Bao", "link": "https://stackoverflow.com/users/4128453/chris-bao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1537509672, "creation_date": 1537066946, "last_edit_date": 1537069767, "question_id": 52350602, "link": "https://stackoverflow.com/questions/52350602/the-order-of-goroutines-runs", "title": "the order of Goroutines runs", "body": "<p>I am learning Golang right now, and came across some interesting tutorial online. for example this one: <a href=\"https://golangbot.com/channels/\" rel=\"nofollow noreferrer\">https://golangbot.com/channels/</a></p>\n\n<p>in this part about goroutines, there is one example case as following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc producer(chnl chan int) {\n    for i := 0; i &lt; 10; i++ {\n        fmt.Println(\"debugging send...\", i)\n        chnl &lt;- i\n    }\n    close(chnl)\n}\nfunc main() {\n    ch := make(chan int)\n    go producer(ch)\n    for {\n        v, ok := &lt;-ch\n        if ok == false {\n            break\n        }\n        fmt.Println(\"Received \", v, ok)\n    }\n}\n</code></pre>\n\n<p>the line <code>fmt.Println(\"debugging send...\", i)</code> is added by me for debugging purpose. and the output is:</p>\n\n<pre><code>debugging send... 0\ndebugging send... 1\nReceived  0 true\nReceived  1 true\ndebugging send... 2\ndebugging send... 3\nReceived  2 true\nReceived  3 true\ndebugging send... 4\ndebugging send... 5\nReceived  4 true\nReceived  5 true\ndebugging send... 6\ndebugging send... 7\nReceived  6 true\nReceived  7 true\ndebugging send... 8\ndebugging send... 9\nReceived  8 true\nReceived  9 true\n</code></pre>\n\n<p>The output order seems interesting for me, but can't fully understand what's going on under the hood. </p>\n"}, {"tags": ["go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 5706249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e551173b6c2eec67dd4ee697d51ebde?s=128&d=identicon&r=PG", "display_name": "ruqqq", "link": "https://stackoverflow.com/users/5706249/ruqqq"}, "edited": false, "score": 0, "creation_date": 1537067230, "post_id": 52350493, "comment_id": 91646487, "body": "It doesn\u2019t compile not because of circular dependencies though. In the example above, package A and B does not import each other. The intent is that the main() (call it package M) code connects the 2 packages together via interfaces."}, {"owner": {"reputation": 153, "user_id": 5706249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e551173b6c2eec67dd4ee697d51ebde?s=128&d=identicon&r=PG", "display_name": "ruqqq", "link": "https://stackoverflow.com/users/5706249/ruqqq"}, "edited": false, "score": 0, "creation_date": 1537067345, "post_id": 52350493, "comment_id": 91646504, "body": "The issue is that RunnerB (pkg b) interface is not detected as equivalent to Runner (pkg a) interface although they define the same function signatures hence the type check fails."}, {"owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "reply_to_user": {"reputation": 153, "user_id": 5706249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e551173b6c2eec67dd4ee697d51ebde?s=128&d=identicon&r=PG", "display_name": "ruqqq", "link": "https://stackoverflow.com/users/5706249/ruqqq"}, "edited": false, "score": 0, "creation_date": 1537071205, "post_id": 52350493, "comment_id": 91646995, "body": "Yes I know. I tried your playground code and tweaked it to work using the same interface type in both packages. I wouldn&#39;t have answered the way I did if I didn&#39;t understand the problem."}, {"owner": {"reputation": 153, "user_id": 5706249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e551173b6c2eec67dd4ee697d51ebde?s=128&d=identicon&r=PG", "display_name": "ruqqq", "link": "https://stackoverflow.com/users/5706249/ruqqq"}, "edited": false, "score": 0, "creation_date": 1537096342, "post_id": 52350493, "comment_id": 91651786, "body": "The edited answer is much clearer, and provide relevant references to why it&#39;s not a consistent axiom. Thanks!"}], "tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 0, "last_activity_date": 1537072350, "last_edit_date": 1537072350, "creation_date": 1537065151, "answer_id": 52350493, "question_id": 52349661, "link": "https://stackoverflow.com/questions/52349661/create-equivalent-interface-of-another-package-with-an-interface-as-argument/52350493#52350493", "title": "Create equivalent interface of another package with an interface as argument", "body": "<h1>The Solution</h1>\n\n<p>You've got a type that is used in two packages, A and B.  Package A imports package B.</p>\n\n<p>You have to avoid circular dependencies, so you have three choices:</p>\n\n<ol>\n<li>Define the type in package B, so it will be available in both\npackages.</li>\n<li>Define the type in package C and have both A and B import package C.</li>\n<li>Change your design such that the type is not used in both A and B.</li>\n</ol>\n\n<p>These are your choices whether that type is an interface or any other type.</p>\n\n<p>Choose the option that best fits your design goals.</p>\n\n<h1>The Rule / Idiom</h1>\n\n<blockquote>\n  <p>I am practicing writing idiomatic Go code and discovered that\n  interfaces should be declared in packages which are consuming them\n  since they're implicit.</p>\n</blockquote>\n\n<p>I get the impulse/idea - the problem is it's not very practical.  Interfaces would be less useful if they could only be consumed in the package in which they are defined.  The standard library is full of code that violates this axiom.  Therefore I do not think the rule as presented -- applying to all interfaces in all situations, designs and contexts -- is idiomatic.</p>\n\n<p>For example, look at the <a href=\"https://golang.org/pkg/bytes\" rel=\"nofollow noreferrer\">bytes</a> package.   <a href=\"https://golang.org/pkg/bytes/#Buffer.ReadFrom\" rel=\"nofollow noreferrer\"><code>func (b *Buffer) ReadFrom(r io.Reader) (n int64, err error)</code></a> consumes <code>io.Reader</code>, an interface defined in another package.  <a href=\"https://golang.org/pkg/bytes/#Reader.WriteTo\" rel=\"nofollow noreferrer\"><code>func (r *Reader) WriteTo(w io.Writer) (n int64, err error)</code></a> consumes <code>io.Writer</code>, an interface defined in another package.</p>\n"}, {"tags": [], "owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "is_accepted": true, "score": 2, "last_activity_date": 1537081377, "creation_date": 1537081377, "answer_id": 52351779, "question_id": 52349661, "link": "https://stackoverflow.com/questions/52349661/create-equivalent-interface-of-another-package-with-an-interface-as-argument/52351779#52351779", "title": "Create equivalent interface of another package with an interface as argument", "body": "<p>IIUC, your question is not about packages but boils down to whether a function (or method)\ncan be typecast to another function which takes arguments with equivalent, but\nnot the same interface types.</p>\n\n<p>Something like this: (<a href=\"https://play.golang.org/p/HmnNoBf0p1z\" rel=\"nofollow noreferrer\">Go Playground</a>)</p>\n\n<pre><code>package main\n\ntype I1 interface{}\n\nfunc f1(x I1) {}\n\nfunc main() {\n    f := (func(interface{}))(f1)\n    f(nil)\n}\n</code></pre>\n\n<p>Compilation error:  <code>./g.go:8:26: cannot convert f1 (type func(I1)) to type func(interface {})</code></p>\n\n<p>The answer appears to be no, because Go doesn't consider <code>func (I1)</code> to be\nequivalent to <code>func (interface{})</code>. The <a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow noreferrer\">Go spec</a> says this</p>\n\n<blockquote>\n  <p>A function type denotes the set of all functions with the same parameter and result types.</p>\n</blockquote>\n\n<p>The types <code>func (I1)</code> and <code>func (interface{})</code> do not take the same parameters, even though\n<code>I1</code> is defined as <code>interface{}</code>. Your code fails to compile for a similar\nreason because <code>func (runner RunnerB)</code> is not the same as <code>func (runner Runner)</code> and hence the method set of  <code>*Manager</code> is not a superset of the\ninterface <code>runnerRegisterer</code>.</p>\n\n<p>Coming to your original question:</p>\n\n<blockquote>\n  <p>I am practicing writing idiomatic Go code and discovered that interfaces\n  should be declared in packages which are consuming them since they're\n  implicit.</p>\n</blockquote>\n\n<p>Yes, the idea is good but it doesn't apply to your implementation the way you\nthink it does. Since you're expecting to have different implementations of\n<code>runnerRegisterer</code> and they must all have a method with the same signature\nusing the <code>Runner</code> interface, it makes sense to define <code>Runner</code> in a common\nplace. Also, as seen above Go wouldn't allow you to use a different interface\nin the method signatures anyway.</p>\n\n<p>Based on my understanding of what you're trying to achieve, here's how I think\nyou should re-arrange your code:</p>\n\n<ol>\n<li>Define <code>RunnerRegisterer</code> (note: this is public) and <code>Runner</code> in one\npackage.</li>\n<li>Implement your <code>RunnerCoach</code> in the same package and use the above\ninterfaces. Your <code>RunnerCoach</code> consumes types that implement the interfaces,\nso it defines them.</li>\n<li>Implement your runners in another package. You don't define the <code>Runner</code>\ninterface here.</li>\n<li>Implement your <code>Manager</code> in another package, which uses the interface\n<code>Runner</code> defined in <code>RunnerCoach</code>'s package because it must take that type\nas an argument if it wants to be used as a <code>RunnerRegisterer</code>.</li>\n</ol>\n"}], "owner": {"reputation": 153, "user_id": 5706249, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e551173b6c2eec67dd4ee697d51ebde?s=128&d=identicon&r=PG", "display_name": "ruqqq", "link": "https://stackoverflow.com/users/5706249/ruqqq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 336, "favorite_count": 0, "accepted_answer_id": 52351779, "answer_count": 2, "score": 2, "last_activity_date": 1537095188, "creation_date": 1537053528, "last_edit_date": 1537095188, "question_id": 52349661, "link": "https://stackoverflow.com/questions/52349661/create-equivalent-interface-of-another-package-with-an-interface-as-argument", "title": "Create equivalent interface of another package with an interface as argument", "body": "<p>I am practicing writing idiomatic Go code and discovered that interfaces should be declared in packages which are consuming them since they're implicit. However I came to this situation where by in the second package (package b) I want a function to call the receiver function of a struct in package a without coupling it tightly.</p>\n\n<p>So naturally, I declare an interface in package b with the signature of the function I want to call from package a. The problem is that this function accepts an argument of a certain type which is an interface declared in package a. As I don't want package b to import package a, I defined an interface in package b with the exact same signature as the one which exists in package a. The playground link below shows the example code.</p>\n\n<p><a href=\"https://play.golang.org/p/s7yMfD2YjrF\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n    manager := &amp;Manager{}\n    coach := NewRunnerCoach(manager)\n    fmt.Println(\"Done\")\n}\n\n// package a\n\ntype Runner interface {\n    Run()\n}\n\ntype Manager struct {\n}\n\nfunc (o *Manager) RegisterRunner(runner Runner) {\n    log.Print(\"RegisterRunner\")\n}\n\nfunc (o *Manager) Start() {\n    log.Print(\"Start\")\n}\n\n// package b\n\ntype RunnerCoach struct {\n    runner *FastRunner\n}\n\nfunc NewRunnerCoach(registerer runnerRegisterer) *RunnerCoach {\n    runnerCoach := &amp;RunnerCoach{&amp;FastRunner{}}\n    registerer.RegisterRunner(runnerCoach.runner)\n    return runnerCoach\n}\n\ntype FastRunner struct {\n}\n\nfunc (r *FastRunner) Run() {\n    log.Print(\"FastRunner Run\")\n}\n\n// define ther registerer interface coach is accepting\ntype runnerRegisterer interface {\n    RegisterRunner(runner RunnerB)\n}\n\n// declaring a new interface with the same signature because we dont want to import package a\n// and import Runner interface\ntype RunnerB interface {\n    Run()\n}\n</code></pre>\n\n<p>This code does not compile. So the question here is that, am I using interface wrongly or should concrete types be defined in a separate package or lastly, is there a better code pattern for the problem I'm trying to solve?</p>\n\n<p>EDIT: To clarify, package a and b does not import each other. The main() code exists in a separate package which connects these two.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "edited": false, "score": 2, "creation_date": 1537056740, "post_id": 52349447, "comment_id": 91644977, "body": "I wish you had more of an example to work with. But I think you want struct composition <a href=\"https://dave.cheney.net/2015/05/22/struct-composition-with-go\" rel=\"nofollow noreferrer\">dave.cheney.net/2015/05/22/struct-composition-with-go</a>   or else just repeat the structs. Code repetition is not as bad as OOP languages may have lead you to believe."}], "answers": [{"tags": [], "owner": {"reputation": 2254, "user_id": 1003650, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6b653616a592b8bdc296b0abf6207a71?s=128&d=identicon&r=PG", "display_name": "Venantius", "link": "https://stackoverflow.com/users/1003650/venantius"}, "is_accepted": false, "score": 0, "last_activity_date": 1537053465, "creation_date": 1537053465, "answer_id": 52349651, "question_id": 52349447, "link": "https://stackoverflow.com/questions/52349447/merging-two-structs-of-the-same-type-in-go/52349651#52349651", "title": "Merging two structs (of the same type) in go?", "body": "<p>I guess there is a significant question here about performance. If performance matters, I can pretty much guarantee that serializing / deserializing to string representation isn't the way you want to go. </p>\n\n<p>In general I'd assert that what you want to re: making it generic is not in the spirit of Go. If you need to \"merge\" two structs (itself an unclear objective without more specific examples) I think you probably should write this function yourself with explicit logic about which fields get copied where. </p>\n"}, {"tags": [], "owner": {"reputation": 3226, "user_id": 1964690, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/120d7c6980b552a124f79016300ca954?s=128&d=identicon&r=PG", "display_name": "jrefior", "link": "https://stackoverflow.com/users/1964690/jrefior"}, "is_accepted": false, "score": 1, "last_activity_date": 1537095935, "last_edit_date": 1537095935, "creation_date": 1537062375, "answer_id": 52350293, "question_id": 52349447, "link": "https://stackoverflow.com/questions/52349447/merging-two-structs-of-the-same-type-in-go/52350293#52350293", "title": "Merging two structs (of the same type) in go?", "body": "<p>Work with product to reduce your use cases to a manageable number of types rather than trying to write something fully generic that can handle any imaginable type.</p>\n\n<p>Then choose one of:</p>\n\n<ol>\n<li>Code generation with templates that will be populated on a per-type basis (high performance),</li>\n<li>Interfaces with type assertions (good performance, somewhat tedious to write but make use of a good editor or use code generation with templates here as well), or</li>\n<li>Reflection (poor performance, greater complexity, and possibly still tedious)</li>\n</ol>\n\n<p>If you can't get it down to a manageable number of types, a solution is still possible with reflection, but much more complex.  If you reach this point, look to the standard library and popular open source packages that are able to handle any type for examples/inspiration, and be aware it will likely take a lot of work/time/thought to complete and thoroughly test.</p>\n"}], "owner": {"reputation": 780, "user_id": 5261088, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/8256e8a248d8bcde285d3b97f77e36b0?s=128&d=identicon&r=PG&f=1", "display_name": "MickeyThreeSheds", "link": "https://stackoverflow.com/users/5261088/mickeythreesheds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 904, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1537095935, "creation_date": 1537050852, "question_id": 52349447, "link": "https://stackoverflow.com/questions/52349447/merging-two-structs-of-the-same-type-in-go", "title": "Merging two structs (of the same type) in go?", "body": "<p>I am kind of stuck here. I want to write a (generic, if possible!) function which will merge two structs of the same type - which also might contain not just primitives, but structs, and even slices.</p>\n\n<p>Due to the constraints that are placed on us at the business level, we can't really use mergo, so I need to write this. But I am kind of having trouble getting any results worth talking about - I am not looking for a fully working solution (if you have code, it'll help for sure) but I really need some guidance on what this algorithm might look like.</p>\n\n<p>I'd imagine I want to do something like have : </p>\n\n<pre><code>func Merge(source CustomStruct, target CustomStruct) result CustomStruct{\n\n    // Maybe some kind of son work to get my two structs to be strings?\n\n    // Iterate the JSON, comparing each field and taking values from source and target (depending on rules), and add them to result...\n\n    // recursion for when it contains another struct, or slice?\n\n    // return result\n}\n</code></pre>\n"}, {"tags": ["dictionary", "go", "hashmap"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1537044159, "post_id": 52348514, "comment_id": 91642758, "body": "You can make a type, create values of it to assign the map. <code>type myKey struct {x,y int}; m := map[myKey]int{myKey{2,3}:8,};&#47;&#47;...</code>"}], "answers": [{"comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1537048167, "post_id": 52348696, "comment_id": 91643567, "body": "The first sentence of the answer says that a <i>slice(array)</i> cannot be used as a key.  Slices and arrays are not the same thing.  An array can be used as a map key."}, {"owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1537056455, "post_id": 52348696, "comment_id": 91644930, "body": "@ThunderCat I was unaware that arrays could be used as a map key. Edited to that effect. Thanks! Always question myself using phrases like slice as I fear answers can become less understandable using somewhat go specific terms."}], "tags": [], "owner": {"reputation": 1158, "user_id": 6117625, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/cff13813080b5f227531191b1dc96b60?s=128&d=identicon&r=PG&f=1", "display_name": "Dean coakley", "link": "https://stackoverflow.com/users/6117625/dean-coakley"}, "is_accepted": false, "score": 6, "last_activity_date": 1537056238, "last_edit_date": 1537056238, "creation_date": 1537044076, "answer_id": 52348696, "question_id": 52348514, "link": "https://stackoverflow.com/questions/52348514/how-to-make-composite-key-for-a-hash-map-in-golang/52348696#52348696", "title": "How to make composite key for a hash map in golang", "body": "<p>Go can't make a hash of a slice of ints. </p>\n\n<p>Therefore the way I would approach this is mapping a struct to a number.</p>\n\n<p>Here is an example of how that could be done:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Nums struct {\n    num1 int\n    num2 int\n}\n\nfunc main() {\n    powers := make(map[Nums]int)\n    numbers := Nums{num1: 2, num2: 4}\n\n    powers[numbers] = 6\n\n    fmt.Printf(\"%v\", powers[input])\n}\n</code></pre>\n\n<p>I hope that helps</p>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "edited": false, "score": 1, "creation_date": 1537211073, "post_id": 52348704, "comment_id": 91693187, "body": "@GauravSinha incidentally, if you want to avoid Key literals in the calls, you can make the map a named type with a method: <a href=\"https://play.golang.org/p/TLsewvbwsc7\" rel=\"nofollow noreferrer\">play.golang.org/p/TLsewvbwsc7</a>"}, {"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1537216894, "post_id": 52348704, "comment_id": 91695597, "body": "@Kaedys nice, that&#39;s cleaner. Thank you."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 21, "last_activity_date": 1537072409, "last_edit_date": 1537072409, "creation_date": 1537044136, "answer_id": 52348704, "question_id": 52348514, "link": "https://stackoverflow.com/questions/52348514/how-to-make-composite-key-for-a-hash-map-in-golang/52348704#52348704", "title": "How to make composite key for a hash map in golang", "body": "<p>The easiest and most flexible way is to use a <code>struct</code> as the key type, including all the data you want to be part of the key, so in your case:</p>\n\n<pre><code>type Key struct {\n    X, Y int\n}\n</code></pre>\n\n<p>And that's all. Using it:</p>\n\n<pre><code>m := map[Key]int{}\nm[Key{2, 2}] = 4\nm[Key{2, 3}] = 8\n\nfmt.Println(\"2^2 = \", m[Key{2, 2}])\nfmt.Println(\"2^3 = \", m[Key{2, 3}])\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/0pMWmGJgoGH\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2^2 =  4\n2^3 =  8\n</code></pre>\n\n<p><a href=\"https://golang.org/ref/spec#Map_types\" rel=\"noreferrer\">Spec: Map types:</a> You may use any types as the key where the comparison operators <code>==</code> and <code>!=</code> are fully defined, and the above <code>Key</code> struct type fulfills this.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">Spec: Comparison operators:</a> Struct values are comparable if all their fields are comparable. Two struct values are equal if their corresponding non-<a href=\"https://golang.org/ref/spec#Blank_identifier\" rel=\"noreferrer\">blank</a> fields are equal. </p>\n\n<p>One important thing: you should not use a pointer as the key type (e.g. <code>*Key</code>), because comparing pointers only compares the memory address, and not the pointed values.</p>\n\n<p>Also note that you could also use <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"noreferrer\">arrays</a> (not <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"noreferrer\">slices</a>) as key type, but arrays are not as flexible as structs. You can read more about this here: <a href=\"https://stackoverflow.com/questions/38645175/why-have-arrays-in-go/38645895#38645895\">Why have arrays in Go?</a></p>\n\n<p>This is how it would look like with arrays:</p>\n\n<pre><code>type Key [2]int\n\nm := map[Key]int{}\nm[Key{2, 2}] = 4\nm[Key{2, 3}] = 8\n\nfmt.Println(\"2^2 = \", m[Key{2, 2}])\nfmt.Println(\"2^3 = \", m[Key{2, 3}])\n</code></pre>\n\n<p>Output is the same. Try it on the <a href=\"https://play.golang.org/p/o4WquJecnn2\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8048, "favorite_count": 2, "accepted_answer_id": 52348704, "answer_count": 2, "score": 9, "last_activity_date": 1537167561, "creation_date": 1537042687, "last_edit_date": 1537167561, "question_id": 52348514, "link": "https://stackoverflow.com/questions/52348514/how-to-make-composite-key-for-a-hash-map-in-golang", "title": "How to make composite key for a hash map in golang", "body": "<p>First, my definition of composite key - two ore more values combine to make the key. Not to confuse with composite keys in databases. </p>\n\n<p>My goal is to save computed values of pow(x, y) in a hash table (x and y are integers). This is where I need ideas on how to make a key, so that given x and y, I can look it up in the hash table, to find pow(x,y).</p>\n\n<p>Eg. pow(2, 3) => {key(2,3):8}\nFunction / way to get the key(2,3) is what I want to figure out.  </p>\n\n<p>In general whats the best way to handle key which is a combination of multiple values, while using as a key in hash table. </p>\n\n<p>Thanks</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10259808"}, "is_accepted": false, "score": 0, "last_activity_date": 1537040443, "creation_date": 1537040443, "answer_id": 52348236, "question_id": 52348110, "link": "https://stackoverflow.com/questions/52348110/what-is-a-good-practice-for-pagination-using-page-number-limit-in-go/52348236#52348236", "title": "What is a good Practice for Pagination using Page Number &amp; Limit in Go?", "body": "<p>I also faced the same problem. I preferred to send Error Response instead of showing all the data.</p>\n\n<p>Because It's a heavy transaction for DB if DB has to send all data. On small collections, it's work fine but for the large collections, it's gonna hang DB.</p>\n\n<p>So send an error response.</p>\n"}, {"comments": [{"owner": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "edited": false, "score": 0, "creation_date": 1537042051, "post_id": 52348347, "comment_id": 91642265, "body": "I don&#39;t have lastMemorizedId actually."}, {"owner": {"reputation": 30583, "user_id": 605153, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/771f1c4e90ceeec0060c62ff0dbb762e?s=128&d=identicon&r=PG", "display_name": "Mark Bramnik", "link": "https://stackoverflow.com/users/605153/mark-bramnik"}, "reply_to_user": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "edited": false, "score": 0, "creation_date": 1537042143, "post_id": 52348347, "comment_id": 91642296, "body": "I understand, I&#39;m just stating the possible issues, so if performance aggravation is an issue, probably it worth to be aware of the possible reason."}, {"owner": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "edited": false, "score": 0, "creation_date": 1537042186, "post_id": 52348347, "comment_id": 91642311, "body": "So I think sending error response is a good idea. Just a thought."}], "tags": [], "owner": {"reputation": 30583, "user_id": 605153, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/771f1c4e90ceeec0060c62ff0dbb762e?s=128&d=identicon&r=PG", "display_name": "Mark Bramnik", "link": "https://stackoverflow.com/users/605153/mark-bramnik"}, "is_accepted": false, "score": 2, "last_activity_date": 1537041374, "creation_date": 1537041374, "answer_id": 52348347, "question_id": 52348110, "link": "https://stackoverflow.com/questions/52348110/what-is-a-good-practice-for-pagination-using-page-number-limit-in-go/52348347#52348347", "title": "What is a good Practice for Pagination using Page Number &amp; Limit in Go?", "body": "<p>I believe, that paging should be used only for cases when the size of the collection is big (otherwise just show all the data at once and don't fiddle with paging at all).</p>\n\n<p>However, if the collection is reasonably big, then sending all the data is a bad idea.</p>\n\n<p>There is an additional issue with \"skip\" statement (it's not unique to mongo though):\nin order to skip N records, the db has to do a full scan (full collection scan in case of mongo), so it will take more time to fetch results for page N + 1 than for page N.</p>\n\n<p>Now, in order to deal with it, there is a \"trick\":\nDon't work with skip at all, instead \"memorize\" the last document id (its already indexed anyway and you sort by <code>_id</code> anyway).\nThen the queries will be (pseudocode since I don't speak 'Go'):</p>\n\n<ul>\n<li><p>For the first query:\n<code>Find().sort(_id).limit(limitSize)</code></p></li>\n<li><p>For subsequent queries:\n<code>Find ().where(_id &gt; lastMemorizedId).sort(_id).limit(limitSize)</code></p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "edited": false, "score": 0, "creation_date": 1537043803, "post_id": 52348621, "comment_id": 91642691, "body": "The problem is that neither I can&#39;t define safety limit nor I can&#39;t check. Also I don&#39;t have last record id."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "edited": false, "score": 0, "creation_date": 1537043835, "post_id": 52348621, "comment_id": 91642698, "body": "Please explain &quot;can&#39;t&quot;. Are you the developer or not? If you are, you can."}, {"owner": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "edited": false, "score": 0, "creation_date": 1537044135, "post_id": 52348621, "comment_id": 91642755, "body": "The situation is that : I got an requirement where nothing return about same anything OR no one is availabel to answer. Some one else have some predefined set of test and gonna test for same. I love to use safety and error responses. So that&#39;s the situation. I think I should use safety limit and send error responses."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1537253580, "post_id": 52348621, "comment_id": 91705346, "body": "The only thing to add here would be to log requests that are trying to exceed the safety limits including the (original) IP (see <a href=\"https://en.m.wikipedia.org/wiki/X-Forwarded-For\" rel=\"nofollow noreferrer\">XFF</a> if you use a reverse proxy) of the request to be able to react to DoS attacks with something like fail2ban or at least detect it with a SIEM."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1537254696, "post_id": 52348621, "comment_id": 91705959, "body": "@MarkusWMahlberg Yes, there are a lot more things that could be added in the name of security (such as authentication, rate limiting etc.), I tried to focus on how to handle the <code>limit</code> parameter."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1572992993, "last_edit_date": 1572992993, "creation_date": 1537043453, "answer_id": 52348621, "question_id": 52348110, "link": "https://stackoverflow.com/questions/52348110/what-is-a-good-practice-for-pagination-using-page-number-limit-in-go/52348621#52348621", "title": "What is a good Practice for Pagination using Page Number &amp; Limit in Go?", "body": "<p>This question is somewhat opinion-based (and therefore somewhat off-topic for StackOverflow), but I think some advice or general practice may be helpful and useful for others. So therefore the following of the answer is <em>my</em> opinion.</p>\n\n<p>You as the developer of the server application are responsible for the safety and security of the server, and for the utilization of the server's resources. You as the developer should trust clients to the least extent necessary.</p>\n\n<p>That said, sending all documents when client fails to specify the limit (either accidentally or purposefully) is the worst way to handle the situation. It's like screaming out: \"Hey, clients and hackers, here's an endpoint, and if you want to <a href=\"https://en.wikipedia.org/wiki/Denial-of-service_attack\" rel=\"nofollow noreferrer\">DoS attack</a> my server, just call this endpoint a couple of times\".</p>\n\n<p>To protect your server, you should have a safety limit even for the \"limit\" parameter, because allowing any value for it may be just as bad: just because you force clients to specify a limit doesn't protect your server, \"bad\" clients may just as well send a limit like <code>1e9</code> which will most likely include all your documents.</p>\n\n<p>My advice is to always have <em>meaningful defaults</em> and <em>safety limits</em>. Default values should always be documented, safety limits are not so important (but could be documented as well).</p>\n\n<p>So how you should handle it is:</p>\n\n<ol>\n<li><p>If limit is missing, apply the defaults. If you can't have defaults, just skip this step (although there must be a good reason not to have / allow a default).</p></li>\n<li><p>Limit should be checked against a safety limit. If it exceeds the safety value, use the safety limit (max allowed limit).</p></li>\n<li><p>If the server has the \"right\" to alter the requested limit (e.g. using a default when limit is missing, or capping the limit based on a safety limit), the server should communicate back to the client the limit that was actually used to serve the request.</p></li>\n</ol>\n\n<p>And regarding efficient MongoDB paging: I only recommend using <code>Query.Skip()</code> and <code>Query.Limit()</code> for \"small\" document counts. For an efficient paging that \"scales\" with the number of documents, check out this question+answer: <a href=\"https://stackoverflow.com/questions/40634865/efficient-paging-in-mongodb-using-mgo\">Efficient paging in MongoDB using mgo</a></p>\n"}], "owner": {"reputation": 894, "user_id": 1947741, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/S3zyB.png?s=128&g=1", "display_name": "amku91", "link": "https://stackoverflow.com/users/1947741/amku91"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1068, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1572992993, "creation_date": 1537039511, "last_edit_date": 1537254723, "question_id": 52348110, "link": "https://stackoverflow.com/questions/52348110/what-is-a-good-practice-for-pagination-using-page-number-limit-in-go", "title": "What is a good Practice for Pagination using Page Number &amp; Limit in Go?", "body": "<p>I have created Pagination in Go using Page Number &amp; Limit. Where <code>Limit &amp; Page Number are INT</code></p>\n\n<p>and I created pagination like :</p>\n\n<pre><code>MONGO_SESSION.Find(nil).Skip(pageNumber*limit).Limit(limit).Sort(\"_id\").All(&amp;RETURN_STRUCT)\n</code></pre>\n\n<p>It's working fine. But when I send page number or limit ZERO. By default mongo DB return all records because nothing to skip and limit.</p>\n\n<blockquote>\n  <p>So my question is that what is good practice in case of zero limit and\n  zero page number.</p>\n  \n  <p>Practice 1: Send all data. Don't send error response.</p>\n  \n  <p>Practice 2: Send error response saying \"Page number and limit can't be\n  zero\"</p>\n</blockquote>\n\n<p><strong>Note: I can't hardcode limit or page number.</strong></p>\n\n<p>Any suggestion would be appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1537039738, "post_id": 52347816, "comment_id": 91641662, "body": "<code>creating the csv.Reader once, then feeding it the chan content somehow</code>. You could use a <code>io.Pipe</code>, sink the content of the chan into the write part, give the read part to the csv reader, drain the csv reader."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1537128235, "last_edit_date": 1537128235, "creation_date": 1537039165, "answer_id": 52348065, "question_id": 52347816, "link": "https://stackoverflow.com/questions/52347816/efficient-way-to-use-a-csv-reader-for-a-chan-string/52348065#52348065", "title": "Efficient way to use a csv.Reader() for a &quot;chan string&quot;", "body": "<p>Use the following to convert a channel of strings to a reader:</p>\n\n<pre><code>type chanReader struct {\n    c   chan string\n    buf string\n}\n\nfunc (r *chanReader) Read(p []byte) (int, error) {\n\n    // Fill the buffer when we have no data to return to the caller\n    if len(r.buf) == 0 {\n        var ok bool\n        r.buf, ok = &lt;-r.c\n        if !ok {\n            // Return eof on channel closed\n            return 0, io.EOF\n        }\n    }\n\n    n := copy(p, r.buf)\n    r.buf = r.buf[n:]\n    return n, nil\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>r := csv.NewReader(&amp;chanReader{c: feederChan})\nfor {\n    a, err := r.Read()\n    if err != nil {\n        // handle error, break out of loop\n    }\n    // do something with a\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ciisM8FbJ_9\" rel=\"nofollow noreferrer\">Run it on the playground</a></p>\n\n<p>If the application assumes that newlines separate the values received from the channel, then append a newline to each value received:</p>\n\n<pre><code>        ...\n        var ok bool\n        r.buf, ok = &lt;-r.c\n        if !ok {\n            // Return eof on channel closed\n            return 0, io.EOF\n        }\n        r.buf += \"\\n\"\n        ...\n</code></pre>\n\n<p>The <code>+= \"\\n\"</code> copies the string. If this does not meet the application's efficiency requirements, then introduce a new field to manage line separators.</p>\n\n<pre><code>type chanReader struct {\n    c chan string  // source of lines\n    buf string     // the current line\n    nl bool        // true if line separator is pending\n}\n\nfunc (r *chanReader) Read(p []byte) (int, error) {\n\n    // Fill the buffer when we have no data to return to the caller\n    if len(r.buf) == 0 &amp;&amp; !r.nl {\n        var ok bool\n        r.buf, ok = &lt;-r.c\n        if !ok {\n            // Return eof on channel closed\n            return 0, io.EOF\n        }\n        r.nl = true\n    }\n\n    // Return data if we have it\n    if len(r.buf) &gt; 0 {\n        n := copy(p, r.buf)\n        r.buf = r.buf[n:]\n        return n, nil\n    }\n\n    // No data, return the line separator\n    n := copy(p, \"\\n\")\n    r.nl = n == 0\n    return n, nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/wqaxGIBd2fO\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n\n<p>Another approach is to use an io.Pipe and goroutine to convert the channel to a io.Reader as suggested in a comment to the question. A first pass at this approach is:</p>\n\n<pre><code>var nl = []byte(\"\\n\")\n\nfunc createChanReader(c chan string) io.Reader {\n    r, w := io.Pipe()\n    go func() {\n        defer w.Close()\n        for s := range c {\n            io.WriteString(w, s)\n            w.Write(nl)\n            }\n        }\n    }()\n    return r\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>r := csv.NewReader(createChanReader(feederChan))\nfor {\n    a, err := r.Read()\n    if err != nil {\n        // handle error, break out of loop\n    }\n    // do something with a\n}\n</code></pre>\n\n<p>This first pass at the io.Pipe solution leaks a goroutine when the application exits the loop before reading the pipe to EOF. The application might break out early because the CSV reader detected a syntax error, the application panicked because of a programmer error, or any number of other reasons.</p>\n\n<p>To fix the goroutine leak, exit the writing goroutine on write error and close the pipe reader when done reading.</p>\n\n<pre><code>var nl = []byte(\"\\n\")\n\nfunc createChanReader(c chan string) *io.PipeReader {\n    r, w := io.Pipe()\n    go func() {\n        defer w.Close()\n        for s := range c {\n            if _, err := io.WriteString(w, s); err != nil {\n                return\n            }\n            if _, err := w.Write(nl); err != nil {\n                return\n            }\n        }\n    }()\n    return r\n}\n</code></pre>\n\n<p>Use it like this:</p>\n\n<pre><code>cr := createChanReader(feederChan)\ndefer cr.Close() // Required for goroutine cleanup\nr := csv.NewReader(cr)\nfor {\n    a, err := r.Read()\n    if err != nil {\n        // handle error, break out of loop\n    }\n    // do something with a\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/FuVVNVwX8ts\" rel=\"nofollow noreferrer\">Run it on the playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 10368637, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PparYyECSOE/AAAAAAAAAAI/AAAAAAAAFq0/CXeTZzROn_I/photo.jpg?sz=128", "display_name": "Sherif Eldeeb", "link": "https://stackoverflow.com/users/10368637/sherif-eldeeb"}, "is_accepted": false, "score": 2, "last_activity_date": 1537131678, "last_edit_date": 1537131678, "creation_date": 1537084800, "answer_id": 52352148, "question_id": 52347816, "link": "https://stackoverflow.com/questions/52347816/efficient-way-to-use-a-csv-reader-for-a-chan-string/52352148#52352148", "title": "Efficient way to use a csv.Reader() for a &quot;chan string&quot;", "body": "<p>Even though \"ThunderCat's\" answer was really useful and appreciated, I ended up using io.Pipe() \"as mh-cbon mentioned\" which is much simpler and looks like more efficient (explained below):</p>\n\n<pre><code>rp, wp := io.Pipe()\ngo func() {\n    defer wp.Close()\n    for i := range feederChan {\n        fmt.Fprintln(wp, i)\n    }\n}()\n\nr := csv.NewReader(rp)\nfor { // keep reading\n    a, err := r.Read()\n    if err == io.EOF {\n        break\n    }\n    // do stuff with 'a'\n    // ...\n}\n</code></pre>\n\n<p>The io.Pipe() is synchronous, and should be fairly efficient: it pipes data from writer to a reader; I fed the csv.NewReader() the reader part, and created a goroutine that drains the chan writing to the writer part.</p>\n\n<p>Thanks a lot.</p>\n\n<p>EDIT: ThunderCat added the io.Pipe approach to his answer (after I posted this I guess) ... his answer is much more comprehensive and was accepted as such.</p>\n"}], "owner": {"reputation": 63, "user_id": 10368637, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-PparYyECSOE/AAAAAAAAAAI/AAAAAAAAFq0/CXeTZzROn_I/photo.jpg?sz=128", "display_name": "Sherif Eldeeb", "link": "https://stackoverflow.com/users/10368637/sherif-eldeeb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 98, "favorite_count": 0, "accepted_answer_id": 52348065, "answer_count": 2, "score": 1, "last_activity_date": 1537131678, "creation_date": 1537037197, "question_id": 52347816, "link": "https://stackoverflow.com/questions/52347816/efficient-way-to-use-a-csv-reader-for-a-chan-string", "title": "Efficient way to use a csv.Reader() for a &quot;chan string&quot;", "body": "<p>I have a \"chan string\", where each entry is a CSV log line that I would like to convert to columns \"[]string\", currently I am (un-efficiently) creating a csv.NewReader(strings.NewReader(i)) for each item, which looks a lot more work than it really needs to be:</p>\n\n<pre><code>for i := range feederChan {\n    r := csv.NewReader(strings.NewReader(i))\n    a, err := r.Read()\n    if err != nil {\n         // log error...\n         continue\n    }\n    // then do stuff with 'a'\n    // ...\n}\n</code></pre>\n\n<p>So, I'd really appreciate sharing if there's a more efficient way to do that, like creating the csv.Reader once, then feeding it the chan content somehow (stream 'chan' content to something that implements the 'io.Reader' interface?).</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1537027887, "post_id": 52346262, "comment_id": 91638539, "body": "You have to write on <code>quit</code> after <code>Wait</code> in order to signal termination of the remote process. Within your main, after the select, add a read operation on <code>quit</code> to catch that new signal and exit your program."}], "answers": [{"tags": [], "owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "is_accepted": true, "score": 6, "last_activity_date": 1537040317, "last_edit_date": 1537040317, "creation_date": 1537038481, "answer_id": 52347990, "question_id": 52346262, "link": "https://stackoverflow.com/questions/52346262/how-to-call-cancel-when-using-exec-commandcontext-in-a-goroutine/52347990#52347990", "title": "how to call cancel() when using exec.CommandContext in a goroutine", "body": "\n\n<p>In Go, the program will stop if the end of the <code>main</code> method (in the <code>main</code> package) is reached. This behavior is described in the Go language specification under a <a href=\"https://golang.org/ref/spec#Program_execution\" rel=\"noreferrer\">section on program execution</a> (emphasis my own):</p>\n\n<blockquote>\n  <p>Program execution begins by initializing the <code>main</code> package and then invoking the function <code>main</code>. When that function invocation returns, the program exits. <strong>It does not wait for other (non-main) goroutines to complete.</strong></p>\n</blockquote>\n\n<hr>\n\n<h1>Defects</h1>\n\n<p>I will consider each of your examples and their associated control flow defects. You will find links to the Go playground below, but the code in these examples will not execute in the restrictive playground sandbox as the <code>sleep</code> executable cannot be found. Copy and paste to your own environment for testing.</p>\n\n<h2>Multiple goroutine example</h2>\n\n<pre class=\"lang-golang prettyprint-override\"><code>case &lt;-time.After(3 * time.Second):\n        log.Println(\"closing via ctx\")\n        ch &lt;- struct{}{}\n</code></pre>\n\n<p>After the timer fires and you signal to the goroutine it is time to kill the child and stop work, there is nothing to cause the <code>main</code> method to block and wait for this to complete, so it returns. In accordance with the language spec, the program exits.</p>\n\n<p>The scheduler may fire after the channel transmit, so there may be a race may between <code>main</code> exiting and the other goroutines waking up to receive from <code>ch</code>. However, it is unsafe to assume any particular interleaving of behavior \u2013 and, for practical purposes, unlikely that any useful work will happen before <code>main</code> quits. The <code>sleep</code> child process will be <a href=\"https://en.wikipedia.org/wiki/Orphan_process\" rel=\"noreferrer\">orphaned</a>; on Unix systems, the operating system will normally re-parent the process onto the <code>init</code> process.</p>\n\n<h2>Single goroutine example</h2>\n\n<p>Here, you have the opposite problem: <code>main</code> does not return, so the child process is not killed. This situation is only resolved when the child process exits (after 5 minutes). This occurs because:</p>\n\n<ul>\n<li>The call to <code>cmd.Wait</code> in the <code>Run</code> method is a blocking call (<a href=\"https://golang.org/pkg/os/exec/#Cmd.Wait\" rel=\"noreferrer\">docs</a>). The <code>select</code> statement is blocked waiting for <code>cmd.Wait</code> to return an error value, so cannot receive from the <code>quit</code> channel.</li>\n<li><p>The <code>quit</code> channel (declared as <code>ch</code> in <code>main</code>) is an <strong>unbuffered channel</strong>. Send operations on unbuffered channels will block until a receiver is ready to receive the data. From the <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"noreferrer\">language spec on channels</a> (again, emphasis my own):</p>\n\n<blockquote>\n  <p>The capacity, in number of elements, sets the size of the buffer in the channel. If the capacity is zero or absent, the channel is unbuffered and <strong>communication succeeds only when both a sender and receiver are ready</strong>.</p>\n</blockquote>\n\n<p>As <code>Run</code> is blocked in <code>cmd.Wait</code>, there is no ready receiver to receive the value transmitted on the channel by the <code>ch &lt;- struct{}{}</code> statement in the <code>main</code> method. <code>main</code> blocks waiting to transmit this data, which prevents the process returning.</p></li>\n</ul>\n\n<p>We can demonstrate both issues with minor code tweaks.</p>\n\n<h3><code>cmd.Wait</code> is blocking</h3>\n\n<p>To expose the blocking nature of <code>cmd.Wait</code>, declare the following function and use it in place of the <code>Wait</code> call. This function is a wrapper with the same behavior as <code>cmd.Wait</code>, but additional side-effects to print what is happening to STDOUT. (<a href=\"https://play.golang.org/p/BTN9i_9oW9d\" rel=\"noreferrer\">Playground link</a>):</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func waitOn(cmd *exec.Cmd) error {\n    fmt.Printf(\"Waiting on command %p\\n\", cmd)\n    err := cmd.Wait()\n    fmt.Printf(\"Returning from waitOn %p\\n\", cmd)\n    return err\n}\n\n// Change the select statement call to cmd.Wait to use the wrapper\ncase e &lt;- waitOn(cmd):\n</code></pre>\n\n<p>Upon running this modified program, you will observe the output <code>Waiting on command &lt;pointer&gt;</code> to the console. After the timers fire, you will observe the output <code>calling ctx cancel</code>, but no corresponding <code>Returning from waitOn &lt;pointer&gt;</code> text. This will only occur when the child process returns, which you can observe quickly by reducing the sleep duration to a smaller number of seconds (I chose 5 seconds).</p>\n\n<h3>Send on the quit channel, <code>ch</code>, blocks</h3>\n\n<p><code>main</code> cannot return because the signal channel used to propagate the quit request is unbuffered and there is no corresponding listener. By changing the line:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    ch := make(chan struct{})\n</code></pre>\n\n<p>to</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    ch := make(chan struct{}, 1)\n</code></pre>\n\n<p>the send on the channel in <code>main</code> will proceed (to the channel's buffer) and <code>main</code> will quit \u2013 the same behavior as the multiple goroutine example. However, this implementation is still broken: the value will not be read from the channel's buffer to actually start stopping the child process before <code>main</code> returns, so the child process will still be orphaned.</p>\n\n<hr>\n\n<h1>Fixed version</h1>\n\n<p>I have produced a fixed version for you, code below. There are also some stylistic improvements to convert your example to more idiomatic go:</p>\n\n<ul>\n<li><p>Indirection via a channel to signal when it is time to stop is unnecessary. Instead, we can avoid declaring a channel by hoisting declaration of the context and cancellation function to the <code>main</code> method. The context can be cancelled directly at the appropriate time.</p>\n\n<p>I have retained the separate <code>Run</code> function to demonstrate passing the context in this way, but in many cases, its logic could be embedded into the <code>main</code> method, with a goroutine spawned to perform the <code>cmd.Wait</code> blocking call.</p></li>\n<li>The <code>select</code> statement in the <code>main</code> method is unnecessary as it only has one <code>case</code> statement.</li>\n<li><a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a> is introduced to explicitly solve the problem of <code>main</code> exiting before the child process (waited on in a separate goroutine) has been killed. The wait group implements a counter; the call to <code>Wait</code> blocks until all goroutines have finished working and called <code>Done</code>.</li>\n</ul>\n\n\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"context\"\n    \"log\"\n    \"os/exec\"\n    \"sync\"\n    \"time\"\n)\n\nfunc Run(ctx context.Context) {\n    cmd := exec.CommandContext(ctx, \"sleep\", \"300\")\n    err := cmd.Start()\n    if err != nil {\n        // Run could also return this error and push the program\n        // termination decision to the `main` method.\n        log.Fatal(err)\n    }\n\n    err = cmd.Wait()\n    if err != nil {\n        log.Println(\"waiting on cmd:\", err)\n    }\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n    ctx, cancel := context.WithCancel(context.Background())\n\n    // Increment the WaitGroup synchronously in the main method, to avoid\n    // racing with the goroutine starting.\n    wg.Add(1)\n    go func() {\n        Run(ctx)\n        // Signal the goroutine has completed\n        wg.Done()\n    }()\n\n    &lt;-time.After(3 * time.Second)\n    log.Println(\"closing via ctx\")\n    cancel()\n\n    // Wait for the child goroutine to finish, which will only occur when\n    // the child process has stopped and the call to cmd.Wait has returned.\n    // This prevents main() exiting prematurely.\n    wg.Wait()\n}\n</code></pre>\n\n<p>(<a href=\"https://play.golang.org/p/_i313PNpmKJ\" rel=\"noreferrer\">Playground link</a>)</p>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2300, "favorite_count": 1, "accepted_answer_id": 52347990, "answer_count": 1, "score": 4, "last_activity_date": 1537040317, "creation_date": 1537026339, "last_edit_date": 1537026656, "question_id": 52346262, "link": "https://stackoverflow.com/questions/52346262/how-to-call-cancel-when-using-exec-commandcontext-in-a-goroutine", "title": "how to call cancel() when using exec.CommandContext in a goroutine", "body": "<p>I would like to cancel on demand a running command, for this, I am trying, <a href=\"https://golang.org/pkg/os/exec/#CommandContext\" rel=\"nofollow noreferrer\"><code>exec.CommandContext</code></a>, currently trying this:</p>\n\n<p><a href=\"https://play.golang.org/p/0JTD9HKvyad\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0JTD9HKvyad</a></p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"log\"\n    \"os/exec\"\n    \"time\"\n)\n\nfunc Run(quit chan struct{}) {\n    ctx, cancel := context.WithCancel(context.Background())\n    cmd := exec.CommandContext(ctx, \"sleep\", \"300\")\n    err := cmd.Start()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    go func() {\n        log.Println(\"waiting cmd to exit\")\n        err := cmd.Wait()\n        if err != nil {\n            log.Println(err)\n        }\n    }()\n\n    go func() {\n        select {\n        case &lt;-quit:\n            log.Println(\"calling ctx cancel\")\n            cancel()\n        }\n    }()\n}\n\nfunc main() {\n    ch := make(chan struct{})\n    Run(ch)\n    select {\n    case &lt;-time.After(3 * time.Second):\n        log.Println(\"closing via ctx\")\n        ch &lt;- struct{}{}\n    }\n}\n</code></pre>\n\n<p>The problem that I am facing is that the <code>cancel()</code> is called but the process is not being killed, my guess is that the main thread exit first and don't wait for the <code>cancel()</code> to properly terminate the command, mainly because If I use a <code>time.Sleep(time.Second)</code> at the end of the <code>main</code> function it exits/kills the running command.</p>\n\n<p>Any idea about how could I <code>wait</code> to ensure that the command has been killed before exiting not using a <code>sleep</code>? could the <code>cancel()</code> be used in a channel after successfully has killed the command?</p>\n\n<p>In a try to use a single goroutine I tried with this: <a href=\"https://play.golang.org/p/r7IuEtSM-gL\" rel=\"nofollow noreferrer\">https://play.golang.org/p/r7IuEtSM-gL</a> but the <code>cmd.Wait()</code> seems to be blocking all the time the <code>select</code> and was not available to call the <code>cancel()</code></p>\n"}, {"tags": ["javascript", "html", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537027717, "post_id": 52346011, "comment_id": 91638494, "body": "In your Go code when the login fails, don&#39;t redirect and write the error response, you can do only one of those per request/response. Do you want to return StatusForbidden or 302? Choose one."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537028044, "post_id": 52346011, "comment_id": 91638587, "body": "In your JS you can do what you want either by sending the request with javascript and waiting for the response and then based on the response do alert/log accordingly, or you can have the Go code redirect to a page where your JS already knows what to alert/log, or you re-render the login page but with some additional data, provided by Go, which is then read and handled by JS."}, {"owner": {"reputation": 43, "user_id": 6889344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a4743b94402677e0bf0504a1f27779?s=128&d=identicon&r=PG&f=1", "display_name": "Maruf Saidov", "link": "https://stackoverflow.com/users/6889344/maruf-saidov"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1537089102, "post_id": 52346011, "comment_id": 91650204, "body": "OK, It is clear, however I have another question. How to response (wrong password or login) without refreshing the html page? Because redirection refreshes the html page, what I should use instead?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1537093075, "post_id": 52346011, "comment_id": 91651058, "body": "In that case you can use the 1st option in my second comment. Send the form data with JS using <a href=\"https://developer.mozilla.org/en-US/docs/Learn/HTML/Forms/Sending_forms_through_JavaScript\" rel=\"nofollow noreferrer\">XMLHttpRequest</a>."}], "owner": {"reputation": 43, "user_id": 6889344, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a4743b94402677e0bf0504a1f27779?s=128&d=identicon&r=PG&f=1", "display_name": "Maruf Saidov", "link": "https://stackoverflow.com/users/6889344/maruf-saidov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 321, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537032229, "creation_date": 1537024393, "last_edit_date": 1537032229, "question_id": 52346011, "link": "https://stackoverflow.com/questions/52346011/response-to-webpage-with-javascript-in-golang", "title": "response to webpage with javascript in golang", "body": "<p>I have a webpage with login and password forms\nIf login or password are wrong how could I response with javascript alert() or console.log() functions in golang</p>\n\n<pre><code>&lt;body&gt;\n    &lt;!-- LOGIN FORM --&gt;\n    &lt;div class=\"login-page\"&gt;\n        &lt;div class=\"form\"&gt;\n          &lt;form class=\"login-form\"action=\"/login\" method=\"POST\"&gt;\n            &lt;input type=\"text\"   name=\"username\"   placeholder=\"username\"/&gt;\n            &lt;input type=\"password\" name=\"password\" placeholder=\"password\"/&gt;\n            &lt;button type=\"submit\" id=\"send\" value=\"Login\"&gt;Login&lt;/button&gt;\n          &lt;/form&gt;\n        &lt;/div&gt;\n      &lt;/div&gt;\n&lt;/body&gt;\n</code></pre>\n\n<p>GOLANG</p>\n\n<pre><code>func (c *AuthenticationControllers) AdminLogin() http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n\n        switch r.Method {\n        case \"GET\":\n            http.ServeFile(w, r, \"C:/Projects/Go/src/github.com/AlifElectronicQueue/web/template/login.html\")\n        case \"POST\":\n\n            //********AUTHENTICATION PROCESS*********//\n            if loginAns {\n                //Some code\n                http.Redirect(w, r, \"/admin/applications\", 302)\n\n            }  else {\n                http.Redirect(w, r, \"/login\", 302)\n                http.Error(w, http.StatusText(http.StatusForbidden), http.StatusForbidden)\n            } \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537023731, "post_id": 52345833, "comment_id": 91637518, "body": "You&#39;re inserting one row, hence the affected row should be 1 if the insert succeded, or do you expect it to return something else?"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1537023841, "post_id": 52345833, "comment_id": 91637556, "body": "yes, the returned rows should be 1, and the idea to get AffectedRows is to prove that the insert was successful"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537023969, "post_id": 52345833, "comment_id": 91637584, "body": "If the insert was unsuccessful then scanning the account_id through row will return an error."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1537024270, "post_id": 52345833, "comment_id": 91637647, "body": "well, somehow, the insert fails but doesn&#39;t returns an error, so I want to get AffectedRows to double check"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537024653, "post_id": 52345833, "comment_id": 91637735, "body": "How do you know it failed if you&#39;re not getting an error? What&#39;s the value <code>account_id</code> after you call <code>Scan</code>?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537024788, "post_id": 52345833, "comment_id": 91637764, "body": "Just to be clear I don&#39;t think what you look for is possible, retrieving rows and affected rows in one go, so I believe you&#39;ll have to find another solution for your problem."}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1537024812, "post_id": 52345833, "comment_id": 91637767, "body": "I know it fails because it doesn&#39;t insert the record, I test it in <code>psql</code> console"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1537024945, "post_id": 52345833, "comment_id": 91637802, "body": "If <code>Scan</code> doesn&#39;t return an error what&#39;s the value of <code>account_id</code>?"}, {"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1537025451, "post_id": 52345833, "comment_id": 91637924, "body": "@mkopriva, I found a bug in the code, the INSERT statement was being skipped, that&#39;s why the record it wasn&#39;t inserted.  But anyway, it would be nice to have rows affected and the autoincremented filed both returned by the driver"}, {"owner": {"reputation": 474, "user_id": 4063201, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/uU5YK.png?s=128&g=1", "display_name": "monirz", "link": "https://stackoverflow.com/users/4063201/monirz"}, "edited": false, "score": 1, "creation_date": 1537027270, "post_id": 52345833, "comment_id": 91638376, "body": "The <code>sql.Result</code> interface has the method called <code>LastInsertId()</code>, I think you missed it."}], "owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 29, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1537023098, "creation_date": 1537023098, "question_id": 52345833, "link": "https://stackoverflow.com/questions/52345833/how-to-get-affectedrows-and-row-at-the-same-time", "title": "How to get AffectedRows and Row at the same time?", "body": "<p>This is my query:</p>\n\n<pre><code>query=\"INSERT INTO account(address,owner_id,deleted,block_del,ts_created,block_created) VALUES($1,$2,$3,$4,$5,$6) RETURNING account_id\";\n</code></pre>\n\n<p>After executing the query I want to know both things: <code>affected rows</code> + the <code>account_id</code> serial field that has been incremented during <code>INSERT</code>. </p>\n\n<p>How can I do it?</p>\n\n<p>If I use <code>db.Exec()</code> I will only get affected rows:</p>\n\n<pre><code>result,err := db.Exec(query, addr_str, owner_id, deleted, block_del, timestamp, block_num);\naffected_rows,err:=result.RowsAffected()\n</code></pre>\n\n<p>If I use <code>db.QueryRow()</code> I can get the <code>account_id</code> but I will not be able to get AffectedRows:</p>\n\n<pre><code>row:=db.QueryRow(query,addr_str,owner_id,deleted,block_del,timestamp,block_num);\naccount_id,err:=row.Scan(&amp;account_id)\n</code></pre>\n\n<p>But how to get both of them  ??? Is there any function what will return <code>db.Row</code> and <code>db.Result</code> at the same time ?</p>\n"}, {"tags": ["go", "linked-list"], "comments": [{"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 0, "creation_date": 1537020304, "post_id": 52345395, "comment_id": 91636651, "body": "You have your next in <code>input2</code> and yet you try to use the next of <code>input</code> to access <code>input2</code>."}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1537020373, "post_id": 52345395, "comment_id": 91636666, "body": "You only changed the value of a local variable / function argument in <code>test</code>."}, {"owner": {"reputation": 5, "user_id": 10257645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GywQMqVUyS4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOgvyU2UyWSNJwH5VgM3ruhIkhaeA/mo/photo.jpg?sz=128", "display_name": "BlockMo", "link": "https://stackoverflow.com/users/10257645/blockmo"}, "reply_to_user": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 0, "creation_date": 1537020797, "post_id": 52345395, "comment_id": 91636797, "body": "@Ullaakut, sorry i correct my post, my question is why i input address to function, and change the linked list, but nothing changed."}, {"owner": {"reputation": 5, "user_id": 10257645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GywQMqVUyS4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOgvyU2UyWSNJwH5VgM3ruhIkhaeA/mo/photo.jpg?sz=128", "display_name": "BlockMo", "link": "https://stackoverflow.com/users/10257645/blockmo"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1537020967, "post_id": 52345395, "comment_id": 91636836, "body": "@bereal, but i put the address to the function, not value, why it won&#39;t change."}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 1, "creation_date": 1537021121, "post_id": 52345395, "comment_id": 91636877, "body": "@BlockMo the local variable <code>head</code> is a pointer or address, indeed. By assigning to this variable, you change the value of the pointer, making the variable pointing to something else. The underlying data does not change."}], "answers": [{"tags": [], "owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "is_accepted": true, "score": 0, "last_activity_date": 1537020445, "creation_date": 1537020445, "answer_id": 52345462, "question_id": 52345395, "link": "https://stackoverflow.com/questions/52345395/linked-list-doesnt-change-in-golang/52345462#52345462", "title": "Linked list doesn&#39;t change in Golang", "body": "<p>Here it is fixed:</p>\n\n<p><a href=\"https://play.golang.org/p/VUeqh71nEaN\" rel=\"nofollow noreferrer\">https://play.golang.org/p/VUeqh71nEaN</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype ListNode struct {\n    Val  int\n    Next *ListNode\n}\n\nfunc test(head *ListNode) *ListNode {\n    head = head.Next\n    return head\n}\n\nfunc main() {\n\n    var input1, input2 ListNode\n    input1 = ListNode{Val: 1, Next: &amp;input2}\n    input2 = ListNode{Val: 2, Next: &amp;input1}\n\n    input := test(&amp;input1)\n    fmt.Println(input.Val)\n}\n</code></pre>\n\n<p>Outputs</p>\n\n<p><code>2</code></p>\n\n<p>The problems were that you don't use the return value of your <code>test</code> function, and you passed a node that doesn't have a <code>Next</code> value.</p>\n"}], "owner": {"reputation": 5, "user_id": 10257645, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GywQMqVUyS4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaOgvyU2UyWSNJwH5VgM3ruhIkhaeA/mo/photo.jpg?sz=128", "display_name": "BlockMo", "link": "https://stackoverflow.com/users/10257645/blockmo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "accepted_answer_id": 52345462, "answer_count": 1, "score": 0, "last_activity_date": 1537116739, "creation_date": 1537020005, "last_edit_date": 1537116739, "question_id": 52345395, "link": "https://stackoverflow.com/questions/52345395/linked-list-doesnt-change-in-golang", "title": "Linked list doesn&#39;t change in Golang", "body": "<p>My question is that when I made the <strong>head</strong> point to <strong>head.next</strong>\n<p>the <strong>input.Val</strong> still remains 1 instead of 2(which is the next value).</p>\n\n<pre><code>type ListNode struct {\n    Val  int\n    Next *ListNode\n}\n\nfunc test(head *ListNode) *ListNode {\n    head = head.Next\n    return head\n}\n\nfunc main() {\n\n    var input, input2 ListNode\n    input = ListNode{Val: 1, Next: &amp;input2}}\n    input2 = ListNode{Val: 2} \n\n    test(&amp;input)\n    fmt.Println(input.Val)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "edited": false, "score": 0, "creation_date": 1537022257, "post_id": 52345294, "comment_id": 91637152, "body": "I would recommend structuring your query so these types of errors don&#39;t occur, but regardless... what&#39;s the underlying database technology?"}, {"owner": {"reputation": 63, "user_id": 7650072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5ea407eaaf693fc2b80ee99bb2b4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mou", "link": "https://stackoverflow.com/users/7650072/mou"}, "reply_to_user": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "edited": false, "score": 0, "creation_date": 1537022991, "post_id": 52345294, "comment_id": 91637335, "body": "The database is MySQL/PostgreSQL - structuring the queries is very hard since the input is random - but I will give it a try, thanks for the tip!"}, {"owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "edited": false, "score": 0, "creation_date": 1537039663, "post_id": 52345294, "comment_id": 91641645, "body": "Are your inserts failing due to the <code>INSERT</code>ed values conflicting with constraints on other rows already present in the database (e.g. a <code>UNIQUE</code> index), or for some other issue?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1537043258, "post_id": 52345294, "comment_id": 91642572, "body": "The point of the transaction is to ensure that ALL or NONE of the statements execute. This is not what you want. Don&#39;t bother with the transaction."}, {"owner": {"reputation": 63, "user_id": 7650072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5ea407eaaf693fc2b80ee99bb2b4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mou", "link": "https://stackoverflow.com/users/7650072/mou"}, "edited": false, "score": 0, "creation_date": 1537046575, "post_id": 52345294, "comment_id": 91643244, "body": "The data is not relevant for each other - the database is simply a storage and the data is not in relation with each other. I thought about using no transactions - does it make a difference performance wise? Thanks for the anwers :)"}, {"owner": {"reputation": 333, "user_id": 8989452, "user_type": "registered", "profile_image": "https://graph.facebook.com/1517851688282463/picture?type=large", "display_name": "Krzysztof Skolimowski", "link": "https://stackoverflow.com/users/8989452/krzysztof-skolimowski"}, "edited": false, "score": 0, "creation_date": 1537103933, "post_id": 52345294, "comment_id": 91653673, "body": "Do you need to do everything in one transaction?  It is a definition of transaction, that everything fails if one operation goes wrong.  Performance wise it does matter, but you can use multiple goroutines to mitigate that."}], "answers": [{"tags": [], "owner": {"reputation": 269, "user_id": 3142303, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/39f23a408e48229147f4336d765dd649?s=128&d=identicon&r=PG&f=1", "display_name": "Jack_125", "link": "https://stackoverflow.com/users/3142303/jack-125"}, "is_accepted": false, "score": 2, "last_activity_date": 1537115236, "last_edit_date": 1537115236, "creation_date": 1537111062, "answer_id": 52355526, "question_id": 52345294, "link": "https://stackoverflow.com/questions/52345294/golang-database-transaction-continue-if-single-exec-statement-fails/52355526#52355526", "title": "golang database transaction: continue if single exec statement fails", "body": "<p>For Postgresql, you can use <strong>ON CONFLICT DO NOTHING</strong></p>\n\n<p>I have tried the code below with postgresql db on my side and it ignores the insert line that has error. I made few other changes to try on my side. You can ignore my other changes. </p>\n\n<pre><code>func insert(db *sql.DB, values []string) error {\n    tx, err := db.Begin()\n    if err != nil {\n        return err\n    }\n    defer tx.Commit()\n    stmt, err := tx.Prepare(\"INSERT INTO foo (  foo_col) VALUES ($1) ON CONFLICT DO NOTHING\")\n\n    if err != nil {\n        fmt.Println(\"errro at stmt\", err)\n        return err\n    }\n\n    defer stmt.Close()\n\n    for _, value := range values {\n        _, err = stmt.Exec(value)\n        if err != nil {\n            fmt.Println(value, err)\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>For mysql, you can use <strong>INSERT IGNORE</strong></p>\n\n<pre><code>stmt, err := tx.Prepare(\"INSERT IGNORE INTO foo (  foo_col) VALUES ($1) \")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 63, "user_id": 7650072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5ea407eaaf693fc2b80ee99bb2b4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mou", "link": "https://stackoverflow.com/users/7650072/mou"}, "is_accepted": true, "score": 1, "last_activity_date": 1537481670, "creation_date": 1537481670, "answer_id": 52434074, "question_id": 52345294, "link": "https://stackoverflow.com/questions/52345294/golang-database-transaction-continue-if-single-exec-statement-fails/52434074#52434074", "title": "golang database transaction: continue if single exec statement fails", "body": "<p>My solution for the problem looks like this: </p>\n\n<ul>\n<li>Do not create a single transaction and add all statements into it, instead just run it without creating transactions.</li>\n<li>As the values are read in, spawn new go routines and let the transaction run parallelized (be careful with connection limits). </li>\n<li>Without parallelization, the performance dropped about 30% (from 20s for 25k values to 30s - we did not use parallelization before). </li>\n<li>With parallelization, the performance increased about 4 times (to 5 seconds) - just be careful you stay within the connection ranges</li>\n</ul>\n"}], "owner": {"reputation": 63, "user_id": 7650072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4d5ea407eaaf693fc2b80ee99bb2b4d5?s=128&d=identicon&r=PG&f=1", "display_name": "Mou", "link": "https://stackoverflow.com/users/7650072/mou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1404, "favorite_count": 1, "accepted_answer_id": 52434074, "answer_count": 2, "score": 4, "last_activity_date": 1537481670, "creation_date": 1537019251, "question_id": 52345294, "link": "https://stackoverflow.com/questions/52345294/golang-database-transaction-continue-if-single-exec-statement-fails", "title": "golang database transaction: continue if single exec statement fails", "body": "<p>I am writing a Go app which should insert thousands of values from a file into a database. This works fine, as long as all values can be inserted into the database. If one of the queries fails, all queries afterwards fail because of <code>pq: : current transaction is aborted, commands ignored until end of transaction block</code></p>\n\n<p>I want to insert all elements and if the insert of an element fails, it should be skipped and the other elements should be inserted.</p>\n\n<p>My Code:</p>\n\n<pre><code>func (db *Database) Insert(values []Value) (transerr error) {\n    tx, err := db.Begin()\n    if transerr != nil {\n        return nil, err\n    }\n    defer func() {\n        if err != nil {\n            tx.Rollback()\n        } else {\n            tx.Commit()\n        }\n    }\n    stmt, err := tx.Prepare(\"INSERT INTO foo VALUES (?)\")\n    if err != nil {\n        return err\n    }\n\n    defer stmt.Close()\n\n    for _, value : range values {\n        _, err = stmt.Exec(value)\n        if err != nil {\n            log.Error(err)\n        }\n    }\n    return nil\n}\n</code></pre>\n\n<p>I tried to add a tx.Rollback() in case a stmt.Exec fails - however this results in <code>sql: statement is closed</code>. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537018752, "post_id": 52345205, "comment_id": 91636266, "body": "What is the error?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537018788, "post_id": 52345205, "comment_id": 91636273, "body": "You probably just need <code>http.HandlerFunc(...)</code> rather than <code>http.Handler(...)</code>, but without showing your actual error, that&#39;s only a guess."}, {"owner": {"reputation": 779, "user_id": 5082396, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ecb90aafcaa063edf9fe1161289be637?s=128&d=identicon&r=PG&f=1", "display_name": "pro", "link": "https://stackoverflow.com/users/5082396/pro"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537020974, "post_id": 52345205, "comment_id": 91636839, "body": "I added the error message."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537021172, "post_id": 52345205, "comment_id": 91636885, "body": "My guess was right. Use <code>http.HandlerFunc()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1537021324, "creation_date": 1537021324, "answer_id": 52345577, "question_id": 52345205, "link": "https://stackoverflow.com/questions/52345205/returning-a-handler-from-a-struct-method-in-golang-gives-error/52345577#52345577", "title": "Returning a handler from a struct method in Golang gives error", "body": "<p>You cannot arbitrarily convert a function to an <code>http.Handler</code>, but the <code>http</code> package does provide a convenient <code>http.Handler</code> struct type, which satisfies the <code>http.Handler</code> interface, and you can return an instance of this type easily:</p>\n\n<pre><code>func (c Controller) GetItems(db *sql.DB) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n         // ...\n    })\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 0, "creation_date": 1617784227, "post_id": 52346650, "comment_id": 118399922, "body": "This works, but I think it is better to keep <code>http.HandlerFunc</code> as an implementation detail (just a tool to create an <code>http.Handler</code>) and only expose <code>http.Handler</code> in the public interface of the package."}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 0, "creation_date": 1617784623, "post_id": 52346650, "comment_id": 118400091, "body": "From the <a href=\"https://golang.org/pkg/net/http/#HandlerFunc\" rel=\"nofollow noreferrer\">documentation</a>: <i>The HandlerFunc type is an adapter to allow the use of ordinary functions as HTTP handlers.</i>"}], "tags": [], "owner": {"reputation": 779, "user_id": 5082396, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ecb90aafcaa063edf9fe1161289be637?s=128&d=identicon&r=PG&f=1", "display_name": "pro", "link": "https://stackoverflow.com/users/5082396/pro"}, "is_accepted": false, "score": 0, "last_activity_date": 1537028945, "creation_date": 1537028945, "answer_id": 52346650, "question_id": 52345205, "link": "https://stackoverflow.com/questions/52345205/returning-a-handler-from-a-struct-method-in-golang-gives-error/52346650#52346650", "title": "Returning a handler from a struct method in Golang gives error", "body": "<p>This actually works:</p>\n\n<pre><code>func (c Controller) GetItems(db *sql.DB) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n          //...\n  } \n}\n</code></pre>\n\n<p>I have changed the return type to <code>http.HandlerFunc</code>and removed the wrapper from the returned function.</p>\n"}], "owner": {"reputation": 779, "user_id": 5082396, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/ecb90aafcaa063edf9fe1161289be637?s=128&d=identicon&r=PG&f=1", "display_name": "pro", "link": "https://stackoverflow.com/users/5082396/pro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 612, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1537028945, "creation_date": 1537018589, "last_edit_date": 1537021362, "question_id": 52345205, "link": "https://stackoverflow.com/questions/52345205/returning-a-handler-from-a-struct-method-in-golang-gives-error", "title": "Returning a handler from a struct method in Golang gives error", "body": "<p>I am trying to return a handler function from a Controller </p>\n\n<p>In my <code>controllers/item.go</code> file:</p>\n\n<pre><code>package controllers\n\nimport (\n // ...\n)\n\ntype Controller struct{}\n\nfunc (c Controller) GetItems(db *sql.DB) http.Handler {\n    return http.Handler(func(w http.ResponseWriter, r *http.Request) {\n      // ...\n    })\n}\n</code></pre>\n\n<p>In my <code>main.go</code> file:</p>\n\n<pre><code>func main() {\n    db = db.Connect()\n    router := mux.NewRouter()\n\n    controllers := controllers.Controller{}\n\n    router.HandleFunc(\"/items\", controllers.GetItems(db)).Methods(\"GET\")\n}\n</code></pre>\n\n<p>You can see I am using <code>mux</code>. My problem is I have not been able to return the handler function. I keep getting this error:</p>\n\n<pre><code> cannot convert func literal (type func(http.ResponseWriter, *http.Request)) to type http.Handler:\n    func(http.ResponseWriter, *http.Request) does not implement http.Handler (missing ServeHTTP method)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1537013685, "post_id": 52344298, "comment_id": 91635058, "body": "Even though you can create a variable of an anonymous struct, you cannot make that type implement any interfaces, so you&#39;ll have to declare a named type. I don&#39;t think that&#39;s a big loss, tbh."}, {"owner": {"reputation": 15156, "user_id": 241453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f8b43ba72c2a51ea4904027af406ae23?s=128&d=identicon&r=PG", "display_name": "mstrap", "link": "https://stackoverflow.com/users/241453/mstrap"}, "reply_to_user": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 0, "creation_date": 1537014221, "post_id": 52344298, "comment_id": 91635181, "body": "Can that named type still be &quot;local&quot; to the current method? Can you please give an example of how to do that, given the local variable <code>file</code>? I&#39;m new to Go, so my questions may sound quite Java-ish..."}, {"owner": {"reputation": 24772, "user_id": 770830, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/a3943e02574f64dabaa71603264c9c28?s=128&d=identicon&r=PG", "display_name": "bereal", "link": "https://stackoverflow.com/users/770830/bereal"}, "edited": false, "score": 1, "creation_date": 1537014624, "post_id": 52344298, "comment_id": 91635259, "body": "Type <code>io.File</code> does not exist. On the other hand, type <a href=\"https://golang.org/pkg/os/#File\" rel=\"nofollow noreferrer\"><code>*os.File</code></a> already implements <code>io.ReadCloser</code>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537014659, "post_id": 52344298, "comment_id": 91635271, "body": "You can&#39;t write an anonymous class in Go, because Go doesn&#39;t support classes at all."}, {"owner": {"reputation": 15156, "user_id": 241453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f8b43ba72c2a51ea4904027af406ae23?s=128&d=identicon&r=PG", "display_name": "mstrap", "link": "https://stackoverflow.com/users/241453/mstrap"}, "edited": false, "score": 1, "creation_date": 1537016343, "post_id": 52344298, "comment_id": 91635665, "body": "The reason why I am asking this question is to find a reasonable piece of code which is equivalent to the given Java code snippet. Again, please excuse my &quot;Java-ish&quot; writing, but translating from Java to Go is actually the heart of this question."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1537016591, "post_id": 52344298, "comment_id": 91635733, "body": "Translating statement-for-statement, or concept-for-concept between languages which take different approaches, is usually a bad idea. (Between C# and Java it may work, for instance, since they&#39;re very similar, conceptually)  A better approach is usually to just re-implement the same high-level functionality, without regard for how the original language accomplished it."}], "answers": [{"tags": [], "owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "is_accepted": false, "score": 2, "last_activity_date": 1537022840, "last_edit_date": 1537022840, "creation_date": 1537022079, "answer_id": 52345670, "question_id": 52344298, "link": "https://stackoverflow.com/questions/52344298/how-to-write-something-equivalent-to-an-anonymous-class-in-java/52345670#52345670", "title": "How to write something equivalent to an anonymous class in Java?", "body": "<p>One way could be to create your own type that combines a <code>io.Reader</code> and \na <code>io.Closer</code> and implements the <code>io.ReadCloser</code> interface. Something like this:</p>\n\n<pre><code>type ReadCloseCombiner struct {\n    io.Reader\n    io.Closer\n}\n\nfunc (rcc ReadCloseCombiner) Read(p []byte) (n int, err error) {\n    return rcc.Reader.Read(p)\n}\n\nfunc (rcc ReadCloseCombiner) Close() error {\n    return rcc.Closer.Close()\n}\n</code></pre>\n\n<p>And use it like this:</p>\n\n<pre><code>var file *os.File\nfile = ... // some File which needs to be closed\n\nvar reader io.Reader\nreader = ... // get Reader from somewhere\n\nvar readCloser io.ReadCloser\nreadCloser = ReadCloseCombiner{reader, file}\n\n// now pass readCloser around as needed\nreadCloser.Read(...)\nreadCloser.Close()\n</code></pre>\n\n<p>If you want something more flexible i would concider having a type that take a read and close function instead and then you could pass it anonymous functions (or even <code>reader.Read</code>/<code>file.Close</code> in your case). </p>\n"}, {"comments": [{"owner": {"reputation": 3889, "user_id": 100405, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/924e4500ab6bdce291ab6346099ede26?s=128&d=identicon&r=PG", "display_name": "weima", "link": "https://stackoverflow.com/users/100405/weima"}, "edited": false, "score": 0, "creation_date": 1537412891, "post_id": 52416927, "comment_id": 91777219, "body": "reason this is already not in the standard library <a href=\"https://github.com/golang/go/issues/24370\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/24370</a>"}], "tags": [], "owner": {"reputation": 3889, "user_id": 100405, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/924e4500ab6bdce291ab6346099ede26?s=128&d=identicon&r=PG", "display_name": "weima", "link": "https://stackoverflow.com/users/100405/weima"}, "is_accepted": true, "score": 2, "last_activity_date": 1537412416, "creation_date": 1537412416, "answer_id": 52416927, "question_id": 52344298, "link": "https://stackoverflow.com/questions/52344298/how-to-write-something-equivalent-to-an-anonymous-class-in-java/52416927#52416927", "title": "How to write something equivalent to an anonymous class in Java?", "body": "<p>taking a hint from <code>http.HandlerFunc</code> , i could think of the following</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n    \"strings\"\n)\n\n// ReadData reads data from an io.Reader\nfunc ReadData(r io.Reader) {\n    buf := new(bytes.Buffer)\n    buf.ReadFrom(r)\n    s := buf.String()\n    fmt.Printf(\"read : %s \\n\", s)\n}\n\n// ReaderFunc takes a function and returns io.Reader\ntype ReaderFunc func([]byte) (int, error)\n\nfunc (r ReaderFunc) Read(b []byte) (int, error) {\n    return r(b)\n}\n\nfunc main() {\n    // invoking ReadData with a regular io.Reader\n    r := strings.NewReader(\"data 123\")\n    ReadData(r)\n\n    // invoking ReadData with an anonymous io.Reader\n    r = strings.NewReader(\"data 456\")\n    ReadData(ReaderFunc(func(b []byte) (int, error) {\n        return r.Read(b)\n    }))\n}\n</code></pre>\n"}], "owner": {"reputation": 15156, "user_id": 241453, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/f8b43ba72c2a51ea4904027af406ae23?s=128&d=identicon&r=PG", "display_name": "mstrap", "link": "https://stackoverflow.com/users/241453/mstrap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 52416927, "answer_count": 2, "score": 0, "last_activity_date": 1537412416, "creation_date": 1537011191, "last_edit_date": 1537016451, "question_id": 52344298, "link": "https://stackoverflow.com/questions/52344298/how-to-write-something-equivalent-to-an-anonymous-class-in-java", "title": "How to write something equivalent to an anonymous class in Java?", "body": "<p>This is more of a generic Go question related to interfaces/functions/closures/types/..., but with a concrete use case of performing I/O.</p>\n\n<p>Given an <code>io.Reader</code> variable I want to create an <code>io.ReadCloser</code> with a custom <code>Close()</code> implementation.</p>\n\n<pre><code>var file os.File\nfile = ... // some File which needs to be closed\n\nvar reader io.Reader\nreader = ... // get Reader from somewhere\n\nvar readCloser io.ReadCloser\nreadCloser = ... // how to create a ReadCloser here?\n</code></pre>\n\n<p>In Java, I would write something like:</p>\n\n<pre><code>readCloser = new io.ReadCloser() {\n    Read(p []byte) {\n        reader.Read(p);\n    }\n\n    Close() {\n        // my custom close implementation\n        file.Close()\n    }    \n}\n\n// now pass readCloser around as needed\n</code></pre>\n\n<p>How to do that with Go?</p>\n"}, {"tags": ["docker", "go", "google-api", "certificate", "alpine"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1537002946, "post_id": 52341878, "comment_id": 91632769, "body": "In the Docker image, install the CA bundle for your distribution. The package is typically called <code>ca-certificates</code>."}], "answers": [{"comments": [{"owner": {"reputation": 725, "user_id": 5229299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUTnO.jpg?s=128&g=1", "display_name": "Robin Huy", "link": "https://stackoverflow.com/users/5229299/robin-huy"}, "edited": false, "score": 0, "creation_date": 1537001526, "post_id": 52342963, "comment_id": 91632461, "body": "When I run <code>update-ca-certificates</code>, it displays warning <code>WARNING: ca-cert-GIAG2.pem does not contain exactly one certificate or CRL: skipping</code>"}, {"owner": {"reputation": 2292, "user_id": 6051596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CDh6.jpg?s=128&g=1", "display_name": "Atmanirbhar Bharat", "link": "https://stackoverflow.com/users/6051596/atmanirbhar-bharat"}, "reply_to_user": {"reputation": 725, "user_id": 5229299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUTnO.jpg?s=128&g=1", "display_name": "Robin Huy", "link": "https://stackoverflow.com/users/5229299/robin-huy"}, "edited": false, "score": 0, "creation_date": 1537018332, "post_id": 52342963, "comment_id": 91636155, "body": "@RobinHuy , i think the full message that it gives is this                      Updating certificates in /etc/ssl/certs... WARNING: GIAG2.pem does not contain a certificate or CRL: skipping 1 added, 0 removed; done.                                                                                                                                  The certificate is added , did you try accessing the API again after this , i think it will work."}, {"owner": {"reputation": 725, "user_id": 5229299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUTnO.jpg?s=128&g=1", "display_name": "Robin Huy", "link": "https://stackoverflow.com/users/5229299/robin-huy"}, "edited": false, "score": 0, "creation_date": 1537154919, "post_id": 52342963, "comment_id": 91665130, "body": "It&#39;s still not working. The full message is <code>WARNING: ca-certificates.crt does not contain exactly one certificate or CRL: skipping WARNING: ca-cert-GIAG2.pem does not contain exactly one certificate or CRL: skipping</code>. I copy file <code>GIAG2.crt</code> as your suggestion, but it&#39;s warning error at <code>ca-cert-GIAG2.pem</code>."}], "tags": [], "owner": {"reputation": 2292, "user_id": 6051596, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7CDh6.jpg?s=128&g=1", "display_name": "Atmanirbhar Bharat", "link": "https://stackoverflow.com/users/6051596/atmanirbhar-bharat"}, "is_accepted": false, "score": 1, "last_activity_date": 1536999516, "creation_date": 1536999516, "answer_id": 52342963, "question_id": 52341878, "link": "https://stackoverflow.com/questions/52341878/cannot-exchange-accesstoken-from-google-api-inside-docker-container/52342963#52342963", "title": "Cannot exchange AccessToken from Google API inside Docker container", "body": "<p>You will need to add the Google Issuing CA certificate to the trusted cert store of the docker image.</p>\n\n<p>The Google CA cert is this <a href=\"https://pki.google.com/GIAG2.crt\" rel=\"nofollow noreferrer\">https://pki.google.com/GIAG2.crt</a> .</p>\n\n<p>More info on the certificate can be found from <a href=\"https://pki.google.com/\" rel=\"nofollow noreferrer\">here</a></p>\n\n<p>Then within the Dockerfile , you will need to do something like this</p>\n\n<pre><code>cp GIAG2.crt /usr/local/share/ca-certificates/GIAG2.crt\nupdate-ca-certificates\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 725, "user_id": 5229299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUTnO.jpg?s=128&g=1", "display_name": "Robin Huy", "link": "https://stackoverflow.com/users/5229299/robin-huy"}, "is_accepted": true, "score": 2, "last_activity_date": 1537327035, "creation_date": 1537327035, "answer_id": 52397492, "question_id": 52341878, "link": "https://stackoverflow.com/questions/52341878/cannot-exchange-accesstoken-from-google-api-inside-docker-container/52397492#52397492", "title": "Cannot exchange AccessToken from Google API inside Docker container", "body": "<p>The problem is not caused by Go but Alpine image.</p>\n\n<p>Default Alpine image does not have certificates so the app cannot call to https address (this case is <a href=\"https://accounts.google.com/o/oauth2/token\" rel=\"nofollow noreferrer\">https://accounts.google.com/o/oauth2/token</a>).</p>\n\n<p>To fix this problem, install 2 packages <code>openssl</code> and <code>ca-certificates</code>. Example in Dockerfile:</p>\n\n<pre><code>apk add --no-cache ca-certificates openssl\n</code></pre>\n"}], "owner": {"reputation": 725, "user_id": 5229299, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GUTnO.jpg?s=128&g=1", "display_name": "Robin Huy", "link": "https://stackoverflow.com/users/5229299/robin-huy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1564, "favorite_count": 1, "accepted_answer_id": 52397492, "answer_count": 2, "score": 4, "last_activity_date": 1537327035, "creation_date": 1536989260, "last_edit_date": 1537325018, "question_id": 52341878, "link": "https://stackoverflow.com/questions/52341878/cannot-exchange-accesstoken-from-google-api-inside-docker-container", "title": "Cannot exchange AccessToken from Google API inside Docker container", "body": "<p>I have a web app written in Go, use oauth2 (package <code>golang.org/x/oauth2</code>) to sign user in by Google (follow this tutorial <a href=\"https://developers.google.com/identity/sign-in/web/server-side-flow\" rel=\"nofollow noreferrer\">https://developers.google.com/identity/sign-in/web/server-side-flow</a>).</p>\n\n<p>When I test app on local, it works fine but when I deploy app and run inside a Docker container (base on <code>alpine:latest</code>, run binary file), it has an error: \n<code>Post https://accounts.google.com/o/oauth2/token: x509: certificate signed by unknown authority\n</code></p>\n\n<p>Here is my code to exchange the accessToken:</p>\n\n<pre><code>ctx = context.Background()\n\nconfig := &amp;oauth2.Config{\n    ClientID:     config.GoogleClientId,\n    ClientSecret: config.GoogleClientSecret,\n    RedirectURL:  config.GoogleLoginRedirectUrl,\n    Endpoint:     google.Endpoint,\n    Scopes:       []string{\"email\", \"profile\"},\n}\n\naccessToken, err := config.Exchange(ctx, req.Code)\nif err != nil {\n    log.Println(err.Error())   // Error here\n}\n</code></pre>\n"}, {"tags": ["unit-testing", "testing", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1536991045, "post_id": 52341722, "comment_id": 91630618, "body": "If these files are not part of the build than they are probably excluded already by a build tag and would not show up in the cover profile. If they do they are compiled and thus should be part of the line coverage. Note that line coverage as a single number is meaningless."}, {"owner": {"reputation": 142, "user_id": 6906431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29be39e05f003a1461622d69bff3e65d?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky Sterling", "link": "https://stackoverflow.com/users/6906431/ricky-sterling"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1536993671, "post_id": 52341722, "comment_id": 91631045, "body": "These files are included in build but since they are just defining the constants and interface and are mock files so i didnt write test cases for those files.Can you throw some more light on cover.out?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1537084066, "post_id": 52341722, "comment_id": 91649092, "body": "Type definitions and constants are not counted during test coverage. View the coverprofile. (You probably but these into the relevant files anyway.)"}, {"owner": {"reputation": 142, "user_id": 6906431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29be39e05f003a1461622d69bff3e65d?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky Sterling", "link": "https://stackoverflow.com/users/6906431/ricky-sterling"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1537088032, "post_id": 52341722, "comment_id": 91650003, "body": "you see this command is used for testing by Sonarcube go test ./... -v -coverprofile=cover.out .Some senior guy told me to play around with &#39;cover.out&#39; to exclude those files but i didnt find any resource on that.Do you have any idea about this?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1537089461, "post_id": 52341722, "comment_id": 91650275, "body": "I&#39;m telling you to keep those files. You may cite me."}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537001274, "post_id": 52341918, "comment_id": 91632399, "body": "This does not answer the question."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1537022026, "post_id": 52341918, "comment_id": 91637108, "body": "Your new answer still doesn&#39;t answer the question."}], "tags": [], "owner": {"reputation": 536, "user_id": 3956589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39365ac79e46dc67ace5d93a627a068d?s=128&d=identicon&r=PG&f=1", "display_name": "whitespace", "link": "https://stackoverflow.com/users/3956589/whitespace"}, "is_accepted": false, "score": 0, "last_activity_date": 1540308772, "last_edit_date": 1540308772, "creation_date": 1536989805, "answer_id": 52341918, "question_id": 52341722, "link": "https://stackoverflow.com/questions/52341722/how-to-test-a-package-in-go-excluding-some-files/52341918#52341918", "title": "How to test a package in go excluding some files?", "body": "<p><s> You can add all the tests you want to run in my_test.go and run <code>go test my_test.go</code>. </s></p>\n\n<p>you can use <code>-run=&lt;regex&gt;</code> flag. This possible when you have a common Prefix, Suffix or term in the names of the tests you want to run. I will update a better answer.</p>\n\n<p>hey, if anyone still ends up here. I tried building a command line application. Its still rough around the edges. It doesn't import all the packages. But it does what you required here. It will exclude files. Based on contents of a <code>.testignore</code> file.</p>\n\n<p>here is the link <a href=\"https://github.com/kurianCoding/ko\" rel=\"nofollow noreferrer\">https://github.com/kurianCoding/ko</a> </p>\n"}], "owner": {"reputation": 142, "user_id": 6906431, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29be39e05f003a1461622d69bff3e65d?s=128&d=identicon&r=PG&f=1", "display_name": "Ricky Sterling", "link": "https://stackoverflow.com/users/6906431/ricky-sterling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1311, "favorite_count": 0, "closed_date": 1537008076, "answer_count": 1, "score": 1, "last_activity_date": 1540308772, "creation_date": 1536987746, "last_edit_date": 1536988052, "question_id": 52341722, "link": "https://stackoverflow.com/questions/52341722/how-to-test-a-package-in-go-excluding-some-files", "closed_reason": "Duplicate", "title": "How to test a package in go excluding some files?", "body": "<p>I have folder structure somewhat like this.</p>\n\n<pre><code>\u251c\u2500\u2500 executor\n|   \u251c\u2500\u2500 executor_test.go\n|   |\u2500\u2500 executor.go\n|   |--excutor_mock.go\n|   |--errors.go\n|   |--app.go \n\u251c\u2500\u2500 _includes\n|   \u251c\u2500\u2500 xyz.go\n|   \u2514\u2500\u2500 abc.go\n\u251c\u2500\u2500vendor\n</code></pre>\n\n<p>executor_test.go contains all the unit test cases for executor.go.</p>\n\n<p>So when I run <code>go test --cover ./...</code> It shows me the coverage package wise which is good but I also want to exclude errors.go, excutor_mock.go and app.go in executor folder from showing up in <code>go test --cover ./...</code>.So is there a way to exclude them?</p>\n"}, {"tags": ["go", "time"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1537003547, "post_id": 52341631, "comment_id": 91632887, "body": "Don&#39;t use <code>for {}</code> to block indefinitely. That&#39;s a busy loop that burns CPU and offers no opportunity for the scheduler to interrupt it. Use an empty select instead: <code>select {}</code>."}, {"owner": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1537006475, "post_id": 52341631, "comment_id": 91633448, "body": "Thanks @Peter. After adding the <code>select {}</code> statement, it worked :)"}], "answers": [{"comments": [{"owner": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "edited": false, "score": 0, "creation_date": 1537002890, "post_id": 52343104, "comment_id": 91632757, "body": "No I tried to move the go routine call to outer level. ie: <code>go StartTimeoutTimer()</code>. Even then the results are same"}], "tags": [], "owner": {"reputation": 88, "user_id": 968024, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0dddc33e0c442a45d4f144ade5342add?s=128&d=identicon&r=PG", "display_name": "YSTai", "link": "https://stackoverflow.com/users/968024/ystai"}, "is_accepted": false, "score": 2, "last_activity_date": 1537001205, "last_edit_date": 1537001205, "creation_date": 1537000669, "answer_id": 52343104, "question_id": 52341631, "link": "https://stackoverflow.com/questions/52341631/time-after-not-getting-triggered-after-specified-time/52343104#52343104", "title": "time.After not getting triggered after specified time", "body": "<p>There is no guarantee that the new goroutine in <code>StartTimeoutTimer()</code> will be executed. <code>StartTimeoutTimer()</code> return immediately after creating the new goroutine.</p>\n\n<p>I think what you want is something like</p>\n\n<pre><code>done := make(chan struct{})\ngo func(){\n    testFunc()\n    close(done)\n}()\nselect {\n    case &lt;- time.After(duration):\n        panic(\"...\")\n    case &lt;- done:\n}\n</code></pre>\n"}], "owner": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1537001205, "creation_date": 1536986805, "last_edit_date": 1536998692, "question_id": 52341631, "link": "https://stackoverflow.com/questions/52341631/time-after-not-getting-triggered-after-specified-time", "title": "time.After not getting triggered after specified time", "body": "<p>I am using <strong>go1.10 darwin/amd64</strong> and trying to set custom timeout for my testing during runtime using the following code snippet.</p>\n\n<p>And I am executing the test using the command by setting Go's timeout to 11m and setting the test's panic timer to 5m and observed that Go timeout value is getting triggered and not mine.</p>\n\n<pre><code>go test github.com/foo -run TestMod -v --race -timeout 11m\n...\n...\n*** Test killed with quit: ran too long (12m0s).\n</code></pre>\n\n<p><strong>Code snippet:</strong></p>\n\n<pre><code>// Returns time.Duration from given string\n// Default return value: \"2h0m0s\"\nfunc GetDuration(timeoutStr string) time.Duration {\n    // Default timeout to 2 hours\n    durationToReturn := (2 * time.Hour)\n\n    pattern, _ := regexp.Compile(\"^([0-9]+)([mhd])$\")\n\n    // Calculates only if valid pattern exists\n    if pattern.MatchString(timeoutStr) {\n        match := pattern.FindStringSubmatch(timeoutStr)\n        timeoutVal, err := strconv.Atoi(match[1])\n        if err != nil {\n            return durationToReturn\n        }\n        timeoutDuration := time.Duration(timeoutVal)\n        switch match[2] {\n        case \"m\":\n            durationToReturn = timeoutDuration * time.Minute\n        case \"h\":\n            durationToReturn = timeoutDuration * time.Hour\n        case \"d\":\n            durationToReturn = timeoutDuration * (time.Hour * 24)\n        }\n    }\n    return durationToReturn\n}\n\n// Starts timeout trigger based on given value in suiteData.Timeout\nfunc StartTimeoutTimer() {\n    timeoutStr := \"5m\"\n    go func() {\n        timeoutDuration := GetDuration(timeoutStr)\n        fmt.Printf(\"Setting timeout of %v from %v\\n\", timeoutDuration, time.Now())\n        &lt;-time.After(timeoutDuration)\n        fmt.Printf(\"Timeout happened at %v\\n\", time.Now())\n        panic(\"Test timed out..\")\n    }()\n}\n\nfunc TestMain(m *testing.M) {\n    StartTimeoutTimer()\n    for {\n    }\n}\n</code></pre>\n"}, {"tags": ["testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "edited": false, "score": 0, "creation_date": 1537165523, "post_id": 52358097, "comment_id": 91667869, "body": "But the code is anyway going to set it to <code>Zero (0)</code> as per the line <code>https:&#47;&#47;github.com&#47;golang&#47;go&#47;blob&#47;adcecbe05ef812bc8ff477dec4&zwnj;&#8203;7720a2cfc273e3&#47;src&#47;t&zwnj;&#8203;esting&#47;testing.go#L2&zwnj;&#8203;71</code>. So passing the same value as part of external params will be behaving the same I guess"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "edited": false, "score": 0, "creation_date": 1537197268, "post_id": 52358097, "comment_id": 91686384, "body": "Right, if you had done <code>-timeout 1</code>, it would be set to <code>1</code> instead and be a very quick timeout."}, {"owner": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "edited": false, "score": 0, "creation_date": 1537247844, "post_id": 52358097, "comment_id": 91702974, "body": "So it doesn&#39;t solve the problem I have mentioned. How to get that working in this version ?"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "edited": false, "score": 0, "creation_date": 1538445704, "post_id": 52358097, "comment_id": 92136473, "body": "I&#39;m not sure I understand your problem. Why do you want to have the test immediately timeout?"}, {"owner": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "edited": false, "score": 0, "creation_date": 1538639716, "post_id": 52358097, "comment_id": 92215723, "body": "All I want is to disable timeout for my go test. But currently if I use <code>-timeout 0</code>, the test still timesout after the default time of <code>10m</code>"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "reply_to_user": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "edited": false, "score": 0, "creation_date": 1540267968, "post_id": 52358097, "comment_id": 92790692, "body": "You could go the other way and do something like <code>100h</code>, which would feel like turning it off."}], "tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": false, "score": -1, "last_activity_date": 1537129444, "creation_date": 1537129444, "answer_id": 52358097, "question_id": 52341550, "link": "https://stackoverflow.com/questions/52341550/test-timeout-0-not-reflected-in-execution/52358097#52358097", "title": "Test &#39;-timeout 0&#39; not reflected in execution", "body": "<p>Its the way the <code>testing</code> library is handling that flag value:</p>\n\n<p><a href=\"https://github.com/golang/go/blob/adcecbe05ef812bc8ff477dec47720a2cfc273e3/src/testing/testing.go#L1299\" rel=\"nofollow noreferrer\">https://github.com/golang/go/blob/adcecbe05ef812bc8ff477dec47720a2cfc273e3/src/testing/testing.go#L1299</a></p>\n\n<p>It only uses the given value if the <code>timeout</code> is greater than <code>0</code>. Therefore, by setting it to 0, it just uses the default (<code>10m</code>).</p>\n"}, {"tags": [], "owner": {"reputation": 527, "user_id": 1195832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc4796b90f1b852b6efce7617f8dad94?s=128&d=identicon&r=PG", "display_name": "mat007", "link": "https://stackoverflow.com/users/1195832/mat007"}, "is_accepted": false, "score": 0, "last_activity_date": 1537282409, "creation_date": 1537282409, "answer_id": 52389341, "question_id": 52341550, "link": "https://stackoverflow.com/questions/52341550/test-timeout-0-not-reflected-in-execution/52389341#52389341", "title": "Test &#39;-timeout 0&#39; not reflected in execution", "body": "<p>It's <code>test.timeout</code> i.e.</p>\n\n<p><code>go test my_module -run TestModule -v --race -test.timeout 0</code></p>\n"}], "owner": {"reputation": 923, "user_id": 2822921, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/a240cddfed87fa7da86cb9e4b1d6ef05?s=128&d=identicon&r=PG&f=1", "display_name": "Ashwin", "link": "https://stackoverflow.com/users/2822921/ashwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 371, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1537282409, "creation_date": 1536985925, "last_edit_date": 1536998681, "question_id": 52341550, "link": "https://stackoverflow.com/questions/52341550/test-timeout-0-not-reflected-in-execution", "title": "Test &#39;-timeout 0&#39; not reflected in execution", "body": "<p>I am using Go <strong>1.9.2</strong> version and invoking the test with timeout disabled using <code>-timeout 0</code> flag. </p>\n\n<p><code>go test my_module -run TestModule -v --race -timeout 0</code></p>\n\n<p>But the test execution is getting timed out after default timeout of 10m.</p>\n\n<blockquote>\n  <p>*** Test killed: ran too long (10m0s). </p>\n</blockquote>\n"}, {"tags": ["sql", "database", "oracle", "go"], "comments": [{"owner": {"reputation": 170, "user_id": 6465854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e2c829785e38dc5485403c02849abb?s=128&d=identicon&r=PG", "display_name": "Rodrigo Brito", "link": "https://stackoverflow.com/users/6465854/rodrigo-brito"}, "edited": false, "score": 0, "creation_date": 1536969621, "post_id": 52340411, "comment_id": 91627972, "body": "The right way is <code>db.Query()</code> or <code>db.Prepare()</code> with <code>stmt.Exec()</code>. But <code>db.Query()</code> does not return only error, whats is your driver? Please, complete with a sample of code with <code>db</code> variable creation. Reference: <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#DB.Query</a>"}, {"owner": {"reputation": 81, "user_id": 7938282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bee0e58b5ae35f9c27531c6053a6805?s=128&d=identicon&r=PG&f=1", "display_name": "Chakrapani Velugubantla", "link": "https://stackoverflow.com/users/7938282/chakrapani-velugubantla"}, "reply_to_user": {"reputation": 170, "user_id": 6465854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e2c829785e38dc5485403c02849abb?s=128&d=identicon&r=PG", "display_name": "Rodrigo Brito", "link": "https://stackoverflow.com/users/6465854/rodrigo-brito"}, "edited": false, "score": 0, "creation_date": 1536985053, "post_id": 52340411, "comment_id": 91629796, "body": "here is my ora driver - <a href=\"https://github.com/mattn/go-oci8\" rel=\"nofollow noreferrer\">github.com/mattn/go-oci8</a>"}, {"owner": {"reputation": 81, "user_id": 7938282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bee0e58b5ae35f9c27531c6053a6805?s=128&d=identicon&r=PG&f=1", "display_name": "Chakrapani Velugubantla", "link": "https://stackoverflow.com/users/7938282/chakrapani-velugubantla"}, "reply_to_user": {"reputation": 170, "user_id": 6465854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e2c829785e38dc5485403c02849abb?s=128&d=identicon&r=PG", "display_name": "Rodrigo Brito", "link": "https://stackoverflow.com/users/6465854/rodrigo-brito"}, "edited": false, "score": 0, "creation_date": 1536985229, "post_id": 52340411, "comment_id": 91629816, "body": "func NewOracleConnection(cfg config.Config, log log.Logger) (Connection, error) { \tvar err error \to := &amp;Oracle{ \t\tDriver:        cfg.DB.Driver, \t\tConnectString: cfg.DB.ConnectString, \t\tlogger:        log, \t} \to.Db, err = sql.Open(o.Driver, o.ConnectString) \tif err != nil { \t\tlog.Log(&quot;event&quot;, &quot;connecting to database&quot;, &quot;err&quot;, err.Error()) \t} \treturn o, err }"}, {"owner": {"reputation": 81, "user_id": 7938282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bee0e58b5ae35f9c27531c6053a6805?s=128&d=identicon&r=PG&f=1", "display_name": "Chakrapani Velugubantla", "link": "https://stackoverflow.com/users/7938282/chakrapani-velugubantla"}, "reply_to_user": {"reputation": 170, "user_id": 6465854, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12e2c829785e38dc5485403c02849abb?s=128&d=identicon&r=PG", "display_name": "Rodrigo Brito", "link": "https://stackoverflow.com/users/6465854/rodrigo-brito"}, "edited": false, "score": 0, "creation_date": 1536985296, "post_id": 52340411, "comment_id": 91629822, "body": "i have tried db.query &amp; Exec. what&#39;s interesting is sqlplus client works fine for the same query with variable substitution but fails with this driver"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1536999498, "post_id": 52340411, "comment_id": 91632048, "body": "For that driver it seems to be <code>:N</code> (<a href=\"https://github.com/mattn/go-oci8/blob/master/oci8Sql_test.go#L1149\" rel=\"nofollow noreferrer\">github.com/mattn/go-oci8/blob/master/oci8Sql_test.go#L1149</a>) where <code>N</code> is the position of the parameter. So in your case something like this should work: <code>db.Query(&quot;select name from table where department = :1 and organisation = :2&quot;, dep, org)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 7938282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bee0e58b5ae35f9c27531c6053a6805?s=128&d=identicon&r=PG&f=1", "display_name": "Chakrapani Velugubantla", "link": "https://stackoverflow.com/users/7938282/chakrapani-velugubantla"}, "edited": false, "score": 0, "creation_date": 1537195945, "post_id": 52341791, "comment_id": 91685442, "body": "thanks a lot..this definitely helps..i  was able to resolve it ..thank you"}], "tags": [], "owner": {"reputation": 150, "user_id": 10294987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSnKT.jpg?s=128&g=1", "display_name": "dakait", "link": "https://stackoverflow.com/users/10294987/dakait"}, "is_accepted": true, "score": 11, "last_activity_date": 1536988525, "creation_date": 1536988525, "answer_id": 52341791, "question_id": 52340411, "link": "https://stackoverflow.com/questions/52340411/golang-sql-query-variable-substituion/52341791#52341791", "title": "Golang SQL query variable substituion", "body": "<p>Parameter Placeholder Syntax (reference: <a href=\"http://go-database-sql.org/prepared.html\" rel=\"noreferrer\">http://go-database-sql.org/prepared.html</a> )</p>\n\n<blockquote>\n  <p>The syntax for placeholder parameters in prepared statements is\n  database-specific. For example, comparing MySQL, PostgreSQL, and\n  Oracle:</p>\n</blockquote>\n\n<pre><code>MySQL               PostgreSQL            Oracle\n=====               ==========            ====== \nWHERE col = ?       WHERE col = $1        WHERE col = :col \nVALUES(?, ?, ?)     VALUES($1, $2, $3)    VALUES(:val1, :val2, :val3)\n</code></pre>\n\n<p>For oracle you need to use :dep, :org as placeholders.</p>\n"}, {"comments": [{"owner": {"reputation": 81, "user_id": 7938282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bee0e58b5ae35f9c27531c6053a6805?s=128&d=identicon&r=PG&f=1", "display_name": "Chakrapani Velugubantla", "link": "https://stackoverflow.com/users/7938282/chakrapani-velugubantla"}, "edited": false, "score": 1, "creation_date": 1537196027, "post_id": 52343459, "comment_id": 91685506, "body": "thanks  a lot ..i was able to resolve it with ur above example and @dakait&#39;s logic stated above"}], "tags": [], "owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "is_accepted": false, "score": 1, "last_activity_date": 1537003961, "creation_date": 1537003961, "answer_id": 52343459, "question_id": 52340411, "link": "https://stackoverflow.com/questions/52340411/golang-sql-query-variable-substituion/52343459#52343459", "title": "Golang SQL query variable substituion", "body": "<p>As @dakait stated, on your prepare statement you should use <code>:</code> placeholders.</p>\n\n<p>So, for completeness, you would get it working with something like:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"log\"\n)\n\n// Output is an example struct\ntype Output struct {\n    Name string\n}\n\nconst (\n    dep = \"abc\"\n    org = \"def\"\n)\n\nfunc main() {\n\n    query := \"SELECT name from table WHERE department= :1 and organisation = :2\"\n\n    q, err := db.Prepare(query)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer q.Close()\n\n    var out Output\n\n    if err := q.QueryRow(dep, org).Scan(&amp;out.Name); err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(out.Name)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 7938282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2bee0e58b5ae35f9c27531c6053a6805?s=128&d=identicon&r=PG&f=1", "display_name": "Chakrapani Velugubantla", "link": "https://stackoverflow.com/users/7938282/chakrapani-velugubantla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4909, "favorite_count": 3, "accepted_answer_id": 52341791, "answer_count": 2, "score": 4, "last_activity_date": 1553358421, "creation_date": 1536968706, "last_edit_date": 1553358421, "question_id": 52340411, "link": "https://stackoverflow.com/questions/52340411/golang-sql-query-variable-substituion", "title": "Golang SQL query variable substituion", "body": "<p>I have sql query that needs variable substitution for better consumption of my <a href=\"https://github.com/go-kit/kit\" rel=\"nofollow noreferrer\">go-kit</a> service.</p>\n\n<p>I have <code>dep</code> &amp; <code>org</code> as user inputs which are part of my rest service, for instance: <code>dep = 'abc'</code> and <code>org = 'def'</code>.</p>\n\n<p>I've tried few things like:</p>\n\n<pre><code>rows, err := db.Query(\n    \"select name from table where department='&amp;dep' and organisation='&amp;org'\",\n)\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>rows, err := db.Query(\n    \"select name from table where department=? and organisation=?\", dep , org,\n)\n</code></pre>\n\n<p>That led to error: <code>sql: statement expects 0 inputs; got 2</code> </p>\n\n<p>Only hard-coded values work and substitution fails .</p>\n\n<p>I haven't found much help from oracle blogs regarding this and wondering if there is any way to approach this.</p>\n"}, {"tags": ["go", "web-scraping"], "answers": [{"tags": [], "owner": {"reputation": 43, "user_id": 2370582, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0be683b0ca39ee540dce03acbe480a94?s=128&d=identicon&r=PG", "display_name": "Vinh Truong", "link": "https://stackoverflow.com/users/2370582/vinh-truong"}, "is_accepted": false, "score": 0, "last_activity_date": 1550597289, "last_edit_date": 1550597289, "creation_date": 1550596202, "answer_id": 54771566, "question_id": 52339920, "link": "https://stackoverflow.com/questions/52339920/how-to-parse-a-string-as-a-dom-element-in-golang-using-colly/54771566#54771566", "title": "How to parse a string as a DOM element in Golang using Colly", "body": "<p>I have not really found a good way to create a <code>HTMLElement</code>, however it is possible that you can convert to a <code>Document</code> object, and do the same query execution (this has nothing to do with <code>gocolly</code> however)</p>\n\n<pre><code>var doc,_ = goquery.NewDocumentFromReader(strings.NewReader(\"&lt;p&gt;&lt;a&gt;Your element&lt;/a&gt;&lt;/p&gt;\"))\ndoc.Filter(\"your selector here\")\n</code></pre>\n"}], "owner": {"reputation": 1271, "user_id": 3773232, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/82fcc37b8b11f63638093d2527f9604a?s=128&d=identicon&r=PG", "display_name": "Miguel", "link": "https://stackoverflow.com/users/3773232/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1550597289, "creation_date": 1536964080, "question_id": 52339920, "link": "https://stackoverflow.com/questions/52339920/how-to-parse-a-string-as-a-dom-element-in-golang-using-colly", "title": "How to parse a string as a DOM element in Golang using Colly", "body": "<p>I'm new with Go and I am using it with <a href=\"https://github.com/gocolly/colly\" rel=\"nofollow noreferrer\">Colly</a> to scrapper a website but I am having some problems with the noscript tag because it is not getting parsed just returned as a string so I want to transform that string into a colly HtmlElement to be able to query it as a normal tag.</p>\n\n<p>How can I do that?</p>\n\n<p>The website I want to scrap is the <strong>Chrome Web Store</strong></p>\n"}, {"tags": ["go", "viper-go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1536964849, "post_id": 52339336, "comment_id": 91627134, "body": "There&#39;s no way to remove things as far as I can tell either, but you could selectively set things. It&#39;s a bit more work, but it may be necessary in this case. Use <code>viper.New</code> to create a new <code>*viper.Viper</code> and load your config, range over the config settings, and for the settings you want enabled, use <code>viper.Set</code> to manually set them on the global <code>Viper</code> instance. This methodology can also be applied to other config sources as necessary, though merging them together will obviously involve more work (ideally you&#39;d use the same priorities for your sources as viper does.) Just an idea."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 7361270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b9bbdc731cdc2755da2c2d8aa00eee7?s=128&d=identicon&r=PG&f=1", "display_name": "makeworld", "link": "https://stackoverflow.com/users/7361270/makeworld"}, "edited": false, "score": 0, "creation_date": 1592942509, "post_id": 52667799, "comment_id": 110604733, "body": "This did not seem to work for me with Viper 1.7.0, the latest version."}], "tags": [], "owner": {"reputation": 26, "user_id": 8065356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84f588fa9c07957e7cf00b2387d2e9a2?s=128&d=identicon&r=PG&f=1", "display_name": "GuidoV", "link": "https://stackoverflow.com/users/8065356/guidov"}, "is_accepted": true, "score": 1, "last_activity_date": 1538749575, "creation_date": 1538749575, "answer_id": 52667799, "question_id": 52339336, "link": "https://stackoverflow.com/questions/52339336/removal-of-key-value-pair-from-viper-config-file/52667799#52667799", "title": "Removal of key-value pair from viper config file", "body": "<p>Try</p>\n\n<pre><code>delete(viper.Get(\"path.to.key\").(map[string]interface{}), \"key\")\n</code></pre>\n\n<p>Example:</p>\n\n<pre><code>[backends]\n  [backends.setibe]\n    [backends.setibe.servers]\n      [backends.setibe.servers.server0]\n      url = \"http://192.168.1.20:80\"\n      weight = 1\n      [backends.setibe.servers.server1]\n      url = \"http://192.168.1.21:80\"\n      weight = 1\n</code></pre>\n\n<p>To delete \"backends.setibe.servers.server1\"</p>\n\n<pre><code>delete(viper.Get(\"backends.setibe.servers\").(map[string]interface{}), \"server2\")\n</code></pre>\n"}], "owner": {"reputation": 598, "user_id": 38413, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/155702d497cd4fe07b166296b5b2fb5f?s=128&d=identicon&r=PG", "display_name": "RoKK", "link": "https://stackoverflow.com/users/38413/rokk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 797, "favorite_count": 0, "accepted_answer_id": 52667799, "answer_count": 1, "score": 1, "last_activity_date": 1538749575, "creation_date": 1536960106, "question_id": 52339336, "link": "https://stackoverflow.com/questions/52339336/removal-of-key-value-pair-from-viper-config-file", "title": "Removal of key-value pair from viper config file", "body": "<p>Is there a way to remove a key/value pair from the loaded config file?</p>\n\n<pre><code>viper.Set(\"key\", nil)\n</code></pre>\n\n<p>does not work</p>\n"}, {"tags": ["go", "beego"], "answers": [{"tags": [], "owner": {"reputation": 311, "user_id": 2888802, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/ErWKL.jpg?s=128&g=1", "display_name": "dom", "link": "https://stackoverflow.com/users/2888802/dom"}, "is_accepted": false, "score": 0, "last_activity_date": 1536970435, "creation_date": 1536970435, "answer_id": 52340532, "question_id": 52339179, "link": "https://stackoverflow.com/questions/52339179/namespace-routing/52340532#52340532", "title": "Namespace routing", "body": "<p>Try doing it this way:</p>\n\n<pre><code>func init() {\n\nns :=\n    beego.NewNamespace(\"/v1\",\n        beego.NSRouter(\"/weather\", &amp;controllers.WeatherController{}),\n        beego.NSRouter(\"/scheduler/weather\",&amp;controllers.ScheduleController{}),\n\n    )\nbeego.AddNamespace(ns) }\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 8771984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gbh41.jpg?s=128&g=1", "display_name": "Sergio Palechor", "link": "https://stackoverflow.com/users/8771984/sergio-palechor"}, "is_accepted": false, "score": 0, "last_activity_date": 1537195738, "creation_date": 1537195738, "answer_id": 52370404, "question_id": 52339179, "link": "https://stackoverflow.com/questions/52339179/namespace-routing/52370404#52370404", "title": "Namespace routing", "body": "<p>The problem was not on router.go but in the controller definition.</p>\n\n<p>Before:</p>\n\n<pre><code>// @router / [put]\n\nfunc (c *ScheduleController) Put() {\n...\n}\n</code></pre>\n\n<p>After:</p>\n\n<pre><code>// @router / [put]\nfunc (c *ScheduleController) Put() {\n...\n}\n</code></pre>\n\n<p>The difference was the space in-between <code>@router</code> and the method definition. </p>\n"}], "owner": {"reputation": 1, "user_id": 8771984, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Gbh41.jpg?s=128&g=1", "display_name": "Sergio Palechor", "link": "https://stackoverflow.com/users/8771984/sergio-palechor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 344, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1537195738, "creation_date": 1536958993, "question_id": 52339179, "link": "https://stackoverflow.com/questions/52339179/namespace-routing", "title": "Namespace routing", "body": "<p>I'm new with Go/Beego framework and I'm trying to understand how namespace routing works. I have the following:</p>\n\n<pre><code>func init() {\n\n    ns :=\n        beego.NewNamespace(\"/v1\",\n            beego.NSNamespace(\"/weather\",\n                beego.NSInclude(&amp;controllers.WeatherController{}),\n            ),\n            beego.NSNamespace(\"/scheduler/weather\",\n                beego.NSInclude(&amp;controllers.ScheduleController{}),\n            ),\n        )\n    beego.AddNamespace(ns)\n}\n</code></pre>\n\n<p>However when I type <code>127.0.0.1/v1/weather</code> or <code>127.0.0.1/weather</code> on the browser, there's a page not found response. Same with the other url.</p>\n\n<p>What am I missing here?</p>\n\n<p>Thanks!</p>\n"}]