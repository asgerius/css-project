[{"tags": ["json", "go", "struct", "marshalling", "unmarshalling"], "comments": [{"owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "edited": false, "score": 5, "creation_date": 1485993725, "post_id": 41992035, "comment_id": 71161198, "body": "That isn&#39;t valid JSON. Fruits needs to be either an array or a name: value pair."}], "answers": [{"comments": [{"owner": {"reputation": 127, "user_id": 1106558, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e89b0acda3f3332c3b2def50c19994a9?s=128&d=identicon&r=PG", "display_name": "sukkad", "link": "https://stackoverflow.com/users/1106558/sukkad"}, "edited": false, "score": 0, "creation_date": 1486002926, "post_id": 41992654, "comment_id": 71163627, "body": "This does not solve the issue of Fruits appearing as array <b>[]</b> and not <b>{[]}</b>. Output should have &quot;Fruits&quot;:{[{&quot;Name&quot;:&quot;Mango&quot;,&quot;Season&quot;:&quot;Summer&quot;},{&quot;Name&quot;:&quot;Fig&quot;,&zwnj;&#8203;&quot;Season&quot;:&quot;Winter&quot;}]}"}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "reply_to_user": {"reputation": 127, "user_id": 1106558, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e89b0acda3f3332c3b2def50c19994a9?s=128&d=identicon&r=PG", "display_name": "sukkad", "link": "https://stackoverflow.com/users/1106558/sukkad"}, "edited": false, "score": 0, "creation_date": 1486010729, "post_id": 41992654, "comment_id": 71165645, "body": "@sukkad that&#39;s not valid JSON"}], "tags": [], "owner": {"reputation": 17, "user_id": 3705015, "user_type": "registered", "profile_image": "https://graph.facebook.com/685960818/picture?type=large", "display_name": "alvaro.muir", "link": "https://stackoverflow.com/users/3705015/alvaro-muir"}, "is_accepted": false, "score": 1, "last_activity_date": 1485997466, "creation_date": 1485997466, "answer_id": 41992654, "question_id": 41992035, "link": "https://stackoverflow.com/questions/41992035/json-unmarshal-type-model-in-golang/41992654#41992654", "title": "Json unmarshal type model in golang", "body": "<p>I would make 'Baskets' a struct within 'Response', create a 'BasketsData' struct,  and give it all some labels. </p>\n\n<pre><code>type Fruit struct {\n    Name   string `json:\"Name\"`\n    Season string `json:\"Season\"`\n}\n\ntype BasketData struct {\n    Count  int     `json:\"Count\"`\n    Fruits []Fruit `json:\"Fruits\"`\n}\n\ntype Response struct {\n    Basket BasketData `json:\"Basket\"`\n}\n</code></pre>\n\n<p>This way you will get a top level JSON response when you marshall it.</p>\n\n<pre><code>fruitmania := []Fruit{{Name: \"Mango\", Season: \"Summer\"},\n                       {Name: \"Fig\", Season: \"Winter\"}}\nbasket := Response{BasketData{Count: 100, Fruits: fruitmania}}\n\nb, _ := json.Marshal(basket)\nfmt.Println(string(b))\n</code></pre>\n\n<p>checkit-checkit out:\n<a href=\"https://play.golang.org/p/TuUwBLs_Ql\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TuUwBLs_Ql</a></p>\n"}, {"comments": [{"owner": {"reputation": 127, "user_id": 1106558, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e89b0acda3f3332c3b2def50c19994a9?s=128&d=identicon&r=PG", "display_name": "sukkad", "link": "https://stackoverflow.com/users/1106558/sukkad"}, "edited": false, "score": 0, "creation_date": 1486061649, "post_id": 42005122, "comment_id": 71195696, "body": "You are spot on, the JSON I am consuming comes from a 3rd party and is invalid. I switch to XML and my structure works perfectly (This is why I like Go, transition is just 2 line change). I also validated with json.RawMessage. Json is not supposed to have &quot;[&quot; after &quot;{&quot;."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": true, "score": 1, "last_activity_date": 1486047291, "last_edit_date": 1486047291, "creation_date": 1486046609, "answer_id": 42005122, "question_id": 41992035, "link": "https://stackoverflow.com/questions/41992035/json-unmarshal-type-model-in-golang/42005122#42005122", "title": "Json unmarshal type model in golang", "body": "<p>Your model is totally correct and valid, but the JSON object is not. <code>\"Fruits\"</code> doesn't have name if it should be key value pair or it should be wrapped in <code>[]</code> not <code>{}</code>.</p>\n\n<p>JSON obj should be formatted like this:</p>\n\n<pre><code>{\n  \"Basket\" : {\n    \"Count\": 1,\n    \"Fruits\": [\n      {\n        \"Name\":\"Mango\", \n        \"Season\":\"Summer\"\n      },\n      {\n        \"Name\":\"Fig\", \n        \"Season\":\"Winter\"\n      }\n    ]\n  }\n}\n</code></pre>\n\n<p>And actually invalid json shouldn't work <a href=\"https://play.golang.org/p/yoW7t4NfI7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yoW7t4NfI7</a></p>\n"}], "owner": {"reputation": 127, "user_id": 1106558, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e89b0acda3f3332c3b2def50c19994a9?s=128&d=identicon&r=PG", "display_name": "sukkad", "link": "https://stackoverflow.com/users/1106558/sukkad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 692, "favorite_count": 1, "accepted_answer_id": 42005122, "answer_count": 2, "score": -1, "last_activity_date": 1486047291, "creation_date": 1485993173, "last_edit_date": 1486003467, "question_id": 41992035, "link": "https://stackoverflow.com/questions/41992035/json-unmarshal-type-model-in-golang", "title": "Json unmarshal type model in golang", "body": "<p>I have a RESTful service that returns response similar to show below:</p>\n\n<pre><code>\"Basket\" : {\n  \"Count\": 1,\n  \"Fruits\": {[\n    {\n      \"Name\":\"Mango\", \n      \"Season\":\"Summer\"\n    },\n    {\n      \"Name\":\"Fig\", \n      \"Season\":\"Winter\"}\n  ]}\n}\n</code></pre>\n\n<p>I am trying to create Go lang model to unmarshal the contents. Following is the code I have tried:</p>\n\n<pre><code>type Response struct {\n    Count   int\n    Fruits []Fruit\n}\n\ntype Fruit struct {\n    Name string\n    Season string\n}\n</code></pre>\n\n<p>But when I marshal the Response object in my test code I don't see similar json. (<a href=\"https://play.golang.org/p/EGKqfbwFvW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/EGKqfbwFvW</a>)\nMarshalled data always appears as :</p>\n\n<pre><code>{\n  \"Count\":100,\n  \"Fruits\":[\n    {\"Name\":\"Mango\",\"Season\":\"Summer\"},\n    {\"Name\":\"Fig\",\"Season\":\"Winter\"}\n  ]\n}\n</code></pre>\n\n<p>Notice the Fruits appearing as array <strong>[]</strong> and not <strong>{[]}</strong> in original json. How can I model structs in golang for this response?</p>\n"}, {"tags": ["go", "rabbitmq", "amqp"], "answers": [{"comments": [{"owner": {"reputation": 5639, "user_id": 1277048, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/tGJVH.jpg?s=128&g=1", "display_name": "FuzzyAmi", "link": "https://stackoverflow.com/users/1277048/fuzzyami"}, "edited": false, "score": 3, "creation_date": 1498984991, "post_id": 41992811, "comment_id": 76716804, "body": "it should be noted that if someone calls Close on the connection, NotifyClose would return with nil. this allows differentiating between errors (which would likely warrant reconnection) and normal app termination."}, {"owner": {"reputation": 4691, "user_id": 302915, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/afe39c5876518d84943dbc30652e38d8?s=128&d=identicon&r=PG", "display_name": "Gene Vincent", "link": "https://stackoverflow.com/users/302915/gene-vincent"}, "edited": false, "score": 0, "creation_date": 1518453191, "post_id": 41992811, "comment_id": 84502759, "body": "Do the C bindings (<a href=\"https://github.com/alanxz/rabbitmq-c\" rel=\"nofollow noreferrer\">github.com/alanxz/rabbitmq-c</a>) have a similar mechanism to get notified when the connection closes ?"}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 15, "last_activity_date": 1486029890, "last_edit_date": 1486029890, "creation_date": 1485998635, "answer_id": 41992811, "question_id": 41991926, "link": "https://stackoverflow.com/questions/41991926/how-to-detect-dead-rabbitmq-connection/41992811#41992811", "title": "How to detect dead RabbitMQ connection", "body": "<p><code>amqp.Connection</code> has method <code>NotifyClose()</code> which return channel signalling a transport or protocol error.\nSo something like</p>\n\n<pre><code>for {  //reconnection loop\n    conn, err := amqp.Dial(\"amqp://guest:guest@localhost:5672/\") //setup\n    notify := conn.NotifyClose(make(chan *amqp.Error)) //error channel\n...\n    ch, err := conn.Channel()\n    msgs, err := ch.Consume(\n...\n    for{  //receive loop\n        select {  //check connection\n            case err = &lt;-notify:\n            //work with error\n            break //reconnect\n        case d = &lt;- msgs:\n            //work with message\n        ...\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 402, "user_id": 10272632, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7yEWA.jpg?s=128&g=1", "display_name": "dyy.alex", "link": "https://stackoverflow.com/users/10272632/dyy-alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1595225925, "creation_date": 1595225925, "answer_id": 62989632, "question_id": 41991926, "link": "https://stackoverflow.com/questions/41991926/how-to-detect-dead-rabbitmq-connection/62989632#62989632", "title": "How to detect dead RabbitMQ connection", "body": "<p>It has not been found that the go-amqp library implements the disconnection and reconnection function of the connection pool. <br>\nThere is an open source code based on Amqp secondary packaging on github.\nReconnect after disconnection and abnormal reconnect have been supported. The code is also relatively simple to use, and each service has a connection and channel.</p>\n<p>Git address: <code>https://github.com/billmi/go-rabbit</code></p>\n<p>Example Code:</p>\n<pre><code>package main\n \nimport (\n    &quot;go-rabbit/rabbit&quot;\n)\n \n/*\n    support isconnection and reconnection function\n    And Failure re-send function\n    @author : Bill\n*/\nfunc main() {\n    var(\n        addr = &quot;amqp://guest:guest@localhost:5672/&quot;\n        queue = &quot;testQueue&quot;\n        exchange = &quot;test_exchange&quot;\n        routerKey = &quot;/test&quot;\n        msg = &quot;test1!&quot;\n \n        //delay\n        delayQueue = &quot;delay_queue&quot;\n        delayExchange = &quot;delay_exchange&quot;\n        delayRouterKey = &quot;delay_exchange&quot;\n        prefix = &quot;v1_prefix&quot;\n        sep = &quot;_&quot;\n        eType = &quot;F&quot;\n        _ttl = 60 * 1000\n    )\n \n    var rabbitProduct1 = rabbit.NewRabbitProduct(addr,_ttl,prefix,sep,delayExchange,delayQueue,delayRouterKey)\n    // register recycle\n    go rabbitProduct1.InitDefdelay(false)\n    go rabbitProduct1.InitDefdelay(true)\n    go rabbitProduct1.RegisterDelayWithPreFix(&quot;delay_queue&quot;,&quot;delay_exchange&quot;,&quot;delay_exchange&quot;)\n \n    // ttl is dead recycle time if ttl &gt; 0 then recycle\n    rabbitProduct1.PubMessage(true,eType,queue,exchange,routerKey,msg,rabbitProduct1.GetBool(1),rabbitProduct1.GetBool(0),_ttl)\n \n}\n</code></pre>\n<p>Wish it will help you or give you some idea</p>\n"}], "owner": {"reputation": 121, "user_id": 2965807, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f90bac6711d6a45e48c9ac10da4e48aa?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander", "link": "https://stackoverflow.com/users/2965807/alexander"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8164, "favorite_count": 3, "answer_count": 2, "score": 12, "last_activity_date": 1595225925, "creation_date": 1485992603, "last_edit_date": 1595214375, "question_id": 41991926, "link": "https://stackoverflow.com/questions/41991926/how-to-detect-dead-rabbitmq-connection", "title": "How to detect dead RabbitMQ connection", "body": "<p>I have a RabbitMQ consumer script in Go (this is a simple script from <a href=\"https://www.rabbitmq.com/tutorials/tutorial-two-go.html\" rel=\"nofollow noreferrer\">RabbitMQ tutorial</a> that uses <a href=\"https://github.com/streadway/amqp\" rel=\"nofollow noreferrer\" title=\"streadway/amqp\">streadway/amqp</a> library).</p>\n<p>The problem is that if the rabbitmq-server is stopped, the consumer script does not exit; and when rabbitmq-server is started again, the consumer does not receive messages anymore.</p>\n<p>Is there a way to detect that the consumer connection is dead and reconnect or at least terminate the consumer script?</p>\n<p>I know that it sets default 10 sec. heartbeat interval for the connection, is it possible to use it someway?</p>\n<pre><code>func main() {\n    conn, err := amqp.Dial(&quot;amqp://guest:guest@localhost:5672/&quot;)\n    failOnError(err, &quot;Failed to connect to RabbitMQ&quot;)\n    defer conn.Close()\n\n    ch, err := conn.Channel()\n    failOnError(err, &quot;Failed to open a channel&quot;)\n    defer ch.Close()\n\n    q, err := ch.QueueDeclare(\n        &quot;test_task_queue&quot;, // name\n        true,         // durable\n        false,        // delete when unused\n        false,        // exclusive\n        false,        // no-wait\n        nil,          // arguments\n    )\n    failOnError(err, &quot;Failed to declare a queue&quot;)\n\n    err = ch.Qos(\n        1,     // prefetch count\n        0,     // prefetch size\n        false, // global\n    )\n    failOnError(err, &quot;Failed to set QoS&quot;)\n\n    msgs, err := ch.Consume(\n        q.Name, // queue\n        &quot;&quot;,     // consumer\n        false,  // auto-ack\n        false,  // exclusive\n        false,  // no-local\n        false,  // no-wait\n        nil,    // args\n    )\n    failOnError(err, &quot;Failed to register a consumer&quot;)\n\n    forever := make(chan bool)\n\n    go func() {\n        for d := range msgs {\n            log.Printf(&quot;Received a message: %s&quot;, d.Body)\n            d.Ack(false)\n            dot_count := bytes.Count(d.Body, []byte(&quot;.&quot;))\n            t := time.Duration(dot_count)\n            time.Sleep(t * time.Second)\n            log.Printf(&quot;Done&quot;)\n        }\n    }()\n\n    log.Printf(&quot; [*] Waiting for messages. To exit press CTRL+C&quot;)\n    &lt;-forever\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1485977342, "post_id": 41988041, "comment_id": 71153636, "body": "You have a variable and a function with the same name. What is it you are trying to do?"}, {"owner": {"reputation": 11, "user_id": 7502181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0efc6c081f6ace78a5452b046053f045?s=128&d=identicon&r=PG&f=1", "display_name": "touchman", "link": "https://stackoverflow.com/users/7502181/touchman"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485977864, "post_id": 41988041, "comment_id": 71153936, "body": "Updated. Hope, now it&#39;s clear"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485977950, "post_id": 41988041, "comment_id": 71153980, "body": "Are you looking for a type assertion or type switch? Possible duplicate: <a href=\"https://stackoverflow.com/questions/6996704/how-to-check-variable-type-at-runtime-in-go-language\" title=\"how to check variable type at runtime in go language\">stackoverflow.com/questions/6996704/&hellip;</a>"}, {"owner": {"reputation": 21605, "user_id": 1142167, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/f9MAS.jpg?s=128&g=1", "display_name": "Joel Cornett", "link": "https://stackoverflow.com/users/1142167/joel-cornett"}, "edited": false, "score": 0, "creation_date": 1486010804, "post_id": 41988041, "comment_id": 71165665, "body": "What problem are you trying to solve?"}], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 4, "last_activity_date": 1486007775, "last_edit_date": 1486007775, "creation_date": 1485979374, "answer_id": 41988665, "question_id": 41988041, "link": "https://stackoverflow.com/questions/41988041/golang-use-structs-as-argument-into-a-function/41988665#41988665", "title": "golang, use structs as argument into a function", "body": "<p>You may use a <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow noreferrer\">type switch</a> if you know the exact possible types. Otherwise you may use the <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflect</a> package.</p>\n\n<p>Here is code demonstrating the type switch approach:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype X struct {\n    x string\n}\ntype Y struct {\n    y string\n}\n\nfunc main() {\n    var x = []X{{\"xx\"}}\n    var y = []Y{{\"yy\"}}\n\n    f(x)\n    f(y)\n}\n\nfunc f(value interface{}) {\n    switch value := value.(type) {\n    case []X:\n        fmt.Println(\"This is X\", value)\n    case []Y:\n        fmt.Println(\"This is Y\", value)\n    default:\n        fmt.Println(\"This is YoYo\")\n    }\n}\n</code></pre>\n\n<p>play link : <a href=\"https://play.golang.org/p/d1NAcBhwTh\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 11, "user_id": 7502181, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0efc6c081f6ace78a5452b046053f045?s=128&d=identicon&r=PG&f=1", "display_name": "touchman", "link": "https://stackoverflow.com/users/7502181/touchman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 0, "accepted_answer_id": 41988665, "answer_count": 1, "score": 0, "last_activity_date": 1486007775, "creation_date": 1485977228, "last_edit_date": 1485995804, "question_id": 41988041, "link": "https://stackoverflow.com/questions/41988041/golang-use-structs-as-argument-into-a-function", "title": "golang, use structs as argument into a function", "body": "<p>could you please advise on the question.\nI just started to learn golang and have already choked with this situation.</p>\n\n<p>For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\ntype X struct{\n    x string\n}\ntype Y struct{\n    y string\n}\n\nfunc main() {\n    var x []X\n    var y []Y\n\n    f(x)\n    f(y)\n}\n\nfunc f(value interface{}){\n    if(typeof(value) == \"[]X\"){\n        fmt.Println(\"this is X\")\n    }\n    if(typeof(value) == \"[]Y\"){\n        fmt.Println(\"this is Y\")\n    }\n}\n\nexpected output: this is X\n                 this is Y\n</code></pre>\n\n<p><code>value interface{}</code> is wrong type. How can I put different structures into one function and then dynamically define its type. </p>\n\n<p>Is something like this possible? \nThanks.</p>\n"}, {"tags": ["go", "apache-kafka", "sarama"], "answers": [{"tags": [], "owner": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "is_accepted": true, "score": 2, "last_activity_date": 1582113869, "last_edit_date": 1582113869, "creation_date": 1485987171, "answer_id": 41990805, "question_id": 41986674, "link": "https://stackoverflow.com/questions/41986674/how-to-create-a-kafka-consumer-group-in-golang/41990805#41990805", "title": "How to create a kafka consumer group in Golang?", "body": "<p>The consumer group is specified by the second argument of the cluster consumer \"constructor\". Here's a very basic sketch:</p>\n\n<pre><code>import (\n    \"github.com/Shopify/sarama\"\n    \"github.com/bsm/sarama-cluster\"\n)\n\nconf := cluster.NewConfig()\n// add config values\n\nbrokers := []string{\"kafka-1:9092\", \"kafka-2:9092\"}\ngroup := \"Your-Consumer-Group\"\ntopics := []string{\"topicName\"}\nconsumer := cluster.NewConsumer(broker, group, topics, conf)\n</code></pre>\n\n<p>And so you'll have a consumer belonging to the specified consumer group.</p>\n"}, {"comments": [{"owner": {"reputation": 532, "user_id": 454335, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KQvh0.jpg?s=128&g=1", "display_name": "vinni_f", "link": "https://stackoverflow.com/users/454335/vinni-f"}, "edited": false, "score": 0, "creation_date": 1569350152, "post_id": 56679704, "comment_id": 102566317, "body": "unless you are stuck at kafka 0.10.1, you still need to use sarama-cluster"}, {"owner": {"reputation": 61, "user_id": 13839097, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FVJmlc09GSA/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclxBKSjJ_XeC3oPQAWKU71fDLZmHA/photo.jpg?sz=128", "display_name": "Li Ziyan", "link": "https://stackoverflow.com/users/13839097/li-ziyan"}, "edited": false, "score": 0, "creation_date": 1619164334, "post_id": 56679704, "comment_id": 118826864, "body": "could I scale safely if I deploy this program in Pod of Kubernetes Deployment?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 61, "user_id": 13839097, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-FVJmlc09GSA/AAAAAAAAAAI/AAAAAAAAAAA/AMZuuclxBKSjJ_XeC3oPQAWKU71fDLZmHA/photo.jpg?sz=128", "display_name": "Li Ziyan", "link": "https://stackoverflow.com/users/13839097/li-ziyan"}, "edited": false, "score": 0, "creation_date": 1619260999, "post_id": 56679704, "comment_id": 118854666, "body": "yes @LiZiyan you can scale producers to multiple pods in cluster"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 18, "last_activity_date": 1561026661, "last_edit_date": 1561026661, "creation_date": 1561009797, "answer_id": 56679704, "question_id": 41986674, "link": "https://stackoverflow.com/questions/41986674/how-to-create-a-kafka-consumer-group-in-golang/56679704#56679704", "title": "How to create a kafka consumer group in Golang?", "body": "<p>There is no need to use <strong>sarama-cluster</strong> library. It is DEPRECATED for apache kafka integration. <code>Sarama</code> original library itself provide a way to connect to kafka cluster using consumer group.</p>\n\n<p>We need to create client and then we initialize consumer group where we create claims and wait for message channel to receive message.</p>\n\n<p>Initializing client :-</p>\n\n<pre><code>kfversion, err := sarama.ParseKafkaVersion(kafkaVersion) // kafkaVersion is the version of kafka server like 0.11.0.2\nif err != nil {\n    log.Println(err)\n}\n\nconfig := sarama.NewConfig()\nconfig.Version = kfversion\nconfig.Consumer.Return.Errors = true\n\n// Start with a client\nclient, err := sarama.NewClient([]string{brokerAddr}, config)\nif err != nil {\n    log.Println(err)\n}\ndefer func() { _ = client.Close() }()\n</code></pre>\n\n<p>Connection to consumer group :-</p>\n\n<pre><code>// Start a new consumer group\ngroup, err := sarama.NewConsumerGroupFromClient(consumer_group, client)\nif err != nil {\n    log.Println(err)\n}\ndefer func() { _ = group.Close() }()\n</code></pre>\n\n<p>Start consuming messages from topic partition :-</p>\n\n<pre><code>// Iterate over consumer sessions.\nctx := context.Background()\nfor {\n    topics := []string{topicName}\n    handler := &amp;Message{}\n    err := group.Consume(ctx, topics, handler)\n    if err != nil {\n        log.Println(err)\n    }\n}\n</code></pre>\n\n<p>The last part is to wait for message channel to consume messages. We need to implement all of the functions (three) to implement <code>ConsumerGroupHandler</code> interface.</p>\n\n<pre><code>func (exampleConsumerGroupHandler) Setup(_ ConsumerGroupSession) error   { return nil }\nfunc (exampleConsumerGroupHandler) Cleanup(_ ConsumerGroupSession) error { return nil }\nfunc (h exampleConsumerGroupHandler) ConsumeClaim(sess ConsumerGroupSession, claim ConsumerGroupClaim) error {\n    for msg := range claim.Messages() {\n        fmt.Printf(\"Message topic:%q partition:%d offset:%d\\n\", msg.Topic, msg.Partition, msg.Offset)\n        sess.MarkMessage(msg, \"\")\n    }\n    return nil\n}\n</code></pre>\n\n<p>For more information on kafka using golang check <a href=\"https://godoc.org/github.com/Shopify/sarama\" rel=\"noreferrer\">sarama</a> library.</p>\n"}], "owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9822, "favorite_count": 3, "accepted_answer_id": 41990805, "answer_count": 2, "score": 5, "last_activity_date": 1582113869, "creation_date": 1485972449, "last_edit_date": 1485990465, "question_id": 41986674, "link": "https://stackoverflow.com/questions/41986674/how-to-create-a-kafka-consumer-group-in-golang", "title": "How to create a kafka consumer group in Golang?", "body": "<p>An available library is <a href=\"https://github.com/Shopify/sarama/\" rel=\"noreferrer\">sarama</a> (or its expansion <a href=\"https://github.com/bsm/sarama-cluster\" rel=\"noreferrer\">sarama-cluster</a>) however no consumer group example are provided, not in <a href=\"https://godoc.org/gopkg.in/Shopify/sarama.v1#example-Consumer\" rel=\"noreferrer\">sarama</a> nor in <a href=\"https://github.com/bsm/sarama-cluster/issues/105\" rel=\"noreferrer\">sarama-cluster</a>.</p>\n\n<p>I do not understand the API. May I have an example of creating a consumer group for a topic?</p>\n"}, {"tags": ["go", "apache-kafka", "sarama"], "answers": [{"comments": [{"owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1485972961, "post_id": 41986717, "comment_id": 71151267, "body": "So I need to create a consumer group and give it a specific name of my choice, correct? Can that be done in using Shopify/sarama?"}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "reply_to_user": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "edited": false, "score": 0, "creation_date": 1485975581, "post_id": 41986717, "comment_id": 71152690, "body": "There are several ways to create a consumer. Using <a href=\"https://godoc.org/github.com/Shopify/sarama#NewConsumerFromClient\" rel=\"nofollow noreferrer\">NewConsumerFromClient</a> allows you to set your offsets in the client prior to creating the consumer. To find the offsets you&#39;d use the same group id so as to use the offset manager mentioned above."}], "tags": [], "owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "is_accepted": false, "score": 0, "last_activity_date": 1485972604, "creation_date": 1485972604, "answer_id": 41986717, "question_id": 41984572, "link": "https://stackoverflow.com/questions/41984572/how-to-get-groupid-in-golang-kafka-10/41986717#41986717", "title": "How to get GroupID in Golang Kafka 10?", "body": "<p>You are attempting to create your own offset manager to find current offsets:</p>\n\n<pre><code>offsetManager, _ := sarama.NewOffsetManagerFromClient(group, cli)\n</code></pre>\n\n<p>Similarly, the consumer that was consuming your topic's messages would have to use the same offset manager and they would have used a specific group id. Use that group id.</p>\n"}, {"tags": [], "owner": {"reputation": 90, "user_id": 8194156, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Cyt7b.jpg?s=128&g=1", "display_name": "Juxuny Wu", "link": "https://stackoverflow.com/users/8194156/juxuny-wu"}, "is_accepted": false, "score": 0, "last_activity_date": 1577554908, "creation_date": 1577554908, "answer_id": 59513361, "question_id": 41984572, "link": "https://stackoverflow.com/questions/41984572/how-to-get-groupid-in-golang-kafka-10/59513361#59513361", "title": "How to get GroupID in Golang Kafka 10?", "body": "<p>I think you can use any string as groupId. Please look at the example from <a href=\"https://godoc.org/github.com/Shopify/sarama\" rel=\"nofollow noreferrer\">sarama GoDoc</a></p>\n\n<pre><code>// Start a new consumer group\ngroup, err := NewConsumerGroupFromClient(\"my-group\", client)\nif err != nil {\n    panic(err)\n}\ndefer func() { _ = group.Close() }()\n</code></pre>\n\n<p>Maybe you can give it any string. And you should make sure the other consumers can get the same groupId for joining the group.</p>\n"}], "owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 738, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1577554908, "creation_date": 1485965876, "last_edit_date": 1485988667, "question_id": 41984572, "link": "https://stackoverflow.com/questions/41984572/how-to-get-groupid-in-golang-kafka-10", "title": "How to get GroupID in Golang Kafka 10?", "body": "<p>I am using Kafka 10.0 and <a href=\"https://github.com/Shopify/sarama\" rel=\"nofollow noreferrer\">https://github.com/Shopify/sarama</a>.\nI am trying to get the offset of the latest message that a consumer processed.</p>\n\n<p>To do so I've found the method <a href=\"https://godoc.org/github.com/Shopify/sarama#NewOffsetManagerFromClient\" rel=\"nofollow noreferrer\">NewOffsetManagerFromClient(group string, client Client)</a> which require the group name.</p>\n\n<p><strong>How do I get consumer group name?</strong></p>\n\n<pre><code>offsets := make(map[int32]int64)\n\nconfig := sarama.NewConfig()\nconfig.Consumer.Offsets.CommitInterval = 200 * time.Millisecond\nconfig.Version = sarama.V0_10_0_0\n\n// config.Consumer.Offsets.Initial = sarama.OffsetNewest\ncli, _ := sarama.NewClient(kafkaHost, config)\ndefer cli.Close()\n\noffsetManager, _ := sarama.NewOffsetManagerFromClient(group, cli)\nfor _, partition := range partitions {\n    partitionOffsetManager, _ := offsetManager.ManagePartition(topic, partition)\n    offset, _ := partitionOffsetManager.NextOffset()\n\n    offsets[partition] = offset\n}\nreturn offsets\n</code></pre>\n\n<p>I created a consumer with</p>\n\n<pre><code>consumer := sarama.NewConsumer(connections, config)\n</code></pre>\n\n<p>but I do not know how to create a consumer group and get its group name.</p>\n"}, {"tags": ["go", "apache-kafka", "sarama"], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 346819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ef08724b1d2baaabc047612ca452e54e?s=128&d=identicon&r=PG", "display_name": "Karthikeyan Marudhachalam", "link": "https://stackoverflow.com/users/346819/karthikeyan-marudhachalam"}, "is_accepted": true, "score": 2, "last_activity_date": 1516282033, "creation_date": 1516282033, "answer_id": 48322510, "question_id": 41983936, "link": "https://stackoverflow.com/questions/41983936/how-to-set-consumer-to-start-from-a-specific-offset-in-golang-kafka-10/48322510#48322510", "title": "How to set consumer to start from a specific offset in Golang Kafka 10", "body": "<p>If offset was already saved for a partition, sarama-cluster will resume consumption from that offset. The <code>Config.Producer.Offsets.Initial</code> option is used only if no saved offset is present (first run for a consumer group).</p>\n\n<p>You can verify this by adding the following line at the beginning of your <code>main()</code> function:</p>\n\n<pre><code>sarama.Logger = log.New(os.Stdout, \"sarama: \", log.LstdFlags)\n</code></pre>\n\n<p>Then you'll see something like the following in the output:</p>\n\n<p><code>cluster/consumer CID-17db1be4-a162-411c-a106-4d198191176a consume sample/0 from 12</code></p>\n\n<p>The 12 in that is the offset Sarama is going to start from for that partition (sample/0).</p>\n"}], "owner": {"reputation": 1627, "user_id": 2893839, "user_type": "registered", "accept_rate": 53, "profile_image": "https://i.stack.imgur.com/A1yFr.jpg?s=128&g=1", "display_name": "Lorenzo Belli", "link": "https://stackoverflow.com/users/2893839/lorenzo-belli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2707, "favorite_count": 0, "accepted_answer_id": 48322510, "answer_count": 1, "score": 1, "last_activity_date": 1516282033, "creation_date": 1485964009, "last_edit_date": 1485989101, "question_id": 41983936, "link": "https://stackoverflow.com/questions/41983936/how-to-set-consumer-to-start-from-a-specific-offset-in-golang-kafka-10", "title": "How to set consumer to start from a specific offset in Golang Kafka 10", "body": "<p>My need is to make the producer to start from the last message it processed before it crashed. Fortunately I am in the case of having only one topic, with one partition and one consumer.</p>\n\n<p>To do so I tried <a href=\"https://github.com/Shopify/sarama\" rel=\"nofollow noreferrer\">https://github.com/Shopify/sarama</a> but it doesn't seems to be available yet. \nI am now using <a href=\"https://godoc.org/github.com/bsm/sarama-cluster\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/bsm/sarama-cluster</a>, which allow me to commit every message offset.</p>\n\n<p>I cannot retrieve the last committed offset\nI cannot figure out how to make a sarama <a href=\"https://godoc.org/github.com/bsm/sarama-cluster#Consumer\" rel=\"nofollow noreferrer\">consumer</a> to start from said offset. The only parameter I've found so far is <code>Config.Producer.Offsets.Initial</code>.</p>\n\n<ol>\n<li>How to retrieve the last committed offset?</li>\n<li>How to  make the consumer start from the last message whose offset has been committed? <code>OffsetNewest</code> will make it start from the last message produced, not the last processed b the consumer.</li>\n<li>Is it possible to do so using only Shopify/sarama and not bsm/sarama-cluster ?</li>\n</ol>\n\n<p>Thank in advance</p>\n\n<p>P.S. I am using Kafka 10.0, so the offsets are stores in a kafka and not in zookeeper.</p>\n\n<p><strong>EDIT1:</strong>\nPartial solution: fetch all the messages since sarama.OffsetOldest and skip all of them until we found a non processed one.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 23294, "user_id": 2891324, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07d27f03cd98b59774911f8dea5ee00b?s=128&d=identicon&r=PG", "display_name": "nessuno", "link": "https://stackoverflow.com/users/2891324/nessuno"}, "is_accepted": false, "score": 0, "last_activity_date": 1485958147, "creation_date": 1485958147, "answer_id": 41981808, "question_id": 41981767, "link": "https://stackoverflow.com/questions/41981767/how-to-build-after-go-get-d/41981808#41981808", "title": "How to build after &quot;go get -d&quot;?", "body": "<p><code>go -h</code> can help you:</p>\n\n<blockquote>\n  <p>Go is a tool for managing Go source code.</p>\n  \n  <p>Usage:</p>\n\n<pre><code>    go command [arguments]\n</code></pre>\n  \n  <p>The commands are:</p>\n\n<pre><code>    build       compile packages and dependencies\n</code></pre>\n  \n  <p>...</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 550, "user_id": 370039, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/65fddbce7765d52e835eb5a2495e3308?s=128&d=identicon&r=PG", "display_name": "rmweiss", "link": "https://stackoverflow.com/users/370039/rmweiss"}, "is_accepted": true, "score": 3, "last_activity_date": 1567148256, "last_edit_date": 1567148256, "creation_date": 1485959310, "answer_id": 41982195, "question_id": 41981767, "link": "https://stackoverflow.com/questions/41981767/how-to-build-after-go-get-d/41982195#41982195", "title": "How to build after &quot;go get -d&quot;?", "body": "<p>I found the answer myself: </p>\n\n<pre><code> go install ...\n</code></pre>\n\n<p>This seems to do exactly the same as <code>go get</code> after downloading the sources.</p>\n"}], "owner": {"reputation": 550, "user_id": 370039, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/65fddbce7765d52e835eb5a2495e3308?s=128&d=identicon&r=PG", "display_name": "rmweiss", "link": "https://stackoverflow.com/users/370039/rmweiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1458, "favorite_count": 0, "accepted_answer_id": 41982195, "answer_count": 2, "score": 1, "last_activity_date": 1567148256, "creation_date": 1485958004, "question_id": 41981767, "link": "https://stackoverflow.com/questions/41981767/how-to-build-after-go-get-d", "title": "How to build after &quot;go get -d&quot;?", "body": "<p>I'm using the GOfax.IP which I can download and build with:</p>\n\n<pre><code>go get github.com/gonicus/gofaxip/...\n</code></pre>\n\n<p>This works without any problems.</p>\n\n<p>Now I want to make a small change in the source code before compiling. </p>\n\n<p>I know that I can use <code>go get -d</code> to only download the sources, but how would I start the build/compile part of <code>got get</code> after I finished my modifications?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 2, "creation_date": 1489658550, "post_id": 41978277, "comment_id": 72771329, "body": "Being relatively new to golang I have to say that <code>if v1, v2, ok1, ok2 := idx(m1, m2, &quot;aaa&quot;); ok1 &amp;&amp; ok2 {</code> looks like a contributing risk factor for intraocular melanoma. A.k.a. eye cancer."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 12379, "user_id": 512155, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1d9e7cb33c7af34026a521a786ada19b?s=128&d=identicon&r=PG", "display_name": "jan groth", "link": "https://stackoverflow.com/users/512155/jan-groth"}, "edited": false, "score": 0, "creation_date": 1489660138, "post_id": 41978277, "comment_id": 72772444, "body": "@jangroth I wouldn&#39;t use it either, but that&#39;s a possibility to do what the asker wanted."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 8, "last_activity_date": 1485947945, "last_edit_date": 1592644375, "creation_date": 1485947384, "answer_id": 41978277, "question_id": 41978101, "link": "https://stackoverflow.com/questions/41978101/check-if-key-exists-in-multiple-maps-in-one-condition/41978277#41978277", "title": "Check if key exists in multiple maps in one condition", "body": "<p>No, it can't be done. <a href=\"https://golang.org/ref/spec#Index_expressions\" rel=\"noreferrer\">Spec: Index expressions:</a></p>\n<blockquote>\n<p>An index expression on a map a of type <code>map[K]V</code> used in an <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"noreferrer\">assignment</a> or initialization of the special form</p>\n<pre><code>v, ok = a[x]\nv, ok := a[x]\nvar v, ok = a[x]\n</code></pre>\n<p>yields an additional untyped boolean value. The value of <code>ok</code> is <code>true</code> if the key <code>x</code> is present in the map, and false otherwise.</p>\n</blockquote>\n<p>So you can use the special <code>v, ok := m[k]</code> form only if nothing else gets assigned.</p>\n<p>However, if you don't use the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"noreferrer\">zero value</a> of the value type of the map, you can do the check using a simple tuple-assignment; by not using the special form but 2 simple index expressions.</p>\n<p>For example if your value type is some interface type (e.g. <code>interface{}</code>), and you know you don't use the <code>nil</code> value, you may do the following:</p>\n<pre><code>if v1, v2 := m1[&quot;aaa&quot;], m2[&quot;aaa&quot;]; v1 != nil &amp;&amp; v2 != nil {\n    fmt.Printf(&quot;Both map contains key '%s': %v, %v\\n&quot;, &quot;aaa&quot;, v1, v2)\n}\n</code></pre>\n<p>Of course with a helper function, you can do it in one step:</p>\n<pre><code>func idx(m1, m2 map[string]interface{}, k string) (\n    v1, v2 interface{}, ok1, ok2 bool) {\n\n    v1, ok1 = m1[k]\n    v2, ok2 = m2[k]\n    return\n}\n</code></pre>\n<p>Using it:</p>\n<pre><code>if v1, v2, ok1, ok2 := idx(m1, m2, &quot;aaa&quot;); ok1 &amp;&amp; ok2 {\n    fmt.Printf(&quot;Both map contains key '%s': %v, %v\\n&quot;, &quot;aaa&quot;, v1, v2)\n}\n</code></pre>\n<p>Try the examples on the <a href=\"https://play.golang.org/p/mXtKW59dkQ\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1485986964, "creation_date": 1485986964, "answer_id": 41990758, "question_id": 41978101, "link": "https://stackoverflow.com/questions/41978101/check-if-key-exists-in-multiple-maps-in-one-condition/41990758#41990758", "title": "Check if key exists in multiple maps in one condition", "body": "<p>you could also use variadic parameter(three dots) to check multiple keys : </p>\n\n<pre><code>// check map 1 and map2 is null or not\nfunc checkMap(m1, m2 map[string]interface{}, keys ...string) []bool {\n    var isExist []bool\n\n    for key := range keys {\n        //checking value from map 1\n        _, ok := m1[keys[key]]\n        if ok {\n            isExist = append(isExist, true) // append for the first time to avoid panic\n        } else {\n            isExist = append(isExist, false) // append for the first time to avoid panic\n        }\n\n        // checking value from map2\n        _, ok = m2[keys[key]]\n        if ok {\n            isExist[key] = true\n        } else {\n            isExist[key] = false\n        }\n    }\n\n    return isExist\n}\n</code></pre>\n\n<p>And then you can check your keys in order like this : </p>\n\n<pre><code>result := checkMap(myMap, myMap2, \"a\", \"b\", \"c\", \"d\", \"e\", \"f\", \"g\")\nfmt.Printf(\"result = %+v\\n\", result) // print the result\n\nif result[0] {\n    fmt.Println(\"key a exist in both map\")\n}\n\nif result[1] {\n    fmt.Println(\"key b exist in both map\")\n} \n</code></pre>\n"}], "owner": {"reputation": 125, "user_id": 7432504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98d73e6185c4dd791637275f42c8b862?s=128&d=identicon&r=PG&f=1", "display_name": "wrwr", "link": "https://stackoverflow.com/users/7432504/wrwr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4128, "favorite_count": 0, "accepted_answer_id": 41978277, "answer_count": 2, "score": 10, "last_activity_date": 1485986964, "creation_date": 1485946913, "last_edit_date": 1485948075, "question_id": 41978101, "link": "https://stackoverflow.com/questions/41978101/check-if-key-exists-in-multiple-maps-in-one-condition", "title": "Check if key exists in multiple maps in one condition", "body": "<p>I need to check if the same key exists in two maps:</p>\n\n<pre><code>if v1, ok1 := map1[\"aaa\"]; ok1 {\n ...\n}\nif v2, ok2 := map2[\"aaa\"]; ok2 {\n ...\n}\n</code></pre>\n\n<p>Is it possible to join these two conditions into one? I managed to do something like this:</p>\n\n<pre><code>v1, ok1 := map1[\"aaa\"]\nv2, ok2 := map2[\"aaa\"]\nif ok1 &amp;&amp; ok2 {\n ...\n}\n</code></pre>\n\n<p>but I'm curious whether it (assigning and checking) can be done in one <code>if</code> condition.</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 0, "creation_date": 1485955102, "post_id": 41977601, "comment_id": 71139153, "body": "Have you found a regexp matching the base64 decoded content first? If there is no pattern at the binary level there won&#39;t be a pattern at the layer above (base64)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1485962163, "post_id": 41977601, "comment_id": 71144121, "body": "You detect them by decoding them into the proper data structure. A regex is not appropriate here."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1486012789, "post_id": 41977601, "comment_id": 71166223, "body": "It&#39;s not possible to use regex to detect RSA keys. Attempt to parse them in turn."}], "answers": [{"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1486032261, "last_edit_date": 1592644375, "creation_date": 1486028137, "answer_id": 41998622, "question_id": 41977601, "link": "https://stackoverflow.com/questions/41977601/regular-expression-to-detect-private-and-public-rsa-keys/41998622#41998622", "title": "Regular Expression to detect private and public RSA keys", "body": "<h3>Get pem formatted block</h3>\n<p>If your document contains not only PEM formatted block than <a href=\"https://golang.org/pkg/encoding/pem/#Decode\" rel=\"nofollow noreferrer\"><code>Decode</code></a> function from <code>encoding/pem</code> package will be helpful:</p>\n<blockquote>\n<p>Decode will find the next PEM formatted block (certificate, private key etc) in the input. It returns that block and the remainder of the input. If no PEM data is found, p is nil and the whole of the input is returned in rest.</p>\n</blockquote>\n<h3>Parse key and check for rsa conformity</h3>\n<p>Go contains package named <code>crypto</code> to do such things like parsing keys and certifies. For purpose of parsing public keys provided function <a href=\"https://golang.org/pkg/crypto/x509/#ParsePKIXPublicKey\" rel=\"nofollow noreferrer\"><code> ParsePKIXPublicKey</code></a>:</p>\n<blockquote>\n<p>Supported key types include RSA, DSA, and ECDSA. Unknown key types result in an error.</p>\n<p>On success, pub will be of type *rsa.PublicKey, *dsa.PublicKey, or *ecdsa.PublicKey.</p>\n</blockquote>\n<p>On return you obtain concrete type which is easy to assert with type switch (idiomatic way to determine type of variable):</p>\n<h3><a href=\"https://play.golang.org/p/9_1bdIyYoE\" rel=\"nofollow noreferrer\">Example</a>:</h3>\n<pre><code>// There is a key\nconst pubPEM = `MIICIjANBgkqhkiG9...`\n\n// Ignore the rest of document\nblock, _ := pem.Decode([]byte(pubPEM))\nif block == nil {\n    log.Fatal(&quot;The document doesn't contain PEM blocks.&quot;)\n}\n\npub, err := x509.ParsePKIXPublicKey(block.Bytes)\nif err != nil {\n    log.Fatal(&quot;The block is not a DER encoded public key.&quot;)\n}\n\nswitch pub := pub.(type) {\ncase *rsa.PublicKey:\n    fmt.Println(&quot;pub is of type RSA:&quot;, pub)\ndefault:\n    log.Fatal(&quot;The key is not RSA encripted.&quot;)\n}\n</code></pre>\n"}], "owner": {"reputation": 143, "user_id": 5053840, "user_type": "registered", "accept_rate": 14, "profile_image": "https://www.gravatar.com/avatar/4cb19df22047fe6f8fdc632f906e85ee?s=128&d=identicon&r=PG&f=1", "display_name": "Chenko47", "link": "https://stackoverflow.com/users/5053840/chenko47"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2699, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1486032261, "creation_date": 1485945537, "question_id": 41977601, "link": "https://stackoverflow.com/questions/41977601/regular-expression-to-detect-private-and-public-rsa-keys", "title": "Regular Expression to detect private and public RSA keys", "body": "<p>I've searched over the internet but with no results,\nThere is any pattern (to be implemented in regex) to detect RSA private or public keys ?</p>\n\n<p>(not included strings such as ---- Public RSA key-- or \"ssh rsa\")</p>\n\n<p>I'm stuck after create base64 regex </p>\n\n<pre><code>var re = regexp.MustCompile(`(?:[A-Za-z0-9+/]{4})*(?:[A-Za-z0-9+/]{2}==|[A-Za-z0-9+/]{3})=`)\n</code></pre>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 872312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/757f8bcbbca28cb59f95892a0a960869?s=128&d=identicon&r=PG", "display_name": "netsplit", "link": "https://stackoverflow.com/users/872312/netsplit"}, "edited": false, "score": 0, "creation_date": 1486391496, "post_id": 41977318, "comment_id": 71311645, "body": "How does it behave with non pointers? e.g. <code>value := C.size_t(5)</code>. Do they have to be free&#39;ed as well?"}], "tags": [], "owner": {"reputation": 801, "user_id": 6078745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09e9743aa6f4ee0f30e47abd7a60a69d?s=128&d=identicon&r=PG&f=1", "display_name": "Mario Dekena", "link": "https://stackoverflow.com/users/6078745/mario-dekena"}, "is_accepted": true, "score": 1, "last_activity_date": 1485944808, "creation_date": 1485944808, "answer_id": 41977318, "question_id": 41976730, "link": "https://stackoverflow.com/questions/41976730/how-to-free-c-variables-used-in-parameters/41977318#41977318", "title": "How to free C variables used in parameters", "body": "<p>If you use it as inline parameter, you can only free it inside the function. While you could do that, it's a really bad practice. If you use this function elsewhere with a variable that you plan on using later, it will free the variable unintentionally.</p>\n\n<p>Just move the string in front of the function call as a variable, call the function and then free it.</p>\n"}], "owner": {"reputation": 140, "user_id": 872312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/757f8bcbbca28cb59f95892a0a960869?s=128&d=identicon&r=PG", "display_name": "netsplit", "link": "https://stackoverflow.com/users/872312/netsplit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 41977318, "answer_count": 1, "score": 0, "last_activity_date": 1485944808, "creation_date": 1485943062, "question_id": 41976730, "link": "https://stackoverflow.com/questions/41976730/how-to-free-c-variables-used-in-parameters", "title": "How to free C variables used in parameters", "body": "<p><a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">https://golang.org/cmd/cgo/</a> says:</p>\n\n<pre><code>// The C string is allocated in the C heap using malloc.\n// It is the caller's responsibility to arrange for it to be\n// freed, such as by calling C.free (be sure to include stdlib.h\n// if C.free is needed).\n</code></pre>\n\n<p>What if I use <code>C.CString</code> inline as parameter? I would have to <code>free()</code> it anyways, right? What is best practise in this case?</p>\n\n<p>Example:</p>\n\n<pre><code>ret := C.RandomCFunction(C.CString(\"foo\"))\n</code></pre>\n"}, {"tags": ["go", "concurrency", "mutex"], "comments": [{"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1485944138, "post_id": 41976512, "comment_id": 71131878, "body": "you posted a lot of info. Thats nice. But hard to understand  on the spot. Concretise your problem, and add isolated example as link to golang playground."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485944394, "post_id": 41976512, "comment_id": 71132042, "body": "Also I can&#39;t see where you use it all concurrently. Until there is no <code>go</code> you don&#39;t need mutexes at all. I understand that somewhere it used concurrently but it should be shown."}, {"owner": {"reputation": 353, "user_id": 7084531, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YcySo.jpg?s=128&g=1", "display_name": "Leylandski", "link": "https://stackoverflow.com/users/7084531/leylandski"}, "reply_to_user": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1485944500, "post_id": 41976512, "comment_id": 71132126, "body": "@Altenrion will do. @i159 the goroutines are in the main package, this is just a config package, but both <code>Current()</code> and <code>Load()</code> theoretically could be called at any time from any one of them."}], "answers": [{"comments": [{"owner": {"reputation": 353, "user_id": 7084531, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YcySo.jpg?s=128&g=1", "display_name": "Leylandski", "link": "https://stackoverflow.com/users/7084531/leylandski"}, "edited": false, "score": 0, "creation_date": 1485945582, "post_id": 41977573, "comment_id": 71132898, "body": "Thank you, this is a very useful answer, and you actually read the full question instead of jumping to half-baked conclusions from skimming it and then downvoting without really understanding it, as happens so often on this site."}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 1, "creation_date": 1485955371, "post_id": 41977573, "comment_id": 71139347, "body": "Great catch! The mutext must not be part of the data being replaced."}], "tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": true, "score": 8, "last_activity_date": 1486026251, "last_edit_date": 1486026251, "creation_date": 1485945459, "answer_id": 41977573, "question_id": 41976512, "link": "https://stackoverflow.com/questions/41976512/do-i-need-a-mutex-if-i-am-returning-a-copy-of-the-variable-rather-than-a-pointer/41977573#41977573", "title": "Do I need a mutex if I am returning a copy of the variable rather than a pointer?", "body": "<p>When you read data which can be written at the same time you need a mutex. Otherwise it might happen that you read while it's written and get half of the old data and half of the new data.</p>\n\n<p>So your example seems to be just fine. Because you are probably reading the config very often but writing it rarely your usage of a <code>RWLock</code> makes sense. This means that multiple threads can read at the same time as long as it's not written.</p>\n\n<p>What in your code looks dangerous is:</p>\n\n<pre><code>programConfig.Lock()\nprogramConfig = newSettings\nprogramConfig.Unlock()\n</code></pre>\n\n<p>Because <code>programConfig</code> contains the <code>Mutex</code> you are doing the <code>Lock</code> and <code>Unlock</code> on different instances which will lead to deadlocks. You should add the <code>Mutex</code> to the \"parent\" of the instance. In this case probably the package.</p>\n"}], "owner": {"reputation": 353, "user_id": 7084531, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/YcySo.jpg?s=128&g=1", "display_name": "Leylandski", "link": "https://stackoverflow.com/users/7084531/leylandski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "accepted_answer_id": 41977573, "answer_count": 1, "score": 1, "last_activity_date": 1486026251, "creation_date": 1485942395, "question_id": 41976512, "link": "https://stackoverflow.com/questions/41976512/do-i-need-a-mutex-if-i-am-returning-a-copy-of-the-variable-rather-than-a-pointer", "title": "Do I need a mutex if I am returning a copy of the variable rather than a pointer?", "body": "<p>I'm a little confused about the use of <code>sync.Mutex</code> in Go. I understand the basic concept (calling <code>Lock()</code> will prevent other goroutines from executing the code between it and <code>Unlock()</code>), but I'm not sure if I <em>need</em> it here. I've seen a fair few C++ answers for this but in each example they all seem to be modifying and accessing a variable directly.</p>\n\n<p>This is my code from a package called configuration, which I will use throughout the application to get (surprisingly) configuration and settings information.</p>\n\n<pre><code>package config\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"os\"\n    \"sync\"\n\n    log \"github.com/sirupsen/logrus\"\n)\n\n/*\nConfigurationError is an implementation of the error interface describing errors that occurred while dealing with this\npackage.\n*/\ntype ConfigurationError string\n\n/*\nError prints the error message for this ConfigurationError. It also implements the error interface.\n*/\nfunc (ce ConfigurationError) Error() string {\n    return fmt.Sprintf(\"Configuration error: %s\", string(ce))\n}\n\n/*\nconfiguration is a data struct that holds all of the required information for setting up the program. It is unexported\nto prevent other packages creating more instances. Other packages that need settings information should call Current()\nto access a copy of the unexported programConfig package variable.\n*/\ntype configuration struct {\n    sync.RWMutex\n    LogLevel               log.Level `json:\"logLevel,omitempty\"`     //Logging\n    LogLocation            string    `json:\"logLocation,omitempty\"`  //-\n    HttpPort               int       `json:\"port,omitempty\"`         //Web\n    LoginUri               string    `json:\"loginUri\"`               //-\n    WebBaseUri             string    `json:\"webBaseUri\"`             //-\n    StaticBaseUri          string    `json:\"staticBaseUri\"`          //-\n    ApiBaseUri             string    `json:\"apiBaseUri\"`             //-\n    StaticContentLocalPath string    `json:\"staticContentLocalPath\"` //-\n    MaxSimultaneousReports int       `json:\"maxSimultaneousReports\"` //Reporting\n}\n\nvar programConfig configuration\n\n/*\nCurrent returns a copy of the currently loaded program configuration.\n*/\nfunc Current() configuration {\n    programConfig.RLock()\n    defer programConfig.RUnlock()\n    return programConfig\n}\n\n/*\nLoad attempts to load a JSON settings file containing a representation of the Configuration struct. It will then set\nthe value of the package-level config struct to the loaded values. Some settings changes will require a restart of the\nserver application.\n\nfilepath - the full path of the settings file including a leading slash or drive name (depending on the OS).\n*/\nfunc Load(filepath string) error {\n\n    //Open the file for reading.\n    settingsFile, err := os.Open(filepath)\n    if err != nil {\n        return ConfigurationError(err.Error())\n    }\n    defer settingsFile.Close()\n\n    //Decode JSON into package level var.\n    decoder := json.NewDecoder(settingsFile)\n    newSettings := configuration{}\n    err = decoder.Decode(&amp;newSettings)\n    if err != nil {\n        return ConfigurationError(err.Error())\n    }\n\n    programConfig.Lock() //I'm not 100% sure this is the correct use of a mutex for this situation, so check up on that.\n    programConfig = newSettings\n    programConfig.Unlock()\n    return nil\n\n}\n</code></pre>\n\n<p>As you can see, I've used mutex in two places. </p>\n\n<ul>\n<li>In <code>Current()</code>. Do I need this here if the function is not returning a pointer but a copy of the programConfig variable? The only way the underlying package variable will be modified is through the <code>Load()</code> function.</li>\n<li>In the <code>Load()</code> function. This can be called at any time by any goroutine, although it rarely will be.</li>\n</ul>\n\n<p>Given that, am I using them correctly and <em>why</em> do I need one when reading a copy of the data (if so)?</p>\n"}, {"tags": ["go", "websocket"], "answers": [{"comments": [{"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1485943589, "post_id": 41976860, "comment_id": 71131512, "body": "it might be nesessary if we would work with images of 10+GB size like in medicine diagnostics"}, {"owner": {"reputation": 552, "user_id": 7360228, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1440fb0824103ce98beb81fc4860714a?s=128&d=identicon&r=PG&f=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/7360228/saeed"}, "edited": false, "score": 0, "creation_date": 1485943656, "post_id": 41976860, "comment_id": 71131560, "body": "I can send on big message (file data bytes) but how can get progress (percent) of sending file without splitting in multiple frames?"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "edited": false, "score": 0, "creation_date": 1485943853, "post_id": 41976860, "comment_id": 71131701, "body": "be careful, moderators like to move long conversations in chatrooms. better practise - edit main question with details."}], "tags": [], "owner": {"reputation": 4764, "user_id": 2419922, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/41e095cca8abbfde0f1f52d73a1efcd7?s=128&d=identicon&r=PG", "display_name": "cshu", "link": "https://stackoverflow.com/users/2419922/cshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1485946030, "last_edit_date": 1485946030, "creation_date": 1485943412, "answer_id": 41976860, "question_id": 41976053, "link": "https://stackoverflow.com/questions/41976053/how-receive-binary-data-in-multiple-frames-in-go-lang/41976860#41976860", "title": "How receive binary data in multiple frames in go lang", "body": "<p>Usually it should be unnecessary to split data into multiple frames and then merge them.</p>\n\n<p>If you want to get progress, maybe the <code>func (ws *Conn) Read(msg []byte) (n int, err error)</code> can be called with a relatively small buffer size. So you don't read the whole message in one go. But you may have to always send the file size before file content. (e.g. first 8 bytes is always the file size, and file content starts from the 9th.) So you can use <code>sumOfReceivedSize / fileSize</code> to show the progress after each call of <code>Read</code>.</p>\n\n<hr>\n\n<p>If you want to split file data no matter what:</p>\n\n<p>Simply send the file size in the first message (as first 8 bytes), and then send all the rest chunks in separate messages.</p>\n\n<p>Multiple messages will be received, until the recipient gets enough data, i.e. reaches the file size.</p>\n"}], "owner": {"reputation": 552, "user_id": 7360228, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1440fb0824103ce98beb81fc4860714a?s=128&d=identicon&r=PG&f=1", "display_name": "Saeed", "link": "https://stackoverflow.com/users/7360228/saeed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 626, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1485946030, "creation_date": 1485940995, "last_edit_date": 1485946008, "question_id": 41976053, "link": "https://stackoverflow.com/questions/41976053/how-receive-binary-data-in-multiple-frames-in-go-lang", "title": "How receive binary data in multiple frames in go lang", "body": "<p>I successfully sent file data in the <code>form</code> of a frame to the <code>websocket</code>. I can split file data in multiple frames and send to <code>websocket</code>, but i don't know how to receive and merge frames in one data array.</p>\n\n<p>I gonna do this for getting progress of sending file to websocket:</p>\n\n<pre><code>import (\n    \"golang.org/x/net/websocket\"\n    \"io/ioutil\"\n    ...\n    ...\n)\n...\n...\nvar data []byte\nerr = websocket.Message.Receive(ws, &amp;data)\nif (err == nil) {\n    ioutil.WriteFile(\"/home/img.jpg\", data, 0644)\n}\n</code></pre>\n"}, {"tags": ["parsing", "templates", "go", "interface"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1485941881, "post_id": 41975647, "comment_id": 71130419, "body": "Try map[string]interface{}"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485942338, "post_id": 41975647, "comment_id": 71130718, "body": "Your question is about unmarshaling (as I understood it) not about templates. Please change the topic to something like: &quot;Unmarshal multi-item json with GoLang&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3809560, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4221ab68448e9413c315147180574ac0?s=128&d=identicon&r=PG&f=1", "display_name": "user3809560", "link": "https://stackoverflow.com/users/3809560/user3809560"}, "edited": false, "score": 0, "creation_date": 1485948571, "post_id": 41976352, "comment_id": 71134835, "body": "Maybe what i &#39;ll need to do is to create a struct that holds the fields of the product Struct and another Struct say Data that hold the types User and Product. I need to unmarshal the json into the product struct and pass on Data to the render function. I &#39;ve been trying, but am not able to get it right"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 97, "user_id": 3809560, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4221ab68448e9413c315147180574ac0?s=128&d=identicon&r=PG&f=1", "display_name": "user3809560", "link": "https://stackoverflow.com/users/3809560/user3809560"}, "edited": false, "score": 0, "creation_date": 1485955140, "post_id": 41976352, "comment_id": 71139179, "body": "You can unmarshal the jason obj as you want but I have no idea what is type Product and how to use it in code I never saw. All I can consider that the json obj you posted could be unmarshaled to []map[string]string easily."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1485955457, "last_edit_date": 1485955457, "creation_date": 1485941893, "answer_id": 41976352, "question_id": 41975647, "link": "https://stackoverflow.com/questions/41975647/how-to-pass-multiple-data-objects-to-html-templates-in-golang/41976352#41976352", "title": "How to pass multiple data objects to HTML templates in Golang", "body": "<p>You don't need a <code>map[interface{}]string</code> to unmarshal the json obj. Your json is equivalent to slice of maps:</p>\n\n<pre><code>[\n    {\n        \"image\":\"1Appleiphone7.jpeg\",\n        \"pname\":\"iphone7\",\n        \"price\":\"70000\",\n        \"puid\":\"d6742e4e-2ad6-43c5-97f4-e8a7b00684e2\",\n        \"quantity\":\"100\"\n    }\n]\n</code></pre>\n\n<p>The object to unmarshal should be a slice of maps with string keys and values:</p>\n\n<pre><code>var Pr []map[string]string\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/bP-v94uMWO\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>BTW, I believe misunderstanding is hidden there:</p>\n\n<blockquote>\n  <p>The render function takes an argument of the type interface{}</p>\n</blockquote>\n\n<p>I means not that you must pass a variable of <code>interface{}</code> type there but it means you CAN pass a <strong>variable of any type</strong> to <code>render</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 97, "user_id": 3809560, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4221ab68448e9413c315147180574ac0?s=128&d=identicon&r=PG&f=1", "display_name": "user3809560", "link": "https://stackoverflow.com/users/3809560/user3809560"}, "is_accepted": true, "score": 0, "last_activity_date": 1486200989, "creation_date": 1486200989, "answer_id": 42038761, "question_id": 41975647, "link": "https://stackoverflow.com/questions/41975647/how-to-pass-multiple-data-objects-to-html-templates-in-golang/42038761#42038761", "title": "How to pass multiple data objects to HTML templates in Golang", "body": "<p>I am posting a working example of unmarshalling json as bytes into a struct type which then can be referenced using the <code>{{.}}</code> in the template.   </p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Usrdata struct {\n    Uuid  string\n    Fname string\n}\n\ntype Prdata struct {\n    Puid     string `json:\"puid\"`\n    Pname    string `json:\"pname\"`\n    Quantity string `json:\"quantity\"`\n    Price    string `json:\"price\"`\n    Image    string `json:\"image\"`\n}\n\ntype Data struct {\n    U Usrdata\n    P []Prdata\n}\n\nfunc main() {\n    Ur := Usrdata{Uuid: \"xyz\", Fname: \"Somename\"}\n    Pr := make([]Prdata, 0)\n    var Dt Data\n    Dt.U = Ur\n    pdata := `[{\"image\":\"1Appleiphone7.jpeg\",\"pname\":\"iphone7\",\"price\":\"70000\",\"puid\":\"d6742e4e-2ad6-43c5-97f4-e8a7b00684e2\",\"quantity\":\"100\"}]`\n    err := json.Unmarshal([]byte(pdata), &amp;Pr)\n    if err != nil {\n        fmt.Println(err)\n    }\n    Dt.P = Pr\n    fmt.Println(Pr[0].Pname)\n    fmt.Println(Pr)\n    fmt.Println(Dt)\n}\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 3809560, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4221ab68448e9413c315147180574ac0?s=128&d=identicon&r=PG&f=1", "display_name": "user3809560", "link": "https://stackoverflow.com/users/3809560/user3809560"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1966, "favorite_count": 0, "accepted_answer_id": 42038761, "answer_count": 2, "score": 0, "last_activity_date": 1486200989, "creation_date": 1485939714, "last_edit_date": 1486026608, "question_id": 41975647, "link": "https://stackoverflow.com/questions/41975647/how-to-pass-multiple-data-objects-to-html-templates-in-golang", "title": "How to pass multiple data objects to HTML templates in Golang", "body": "<p>I am returing all rows of a table as json to the variable <code>pdata</code> and unmarshaling it into an interface object.\nI have an instance of the user struct which I would like to pass along with the unmarshalled json data to the render function and access it using field arguments <code>{{.fieldname}}</code> in the html template.</p>\n\n<pre><code>if uuid != \"\" {\n    pdata, err := getProduct()\n    if err != nil {\n        fmt.Println(err)\n    } \n\n    type Prdata struct {\n        Puid     string `json:\"puid\"`\n        Pname    string `json:\"pname\"`\n        Quantity string `json:\"quantity\"`\n        Price    string `json:\"price\"`\n        Image    string `json:\"image\"`\n    }\n\n    // Obj:= make(map[Prdata]string)\n\n    var Pr Prdata\n\n    err = json.Unmarshal(pdata , &amp;Pr)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(string(pdata))\n    fmt.Println(Pr)\n    fmt.Println(u)\n\n    render(w, \"internal\", Pr)\n}\n</code></pre>\n\n<p><code>fmt.Println(string(pdata))</code> gives this output</p>\n\n<blockquote>\n  <p>[{\"image\":\"1Appleiphone7.jpeg\",\"pname\":\"iphone7\",\"price\":\"70000\",\"puid\":\"d6742e4e-2ad6-43c5-97f4-e8a7b00684e2\",\"quantity\":\"100\"}]</p>\n</blockquote>\n\n<p>I have only been successful to unmarshal the data into an <code>interface{}</code> object. Trying to make maps with keys of the type <code>interface{}</code> and values of type <code>string</code> but it throws the error:</p>\n\n<blockquote>\n  <p>\"json: cannot unmarshal array into Go value of type map[interface {}]string\"</p>\n</blockquote>\n\n<p>The render function takes an argument of the type <code>interface{}</code></p>\n\n<pre><code>func render(w http.ResponseWriter, name string, data interface{})\n</code></pre>\n\n<p><code>fmt.Println(Pr)</code> gives this output:</p>\n\n<blockquote>\n  <p>[map[quantity:100 image:1Appleiphone7.jpeg pname:iphone7 price:70000 puid:d6742e4e-2ad6-43c5-97f4-e8a7b00684e2]]</p>\n</blockquote>\n\n<p><code>u</code> is an instance of struct <code>User</code></p>\n\n<pre><code>var u = &amp;User{}\n\ntype User struct {\n    Uuid     string            \n    Username string           \n    Password string           \n    Fname    string            \n    Email    string            \n}\n</code></pre>\n\n<p>I can see the output on the html page using the pipeline <code>{{.}}</code>. However I am not able to access any data using the fieldname.</p>\n\n<p>There must be a way of doing this. But I am not sure how? </p>\n\n<p>When I pass of a json of the type below, I am able to pass it to the struct type and reference it by the key values using pipelines in my template.</p>\n\n<pre><code>    str := `{\n    \"image\": \"1Appleiphone7.jpeg\",\n    \"pname\": \"iphone7\",\n    \"price\": \"70000\",\n    \"puid\": \"d6742e4e-2ad6-43c5-97f4-e8a7b00684e2\",\n    \"quantity\": \"100\"\n    }`\n</code></pre>\n\n<p>unmarshal function </p>\n\n<pre><code>err = json.Unmarshal([]byte(str), &amp;Pr)\n</code></pre>\n\n<p>The difference in the json data of the DB record <code>pdata</code> and the one above <code>str</code> is in the use of backticks \"`\". It seems that though the json data shows key value pairs, it is actually a json array and not a json object. Is there a way to get around this?</p>\n"}, {"tags": ["go", "struct", "types"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 1, "creation_date": 1485934673, "post_id": 41971939, "comment_id": 71126464, "body": "How is the aboveassign an embedded struct to the tyoe <code>UserModel</code> ?"}, {"owner": {"reputation": 1659, "user_id": 302646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYT9J.png?s=128&g=1", "display_name": "Makkes", "link": "https://stackoverflow.com/users/302646/makkes"}, "edited": false, "score": 0, "creation_date": 1485937095, "post_id": 41971939, "comment_id": 71127587, "body": "Your code just defines a type and adds a method for that type. See <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Struct_types</a> for the definition of struct types and embedded fields."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485939769, "post_id": 41971939, "comment_id": 71129061, "body": "This question could be the down vote champion \u0425) There is no embedding. It is a struct with a method. It is possible to define methods for other types."}, {"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "reply_to_user": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485955637, "post_id": 41971939, "comment_id": 71139511, "body": "@I159 I guess it&#39;s too tedious to type something like &quot;ohh dude, those are called methods, not &quot;embedded structs&quot;. lol noob&quot; K, thanks"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485955761, "post_id": 41971939, "comment_id": 71139599, "body": "@borislemke, do you still need an answer about methods definition for different types?"}, {"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "reply_to_user": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485956061, "post_id": 41971939, "comment_id": 71139807, "body": "@I159 let me do the walk of shame with this question, probably deserved it"}], "answers": [{"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 2, "last_activity_date": 1485957959, "last_edit_date": 1485957959, "creation_date": 1485957253, "answer_id": 41981531, "question_id": 41971939, "link": "https://stackoverflow.com/questions/41971939/is-it-possible-to-add-a-variable-embedded-variables-to-a-struct/41981531#41981531", "title": "Is it possible to add a variable &quot;embedded variables&quot; to a struct?", "body": "<h3>Methods</h3>\n\n<p>Methods is a functions with receivers bound to a types. Receiver could take a value or a pointer to a type which method bound to.</p>\n\n<p>Go by example provides this nice <a href=\"https://play.golang.org/p/254m_9Yjwa\" rel=\"nofollow noreferrer\">example</a>:</p>\n\n<pre><code>type rect struct {\n    width, height int\n}\n\n// This `area` method has a _receiver type_ of `*rect`.\nfunc (r *rect) area() int {\n    return r.width * r.height\n}\n\n// Methods can be defined for either pointer or value\n// receiver types. Here's an example of a value receiver.\nfunc (r rect) perim() int {\n    return 2*r.width + 2*r.height\n}\n</code></pre>\n\n<p>And yes you can define methods on almost all existing types except <code>interface</code>. Also it must be local type (defined in a package not built-in)</p>\n\n<pre><code>type Int int\n\nfunc (i Int) Add(j Int) Int {\n    return i + j\n}\n</code></pre>\n\n<h3>Embedding</h3>\n\n<p>Generalizing \"Effective Go\" a bit:</p>\n\n<p>The methods of embedded types come along for free. Which means that if type B embedded to type A than type A not only has its own methods it also has methods of type B.</p>\n\n<p>Extending previous example:</p>\n\n<pre><code>type parallelogram struct {\n    rect // Embedding. parallelogram has area and perim methods\n    depth int\n}\n\nfunc (p parallelogram) volume () int { // Extending rect\n    // Volume logic\n}\n</code></pre>\n"}], "owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "answer_count": 1, "score": -3, "last_activity_date": 1485957959, "creation_date": 1485923487, "question_id": 41971939, "link": "https://stackoverflow.com/questions/41971939/is-it-possible-to-add-a-variable-embedded-variables-to-a-struct", "title": "Is it possible to add a variable &quot;embedded variables&quot; to a struct?", "body": "<pre><code>type UserModel struct {\n    ...\n}\n\nfunc (u *UserModel) C() string {\n    return \"system_users\"\n}\n</code></pre>\n\n<p>The above will assign an embedded struct to the type <code>UserModel</code>, does Go allow the same to be done with <code>var</code>s or <code>const</code>s?</p>\n\n<p>Something like</p>\n\n<pre><code>var (u *UserModel) C = \"system_users\"\n</code></pre>\n\n<p>You get the idea.</p>\n"}, {"tags": ["vim", "go", "vi", "vim-plugin"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 3, "creation_date": 1485919860, "post_id": 41971246, "comment_id": 71121143, "body": "use only <code>fatih&#47;vim-go</code> instead, it integrates guru, and once you have the basic plugin you can just run <code>:GoInstallBinaries</code>"}, {"owner": {"reputation": 654, "user_id": 2867339, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/Ly1g1.jpg?s=128&g=1", "display_name": "Altenrion", "link": "https://stackoverflow.com/users/2867339/altenrion"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1485944217, "post_id": 41971246, "comment_id": 71131919, "body": "@Plato add this as answer then. That is a best practise here)"}], "answers": [{"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": true, "score": 3, "last_activity_date": 1485955978, "creation_date": 1485955978, "answer_id": 41981110, "question_id": 41971246, "link": "https://stackoverflow.com/questions/41971246/error-opening-vim/41981110#41981110", "title": "Error opening vim", "body": "<p><a href=\"https://github.com/fatih/vim-go\" rel=\"nofollow noreferrer\">Vim-Go</a> - all in one Go plugin for Vim. The best plugin I ever saw. Thanks to <a href=\"https://github.com/fatih\" rel=\"nofollow noreferrer\">Fatih Arslan</a> (btw he made a lot of excellent tools for Go).</p>\n"}], "owner": {"reputation": 105, "user_id": 3966197, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/559991476/picture?type=large", "display_name": "Marian Montagnino", "link": "https://stackoverflow.com/users/3966197/marian-montagnino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 41981110, "answer_count": 1, "score": 4, "last_activity_date": 1485955978, "creation_date": 1485918373, "question_id": 41971246, "link": "https://stackoverflow.com/questions/41971246/error-opening-vim", "title": "Error opening vim", "body": "<p>I just installed VimPlug and several golang imported tools and plugins.  I'm not sure where the first place to look at in order to disable this installation of oracle since it's been replaced with guru.</p>\n\n<pre><code>$ vim\nInstalling golang.org/x/tools/cmd/oracle\nError installing golang.org/x/tools/cmd/oracle: \nPress ENTER or type command to continue\n</code></pre>\n"}, {"tags": ["ssl", "go", "packet-sniffers"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1485886579, "post_id": 41964431, "comment_id": 71108222, "body": "What is the ciphersuite being negotiated? The preferred keyexchange algorithms are now ECDHE, which you can&#39;t decrypt without the pre-master secret. The point of forward secrecy is so that the stream <i>can&#39;t</i> be decrypted later."}, {"owner": {"reputation": 89, "user_id": 4668840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6dbaef9ca71e4a35e23e2843c555f?s=128&d=identicon&r=PG&f=1", "display_name": "davidear", "link": "https://stackoverflow.com/users/4668840/davidear"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485958501, "post_id": 41964431, "comment_id": 71141552, "body": "i see, we have AES_128_GCM with ECDHE_RSA, I thought if the webserver can decrypt the data with key and certificate on the same machine we would be able to do that as well ? wouldn&#39;t the pre-master secret being exchanged as well so we could grab it and decrypt it? thank you"}, {"owner": {"reputation": 89, "user_id": 4668840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6dbaef9ca71e4a35e23e2843c555f?s=128&d=identicon&r=PG&f=1", "display_name": "davidear", "link": "https://stackoverflow.com/users/4668840/davidear"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485958835, "post_id": 41964431, "comment_id": 71141792, "body": "wireshark can do it on the client side <a href=\"https://jimshaver.net/2015/02/11/decrypting-tls-browser-traffic-with-wireshark-the-easy-way/\" rel=\"nofollow noreferrer\">jimshaver.net/2015/02/11/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1485960882, "post_id": 41964431, "comment_id": 71143190, "body": "The secret is shared via a DH exchange, so it doesn&#39;t go over the wire. You need access to the client, and the wireshark example there uses session key logging, which I&#39;m pretty sure is a feature only in nss, and really only used in firefox."}, {"owner": {"reputation": 89, "user_id": 4668840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6dbaef9ca71e4a35e23e2843c555f?s=128&d=identicon&r=PG&f=1", "display_name": "davidear", "link": "https://stackoverflow.com/users/4668840/davidear"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485965455, "post_id": 41964431, "comment_id": 71146653, "body": "yes sorry wrong example, so i am trying to do it in the server , I did it a bit more digging and as I understand the DH exchange the server would receive the client public key encrypted, which then it combines with his private key to have the shared secret. and because I am trying to decrypt only incoming packets not the full http conversation, if i sniff the key exchange wouldn&#39;t i be able to get decryptable data from there to decrypt the rest of the packets ? thanks for the hints"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1486045969, "post_id": 41964431, "comment_id": 71185724, "body": "In ECDHE_RSA, the keys are only used for signing the exchange, the ephemeral keys never go over the wire. Decrypting the traffic even when you do have the key data is still not trivial. I would start with seeing how wireshark handles your traffic, as it probably has the best support right now for recording and decrypting tls streams."}, {"owner": {"reputation": 89, "user_id": 4668840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6dbaef9ca71e4a35e23e2843c555f?s=128&d=identicon&r=PG&f=1", "display_name": "davidear", "link": "https://stackoverflow.com/users/4668840/davidear"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1487085018, "post_id": 41964431, "comment_id": 71618623, "body": "yes we could capture the client public key and build the ephemeral from there on the server probably but is much more complex then i thought also because stream needs to be reassembled in correct order, and for each connection keep track of these details is a huge task, thanks a lot"}, {"owner": {"reputation": 555, "user_id": 5675692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcbd2723a6bbde29f0a7f62e6651475a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashvin Sharma", "link": "https://stackoverflow.com/users/5675692/ashvin-sharma"}, "edited": false, "score": 0, "creation_date": 1607409967, "post_id": 41964431, "comment_id": 115256406, "body": "I happened to have a similar problem, did you solve it?"}, {"owner": {"reputation": 89, "user_id": 4668840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6dbaef9ca71e4a35e23e2843c555f?s=128&d=identicon&r=PG&f=1", "display_name": "davidear", "link": "https://stackoverflow.com/users/4668840/davidear"}, "reply_to_user": {"reputation": 555, "user_id": 5675692, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/fcbd2723a6bbde29f0a7f62e6651475a?s=128&d=identicon&r=PG&f=1", "display_name": "Ashvin Sharma", "link": "https://stackoverflow.com/users/5675692/ashvin-sharma"}, "edited": false, "score": 0, "creation_date": 1617015715, "post_id": 41964431, "comment_id": 118173448, "body": "Hi @AshvinSharma no at the end even having all the certificates I didn&#39;t manage can&#39;t remember now if was just not possible or we got stuck on something, we let nginx handle the ssl and we analyse the packets after that"}], "owner": {"reputation": 89, "user_id": 4668840, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7aa6dbaef9ca71e4a35e23e2843c555f?s=128&d=identicon&r=PG&f=1", "display_name": "davidear", "link": "https://stackoverflow.com/users/4668840/davidear"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1485885693, "creation_date": 1485885693, "question_id": 41964431, "link": "https://stackoverflow.com/questions/41964431/how-to-decode-encrypted-ssl-packets-in-go", "title": "How to decode encrypted ssl packets in Go?", "body": "<p>we are building a packet sniffer in go using gopacket, now the issue is for ssl traffic I am trying to decode the data, I have the key and certificate on the server but online i can find only partial answers, I am trying to use the x509 in the crypt package and the openssl package from spacemonkey, with not much success, any tutorial or suggestion I can look at ? I think i miss some bits on how to manipulate the private key and certificates</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go", "https"], "comments": [{"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 0, "creation_date": 1485883392, "post_id": 41963270, "comment_id": 71106403, "body": "<a href=\"http://goroutines.com/ssl\" rel=\"nofollow noreferrer\">goroutines.com/ssl</a>"}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1485883639, "post_id": 41963507, "comment_id": 71106562, "body": "Sounds more like he&#39;s asking about SSL without client certs (totally doable, an in fact the default behavior), not SSL without server certs (not possible)."}, {"owner": {"reputation": 91, "user_id": 4974819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8863c88cfb3e0362cb55b63e5dc82b93?s=128&d=identicon&r=PG&f=1", "display_name": "lplatz", "link": "https://stackoverflow.com/users/4974819/lplatz"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1485884039, "post_id": 41963507, "comment_id": 71106782, "body": "ah - i read as &#39;client&#39; being who he was implementing for. you&#39;re totally right @Kaedys"}], "tags": [], "owner": {"reputation": 91, "user_id": 4974819, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8863c88cfb3e0362cb55b63e5dc82b93?s=128&d=identicon&r=PG&f=1", "display_name": "lplatz", "link": "https://stackoverflow.com/users/4974819/lplatz"}, "is_accepted": false, "score": 0, "last_activity_date": 1485883999, "last_edit_date": 1485883999, "creation_date": 1485882711, "answer_id": 41963507, "question_id": 41963270, "link": "https://stackoverflow.com/questions/41963270/howto-write-https-sever-no-certificate-in-golang/41963507#41963507", "title": "Howto write https sever no certificate in golang?", "body": "<p>Https requests require SSL Certificates.. you can create a self signed one, but you should get a real, valid certificate for any production ready server.</p>\n\n<p>Just 1 way to make a self signed cert: <a href=\"https://devcenter.heroku.com/articles/ssl-certificate-self\" rel=\"nofollow noreferrer\">https://devcenter.heroku.com/articles/ssl-certificate-self</a></p>\n"}, {"comments": [{"owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485889642, "post_id": 41963927, "comment_id": 71109941, "body": "Thanks for the reply, so if server does not validate the certificate even then we have to generate <code>cert</code> and <code>key</code> file."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "edited": false, "score": 0, "creation_date": 1485890717, "post_id": 41963927, "comment_id": 71110478, "body": "The client doesn&#39;t need to provide the certs at all, no.  The <i>server</i> still needs valid cert files, but the client doesn&#39;t unless you set the <code>http.Server.ClientAuth</code> field."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 0, "last_activity_date": 1485884025, "creation_date": 1485884025, "answer_id": 41963927, "question_id": 41963270, "link": "https://stackoverflow.com/questions/41963270/howto-write-https-sever-no-certificate-in-golang/41963927#41963927", "title": "Howto write https sever no certificate in golang?", "body": "<p>This could go two different directions depending on what you're actually asking.</p>\n\n<p>If you're asking how to host <code>https</code> requests without the <em>server</em> having a certificate, that's impossible.  <code>https</code> requests mean that the connection is secured by SSL/TLS, which necessarily requires a server certificate to function.</p>\n\n<p>If you're asking how to host <code>https</code> requests without requiring <em>clients</em> to have certificates, that's another matter, and in fact is the default behavior of the <code>http.Server</code>.  You actually have to set the <code>https.Server</code> field <code>ClientAuth</code> (for example, to <code>http.RequireAndVerifyClientCert</code>) in order to actually require those certs.  If you don't set this field, the default value is <code>http.NoClientCert</code>, which allows client connections without certificates, and doesn't validate the certs even if they are presented.</p>\n"}], "owner": {"reputation": 387, "user_id": 4160072, "user_type": "registered", "accept_rate": 64, "profile_image": "https://lh4.googleusercontent.com/-87BjCfblqW4/AAAAAAAAAAI/AAAAAAAAAuU/96eymOXkgvs/photo.jpg?sz=128", "display_name": "Mohammed", "link": "https://stackoverflow.com/users/4160072/mohammed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 41963927, "answer_count": 2, "score": -1, "last_activity_date": 1485884025, "creation_date": 1485882040, "question_id": 41963270, "link": "https://stackoverflow.com/questions/41963270/howto-write-https-sever-no-certificate-in-golang", "title": "Howto write https sever no certificate in golang?", "body": "<p>I am trying to write a server logic which takes 'https' request but client does not have any certificate, how do I write it?</p>\n"}, {"tags": ["templates", "go", "range", "add"], "comments": [{"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1485878842, "post_id": 41962055, "comment_id": 71103163, "body": "You could use <code>{{ range $i, $e := .topicsUp }}</code> and then use <code>{{ add $i $startingValue }}</code> in the place where it&#39;s used."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485878982, "post_id": 41962055, "comment_id": 71103281, "body": "Template variables are &quot;read-only&quot;, you can&#39;t change their values. You may use registered functions to simulate the behavior, or a function which takes <code>$i</code> and returns a value after adding an offset."}, {"owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "reply_to_user": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "edited": false, "score": 0, "creation_date": 1485883357, "post_id": 41962055, "comment_id": 71106383, "body": "@Thomas Thanks. That brought me to the solution."}], "owner": {"reputation": 5055, "user_id": 1903257, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/op6HW.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1903257/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1808, "favorite_count": 0, "closed_date": 1485878914, "answer_count": 0, "score": 2, "last_activity_date": 1485883703, "creation_date": 1485878656, "last_edit_date": 1495540891, "question_id": 41962055, "link": "https://stackoverflow.com/questions/41962055/how-to-increment-an-index-variable-i-in-go", "closed_reason": "Duplicate", "title": "How to increment an index variable $i in Go?", "body": "<p>I try to increment $i (I know that I could use <code>{{ range $i, $e := .topicsUp }}</code>, but I need different start values for $i):</p>\n\n<pre><code>{{ $i := 0 }}\n{{ range .topicsUp }}\n&lt;div class=\"item item{{ $i }}\"&gt;\n    ...\n&lt;/div&gt;\n{{ $i := (add $i 1) }}\n{{ end }}\n</code></pre>\n\n<p>I tried also</p>\n\n<pre><code>{{ add $i 1 }}\n</code></pre>\n\n<p>Both leave $i with value 0.</p>\n\n<p>Why?</p>\n\n<p>As @icza stated the question is similar to <a href=\"https://stackoverflow.com/questions/36521839/how-to-create-a-global-variable-and-change-in-multiple-places-in-golang-html-tem\">How to create a global variable and change in multiple places in golang html/template?</a>, but has an additional practical answer, that acually let me find a solution.</p>\n"}, {"tags": ["go", "memory-leaks"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1485878438, "post_id": 41961906, "comment_id": 71102851, "body": "Note that every step of that for loop is going to allocate some memory (mostly because of WriteString, iirc), and that memory will persist until garbage collection.  Saw the same thing in my own loop, which allocated a hundred or so bytes per loop iteration until garbage collection.  It&#39;s not a leak, it&#39;s just normal allocation."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485880667, "post_id": 41961906, "comment_id": 71104460, "body": "@VaD: ReadMemStats is as accurate as you can get, as that shows all allocations made by the Go runtime. Maybe track the output of <code>gctrace</code> to see how memory is being collected on your system."}, {"owner": {"reputation": 79, "user_id": 7495780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0804b2fde3cd14d8b56a0cca2ebf84ea?s=128&d=identicon&r=PG&f=1", "display_name": "VaD", "link": "https://stackoverflow.com/users/7495780/vad"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1485880798, "post_id": 41961906, "comment_id": 71104582, "body": "@Kaedys I did some research before asking that question, and I arrived to the same conclusion. Even though it occurs in simpler programs such as writing the output to stdout instead of a file, or using pprof. But I still cannot figure out how I can get accurate memory usage tracking of the command I run through Go (using <code>exec.Command</code>), I want to be able to tell if that command is leaking memory."}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "edited": false, "score": 0, "creation_date": 1539187300, "post_id": 41961906, "comment_id": 92413283, "body": "<a href=\"https://stackoverflow.com/a/44711589/2777965\">stackoverflow.com/a/44711589/2777965</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1506, "user_id": 8689709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9cd57855e7bff23fbca35abc8ddc0073?s=128&d=identicon&r=PG", "display_name": "Bill Zelenko", "link": "https://stackoverflow.com/users/8689709/bill-zelenko"}, "is_accepted": false, "score": 0, "last_activity_date": 1541000429, "creation_date": 1541000429, "answer_id": 53087199, "question_id": 41961906, "link": "https://stackoverflow.com/questions/41961906/how-to-track-memory-usage-accurately/53087199#53087199", "title": "How to track memory usage accurately?", "body": "<p>On Linux (RedHat) the following will show memory usage:\n<code>ps -No pid,comm,size,vsize,args:90</code></p>\n"}], "owner": {"reputation": 79, "user_id": 7495780, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0804b2fde3cd14d8b56a0cca2ebf84ea?s=128&d=identicon&r=PG&f=1", "display_name": "VaD", "link": "https://stackoverflow.com/users/7495780/vad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4337, "favorite_count": 4, "answer_count": 1, "score": 7, "last_activity_date": 1611251611, "creation_date": 1485878289, "last_edit_date": 1611251611, "question_id": 41961906, "link": "https://stackoverflow.com/questions/41961906/how-to-track-memory-usage-accurately", "title": "How to track memory usage accurately?", "body": "<p>I am trying to build a small tool that will allow me to run a program and track memory usage through Go. I am using <code>r.exec = exec.Command(r.Command, r.CommandArgs...)</code> to run the command, and runtime.MemStats to track memory usage (in a separate go routine):</p>\n<pre><code>func monitorRuntime() {\n    m := &amp;runtime.MemStats{}\n    f, err := os.Create(fmt.Sprintf(&quot;mmem_%s.csv&quot;, getFileTimeStamp()))\n    if err != nil {\n        panic(err)\n    }\n    f.WriteString(&quot;Time;Allocated;Total Allocated; System Memory;Num Gc;Heap Allocated;Heap System;Heap Objects;Heap Released;\\n&quot;)\n    for {\n        runtime.ReadMemStats(m)\n        f.WriteString(fmt.Sprintf(&quot;%s;%d;%d;%d;%d;%d;%d;%d;%d;\\n&quot;, getTimeStamp(), m.Alloc, m.TotalAlloc, m.Sys, m.NumGC, m.HeapAlloc, m.HeapSys, m.HeapObjects, m.HeapReleased))\n        time.Sleep(5 * time.Second)\n    }\n}\n</code></pre>\n<p>When I tested my code with simple program that just sits there (for about 12 hours), I noticed that Go is constantly allocating more memory:\n<a href=\"https://i.stack.imgur.com/LYBdb.png\" rel=\"nofollow noreferrer\">System Memory</a>\n<a href=\"https://i.stack.imgur.com/lFDET.png\" rel=\"nofollow noreferrer\">Heap Allocation</a></p>\n<p>I did a few more tests such as running the <code>monitorRuntime()</code> function without any other code, or using pprof, such as:</p>\n<pre><code>package main\n\nimport (\n    &quot;net/http&quot;\n    _ &quot;net/http/pprof&quot;\n)\n\nfunc main() {\n    http.ListenAndServe(&quot;:8080&quot;, nil)\n}\n</code></pre>\n<p>Yet I still noticed that memory allocation keeps going up just like in the graphs.</p>\n<p>How can I accurately track memory usage of the program I want to run through Go?\nI know one way, which I used in the past, is to use <code>/proc/$PID/statm</code>, but that file doesn't exist in every operating system (such as MacOS or Windows)</p>\n"}, {"tags": ["algorithm", "go", "hash", "rune"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485875036, "post_id": 41960747, "comment_id": 71100330, "body": "what do you mean by &quot;binary&quot;? Your example of changing a string to <code>*****</code> and magically transforming it back doesn&#39;t make any sense"}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485875428, "post_id": 41960747, "comment_id": 71100599, "body": "like this <a href=\"https://gist.github.com/hutt/8978333\" rel=\"nofollow noreferrer\">gist.github.com/hutt/8978333</a> (using php)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485875797, "post_id": 41960747, "comment_id": 71100846, "body": "I still don&#39;t understand. A string is just a slice of bytes, and can be converted  directly to <code>[]byte</code>, it already is as &quot;binary&quot; as you can get. Please show exactly the output you expect."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485875965, "post_id": 41960747, "comment_id": 71100951, "body": "<code>1101000 1100101 1101100 1101100 1101111</code> == <code>hello</code> in this php source"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485876079, "post_id": 41960747, "comment_id": 71101021, "body": "<a href=\"https://play.golang.org/p/5I2DIWisKF\" rel=\"nofollow noreferrer\">play.golang.org/p/5I2DIWisKF</a>?"}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485876801, "post_id": 41960747, "comment_id": 71101552, "body": "how store %b without [ and ] character? and also delete <code>\\s</code>(space) ? not have optional then auto delete? replace may not good for speed."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485876891, "post_id": 41960747, "comment_id": 71101628, "body": "i think this is not good. i want a function then for all char of text and convert every char. then i can change , and add more hash on them. and speed important."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485876954, "post_id": 41960747, "comment_id": 71101690, "body": "What is the purpose of this? This isn&#39;t a &quot;hash&quot; as you&#39;ve called it here, it&#39;s simply changing the string representation, so you&#39;re going to be limited by manipulating strings."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485877093, "post_id": 41960747, "comment_id": 71101794, "body": "yes , is right. but next i want hash them...."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485877131, "post_id": 41960747, "comment_id": 71101822, "body": "i want two function like <a href=\"http://gist.github.com/hutt/8978333\" rel=\"nofollow noreferrer\">PHP Script</a> for Go."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485877487, "post_id": 41960747, "comment_id": 71102088, "body": "<code>&lt;?php echo decbin(ord(&quot;c&quot;)); ?&gt;</code> and <code>&lt;?php echo chr(bindec(&quot;1101000&quot;)); ?&gt;</code> how do this in GO?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485877890, "post_id": 41960747, "comment_id": 71102418, "body": "FYI, there&#39;s absolutely no useful reason to change the string representation like this for hashing, and looks like a gross misunderstanding of how to securely hash a string. Is this what you want to do? <a href=\"https://play.golang.org/p/SnyWzJlTTF\" rel=\"nofollow noreferrer\">play.golang.org/p/SnyWzJlTTF</a>"}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485878099, "post_id": 41960747, "comment_id": 71102569, "body": "woow..tank you.very tank from you."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485878144, "post_id": 41960747, "comment_id": 71102610, "body": "but not work for utf-8 text!! how fix?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485878838, "post_id": 41960747, "comment_id": 71103161, "body": "You need to <i>not</i> try to use it as utf8, and index the string bytes directly. I&#39;ll post it so you can see it exactly."}], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485879266, "post_id": 41962148, "comment_id": 71103498, "body": "<code>need try,catch to not show error if not binary</code>.. example : <code>fmt.Println(base2ToString(&quot;jdfgidjfigjdfidfg&quot;))</code> how fix this? show error : <code>panic: strconv.ParseUint: parsing &quot;jdfgidjf&quot;: invalid syntax</code>??? how fix?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485879415, "post_id": 41962148, "comment_id": 71103611, "body": "I purposely made it panic on invalid input. If you want to catch all errors, you are free to do so."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 1, "creation_date": 1485879743, "post_id": 41962148, "comment_id": 71103840, "body": "instead of <code>panic</code>, return the error and handle it. Have you gone over the basics of Go? Maybe take the <a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">Tour of Go</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 2, "creation_date": 1485885512, "post_id": 41962148, "comment_id": 71107646, "body": "@LovePython: <code>adler32</code> is a checksum, you can&#39;t &quot;decode&quot; it. Do you mean <a href=\"https://godoc.org/hash/adler32#Checksum\" rel=\"nofollow noreferrer\"><code>adler32.Checksum</code></a>? Please take some time to learn the basics and how to check the documentation."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485950251, "post_id": 41962148, "comment_id": 71135947, "body": "oh, Ok. i have a text(number). how can minify this? what hash is better and minify?"}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485950351, "post_id": 41962148, "comment_id": 71136026, "body": "and also about <code>stringToBase2()</code> you sure then all character utf-8 max have <code>%08b</code> 8 bit/byte?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485973955, "post_id": 41962148, "comment_id": 71151795, "body": "@LovePython: stringToBase2 doesn&#39;t have anything to do with utf8. A byte is 8 bits, and you&#39;re converting the string&#39;s bytes into a base 2 representation. Again, this is a pointless exercise, and amounts only to a minor obfuscation of some sort."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485974034, "post_id": 41962148, "comment_id": 71151848, "body": "@LovePython: what do you mean by &quot;minify&quot;? Minify implies compression, but a hash is by definition a lossy one-way transformation."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485988518, "post_id": 41962148, "comment_id": 71159366, "body": "yes. now i have a string , and i want compression them. what algorithm good for compression?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1485878930, "creation_date": 1485878930, "answer_id": 41962148, "question_id": 41960747, "link": "https://stackoverflow.com/questions/41960747/how-convert-stringtext-to-binary-and-conversely-using-go/41962148#41962148", "title": "How Convert StringText To Binary And Conversely Using Go", "body": "<p>Convert each byte individually to its base 2 representation. You can use <code>strconv.ParseUint</code> to convert the base2 back to bytes.</p>\n\n<pre><code>func stringToBase2(s string) string {\n    var buf bytes.Buffer\n    for i := 0; i &lt; len(s); i++ {\n        fmt.Fprintf(&amp;buf, \"%08b\", s[i])\n    }\n    return buf.String()\n}\n\nfunc base2ToString(s string) string {\n    var out []byte\n    for i := 0; i+8 &lt;= len(s); i += 8 {\n        b, err := strconv.ParseUint(s[i:i+8], 2, 8)\n        if err != nil {\n            panic(err)\n        }\n        out = append(out, byte(b))\n    }\n    return string(out)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/cLvoPHZ-hH\" rel=\"nofollow noreferrer\">https://play.golang.org/p/cLvoPHZ-hH</a></p>\n"}], "owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 221, "favorite_count": 0, "accepted_answer_id": 41962148, "answer_count": 1, "score": -2, "last_activity_date": 1485878930, "creation_date": 1485874806, "last_edit_date": 1495541801, "question_id": 41960747, "link": "https://stackoverflow.com/questions/41960747/how-convert-stringtext-to-binary-and-conversely-using-go", "title": "How Convert StringText To Binary And Conversely Using Go", "body": "<p>i want Convert <code>Text</code>(type=<code>String</code>) To <code>Binary</code>(type=<code>String</code>) And <code>Conversely</code> Using Go</p>\n\n<p>some userfull link :\n<a href=\"https://stackoverflow.com/questions/37349071/golang-how-to-convert-string-to-binary-representation/37350639\">Golang: How to convert String to binary representation</a> &amp; \n<a href=\"https://stackoverflow.com/questions/32685687/convert-string-to-binary-in-go\">Convert string to binary in Go</a></p>\n\n<p>but i need another.</p>\n\n<p>i want example convert a text like <code>hello</code> to <code>binary</code>. and next can convert then binary to first text(<code>hello</code>).</p>\n\n<pre><code>var hash_text := hash(\"hello\")//example return *****\nvar unhash_text := unhash(hash_text);//return hello\n</code></pre>\n\n<p>like this gist.github.com/hutt/8978333 (using php)</p>\n\n<p>also <code>speed</code> for me is <code>importamt</code>.</p>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485872041, "post_id": 41959727, "comment_id": 71098155, "body": "http: panic serving 127.0.0.1:56095: runtime error: index out of range goroutine 7 [running]:"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "reply_to_user": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485872242, "post_id": 41959727, "comment_id": 71098296, "body": "<code>returnBeaconData </code> is a slice. index out of range happens to arrays."}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485872250, "post_id": 41959727, "comment_id": 71098300, "body": "I&#39;ve had this problem and I think I did what I did to get rid of the index out of bound error. Although it doesnt work"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485872296, "post_id": 41959727, "comment_id": 71098354, "body": "But what has happened then? I get the error index out of range when changing what you said?"}, {"owner": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "reply_to_user": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485872483, "post_id": 41959727, "comment_id": 71098492, "body": "@SimonNilssonGuldstrand 1389 is the line number"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485872527, "post_id": 41959727, "comment_id": 71098529, "body": "Try changing the line <code>returnBeaconData := []types.BeaconDataXY{}</code> to <code>returnBeaconData := make([]types.BeaconData, 1)</code>"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485873036, "post_id": 41959727, "comment_id": 71098902, "body": "Maybe <code>beacondataXY</code> is too large for logging?"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485873090, "post_id": 41959727, "comment_id": 71098932, "body": "Comment <code>log.Infof</code> out as a test"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485873137, "post_id": 41959727, "comment_id": 71098969, "body": "@dev.bmax did that also"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485873388, "post_id": 41959727, "comment_id": 71099146, "body": "Also, change <code>beacondatastatic := []types.BeaconDataStatic{}</code> to <code>beacondatastatic := make([]types.BeaconDataStatic, 1)</code>"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485873490, "post_id": 41959727, "comment_id": 71099200, "body": "or check that <code>len(beacondatastatic) &gt; 0</code> before indexing <code>beacondatastatic[0]</code>"}], "tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": false, "score": 1, "last_activity_date": 1485872093, "last_edit_date": 1485872093, "creation_date": 1485871921, "answer_id": 41959727, "question_id": 41959651, "link": "https://stackoverflow.com/questions/41959651/golang-slices-append/41959727#41959727", "title": "Golang slices append", "body": "<p>Try <code>returnBeaconData = append(returnBeaconData, *beacondataXY)</code></p>\n\n<p>new() built-in function returns a pointer, you can alternatively write:</p>\n\n<p><code>var beacondataXY = types.BeaconDataXY{}</code></p>\n"}, {"comments": [{"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485872894, "post_id": 41959977, "comment_id": 71098794, "body": "Have updated according to that but still same problem as I answered in the other solution. Index out of range"}, {"owner": {"reputation": 1659, "user_id": 302646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYT9J.png?s=128&g=1", "display_name": "Makkes", "link": "https://stackoverflow.com/users/302646/makkes"}, "reply_to_user": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485873143, "post_id": 41959977, "comment_id": 71098975, "body": "Please post the complete stack trace."}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485873202, "post_id": 41959977, "comment_id": 71099021, "body": "How do I see stack trace? Or is the stack trace the entire error output? <a href=\"http://imgur.com/wMj90Fz\" rel=\"nofollow noreferrer\">imgur.com/wMj90Fz</a>"}, {"owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 1, "creation_date": 1485873315, "post_id": 41959977, "comment_id": 71099102, "body": "See previous comment here, posted a imgur link with entire stack trace"}, {"owner": {"reputation": 1659, "user_id": 302646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYT9J.png?s=128&g=1", "display_name": "Makkes", "link": "https://stackoverflow.com/users/302646/makkes"}, "reply_to_user": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485873354, "post_id": 41959977, "comment_id": 71099124, "body": "What&#39;s in line 136 of handlers/utils.go?"}, {"owner": {"reputation": 1659, "user_id": 302646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYT9J.png?s=128&g=1", "display_name": "Makkes", "link": "https://stackoverflow.com/users/302646/makkes"}, "reply_to_user": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "edited": false, "score": 0, "creation_date": 1485873378, "post_id": 41959977, "comment_id": 71099137, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/134494/discussion-between-makkes-and-simon-nilsson-guldstrand\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 1659, "user_id": 302646, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bYT9J.png?s=128&g=1", "display_name": "Makkes", "link": "https://stackoverflow.com/users/302646/makkes"}, "is_accepted": true, "score": 3, "last_activity_date": 1485872662, "creation_date": 1485872662, "answer_id": 41959977, "question_id": 41959651, "link": "https://stackoverflow.com/questions/41959651/golang-slices-append/41959977#41959977", "title": "Golang slices append", "body": "<p>With this assignment:</p>\n\n<pre><code>var beacondataXY = new(types.BeaconDataXY)\n</code></pre>\n\n<p>you are creating a variable of type *types.BeaconDataXY. Just create a new BeaconDataXY like this:</p>\n\n<pre><code>var beacondataXY = types.BeaconDataXY{}\n</code></pre>\n\n<p>When appending to your array do it like this:</p>\n\n<pre><code>returnBeaconData = append(returnBeaconData, beacondataXY)\n</code></pre>\n\n<p>The \"...\" would assume that beacondataXY is an array but it isn't, you just want to append beacondataXY to returnBeaconData. See <a href=\"https://golang.org/ref/spec#Appending_and_copying_slices\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Appending_and_copying_slices</a> for an explanation of what \"...\" means in this context.</p>\n"}], "owner": {"reputation": 478, "user_id": 1103562, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/ef07743a8a849d44a56f4f0e80169e33?s=128&d=identicon&r=PG", "display_name": "Simon Guldstrand", "link": "https://stackoverflow.com/users/1103562/simon-guldstrand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 41959977, "answer_count": 2, "score": 1, "last_activity_date": 1486419265, "creation_date": 1485871745, "last_edit_date": 1486419265, "question_id": 41959651, "link": "https://stackoverflow.com/questions/41959651/golang-slices-append", "title": "Golang slices append", "body": "<p>I am having a problem when appending to my slice using Golang.</p>\n\n<p>Here is my code: </p>\n\n<pre><code>func MatchBeaconWithXY(w http.ResponseWriter, r *http.Request) ([]types.BeaconDataXY, error) {\ncontext := appengine.NewContext(r)\nreturnBeaconData := []types.BeaconDataXY{}\n\nbeacondata, err := GetBeaconData(w, r)\nif err != nil {\n    log.Errorf(context, \"error getting beacondata %v\", err)\n    w.WriteHeader(http.StatusInternalServerError)\n    return nil, err\n}\n\nfor index, element := range beacondata {\n    q := datastore.NewQuery(\"physicalbeacondata\").Filter(\"NamespaceID =\", element.NamespaceID).Filter(\"InstanceID =\", element.InstanceID)\n\n    beacondatastatic := []types.BeaconDataStatic{}\n    _, err := q.GetAll(context, &amp;beacondatastatic)\n    if err != nil {\n        log.Errorf(context, \"cant get query %v\", err)\n        w.WriteHeader(http.StatusInternalServerError)\n        return nil, err\n    }\n\n    var beacondataXY = new(types.BeaconDataXY)\n    beacondataXY.NamespaceID = element.NamespaceID\n    beacondataXY.InstanceID = element.InstanceID\n    beacondataXY.XCoord = beacondatastatic[0].XCoord\n    beacondataXY.YCoord = beacondatastatic[0].YCoord\n    beacondataXY.Distance = element.Distance\n\n    returnBeaconData = append(returnBeaconData, beacondataXY...)\n\n    log.Infof(context, \"beaondataXY tot %v\", beacondataXY)\n}\n</code></pre>\n\n<p>The <em>beacondataxy.go</em> contains this:</p>\n\n<pre><code>package types\n\ntype BeaconDataXY struct {\n    InstanceID  string\n    NamespaceID string\n    XCoord      float64\n    YCoord      float64\n    Distance    float64\n}\n</code></pre>\n\n<p>The error message is this:</p>\n\n<blockquote>\n  <p>utils.go:139: cannot use beacondataXY (type *types.BeaconDataXY) as\n  type []types.BeaconDataXY in append</p>\n</blockquote>\n\n<p>I don't really know how to handle slices in Golang, even after reading some tutorials that makes perfect sense. I'm not sure what I'm doing wrong.</p>\n\n<p>I want to have an array/slice with types inside, return BeaconData is of []types. BeaconDataXY and it should contain single types of BeaconDataXY. </p>\n\n<p>Thanks for all help.</p>\n\n<p>EDIT:</p>\n\n<p>The code now looks like this:</p>\n\n<pre><code>func MatchBeaconWithXY(w http.ResponseWriter, r *http.Request) ([]types.BeaconDataXY, error) {\n    context := appengine.NewContext(r)\n    //returnBeaconData := []types.BeaconDataXY{}\n    returnBeaconData := make([]types.BeaconDataXY, 1)\n\n    beacondata, err := GetBeaconData(w, r)\n    if err != nil {\n        log.Errorf(context, \"error getting beacondata %v\", err)\n        w.WriteHeader(http.StatusInternalServerError)\n        return nil, err\n    }\n\n    for _, element := range beacondata {\n        q := datastore.NewQuery(\"physicalbeacondata\").Filter(\"NamespaceID =\", element.NamespaceID).Filter(\"InstanceID =\", element.InstanceID)\n\n        beacondatastatic := []types.BeaconDataStatic{}\n        _, err := q.GetAll(context, &amp;beacondatastatic)\n        if err != nil {\n            log.Errorf(context, \"cant get query %v\", err)\n            w.WriteHeader(http.StatusInternalServerError)\n            return nil, err\n        }\n\n        var beacondataXY = types.BeaconDataXY{}\n        beacondataXY.NamespaceID = element.NamespaceID\n        beacondataXY.InstanceID = element.InstanceID\n        beacondataXY.XCoord = beacondatastatic[0].XCoord\n        beacondataXY.YCoord = beacondatastatic[0].YCoord\n        beacondataXY.Distance = element.Distance\n\n        returnBeaconData = append(returnBeaconData, beacondataXY)\n\n        //log.Infof(context, \"beaondataXY tot %v\", beacondataXY)\n    }\n</code></pre>\n"}, {"tags": ["parsing", "layout", "go", "time"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 2, "creation_date": 1485867775, "post_id": 41958170, "comment_id": 71095265, "body": "Your time layout format is incorrect, see ie <a href=\"http://stackoverflow.com/q/37937794/723693\">stackoverflow.com/q/37937794/723693</a>"}, {"owner": {"reputation": 183, "user_id": 4592096, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/af89de25ba36e49b6b950b5c0536831a?s=128&d=identicon&r=PG&f=1", "display_name": "dewastator", "link": "https://stackoverflow.com/users/4592096/dewastator"}, "edited": false, "score": 0, "creation_date": 1485868103, "post_id": 41958170, "comment_id": 71095474, "body": "Perfect thanks guys. <code>p.TimeParse(&quot;2006-01-02T15:04:05Z&quot;, v)</code> works"}], "owner": {"reputation": 183, "user_id": 4592096, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/af89de25ba36e49b6b950b5c0536831a?s=128&d=identicon&r=PG&f=1", "display_name": "dewastator", "link": "https://stackoverflow.com/users/4592096/dewastator"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 78, "favorite_count": 0, "closed_date": 1485870760, "answer_count": 0, "score": 0, "last_activity_date": 1485867307, "creation_date": 1485867307, "question_id": 41958170, "link": "https://stackoverflow.com/questions/41958170/parsing-time-in-golang-how-to-define-correct-layout", "closed_reason": "Duplicate", "title": "Parsing time in golang. How to define correct layout?", "body": "<p>I am trying to parse time from string to time.Time type. I have following code:</p>\n\n<pre><code>s, _ := v.(string)\nfmt.Println(s) //Gives: 2016-12-01T14:10:12Z\nttime, err := time.Parse(\"2006-01-01T07:00:00Z\", s)\nfmt.Println(err) //Gives: parsing time \"2016-12-01T14:10:12Z\" as \"2006-01-01T07:00:00Z\": cannot parse \"14:10:12Z\" as \"T07:00:00Z\n</code></pre>\n\n<p>When I try change time layout:</p>\n\n<pre><code>s, _ := v.(string)\nfmt.Println(s) //Gives: 2016-12-01T14:10:12Z\nttime, err := time.Parse(\"2006-01-01 07:00:00Z\", s)\nfmt.Println(err) //Gives: parsing time \"2016-12-01T14:10:12Z\": month out of range\n</code></pre>\n\n<p>Can someone tell me what I am doing wrong? Thanks for all answers.</p>\n"}, {"tags": ["string", "go", "rune"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1485870444, "last_edit_date": 1485870444, "creation_date": 1485863049, "answer_id": 41956722, "question_id": 41956391, "link": "https://stackoverflow.com/questions/41956391/how-found-offset-index-a-string-in-rune-using-go/41956722#41956722", "title": "How found offset index a string in rune using go", "body": "<p><strong>Edit #2:</strong> You again indicated a new type \"meaning\" of your question: you want to search a <code>string</code> in a <code>[]rune</code>.</p>\n\n<p>Answer: this is not supported directly in the standard library. But it's easy to implement it with 2 <code>for</code> loops:</p>\n\n<pre><code>func search(text []rune, what string) int {\n    whatRunes := []rune(what)\n\n    for i := range text {\n        found := true\n        for j := range whatRunes {\n            if text[i+j] != whatRunes[j] {\n                found = false\n                break\n            }\n        }\n        if found {\n            return i\n        }\n    }\n    return -1\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>value := []rune(\"123}456}}789\")\nresult := search(value, \"}}\")\nfmt.Println(result)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/QcvvHBHmpV\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>7\n</code></pre>\n\n<hr>\n\n<p><strong>Edit:</strong> You updated the question indicating that you want to search <code>rune</code>s in a <code>string</code>.</p>\n\n<p>You may easily convert a <code>[]rune</code> to a <code>string</code> using a simple type conversion:</p>\n\n<pre><code>toSearchRunes := []rune{'}', '}'}\ntoSearch := string(toSearchRunes)\n</code></pre>\n\n<p>And from there on, you can use <code>strings.Index()</code> as you did in your example:</p>\n\n<pre><code>if i := strings.Index(text[offset:], toSearch); i &gt; 0 {\n    print(i)\n}\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/pDm7G4iw9n\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Original answer follows:</p>\n\n<hr>\n\n<p><code>string</code> values in Go are stored as UTF-8 encoded bytes. <a href=\"https://golang.org/pkg/strings/#Index\" rel=\"nofollow noreferrer\"><code>strings.Index()</code></a> returns you the byte position if the given substring is found.</p>\n\n<p>So basically what you want is to convert this byte-position to rune-position. The <a href=\"https://golang.org/pkg/unicode/utf8/\" rel=\"nofollow noreferrer\"><code>unicode/utf8</code></a> package contains utility functions for telling the rune-count or rune-length of a <code>string</code>: <a href=\"https://golang.org/pkg/unicode/utf8/#RuneCountInString\" rel=\"nofollow noreferrer\"><code>utf8.RuneCountInString()</code></a>.</p>\n\n<p>So basically you just need to pass the substring to this function:</p>\n\n<pre><code>offset := 0\ntext := \"123456789}}56\"\nif i := strings.Index(text[offset:], \"}}\"); i &gt; 0 {\n    fmt.Println(\"byte-pos:\", i, \"rune-pos:\", utf8.RuneCountInString(text[offset:i]))\n}\n\ntext = \"\u4e16\u754c}}\u4e16\u754c\"\nif i := strings.Index(text[offset:], \"}}\"); i &gt; 0 {\n    fmt.Println(\"byte-pos:\", i, \"rune-pos:\", utf8.RuneCountInString(text[offset:i]))\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/A1mlDF0M7J\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>byte-pos: 9 rune-pos: 9\nbyte-pos: 6 rune-pos: 2\n</code></pre>\n\n<p>Note: <code>offset</code> must also be a byte position, because when slicing a <code>string</code> like <code>text[offset:]</code>, the index is interpreted as byte-index.</p>\n\n<p>If you want to get the index of a <code>rune</code>, use <a href=\"https://golang.org/pkg/strings/#IndexRune\" rel=\"nofollow noreferrer\"><code>strings.IndexRune()</code></a> instead of <code>strings.Index()</code>.</p>\n"}], "owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1974, "favorite_count": 0, "accepted_answer_id": 41956722, "answer_count": 1, "score": -2, "last_activity_date": 1485870444, "creation_date": 1485862014, "last_edit_date": 1485869322, "question_id": 41956391, "link": "https://stackoverflow.com/questions/41956391/how-found-offset-index-a-string-in-rune-using-go", "title": "How found offset index a string in rune using go", "body": "<p>How found offset index a string in []rune using go?</p>\n\n<p>I can do this work with string type.</p>\n\n<p><code>if i := strings.Index(input[offset:], \"}}\"); i &gt; 0 {print(i);}</code></p>\n\n<p>but i need for runes.</p>\n\n<p>i have a rune and want get offset index.</p>\n\n<p>how can do this work with runes type in go?</p>\n\n<p>example for more undrestand want need:</p>\n\n<pre><code>int offset=0//mean start from 0 (this is important for me)\nstring text=\"123456783}}56\"\nif i := strings.Index(text[offset:], \"}}\"); i &gt; 0 {print(i);}\n</code></pre>\n\n<p>output of this example is : <code>9</code></p>\n\n<p>but i want do this with []rune type(text variable)</p>\n\n<p>may?</p>\n\n<p>see my current code : <a href=\"https://play.golang.org/p/seImKzVpdh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/seImKzVpdh</a></p>\n\n<p>tank you.</p>\n"}, {"tags": ["arrays", "dictionary", "go", "hashmap", "slice"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1485856636, "post_id": 41954173, "comment_id": 71087949, "body": "I don&#39;t think you can do anything like this in Go. Go strives to be explicit, so you must always provide keys in maps."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "edited": false, "score": 0, "creation_date": 1485856691, "post_id": 41954173, "comment_id": 71087992, "body": "The post is highly ambiguous. Your code is not Go code. Read about strict typing  languages, because Go is not Python... Not even close..."}, {"owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "edited": false, "score": 0, "creation_date": 1485857489, "post_id": 41954173, "comment_id": 71088500, "body": "Why minuses? It&#39;s a typical novice question  coming from dynamic typing languages. Except for &quot;child&quot;:[1,2,3,4,5,9:1] - everything is doable in go"}], "answers": [{"comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1485859860, "post_id": 41954742, "comment_id": 71090104, "body": "I think <code>9:1</code> means that the ninth element of the slice should be <code>1</code>."}, {"owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1485861413, "post_id": 41954742, "comment_id": 71091052, "body": "Interesting.  I had not knew."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485861790, "post_id": 41954742, "comment_id": 71091283, "body": "<code>9:1</code> ==&gt; 9 is name index."}, {"owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "edited": false, "score": 0, "creation_date": 1485861864, "post_id": 41954742, "comment_id": 71091329, "body": "tank you from all."}], "tags": [], "owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "is_accepted": false, "score": 1, "last_activity_date": 1485862745, "last_edit_date": 1485862745, "creation_date": 1485857293, "answer_id": 41954742, "question_id": 41954173, "link": "https://stackoverflow.com/questions/41954173/how-to-store-values-in-hashmap-without-index-name-using-go/41954742#41954742", "title": "How to store values in hashmap without index name using go?", "body": "<p>You can do something like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    dynMap := map[interface{}]interface{}{\n        \"name\": \"attn\",\n        0:      1,\n        1:      5,\n        2:      6,\n        3:      7,\n        4:      8,\n    }\n    fmt.Printf(\"%v\\n\", dynMap)\n\n    dynMap2 := map[interface{}]interface{}{\n        0:       \"start\",\n        \"name\":  \"mattn\",\n        \"age\":   39,\n        \"child\": []int{1, 2, 3, 4, 5, 9:1}, \n\n    }\n    fmt.Printf(\"%v\\n\", dynMap2)\n}\n</code></pre>\n\n<p><strike>Except for \"child\":[1,2,3,4,5,9:1] - I fail to understand what you really want for [9:1]</strike> Thanks for correction: this is also doable.</p>\n\n<p>And, although I like python too, go is not python (or js/ruby/etc). If you will do a lot interface{} and reflect on it - it's possible but it's a pain.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 2, "last_activity_date": 1485862280, "last_edit_date": 1495541346, "creation_date": 1485860413, "answer_id": 41955870, "question_id": 41954173, "link": "https://stackoverflow.com/questions/41954173/how-to-store-values-in-hashmap-without-index-name-using-go/41955870#41955870", "title": "How to store values in hashmap without index name using go?", "body": "<p><a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">Spec: Composite literals:</a></p>\n\n<blockquote>\n  <p>The key is interpreted as a field name for struct literals, an index for array and slice literals, and a key for map literals. <strong>For map literals, all elements must have a key.</strong> It is an error to specify multiple elements with the same field name or constant key value.</p>\n</blockquote>\n\n<p>So no, using a composite literal to initialize a <code>map</code>, we can't omit the keys.</p>\n\n<p>We may (and usually we do) omit indices when using a slice literal. So we may list key-value pairs in one map literal (where we know or want to explicitly state the key), and list elements with subsequent indices in another slice literal to initialize a slice. Then we can iterate over the slice and add key-value pairs based on index-value pairs.</p>\n\n<p>Your first example:</p>\n\n<pre><code>m := map[interface{}]interface{}{\n    \"name\": \"attn\",\n}\ns := []int{1, 5, 6, 7, 8}\nfor i, v := range s {\n    m[i] = v\n}\nfmt.Println(m)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>map[0:1 1:5 2:6 3:7 4:8 name:attn]\n</code></pre>\n\n<p>Your other example:</p>\n\n<pre><code>m = map[interface{}]interface{}{\n    0: \"start\", \"name\": \"mattn\", \"age\": 39,\n    \"child\": []int{1: 1, 2, 3, 4, 5, 9: 1},\n}\nfmt.Println(m)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>map[0:start name:mattn age:39 child:[0 1 2 3 4 5 0 0 0 1]]\n</code></pre>\n\n<p>Try these on the <a href=\"https://play.golang.org/p/8Bi1bipO7l\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p>Note that in the 2nd example the value for <code>\"child\"</code> is a slice which contains <code>0</code> elements. The reason for this is because a slice or array is contiguous, even if we don't provide elements for all indices, there will still be elements for the missing indices. If we don't want this, that is not a slice (or array), but that is a <code>map</code>, and we can initialize it as seen in the first example.</p>\n\n<p>We can't distinguish between an implicit <code>0</code> and an explicit <code>0</code> (which we may list in the composite literal). If <code>0</code> is a value we may use, another alternative would be to define type of <code>child</code> to be <code>[]interface{}</code>, and if we don't explicitly specify a value in the composite literal, it will be <code>nil</code>.</p>\n\n<p>See this question for more examples on initializing arrays and slices: <a href=\"https://stackoverflow.com/questions/36302441/keyed-items-in-golang-array-initialization/36302875#36302875\">Keyed items in golang array initialization</a></p>\n"}], "owner": {"reputation": 25, "user_id": 7464028, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cad327cde08f25cb7b41ccc24b4104e2?s=128&d=identicon&r=PG&f=1", "display_name": "Love Python", "link": "https://stackoverflow.com/users/7464028/love-python"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1485862745, "creation_date": 1485855801, "last_edit_date": 1485862372, "question_id": 41954173, "link": "https://stackoverflow.com/questions/41954173/how-to-store-values-in-hashmap-without-index-name-using-go", "title": "How to store values in hashmap without index name using go?", "body": "<p>I want to store some values in hashmap without index name. I mean derived from the array and hashmap.</p>\n\n<p>Example : </p>\n\n<pre><code>{\"name\":\"attn\",1,5,6,7,8}\n</code></pre>\n\n<p>Output of variable (just for demonstration): </p>\n\n<pre><code>( \"name\" : \"attn\", 0:1, 1:5, 2:6, 3:7, 4:8, )\n</code></pre>\n\n<p>Or another example:</p>\n\n<pre><code>{ 0:\"start\",\"name\":\"mattn\",\"age\":39,\"child\":[1,2,3,4,5,9:1] }\n</code></pre>\n\n<p><strong>How can do this in Go?</strong></p>\n\n<p>Maybe I need new data type? :)</p>\n\n<p>Please, help me! Thank you!</p>\n"}, {"tags": ["go", "asn.1"], "comments": [{"owner": {"reputation": 1641, "user_id": 269722, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81d598eabde4371045e19cce8d01f700?s=128&d=identicon&r=PG", "display_name": "Kevin", "link": "https://stackoverflow.com/users/269722/kevin"}, "edited": false, "score": 0, "creation_date": 1485888630, "post_id": 41953821, "comment_id": 71109464, "body": "I don&#39;t know Golang.  I guess the error is telling you it found an [APPLICATION 13] tag ?? But there is no such tag in your data.  Which leads to my next question - when you assign mdata2, is that string interpreted as base64, or are the characters converted to bytes according to, say, UTF-8?  That might be your problem."}], "answers": [{"tags": [], "owner": {"reputation": 2259, "user_id": 436980, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AIzdr.gif?s=128&g=1", "display_name": "Artem Zankovich", "link": "https://stackoverflow.com/users/436980/artem-zankovich"}, "is_accepted": false, "score": 0, "last_activity_date": 1492129463, "creation_date": 1492129463, "answer_id": 43403600, "question_id": 41953821, "link": "https://stackoverflow.com/questions/41953821/unable-to-define-correct-struct-for-asn-decoding-in-golang/43403600#43403600", "title": "Unable to define correct struct for asn decoding in golang", "body": "<p>You defined base64-encoded ASN.1 stream and need to decode it before passing to <code>Unmarshal</code>. Consider the next definition:</p>\n\n<pre><code>mdata2, _ := base64.StdEncoding.DecodeString(\"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAhxW+fVIU3KiVWyHy5RZ6jMQrXbrpUNOrz8V29qhZ98G53o6yKeUc2dOXC/dX2w8lEXjf+Hys9BLAJJZc6dlV1vrVZM5C9fvCAMHlAcMW2AADLuG+SruM6URBedSAxMFVwAzsSApLEQSlfGyMvjT+UOrHEjBUMn4+IPiLW2G0o1pHxCkrUxub/RWpl5qO7BbuEQj4flbUGpOpFW+XOuYu78MRmEvl/E9SX8b04RrXZTxPMAqxAl/zRA7VgIVzwtcm6xjzFw8kvr7H4B/zb7Jvl32FhniXMOrPfSGI2xhrr92DTOaPXuPFH2DywbNj/O21fenykWYsB/bA8vH7/EmQdwIDAQAB\")\n</code></pre>\n\n<p>Then it should work after adding <code>\"encoding/base64\"</code> to imports.</p>\n"}], "owner": {"reputation": 104, "user_id": 2636979, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/445632aed806e6fe7ca1175fee4fcfd1?s=128&d=identicon&r=PG", "display_name": "naveen", "link": "https://stackoverflow.com/users/2636979/naveen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1492129463, "creation_date": 1485854721, "question_id": 41953821, "link": "https://stackoverflow.com/questions/41953821/unable-to-define-correct-struct-for-asn-decoding-in-golang", "title": "Unable to define correct struct for asn decoding in golang", "body": "<p>I have the following <a href=\"https://lapo.it/asn1js/#MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAhxW%2BfVIU3KiVWyHy5RZ6jMQrXbrpUNOrz8V29qhZ98G53o6yKeUc2dOXC%2FdX2w8lEXjf%2BHys9BLAJJZc6dlV1vrVZM5C9fvCAMHlAcMW2AADLuG%2BSruM6URBedSAxMFVwAzsSApLEQSlfGyMvjT%2BUOrHEjBUMn4%2BIPiLW2G0o1pHxCkrUxub%2FRWpl5qO7BbuEQj4flbUGpOpFW%2BXOuYu78MRmEvl%2FE9SX8b04RrXZTxPMAqxAl%2FzRA7VgIVzwtcm6xjzFw8kvr7H4B%2Fzb7Jvl32FhniXMOrPfSGI2xhrr92DTOaPXuPFH2DywbNj%2FO21fenykWYsB%2FbA8vH7%2FEmQdwIDAQAB\" rel=\"nofollow noreferrer\">ASN1 structure</a> to decode using golang</p>\n\n<pre><code>SEQUENCE(2 elem)\n     SEQUENCE(2 elem)\n          OBJECT IDENTIFIER1.2.840.113549.1.1.1\n          NULL\n     BIT STRING(1 elem)\n          SEQUENCE(2 elem)\n               INTEGER(2048 bit) 20832\u2026\n               INTEGER  65537\n</code></pre>\n\n<p>and I am using the following struct to store the decoded data:</p>\n\n<pre><code>type OidAndNullSET struct {\n    OID  asn1.ObjectIdentifier\n    Null asn1.RawValue\n}\n\ntype Seq struct {\n    Set    OidAndNullSET\n    BitStr asn1.BitString\n}\n\nfunc main() {\n    mdata2 := []byte(\"MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEAhxW+fVIU3KiVWyHy5RZ6jMQrXbrpUNOrz8V29qhZ98G53o6yKeUc2dOXC/dX2w8lEXjf+Hys9BLAJJZc6dlV1vrVZM5C9fvCAMHlAcMW2AADLuG+SruM6URBedSAxMFVwAzsSApLEQSlfGyMvjT+UOrHEjBUMn4+IPiLW2G0o1pHxCkrUxub/RWpl5qO7BbuEQj4flbUGpOpFW+XOuYu78MRmEvl/E9SX8b04RrXZTxPMAqxAl/zRA7VgIVzwtcm6xjzFw8kvr7H4B/zb7Jvl32FhniXMOrPfSGI2xhrr92DTOaPXuPFH2DywbNj/O21fenykWYsB/bA8vH7/EmQdwIDAQAB\")\n\n\n    var n Seq\n    _, err1 := asn1.Unmarshal(mdata2, &amp;n)\n    checkError(err1)\n\n    fmt.Println(\"After unmarshal: \", n)\n}\n\nfunc checkError(err error) {\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"Fatal error: %s\", err.Error())\n        os.Exit(1)\n    }\n}\n</code></pre>\n\n<p>I cannot find a proper structure to store a SEQUENCE* and getting following error  </p>\n\n<blockquote>\n  <p>asn1: structure error: tags don't match (16 vs {class:1 tag:13 length:73 isCompound:false}). </p>\n</blockquote>\n\n<p>Any thoughts?</p>\n"}, {"tags": ["go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 140, "user_id": 872312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/757f8bcbbca28cb59f95892a0a960869?s=128&d=identicon&r=PG", "display_name": "netsplit", "link": "https://stackoverflow.com/users/872312/netsplit"}, "edited": false, "score": 0, "creation_date": 1485876871, "post_id": 41959132, "comment_id": 71101614, "body": "This makes actually sense, but how do I convert it back to a go string in the end?"}, {"owner": {"reputation": 140, "user_id": 872312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/757f8bcbbca28cb59f95892a0a960869?s=128&d=identicon&r=PG", "display_name": "netsplit", "link": "https://stackoverflow.com/users/872312/netsplit"}, "edited": false, "score": 0, "creation_date": 1485877612, "post_id": 41959132, "comment_id": 71102199, "body": "<code>newString := C.GoString((*C.char)(s))</code> it is"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 140, "user_id": 872312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/757f8bcbbca28cb59f95892a0a960869?s=128&d=identicon&r=PG", "display_name": "netsplit", "link": "https://stackoverflow.com/users/872312/netsplit"}, "edited": false, "score": 0, "creation_date": 1485878098, "post_id": 41959132, "comment_id": 71102566, "body": "@netsplit: yes, you convert the pointer to a <code>*C.char</code> if you want to copy the bytes back into a Go string."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1485870238, "creation_date": 1485870238, "answer_id": 41959132, "question_id": 41953619, "link": "https://stackoverflow.com/questions/41953619/how-to-initialise-empty-c-cstring-in-cgo/41959132#41959132", "title": "How to initialise empty C.CString in cgo", "body": "<p>If you don't need to convert a string, just malloc the size you need:</p>\n\n<pre><code>s := C.malloc(6)\ndefer C.free(unsafe.Pointer(s))\n</code></pre>\n"}], "owner": {"reputation": 140, "user_id": 872312, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/757f8bcbbca28cb59f95892a0a960869?s=128&d=identicon&r=PG", "display_name": "netsplit", "link": "https://stackoverflow.com/users/872312/netsplit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "accepted_answer_id": 41959132, "answer_count": 1, "score": 0, "last_activity_date": 1485870238, "creation_date": 1485854094, "last_edit_date": 1485854964, "question_id": 41953619, "link": "https://stackoverflow.com/questions/41953619/how-to-initialise-empty-c-cstring-in-cgo", "title": "How to initialise empty C.CString in cgo", "body": "<p>What do you think is the best way to initialise a C.CString with length x in CGO? Background: I need a char* of a proper size for a C function parameter, but I suppose following code can be improved:</p>\n\n<pre><code>// length = 6\nvar buffer [6]byte\nname := C.CString(string(buffer[:6]))\ndefer C.free(unsafe.Pointer(name))\n</code></pre>\n\n<p>or</p>\n\n<pre><code>// length = 6\nname := C.CString(\"      \")\ndefer C.free(unsafe.Pointer(name))\n</code></pre>\n"}, {"tags": ["string", "go", "quote"], "answers": [{"comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 19, "creation_date": 1485870240, "post_id": 41953591, "comment_id": 71096958, "body": "More easily even <code>fmt.Println(`&quot;`)</code>"}], "tags": [], "owner": {"reputation": 1528, "user_id": 6509830, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a2iUCqNxm8g/AAAAAAAAAAI/AAAAAAAAADk/L30vHNHz62Q/photo.jpg?sz=128", "display_name": "Sourabh Bhagat", "link": "https://stackoverflow.com/users/6509830/sourabh-bhagat"}, "is_accepted": true, "score": 36, "last_activity_date": 1485853994, "creation_date": 1485853994, "answer_id": 41953591, "question_id": 41953577, "link": "https://stackoverflow.com/questions/41953577/printing-double-quote-in-golang/41953591#41953591", "title": "Printing &quot; (double quote) in GoLang", "body": "<p>This is very easy, Just like C.</p>\n\n<pre><code>fmt.Println(\"\\\"\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "is_accepted": false, "score": 30, "last_activity_date": 1485854109, "creation_date": 1485854109, "answer_id": 41953623, "question_id": 41953577, "link": "https://stackoverflow.com/questions/41953577/printing-double-quote-in-golang/41953623#41953623", "title": "Printing &quot; (double quote) in GoLang", "body": "<p>Old style string literals and their escapes can often be avoided. The typical Go solution is to use a <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"noreferrer\">raw string literal</a> here:</p>\n\n<pre><code> fmt.Println(`\"`)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 19, "last_activity_date": 1485859554, "last_edit_date": 1485859554, "creation_date": 1485855402, "answer_id": 41954042, "question_id": 41953577, "link": "https://stackoverflow.com/questions/41953577/printing-double-quote-in-golang/41954042#41954042", "title": "Printing &quot; (double quote) in GoLang", "body": "<p>Don't say Go doesn't leave you options. The following all print a quotation mark <code>\"</code>:</p>\n\n<pre><code>fmt.Println(\"\\\"\")\nfmt.Println(\"\\x22\")\nfmt.Println(\"\\u0022\")\nfmt.Println(\"\\042\")\nfmt.Println(`\"`)\nfmt.Println(string('\"'))\nfmt.Println(string([]byte{'\"'}))\nfmt.Printf(\"%c\\n\", '\"')\nfmt.Printf(\"%s\\n\", []byte{'\"'})\n\n// Seriously, this one is just for demonstration not production :)\nfmt.Println(xml.Header[14:15])\nfmt.Println(strconv.Quote(\"\")[:1])\n</code></pre>\n\n<p>Try them on the <a href=\"https://play.golang.org/p/-ywYwcBHkH\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 3441629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72ec018a450178fdba825175164b8ae2?s=128&d=identicon&r=PG&f=1", "display_name": "okhrypko", "link": "https://stackoverflow.com/users/3441629/okhrypko"}, "is_accepted": false, "score": 6, "last_activity_date": 1518802701, "creation_date": 1518802701, "answer_id": 48832120, "question_id": 41953577, "link": "https://stackoverflow.com/questions/41953577/printing-double-quote-in-golang/48832120#48832120", "title": "Printing &quot; (double quote) in GoLang", "body": "<ul>\n<li>fmt.Printf(\"test: %q\", \"bla\")</li>\n<li>output: test: \"bla\"</li>\n<li><a href=\"https://play.golang.org/p/eO6HghCPZW2\" rel=\"noreferrer\">play ground here</a></li>\n<li><a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\">docs here</a></li>\n</ul>\n"}], "owner": {"reputation": 295, "user_id": 7481642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e679a06a283ec28824fe8213acbbe9?s=128&d=identicon&r=PG&f=1", "display_name": "bender", "link": "https://stackoverflow.com/users/7481642/bender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40004, "favorite_count": 4, "accepted_answer_id": 41953591, "answer_count": 4, "score": 24, "last_activity_date": 1518802701, "creation_date": 1485853955, "last_edit_date": 1485855863, "question_id": 41953577, "link": "https://stackoverflow.com/questions/41953577/printing-double-quote-in-golang", "title": "Printing &quot; (double quote) in GoLang", "body": "<p>I am writing a Go code which reads from a file. To do so I use <code>fmt.Println()</code> to print into that intermediate file.</p>\n\n<p>How can I print <code>\"</code>?</p>\n"}, {"tags": ["xml", "go", "cdata"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7493327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/db78e.png?s=128&g=1", "display_name": "woylyn", "link": "https://stackoverflow.com/users/7493327/woylyn"}, "edited": false, "score": 0, "creation_date": 1485858316, "post_id": 41952474, "comment_id": 71089056, "body": "thank you very much\uff01it&#39;s really a good idea.I changed the code so that the extra structure would not be exported: <code>func (c CDATA) MarshalXML(e *xml.Encoder, start xml.StartElement) error { \treturn e.EncodeElement(struct { \t\tstring &quot;xml:\\&quot;,cdata\\&quot;&quot; \t}{string(c)}, start) }</code>"}, {"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "reply_to_user": {"reputation": 3, "user_id": 7493327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/db78e.png?s=128&g=1", "display_name": "woylyn", "link": "https://stackoverflow.com/users/7493327/woylyn"}, "edited": false, "score": 0, "creation_date": 1485860238, "post_id": 41952474, "comment_id": 71090348, "body": "@woylyn You&#39;re welcome. Since your code seems much smarter. I would edit the answer."}], "tags": [], "owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "is_accepted": true, "score": 1, "last_activity_date": 1485860479, "last_edit_date": 1485860479, "creation_date": 1485849736, "answer_id": 41952474, "question_id": 41951345, "link": "https://stackoverflow.com/questions/41951345/how-to-make-custom-type-string-marshal-cdata-format-in-golang/41952474#41952474", "title": "How to make custom type (string) marshal CDATA format in golang?", "body": "<p>You can create another structure <code>CDATA2</code> which has tag <code>xml:\",cdata\"</code>, and pass it to <code>EncodeElement()</code>.</p>\n\n<p><code>EncodeElement()</code> would correctly encode <code>CDATA2{\"foo&lt;&gt;\"}</code> to <code>&lt;![CDATA[foo&lt;&gt;]]&gt;</code>.</p>\n\n<pre><code>type CDATA2 struct {\n    Text string `xml:\",cdata\"`\n}\n\nfunc (c CDATA) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n    e.EncodeElement(CDATA2{string(c)}, start)\n    return nil\n}\n</code></pre>\n\n<p>Check it in: <a href=\"https://play.golang.org/p/_w2uiniuQb\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n\n<p><strong>Edit</strong>: you can use anonymous struct if you don't want to define named type</p>\n\n<pre><code>func (c CDATA) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n    e.EncodeElement(struct {\n        string `xml:\",cdata\"`\n    }{string(c)}, start)\n    return nil\n}\n</code></pre>\n\n<p>Check it in: <a href=\"https://play.golang.org/p/WlAFhIRrQ8\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}], "owner": {"reputation": 3, "user_id": 7493327, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/db78e.png?s=128&g=1", "display_name": "woylyn", "link": "https://stackoverflow.com/users/7493327/woylyn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 875, "favorite_count": 0, "accepted_answer_id": 41952474, "answer_count": 1, "score": 0, "last_activity_date": 1485860479, "creation_date": 1485845556, "last_edit_date": 1485846433, "question_id": 41951345, "link": "https://stackoverflow.com/questions/41951345/how-to-make-custom-type-string-marshal-cdata-format-in-golang", "title": "How to make custom type (string) marshal CDATA format in golang?", "body": "<p>WeChat message reply requires such a format, CDATA is to resolve the special characters.</p>\n\n<pre><code>&lt;xml&gt;\n&lt;ToUserName&gt;&lt;![CDATA[toUser]]&gt;&lt;/ToUserName&gt;\n&lt;FromUserName&gt;&lt;![CDATA[fromUser]]&gt;&lt;/FromUserName&gt;\n&lt;CreateTime&gt;12345678&lt;/CreateTime&gt;\n&lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;\n&lt;Content&gt;&lt;![CDATA[hello world]]&gt;&lt;/Content&gt;\n&lt;/xml&gt;\n</code></pre>\n\n<p>When using <code>golang</code> to achieve the specification,I found that the  xml.Marshal () can be used with the struct tag <code>xml:\",cdata\"</code> .\nDefine a struct to deal with, the codes seems like:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"time\"\n)\n\ntype TextMsg struct {\n    XMLName      xml.Name `xml:\"xml\"`\n    ToUserName   CDATA\n    FromUserName CDATA\n    CreateTime   int64\n    MsgType      CDATA\n    Content      CDATA\n}\n\ntype CDATA struct {\n    Text string `xml:\",cdata\"`\n}\n\nfunc main() {\n    msg := TextMsg{\n        ToUserName:   CDATA{\"userId\"},\n        FromUserName: CDATA{\"appId\"},\n        CreateTime:   time.Now().Unix(),\n        MsgType:      CDATA{\"text\"},\n        Content:      CDATA{\"some message like &lt;hello&gt;\"}}\n\n    b, _ := xml.MarshalIndent(msg, \"\", \"    \")\n    fmt.Println(string(b))\n}\n</code></pre>\n\n<blockquote>\n  <p>Output results:</p>\n</blockquote>\n\n<pre><code>&lt;xml&gt;\n    &lt;ToUserName&gt;&lt;![CDATA[userId]]&gt;&lt;/ToUserName&gt;\n    &lt;FromUserName&gt;&lt;![CDATA[appId]]&gt;&lt;/FromUserName&gt;\n    &lt;CreateTime&gt;1485837083&lt;/CreateTime&gt;\n    &lt;MsgType&gt;&lt;![CDATA[text]]&gt;&lt;/MsgType&gt;\n    &lt;Content&gt;&lt;![CDATA[some message like &lt;hello&gt;]]&gt;&lt;/Content&gt;\n&lt;/xml&gt;\n</code></pre>\n\n<p>But I think it's not perfect, since variable assignment is not as convenient as the normal string type, so I change the CDATA into string type, and try to achieve MarshalXML ():</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"time\"\n)\n\ntype TextMsg struct {\n    XMLName      xml.Name `xml:\"xml\"`\n    ToUserName   CDATA\n    FromUserName CDATA\n    CreateTime   int64\n    MsgType      CDATA\n    Content      CDATA\n}\n\ntype CDATA string\n\nfunc (c CDATA) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n    e.EncodeElement(\"&lt;![CDATA[\"+string(c)+\"]]&gt;\", start)\n    return nil\n}\n\nfunc main() {\n    msg := TextMsg{\n        ToUserName:   \"userId\",\n        FromUserName: \"appId\",\n        CreateTime:   time.Now().Unix(),\n        MsgType:      \"text\",\n        Content:      \"some message like &lt;hello&gt;\"}\n\n    b, _ := xml.MarshalIndent(msg, \"\", \"    \")\n    fmt.Println(string(b))\n}\n</code></pre>\n\n<blockquote>\n  <p>But the output results do not meet expectations, \"&lt;\" or \">\" is\n  escaped:</p>\n</blockquote>\n\n<pre><code>&lt;xml&gt;\n    &lt;ToUserName&gt;&amp;lt;![CDATA[userId]]&amp;gt;&lt;/ToUserName&gt;\n    &lt;FromUserName&gt;&amp;lt;![CDATA[appId]]&amp;gt;&lt;/FromUserName&gt;\n    &lt;CreateTime&gt;1485837470&lt;/CreateTime&gt;\n    &lt;MsgType&gt;&amp;lt;![CDATA[text]]&amp;gt;&lt;/MsgType&gt;\n    &lt;Content&gt;&amp;lt;![CDATA[some message like &amp;lt;hello&amp;gt;]]&amp;gt;&lt;/Content&gt;\n&lt;/xml&gt;\n</code></pre>\n\n<p>Do you have any good suggestions for me, thank you.</p>\n"}, {"tags": ["inheritance", "go", "struct", "interface"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1485847068, "post_id": 41951172, "comment_id": 71082737, "body": "Could you please elaborate a bit on how the methods of those embedded strutcts complement each other exactly?"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 4, "last_activity_date": 1485847307, "creation_date": 1485847307, "answer_id": 41951804, "question_id": 41951172, "link": "https://stackoverflow.com/questions/41951172/embed-two-structs-with-the-same-name-in-a-struct/41951804#41951804", "title": "Embed two structs with the same name in a struct", "body": "<p>You can try to first wrap your <code>whatever.Store</code> into distinct-named types:</p>\n\n<pre><code>import (\n    \"os\"\n    \"whatever/sql\"\n)\n\ntype SqlStore struct {\n    *sql.Store\n}\n\ntype FileStore struct {\n     *os.File\n}\n\ntype DataStore struct {\n     SqlStore\n     FileStore\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/6FpnYqXbHR\" rel=\"nofollow noreferrer\">Playground link</a>.</p>\n\n<p>Note that Go 1.9 might gain support for type aliases: see <a href=\"https://github.com/golang/go/issues/16339\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://github.com/golang/go/issues/18130\" rel=\"nofollow noreferrer\">this</a>.  I'm not sure that would help in your case but might be interesting to learn about.</p>\n"}, {"tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": false, "score": 2, "last_activity_date": 1485901526, "creation_date": 1485901526, "answer_id": 41968597, "question_id": 41951172, "link": "https://stackoverflow.com/questions/41951172/embed-two-structs-with-the-same-name-in-a-struct/41968597#41968597", "title": "Embed two structs with the same name in a struct", "body": "<p>You can indeed refer to a field even if present in two different substructures included as anonymous fields:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype A struct {\n    x int32\n}\n\ntype B struct {\n    x int32\n}\n\ntype C struct {\n    A\n    B\n}\n\nfunc main() {\n    c := C{A{1}, B{2}}\n    //fmt.Println(c.x) // Error, ambiguous\n    fmt.Println(c.A.x) // Ok, 1\n    fmt.Println(c.B.x) // Ok, 2\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7522, "user_id": 2142441, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1296edcd40a8fb8af4086e1544fcc2a9?s=128&d=identicon&r=PG", "display_name": "mattes", "link": "https://stackoverflow.com/users/2142441/mattes"}, "is_accepted": true, "score": 8, "last_activity_date": 1559281827, "creation_date": 1559281827, "answer_id": 56389339, "question_id": 41951172, "link": "https://stackoverflow.com/questions/41951172/embed-two-structs-with-the-same-name-in-a-struct/56389339#56389339", "title": "Embed two structs with the same name in a struct", "body": "<p>Use a <a href=\"https://golang.org/doc/go1.9#language\" rel=\"noreferrer\">type alias</a>, example:</p>\n\n<pre><code>type sqlStore = sql.Store // this is a type alias\n\ntype datastore {\n    *sqlStore\n    *file.Store\n}\n</code></pre>\n\n<p>A type alias doesn\u2019t create a new distinct type different from the type it\u2019s created from. It just introduces an alias name <code>sqlStore</code>, an alternate spelling, for the type denoted by <code>sql.Store</code>.</p>\n"}], "owner": {"reputation": 5764, "user_id": 1336532, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93e5830761f6e85757991d5915369349?s=128&d=identicon&r=PG", "display_name": "Mahoni", "link": "https://stackoverflow.com/users/1336532/mahoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2222, "favorite_count": 1, "accepted_answer_id": 56389339, "answer_count": 3, "score": 4, "last_activity_date": 1559281827, "creation_date": 1485844776, "question_id": 41951172, "link": "https://stackoverflow.com/questions/41951172/embed-two-structs-with-the-same-name-in-a-struct", "title": "Embed two structs with the same name in a struct", "body": "<p>How do you embed two types of the same name in a struct? For instance:</p>\n\n<pre><code>type datastore {\n    *sql.Store\n    *file.Store\n}\n</code></pre>\n\n<p>Results in <code>duplicate field Store</code>. I know this makes sense, since you wouldn't be able to refer to the embedded field <code>ds.Store</code> but how do you accomplish this anyway?</p>\n\n<p>To clarify, I want to implement an interface with <code>datastore</code>. For that both structs are needed as their methods complement each other to create the interface. What alterantives do I have?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 149, "user_id": 7442734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ea14d7b25c9892334d44e7c4d13523?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Grigorov", "link": "https://stackoverflow.com/users/7442734/anton-grigorov"}, "edited": false, "score": 1, "creation_date": 1485839316, "post_id": 41949880, "comment_id": 71079796, "body": "Is regex required? Why not split and then select the 4th element from the array?"}, {"owner": {"reputation": 884, "user_id": 1139454, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fZDFq.png?s=128&g=1", "display_name": "Cocotton", "link": "https://stackoverflow.com/users/1139454/cocotton"}, "reply_to_user": {"reputation": 149, "user_id": 7442734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09ea14d7b25c9892334d44e7c4d13523?s=128&d=identicon&r=PG&f=1", "display_name": "Anton Grigorov", "link": "https://stackoverflow.com/users/7442734/anton-grigorov"}, "edited": false, "score": 0, "creation_date": 1485839877, "post_id": 41949880, "comment_id": 71079986, "body": "I could have indeed done it by splitting the string, but I was curious to see how that could be achieved with regex :-)"}], "answers": [{"comments": [{"owner": {"reputation": 884, "user_id": 1139454, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fZDFq.png?s=128&g=1", "display_name": "Cocotton", "link": "https://stackoverflow.com/users/1139454/cocotton"}, "edited": false, "score": 0, "creation_date": 1485839766, "post_id": 41949920, "comment_id": 71079953, "body": "That worked! I had some troubles with groups, that helped me to understand way better!"}, {"owner": {"reputation": 32215, "user_id": 3789550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8mGqv.gif?s=128&g=1", "display_name": "heemayl", "link": "https://stackoverflow.com/users/3789550/heemayl"}, "reply_to_user": {"reputation": 884, "user_id": 1139454, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fZDFq.png?s=128&g=1", "display_name": "Cocotton", "link": "https://stackoverflow.com/users/1139454/cocotton"}, "edited": false, "score": 0, "creation_date": 1485840146, "post_id": 41949920, "comment_id": 71080059, "body": "@Cocotton Great. Check my edits too; i think string manipulation is what you should be after in this case."}, {"owner": {"reputation": 884, "user_id": 1139454, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fZDFq.png?s=128&g=1", "display_name": "Cocotton", "link": "https://stackoverflow.com/users/1139454/cocotton"}, "edited": false, "score": 0, "creation_date": 1485840249, "post_id": 41949920, "comment_id": 71080096, "body": "Yes that would work well indeed! But I&#39;ll admit I thought regex would be faster than straight string manipulations. Very interesting, thanks!"}], "tags": [], "owner": {"reputation": 32215, "user_id": 3789550, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8mGqv.gif?s=128&g=1", "display_name": "heemayl", "link": "https://stackoverflow.com/users/3789550/heemayl"}, "is_accepted": true, "score": 6, "last_activity_date": 1485840095, "last_edit_date": 1485840095, "creation_date": 1485838635, "answer_id": 41949920, "question_id": 41949880, "link": "https://stackoverflow.com/questions/41949880/regex-how-to-match-a-substring-after-x-occurrences-of-a-pattern/41949920#41949920", "title": "regex - How to match a substring after X occurrences of a pattern?", "body": "<p>Do:</p>\n\n<pre><code>^(?:[^-]+-){3}([^-]+)\n</code></pre>\n\n<ul>\n<li><p><code>^(?:[^-]+-){3}</code> matches <code>-</code> separated first 3 fields, <code>(?:)</code> makes the group non-capturing</p></li>\n<li><p>The captured group, <code>([^-]+)</code>  will contain the <code>-</code> separated 4th field.</p></li>\n</ul>\n\n<p><a href=\"https://regex101.com/r/OnkEJA/1\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<hr>\n\n<p>While we are at this, you should perhaps look at string manipulation rather than costly Regex implementation, plain <code>strings.Split()</code> should do:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    s := \"ab1-cde23-fg45-h6-ijk-789.lmn.local.        86400 IN A  12.34.5.123\"\n    fmt.Println(strings.Split(s, \"-\")[3])\n}\n</code></pre>\n"}], "owner": {"reputation": 884, "user_id": 1139454, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/fZDFq.png?s=128&g=1", "display_name": "Cocotton", "link": "https://stackoverflow.com/users/1139454/cocotton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1455, "favorite_count": 0, "accepted_answer_id": 41949920, "answer_count": 1, "score": 5, "last_activity_date": 1485840095, "creation_date": 1485838427, "question_id": 41949880, "link": "https://stackoverflow.com/questions/41949880/regex-how-to-match-a-substring-after-x-occurrences-of-a-pattern", "title": "regex - How to match a substring after X occurrences of a pattern?", "body": "<pre><code>ab1-cde23-fg45-h6-ijk-789.lmn.local.        86400 IN A  12.34.5.123\n</code></pre>\n\n<p>In the follow DNS entry, I'm trying to match the <code>h6</code> section (position 4). At this point, I know this section of the domain is only composed of 2 letters/digits or one of each, so I can match it (in a clumsy way) with</p>\n\n<pre><code>\"-[a-zA-Z0-9]{2}-\"\n</code></pre>\n\n<p><strong>In a case where I could not assume that this is the only section of a domain with 2 letters/digits, how could I match only the content of the 4th position minus the <code>-</code>?</strong> (<code>ab1</code> being the first position, <code>cde23</code> the second, and so on, with all the positions separated by <code>-</code>)</p>\n\n<p>I'm able to match up to the 4th positions with the following regex, but it includes everything from the start.</p>\n\n<pre><code>\"([a-zA-Z0-9]*-){3}[a-zA-Z0-9]*-\"\n</code></pre>\n\n<p>I'm using theses regexp in golang.</p>\n"}, {"tags": ["go", "interface", "go-cobra"], "comments": [{"owner": {"reputation": 750, "user_id": 2809739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymnxe.jpg?s=128&g=1", "display_name": "Sachin Nambiar Nalavattanon", "link": "https://stackoverflow.com/users/2809739/sachin-nambiar-nalavattanon"}, "edited": false, "score": 0, "creation_date": 1486372777, "post_id": 41948959, "comment_id": 71299761, "body": "Please show exactly where you are stuck and what have you tried. <a href=\"http://stackoverflow.com/help/mcve\">stackoverflow.com/help/mcve</a>"}, {"owner": {"reputation": 67, "user_id": 6643210, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa44986fcb2caa1a389735cf23744508?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/6643210/manu"}, "reply_to_user": {"reputation": 750, "user_id": 2809739, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ymnxe.jpg?s=128&g=1", "display_name": "Sachin Nambiar Nalavattanon", "link": "https://stackoverflow.com/users/2809739/sachin-nambiar-nalavattanon"}, "edited": false, "score": 0, "creation_date": 1486525413, "post_id": 41948959, "comment_id": 71378244, "body": "I want use the concept of interfaces in cobra to implement a calculator.I want to implement a method called operations for addition, subtraction, multiplication, division.I have done it using the go language but I don&#39;t know how to do the same using cobra commands, Should I do it in a separate command ..?"}, {"owner": {"reputation": 145, "user_id": 7471352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448a503438bdc7c5114bb1e7b95155da?s=128&d=identicon&r=PG&f=1", "display_name": "Aor", "link": "https://stackoverflow.com/users/7471352/aor"}, "edited": false, "score": 0, "creation_date": 1512486079, "post_id": 41948959, "comment_id": 82271408, "body": "I don&#39;t know what you mean by the &quot;concept of interfaces in Cobra.&quot; Are you trying to make all of the commands interfaces? If so, why?"}, {"owner": {"reputation": 145, "user_id": 7471352, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/448a503438bdc7c5114bb1e7b95155da?s=128&d=identicon&r=PG&f=1", "display_name": "Aor", "link": "https://stackoverflow.com/users/7471352/aor"}, "edited": false, "score": 0, "creation_date": 1512486665, "post_id": 41948959, "comment_id": 82271837, "body": "Also, the way you add your command is not good practice. Instead of having a static function which creates and returns the addition command, you should define the command outside of a function and bind it to RootCmd in init() directly. <code>var addition = &amp;cobra.Command{...}</code> ... <code>func init() {RootCmd.AddCommand(addition)}</code>"}], "owner": {"reputation": 67, "user_id": 6643210, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/aa44986fcb2caa1a389735cf23744508?s=128&d=identicon&r=PG&f=1", "display_name": "Manu", "link": "https://stackoverflow.com/users/6643210/manu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 161, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1488062059, "creation_date": 1485831280, "last_edit_date": 1488062059, "question_id": 41948959, "link": "https://stackoverflow.com/questions/41948959/implementing-go-interfaces-using-cobra-commands", "title": "Implementing Go interfaces using cobra commands", "body": "<p>I have written a program to calculate basic arithmetic functions using interfaces in Go language.</p>\n\n<p>I want to do the same using COBRA commands. Here is <a href=\"https://play.golang.org/p/9d3unffuNU\" rel=\"nofollow noreferrer\">some Go code using interfaces</a>.</p>\n\n<p>I have also implemented the arithmetic functions using <code>cobra</code> commands \nwithout the interfaces.</p>\n\n<p>this is addition using cobra commands without using the concept of interfaces, I want to implement the same using cobra commands.</p>\n\n<pre><code>package cmd\n\n    import (\n        \"fmt\"\n\n        \"github.com/spf13/cobra\"\n\n        \"os\"\n\n        \"strconv\"\n    )\n\n    func addCmd() *cobra.Command {\n        var input int\n        c := &amp;cobra.Command{\n            Use:   \"add\",\n            Short: \"Addition value of given Numbers\",\n\n            Run: func(cmd *cobra.Command, args []string) {\n                if len(args) != input {\n                    fmt.Println(fmt.Sprintf(\"You need to provide %v number to sum up\", input))\n                    os.Exit(1)\n                }\n                numbers := make([]int, input)\n                for i := 0; i &lt; input; i++ {\n                    num, _ := strconv.Atoi(args[i])\n                    numbers[i] = num\n                }\n                sum := 0\n                for _, numbers := range numbers {\n                    sum += numbers\n                }\n                fmt.Println(\"The Sum :\", sum)\n            },\n        }\n        c.Flags().IntVar(&amp;input, \"input\", 0, \"Number of input\")\n        return c\n    }\n\n    func init() {\n\n        cmd := addCmd()\n        RootCmd.AddCommand(cmd)\n\n    }\n</code></pre>\n\n<p>Can someone help me out with the interfaces and the cobra commands.</p>\n"}, {"tags": ["maven", "go", "docker"], "comments": [{"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1485826591, "post_id": 41948271, "comment_id": 71076845, "body": "By docker api, are you referring to the rest protocol, or just the <code>docker exec</code> cli?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "reply_to_user": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1485826701, "post_id": 41948271, "comment_id": 71076878, "body": "@BMitch the rest protocol"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "edited": false, "score": 0, "creation_date": 1485827983, "post_id": 41948498, "comment_id": 71077197, "body": "So does Running refer to the status of the exec command as opposed to the state of the container?"}, {"owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "edited": false, "score": 0, "creation_date": 1485828145, "post_id": 41948498, "comment_id": 71077223, "body": "For the exec inspect api, I believe so. Notice the Pid in the api reference is not 1 which it would be for the process running the container."}], "tags": [], "owner": {"reputation": 144207, "user_id": 596285, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b6975c494d3d9c404dd3d7af2edf3133?s=128&d=identicon&r=PG", "display_name": "BMitch", "link": "https://stackoverflow.com/users/596285/bmitch"}, "is_accepted": true, "score": 1, "last_activity_date": 1485827435, "creation_date": 1485827435, "answer_id": 41948498, "question_id": 41948271, "link": "https://stackoverflow.com/questions/41948271/how-to-determine-when-cmds-in-docker-exec-complete/41948498#41948498", "title": "How to determine when cmds in docker exec complete", "body": "<p>From the <a href=\"https://docs.docker.com/engine/api/v1.25/#operation/ExecStart\" rel=\"nofollow noreferrer\">exec api spec</a> if you do not set detach to true, the web socket should close once the command finishes. If you do detach from the the exec, then you can use the <a href=\"https://docs.docker.com/engine/api/v1.25/#operation/ExecInspect\" rel=\"nofollow noreferrer\">exec inspect api</a> and poll for Running to go to false.</p>\n\n<p>If you're using the exec api to run an interactive shell and you run your commands as input to the shell without closing stdin, then that shell will hang just as if you ran it outside of docker. You can close stdin to the shell or you'll need to \"get creative\" if that's not an option.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2494770"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 256, "favorite_count": 0, "accepted_answer_id": 41948498, "answer_count": 1, "score": 1, "last_activity_date": 1485827435, "creation_date": 1485825648, "last_edit_date": 1485826716, "question_id": 41948271, "link": "https://stackoverflow.com/questions/41948271/how-to-determine-when-cmds-in-docker-exec-complete", "title": "How to determine when cmds in docker exec complete", "body": "<p>I'm currently using the Docker Rest API to run an exec command on a container to start building a maven project. I was wondering if there was any way provided by Docker to determine when the cmds you attach to the exec cmd complete or if I need to start getting creative </p>\n"}, {"tags": ["file", "go", "hash"], "answers": [{"comments": [{"owner": {"reputation": 954, "user_id": 779856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e5060ea49d244015fab26fba9c118046?s=128&d=identicon&r=PG", "display_name": "Valentin", "link": "https://stackoverflow.com/users/779856/valentin"}, "edited": false, "score": 0, "creation_date": 1485867263, "post_id": 41947512, "comment_id": 71094900, "body": "I posted above, io.Copy and and io.Write gives different data types, int64 and int, so results are platform dependent. How to resolve that?"}, {"owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "reply_to_user": {"reputation": 954, "user_id": 779856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e5060ea49d244015fab26fba9c118046?s=128&d=identicon&r=PG", "display_name": "Valentin", "link": "https://stackoverflow.com/users/779856/valentin"}, "edited": false, "score": 0, "creation_date": 1485879185, "post_id": 41947512, "comment_id": 71103433, "body": "If your files are too big for their size to fit in an int, you can&#39;t make a byte slice big enough to hold their content anyway, since the length of a slice is an int. (And if you&#39;re running on a 32-bit platform, where this is an issue, you probably don&#39;t have enough RAM to read a file that big either.)"}], "tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": false, "score": -1, "last_activity_date": 1485820556, "creation_date": 1485820556, "answer_id": 41947512, "question_id": 41947307, "link": "https://stackoverflow.com/questions/41947307/how-to-return-hash-and-bytes-in-one-step-in-go/41947512#41947512", "title": "How to return hash and bytes in one step in Go?", "body": "<p>Do <code>data, err := ioutil.ReadFile(fname)</code> first. You'll have your slice of bytes. Then create your hasher, and do <code>hasher.Write(data)</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 954, "user_id": 779856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e5060ea49d244015fab26fba9c118046?s=128&d=identicon&r=PG", "display_name": "Valentin", "link": "https://stackoverflow.com/users/779856/valentin"}, "edited": false, "score": 0, "creation_date": 1485867166, "post_id": 41947514, "comment_id": 71094839, "body": "even though it works, but it will give inconsistent results, the io.Copy returns int64 while io.Writer returns int. Of course I can cast later to former, but it makes me think it becomes architecture specific and will lead to issues when I need to deal with large files."}], "tags": [], "owner": {"reputation": 19, "user_id": 2330178, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7770fc436c9301ec4928ae47fba8e9ae?s=128&d=identicon&r=PG", "display_name": "Steve", "link": "https://stackoverflow.com/users/2330178/steve"}, "is_accepted": false, "score": 0, "last_activity_date": 1485820574, "creation_date": 1485820574, "answer_id": 41947514, "question_id": 41947307, "link": "https://stackoverflow.com/questions/41947307/how-to-return-hash-and-bytes-in-one-step-in-go/41947514#41947514", "title": "How to return hash and bytes in one step in Go?", "body": "<p>You can write bytes directly to the hasher. For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/sha256\"\n    \"encoding/hex\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n    hasher := sha256.New()\n\n    data, err := ioutil.ReadFile(\"foo.txt\")\n    if err != nil {\n        panic(err)\n    }\n\n    hasher.Write(data)\n    cksum := hex.EncodeToString(hasher.Sum(nil))\n\n    println(cksum)\n}\n</code></pre>\n\n<p>As the Hash interface embeds io.Writer. This allows you to read the bytes from the file once, write them into the hasher then also return them out. </p>\n"}, {"comments": [{"owner": {"reputation": 793, "user_id": 90506, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/a4bffdc2e88202aa1c2b74e165355199?s=128&d=identicon&r=PG", "display_name": "farhany", "link": "https://stackoverflow.com/users/90506/farhany"}, "edited": false, "score": 0, "creation_date": 1556076551, "post_id": 41963206, "comment_id": 98309730, "body": "Best example on how to use io.TeeReader I&#39;ve come across. Short, and sweet. Thanks!"}], "tags": [], "owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "is_accepted": true, "score": 7, "last_activity_date": 1485882441, "last_edit_date": 1485882441, "creation_date": 1485881851, "answer_id": 41963206, "question_id": 41947307, "link": "https://stackoverflow.com/questions/41947307/how-to-return-hash-and-bytes-in-one-step-in-go/41963206#41963206", "title": "How to return hash and bytes in one step in Go?", "body": "<p>If you want to read a file, without creating a copy of the entire file in memory, and at the same time calculate its hash, you can do so with a <a href=\"https://golang.org/pkg/io/#TeeReader\" rel=\"noreferrer\">TeeReader</a>:</p>\n\n<pre><code>hasher := sha256.New()\nf, err := os.Open(fname)\ndata := io.TeeReader(f, hasher)\n// Now read from data as usual, which is still a stream.\n</code></pre>\n\n<p>What happens here is that any bytes that are read from <code>data</code> (which is a <code>Reader</code> just like the file object <code>f</code> is) will be pushed to <code>hasher</code>as well.</p>\n\n<p>Note, however, that <code>hasher</code> will produce the correct hash only once you have read the entire file through <code>data</code>, and not until then. So if you need the hash before you decide whether or not you want to read the file, you are left with the options of either doing it in two passes (for example like you are now), or to always read the file but discard the result if the hash check failed.</p>\n\n<p>If you do read the file in two passes, you could of course buffer the entire file data in a byte buffer in memory. However, the operating system will typically cache the file you just read in RAM anyway (if possible), so the performance benefit of doing a buffered two-pass solution yourself rather than just doing two passes over the file is probably negligible.</p>\n"}, {"tags": [], "owner": {"reputation": 1178, "user_id": 3967945, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d671333d111810416ba4952f1da75c1?s=128&d=identicon&r=PG", "display_name": "mroman", "link": "https://stackoverflow.com/users/3967945/mroman"}, "is_accepted": false, "score": -1, "last_activity_date": 1528905631, "creation_date": 1528905631, "answer_id": 50841610, "question_id": 41947307, "link": "https://stackoverflow.com/questions/41947307/how-to-return-hash-and-bytes-in-one-step-in-go/50841610#50841610", "title": "How to return hash and bytes in one step in Go?", "body": "<p>If you plan on hashing files you shouldn't read the whole file into memory because... there are large files that don't fit into RAM. Yes, in practice you very rarely will run into such out-of-memory issues but you can easily prevent them. The <a href=\"https://golang.org/pkg/hash/#Hash\" rel=\"nofollow noreferrer\">Hash</a> interface is an <code>io.Writer</code>. Usually, the Hash packages have a <a href=\"https://golang.org/pkg/crypto/sha256/#New\" rel=\"nofollow noreferrer\">New</a> function that return a Hash. This allows you to read the file in blocks and continuously feed it to the <code>Write</code> method of the Hash you have. You may also use methods like <code>io.Copy</code> to do this:</p>\n\n<pre><code>h := sha256.New()\ndata := &amp;bytes.Buffer{}\ndata.Write([]byte(\"hi there\"))\ndata.Write([]byte(\"folks\"))\nio.Copy(h, data)\nfmt.Printf(\"%x\", h.Sum(nil))\n</code></pre>\n\n<p><code>io.Copy</code> uses a bufer of 32KiB internally so using it requires around 32KiB of memory max. </p>\n"}], "owner": {"reputation": 954, "user_id": 779856, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/e5060ea49d244015fab26fba9c118046?s=128&d=identicon&r=PG", "display_name": "Valentin", "link": "https://stackoverflow.com/users/779856/valentin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1476, "favorite_count": 1, "accepted_answer_id": 41963206, "answer_count": 4, "score": 2, "last_activity_date": 1528905631, "creation_date": 1485819332, "question_id": 41947307, "link": "https://stackoverflow.com/questions/41947307/how-to-return-hash-and-bytes-in-one-step-in-go", "title": "How to return hash and bytes in one step in Go?", "body": "<p>I'm trying to understand how I can read content of the file, calculate its hash and return its bytes in one Go. So far, I'm doing this in two steps, e.g.</p>\n\n<pre><code>// calculate file checksum\nhasher := sha256.New()\nf, err := os.Open(fname)\nif err != nil {\n    msg := fmt.Sprintf(\"Unable to open file %s, %v\", fname, err)\n    panic(msg)\n}\ndefer f.Close()\nb, err := io.Copy(hasher, f)\nif err != nil {\n    panic(err)\n}\ncksum := hex.EncodeToString(hasher.Sum(nil))\n\n// read again (!!!) to get data as bytes array\ndata, err := ioutil.ReadFile(fname)\n</code></pre>\n\n<p>Obviously it is not the most efficient way to do this, since read happens twice, once in copy to pass to hasher and another in ioutil to read file and return list of bytes. I'm struggling to understand how I can combine these steps together and do in one go, read data once, calculate any hash and return it along with list of bytes to another layer.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485814328, "post_id": 41946148, "comment_id": 71073006, "body": "Read through <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">&quot;Effective Go&quot;</a> for a quick overview on the language and programming style"}], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 7491531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fnjm7q0i6y8/AAAAAAAAAAI/AAAAAAAAAAw/FQ4FckqUE-c/photo.jpg?sz=128", "display_name": "tahseen jamal", "link": "https://stackoverflow.com/users/7491531/tahseen-jamal"}, "edited": false, "score": 0, "creation_date": 1485817304, "post_id": 41946354, "comment_id": 71074296, "body": "If I continue in this program to make a binary tree program out of it, just want to understand how would I know if the s.left element is already declared or not ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3, "user_id": 7491531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fnjm7q0i6y8/AAAAAAAAAAI/AAAAAAAAAAw/FQ4FckqUE-c/photo.jpg?sz=128", "display_name": "tahseen jamal", "link": "https://stackoverflow.com/users/7491531/tahseen-jamal"}, "edited": false, "score": 1, "creation_date": 1485817528, "post_id": 41946354, "comment_id": 71074386, "body": "@tahseenjamal: just compare it to <code>nil</code>."}, {"owner": {"reputation": 3, "user_id": 7491531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fnjm7q0i6y8/AAAAAAAAAAI/AAAAAAAAAAw/FQ4FckqUE-c/photo.jpg?sz=128", "display_name": "tahseen jamal", "link": "https://stackoverflow.com/users/7491531/tahseen-jamal"}, "edited": false, "score": 0, "creation_date": 1485899350, "post_id": 41946354, "comment_id": 71114979, "body": "if I try to now print  s.left.element  it gives me error, why ?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3, "user_id": 7491531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fnjm7q0i6y8/AAAAAAAAAAI/AAAAAAAAAAw/FQ4FckqUE-c/photo.jpg?sz=128", "display_name": "tahseen jamal", "link": "https://stackoverflow.com/users/7491531/tahseen-jamal"}, "edited": false, "score": 0, "creation_date": 1485900240, "post_id": 41946354, "comment_id": 71115352, "body": "<code>left</code> is a <code>node</code>, not a <code>node_element </code>. You need a type assertion if you want to do that."}, {"owner": {"reputation": 3, "user_id": 7491531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fnjm7q0i6y8/AAAAAAAAAAI/AAAAAAAAAAw/FQ4FckqUE-c/photo.jpg?sz=128", "display_name": "tahseen jamal", "link": "https://stackoverflow.com/users/7491531/tahseen-jamal"}, "edited": false, "score": 0, "creation_date": 1485900708, "post_id": 41946354, "comment_id": 71115562, "body": "Got it. Now the last thing. I want to show binary tree. Which means in getval() want to return a string showing left and right also  but in first initialisation left and right are nil and therefore   return &quot;{&quot; + strconv.Itoa(c.left.(*node_element).element) + &quot;.&quot; + strconv.Itoa(c.element) + &quot;.&quot; + strconv.Itoa(c.right.(*node_element).element) + &quot;}&quot;  fails as am converting a nil to string"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3, "user_id": 7491531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fnjm7q0i6y8/AAAAAAAAAAI/AAAAAAAAAAw/FQ4FckqUE-c/photo.jpg?sz=128", "display_name": "tahseen jamal", "link": "https://stackoverflow.com/users/7491531/tahseen-jamal"}, "edited": false, "score": 0, "creation_date": 1485900883, "post_id": 41946354, "comment_id": 71115640, "body": "you need to check if it&#39;s nil before the type assertion, or you need to use the  multi-value type assertion which is safe from panics."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1485814515, "creation_date": 1485814515, "answer_id": 41946354, "question_id": 41946148, "link": "https://stackoverflow.com/questions/41946148/golang-binary-tree-using-interface-and-struct/41946354#41946354", "title": "GoLang Binary Tree - using Interface and Struct", "body": "<p>You don't need to declare <code>s</code> as a <code>node</code>, a <code>*node_element</code> can be used as a <code>node</code>. You also never want to have a pointer to an interface, so change the <code>left</code> and <code>right</code> types to <code>node</code>.</p>\n\n<p>You can then just assign the fields directly:</p>\n\n<pre><code>s := &amp;node_element{}\ns.add(1)\ns.left = &amp;node_element{element: 2}\ns.right = &amp;node_element{element: 3}\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 7491531, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-fnjm7q0i6y8/AAAAAAAAAAI/AAAAAAAAAAw/FQ4FckqUE-c/photo.jpg?sz=128", "display_name": "tahseen jamal", "link": "https://stackoverflow.com/users/7491531/tahseen-jamal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 475, "favorite_count": 0, "accepted_answer_id": 41946354, "answer_count": 1, "score": 0, "last_activity_date": 1485814515, "creation_date": 1485813589, "question_id": 41946148, "link": "https://stackoverflow.com/questions/41946148/golang-binary-tree-using-interface-and-struct", "title": "GoLang Binary Tree - using Interface and Struct", "body": "<p>I am trying to use Interfaces and Struct in GoLang to create a binary tree concept</p>\n\n<p>I wrote the below code</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype node interface {\n    add(a int)\n    getval() int\n}\n\ntype node_element struct {\n    element int\n\n    left  *node\n    right *node\n}\n\nfunc (c *node_element) add(a int) {\n    c.element = a\n}\n\nfunc (c *node_element) getval() int {\n    return c.element\n}\n\nfunc main() {\n\n    var s node\n\n    s = &amp;node_element{}\n\n    s.add(1)\n\n    fmt.Println(s.getval())\n\n}\n</code></pre>\n\n<p>Now how do I instantiate left and right. I am using VIM with Go autocomplete. In auto complete on pressing . there is no list. Which means access to this pointer object to s is not happening</p>\n\n<p>How to instantiate and use left and right ?</p>\n"}, {"tags": ["math", "go"], "comments": [{"owner": {"reputation": 65718, "user_id": 844416, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e39c2364935265593d76247ddc6d07c?s=128&d=identicon&r=PG", "display_name": "MBo", "link": "https://stackoverflow.com/users/844416/mbo"}, "edited": false, "score": 1, "creation_date": 1485838687, "post_id": 41945572, "comment_id": 71079604, "body": "Be ready that <code>Sqrt(n^2)</code> would not equal to <code>n</code>"}], "owner": {"reputation": 35, "user_id": 6244859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uJRZC.jpg?s=128&g=1", "display_name": "Rachel Addleman", "link": "https://stackoverflow.com/users/6244859/rachel-addleman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 151, "favorite_count": 0, "closed_date": 1485852413, "answer_count": 0, "score": 2, "last_activity_date": 1485839383, "creation_date": 1485811141, "question_id": 41945572, "link": "https://stackoverflow.com/questions/41945572/golang-how-to-check-if-a-float64-is-a-whole-number", "closed_reason": "Duplicate", "title": "Golang how to check if a float64 is a whole number?", "body": "<p>I'm trying to figure out whether the result from a math.Sqrt() is a whole number. Normally I would try something like :</p>\n\n<pre><code>    c := math.Sqrt((a * a) + (b * b)) // a &amp; b are float64\n\n    if c % 1 == 0 {\n     return \"whole number\"\n    } else {\n     return \"integer\"\n    }\n</code></pre>\n\n<p>However this function returns a float64 on which you can't use the modulus.  I've tried looking at documentation to try and find a good solution but I haven't been successful. Does anyone have a good solution for this issue?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1485806226, "post_id": 41944253, "comment_id": 71068853, "body": "We can&#39;t show you the specific problem with a complete example, but it looks like you&#39;re passing around multiple slices pointing to the same array. Chances are <code>GetCards</code> isn&#39;t doing what you think it is."}, {"owner": {"reputation": 8159, "user_id": 5405630, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb6042cc5ec007ec9a1a7ee0b07a77b4?s=128&d=identicon&r=PG&f=1", "display_name": "DevK", "link": "https://stackoverflow.com/users/5405630/devk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485806345, "post_id": 41944253, "comment_id": 71068923, "body": "I&#39;m more than happy to update you with anything you need. Give me a min and I&#39;ll edit my original post"}, {"owner": {"reputation": 8159, "user_id": 5405630, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb6042cc5ec007ec9a1a7ee0b07a77b4?s=128&d=identicon&r=PG&f=1", "display_name": "DevK", "link": "https://stackoverflow.com/users/5405630/devk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485806606, "post_id": 41944253, "comment_id": 71069060, "body": "@JimB I&#39;ve created a Pastebin with my card stack. <code>GetCards</code> is just <code>return c.cards</code>. If there is anything else you think could help let me know"}, {"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1485806936, "post_id": 41944253, "comment_id": 71069223, "body": "<code>deck.PrintCards</code> is not seen in your code."}], "answers": [{"comments": [{"owner": {"reputation": 8159, "user_id": 5405630, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb6042cc5ec007ec9a1a7ee0b07a77b4?s=128&d=identicon&r=PG&f=1", "display_name": "DevK", "link": "https://stackoverflow.com/users/5405630/devk"}, "edited": false, "score": 0, "creation_date": 1485807605, "post_id": 41944564, "comment_id": 71069554, "body": "Thanks a lot of the help! So judging by that my <a href=\"https://github.com/d1am0nd/hearths-go/blob/cardstack/redo/hearths/cardstack.go#L120\" rel=\"nofollow noreferrer\"><code>SubStack</code></a> method is screwing me over? Because (if I understand correctly) it returns the reference to the same array, rather than creating a copy. (also I&#39;ve put it on github so whole source is visible now)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 8159, "user_id": 5405630, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb6042cc5ec007ec9a1a7ee0b07a77b4?s=128&d=identicon&r=PG&f=1", "display_name": "DevK", "link": "https://stackoverflow.com/users/5405630/devk"}, "edited": false, "score": 2, "creation_date": 1485807723, "post_id": 41944564, "comment_id": 71069626, "body": "Yes, if the intent if SubStack is to return a new slice, then you need to allocate one and copy the value (or possibly do it in SetCards. It&#39;s up to you to determine the specific semantics of the methods here)"}, {"owner": {"reputation": 8159, "user_id": 5405630, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb6042cc5ec007ec9a1a7ee0b07a77b4?s=128&d=identicon&r=PG&f=1", "display_name": "DevK", "link": "https://stackoverflow.com/users/5405630/devk"}, "edited": false, "score": 0, "creation_date": 1485808101, "post_id": 41944564, "comment_id": 71069811, "body": "Perfect. Thank you for your help and simple explanation!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1485810905, "last_edit_date": 1485810905, "creation_date": 1485807032, "answer_id": 41944564, "question_id": 41944253, "link": "https://stackoverflow.com/questions/41944253/golang-why-does-this-function-change-the-input-argument/41944564#41944564", "title": "Golang - Why does this function change the input argument?", "body": "<p>In your example, the value of <code>cards</code> in <code>DrawCards</code> is a sub-slice of the <code>CardsStack.cards</code> slice, which is referencing values in the same backing array.</p>\n\n<p>When you call <code>findCard</code> and remove a card from the <code>CardStack.cards</code> slice, you are manipulating the same array that the <code>cards</code> argument is using.</p>\n\n<p>When you want a copy of a slice, you need to allocate a new slice and copy each element. To do this in your example, you could:</p>\n\n<pre><code>ssCopy := make([]deck.Card, len(ss))\ncopy(ssCopy, ss)\ncards.DrawCards(ssCopy)\n</code></pre>\n"}], "owner": {"reputation": 8159, "user_id": 5405630, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/cb6042cc5ec007ec9a1a7ee0b07a77b4?s=128&d=identicon&r=PG&f=1", "display_name": "DevK", "link": "https://stackoverflow.com/users/5405630/devk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1090, "favorite_count": 0, "accepted_answer_id": 41944564, "answer_count": 1, "score": 3, "last_activity_date": 1485810905, "creation_date": 1485805713, "last_edit_date": 1485807237, "question_id": 41944253, "link": "https://stackoverflow.com/questions/41944253/golang-why-does-this-function-change-the-input-argument", "title": "Golang - Why does this function change the input argument?", "body": "<p>I'm learning Golang and I come from PHP background. I have a bit of trouble understanding some of the core functionalities at times.</p>\n\n<p>Specifically, right now I'm building a Hearths game and I've created a CardStack type, that has some convenient methods one might use in a card stack (read: player's hand, discard pile...) such as <code>DrawCards(...)</code>, <code>AppendCards(...)</code>...</p>\n\n<p><strong>The problem</strong> I have is that the function <code>func (c* CardStack) DrawCards(cards []deck.Card) ([]deck.Card, error) {...}</code> changes the argument <code>cards []deck.Card</code> and I cannot figure out why or how to avoid this.</p>\n\n<p>This is my CardStack:</p>\n\n<pre><code>type CardStack struct {\n    cards []deck.Card\n}\n</code></pre>\n\n<p>This is my <code>DrawCards</code> method:</p>\n\n<pre><code>func (c *CardStack) DrawCards(cards []deck.Card) ([]deck.Card, error) {\n    return c.getCardsSlice(cards, true)\n}\n\n// Returns cards that are missing\nfunc (c *CardStack) getCardsSlice(cards []deck.Card, rm bool) ([]deck.Card, error) {\n    var err error\n    var returnc = []deck.Card{}\n    for _, card := range cards {\n        fmt.Println(\"BEFORE c.findCard(cards): \")\n        deck.PrintCards(cards) // In my example this will print out {Kc, 8d}, which is what I expect it to be\n        _, err = c.findCard(card, rm) // AFTER THIS LINE THE cards VAR IS CHANGED\n        fmt.Println(\"AFTER c.findCard(cards): \")\n        deck.PrintCards(cards) // In my example this will print out {8d, 8d}, which is not at all what I expected\n        if err != nil {\n            return returnc, err\n        }\n    }\n    return returnc, nil\n}\n\n// Expects string like \"Ts\" or \"2h\" (1. face 2. suit)\nfunc (c *CardStack) findCard(cc deck.Card, rm bool) (deck.Card, error) {\n    for i, card := range c.GetCards() {\n        if cc == card {\n            return c.cardByIndex(i, rm)\n        }\n    }\n    return deck.Card{}, fmt.Errorf(\"Card not found\")\n}\n\nfunc (c *CardStack) cardByIndex(n int, rm bool) (deck.Card, error) {\n    if n &gt; len(c.GetCards()) {\n        return deck.Card{}, fmt.Errorf(\"Index out of bounds\")\n    }\n\n    card := c.GetCards()[n]\n    if rm {\n        c.SetCards(append(c.GetCards()[:n], c.GetCards()[n+1:]...))\n    }\n    return card, nil\n}\n</code></pre>\n\n<p>To explain a bit more - specifically the <code>findCard(...)</code> method that gets called in <code>getCardsSlice</code> messes with the original value (I've added comments to indicate where it happens).</p>\n\n<p>If it's of any help, this is part of my <code>main()</code> method that I use for debugging:</p>\n\n<pre><code>// ...\nss, _ := cards.SubStack(1, 3) // ss now holds {Kc, 8d}\nss.Print() // Prints {Kc, 8d}\ncards.Print() // Prints {5c, Kc, 8d} (assigned somewhere up in the code)\ncards.DrawCards(ss) // Draws {Kc, 8d} from {5c, Kc, 8d}\ncards.Print() // Prints {5c} - as expected\nss.Print() // Prints {8d, 8d} - ???\n</code></pre>\n\n<p>What am I doing wrong and how should I go about doing this.</p>\n\n<p>Any kind of help is appreciated.</p>\n\n<p><strong>Edit</strong>:</p>\n\n<p>The whole CardStack file: <a href=\"http://pastebin.com/LmhryfGc\" rel=\"nofollow noreferrer\">http://pastebin.com/LmhryfGc</a></p>\n\n<p><strong>Edit2</strong>:</p>\n\n<p>I was going to put it on github sooner or later (was hoping after the code looks semi-ok), here it is - <a href=\"https://github.com/d1am0nd/hearths-go/tree/cardstack/redo\" rel=\"nofollow noreferrer\">https://github.com/d1am0nd/hearths-go/tree/cardstack/redo</a></p>\n"}, {"tags": ["go", "rethinkdb"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485823815, "post_id": 41943744, "comment_id": 71076125, "body": "could you be more specific on the code sample ? A play link would be great"}], "answers": [{"tags": [], "owner": {"reputation": 5636, "user_id": 243581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2d196ce09c988b9e2782f5a04a987aa?s=128&d=identicon&r=PG", "display_name": "AtnNn", "link": "https://stackoverflow.com/users/243581/atnnn"}, "is_accepted": true, "score": 1, "last_activity_date": 1485843024, "creation_date": 1485843024, "answer_id": 41950775, "question_id": 41943744, "link": "https://stackoverflow.com/questions/41943744/how-to-find-fields-value-whose-equal-any-value-in-array/41950775#41950775", "title": "How to find field&#39;s value whose equal any value in array", "body": "<p>When you find yourself trying to iterate over an array inside a ReQL query, it is often easier or necessary to use built-in ReQL operations such as <code>Map</code> or <code>ConcatMap</code>.</p>\n\n<p>In this case, <code>Contains</code> seems to be the operation you want. Try something like:</p>\n\n<pre><code>(...).Filter(func(post r.Term) interface{}{\n    r.Expr(listOriginID).Contains(post.Field(\"OriginID\"))\n})\n</code></pre>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 41950775, "answer_count": 1, "score": 1, "last_activity_date": 1485850553, "creation_date": 1485803787, "last_edit_date": 1485850553, "question_id": 41943744, "link": "https://stackoverflow.com/questions/41943744/how-to-find-fields-value-whose-equal-any-value-in-array", "title": "How to find field&#39;s value whose equal any value in array", "body": "<p>I have an array whose contain some ID : </p>\n\n<pre><code>[\"4007fa1c-4e27-4d2e-9429-f3631171760c\",\n\"a21649a3-1a64-45cf-b92a-e899a7ef4742\",\n\"1903a571-b166-4f93-9c1c-93dc66067a49\", \n\"2845d278-5ec4-45e9-ab9c-999178332c73\",\n\"4e3ed481-a3d9-4689-8873-5c912668b26f\",\n\"390e89fd-d680-4264-8806-8295b361d2f1\"]\n</code></pre>\n\n<p>I would like thanks to this array, find all the posts having for \"OriginID\", one of the Ids present in the table.</p>\n\n<p>I've started something like that, but I don't know how to complete to make work this code.</p>\n\n<pre><code>curs, _ =   r.Table(\"posts\").\n            Filter(r.Row.Field(\"Validated\").Eq(false)).\nFilter(func(customer r.Term) interface{}{\n    for _, id := range listOriginID {\n        //I don't know how to finish\n    }\n})\n</code></pre>\n\n<p>Thank you for your help</p>\n"}, {"tags": ["javascript", "jquery", "json", "ajax", "go"], "comments": [{"owner": {"reputation": 133386, "user_id": 295783, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/da548667c834109a7059b51060e53dff?s=128&d=identicon&r=PG", "display_name": "mplungjan", "link": "https://stackoverflow.com/users/295783/mplungjan"}, "edited": false, "score": 0, "creation_date": 1485789739, "post_id": 41939318, "comment_id": 71059092, "body": "This IS your callback: <code>success:function(result) {            $(&#39;#target&#39;).html(&#39;Request was sent successfully...&#39;);            console.log(result);       }</code> - the result should be your JSON but I do not see the server return JSON"}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1485792111, "post_id": 41939318, "comment_id": 71060754, "body": "I am not sure what your output looks like from <code>myscript.sh</code>, but as a starter you can try sending that back.  Instead of printing to stdout with <code>fmt.Println(string(cmdOut))</code>, try <code>fmt.Fprint(rw, string(cmdOut))</code>"}, {"owner": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "edited": false, "score": 0, "creation_date": 1485793805, "post_id": 41939318, "comment_id": 71061835, "body": "Is this a streamed response?  In that, when my script runs, can it say &quot;Starting to run...&quot; and have that go to the web page and then have it say the last message when it is done, which is a bunch of stuff (i.e., not just a message saying Done)."}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1485794591, "post_id": 41939318, "comment_id": 71062291, "body": "Like Mark suggests below, look into websockets."}, {"owner": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "edited": false, "score": 0, "creation_date": 1485794980, "post_id": 41939318, "comment_id": 71062526, "body": "For some reason it throws error: error and I see the go server does not show it received the post json data.  If I run it again, it does not throw error, but when the go server gets to the end and writes the ftm.Fprint(rw, string(cmdOUt)), I do not see anything displaying on the web page that I would have thought would go to web page and the console.log."}], "answers": [{"tags": [], "owner": {"reputation": 32602, "user_id": 7050130, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efd06b6898f66b91234471a40cffae45?s=128&d=identicon&r=PG", "display_name": "Mark Adelsberger", "link": "https://stackoverflow.com/users/7050130/mark-adelsberger"}, "is_accepted": false, "score": 0, "last_activity_date": 1485790018, "creation_date": 1485790018, "answer_id": 41939557, "question_id": 41939318, "link": "https://stackoverflow.com/questions/41939318/have-a-go-web-service-that-receives-a-post-but-unclear-how-to-send-response-bac/41939557#41939557", "title": "Have a go web service that receives a post, but unclear how to send response back to jquery", "body": "<p>In your <code>ajax</code> call you've already specified a callback to receive a response; that's what <code>success</code> is, and it will receive the data provided by the server's <code>http.ResponseWriter</code>.</p>\n\n<p>If what you mean is that after the http request/response cycle is complete, at some later time you want the server to initiate a message to the client, then you need to be looking at websockets.</p>\n"}, {"comments": [{"owner": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "edited": false, "score": 0, "creation_date": 1485872106, "post_id": 41943539, "comment_id": 71098199, "body": "Okay, I need to resolve something first.  Why does this code go immediately to : {&quot;readyState&quot;:0,&quot;responseText&quot;:&quot;&quot;,&quot;status&quot;:0,&quot;statusText&quot;:&quot;e&zwnj;&#8203;rror&quot;}, but I see the json post stuff arrive at go server?  &quot;environmentid&quot;:&quot;95158277&quot;,&quot;versionid&quot;:&quot;94470491&quot;,&quot;dtp&quot;:&quot;201&zwnj;&#8203;7/02/02 09:11&quot;} ."}, {"owner": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "edited": false, "score": 0, "creation_date": 1485873210, "post_id": 41943539, "comment_id": 71099030, "body": "Running with curl seems to show it working:     2017/01/31 09:30:48 curl/7.29.0 Deploy: 95158277,94470491,stuff                  &lt;---shows it got post { &quot;deploymentState&quot;: &quot;SUCCESS&quot; }                &lt;---message at end with ajaxResponse.  But web page is not working.  It throws that statusText error.  I thought I had cross-domain working as I see the post arrive and can print values to screen and use them in the go server, but I guess web page is failing immediately so I can&#39;t send message back to it."}, {"owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "reply_to_user": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "edited": false, "score": 0, "creation_date": 1485874073, "post_id": 41943539, "comment_id": 71099618, "body": "I don&#39;t know if I really understand. I use pure ajax (without jquery), I will edit my answer to show an example of client side ajax request and maybe that can help."}], "tags": [], "owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "is_accepted": false, "score": 0, "last_activity_date": 1485874480, "last_edit_date": 1485874480, "creation_date": 1485803017, "answer_id": 41943539, "question_id": 41939318, "link": "https://stackoverflow.com/questions/41939318/have-a-go-web-service-that-receives-a-post-but-unclear-how-to-send-response-bac/41943539#41943539", "title": "Have a go web service that receives a post, but unclear how to send response back to jquery", "body": "<p>I use something like this:</p>\n\n<pre><code>func ajaxResponse(w http.ResponseWriter, res map[string]string) {\n  // set the proper headerfor application/json\n  w.Header().Set(\"Content-Type\", \"application/json\")             \n  // encode your response into json and write it to w\n  err := json.NewEncoder(w).Encode(res)                          \n  if err != nil {                                                \n    log.Println(err)                                             \n  }                                                              \n}\n</code></pre>\n\n<p>And call it like this:</p>\n\n<pre><code>func apiFunc(w http.ResponseWriter, r *http.Request) {\n  // do stuff\n  ajaxResponse(w, map[string]string{\"data\": \"your data here\"})\n}\n</code></pre>\n\n<p>Edit:</p>\n\n<p>on the client I use \"pure\" ajax without jquery:</p>\n\n<pre><code>// a function to send user info to add them to a database           \nfunction addUser() {                                                \n  // new request                                                    \n  var xhr = new XMLHttpRequest();                                   \n  // type (eg POST, GET, etc), and api endpoint                     \n  xhr.open('POST', '/api/addUser');                                    \n  // tell it you're sending json                                    \n  xhr.setRequestHeader('Content-Type', 'application/json');         \n  // call this function on load                                     \n  xhr.onload = function() {                                         \n    // if it was successful                                         \n    if (xhr.status === 200) {                                       \n      // parse the response into json                               \n      var userInfo = JSON.parse(xhr.responseText);                  \n      // use the json to change your apps UI                        \n      document.getElementById(\"footer\").innerHTML = userInfo.error; \n    }                                                               \n  };                                                                \n  xhr.send(JSON.stringify({                                         \n    // user info here                                               \n    error: \"nil\"                                                    \n  }));                                                              \n}                                                                   \n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "edited": false, "score": 0, "creation_date": 1485893383, "post_id": 41965225, "comment_id": 71111888, "body": "Never mind.  I just replaced the type=submit to type=button.  Cheers and thanks for looking at my question."}], "tags": [], "owner": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "is_accepted": false, "score": 0, "last_activity_date": 1485888400, "creation_date": 1485888400, "answer_id": 41965225, "question_id": 41939318, "link": "https://stackoverflow.com/questions/41939318/have-a-go-web-service-that-receives-a-post-but-unclear-how-to-send-response-bac/41965225#41965225", "title": "Have a go web service that receives a post, but unclear how to send response back to jquery", "body": "<p>I ended up changing my go server code and added a .ajaxSetup option in the client web page to disable cache and async.  The javascript url changed to fit into how they example was using post with a param so that it could store the array of post information.  This would allow me to add a GET to retrieve information on a specific request if I desired.   </p>\n\n<p>My last challenge, and maybe you can help, is that when the response arrives back at the web page it flashes on the screen for a second and then resets the page.  How do I get the result to stay on the screen and retain in the list boxes the response?  It has been a while since I made a page...</p>\n\n<p>Note: My concern is that I had to use the deprecated async cache stuff because the ajax was intermittent at best (i.e., it would not wait for result or even get json to go server if I tried sending a few times without the async and cache options.  </p>\n\n<pre><code>            $.ajaxSetup({async: false, cache: false});\n            $.ajax({\n                    type: 'POST',\n                    url: url,\n                    crossOrigin: true,\n                    contentType: 'application/json',\n                    data: jsonData,\n                    dataType: 'json',\n                    success: function(data) {\n                            console.log(JSON.stringify(data))\n                            document.getElementById(\"target\").innerHTML = \"&lt;p&gt;\" + JSON.stringify(data) + \"&lt;/p&gt;\";\n                            alert(JSON.stringify(data));\n                    },\n                    error: function(data) {\n                            console.log(JSON.stringify(data));\n                    }\n            });\n</code></pre>\n\n<p>The go server code changed to use gorilla:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"github.com/gorilla/mux\"\n    \"github.com/gorilla/handlers\"\n    \"os/exec\"\n    \"strings\"\n)\n\n// Deploy Struct\ntype Deploy struct {\n    Environment  string `json:\"environmentid\"`\n    Release      string `json:\"versionid\"`\n    DTP          string `json:\"dtp\"`\n}\n\nvar deploys = map[string]*Deploy{}\n\nfunc main() {\n    corsObj:=handlers.AllowedOrigins([]string{\"*\"})\n    methods := []string{\"GET\", \"POST\", \"PUT\", \"DELETE\"}\n    headers := []string{\"Content-Type\"}\n    router := mux.NewRouter()\n    router.HandleFunc(\"/deploy/{deployKey}\", handleDeploy).Methods(\"POST\")\n    log.Fatal(http.ListenAndServe(\":3000\",   handlers.CORS(handlers.AllowedMethods(methods), handlers.AllowedHeaders(headers), corsObj)(router)))\n}\n\nfunc handleDeploy(res http.ResponseWriter, req *http.Request) {\n    res.Header().Set(\"Content-Type\", \"application/json\")\n\n    vars := mux.Vars(req)\n    deployKey := vars[\"deployKey\"]\n\n    switch req.Method {\n    case \"POST\":\n            deploy := new(Deploy)\n            decoder := json.NewDecoder(req.Body)\n            error := decoder.Decode(&amp;deploy)\n            if error != nil {\n                    log.Println(error.Error())\n                    http.Error(res, error.Error(), http.StatusInternalServerError)\n                    return\n            }\n            deploys[deployKey] = deploy\n\n            /*\n            outgoingJSON, err := json.Marshal(deploy)\n            if err != nil {\n                    log.Println(error.Error())\n                    http.Error(res, err.Error(), http.StatusInternalServerError)\n                    return\n            }\n            */\n\n            fmt.Println(\"Deploy: \" + deploy.Environment + \",\" + deploy.Release + \",\" + deploy.DTP)\n            cmd := exec.Command(\"/u/boop/bin/boop/bam.sh\", strings.Split(fmt.Sprintf(\"-e %s -r %s\", deploy.Environment, deploy.Release), \" \")...)\n            cmdOut, cmdErr := cmd.Output()\n            if cmdErr != nil {\n                    log.Println(error.Error())\n                    http.Error(res, cmdErr.Error(), http.StatusInternalServerError)\n                    return\n            }\n            //fmt.Println(string(cmdOut))\n            //var s = string(cmdOut)\n            //strings.Replace(s,\"\\n\",\"\",-1)\n\n            res.WriteHeader(http.StatusCreated)\n            //fmt.Fprint(res, string(outgoingJSON))\n            fmt.Fprint(res, string(cmdOut))\n    }\n</code></pre>\n"}], "owner": {"reputation": 287, "user_id": 372429, "user_type": "registered", "accept_rate": 8, "profile_image": "https://www.gravatar.com/avatar/416c63cb7f6e15b4a11680121dff3e84?s=128&d=identicon&r=PG", "display_name": "archcutbank", "link": "https://stackoverflow.com/users/372429/archcutbank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 907, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1485888400, "creation_date": 1485789361, "question_id": 41939318, "link": "https://stackoverflow.com/questions/41939318/have-a-go-web-service-that-receives-a-post-but-unclear-how-to-send-response-bac", "title": "Have a go web service that receives a post, but unclear how to send response back to jquery", "body": "<p>Morning,</p>\n\n<p>I have some go code that receives a json post and does some stuff, but I want to send back to jquery the result or a message.  </p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"encoding/json\"\n    \"os/exec\"\n    \"strings\"\n)\ntype Deploy struct {\n    Environmentid string `json:\"environmentid\"`\n    Versionid string `json:\"versionid\"`\n    Dtp string `json:\"dtp\"`\n}\nfunc deploy(rw http.ResponseWriter, req *http.Request) {\n    if origin := req.Header.Get(\"Origin\"); origin != \"\" {\n        rw.Header().Set(\"Access-Control-Allow-Origin\", origin)\n        rw.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS,     PUT, DELETE\")\n        rw.Header().Set(\"Access-Control-Allow-Headers\",\n            \"Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-    Token, Authorization\")\n    }\n    // Stop here if its Preflighted OPTIONS request\n    if req.Method == \"OPTIONS\" {\n        return\n    }\n    if req.Method == \"POST\" {\n        d := Deploy{}\n        err := json.NewDecoder(req.Body).Decode(&amp;d)\n        if err != nil {\n            panic(\"Can't decode Json received in post\")\n        }\n        fmt.Println(\"Deploy: \" + d.Environmentid + \",\" + d.Versionid + \",\" +   d.Dtp)\n        // Run command\n        cmd := exec.Command(\"/bin/myscript.sh\", strings.Split(fmt.Sprintf(\"-e %s -v %s\", d.Environmentid, d.Versionid), \" \")...)\n        cmdOut, cmdErr := cmd.Output()\n        if cmdErr != nil {\n                panic(cmdErr)\n        }\n        fmt.Println(string(cmdOut))\n    }\n</code></pre>\n\n<p>The jquery I have right now:</p>\n\n<pre><code> $.ajax({\n     type: 'POST',\n     url: url,\n     cache:false,\n     crossDomain: true,\n     contentType: 'application/json; charset=utf-8',\n     data: jsonData,\n               dataType: 'json',\n     success:function(result) {\n           $('#target').html('Request was sent successfully...');\n           console.log(result);\n      },\n      error:function(xhr,status,error) {\n           //alert(error);\n      }\n });\n</code></pre>\n\n<p>I see the 3 things I send just fine.<br>\nI think I saw some reference to some option called callback for the $.ajax.  I am guessing that that allows me to put a function name to receive a response.  An example of how to receive a json response that has the success or error from the go server would be appreciated, and how to send the response from the go server to this callback.</p>\n"}, {"tags": ["mongodb", "go", "struct", "embedding", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "edited": false, "score": 0, "creation_date": 1485838915, "post_id": 41941085, "comment_id": 71079677, "body": "Ohh sorry, I forgot to type <code>ID</code> in the first code block. It&#39;s actually there in my code I just forgot to add it to this question. Thanks for pointing out that <code>inline</code> tag. That did it for me, thanks heaps! Btw, you have now answered 2 of my <code>mgo</code> questions with both as accepted! :)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1485847048, "last_edit_date": 1495540891, "creation_date": 1485794616, "answer_id": 41941085, "question_id": 41939080, "link": "https://stackoverflow.com/questions/41939080/anonymous-structs-return-empty-field-value/41941085#41941085", "title": "Anonymous structs return empty field value", "body": "<p>The problem here is that fields having <code>struct</code> types (including embedded structs) appear as embedded documents in MongoDB. If you don't want this, you have to specify the <code>\"inline\"</code> bson flag when embedding a struct:</p>\n\n<pre><code>User struct {\n    Id           `bson:\",inline\"`\n    Email string `json:\"email\" bson:\"email\"`\n}\n</code></pre>\n\n<p>What the <code>\"inline\"</code> tag does is in MongoDB it \"flattens\" the fields of the embedded struct as if they were part of the embedder struct.</p>\n\n<p>Similarly:</p>\n\n<pre><code>type UserModel struct {\n    SoftDelete `bson:\",inline\"`\n}\n\ntype BlogPost struct {\n    SoftDelete `bson:\",inline\"`\n}\n</code></pre>\n\n<p><sup><strong>Edit:</strong> the following section applies to the original <code>Id</code> type which embedded <code>bson.ObjectId</code>. The asker later clarified that this was just a typo (and edited the question since), and it is a named, non-anonymous field. Still think the info below is useful.</sup></p>\n\n<p>One thing to note about your <code>Id</code> type: Your <code>Id</code> type also <em>embeds</em> <code>bson.ObjectId</code>:</p>\n\n<pre><code>Id struct {\n    bson.ObjectId `json:\"id\" bson:\"_id\"`\n}\n</code></pre>\n\n<p><code>Id</code> not just has a field of <code>bson.ObjectId</code>, but it embeds it. This matters because this way you <code>Id</code> type will have a <code>String()</code> method promoted from <code>bson.ObjectId</code>, and so will <code>User</code> which embeds <code>Id</code>. Having said that, it will be hard trying to print or debug values of type <code>User</code>, because you will always see it printed just as a single <code>ObjectId</code>.</p>\n\n<p>Instead you can make it a regular field in <code>Id</code>, embedding <code>Id</code> in <code>User</code> will still work as expected:</p>\n\n<pre><code>Id struct {\n    ID bson.ObjectId `json:\"id\" bson:\"_id\"`\n}\n</code></pre>\n\n<p>See related question+asnwer: <a href=\"https://stackoverflow.com/questions/41595577/enforce-a-type-mapping-with-mgo/41596169#41596169\">Enforce a type mapping with mgo</a></p>\n"}], "owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 41941085, "answer_count": 1, "score": 2, "last_activity_date": 1485847048, "creation_date": 1485788654, "last_edit_date": 1485839098, "question_id": 41939080, "link": "https://stackoverflow.com/questions/41939080/anonymous-structs-return-empty-field-value", "title": "Anonymous structs return empty field value", "body": "<pre><code>type (\n\n    Id struct {\n        // I previously forgot to add the `ID` field in my question, it is present in my code but not on this question as @icza pointed it out to me\n        ID bson.ObjectId `json:\"id\" bson:\"_id\"`\n    }\n\n    User struct {\n        // When using anonymous struct, upon returning the collection, each of the document will have an empty `id` field, `id: \"\"`\n        Id\n        Email string `json:\"email\" bson:\"email\"`\n        ...\n    }\n\n    // This works\n    User2 struct {\n        ID bson.ObjectId `json:\"id\" bson:\"_id\"`\n        Email string `json:\"email\" bson:\"email\"`\n    }\n)\n</code></pre>\n\n<p>I might not have fully understood the concept of anonymous structs yet. In the example above, when querying all users from a collection, the <code>id</code> field is going to be an empty string <code>\"\"</code>. However, if I directly define the ID field in the <code>User</code> struct, the <code>id</code> shows up fine. Is this not what anonymous structs are for? Basically extending struct so you won't have to type them again and again?</p>\n\n<p>More example:</p>\n\n<pre><code>type SoftDelete struct {\n    CreatedAt time.Time `json:\"created_at\" bson:\"created_at\"`\n    UpdatedAt time.Time `json:\"updated_at\" bson:\"updated_at\"`\n    DeletedAt time.Time `json:\"deleted_at\" bson:\"deleted_at\"`\n}\n\ntype UserModel struct {\n    SoftDelete\n}\n\ntype BlogPost struct {\n    SoftDelete\n}\n</code></pre>\n"}, {"tags": ["csv", "go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1485787921, "post_id": 41938068, "comment_id": 71057837, "body": "You can&#39;t read or write individual files concurrently, and when the data processing is going to be so much faster than the IO there&#39;s little benefit in making the reading of one file concurrent with writing of another. If the files are huge it may be worth it, but get a working example first to understand the basics."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1485794936, "post_id": 41938068, "comment_id": 71062495, "body": "This may be better suited for <a href=\"http://codereview.stackexchange.com/\">codereview.stackexchange.com</a>."}, {"owner": {"reputation": 73, "user_id": 6341231, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kn5hq.png?s=128&g=1", "display_name": "Daniel Tan", "link": "https://stackoverflow.com/users/6341231/daniel-tan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485854447, "post_id": 41938068, "comment_id": 71086592, "body": "@JimB Ah, i did not know reading/writing files could not be done concurrently. If I fleshed out my randomizing of columns as a separate method e.g. func RandomizeColumns([] string), could I split my Reader object into 2 streams and apply RandomizeColumns() on both concurrently?   I.e. can I split a csv.Reader() object into 2?"}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485962195, "post_id": 41938068, "comment_id": 71144149, "body": "@JimB Wrong. You can read a file in a goroutine while you write to another file in another goroutine. Will it make your program faster? It depends."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 0, "creation_date": 1485962366, "post_id": 41938068, "comment_id": 71144270, "body": "@dolmen: I meant that concurrent readers will not help, and often hurt sequential io. People often think &quot;I can read this faster if I have more readers&quot;, which isn&#39;t the case. Yes, you can even have multiple readers at different offsets, which may help in specific cases, but the OP obviously needs to start at the basics here."}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6341231, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kn5hq.png?s=128&g=1", "display_name": "Daniel Tan", "link": "https://stackoverflow.com/users/6341231/daniel-tan"}, "edited": false, "score": 0, "creation_date": 1485854316, "post_id": 41943576, "comment_id": 71086515, "body": "Thanks for the improvement! I consider your response an adequate answer to my question. I&#39;m a little disappointed that this use case has no need for concurrency, but I&#39;ll go look for another exercise to practice that."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1485803177, "creation_date": 1485803177, "answer_id": 41943576, "question_id": 41938068, "link": "https://stackoverflow.com/questions/41938068/using-golang-to-read-csv-reorder-columns-then-write-result-to-a-new-csv-with-co/41943576#41943576", "title": "Using Golang to read csv, reorder columns then write result to a new csv with Concurrency", "body": "<p>Your code is OK. There are no much case for concurrency. But you can at least reduce memory consumption reordering on the fly. Just use <code>Read()</code> instead of <code>ReadAll()</code> to avoid allocating slice for hole input file.</p>\n\n<pre><code>for line, err := reader.Read(); err == nil; line, err = reader.Read(){\n    if err = writer.Write([]string{line[col_index[0]], line[col_index[1]], line[col_index[2]]}); err != nil {\n            fmt.Println(\"Error:\", err)\n            break\n    }\n    writer.Flush()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 73, "user_id": 6341231, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kn5hq.png?s=128&g=1", "display_name": "Daniel Tan", "link": "https://stackoverflow.com/users/6341231/daniel-tan"}, "edited": false, "score": 0, "creation_date": 1486106012, "post_id": 41983253, "comment_id": 71211720, "body": "Thank you for taking the time to review my code + explain a possible solution involving concurrency."}], "tags": [], "owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "is_accepted": false, "score": 0, "last_activity_date": 1485962218, "creation_date": 1485962218, "answer_id": 41983253, "question_id": 41938068, "link": "https://stackoverflow.com/questions/41938068/using-golang-to-read-csv-reorder-columns-then-write-result-to-a-new-csv-with-co/41983253#41983253", "title": "Using Golang to read csv, reorder columns then write result to a new csv with Concurrency", "body": "<p>Move the <code>col_index</code> initialisation outside the write loop:</p>\n\n<pre><code>if len(lines) &gt; 0 {\n    //randomize column index based on the number of columns recorded in the 1st line\n    col_index := rand.Perm(len(lines[0]))\n    newLine := make([]string, len(col_index))\n\n    for _, line :=range lines[1:] {\n        for from, to := range col_index {\n            newLine[to] = line[from]\n        }\n        writer.Write(newLine)\n        writer.Flush()\n    }\n}\n</code></pre>\n\n<p>To use concurrency, you must not use <code>reader.ReadAll</code>. Instead make a goroutine that calls <code>reader.Read</code> and write the output on a channel that would replace the <code>lines</code> array. The main goroutine would read the channel   and do the shuffle and the write.</p>\n"}], "owner": {"reputation": 73, "user_id": 6341231, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/kn5hq.png?s=128&g=1", "display_name": "Daniel Tan", "link": "https://stackoverflow.com/users/6341231/daniel-tan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4060, "favorite_count": 0, "accepted_answer_id": 41943576, "answer_count": 2, "score": 1, "last_activity_date": 1485962218, "creation_date": 1485785750, "question_id": 41938068, "link": "https://stackoverflow.com/questions/41938068/using-golang-to-read-csv-reorder-columns-then-write-result-to-a-new-csv-with-co", "title": "Using Golang to read csv, reorder columns then write result to a new csv with Concurrency", "body": "<p>Here's my starting point. </p>\n\n<p>It is a Golang script to read in a csv with 3 columns, re-order the columns and write the result to a new csv file.</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n   \"encoding/csv\"\n   \"io\"\n   \"os\"\n   \"math/rand\"\n   \"time\"\n)\n\nfunc main(){\n  start_time := time.Now()\n\n  // Loading csv file\n  rFile, err := os.Open(\"data/small.csv\") //3 columns\n  if err != nil {\n    fmt.Println(\"Error:\", err)\n    return\n   }\n  defer rFile.Close()\n\n  // Creating csv reader\n  reader := csv.NewReader(rFile)\n\n  lines, err := reader.ReadAll()\n  if err == io.EOF {\n      fmt.Println(\"Error:\", err)\n      return\n  }\n\n  // Creating csv writer\n  wFile, err := os.Create(\"data/result.csv\")\n  if err != nil {\n      fmt.Println(\"Error:\",err)\n      return\n  }\n  defer wFile.Close()\n  writer := csv.NewWriter(wFile)\n\n  // Read data, randomize columns and write new lines to results.csv\n  rand.Seed(int64(time.Now().Nanosecond()))\n  var col_index []int\n  for i,line :=range lines{\n      if i == 0 {\n        //randomize column index based on the number of columns recorded in the 1st line\n        col_index = rand.Perm(len(line))\n    }\n    writer.Write([]string{line[col_index[0]], line[col_index[1]], line[col_index[2]]}) //3 columns\n    writer.Flush()\n}\n\n//print report\nfmt.Println(\"No. of lines: \",len(lines))\nfmt.Println(\"Time taken: \", time.Since(start_time))\n\n}\n</code></pre>\n\n<p><strong>Question:</strong></p>\n\n<ol>\n<li><p>Is my code idiomatic for Golang?</p></li>\n<li><p>How can I add concurrency to this code?</p></li>\n</ol>\n"}, {"tags": ["go", "web-applications", "server"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1485783401, "post_id": 41937022, "comment_id": 71054840, "body": "If you want multiple apps on port 80 then a proper webserver fronting your applications is a good way to go.  Nginx or Apache should handle that easily (my preference being Nginx)"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5314932, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/397fb67078242d9b410ea7d1528270fc?s=128&d=identicon&r=PG&f=1", "display_name": "agileone", "link": "https://stackoverflow.com/users/5314932/agileone"}, "is_accepted": false, "score": 1, "last_activity_date": 1485784123, "creation_date": 1485784123, "answer_id": 41937491, "question_id": 41937022, "link": "https://stackoverflow.com/questions/41937022/how-to-run-multiple-golang-apps-on-a-dedicated-server/41937491#41937491", "title": "How to run multiple Golang apps on a dedicated server?", "body": "<p>You might want to look a Traefik (<a href=\"https://traefik.io/\" rel=\"nofollow noreferrer\">https://traefik.io/</a>), a go based web proxy</p>\n"}, {"comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1485786401, "post_id": 41937498, "comment_id": 71056828, "body": "Moreover, with this setup Go programs can be set to listen on a <a href=\"http://nginx.org/en/docs/http/ngx_http_proxy_module.html#proxy_pass\" rel=\"nofollow noreferrer\">Unix-domain socket</a>; passing data between UD-sockets is super fast as it merely amounts to copying data between memory buffers (as opposed to letting it through the full TCP stack)."}], "tags": [], "owner": {"reputation": 426, "user_id": 1769115, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/72857f57e422bec26d0afbfbaacd24c7?s=128&d=identicon&r=PG", "display_name": "Zach Kauffman", "link": "https://stackoverflow.com/users/1769115/zach-kauffman"}, "is_accepted": false, "score": 3, "last_activity_date": 1485784138, "creation_date": 1485784138, "answer_id": 41937498, "question_id": 41937022, "link": "https://stackoverflow.com/questions/41937022/how-to-run-multiple-golang-apps-on-a-dedicated-server/41937498#41937498", "title": "How to run multiple Golang apps on a dedicated server?", "body": "<p>If you need multiple apps to serve HTTP requests, you should definitely consider using Nginx as a <a href=\"https://www.nginx.com/resources/admin-guide/reverse-proxy/\" rel=\"nofollow noreferrer\">reverse proxy</a>. You can forward all requests on a given route, say /api to one service and /ui to a second service, provided they are bound to different ports.</p>\n"}, {"tags": [], "owner": {"reputation": 936, "user_id": 1267758, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1e8e69107d92e6fdccfa30eb533efaa?s=128&d=identicon&r=PG", "display_name": "Andrew Leap", "link": "https://stackoverflow.com/users/1267758/andrew-leap"}, "is_accepted": true, "score": 3, "last_activity_date": 1485784230, "creation_date": 1485784230, "answer_id": 41937528, "question_id": 41937022, "link": "https://stackoverflow.com/questions/41937022/how-to-run-multiple-golang-apps-on-a-dedicated-server/41937528#41937528", "title": "How to run multiple Golang apps on a dedicated server?", "body": "<p>I'd highly recommend going with Caddy.  You can set up you server with all the apps on different ports (esp. higher ports i.e. 1024 and up, so they don't need to be root), and then use <code>proxy</code> directives to forward traffic to your apps and such.  As a bonus, you also then get free Let's Encrypt certificate support!</p>\n\n<p><a href=\"https://caddyserver.com/docs/proxy\" rel=\"nofollow noreferrer\">https://caddyserver.com/docs/proxy</a> for more on the <code>proxy</code> directive</p>\n"}], "owner": {"reputation": 377, "user_id": 6723763, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/1r3OV.gif?s=128&g=1", "display_name": "Rtsne42", "link": "https://stackoverflow.com/users/6723763/rtsne42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1923, "favorite_count": 0, "closed_date": 1485790523, "accepted_answer_id": 41937528, "answer_count": 3, "score": 2, "last_activity_date": 1487171082, "creation_date": 1485782650, "last_edit_date": 1487171082, "question_id": 41937022, "link": "https://stackoverflow.com/questions/41937022/how-to-run-multiple-golang-apps-on-a-dedicated-server", "closed_reason": "Needs more focus", "title": "How to run multiple Golang apps on a dedicated server?", "body": "<p>I'm a Go newbie and I'm stuck trying to figure out how to deploy my apps on a dedicated server.</p>\n\n<p>When I worked with PHP I used the standard setup:</p>\n\n<p><img src=\"https://i.stack.imgur.com/f7Bmi.png\" alt=\"Apache and PHP diagram\"></p>\n\n<p>But I'm confused as to how I'm supposed to deploy my Go apps.</p>\n\n<p>I know I can run a single app on port <code>:80</code> but how do I run multiple apps?</p>\n\n<p>Is this the general idea:</p>\n\n<p><img src=\"https://i.stack.imgur.com/a44di.png\" alt=\"Multiple apps diagram\"></p>\n\n<p>Or should I be using something like this:</p>\n\n<p><img src=\"https://i.stack.imgur.com/JAepG.png\" alt=\"Nginx diagram\"></p>\n\n<p>Can someone clarify the way most Go developers deploy their apps? \nThanks!</p>\n"}, {"tags": ["rest", "api", "go"], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "edited": false, "score": 1, "creation_date": 1485870942, "post_id": 41950403, "comment_id": 71097403, "body": "Thanks for answering, I&#39;ll try it next and keep you in touch"}, {"owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "edited": false, "score": 0, "creation_date": 1485879103, "post_id": 41950403, "comment_id": 71103378, "body": "I agree that I need ACL but I don&#39;t think your github repositories could satisfy my case sorry if you have something else it could be nice"}], "tags": [], "owner": {"reputation": 1528, "user_id": 6509830, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a2iUCqNxm8g/AAAAAAAAAAI/AAAAAAAAADk/L30vHNHz62Q/photo.jpg?sz=128", "display_name": "Sourabh Bhagat", "link": "https://stackoverflow.com/users/6509830/sourabh-bhagat"}, "is_accepted": true, "score": 6, "last_activity_date": 1485841207, "creation_date": 1485841207, "answer_id": 41950403, "question_id": 41936919, "link": "https://stackoverflow.com/questions/41936919/roles-and-permissions-in-go-rest-api/41950403#41950403", "title": "Roles and permissions in Go REST Api", "body": "<p>If I am not wrong, what you are asking is for access control list (ACL) <a href=\"https://en.wikipedia.org/wiki/Access_control_list\" rel=\"noreferrer\">https://en.wikipedia.org/wiki/Access_control_list</a></p>\n\n<p>You will need to separate controllers for each type of permission and have a module that checks the session variable set when the user logs in with the type of permission allowed for that particular controller.</p>\n\n<p>After the login check is completed, you can carry out an authorization check whether the user can access the resource and action, the controller can be tied to a single resource (but this behavior can be overridden) and the controller action can be mapped to a resource action.</p>\n\n<p>For Go, you can get a lot of ACL samples:</p>\n\n<p>[1] <a href=\"https://github.com/hectane/go-acl\" rel=\"noreferrer\">https://github.com/hectane/go-acl</a></p>\n\n<p>[2] <a href=\"https://github.com/mikespook/gorbac\" rel=\"noreferrer\">https://github.com/mikespook/gorbac</a></p>\n"}], "owner": {"reputation": 559, "user_id": 6843968, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/837570a6eefe9402a0ea7df116184025?s=128&d=identicon&r=PG&f=1", "display_name": "MounirOnGithub", "link": "https://stackoverflow.com/users/6843968/mounirongithub"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5891, "favorite_count": 2, "accepted_answer_id": 41950403, "answer_count": 1, "score": 5, "last_activity_date": 1485841207, "creation_date": 1485782300, "question_id": 41936919, "link": "https://stackoverflow.com/questions/41936919/roles-and-permissions-in-go-rest-api", "title": "Roles and permissions in Go REST Api", "body": "<p>I'm developing an REST API in go, it's implementing jwt following this schema : <a href=\"https://i.stack.imgur.com/JPFi1.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/JPFi1.png\" alt=\"Jwt schema\"></a></p>\n\n<p>I've a middleware that verify tokens and my problem is that I want another one to add roles and permissions on some path in my API </p>\n\n<p>Could you guys give some tips pls ? My project is on github as you can see all the code : <a href=\"https://github.com/MounirOnGithub/go-rest-service\" rel=\"noreferrer\">repository</a></p>\n\n<p>Thanks </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1485770878, "post_id": 41933194, "comment_id": 71046740, "body": "See also <a href=\"http://stackoverflow.com/questions/33947545/go-log-thread-id-in-gorilla-handler\" title=\"go log thread id in gorilla handler\">stackoverflow.com/questions/33947545/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 2, "last_activity_date": 1485771669, "last_edit_date": 1485771669, "creation_date": 1485771153, "answer_id": 41933332, "question_id": 41933194, "link": "https://stackoverflow.com/questions/41933194/how-can-i-identify-threads-or-similar-in-log/41933332#41933332", "title": "How can I identify threads or similar in log?", "body": "<p>There is no equivalent of thread id in GoLang for go routines.</p>\n\n<p>What you may do is create a <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">context</a> and attach a unique id (request id preferably) to it.Let all the functions accept a context aswell. Let the logger library take the context and print the unique id. By using context in this way you can share even for info for the log</p>\n"}, {"tags": [], "owner": {"reputation": 1157, "user_id": 5154802, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZqLky3QxN2E/AAAAAAAAAAI/AAAAAAAAAEE/MyYiHfmqVe0/photo.jpg?sz=128", "display_name": "shivendra pratap singh", "link": "https://stackoverflow.com/users/5154802/shivendra-pratap-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1485771222, "creation_date": 1485771222, "answer_id": 41933350, "question_id": 41933194, "link": "https://stackoverflow.com/questions/41933194/how-can-i-identify-threads-or-similar-in-log/41933350#41933350", "title": "How can I identify threads or similar in log?", "body": "<p>I personally prefer log4j in go <a href=\"https://code.google.com/archive/p/log4go/\" rel=\"nofollow noreferrer\">Log4J in Go</a>.</p>\n\n<p>It's quite easy to use and also it has all the facilities such as file rotation on the basis of time and size. Also, you can store complete error stack which contains the file name and line number.</p>\n"}], "owner": {"reputation": 23, "user_id": 7488949, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9720750bb2e8c636021112c3d4b74cd7?s=128&d=identicon&r=PG&f=1", "display_name": "maxwell", "link": "https://stackoverflow.com/users/7488949/maxwell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2741, "favorite_count": 1, "accepted_answer_id": 41933332, "answer_count": 2, "score": 1, "last_activity_date": 1553671917, "creation_date": 1485770721, "last_edit_date": 1553671917, "question_id": 41933194, "link": "https://stackoverflow.com/questions/41933194/how-can-i-identify-threads-or-similar-in-log", "title": "How can I identify threads or similar in log?", "body": "<p>I am developing in Go language, echo framework.</p>\n\n<p>I am designing a logger and I want to log the equivalent of\u00a0thread ID to the log, but I do not know a good method.</p>\n\n<p>For example, if login processing is performed at the same time with multiple accesses, it succeeds on one side and fails on one side\nIt can not be determined by looking at the log which failed.</p>\n\n<p>After examining, in Go language goroutine's id exists, but I should not get it,\nOriginally it was said that goroutine was not the same in the same thread.</p>\n\n<p>How can I identify threads?\nOr is there a package to put them in the log?</p>\n\n<p>I'm sorry if I used the wrong expression as English is not my mother tongue.\nThanks.</p>\n"}, {"tags": ["go", "permissions"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1485771063, "last_edit_date": 1485771063, "creation_date": 1485768931, "answer_id": 41932625, "question_id": 41932480, "link": "https://stackoverflow.com/questions/41932480/file-permission-mask-in-go/41932625#41932625", "title": "File permission mask in Go", "body": "<p>Once you have the file mode (with <a href=\"https://golang.org/pkg/os/#FileInfo\" rel=\"nofollow noreferrer\"><code>FileInfo.Mode()</code></a>), use the <a href=\"https://golang.org/pkg/os/#FileMode.Perm\" rel=\"nofollow noreferrer\"><code>FileMode.Perm()</code></a> method. This returns a value of type <a href=\"https://golang.org/pkg/os/#FileMode\" rel=\"nofollow noreferrer\"><code>os.FileMode</code></a> which has <code>uint32</code> as its underlying type.</p>\n\n<p>The format you're seeking (e.g. <code>0777</code>) is in base 8. You can use e.g. <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow noreferrer\"><code>fmt.Printf()</code></a> with the verb <code>%o</code> to print a number in octal format (base 8). Use a width <code>4</code> to make it 4 digits, and a flag <code>0</code> to make it padded with <code>0</code>'s. So the format string for printing file permissions: <code>\"%04o\"</code>.</p>\n\n<p>So print it like this:</p>\n\n<pre><code>files, err := ioutil.ReadDir(\".\")\n// Handle err\n\nfor _, file := range files {\n    fmt.Printf(\"%s %04o %s\\n\", file.Mode(), file.Mode().Perm(), file.Name())\n}\n</code></pre>\n\n<p>Example output:</p>\n\n<pre><code>-rw-rw-r-- 0664 play.go\ndrwxrwxr-x 0775 subplay\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user5349891"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1024, "favorite_count": 1, "accepted_answer_id": 41932625, "answer_count": 1, "score": 2, "last_activity_date": 1485771063, "creation_date": 1485768443, "last_edit_date": 1495541348, "question_id": 41932480, "link": "https://stackoverflow.com/questions/41932480/file-permission-mask-in-go", "title": "File permission mask in Go", "body": "<p>I was recently playing with file modes and permissions in Go and stumbled upon the output when getting it.</p>\n\n<p>The following code:</p>\n\n<pre><code>for _, file := range files {\n    fmt.Println(file.Mode()) \n}  \n</code></pre>\n\n<p>produces output:</p>\n\n<pre><code>drwx------\nLrwxr-xr-x\ndrwxr--r--\ndrwx------\ndrwx------\nprw-r--r--\nSrw-rw-rw-\nSrw-rw-rw-\n-rw-r--r--\n</code></pre>\n\n<p>My question is how do I get permissions in numbers like 0777, etc.</p>\n\n<p>Is there a similar way like in python provided in this answer: <a href=\"https://stackoverflow.com/questions/5337070/how-can-i-get-a-files-permission-mask\">How can I get a file&#39;s permission mask?</a>?</p>\n"}, {"tags": ["html", "json", "templates", "go", "escaping"], "answers": [{"comments": [{"owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "edited": false, "score": 0, "creation_date": 1485763627, "post_id": 41931210, "comment_id": 71042804, "body": "that worked thanks!"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 17, "last_activity_date": 1485763250, "creation_date": 1485763250, "answer_id": 41931210, "question_id": 41931082, "link": "https://stackoverflow.com/questions/41931082/inserting-html-to-golang-template/41931210#41931210", "title": "Inserting HTML to golang template", "body": "<p>You should pass the variable as a <code>template.HTML</code> and not as a <code>string</code>:</p>\n\n<pre><code>tpl := template.Must(template.New(\"main\").Parse(`{{define \"T\"}}{{.Html}}{{.String}}{{end}}`))\ntplVars := map[string]interface{} {\n    \"Html\": template.HTML(\"&lt;p&gt;Paragraph&lt;/p&gt;\"),\n    \"String\": \"&lt;p&gt;Paragraph&lt;/p&gt;\",\n}\ntpl.ExecuteTemplate(os.Stdout, \"T\", tplVars)\n\n//OUTPUT: &lt;p&gt;Paragraph&lt;/p&gt;&amp;lt;p&amp;gt;Paragraph&amp;lt;/p&amp;gt;\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/QKKpQJ7gIs\" rel=\"noreferrer\">https://play.golang.org/p/QKKpQJ7gIs</a></p>\n\n<p>As you can see, the variable we passed as a <code>template.HTML</code> is not escaped, but the one passed as a <code>string</code>is.</p>\n"}], "owner": {"reputation": 4924, "user_id": 3049865, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98dc179f82c2efee71cc49006397cfc5?s=128&d=identicon&r=PG&f=1", "display_name": "Alexander Kleinhans", "link": "https://stackoverflow.com/users/3049865/alexander-kleinhans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4123, "favorite_count": 1, "closed_date": 1561145198, "accepted_answer_id": 41931210, "answer_count": 1, "score": 4, "last_activity_date": 1485763250, "creation_date": 1485762575, "question_id": 41931082, "link": "https://stackoverflow.com/questions/41931082/inserting-html-to-golang-template", "closed_reason": "Duplicate", "title": "Inserting HTML to golang template", "body": "<p>I have a template in golang where I have a string that looks something like this:</p>\n\n<pre><code>&lt;some_html&gt; {{ .SomeOtherHTML }} &lt;/some_html&gt;\n</code></pre>\n\n<p>I'm expecting an output to be something like this:</p>\n\n<pre><code>&lt;some_html&gt; &lt;the_other_html/&gt; &lt;/some_html&gt;\n</code></pre>\n\n<p>But instead I'm seeing something like this:</p>\n\n<pre><code>&lt;some_html&gt; &amp;lt;the_other_html/&amp;lt; &lt;/some_html&gt;\n</code></pre>\n\n<p>I'm also trying to insert some JSON but golang is escaping characters and adding things like <code>\"</code> in places they shouldn't be. </p>\n\n<p>How do I insert into an HTML template in golang without this happening?</p>\n"}, {"tags": ["database", "go", "marshalling", "aerospike", "nosql"], "answers": [{"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485782363, "post_id": 41936870, "comment_id": 71054122, "body": "This is very specific to aerospike.Hiw they Marshall object"}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 1, "last_activity_date": 1485783036, "last_edit_date": 1485783036, "creation_date": 1485782133, "answer_id": 41936870, "question_id": 41931030, "link": "https://stackoverflow.com/questions/41931030/embedded-structs-in-aerospike-go-library-unexpected-behaviour/41936870#41936870", "title": "Embedded structs in aerospike-go library unexpected behaviour", "body": "<p>Struct embedding <strong>embeds methods and doesn't reflect attributes</strong>. Attributes of inner type are accessible thorough outer type but don't exist among attributes of outer type. So defining attribute of type <code>Table</code> you literally define attribute of type <code>Table</code> not reflect all attributes of type <code>Table</code> to type <code>Account</code>.</p>\n\n<p>Try to print your <code>Account</code> struct - <a href=\"https://play.golang.org/p/jWdGp9Q9D7\" rel=\"nofollow noreferrer\">playground</a>.</p>\n"}], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501921129, "creation_date": 1485762354, "last_edit_date": 1506103282, "question_id": 41931030, "link": "https://stackoverflow.com/questions/41931030/embedded-structs-in-aerospike-go-library-unexpected-behaviour", "title": "Embedded structs in aerospike-go library unexpected behaviour", "body": "<p><strong>Aerospike Go client</strong></p>\n\n<h2>Problem</h2>\n\n<p>Need to add set of common fields to all the sets ,ie CreatedAt,UpdtedAt,DeletedAt etc. For the same I have created a struct and embed that with all the set structs. I need the Fields of the common structure saved in the set as fields of the given record</p>\n\n<h2>Sample Code</h2>\n\n<pre><code>type Table struct {\n   CreatedAt time.Time\n   UpdatedAt time.Time\n   DeletedAt time.Time\n}\n\n\ntype Account struct {\n   Table\n   Name string\n   Status bool\n   .....\n}\n</code></pre>\n\n<p>For the above mentioned struct <code>Account</code>.I expect the record stored with bin names </p>\n\n<pre><code>CreatedAt,UpdatedAt,DeletedAt,Name,Status.....\n</code></pre>\n\n<p>But when the records are stored  bin names are </p>\n\n<pre><code>Table,Name,Status...\n</code></pre>\n\n<p>Where <code>Table</code> would be a map with key values</p>\n\n<p>Is it possible to achieve the expected behaviour ? if so how?</p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1485789607, "post_id": 41930482, "comment_id": 71059000, "body": "See <a href=\"https://godoc.org/net/http/httptest#Server\" rel=\"nofollow noreferrer\">godoc.org/net/http/httptest#Server</a>"}], "answers": [{"tags": [], "owner": {"reputation": 6204, "user_id": 396119, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b9d0b74d8e51d461235893edd4ab5785?s=128&d=identicon&r=PG", "display_name": "goenning", "link": "https://stackoverflow.com/users/396119/goenning"}, "is_accepted": false, "score": 0, "last_activity_date": 1485978266, "last_edit_date": 1485978266, "creation_date": 1485867989, "answer_id": 41958400, "question_id": 41930482, "link": "https://stackoverflow.com/questions/41930482/how-to-mock-while-sending-http-request-to-api/41958400#41958400", "title": "How to mock while sending http request to API", "body": "<p>I don't think there is single response for this question, but I'll share my approach on how I'm currently doing Dependency Injection on Go with go-gin (but should be the nearly the same with any other router).</p>\n\n<p>From a business point of view, I have a struct that wraps all access to my services which are responsible for business rules/processing.</p>\n\n<pre><code>// WchyContext is an application-wide context\ntype WchyContext struct {\n    Health   services.HealthCheckService\n    Tenant   services.TenantService\n    ... whatever\n}\n</code></pre>\n\n<p>My services are then just interfaces.</p>\n\n<pre><code>// HealthCheckService is a simple general purpose health check service\ntype HealthCheckService interface {\n    IsDatabaseOnline() bool\n}\n</code></pre>\n\n<p>Which have mulitple implementations, like <code>MockedHealthCheck</code>, <code>PostgresHealthCheck</code>, <code>PostgresTenantService</code> and so on.</p>\n\n<p>My router than depends on a WchyContext, which the code looks like this:</p>\n\n<pre><code>func GetMainEngine(ctx context.WchyContext) *gin.Engine {\n    router := gin.New()\n    router.Use(gin.Logger())\n    router.GET(\"/status\", Status(ctx))\n    router.GET(\"/tenants/:domain\", TenantByDomain(ctx))\n    return router\n}`\n</code></pre>\n\n<p><code>Status</code> and <code>TenantByDomain</code> act like a handler-factory, all it does is create a new handler based on given context, like this:</p>\n\n<pre><code>type statusHandler struct {\n    ctx context.WchyContext\n}\n\n// Status creates a new Status HTTP handler\nfunc Status(ctx context.WchyContext) gin.HandlerFunc {\n    return statusHandler{ctx: ctx}.get()\n}\n\nfunc (h statusHandler) get() gin.HandlerFunc {\n    return func(c *gin.Context) {\n        c.JSON(200, gin.H{\n            \"healthy\": gin.H{\n                \"database\": h.ctx.Health.IsDatabaseOnline(),\n            },\n            \"now\":     time.Now().Format(\"2006.01.02.150405\"),\n        })\n    }\n}\n</code></pre>\n\n<p>As you can see, my health check handler doesn't care about concrete implementation of my services, I just use it whatever is in the <code>ctx.</code></p>\n\n<p>The last part depends on current execution environment. During automated tests I create a new <code>WchyContext</code> using mocked/stubbed services and send it to GetMainEngine, like this:</p>\n\n<pre><code>ctx := context.WchyContext{\n    Health: &amp;services.InMemoryHealthCheckService{Status: false},\n    Tenant: &amp;services.InMemoryTenantService{Tenants: []*models.Tenant{\n        &amp;models.Tenant{ID: 1, Name: \"Orange Inc.\", Domain: \"orange\"},\n        &amp;models.Tenant{ID: 2, Name: \"The Triathlon Shop\", Domain: \"trishop\"},\n    }}\n}\nrouter := handlers.GetMainEngine(ctx)\n\nrequest, _ := http.NewRequest(method, url, nil)\nresponse := httptest.NewRecorder()\nrouter.ServeHTTP(response, request)\n... check if response matches what you expect from your handler\n</code></pre>\n\n<p>And when you setup it to really listen to a HTTP port, the wiring up looks like this: </p>\n\n<pre><code>var ctx context.WchyContext\nvar db *sql.DB\n\nfunc init() {\n    db, _ = sql.Open(\"postgres\", os.Getenv(\"DATABASE_URL\"))\n\n    ctx = context.WchyContext{\n        Health: &amp;services.PostgresHealthCheckService{DB: db},\n        Tenant: &amp;services.PostgresTenantService{DB: db}\n    }\n}\n\nfunc main() {\n    handlers.GetMainEngine(ctx).Run(\":\" + util.GetEnvOrDefault(\"PORT\", \"3000\"))\n}\n</code></pre>\n\n<p>There are a few things that I don't like about this, I'll probably refactor/improve it later, but it has been working well so far.</p>\n\n<p>If you want to see full code reference, I'm working on this project here <a href=\"https://github.com/WeCanHearYou/wchy\" rel=\"nofollow noreferrer\">https://github.com/WeCanHearYou/wchy</a></p>\n\n<p>Hope it can help you somehow.</p>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1055, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485978266, "creation_date": 1485759677, "last_edit_date": 1495541349, "question_id": 41930482, "link": "https://stackoverflow.com/questions/41930482/how-to-mock-while-sending-http-request-to-api", "title": "How to mock while sending http request to API", "body": "<p>I have implemented a ReST API in Go using go-gin and I am trying to test a handler function which looks like the following</p>\n\n<pre><code>func editNameHandler(c *gin.Context) {\n        // make a ReST call to another server\n        callToAnotherServer()\n        c.Status(200)\n}\n</code></pre>\n\n<p>I want to to mock <code>callToAnotherServer</code> method so that my test case doesn't call the 3rd party server at all.</p>\n\n<p>My test case looks like</p>\n\n<pre><code> func TestSeriveIdStatusRestorePatch(t *testing.T) {\n\n    // Request body\n    send := strings.NewReader(`{\"name\":\"Robert\"}` \n\n    // this function sends an HTTP request to the API which ultimately calls editNameHandler\n    // Ignore the variables.The variables are retrieved in code this is to simplify question\n    ValidTokenTestPatch(API_VERSION+\"/accounts/\"+TestAccountUUID+\"/students/\"+TestStudentId, t, send, http.StatusOK)        \n}\n</code></pre>\n\n<p>I went through <a href=\"https://stackoverflow.com/questions/19167970/mock-functions-in-go?rq=1\">Mock functions in Go</a> which  mentions how we can pass a function to mock. I am wondering how we can pass a function while sending http request? How can I mock function in such case. What is the best practice?</p>\n"}, {"tags": ["mongodb", "go", "struct", "slice", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1485770483, "creation_date": 1485770483, "answer_id": 41933122, "question_id": 41930292, "link": "https://stackoverflow.com/questions/41930292/nested-documents-in-model-struct/41933122#41933122", "title": "Nested documents in model struct", "body": "<p>I would use 2 separate fields, one for the slice of IDs, and one for the slice of lazily loaded objects.</p>\n\n<p>Omit the lazily loaded object slice from saving. It could look like this:</p>\n\n<pre><code>type UserModel struct {\n     // ...\n     OrderIDs []bson.ObjectId `json:\"orderIDs\" bson:\"orderIDs\"`\n     Orders   []OrderModel    `json:\"orders\" bson:\"-\"`\n     // ...\n}\n</code></pre>\n\n<p>Note that I intentionally did not exclude <code>Orders</code> from JSON serialization, as it is (may) be useful in JSON representation.</p>\n"}], "owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 41933122, "answer_count": 1, "score": 2, "last_activity_date": 1485795512, "creation_date": 1485758598, "last_edit_date": 1485795512, "question_id": 41930292, "link": "https://stackoverflow.com/questions/41930292/nested-documents-in-model-struct", "title": "Nested documents in model struct", "body": "<p>Say I have a <code>UserModel</code> like so:</p>\n\n<pre><code>type (\n    OrderModel struct {\n         ID   bson.ObjectId `json:\"id\" bson:\"_id\"`\n         ...\n    }\n\n    UserModel struct {\n         ...\n         // What do I store here? Is this an array of strings? An array of bson.ObjectID? Or an Array of OrderModel?\n         Orders  []string        `json:\"orders\" bson:\"orders\"`\n         Orders  []bson.ObjectId `json:\"orders\" bson:\"orders\"`\n         Orders  []OrderModel    `json:\"orders\" bson:\"orders\"`\n         ...\n    }\n)\n\nfunc (user *UserModel) PopulateOrders() {\n    orders := []OrderModel{}\n\n    // Query orders and assign to variable orders to then be assigned the the user Object\n    // {magic query here}\n\n    user.Orders = orders\n}\n</code></pre>\n\n<p>In MongoDB, an array of <code>ObjectID</code>s would be stored to reference the <code>OrderModel</code> documents. Later on, I have a function that will populate the <code>Order</code> documents like described above: <code>PopulateOrders</code>.</p>\n\n<p>What is the best way for the case above?</p>\n"}, {"tags": ["go", "methods", "types"], "comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485732494, "post_id": 41926900, "comment_id": 71034891, "body": "With this error, How do I know, what methods to be defined for an allowed type?"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 1, "creation_date": 1485732562, "post_id": 41926900, "comment_id": 71034911, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/41922181/go-why-implicit-non-pointer-methods-not-satisfy-interface\">GO - Why implicit non-pointer methods not satisfy interface?</a>"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485738982, "post_id": 41926900, "comment_id": 71036220, "body": "@dev.bmax how do u think it is duplicate? If this query got answer Ed then please share it"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 1, "creation_date": 1485761444, "post_id": 41926900, "comment_id": 71041939, "body": "The three threads, that you have started, are all the same. You take one language feature, that just doesn&#39;t make sense to you, and you try to find inconsistency in the language methodology. But, the community proves you wrong each time. And finally, you don&#39;t accept the answers, that are well supported by documentation and examples, simply because they don&#39;t match your intuition."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485761621, "post_id": 41926900, "comment_id": 71042007, "body": "@dev.bmax after seeing your answers, I felt that this is supposed to be my first question. Am not here to accept your answers, instead to learn."}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485765708, "post_id": 41926900, "comment_id": 71043718, "body": "I don&#39;t care, who&#39;s answer will be accepted. The reason, this thread is marked as a duplicate, is because you are causing people to refrase the same concept over and over again."}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485766160, "post_id": 41926900, "comment_id": 71043949, "body": "As other people have already made it clear: the compile time error, that you are getting, means that you are not allowed to confuse the machine, by supplying multiple functions, that are all accessable, using the same statement according to the language rules. If you feel, that the rules are not fair, than SO is not the place to file complains."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485790874, "post_id": 41926900, "comment_id": 71059877, "body": "@dev.bmax rule is given at the very first line of query. Am trying to follow that rule."}], "answers": [{"comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485731149, "post_id": 41926962, "comment_id": 71034529, "body": "function <code>foo()</code> has same signature. In Method <code>(Cat)foo()</code> &amp; <code>(*Cat)foo()</code>, first parameter is receiver type parameter, which makes different signature. So, how signatures are same? compiler does not complain that function(<code>foo</code>) has same signature"}, {"owner": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485731377, "post_id": 41926962, "comment_id": 71034583, "body": "@overexchange If you have <code>var c Cat</code> and call <code>c.foo()</code> how do you disambiguate which method is to be called?"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 115745, "user_id": 119527, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/lTjBL.png?s=128&g=1", "display_name": "Jonathon Reinhart", "link": "https://stackoverflow.com/users/119527/jonathon-reinhart"}, "edited": false, "score": 0, "creation_date": 1485732090, "post_id": 41926962, "comment_id": 71034773, "body": "@JonathonReinhart <b>1)</b> Are you asking, if GO compiler allows both methods, then, on saying, <code>var c Cat;c.foo()</code>, which method to be called? the receiver type <code>(c Cat)</code> is suppose to disambiguate.  <b>2)</b> When I say<code>func (c*Cat)foo(){..}</code> am defining method <b>for</b> receiver type(<code>*Cat</code>) but not for receiver type(<code>Cat</code>) and <i>vice versa</i> <b>3)</b> With this error, Why should I know, which one method I need to define <code>func (c *Cat)foo(){..}</code> or <code>func (c Cat)foo(){..}</code> because method foo has different signature, with first parameter as one with  named type and thesecond as pointer to named type"}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": false, "score": 4, "last_activity_date": 1485731754, "last_edit_date": 1485731754, "creation_date": 1485731035, "answer_id": 41926962, "question_id": 41926900, "link": "https://stackoverflow.com/questions/41926900/go-method-redeclared-error/41926962#41926962", "title": "GO - method redeclared error", "body": "<p>In Go, receivers are a kind of syntactic sugar. The actual, runtime signature of function <code>(c Cat) foo()</code> is <code>foo(c Cat)</code>. The receiver is moved to a first parameer.</p>\n\n<p>Go does not support name overloading. There can be only one function of with name <code>foo</code> in a package.</p>\n\n<p>Having said the statements above, you see that there would be two functions named <code>foo</code> with different signatures. This language does not support it.</p>\n\n<p>You cannot do that in Go. The rule of thumb is to write a method for a pointer receiver and Go will use it whenever you have a pointer or value.</p>\n\n<p>If you still need two variants, you need name the methods differently.</p>\n"}, {"tags": [], "owner": {"reputation": 5, "user_id": 7118338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c4abafcf449b09ceb303d02bb5106c6?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Coates", "link": "https://stackoverflow.com/users/7118338/colin-coates"}, "is_accepted": false, "score": -2, "last_activity_date": 1485767193, "creation_date": 1485767193, "answer_id": 41932112, "question_id": 41926900, "link": "https://stackoverflow.com/questions/41926900/go-method-redeclared-error/41932112#41932112", "title": "GO - method redeclared error", "body": "<p>For example, you can model some feline behavior like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Growler interface{\n    Growl() bool\n}\n\ntype Cat struct{\n    Name string\n    Age int\n} \n\n// *Cat is good for both objects and \"object references\" (pointers to objects)\nfunc (c *Cat) Speak() bool{\n    fmt.Println(\"Meow!\")\n    return true\n}\n\nfunc (c *Cat) Growl() bool{\n    fmt.Println(\"Grrr!\")\n    return true\n}\n\n\nfunc main() {\n    var felix Cat // is not a pointer\n    felix.Speak() // works :-)\n    felix.Growl() // works :-)\n\n    var ginger *Cat = new(Cat) \n    ginger.Speak() // works :-)\n    ginger.Growl() // works :-)\n}\n</code></pre>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1803, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1485793649, "creation_date": 1485730556, "last_edit_date": 1485793649, "question_id": 41926900, "link": "https://stackoverflow.com/questions/41926900/go-method-redeclared-error", "title": "GO - method redeclared error", "body": "<p>Rule is, methods can be defined only on named type and pointer to named type.</p>\n\n<hr>\n\n<p>For the below <a href=\"https://play.golang.org/p/wjB28Ijsuh\" rel=\"nofollow noreferrer\">code</a>,</p>\n\n<pre><code>package main\n\ntype Cat struct {\n}\n\nfunc (c Cat) foo() {\n   // do stuff_\n}\n\nfunc (c *Cat) foo() {\n  // do stuff_\n}\n\nfunc main() {\n\n}\n</code></pre>\n\n<hr>\n\n<p>compiler gives error:</p>\n\n<pre><code>main.go:10: method redeclared: Cat.foo\n    method(Cat) func()\n    method(*Cat) func()\n</code></pre>\n\n<hr>\n\n<p>Above code defines,</p>\n\n<p>method <code>foo()</code> for named type(<code>Cat</code>) and </p>\n\n<p>method <code>foo()</code> for pointer to named type(<code>*Cat</code>).</p>\n\n<p><strong>Question:</strong></p>\n\n<p>For GO compiler, Why methods defined for different type is considered\nsame?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1485716218, "post_id": 41923825, "comment_id": 71029847, "body": "You can&#39;t. Go does not have generics :)"}, {"owner": {"reputation": 43, "user_id": 7387046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aabafda9fa4c3ecc248a6738613a8802?s=128&d=identicon&r=PG&f=1", "display_name": "Kojan", "link": "https://stackoverflow.com/users/7387046/kojan"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1485716549, "post_id": 41923825, "comment_id": 71029968, "body": "@Nadh I must rewrite it? can you answer another <a href=\"http://stackoverflow.com/questions/41887596/golang-map-sort\">question</a>? I don&#39;t use array for order, because element, that before need element, can be delete earlie. And i worry, that it delete another element"}], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1485755509, "last_edit_date": 1485755509, "creation_date": 1485714278, "answer_id": 41924383, "question_id": 41923825, "link": "https://stackoverflow.com/questions/41923825/how-use-universal-struct/41924383#41924383", "title": "How use universal struct", "body": "<p>You can define function which would work with all types that implements <code>Prev()</code> and <code>Next()</code> methods. For example something like this</p>\n\n<pre><code>type List interface{\n    Next() List\n    Prev() List\n    First() List\n    Last() List\n    Value() interface{}\n    SetNext(List)\n    SetPrev(List)\n}\nfunc Del(l List, elem_to_delete interface{}){\n    for e:=l.First(); e != l.Last(); e = l.Next()\n        if l.Value() == elem_to_delete{\n            l.Prev().SetNext(l.Next())\n            l.Next().SetPrev(l.Prev())\n            break\n        }\n    }\n}\n//and implement those methods for your types\ntype Post struct { //for example\n    P string\n    O int\n    Prev, Next *Post\n}\nfunc (p Post) Next() List{\n    return p.Next\n}\n...\n//and then you can call Del() with any of this types\nDel(post, 5)\n</code></pre>\n\n<p>Also Go have list data structure defined in <a href=\"https://tip.golang.org/pkg/container/list/\" rel=\"nofollow noreferrer\">stdlib</a> which you can use.</p>\n"}, {"tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 1, "last_activity_date": 1485758345, "last_edit_date": 1485758345, "creation_date": 1485723823, "answer_id": 41925941, "question_id": 41923825, "link": "https://stackoverflow.com/questions/41923825/how-use-universal-struct/41925941#41925941", "title": "How use universal struct", "body": "<p>If to define <code>Next</code> and <code>Prev</code> operations as methods:</p>\n\n<pre><code>type Act struct {\n    I int\n    Prev, Next *Act\n}\n\nfunc (a *Act) GetNext(){\n    return a.Next\n}    \n</code></pre>\n\n<p>you could have an interface:</p>\n\n<pre><code>type PrevNext interface {\n    GetNext() *Act\n    GetPrev() *Act\n    // ... and all other required actions\n}\n</code></pre>\n\n<p>So you could define <code>Del()</code> not as method but as generic function which expects object of <code>PrevNext</code> type with all required operations defined as methods.</p>\n\n<pre><code>func Del(m *PrevNext, s int) {\n    if _, ok := m.Act[s]; ok {\n        if m.GetLast() == m.GetFirst() {\n            m.SetLast(nil)\n            m.SetFirst(nil)\n            delete(m.Act, s)\n            return\n        } \n    // ....\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7387046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aabafda9fa4c3ecc248a6738613a8802?s=128&d=identicon&r=PG&f=1", "display_name": "Kojan", "link": "https://stackoverflow.com/users/7387046/kojan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 1, "answer_count": 2, "score": 1, "last_activity_date": 1485758345, "creation_date": 1485710931, "last_edit_date": 1485757948, "question_id": 41923825, "link": "https://stackoverflow.com/questions/41923825/how-use-universal-struct", "title": "How use universal struct", "body": "<p>I have struct for order list. I want order <code>map</code> and find it way. But i don't want create this for all types, that i have. Maybe I need another code? Or how I can rewrite it for universal, that I can use it with all types, that have <code>Prev</code> and <code>Next</code>.</p>\n\n<pre><code>type Post struct { //for example\n    P string\n    O int\n    Prev, Next *Post\n}\ntype Act struct {\n    I int\n    Prev, Next *Act\n}    \n\ntype Map struct {\n    Act         map[int]*Act\n    First, Last *Act\n}\n\nfunc (m *Map) New(a *Act) int {\n    Ida++\n    f := Ida\n    a.Id = Ida\n    m.Act[Ida] = a\n    if m.First == nil {\n        m.First = a\n    } else {\n        m.Last.Next = a\n        a.Prev = m.Last\n    }\n    m.Last = a\n    return f\n}\n\nfunc (m *Map) Del(s int) {\n    if _, ok := m.Act[s]; ok {\n        if m.Last == m.First {\n            m.Last = nil\n            m.First = nil\n            delete(m.Act, s)\n            return\n        }\n        if m.Last == m.Act[s] {\n            m.Last = m.Act[s].Prev\n            m.Act[s].Prev.Next = nil\n            delete(m.Act, s)\n            return\n        }\n        if m.First == m.Act[s] {\n            m.First = m.Act[s].Next\n            m.Act[s].Next.Prev = nil\n            delete(m.Act, s)\n            return\n        }\n        m.Act[s].Prev.Next = m.Act[s].Next\n        m.Act[s].Next.Prev = m.Act[s].Prev\n        delete(m.Act, s)\n        return\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "methods", "interface", "structural-typing"], "comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 3575, "user_id": 6081445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005fd098b0fa87b368915187a4e588fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Wallis", "link": "https://stackoverflow.com/users/6081445/kevin-wallis"}, "edited": false, "score": 0, "creation_date": 1485701586, "post_id": 41922181, "comment_id": 71024953, "body": "@KevinWallis I had to make an another change. so Edited on top of yours. You can take control now"}, {"owner": {"reputation": 3575, "user_id": 6081445, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/005fd098b0fa87b368915187a4e588fd?s=128&d=identicon&r=PG&f=1", "display_name": "Kevin Wallis", "link": "https://stackoverflow.com/users/6081445/kevin-wallis"}, "edited": false, "score": 0, "creation_date": 1485701714, "post_id": 41922181, "comment_id": 71025002, "body": "its fine now :)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1485703732, "post_id": 41922181, "comment_id": 71025586, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/40823315/go-x-does-not-implement-y-method-has-a-pointer-receiver/40824044#40824044\">Go, X does not implement Y (... method has a pointer receiver)</a>. Also related: <a href=\"http://stackoverflow.com/questions/41015114/types-of-go-struct-methods-that-satisfy-an-interface/41016448#41016448\">Types of Go struct methods that satisfy an interface</a>."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485704065, "post_id": 41922181, "comment_id": 71025692, "body": "@icza In that query assignment fails due to not implementing interface, here <code>x = p</code> does not fail"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 2, "creation_date": 1485706717, "post_id": 41922181, "comment_id": 71026553, "body": "You are confusing people with imaginary implicit method definitions."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1485714216, "post_id": 41922181, "comment_id": 71029143, "body": "@overexchange Yes, and if you read the linked answer, you&#39;ll know why."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1485715796, "post_id": 41922181, "comment_id": 71029720, "body": "Also also related: <a href=\"http://stackoverflow.com/questions/33587227/golang-method-sets-pointer-vs-value-receiver/33591156\">Golang Method Sets (Pointer vs Value Receiver)</a>."}], "answers": [{"comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485705643, "post_id": 41922551, "comment_id": 71026180, "body": "<code>c.bar()</code> works as shown in this <a href=\"https://play.golang.org/p/pF1KJ3Xtq8\" rel=\"nofollow noreferrer\">code</a>. So, how would you prove that The method set of the type(<code>Cat</code>) is <code>[foo()]</code>?"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485706261, "post_id": 41922551, "comment_id": 71026388, "body": "<code>c.bar()</code> works, because the compiler replaces this statement with <code>(&amp;c).bar()</code>. But, <code>c</code> cannot be assigned to the interface <code>x</code>, because for it&#39;s own type <code>Cat</code>, there is no such method as <code>bar()</code>."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485706360, "post_id": 41922551, "comment_id": 71026436, "body": "For non-pointer, <code>var c Cat</code>, how would you, invoke <code>(*c).bar()</code>?"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485706396, "post_id": 41922551, "comment_id": 71026448, "body": "It was a typo, fixed."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485707456, "post_id": 41922551, "comment_id": 71026828, "body": "As per the spec, What is the method set of type(<code>*Cat</code>) in this <a href=\"https://play.golang.org/p/81xh7jr0Ch\" rel=\"nofollow noreferrer\">code</a>? and why <code>p.bar()</code> failed? as per your point, Why <code>(*p).bar()</code> is not invoked in place of <code>p.bar()</code>?"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485708188, "post_id": 41922551, "comment_id": 71027109, "body": "p.bar() fails because p is nil. You didn&#39;t assign it a value."}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485709962, "post_id": 41922551, "comment_id": 71027713, "body": "p.foo() tries to dereference a pointer that has no value (in order to pass it to the method as a receiver) and fails. p.bar() passes the nil to the method successfully. But, if you would try to use the receiver inside of the method, you will fail. You are off the topic already, and are probably out of coffee too :)"}], "tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": true, "score": 5, "last_activity_date": 1485726441, "last_edit_date": 1485726441, "creation_date": 1485703681, "answer_id": 41922551, "question_id": 41922181, "link": "https://stackoverflow.com/questions/41922181/why-implicit-non-pointer-methods-not-satisfy-interface/41922551#41922551", "title": "Why implicit non-pointer methods not satisfy interface?", "body": "<p>Let's look into the language <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">specification</a>:</p>\n\n<blockquote>\n  <p>A type may have a <b>method set</b> associated with it. The method set\n  of an interface type is its interface. The method set of any other\n  type T consists of all methods declared with receiver type T. The\n  method set of the corresponding pointer type *T is the set of all\n  methods declared with receiver *T or T (that is, it <b>also contains\n  the method set</b> of T).</p>\n</blockquote>\n\n<p>In your example, the method set of the interface type <code>x</code> is <code>[foo(), bar()]</code>. The method set of the type <code>Cat</code> is <code>[foo()]</code>, and the method set of the type <code>*Cat</code> is <code>[foo()]</code> + <code>[bar()]</code> = <code>[foo(), bar()]</code>. </p>\n\n<p>This explains, why variable <code>p</code> satisfies the interface <code>x</code>, but variable <code>c</code> doesn't.</p>\n"}, {"comments": [{"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485705524, "post_id": 41922626, "comment_id": 71026143, "body": "@overexchange,  t is not implicit definition it is just the fact that pointer has access (actually it is access) to value but value has no access to pointer. Value receiver restricted by that."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485705964, "post_id": 41922626, "comment_id": 71026291, "body": "<b>1)</b> <i>also contains the method set of T</i>, mean, If receiver type(<code>*Cat</code>) has defined method (<code>bar()</code>) then compiler creates implicit definition of method <code>bar()</code> for receiver type(<code>Cat</code>), which I say in first section of query as well as in the problem line in the code(with comments). <b>2)</b> With you line  <code>x = &amp;c</code>, you are saying that, <code>&amp;c</code> is of type <code>*Cat</code> and <code>*Cat</code> type has satisfied interface, which I say also in the query, so it works"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485706045, "post_id": 41922626, "comment_id": 71026314, "body": "@overexchange, &quot;t&quot; is &quot;it&quot; which lost &quot;i&quot; =)"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485706120, "post_id": 41922626, "comment_id": 71026336, "body": "Please go thru this <a href=\"https://play.golang.org/p/pF1KJ3Xtq8\" rel=\"nofollow noreferrer\">code</a> and check(<code>c.bar()</code>) at line 24 and explain me, who defined method <code>bar()</code> for type(<code>Cat</code>)?"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 2, "creation_date": 1485716309, "post_id": 41922626, "comment_id": 71029882, "body": "@overexchange no one. There is no method <code>bar()</code> for type <code>Cat</code>. But because <code>c</code> is addressable, the compiler converts the call <code>c.bar()</code> to <code>(&amp;c).bar()</code> for your convenience. Likewise if <code>p</code> is a <code>*Cat</code>, the compiler converts <code>p.foo()</code> to <code>(*p).foo()</code> for you. There are no implicit <i>methods</i>, only implicit rewriting of <i>calls</i>."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 1, "last_activity_date": 1485724079, "last_edit_date": 1485724079, "creation_date": 1485704268, "answer_id": 41922626, "question_id": 41922181, "link": "https://stackoverflow.com/questions/41922181/why-implicit-non-pointer-methods-not-satisfy-interface/41922626#41922626", "title": "Why implicit non-pointer methods not satisfy interface?", "body": "<h3>Method set</h3>\n\n<p>Following the <a href=\"https://github.com/golang/go/wiki/MethodSets#the-spec\" rel=\"nofollow noreferrer\">spec</a>:</p>\n\n<blockquote>\n  <p>The method set of any other named type T consists of all methods with receiver type T. The method set of the corresponding pointer type *T is the set of all methods with receiver *T or T (that is, it also contains the method set of T).</p>\n</blockquote>\n\n<p>Method set definition sounds weird until you follow addressable and not addressable types concept.</p>\n\n<h3>Addressable and not addressable types</h3>\n\n<p>It is possible to call a pointer receiver method on a value if the value is  of addressable type.</p>\n\n<blockquote>\n  <p>As with selectors, a reference to a non-interface method with a value receiver using a pointer will automatically dereference that pointer: pt.Mv is equivalent to (*pt).Mv.</p>\n  \n  <p>As with method calls, a reference to a non-interface method with a pointer receiver using an addressable value will automatically take the address of that value: t.Mp is equivalent to (&amp;t).Mp.</p>\n</blockquote>\n\n<p>It is ok to call pointer receiver methods on values till you are dealing with addressable types (struct is addressable):</p>\n\n<pre><code>type Cat struct {}\n\nfunc (c *Cat) bar() string { return \"Mew\" }\n\nfunc main() {\n    var c Cat\n    c.bar()\n}\n</code></pre>\n\n<h3>Variables of interface type are not addressable</h3>\n\n<p>But not all Go types are addressable. Also <strong>variables referenced through interfaces are not addressable</strong>.</p>\n\n<p>It is impossible to call pointer receiver on values of not addressable types:</p>\n\n<pre><code>type X interface {\n    bar() string\n}\n\ntype Cat struct{}\n\nfunc (c *Cat) bar() string { return \"Mew\" }\n\n/* Note `cat` variable is not a `struct` type value but\n   it is type of `X` interface therefor it is not addressable. */\nfunc CatBar(cat X) { \n    fmt.Print(cat.bar())\n}\n\nfunc main() {\n    var c Cat\n    CatBar(c)\n}\n</code></pre>\n\n<p>So with the following error Go runtime prevents segment fault:</p>\n\n<blockquote>\n  <p>cannot use c (type Cat) as type X in assignment:\n      Cat does not implement X (bar method has pointer receiver)</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 3358, "user_id": 852385, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c0eac51aaa99541fb966854b5dcb131?s=128&d=identicon&r=PG", "display_name": "Helin Wang", "link": "https://stackoverflow.com/users/852385/helin-wang"}, "is_accepted": false, "score": 0, "last_activity_date": 1485704426, "creation_date": 1485704426, "answer_id": 41922665, "question_id": 41922181, "link": "https://stackoverflow.com/questions/41922181/why-implicit-non-pointer-methods-not-satisfy-interface/41922665#41922665", "title": "Why implicit non-pointer methods not satisfy interface?", "body": "<p>Add a little to dev.bmax's answer.</p>\n\n<pre><code>type Cat struct{\n}\n\nfunc (c Cat) foo(){\n  // do stuff_\n}\n\nfunc (c *Cat) bar(){\n  // do stuff_\n}\n</code></pre>\n\n<p>you can do</p>\n\n<pre><code>var c cat\nc.bar() // ok to call bar(), since c is a variable.\n</code></pre>\n\n<p>but not</p>\n\n<pre><code>cat{}.bar() // not ok to call bar(), c is not a variable.\n</code></pre>\n\n<p>It's legal to call a *T method on an argument of type T so long as the argument is a <em>variable</em>; the compiler implicitly takes its address. But this is mere syntactic sugar: a value of type T does not posses all methods that a *T pointer does, and as a result it might satisfy fewer interfaces.</p>\n\n<p>On the other hand, you can always call foo() with Cat or *Cat.</p>\n"}, {"comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485709396, "post_id": 41923499, "comment_id": 71027517, "body": "<code>felix.Speak()</code> and <code>felix.Growl()</code> works because as I said in Query, for explicit method definition(<code>Speak()</code> &amp; <code>Browl()</code>) for type(<code>*Cat</code>), GO compiler implicitly defines those two methods(<code>Speak()</code> &amp; <code>Browl()</code>) for type(<code>Cat</code>). Do you agree?"}, {"owner": {"reputation": 5, "user_id": 7118338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c4abafcf449b09ceb303d02bb5106c6?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Coates", "link": "https://stackoverflow.com/users/7118338/colin-coates"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485710392, "post_id": 41923499, "comment_id": 71027859, "body": "So far as I can see, all the rules are succinctly explained under &quot;Method Expressions&quot; and &quot;Method Values&quot; in the Go language specification. I was just trying to provide a quick example of how that works for felines! ;-)"}], "tags": [], "owner": {"reputation": 5, "user_id": 7118338, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c4abafcf449b09ceb303d02bb5106c6?s=128&d=identicon&r=PG&f=1", "display_name": "Colin Coates", "link": "https://stackoverflow.com/users/7118338/colin-coates"}, "is_accepted": false, "score": 0, "last_activity_date": 1485709173, "creation_date": 1485709173, "answer_id": 41923499, "question_id": 41922181, "link": "https://stackoverflow.com/questions/41922181/why-implicit-non-pointer-methods-not-satisfy-interface/41923499#41923499", "title": "Why implicit non-pointer methods not satisfy interface?", "body": "<p>How about this?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Growler interface{\n    Growl() bool\n}\n\ntype Cat struct{\n    Name string\n    Age int\n} \n\n// *Cat is good for both objects and \"references\" (pointers to objects)\nfunc (c *Cat) Speak() bool{\n    fmt.Println(\"Meow!\")\n        return true\n}\n\nfunc (c *Cat) Growl() bool{\n    fmt.Println(\"Grrr!\")\n    return true\n}\n\nfunc main() {\n    var felix Cat // is not a pointer\n    felix.Speak() // works :-)\n    felix.Growl() // works :-)\n\n    var ginger *Cat = new(Cat) \n    ginger.Speak() // works :-)\n    ginger.Growl() // works :-)\n}\n</code></pre>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 882, "favorite_count": 3, "accepted_answer_id": 41922551, "answer_count": 4, "score": 4, "last_activity_date": 1560166253, "creation_date": 1485701343, "last_edit_date": 1560166253, "question_id": 41922181, "link": "https://stackoverflow.com/questions/41922181/why-implicit-non-pointer-methods-not-satisfy-interface", "title": "Why implicit non-pointer methods not satisfy interface?", "body": "<blockquote>\n  <p>Assuming we have an understanding that,</p>\n  \n  <p>For explicit method definition for type <code>X</code>, GO compiler implicitly defines the same method for type <code>*X</code> and <em>vice versa</em>, if I declare,</p>\n\n<pre><code>func (c Cat) foo(){\n  //do stuff_\n} \n</code></pre>\n  \n  <p>and declare,</p>\n\n<pre><code>func (c *Cat) foo(){\n  // do stuff_\n}\n</code></pre>\n  \n  <p>then GO compiler gives error,</p>\n\n<pre><code>Compile error: method re-declared\n</code></pre>\n  \n  <p>which indicates that, pointer method is implicitly defined and <em>vice versa</em></p>\n</blockquote>\n\n<hr>\n\n<p>In the below code,</p>\n\n<pre><code>package main\n\ntype X interface{\n  foo();\n  bar();\n}\n\ntype Cat struct{\n\n}\n\nfunc (c Cat) foo(){\n  // do stuff_\n}\n\nfunc (c *Cat) bar(){\n  // do stuff_\n}\n\nfunc main() {\n  var c Cat\n  var p *Cat\n  var x X\n\n  x = p // OK; *Cat has explicit method bar() and implicit method foo()\n  x = c //compile error: Cat has explicit method foo() and implicit method bar()\n\n}\n</code></pre>\n\n<hr>\n\n<p>GO compiler gives error, </p>\n\n<pre><code>cannot use c (type Cat) as type X in assignment:\n    Cat does not implement X (bar method has pointer receiver)\n</code></pre>\n\n<p>at <code>x = c</code>, because, implicit pointer methods satisfy interfaces, but implicit non-pointer methods do not.</p>\n\n<p>Question:</p>\n\n<p>Why implicit non-pointer methods do not satisfy interfaces?</p>\n"}, {"tags": ["go", "google-bigquery"], "comments": [{"owner": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "edited": false, "score": 2, "creation_date": 1485700304, "post_id": 41921566, "comment_id": 71024568, "body": "The documentation states that  &quot;Put returns a PutMultiError if one or more rows failed to be uploaded. The PutMultiError contains a RowInsertionError for each failed row.&quot;  So to get more error information, you can type cast the error to a PutMultiError (ex: <code>multiError := err.(PutMultiError)</code>), iterate over it, then iterate over the MultiErrors, and print each error. Refer to the documentation for more information: <a href=\"https://godoc.org/cloud.google.com/go/bigquery#PutMultiError\" rel=\"nofollow noreferrer\">godoc.org/cloud.google.com/go/bigquery#PutMultiError</a>"}, {"owner": {"reputation": 241, "user_id": 4450908, "user_type": "registered", "profile_image": "https://graph.facebook.com/601433544/picture?type=large", "display_name": "O\u011fuz Y\u0131ld\u0131z", "link": "https://stackoverflow.com/users/4450908/o%c4%9fuz-y%c4%b1ld%c4%b1z"}, "reply_to_user": {"reputation": 497, "user_id": 2692215, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6d0b6dabfa2ba63adece2081af25989e?s=128&d=identicon&r=PG&f=1", "display_name": "1lann", "link": "https://stackoverflow.com/users/2692215/1lann"}, "edited": false, "score": 0, "creation_date": 1497933344, "post_id": 41921566, "comment_id": 76273147, "body": "Thanks @1lann ! But the information I see just says &quot;invalid&quot;.. Any ideas how I can get the more detailed reason?"}, {"owner": {"reputation": 381, "user_id": 5193766, "user_type": "registered", "accept_rate": 17, "profile_image": "https://lh5.googleusercontent.com/-ijH86FwAgd0/AAAAAAAAAAI/AAAAAAAAAXc/VxUFFDcM_38/photo.jpg?sz=128", "display_name": "Gaurav Sharma", "link": "https://stackoverflow.com/users/5193766/gaurav-sharma"}, "reply_to_user": {"reputation": 241, "user_id": 4450908, "user_type": "registered", "profile_image": "https://graph.facebook.com/601433544/picture?type=large", "display_name": "O\u011fuz Y\u0131ld\u0131z", "link": "https://stackoverflow.com/users/4450908/o%c4%9fuz-y%c4%b1ld%c4%b1z"}, "edited": false, "score": 1, "creation_date": 1554564317, "post_id": 41921566, "comment_id": 97802434, "body": "@O\u011fuzY\u0131ld\u0131z I&#39;m facing same Invalid error, did you get the fix for it."}], "answers": [{"tags": [], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "is_accepted": false, "score": 6, "last_activity_date": 1539929454, "last_edit_date": 1539929454, "creation_date": 1535091594, "answer_id": 51998570, "question_id": 41921566, "link": "https://stackoverflow.com/questions/41921566/bigquery-row-insertions-failed-with-go-library/51998570#51998570", "title": "BigQuery row insertions failed with Go library", "body": "<p>Using <code>bigquery.PutMultiError</code> I get the following properties where <code>Message</code> profiles the failure reason.</p>\n\n<ul>\n<li><code>Location</code>: column</li>\n<li><code>Message</code>: what failed</li>\n<li><code>Reason</code>: this can simply be <code>invalid</code></li>\n</ul>\n\n<p>Here is an example:</p>\n\n<pre><code>{Location: \"speed\"; Message: \"Cannot convert value to integer (bad value):foobar\"; Reason: \"invalid\"}\n</code></pre>\n\n<p>Here's an example using <code>PutMultiError</code> as mentioned by 1lann. Of note, <code>Put</code> can return a <code>*errors.errorString</code> or <code>bigquery.PutMultiError</code> so it's useful to check which you have.</p>\n\n<pre><code>err := u.Put(ctx, inserts)\nif err != nil {\n    if multiError, ok := err.(bigquery.PutMultiError); ok {\n        for _, err1 := range multiError {\n            for _, err2 := range err1.Errors {\n                fmt.Println(err2)\n            }\n        }\n    } else {\n        fmt.Println(err)\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 2352219, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/da2b444677efbdce8fc063168dd78d12?s=128&d=identicon&r=PG", "display_name": "Oguz Yildiz", "link": "https://stackoverflow.com/users/2352219/oguz-yildiz"}, "is_accepted": false, "score": 0, "last_activity_date": 1601482189, "creation_date": 1601482189, "answer_id": 64141553, "question_id": 41921566, "link": "https://stackoverflow.com/questions/41921566/bigquery-row-insertions-failed-with-go-library/64141553#64141553", "title": "BigQuery row insertions failed with Go library", "body": "<p>One possible fix is to make sure the fields of your struct are exported (e.g. start with uppercase letters).</p>\n<p>It's just a really bad error message, this is just one of the reasons you could be getting that error</p>\n"}], "owner": {"reputation": 113, "user_id": 6463620, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/940bda5f2d6503480fe8aa96526d59dc?s=128&d=identicon&r=PG&f=1", "display_name": "Javier Roda", "link": "https://stackoverflow.com/users/6463620/javier-roda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1772, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1601482189, "creation_date": 1485697341, "question_id": 41921566, "link": "https://stackoverflow.com/questions/41921566/bigquery-row-insertions-failed-with-go-library", "title": "BigQuery row insertions failed with Go library", "body": "<p>I'm getting this error \"X row insertions failed\" where X is a number of rows when I try to insert in bigquery.</p>\n\n<p>I use this library \"cloud.google.com/go/bigquery\" in Golang</p>\n\n<p>I attach the code here:</p>\n\n<pre><code>    u := table.Uploader()\n\n    var inserts []*bigquery.StructSaver\n    for _, insert := range value {\n        aux := bigquery.StructSaver{Struct: insert, Schema: schema}\n        inserts = append(inserts, &amp;aux)\n    }\n\n    err := u.Put(ctx, inserts)\n    if err != nil {\n        fmt.Printf(\"%v\\n\", err)\n    }\n</code></pre>\n\n<p>This doesn't happen  in every try and I don't know what can produce it.\nAnyone got the same error?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1485698024, "post_id": 41921158, "comment_id": 71023954, "body": "r *http.Request is a pointer to a struct. It is not guarded with any sync mechanism. But you use it concurrently go parseVideo(r). It may lead to unpredictable behaviour to my mind."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485698429, "post_id": 41921158, "comment_id": 71024045, "body": "You can&#39;t pass the request to a goroutine then end the request. If you want to continue writing to the response, do it shnchronously in the handler."}, {"owner": {"reputation": 57, "user_id": 3565093, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Llcy1.jpg?s=128&g=1", "display_name": "ma3x", "link": "https://stackoverflow.com/users/3565093/ma3x"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485716653, "post_id": 41921158, "comment_id": 71030013, "body": "I have the same problem with sequential code too. @JimB"}, {"owner": {"reputation": 57, "user_id": 3565093, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Llcy1.jpg?s=128&g=1", "display_name": "ma3x", "link": "https://stackoverflow.com/users/3565093/ma3x"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1485716661, "post_id": 41921158, "comment_id": 71030021, "body": "I have the same problem with sequential code too. @Uvelichitel"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485718895, "post_id": 41921158, "comment_id": 71030706, "body": "You need to provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485803590, "post_id": 41921158, "comment_id": 71067502, "body": "Does you server log any errors, panics, etc? I don&#39;t think you&#39;ve provided enough context here to see what could be happening, since a connection reset isn&#39;t a normal response, and we can&#39;t see what happens at &quot;/admin/logs&quot;. Note that <code>ParseVideo</code> may be in any state, including not run at all yet when you get redirected. Your <code>ParseVideo</code> function also has return paths where the files aren&#39;t closed, and never closes the chunk files, which will eventually run out of file descriptors."}, {"owner": {"reputation": 57, "user_id": 3565093, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Llcy1.jpg?s=128&g=1", "display_name": "ma3x", "link": "https://stackoverflow.com/users/3565093/ma3x"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485806784, "post_id": 41921158, "comment_id": 71069138, "body": "@JimB Question updated. The server is running with <code>log.Fatal(srv.ListenAndServe())</code>. Anywhere a function returns an error the code either panics or logs the error. I&#39;d updated <code>ParseVideo</code> function and fixed the addressed issues. Thanks!"}], "owner": {"reputation": 57, "user_id": 3565093, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/Llcy1.jpg?s=128&g=1", "display_name": "ma3x", "link": "https://stackoverflow.com/users/3565093/ma3x"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 191, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1485806594, "creation_date": 1485694751, "last_edit_date": 1485806594, "question_id": 41921158, "link": "https://stackoverflow.com/questions/41921158/getting-connection-reset-error-with-http-redirect-and-multipart-request", "title": "Getting connection reset error with http.Redirect and multipart request", "body": "<p>Here is my handler:</p>\n\n<pre><code>func VideosStoreHandler(w http.ResponseWriter, r *http.Request) {\n    r.ParseMultipartForm(32 &lt;&lt; 20)\n\n    clientFile, header, err := r.FormFile(\"file\")\n    if err != nil {\n        logs.Create(logs.LevelError, \"[VideosStoreHandler] Unable to parse uploaded file: \"+err.Error())\n        return\n    }\n    defer clientFile.Close()\n\n    tfn := fmt.Sprintf(\"%s%d%s\", config.TmpDir, time.Now().UnixNano(), filepath.Ext(header.Filename))\n    tmpFile, err := os.OpenFile(tfn, os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0666)\n    if err != nil {\n        logs.Create(logs.LevelError, \"[VideosStoreHandler] Unable to create temporary file: \"+err.Error())\n        return\n    }\n    defer tmpFile.Close()\n\n    io.Copy(tmpFile, clientFile)\n\n    msg := fmt.Sprintf(\"[VideosStoreHandler] Video %q uploaded with filename: %q.\", r.FormValue(\"name\"), header.Filename)\n    logs.Create(logs.LevelInfo, msg)\n\n    vid := videos.CreateVideo(r.FormValue(\"name\"), filepath.Ext(header.Filename))\n\n    go util.ParseVideo(vid, r.FormValue(\"name\"), tmpFile.Name())\n\n    http.Redirect(w, r, \"/admin/logs\", http.StatusTemporaryRedirect)\n}\n</code></pre>\n\n<p><code>ParseVideo</code> function:</p>\n\n<pre><code>func ParseVideo(vid int64, vname, fname string) {\n    defer os.Remove(fname)\n\n    file, err := os.Open(fname)\n    if err != nil {\n        logs.Create(logs.LevelError, \"[ParseVideo] Unable to open temporary file: \"+err.Error())\n        return\n    }\n    defer file.Close()\n\n    fstat, err := file.Stat()\n    if err != nil {\n        logs.Create(logs.LevelError, \"[ParseVideo] Unable to get file info: \"+err.Error())\n        return\n    }\n\n    fileSize := fstat.Size()\n    totalPartsNum := uint64(math.Ceil(float64(fileSize) / float64(config.ChunkSize)))\n\n    prefix := fmt.Sprintf(\"%d\", time.Now().UnixNano())\n\n    time.Sleep(5 * time.Second) // NOTE: This is intentional, for testing.\n\n    for i := uint64(0); i &lt; totalPartsNum; i++ {\n        time.Sleep(5 * time.Second) // NOTE: This is intentional, for testing.\n\n        partSize := int(math.Min(config.ChunkSize, float64(fileSize-int64(i*config.ChunkSize))))\n        partBuffer := make([]byte, partSize)\n\n        file.Read(partBuffer)\n        encrypted, err := crypt.EncryptChunk(partBuffer)\n        if err != nil {\n            logs.Create(logs.LevelError, \"[ParseVideo] Failed to encrypt chunk file: \"+err.Error())\n            return\n        }\n\n        fileName := fmt.Sprintf(\"%s%s%d\", config.ChunksDir, prefix, i)\n        chunkFile, err := os.Create(fileName)\n        if err != nil {\n            logs.Create(logs.LevelError, \"[ParseVideo] Unable to create chunk file: \"+err.Error())\n            return\n        }\n        chunkFile.Close()\n\n        err = ioutil.WriteFile(fileName, encrypted, os.ModeAppend)\n        if err != nil {\n            logs.Create(logs.LevelError, \"[ParseVideo] Writing to chunk file failed: \"+err.Error())\n            return\n        }\n\n        videos.CreateChunk(vid, fileName)\n\n        msg := fmt.Sprintf(\"[ParseVideo] Chunk %d of %q stored in %q.\",\n            i, vname, fileName)\n        logs.Create(logs.LevelInfo, msg)\n    }\n\n    msg := fmt.Sprintf(\"[ParseVideo] %q processing finished without errors.\", vname)\n    logs.Create(logs.LevelSuccess, msg)\n}\n</code></pre>\n\n<p><code>LogsHandler</code> which serves <code>/admin/logs</code>:</p>\n\n<pre><code>func LogsHandler(w http.ResponseWriter, r *http.Request) {\n    data := struct {\n        Items []logs.Log\n    }{}\n\n    rows, err := logs.FetchAll()\n    if err != nil {\n        logs.Create(logs.LevelError, \"[LogsHandler] Failed to fetch logs: \"+err.Error())\n        return\n    }\n\n    for rows.Next() {\n        var item logs.Log\n\n        if err := rows.Scan(&amp;item.Level, &amp;item.Message, &amp;item.Timestamp); err != nil {\n            logs.Create(logs.LevelError, \"[LogsHandler] Failed to scan log items: \"+err.Error())\n            return\n        }\n\n        data.Items = append(data.Items, item)\n    }\n\n    if err := rows.Err(); err != nil {\n        logs.Create(logs.LevelError, \"[LogsHandler] SQL Error: \"+err.Error())\n        return\n    }\n\n    template.Render(\"admin/logs.html\", data, w)\n}\n</code></pre>\n\n<p><code>Render</code> function:</p>\n\n<pre><code>func Render(filePath string, data interface{}, w http.ResponseWriter) {\n    fp := path.Join(\"templates\", filePath)\n    tmpl, err := template.ParseFiles(fp, \"templates/layouts/master.html\")\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n\n    if err := tmpl.Execute(w, data); err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n}\n</code></pre>\n\n<p>I want to show parsing progress in log. Logging works fine, but http.Redirect isn't working (I use this method in other handlers which I need redirection, they work fine) and my browser displays this error:\n<a href=\"https://i.stack.imgur.com/MYop4.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/MYop4.png\" alt=\"enter image description here\"></a></p>\n\n<p>By inspecting response via chrome developer tools, there is no response in network tab. By manually browsing to <code>/admin/logs</code> it loads just fine!</p>\n\n<p>Where is the problem?</p>\n"}, {"tags": ["inheritance", "go", "facebook-messenger-bot"], "answers": [{"comments": [{"owner": {"reputation": 1166, "user_id": 55049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784247c4145b0d2cfc0827bb67256943?s=128&d=identicon&r=PG", "display_name": "perelin", "link": "https://stackoverflow.com/users/55049/perelin"}, "edited": false, "score": 0, "creation_date": 1485685671, "post_id": 41919775, "comment_id": 71020672, "body": "Thanks for the pointer. I tried that already but discovered that I don&#180;t have access to the necessary variables to fill the function parameters. I&#180;ll add that to my main question. Did the tour of go of course but that was some time ago ;) think I&#180;ll refresh. Actually I had a look into it yesterday to find a hint for my problem but couldn&#180;t make out anything fitting the case. The chapter about interfaces didn&#180;t seem to apply here."}, {"owner": {"reputation": 7869, "user_id": 243861, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8850d2f72f498e3987b3d8641ea065a?s=128&d=identicon&r=PG", "display_name": "Mykola Gurov", "link": "https://stackoverflow.com/users/243861/mykola-gurov"}, "reply_to_user": {"reputation": 1166, "user_id": 55049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784247c4145b0d2cfc0827bb67256943?s=128&d=identicon&r=PG", "display_name": "perelin", "link": "https://stackoverflow.com/users/55049/perelin"}, "edited": false, "score": 0, "creation_date": 1485693769, "post_id": 41919775, "comment_id": 71022779, "body": "the variables are supposed to be sent by the library to the callback. I&#39;ve expanded the example to make it clear."}, {"owner": {"reputation": 1166, "user_id": 55049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784247c4145b0d2cfc0827bb67256943?s=128&d=identicon&r=PG", "display_name": "perelin", "link": "https://stackoverflow.com/users/55049/perelin"}, "edited": false, "score": 0, "creation_date": 1485699830, "post_id": 41919775, "comment_id": 71024446, "body": "Got it. The only thing I had to add was to import the types from the library package. Thx!"}], "tags": [], "owner": {"reputation": 7869, "user_id": 243861, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c8850d2f72f498e3987b3d8641ea065a?s=128&d=identicon&r=PG", "display_name": "Mykola Gurov", "link": "https://stackoverflow.com/users/243861/mykola-gurov"}, "is_accepted": true, "score": 2, "last_activity_date": 1485693729, "last_edit_date": 1485693729, "creation_date": 1485685094, "answer_id": 41919775, "question_id": 41919644, "link": "https://stackoverflow.com/questions/41919644/how-to-extend-a-function-without-body-in-golang/41919775#41919775", "title": "How to extend a function without body in golang", "body": "<p>The fact that someone somewhere has declared a new type derived from <code>messengerbot.MessageReceivedHandler</code> doesn't and shouldn't have any effect on the bot library itself. </p>\n\n<p>What you need is to set the handler of the bot either at the construction point, by instantiating it yourself, or later by doing </p>\n\n<pre><code>bot.MessageReceived = func(bot *MessengerBot, evt Event, opts MessageOpts, msg ReceivedMessage) {\n  log.Println(\"works!\", msg)\n}\n</code></pre>\n\n<p>P.S. You might want to check the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">tour of go</a> if you haven't yet, as you seem to miss some basic concepts of working with go. </p>\n"}], "owner": {"reputation": 1166, "user_id": 55049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/784247c4145b0d2cfc0827bb67256943?s=128&d=identicon&r=PG", "display_name": "perelin", "link": "https://stackoverflow.com/users/55049/perelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 279, "favorite_count": 0, "accepted_answer_id": 41919775, "answer_count": 1, "score": 1, "last_activity_date": 1485700100, "creation_date": 1485684155, "last_edit_date": 1495541803, "question_id": 41919644, "link": "https://stackoverflow.com/questions/41919644/how-to-extend-a-function-without-body-in-golang", "title": "How to extend a function without body in golang", "body": "<p>I want to user the <a href=\"https://github.com/ippy04/messengerbot/\" rel=\"nofollow noreferrer\">ippy04/messengerbot</a> library to build a bot for the facebook messenger.</p>\n\n<p>For receiving a new message the library uses a construct I can\u00b4t wrap my head around. The following function type is defined (but without body) in the relevant <a href=\"https://github.com/ippy04/messengerbot/blob/master/webhook.go#L66\" rel=\"nofollow noreferrer\">library source file</a>:</p>\n\n<pre><code>type MessageReceivedHandler func(*MessengerBot, Event, MessageOpts, ReceivedMessage)\n</code></pre>\n\n<p>This type then <a href=\"https://github.com/ippy04/messengerbot/blob/master/messengerbot.go#L10\" rel=\"nofollow noreferrer\">gets attached</a> to the actual bot:</p>\n\n<pre><code>type MessengerBot struct {\n    MessageReceived  MessageReceivedHandler\n}\n</code></pre>\n\n<p>Later in the code <a href=\"https://github.com/ippy04/messengerbot/blob/master/webhook.go#L121-L123\" rel=\"nofollow noreferrer\">it gets called</a> like this:</p>\n\n<pre><code>if bot.MessageReceived != nil {\n  go bot.MessageReceived(bot, entry.Event, message.MessageOpts, *message.Message)\n}\n</code></pre>\n\n<p>Now it seems I need to extend <code>MessageReceivedHandler</code> with an actual body implementation in my own package. I tried a few thing.</p>\n\n<p>Following another <a href=\"https://stackoverflow.com/questions/28800672/how-to-add-new-methods-to-an-existing-type-in-go\">SO thread</a> I did this:  </p>\n\n<pre><code>import \"github.com/ippy04/messengerbot\"\ntype myMRH messengerbot.MessageReceivedHandler\nfunc (mr myMRH) HRM() {\n    log.Println(\"works!\")\n}\n</code></pre>\n\n<p>... but that code never gets called.</p>\n\n<p>Also I tried to extend <code>bot.MessageReceived</code> like this (I\u00b4m using GinGonic)</p>\n\n<pre><code>router.POST(\"/webhook\", func(c *gin.Context) {\n    bot := messengerbot.NewMessengerBot(os.Getenv(\"FB_PAGE_ACCESS_TOKEN\"), os.Getenv(\"FB_MESSENGER_VERIFY_TOKEN\"))\n    bot.Debug = true\n    bot.MessageReceived = func(*MessengerBot, Event, MessageOpts, ReceivedMessage) {\n        log.Println(\"works!\")\n    }\n    bot.Handler(c.Writer, c.Request)\n})\n</code></pre>\n\n<p>but then I have no idea where to get the necessary function variables from since they ar enot exposed by the library.</p>\n\n<p>Any idea on how to implement that <code>MessageReceivedHandler</code>?</p>\n\n<hr>\n\n<p>Based on the answer from @mykola here is the complete solution to my problem:</p>\n\n<pre><code>router.POST(\"/webhook\", func(c *gin.Context) {\n    bot := messengerbot.NewMessengerBot(os.Getenv(\"FB_PAGE_ACCESS_TOKEN\"), os.Getenv(\"FB_MESSENGER_VERIFY_TOKEN\"))\n    bot.Debug = true\n    bot.MessageReceived = func(bot *messengerbot.MessengerBot, evt messengerbot.Event, opts messengerbot.MessageOpts, msg messengerbot.ReceivedMessage) {\n        log.Println(msg.Message.Text)\n    }\n    bot.Handler(c.Writer, c.Request)\n})\n</code></pre>\n"}, {"tags": ["for-loop", "go"], "comments": [{"owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "edited": false, "score": 0, "creation_date": 1485682057, "post_id": 41919359, "comment_id": 71019774, "body": "The code is missing a closing brace <code>}</code> at the end. Adding it works as intended."}, {"owner": {"reputation": 179, "user_id": 6379615, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/e3596ede2acd56c0fe8151e003bb720d?s=128&d=identicon&r=PG&f=1", "display_name": "m_h", "link": "https://stackoverflow.com/users/6379615/m-h"}, "reply_to_user": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "edited": false, "score": 0, "creation_date": 1485682322, "post_id": 41919359, "comment_id": 71019834, "body": "OK , sorry, copied it wrong. But what about declaring varibles, when  should variables be declared and when shouldn&#39;t they be?"}], "answers": [{"tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": false, "score": 1, "last_activity_date": 1485682348, "creation_date": 1485682348, "answer_id": 41919424, "question_id": 41919359, "link": "https://stackoverflow.com/questions/41919359/variable-declared-and-not-used/41919424#41919424", "title": "variable declared and not used", "body": "<p>The reason, you have the 'not used error', is because the expression <code>a:=0</code> declares a new variable with the same name in the scope of the loop. If you already have the variable 'a' declared before the loop, change it to <code>for a=0; a&lt;4; a++</code> (without the colon).</p>\n"}, {"tags": [], "owner": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "is_accepted": false, "score": 3, "last_activity_date": 1485682943, "creation_date": 1485682943, "answer_id": 41919492, "question_id": 41919359, "link": "https://stackoverflow.com/questions/41919359/variable-declared-and-not-used/41919492#41919492", "title": "variable declared and not used", "body": "<p>You have two options available</p>\n\n<ol>\n<li><p>Declare the variable explicitly and then use</p>\n\n<pre><code>var a int\na = 0\n</code></pre></li>\n<li><p>Declare and assign in one statement without having to specify the type (it is inferred)</p>\n\n<pre><code>a:=0\n</code></pre></li>\n</ol>\n\n<p>Note the difference in <code>=</code> and <code>:=</code>. If you use <code>:=</code> twice, it counts as a redeclaration. In other words, <code>=</code> is for assignment only, whereas <code>:=</code> is for declaration and assignment in a single step.</p>\n"}], "owner": {"reputation": 179, "user_id": 6379615, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/e3596ede2acd56c0fe8151e003bb720d?s=128&d=identicon&r=PG&f=1", "display_name": "m_h", "link": "https://stackoverflow.com/users/6379615/m-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1302, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1526312781, "creation_date": 1485681830, "last_edit_date": 1526312781, "question_id": 41919359, "link": "https://stackoverflow.com/questions/41919359/variable-declared-and-not-used", "title": "variable declared and not used", "body": "<p>I am trying to learn Go, but when trying out a simple for loop, I found it difficult to get it working. This code does not compile if I define the variable a in the main function, it gives an error 'a declared but not used'. I don't understand when a variable must be declared and when it must not be. Thanks.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {   \n\n\n    for a:=0;a&lt;4;a++ {      \n        fmt.Printf(\"value of a is %d\\n\",a)\n}\n</code></pre>\n"}, {"tags": ["go", "interface", "structure"], "comments": [{"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 0, "creation_date": 1485962803, "post_id": 41919297, "comment_id": 71144601, "body": "If a function is missing and you try to call it, the compiler will raise the issue. If a function is missing and nobody calls it, why bother?"}], "answers": [{"tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": true, "score": 1, "last_activity_date": 1485682886, "creation_date": 1485682886, "answer_id": 41919486, "question_id": 41919297, "link": "https://stackoverflow.com/questions/41919297/can-i-restrict-packages-have-some-set-of-functions-in-golang/41919486#41919486", "title": "Can I restrict packages have some set of functions in Golang?", "body": "<p>You could \"register\" each package with a call</p>\n\n<pre><code>package server\n\ntype PageHandler {\n    url, name func() string\n}\n\nvar Handlers = []PageHandler\n\nfunc RegisterHandler(url func()string, name func()string) {\n    Handlers = append(Handlers, PageHandler{url, name})\n}\n\n...\n\npackage home_page\n\n...\n\nfunc init() {\n    server.RegisterHandler(GetUrl, GetPageName)\n}\n</code></pre>\n\n<p>The package won't compile unless <code>GetUrl</code> and <code>GetPageName</code> are provided and the function signature is correct.</p>\n"}], "owner": {"reputation": 42794, "user_id": 135829, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/zfWZK.jpg?s=128&g=1", "display_name": "Sergei Basharov", "link": "https://stackoverflow.com/users/135829/sergei-basharov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 0, "accepted_answer_id": 41919486, "answer_count": 1, "score": 0, "last_activity_date": 1485682886, "creation_date": 1485681420, "question_id": 41919297, "link": "https://stackoverflow.com/questions/41919297/can-i-restrict-packages-have-some-set-of-functions-in-golang", "title": "Can I restrict packages have some set of functions in Golang?", "body": "<p>I have packages, that are similar in functionality, as they are web request handlers.</p>\n\n<p>I have functions like this for Home page in each package:</p>\n\n<pre><code>package home_page_handler\n\n\nfunc GetUrl() string {\n    return \"/\"\n}\n\nfunc GetPageName() string {\n    return \"HomePage\"\n}\n</code></pre>\n\n<p>To structure the code better, I wonder if I can add a restriction, may be via interfaces to make each package of some \"class\" contain these functions? </p>\n\n<p>That way if I add one more handler, it will throw an error while compiling if a function is missing or has a wrong signature.</p>\n"}, {"tags": ["optimization", "go", "time", "system-calls"], "comments": [{"owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1485678171, "post_id": 41918897, "comment_id": 71018835, "body": "do you need, 51.992871217 part?"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "reply_to_user": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "edited": false, "score": 0, "creation_date": 1485678246, "post_id": 41918897, "comment_id": 71018857, "body": "Nope, since my input is in minutes +/- 59 secs is ok"}], "answers": [{"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485678544, "post_id": 41918962, "comment_id": 71018941, "body": "could you comment on vDSO part as well"}, {"owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485678630, "post_id": 41918962, "comment_id": 71018951, "body": "@Sarathsp, sorry, no idea about what vDSO is."}], "tags": [], "owner": {"reputation": 106150, "user_id": 213464, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/a7ba62044bc19143ea4a38cf490b67f2?s=128&d=identicon&r=PG", "display_name": "YOU", "link": "https://stackoverflow.com/users/213464/you"}, "is_accepted": true, "score": 1, "last_activity_date": 1485678300, "creation_date": 1485678300, "answer_id": 41918962, "question_id": 41918897, "link": "https://stackoverflow.com/questions/41918897/optimal-way-to-get-time-in-utc-given-todays-time-as-minutes-in-golang/41918962#41918962", "title": "Optimal way to get time in UTC given today&#39;s time as minutes in golang", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Print(MinutesToTime(780).UTC())\n}\n\nfunc MinutesToTime(m int64) time.Time {\n    return time.Unix(time.Now().Unix()/86400*86400+m*60, 0)\n}\n\n% go run test.go                                                                                                         \n2017-01-29 13:00:00 +0000 UTC% \n</code></pre>\n"}], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 860, "favorite_count": 0, "accepted_answer_id": 41918962, "answer_count": 1, "score": 1, "last_activity_date": 1485678300, "creation_date": 1485677705, "question_id": 41918897, "link": "https://stackoverflow.com/questions/41918897/optimal-way-to-get-time-in-utc-given-todays-time-as-minutes-in-golang", "title": "Optimal way to get time in UTC given today&#39;s time as minutes in golang", "body": "<p>I have  time of the same day in minutes (ie, hours * 60 + minutes) as input ,need to convert it into <code>time.Time</code> here is my attempt to do the same .</p>\n\n<p><strong>Example</strong></p>\n\n<pre><code>Input: 780\nOutput : 2017-01-29 13:00:51.992871217 +0000 UTC\n</code></pre>\n\n<p><strong>Code</strong></p>\n\n<pre><code>func MinutesToTime(minutes int) time.Time {\n          t := time.Now().UTC() //may be cached  \n          h, m, _ := t.Clock()\n          diff := minutes - (h*60 + m)\n          t = t.Add(time.Duration(diff) * time.Minute)\n          return t\n}\n</code></pre>\n\n<p><strong>Doubt</strong></p>\n\n<ol>\n<li>Is there any functions that <code>time</code> package exposes that might help\nme optimize this</li>\n<li>Should i be using gettimeofday() system call directly </li>\n<li>Would trying to implement vDSO be an overkill , vDSO implementation for only amd64 is found in <a href=\"https://github.com/golang/go/blob/964639cc338db650ccadeafb7424bc8ebb2c0f6c/src/runtime/vdso_linux_amd64.go\" rel=\"nofollow noreferrer\">go source code</a> </li>\n</ol>\n\n<p><strong>PS</strong>\nThe  59 sec err is acceptable as minute is my lowest granularity</p>\n"}, {"tags": ["pointers", "go", "methods", "structural-typing"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1485677781, "post_id": 41918750, "comment_id": 71018742, "body": "I expect that you get the type the method expects. But why didn&#39;t you try it, to see if the struct changes or not after you modify it in a pointer method?"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1485678074, "post_id": 41918750, "comment_id": 71018812, "body": "@ZanLynx I tried, my observation says, <b>1)</b> the implicit pointer method receives the pointed to value, but not pointer. <b>2)</b> the implicit pointer method receives the pointer to the value, but not the value. <i>This is bit confusing for me, on understanding, why it is happening in opposite way? Logically it should be as mentioned in the question 1 &amp; 2</i>"}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1485699694, "post_id": 41918750, "comment_id": 71024408, "body": "I consider below answer from @dev.bmax as partially incorrect. Rest is yours"}, {"owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "edited": false, "score": 0, "creation_date": 1485701583, "post_id": 41918750, "comment_id": 71024951, "body": "See my updated answer (reference included)."}], "answers": [{"comments": [{"owner": {"reputation": 40613, "user_id": 4099593, "user_type": "moderator", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/zweIW.png?s=128&g=1", "display_name": "Bhargav Rao", "link": "https://stackoverflow.com/users/4099593/bhargav-rao"}, "edited": false, "score": 0, "creation_date": 1485709452, "post_id": 41919538, "comment_id": 71027537, "body": "Comments are not for extended discussion; this conversation has been <a href=\"http://chat.stackoverflow.com/rooms/134311/discussion-on-answer-by-dev-bmax-go-how-does-an-implicit-method-work\">moved to chat</a>."}], "tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": false, "score": 5, "last_activity_date": 1485701245, "last_edit_date": 1485701245, "creation_date": 1485683289, "answer_id": 41919538, "question_id": 41918750, "link": "https://stackoverflow.com/questions/41918750/go-how-does-an-implicit-method-work/41919538#41919538", "title": "GO - How does an implicit method work?", "body": "<ol>\n<li><code>An explicit method definition for type X implicitly defines the same method for type *X and vice versa.</code></li>\n</ol>\n\n<p>This is not correct. Methods are not defined implicitly. The only thing that a compiler does for you is implicitly replacing <code>c.foo()</code> with <code>(*c).foo()</code> or <code>c.foo()</code> with <code>(&amp;c).foo()</code> for convenience. See the <a href=\"https://tour.golang.org/methods/6\" rel=\"nofollow noreferrer\">tour of Go</a></p>\n\n<ol start=\"2\">\n<li>The receiver of the method is either of type T or of type *T, based on your explicit declaration.</li>\n</ol>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1485701245, "creation_date": 1485676344, "last_edit_date": 1485699748, "question_id": 41918750, "link": "https://stackoverflow.com/questions/41918750/go-how-does-an-implicit-method-work", "title": "GO - How does an implicit method work?", "body": "<blockquote>\n  <p>In GO, I learnt that, </p>\n  \n  <p>1)</p>\n  \n  <p>Programmer can only define methods on named types(<code>X</code>) or pointer(<code>*X</code>) to named types</p>\n  \n  <p>2)</p>\n  \n  <p>An explicit method definition for type <code>X</code> implicitly defines the same method for type <code>*X</code> and <em>vice versa</em>, so, my understanding is, If I declare, </p>\n\n<pre><code>func (c Cat) foo(){\n  //do stuff_\n} \n</code></pre>\n  \n  <p>and declare,</p>\n\n<pre><code>func (c *Cat) foo(){\n  // do stuff_\n}\n</code></pre>\n  \n  <p>then GO compiler gives, </p>\n  \n  <p><code>Compile error: method re-declared</code> </p>\n  \n  <p>which indicates that, pointer method is implicitly defined and <em>vice versa</em></p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>With the given named type(<code>Cat</code>),</p>\n\n<pre><code>type Cat struct{\n  Name string\n  Age int\n  Children []Cat\n  Mother *Cat\n} \n</code></pre>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><strong>Scenario 1</strong></p>\n  \n  <p>Method(<code>foo</code>) defined on a named type(<code>Cat</code>), by programmer,</p>\n\n<pre><code>func (c Cat) foo(){\n   // do stuff....\n}\n</code></pre>\n  \n  <p>that implicitly defines method(<code>foo</code>) on pointer(<code>*Cat</code>) to named type, by GO compiler, that looks like,</p>\n\n<pre><code>func (c *Cat) foo(){\n   // do stuff....\n}\n</code></pre>\n  \n  <p>On creating variables of named type(<code>Cat</code>)</p>\n\n<pre><code>var c Cat\nvar p *Cat = &amp;c\n</code></pre>\n  \n  <p><code>c.foo()</code> has the method defined by programmer.</p>\n  \n  <p><strong>Question 1:</strong></p>\n  \n  <p>On invoking <code>p.foo()</code>, does implicit pointer method receive the pointer(<code>p</code>)?</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><strong>Scenario 2</strong></p>\n  \n  <p>Method(<code>foo</code>) defined on a pointer(<code>*Cat</code>) to named type, by the programmer,</p>\n\n<pre><code>func (c *Cat) foo(){\n   // do stuff....\n  }\n</code></pre>\n  \n  <p>that implicitly defines method(<code>foo</code>) on named type(<code>Cat</code>), by the GO compiler, that looks like,</p>\n\n<pre><code>func (c Cat) foo(){\n   // do stuff....\n  }\n</code></pre>\n  \n  <p>On creating variables of named type(<code>Cat</code>)</p>\n\n<pre><code>var c Cat\nvar p *Cat = &amp;c\n</code></pre>\n  \n  <p><code>p.foo()</code> has method defined by programmer(above).</p>\n  \n  <p><strong>Question 2:</strong></p>\n  \n  <p>On invoking <code>c.foo()</code>, does the implicit non-pointer method receive the value <code>c</code>?</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1485671511, "post_id": 41918232, "comment_id": 71017578, "body": "<a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Conversions</a>"}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1485671576, "post_id": 41918232, "comment_id": 71017586, "body": "Mostly because it knows the literal&#39;s value, so it can tell you right away that it is a silly idea. And it doesn&#39;t do it at runtime because the runtime cost is too high."}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1485672271, "post_id": 41918281, "comment_id": 71017717, "body": "See also <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/2L7NfqtZYls\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!topic/golang-nuts/2L7NfqtZYls</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1485762368, "post_id": 41918281, "comment_id": 71042311, "body": "@mattes, see also <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\">a must-read post on Go constants</a> which, among other things, deals with defining constant for maximum integer values of various types."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1485672317, "last_edit_date": 1495539932, "creation_date": 1485671448, "answer_id": 41918281, "question_id": 41918232, "link": "https://stackoverflow.com/questions/41918232/no-panic-when-converting-int-to-uint/41918281#41918281", "title": "No panic when converting int to uint?", "body": "<p>As mentioned in <a href=\"https://github.com/golang/go/issues/6923\" rel=\"nofollow noreferrer\">issue 6923</a>:</p>\n\n<blockquote>\n  <p><code>T(c)</code> where <code>T</code> is a type and <code>c</code> is a constant means to treat <code>c</code> as having type <code>T</code> rather than one of the default types.<br>\n  It gives an error if <code>c</code> can not be represented in <code>T</code>, except that for <code>float</code> and <code>complex</code> constants we quietly round to <code>T</code> as long as the value is not too large.</p>\n</blockquote>\n\n<p>Here:</p>\n\n<pre><code>const x uint = -1\nvar x uint = -1\n</code></pre>\n\n<blockquote>\n  <p>This doesn't work because -1 cannot be (implicitly) <strong><a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow noreferrer\">converted</a></strong> to a uint.</p>\n</blockquote>\n\n<pre><code>_ = uint(a) // why no panic?\n</code></pre>\n\n<p>Because <code>a</code> is not an untyped constant, but a typed variable (<code>int</code>). See <a href=\"https://play.golang.org/p/FV3ln7rwiO\" rel=\"nofollow noreferrer\">Playground</a> and \"<a href=\"https://stackoverflow.com/a/29787847/6309\">what's wrong with golang constant overflows uint64</a>\":</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    a := -1\n    _ = uint(a) // why no panic?\n    var b uint\n    b = uint(a)\n    fmt.Println(b)\n    // _ = uint(-1) // panics: main.go:7: constant -1 overflows uint\n}\n</code></pre>\n\n<p>Result: <code>4294967295</code></p>\n\n<p>That are specific rules for the conversion of non-constant numeric values:</p>\n\n<blockquote>\n  <p>When converting between integer types, if the value is a signed integer, it is sign extended to implicit infinite precision; otherwise it is zero extended.<br>\n  It is then truncated to fit in the result type's size.</p>\n</blockquote>\n"}], "owner": {"reputation": 7522, "user_id": 2142441, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/1296edcd40a8fb8af4086e1544fcc2a9?s=128&d=identicon&r=PG", "display_name": "mattes", "link": "https://stackoverflow.com/users/2142441/mattes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1712, "favorite_count": 1, "accepted_answer_id": 41918281, "answer_count": 1, "score": 2, "last_activity_date": 1485672317, "creation_date": 1485670896, "question_id": 41918232, "link": "https://stackoverflow.com/questions/41918232/no-panic-when-converting-int-to-uint", "title": "No panic when converting int to uint?", "body": "<p>I'm confused about the following type conversion. I would expect both <code>uint</code> conversions to panic.</p>\n\n<pre><code>a := -1\n_ = uint(a) // why no panic?\n\n_ = uint(-1) // panics: constant -1 overflows uint\n</code></pre>\n\n<p>Why doesn't it panic in line 2?</p>\n\n<p><a href=\"https://play.golang.org/p/jcfDL8km2C\" rel=\"nofollow noreferrer\">https://play.golang.org/p/jcfDL8km2C</a></p>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 11946, "user_id": 129895, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hQxW8.png?s=128&g=1", "display_name": "Rob Lourens", "link": "https://stackoverflow.com/users/129895/rob-lourens"}, "edited": false, "score": 0, "creation_date": 1485659073, "post_id": 41917033, "comment_id": 71015727, "body": "I cloned that repo and it works for me. Are there any errors in the developer tools console?"}, {"owner": {"reputation": 522, "user_id": 1611102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b464a54d2edba7c4979e018d0b81cd1a?s=128&d=identicon&r=PG", "display_name": "cpchung", "link": "https://stackoverflow.com/users/1611102/cpchung"}, "reply_to_user": {"reputation": 11946, "user_id": 129895, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hQxW8.png?s=128&g=1", "display_name": "Rob Lourens", "link": "https://stackoverflow.com/users/129895/rob-lourens"}, "edited": false, "score": 0, "creation_date": 1485664481, "post_id": 41917033, "comment_id": 71016478, "body": "strange to me. Can you use the vscode to &quot;go to definition&quot; (F12) for some function inside the file?"}, {"owner": {"reputation": 522, "user_id": 1611102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b464a54d2edba7c4979e018d0b81cd1a?s=128&d=identicon&r=PG", "display_name": "cpchung", "link": "https://stackoverflow.com/users/1611102/cpchung"}, "reply_to_user": {"reputation": 11946, "user_id": 129895, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hQxW8.png?s=128&g=1", "display_name": "Rob Lourens", "link": "https://stackoverflow.com/users/129895/rob-lourens"}, "edited": false, "score": 0, "creation_date": 1485703518, "post_id": 41917033, "comment_id": 71025526, "body": "Thank you for confirming this. The problem is now solved."}, {"owner": {"reputation": 522, "user_id": 1611102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b464a54d2edba7c4979e018d0b81cd1a?s=128&d=identicon&r=PG", "display_name": "cpchung", "link": "https://stackoverflow.com/users/1611102/cpchung"}, "reply_to_user": {"reputation": 11946, "user_id": 129895, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/hQxW8.png?s=128&g=1", "display_name": "Rob Lourens", "link": "https://stackoverflow.com/users/129895/rob-lourens"}, "edited": false, "score": 0, "creation_date": 1485744687, "post_id": 41917033, "comment_id": 71037336, "body": "I still have no idea how to have multiple gopath working. Is that doable in vscode for go? I want to keep the &quot;go to definition&quot; (F12) working when openning multiple projects."}, {"owner": {"reputation": 111, "user_id": 3411406, "user_type": "registered", "profile_image": "https://graph.facebook.com/1564509443/picture?type=large", "display_name": "Mohamed Mahmoud", "link": "https://stackoverflow.com/users/3411406/mohamed-mahmoud"}, "edited": false, "score": 0, "creation_date": 1487852351, "post_id": 41917033, "comment_id": 71976402, "body": "What about windows I can never &quot;go to definition&quot; ?"}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 5, "last_activity_date": 1542616740, "creation_date": 1542616740, "answer_id": 53370964, "question_id": 41917033, "link": "https://stackoverflow.com/questions/41917033/no-go-to-definition-and-no-function-definition-pop-up-for-golang-code/53370964#53370964", "title": "no &quot;go to definition&quot; and no function definition pop-up for golang code", "body": "<p>This issue is in new versions or updates of vs code. My version is <code>1.22</code>, It started working in my vs code when I tried to edit the settings of go extension for Go doc tool in </p>\n\n<pre><code>File &gt; Preferences &gt; Settings &gt; Extensions &gt; Go(Configuration)\n</code></pre>\n\n<p>Set Docs Tool from <code>godoc</code> to <code>gogetdoc</code>. If you have not downloaded <code>gogetdoc</code>. Download it first and restart vscode for it to load the tool.</p>\n\n<pre><code>go get -u github.com/zmb3/gogetdoc\n</code></pre>\n\n<p>Now Press <code>F12</code> to go to definition. I hope it helps.</p>\n"}], "owner": {"reputation": 522, "user_id": 1611102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b464a54d2edba7c4979e018d0b81cd1a?s=128&d=identicon&r=PG", "display_name": "cpchung", "link": "https://stackoverflow.com/users/1611102/cpchung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7077, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1597812360, "creation_date": 1485656560, "last_edit_date": 1485703599, "question_id": 41917033, "link": "https://stackoverflow.com/questions/41917033/no-go-to-definition-and-no-function-definition-pop-up-for-golang-code", "title": "no &quot;go to definition&quot; and no function definition pop-up for golang code", "body": "<p>I am using visual studio code to code in golang.</p>\n\n<p>Here is the code repository.\n<a href=\"https://github.com/chakpongchung/public/tree/master/rpc/src\" rel=\"nofollow noreferrer\">https://github.com/chakpongchung/public/tree/master/rpc/src</a></p>\n\n<p>It is copied from this document:\n<a href=\"https://golang.org/pkg/net/rpc/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/rpc/</a></p>\n\n<p>For this particular example, I cant see any function definition pop-up, nor can I use \"go to definition\" in vscode by pressing F12. I can see the definition pop-up in other projects in my computer.</p>\n\n<p>I have set my gopath in .bashrc in ubuntu 16.04 using the env.sh</p>\n\n<p>All the plugin and visual studio code version are the latest. What should I do to use the function definition prompt?</p>\n\n<p>update: the problem is now solved by setting:</p>\n\n<pre><code>export GOPATH=`pwd` \n</code></pre>\n\n<p>instead of:</p>\n\n<pre><code>export GOPATH=${GOPATH}:`pwd`\n</code></pre>\n\n<p>Thank you all!Though I still have no idea to have multiple gopath working.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 1345360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ac2ed6d55a1fcc3fb47be38e7cb7027?s=128&d=identicon&r=PG", "display_name": "wjdp", "link": "https://stackoverflow.com/users/1345360/wjdp"}, "edited": false, "score": 0, "creation_date": 1485698786, "post_id": 41917371, "comment_id": 71024129, "body": "Right, I&#39;m aware of that. What I&#39;m asking is what is the best way to work around this. Can we extend the html package or do we need to fork it and add that functionality. Is it possible by writing our own tokeniser?"}, {"owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "reply_to_user": {"reputation": 1310, "user_id": 1345360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ac2ed6d55a1fcc3fb47be38e7cb7027?s=128&d=identicon&r=PG", "display_name": "wjdp", "link": "https://stackoverflow.com/users/1345360/wjdp"}, "edited": false, "score": 0, "creation_date": 1485730741, "post_id": 41917371, "comment_id": 71034410, "body": "It would be necessary to fork it and add the position information to both Token and Node, and then everywhere a Node is created, copy the position information from the associated Token, if any."}], "tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": false, "score": 0, "last_activity_date": 1485660965, "creation_date": 1485660965, "answer_id": 41917371, "question_id": 41916829, "link": "https://stackoverflow.com/questions/41916829/get-full-tag-line-number-from-net-html/41917371#41917371", "title": "Get full tag / line number from net/html", "body": "<p>The html package does not record that information, so it is not available.</p>\n"}], "owner": {"reputation": 1310, "user_id": 1345360, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5ac2ed6d55a1fcc3fb47be38e7cb7027?s=128&d=identicon&r=PG", "display_name": "wjdp", "link": "https://stackoverflow.com/users/1345360/wjdp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 39, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485660965, "creation_date": 1485654329, "question_id": 41916829, "link": "https://stackoverflow.com/questions/41916829/get-full-tag-line-number-from-net-html", "title": "Get full tag / line number from net/html", "body": "<p>After parsing a document using <code>html.Parse(r io.Reader)</code> we get a node tree. Each DOM node provides it's surroundings, the name of the tag and that tag's attributes. <a href=\"https://godoc.org/golang.org/x/net/html#Node\" rel=\"nofollow noreferrer\">See here</a>.</p>\n\n<p>What's the best way to go from a node object to the string text of that node in the file <code>r</code>, as well as the line number of that tag within that file?</p>\n"}, {"tags": ["go", "package"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485634875, "post_id": 41914416, "comment_id": 71010158, "body": "Directory name and package name don&#39;t need to match, they just usually do by convention."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485635016, "post_id": 41914416, "comment_id": 71010210, "body": "@JimB If I need to import <code>roms.go</code> symbols in another file, then,  do I need to say <code>import github.com&#47;fogleman&#47;nes&#47;util&#47;main</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485635092, "post_id": 41914416, "comment_id": 71010238, "body": "You only import by path, but you can&#39;t import a main package; <code>main</code> is the program entry point."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485635200, "post_id": 41914416, "comment_id": 71010267, "body": "@JimB  <code>main</code> in <code>package main</code> is just a package name. Why does it have an implication of not getting imported?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485635405, "post_id": 41914416, "comment_id": 71010334, "body": "No, main is not only a package name, it&#39;s defined as the package that contains a <code>main</code> function and is setup as the program entry point. Every program needs a single <code>main</code> package, you can&#39;t import multiple."}], "answers": [{"comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485636257, "post_id": 41914504, "comment_id": 71010580, "body": "Does GO allow multiple(more than one) <code>.go</code> files in a directory(<code>..&#47;fogleman&#47;nes&#47;util&#47;</code>) or directory(<code>..&#47;fogleman&#47;nes&#47;</code>) with <code>package main</code>?"}], "tags": [], "owner": {"reputation": 111, "user_id": 7471377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KQzmZ.jpg?s=128&g=1", "display_name": "Michael Pettigrew", "link": "https://stackoverflow.com/users/7471377/michael-pettigrew"}, "is_accepted": false, "score": 2, "last_activity_date": 1485635335, "creation_date": 1485635335, "answer_id": 41914504, "question_id": 41914416, "link": "https://stackoverflow.com/questions/41914416/go-package-name-of-files/41914504#41914504", "title": "GO - Package name of files", "body": "<p>I believe the author of this repo intended on running roms.go as a separate program for testing. Without putting this file in package <code>main</code>, this could not be done. If you are in the root project directory:</p>\n\n<p><code>cd util</code></p>\n\n<p><code>go run roms.go path/to/roms/dir</code></p>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 615, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1485635648, "creation_date": 1485634731, "last_edit_date": 1485635648, "question_id": 41914416, "link": "https://stackoverflow.com/questions/41914416/go-package-name-of-files", "title": "GO - Package name of files", "body": "<p>I learnt that, all <code>.go</code> files in a directory must name the same package.</p>\n\n<hr>\n\n<p>Considering below <a href=\"https://github.com/fogleman/nes\" rel=\"nofollow noreferrer\">example</a> from github,</p>\n\n<pre><code>fogleman/nes/\n  nes/  \n    apu.go  \n    cartridge.go\n    console.go  \n    controller.go\n    cpu.go  \n    filter.go   \n    ines.go \n    mapper.go   \n    mapper1.go  \n    mapper2.go  \n    mapper3.go  \n    mapper4.go  \n    mapper7.go  \n    memory.go   \n    palette.go  \n    ppu.go  \n  ui/   \n  util/\n  .gitignore    \n  LICENSE.md    \n  README.md \n  main.go   \n</code></pre>\n\n<hr>\n\n<p>So, All <code>.go</code> files in directory(<code>../fogleman/nes/nes</code>) have the package name <code>nes</code>(same as directory name). </p>\n\n<p>Similarly, all  <code>.go</code> files in directory, <code>../fogleman/nes/ui</code> have the package name <code>ui</code>(same as directory name).</p>\n\n<hr>\n\n<p>Considering below two files,  I have a question,</p>\n\n<p>1)</p>\n\n<p><code>roms.go</code> file in directory(<code>../fogleman/nes/util</code>) has package name <code>main</code>(different from directory name)</p>\n\n<p>2)</p>\n\n<p><code>main.go</code> file in directory(<code>../fogleman/nes</code>) has package <code>main</code>(different from directory name).</p>\n\n<p><strong>Question:</strong></p>\n\n<p>Why package name(<code>main</code>) is different from its directory name?</p>\n"}, {"tags": ["memory-management", "go", "append", "slice", "prepend"], "answers": [{"comments": [{"owner": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "edited": false, "score": 0, "creation_date": 1485668815, "post_id": 41914898, "comment_id": 71017118, "body": "Thank you. In this case, is there any faster way of performing append, given the slice size is large?"}], "tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": false, "score": 3, "last_activity_date": 1485679366, "last_edit_date": 1485679366, "creation_date": 1485638020, "answer_id": 41914898, "question_id": 41914386, "link": "https://stackoverflow.com/questions/41914386/what-is-the-mechanism-of-using-append-to-prepend-in-go/41914898#41914898", "title": "What is the mechanism of using append to prepend in Go?", "body": "<p>The \"prepend\" call will need to allocate an array and copy all elements because a slice in Go is defined as a starting point, a size and an allocation (with the allocation being counted from the starting point).</p>\n\n<p>There is no way a slice can know that the element <strong>before</strong> the first one can be used to extend the slice.</p>\n\n<p>What will happen with</p>\n\n<pre><code>slice = append([]int{value}, slice...)\n</code></pre>\n\n<p>is</p>\n\n<ol>\n<li>a new array of a single element <code>value</code> is allocated (probably on stack)</li>\n<li>a slice is created to map this element (start=0, size=1, alloc=1)</li>\n<li>the <code>append</code> call is done</li>\n<li><code>append</code> sees that there is not enough room to extend the single-element slice so allocates a new array and copies all the elements</li>\n<li>a new slice object is created to refer to this array</li>\n</ol>\n\n<p>If appending/removing at both ends of a large container is the common use case for your application then you need a <a href=\"https://en.wikipedia.org/wiki/Double-ended_queue\" rel=\"nofollow noreferrer\">deque</a> container. It is unfortunately unavailable in Go and impossible to write efficiently for generic contained types while maintaining usability (because Go still lacks generics).</p>\n\n<p>You can however implement a deque for your specific case and this is easy (for example if you have a large container with a known upper bound may be a <a href=\"https://en.wikipedia.org/wiki/Circular_buffer\" rel=\"nofollow noreferrer\">circular buffer</a> is all you need and that is just a couple of lines of code away).</p>\n\n<hr>\n\n<p>I'm very new to Go, so may be the following is very bad Go code... but it's an attempt to implement a deque using a growing circular buffer (depending on the use case this may be or may be not a good solution)</p>\n\n<pre><code>type Deque struct {\n    buffer  []interface{}\n    f, b, n int\n}\n\nfunc (d *Deque) resize() {\n    new_buffer := make([]interface{}, 2*(1+d.n))\n    j := d.f\n    for i := 0; i &lt; d.n; i++ {\n        new_buffer[i] = d.buffer[j]\n        d.buffer[j] = nil\n        j++\n        if j == len(d.buffer) {\n            j = 0\n        }\n    }\n    d.f = 0\n    d.b = d.n\n    d.buffer = new_buffer\n}\n\nfunc (d *Deque) push_back(x interface{}) {\n    if d.n == len(d.buffer) {\n        d.resize()\n    }\n    d.buffer[d.b] = x\n    d.b++\n    if d.b == len(d.buffer) {\n        d.b = 0\n    }\n    d.n++\n}\n\nfunc (d *Deque) push_front(x interface{}) {\n    if d.n == len(d.buffer) {\n        d.resize()\n    }\n    if d.f == 0 {\n        d.f = len(d.buffer)\n    }\n    d.f--\n    d.buffer[d.f] = x\n    d.n++\n}\n\nfunc (d *Deque) pop_back() interface{} {\n    if d.n == 0 {\n        panic(\"Cannot pop from an empty deque\")\n    }\n    if d.b == 0 {\n        d.b = len(d.buffer)\n    }\n    d.b--\n    x := d.buffer[d.b]\n    d.buffer[d.b] = nil\n    d.n--\n    return x\n}\n\nfunc (d *Deque) pop_front() interface{} {\n    if d.n == 0 {\n        panic(\"Cannot pop from an empty deque\")\n    }\n    x := d.buffer[d.f]\n    d.buffer[d.f] = nil\n    d.f++\n    if d.f == len(d.buffer) {\n        d.f = 0\n    }\n    d.n--\n    return x\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1528, "user_id": 6509830, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-a2iUCqNxm8g/AAAAAAAAAAI/AAAAAAAAADk/L30vHNHz62Q/photo.jpg?sz=128", "display_name": "Sourabh Bhagat", "link": "https://stackoverflow.com/users/6509830/sourabh-bhagat"}, "edited": false, "score": 2, "creation_date": 1485709584, "post_id": 41918820, "comment_id": 71027584, "body": "Nice and detailed answer. Good job."}, {"owner": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "edited": false, "score": 0, "creation_date": 1485781072, "post_id": 41918820, "comment_id": 71053202, "body": "Thank you for your detailed and helpful answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1485693323, "last_edit_date": 1485693323, "creation_date": 1485676905, "answer_id": 41918820, "question_id": 41914386, "link": "https://stackoverflow.com/questions/41914386/what-is-the-mechanism-of-using-append-to-prepend-in-go/41918820#41918820", "title": "What is the mechanism of using append to prepend in Go?", "body": "<h2>With reslicing and copying</h2>\n\n<p>The builtin <a href=\"https://golang.org/pkg/builtin/#append\" rel=\"nofollow noreferrer\"><code>append()</code></a> always <em>appends</em> elements to a slice. You cannot use it (alone) to prepend elements.</p>\n\n<p>Having said that, if you have a slice capacity bigger than length (has \"free\" space after its elements) to which you want to prepend an element, you may reslice the original slice, copy all elements to an index one higher to make room for the new element, then set the element to the 0<sup>th</sup> index. This will require no new allocation. This is how it could look like:</p>\n\n<pre><code>func prepend(dest []int, value int) []int {\n    if cap(dest) &gt; len(dest) {\n        dest = dest[:len(dest)+1]\n        copy(dest[1:], dest)\n        dest[0] = value\n        return dest\n    }\n\n    // No room, new slice need to be allocated:\n    // Use some extra space for future:\n    res := make([]int, len(dest)+1, len(dest)+5)\n    res[0] = value\n    copy(res[1:], dest)\n    return res\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>s := make([]int, 0, 5)\ns = append(s, 1, 2, 3, 4)\nfmt.Println(s)\ns = prepend(s, 9)\nfmt.Println(s)\ns = prepend(s, 8)\nfmt.Println(s)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/pkjpf5_9Mi\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[1 2 3 4]\n[9 1 2 3 4]\n[8 9 1 2 3 4]\n</code></pre>\n\n<p>Note: if no room for the new element, since performance does matter now, we didn't just do:</p>\n\n<pre><code>res := append([]int{value}, dest...)\n</code></pre>\n\n<p>Because it does more allocations and copying than needed: allocates a slice for the literal (<code>[]int{value}</code>), then <code>append()</code> allocates a new when appending <code>dest</code> to it.</p>\n\n<p>Instead our solution allocates just one new array (by <code>make()</code>, even reserving some space for future growth), then just set <code>value</code> as the first element and copy <code>dest</code> (the previous elements).</p>\n\n<h2>With linked list</h2>\n\n<p>If you need to prepend many times, a normal slice may not be the right choice. A faster alternative would be to use a linked list, to which prepending an element requires no allocations of slices / arrays and copying, you just create a new node element, and you designate it to be the root by pointing it to the old root (first element).</p>\n\n<p>The standard library provides a general implementation in the <a href=\"https://golang.org/pkg/container/list/\" rel=\"nofollow noreferrer\"><code>container/list</code></a> package.</p>\n\n<h2>With manually managing a larger backing array</h2>\n\n<p>Sticking to normal slices and arrays, there is another solution.</p>\n\n<p>If you're willing to manage a larger backing array (or slice) yourself, you can do so by leaving free space before the slice you use. When prepending, you can create a new slice value from the backing larger array or slice which starts at an index that leaves room for 1 element to be prepended.</p>\n\n<p>Without completeness, just for demonstration:</p>\n\n<pre><code>var backing = make([]int, 15) // 15 elements\nvar start int\n\nfunc prepend(dest []int, value int) []int {\n    if start == 0 {\n        // No more room for new value, must allocate bigger backing array:\n        newbacking := make([]int, len(backing)+5)\n        start = 5\n        copy(newbacking[5:], backing)\n        backing = newbacking\n    }\n\n    start--\n    dest = backing[start : start+len(dest)+1]\n    dest[0] = value\n    return dest\n}\n</code></pre>\n\n<p>Testing / using it:</p>\n\n<pre><code>start = 5\ns := backing[start:start] // empty slice, starting at idx=5\ns = append(s, 1, 2, 3, 4)\nfmt.Println(s)\ns = prepend(s, 9)\nfmt.Println(s)\ns = prepend(s, 8)\nfmt.Println(s)\n\n// Prepend more to test reallocation:\nfor i := 10; i &lt; 15; i++ {\n    s = prepend(s, i)\n}\nfmt.Println(s)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/kqxrnj5Nqk\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[1 2 3 4]\n[9 1 2 3 4]\n[8 9 1 2 3 4]\n[14 13 12 11 10 8 9 1 2 3 4]\n</code></pre>\n\n<p><strong>Analysis: this solution makes no allocations and no copying when there is room in the <code>backing</code> slice to prepend the value!</strong> All that happens is it creates a new slice from the <code>backing</code> slice that covers the destination +1 space for the value to be prepended, sets it and returns this slice value. You can't really get better than this.</p>\n\n<p>If there is no room, then it allocates a larger <code>backing</code> slice, copies over the content of the old, and then does the \"normal\" prepending.</p>\n\n<h2>With tricky slice usage</h2>\n\n<p>Idea: imagine that you always store elements in a slice in backward order.</p>\n\n<p><strong>Storing your elements in backward order in a slice means a prepand becomes append!</strong></p>\n\n<p>So to \"prepand\" an element, you can simply use <code>append(s, value)</code>. And that's all.</p>\n\n<p>Yes, this has its limited uses (e.g. append to a slice stored in reverse order has the same issues and complexity as a \"normal\" slice and prepand operation),  and you lose many conveniences (ability to list elements using <code>for range</code> just to name one), but performance wise nothing beats prepanding a value just by using <code>append()</code>.</p>\n\n<p>Note: iterating over the elements that stores elements in backward order has to use a downward loop, e.g.:</p>\n\n<pre><code>for i := len(s) - 1; i &gt;= 0; i-- {\n    // do something with s[i]\n}\n</code></pre>\n\n<hr>\n\n<p>Final note: all these solutions can easily be extended to prepend a slice instead of just a value. Generally the additional space when reslicing is not <code>+1</code> but <code>+len(values)</code>, and not simply setting <code>dst[0] = value</code> but instead a call to <code>copy(dst, values)</code>.</p>\n"}], "owner": {"reputation": 4952, "user_id": 5987698, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/1b26d6435dcb8897d1a57fa24b462da0?s=128&d=identicon&r=PG&f=1", "display_name": "GoodDeeds", "link": "https://stackoverflow.com/users/5987698/gooddeeds"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1299, "favorite_count": 1, "accepted_answer_id": 41918820, "answer_count": 2, "score": 4, "last_activity_date": 1485693323, "creation_date": 1485634560, "last_edit_date": 1495542807, "question_id": 41914386, "link": "https://stackoverflow.com/questions/41914386/what-is-the-mechanism-of-using-append-to-prepend-in-go", "title": "What is the mechanism of using append to prepend in Go?", "body": "<p>Suppose I have a slice <code>slice</code> of type <code>int</code>. While declaring, I set the third argument to <code>size</code>, which I believe reserves memory for at least <code>size</code> ints by setting the <code>cap</code> parameter of the slice.</p>\n\n<pre><code>slice:=make([]int,0,size)\n</code></pre>\n\n<p>Now, suppose I have an integer variable <code>value</code>. To add it to the slice at the end, I use</p>\n\n<pre><code>slice=append(slice,value)\n</code></pre>\n\n<p>If the number of elements currently in the slice is less than <code>size</code>, then there will be no need to copy the entire underlying array to a new location in order to add the new element.</p>\n\n<p>Further, if I want to prepend <code>value</code> to <code>slice</code>, as suggested <a href=\"https://stackoverflow.com/a/25092960/5987698\">here</a> and <a href=\"https://stackoverflow.com/a/34293641/5987698\">here</a>, I use</p>\n\n<pre><code>slice=append([]int{value},slice...)\n</code></pre>\n\n<p>My question is, what happens in this case? If the number of elements is still less than <code>size</code>, how are the elements stored in the memory? Assuming a contiguous allocation when the <code>make()</code> function was invoked, are all existing elements right shifted to free the first space for value? Or is memory reallocated and all elements copied?</p>\n\n<p>The reason for asking is that I would like my program to be as fast as possible, and would like to know if this is a possible cause for slowing it down. If it is so, is there any alternative way of prepending that would be more time efficient?</p>\n"}, {"tags": ["go", "server-side"], "comments": [{"owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "edited": false, "score": 0, "creation_date": 1485628152, "post_id": 41913240, "comment_id": 71007893, "body": "Go &quot;plugins&quot; might be what you&#39;re looking for, they&#39;re not stable yet and only work on linux afaik: <a href=\"https://appliedgo.net/plugins/\" rel=\"nofollow noreferrer\">appliedgo.net/plugins</a>"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 1, "creation_date": 1485629663, "post_id": 41913240, "comment_id": 71008452, "body": "Does <a href=\"https://github.com/facebookgo/grace\" rel=\"nofollow noreferrer\">this</a> help?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "edited": false, "score": 0, "creation_date": 1485630724, "post_id": 41913240, "comment_id": 71008816, "body": "@hermancain, plugins can&#39;t be unloaded, so I&#39;m not sure how that would suffice."}], "answers": [{"tags": [], "owner": {"reputation": 2815, "user_id": 123600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0eeb220ccf249757b0960465f2b10631?s=128&d=identicon&r=PG", "display_name": "icio", "link": "https://stackoverflow.com/users/123600/icio"}, "is_accepted": false, "score": 1, "last_activity_date": 1485701229, "creation_date": 1485701229, "answer_id": 41922157, "question_id": 41913240, "link": "https://stackoverflow.com/questions/41913240/seamless-patch-deploy-of-go-server-without-restarting/41922157#41922157", "title": "Seamless Patch Deploy of Go Server Without Restarting", "body": "<p>This kind of seemless deployment can be achieved for even the most naive of application servers by introducing a request router such as <a href=\"https://www.nginx.com/resources/wiki/\" rel=\"nofollow noreferrer\">nginx</a> or <a href=\"http://www.haproxy.org/\" rel=\"nofollow noreferrer\">haproxy</a>. Both of these routers allow you to forward requests to different services (known as a reverse-proxy), and reload their configuration without dropping connections. By way of an example:</p>\n\n<ul>\n<li>Configure your router to listen on <code>0.0.0.0.80</code> and forward these requests to <code>127.0.0.1:5001</code>.</li>\n<li>Run your application server v1 on <code>127.0.0.1:5001</code>.</li>\n<li>In this setup when your users make requests to your router, they will be forwarded it to your application v1 server.</li>\n<li>In deploying a new version v2 of your application, configure it to listen on port <code>127.0.0.1:5002</code>.</li>\n<li>Change the router configuration such that it now forwards traffic to <code>127.0.0.1:5002</code>. Then tell the router to reload its configuration.</li>\n<li>Now when your users make new requests to your router, they will be forwarded to your application v2 server.</li>\n<li>You can safely shut down v1 once it stops receiving traffic. If there are issues with v2 you can revert back to v1 by reverting your router configuration, so keeping v1 running in the background has its benefits.</li>\n</ul>\n\n<p>This is a simplified, high-level overview. (You should prefer unix sockets over the loopback interface, for example.) This kind of deployment is typically referred to as a canary or <a href=\"https://martinfowler.com/bliki/BlueGreenDeployment.html\" rel=\"nofollow noreferrer\">blue-green deployment</a>.</p>\n"}], "owner": {"reputation": 1472, "user_id": 1784242, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/227e25a94746cb18c48454ffb0855c99?s=128&d=identicon&r=PG", "display_name": "rbtLong", "link": "https://stackoverflow.com/users/1784242/rbtlong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485701229, "creation_date": 1485627908, "question_id": 41913240, "link": "https://stackoverflow.com/questions/41913240/seamless-patch-deploy-of-go-server-without-restarting", "title": "Seamless Patch Deploy of Go Server Without Restarting", "body": "<p>I was curious if there are any solutions to deploying a go server without the need shut it down and relaunch it. I know popular solutions like ASP.Net and PHP and the like will do this seamlessly for user sessions.</p>\n\n<p>Will stateless sessions take care of this issue?</p>\n"}, {"tags": ["go", "struct", "slice", "mutable"], "answers": [{"comments": [{"owner": {"reputation": 733, "user_id": 5757964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3639bf68fea827de4f005972c1adee68?s=128&d=identicon&r=PG&f=1", "display_name": "AnkithD", "link": "https://stackoverflow.com/users/5757964/ankithd"}, "edited": false, "score": 0, "creation_date": 1485625566, "post_id": 41912837, "comment_id": 71007009, "body": "What would you recommend I do to avoid this? Do i have to manually make make a temporary slice of same length, copy the old one into this and reassign the myslice field to refer to this temporary slice? Isn&#39;t there any elegant way to handle this?"}, {"owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "reply_to_user": {"reputation": 733, "user_id": 5757964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3639bf68fea827de4f005972c1adee68?s=128&d=identicon&r=PG&f=1", "display_name": "AnkithD", "link": "https://stackoverflow.com/users/5757964/ankithd"}, "edited": false, "score": 0, "creation_date": 1485625753, "post_id": 41912837, "comment_id": 71007080, "body": "The real question is, &quot;Why is the function modifying the contents of the slice?&quot; But yes, if you are using a function like that, and you don&#39;t want it to modify the contents of the slice, you would need to make a deep copy of the struct, including the contents of the slice."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 733, "user_id": 5757964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3639bf68fea827de4f005972c1adee68?s=128&d=identicon&r=PG&f=1", "display_name": "AnkithD", "link": "https://stackoverflow.com/users/5757964/ankithd"}, "edited": false, "score": 1, "creation_date": 1485627348, "post_id": 41912837, "comment_id": 71007611, "body": "@AnkithD, you should understand this triplet of facts: 1) In Go, absolutely everything is passed by value, ever. 2) You may take an address of a value and pass it--instead of the original value. Still, the pointer is passed by value. 3) Three built-in types have <i>reference semantics:</i> maps, slices, channels. It means that the values of these types behave as &quot;descriptors&quot; (or &quot;handles&quot;) of/on certain complicated hidden structures. The values of these types are passed by value like everything else but each copy <i>refers</i> to the same underlying structure."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 733, "user_id": 5757964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3639bf68fea827de4f005972c1adee68?s=128&d=identicon&r=PG&f=1", "display_name": "AnkithD", "link": "https://stackoverflow.com/users/5757964/ankithd"}, "edited": false, "score": 0, "creation_date": 1485627635, "post_id": 41912837, "comment_id": 71007720, "body": "@AnkithD, for slices, such a &quot;hidden structure&quot; is the backing array, and when you assign a slice value to a variable, two resulting values refer to the same underying array--hence sharing it. To understand why slices were designed this way, it&#39;s better to first learn about Go arrays. Unlike certain other languages (like, say, JS or C#), a slice is not &quot;the data structure implementing an array&quot;, it is <i>a view window to an underlying array.</i> Yes, with <code>make()</code>, it&#39;s possible to create a slice with preallocated (and hence &quot;anonymous&quot;) backing array..."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 733, "user_id": 5757964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3639bf68fea827de4f005972c1adee68?s=128&d=identicon&r=PG&f=1", "display_name": "AnkithD", "link": "https://stackoverflow.com/users/5757964/ankithd"}, "edited": false, "score": 1, "creation_date": 1485627855, "post_id": 41912837, "comment_id": 71007801, "body": "@AnkithD, ...but it&#39;s also fine to take an existing array and &quot;slice&quot; it. This is very useful for writing certain kind of algorithms--like parsing data transferred by network protocols. Without slices, when you&#39;d want to make parsing functions to only be concerned with certain parts of a buffer (array) containing data, you&#39;d have to explicitly pass around a pointer to that buffer, an offset from its beginning and a length after that offset--both limiting the span of items to access. Slices combine these into nice self-contained packages."}], "tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": false, "score": 2, "last_activity_date": 1485625588, "last_edit_date": 1485625588, "creation_date": 1485625451, "answer_id": 41912837, "question_id": 41912662, "link": "https://stackoverflow.com/questions/41912662/why-are-slices-insides-structs-passed-by-reference-when-passed-into-functions/41912837#41912837", "title": "Why are Slices insides structs &quot;passed by reference&quot; when passed into functions in Go?", "body": "<p>The slice is not really being <em>passed</em> by reference; if you append to it in <code>addOne</code>, its length will not change. But a slice <em>contains</em> a reference (or pointer) to its backing array. So when you copy a slice, the new one shares the same backing array with the old one.</p>\n\n<p>The fact that the slice is inside a struct doesn't make any difference. You would see the same thing if you changed <code>addOne</code> to just take a slice instead of the whole struct.</p>\n"}], "owner": {"reputation": 733, "user_id": 5757964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3639bf68fea827de4f005972c1adee68?s=128&d=identicon&r=PG&f=1", "display_name": "AnkithD", "link": "https://stackoverflow.com/users/5757964/ankithd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485625588, "creation_date": 1485624357, "question_id": 41912662, "link": "https://stackoverflow.com/questions/41912662/why-are-slices-insides-structs-passed-by-reference-when-passed-into-functions", "title": "Why are Slices insides structs &quot;passed by reference&quot; when passed into functions in Go?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n\n    a := SomeType{myslice: []int{1, 2, 3}, decimal: 2.33}\n\n    for _, i := range a.myslice {\n        fmt.Println(i)\n    }\n    fmt.Println(a.decimal)\n\n    addOne(a)\n\n    for _, i := range a.myslice {\n        fmt.Println(i)\n    }\n    fmt.Println(a.decimal)\n\n}\n\ntype SomeType struct {\n    myslice []int\n    decimal float32\n}\n\nfunc addOne(s SomeType) {\n    s.myslice[0]++\n    s.decimal += 1.2\n}\n</code></pre>\n\n<p>The output for the code above is:</p>\n\n<p>1\n2\n3\n2.33\n2\n2\n3\n2.33</p>\n\n<p>Even though i have not passed the SomeType object a by reference the myslice field is being modified in the original object. Why is this happening? Is there anyway to pass the entire object by value without having to create a copy of the original object?</p>\n"}, {"tags": ["go", "error-handling", "idioms"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1485625616, "last_edit_date": 1485625616, "creation_date": 1485624799, "answer_id": 41912724, "question_id": 41912264, "link": "https://stackoverflow.com/questions/41912264/where-to-exit1-and-where-to-return-error/41912724#41912724", "title": "Where to `Exit(1)` and where to return error?", "body": "<p>Basically you better handle error in place not drug it through. You call <code>os.Exit()</code> when you need immediate exit so in place also. And you forget another option - <code>panic()</code>. It goes through and evaluates deferred function which allows you some teardown. While writing a package it's not recommended to call <code>os.Exit()</code> or <code>panic()</code> to not confuse users with unpredictable. In packages promoting errors is the best choice.</p>\n"}], "owner": {"reputation": 5, "user_id": 7463554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/zSGjF.jpg?s=128&g=1", "display_name": "Canadian Gopher", "link": "https://stackoverflow.com/users/7463554/canadian-gopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 41912724, "answer_count": 1, "score": 0, "last_activity_date": 1485625616, "creation_date": 1485622006, "question_id": 41912264, "link": "https://stackoverflow.com/questions/41912264/where-to-exit1-and-where-to-return-error", "title": "Where to `Exit(1)` and where to return error?", "body": "<p>What is the idiomatic way to handle errors occurred deep in a program layers? If I have such a snippet somewhere deep inside a package:</p>\n\n<pre><code>file, err := os.Open(path)\nif err != nil {            \n    os.Exit(1) // or return errors.New(\"The path is invalid.\")\n}                          \n</code></pre>\n\n<p>Should I return an error and possibly drag it through a several layers with <code>if {} else {}</code> blocks up to <code>main</code> and <code>Exit</code> in <code>main</code> or <code>Exit</code> immediately? </p>\n\n<p>With immediate <code>Exit</code> code looks cleaner and more readable. But sometimes it is difficult to test. With returns and checks code looks worse (at my opinion) but it is easier to test and reach 100% of coverage.</p>\n\n<p>And one more question... If I'm writing a package and it has no <code>main</code> function should I leave <code>Exit</code>s to a \"user\" program and just return errors?</p>\n"}, {"tags": ["mysql", "go", "redis", "memcached", "quota"], "comments": [{"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "edited": false, "score": 0, "creation_date": 1485639519, "post_id": 41912252, "comment_id": 71011510, "body": "Since you&#39;re talking about a web app, one straightforward and significantly more lightweight solution is to do this with HAProxy, which has optimized memory structures for holding large numbers of counters, and I believe is <a href=\"http://blog.serverfault.com/2010/08/26/1016491873/\" rel=\"nofollow noreferrer\">the way Stack Exchange does its rate limiting</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2337, "user_id": 600061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bbac8bb4d3ffbceca42b09eb0729e63c?s=128&d=identicon&r=PG", "display_name": "Twisted1919", "link": "https://stackoverflow.com/users/600061/twisted1919"}, "edited": false, "score": 0, "creation_date": 1485623312, "post_id": 41912439, "comment_id": 71006203, "body": "Thanks for the reply, i don&#39;t have the exact error code at hand atm, but the problem arises when we do parallel requests and it happens that 2 or more requests try to update that column at the same time, so then your example will fail. I think there needs to be a way to do atomic updates, but haven&#39;t found any.   Thanks for the redis link, i&#39;ll have a look at it."}, {"owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "reply_to_user": {"reputation": 2337, "user_id": 600061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bbac8bb4d3ffbceca42b09eb0729e63c?s=128&d=identicon&r=PG", "display_name": "Twisted1919", "link": "https://stackoverflow.com/users/600061/twisted1919"}, "edited": false, "score": 0, "creation_date": 1485639219, "post_id": 41912439, "comment_id": 71011419, "body": "@Twisted1919 that&#39;s not what a deadlock is.  Atomic updates are fine, and lock contention is handled transparently. Deadlocks occur when two transactions each try to acquire a lock that the other one already holds, which isn&#39;t going to happen in a simple atomic update of one column in one row."}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 1, "last_activity_date": 1485623120, "creation_date": 1485623120, "answer_id": 41912439, "question_id": 41912252, "link": "https://stackoverflow.com/questions/41912252/implementing-a-quota-system-to-limit-requests-in-a-web-based-app/41912439#41912439", "title": "Implementing a quota system to limit requests in a web based app", "body": "<p>I'm not sure what you mean by \"get a deadlock from mysql\" when you try to update a row at the same time.  But a simple <code>update rate_limit set count = count + 1 where user_id = ?</code> should do what you want.</p>\n\n<p>Personally I have had great success with Redis for doing rate limiting.  There are lots of resources out there to help you understand the appropriate approach for your use case.  Here is one I just glanced at that seems to handle things correctly: <a href=\"https://www.binpress.com/tutorial/introduction-to-rate-limiting-with-redis/155\" rel=\"nofollow noreferrer\">https://www.binpress.com/tutorial/introduction-to-rate-limiting-with-redis/155</a>.  Using pipelines (<code>MULTI</code>) or Lua scripts may make things even nicer.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1485736049, "creation_date": 1485736049, "answer_id": 41927533, "question_id": 41912252, "link": "https://stackoverflow.com/questions/41912252/implementing-a-quota-system-to-limit-requests-in-a-web-based-app/41927533#41927533", "title": "Implementing a quota system to limit requests in a web based app", "body": "<p>You can persist your <code>map[int]int</code> in RDBMS or just file system time to time and in defer function. You even can use it as cache instead of redis. Surely it will be anyway faster than connection to third-party service every request. Also you can store counters on user side simply in cookies. Smart user can clear cookies of-douse but is it so dangerous at all and you can also provide some identification info in cookies to make clearing uncomfortable.  </p>\n"}], "owner": {"reputation": 2337, "user_id": 600061, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bbac8bb4d3ffbceca42b09eb0729e63c?s=128&d=identicon&r=PG", "display_name": "Twisted1919", "link": "https://stackoverflow.com/users/600061/twisted1919"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 162, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485736049, "creation_date": 1485621961, "question_id": 41912252, "link": "https://stackoverflow.com/questions/41912252/implementing-a-quota-system-to-limit-requests-in-a-web-based-app", "title": "Implementing a quota system to limit requests in a web based app", "body": "<p>I want to limit my users to 25k/requests per hour/day/whatever.</p>\n\n<p>My first idea was to simply use mysql and have a column in the users table where i would store the requests and i would increment this counter each time the user makes a request. Problem with this approach is that sometimes you end up writing at the same time in the column and you get a deadlock from mysql, so this isn't really a good way to go about it, is it ?</p>\n\n<p>Another way would be, instead of incrementing the counters of a column, to insert log records in a separate table and then count these records for a given timespan, but this way you can easily end up with million records table and the query can be too slow.</p>\n\n<p>When using a RDBMS another aspect to take into consideration is that at each request you'd have to count the user quota from database and this can take time depending on either of the above mentioned methods.</p>\n\n<p>My second idea, i thought using something like redis/memcached (not sure of alternatives or which one of them is faster) and store the request counters there. This would be fast enough to query and increment the counters, for sure faster than a RDBMS, but i haven't tried it with huge amounts of data, so i am not sure how it will perform just yet.</p>\n\n<p>My third idea, i would keep the quota data in memory in a map, something like <code>map[int]int</code> where the key would be the user_id and the value would be the quota usage and i'd protect the map access with a mutex. This would be the fastest solution of all but then what do you do if for some reason your app crashes, you lose all that data related to the number of requests certain user did. One way would be to catch the app when crashing and loop through the map and update the database. Is this feasible?</p>\n\n<p>Not sure if either of the above is the right approach, but i am open to suggestions.</p>\n"}, {"tags": ["go", "synchronization", "goroutine"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485622143, "post_id": 41911253, "comment_id": 71005791, "body": "The \tsecond print is not waiting for waitgroup, fmt.Println(&quot;done twice&quot;). Is it expected"}, {"owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485646635, "post_id": 41911253, "comment_id": 71013520, "body": "Yes, good catch. I will add it"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1485656350, "post_id": 41911253, "comment_id": 71015302, "body": "check answer below.It is written for your code sample"}], "owner": {"reputation": 9547, "user_id": 46279, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/df9614769cb56c2cc06330efa2599e3f?s=128&d=identicon&r=PG", "display_name": "coder_bro", "link": "https://stackoverflow.com/users/46279/coder-bro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1485646745, "creation_date": 1485615891, "last_edit_date": 1485646745, "question_id": 41911253, "link": "https://stackoverflow.com/questions/41911253/how-to-signal-all-go-routines-that-are-waiting", "title": "How to signal all go routines that are waiting?", "body": "<p>The problem I have is to \"signal all go routines that are waiting\".\nSome go routines may be performing other tasks (simulated by time.Sleep in code below), before waiting for the signal. Others go routines may wait for the signal immediately after starting. In some case there may not be any go routines that are waiting (not simulated in the code below)</p>\n\n<p>I came with the following approach:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n\n    wg := sync.WaitGroup{}\n    wg.Add(3)\n    cond := sync.NewCond(&amp;sync.Mutex{})\n    signalled := false\n\n    producer := func() {\n        time.Sleep(1)\n        cond.L.Lock()\n        signalled = true\n        cond.Broadcast()\n        cond.L.Unlock()\n        wg.Done()\n    }\n    go producer()\n\n    go func() {\n        time.Sleep(3 * time.Second)\n        cond.L.Lock()\n        for !signalled {\n            cond.Wait()\n        }\n        cond.L.Unlock()\n        wg.Done()\n    }()\n\n    go func() {\n        cond.L.Lock()\n        for !signalled {\n            cond.Wait()\n        }\n        cond.L.Unlock()\n        wg.Done()\n    }()\n\n    wg.Wait()\n    fmt.Println(\"done once\")\n\n    reset := func() {\n        cond.L.Lock()\n        signalled = false\n        cond.L.Unlock()\n    }\n    // a reset function\n    reset()\n\n    wg.Add(2)\n    go producer()\n    go func() {\n        cond.L.Lock()\n        for !signalled {\n            cond.Wait()\n        }\n        cond.L.Unlock()\n        wg.Done()\n    }()\n    wg.Wait()\n    fmt.Println(\"done twice\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/uNmyofH2hs\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uNmyofH2hs</a></p>\n\n<p>I can use a channel and close the channel as a signal. But this means that in case there is a need for \"reset\" (where in the \"signal\" can be triggered again), the channel would have to be created again.</p>\n\n<p>Is there a better (concise) way to achieve this?</p>\n"}, {"tags": ["ubuntu", "go", "daemon", "supervisord", "upstart"], "answers": [{"comments": [{"owner": {"reputation": 190, "user_id": 910580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2Eof.jpg?s=128&g=1", "display_name": "stevemanuel", "link": "https://stackoverflow.com/users/910580/stevemanuel"}, "reply_to_user": {"reputation": 959, "user_id": 4784553, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/KSIgw.jpg?s=128&g=1", "display_name": "Zept", "link": "https://stackoverflow.com/users/4784553/zept"}, "edited": false, "score": 0, "creation_date": 1487897908, "post_id": 42357385, "comment_id": 72003398, "body": "Sure thing -- if you wouldn&#39;t mind then marking my answer correct or adding your own solution and marking it, it would be helpful to other people who find this from a Google search."}], "tags": [], "owner": {"reputation": 190, "user_id": 910580, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2Eof.jpg?s=128&g=1", "display_name": "stevemanuel", "link": "https://stackoverflow.com/users/910580/stevemanuel"}, "is_accepted": false, "score": 0, "last_activity_date": 1487642412, "creation_date": 1487642412, "answer_id": 42357385, "question_id": 41911005, "link": "https://stackoverflow.com/questions/41911005/service-upstrart-process-exited-with-error-code/42357385#42357385", "title": "Service upstrart process exited with error code", "body": "<p>This is commonly caused by not assigning the $VARIABLES in the init script that is provided as an example in the Ponzu project.</p>\n\n<p>Make sure you add your own project directory path and other variables before you try to start a daemon/service.</p>\n"}], "owner": {"reputation": 959, "user_id": 4784553, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/KSIgw.jpg?s=128&g=1", "display_name": "Zept", "link": "https://stackoverflow.com/users/4784553/zept"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 239, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1487642412, "creation_date": 1485614271, "last_edit_date": 1485620815, "question_id": 41911005, "link": "https://stackoverflow.com/questions/41911005/service-upstrart-process-exited-with-error-code", "title": "Service upstrart process exited with error code", "body": "<p>I added ponzu-server in upstart, but I start ponzu-server  have some error. </p>\n\n<pre><code>sudo service ponzu-server start\nJob for ponzu-server.service failed because the control process exited with error code. See \"systemctl status ponzu-server.service\" and \"journalctl -xe\" for details.\n</code></pre>\n\n<p>journalctl -xe:</p>\n\n<pre><code>Jan 28 19:12:22 cs67724 systemd[1]: ponzu-server.service: Unit entered failed state.\nJan 28 19:12:22 cs67724 systemd[1]: ponzu-server.service: Failed with result 'exit-code'.\nJan 28 19:12:22 cs67724 sudo[1069]: pam_unix(sudo:session): session closed for user root\nJan 28 19:12:30 cs67724 sudo[1095]:    ponzu : TTY=pts/0 ; PWD=/home/ponzu/work ; USER=root ; COMMAND=/bin/journalctl -xe\nJan 28 19:12:30 cs67724 sudo[1095]: pam_unix(sudo:session): session opened for user root by ponzu(uid=0)\nJan 28 19:13:14 cs67724 sudo[1095]: pam_unix(sudo:session): session closed for user root\nJan 28 19:16:58 cs67724 sudo[1118]:    ponzu : TTY=pts/0 ; PWD=/home/ponzu/work/src/remoteConfig/deployment/sysv ; USER=root ; COMM\nJan 28 19:16:58 cs67724 sudo[1118]: pam_unix(sudo:session): session opened for user root by ponzu(uid=0)\n</code></pre>\n"}, {"tags": ["json", "go", "struct"], "comments": [{"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 1, "creation_date": 1485624771, "post_id": 41910620, "comment_id": 71006727, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/q/18526046\">mapping strings to multiple types for json objects</a>"}], "answers": [{"tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": false, "score": 0, "last_activity_date": 1485617175, "creation_date": 1485617175, "answer_id": 41911474, "question_id": 41910620, "link": "https://stackoverflow.com/questions/41910620/map-a-string-to-a-map-with-different-values/41911474#41911474", "title": "map a string to a map with different values", "body": "<p>If you don't know the structure in advance then just use</p>\n\n<pre><code>x := make(map[string]interface{})\nx[\"foo\"] = 1\nx[\"bar\"] = \"A string\"\n</code></pre>\n"}], "owner": {"reputation": 363, "user_id": 7363849, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/ddee75a837013b5745c0acb6fc947fbd?s=128&d=identicon&r=PG&f=1", "display_name": "lol", "link": "https://stackoverflow.com/users/7363849/lol"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485617175, "creation_date": 1485611917, "question_id": 41910620, "link": "https://stackoverflow.com/questions/41910620/map-a-string-to-a-map-with-different-values", "title": "map a string to a map with different values", "body": "<pre><code>{'award_name':\n{'note':'good job!','value':10,'number':1,'date-received':'DATE'}\n}\n</code></pre>\n\n<p>I am creating a struct to store all this data, but I'm confused on what format it should be in. You are mapping a string to a map of different types, how do you create that? Do I need to make another <code>struct</code> to store the layout?</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": false, "score": 1, "last_activity_date": 1485625878, "last_edit_date": 1485625878, "creation_date": 1485613158, "answer_id": 41910814, "question_id": 41910294, "link": "https://stackoverflow.com/questions/41910294/gorilla-mux-excluding-request-by-extension/41910814#41910814", "title": "gorilla mux excluding request by extension", "body": "<p>This <code>\"^.*([!js|jpg|png|gif])$}\"</code> is not a valid regular expession for matching string that does not have  .jpg|.js|.png</p>\n\n<p>However, In golang <em>Negative lookahead</em> isn't supported for technical reasons, specifically because it conflicts with the O(n)-time guarantees of the library. </p>\n\n<p>I would suggest you to do it other way around ie, add handlers for png,js,css files etc to serve the files as such</p>\n"}, {"tags": [], "owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "is_accepted": false, "score": 2, "last_activity_date": 1485623963, "creation_date": 1485623963, "answer_id": 41912587, "question_id": 41910294, "link": "https://stackoverflow.com/questions/41910294/gorilla-mux-excluding-request-by-extension/41912587#41912587", "title": "gorilla mux excluding request by extension", "body": "<p>Better approach welcome, hoped to use regular expression so things where left intact with no crazy if/else conditions</p>\n\n<pre><code>func main() {\n    r := mux.NewRouter()\n\n    r.HandleFunc(\"/{path:.*}\", func(w http.ResponseWriter, r *http.Request) {\n        if HasSuffix(r.URL.Path, []string{\"js\", \"css\", \"gif\", \"jpeg\", \"woff2\", \"woff\", \"ttf\"}) == false {\n            fmt.Println(\"serving index\")\n            http.ServeFile(w, r, \"dist/index.html\")\n        } else {\n            http.ServeFile(w, r, \"dist/\"+r.URL.Path)\n        }\n    })\n\n    //r.PathPrefix(\"/\").Handler(http.StripPrefix(\"/\", http.FileServer(http.Dir(\"dist\"))))\n\n    http.Handle(\"/\", r)\n    http.ListenAndServe(\":8000\", nil)\n}\n\n//HasSuffix check if url has suffix\nfunc HasSuffix(path string, parts []string) bool {\n    for _, part := range parts {\n        fmt.Println(\"checking if part:\" + part + \" exists in path:\" + path)\n        if strings.HasSuffix(path, part) == true {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n"}], "owner": {"reputation": 767, "user_id": 4080676, "user_type": "registered", "accept_rate": 35, "profile_image": "https://i.stack.imgur.com/NXpQt.png?s=128&g=1", "display_name": "iswak", "link": "https://stackoverflow.com/users/4080676/iswak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 954, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1485625878, "creation_date": 1485609783, "question_id": 41910294, "link": "https://stackoverflow.com/questions/41910294/gorilla-mux-excluding-request-by-extension", "title": "gorilla mux excluding request by extension", "body": "<p>An attempt to configure go server routing with <code>github.com/gorilla/mux</code> to respond to all requests with index.html but exclude requests with extension .jpg|.js|.png</p>\n\n<p>Static files excluded due to extension will be routed to FileServer. configured. </p>\n\n<p><strong>Failed Attempt</strong></p>\n\n<pre><code>  func main() {\n        r := mux.NewRouter()\n\n        r.HandleFunc(\"/{path:^.*([!js|jpg|png|gif])$}\", func(w http.ResponseWriter, r *http.Request) {\n            http.ServeFile(w, r, \"dist/index.html\")\n        })\n\n        r.PathPrefix(\"/\").Handler(http.StripPrefix(\"/\", http.FileServer(http.Dir(\"dist\"))))\n\n        http.Handle(\"/\", r)\n        http.ListenAndServe(\":8000\", nil)\n    }\n</code></pre>\n"}, {"tags": ["arrays", "go"], "answers": [{"tags": [], "owner": {"reputation": 848, "user_id": 810870, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/43f6e9325bf6753da13c84dec8e86eb2?s=128&d=identicon&r=PG", "display_name": "Tamerz", "link": "https://stackoverflow.com/users/810870/tamerz"}, "is_accepted": false, "score": 0, "last_activity_date": 1485600801, "creation_date": 1485600801, "answer_id": 41908917, "question_id": 41908720, "link": "https://stackoverflow.com/questions/41908720/how-do-i-create-a-byte-array-from-a-mix-of-hex-and-strings-in-go/41908917#41908917", "title": "How do I create a byte array from a mix of hex and strings in Go?", "body": "<p>After a long time of working on this, I of course figure it out after I ask here...</p>\n\n<pre><code>message := []byte(\"\\xff\\xff\\xff\\xff\\x54Source Engine Query\\x00\")\n</code></pre>\n\n<p>This works perfect. I found it here:</p>\n\n<p><a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">https://blog.golang.org/strings</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1485602329, "creation_date": 1485602329, "answer_id": 41909153, "question_id": 41908720, "link": "https://stackoverflow.com/questions/41908720/how-do-i-create-a-byte-array-from-a-mix-of-hex-and-strings-in-go/41909153#41909153", "title": "How do I create a byte array from a mix of hex and strings in Go?", "body": "<p>It's also bytes.Buffer <a href=\"https://golang.org/pkg/bytes/#Buffer\" rel=\"nofollow noreferrer\">https://golang.org/pkg/bytes/#Buffer</a> among other approaches, quite fast and has couple of handy methods</p>\n\n<pre><code>message := bytes.NewBuffer([]byte{0xFF, 0xFF, 0xFF, 0xFF, 0x54})\nmessage.WriteString(\"Source Engine Query\")\nmessage.WriteByte(0x00)\nmessage.WriteTo(os.Stdout) //or write to some other io.Writer you want, say net.Conn\n</code></pre>\n"}], "owner": {"reputation": 848, "user_id": 810870, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/43f6e9325bf6753da13c84dec8e86eb2?s=128&d=identicon&r=PG", "display_name": "Tamerz", "link": "https://stackoverflow.com/users/810870/tamerz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1485602329, "creation_date": 1485599404, "question_id": 41908720, "link": "https://stackoverflow.com/questions/41908720/how-do-i-create-a-byte-array-from-a-mix-of-hex-and-strings-in-go", "title": "How do I create a byte array from a mix of hex and strings in Go?", "body": "<p>I'm trying to implement the data specified here:</p>\n\n<p><a href=\"https://developer.valvesoftware.com/wiki/Server_queries#Request_Format\" rel=\"nofollow noreferrer\">https://developer.valvesoftware.com/wiki/Server_queries#Request_Format</a></p>\n\n<p>I'm creating a byte array that needs to end up looking like this:</p>\n\n<pre><code>0xFF 0xFF 0xFF 0xFF 0x54 0x53 0x6F 0x75 0x72 0x63 0x65 0x20 0x45 0x6E 0x67 0x69 0x6E 0x65 0x20 0x51 0x75 0x65 0x72 0x79 0x00\n</code></pre>\n\n<p>Broken down, it is just some bytes in a header:</p>\n\n<pre><code>0xFF 0xFF 0xFF 0xFF 0x54\n</code></pre>\n\n<p>Then after that, the zero terminated string \"Source Engine Query\".</p>\n\n<p>I was able to get this to work in a very ugly fashion, but I know there has to be a cleaner path:</p>\n\n<pre><code>message := []byte(\"xxxxxSource Engine Queryx\")\nmessage[0] = 0xFF\nmessage[1] = 0xFF\nmessage[2] = 0xFF\nmessage[3] = 0xFF\nmessage[4] = 0x54\nmessage[24] = 0x00\n</code></pre>\n\n<p>I've tried using slices like this, but I can't figure out how to use it with non string values:</p>\n\n<pre><code>message := make([]byte, 25)\ncopy(message[5:], \"Source Engine Query\")\n</code></pre>\n\n<p>That works, but then I can't figure out how to add the \"0xFF 0xFF 0xFF 0xFF 0x54\" to the beginning.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 0, "creation_date": 1485603411, "post_id": 41908709, "comment_id": 71000027, "body": "I don&#39;t know the reason why it is implemented like this but it seems that they are checking <code>error</code> before <code>Stringer</code> in <code>fmt.Println()</code>: <a href=\"https://golang.org/src/fmt/print.go#L576\" rel=\"nofollow noreferrer\">golang.org/src/fmt/print.go#L576</a>"}, {"owner": {"reputation": 69, "user_id": 3831768, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MtLro.jpg?s=128&g=1", "display_name": "furusiyya", "link": "https://stackoverflow.com/users/3831768/furusiyya"}, "reply_to_user": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 0, "creation_date": 1485604179, "post_id": 41908709, "comment_id": 71000229, "body": "@ymonad exactly, it means no body could implement both interfaces at a time :)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1485605386, "post_id": 41908709, "comment_id": 71000559, "body": "@hackingNerd &quot;it means no body could implement both interfaces at a time&quot; this is plain wrong. Of course you can implement both interfaces. It&#39;s just that fmt.Printf chose to use <code>Error</code> first. But your type still implements both interfaces."}], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 7482686, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/106be849907e7d7a6640ab0bd6ce2303?s=128&d=identicon&r=PG", "display_name": "user7482686", "link": "https://stackoverflow.com/users/7482686/user7482686"}, "is_accepted": false, "score": 2, "last_activity_date": 1485605820, "creation_date": 1485605820, "answer_id": 41909689, "question_id": 41908709, "link": "https://stackoverflow.com/questions/41908709/how-to-implement-both-fmt-stringer-and-error-interface-on-a-type/41909689#41909689", "title": "How to implement both fmt.Stringer and error interface on a type?", "body": "<p>Not really a universal solution, but in certain situations one can use pointer vs non-pointer receivers to do the trick: <a href=\"https://play.golang.org/p/DY4Cq4efsT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/DY4Cq4efsT</a></p>\n"}], "owner": {"reputation": 69, "user_id": 3831768, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/MtLro.jpg?s=128&g=1", "display_name": "furusiyya", "link": "https://stackoverflow.com/users/3831768/furusiyya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1485605820, "creation_date": 1485599347, "question_id": 41908709, "link": "https://stackoverflow.com/questions/41908709/how-to-implement-both-fmt-stringer-and-error-interface-on-a-type", "title": "How to implement both fmt.Stringer and error interface on a type?", "body": "<p>As with <a href=\"https://tour.golang.org/methods/17\" rel=\"nofollow noreferrer\">fmt.Stringer</a>, the <code>fmt</code> package looks for the <a href=\"https://tour.golang.org/methods/19\" rel=\"nofollow noreferrer\">error interface</a> when printing values. In case if a <a href=\"https://play.golang.org/p/I-a5AbNl6k\" rel=\"nofollow noreferrer\">type</a> satisfies both interfaces, <code>fmt</code> only on look for <code>error</code> not <code>Stringer</code>. Why? How I could implement both <code>Stringer</code> and <code>error</code> on a type?  </p>\n"}, {"tags": ["go", "progress"], "answers": [{"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1485614008, "creation_date": 1485614008, "answer_id": 41910959, "question_id": 41908171, "link": "https://stackoverflow.com/questions/41908171/show-progress-while-processing-post-request-in-golang-webapp/41910959#41910959", "title": "Show Progress while processing post request in golang webapp", "body": "<p><code>w ResponseWriter</code> in your Handlers <code>func(w ResponseWriter,r *Request)</code> most likely implements <code>http.Flusher</code> interface. So you can</p>\n\n<pre><code>io.WriteString(w, \"Loading data (xyz conversion done)\")\nw.(http.Flusher).Flush() //you must assert it implements\nio.WriteString(w, payload)\n</code></pre>\n\n<p>flush to client before all work done.\nTo take more control you even can hijack connection</p>\n\n<pre><code>conn, bufrw, err :=w.(http.Hijacker).Hijack()\ndefer conn.Close()\nbufrw.WriteString(\"Loading data (xyz conversion done)\")\nbufrw.Flush()\nbufrw.WriteString(\"Loading data (xyz added to stream)\")\nbufrw.Flush()\n</code></pre>\n\n<p>and speak raw TCP.</p>\n"}, {"tags": [], "owner": {"reputation": 7118, "user_id": 4283005, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/N0m1E.png?s=128&g=1", "display_name": "dev.bmax", "link": "https://stackoverflow.com/users/4283005/dev-bmax"}, "is_accepted": false, "score": 0, "last_activity_date": 1485865374, "creation_date": 1485865374, "answer_id": 41957504, "question_id": 41908171, "link": "https://stackoverflow.com/questions/41908171/show-progress-while-processing-post-request-in-golang-webapp/41957504#41957504", "title": "Show Progress while processing post request in golang webapp", "body": "<p>Showing a progress indicator is the job of your client-side code (while making an asynchronous call).</p>\n\n<p>HTTP is a request\u2013response protocol. Responses have a standard format (including a status line, headers, message body). They are not sent in parts.</p>\n\n<p>What you are suggesting would be relevant to a TCP connection but not HTTP.</p>\n"}], "owner": {"reputation": 1589, "user_id": 7205620, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/d192b6e443c87744c05a745b951f8fde?s=128&d=identicon&r=PG&f=1", "display_name": "Krash", "link": "https://stackoverflow.com/users/7205620/krash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 698, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1485865374, "creation_date": 1485595379, "last_edit_date": 1485598575, "question_id": 41908171, "link": "https://stackoverflow.com/questions/41908171/show-progress-while-processing-post-request-in-golang-webapp", "title": "Show Progress while processing post request in golang webapp", "body": "<p>On receiving the post request, the posted data passes through several functions and when the processing is done, it displays a suitable web page. The problem is that there is a bit of delay since the functions for processing data are somewhat time taking. </p>\n\n<p>Is there a way I can show clients the progress of data processing? Essentially, when a data is posted, I want some messages to be dislayed like </p>\n\n<pre><code>Loading data (xyz conversion done)\nLoading data (xyz added to stream)\n</code></pre>\n\n<p>I am using golang for my backend and julienschmidt's httprouter . </p>\n"}, {"tags": ["go", "filenames", "multipart", "enctype"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1485595189, "post_id": 41908120, "comment_id": 70998041, "body": "Thats what you&#39;re doing with your code."}, {"owner": {"reputation": 97, "user_id": 3809560, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4221ab68448e9413c315147180574ac0?s=128&d=identicon&r=PG&f=1", "display_name": "user3809560", "link": "https://stackoverflow.com/users/3809560/user3809560"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1485599843, "post_id": 41908120, "comment_id": 70999133, "body": "am getting the invalid memory address or nil pointer dereference error though"}, {"owner": {"reputation": 97, "user_id": 3809560, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4221ab68448e9413c315147180574ac0?s=128&d=identicon&r=PG&f=1", "display_name": "user3809560", "link": "https://stackoverflow.com/users/3809560/user3809560"}, "reply_to_user": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1485622164, "post_id": 41908120, "comment_id": 71005802, "body": "Value of filename (pimage) is printed out correctly to the terminal. However I get the error. When I directly assign a string value to the struct field (image) there are no errors. Have tried converting the filename to string, but that doesn&#39;t work either."}], "answers": [{"comments": [{"owner": {"reputation": 97, "user_id": 3809560, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4221ab68448e9413c315147180574ac0?s=128&d=identicon&r=PG&f=1", "display_name": "user3809560", "link": "https://stackoverflow.com/users/3809560/user3809560"}, "edited": false, "score": 0, "creation_date": 1485681325, "post_id": 41914615, "comment_id": 71019613, "body": "I am using the govalidator package to validate the struct fields. Filenames with extensions would fail the validation for the alpha and alphanum validator tags and subsequently the error would get generated. I made some changes to escape those validation checks and the code works."}], "tags": [], "owner": {"reputation": 111, "user_id": 7471377, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KQzmZ.jpg?s=128&g=1", "display_name": "Michael Pettigrew", "link": "https://stackoverflow.com/users/7471377/michael-pettigrew"}, "is_accepted": true, "score": 0, "last_activity_date": 1485636090, "creation_date": 1485636090, "answer_id": 41914615, "question_id": 41908120, "link": "https://stackoverflow.com/questions/41908120/pass-filename-of-the-file-selected-for-upload-using-enctype-multipart-form-data/41914615#41914615", "title": "Pass filename of the file selected for upload using enctype=&quot;multipart/form-data&quot; to a struct field in Golang", "body": "<p>Instead of calling <code>r.FormFile()</code>, you could instead try:</p>\n\n<pre><code>mpr, _ := r.MultipartReader()\nfilePart, _ := r.NextPart()\nfileName := filePart.FileName()\n</code></pre>\n\n<p>However, I would check the errors :)</p>\n"}], "owner": {"reputation": 97, "user_id": 3809560, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4221ab68448e9413c315147180574ac0?s=128&d=identicon&r=PG&f=1", "display_name": "user3809560", "link": "https://stackoverflow.com/users/3809560/user3809560"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 41914615, "answer_count": 1, "score": 1, "last_activity_date": 1485636090, "creation_date": 1485594943, "question_id": 41908120, "link": "https://stackoverflow.com/questions/41908120/pass-filename-of-the-file-selected-for-upload-using-enctype-multipart-form-data", "title": "Pass filename of the file selected for upload using enctype=&quot;multipart/form-data&quot; to a struct field in Golang", "body": "<p>My application uses the html code snippet for the form to upload a file</p>\n\n<pre><code>&lt;form  method=\"POST\" action=\"/addproduct\" enctype=\"multipart/form-data\"&gt;\n        &lt;label class=\"form-control-label\" for=\"productimage\"&gt;&lt;/label&gt;\n        {{with .Errors.image}}\n        &lt;div class=\"alert alert-danger\"&gt;\n            {{.}}\n        &lt;/div&gt;\n        {{end}}     \n\n        &lt;input type=\"file\" name=\"productimage\" id = \"productimage\" multiple=\"multiple\" class = \"btn btn-danger\"&gt;\n\n        &lt;input type=\"submit\" name=\"submit\" value=\"Submit\" class = \"btn btn-info\"&gt;\n    &lt;/form&gt;\n</code></pre>\n\n<p>I need to grab the filename of the uploaded file and pass it to a struct field in Golang.</p>\n\n<pre><code>    file, header, err := r.FormFile(\"productimage\")\n    defer file.Close()\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n    var pimage = header.Filename \n\np := &amp;Product{\n    Puid:     Puid(),\n    Pname:    r.FormValue(\"productName\"),\n    Quantity: r.FormValue(\"quantity\"),\n    Price:    r.FormValue(\"price\"),\n    Image:    pimage,\n}\n</code></pre>\n\n<p>I am trying to pass the name of the file selected for uploaded to 'image' field of the struct 'Product'. Any suggestions on how this can be done?</p>\n"}, {"tags": ["javascript", "python", "c", "go", "escape-analysis"], "comments": [{"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 0, "creation_date": 1485595484, "post_id": 41907662, "comment_id": 70998110, "body": "Note that not all languages behave like C. In a lot of languages like javascript and lisp a closure is actually part of the stack. Only that the stack for the language is not implemented in the &quot;stack&quot; in the C sense but rather the stack is implemented as a linked list - which means that the stack in some languages is implemented in the heap. Javascript implementations may either implement the classic functional linked-list stack or some sort of closure discovery mechanism to capture enclosed free variables. Both behave the same."}, {"owner": {"reputation": 92307, "user_id": 167735, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5deb8de031f80c23f19e9b6d389e5afe?s=128&d=identicon&r=PG", "display_name": "slebetman", "link": "https://stackoverflow.com/users/167735/slebetman"}, "edited": false, "score": 0, "creation_date": 1485595654, "post_id": 41907662, "comment_id": 70998136, "body": "Here&#39;s one good series of articles about writing a Ruby interpreter in Ruby that explains the traditional implementation of closures in functional languages: <a href=\"http://hokstad.com/how-to-implement-closures\" rel=\"nofollow noreferrer\">hokstad.com/how-to-implement-closures</a>. Note his explanation <code>Instead of a traditional stack, put activation frames (arguments and local variables) for function&#47;method calls on the heap, as a linked list</code> -- he&#39;s implementing the stack for his interpreter in the heap"}], "answers": [{"tags": [], "owner": {"reputation": 466742, "user_id": 224671, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/c90de868a7e95d75bdfd6a906dfedac7?s=128&d=identicon&r=PG", "display_name": "kennytm", "link": "https://stackoverflow.com/users/224671/kennytm"}, "is_accepted": false, "score": 12, "last_activity_date": 1485614114, "last_edit_date": 1485614114, "creation_date": 1485593376, "answer_id": 41907923, "question_id": 41907662, "link": "https://stackoverflow.com/questions/41907662/escape-analysis/41907923#41907923", "title": "Escape analysis", "body": "<p>In Go, you are supposed to trust the compiler to make the best decision. It will allocate memory on the stack if possible. See also <a href=\"https://golang.org/doc/faq#stack_or_heap\" rel=\"noreferrer\">the FAQ</a>:</p>\n\n<blockquote>\n  <p>From a correctness standpoint, you don't need to know. Each variable in Go exists as long as there are references to it. The storage location chosen by the implementation is irrelevant to the semantics of the language.</p>\n  \n  <p>The storage location does have an effect on writing efficient programs. When possible, the Go compilers will allocate variables that are local to a function in that function's stack frame. However, if the compiler cannot prove that the variable is not referenced after the function returns, then the compiler must allocate the variable on the garbage-collected heap to avoid dangling pointer errors. Also, if a local variable is very large, it might make more sense to store it on the heap rather than the stack.</p>\n  \n  <p>In the current compilers, if a variable has its address taken, that variable is a candidate for allocation on the heap. However, a basic escape analysis recognizes some cases when such variables will not live past the return from the function and can reside on the stack. </p>\n</blockquote>\n\n<hr>\n\n<p>Without optimization (inlining), <strong>yes <code>a</code> will be allocated in the heap</strong>. We can check the escape analysis by passing <code>-gcflags='-m'</code> (<a href=\"https://play.golang.org/p/l3cZFK5QHO\" rel=\"noreferrer\">https://play.golang.org/p/l3cZFK5QHO</a>):</p>\n\n<pre><code>$ nl -ba 1.go\n     1  package main\n     2  \n     3  func inlined() []int {\n     4      var a [5]int\n     5      return a[:]\n     6  }\n     7  \n     8  //go:noinline\n     9  func no_inline() []int {\n    10      var b [5]int\n    11      return b[:]\n    12  }\n    13  \n    14  func main() {\n    15      var local_array [5]int\n    16      var local_var int\n    17      println(no_inline())\n    18      println(inlined())\n    19      println(local_array[:])\n    20      println(&amp;local_var)\n    21  }\n</code></pre>\n\n\n\n<pre><code>$ go build -gcflags='-m' 1.go\n# command-line-arguments\n./1.go:3: can inline inlined\n./1.go:18: inlining call to inlined\n./1.go:5: a escapes to heap\n./1.go:4: moved to heap: a\n./1.go:11: b escapes to heap\n./1.go:10: moved to heap: b\n./1.go:18: main a does not escape\n./1.go:19: main local_array does not escape\n./1.go:20: main &amp;local_var does not escape\n</code></pre>\n\n<p>We see that the compiler decided to allocate <code>inlined.a</code> on line 5 and <code>no_inline.b</code> on line 10 on the heap, because they both escape their scope.</p>\n\n<p>However, after inlining, the compiler noticed that the <code>a</code> does not escape any more, so it determines the variable can be allocated on the stack again (line 18). </p>\n\n<p>The result is that the variable <code>a</code> is allocated on the <code>main</code> goroutine's stack, while the variable <code>b</code> is allocated on the heap. As we can see from the output, the address of <code>b</code> is on 0x1043xxxx while all other are on 0x1042xxxx.</p>\n\n<pre><code>$ ./1\n[5/5]0x10432020\n[5/5]0x10429f58\n[5/5]0x10429f44\n0x10429f40\n</code></pre>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1468, "favorite_count": 4, "answer_count": 1, "score": 5, "last_activity_date": 1566229368, "creation_date": 1485590901, "last_edit_date": 1566229368, "question_id": 41907662, "link": "https://stackoverflow.com/questions/41907662/escape-analysis", "title": "Escape analysis", "body": "<p>In many languages, local variables are located in call stack</p>\n\n<p>In JavaScript/Python, only <em>closure</em> variables are located in heap, because they  must live beyond the function calls, they are created.</p>\n\n<hr>\n\n<p>In GO, some GO types(like slice type <code>[]int</code>) do reference other parts of memory, like JavaScript/Python.</p>\n\n<p>In GO, not all types of variables hold references, like Javascript/Python.</p>\n\n<p>For example,  </p>\n\n<p>1) <code>[3]int</code> type variable <code>b</code> directly stores an array of <code>int</code>'s, like C, except that C allows to get access of each array element location using C syntax <code>&amp;b[index]</code>, for more control</p>\n\n<p>2) <code>int</code> type variable <code>c</code> directly stores an <code>int</code> value, like C, except that, C gives more control by providing syntax(<code>&amp;c</code>) to get location access.</p>\n\n<hr>\n\n<p>In GO, my understanding is, for local variables to be on heap/stack depends on applying compiler's <strong>escape analysis</strong> in example code(below),</p>\n\n<pre><code>func foo() []int {\n  // the array lives beyond the call to foo in which it is created\n  var a [5]int\n  return a[:] // range operator\n}\n</code></pre>\n\n<p>that tells the compiler that variable <code>a</code> lives beyond its scope, so allocate in heap, but not stack.</p>\n\n<hr>\n\n<p>Question:</p>\n\n<p>Does the variable <code>a</code> get allocated in heap?</p>\n"}, {"tags": ["mongodb", "go", "struct", "time", "mgo"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1487593928, "last_edit_date": 1495540924, "creation_date": 1487592646, "answer_id": 42344267, "question_id": 41907619, "link": "https://stackoverflow.com/questions/41907619/set-default-date-when-inserting-document-with-time-time-field/42344267#42344267", "title": "Set default date when inserting document with time.Time field", "body": "<p>In Go you can't define default values for fields, they will always be the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">zero-value</a> of their type when a new struct value is created (unless you use a <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">composite literal</a> where you can give a different value explicitly).</p>\n\n<p>So one option would be to create a constructor-like function <code>NewUser()</code> which would set this field, and use always this function to create new users:</p>\n\n<pre><code>func NewUser() *User {\n    return &amp;User{\n        CreatedAt: time.Now(),\n    }\n}\n</code></pre>\n\n<p>Of course this can't be forced, and also this will hold the timestamp of the <code>User</code> struct value creation and not when it is saved.</p>\n\n<p>Another, better approach is to use a custom marshaling logic.</p>\n\n<p>You can write custom marshaling logic by implementing <a href=\"https://godoc.org/gopkg.in/mgo.v2/bson#Getter\" rel=\"nofollow noreferrer\"><code>bson.Getter</code></a>. <code>GetBSON()</code> is responsible to provide a value that will actually be saved. We want the same <code>User</code> instance to be saved, just its <code>CreatedAt</code> field set prior:</p>\n\n<pre><code>type User struct {\n    CreatedAt time.Time `json:\"created_at\" bson:\"created_at\"`\n}\n\nfunc (u *User) GetBSON() (interface{}, error) {\n    u.CreatedAt = time.Now()\n    type my *User\n    return my(u), nil\n}\n</code></pre>\n\n<p>Note that a new <code>my</code> type is created and returned. The reason for this is to avoid stack overflow. Simply returning a value of type <code>*User</code> is bad, because it implements <code>bson.Getter</code>, so <code>GetBSON()</code> would get called endlessly. The new <code>my</code> type does not have this method, so endless \"recursion\" does not happen (the <code>type</code> keyword creates a new type, and it does not \"inherit\" methods of the underlying type).</p>\n\n<p>Note that this solution will also overwrite (re-set) the <code>CreatedAt</code> field) even if you just want to re-save a <code>User</code>. So we should add a check whether the <code>CreatedAt</code> field is filled, and only set it if it's the zero value:</p>\n\n<pre><code>func (u *User) GetBSON() (interface{}, error) {\n    if u.CreatedAt.IsZero() {\n        u.CreatedAt = time.Now()\n    }\n    type my *User\n    return my(u), nil\n}\n</code></pre>\n\n<p>Also see related / similar question: <a href=\"https://stackoverflow.com/questions/42342943/accesing-mongodb-from-go/42343810#42343810\">Accesing MongoDB from Go</a></p>\n"}], "owner": {"reputation": 6874, "user_id": 871956, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/ebeccdf48d0d949a8ae5ea51c1366be0?s=128&d=identicon&r=PG", "display_name": "borislemke", "link": "https://stackoverflow.com/users/871956/borislemke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2000, "favorite_count": 1, "accepted_answer_id": 42344267, "answer_count": 1, "score": 3, "last_activity_date": 1527758407, "creation_date": 1485590524, "last_edit_date": 1527758407, "question_id": 41907619, "link": "https://stackoverflow.com/questions/41907619/set-default-date-when-inserting-document-with-time-time-field", "title": "Set default date when inserting document with time.Time field", "body": "<p>In <code>mongoose</code>(<code>node.js</code>) I can define a model schema with a default <code>Date.now</code> like so:</p>\n\n<pre><code>...\ntype: Date,\ndefault: Date.now\n...\n</code></pre>\n\n<p>How do I achieve the same without having to insert the <code>time.Time</code> every time I create a document with <code>mgo</code>?</p>\n\n<pre><code>type User struct {\n    CreatedAt   time.Time `json:\"created_at\" bson:\"created_at\"` // Make this field filled automatically with time.Now() every time a document of this `struct` is inserted\n}\n</code></pre>\n"}, {"tags": ["arrays", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485586878, "post_id": 41907208, "comment_id": 70996264, "body": "When you say, single slice with 5 elements, Does that imply, each element is also a slice?"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485587012, "post_id": 41907208, "comment_id": 70996293, "body": "Each element is an array of 3 strings, <code>[3]string</code>."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485587464, "post_id": 41907208, "comment_id": 70996377, "body": "<code>b</code> is single slice with 5 elements, where each element(say <code>b[0]</code>) points to memory of type <code>[3]string</code>. Does that mean, <b>##1)</b> type of element(<code>b[0]</code>) is <code>[]string</code> or <b>##2)</b> <code>b[0]</code> is a slice of type <code>[]string</code> pointing to memory of type <code>[3]string</code>?"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "reply_to_user": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485587802, "post_id": 41907208, "comment_id": 70996438, "body": "If <code>b</code> is a <code>[][3]string</code> then <code>b[0]</code> is a <code>[3]string</code> and <code>b[0][0]</code> is a <code>string</code>."}, {"owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "edited": false, "score": 0, "creation_date": 1485588213, "post_id": 41907208, "comment_id": 70996523, "body": "OK. As <code>b[0]</code> is of type <code>[3]string</code>, <code>b[0]</code> is not a slice"}], "tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": true, "score": 2, "last_activity_date": 1485586925, "last_edit_date": 1485586925, "creation_date": 1485586758, "answer_id": 41907208, "question_id": 41907150, "link": "https://stackoverflow.com/questions/41907150/array-of-slices-go/41907208#41907208", "title": "Array of slices - GO", "body": "<blockquote>\n  <p>1) Considering the syntax,</p>\n\n<pre><code>a = make([][3]string, 5)\n</code></pre>\n  \n  <p>Is it 5 slices, where each slice(a[0]) is array of 3 strings?</p>\n  \n  <p>or</p>\n  \n  <p>Is it a single slice(a) pointing to 5 arrays of 3 strings each?</p>\n</blockquote>\n\n<p>Its a single slice with 5 elements where each element is an array of 3 strings.</p>\n\n<blockquote>\n  <p>2)</p>\n  \n  <p>How do I know the type of an element? slice or array?</p>\n</blockquote>\n\n<p>Slices and arrays are different types. You can not interchangeably assign arrays and slices to the same variable, hence if the declaration declares it as an array, its an array, if it declares it as a slice, its a slice. If it has a <em>number</em> in the brackets (<code>[5]string</code>) its an array, if the brackets are empty (<code>[]string</code>) its a slice.</p>\n\n<blockquote>\n  <p>2) For slice declaration,</p>\n\n<pre><code>var b [][3][6]string\n</code></pre>\n  \n  <p>creates a single slice(b) that points to 3 arrays of 6 strings each,\n  where len(b) = 3 and cap(b) =3</p>\n\n<pre><code>b = make([][3][6]string, 5)\n</code></pre>\n  \n  <p>creates 5 slices, where each slice(say b[0]) points to 3 arrays of 6 strings each</p>\n</blockquote>\n\n<p>No. Former code just declares a variable, it doesn't hold a slice yet. Latter code creates <em>one</em> slice with <em>five</em> elements.</p>\n"}, {"tags": [], "owner": {"reputation": 103812, "user_id": 320726, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/02041b18199678d1f02e6d5040dbb907?s=128&d=identicon&r=PG", "display_name": "6502", "link": "https://stackoverflow.com/users/320726/6502"}, "is_accepted": false, "score": 3, "last_activity_date": 1485590794, "creation_date": 1485590794, "answer_id": 41907646, "question_id": 41907150, "link": "https://stackoverflow.com/questions/41907150/array-of-slices-go/41907646#41907646", "title": "Array of slices - GO", "body": "<p>Slices and arrays are two different types: an array in memory is a contiguous sequences of values of the same type. In Go a type has a fixed size. The very same concept is present for example in C++ and</p>\n\n<pre><code>int x[5]; // C and C++\nx [5]int  // Go\n</code></pre>\n\n<p>are basically the same thing (not 100% the same because arrays in C and C++ are \"second class citizens\" and behave strangely in a few places, Go is more uniform on that).</p>\n\n<p>A slice in Go is instead a \"view\" of a portion of an array, and is more or less equivalent to a C++ structure with a pointer to the first element, a number of used elements (relative to first) and a number of available elements (relative to first)</p>\n\n<pre><code>// C++\ntemplate&lt;typename T&gt;\nstruct Slice {\n    T *first;\n    int size, capacity;\n};\nSlice&lt;int&gt; x{nullptr, 0, 0};\n\n// Go\nvar x []int\n</code></pre>\n\n<p>The <code>Make</code> special function is able to create slices associated to newly created arrays, given size and optional capacity:</p>\n\n<pre><code>// C++\ntemplate&lt;typename T&gt;\nSlice&lt;T&gt; make(int size, int capacity=-1) {\n    if (capacity == -1) capacity = size;\n    return Slice&lt;T&gt;{new T[capacity], size, capacity};\n}\n\n// Go\nx := Make([]int, size, capacity)\n</code></pre>\n\n<p>Slices can be efficiently passed around in O(1) (independently on size/capacity) and you can also take a sub-slice of a slice in O(1)... note that Go is garbage collected, doing the same in C++ would require some extra work (for example also keeping a pointer to the original array object and its size in the slice).</p>\n\n<p>You can of course have arrays of slices, slices of slices, slices of arrays and arrays of arrays. Note however that in Go <code>Make</code> is used only to create slices (and maps) not for arrays...</p>\n\n<pre><code>x := Make([][2]int, 3)   // a slice of 3 arrays of 2 ints each\n\n// Same thing (except for content)\ny := [][2]int{[2]int{1, 2},\n              [2]int{3, 4},\n              [2]int{5, 6}}\n\n// An array of 3 slices of two ints each\nz := [3][]int{[]int{1, 2},\n              []int{3, 4},\n              []int{5, 6}}\n</code></pre>\n\n<p>While for example both <code>y</code> and <code>z</code> <a href=\"https://play.golang.org/p/aTb0laOg__\" rel=\"nofollow noreferrer\">in the playground</a> would look the same <code>[[1, 2], [3, 4], [5, 6]]</code> when using <code>fmt.Println</code>, they are very different types, for example you can add a new pair to <code>y</code> with</p>\n\n<pre><code>y = append(y, [2]int{7, 8})  // now [[1, 2], [3, 4], [5, 6], [7, 8]]\n</code></pre>\n\n<p>and you can instead increase the length of first element of <code>z</code> with</p>\n\n<pre><code>z[0] = append(z[0], 99) // now [[1, 2, 99], [3, 4], [5, 6]]\n</code></pre>\n\n<p>but you cannot add new elements to <code>z</code> (it's an array) and you cannot extend an element of <code>y</code> (because elements are arrays)</p>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 686, "favorite_count": 0, "accepted_answer_id": 41907208, "answer_count": 2, "score": 3, "last_activity_date": 1485590794, "creation_date": 1485586164, "last_edit_date": 1485586765, "question_id": 41907150, "link": "https://stackoverflow.com/questions/41907150/array-of-slices-go", "title": "Array of slices - GO", "body": "<p>1)</p>\n\n<p>For below slice declaration,</p>\n\n<pre><code>var a [][3]string\n</code></pre>\n\n<p>creates a single slice(<code>a</code>) that points to array of 3 strings, <code>len(a) = 3</code> and <code>cap(a) =3</code> but not <code>cap(a) &gt;= 3</code></p>\n\n<pre><code>a = make([][3]string, 5)\n</code></pre>\n\n<p>creates 5 slices, where each slice(say <code>a[0]</code>) points to array of 3 strings, <code>len(a[0]) = 3</code> and <code>cap(a[0]) = 3</code></p>\n\n<hr>\n\n<p>2)</p>\n\n<p>For slice declaration,</p>\n\n<pre><code>var b [][3][6]string\n</code></pre>\n\n<p>creates a single slice(<code>b</code>) that points to 3 arrays of 6 strings each, where <code>len(b) = 3</code> and <code>cap(b) =3</code></p>\n\n<pre><code>b = make([][3][6]string, 5)\n</code></pre>\n\n<p>creates 5 slices, where each slice(say <code>b[0]</code>) points to 3 arrays of 6 strings each</p>\n\n<hr>\n\n<p>In both cases, after making slices, I said, <em>creates 5 slices,</em></p>\n\n<hr>\n\n<p>Considering the syntax, below are my two questions,</p>\n\n<pre><code>a = make([][3]string, 5)\n</code></pre>\n\n<p><strong>My question:</strong></p>\n\n<p>1)</p>\n\n<p>Is it 5 slices, where each slice(<code>a[0]</code>) is array of 3 strings?</p>\n\n<p>or</p>\n\n<p>Is it a single slice(<code>a</code>) pointing to 5 arrays of 3 strings each?</p>\n\n<p>2)</p>\n\n<p>How do I know the type of an element? slice or array?</p>\n\n<p><em>1) In such scenarios, \"array of\" terminology has to be cautiously used.</em></p>\n\n<p><em>2) There are no implicit pointers involved in GO unlike C</em></p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1485605519, "post_id": 41906439, "comment_id": 71000594, "body": "You may want to work through the &quot;Tour of Go&quot; (tour.golang.org), especially the slice parts."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 1, "last_activity_date": 1485582770, "last_edit_date": 1495541807, "creation_date": 1485582770, "answer_id": 41906802, "question_id": 41906439, "link": "https://stackoverflow.com/questions/41906439/how-slice-works-in-go/41906802#41906802", "title": "How slice works in GO?", "body": "<p>As I mentioned \"<a href=\"https://stackoverflow.com/a/25544086/6309\">Declare slice or make slice?</a>\",  the zero value of a slice (nil) acts like a zero-length slice.</p>\n\n<p>So you can append to <code>a []int</code> directly.</p>\n\n<p>You would need to make a slice (<code>make([]int, 0)</code> ) only if you wanted to potentially return an empty slice (instead of <code>nil</code>).<br>\nIf not, no need to allocate memory before starting appending.<br>\nSee also \"<a href=\"https://blog.golang.org/slices#TOC_11.\" rel=\"nofollow noreferrer\">Arrays, slices (and strings): The mechanics of 'append': Nil</a>\"</p>\n\n<blockquote>\n  <p>a nil slice is functionally equivalent to a zero-length slice, even though it points to nothing. It has length zero and can be appended to, with allocation. </p>\n</blockquote>\n"}], "owner": {"reputation": 11490, "user_id": 3317808, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/6c8272382fcd9841919bc1f8709d25a0?s=128&d=identicon&r=PG&f=1", "display_name": "overexchange", "link": "https://stackoverflow.com/users/3317808/overexchange"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1485582770, "creation_date": 1485578994, "last_edit_date": 1485579699, "question_id": 41906439, "link": "https://stackoverflow.com/questions/41906439/how-slice-works-in-go", "title": "How slice works in GO?", "body": "<pre><code>a = make([]int, 7, 15)\n</code></pre>\n\n<p>creates implicit array of size <code>15</code> and slice(<code>a</code>) creates a shallow copy of implicit array and points to first 7 elements in array.</p>\n\n<p>Consider,</p>\n\n<pre><code>var a []int;\n</code></pre>\n\n<p>creates a zero length slice that does not point to any implicit array.</p>\n\n<pre><code>a = append(a, 9, 86);\n</code></pre>\n\n<p>creates new implicit array of length 2 and append values <code>9</code> and <code>86</code>. slice(<code>a</code>) points to that new implicit array, where</p>\n\n<p><code>len(a) is 2</code> and <code>cap(a) &gt;= 2</code></p>\n\n<hr>\n\n<p>My question:</p>\n\n<p>is this the correct understanding?</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1485620562, "last_edit_date": 1592644375, "creation_date": 1485583242, "answer_id": 41906859, "question_id": 41906357, "link": "https://stackoverflow.com/questions/41906357/why-are-goroutines-much-cheaper-than-threads-in-other-languages/41906859#41906859", "title": "Why are goroutines much cheaper than threads in other languages?", "body": "<p>See &quot;<a href=\"http://blog.nindalf.com/how-goroutines-work/\" rel=\"nofollow noreferrer\">How goroutines work</a>&quot;.<br />\nThey are cheaper in:</p>\n<ul>\n<li>memory consumption:<br />\nA thread starts with a large memory as opposed to a few Kb.</li>\n<li>Setup and teardown costs<br />\n(That is why you have to maintain a pool of thread)</li>\n<li>Switching costs<br />\nThreads are scheduled preemptively, and during a thread switch, the scheduler needs to save/restore ALL registers.<br />\nAs opposed to Go where the  the runtime manages the goroutines throughout from creation to scheduling to teardown. And the number of registers to save is lower.</li>\n</ul>\n<p>Plus, as mentioned in &quot;<a href=\"https://blog.twitch.tv/gos-march-to-low-latency-gc-a6fa96f06eb7#.pufgzt9hw\" rel=\"nofollow noreferrer\">Go\u2019s march to low-latency GC</a>&quot;, a GC is easier to implement when the runtime is in charge of managing goroutines:</p>\n<blockquote>\n<p>Since the introduction of its concurrent GC in Go 1.5, the runtime has kept track of whether a goroutine has executed since its stack was last scanned. The mark termination phase would check each goroutine to see whether it had recently run, and would rescan the few that had.</p>\n<p>In Go 1.7, the runtime maintains a separate short list of such goroutines. This removes the need to look through the entire list of goroutines while user code is paused, and greatly reduces the number of memory accesses that can trigger the kernel\u2019s NUMA-related memory migration code.</p>\n</blockquote>\n"}], "owner": {"reputation": 3023, "user_id": 789774, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/GrpmL.png?s=128&g=1", "display_name": "aamir", "link": "https://stackoverflow.com/users/789774/aamir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1213, "favorite_count": 1, "answer_count": 1, "score": 6, "last_activity_date": 1485620562, "creation_date": 1485577968, "last_edit_date": 1485584359, "question_id": 41906357, "link": "https://stackoverflow.com/questions/41906357/why-are-goroutines-much-cheaper-than-threads-in-other-languages", "title": "Why are goroutines much cheaper than threads in other languages?", "body": "<p>In his talk - <a href=\"https://blog.golang.org/concurrency-is-not-parallelism\" rel=\"nofollow noreferrer\">https://blog.golang.org/concurrency-is-not-parallelism</a>, Rob Pike says that go routines are similar to threads but much much cheaper. Can someone explain why?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "edited": false, "score": 3, "creation_date": 1485578152, "post_id": 41906336, "comment_id": 70994921, "body": "I understand how buffered channels work. My question was more on the lines of why they were designed to have a limited buffer as opposed to a dynamically sized buffer. IMO It makes more sense to let them hold unlimited values without blocking if using buffered channels"}], "tags": [], "owner": {"reputation": 295, "user_id": 7481642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7e679a06a283ec28824fe8213acbbe9?s=128&d=identicon&r=PG&f=1", "display_name": "bender", "link": "https://stackoverflow.com/users/7481642/bender"}, "is_accepted": false, "score": -4, "last_activity_date": 1485577800, "creation_date": 1485577800, "answer_id": 41906336, "question_id": 41906146, "link": "https://stackoverflow.com/questions/41906146/why-go-channels-limit-the-buffer-size/41906336#41906336", "title": "Why Go channels limit the buffer size", "body": "<p>The buffer size is the number of elements that can be sent to the channel without the send blocking. By default, a channel has a buffer size of 0 (you get this with make(chan int)). This means that every single send will block until another goroutine receives from the channel. A channel of buffer size 1 can hold 1 element until sending blocks, so you'd get</p>\n\n<pre><code>c := make(chan int, 1)\nc &lt;- 1 // doesn't block\nc &lt;- 2 // blocks until another goroutine receives from the channel\n</code></pre>\n\n<p>I suggest you to look this for more clarification:\n <a href=\"https://rogpeppe.wordpress.com/2010/02/10/unlimited-buffering-with-low-overhead/\" rel=\"nofollow noreferrer\">https://rogpeppe.wordpress.com/2010/02/10/unlimited-buffering-with-low-overhead/</a>\n <a href=\"http://openmymind.net/Introduction-To-Go-Buffered-Channels/\" rel=\"nofollow noreferrer\">http://openmymind.net/Introduction-To-Go-Buffered-Channels/</a></p>\n"}, {"tags": [], "owner": {"reputation": 12763, "user_id": 1097065, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e26becbd681062e6da684a000c6b03ea?s=128&d=identicon&r=PG", "display_name": "andybalholm", "link": "https://stackoverflow.com/users/1097065/andybalholm"}, "is_accepted": false, "score": 17, "last_activity_date": 1485579581, "creation_date": 1485579581, "answer_id": 41906488, "question_id": 41906146, "link": "https://stackoverflow.com/questions/41906146/why-go-channels-limit-the-buffer-size/41906488#41906488", "title": "Why Go channels limit the buffer size", "body": "<p>If one component of a program can't keep up with its input, it needs to put back-pressure on the rest of the system, rather than letting it run ahead and generate gigabytes of data that will never get processed because the system ran out of memory and crashed.</p>\n\n<p>There is really no such thing as an unlimited buffer, because machines have limits on what they can handle. Go requires you to specify a size for buffered channels so that you will think about what size buffer your program actually needs and can handle. If it really needs a billion items, and can handle them, you can create a channel that big. But in most cases a buffer size of 0 or 1 is actually what is needed.</p>\n"}, {"tags": [], "owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "is_accepted": false, "score": 0, "last_activity_date": 1612736296, "creation_date": 1612736296, "answer_id": 66093691, "question_id": 41906146, "link": "https://stackoverflow.com/questions/41906146/why-go-channels-limit-the-buffer-size/66093691#66093691", "title": "Why Go channels limit the buffer size", "body": "<p>This is because Channels are designed for efficient communication between concurrent goroutines, but the need you have is something different: the fact you are blocking denotes that the recipient is not attending the work queue, and &quot;dynamic&quot; is rarely free.</p>\n<p>There are a variety of different patterns and algorithms you can use to solve the problem you have: you could change your channel to accept arrays of ints, you could add additional goroutines to better balance or filter work. Or you could implement your own dynamic channel. Doing so is certainly a useful exercise for seeing why dynamic channels aren't a great way to build concurrency.</p>\n<pre><code>package main\n\nimport &quot;fmt&quot;\n\nfunc dynamicChannel(initial int) (chan &lt;- interface{}, &lt;- chan interface{}) {\n    in := make(chan interface{}, initial)\n    out := make(chan interface{}, initial)\n    go func () {\n        defer close(out)\n        buffer := make([]interface{}, 0, initial)\n    loop:\n        for {\n            packet, ok := &lt;- in\n            if !ok {\n                break loop\n            }\n            select {\n            case out &lt;- packet:\n                continue\n            default:\n            }\n            buffer = append(buffer, packet)\n            for len(buffer) &gt; 0 {\n                select {\n                case packet, ok := &lt;-in:\n                    if !ok {\n                        break loop\n                    }\n                    buffer = append(buffer, packet)\n\n                case out &lt;- buffer[0]:\n                    buffer = buffer[1:]\n                }\n            }\n        }\n        for len(buffer) &gt; 0 {\n            out &lt;- buffer[0]\n            buffer = buffer[1:]\n        }\n    } ()\n\n    return in, out\n}\n\n\nfunc main() {\n    in, out := dynamicChannel(4)\n\n    in &lt;- 10\n    fmt.Println(&lt;-out)\n\n    in &lt;- 20\n    in &lt;- 30\n\n    fmt.Println(&lt;-out)\n    fmt.Println(&lt;-out)\n\n    for i := 100; i &lt; 120; i++ {\n        in &lt;- i\n    }\n    fmt.Println(&quot;queued 100-120&quot;)\n    fmt.Println(&lt;-out)\n    close(in)\n    fmt.Println(&quot;in closed&quot;)\n    for i := range out {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n<p>Generally, if you are blocking, it indicates your concurrency is not well balanced. Consider a different strategy. For example, a simple tool to look for files with a matching .checksum file and then check the hashes:</p>\n<pre><code>func crawl(toplevel string, workQ chan &lt;- string) {\n  defer close(workQ)\n  for _, path := filepath.Walk(toplevel, func (path string, info os.FileInfo, err error) error {\n    if err == nil &amp;&amp; info.Mode().IsRegular() {\n      workQ &lt;- path\n  }\n}\n\n// if a file has a .checksum file, compare it with the file's checksum.\nfunc validateWorker(workQ &lt;- chan string) {\n  for path := range workQ {\n    // If there's a .checksum file, read it, limit to 256 bytes.\n    expectedSum, err := os.ReadFile(path + &quot;.checksum&quot;)[:256]\n    if err != nil {  // ignore\n      continue\n    }\n    file, err := os.Open(path)\n    if err != nil {\n      continue\n    }\n    defer close(file)\n    hash := sha256.New()\n    if _, err := io.Copy(hash, file); err != nil {\n      log.Printf(&quot;couldn't hash %s: %w&quot;, path, err)\n      continue\n    }\n    actualSum := fmt.Sprintf(&quot;%x&quot;, hash.Sum(nil))\n    if actualSum != expectedSum {\n      log.Printf(&quot;%s: mismatch: expected %s, got %s&quot;, path, expectedSum, actualSum)\n  }\n}\n</code></pre>\n<p>Even without any .checksum files, the crawl function will tend to outpace the worker queue. When .checksum files are encountered, especially if the files are large, the worker could take much, much longer to perform a single checksum.</p>\n<p>A better aim here would be to achieve more consistent throughput by reducing the number of things the &quot;validateWorker&quot; does. Right now it is sometimes fast, because it checks for the checksum file. Othertimes it is slow, because it also loads has to read and checksum the files.</p>\n<pre><code>type ChecksumQuery struct {\n  Filepath  string\n  ExpectSum string\n}\n\nfunc crawl(toplevel string, workQ chan &lt;- ChecksumQuery) {\n  // Have a worker filter out files which don't have .checksums, and allow it\n  // to get a little ahead of the crawl function.\n  checkupQ := make(chan string, 4)\n\n  go func () {\n    defer close(workQ)\n    for path := range checkupQ {\n      expected, err := os.ReadFile(path + &quot;.checksum&quot;)[:256]\n      if err == nil &amp;&amp; len(expected) &gt; 0 {\n        workQ &lt;- ChecksumQuery{ path, string(expected) }\n      }\n    }\n  }()\n\n  go func () {\n    defer close(checkupQ)\n    for _, path := filepath.Walk(toplevel, func (path string, info os.FileInfo, err error) error {\n      if err == nil &amp;&amp; info.Mode().IsRegular() {\n        checkupQ &lt;- path\n      }\n    }\n  }()\n}\n</code></pre>\n<p>Run a suitable number of validate workers, assign the workQ a suitable size, but if the crawler or validate functions block, it is because validate is doing useful work.</p>\n<p>If your validate workers are all busy, they are all consuming large files from disk and hashing them. Having other workers interrupt this by crawling for more filenames, allocating and passing strings, isn't advantageous.</p>\n<p>Other scenarios might be passing large lists to workers, in which pass the slices over channels (its cheap); or dynamic sized groups of things, in which case consider passing channels or captures over channels.</p>\n"}], "owner": {"reputation": 19270, "user_id": 5501675, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/9ea71bcc6b5c512a7d15da82db05f2ab?s=128&d=identicon&r=PG&f=1", "display_name": "Curious", "link": "https://stackoverflow.com/users/5501675/curious"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9511, "favorite_count": 2, "answer_count": 3, "score": 7, "last_activity_date": 1612736296, "creation_date": 1485575575, "last_edit_date": 1485577988, "question_id": 41906146, "link": "https://stackoverflow.com/questions/41906146/why-go-channels-limit-the-buffer-size", "title": "Why Go channels limit the buffer size", "body": "<p>I am new to Go and I might be missing the point but why are Go channels limited in the maximum buffer size buffered channels can have?  For example if I make a channel like so </p>\n\n<pre><code>channel := make(chan int, 100)\n</code></pre>\n\n<p>I cannot add more than 100 elements to the channel without blocking, is there a reason for this?  Further they cannot dynamically be resized, because the channel API does not support that.  </p>\n\n<p>This seems sort of limiting in the language's support for universal synchronization with a single mechanism since it lacks convenience compared to an unbounded semaphore.  For example a generalized semaphore's value can be increased without bounds.  </p>\n"}, {"tags": ["go", "reflection", "types"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1485574771, "last_edit_date": 1495542259, "creation_date": 1485567858, "answer_id": 41905585, "question_id": 41905222, "link": "https://stackoverflow.com/questions/41905222/how-to-get-the-string-representation-of-a-type/41905585#41905585", "title": "How to get the string representation of a type?", "body": "<p>You may use package <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a> (the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package does that too under the hood). You may start from the <em>pointer</em> to the type, and use a <em>typed <code>nil</code></em> pointer value without allocation, and you can navigate from its <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"nofollow noreferrer\"><code>reflect.Type</code></a> descriptor to the descriptor of the <em>base</em> type (or <em>element</em> type) of the pointer using <code>Type.Elem()</code>.</p>\n\n<p>Example:</p>\n\n<pre><code>t := reflect.TypeOf((*ID)(nil)).Elem()\nname := t.Name()\nfmt.Println(name)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/9tWT6xGweW\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>ID\n</code></pre>\n\n<p>Note: be aware that <code>Type.Name()</code> may return an empty <code>string</code> (if the <code>Type</code> represents an unnamed type). If you're using a <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">type declaration</a> (with the <code>type</code> keyword), then you already named the type, so <code>Type.Name()</code> will return a non-empty type name. But using the above code for a variable of type <code>*[]string</code> for example will give you an empty string:</p>\n\n<pre><code>var s *[]string\nt := reflect.TypeOf(s).Elem()\nname := t.Name()\nfmt.Printf(\"%q\", name)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Jgsuo60XQm\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\"\"\n</code></pre>\n\n<p>See related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/40879748/golang-reflect-get-type-representation-from-name/40882963#40882963\">Golang reflect: Get Type representation from name?</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/36310538/identify-non-builtin-types-using-reflect/37292523#37292523\">Identify non builtin-types using reflect</a></p>\n"}], "owner": {"reputation": 5764, "user_id": 1336532, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93e5830761f6e85757991d5915369349?s=128&d=identicon&r=PG", "display_name": "Mahoni", "link": "https://stackoverflow.com/users/1336532/mahoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1568, "favorite_count": 0, "accepted_answer_id": 41905585, "answer_count": 1, "score": 1, "last_activity_date": 1485574771, "creation_date": 1485564124, "question_id": 41905222, "link": "https://stackoverflow.com/questions/41905222/how-to-get-the-string-representation-of-a-type", "title": "How to get the string representation of a type?", "body": "<p>Let's say I have the following type defined:</p>\n\n<pre><code>type ID uuid.UUID\n</code></pre>\n\n<p>How would I get the type as string in a programmatic way so it's easy to refactor later other than maybe:</p>\n\n<pre><code>fmt.Sprintf(\"%T\", ID{})\n</code></pre>\n\n<p>which I don't quite like because it instantiates it, also from an Interface.</p>\n"}, {"tags": ["templates", "go"], "answers": [{"tags": [], "owner": {"reputation": 46, "user_id": 7481197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rY8ZB.jpg?s=128&g=1", "display_name": "Mike M", "link": "https://stackoverflow.com/users/7481197/mike-m"}, "is_accepted": false, "score": 1, "last_activity_date": 1485560917, "creation_date": 1485560917, "answer_id": 41904828, "question_id": 41904390, "link": "https://stackoverflow.com/questions/41904390/run-a-function-on-data-in-a-go-html-template/41904828#41904828", "title": "Run a function on data in a go html/template", "body": "<p>All of your *Page structs are created by the loadPage function. So it would seem to be easiest to just create your hyphenated title then and store it in your page struct:</p>\n\n<pre><code>type Page struct {\n    Title string\n    HyphenTitle string\n    Body  []byte\n}\n\nfunc loadPage(title string) (*Page, error) {\n    filename := title + \".txt\"\n    body, err := ioutil.ReadFile(filename)\n    if err != nil {\n        return nil, err\n    }\n    return &amp;Page{Title: title, Body: body, HyphenTitle: hyphenate(title)}, nil\n}\n\nfunc hyphenate (s string) string {\n    return strings.Replace(s,\" \",\"-\",-1)\n}\n</code></pre>\n\n<p>Then just use <code>{{.HyphenTitle}}</code> where you want it.</p>\n"}, {"tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 2, "last_activity_date": 1485561531, "creation_date": 1485561531, "answer_id": 41904917, "question_id": 41904390, "link": "https://stackoverflow.com/questions/41904390/run-a-function-on-data-in-a-go-html-template/41904917#41904917", "title": "Run a function on data in a go html/template", "body": "<p>You can pass a <code>template.FuncMap</code> to the template and then you can do something like:</p>\n\n<pre><code>{{ .Title | title }}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/KWy_KRttD_\" rel=\"nofollow noreferrer\">https://play.golang.org/p/KWy_KRttD_</a></p>\n\n<pre><code>func Sluggify(s string) string {\n    return strings.ToLower(s) //for example\n}\n\nfunc main() {\n    funcMap := template.FuncMap {\n        \"title\": Sluggify,\n    }\n\n    tpl := template.Must(template.New(\"main\").Funcs(funcMap).Parse(`{{define \"T\"}}Hello {{.Title | title }} Content: {{.Content}}{{end}}`))\n    tplVars := map[string]string {\n        \"Title\": \"Hello world\",\n        \"Content\": \"Hi there\",\n    }\n    tpl.ExecuteTemplate(os.Stdout, \"T\", tplVars)\n}\n</code></pre>\n"}], "owner": {"reputation": 988, "user_id": 6149170, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/bc071a84d9b5d4ec115745e1d0922b29?s=128&d=identicon&r=PG", "display_name": "hermancain", "link": "https://stackoverflow.com/users/6149170/hermancain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 243, "favorite_count": 0, "accepted_answer_id": 41904917, "answer_count": 2, "score": 0, "last_activity_date": 1485561531, "creation_date": 1485557959, "question_id": 41904390, "link": "https://stackoverflow.com/questions/41904390/run-a-function-on-data-in-a-go-html-template", "title": "Run a function on data in a go html/template", "body": "<p>I want to add hyphens (<code>-</code>) to a string in a go template when someone tries to save it. I'm using some modified code from the go wiki tutorial here: <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">https://golang.org/doc/articles/wiki/</a></p>\n\n<p>Code:</p>\n\n<pre><code>&lt;h1&gt;Editing {{.Title}}&lt;/h1&gt;                                                            \n&lt;form action=\"/save/{{.Title}}\" method=\"POST\"&gt;                                         \n  &lt;div&gt;&lt;input name=\"title\" type=\"text\" placeholder=\"title\"&gt;&lt;/div&gt;                      \n  &lt;div&gt;&lt;textarea name=\"body\" rows=\"20\" cols=\"80\"&gt;{{printf \"%s\" .Body}}&lt;/textarea&gt;&lt;/div&gt;\n  &lt;div&gt;&lt;input type=\"submit\" value=\"Save\"&gt;&lt;/div&gt;                                        \n&lt;/form&gt;                                                                          \n</code></pre>\n\n<p>The line with</p>\n\n<pre><code>&lt;form action=\"/save/{{.Title}}\" method=\"POST\"&gt;\n</code></pre>\n\n<p>is the relevant line. I need to transform <code>.Title</code> which might be something like \"the quick brown fox\" to \"the-quick-brown-fox\".</p>\n\n<p>As you can see in the code above, you can add a function like <code>println</code>, but I'm not sure how I would do this for my case.</p>\n"}, {"tags": ["amazon-web-services", "go", "lambda"], "comments": [{"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "edited": false, "score": 0, "creation_date": 1485559085, "post_id": 41903075, "comment_id": 70991596, "body": "How is <code>Handle</code> called and what does the caller do with the return-value?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1485559744, "post_id": 41903075, "comment_id": 70991760, "body": "Looks like you&#39;re not supposed to JSONify the return value (the return type is <code>interface{}</code>). It may be marshaling the marshaled string."}, {"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1485559835, "post_id": 41903075, "comment_id": 70991785, "body": "@AndySchweig can you elaborate? If I just return <code>content, nil</code>, I will get the base64 encoded json"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 2, "creation_date": 1485559918, "post_id": 41903075, "comment_id": 70991808, "body": "What if you return <code>res, nil</code>?"}, {"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1485560079, "post_id": 41903075, "comment_id": 70991846, "body": "@AndySchweig yep that worked! I look at the source code for the dependency i&#39;m using and the result is getting marshaled so it was getting marshaled twice"}], "answers": [{"tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": false, "score": 0, "last_activity_date": 1485555787, "creation_date": 1485555787, "answer_id": 41903994, "question_id": 41903075, "link": "https://stackoverflow.com/questions/41903075/return-json-in-go/41903994#41903994", "title": "Return JSON in Go", "body": "<p><code>json.Marshal</code> does return a pure JSON string. It looks like you're printing it with <code>%q</code>. See <a href=\"https://play.golang.org/p/skvAfk-frO\" rel=\"nofollow noreferrer\">https://play.golang.org/p/skvAfk-frO</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "edited": false, "score": 0, "creation_date": 1485560315, "post_id": 41904738, "comment_id": 70991896, "body": "I look at the source code for the dependency i&#39;m using and the result is getting marshaled so it was getting marshaled twice"}], "tags": [], "owner": {"reputation": 46, "user_id": 7481197, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rY8ZB.jpg?s=128&g=1", "display_name": "Mike M", "link": "https://stackoverflow.com/users/7481197/mike-m"}, "is_accepted": true, "score": 2, "last_activity_date": 1588599693, "last_edit_date": 1588599693, "creation_date": 1485560204, "answer_id": 41904738, "question_id": 41903075, "link": "https://stackoverflow.com/questions/41903075/return-json-in-go/41904738#41904738", "title": "Return JSON in Go", "body": "<p><a href=\"https://play.golang.org/p/l2nrhG9lOA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/l2nrhG9lOA</a></p>\n\n<p>It looks like the <code>interface{}</code> return type is the culprit. Forcing that to a <code>string</code> returns a more JSON-looking value. Having an <code>interface{}</code> return type makes me think something else is expecting a <code>struct</code> or marshal-able return value. Chase the <code>interface{}</code> or force a <code>string</code> and you should be good.</p>\n"}, {"comments": [{"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1568147759, "post_id": 49357578, "comment_id": 102180568, "body": "If working with API Gateway&#39;s Proxy Integration, see <a href=\"https://docs.aws.amazon.com/apigateway/latest/developerguide/set-up-lambda-proxy-integrations.html#api-gateway-simple-proxy-for-lambda-output-format\" rel=\"nofollow noreferrer\">documentation</a> for specifics on output format."}, {"owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "edited": false, "score": 0, "creation_date": 1568147832, "post_id": 49357578, "comment_id": 102180590, "body": "Similarly, if you get a &quot;Malformed Lambda Response&quot; error like <a href=\"https://aws.amazon.com/premiumsupport/knowledge-center/malformed-502-api-gateway/\" rel=\"nofollow noreferrer\">this</a>"}], "tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": false, "score": 5, "last_activity_date": 1568146710, "last_edit_date": 1568146710, "creation_date": 1521443818, "answer_id": 49357578, "question_id": 41903075, "link": "https://stackoverflow.com/questions/41903075/return-json-in-go/49357578#49357578", "title": "Return JSON in Go", "body": "<p>Since AWS Lambda now <a href=\"https://aws.amazon.com/blogs/compute/announcing-go-support-for-aws-lambda/\" rel=\"nofollow noreferrer\">officially supports Go</a>, here is an revised example.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/aws/aws-lambda-go/lambda\"\n)\n\n// Response ...\ntype Response struct {\n    StatusCode int               `json:\"statusCode\"`\n    Headers    map[string]string `json:\"headers\"`\n    Body       string            `json:\"body\"`\n}\n\n// Handle ...\nfunc Handle() (Response, error) {\n    return Response{\n            StatusCode: 1,\n            Headers:    map[string]string{\"Content-Type\": \"application/json\"},\n            Body:       \"Hello World\",\n        },\n        nil\n}\n\nfunc main() {\n    lambda.Start(Handle)\n}\n</code></pre>\n\n<p><br>\n<strong>(Update below with another example)</strong></p>\n\n<p>You can also just use a <code>map[string]interface{}</code> data type directly without having to create a <code>type</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/aws/aws-lambda-go/lambda\"\n)\n\n// Handle ...\nfunc Handle() (map[string]interface{}, error) {\n    return map[string]interface{}{\n            \"statusCode\": 1,\n            \"headers\":    map[string]string{\"Content-Type\": \"application/json\"},\n            \"body\":       \"Hello World\",\n        },\n        nil\n}\n\nfunc main() {\n    lambda.Start(Handle)\n}\n</code></pre>\n"}], "owner": {"reputation": 1156, "user_id": 2518716, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ed076bff996a50d9839d6046164959c3?s=128&d=identicon&r=PG", "display_name": "frankgreco", "link": "https://stackoverflow.com/users/2518716/frankgreco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8054, "favorite_count": 2, "accepted_answer_id": 41904738, "answer_count": 3, "score": 3, "last_activity_date": 1588599693, "creation_date": 1485551585, "last_edit_date": 1485558225, "question_id": 41903075, "link": "https://stackoverflow.com/questions/41903075/return-json-in-go", "title": "Return JSON in Go", "body": "<p>How to I get JSON back from golang without it being encoded as a string? I am using <a href=\"https://github.com/eawsy/aws-lambda-go-shim\" rel=\"nofollow noreferrer\">this project</a> to wrap go code in python so that I can execute it in an AWS lambda function. </p>\n\n<p>My issue is that whether I return  <code>json.Marshal(obj)</code> or <code>string(json.Marshal(obj))</code> I either get the base64 encoded json or a string representation (e.g. <code>\"{\\\"bar\\\": \\\"foo\\\"}\"</code>). This is not an appropiate response if you are using the AWS API gateway as it expects pure json like you would get if you returned a json object in Node.js.</p>\n\n<p>Here's my code: </p>\n\n<pre><code>package main\n\nimport \"C\"\n\nimport (\n  \"encoding/json\"\n  \"github.com/eawsy/aws-lambda-go-core/service/lambda/runtime\"\n)\n\ntype Response struct {\n  StatusCode  int       `json:\"statusCode\"`\n  Headers     map[string]string  `json:\"headers\"`\n  Body        string    `json:\"body\"`\n}\n\nfunc Handle(evt json.RawMessage, ctx *runtime.Context) (interface{}, error) {\n  res := &amp;Response{\n    StatusCode: 1,\n    Headers: map[string]string{\"Content-Type\": \"application/json\"},\n    Body: \"Hello World\",\n  }\n  content, _ := json.Marshal(res)\n  return string(content), nil\n}\n</code></pre>\n\n<p>Here's the result I get from AWS:</p>\n\n<p><a href=\"https://i.stack.imgur.com/rJi9G.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/rJi9G.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1485554213, "post_id": 41901560, "comment_id": 70989793, "body": "Specifically, it&#39;s initializing the <code>Db</code> global variable."}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 4, "last_activity_date": 1485545167, "creation_date": 1485545167, "answer_id": 41901560, "question_id": 41901370, "link": "https://stackoverflow.com/questions/41901370/go-runtime-error-when-an-unused-func-is-commented-out/41901560#41901560", "title": "Go runtime error when an unused func is commented out", "body": "<p>All <code>init</code> functions are called automatically when the program starts. It must be doing some initialization that other code depends on. See <a href=\"https://golang.org/doc/effective_go.html#init\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#init</a>.</p>\n"}], "owner": {"reputation": 19680, "user_id": 562222, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/jgGXb.jpg?s=128&g=1", "display_name": "qed", "link": "https://stackoverflow.com/users/562222/qed"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 197, "favorite_count": 0, "accepted_answer_id": 41901560, "answer_count": 1, "score": 2, "last_activity_date": 1485545387, "creation_date": 1485544407, "question_id": 41901370, "link": "https://stackoverflow.com/questions/41901370/go-runtime-error-when-an-unused-func-is-commented-out", "title": "Go runtime error when an unused func is commented out", "body": "<p>Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"errors\"\n    \"fmt\"\n    _ \"github.com/lib/pq\"\n)\n\ntype Post struct {\n    Id       int\n    Content  string\n    Author   string\n    Comments []Comment\n}\n\ntype Comment struct {\n    Id      int\n    Content string\n    Author  string\n    Post    *Post\n}\n\nvar Db *sql.DB\n\n// connect to the Db\nfunc init() {\n    var err error\n    //Db, err = sql.Open(\"postgres\", \"user=gwp dbname=gwp password=gwp sslmode=disable\")\n    Db, err = sql.Open(\"postgres\", \"user=gwp dbname=gwp sslmode=disable\")\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc (comment *Comment) Create() (err error) {\n    if comment.Post == nil {\n        err = errors.New(\"You need to specify the post that the comment belongs to.\")\n        return\n    }\n    err = Db.QueryRow(\"insert into comments (content, author, post_id) values ($1, $2, $3) returning id\", comment.Content, comment.Author, comment.Post.Id).Scan(&amp;comment.Id)\n    return\n}\n\n// Get a single post\nfunc GetPost(id int) (post Post, err error) {\n    post = Post{}\n    post.Comments = []Comment{}\n    err = Db.QueryRow(\"select id, content, author from posts where id = $1\", id).Scan(&amp;post.Id, &amp;post.Content, &amp;post.Author)\n\n    rows, err := Db.Query(\"select id, content, author from comments where post_id = $1\", id)\n    if err != nil {\n        return\n    }\n    for rows.Next() {\n        comment := Comment{Post: &amp;post}\n        err = rows.Scan(&amp;comment.Id, &amp;comment.Content, &amp;comment.Author)\n        if err != nil {\n            return\n        }\n        post.Comments = append(post.Comments, comment)\n    }\n    rows.Close()\n    return\n}\n\n// Create a new post\nfunc (post *Post) Create() (err error) {\n    err = Db.QueryRow(\"insert into posts (content, author) values ($1, $2) returning id\", post.Content, post.Author).Scan(&amp;post.Id)\n    return\n}\n\nfunc main() {\n    post := Post{Content: \"Hello World!\", Author: \"Sau Sheong\"}\n    post.Create()\n\n    // Add a comment\n    comment := Comment{Content: \"Good post!\", Author: \"Joe\", Post: &amp;post}\n    comment.Create()\n    readPost, _ := GetPost(post.Id)\n\n    fmt.Println(readPost)                  // {1 Hello World! Sau Sheong [{1 Good post! Joe 0xc20802a1c0}]}\n    fmt.Println(readPost.Comments)         // [{1 Good post! Joe 0xc20802a1c0}]\n    fmt.Println(readPost.Comments[0].Post) // &amp;{1 Hello World! Sau Sheong [{1 Good post! Joe 0xc20802a1c0}]}\n}\n</code></pre>\n\n<p>The <code>init</code> function is not used anywhere, but if I comment it out, the program crashes with the following error:</p>\n\n<pre><code>/usr/local/Cellar/go/1.7.4_2/libexec/bin/go run /Users/kaiyin/golang/src/github.com/sausheong/gwp/Chapter_6_Storing_Data/sql_store2/store.go\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x5fa9a]\n\ngoroutine 1 [running]:\npanic(0x1d62c0, 0xc42000c0e0)\n    /usr/local/Cellar/go/1.7.4_2/libexec/src/runtime/panic.go:500 +0x1a1\ndatabase/sql.(*DB).conn(0x0, 0x1, 0x22, 0x1c, 0x0)\n    /usr/local/Cellar/go/1.7.4_2/libexec/src/database/sql/sql.go:781 +0x3a\ndatabase/sql.(*DB).query(0x0, 0x216def, 0x40, 0xc42004fd80, 0x2, 0x2, 0x1, 0x10, 0xc42000cba0, 0x0)\n    /usr/local/Cellar/go/1.7.4_2/libexec/src/database/sql/sql.go:1074 +0x3b\ndatabase/sql.(*DB).Query(0x0, 0x216def, 0x40, 0xc42004fd80, 0x2, 0x2, 0x1, 0xc42000cba0, 0xc42004fd28)\n    /usr/local/Cellar/go/1.7.4_2/libexec/src/database/sql/sql.go:1062 +0x90\ndatabase/sql.(*DB).QueryRow(0x0, 0x216def, 0x40, 0xc42004fd80, 0x2, 0x2, 0x11200b7b18)\n    /usr/local/Cellar/go/1.7.4_2/libexec/src/database/sql/sql.go:1143 +0x70\nmain.(*Post).Create(0xc420018380, 0xc420018380, 0xc42004fe20)\n    /Users/kaiyin/golang/src/github.com/sausheong/gwp/Chapter_6_Storing_Data/sql_store2/store.go:69 +0xfe\nmain.main()\n    /Users/kaiyin/golang/src/github.com/sausheong/gwp/Chapter_6_Storing_Data/sql_store2/store.go:75 +0xd7\nexit status 2\n\nProcess finished with exit code 1\n</code></pre>\n\n<p>Not very helpful for debugging. </p>\n\n<p>Any idea what's going on here? Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7873, "user_id": 2225104, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/195de66794c596e35bc145c80e9f5515?s=128&d=identicon&r=PG", "display_name": "BitTickler", "link": "https://stackoverflow.com/users/2225104/bittickler"}, "edited": false, "score": 0, "creation_date": 1485542351, "post_id": 41900724, "comment_id": 70983944, "body": "For those who wonder... <a href=\"http://jsonlint.com/\" rel=\"nofollow noreferrer\">jsonlint.com</a> says the input is valid JSON."}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "edited": false, "score": 0, "creation_date": 1485584360, "post_id": 41901309, "comment_id": 70995867, "body": "Amazing! I&#39;ve spent so many hours on this and now the solution seems so clear. I can&#39;t believe I didn&#39;t realize the mistake. Thanks."}], "tags": [], "owner": {"reputation": 10697, "user_id": 2456263, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a3cf0df72502fdc81fad7301b2b887d8?s=128&d=identicon&r=PG", "display_name": "0xcaff", "link": "https://stackoverflow.com/users/2456263/0xcaff"}, "is_accepted": true, "score": 8, "last_activity_date": 1485544167, "creation_date": 1485544167, "answer_id": 41901309, "question_id": 41900724, "link": "https://stackoverflow.com/questions/41900724/unable-to-unmarshal-json-into-struct/41901309#41901309", "title": "Unable to unmarshal JSON into struct", "body": "<p>This is happening because other packages (<code>encoding/json</code>) can't access private fields (even with reflection). In go, private fields are fields starting with a lower case character. To fix this, make your struct contains public fields (which start with an upper case letter):</p>\n\n<pre><code>type jsonStruct struct {\n    Main struct {\n        Data []struct {\n            Key1 string `json:\"KEY1\"`\n            Key2 string `json:\"KEY2\"`\n            Key3 int    `json:\"KEY3\"`\n            Key4 string `json:\"KEY4\"`\n            Key5 string `json:\"KEY5\"`\n            Key6 string `json:\"KEY6\"`\n            Key7 string `json:\"KEY7\"`\n       } `json:\"data\"`\n    } `json:\"MAIN\"`\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/lStXAvDtpZ\" rel=\"noreferrer\">https://play.golang.org/p/lStXAvDtpZ</a></p>\n"}], "owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 787, "favorite_count": 1, "accepted_answer_id": 41901309, "answer_count": 1, "score": 2, "last_activity_date": 1485545261, "creation_date": 1485541957, "question_id": 41900724, "link": "https://stackoverflow.com/questions/41900724/unable-to-unmarshal-json-into-struct", "title": "Unable to unmarshal JSON into struct", "body": "<p>I want to unmarshal the following JSON into a struct:</p>\n\n<pre><code>{\"MAIN\":{\"data\":[{\"KEY1\":\"1111111\",\"KEY2\":\"2222222\",\"KEY3\":0,\"KEY4\":\"AAAAAAA\",\"KEY5\":\"9999\",\"KEY6\":\"4\",\"KEY7\":\"BBBBBBB\"}]}}\n</code></pre>\n\n<p>I have tried to modify the <code>jsonStruct</code> in various ways, but the struct is always empty:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype jsonStruct struct {\n    main struct {\n        data []struct {\n            Key1 string `json:\"KEY1\"`\n            Key2 string `json:\"KEY2\"`\n            Key3 int    `json:\"KEY3\"`\n            Key4 string `json:\"KEY4\"`\n            Key5 string `json:\"KEY5\"`\n            Key6 string `json:\"KEY6\"`\n            Key7 string `json:\"KEY7\"`\n       } `json:\"data\"`\n    } `json:\"MAIN\"`\n}\n\nfunc main() {\n    jsonData := []byte(`{\"MAIN\":{\"data\":[{\"KEY1\":\"1111111\",\"KEY2\":\"2222222\",\"KEY3\":0,\"KEY4\":\"AAAAAAA\",\"KEY5\":\"9999\",\"KEY6\":\"4\",\"KEY7\":\"BBBBBBB\"}]}}`)\n\n    var js jsonStruct\n\n    err := json.Unmarshal(jsonData, &amp;js)\n    if err != nil {\n            panic(err)\n    }\n\n    fmt.Println(js)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{{[]}}\n</code></pre>\n\n<p>The JSON I have worked with in the past contained no brackets, so I suspect that the problem is related to them.</p>\n\n<p>Can anyone help?</p>\n\n<p><a href=\"https://play.golang.org/p/pymKbOqcM-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/pymKbOqcM-</a></p>\n"}, {"tags": ["testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 1, "last_activity_date": 1485541338, "creation_date": 1485541338, "answer_id": 41900578, "question_id": 41900523, "link": "https://stackoverflow.com/questions/41900523/how-can-i-share-setup-and-teardown-methods-across-packages-when-testing-go/41900578#41900578", "title": "How can I share setup and teardown methods across packages when testing Go?", "body": "<p>Put it in another package <code>baz</code> that both <code>foo</code> and <code>bar</code> import in their tests.  We use this for database setup and teardown code in our tests.</p>\n"}], "owner": {"reputation": 7636, "user_id": 1650674, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6U9F1.png?s=128&g=1", "display_name": "tir38", "link": "https://stackoverflow.com/users/1650674/tir38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 114, "favorite_count": 0, "accepted_answer_id": 41900578, "answer_count": 1, "score": 0, "last_activity_date": 1485541338, "creation_date": 1485541131, "question_id": 41900523, "link": "https://stackoverflow.com/questions/41900523/how-can-i-share-setup-and-teardown-methods-across-packages-when-testing-go", "title": "How can I share setup and teardown methods across packages when testing Go?", "body": "<p>Let's say I have two packages <code>foo</code> and <code>bar</code>. Each package has file and a test file:</p>\n\n<pre><code>foo\n---widget.go\n---widget_test.go\nbar\n---wingding.go\n---wingding_test.go\n</code></pre>\n\n<p>Now for both tests (widget_test.go and wingding_test.go) I want to share some setup code. I know I can put this code inside each package inside main_test.go. But I obviously don't want to copy/paste code in two places. So where can I put this code so that it's shared across packages?</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1485541483, "post_id": 41900053, "comment_id": 70983504, "body": "Bit of an opinion-based question, but that&#39;s the style I personally prefer.  Unexported struct, exported interface, struct stored by pointer in the interface.  Makes mocking and middleware wrapping super easy, and is better aligned to an object-oriented abstraction principle than exported structs.  Only addition I might make is a factory function for the <code>datastr</code> type that returns a <code>Guy</code> interface, as this gives a compile-time guarantee that your structure fulfills the interface it is expected to fulfill."}], "answers": [{"comments": [{"owner": {"reputation": 388, "user_id": 434255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fed48080b982666795e7d3b8fc4914f4?s=128&d=identicon&r=PG", "display_name": "ont.rif", "link": "https://stackoverflow.com/users/434255/ont-rif"}, "edited": false, "score": 5, "creation_date": 1602058693, "post_id": 42970425, "comment_id": 113596522, "body": "unfortunately the repository <code>facebookgo&#47;inject</code> is archived now"}, {"owner": {"reputation": 784, "user_id": 3461650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BaUzM.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/3461650/jeremy"}, "edited": false, "score": 1, "creation_date": 1613670103, "post_id": 42970425, "comment_id": 117153654, "body": "This code illustrates the unnecessary complexity this approach has. uber/dig or google/wire are far better approaches."}], "tags": [], "owner": {"reputation": 6504, "user_id": 1591992, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/145ef738364c736add113829ed84ec84?s=128&d=identicon&r=PG", "display_name": "Wilbert", "link": "https://stackoverflow.com/users/1591992/wilbert"}, "is_accepted": true, "score": 12, "last_activity_date": 1490256635, "creation_date": 1490256635, "answer_id": 42970425, "question_id": 41900053, "link": "https://stackoverflow.com/questions/41900053/is-there-a-better-dependency-injection-pattern-in-golang/42970425#42970425", "title": "Is there a better dependency injection pattern in golang?", "body": "<p>Yes, the facebookgo inject library allows you to take your injected members and will wire up the graph for you.</p>\n\n<p>Code: <a href=\"https://github.com/facebookgo/inject\" rel=\"noreferrer\">https://github.com/facebookgo/inject</a></p>\n\n<p>Documentation: <a href=\"https://godoc.org/github.com/facebookgo/inject\" rel=\"noreferrer\">https://godoc.org/github.com/facebookgo/inject</a></p>\n\n<p>Here's a code example from the documentation: </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/facebookgo/inject\"\n)\n\n// Our Awesome Application renders a message using two APIs in our fake\n// world.\ntype HomePlanetRenderApp struct {\n    // The tags below indicate to the inject library that these fields are\n    // eligible for injection. They do not specify any options, and will\n    // result in a singleton instance created for each of the APIs.\n\n    NameAPI   *NameAPI   `inject:\"\"`\n    PlanetAPI *PlanetAPI `inject:\"\"`\n}\n\nfunc (a *HomePlanetRenderApp) Render(id uint64) string {\n    return fmt.Sprintf(\n        \"%s is from the planet %s.\",\n        a.NameAPI.Name(id),\n        a.PlanetAPI.Planet(id),\n    )\n}\n\n// Our fake Name API.\ntype NameAPI struct {\n    // Here and below in PlanetAPI we add the tag to an interface value.\n    // This value cannot automatically be created (by definition) and\n    // hence must be explicitly provided to the graph.\n\n    HTTPTransport http.RoundTripper `inject:\"\"`\n}\n\nfunc (n *NameAPI) Name(id uint64) string {\n    // in the real world we would use f.HTTPTransport and fetch the name\n    return \"Spock\"\n}\n\n// Our fake Planet API.\ntype PlanetAPI struct {\n    HTTPTransport http.RoundTripper `inject:\"\"`\n}\n\nfunc (p *PlanetAPI) Planet(id uint64) string {\n    // in the real world we would use f.HTTPTransport and fetch the planet\n    return \"Vulcan\"\n}\n\nfunc main() {\n    // Typically an application will have exactly one object graph, and\n    // you will create it and use it within a main function:\n    var g inject.Graph\n\n    // We provide our graph two \"seed\" objects, one our empty\n    // HomePlanetRenderApp instance which we're hoping to get filled out,\n    // and second our DefaultTransport to satisfy our HTTPTransport\n    // dependency. We have to provide the DefaultTransport because the\n    // dependency is defined in terms of the http.RoundTripper interface,\n    // and since it is an interface the library cannot create an instance\n    // for it. Instead it will use the given DefaultTransport to satisfy\n    // the dependency since it implements the interface:\n    var a HomePlanetRenderApp\n    err := g.Provide(\n        &amp;inject.Object{Value: &amp;a},\n        &amp;inject.Object{Value: http.DefaultTransport},\n    )\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n\n    // Here the Populate call is creating instances of NameAPI &amp;\n    // PlanetAPI, and setting the HTTPTransport on both to the\n    // http.DefaultTransport provided above:\n    if err := g.Populate(); err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        os.Exit(1)\n    }\n\n    // There is a shorthand API for the simple case which combines the\n    // three calls above is available as inject.Populate:\n    //\n    //   inject.Populate(&amp;a, http.DefaultTransport)\n    //\n    // The above API shows the underlying API which also allows the use of\n    // named instances for more complex scenarios.\n\n    fmt.Println(a.Render(42))\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "is_accepted": false, "score": 1, "last_activity_date": 1535837215, "creation_date": 1535837215, "answer_id": 52132316, "question_id": 41900053, "link": "https://stackoverflow.com/questions/41900053/is-there-a-better-dependency-injection-pattern-in-golang/52132316#52132316", "title": "Is there a better dependency injection pattern in golang?", "body": "<p>You should also try <a href=\"https://godoc.org/github.com/jwells131313/dargo/ioc\" rel=\"nofollow noreferrer\">Dargo</a>, which is new but has some features that the facebook one doesn't have.  The code is <a href=\"https://github.com/jwells131313/dargo\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>Here is an example:</p>\n\n<p>In this example a service called SimpleService will inject a logger. The logger itself is a dargo service that is bound with a creation method. That creation method looks like this:</p>\n\n<pre><code>func newLogger(ioc.ServiceLocator, ioc.Descriptor) (interface{}, error) {\n    return logrus.New(), nil\n}\n</code></pre>\n\n<p>The binding of SimpleService will provide the struct that should be used to implement the interface. The struct has a field annotated with inject followed by the name of the service to inject. This is the interface and the struct used to implement it:</p>\n\n<pre><code>type SimpleService interface {\n    // CallMe logs a message to the logger!\n    CallMe()\n}\n\n// SimpleServiceData is a struct implementing SimpleService\ntype SimpleServiceData struct {\n    Log *logrus.Logger `inject:\"LoggerService_Name\"`\n}\n\n// CallMe implements the SimpleService method\nfunc (ssd *SimpleServiceData) CallMe() {\n    ssd.Log.Info(\"This logger was injected!\")\n}\n</code></pre>\n\n<p>Both the logger service and the SimpleService are bound into the ServiceLocator. This is normally done near the start of your program:</p>\n\n<pre><code>locator, err := ioc.CreateAndBind(\"InjectionExampleLocator\", func(binder ioc.Binder) error {\n        // Binds SimpleService by providing the structure\n        binder.Bind(\"SimpleService\", SimpleServiceData{})\n\n        // Binds the logger service by providing the creation function \n        binder.BindWithCreator(\"LoggerService_Name\", newLogger).InScope(ioc.PerLookup)\n\n        return nil\n    })\n</code></pre>\n\n<p>The returned locator can be used to lookup the SimpleService service. The SimpleService is bound into the Singleton scope (the default scope), which means that it will only be created the first time it is looked up or injected, and never again. The LoggerService, on the other hand is in the PerLookup scope, which means that every time it is injected or looked up a new one will be created.</p>\n\n<p>This is the code that uses the looked up service:</p>\n\n<pre><code>raw, err := locator.GetDService(\"SimpleService\")\nif err != nil {\n    return err\n}\n\nss, ok := raw.(SimpleService)\nif !ok {\n    return fmt.Errorf(\"Invalid type for simple service %v\", ss)\n}\n\nss.CallMe()\n</code></pre>\n\n<p>Any depth of injection is supported (ServiceA can depend on ServiceB which depends on ServiceC and so on). A service can also depend on as many services as it would like (ServiceA can depend on service D, E and F etc). Howerver, services cannot have circular dependencies.</p>\n"}, {"comments": [{"owner": {"reputation": 901, "user_id": 3615752, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/95f412691055035fad3a563e8b162dc4?s=128&d=identicon&r=PG&f=1", "display_name": "kamal", "link": "https://stackoverflow.com/users/3615752/kamal"}, "edited": false, "score": 0, "creation_date": 1607357689, "post_id": 53842667, "comment_id": 115240770, "body": "We are using uber&#39;s Dig, its really get clumsy as the project gets even little bigger."}], "tags": [], "owner": {"reputation": 4649, "user_id": 1658458, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/dc5d638443908cf7ae97690a4e2a045b?s=128&d=identicon&r=PG", "display_name": "yndolok", "link": "https://stackoverflow.com/users/1658458/yndolok"}, "is_accepted": false, "score": 1, "last_activity_date": 1545176416, "creation_date": 1545176416, "answer_id": 53842667, "question_id": 41900053, "link": "https://stackoverflow.com/questions/41900053/is-there-a-better-dependency-injection-pattern-in-golang/53842667#53842667", "title": "Is there a better dependency injection pattern in golang?", "body": "<p>Uber's <a href=\"https://github.com/uber-go/dig\" rel=\"nofollow noreferrer\">Dig</a> is pretty awesome. Here's a great blog post about it: <a href=\"https://blog.drewolson.org/dependency-injection-in-go\" rel=\"nofollow noreferrer\">Dependency Injection in Go</a></p>\n"}, {"tags": [], "owner": {"reputation": 141, "user_id": 9647255, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bd7c4ad441470225dbbaa215914088e7?s=128&d=identicon&r=PG&f=1", "display_name": "Eddie Owens", "link": "https://stackoverflow.com/users/9647255/eddie-owens"}, "is_accepted": false, "score": 0, "last_activity_date": 1555310301, "creation_date": 1555310301, "answer_id": 55683702, "question_id": 41900053, "link": "https://stackoverflow.com/questions/41900053/is-there-a-better-dependency-injection-pattern-in-golang/55683702#55683702", "title": "Is there a better dependency injection pattern in golang?", "body": "<p>If you're still interested in finding a DI library for Go that uses very minimal reflection I made one called <a href=\"https://github.com/eddieowens/axon\" rel=\"nofollow noreferrer\">axon</a>. It's based on Google's <a href=\"https://github.com/google/guice\" rel=\"nofollow noreferrer\">Guice</a> so if you're coming from the Java world (like myself) it should lend itself well to how you expect it to work. </p>\n\n<p>I've used it in web servers and it hasn't had any problems and was fast enough to not have any impact on being used within CLIs.</p>\n"}, {"tags": [], "owner": {"reputation": 341, "user_id": 714426, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9T2Hi.jpg?s=128&g=1", "display_name": "William Yeh", "link": "https://stackoverflow.com/users/714426/william-yeh"}, "is_accepted": false, "score": 8, "last_activity_date": 1580877209, "creation_date": 1580877209, "answer_id": 60069077, "question_id": 41900053, "link": "https://stackoverflow.com/questions/41900053/is-there-a-better-dependency-injection-pattern-in-golang/60069077#60069077", "title": "Is there a better dependency injection pattern in golang?", "body": "<p>Google's <a href=\"https://github.com/google/wire\" rel=\"noreferrer\">Wire</a> looks promising. There're some articles about it:</p>\n\n<ul>\n<li><p><a href=\"https://blog.golang.org/wire\" rel=\"noreferrer\">Compile-time Dependency Injection With Go Cloud's Wire</a></p></li>\n<li><p><a href=\"https://blog.drewolson.org/go-dependency-injection-with-wire\" rel=\"noreferrer\">Go Dependency Injection with Wire</a></p></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 300, "user_id": 10813908, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RX2IbOndafg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hU5rnSDGLYOR71KEuqfGURQkIOxA/mo/photo.jpg?sz=128", "display_name": "Zeeshan", "link": "https://stackoverflow.com/users/10813908/zeeshan"}, "reply_to_user": {"reputation": 1429, "user_id": 1402237, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/sXps1.jpg?s=128&g=1", "display_name": "rekiem87", "link": "https://stackoverflow.com/users/1402237/rekiem87"}, "edited": false, "score": 4, "creation_date": 1583209136, "post_id": 60271405, "comment_id": 107029320, "body": "Unfortunately haven&#39;t used wire and neither am i an expert in DI in Golang.  However, i strongly believe that no specific pattern is needed since any library would complicate the program flow and Golang aims to be a language which does not have any <i>magic</i> and is easy to follow."}, {"owner": {"reputation": 1612, "user_id": 3142741, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/8d823983245110f781dc5bc8e4bba5fe?s=128&d=identicon&r=PG&f=1", "display_name": "Arshia001", "link": "https://stackoverflow.com/users/3142741/arshia001"}, "edited": false, "score": 4, "creation_date": 1607238635, "post_id": 60271405, "comment_id": 115206193, "body": "&quot;Best practice is not to use a DI library.&quot; Isn&#39;t this taking it just a bit too far?"}, {"owner": {"reputation": 784, "user_id": 3461650, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BaUzM.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/3461650/jeremy"}, "edited": false, "score": 1, "creation_date": 1613669772, "post_id": 60271405, "comment_id": 117153512, "body": "If this is classed as the best practice, please add a Go doc reference to that effect.  Considering that Google created wire as a DI system that avoids reflection and maintains the calling clarity I find this answer more likely to be incorrect."}, {"owner": {"reputation": 300, "user_id": 10813908, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RX2IbOndafg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hU5rnSDGLYOR71KEuqfGURQkIOxA/mo/photo.jpg?sz=128", "display_name": "Zeeshan", "link": "https://stackoverflow.com/users/10813908/zeeshan"}, "edited": false, "score": 0, "creation_date": 1616046048, "post_id": 60271405, "comment_id": 117881495, "body": "No Go Doc reference; have myself read a bunch of articles and effective go. Using no DI framework is more idiomatic Go compared to using a DI framework that does reflection or magic under the hood."}, {"owner": {"reputation": 2061, "user_id": 1520291, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/9d8e7bdd418d0b727f76b47e655bc465?s=128&d=identicon&r=PG", "display_name": "Dmytro Titov", "link": "https://stackoverflow.com/users/1520291/dmytro-titov"}, "edited": false, "score": 0, "creation_date": 1618703251, "post_id": 60271405, "comment_id": 118682904, "body": "Says who? I&#39;ve seen quite a few good projects that were using some sort of DI. Also Google with its Wire would argue with your statement..."}], "tags": [], "owner": {"reputation": 300, "user_id": 10813908, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-RX2IbOndafg/AAAAAAAAAAI/AAAAAAAAAAA/AGDgw-hU5rnSDGLYOR71KEuqfGURQkIOxA/mo/photo.jpg?sz=128", "display_name": "Zeeshan", "link": "https://stackoverflow.com/users/10813908/zeeshan"}, "is_accepted": false, "score": 19, "last_activity_date": 1612093493, "last_edit_date": 1612093493, "creation_date": 1581979506, "answer_id": 60271405, "question_id": 41900053, "link": "https://stackoverflow.com/questions/41900053/is-there-a-better-dependency-injection-pattern-in-golang/60271405#60271405", "title": "Is there a better dependency injection pattern in golang?", "body": "<p>The best practice is not to use a DI library. Go is meant to be a simple language that is easy to follow. A DI library/framework will abstract that away from you (and to some extent make DI <em>magical</em>).</p>\n"}], "owner": {"reputation": 5090, "user_id": 491770, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/I2mn1.png?s=128&g=1", "display_name": "Justin Thomas", "link": "https://stackoverflow.com/users/491770/justin-thomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20801, "favorite_count": 7, "accepted_answer_id": 42970425, "answer_count": 6, "score": 18, "last_activity_date": 1612093493, "creation_date": 1485539338, "question_id": 41900053, "link": "https://stackoverflow.com/questions/41900053/is-there-a-better-dependency-injection-pattern-in-golang", "title": "Is there a better dependency injection pattern in golang?", "body": "<p>Given this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype datstr string\n\ntype Guy interface {\n   SomeDumbGuy() string\n}\n\nfunc (d *datstr) SomeDumbGuy() string {\n  return \"some guy\"\n}\n\nfunc someConsumer(g Guy) {\n  fmt.Println(\"Hello, \" + g.SomeDumbGuy())\n}\n\nfunc main() {\n    var d datstr\n    someConsumer(&amp;d)\n}\n</code></pre>\n\n<p>Is the wiring of components together that's done in <strong>main</strong> the right way to wire a dependency together?  It seems like I'm over using this a bit in my code.  Is there a common pattern better than this, or am I overthinking it?</p>\n"}, {"tags": ["go", "redis", "redigo"], "answers": [{"comments": [{"owner": {"reputation": 25, "user_id": 7479962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a25441f8164e5125d0e0b9e86a2f1e?s=128&d=identicon&r=PG&f=1", "display_name": "Err0r500", "link": "https://stackoverflow.com/users/7479962/err0r500"}, "edited": false, "score": 0, "creation_date": 1485538751, "post_id": 41899640, "comment_id": 70982047, "body": "You&#39;re right, your suggestions were my first tries but I just did a minimal example and it works fine. The problem came in fact from another redis call right after this one which was failing in the case this one was passing... Thanks"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1485537814, "creation_date": 1485537814, "answer_id": 41899640, "question_id": 41899534, "link": "https://stackoverflow.com/questions/41899534/geoadd-command-with-redigo/41899640#41899640", "title": "GEOADD command with Redigo", "body": "<p>The easiest way to call this API is:</p>\n\n<pre><code>_, err := conn.Do(\"GEOADD\", \"geoIndex\", \"3.361389\", \"38.115556\", \"12\")\n</code></pre>\n\n<p>You can also pass number values:</p>\n\n<pre><code>_, err := conn.Do(\"GEOADD\", \"geoIndex\", 3.361389, 38.115556, 12)\n</code></pre>\n\n<p>If you do want to piece the command together, then pass the slice to AddFlat, not a pointer to the slice:</p>\n\n<pre><code>insertPos := []string{\"3.361389\", \"38.115556\", \"12\"}\n_, err := conn.Do(\"GEOADD\", redis.Args{}.Add(\"geoIndex\").AddFlat(insertPos)...)\n</code></pre>\n"}], "owner": {"reputation": 25, "user_id": 7479962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a0a25441f8164e5125d0e0b9e86a2f1e?s=128&d=identicon&r=PG&f=1", "display_name": "Err0r500", "link": "https://stackoverflow.com/users/7479962/err0r500"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 1, "accepted_answer_id": 41899640, "answer_count": 1, "score": 2, "last_activity_date": 1485537814, "creation_date": 1485537459, "question_id": 41899534, "link": "https://stackoverflow.com/questions/41899534/geoadd-command-with-redigo", "title": "GEOADD command with Redigo", "body": "<p>Here's what i'm trying, using Redigo (\"github.com/garyburd/redigo/redis\") :</p>\n\n<pre><code>insertPos := []string{\"3.361389\", \"38.115556\", \"12\"}\nif _, err := conn.Do(\"GEOADD\", redis.Args{}.Add(\"geoIndex\").AddFlat(&amp;insertPos)...); err != nil {\n    log.Print(err)\n} \n==&gt; \"ERR wrong number of arguments for 'geoadd' command\"\n</code></pre>\n\n<p>While with the redis-cli this works fine : </p>\n\n<pre><code>GEOADD geoIndex  3.361389  38.115556  12\n==&gt; (integer) 1\n</code></pre>\n\n<p>Other commands works fine, that's just the first time I've to use GEOADD and it clearly doesn't seem to work as I expect it to. \nDoes someone have an idea ?</p>\n"}, {"tags": ["html", "dictionary", "go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 6878602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6739761de47bfd12390be949e30378?s=128&d=identicon&r=PG&f=1", "display_name": "Egor Miloserdov", "link": "https://stackoverflow.com/users/6878602/egor-miloserdov"}, "edited": false, "score": 0, "creation_date": 1485540872, "post_id": 41899792, "comment_id": 70983202, "body": "Oh, lord =(. Such a stupid mistake. Thanks a lot, It helped."}], "tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1485538416, "creation_date": 1485538416, "answer_id": 41899792, "question_id": 41899501, "link": "https://stackoverflow.com/questions/41899501/map-of-counetrs-html-tags-in-golang-dont-work-properly/41899792#41899792", "title": "Map of counetrs html tags in Golang dont work properly", "body": "<p>Error is exact. You can't assign in nil map. You must first allocate. Also you need something to work, you func return nothing. So</p>\n\n<pre><code>outline := make(map[string]int) //allocate and name your map\noutline2(outline, doc)\nfmt.Println(outline) //do something with it\n</code></pre>\n\n<p>should work</p>\n"}], "owner": {"reputation": 3, "user_id": 6878602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4b6739761de47bfd12390be949e30378?s=128&d=identicon&r=PG&f=1", "display_name": "Egor Miloserdov", "link": "https://stackoverflow.com/users/6878602/egor-miloserdov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 41899792, "answer_count": 1, "score": -1, "last_activity_date": 1485538416, "creation_date": 1485537351, "question_id": 41899501, "link": "https://stackoverflow.com/questions/41899501/map-of-counetrs-html-tags-in-golang-dont-work-properly", "title": "Map of counetrs html tags in Golang dont work properly", "body": "<p>I got a problem. \nI need to write a function to populate a mapping from element names\u2014p, div, span, and so on \u2014 to the number of elements with that name in an HTML document tree. I made function <code>outline2</code>, it's not working, here is the eroor log:</p>\n\n<pre><code>html\npanic: assignment to entry in nil map\n\n    goroutine 1 [running]:\n    panic(0x4c3b40, 0xc042010a90)\n            F:/Go/src/runtime/panic.go:500 +0x1af\n    main.outline2(0x0, 0xc0420320e0)\n            F:/Go_Stuff/Books/Golang_stuff/exercises/src/gopl.io/ch5/outline/main.go:29 +0x1ae\n    main.outline2(0x0, 0xc042032070)\n            F:/Go_Stuff/Books/Golang_stuff/exercises/src/gopl.io/ch5/outline/main.go:34 +0xe3\n    main.main()\n            F:/Go_Stuff/Books/Golang_stuff/exercises/src/gopl.io/ch5/outline/main.go:23 +0x77\n</code></pre>\n\n<p>Here is the code:</p>\n\n<pre><code>func main() {\n    doc, err := html.Parse(os.Stdin)\n    if err != nil {\n        fmt.Fprintf(os.Stderr, \"outline: %v\\n\", err)\n        os.Exit(1)\n    }\n    outline2(nil, doc)\n}\nfunc outline2(tags map[string]int, n *html.Node) {\n    fmt.Println(n.Data)\n    if n.Type == html.ElementNode {\n        fmt.Println(n.Data)\n        tags[n.Data] += 1 // push tag\n        fmt.Println(n.Data)\n\n    }\n    for c := n.FirstChild; c != nil; c = c.NextSibling {\n        outline2(tags, c)\n\n\n    }\n}\n</code></pre>\n\n<p>Please, point out my mistakes. I don't know what to do =(</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 7, "creation_date": 1485531369, "post_id": 41897415, "comment_id": 70977447, "body": "It just looks like a bad result was cached somehow. Changing the source slightly to get a new run shows output: <a href=\"https://play.golang.org/p/9JCVkOwWD8\" rel=\"nofollow noreferrer\">play.golang.org/p/9JCVkOwWD8</a>"}, {"owner": {"reputation": 25722, "user_id": 2192903, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/mNrNH.png?s=128&g=1", "display_name": "Arnaud Denoyelle", "link": "https://stackoverflow.com/users/2192903/arnaud-denoyelle"}, "edited": false, "score": 0, "creation_date": 1485535641, "post_id": 41897415, "comment_id": 70980212, "body": "If you add a dummy <code>fmt.Println(&quot;&quot;)</code>, you see that your expected result appears. It seems that the program exits before the buffer is flushed. Also, it works as expected when I execute locally."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1496958596, "creation_date": 1496958596, "answer_id": 44446135, "question_id": 41897415, "link": "https://stackoverflow.com/questions/41897415/cannot-print-array-slice/44446135#44446135", "title": "Cannot print array slice", "body": "<p>A few month later (June 2017), even the <a href=\"https://play.golang.org/p/wdLUlXigcv\" rel=\"nofollow noreferrer\">original example</a> does work with the current iteration of the <a href=\"https://github.com/golang/playground\" rel=\"nofollow noreferrer\"><code>golang/playground</code></a>.</p>\n\n<p>That means the flushing issue after a <code>fmt.Println</code> as a last instruction of main() has been fixed.</p>\n"}], "owner": {"reputation": 868, "user_id": 3367929, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/5f06ec213df31bb3a61141cdc1f2222e?s=128&d=identicon&r=PG&f=1", "display_name": "Rames", "link": "https://stackoverflow.com/users/3367929/rames"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 88, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1496958596, "creation_date": 1485530755, "question_id": 41897415, "link": "https://stackoverflow.com/questions/41897415/cannot-print-array-slice", "title": "Cannot print array slice", "body": "<p>I'm playing around with Go language, using its online playground.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    primes := [6]int{2, 3, 5, 7, 11, 13}\n\n    var s []int = primes[1:6]\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>This code prints nothing. Changing slice range to something else, for instance to <code>[2:6]</code> works as expected. I have tried it only using Go playground. <a href=\"https://play.golang.org/p/wdLUlXigcv\" rel=\"nofollow noreferrer\">Check it here.</a></p>\n\n<p>Why it doesn't print anything? Probably it can be a Go compiler or Go playground bug, however I don't know the language so I'm not sure.</p>\n"}, {"tags": ["date", "go", "locale"], "answers": [{"comments": [{"owner": {"reputation": 51550, "user_id": 1458569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mPKhD.png?s=128&g=1", "display_name": "Igor Chubin", "link": "https://stackoverflow.com/users/1458569/igor-chubin"}, "edited": false, "score": 0, "creation_date": 1485532437, "post_id": 41897507, "comment_id": 70978180, "body": "I can&#39;t believe it is so bad. Are there no robust i18n packages for go?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 51550, "user_id": 1458569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mPKhD.png?s=128&g=1", "display_name": "Igor Chubin", "link": "https://stackoverflow.com/users/1458569/igor-chubin"}, "edited": false, "score": 0, "creation_date": 1485533311, "post_id": 41897507, "comment_id": 70978791, "body": "@IgorChubin Unfortunately there&#39;s none yet (that I know of). But to support a specific language and layout, it&#39;s easy enough. Added to the answer."}, {"owner": {"reputation": 51550, "user_id": 1458569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mPKhD.png?s=128&g=1", "display_name": "Igor Chubin", "link": "https://stackoverflow.com/users/1458569/igor-chubin"}, "edited": false, "score": 1, "creation_date": 1485535386, "post_id": 41897507, "comment_id": 70980047, "body": "I&#39;ve found this library: <a href=\"https://github.com/variadico/lctime\" rel=\"nofollow noreferrer\">github.com/variadico/lctime</a> and it seems to have the features that I need. Thank you icza!"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 51550, "user_id": 1458569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mPKhD.png?s=128&g=1", "display_name": "Igor Chubin", "link": "https://stackoverflow.com/users/1458569/igor-chubin"}, "edited": false, "score": 0, "creation_date": 1485535571, "post_id": 41897507, "comment_id": 70980171, "body": "@IgorChubin Good find! Thanks for sharing."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 12, "last_activity_date": 1582282512, "last_edit_date": 1582282512, "creation_date": 1485531030, "answer_id": 41897507, "question_id": 41897265, "link": "https://stackoverflow.com/questions/41897265/how-do-i-convert-date-to-the-string-in-go-using-locale/41897507#41897507", "title": "How do I convert date to the string in go using locale?", "body": "<p>You can't. The Go standard library does not contain localized month, day and zone names. The names are wired into the <code>time</code> package.</p>\n\n<p>For example, the name of the months returned by <a href=\"https://golang.org/pkg/time/#Month.String\" rel=\"noreferrer\"><code>Month.String()</code></a> are stored in the unexported <code>time.month</code> global variable:</p>\n\n<pre><code>var months = [...]string{\n    \"January\",\n    \"February\",\n    \"March\",\n    \"April\",\n    \"May\",\n    \"June\",\n    \"July\",\n    \"August\",\n    \"September\",\n    \"October\",\n    \"November\",\n    \"December\",\n}\n\nfunc (m Month) String() string { return months[m-1] }\n</code></pre>\n\n<p>Similarly, names of weekdays come from <a href=\"https://golang.org/pkg/time/#Weekday.String\" rel=\"noreferrer\"><code>Weekday.String()</code></a>, stored in unexported variable <code>time.days</code>.</p>\n\n<p>Having said that, there may be 3rd party libraries supporting your needs. Here's an incomplete one which might be of  some help to you: <a href=\"https://github.com/mattbaird/go-i18n-formats\" rel=\"noreferrer\">https://github.com/mattbaird/go-i18n-formats</a></p>\n\n<p>As shared by Igor Chubin below, this 3rd party lib is much more complete: <a href=\"https://github.com/klauspost/lctime\" rel=\"noreferrer\">https://github.com/klauspost/lctime</a></p>\n\n<p>Also note that while providing a general, multilingual time formatting package is not an easy task, if you really need it, you could take the <code>time</code> package, copy it to your project and just translate the names to the language you need.</p>\n\n<p>Also note that supporting a low number of languages and low number of layouts, it's easy to create the formatting yourself.</p>\n\n<p>For example, the code below formats a given <code>time.Time</code> value in Hungarian, using the layout you used in your question:</p>\n\n<pre><code>func Format(t time.Time) string {\n    return fmt.Sprintf(\"%s %02d. %s\",\n        days[t.Weekday()][:3], t.Day(), months[t.Month()-1][:3],\n    )\n}\n\nvar days = [...]string{\n    \"Vas\u00e1rnap\", \"H\u00e9tf\u0151\", \"Kedd\", \"Szerda\", \"Cs\u00fct\u00f6rt\u00f6k\", \"P\u00e9ntek\", \"Szombat\"}\n\nvar months = [...]string{\n    \"Janu\u00e1r\", \"Febru\u00e1r\", \"M\u00e1rcius\", \"\u00c1prilis\", \"M\u00e1jus\", \"J\u00fanius\",\n    \"J\u00falius\", \"Augusztus\", \"Szeptember\", \"Okt\u00f3ber\", \"November\", \"December\",\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>fmt.Println(Format(time.Now()))\n</code></pre>\n\n<p>Output on the <a href=\"https://play.golang.org/p/exJBNBNqxr\" rel=\"noreferrer\">Go Playground</a>:</p>\n\n<pre><code>Ked 10. Nov\n</code></pre>\n\n<p>Output on my local machine:</p>\n\n<pre><code>P\u00e9n 27. Jan\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 451, "user_id": 4624605, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/CLvcA.jpg?s=128&g=1", "display_name": "Paul Oskar Mayer", "link": "https://stackoverflow.com/users/4624605/paul-oskar-mayer"}, "is_accepted": false, "score": 3, "last_activity_date": 1572347329, "creation_date": 1572347329, "answer_id": 58606273, "question_id": 41897265, "link": "https://stackoverflow.com/questions/41897265/how-do-i-convert-date-to-the-string-in-go-using-locale/58606273#58606273", "title": "How do I convert date to the string in go using locale?", "body": "<p>You can use a replacer as quickfix for the problem.\nExample in german:</p>\n\n<pre><code>r := strings.NewReplacer(\n            \"January\", \"Januar\",\n            \"February\", \"Februar\",\n            \"March\", \"M\u00e4rz\",\n            \"April\", \"April\",\n            \"May\", \"Mai\",\n            \"June\", \"Juni\",\n            \"July\", \"Juli\",\n            \"August\", \"August\",\n            \"September\", \"September\",\n            \"October\", \"Oktober\",\n            \"November\", \"November\",\n            \"December\", \"Dezember\", )\n\n\ntime := inputTime.Format(\"2 January 2006\")\n\noutputString := r.Replace(time)\n</code></pre>\n"}], "owner": {"reputation": 51550, "user_id": 1458569, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/mPKhD.png?s=128&g=1", "display_name": "Igor Chubin", "link": "https://stackoverflow.com/users/1458569/igor-chubin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3004, "favorite_count": 3, "accepted_answer_id": 41897507, "answer_count": 2, "score": 7, "last_activity_date": 1582282512, "creation_date": 1485530281, "question_id": 41897265, "link": "https://stackoverflow.com/questions/41897265/how-do-i-convert-date-to-the-string-in-go-using-locale", "title": "How do I convert date to the string in go using locale?", "body": "<p>I convert date to a string this way:</p>\n\n<pre><code>d.Format(\"Mon 02. Jan\")\n</code></pre>\n\n<p>and I get something like</p>\n\n<pre><code>Fri 27. Jan\n</code></pre>\n\n<p>How can I switch the locale and get the string in other language?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485526509, "post_id": 41895950, "comment_id": 70974030, "body": "Chances are it&#39;s a <code>git</code> problem, not Go. You can set various env variables to have git log extra output (<code>GIT_TRACE=1</code> should work). It&#39;s likely an old/buggy version of git."}, {"owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1486420792, "post_id": 41895950, "comment_id": 71328745, "body": "Closing this as this was an intermittent issue. Details are at <a href=\"https://github.com/urfave/cli/issues/591\" rel=\"nofollow noreferrer\">github.com/urfave/cli/issues/591</a>"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1581282010, "post_id": 41895950, "comment_id": 106369652, "body": "Hanging is a disappointing way to handle networking issues.  BTW, here&#39;s a related question: <a href=\"https://stackoverflow.com/questions/29895951/go-get-hanging-on-certain-library\" title=\"go get hanging on certain library\">stackoverflow.com/questions/29895951/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "edited": false, "score": 0, "creation_date": 1485529735, "post_id": 41896119, "comment_id": 70976330, "body": "Thanks for the suggestion. Look at my answer"}], "tags": [], "owner": {"reputation": 11, "user_id": 7163644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b61970f6392a962b83fc1e966530419d?s=128&d=identicon&r=PG&f=1", "display_name": "Louis B", "link": "https://stackoverflow.com/users/7163644/louis-b"}, "is_accepted": false, "score": 1, "last_activity_date": 1485526866, "creation_date": 1485526866, "answer_id": 41896119, "question_id": 41895950, "link": "https://stackoverflow.com/questions/41895950/how-to-debug-a-hanging-golang-go-get-call/41896119#41896119", "title": "How to debug a hanging golang &quot;go get&quot; call?", "body": "<p>Most likely a networking issue. We had this phenomenon while the connection to our ISP experienced package loss.</p>\n\n<p>Since <code>go get</code> uses git, you could manually clone the repository and see what <code>git</code> tells you:</p>\n\n<pre><code>$ git clone --verbose https://gopkg.in/urfave/cli.v2\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485533174, "post_id": 41897078, "comment_id": 70978705, "body": "no, that import path works. It&#39;s still probably an issue with your version of git, local git configuration, or network (proxy?)."}], "tags": [], "owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "is_accepted": false, "score": 0, "last_activity_date": 1485529707, "creation_date": 1485529707, "answer_id": 41897078, "question_id": 41895950, "link": "https://stackoverflow.com/questions/41895950/how-to-debug-a-hanging-golang-go-get-call/41897078#41897078", "title": "How to debug a hanging golang &quot;go get&quot; call?", "body": "<p>It turns out there is no source code repo at <a href=\"https://gopkg.in/urfave/cli.v2\" rel=\"nofollow noreferrer\">https://gopkg.in/urfave/cli.v2</a>. I had to follow @Louis suggestion of cloning the repo myself </p>\n\n<pre><code>mkdir -p $GOPATH/src/gopkg.in/urfave\ncd $GOPATH/src/gopkg.in/urfave\ngit clone https://github.com/urfave/cli -b v2 cli.v2\n</code></pre>\n\n<p>NOTE: Opened an issue for the author <a href=\"https://github.com/urfave/cli/issues/591\" rel=\"nofollow noreferrer\">https://github.com/urfave/cli/issues/591</a></p>\n"}], "owner": {"reputation": 74134, "user_id": 127320, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/OdIgE.jpg?s=128&g=1", "display_name": "Aravind Yarram", "link": "https://stackoverflow.com/users/127320/aravind-yarram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4649, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1485529707, "creation_date": 1485526325, "question_id": 41895950, "link": "https://stackoverflow.com/questions/41895950/how-to-debug-a-hanging-golang-go-get-call", "title": "How to debug a hanging golang &quot;go get&quot; call?", "body": "<p>The <code>go get -v gopkg.in/urfave/cli.v2</code> is hanging after printing the following output. I could install other packages though. How to debug the root cause for this?</p>\n\n<p>This has been hanging for over 6 hours. Had to come out of this by pressing cntrl+c.</p>\n\n<pre><code>$go get -v -insecure gopkg.in/urfave/cli.v2\nFetching https://gopkg.in/urfave/cli.v2?go-get=1\nParsing meta tags from https://gopkg.in/urfave/cli.v2?go-get=1 (status code 200)\nget \"gopkg.in/urfave/cli.v2\": found meta tag main.metaImport{Prefix:\"gopkg.in/urfave/cli.v2\", VCS:\"git\", RepoRoot:\"https://gopkg.in/urfave/cli.v2\"} at https://gopkg.in/urfave/cli.v2?go-get=1\ngopkg.in/urfave/cli.v2 (download)\n</code></pre>\n"}, {"tags": ["go", "command-line-interface"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1485528486, "post_id": 41895260, "comment_id": 70975379, "body": "What do you mean by &quot;CLI&quot;? Ie will the user start your program and then work in &quot;interacive shell&quot; in it or will the user enter the full command in the system shell and your program does it&#39;s thing and exits?"}, {"owner": {"reputation": 435, "user_id": 3162261, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/06813697a52abdc3b82be98f99d479ba?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3162261/chris"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1485528609, "post_id": 41895260, "comment_id": 70975457, "body": "@ain Good question. I haven&#39;t thought about this. It doesn&#39;t matter to the use case. Therefore: Whatever is better to implement."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485528689, "post_id": 41895260, "comment_id": 70975517, "body": "The two examples you pointed to are very different, one <i>is</i> a readline implementation, and one uses the autocompletion features of bash (which uses a different readline implementation)."}, {"owner": {"reputation": 435, "user_id": 3162261, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/06813697a52abdc3b82be98f99d479ba?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3162261/chris"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485528771, "post_id": 41895260, "comment_id": 70975571, "body": "@JimB Could you explain the meaning of readline further? Does it read the actually line (in the sense of what is/was typed on the CLI) or can I provide the values it should go through?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1485528858, "post_id": 41895260, "comment_id": 70975641, "body": "readline is a standard library used by interactive CLIs: <a href=\"https://en.wikipedia.org/wiki/GNU_Readline\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/GNU_Readline</a>"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1485529775, "post_id": 41895260, "comment_id": 70976368, "body": "@Chris The readline package is the solution for &quot;interactive shell&quot; case, the cobra package is for the &quot;user enters the command in system shell and program exits after doing it&#39;s thing&quot; case."}], "answers": [{"tags": [], "owner": {"reputation": 435, "user_id": 3162261, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/06813697a52abdc3b82be98f99d479ba?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3162261/chris"}, "is_accepted": false, "score": 0, "last_activity_date": 1485539410, "creation_date": 1485539410, "answer_id": 41900070, "question_id": 41895260, "link": "https://stackoverflow.com/questions/41895260/implementing-auto-autocomplete-for-cli-application/41900070#41900070", "title": "Implementing auto autocomplete for CLI application", "body": "<p>Thank you @ain and @JimB for pointing me in the right direction.</p>\n\n<p>Based on the example provided at <a href=\"https://github.com/chzyer/readline/tree/master/example/readline-demo\" rel=\"nofollow noreferrer\">https://github.com/chzyer/readline/tree/master/example/readline-demo</a> I was able to achieve the desired functionality.</p>\n\n<p>The following code has to main commands <code>newEntry</code> and <code>newCategory</code>. If the user types <code>newEntry</code> and than presses TAB he can choose from the available categories. The <code>newCategory</code> command allow to add a new custom category which is immediately available the next time <code>newEntry</code> is executed.</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"log\"\n    \"strconv\"\n    \"strings\"\n\n    \"github.com/chzyer/readline\"\n)\n\n// completer defines which commands the user can use\nvar completer = readline.NewPrefixCompleter()\n\n// categories holding the initial default categories. The user can  add categories.\nvar categories = []string{\"Category A\", \"Category B\", \"Category C\"}\n\nvar l *readline.Instance\n\nfunc main() {\n\n// Initialize config\nconfig := readline.Config{\n    Prompt:          \"\\033[31m\u00bb\\033[0m \",\n    HistoryFile:     \"/tmp/readline.tmp\",\n    AutoComplete:    completer,\n    InterruptPrompt: \"^C\",\n    EOFPrompt:       \"exit\",\n\n    HistorySearchFold: true,\n}\n\nvar err error\n// Create instance\nl, err = readline.NewEx(&amp;config)\nif err != nil {\n    panic(err)\n}\ndefer l.Close()\n\n// Initial initialization of the completer\nupdateCompleter(categories)\n\nlog.SetOutput(l.Stderr())\n// This loop watches for user input and process it\nfor {\n    line, err := l.Readline()\n    if err == readline.ErrInterrupt {\n        if len(line) == 0 {\n            break\n        } else {\n            continue\n        }\n    } else if err == io.EOF {\n        break\n    }\n\n    line = strings.TrimSpace(line)\n    // Checking which command the user typed\n    switch {\n    // Add new category\n    case strings.HasPrefix(line, \"newCategory\"):\n        // Remove the \"newCategory \" prefix (including space)\n        if len(line) &lt;= 12 {\n            log.Println(\"newCategory &lt;NameOfCategory&gt;\")\n            break\n        }\n        // Append everything that comes behind the command as the name of the new category\n        categories = append(categories, line[12:])\n        // Update the completer to make the new category available in the cmd\n        updateCompleter(categories)\n    // Program is closed when user types \"exit\"\n    case line == \"exit\":\n        goto exit\n    // Log all commands we don't know\n    default:\n        log.Println(\"Unknown command:\", strconv.Quote(line))\n    }\n}\nexit:\n}\n\n// updateCompleter is updates the completer allowing to add new command during runtime. The completer is recreated\n// and the configuration of the instance update.\nfunc updateCompleter(categories []string) {\n\nvar items []readline.PrefixCompleterInterface\n\nfor _, category := range categories {\n    items = append(items, readline.PcItem(category))\n}\n\ncompleter = readline.NewPrefixCompleter(\n    readline.PcItem(\"newEntry\",\n        items...,\n    ),\n    readline.PcItem(\"newCategory\"),\n)\n\nl.Config.AutoComplete = completer\n}\n</code></pre>\n"}], "owner": {"reputation": 435, "user_id": 3162261, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/06813697a52abdc3b82be98f99d479ba?s=128&d=identicon&r=PG&f=1", "display_name": "Chris", "link": "https://stackoverflow.com/users/3162261/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1809, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1485539410, "creation_date": 1485524196, "question_id": 41895260, "link": "https://stackoverflow.com/questions/41895260/implementing-auto-autocomplete-for-cli-application", "title": "Implementing auto autocomplete for CLI application", "body": "<p>I am looking into writing a CLI application in Go.</p>\n\n<p>One of the requirements is auto complete. Not of the command itself but of possible options.</p>\n\n<p>Imagine I want to add a new entry using the CLI. Each entry can have a category.\nThe categories are available in a slice. What I want to do now is to enable the user to tab through the available categories when typing in <code>add</code>.</p>\n\n<p>I am aware of libraries like <a href=\"https://github.com/chzyer/readline\" rel=\"nofollow noreferrer\">https://github.com/chzyer/readline</a> and <a href=\"https://github.com/spf13/cobra\" rel=\"nofollow noreferrer\">https://github.com/spf13/cobra</a> but could not find if or how they support this.</p>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1485523884, "post_id": 41895016, "comment_id": 70972155, "body": "Don&#39;t ignore the error returned by Write/WriteAll. The examples in encoding/csv are explanatory."}, {"owner": {"reputation": 735, "user_id": 190833, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c214bae9cd1b284a7006c2d725392747?s=128&d=identicon&r=PG", "display_name": "FrontierPsycho", "link": "https://stackoverflow.com/users/190833/frontierpsycho"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1485524020, "post_id": 41895016, "comment_id": 70972240, "body": "It&#39;s in the official docs!"}], "answers": [{"comments": [{"owner": {"reputation": 735, "user_id": 190833, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c214bae9cd1b284a7006c2d725392747?s=128&d=identicon&r=PG", "display_name": "FrontierPsycho", "link": "https://stackoverflow.com/users/190833/frontierpsycho"}, "edited": false, "score": 0, "creation_date": 1485524133, "post_id": 41895195, "comment_id": 70972317, "body": "Thanks. I know this is a very common pattern in go, that&#39;s why I was curious to see the example use a different approach. I wonder if I&#39;m missing some errors with the returned error, that the method catches. Like perhaps if <code>Flush</code> throws."}], "tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": false, "score": 0, "last_activity_date": 1485523988, "creation_date": 1485523988, "answer_id": 41895195, "question_id": 41895016, "link": "https://stackoverflow.com/questions/41895016/encoding-csv-should-i-use-error-with-writeall/41895195#41895195", "title": "encoding/csv: Should I use Error() with WriteAll()?", "body": "<p>As far as i can see you can use both, i would propose to use the error from</p>\n\n<pre><code>err := w.WriteAll(records)\n</code></pre>\n\n<p>this is more common in go.</p>\n\n<p>All errors returned are coming from the *bufio.Writer, and if it fails it will always return an error. So if w.WriteAll returns an error a call to Error() will also return an error.</p>\n"}], "owner": {"reputation": 735, "user_id": 190833, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c214bae9cd1b284a7006c2d725392747?s=128&d=identicon&r=PG", "display_name": "FrontierPsycho", "link": "https://stackoverflow.com/users/190833/frontierpsycho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1485523988, "creation_date": 1485523476, "question_id": 41895016, "link": "https://stackoverflow.com/questions/41895016/encoding-csv-should-i-use-error-with-writeall", "title": "encoding/csv: Should I use Error() with WriteAll()?", "body": "<p>In the golang docs for <a href=\"https://golang.org/pkg/encoding/csv/#Writer.WriteAll\" rel=\"nofollow noreferrer\">encoding/csv</a>, <code>WriteAll</code> is stated to <code>Write</code> the given CSV records, and then to call <code>Flush</code> on the underlying writer. </p>\n\n<p>Now, I'm confused as to whether I should detect errors during <code>WriteAll</code> via its return value, or the <code>Error()</code> method. Let me explain why.</p>\n\n<ul>\n<li><code>Write</code> returns <code>error</code>. This makes me think I can detect errors based on its return value.</li>\n<li><code>Flush</code> doesn't return <code>error</code>, and the docs explicitly say \"To check if an error occurred during the Flush, call Error.\"</li>\n<li><p><code>WriteAll</code> mentions nothing about error handling, but it returns <code>error</code>, and states it performs both <code>Write</code> and <code>Flush</code>. The docs include an example that goes like this:</p>\n\n<pre><code>w := csv.NewWriter(os.Stdout)\nw.WriteAll(records) // calls Flush internally\n\nif err := w.Error(); err != nil {\n    log.Fatalln(\"error writing csv:\", err)\n}\n</code></pre></li>\n<li><p><code>Error()</code> itself states: \"Error reports any error that has occurred during a previous <strong>Write or Flush</strong>.\" (emphasis mine).</p></li>\n</ul>\n\n<p>I looked at the code and I saw some shenanigans I wasn't familiar with, so I'm turning the question to SO.</p>\n\n<p>Which is it, then? Should I look at the returned <code>error</code>? Should I use <code>w.Error()</code>? Should I use both? What's the difference? </p>\n"}, {"tags": ["go", "erlang", "elixir"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 1, "creation_date": 1485522680, "post_id": 41894046, "comment_id": 70971343, "body": "Maybe explain why you think it&#39;s not equivalent ?"}, {"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "reply_to_user": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1485522774, "post_id": 41894046, "comment_id": 70971405, "body": "I&#39;m just not sure.."}, {"owner": {"reputation": 49824, "user_id": 192702, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/aec924d6fd4f693e4a93c1f463c5023a?s=128&d=identicon&r=PG", "display_name": "Patrick Oscity", "link": "https://stackoverflow.com/users/192702/patrick-oscity"}, "edited": false, "score": 1, "creation_date": 1485523143, "post_id": 41894046, "comment_id": 70971645, "body": "Are you trying to benchmark the performance of spawning processes in Go vs. Elixir? Just a wild guess, but IO may become your bottleneck. Also there&#39;s an off by one error in your elixir code, you&#39;re actually spawning n+1 processes - although that won&#39;t make much of a difference here. To get a meaningful benchmark, it would be interesting to know what type of work you actually want to perform in the processes."}, {"owner": {"reputation": 187800, "user_id": 320615, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/65c80e12b6a33913538653f6d4ef1277?s=128&d=identicon&r=PG", "display_name": "Dogbert", "link": "https://stackoverflow.com/users/320615/dogbert"}, "edited": false, "score": 2, "creation_date": 1485528882, "post_id": 41894046, "comment_id": 70975668, "body": "Looks pretty much equivalent to me. I get a ~15-20% speed up if I put the code in a mix package, compile it, and then run it. Even if I remove <code>IO.puts</code> from Elixir completely, it&#39;s still only 30% faster than the current one, and way slower than the Go numbers you&#39;ve posted."}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1485583207, "post_id": 41894046, "comment_id": 70995716, "body": "Note the RAM consumption. It would be interesting to see how Go will handle 500000. Also, strictly speaking the equivalent would be <code>1..k |&gt; Enum.each(fn n -&gt; spawn fn - &gt; IO.puts n end end)</code>. Tail recursion should matter."}, {"owner": {"reputation": 25491, "user_id": 49197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15ebf24a33a29b9efbf9924f530dd736?s=128&d=identicon&r=PG", "display_name": "Hynek -Pichi- Vychodil", "link": "https://stackoverflow.com/users/49197/hynek-pichi-vychodil"}, "reply_to_user": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "edited": false, "score": 0, "creation_date": 1485590156, "post_id": 41894046, "comment_id": 70996976, "body": "@mudasobwa How is your version any different in tail recursion matter?"}, {"owner": {"reputation": 105308, "user_id": 2035262, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/pPtKA.jpg?s=128&g=1", "display_name": "Aleksei Matiushkin", "link": "https://stackoverflow.com/users/2035262/aleksei-matiushkin"}, "reply_to_user": {"reputation": 25491, "user_id": 49197, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/15ebf24a33a29b9efbf9924f530dd736?s=128&d=identicon&r=PG", "display_name": "Hynek -Pichi- Vychodil", "link": "https://stackoverflow.com/users/49197/hynek-pichi-vychodil"}, "edited": false, "score": 0, "creation_date": 1485590350, "post_id": 41894046, "comment_id": 70997022, "body": "@Hynek-Pichi-Vychodil I meant, it\u2019s absence should matter. I have benchmarked it, though: it does not. Simple iteration in 3% faster."}, {"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "edited": false, "score": 0, "creation_date": 1487824034, "post_id": 41894046, "comment_id": 71960638, "body": "<code>1..k |&gt; Enum.each(fn n -&gt; spawn fn -&gt; IO.puts n end end)</code> version does not give correct number of line, just like first go version"}], "answers": [{"tags": [], "owner": {"reputation": 2297, "user_id": 2528006, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/mIt9a.jpg?s=128&g=1", "display_name": "Kelu Thatsall", "link": "https://stackoverflow.com/users/2528006/kelu-thatsall"}, "is_accepted": true, "score": 3, "last_activity_date": 1485596397, "last_edit_date": 1485596397, "creation_date": 1485595002, "answer_id": 41908127, "question_id": 41894046, "link": "https://stackoverflow.com/questions/41894046/how-to-spawn-n-k-light-process-in-erlang-or-elixir/41908127#41908127", "title": "How to spawn n-k light-process in erlang or elixir?", "body": "<p>I'm sorry guys but I'm not convinced that this code in Go is really working as expected. I'm not an expert, so please correct me if I'm wrong. First of all it prints <code>z</code> which it seems is a current value of it in global scope (usually <code>k*1000</code>) <a href=\"https://play.golang.org/p/a4TJyjKBQh\" rel=\"nofollow noreferrer\">https://play.golang.org/p/a4TJyjKBQh</a></p>\n\n<pre><code>// test.go\npackage main\nimport (\n  \"fmt\"\n  \"time\"\n)\n\nfunc main() {\n\n  for z:=0; z&lt;1000; z++ {\n    go func(x int) { // I'm passing z to the function with current value now\n      fmt.Println(x) \n    }(z)\n  }\n\n  time.Sleep(1 * time.Nanosecond)\n\n}\n</code></pre>\n\n<p>And also if I comment out <code>Sleep</code> the program will exit before even starting any goroutines (at least it doesn't print out the results). I would be happy to know if I'm doing something wrong, but from this simple example it seems the problem is not with <code>Elixir</code>, but <code>Go</code> code provided. Some <code>Go</code> gurus out there?</p>\n\n<p>I've also run some test on my local machine:</p>\n\n<pre><code>go run test.go 500 | wc -l\n72442 # expected 500000\ngo run test.go 5000 | wc -l\n76274 # expected 5000000\n</code></pre>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 497, "favorite_count": 4, "accepted_answer_id": 41908127, "answer_count": 1, "score": 3, "last_activity_date": 1594315389, "creation_date": 1485520184, "last_edit_date": 1594315389, "question_id": 41894046, "link": "https://stackoverflow.com/questions/41894046/how-to-spawn-n-k-light-process-in-erlang-or-elixir", "title": "How to spawn n-k light-process in erlang or elixir?", "body": "<p>In Go I can create goroutines like this (<em>EDITED</em> as reported by <a href=\"https://stackoverflow.com/users/2528006/\">kelu-thatsall</a>'s answer):</p>\n<pre><code>// test.go\npackage main\n\nimport (\n        &quot;fmt&quot;\n        &quot;os&quot;\n        &quot;strconv&quot;\n        &quot;sync&quot;\n        &quot;runtime&quot;\n)\n\nfunc main() {\n        var wg sync.WaitGroup\n        if len(os.Args) &lt; 2 {\n                os.Exit(1)\n        }\n        k, ok := strconv.Atoi(os.Args[1])\n        if ok != nil {\n                os.Exit(2)\n        }\n        wg.Add(k * 1000)\n        for z := 0; z &lt; k*1000; z++ {\n            go func(x int) {\n                    defer wg.Done()\n                    fmt.Println(x)\n            }(z)\n            if z%k == k-1 {\n                // @mattn: avoid busy loop, so Go can start processing like BEAM do \n                runtime.Gosched() \n            }\n        }\n        wg.Wait()\n}\n</code></pre>\n<p>The result in Go 1.8.0 (64-bit):</p>\n<pre><code># shell    \n$ go build test.go ; for k in 5 50 500 5000 50000 500000; do echo -n $k; time ./test $k &gt; /dev/null; done\n\n5\nCPU: 0.00s      Real: 0.00s     RAM: 2080KB\n50\nCPU: 0.06s      Real: 0.01s     RAM: 3048KB\n500\nCPU: 0.61s      Real: 0.12s     RAM: 7760KB\n5000\nCPU: 6.02s      Real: 1.23s     RAM: 17712KB # 17 MB\n50000\nCPU: 62.30s     Real: 12.53s    RAM: 207720KB # 207 MB\n500000\nCPU: 649.47s    Real: 131.53s   RAM: 3008180KB # 3 GB\n</code></pre>\n<p>What's the equivalent code in Erlang or Elixir? (<em>EDITED</em> as reported by <a href=\"https://stackoverflow.com/users/192702/\">patrick-oscity</a>'s comment)</p>\n<p>What I've tried so far is the following:</p>\n<pre><code># test.exs\ndefmodule Recursion do\n  def print_multiple_times(n) when n &lt;= 1 do\n    spawn fn -&gt; IO.puts n end\n  end\n\n  def print_multiple_times(n) do\n    spawn fn -&gt; IO.puts n end\n    print_multiple_times(n - 1)\n  end\nend\n\n[x]=System.argv()\n{k,_}=Integer.parse(x)\nk=k*1000\nRecursion.print_multiple_times(k)\n</code></pre>\n<p>The result in elixir 1.4.2 (erts-8.2.2):</p>\n<pre><code># shell    \n$ for k in 5 50 500 5000 50000 ; do echo -n $k; time elixir --erl &quot;+P 90000000&quot; test.exs $k &gt; /dev/null; done\n\n5\nCPU: 0.53s      Real: 0.50s     RAM: 842384KB # 842 MB\n50\nCPU: 1.50s      Real: 0.62s     RAM: 934276KB # 934 MB\n500\nCPU: 11.92s     Real: 2.53s     RAM: 1675872KB # 1.6 GB\n5000\nCPU: 122.65s    Real: 20.20s    RAM: 4336116KB # 4.3 GB\n50000\nCPU: 1288.65s   Real: 209.66s   RAM: 6573560KB # 6.5 GB\n</code></pre>\n<p>But I'm not sure if the two are equivalent. Are they ?</p>\n<p><em>EDIT</em> Shortened version as <a href=\"https://stackoverflow.com/users/2035262/mudasobwa\">mudasobwa</a>'s comment does not give correct output</p>\n<pre><code># test2.exs\n[x]=System.argv()\n{k,_}=Integer.parse(x)\nk=k*1000\n1..k |&gt; Enum.each(fn n -&gt; spawn fn -&gt; IO.puts n end end)\n</code></pre>\n<p>The result <code>for k in 5 50 500 5000 50000 ; do echo -n $k; time elixir --erl &quot;+P 90000000&quot; test.exs $k | wc -l ; done</code>:</p>\n<pre><code>5\nCPU: 0.35s      Real: 0.41s     RAM: 1623344KB # 1.6 GB\n2826 # does not complete, this should be 5000\n50\nCPU: 1.08s      Real: 0.53s     RAM: 1691060KB # 1.6 GB\n35062\n500\nCPU: 8.69s      Real: 1.70s     RAM: 2340200KB # 2.3 GB\n373193\n5000        \nCPU: 109.95s    Real: 18.49s    RAM: 4980500KB # 4.9 GB\n4487475\n50000\nerl_child_setup closed\nCrash dump is being written to: erl_crash.dump...Command terminated by signal 9\nCPU: 891.35s    Real: 157.52s   RAM: 24361288KB # 24.3 GB\n</code></pre>\n<p>Not testing 500m for elixir because it took too long and <code>+P 500000000</code> argument is <code>bad number of processes</code></p>\n<p><a href=\"https://i.stack.imgur.com/758Z1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/758Z1.png\" alt=\"microbenchmark result\" /></a></p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 872, "user_id": 7094618, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/2b28131a8f0db8c2f50e449414f92175?s=128&d=identicon&r=PG", "display_name": "Faegy", "link": "https://stackoverflow.com/users/7094618/faegy"}, "edited": false, "score": 0, "creation_date": 1485517053, "post_id": 41893086, "comment_id": 70968064, "body": "Add some code as examples please."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1485541996, "post_id": 41895242, "comment_id": 70983758, "body": "You can easily omit an entry from a slice though.  <code>yourStruct = append(yourStruct[:2], yourStruct[3:]...)</code>.  As long as the slice has a length of 3 or more, that won&#39;t panic (even though index 3 in a slice of length 3 is an invalid index, the runtime is coded to handle it properly)."}], "tags": [], "owner": {"reputation": 7377, "user_id": 2652524, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/f59a118231057a2afd3d02f2b0be8ce1?s=128&d=identicon&r=PG", "display_name": "Gujarat Santana", "link": "https://stackoverflow.com/users/2652524/gujarat-santana"}, "is_accepted": true, "score": 0, "last_activity_date": 1485586692, "last_edit_date": 1495535367, "creation_date": 1485524141, "answer_id": 41895242, "question_id": 41893086, "link": "https://stackoverflow.com/questions/41893086/removing-a-specific-element-from-a-json-array-in-golang/41895242#41895242", "title": "Removing a specific element from a json array in golang", "body": "<p>Let's say that you have successfully parsed your data to struct.\nAnd you would have an array of yourStruct <code>[]yourStruct</code>, and assign the third element with empty struct like this :</p>\n\n<pre><code>yourStruct[2] = YourStruct{}\n</code></pre>\n\n<p>the third element is still there with empty value. And unfortunately in go you can't assign struct with <code>nil</code> value. </p>\n\n<p>or you can convert the <code>[]byte</code> of your data that has your json to <code>string</code> and iterate it over to the their element and remove it with empty char, but this would be an expensive approach.</p>\n\n<p>As <a href=\"https://stackoverflow.com/users/4551301/kaedys\">Kaedys</a> said you can remove your array struct using slice like this :</p>\n\n<pre><code>yourStruct = yourStruct[:2]\nfmt.Printf(\"resutl struct = %+v\\n\", yourStruct)\n</code></pre>\n"}], "owner": {"reputation": 97, "user_id": 5391763, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/7c0ea35805214e297dbeb54c116e99c9?s=128&d=identicon&r=PG&f=1", "display_name": "Zozo", "link": "https://stackoverflow.com/users/5391763/zozo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1222, "favorite_count": 0, "accepted_answer_id": 41895242, "answer_count": 1, "score": 1, "last_activity_date": 1485586692, "creation_date": 1485516982, "last_edit_date": 1485518244, "question_id": 41893086, "link": "https://stackoverflow.com/questions/41893086/removing-a-specific-element-from-a-json-array-in-golang", "title": "Removing a specific element from a json array in golang", "body": "<p>I tried a few options but with no results. If anyone knows some kind of solution it would be nice. I was trying with <a href=\"http://github.com/buger/jsonparser\" rel=\"nofollow noreferrer\">buger/jsonparser</a> because of the parsing speed. Lets say i want to exclude object3 and assign it to MYVARIABLE</p>\n\n<p>for exaple :</p>\n\n<pre><code>data:=[{object1}, {object2}, {object3}]\n\n//this function iterates through the array\njsonparser.ArrayEach(data, func(key []byte, dataType jsonparser.ValueType, offset int, err error) {\n\n    MYVARIABLE:=key\n\n    return\n})\n</code></pre>\n"}, {"tags": ["json", "go", "reflection", "types"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1485513150, "last_edit_date": 1592644375, "creation_date": 1485508115, "answer_id": 41890288, "question_id": 41890150, "link": "https://stackoverflow.com/questions/41890150/unmarshaljson-any-type-from-interface-possible/41890288#41890288", "title": "UnmarshalJSON any type from []interface{} possible?", "body": "<p>You can unmarshal any type into a value of type <code>interface{}</code>. If you use a value of type <code>[]interface{}</code>, you can only unmarshal JSON arrays into it, but yes, the elements of the array may be of any type.</p>\n<p>Since you're using <code>interface{}</code> or <code>[]interface{}</code>, yes, type information is not available, and it's up to the <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> package to choose the best it sees fit. For example, for JSON objects it will choose <code>map[string]interface{}</code>. The full list of default types is documented in <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\"><code>json.Unmarshal()</code></a>:</p>\n<blockquote>\n<p>To unmarshal JSON into an interface value, Unmarshal stores one of these in the interface value:</p>\n<pre><code>bool, for JSON booleans\nfloat64, for JSON numbers\nstring, for JSON strings\n[]interface{}, for JSON arrays\nmap[string]interface{}, for JSON objects\nnil for JSON null\n</code></pre>\n</blockquote>\n<p>Obviously if your JSON marshaling/unmarshaling logic needs some pre- / postprocessing, the <code>json</code> package will not miraculously find it out. It can know about those only if you unmarshal into values of specific types (which implement <a href=\"https://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow noreferrer\"><code>json.Unmarshaler</code></a>). The <code>json</code> package will still be able to unmarshal them to the default types, but custom logic will obviously not run on them.</p>\n"}], "owner": {"reputation": 5764, "user_id": 1336532, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/93e5830761f6e85757991d5915369349?s=128&d=identicon&r=PG", "display_name": "Mahoni", "link": "https://stackoverflow.com/users/1336532/mahoni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 254, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1485513150, "creation_date": 1485507598, "question_id": 41890150, "link": "https://stackoverflow.com/questions/41890150/unmarshaljson-any-type-from-interface-possible", "title": "UnmarshalJSON any type from []interface{} possible?", "body": "<p>When you unmarshal JSON to <code>[]interface{}</code> is there any way to automatically detect the type besides some standard types like bool, int and string?</p>\n\n<p>What I noticed is the following, Let's say I marshal <a href=\"https://github.com/satori/go.uuid\" rel=\"nofollow noreferrer\"><code>[uuid.UUID, bool]</code></a> then the JSON I get looks like:</p>\n\n<pre><code>[[234,50,7,116,194,41,64,225,177,151,60,195,60,45,123,106],true]\n</code></pre>\n\n<p>When I unmarshal it again, I get the types as shown through <code>reflect</code>:</p>\n\n<p><code>[]interface{}, bool</code></p>\n\n<p>I don't understand why it picked <code>[]interface{}</code>. If it cannot detect it, shouldn't it be at least <code>interface{}</code>?</p>\n\n<p>In any case, my question is, is it possible to unmarshal any type when the target is of type <code>[]interface{}</code>? It seems to work for standard types like string, bool, int but for custom types I don't think that's possible, is it? You can define custom JSON marshal/unmarshal methods but that only works if you decode it into a target type so that it can look up which custom marshal/unmarshal methods to use.</p>\n"}, {"tags": ["go", "gopath"], "comments": [{"owner": {"reputation": 10230, "user_id": 2427222, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4h1qN.png?s=128&g=1", "display_name": "ymonad", "link": "https://stackoverflow.com/users/2427222/ymonad"}, "edited": false, "score": 1, "creation_date": 1485503205, "post_id": 41889021, "comment_id": 70960261, "body": "current go supports vendoring so 4 won&#39;t be a problem: <a href=\"https://golang.org/cmd/go/#hdr-Vendor_Directories\" rel=\"nofollow noreferrer\">golang.org/cmd/go/#hdr-Vendor_Directories</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1362, "user_id": 6486607, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/e6c5ef2e01327de3ee7c2913832c15c1?s=128&d=identicon&r=PG&f=1", "display_name": "Razvan Alex", "link": "https://stackoverflow.com/users/6486607/razvan-alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1485509379, "creation_date": 1485509379, "answer_id": 41890649, "question_id": 41889021, "link": "https://stackoverflow.com/questions/41889021/whats-the-sense-of-having-all-projects-in-a-single-gopath-workspace/41890649#41890649", "title": "whats the sense of having all projects in a single GOPATH workspace?", "body": "<p>Using an GOPATH workspace is usefull to keep all the installed packages or binaries in the same folders to make the developer's job easier. You are not bound to use it straight forward. Since the compiler doesn't care about you're <code>go</code> files path, you can always create a separate folder for you're projects, just specify the entry file and the output of the compiled file..as simple as that ;)</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": true, "score": 1, "last_activity_date": 1485510289, "creation_date": 1485510289, "answer_id": 41890947, "question_id": 41889021, "link": "https://stackoverflow.com/questions/41889021/whats-the-sense-of-having-all-projects-in-a-single-gopath-workspace/41890947#41890947", "title": "whats the sense of having all projects in a single GOPATH workspace?", "body": "<p>GOPATH simplify automation, developers tools heavily use it which was design goal. And GOPATH like OS PATH is a list i.e.</p>\n\n<pre><code>export GOPATH = PATH1:PATH2:PATH3\n</code></pre>\n\n<p>that can answer some your questions.</p>\n"}], "owner": {"reputation": 12424, "user_id": 345859, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/cdb711788e4473ecd856108533787144?s=128&d=identicon&r=PG&f=1", "display_name": "Jas", "link": "https://stackoverflow.com/users/345859/jas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 41890947, "answer_count": 2, "score": 0, "last_activity_date": 1485512501, "creation_date": 1485502909, "last_edit_date": 1485512501, "question_id": 41889021, "link": "https://stackoverflow.com/questions/41889021/whats-the-sense-of-having-all-projects-in-a-single-gopath-workspace", "title": "whats the sense of having all projects in a single GOPATH workspace?", "body": "<p>Why does it makes sense? I can think of many reasons i want many workspaces:</p>\n\n<ol>\n<li>I work for two companies.</li>\n<li>I have home projects and work projects.</li>\n<li>I have multiple go versions.</li>\n<li>I'm working on two versions of a library</li>\n</ol>\n"}, {"tags": ["go", "compiler-errors"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7210680"}, "is_accepted": true, "score": 1, "last_activity_date": 1485502950, "creation_date": 1485502950, "answer_id": 41889031, "question_id": 41888915, "link": "https://stackoverflow.com/questions/41888915/undefined-type-float32-has-no-field-or-method-sum-error-how-do-i-fix-it/41889031#41889031", "title": "undefined &lt;type float32 has no field or method sum&gt; error.How do I fix it?", "body": "<p>Your variable <code>a</code> in the loop shadows the variable <code>a</code> representing Addition. Changing your loop to this will solve the problem:</p>\n\n<pre><code>for _, v := range input[1:] {\n    a.sum += v      \n}\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 6661634, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/4ec239aa2f9a59d1a62c707c92c3d19a?s=128&d=identicon&r=PG&f=1", "display_name": "codinggirl", "link": "https://stackoverflow.com/users/6661634/codinggirl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 0, "accepted_answer_id": 41889031, "answer_count": 1, "score": 0, "last_activity_date": 1485502950, "creation_date": 1485502429, "question_id": 41888915, "link": "https://stackoverflow.com/questions/41888915/undefined-type-float32-has-no-field-or-method-sum-error-how-do-i-fix-it", "title": "undefined &lt;type float32 has no field or method sum&gt; error.How do I fix it?", "body": "<p>this is my program.When I run it, it gives the following error - a.sum undefined (type float32 has no field or method sum)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Calculation interface {\n    operation(input []float32)\n}\n\ntype Addition struct {\n    sum float32\n}\n\n\nfunc (a Addition) operation(input []float32) {\n    a.sum = input[0]\n    for _, a := range input[1:] {\n        a.sum += a      \n    }\n    fmt.Println(\"Sum :\", a.sum)\n}\nfunc main() {\n  var n int\n    fmt.Println(\"Enter the no of inputs  : \")\n    fmt.Scanln(&amp;n)    \n    var input []float32\n    input = make([]float32 , n)\n    fmt.Println(\"Enter the numbers \")\n    for i:=0 ; i &lt;n ; i++ {\n    fmt.Scanln(&amp;input[i])\n    }\n   var c Calculation\ni := Addition{0}\n        c = i\nc.operation(input)\n}\n</code></pre>\n\n<p>I have written 3 more functions Subtraction , Multiplication and Division with Addition. All of them follow similar format but those three run with out any error, Only addition is giving this error. Unable to figure out why.</p>\n"}]