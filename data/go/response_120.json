[{"tags": ["django", "go"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 7824318, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V4p_VN3ufQk/AAAAAAAAAAI/AAAAAAAAD3Y/H1b7inb8yfQ/photo.jpg?sz=128", "display_name": "dawid kraus", "link": "https://stackoverflow.com/users/7824318/dawid-kraus"}, "edited": false, "score": 0, "creation_date": 1493258271, "post_id": 43646078, "comment_id": 74342964, "body": "Thank you I appreciate the answer :)"}], "tags": [], "owner": {"reputation": 1343, "user_id": 3185502, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c65699a0d998330d47145a96b2b54b2?s=128&d=identicon&r=PG&f=1", "display_name": "Vasif", "link": "https://stackoverflow.com/users/3185502/vasif"}, "is_accepted": false, "score": 5, "last_activity_date": 1493248611, "creation_date": 1493248611, "answer_id": 43646078, "question_id": 43645860, "link": "https://stackoverflow.com/questions/43645860/how-to-incorporate-golang-in-to-your-website/43646078#43646078", "title": "How to incorporate Golang in to your website?", "body": "<p>Go is a Programming Language and can be used to write the server for your web application.</p>\n\n<p>This requires completely replacing django with equivalent code written in Go. You will most possibly need a web framework written on top of Go. For ex. Revel. If you want an analogy, Go is like Python. Revel is like Django. </p>\n\n<p>This is a big change in your architecture. If performance is the only issue of your working website, you might want to improve the bottlenecks by just using python and django. Django and Python provide a powerful platform that can scale your application to a practically large number of users.</p>\n\n<p>There is also ways that you can change only small parts of your infrastructure by incorporating Go. Look for micro-services architecture in order to think on those lines.</p>\n"}], "owner": {"reputation": 83, "user_id": 7824318, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-V4p_VN3ufQk/AAAAAAAAAAI/AAAAAAAAD3Y/H1b7inb8yfQ/photo.jpg?sz=128", "display_name": "dawid kraus", "link": "https://stackoverflow.com/users/7824318/dawid-kraus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 707, "favorite_count": 1, "closed_date": 1493251266, "answer_count": 1, "score": -1, "last_activity_date": 1493248611, "creation_date": 1493247354, "question_id": 43645860, "link": "https://stackoverflow.com/questions/43645860/how-to-incorporate-golang-in-to-your-website", "closed_reason": "Needs more focus", "title": "How to incorporate Golang in to your website?", "body": "<p>I have a website that uses django and an sql database. I want to use Golang with my website i don't know any way to incorporate. I want it to accelerate my performance in the website because i have some of my \"parts\" (ex. Like Login and Follow its a music site) that are very cpu intensive and need to be optimized a better way. Please Help me.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 109, "user_id": 7509308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d405b4311edae6509c25fc302c72adfd?s=128&d=identicon&r=PG&f=1", "display_name": "sman", "link": "https://stackoverflow.com/users/7509308/sman"}, "is_accepted": false, "score": 0, "last_activity_date": 1493343767, "creation_date": 1493343767, "answer_id": 43670594, "question_id": 43645009, "link": "https://stackoverflow.com/questions/43645009/gomail-v2-quoted-printable-encoding-issue-on-html-email-body/43670594#43670594", "title": "gomail.v2 quoted-printable encoding issue on html email body", "body": "<p>After digging into this problem further, the data inside the mail client <em>should</em> look the way it is shown above, and the HTML does render properly. It turns out that the first link I was looking at didn't work for a completely unrelated reason.</p>\n"}], "owner": {"reputation": 109, "user_id": 7509308, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/d405b4311edae6509c25fc302c72adfd?s=128&d=identicon&r=PG&f=1", "display_name": "sman", "link": "https://stackoverflow.com/users/7509308/sman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 192, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493343767, "creation_date": 1493242975, "question_id": 43645009, "link": "https://stackoverflow.com/questions/43645009/gomail-v2-quoted-printable-encoding-issue-on-html-email-body", "title": "gomail.v2 quoted-printable encoding issue on html email body", "body": "<p>I'm using gomail.v2 to send html email messages. There is a problem with the encoding / decoding of the html. Here are the relevant the lines of code:</p>\n\n<pre><code>    m := gomail.NewMessage()\n\n    // ... a bunch of lines removed, for clarity...\n\n    s, err := GenerateBodyHTML(si.MsgFName, si.Hostname, &amp;p, t)\n    if err != nil {\n        return err\n    }\n    m.SetBody(\"text/html\", s)\n\n    err = d.DialAndSend(m)\n</code></pre>\n\n<p>I generate the HTML as a string and I verified that it is correct -- I can write the contents of s to a file and open that file in a browser and it all looks fine. So, for example, here are a few lines from the middle of s:</p>\n\n<pre><code>&lt;body&gt;\n&lt;a href=\"http://myisolabella.com/\"&gt;&lt;img src=\"http://ec2-54-152-108-202.compute-1.amazonaws.com:8275/iblogosm.png\"&gt;&lt;/a&gt;\n&lt;p&gt;Hello Tom,&lt;/p&gt;\n</code></pre>\n\n<p>But in the 3 email clients I tested, here's what the raw message body looks like:</p>\n\n<pre><code>&lt;body&gt;\n&lt;a href=3D\"http://myisolabella.com/\"&gt;&lt;img src=3D\"http://ec2-54-152-108-202.compute-1.amazonaws.com:8275/iblogosm.png\"&gt;&lt;/a&gt;\n&lt;p&gt;Hello Tom,&lt;/p&gt;\n</code></pre>\n\n<p>So the link and image tags don't work when the message renders. The equal sign is still in quoted-printable form. Here are the relevant headers received by the email client (I removed most of them for brevity, plus nothing else looked relevant):</p>\n\n<pre><code>Content-Type: text/html; charset=UTF-8\nContent-Transfer-Encoding: quoted-printable\n</code></pre>\n\n<p>What do I need to do to get the HTML decoded correctly on the mail client?</p>\n"}, {"tags": ["go", "documentation", "idioms", "godoc"], "comments": [{"owner": {"reputation": 1042, "user_id": 3955539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcbIF.jpg?s=128&g=1", "display_name": "cengineer", "link": "https://stackoverflow.com/users/3955539/cengineer"}, "edited": false, "score": 5, "creation_date": 1493219947, "post_id": 43638249, "comment_id": 74324888, "body": "You may want to look at the following article about it <a href=\"https://blog.golang.org/godoc-documenting-go-code\" rel=\"nofollow noreferrer\">blog.golang.org/godoc-documenting-go-code</a> . It perfectly explains idiomatic way of preparing Godoc"}, {"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "reply_to_user": {"reputation": 1042, "user_id": 3955539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcbIF.jpg?s=128&g=1", "display_name": "cengineer", "link": "https://stackoverflow.com/users/3955539/cengineer"}, "edited": false, "score": 0, "creation_date": 1493219999, "post_id": 43638249, "comment_id": 74324923, "body": "Yeah, I read it, but it&#39;s about packages and exported functions only. Here I have the main package and no exported functions."}, {"owner": {"reputation": 1042, "user_id": 3955539, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HcbIF.jpg?s=128&g=1", "display_name": "cengineer", "link": "https://stackoverflow.com/users/3955539/cengineer"}, "edited": false, "score": 2, "creation_date": 1493220576, "post_id": 43638249, "comment_id": 74325368, "body": "Then most probably you have also read that article <a href=\"https://godoc.org/golang.org/x/tools/cmd/godoc\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/tools/cmd/godoc</a> . Basically when you want to look at the doc of this package/function, you are going to run &quot;godoc main&quot; like you do on any other package, right? So since it is also a package, all idiomatic ways are also valid for that too."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1493231573, "post_id": 43638249, "comment_id": 74332251, "body": "godoc is intended to document Go library APIs; since you can&#39;t import main, there&#39;s nothing in a main package worth documenting from that standpoint. If you want to document what the tool does, README.md or the like is probably the better and more idiomatic solution."}], "answers": [{"comments": [{"owner": {"reputation": 258, "user_id": 1682093, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/TMysJ.jpg?s=128&g=1", "display_name": "n-canter", "link": "https://stackoverflow.com/users/1682093/n-canter"}, "edited": false, "score": 0, "creation_date": 1501269827, "post_id": 43638874, "comment_id": 77723522, "body": "As an example you can look at <a href=\"https://github.com/golang/tools/blob/master/cmd/stringer/stringer.go\" rel=\"nofollow noreferrer\">github.com/golang/tools/blob/master/cmd/stringer/stringer.go</a> and try to run &#39;godoc cmd/stringer&#39;"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 11, "last_activity_date": 1501272609, "last_edit_date": 1501272609, "creation_date": 1493221459, "answer_id": 43638874, "question_id": 43638249, "link": "https://stackoverflow.com/questions/43638249/idiomatic-way-of-documenting-a-golang-program-consisting-of-one-main-go-file/43638874#43638874", "title": "Idiomatic way of documenting a Golang program, consisting of one main.go file", "body": "<p>To document a command for godoc or godoc.org, write the command documentation in the package comment.</p>\n\n<pre><code>// Command foo does bar.\npackage main\n\nfunc main() {\n   // code!\n}\n</code></pre>\n\n<p>See the <a href=\"https://github.com/golang/tools/blob/ac1e4b1998e6a311e006d9629b9283295dee36a3/cmd/stringer/stringer.go#L5-L59\" rel=\"noreferrer\">comment in stringer.go</a> and <a href=\"http://godoc.org/golang.org/x/tools/cmd/stringer\" rel=\"noreferrer\">the stringer documentation</a> for an example.</p>\n\n<p>By default, godoc and godoc.org hide all other doc comments in a package with the name \"main\".</p>\n"}], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1283, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1501272609, "creation_date": 1493219844, "last_edit_date": 1493220198, "question_id": 43638249, "link": "https://stackoverflow.com/questions/43638249/idiomatic-way-of-documenting-a-golang-program-consisting-of-one-main-go-file", "title": "Idiomatic way of documenting a Golang program, consisting of one main.go file", "body": "<p>I wrote a Go tool which reads files and produces output based on the input. It consists of one main.go file. Where do I document what the tool does, in order to make use of godoc (or just be idiomatic)?</p>\n\n<pre><code>// Should I explain it here?\npackage main\n\n// Or here?\nfunc main() {\n    // code!\n}\n\n// Or somewhere else?\n</code></pre>\n"}, {"tags": ["node.js", "go", "travis-ci"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1493216459, "post_id": 43636077, "comment_id": 74322023, "body": "Don&#39;t use nodejs. Write your API tests in Go, and use the standard go testing framework. Then you won&#39;t have the problem, because the Go server will run as part of the testing framework."}, {"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493218370, "post_id": 43636077, "comment_id": 74323609, "body": "Thanks @Flimzy, the point is taken and this is what I will do . Thanks :-)"}], "answers": [{"comments": [{"owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "edited": false, "score": 0, "creation_date": 1493218252, "post_id": 43636958, "comment_id": 74323478, "body": "Thanks, the point is taken, I&#39;m going to transfer the tests right away to Go :-)"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 3, "last_activity_date": 1493290887, "last_edit_date": 1495540012, "creation_date": 1493216580, "answer_id": 43636958, "question_id": 43636077, "link": "https://stackoverflow.com/questions/43636077/how-to-run-a-go-server-in-travis-ci/43636958#43636958", "title": "How to run a Go server in Travis-CI?", "body": "<p>First, you should seriously question whether writing tests in mocha makes sense.  Admittedly, there might be cases when it does make sense (i.e. if you're porting a nodejs app to Go, and already have tests written for node). But even then, you should consider this a stop-gap measure, and write all new tests, and even migrate old tests, to Go as soon as possible.</p>\n\n<p>But that aside, there's no reason you shouldn't be able to just start the process in the background normally.  Perhaps with a shell script called from your Travis config (can often be cleaner and easier to follow than putting all commands in the config directly):</p>\n\n<pre><code>#!/bin/sh\n\ngo run &amp;\n\nmocha\n</code></pre>\n\n<p>If you really must run your tests in an external process, there are certain advantages from starting that from a Go test anyway.  Namely, you can get test coverage stats, and starting can be more easily synchronized (so you don't need a <code>sleep</code>).  To do this, you can follow my advice in <a href=\"https://stackoverflow.com/a/43381703/13860\">this answer</a>. Specifically, for the mocha case:</p>\n\n<p>Write a test file that executes your main() function in a go routine:</p>\n\n<pre><code>func TestMainApp(t *testing.T) {\n    go main() // Or whatever you need to do to start the server process\n    cmd := exec.Command(\"mocha\", ...)\n    cmd.Start()\n}\n</code></pre>\n\n<p>But seriously.  You should write your tests in Go.</p>\n"}, {"tags": [], "owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "is_accepted": false, "score": 0, "last_activity_date": 1493218327, "creation_date": 1493218327, "answer_id": 43637623, "question_id": 43636077, "link": "https://stackoverflow.com/questions/43636077/how-to-run-a-go-server-in-travis-ci/43637623#43637623", "title": "How to run a Go server in Travis-CI?", "body": "<p>Mocha runs directly after <code>- nohup go run ./cmd/server/main.go --scheme=http --port=8080 --host=127.0.0.1 &amp;</code> so the server didn't start up yet.</p>\n\n<p>Adding a sleep was enough.</p>\n\n<pre><code>script:\n  - npm install mocha -g\n  - npm install\n  - nohup go run ./cmd/server/main.go --scheme=http --port=8080 --host=127.0.0.1 &amp;\n  - sleep 4\n  - mocha\n</code></pre>\n\n<p>But, the point is taken, I will move to Go tests :-P</p>\n"}], "owner": {"reputation": 6046, "user_id": 1501285, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/b742182dd480420da7e0e9fe357b2c04?s=128&d=identicon&r=PG", "display_name": "Bob van Luijt", "link": "https://stackoverflow.com/users/1501285/bob-van-luijt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 424, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1493290887, "creation_date": 1493214393, "last_edit_date": 1493217019, "question_id": 43636077, "link": "https://stackoverflow.com/questions/43636077/how-to-run-a-go-server-in-travis-ci", "title": "How to run a Go server in Travis-CI?", "body": "<p>I'm working on a Go project that exposes a RESTful http API.</p>\n\n<p>I want to run the Go project and use Nodejs (Mocha) to test the endpoints. It seems as if the nohup command doesn't keep running in the background.</p>\n\n<p>Locally everything works but I don't seem to be able to get it running in Travis-ci.</p>\n\n<pre><code>language: go\ngo:\n  - 1.8\nenv:\n  - \"PATH=/home/travis/gopath/bin:$PATH\"\nbefore_install:\n  - go get ./...\nscript:\n  - npm install mocha -g\n  - npm install\n  - nohup go run ./cmd/server/main.go --scheme=http --port=8080 --host=127.0.0.1 &amp;\n  - mocha\n</code></pre>\n"}, {"tags": ["http", "url", "go", "routes", "gorilla"], "comments": [{"owner": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 4, "creation_date": 1493213632, "post_id": 43635701, "comment_id": 74319655, "body": "Pass it in a query param and urlencode it. Because depending on what mux you use to parse that, might interpret that differently. Eg.: &#39;?url=https%3A%2F%2Fwww.google.com%2F&#39;"}, {"owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "reply_to_user": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 0, "creation_date": 1493214426, "post_id": 43635701, "comment_id": 74320303, "body": "@BogdanIulianBursuc The only thing is the user will just be passing in the url after the /new parameter. So, they&#39;d first go to <code>www.myapp.heroku.com</code> then get an instruction to pass the url in after /new like so: <code>www.myapp.heroku.com&#47;new&#47;https:&#47;&#47;www.google.com</code>. I don&#39;t know how to pass it in a query param unfortunately."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1493217247, "post_id": 43635701, "comment_id": 74322685, "body": "It should still be URL-encoded. The example URLs given are not valid URLs, so you&#39;ll get no guarantees they&#39;ll work correctly with any parser."}, {"owner": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1493220093, "post_id": 43635701, "comment_id": 74324999, "body": "@Adrian True. And depends also if you have a proxy server in between. Might parse it differently also."}, {"owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "reply_to_user": {"reputation": 2036, "user_id": 2251549, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dc4a07b6f8c1d95e8835b5346a8d3fb7?s=128&d=identicon&r=PG", "display_name": "Bogdan Iulian Bursuc", "link": "https://stackoverflow.com/users/2251549/bogdan-iulian-bursuc"}, "edited": false, "score": 0, "creation_date": 1493265580, "post_id": 43635701, "comment_id": 74344839, "body": "@BogdanIulianBursuc Just to clarify, the urls can&#39;t be passed in a query param and then parsed. The URLs are passed in like in this app: <a href=\"https://little-url.herokuapp.com/\" rel=\"nofollow noreferrer\">little-url.herokuapp.com</a>"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493279953, "post_id": 43635701, "comment_id": 74351223, "body": "I&#39;m little bit confused, you&#39;re building server (which parse the URL) or client (pass URL) with golang? For server side, you need to implement your own <code>Handler</code> or <code>ServeMux</code>, since the default handler will remove the &#39;//&#39; part and give response <code>301</code> (Moved Permanently) to the client."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 2, "last_activity_date": 1493342140, "creation_date": 1493342140, "answer_id": 43670394, "question_id": 43635701, "link": "https://stackoverflow.com/questions/43635701/how-do-i-pass-a-url-as-a-parameter-in-a-golang-route/43670394#43670394", "title": "How do I pass a URL as a parameter in a Golang route?", "body": "<p>After reading <a href=\"https://stackoverflow.com/questions/43626030/why-is-gorillamux-not-allowing-me-to-pass-in-a-url-as-a-parameter\">the other question</a>, I understand what do you mean. Implement a kind of URL re-writer before URL goes to <code>gorilla/mux</code>. The function will look like:</p>\n\n<pre><code>func Rewriter(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        //Simple URL rewriter. Rewrite if it's started with API path\n        pathReq := r.RequestURI\n        if strings.HasPrefix(pathReq, \"/new/\") {\n            //Use url.QueryEscape for pre go1.8\n            pe := url.PathEscape(strings.TrimLeft(pathReq, \"/new/\"))\n            r.URL.Path = \"/new/\" + pe\n            r.URL.RawQuery = \"\"\n        }\n\n        h.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>Wrap gorilla router when starting the http server:</p>\n\n<pre><code>r := mux.NewRouter()\n\n// ... other handler\nr.HandleFunc(\"/new/{original-url}\", NewHandler)\n\n//Wrap mux.Router using Rewriter\nlog.Fatal(http.ListenAndServe(\":8080\", Rewriter(r)))\n</code></pre>\n\n<p>Then in your <code>URL shortener</code> handler, the original URL can be extracted using the following code:</p>\n\n<pre><code>func NewHandler(w http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\n    ou := vars[\"original-url\"]\n    //Use url.QueryUnascape for pre go1.8\n    originalURL, err := url.PathUnescape(ou)\n\n    //... other processing\n}\n</code></pre>\n\n<p>IMHO, implementing <code>URL shortener</code> service like this is not recommended, mainly due to incorrect use of HTTP verbs. Any <code>GET</code> request should not leave side effect in server e.g. no record creation in database, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "is_accepted": true, "score": 2, "last_activity_date": 1520994236, "last_edit_date": 1520994236, "creation_date": 1520992899, "answer_id": 49268678, "question_id": 43635701, "link": "https://stackoverflow.com/questions/43635701/how-do-i-pass-a-url-as-a-parameter-in-a-golang-route/49268678#49268678", "title": "How do I pass a URL as a parameter in a Golang route?", "body": "<p>This particular behavior in Gorilla Mux can be changed by setting SkipClean to <strong>true</strong>.</p>\n\n<pre><code>router := mux.NewRouter()\nrouter.SkipClean(true)\nrouter.HandleFunc(\"/new/\", index)\nrouter.HandleFunc(\"/\", index)\nhttp.ListenAndServe(\":\"+port, router)\n</code></pre>\n\n<p>The relevant documentation can be found <a href=\"http://www.gorillatoolkit.org/pkg/mux#Router.SkipClean\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5991, "favorite_count": 0, "accepted_answer_id": 49268678, "answer_count": 2, "score": 2, "last_activity_date": 1520994236, "creation_date": 1493213441, "question_id": 43635701, "link": "https://stackoverflow.com/questions/43635701/how-do-i-pass-a-url-as-a-parameter-in-a-golang-route", "title": "How do I pass a URL as a parameter in a Golang route?", "body": "<p>I'm trying to pass a URL as a parameter in Golang, and I haven't been able to find a solution in all of the tutorials I've looked at. The problem is that I can only get the url to return minus a crucial forward slash.</p>\n\n<p>My handler looks like this:</p>\n\n<pre><code>router.HandleFunc(\"/new/{url}\", createURL)\n</code></pre>\n\n<p>So the request would look like:</p>\n\n<pre><code>www.myapp.heroku.com/new/https://www.google.com\n</code></pre>\n\n<p>However, the url that I results is missing a slash:</p>\n\n<pre><code>http:/www.google.com\n</code></pre>\n\n<p>I sure it's probably got something to do with RFC3986, but is there a way to pass in the url as it is?</p>\n"}, {"tags": ["go", "exec", "stdout"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 5, "creation_date": 1493219953, "post_id": 43635611, "comment_id": 74324891, "body": "You can use <code>cmd.StdoutPipe</code> and <code>cmd.StderrPipe</code> to get the command output over pipes, which you can read as the data comes in. If you want to read them simultaneously, you&#39;ll need to set up goroutines."}], "answers": [{"tags": [], "owner": {"reputation": 101, "user_id": 254947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e720f13e69e3d9408720bfe758fcb0?s=128&d=identicon&r=PG", "display_name": "ugi", "link": "https://stackoverflow.com/users/254947/ugi"}, "is_accepted": false, "score": 5, "last_activity_date": 1493224072, "creation_date": 1493224072, "answer_id": 43639778, "question_id": 43635611, "link": "https://stackoverflow.com/questions/43635611/continuously-reading-from-exec-cmd-output/43639778#43639778", "title": "continuously reading from exec.Cmd output", "body": "<p>eventually I managed to do it with []bytes</p>\n\n<pre><code>stdout, err := cmd.StdoutPipe()\nbuff := make([]byte,10)\nvar n int\nfor err == nil {\n    n,err = stdout.Read(buff)\n    if n &gt; 0{\n        fmt.Printf(\"taken %d chars %s\",n,string(buff[:n]))\n    }\n}\ncmd.Wait()\nif cmd.ProcessState.Success() {. // ProcessState is set after Wait\n    fmt.Println(\"Script success\")  \n} else {\n    fmt.Println(\"Script failed\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 5561795, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Z0i3f53E6iY/AAAAAAAAAAI/AAAAAAAAEkg/VxUOEbN_GH4/photo.jpg?sz=128", "display_name": "Gaurav Raghuvanshy", "link": "https://stackoverflow.com/users/5561795/gaurav-raghuvanshy"}, "is_accepted": false, "score": 6, "last_activity_date": 1510298249, "creation_date": 1510298249, "answer_id": 47217548, "question_id": 43635611, "link": "https://stackoverflow.com/questions/43635611/continuously-reading-from-exec-cmd-output/47217548#47217548", "title": "continuously reading from exec.Cmd output", "body": "<p>You should use os.StdoutPipe()</p>\n\n<pre><code>func main() {\n    for i := 10; i &lt; 20; i++ {\n        go printName(`My name is Bob, I am ` + strconv.Itoa(i) + ` years old`)\n        // Adding delay so as to see incremental output\n        time.Sleep(60 * time.Millisecond)\n    }\n    // Adding delay so as to let program complete\n    // Please use channels or wait groups\n    time.Sleep(100 * time.Millisecond)\n}\n\nfunc printName(jString string) {\n    cmd := exec.Command(\"echo\", \"-n\", jString)\n    cmdReader, err := cmd.StdoutPipe()\n    if err != nil {\n        log.Fatal(err)\n    }\n    scanner := bufio.NewScanner(cmdReader)\n    go func() {\n        for scanner.Scan() {\n            fmt.Println(scanner.Text())\n        }\n    }()\n    if err := cmd.Start(); err != nil {\n        log.Fatal(err)\n    }\n    if err := cmd.Wait(); err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p>sources that helped me:\n<a href=\"https://nathanleclaire.com/blog/2014/12/29/shelled-out-commands-in-golang/\" rel=\"noreferrer\">nathanleclaire.com</a> \n<a href=\"https://blog.kowalczyk.info/article/wOYk/advanced-command-execution-in-go-with-osexec.html\" rel=\"noreferrer\">blog.kowalczyk.info</a></p>\n"}], "owner": {"reputation": 101, "user_id": 254947, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/43e720f13e69e3d9408720bfe758fcb0?s=128&d=identicon&r=PG", "display_name": "ugi", "link": "https://stackoverflow.com/users/254947/ugi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3586, "favorite_count": 0, "answer_count": 2, "score": 5, "last_activity_date": 1528089082, "creation_date": 1493213213, "question_id": 43635611, "link": "https://stackoverflow.com/questions/43635611/continuously-reading-from-exec-cmd-output", "title": "continuously reading from exec.Cmd output", "body": "<p>Guys I am trying pick new lines as they come from command output, but always I end up doing it synchronous way (I have to wait until script is finished). I tired to use fsnotify but it is working only with regular files, do you have any idea how it can be done ?</p>\n\n<pre><code>package main\nimport (\n   \"fmt\"\n   \"os/exec\"\n   \"bytes\"\n   \"os\"\n)\n\nfunc main() {\n   cmd := exec.Command(\"scripts/long_script\")\n   output := new(bytes.Buffer)\n   cmd.Stdout = output\n   cmd.Stderr = output\n   if err := cmd.Start(); err != nil{ // after Start program is continued and script is executing in background\n     fmt.Printf(\"Failed to start \" + err.Error())\n     os.Exit(1)\n   }\n   fmt.Printf(\" Before WAIT %s \\n\", output.String())  // script is writing but nothing can be read from output\n   cmd.Wait()\n   fmt.Printf(\" After Wait %s \\n\", output.String())  // if we wait to finish execution, we can read all output\n}\n</code></pre>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 1, "creation_date": 1493210222, "post_id": 43633662, "comment_id": 74316714, "body": "You have a space after <code>open</code> and <code>calculator</code> is misspelled. The space before <code>-a</code> may also cause problems. You&#39;re also using <code>Printf()</code> wrong."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493211399, "post_id": 43633662, "comment_id": 74317705, "body": "You are using fmt.Print<b>F</b>."}, {"owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "edited": false, "score": 0, "creation_date": 1493288594, "post_id": 43633662, "comment_id": 74357340, "body": "spaces between  after open  and before -a were causing issue."}], "answers": [{"comments": [{"owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "edited": false, "score": 0, "creation_date": 1493209106, "post_id": 43633810, "comment_id": 74315782, "body": "even with correct spelling same output   =====  2017/04/26 17:45:47  output is err  %!(EXTRA *os.PathError=fork/exec /usr/bin/open : no such file or directory) 2017/04/26 17:45:47  output is out  %!(EXTRA []uint8=[])"}], "tags": [], "owner": {"reputation": 932, "user_id": 6677639, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/59ea151531a76b0019f1319b4aef6cd1?s=128&d=identicon&r=PG&f=1", "display_name": "benwiggy", "link": "https://stackoverflow.com/users/6677639/benwiggy"}, "is_accepted": false, "score": 1, "last_activity_date": 1493208586, "creation_date": 1493208586, "answer_id": 43633810, "question_id": 43633662, "link": "https://stackoverflow.com/questions/43633662/command-execution-on-macosx-in-golang/43633810#43633810", "title": "command execution on MacOSx in golang", "body": "<p>There's a spelling mistake - \"calcultor\" should be \"calculator\".</p>\n"}], "owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 448, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1493208586, "creation_date": 1493208191, "question_id": 43633662, "link": "https://stackoverflow.com/questions/43633662/command-execution-on-macosx-in-golang", "title": "command execution on MacOSx in golang", "body": "<p>I have a simple golang program to start an application in MacOSx.</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"log\"\n    \"os/exec\"\n)\nfunc main() {\nout1,err1 := exec.Command(\"/usr/bin/open \", \" -a\", \"calcultor\").Output()\nlog.Printf(\" output is err  \", err1)\nlog.Printf(\" output is err  \", out1)\n\n}\n</code></pre>\n\n<p>I expect it to start application in calculator after execution but i receive following errors</p>\n\n<blockquote>\n  <p>2017/04/26 16:01:26  output is err%!(EXTRA *os.PathError=fork/exec\n  /usr/bin/open : no such file or directory) 2017/04/26 16:01:26  output\n  is out%!(EXTRA []uint8=[])</p>\n</blockquote>\n\n<p>I am trying it on OSx 10.11.</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493284566, "post_id": 43633108, "comment_id": 74354459, "body": "You need to change the schema manually. See <a href=\"https://www.tutorialspoint.com/sql/sql-alter-command.htm\" rel=\"nofollow noreferrer\">ALTER TABLE</a>."}, {"owner": {"reputation": 83, "user_id": 4913599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200782472959926/picture?type=large", "display_name": "Daniel Morandini", "link": "https://stackoverflow.com/users/4913599/daniel-morandini"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493286194, "post_id": 43633108, "comment_id": 74355662, "body": "@putu that&#39;s what I would like to avoid."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493295040, "post_id": 43633108, "comment_id": 74362019, "body": "How about using <code>gorm</code>&#39;s <a href=\"https://godoc.org/github.com/jinzhu/gorm#DB.ModifyColumn\" rel=\"nofollow noreferrer\">ModifyColumn</a>?. See <a href=\"http://blog.ralch.com/tutorial/golang-object-relation-mapping-with-gorm/\" rel=\"nofollow noreferrer\">this post</a> for example usage."}], "answers": [{"tags": [], "owner": {"reputation": 374, "user_id": 2884012, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wcYlf.jpg?s=128&g=1", "display_name": "Taylor Frey", "link": "https://stackoverflow.com/users/2884012/taylor-frey"}, "is_accepted": true, "score": 2, "last_activity_date": 1494374228, "creation_date": 1494374228, "answer_id": 43881568, "question_id": 43633108, "link": "https://stackoverflow.com/questions/43633108/gorm-upgrading-columns-constraint-with-migration/43881568#43881568", "title": "Gorm - upgrading columns constraint with migration", "body": "<p>When adding a <code>not null</code> constraint, then a <code>default</code> value will also need to be added for when the existing records do not meet the new criteria. The definition could be something like:</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    Name     string   `gorm:\"not null;default:'fillertext'\"`\n}\n</code></pre>\n\n<p>As @putu said, <code>ALTER TABLE</code> will certainly work, but you would still need to add a default value initially to ensure the non-comforming rows meet the new requirements. Once this has been done you can remove the default value if you desire and the migration will work as intended from that point on.</p>\n"}], "owner": {"reputation": 83, "user_id": 4913599, "user_type": "registered", "profile_image": "https://graph.facebook.com/10200782472959926/picture?type=large", "display_name": "Daniel Morandini", "link": "https://stackoverflow.com/users/4913599/daniel-morandini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1456, "favorite_count": 1, "accepted_answer_id": 43881568, "answer_count": 1, "score": 2, "last_activity_date": 1494374228, "creation_date": 1493206658, "question_id": 43633108, "link": "https://stackoverflow.com/questions/43633108/gorm-upgrading-columns-constraint-with-migration", "title": "Gorm - upgrading columns constraint with migration", "body": "<p>How do you perform a Migration with gorm? For example, I need to add a constraint to a column. I changed my model (simplified example below), but the AutoMigrate method, according to the docs, will not change column's constraints. </p>\n\n<p>How do you achieve it then? I cannot find anything useful in the docs</p>\n\n<p>Starting model:</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    Name     string\n}\n</code></pre>\n\n<p>I would like to update it like this:</p>\n\n<pre><code>type User struct {\n    gorm.Model\n    Name     string   `gorm:\"not null\"`\n}\n</code></pre>\n"}, {"tags": ["go", "webserver", "channel", "sigint", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 8, "last_activity_date": 1493255247, "last_edit_date": 1493255247, "creation_date": 1493223572, "answer_id": 43639645, "question_id": 43631854, "link": "https://stackoverflow.com/questions/43631854/gracefully-shutdown-gorilla-server/43639645#43639645", "title": "Gracefully Shutdown Gorilla Server", "body": "<p>Channel can be used to capture shutdown request through API call (<code>/shutdown</code>) or interrupt signal (<code>Ctrl+C</code>). </p>\n\n<ol>\n<li>Embed <code>http.Server</code> into a custom struct, so we can call <a href=\"https://golang.org/pkg/net/http/#Server.Shutdown\" rel=\"noreferrer\">http Server.Shutdown</a> later</li>\n<li>Add channel field (<code>shutdownReq</code>) for passing shutdown request from API call <code>/shutdown</code></li>\n<li>Register http handlers including <code>/shutdown</code> in <code>gorilla/mux</code>'s router, then assign the router to <code>http.Server.Handler</code></li>\n<li>Register <code>os.Interrupt/syscall.SIGINT, syscall.SIGTERM</code> handler</li>\n<li>Use <code>select</code> to capture shutdown request through API call or <code>interrupt</code> signal</li>\n<li>Perform clean shutdown by calling <code>Server.Shutdown</code></li>\n</ol>\n\n<p>Below is the example code:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"log\"\n    \"net/http\"\n    \"sync/atomic\"\n    \"syscall\"\n    \"time\"\n\n    \"os\"\n    \"os/signal\"\n\n    \"github.com/gorilla/mux\"\n)\n\ntype myServer struct {\n    http.Server\n    shutdownReq chan bool\n    reqCount    uint32\n}\n\nfunc NewServer() *myServer {\n    //create server\n    s := &amp;myServer{\n        Server: http.Server{\n            Addr:         \":8080\",\n            ReadTimeout:  10 * time.Second,\n            WriteTimeout: 10 * time.Second,\n        },\n        shutdownReq: make(chan bool),\n    }\n\n    router := mux.NewRouter()\n\n    //register handlers\n    router.HandleFunc(\"/\", s.RootHandler)\n    router.HandleFunc(\"/shutdown\", s.ShutdownHandler)\n\n    //set http server handler\n    s.Handler = router\n\n    return s\n}\n\nfunc (s *myServer) WaitShutdown() {\n    irqSig := make(chan os.Signal, 1)\n    signal.Notify(irqSig, syscall.SIGINT, syscall.SIGTERM)\n\n    //Wait interrupt or shutdown request through /shutdown\n    select {\n    case sig := &lt;-irqSig:\n        log.Printf(\"Shutdown request (signal: %v)\", sig)\n    case sig := &lt;-s.shutdownReq:\n        log.Printf(\"Shutdown request (/shutdown %v)\", sig)\n    }\n\n    log.Printf(\"Stoping http server ...\")\n\n    //Create shutdown context with 10 second timeout\n    ctx, cancel := context.WithTimeout(context.Background(), 10*time.Second)\n    defer cancel()\n\n    //shutdown the server\n    err := s.Shutdown(ctx)\n    if err != nil {\n        log.Printf(\"Shutdown request error: %v\", err)\n    }\n}\n\nfunc (s *myServer) RootHandler(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Hello Gorilla MUX!\\n\"))\n}\n\nfunc (s *myServer) ShutdownHandler(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Shutdown server\"))\n\n    //Do nothing if shutdown request already issued\n    //if s.reqCount == 0 then set to 1, return true otherwise false\n    if !atomic.CompareAndSwapUint32(&amp;s.reqCount, 0, 1) {\n        log.Printf(\"Shutdown through API call in progress...\")\n        return\n    }\n\n    go func() {\n        s.shutdownReq &lt;- true\n    }()\n}\n\nfunc main() {\n    //Start the server\n    server := NewServer()\n\n    done := make(chan bool)\n    go func() {\n        err := server.ListenAndServe()\n        if err != nil {\n            log.Printf(\"Listen and serve: %v\", err)\n        }\n        done &lt;- true\n    }()\n\n    //wait shutdown\n    server.WaitShutdown()\n\n    &lt;-done\n    log.Printf(\"DONE!\")\n}\n</code></pre>\n\n<p><strong>Note</strong>: Please watch <a href=\"https://github.com/golang/go/issues/4674\" rel=\"noreferrer\">this issue</a> which is related to gracefull shutdown.</p>\n"}], "owner": {"reputation": 135, "user_id": 2705941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/45240d9f4697e99dbc4ff5b102cbc413?s=128&d=identicon&r=PG&f=1", "display_name": "Kuzunoha", "link": "https://stackoverflow.com/users/2705941/kuzunoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3114, "favorite_count": 2, "accepted_answer_id": 43639645, "answer_count": 1, "score": 2, "last_activity_date": 1493255247, "creation_date": 1493203187, "question_id": 43631854, "link": "https://stackoverflow.com/questions/43631854/gracefully-shutdown-gorilla-server", "title": "Gracefully Shutdown Gorilla Server", "body": "<p>I'm building a server in go using gorilla multiplexer library found in <a href=\"https://github.com/gorilla/mux\" rel=\"nofollow noreferrer\">https://github.com/gorilla/mux</a>.\nThe problem is, I want it to gracefully shutdown when I'm using Ctrl+C, or when there is a specific API call, for example \"/shutdown\".</p>\n\n<p>I already know that in Go 1.8, graceful shutdown is already implemented. But how to combine it with gorilla multiplexer? Also, how to combine it with SIGINT signal?</p>\n\n<p>Can anyone show me how to do it?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 4, "last_activity_date": 1493199580, "last_edit_date": 1493199580, "creation_date": 1493197654, "answer_id": 43629714, "question_id": 43629475, "link": "https://stackoverflow.com/questions/43629475/go-get-error-when-using-throttled-gopkg-in-throttled-throttled-v2-library/43629714#43629714", "title": "Go get error when using throttled (&quot;gopkg.in/throttled/throttled.v2&quot;) library", "body": "<p>What you see is a <a href=\"https://golang.org/doc/go1.4#canonicalimports\" rel=\"nofollow noreferrer\">Canonical import path introduced in Go 1.4</a>.</p>\n\n<p>The syntax is a line comment in the package declaration, e.g.:</p>\n\n<pre><code>package pdf // import \"rsc.io/pdf\"\n</code></pre>\n\n<p>If canonical import path is specified, you are only allowed to import and go-get the package using its canonical import path, which may be different from the hosting service URL, such as your case.</p>\n\n<p>The package you refer to uses canonical import path, see <a href=\"https://github.com/throttled/throttled/blob/master/doc.go\" rel=\"nofollow noreferrer\">github.com/throttled/throttled/doc.go</a>:</p>\n\n<pre><code>// Package throttled implements rate limiting access to resources such\n// as HTTP endpoints.\npackage throttled // import \"gopkg.in/throttled/throttled.v2\"\n</code></pre>\n\n<p>Canonical import paths are enforced by the go tool. Deleting the comments denoting the the canonical import paths is a really bad way to go about solving your problem.</p>\n\n<p>Simply go get by the canonical import path:</p>\n\n<pre><code>go get gopkg.in/throttled/throttled.v2\n</code></pre>\n\n<p>And then of course use / refer to the packages by the canonical import path, e.g.</p>\n\n<pre><code>import \"gopkg.in/throttled/throttled.v2\"\n</code></pre>\n\n<p>This is also noted on throttled's home page, <a href=\"https://github.com/throttled/throttled#installation\" rel=\"nofollow noreferrer\">Installation section</a>:</p>\n\n<blockquote>\n  <p>throttled uses gopkg.in for semantic versioning: <code>go get gopkg.in/throttled/throttled.v2</code></p>\n</blockquote>\n\n<p>Further posts about the topic:</p>\n\n<p><a href=\"https://docs.google.com/document/d/1jVFkZTcYbNLaTxXD9OcGfn7vYv5hWtPx9--lTx1gPMs/edit\" rel=\"nofollow noreferrer\">Go 1.4 Custom Import Path Checking - Design document</a></p>\n\n<p><a href=\"https://texlution.com/post/golang-canonical-import-paths/\" rel=\"nofollow noreferrer\">Canonical import paths in Golang</a></p>\n"}], "owner": {"reputation": 947, "user_id": 7589131, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f027d0ec78aed0c15818d13f687831f?s=128&d=identicon&r=PG&f=1", "display_name": "litanhua", "link": "https://stackoverflow.com/users/7589131/litanhua"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1493199580, "creation_date": 1493197052, "last_edit_date": 1493199473, "question_id": 43629475, "link": "https://stackoverflow.com/questions/43629475/go-get-error-when-using-throttled-gopkg-in-throttled-throttled-v2-library", "title": "Go get error when using throttled (&quot;gopkg.in/throttled/throttled.v2&quot;) library", "body": "<p>When I attempt to install throttled using <code>go get</code> command:</p>\n\n<pre><code>go get \"github.com/throttled/throttled\"\n</code></pre>\n\n<p>I get the error:</p>\n\n<p><code>can't load package: package github.com/throttled/throttled: code in directory /Users/litanhua/GoglandProjects/cloudstorage/src/github.com/throttled/throttled expects import \"gopkg.in/throttled/throttled.v2\"</code></p>\n"}, {"tags": ["go", "printf"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 3, "last_activity_date": 1493196118, "creation_date": 1493196118, "answer_id": 43629080, "question_id": 43628717, "link": "https://stackoverflow.com/questions/43628717/add-zero-padding-to-numbers-with-fmt-printf/43629080#43629080", "title": "Add zero padding to numbers with fmt.Printf", "body": "<p>Simply replace <code>%d</code> with <code>%02d</code> i.e.</p>\n\n<pre><code>fmt.Printf(\"%d-%s-%02d_%02d:%02d:%02d\\n\", year, month, day, hour, min, sec)\n</code></pre>\n"}], "owner": {"reputation": 251, "user_id": 7923990, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ad61ca14b98f6cde3a7109b252c544c?s=128&d=identicon&r=PG&f=1", "display_name": "icarbajo", "link": "https://stackoverflow.com/users/7923990/icarbajo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "accepted_answer_id": 43629080, "answer_count": 1, "score": 0, "last_activity_date": 1493284836, "creation_date": 1493195107, "last_edit_date": 1493211573, "question_id": 43628717, "link": "https://stackoverflow.com/questions/43628717/add-zero-padding-to-numbers-with-fmt-printf", "title": "Add zero padding to numbers with fmt.Printf", "body": "<p>I have a question about the function fmt.Printf;\nWhy when I use this functions, the program omits the first zero?</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n   \"time\"\n)\n\nfunc main() {\n   now := time.Now()\n   year, month, day := now.Date()\n   hour, min, sec := now.Clock()\n   fmt.Printf(\"%d-%s-%d_%d:%d:%d\\n\", year, month, day, hour, min, sec)\n}\n</code></pre>\n\n<p>That returns: 2017-April-26_10:3:2 at 10h03:02</p>\n\n<p>Can anyone help me?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1493193015, "post_id": 43627252, "comment_id": 74304670, "body": "Your question is quite unclear.  Please clarify what &quot;this&quot; in &quot;Obviously, this isn&#39;t possible&quot; means."}, {"owner": {"reputation": 4984, "user_id": 721578, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/aa50860353d6c6bba575cefe31c5709f?s=128&d=identicon&r=PG", "display_name": "Benjam", "link": "https://stackoverflow.com/users/721578/benjam"}, "reply_to_user": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 0, "creation_date": 1493354185, "post_id": 43627252, "comment_id": 74390349, "body": "&quot;this&quot; meaning the code I have above threw errors for me. Question edited to be more clear."}], "answers": [{"comments": [{"owner": {"reputation": 4984, "user_id": 721578, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/aa50860353d6c6bba575cefe31c5709f?s=128&d=identicon&r=PG", "display_name": "Benjam", "link": "https://stackoverflow.com/users/721578/benjam"}, "edited": false, "score": 0, "creation_date": 1493354641, "post_id": 43627837, "comment_id": 74390473, "body": "I want to force the fact that <code>Foos</code> is a slice of <code>Model</code>. Not just it&#39;s own interface called <code>Models</code>. The slice is being passed into a function, where methods are being run on those elements in the slice that are on the <code>Model</code> interface. So I can&#39;t just create a new interface as it would not be a proper type hint for the function taking in the slice."}, {"owner": {"reputation": 4984, "user_id": 721578, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/aa50860353d6c6bba575cefe31c5709f?s=128&d=identicon&r=PG", "display_name": "Benjam", "link": "https://stackoverflow.com/users/721578/benjam"}, "edited": false, "score": 0, "creation_date": 1493354727, "post_id": 43627837, "comment_id": 74390503, "body": "Thanks for answering, though. I&#39;ve been looking over the code, and what I&#39;m hoping to do just doesn&#39;t seem possible."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1493192258, "creation_date": 1493192258, "answer_id": 43627837, "question_id": 43627252, "link": "https://stackoverflow.com/questions/43627252/create-an-interface-that-is-a-slice-of-another-interface/43627837#43627837", "title": "Create an interface that is a slice of another interface", "body": "<p>Obviously a simple </p>\n\n<pre><code>type Models interface {\n    Prepare(int) ([]Model, error)\n}\ntype Foos []Foo\nfunc (f Foos) Prepare(num int) ([]Model, error) {\n    // do the preparations for Foo slice\n    return nil, nil\n}\nfunc main() {\n    foos := Foos{}\n    models := Models(foos)\n    models.Prepare(17)\n}\n</code></pre>\n\n<p>works.</p>\n\n<p>So what is your actual question? Please see also <a href=\"https://golang.org/doc/faq#covariant_types\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#covariant_types</a> and <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#convert_slice_of_interface</a>\nWhich should make it a bit clearer.</p>\n\n<p>I would recommend to provide function (! not methods) to operate on <code>[]Model</code> and not to abstract the slice-of-model into some higher type.</p>\n"}], "owner": {"reputation": 4984, "user_id": 721578, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/aa50860353d6c6bba575cefe31c5709f?s=128&d=identicon&r=PG", "display_name": "Benjam", "link": "https://stackoverflow.com/users/721578/benjam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1493354208, "creation_date": 1493190494, "last_edit_date": 1493354208, "question_id": 43627252, "link": "https://stackoverflow.com/questions/43627252/create-an-interface-that-is-a-slice-of-another-interface", "title": "Create an interface that is a slice of another interface", "body": "<p>I'd like to do something like the following:</p>\n\n<pre><code>type Model interface {\n    EntityType() string\n    GetKey() *datastore.Key\n    SetKey(*datastore.Key) error\n    PreSave(context.Context) error\n    PostSave(context.Context) error\n    PostLoad(context.Context) error\n}\n\ntype Models []Model interface {\n    Prepare(int) ([]Model, error)\n}\n</code></pre>\n\n<p>So that the struct <code>Models</code> is also an interface and would get implemented by a slice of the structs that implement <code>Model</code>. Something like the following:</p>\n\n<pre><code>type Foo struct {\n    key   *datastore.Key `datastore:\"_\"`\n    // ... other things here\n}\n\n// assume all Model interface funcs are here and valid\n\ntype Foos []Foo\n\nfunc (f *Foos) Prepare (num int) ([]Model, error) {\n    // do the preparations for Foo slice\n}\n</code></pre>\n\n<p>Obviously, the code above throws errors and isn't possible. But is there some code that would produce basically the same functionality? Without using <code>reflect</code> or anything costly like that?</p>\n"}, {"tags": ["go", "blockchain", "libtool", "hyperledger-fabric", "libltdl"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493193100, "post_id": 43626320, "comment_id": 74304721, "body": "Make sure <code>ltdl.h</code> exist in <code>gcc</code>s include directory. Use <code>gcc -xc -E -v -</code> to list up the include directory."}, {"owner": {"reputation": 71, "user_id": 7923102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ffee67dd75353bbdef620389fb660e?s=128&d=identicon&r=PG&f=1", "display_name": "surender", "link": "https://stackoverflow.com/users/7923102/surender"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493198340, "post_id": 43626320, "comment_id": 74308181, "body": "i got this ..       &quot;#include &quot;...&quot; search starts here: #include &lt;...&gt; search starts here: C:/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/includ&zwnj;&#8203;e C:/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../&zwnj;&#8203;../../include C:/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/includ&zwnj;&#8203;e-fixed C:/TDM-GCC-64/bin/../lib/gcc/x86_64-w64-mingw32/5.1.0/../../&zwnj;&#8203;../../x86_64-w64-min&zwnj;&#8203;gw32/include End of search list.`"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493200328, "post_id": 43626320, "comment_id": 74309577, "body": "You have to download developer version of the libtools and put <code>ltdl.h</code> into one of the above directory."}, {"owner": {"reputation": 71, "user_id": 7923102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ffee67dd75353bbdef620389fb660e?s=128&d=identicon&r=PG&f=1", "display_name": "surender", "link": "https://stackoverflow.com/users/7923102/surender"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493203584, "post_id": 43626320, "comment_id": 74311837, "body": "can you share the link where to download developer version of libtools"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493205064, "post_id": 43626320, "comment_id": 74312795, "body": "Its at the link you&#39;ve mentioned in the question. Its called develover files."}], "answers": [{"tags": [], "owner": {"reputation": 163, "user_id": 7446966, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/839f663cf5c9e7b454bf25d57b6a61c3?s=128&d=identicon&r=PG&f=1", "display_name": "Denis Glotov", "link": "https://stackoverflow.com/users/7446966/denis-glotov"}, "is_accepted": false, "score": 16, "last_activity_date": 1494506911, "creation_date": 1494506911, "answer_id": 43915903, "question_id": 43626320, "link": "https://stackoverflow.com/questions/43626320/ltdl-h-not-found-error-while-building-chaincode/43915903#43915903", "title": "ltdl.h Not found error while building chaincode", "body": "<p>It worked for me on ubuntu:\n<code>sudo apt install libltdl-dev</code></p>\n"}, {"tags": [], "owner": {"reputation": 100, "user_id": 6818590, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-EqT3ZP-UYjg/AAAAAAAAAAI/AAAAAAAADOY/aRlQOpwXVzg/photo.jpg?sz=128", "display_name": "Mallikarjuna J S", "link": "https://stackoverflow.com/users/6818590/mallikarjuna-j-s"}, "is_accepted": false, "score": 2, "last_activity_date": 1506522995, "creation_date": 1506522995, "answer_id": 46450669, "question_id": 43626320, "link": "https://stackoverflow.com/questions/43626320/ltdl-h-not-found-error-while-building-chaincode/46450669#46450669", "title": "ltdl.h Not found error while building chaincode", "body": "<p>make sure to add <strong>--tags nopkcs11</strong> to ur go build or go test command. The error should stop appearing </p>\n\n<p>Example : go build --tags nopkcs11</p>\n\n<p>This will compile your chaincode if you are in development and testing your code.</p>\n"}, {"tags": [], "owner": {"reputation": 145, "user_id": 8571900, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_8DjXbuzCII/AAAAAAAAAAI/AAAAAAAAAAo/SzbogRdNXSE/photo.jpg?sz=128", "display_name": "Marshall Fate", "link": "https://stackoverflow.com/users/8571900/marshall-fate"}, "is_accepted": false, "score": 9, "last_activity_date": 1510036084, "creation_date": 1510036084, "answer_id": 47151322, "question_id": 43626320, "link": "https://stackoverflow.com/questions/43626320/ltdl-h-not-found-error-while-building-chaincode/47151322#47151322", "title": "ltdl.h Not found error while building chaincode", "body": "<p>if you are using centos/RHEL 7\nyou can use this code</p>\n\n<pre><code>yum install libtool-ltdl-devel\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1855, "user_id": 1339495, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/fnPSu.jpg?s=128&g=1", "display_name": "malajisi", "link": "https://stackoverflow.com/users/1339495/malajisi"}, "edited": false, "score": 1, "creation_date": 1516725397, "post_id": 48051512, "comment_id": 83802117, "body": "It seems only libtool is enough.                  #sudo apt install libtool"}], "tags": [], "owner": {"reputation": 41, "user_id": 4183576, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UCMXZfZUXAM/AAAAAAAAAAI/AAAAAAAADtI/1FQmi7CIqbw/photo.jpg?sz=128", "display_name": "Enrico Zanardo", "link": "https://stackoverflow.com/users/4183576/enrico-zanardo"}, "is_accepted": false, "score": 4, "last_activity_date": 1514825602, "creation_date": 1514825602, "answer_id": 48051512, "question_id": 43626320, "link": "https://stackoverflow.com/questions/43626320/ltdl-h-not-found-error-while-building-chaincode/48051512#48051512", "title": "ltdl.h Not found error while building chaincode", "body": "<p>On Debian/Ubuntu environment, try using the following command:</p>\n\n<p>sudo apt install libtool libltdl-dev</p>\n"}, {"comments": [{"owner": {"reputation": 5596, "user_id": 39803, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8DWKD.jpg?s=128&g=1", "display_name": "Jared Knipp", "link": "https://stackoverflow.com/users/39803/jared-knipp"}, "edited": false, "score": 0, "creation_date": 1549406641, "post_id": 49761637, "comment_id": 95889350, "body": "Leaving a breadcrumb in case someone else runs into a <code>libltdl is required</code>, i.e for installing XmlSec on OSX. This resolved my issue."}], "tags": [], "owner": {"reputation": 983, "user_id": 6499004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I0fHv3jbsbs/AAAAAAAAAAI/AAAAAAAADUo/bejrpeXzWwg/photo.jpg?sz=128", "display_name": "mahima", "link": "https://stackoverflow.com/users/6499004/mahima"}, "is_accepted": false, "score": 6, "last_activity_date": 1523388945, "creation_date": 1523388945, "answer_id": 49761637, "question_id": 43626320, "link": "https://stackoverflow.com/questions/43626320/ltdl-h-not-found-error-while-building-chaincode/49761637#49761637", "title": "ltdl.h Not found error while building chaincode", "body": "<p>For Mac, make sure you have brew installed. This command worked for me:</p>\n\n<pre><code>brew install libtool\n</code></pre>\n"}], "owner": {"reputation": 71, "user_id": 7923102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37ffee67dd75353bbdef620389fb660e?s=128&d=identicon&r=PG&f=1", "display_name": "surender", "link": "https://stackoverflow.com/users/7923102/surender"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10039, "favorite_count": 2, "answer_count": 5, "score": 6, "last_activity_date": 1531738106, "creation_date": 1493187084, "question_id": 43626320, "link": "https://stackoverflow.com/questions/43626320/ltdl-h-not-found-error-while-building-chaincode", "title": "ltdl.h Not found error while building chaincode", "body": "<p>I am trying to build a chaincode by using <code>go build</code>. when i run Go build command its reporting </p>\n\n<pre><code>.\\hyperledger\\fabric\\vendor\\github.com\\miekg\\pkcs11\\pkcs11.g\u200c\u200bo:29:18: \nfatal error:ltdl.h: No such file or directory\ncompilation terminated\n</code></pre>\n\n<p>I  installed libtools from this <a href=\"http://gnuwin32.sourceforge.net/packages/libtool.htm\" rel=\"noreferrer\">link</a>. But I am getting the same error</p>\n"}, {"tags": ["rest", "http", "go", "backend", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493187441, "post_id": 43626095, "comment_id": 74301350, "body": "How would one encode it before its passed to the function <code>createURL</code>?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493188186, "post_id": 43626095, "comment_id": 74301736, "body": "@AndyMorgan what do you exactly mean? It is the client&#39;s responsibility to do that"}, {"owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493188605, "post_id": 43626095, "comment_id": 74301997, "body": "I don&#39;t know what you mean by it&#39;s the client&#39;s responsibility to do that. I&#39;ll need to do it. I won&#39;t have a form on a page that will encode the URL. The site is <code>localhost:8080</code> and then the user passes in the URL to be shortened as <code>localhost:8080&#47;new&#47;https:&#47;&#47;www.example.com</code>."}, {"owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493190319, "post_id": 43626095, "comment_id": 74302959, "body": "The URL shortener is meant to be functionally similar to this: <a href=\"https://little-url.herokuapp.com/\" rel=\"nofollow noreferrer\">little-url.herokuapp.com</a>"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493192381, "post_id": 43626095, "comment_id": 74304247, "body": "@AndyMorgan it&#39;s not gorilla mux that requires it, but the URL RFC <a href=\"https://tools.ietf.org/html/rfc3986#section-3.3\" rel=\"nofollow noreferrer\">tools.ietf.org/html/rfc3986#section-3.3</a> Whoever generates your urls must specify them properly encoded."}, {"owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493193407, "post_id": 43626095, "comment_id": 74304871, "body": "I&#39;m totally in agreement that that would be one way of doing it, where the client (or the frontend) passes in an encoded url, it would certainly solve my problem. But, I&#39;m not doing it that way, the user needs to pass in the url to be shortened unencoded. I do appreciate your answer to my question, that was helpful, but my next question was: How would one encode it before its passed to the function? I&#39;m trying to figure out how to do that in my main.go file."}, {"owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493193875, "post_id": 43626095, "comment_id": 74305149, "body": "I did see QueryEscape, but how would one encode it before its passed to the function using QueryEscape?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493194039, "post_id": 43626095, "comment_id": 74305261, "body": "Before &quot;what&quot; is passed to &quot;what&quot; function?"}, {"owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493194461, "post_id": 43626095, "comment_id": 74305502, "body": "Before the url is passed to the function <code>createURL</code>. So, this is my code: <code>router.HandleFunc(&quot;&#47;new&#47;{url}&quot;, createURL)</code>, could I encode the url before it is passed to the function, <code>createURL</code> using QueryEscape?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "edited": false, "score": 0, "creation_date": 1493194898, "post_id": 43626095, "comment_id": 74305785, "body": "You cannot. By the moment the url reaches your code it&#39;s already broken. The <b>properly encoded url</b> must be generated by whoever makes a request. So if you type the URL manually in your browser - you must manually type the properly encoded url."}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": false, "score": 3, "last_activity_date": 1493186073, "creation_date": 1493186073, "answer_id": 43626095, "question_id": 43626030, "link": "https://stackoverflow.com/questions/43626030/why-is-gorillamux-not-allowing-me-to-pass-in-a-url-as-a-parameter/43626095#43626095", "title": "Why is GorillaMux not allowing me to pass in a URL as a parameter?", "body": "<p>You need to encode it so that the slash in the parameter was not confused as a part of the url:</p>\n\n<pre><code>localhost:8080/new/https%3A%2F%2Fwww.google.com\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 6053536, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/SqlOh.jpg?s=128&g=1", "display_name": "Andy Morgan", "link": "https://stackoverflow.com/users/6053536/andy-morgan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 180, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493189987, "creation_date": 1493185805, "last_edit_date": 1493189987, "question_id": 43626030, "link": "https://stackoverflow.com/questions/43626030/why-is-gorillamux-not-allowing-me-to-pass-in-a-url-as-a-parameter", "title": "Why is GorillaMux not allowing me to pass in a URL as a parameter?", "body": "<p>I'm building a URL shortener API and I'm trying to pass a URL into a function using GorillaMux. The route handler is like so:</p>\n\n<pre><code>router.HandleFunc(\"/new/{url}\", createURL)\n</code></pre>\n\n<p>The only thing is, if I pass in: <a href=\"https://www.google.com\" rel=\"nofollow noreferrer\">https://www.google.com</a> (as in localhost:8080/new/<a href=\"https://www.google.com\" rel=\"nofollow noreferrer\">https://www.google.com</a>) then it responds with <code>404 page not found</code> and the URL is changed to https:/www.google.com.</p>\n\n<p>I've tried adding a regexp pattern in with the {url} bit like so: {url:[a-zA-Z0-9/]+} but that didn't seem to work and seems a bit overkill since I'm checking the url is correct elsewhere.</p>\n"}, {"tags": ["go", "tcp"], "comments": [{"owner": {"reputation": 1642, "user_id": 1509169, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/8MgOC.jpg?s=128&g=1", "display_name": "Alexander R.", "link": "https://stackoverflow.com/users/1509169/alexander-r"}, "edited": false, "score": 1, "creation_date": 1493194298, "post_id": 43625720, "comment_id": 74305401, "body": "It seems like you execution flow blocked on &quot;c &lt;- bodyString&quot;. It may happens when there isn&#39;t exist any consumer for channel. Please, sure that that you don&#39;t have any error here &quot; conn, _ := net.Dial(&quot;tcp&quot;, Config.Edeserver)&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493213792, "post_id": 43625720, "comment_id": 74319800, "body": "To start, you&#39;re not checking the errors from <code>net.Dial</code> or <code>ReadString</code>, you aren&#39;t closing the tcp connection, and if you were to try and read multiple messages, you&#39;re throwing away the <code>bufio.Reader</code>, which may have buffered data. You also only call <code>tcp.Dial</code> once then exit the goroutine, so even if it works it could only be for the very first http request."}], "answers": [{"comments": [{"owner": {"reputation": 290, "user_id": 3731154, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/add6d86ee1fc413feba633e3cd30f70e?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/3731154/harry"}, "edited": false, "score": 0, "creation_date": 1493219040, "post_id": 43637384, "comment_id": 74324233, "body": "nope that is not true openConnectionTotcp has a chan argument and that go routine reads from it  <code>func openConnectionTotcp(edechannel chan string) {                 conn, _ := net.Dial(&quot;tcp&quot;, Config.Edeserver)                 text := &lt;-edechannel                 fmt.Fprintf(conn, text+&quot;\\n&quot;)                 message, _ := bufio.NewReader(conn).ReadString(&#39;\\n&#39;)                 fmt.Print(&quot;Message from server: &quot; + message)             } </code>"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 290, "user_id": 3731154, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/add6d86ee1fc413feba633e3cd30f70e?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/3731154/harry"}, "edited": false, "score": 0, "creation_date": 1493219363, "post_id": 43637384, "comment_id": 74324479, "body": "That routine will consume a single message, then return, after which any writes to the channel will block forever. You also throw away the error from tcp.Dial, so who knows what&#39;s happening in that routine."}, {"owner": {"reputation": 290, "user_id": 3731154, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/add6d86ee1fc413feba633e3cd30f70e?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/3731154/harry"}, "edited": false, "score": 0, "creation_date": 1493223741, "post_id": 43637384, "comment_id": 74327642, "body": "tcp dial does work as I am running  a local tcp server and I do see messages on tcp server side. the client that make curl request is hanging. how <code>That routine will consume a single message, then return,</code> would it return as I am not closing the channel in the first place"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 290, "user_id": 3731154, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/add6d86ee1fc413feba633e3cd30f70e?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/3731154/harry"}, "edited": false, "score": 1, "creation_date": 1493224746, "post_id": 43637384, "comment_id": 74328255, "body": "It doesn&#39;t matter if you close the channel or not, the function returns. Knowing your TCP listener gets a call doesn&#39;t tell you that Dial was successful. Unproven assumptions lead to defects!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1493217672, "creation_date": 1493217672, "answer_id": 43637384, "question_id": 43625720, "link": "https://stackoverflow.com/questions/43625720/tcp-client-not-working-correcty-golang/43637384#43637384", "title": "TCP client not working correcty golang", "body": "<p>Your code execution blocks at <code>c &lt;- bodyString</code> because nothing appears to be reading from that unbuffered channel. That line will pause execution until another routine reads from the channel.</p>\n"}], "owner": {"reputation": 290, "user_id": 3731154, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/add6d86ee1fc413feba633e3cd30f70e?s=128&d=identicon&r=PG&f=1", "display_name": "harry", "link": "https://stackoverflow.com/users/3731154/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 427, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493217672, "creation_date": 1493184428, "question_id": 43625720, "link": "https://stackoverflow.com/questions/43625720/tcp-client-not-working-correcty-golang", "title": "TCP client not working correcty golang", "body": "<p>I have rest-ful interface written in golang. I need to do the authentication on each endpoint. once authentication is done I have to forward it back to a tcp server. \nI created a tcp client and any value that is coming from the channel is to be send to tcp server. the channel is populated from the http request body.\nThe issue is that once I issue curl command the client is stuck with no response; so obviously I am doing something wrong not sure what is wrong. does anyone have any insights on what my problem might be?</p>\n\n<pre><code> package main\n\n            import (\n                \"bufio\"\n                \"encoding/json\"\n                \"flag\"\n                \"fmt\"\n                \"io/ioutil\"\n                \"log\"\n                \"net\"\n                \"net/http\"\n                \"net/http/httputil\"\n                \"net/url\"\n                \"os\"\n                \"strconv\"\n\n                auth \"github.com/abbot/go-http-auth\"\n            )\n\n            type Configuration struct {\n                Server        string\n                Port          int64\n                UserName      string\n                Pwd           string\n                Realm         string\n                ProxyPort     int64\n                Edeserver     string\n\n            }\n\n            var (\n                Config *Configuration\n                logp   = flag.Bool(\"log\", false, \"enable logging\")\n            )\n\n            func ReadConfiguration() {\n                file, _ := os.Open(\"Config.json\")\n                decoder := json.NewDecoder(file)\n                Config = &amp;Configuration{}\n                err := decoder.Decode(&amp;Config)\n                if err != nil {\n                    fmt.Println(\"error:\", err)\n                }\n\n            }\n\n            func Secret(user, realm string) string {\n                if user == Config.UserName {\n                    // password is \"hello\"\n                    return Config.Pwd\n                }\n                return \"\"\n            }\n\n            func reverseProxyTows(w http.ResponseWriter, authenticatedRequest *auth.AuthenticatedRequest) {\n                req := &amp;authenticatedRequest.Request\n\n                if *logp {\n                    log.Println(\" Authenticated Username \", authenticatedRequest.Username)\n                    log.Println(\" Authenticated URL \", req.URL.RequestURI())\n                }\n\n                destinationURL := fmt.Sprintf(\"http://%s:%d\", Config.Server, Config.Port)\n                u, err := url.Parse(destinationURL)\n                if err != nil {\n                    log.Fatal(err)\n                }\n\n                if *logp {\n                    log.Println(\"reverse_proxy\", u)\n                }\n\n                reverseProxy := httputil.NewSingleHostReverseProxy(u)\n\n                reverseProxy.ServeHTTP(w, req)\n            }\n\n            func openConnectionTotcp(edechannel chan string) {\n                conn, _ := net.Dial(\"tcp\", Config.Edeserver)\n                text := &lt;-edechannel\n                fmt.Fprintf(conn, text+\"\\n\")\n                message, _ := bufio.NewReader(conn).ReadString('\\n')\n                fmt.Print(\"Message from server: \" + message)\n            }\n\n\n            func main() {\n                ReadConfiguration()\n                flag.Parse()\n                c := make(chan string)\n                go openConnectionTotcp(c)\n\n                fmt.Printf(\"Started proxy to destination server %v:%d and is listening on %d \", Config.Server, Config.Port, Config.ProxyPort)\n\n                authenticator := auth.NewBasicAuthenticator(Config.Realm, Secret)\n                http.HandleFunc(\"/\", authenticator.Wrap(reverseProxyTows))\n                http.HandleFunc(\"/tyrion/1\", authenticator.Wrap(func(w http.ResponseWriter, authenticatedRequest *auth.AuthenticatedRequest) {\n                    req := &amp;authenticatedRequest.Request\n                    bodyBytes, err2 := ioutil.ReadAll(req.Body)\n                    if err2 != nil {\n                        log.Fatal(err2)\n                    }\n                    bodyString := string(bodyBytes)\n                    c &lt;- bodyString\n                    fmt.Fprintf(w, \"success\")\n                }))\n                http.ListenAndServe(\":\"+strconv.FormatInt(Config.ProxyPort, 10), nil)\n            }\n</code></pre>\n"}, {"tags": ["go", "odbc", "filemaker"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493188708, "post_id": 43625560, "comment_id": 74302057, "body": "What do you get if you scan the value into a variable having <code>[]byte</code> type instead of <code>sql.NullString</code>?"}, {"owner": {"reputation": 597, "user_id": 2836841, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5aed770572ea9c55247ac7bee8cea36f?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2836841/ben"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493190683, "post_id": 43625560, "comment_id": 74303170, "body": "If I change it to <code>[]byte</code> and use the same print statement without the string (<code>log.Print(p.FirstName)</code>) I get no values in the array i.e. <code>[]</code> is printed."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493191718, "post_id": 43625560, "comment_id": 74303803, "body": "How if you change the driver from <code>mgodbc</code> to <a href=\"https://github.com/alexbrainman/odbc\" rel=\"nofollow noreferrer\"><code>odbc</code> driver</a> (just change the import part)?"}, {"owner": {"reputation": 597, "user_id": 2836841, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5aed770572ea9c55247ac7bee8cea36f?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2836841/ben"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493244524, "post_id": 43625560, "comment_id": 74339080, "body": "That has fixed it. Thank you so much. If you make it an answer, I am happy to make it the answer. It would be even better if you can offer any insight into what might have been wrong with the <code>mgodbc</code> driver so I can learn something about <code>odbc</code> drivers/<code>golang</code>."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 1, "last_activity_date": 1493258567, "creation_date": 1493258567, "answer_id": 43647443, "question_id": 43625560, "link": "https://stackoverflow.com/questions/43625560/odbc-in-go-returning-null-blank-records/43647443#43647443", "title": "ODBC in Go Returning Null/Blank Records", "body": "<p>Golang odbc driver is a wrapper of system's odbc driver (<code>odbc32.dll, unixODBC</code>, etc). If you got any result when executing the query in SQL Server, it eliminates the probability of query error or system's driver problem. Then the problem will be in golang's driver (<code>mgodbc</code>) side. Possible issues:</p>\n\n<ol>\n<li>The driver failed to convert query result due to mismatch/unsupported data type (e.g. you store the string in the database table as binary, etc). So the first try was <code>scan the result to []byte</code>. </li>\n<li>The driver failed to convert query result due to bug. Try using <a href=\"https://github.com/alexbrainman/odbc\" rel=\"nofollow noreferrer\">another odbc driver</a>.</li>\n</ol>\n\n<p>Because the database in question is not available to us, its impossible for us to reproduce the problem. To learn what was the problem, please use debugger. Personally I'm using <a href=\"https://code.visualstudio.com/docs/languages/go\" rel=\"nofollow noreferrer\">Visual Studio Code</a>. To setup the debugger, please refer to <a href=\"https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code\" rel=\"nofollow noreferrer\">VS Code and delve debugger</a>.</p>\n\n<p>My guess, the problem exist in <a href=\"https://bitbucket.org/miquella/mgodbc/src/2207dbb576082c34dacb4e887357ecfa99e011d5/mgodbc.go?at=default&amp;fileviewer=file-view-default\" rel=\"nofollow noreferrer\"><code>mgodbc's Next</code></a> function (line number 781-1011). The <code>odbc's</code> implementation of <code>Next</code> function is available <a href=\"https://github.com/alexbrainman/odbc/blob/master/rows.go\" rel=\"nofollow noreferrer\">here</a> (line 35). The function relies on <a href=\"https://github.com/alexbrainman/odbc/blob/master/column.go\" rel=\"nofollow noreferrer\"><code>column.Value</code></a> function (line 116-165) to convert the query result. Using debugger, you can observe variable(s), expression(s) and compare how these drivers handle query result conversion. </p>\n"}], "owner": {"reputation": 597, "user_id": 2836841, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5aed770572ea9c55247ac7bee8cea36f?s=128&d=identicon&r=PG&f=1", "display_name": "Ben", "link": "https://stackoverflow.com/users/2836841/ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 593, "favorite_count": 0, "accepted_answer_id": 43647443, "answer_count": 1, "score": 0, "last_activity_date": 1493258567, "creation_date": 1493183659, "question_id": 43625560, "link": "https://stackoverflow.com/questions/43625560/odbc-in-go-returning-null-blank-records", "title": "ODBC in Go Returning Null/Blank Records", "body": "<p>I am trying to connect a Go REST API to a backend FileMaker based database over ODBC.</p>\n\n<p>I have successfully installed the FileMaker ODBC drivers on Windows and the DSN is working.</p>\n\n<p>I am using the <code>mgodbc</code> package in Go to connect to the DB.</p>\n\n<p>However, while the connection works (no runtime error), I just get blank/null records back when I run a query. I have the following code to create a DB connection: </p>\n\n<pre><code>func NewDB(dataSourceName string) (*DB, error) {\n\n    db, err := sql.Open(\"mgodbc\", dataSourceName)\n    if err != nil {\n        return nil, err\n    }\n    if err = db.Ping(); err != nil {\n        return nil, err\n    }\n\n    // TEST\n\n    return &amp;DB{db}, nil\n}\n</code></pre>\n\n<p>This gets called from my <code>main</code> method as follows: <code>db, err := md.NewDB(\"DSN=cet_registrations2;Uid=*****;Pwd=*****;\")</code>. I then call one of my query methods and try to read it into a model <code>struct</code>. I have simplified my query to make it easier:</p>\n\n<pre><code>func (db *DB) GetStudent(id int) (*Student, error) {\n\n    s := new(Student)\n    p := new(PersonalDetails)\n\n    log.Println(id)\n\n    rows, err := db.Query(\"SELECT FN_Gn_Pn FROM STUDENTS\")\n\n    i := 0\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer rows.Close()\n    for rows.Next() {\n        i++\n        err := rows.Scan(&amp;p.FirstName)\n        log.Print(p.FirstName.String)\n        log.Printf(strconv.Itoa(i))\n        if err != nil {\n            log.Fatal(err)\n        }\n    }\n    err = rows.Err()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    s.ID = 34114\n    s.Details = p\n\n    return s, err\n}\n</code></pre>\n\n<p>and I am reading into the following <code>struct</code>:</p>\n\n<pre><code>import (\n    \"database/sql\"\n\n    u \"sydney.edu.au/bric9018/cet.api/util\"\n)\n\ntype PersonalDetails struct {\n\n    // Unique identifier for person\n    ID int32 `json:\"id,omitempty\"`\n\n    // First name of person\n    FirstName sql.NullString `json:\"firstName,omitempty\"`\n\n    // Last name of person.\n    LastName sql.NullString `json:\"lastName,omitempty\"`\n\n    // Person nominated preferrered name.\n    PreferredName sql.NullString `json:\"preferredName,omitempty\"`\n\n    // Person's SSO username for University systems\n    Unikey sql.NullString `json:\"unikey,omitempty\"`\n\n    // Person's personal email\n    PersonalEmail sql.NullString `json:\"personalEmail,omitempty\"`\n\n    // Sydney University email\n    UniEmail sql.NullString `json:\"uniEmail,omitempty\"`\n\n    // Person's date of birth\n    Dob u.NullTime `json:\"dob,omitempty\"`\n}\n</code></pre>\n\n<p>However, I just get completely blank rows when I print the value scanned into the model using <code>log.Print(p.FirstName.String)</code>. I don't seem to be getting any values read back by scan into my <code>struct</code>. Why is this? </p>\n\n<p>P.S. the query definitely returns values when I run it in SQL Server over a linked server connection against the FileMaker DB.</p>\n"}, {"tags": ["arrays", "json", "go", "unmarshalling", "decoding"], "answers": [{"comments": [{"owner": {"reputation": 618, "user_id": 1804506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/I4BqR.jpg?s=128&g=1", "display_name": "Ilker Mutlu", "link": "https://stackoverflow.com/users/1804506/ilker-mutlu"}, "edited": false, "score": 4, "creation_date": 1496923714, "post_id": 43624723, "comment_id": 75867802, "body": "That json-to-go is a real lifesaver. Thanks!"}], "tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": 13, "last_activity_date": 1564705645, "last_edit_date": 1564705645, "creation_date": 1493178786, "answer_id": 43624723, "question_id": 43624404, "link": "https://stackoverflow.com/questions/43624404/golang-how-to-parse-unmarshal-decode-a-json-array-api-response/43624723#43624723", "title": "Golang :How to parse/unmarshal/decode a json array API response?", "body": "<p>Struct declarations can be nested inside one another.</p>\n\n<p>The following struct should be convertable from that json:</p>\n\n<pre><code>type resp struct {\n    Items []struct {\n        Project string `json:\"project\"`\n        Article string `json:\"article\"`\n        Granularity string `json:\"granularity\"`\n        Timestamp string `json:\"timestamp\"`\n        Access string `json:\"access\"`\n        Agent string `json:\"agent\"`\n        Views int `json:\"views\"`\n    } `json:\"items\"`\n}\n</code></pre>\n\n<p>I generated that with <a href=\"https://mholt.github.io/json-to-go/\" rel=\"noreferrer\">json-to-go</a>, which is a great time saver when working with JSON APIs. </p>\n"}, {"tags": [], "owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "is_accepted": true, "score": 8, "last_activity_date": 1493179169, "creation_date": 1493179169, "answer_id": 43624782, "question_id": 43624404, "link": "https://stackoverflow.com/questions/43624404/golang-how-to-parse-unmarshal-decode-a-json-array-api-response/43624782#43624782", "title": "Golang :How to parse/unmarshal/decode a json array API response?", "body": "<p>Your solution:</p>\n\n<pre><code>data := struct {\n    Items []struct {\n        Project string `json:\"project\"`\n        Article string `json:\"article\"`\n        Granularity string `json:\"granularity\"`\n        Timestamp string `json:\"timestamp\"`\n        Access string `json:\"access\"`\n        Agent string `json:\"agent\"`\n        Views int `json:\"views\"`\n    } `json:\"items\"`\n}{}\n\n// you don't need to convert body to []byte, ReadAll returns []byte\n\nerr := json.Unmarshal(body, &amp;data)\nif err != nil { // don't forget handle errors\n}\n</code></pre>\n"}], "owner": {"reputation": 315, "user_id": 7458586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f8350ea836f4b7a49248ef8ea5bfd32?s=128&d=identicon&r=PG&f=1", "display_name": "Natalie Williams", "link": "https://stackoverflow.com/users/7458586/natalie-williams"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7325, "favorite_count": 1, "accepted_answer_id": 43624782, "answer_count": 2, "score": 8, "last_activity_date": 1564705645, "creation_date": 1493176695, "last_edit_date": 1493180659, "question_id": 43624404, "link": "https://stackoverflow.com/questions/43624404/golang-how-to-parse-unmarshal-decode-a-json-array-api-response", "title": "Golang :How to parse/unmarshal/decode a json array API response?", "body": "<p>I am trying to parse the response from Wikipedia's API located at <code>https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/Smithsonian_Institution/daily/20160101/20170101</code> into an array of structs of which I will proceed to print out the view count</p>\n\n<p>However, the code that I have tried to implement in order to achieve this returns nothing in the terminal when I build and run it?</p>\n\n<p>The code I am failing to succeed with is as follows.</p>\n\n<pre><code>   type Post struct {\n    Project string `json:\"project\"`\n    Article string `json:\"article\"`\n    Granularity string `json:\"granularity\"`\n    Timestamp string `json:\"timestamp\"`\n    Access string `json:\"access\"`\n    Agent string `json:\"agent\"`\n    Views int `json:\"views\"`\n}\n\nfunc main(){\n    //The name of the wikipedia post\n    postName := \"Smithsonian_Institution\"\n\n    //The frequency of\n    period := \"daily\"\n\n    //When to start the selection\n    startDate := \"20160101\"\n\n    //When to end the selection\n    endDate := \"20170101\"\n\n    url := fmt.Sprintf(\"https://wikimedia.org/api/rest_v1/metrics/pageviews/per-article/en.wikipedia.org/all-access/all-agents/%s/%s/%s/%s\", postName, period, startDate, endDate)\n\n    //Get from URL\n    req, err := http.Get(url)\n    if err != nil{\n        return\n    }\n    defer req.Body.Close()\n\n    var posts []Post\n\n    body, err := ioutil.ReadAll(req.Body)\n    if err != nil {\n        panic(err.Error())\n    }\n\n    json.Unmarshal(body, &amp;posts)\n\n    // Loop over structs and display the respective views.\n    for p := range posts {\n        fmt.Printf(\"Views = %v\", posts[p].Views)\n        fmt.Println()\n    }\n\n}\n</code></pre>\n\n<p>What is the optimal method of receiving a json response from a API such as the one mentioned above and thereafter parsing that array into an array of structs, which can then be inserted into a datastore or printed out accordingly.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "gorilla", "negroni"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493181842, "post_id": 43624016, "comment_id": 74299030, "body": "See <a href=\"https://stackoverflow.com/questions/43601359/how-do-i-serve-css-and-js-in-go-lang\">this similar QA</a>"}], "answers": [{"comments": [{"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1493205511, "post_id": 43630798, "comment_id": 74313167, "body": "I&#39;m on MacOS (and running on Heroku in build). Assuming you mean the full path to static? This doesn&#39;t work.  \tr.Handle(&quot;/&quot;, http.FileServer(http.Dir(&quot;frontend/build/&quot;))) \thttp.Handle(&quot;/static/&quot;, http.StripPrefix(&quot;/static/&quot;, http.FileServer(http.Dir(&quot;frontend/build/static/&quot;)))) \tr.PathPrefix(&quot;/api&quot;).Handler(auth)"}, {"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "reply_to_user": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1493210962, "post_id": 43630798, "comment_id": 74317305, "body": "http.Dir(&quot;frontend/build/static/&quot;) doesn&#39;t specify a correct path. You either need to start the path with &quot;/&quot; to signify the root of your machine (so the path would be something like /home/myuser/myapp/static) or with &quot;./&quot; to specify the current directory you are running your app from as the starting point of your path (so if you are running from &quot;/home/myuser/myapp/&quot; the &quot;./&quot; would translated to that)"}], "tags": [], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "is_accepted": true, "score": 4, "last_activity_date": 1493200452, "creation_date": 1493200452, "answer_id": 43630798, "question_id": 43624016, "link": "https://stackoverflow.com/questions/43624016/serving-subdirectories-in-http-handlers-golang/43630798#43630798", "title": "Serving Subdirectories in HTTP handlers [GoLang]", "body": "<p>Assuming you want to serve the whole content of the directory \"static\" on the endpoint /static and you are running a bsd/linux machine the following syntax should work:</p>\n\n<pre><code>http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"./static\"))))\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1839, "favorite_count": 0, "accepted_answer_id": 43630798, "answer_count": 1, "score": 0, "last_activity_date": 1493200452, "creation_date": 1493173925, "question_id": 43624016, "link": "https://stackoverflow.com/questions/43624016/serving-subdirectories-in-http-handlers-golang", "title": "Serving Subdirectories in HTTP handlers [GoLang]", "body": "<p>I have the following code:</p>\n\n<pre><code>r := mux.NewRouter()\nr.Handle(\"/\", http.FileServer(http.Dir(\"./frontend/build/\")))\nr.Handle(\"/static\", http.FileServer(http.Dir(\"./frontend/build/static/\")))\nr.PathPrefix(\"/api\").Handler(auth)\n</code></pre>\n\n<p><code>/api</code> is supposed to be secure. If a user hits <code>/</code>, I want them to view the <code>index.html</code> in the <code>PROJECTDIR/frontend</code> directory. </p>\n\n<p>The frontend directory looks like</p>\n\n<pre><code>frontend\n    /build\n        index.html\n        /static\n            /js\n            /css\n            /media\n</code></pre>\n\n<p>The index.html loads all contents from <code>/static</code>. No matter how I seem to configure this, when I visit <code>localhost:3000</code>, I can get the <code>index.html</code> but everything under <code>/static</code> is 404'd. </p>\n\n<p>How am I configuring this incorrectly?</p>\n"}, {"tags": ["go", "dokku"], "comments": [{"owner": {"reputation": 2981, "user_id": 6206947, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ef3bb38797a3bd7c6e2b92797e9b80dc?s=128&d=identicon&r=PG", "display_name": "nicovank", "link": "https://stackoverflow.com/users/6206947/nicovank"}, "edited": false, "score": 1, "creation_date": 1493176443, "post_id": 43623892, "comment_id": 74297533, "body": "What is line 114?"}, {"owner": {"reputation": 195, "user_id": 6097697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed8363cbfd4ce2e1a6d1b83cc5e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Erguotou", "link": "https://stackoverflow.com/users/6097697/erguotou"}, "reply_to_user": {"reputation": 2981, "user_id": 6206947, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ef3bb38797a3bd7c6e2b92797e9b80dc?s=128&d=identicon&r=PG", "display_name": "nicovank", "link": "https://stackoverflow.com/users/6206947/nicovank"}, "edited": false, "score": 0, "creation_date": 1493183668, "post_id": 43623892, "comment_id": 74299681, "body": "@nicovank <a href=\"https://github.com/dokku/dokku/blob/master/plugins/git/functions#L114\" rel=\"nofollow noreferrer\">github.com/dokku/dokku/blob/master/plugins/git/functions#L11&zwnj;&#8203;4</a>"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493285120, "post_id": 43623892, "comment_id": 74354868, "body": "Print and observe the content of variable <code>DokkuPath</code> and <code>name</code>. Make sure that there is no error when you execute the command in shell."}, {"owner": {"reputation": 195, "user_id": 6097697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed8363cbfd4ce2e1a6d1b83cc5e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Erguotou", "link": "https://stackoverflow.com/users/6097697/erguotou"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493360481, "post_id": 43623892, "comment_id": 74392615, "body": "@putu <code>DokkuPath</code>&#39;s value is <code>&#47;usr&#47;bin&#47;dokku</code> and <code>name</code> is a string value(app name) that not empty. I am sure the command is right and the following command executed rightly in shell.  <code>cat .&#47;express-sample-master.tar | dokku tar:in node-sample</code>"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493432195, "post_id": 43623892, "comment_id": 74428395, "body": "It complains that <code>&#47;home&#47;dokku&#47;node-sample&#47;refs&#47;heads&#47;master</code> is not available. Make sure the requested file is available. Also, make sure your web application has permission to access the file. As a comparison, you may create a command-line version of the code in question, then execute it in shell."}], "owner": {"reputation": 195, "user_id": 6097697, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1beed8363cbfd4ce2e1a6d1b83cc5e2b?s=128&d=identicon&r=PG&f=1", "display_name": "Erguotou", "link": "https://stackoverflow.com/users/6097697/erguotou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 292, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493172940, "creation_date": 1493172940, "question_id": 43623892, "link": "https://stackoverflow.com/questions/43623892/error-copy-file-to-stdin-in-golang", "title": "Error copy file to stdin in golang", "body": "<p>I'm using echo to build a web app for dokku management. It has a url router to handle <a href=\"http://dokku.viewdocs.io/dokku/deployment/methods/tar/#deploying-via-stdin\" rel=\"nofollow noreferrer\">tarfile deploying</a> and my handler is bellow:\npackage routers</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"github.com/labstack/echo\"\n    \"io\"\n    \"net/http\"\n    \"os/exec\"\n)\n\n// deploy app via tar file\nfunc deployTarApp(c echo.Context) error {\n    name := c.Param(\"name\")\n    file, ef := c.FormFile(\"file\")\n    if ef != nil || file == nil {\n        return c.NoContent(http.StatusBadRequest)\n    }\n    tempfile, et := file.Open()\n    if et != nil {\n        return c.JSON(http.StatusInternalServerError, et)\n    }\n    cmd := exec.Command(DokkuPath, \"tar:in\", name)\n    stdin, err := cmd.StdinPipe()\n    if err != nil {\n        return c.JSON(http.StatusInternalServerError, err)\n    }\n    go func() {\n        defer stdin.Close()\n        io.Copy(stdin, tempfile)\n    }()\n    out, e := cmd.CombinedOutput()\n    if e != nil {\n        fmt.Println(string(out), e)\n        return c.JSON(http.StatusInternalServerError, e)\n    }\n    return c.NoContent(http.StatusOK)\n}\n</code></pre>\n\n<p>First get the form file, then copy it to stdin, then run <code>dokku tar:in app-name</code>. But the code throws an error</p>\n\n<pre><code>/var/lib/dokku/plugins/available/git/functions: line 114: /home/dokku/node-sample/refs/heads/master: No such file or directory\n exit status 128\n</code></pre>\n\n<p>What is the problem with the handler? I am new to golang, so I am not so familiar with it. Thanks for your help.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1493174903, "post_id": 43623658, "comment_id": 74297186, "body": "This can&#39;t be done for the same reasons expressed in <a href=\"http://stackoverflow.com/questions/12753805/type-converting-slices-of-interfaces-in-go\">Type converting slices of interfaces in go</a>. You&#39;d need to use <code>map[string]yourInterface</code>, not <code>map[string]thing</code>, <code>map[string]barThing</code>, or <code>map[string]fooThing</code>, and all of <code>thing</code>, <code>barThing</code>, and <code>fooThing</code> would need to implement <code>yourInterface</code>. That would allow you to do what you want, though you&#39;d want a type switch to convert from the interface type to one of the types mentioned; you could use <code>case thing, barThing, fooThing: v.name = k</code>."}, {"owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "edited": false, "score": 0, "creation_date": 1493180141, "post_id": 43623658, "comment_id": 74298522, "body": "Cools. Thanks for the reply. I did have a working implementation using the <code>map[string]interface</code>, but then we&#39;re back to implementing the same method to satisfy the interface for each type again. It just isn&#39;t DRY, but that seems to be the price we pay for type safety."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1493219271, "post_id": 43623658, "comment_id": 74324400, "body": "I was slightly mistaken in my last comment. You can create an interface requiring a <code>setName(string)</code> method, abstracting the assignment operation. <code>thing</code> could implement the method, and the other types with <code>thing</code> embedded could use that same method without any need to duplicate the method for the other types, thanks to how composition works. Then your map would be as I described, requiring the interface rather than any of the struct types. If <code>thing</code> wasn&#39;t embedded in the other types, you&#39;d be forced use a type switch, or abandon the DRY principle in this particular case."}], "owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 37, "favorite_count": 0, "closed_date": 1493181356, "answer_count": 0, "score": 0, "last_activity_date": 1493172816, "creation_date": 1493171202, "last_edit_date": 1493172816, "question_id": 43623658, "link": "https://stackoverflow.com/questions/43623658/can-a-function-argument-in-go-be-a-type-that-satisfies-each-of-the-types-in-whic", "closed_reason": "Duplicate", "title": "Can a function argument in Go be a type that satisfies each of the types in which it is embedded?", "body": "<p>Is it possible in Go to have a function parameter of a type that satisfies multiple types? I know you can use interfaces to pass in various types, but let me give an example.</p>\n\n<p>Say I have the following three types:</p>\n\n<pre><code>type thing struct {\n    name string\n}\n\ntype barThing struct {\n    thing\n    barAttr string\n}\n\ntype fooThing struct {\n    thing\n    fooAttr int\n}\n</code></pre>\n\n<p>I'd like to have a single functions such that I can pass in a <code>map[string]&lt;anyOfThoseTypes&gt;</code> and add each map item's key to the name field. Something like:</p>\n\n<pre><code>func copyKeysIntoStruct(m map[string]thing) {\n    for k, v := range m {\n        v.name = k\n        m[k] = v\n    }\n}\n\nfunc main() {\n    bars := map[string]barThing{\n        \"b1\": {thing: thing{name: \"overwrite\"}},\n        \"b2\": {thing: thing{}},\n    }\n    foos := map[string]fooThing{\n        \"f1\": {thing: thing{}},\n        \"f2\": {thing: thing{name: \"goingaway\"}},\n    }\n    bars = copyKeysIntoStruct(bars)\n    fmt.Println(bars)\n    foos = copyKeysIntoStruct(foos)\n    fmt.Println(foos)\n}\n</code></pre>\n\n<p>However, here I get <code>cannot use bars (type map[string]barThing) as type map[string]thing in argument to copyKeysIntoStruct</code>, which makes sense. However, I don't want to write this same function for each type that has <code>thing</code> embedded.</p>\n\n<p>The other possibility was to take <code>m map[string]interface{}</code> as an argument and use a type switch and assertions to get the right behavior, but that seemed to be a NOGO too.</p>\n\n<p>In summary, I'm looking to have inputs like:</p>\n\n<pre><code>    bars := map[string]barThing{\n        \"b1\": {thing: thing{name: \"overwrite\"}},\n        \"b2\": {thing: thing{}},\n    }\n    foos := map[string]fooThing{\n        \"f1\": {thing: thing{}},\n        \"f2\": {thing: thing{name: \"goingaway\"}},\n    }\n</code></pre>\n\n<p>and outputs like:</p>\n\n<pre><code>    bars := map[string]barThing{\n        \"b1\": {thing: thing{name: \"b1\"}},\n        \"b2\": {thing: thing{name: \"b2\"}},\n    }\n    foos := map[string]fooThing{\n        \"f1\": {thing: thing{name: \"f1\"}},\n        \"f2\": {thing: thing{name: \"f2\"}},\n    }\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1493167076, "post_id": 43623049, "comment_id": 74295219, "body": "<a href=\"https://golang.org/doc/faq#covariant_types\" rel=\"nofollow noreferrer\">golang.org/doc/faq#covariant_types</a>"}, {"owner": {"reputation": 21295, "user_id": 329781, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eea7eacef5dde692524f0ea01a7ec964?s=128&d=identicon&r=PG", "display_name": "jonderry", "link": "https://stackoverflow.com/users/329781/jonderry"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493167500, "post_id": 43623049, "comment_id": 74295295, "body": "That seems like a flaw in the language. Especially given that the following is perfectly legal: <code>var t interface{} = []string{}</code>."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1493167570, "post_id": 43623049, "comment_id": 74295306, "body": "Your example is not actually relevant to the problem explained: assignability rules (your example code) and interface implementation rules (your actual problem) are different."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1493168160, "post_id": 43623049, "comment_id": 74295463, "body": "@jonderry: go interfaces are a separate concept from variant types, and <code>func(a interface{}, b proto.Message) []*PersistentData</code> is a separate type from <code>func(a interface{}, b proto.Message) interface{}</code>. Having one part of the function signature assignable to another part of the function signature does not make the overall type equal. It helps to work with a language for a while before declaring how the language works &quot;a flaw&quot;."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493168321, "post_id": 43623049, "comment_id": 74295493, "body": "@JimB btw, it&#39;s surprisingly not much in the standard on the rules of how a type is checked whether it implements an interface or not. They have &quot;A variable of interface type can store a value of any type with a method set that is any superset of the interface. Such a type is said to implement the interface.&quot; but there is no (?) definition on how &quot;being a superset&quot; property is evaluated."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1493168422, "post_id": 43623049, "comment_id": 74295516, "body": "@zerkms: it&#39;s all in the spec, but It is hard to reconcile how a newcomer reads the spec compared to one who knows it already. Doesn&#39;t this cover it? <a href=\"https://golang.org/ref/spec#Method_sets\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Method_sets</a>"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493168524, "post_id": 43623049, "comment_id": 74295538, "body": "@JimB it does not (?) cover how method sets are checked for equality."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1493168884, "post_id": 43623049, "comment_id": 74295637, "body": "@zerkms: yeah, maybe it&#39;s not explicit there. I guess my assumption was always that because a method set must match exactly, there&#39;s not really any detail to go into, it simply must match. That&#39;s probably why the covariant question ended up in the FAQ rather than expanding on it in the spec."}, {"owner": {"reputation": 21295, "user_id": 329781, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eea7eacef5dde692524f0ea01a7ec964?s=128&d=identicon&r=PG", "display_name": "jonderry", "link": "https://stackoverflow.com/users/329781/jonderry"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1493171484, "post_id": 43623049, "comment_id": 74296251, "body": "@JimB If the return type of the function is assignable to the return type in the declaration, then the function should be assignable. This is true in most other languages that have function types. A function is not like a container type that requires invariance."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1493168793, "post_id": 43623279, "comment_id": 74295605, "body": "&quot;I think it&#39;s the same logic behind not being able to assign an int to an int8&quot; --- I cannot agree; You cannot assign an <code>int</code> to <code>int8</code> because this may cause data loss. But covariance is a whole different story: covariant types compatible: <code>[]string</code> is assignable to the <code>interface{}</code>. Co/contra-variance support is a higher level operation, than just types assignability."}, {"owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1493169203, "post_id": 43623279, "comment_id": 74295708, "body": "I know it&#39;s a different concept and they might have motivations for designing the language that way, but the reason why that is not allowed is the same. In go if it&#39;s a different type you can&#39;t do an assignment. And the functions types are defined by the whole function signature. <a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Function_types</a>"}], "tags": [], "owner": {"reputation": 4028, "user_id": 816892, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/203cadc8467e3add61b5cdcdfd224cf4?s=128&d=identicon&r=PG", "display_name": "Topo", "link": "https://stackoverflow.com/users/816892/topo"}, "is_accepted": false, "score": 2, "last_activity_date": 1493168365, "creation_date": 1493168365, "answer_id": 43623279, "question_id": 43623049, "link": "https://stackoverflow.com/questions/43623049/how-can-i-return-a-subtype-of-the-specified-return-value-in-this-case-interface/43623279#43623279", "title": "How can I return a subtype of the specified return value (in this case interface{})?", "body": "<p>The type of the object is the whole function signature. If the signature don't match, then it's not the same type and can't be assigned that way.</p>\n\n<p>Anything can be assigned to the empty interface, because all types satisfy the interface, but in your problem neither type is the empty interface, you just have a function that returns an empty interface.</p>\n\n<p>Not because a part of the function can be assigned to another it makes it the same. The type is the whole function signature. I think it's the same logic behind not being able to assign an <code>int</code> to an <code>int8</code>. You can cast them if you want, but for go, they are separate types and you need to deal with making the necessary conversions to be able to assign them.</p>\n\n<p>What you can do is change your second function signature to return an empty interface like this:</p>\n\n<pre><code>func(interface{}, proto.Message) interface{}\n\nfunc reduceMsg(a interface{}, b proto.Message) interface{} {\n    var a []*PersistentData\n    // do something here\n    return a\n}\n</code></pre>\n\n<p>This way the function signature is the same, so it's consider the same type and you are returning an <code>[]*PersistentData</code>. Of course you will need to do a type assertion before using it as such because the program will treat it as an <code>{}interface</code> because that is the type that the function returned.</p>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1599726149, "post_id": 43623861, "comment_id": 112864324, "body": "Code can be found here <a href=\"https://play.golang.org/p/pNKfcc95Uo9\" rel=\"nofollow noreferrer\">play.golang.org/p/pNKfcc95Uo9</a>."}], "tags": [], "owner": {"reputation": 594, "user_id": 409054, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b7ec96a77503599f6c646ff211d0e96c?s=128&d=identicon&r=PG", "display_name": "TaslemGuy", "link": "https://stackoverflow.com/users/409054/taslemguy"}, "is_accepted": true, "score": 2, "last_activity_date": 1493172702, "last_edit_date": 1592644375, "creation_date": 1493172702, "answer_id": 43623861, "question_id": 43623049, "link": "https://stackoverflow.com/questions/43623049/how-can-i-return-a-subtype-of-the-specified-return-value-in-this-case-interface/43623861#43623861", "title": "How can I return a subtype of the specified return value (in this case interface{})?", "body": "<p><a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">Referencing the spec</a>,</p>\n<blockquote>\n<p>In assignments, each value must be assignable to the type of the operand to which it is assigned, with the following special cases:</p>\n<ul>\n<li>Any typed value may be assigned to the blank identifier.</li>\n<li>If an untyped constant is assigned to a variable of interface type or the blank identifier, the constant is first converted to its default type.</li>\n<li>If an untyped boolean value is assigned to a variable of interface type or the blank identifier, it is first converted to type bool.</li>\n</ul>\n</blockquote>\n<p>Assignability</p>\n<blockquote>\n<p>A value x is assignable to a variable of type T (&quot;x is assignable to T&quot;) in any of these cases:</p>\n<ul>\n<li>x's type is identical to T.</li>\n<li>x's type V and T have identical underlying types and at least one of V or T is not a named type.</li>\n<li>T is an interface type and x implements T.</li>\n<li>x is a bidirectional channel value, T is a channel type, x's type V and T have identical element types, and at least one of V or T is not a named type.</li>\n<li>x is the predeclared identifier nil and T is a pointer, function, slice, map, channel, or interface type.</li>\n<li>x is an untyped constant representable by a value of type T.</li>\n</ul>\n</blockquote>\n<p>In general, Go doesn't allow you to implicitly convert values from one type to another, with the exception of being able to use concrete-typed objects as though they were interfaces (that they implement).</p>\n<p>In this particular case, since your function doesn't actually return an <code>interface{}</code>, the compiler would have to do some extra work to wrap up the return value as an <code>interface{}</code> and return it; if you really want to accomplish what you're trying you can do this explicitly yourself:</p>\n<pre><code>type Foo struct {\n    X int\n}\nfunc create(x int) Foo {\n    return Foo{X: x}\n}\nfunc main() {\n    var f func(int) interface{} = func(x int) interface{} {\n        return create(x)\n    }\n}\n</code></pre>\n<p>which is basically doing (explicitly) the wrapping operation that you want the runtime to do implicitly.</p>\n"}], "owner": {"reputation": 21295, "user_id": 329781, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/eea7eacef5dde692524f0ea01a7ec964?s=128&d=identicon&r=PG", "display_name": "jonderry", "link": "https://stackoverflow.com/users/329781/jonderry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 43623861, "answer_count": 2, "score": 0, "last_activity_date": 1493178027, "creation_date": 1493166585, "last_edit_date": 1493178027, "question_id": 43623049, "link": "https://stackoverflow.com/questions/43623049/how-can-i-return-a-subtype-of-the-specified-return-value-in-this-case-interface", "title": "How can I return a subtype of the specified return value (in this case interface{})?", "body": "<p>I have an interface that defines one parameter to have type <code>func(interface{}, proto.Message) interface{}</code> and I'm trying to pass something of type <code>func reduceMsg(a interface{}, b proto.Message) []*PersistentData</code> to it. This results in the following compiler error:</p>\n\n<pre><code>Cannot use reduceMsg (type func(a interface{}, b proto.Message) []*PersistentData as type func(interface{}, proto.Message) interface{}\n</code></pre>\n\n<p>What is the reason for this error, and how can I work around it? It seems like returning a more specific type than <code>interface{}</code> should be legal. Here's a simple complete example that illustrates the issue:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var t func() interface{} = func() []string { return []string{} }\n    fmt.Println(t)\n}\n</code></pre>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1493171519, "post_id": 43623007, "comment_id": 74296260, "body": "i am not very clear about the problem, see if this help <a href=\"http://stackoverflow.com/a/42766877/3435777\">stackoverflow.com/a/42766877/3435777</a>"}, {"owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "reply_to_user": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "edited": false, "score": 0, "creation_date": 1493171635, "post_id": 43623007, "comment_id": 74296298, "body": "<code>gopkg.in</code> is used as a redirect service to allow <code>go get</code> to fetch a specific version, but I want to always get the HEAD, but capture the git tag when <code>go build</code> runs so it can automatically encode the version into the app without me having to update it."}, {"owner": {"reputation": 21113, "user_id": 1549918, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/wAHqV.png?s=128&g=1", "display_name": "Chris Halcrow", "link": "https://stackoverflow.com/users/1549918/chris-halcrow"}, "edited": false, "score": 1, "creation_date": 1493194370, "post_id": 43623007, "comment_id": 74305440, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/30188499/how-to-do-go-get-on-a-specific-tag-of-a-github-repository\">How to do &quot;go get&quot; on a specific tag of a github repository</a>"}, {"owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "edited": false, "score": 0, "creation_date": 1493343032, "post_id": 43623007, "comment_id": 74387741, "body": "Not a duplicate. That question is when you want to request a specific version. I want the latest version, but when it builds it uses the fetched version."}], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 0, "last_activity_date": 1493191573, "creation_date": 1493191573, "answer_id": 43627612, "question_id": 43623007, "link": "https://stackoverflow.com/questions/43623007/is-it-possible-to-get-the-git-tag-with-go-get/43627612#43627612", "title": "Is it possible to get the git tag with &quot;go get&quot;?", "body": "<p>No this is not possible. (Note that go get supports other SCM than git too).</p>\n"}, {"tags": [], "owner": {"reputation": 29052, "user_id": 96233, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/85735330505ef1c84896fcb86491bd0b?s=128&d=identicon&r=PG", "display_name": "Ralph", "link": "https://stackoverflow.com/users/96233/ralph"}, "is_accepted": false, "score": 1, "last_activity_date": 1493210263, "creation_date": 1493210263, "answer_id": 43634430, "question_id": 43623007, "link": "https://stackoverflow.com/questions/43623007/is-it-possible-to-get-the-git-tag-with-go-get/43634430#43634430", "title": "Is it possible to get the git tag with &quot;go get&quot;?", "body": "<p>This does not exactly answer your question, but the way I solved a similar need is the following.</p>\n\n<p>In my <code>main</code> package, I define the following variables:</p>\n\n<pre><code>var (\n    buildInfo  string\n    buildStamp = \"No BuildStamp provided\"\n    gitHash    = \"No GitHash provided\"\n    version    = \"No Version provided\"\n)\n</code></pre>\n\n<p>and in my <code>main</code> function, I execute the following code:</p>\n\n<pre><code>if buildInfo != \"\" {\n    parts := strings.Split(buildInfo, \"|\")\n    if len(parts) &gt;= 3 {\n        buildStamp = parts[0]\n        gitHash = parts[1]\n        version = parts[2]\n    }\n}\n</code></pre>\n\n<p>I then build my application with the following <code>bash</code> (Linux) shell script:</p>\n\n<pre><code>#!/bin/sh\n\ncd \"${0%/*}\"\n\nbuildInfo=\"`date -u '+%Y-%m-%dT%TZ'`|`git describe --always --long`|`git tag | tail -1`\"\ngo build -ldflags \"-X main.buildInfo=${buildInfo} -s -w\" ./cmd/...\n</code></pre>\n\n<p>You will need to adjust the script for Windows and MacOS.</p>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 4700, "user_id": 1470961, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/28216f158ce772dd67fcee384406b2c9?s=128&d=identicon&r=PG", "display_name": "Elliot Chance", "link": "https://stackoverflow.com/users/1470961/elliot-chance"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 639, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1493210263, "creation_date": 1493166256, "question_id": 43623007, "link": "https://stackoverflow.com/questions/43623007/is-it-possible-to-get-the-git-tag-with-go-get", "title": "Is it possible to get the git tag with &quot;go get&quot;?", "body": "<p>I would like to add a <code>--version</code> option to my Go binary, <a href=\"https://github.com/elliotchance/c2go\" rel=\"nofollow noreferrer\">c2go</a>.</p>\n\n<p>I know traditionally this would be hardcoded into the binary but since it's alpha quality software and it's being updated very often I'd like to capture the version when the <code>go get</code> builds the executable (from the git tag).</p>\n\n<p>Is this possible?</p>\n"}, {"tags": ["pointers", "memory", "go", "ownership"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1493169726, "post_id": 43622388, "comment_id": 74295827, "body": "Please edit the question to limit it to a specific problem with enough detail to identify an adequate answer. Avoid asking multiple distinct questions at once."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1493340070, "post_id": 43622388, "comment_id": 74387067, "body": "In Go, this is extremely simple: people using your package are unable to access unexported identifiers. That is, they&#39;re effectively private from a C++ point of view. If you&#39;re providing a way to access a pointer in a struct (e.g. a method that returns such a pointer), then you either copy its data and return a pointer to the copy or simply trust the user of your package not to break things. There are arguments for both sides, but it ultimately is dependent upon your use case."}], "answers": [{"comments": [{"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1493379070, "post_id": 43633983, "comment_id": 74404137, "body": "This solution has a few problems. a) It means that I must declare the struct in a separate package. b) I am relying on the user to know he shouldn&#39;t pass the structure by value and instead use the copy/clone method.... I was hoping there would be a hack to override or at least delete the default copy constructor.... but there doesn&#39;t seem to be one, so In absence of a better answer in 1-2 days I&#39;ll mark this the answer"}, {"owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "edited": false, "score": 0, "creation_date": 1493379229, "post_id": 43633983, "comment_id": 74404247, "body": "Also, sorry for using C++ concepts, but I don&#39;t really know the semantic of go or even of C and, in the end, C++ has every concept that Go has, so its easy to map features from Go to C++, even if GO might have a different name for a copy constructor/operation... its still a concept that exists under some name in the language and I assume its easy enough to associate the two."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1493211998, "last_edit_date": 1493211998, "creation_date": 1493209060, "answer_id": 43633983, "question_id": 43622388, "link": "https://stackoverflow.com/questions/43622388/golang-copying-structures-that-contain-pointers/43633983#43633983", "title": "Golang copying structures that contain pointers", "body": "<blockquote>\n  <p>How can I create a struct in golang, which contains a pointer, then\n  safely pass it by value to other functions ? (By safely I mean without\n  having to worry that those functions can dereference said pointer and\n  change the variable its pointing to).</p>\n</blockquote>\n\n<p>Use an exported package type with unexported fields. For example,</p>\n\n<p><code>src/ptrstruct/ptrstruct.go</code>:</p>\n\n<pre><code>package ptrstruct\n\ntype PtrStruct struct {\n    pn *int\n}\n\nfunc New(n int) *PtrStruct {\n    return &amp;PtrStruct{pn: &amp;n}\n}\n\nfunc (s *PtrStruct) N() int {\n    return *s.pn\n}\n\nfunc (s *PtrStruct) SetN(n int) {\n    *s.pn = n\n}\n\nfunc (s *PtrStruct) Clone() *PtrStruct {\n    // make a deep clone\n    t := &amp;PtrStruct{pn: new(int)}\n    *t.pn = *s.pn\n    return t\n}\n</code></pre>\n\n<p><code>src/ptrstruct.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"ptrstruct\"\n)\n\nfunc main() {\n    ps := ptrstruct.New(42)\n    fmt.Println(ps.N())\n    pc := ps.Clone()\n    fmt.Println(pc.N())\n    pc.SetN(7)\n    fmt.Println(pc.N())\n    fmt.Println(ps.N())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>src $ go run ptrstruct.go\n42\n42\n7\n42\nsrc $ \n</code></pre>\n\n<blockquote>\n  <p>If the answer you are going to give is \"Copy functions\" then how can I\n  delete the original copy constructor/operator ? Override it with me\n  custom copy function ? Or otherwise discourage people from using it ?</p>\n</blockquote>\n\n<p>Stop programming in C++; start programming in Go. By design, Go is not C++.</p>\n\n<p>\"copy constructor/operator\" and \"Override it with custom function\" are C++ concepts.</p>\n\n<p>References:</p>\n\n<p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n\n<p><a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow noreferrer\">Blocks</a></p>\n\n<p><a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">Declarations and scope</a></p>\n\n<p><a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">Exported identifiers</a></p>\n"}], "owner": {"reputation": 2415, "user_id": 7156008, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/QzIXM.jpg?s=128&g=1", "display_name": "George", "link": "https://stackoverflow.com/users/7156008/george"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2774, "favorite_count": 1, "accepted_answer_id": 43633983, "answer_count": 1, "score": 5, "last_activity_date": 1493222436, "creation_date": 1493161628, "last_edit_date": 1493222436, "question_id": 43622388, "link": "https://stackoverflow.com/questions/43622388/golang-copying-structures-that-contain-pointers", "title": "Golang copying structures that contain pointers", "body": "<p>TL;DR\nBecause of the downvotes and the lack of answers and the comments I assume a tl;dr is needed.</p>\n\n<p>How can I create a struct in golang, which contains a pointer, then safely pass it by value to other functions ? (By safely I mean without having to worry that those functions can dereference said pointer and change the variable its pointing to).</p>\n\n<p>AND</p>\n\n<p>If the answer you are going to give is \"Copy functions\" then how can I delete the original copy constructor/operator ? Override it with me custom copy function ? Or otherwise discourage people from using it ?</p>\n\n<hr>\n\n<p>In golang I can have a structure that contains a pointer to a dynamically allocated variable.</p>\n\n<p>I can also pass instances of those structures to functions that \"copy\" them. </p>\n\n<p>However, I cannot override or delete the built-in copy operator. This means that, in theory, I could have code like the following one:</p>\n\n<pre><code>import (\n        \"fmt\"\n)\n\ntype A struct {\n        a * int\n}\n\nfunc main() {\n        var instance A\n        value := 14\n        instance.a = &amp;value\n        fmt.Println(*instance.a) // prints 14\n        mutator(instance)\n        fmt.Println(*instance.a) // prints 11 o.o\n}\n\nfunc mutator(instance A) {\n        *instance.a = 11\n        fmt.Println(*instance.a)\n}\n</code></pre>\n\n<p>This type of code is obviously a bit nonsensical here. However, assuming the member field \"a\" was a complex structure it might stand within reason that a function accessing it will try and modify it.</p>\n\n<p>It might also stand within reason that once the function \"mutator\" is called the programmer might want to keep on using his instance of A and (assuming he didn't necessarily code the structure or was aware of its internals) might even assume that since he passed a copy rather than a pointer his instance of A will remain unchanged.</p>\n\n<p>Now, there are several (3) popular languages which allow the programmer to think about allocating and manipulating memory that aren't golang. I don't know Rust or C so I will refrain to how I would tackle this problem in C++:</p>\n\n<p>a) Assuming I was the designer of the class A I could build a copy constructor resulting in the following code:</p>\n\n<pre><code>#include &lt;iostream&gt;\n\n    class A {\n    public:\n            int * a;\n            A(int value): a(new int{value}) {}\n            A(const A &amp; copyFrom): a(new int{*copyFrom.a}) {}\n    };\n\n    void mutator(A instance) {\n            *instance.a = 11;\n            std::cout &lt;&lt; *instance.a &lt;&lt; \"\\n\";\n    }\n\n\n    int main() {\n            A instance{14};\n            std::cout &lt;&lt; *(instance.a) &lt;&lt; \"\\n\";\n            mutator(instance);\n            std::cout &lt;&lt; *instance.a &lt;&lt; \"\\n\";\n    }\n</code></pre>\n\n<p>This allows an instance of my class to be copied with the added caveat that the pointer is also reassigned.</p>\n\n<p>b) Assuming I was the designer of class A and didn't want to build the copy constructor (say that whatever a points to might be very large or that A is often used in performance critical conditions as a read only object) yet wanted to make sure that any assignment to copy couldn't modify the value a is pointing to (but still allow people to modify a by assigning it to a new value) I could write my class like this:</p>\n\n<pre><code>class A {\npublic:\n        const int * a;\n        A(int value): a(new const int{value}) {}\n};\n</code></pre>\n\n<p>Which would make the following code to fail to compile:</p>\n\n<pre><code>void mutator(A instance) {\n        *instance.a = 11;\n        std::cout &lt;&lt; *instance.a &lt;&lt; \"\\n\";\n}\n\n\nint main() {\n        A instance{14};\n        std::cout &lt;&lt; *(instance.a) &lt;&lt; \"\\n\";\n        mutator(instance);\n        std::cout &lt;&lt; *instance.a &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>But the following code would compile just fine:</p>\n\n<pre><code>void mutator(A instance) {\n        instance.a = new const int{11};\n        std::cout &lt;&lt; *instance.a &lt;&lt; \"\\n\";\n}\n\n\nint main() {\n        A instance{14};\n        std::cout &lt;&lt; *(instance.a) &lt;&lt; \"\\n\";\n        mutator(instance);\n        std::cout &lt;&lt; *instance.a &lt;&lt; \"\\n\";\n}\n</code></pre>\n\n<p>Now, mind you, this is typical  of C++'s \"Object Oriented\" (eegh) design. I for one would much prefer if I could have some sort of rule in the function signature that guaranteed no modification of the instance of A passed to it or a method by which to declare the instance of A \"const\" and  \"guard\" its dynamically allocated fields (not only the static ones) against re-assignment.</p>\n\n<p>However, whilst the solution may not be perfect, it is a solution. It allows me to have a clear idea about the \"ownership\" of my instances of A.</p>\n\n<p>In golang, it appears that any \"copy\" of an instance that contains pointers is basically free for all, it can't be safely passed around even if the author of the struct had such an intention.</p>\n\n<p>The one thing I can think of is having a \"Copy\" method that return a brand new instance of the structure (similar to the Copy Constructor in the example above). But without the ability to delete the copy constructor/operator it would be hard to make sure people will use and/or notice it.</p>\n\n<p>To be honest it seems quite strange to me that golang even allows re-writing the memory address of a pointer without using the \"unsafe\" package or something similar. </p>\n\n<p>Wouldn't it make more sense to simply prohibit this type of operation much like many others are ?</p>\n\n<p>Considering the way \"append\" works it seems quite obvious that the intent of the authors is to favor re-assigning new variables to a pointer rather than mutating the one it previously pointed to. However, whilst this is easy to enforce with a built in structure like a slice or an array it seems quite hard to enforce with a custom struct (without, at least, wrapping said struct in a package).</p>\n\n<p>Am I overlooking a way to do copy construction (or prohibit copying) in golang ? Is it indeed the original intent of the authors to encourage re assignment rather than mutation when memory and time permit it ? If so why is it so easy to mutate dynamically allocated variables ? Is there a way to mimic private/public behavior with structs or files rather than full fledged packages ? Are there any other way to enforce some semblance of ownership with structs that have pointers which I am overlooking ? </p>\n"}, {"tags": ["go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 731, "user_id": 2949583, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/Xh1NA.jpg?s=128&g=1", "display_name": "AnonymousAngelo", "link": "https://stackoverflow.com/users/2949583/anonymousangelo"}, "edited": false, "score": 0, "creation_date": 1559201591, "post_id": 43639908, "comment_id": 99349084, "body": "Do you perhaps have an example or a link to an example implementation? :)"}], "tags": [], "owner": {"reputation": 16391, "user_id": 4690866, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/854931adcbf75ac84630116123920854?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Anderson", "link": "https://stackoverflow.com/users/4690866/eric-anderson"}, "is_accepted": false, "score": 9, "last_activity_date": 1493224462, "creation_date": 1493224462, "answer_id": 43639908, "question_id": 43621586, "link": "https://stackoverflow.com/questions/43621586/is-it-ok-to-use-grpc-to-push-data/43639908#43639908", "title": "Is it OK to use gRPC to push data?", "body": "<p>gRPC is intended to be used in this way.</p>\n\n<p>You should still consider how the client should behave on failures and how you may want to re-balance across backends. If your connection is going across the Internet, you may also want to enable keepalive to detect connection breakages by providing KeepaliveParams to the client and server.</p>\n"}], "owner": {"reputation": 464, "user_id": 4660145, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/61039b2e8fce93ae427a1173273cbeaa?s=128&d=identicon&r=PG&f=1", "display_name": "Momh", "link": "https://stackoverflow.com/users/4660145/momh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5324, "favorite_count": 5, "answer_count": 1, "score": 6, "last_activity_date": 1493224462, "creation_date": 1493157082, "question_id": 43621586, "link": "https://stackoverflow.com/questions/43621586/is-it-ok-to-use-grpc-to-push-data", "title": "Is it OK to use gRPC to push data?", "body": "<p>I'm wondering if it's a good idea to push data from gRPC server to a client. Basically I want to use a pub/sub pattern with gRPC. \nThe way I do is that I return a response stream on the server implementation that I never close. Then, the client has a never ending go routine in charge of reading this stream.</p>\n\n<p>Here is an example:</p>\n\n<pre><code>service Service {\n    rpc RegularChanges (Void) returns (stream Change) {}\n}\n</code></pre>\n\n<p>On the server side:</p>\n\n<pre><code>func (self *MyServiceImpl) RegularChanges(in *pb.Void, stream pb.Service_RegularChangesServer) error {\n\n    for {\n        d, err := time.ParseDuration(\"1s\")\n        if err != nil {\n            log.Fatalf(\"Cannot parse duration\")\n            break;\n        }\n        time.Sleep(d)\n        stream.Send(&amp;pb.Change{Name:\"toto\", Description:\"status changed\"})\n    }\n    return nil\n}\n</code></pre>\n\n<p>On client:</p>\n\n<pre><code>for {\n        change, err := streamChanges.Recv()\n        if err != nil {\n            log.Fatalf(\"Error retrieving change\")\n        } else {\n            log.Println(change)\n        }\n}\n</code></pre>\n\n<p>I just began with go and gRPC but I know it's based on HTTP2, hence it should support pushing datas. However, I'm not sure this is the way gRPC should be used.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-sns", "aws-sdk-go"], "comments": [{"owner": {"reputation": 63555, "user_id": 1094597, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/d42a80b4c1210d697031449b8f86df38?s=128&d=identicon&r=PG", "display_name": "kosa", "link": "https://stackoverflow.com/users/1094597/kosa"}, "edited": false, "score": 0, "creation_date": 1493157756, "post_id": 43621542, "comment_id": 74292504, "body": "This seems more of case for pull rather than push. If at all push, you need to loop and do individual."}, {"owner": {"reputation": 400, "user_id": 274825, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/Qr7cy.jpg?s=128&g=1", "display_name": "Krum", "link": "https://stackoverflow.com/users/274825/krum"}, "edited": false, "score": 2, "creation_date": 1493171272, "post_id": 43621542, "comment_id": 74296196, "body": "You can subscribe each endpoint to a topic then send the message to the topic, or just do what I do and brute force send one message per device."}], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 3557095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50a1f6152fe6ac7ff5f3804d656580a5?s=128&d=identicon&r=PG", "display_name": "henriquechehad", "link": "https://stackoverflow.com/users/3557095/henriquechehad"}, "is_accepted": false, "score": 1, "last_activity_date": 1493227652, "creation_date": 1493227652, "answer_id": 43640855, "question_id": 43621542, "link": "https://stackoverflow.com/questions/43621542/sending-sns-push-notification-message-to-multiple-devices/43640855#43640855", "title": "Sending SNS push notification message to multiple devices", "body": "<p>Solution: I solved creating a topic, subscribing the devices in this topic and sending the push message to the topic.</p>\n"}], "owner": {"reputation": 71, "user_id": 3557095, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/50a1f6152fe6ac7ff5f3804d656580a5?s=128&d=identicon&r=PG", "display_name": "henriquechehad", "link": "https://stackoverflow.com/users/3557095/henriquechehad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1252, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493227652, "creation_date": 1493156886, "question_id": 43621542, "link": "https://stackoverflow.com/questions/43621542/sending-sns-push-notification-message-to-multiple-devices", "title": "Sending SNS push notification message to multiple devices", "body": "<p>I need to send SNS push notification to multiple devices passing the array of device tokens using <code>aws-sdk-go</code> lib.</p>\n\n<p>Currently I'm sending the push message to SNS using this steps:</p>\n\n<p>Creating the endpoint:</p>\n\n<pre><code>pl, err := svc.CreatePlatformEndpoint(&amp;sns.CreatePlatformEndpointInput{\n    PlatformApplicationArn: aws.String(topic),\n    Token: aws.String(n.DeviceToken), // just one device token\n})\n</code></pre>\n\n<p>Sending the message to endpoint:</p>\n\n<pre><code>params := &amp;sns.PublishInput{\n    Message:          aws.String(payload),\n    TargetArn:        aws.String(*pl.EndpointArn),\n    MessageStructure: aws.String(\"json\"),\n}\n</code></pre>\n\n<p>I have not seen a way to send one push message to multiple devices using just one request. Is it possible?</p>\n\n<p>Like this example to illustrate:</p>\n\n<pre><code>pl, err := svc.CreatePlatformEndpoint(&amp;sns.CreatePlatformEndpointInput{\n    PlatformApplicationArn: aws.String(topic),\n    Token: []aws.String{token01, token02, token03}, //array of device tokens\n})\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1493153379, "post_id": 43620664, "comment_id": 74290498, "body": "The Go code looks OK, so your issue is likely in the client-side code, which wasn&#39;t listed."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1493153696, "post_id": 43620664, "comment_id": 74290653, "body": "Are you sure the first output string is from that very endpoint? Show the network tab screenshot and your corresponding js code."}], "answers": [{"tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 3, "last_activity_date": 1493154083, "creation_date": 1493154083, "answer_id": 43620878, "question_id": 43620664, "link": "https://stackoverflow.com/questions/43620664/golang-multiple-response-values-in-web-app/43620878#43620878", "title": "Golang - multiple response values in web app", "body": "<p>You need to additionally check the <code>req.readyState</code>:</p>\n\n<pre><code>   req.onreadystatechange = function () {\n        if (req.readyState === XMLHttpRequest.DONE) {\n            console.log(req.responseText);\n        }\n   }\n</code></pre>\n\n<p>References:</p>\n\n<ul>\n<li><a href=\"https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/onreadystatechange\" rel=\"nofollow noreferrer\">https://developer.mozilla.org/en-US/docs/Web/API/XMLHttpRequest/onreadystatechange</a></li>\n</ul>\n"}], "owner": {"reputation": 2178, "user_id": 3858203, "user_type": "registered", "accept_rate": 30, "profile_image": "https://i.stack.imgur.com/Os9fr.jpg?s=128&g=1", "display_name": "samadadi", "link": "https://stackoverflow.com/users/3858203/samadadi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 317, "favorite_count": 1, "accepted_answer_id": 43620878, "answer_count": 1, "score": 1, "last_activity_date": 1493154083, "creation_date": 1493153316, "last_edit_date": 1493154042, "question_id": 43620664, "link": "https://stackoverflow.com/questions/43620664/golang-multiple-response-values-in-web-app", "title": "Golang - multiple response values in web app", "body": "<p>I write simple go web app. In this app, i am sending ajax post request and returning simple \"hello world!\" string and print it in console, but something is strange. There is three response value in console output. One with empty value and two response with \"hello world!\" string values. What is wrong with my code?</p>\n\n<p>Golang Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"io\"\n    \"net/http\"\n    \"html/template\"\n)\n\nfunc main() {\n     http.HandleFunc(\"/ajax\", ajaxHandler)\n     http.HandleFunc(\"/script.js\", srcHandler)\n     http.HandleFunc(\"/\", mainHandler)\n     http.ListenAndServe(\":8080\", nil)\n}\n\nfunc mainHandler(w http.ResponseWriter, r *http.Request) {\n    t, err := template.ParseFiles(\"home.html\")\n    if err != nil {\n        http.Error(w, http.StatusText(500), 500)\n        return\n    }\n\n    err = t.Execute(w, nil)\n    if err != nil {\n        http.Error(w, http.StatusText(500), 500)\n        return\n    }\n}\n\nfunc srcHandler(w http.ResponseWriter, r *http.Request) {\n     http.ServeFile(w, r, \"script.js\")\n}\n\nfunc ajaxHandler(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello World!\")\n}\n</code></pre>\n\n<p>Javascript Code:</p>\n\n<pre><code>(function () {\n    window.onclick = function () {\n        var req = new XMLHttpRequest();\n        req.open(\"post\", \"/ajax\", true);\n        req.send();\n\n        req.onreadystatechange = function () {\n            console.log(req.responseText);\n       }\n   };\n}());\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/zrdFY.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/zrdFY.png\" alt=\"enter image description here\"></a>\n<a href=\"https://i.stack.imgur.com/wJAS5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wJAS5.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493152641, "post_id": 43619913, "comment_id": 74290111, "body": "Can you explain why 3 untested lines is a problem? Are you striving for 100% data/state-space coverage too or are you satisfied with 100% source code lines coverage?"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493153260, "post_id": 43619913, "comment_id": 74290430, "body": "Currently I believe it&#39;s only 100% source code coverage.  We&#39;re seeking it because the new build guidelines for the company specify 100% unit test coverage as required.  This is rather annoying, frankly, because imo 100% test coverage is a rather unreasonable requirement (there are a noteworthy number of lines that <i>really</i> don&#39;t justify being tested).  But them&#39;s the breaks.  If what we&#39;re looking to do isn&#39;t possible without changing the production code, I think we&#39;ll just have to accept sub-100%, but I figured I&#39;d ask if there was some way I wasn&#39;t seeing to do this."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493181123, "post_id": 43619913, "comment_id": 74298796, "body": "Cool! Then you are free to <i>remove</i> the untested lines. If it is more important to have 100% line coverage than properly working code: So be it. If that corporate-policy-mandated-bulshit-code chrashes you can pull out the coverage report and state &quot;We did everything right! Look here 100% coverage! It must be someones else fault. We are sorry.&quot;"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493221487, "post_id": 43619913, "comment_id": 74326077, "body": "God, I wish I could actually get away with that..."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1493291264, "post_id": 43619913, "comment_id": 74359126, "body": "<code>In pursuit of 100% unit test coverage</code> -- This is a hollow pursuit. 1) 100% test coverage doesn&#39;t really mean anything. 2) Defensive code will have lines that literally <i>can&#39;t</i> be covered, because they handle cases that should never happen."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1493303514, "post_id": 43619913, "comment_id": 74368526, "body": "@Flimzy I fully agree, and our current position seems to be to just accept that those lines can&#39;t be covered in tests.  But the new handbook says 100% coverage, so we at least have to make an effort.  I figured if there was some effective way of masking the import, it&#39;d be worth it."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1493156075, "post_id": 43621340, "comment_id": 74291824, "body": "Ya, we considered doing this, but this would mean changing and complicating the production code purely for the purposes of testing, which we didn&#39;t want to do.  Was hoping there was a way of doing it that didn&#39;t involved changing the prod file."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1493303572, "post_id": 43621340, "comment_id": 74368561, "body": "Marking as answer even though we&#39;re not going with this solution, since it seems to be the only functional method of doing what I asked."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1493303714, "post_id": 43621340, "comment_id": 74368661, "body": "I understand, if you and your team find a better solution down the road, please do let me know, I&#39;d definitely be interested because I&#39;m not very fond of this one either."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1493155972, "creation_date": 1493155972, "answer_id": 43621340, "question_id": 43619913, "link": "https://stackoverflow.com/questions/43619913/mask-package-name-in-test-file-only/43621340#43621340", "title": "Mask package name in test file only", "body": "<p>One solution is to declare variables of those functions you want to mock.</p>\n\n<pre><code>var runtimeCaller = runtime.Caller\nvar runtimeFuncForPC = runtime.FuncForPC\n\nfunc functionName(n int) string {\n    pc, _, _, ok := runtimeCaller(n + 1)\n    if !ok {\n        return \"unknown function\"\n    }\n    me := runtimeFuncForPC(pc)\n    if me == nil {\n        return \"unknown function\"\n    }\n\n    split := strings.Split(me.Name(), \".\")\n    if len(split) == 0 {\n        return \"unknown function\"\n    }\n    return split[len(split)-1]\n}\n</code></pre>\n\n<p>Or if you prefer the dot notation...</p>\n\n<pre><code>var _runtime = struct{\n    Caller    func(skip int) (pc uintptr, file string, line int, ok bool)\n    FuncForPC func(pc uintptr) *runtime.Func\n}{runtime.Caller, runtime.FuncForPC}\n\nfunc functionName(n int) string {\n    pc, _, _, ok := _runtime.Caller(n + 1)\n    if !ok {\n        return \"unknown function\"\n    }\n    me := _runtime.FuncForPC(pc)\n    if me == nil {\n        return \"unknown function\"\n    }\n\n    split := strings.Split(me.Name(), \".\")\n    if len(split) == 0 {\n        return \"unknown function\"\n    }\n    return split[len(split)-1]\n}\n</code></pre>\n\n<p>And in your tests, before running <code>functionName</code>, you can set the variables/fields to mock implementations. And if other tests may cause the <code>functionName</code> to be called beware of concurrent access... I don't think there is much else you can do without changing the existing code significantly.</p>\n"}, {"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1493221684, "post_id": 43623928, "comment_id": 74326215, "body": "To some extent, the negative stack reference isn&#39;t really a bug.  The function is not exported, so we only have to worry about internal usage of it.  In theory, it might be useful to have a check against the actual size of the stack, but I think that&#39;s probably more complexity than is needed here.  As for the sentinel value, again, internal usage.  This function is called purely and only to dump to log, so having a useful &quot;nothing found&quot; string for logging is beneficial.  The output is never <i>checked</i> or <i>validated</i> by anything, though, so there&#39;s no need for a defined comparison variable."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1493221729, "post_id": 43623928, "comment_id": 74326250, "body": "Good quote by Dijkstra, though, and relevant to the current case.  I&#39;ll have to think more on this."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 0, "last_activity_date": 1493190668, "last_edit_date": 1493190668, "creation_date": 1493173309, "answer_id": 43623928, "question_id": 43619913, "link": "https://stackoverflow.com/questions/43619913/mask-package-name-in-test-file-only/43623928#43623928", "title": "Mask package name in test file only", "body": "<blockquote>\n  <p><a href=\"https://www.cs.utexas.edu/users/EWD/ewd03xx/EWD303.PDF\" rel=\"nofollow noreferrer\">On the reliability of programs.</a> Edsger W. Dijkstra</p>\n  \n  <p>The first moral of the story is that program testing can be used very\n  effectively to show the presence of bugs but never to show their\n  absence.</p>\n</blockquote>\n\n<hr>\n\n<p>Let's read your code. Go type <code>int</code> is a 32- or 64-bit signed integer. Therefore, consider,</p>\n\n<p><code>funcname.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"strings\"\n)\n\n// functionName returns a string representing the function name of the function n stack frames above the caller.\n// if n = 0, the name of the function calling functionName() will be returned.\nfunc functionName(n int) string {\n    pc, _, _, ok := runtime.Caller(n + 1)\n    if !ok {\n        return \"unknown function\"\n    }\n    me := runtime.FuncForPC(pc)\n    if me == nil {\n        return \"unknown function\"\n    }\n\n    split := strings.Split(me.Name(), \".\")\n    if len(split) == 0 {\n        return \"unknown function\"\n    }\n    return split[len(split)-1]\n}\n\nfunc main() {\n    for skip := -4; skip &lt;= 4; skip++ {\n        fn := functionName(skip)\n        fmt.Println(functionName(0), skip, fn)\n    }\n    const (\n        sizeInt = 32 &lt;&lt; (^uint(0) &gt;&gt; 63)\n        maxInt  = 1&lt;&lt;(sizeInt-1) - 1\n        minInt  = -1 &lt;&lt; (sizeInt - 1)\n    )\n    for _, skip := range []int{minInt, maxInt} {\n        fn := functionName(skip)\n        fmt.Println(functionName(0), skip, fn)\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run funcname.go\nmain -4 skipPleaseUseCallersFrames\nmain -3 skipPleaseUseCallersFrames\nmain -2 skipPleaseUseCallersFrames\nmain -1 functionName\nmain 0 main\nmain 1 main\nmain 2 goexit\nmain 3 unknown function\nmain 4 unknown function\nmain -9223372036854775808 skipPleaseUseCallersFrames\nmain 9223372036854775807 skipPleaseUseCallersFrames\n$  \n</code></pre>\n\n<p>It looks like a bug in <code>functionName</code> to me. What did your coverage testing say about this?</p>\n\n<hr>\n\n<p>Reading your code there appears to be no reliable way to detect the return of an error value. One way would be to return an empty string. If you want to use a special value such as <code>\"unknown function\"</code> then provide a value to check against. For example,</p>\n\n<pre><code>const functionUnknown = \"unknown function\"\n\nfunc functionName(n int) string {\n    pc, file, line, ok := runtime.Caller(n + 1)\n    if !ok {\n        return functionUnknown\n    }\n    // . . .\n}\n\nfunc main() {\n    fn := functionName(0)\n    if fn == functionUnknown {\n        // handle error\n    }\n}\n</code></pre>\n\n<p>What did your coverage testing say about this?</p>\n"}], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 1, "accepted_answer_id": 43621340, "answer_count": 2, "score": 0, "last_activity_date": 1493190668, "creation_date": 1493150394, "question_id": 43619913, "link": "https://stackoverflow.com/questions/43619913/mask-package-name-in-test-file-only", "title": "Mask package name in test file only", "body": "<p>In pursuit of 100% unit test coverage, we have several lines we're trying to test in one of our functions.  The relevant function calls out to the runtime package:</p>\n\n<pre><code>// functionName returns a string representing the function name of the function n stack frames above the caller.\n// if n = 0, the name of the function calling functionName() will be returned.\nfunc functionName(n int) string {\n    pc, _, _, ok := runtime.Caller(n + 1)\n    if !ok {\n        return \"unknown function\"\n    }\n    me := runtime.FuncForPC(pc)\n    if me == nil {\n        return \"unknown function\"\n    }\n\n    split := strings.Split(me.Name(), \".\")\n    if len(split) == 0 {\n        return \"unknown function\"\n    }\n    return split[len(split)-1]\n}\n</code></pre>\n\n<p>Specifically, the 3 <code>if</code> statements and their return values are currently untested, because the runtime functions don't appear to be easily manipulated to return the values we want.  Our standard response in these cases is to mock out the items in question, but these calls are to package-level functions (rather than methods of an interface) within the runtime package itself.</p>\n\n<p>My first thought was to mock out the runtime token itself by using a structure with Caller() and FuncForPC() methods, assigned to a variable named \"runtime\" in the test files (so it wouldn't affect the production code flow, since test files are omitted during normal builds).  However, this triggers a build error about \"runtime\" being redeclared within the (global) block.  </p>\n\n<p>I know this would be possible if the \"runtime\" variable were declare in a non-global scope (<a href=\"https://play.golang.org/p/J4ccrIPLfy\" rel=\"nofollow noreferrer\">example masking fmt</a>), but I can't find an elegant way to do so such that it gets masked within the tests, but not within the production code itself.  The only way I've thought of is by altering the source of the production code to declare such a variable and replacing it's value in the tests, but this is far from ideal, since it complicates the production code purely for the purposes of testing.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["heroku", "go", "backgroundworker"], "answers": [{"comments": [{"owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "edited": false, "score": 0, "creation_date": 1493391888, "post_id": 43620793, "comment_id": 74412717, "body": "Thank you, I know I cannot rely on any machine and that&#39;s why I wanted to know how to handle this."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1493159267, "last_edit_date": 1493159267, "creation_date": 1493153738, "answer_id": 43620793, "question_id": 43619459, "link": "https://stackoverflow.com/questions/43619459/performing-go-routines-in-background/43620793#43620793", "title": "Performing go routines in background", "body": "<blockquote>\n  <p>I need a way of running this routine independently from the dynos so I\n  know that it will not get shutdown.</p>\n</blockquote>\n\n<p>If you don't want to run your worker code on a dyno then you'll need to use a different provider from Heroku, like Amazon AWS, Digital Ocean, Linode etc.</p>\n\n<p>Having said that, you should design your workers, especially those that are mission critical, to be able to recover from a shutdown. Either to be able to continue where they left off or to start over. Heroku's dyno manager restarts the dynos at least once a day but I wouldn't be surprised if the other cloud providers also restart their virtual instances once in a while, probably not once a day but still... And even if you decide to deploy your workers on a physical machine that you control and never turn off, you cannot prevent things like hardware failure or power outage from happening.</p>\n\n<p>If your workers need to perform some task till it's done you need to make them be aware of possible shutdowns and have them handle such scenarios gracefully. Do not ever rely on a machine, physical or virtual, to keep running while your worker is doing it's job.</p>\n\n<p>For example if you're on Heroku, use a <a href=\"https://devcenter.heroku.com/articles/background-jobs-queueing\" rel=\"nofollow noreferrer\">worker dyno</a> and make your worker listen for the <code>SIGTERM</code> signal, after your worker receives such a signal...</p>\n\n<blockquote>\n  <p>The application processes have 30 seconds to shut down cleanly\n  (ideally, they will do so more quickly than that). During this time\n  they should stop accepting new requests or jobs and attempt to finish\n  their current requests, or put jobs back on the queue for other worker\n  processes to handle. If any processes remain after that time period,\n  the dyno manager will terminate them forcefully with <code>SIGKILL</code>.</p>\n</blockquote>\n\n<p>... continue reading <a href=\"https://devcenter.heroku.com/articles/dynos#shutdown\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>But keep in mind, as I mentioned earlier, if there is an outage and Heroku goes down, which is something that happens from time to time, your worker won't even have those 30 seconds to clean up.</p>\n"}], "owner": {"reputation": 1933, "user_id": 6342826, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/iSdHY.jpg?s=128&g=1", "display_name": "Leticia Esperon", "link": "https://stackoverflow.com/users/6342826/leticia-esperon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 172, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493159267, "creation_date": 1493148821, "question_id": 43619459, "link": "https://stackoverflow.com/questions/43619459/performing-go-routines-in-background", "title": "Performing go routines in background", "body": "<p>I am new to Go and I am using go routines in my app in Heroku, which are long (up to 7 minutes), and cannot be interrupted. \nI saw that the auto scaler sometimes kills the Heroku dyno which is running the routine. I need a way of running this routine independently from the dynos so I know that it will not get shutdown. I read articles and still don't understand how to perform a go routine in a background worker. It is hard for me to believe I am the only one experiencing this.\nMy go routines use my redis database. </p>\n\n<p>Could someone please point me to an example of how to setup a background worker in heroku for go and how to send my go routine to that worker? </p>\n\n<p>Thank you very much</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493147668, "post_id": 43618860, "comment_id": 74287149, "body": "Edit your source files to match the current state of things? That&#39;s what I&#39;ve always done. Curious to see if there&#39;s a better answer."}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1493158048, "post_id": 43619185, "comment_id": 74292632, "body": "As an alternative to <code>grep</code> one can also use the <a href=\"https://golang.org/cmd/gofmt/\" rel=\"nofollow noreferrer\">gofmt tool</a>. E.g. for changing the imports <code>gofmt -w -r &#39;&quot;path&#47;to&#47;PackageName&quot; -&gt; &quot;path&#47;to&#47;packagename&quot;&#39; .&#47;</code> and for changing the <i>selector expressions</i> on that package <code>gofmt -w -r &#39;PackageName.x -&gt; packagename.x&#39; .&#47;</code>"}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": true, "score": 7, "last_activity_date": 1493214910, "last_edit_date": 1592644375, "creation_date": 1493147928, "answer_id": 43619185, "question_id": 43618860, "link": "https://stackoverflow.com/questions/43618860/how-to-handle-case-sensitive-import-collisions/43619185#43619185", "title": "How to handle case sensitive import collisions", "body": "<p>You could <strong>vendor the dependencies</strong>, and then go into the <code>vendor/</code> directory and <strong>manually change</strong> (try <code>grep</code>ing or <code>sed</code>ing the dependency), the dependencies.</p>\n<p>For an introduction to vendoring, try here, <a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder/\" rel=\"noreferrer\">https://blog.gopheracademy.com/advent-2015/vendor-folder/</a></p>\n<p>The original repo can still live in your <code>GOPATH</code>, but the 'corrected' version can go in the vendor folder, in which the compiler will look <em>first</em> when linking dependencies.</p>\n<p>There are many tools for vendoring, I use <a href=\"https://github.com/kardianos/govendor\" rel=\"noreferrer\">govendor</a></p>\n<p><strong>Edit</strong></p>\n<p>As mkopriva mentions in the comments, you can <strong>refactor import names</strong> using the <a href=\"https://golang.org/cmd/gofmt/\" rel=\"noreferrer\"><code>gofmt</code></a> tool:</p>\n<blockquote>\n<p><code>gofmt -w -r '&quot;path/to/PackageName&quot; -&gt; &quot;path/to/packagename&quot;' ./</code></p>\n<p><code>gofmt -w -r 'PackageName.x -&gt; packagename.x' ./</code></p>\n</blockquote>\n<p>The lowercase single character identifier is a <strong>wildcard</strong>.</p>\n<p>from the docs</p>\n<blockquote>\n<p>The rewrite rule specified with the -r flag must be a string of the form:</p>\n<p><code>pattern -&gt; replacement</code></p>\n<p>Both pattern and replacement must be valid Go expressions. In the pattern, single-character lowercase identifiers serve as wildcards matching arbitrary sub-expressions; those expressions will be substituted for the same identifiers in the replacement.</p>\n</blockquote>\n"}], "owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5801, "favorite_count": 0, "accepted_answer_id": 43619185, "answer_count": 1, "score": 4, "last_activity_date": 1493214910, "creation_date": 1493146767, "question_id": 43618860, "link": "https://stackoverflow.com/questions/43618860/how-to-handle-case-sensitive-import-collisions", "title": "How to handle case sensitive import collisions", "body": "<p>I am using a third party library in GoLang that has previously had import paths in different case. Initially a letter was lower case then the author changed it to uppercase.</p>\n\n<p>Some plugin authors updated their libraries and others didn't. In the meantime the original library author reverted the case change.</p>\n\n<p>Now I find myself in a state where my application won't build due to to case import collisions.</p>\n\n<p>How can one go about fixing this?</p>\n\n<p>Many thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493145587, "post_id": 43618272, "comment_id": 74285894, "body": "Please use gofmt!"}, {"owner": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "edited": false, "score": 1, "creation_date": 1493145632, "post_id": 43618272, "comment_id": 74285930, "body": "Before you start going down this route please read some of these answers: <a href=\"http://stackoverflow.com/questions/2113751/sizeof-struct-in-go\">stackoverflow.com/questions/2113751/sizeof-struct-in-go</a> (there are some cautions to be aware of when trying to understand the size of a struct)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1493145903, "post_id": 43618272, "comment_id": 74286084, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/2113751/sizeof-struct-in-go\">Sizeof struct in Go</a>"}, {"owner": {"reputation": 197, "user_id": 507952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/813f777f3374982f35a6f8233b9ea020?s=128&d=identicon&r=PG", "display_name": "Daniel Gao", "link": "https://stackoverflow.com/users/507952/daniel-gao"}, "reply_to_user": {"reputation": 9369, "user_id": 71079, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/3e302415f77b6c398abc0b16efc653f3?s=128&d=identicon&r=PG", "display_name": "Ralph Caraveo", "link": "https://stackoverflow.com/users/71079/ralph-caraveo"}, "edited": false, "score": 0, "creation_date": 1493146784, "post_id": 43618272, "comment_id": 74286619, "body": "@RalphCaraveo I have read that answer, but my question is more about how to handle the case when there is an collection or pointer field involved. It would much easier if the struct only contains basic type."}], "owner": {"reputation": 197, "user_id": 507952, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/813f777f3374982f35a6f8233b9ea020?s=128&d=identicon&r=PG", "display_name": "Daniel Gao", "link": "https://stackoverflow.com/users/507952/daniel-gao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 389, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1493150852, "creation_date": 1493144660, "last_edit_date": 1493150852, "question_id": 43618272, "link": "https://stackoverflow.com/questions/43618272/how-to-get-the-memory-size-of-an-user-generated-thrift-object-in-go", "title": "How to get the memory size of an user generated thrift object in Go", "body": "<p>I am new to Go, and trying to get the estimate size of a Thrift generated object in Go, the object has multiple level, and in the case of an member variable is an collection of pointers, I want to get the total size of pointer and the data that been pointed to. The sizeOf function won't work in this case, as it will only count the space taken by the pointer, not the actual space. What's the best way to get a good estimate of the size of the object? Ideally, I would like to breakdown the size into different fields and subfields</p>\n\n<p>Here is how an example object looks like in Go</p>\n\n<pre><code>type Microshard struct {\n    Header         *Header           `thrift:\"header,1,required\"`\n    ValidatorStats []*ValidatorStat  `thrift:\"validatorStats,2,required\"`\n    DataMap1       map[int64][]byte  `thrift:\"dataMap1,3,required\"`\n    DataMap2       map[int64][]byte  `thrift:\"dataMap2,4,required\"`\n    DataMap3       map[int64][]int64 `thrift:\"dataMap3,5,required\"`\n    DebugInfoMap   map[string][]byte `thrift:\"debugInfoMap,6,required\"`\n    Index          *IndexData        `thrift:\"index,7\"`\n}\n</code></pre>\n"}, {"tags": ["parsing", "go", "protocol-buffers"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493143830, "post_id": 43618017, "comment_id": 74284944, "body": "Can you not simply check <code>if arg[n] == &quot;&quot;</code> ?"}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493144144, "post_id": 43618017, "comment_id": 74285126, "body": "No. Any field can be gone and I dont know which one is missing if i just check length"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493144213, "post_id": 43618017, "comment_id": 74285148, "body": "Are you parsing command line arguments? If so, use the <a href=\"https://godoc.org/flag\" rel=\"nofollow noreferrer\">godoc.org/flag</a> package. Otherwise, we need a little more context where these args are coming from."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493144589, "post_id": 43618017, "comment_id": 74285350, "body": "I am parsing files. Thing about the arg are already parsed into proper values."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493144870, "post_id": 43618017, "comment_id": 74285488, "body": "@RayfenWindspear, take a look at my update. I posted the file structure."}], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493146054, "post_id": 43618544, "comment_id": 74286177, "body": "Made it more portable just now."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493146074, "post_id": 43618544, "comment_id": 74286190, "body": "Thanks for the solution. However, the number of optional fields can be big and I would like to avoid so many switch case for each field. Is there a way to loop around the struct?"}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493146127, "post_id": 43618544, "comment_id": 74286228, "body": "I have thought about a map. However, I would like to have an ordered structure."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493146195, "post_id": 43618544, "comment_id": 74286265, "body": "I have another idea. You can use a regular expression to turn an input line into JSON, then use the <code>encoding&#47;json</code> package. This is more costly as far as CPU is concerned though"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493146727, "post_id": 43618544, "comment_id": 74286578, "body": "My regex is rusty... gimme a minute and I&#39;ll have a new answer."}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 0, "last_activity_date": 1493158458, "last_edit_date": 1493158458, "creation_date": 1493145575, "answer_id": 43618544, "question_id": 43618017, "link": "https://stackoverflow.com/questions/43618017/how-to-flatten-message-with-mutable-structure-into-protobuf/43618544#43618544", "title": "How to flatten message with mutable structure into protobuf?", "body": "<p>Looks like you can write the parser for each line of your input something like the following. </p>\n\n<p>NOTE: I didn't make the struct with <code>proto</code> values because as an external package, it can't be imported in the playground.</p>\n\n<p><a href=\"https://play.golang.org/p/hLZvbiMMlZ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/hLZvbiMMlZ</a></p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"strings\"\n)\n\nvar ins = []string{\n    `id=1, name=peter, age=24`,\n    `id=2, age=30`,\n    `name=mary, age=31`,\n    `id=100`,\n    `name=bob`,\n    `age=11`,\n}\n\nvar ParseError = errors.New(\"bad parser input\")\n\ntype Test struct {\n    ID   string\n    Name string\n    Age  string\n}\n\nfunc (t *Test) String() string {\n    return fmt.Sprintf(\"ID: %s, Name: %s, Age: %s\", t.ID, t.Name, t.Age)\n}\n\nfunc main() {\n    for _, v := range ins {\n        t, err := ParseLine(v)\n        if err != nil {\n            fmt.Println(err)\n        } else {\n            fmt.Println(t)\n        }\n    }\n}\n\nfunc ParseLine(inp string) (*Test, error) {\n    splt := strings.Split(inp, \",\")\n    test := &amp;Test{}\n    for _, f := range splt {\n        fieldVal := strings.Split(strings.TrimSpace(f), \"=\")\n        switch strings.TrimSpace(fieldVal[0]) {\n        case \"id\":\n            test.ID = strings.TrimSpace(fieldVal[1])\n        case \"name\":\n            test.Name = strings.TrimSpace(fieldVal[1])\n        case \"age\":\n            test.Age = strings.TrimSpace(fieldVal[1])\n        default:\n            return nil, ParseError\n        }\n    }\n    return test, nil\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493150722, "post_id": 43619246, "comment_id": 74289004, "body": "The parsing is nice. But my main question is how to serialize this into protobuf? I.e., If we see some fields are missing in protobuf, dont populate it."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493150822, "post_id": 43619246, "comment_id": 74289070, "body": "Ah yes, let me get to that. I guess I&#39;ll make it as generic as possible"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493151204, "post_id": 43619246, "comment_id": 74289309, "body": "Looks like there is a json package specific to protocol buffers. <a href=\"https://godoc.org/github.com/golang/protobuf/jsonpb\" rel=\"nofollow noreferrer\">godoc.org/github.com/golang/protobuf/jsonpb</a> . Admittedly, I haven&#39;t really ever used protocol buffers myself, so I&#39;m not sure how much I can help with that. Plus, that package is not a standard package, so it can&#39;t be run in the playground. Take a look and tell me if it is straightforward enough."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493153905, "post_id": 43619246, "comment_id": 74290764, "body": "Give that a try now. Also, may I just add that using a gigantic switch statement as in my other answer would result in more efficient code. The json parsers are notoriously expensive. However, as long as each item is less than thousands of characters, you should be fine."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493156574, "post_id": 43619246, "comment_id": 74292030, "body": "I think that is doing redundant work by converting from file format to json, then json to pb while I should do file to pb directly. Performance will be impacted by doing redundant work."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493156751, "post_id": 43619246, "comment_id": 74292108, "body": "Which is what I was trying to accomplish with my first answer. You could directly assign the pb struct values in the switch statement. Doing it this way just makes it more convenient."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493164389, "post_id": 43619246, "comment_id": 74294570, "body": "The first solution did not take care of the &quot;too many fields&quot; problem I mentioned. I want to avoid using lots of switch and case if I have, say 30 fields."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493164673, "post_id": 43619246, "comment_id": 74294630, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/142674/discussion-between-drdot-and-rayfenwindspear\">continue this discussion in chat</a>."}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493399520, "post_id": 43619246, "comment_id": 74417256, "body": "I think this method is smart. However, I have one last problem with it before I accept it as the answer. After jsonpb.UnmarshalString(JSON, test), &quot;test&quot; should have the protobuf content. However, if I do fmt.Println(test), then it does not print the value as string, it prints them as address. Could you tell me how to print the actual protobuf value out?"}, {"owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "edited": false, "score": 0, "creation_date": 1493403291, "post_id": 43619246, "comment_id": 74419056, "body": "There seems to be a bug in jsonpb...I will open another question for that. Thank you for answering this question. Here is the new question about the bug: <a href=\"http://stackoverflow.com/questions/43686507/why-is-the-protobuf-marshall-and-unmarshall-returns-different-results-from-befor\" title=\"why is the protobuf marshall and unmarshall returns different results from befor\">stackoverflow.com/questions/43686507/&hellip;</a>"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 1, "last_activity_date": 1493153887, "last_edit_date": 1493153887, "creation_date": 1493148135, "answer_id": 43619246, "question_id": 43618017, "link": "https://stackoverflow.com/questions/43618017/how-to-flatten-message-with-mutable-structure-into-protobuf/43619246#43619246", "title": "How to flatten message with mutable structure into protobuf?", "body": "<p>You could use a regular expression to change your input strings into valid JSON, the use the <code>encoding/json</code> package to parse it. This has the advantage of letting the <code>json</code> parser take care of everything for you. Here is the regex for your particular case.</p>\n\n<p>Basically, the regex looks for <code>field=value</code> and replaces with <code>\"field\" : \"value\"</code> and wraps it in <code>{}</code> to create valid JSON. The commas are left as is.</p>\n\n<p><a href=\"https://play.golang.org/p/_EEdTB6sve\" rel=\"nofollow noreferrer\">https://play.golang.org/p/_EEdTB6sve</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"errors\"\n    \"fmt\"\n    \"log\"\n    \"regexp\"\n)\n\nvar ins = []string{\n    `id=1, name=peter, age=24`,\n    `id=2, age=30`,\n    `name=mary, age=31`,\n    `id=100`,\n    `name=bob`,\n    `age=11`,\n}\n\nvar ParseError = errors.New(\"bad parser input\")\nvar Regex *regexp.Regexp\n\ntype Test struct {\n    ID   string\n    Name string\n    Age  string\n}\n\nfunc (t *Test) String() string {\n    return fmt.Sprintf(\"ID: %s, Name: %s, Age: %s\", t.ID, t.Name, t.Age)\n}\n\nfunc main() {\n    var err error\n    Regex, err = regexp.Compile(`([^,\\s]*)=([^,\\s]*)`)\n    if err != nil {\n        log.Panic(err)\n    }\n    for _, v := range ins {\n\n        test, err := ParseLine(v)\n        if err != nil {\n            log.Panic(err)\n        }\n        fmt.Println(test)\n    }\n}\n\nfunc ParseLine(inp string) (*Test, error) {\n    JSON := fmt.Sprintf(\"{%s}\", Regex.ReplaceAllString(inp, `\"$1\" : \"$2\"`))\n    test := &amp;Test{}\n    err := json.Unmarshal([]byte(JSON), test)\n    if err != nil {\n        return nil, err\n    }\n    return test, nil\n}\n</code></pre>\n\n<p>Here is what I believe to be a minimum working case for what you are after, though I am not familiar enough with protocol buffers to get the strings to print right... or even verify if they are correct. Note that this doesn't run in the playground.</p>\n\n<pre><code>package main\n\nimport (\n    \"errors\"\n    \"fmt\"\n    \"log\"\n    \"regexp\"\n    \"github.com/golang/protobuf/jsonpb\"\n    _ \"github.com/golang/protobuf/proto\"\n)\n\nvar ins = []string{\n    `id=1, name=peter, age=24`,\n    `id=2, age=30`,\n    `name=mary, age=31`,\n    `id=100`,\n    `name=bob`,\n    `age=11`,\n}\n\nvar ParseError = errors.New(\"bad parser input\")\nvar Regex *regexp.Regexp\n\ntype Test struct {\n    ID   *string `protobuf:\"bytes,1,opt,name=id,json=id\" json:\"id,omitempty\"`\n    Name *string `protobuf:\"bytes,2,opt,name=name,json=name\" json:\"name,omitempty\"`\n    Age  *string `protobuf:\"bytes,3,opt,name=age,json=age\" json:\"age,omitempty\"`\n}\n\nfunc (t *Test) Reset() {\n    *t = Test{}\n}\n\n\nfunc (*Test) ProtoMessage() {}\nfunc (*Test) Descriptor() ([]byte, []int) {return []byte{}, []int{0}}\n\nfunc (t *Test) String() string {\n    return fmt.Sprintf(\"ID: %v, Name: %v, Age: %v\", t.ID, t.Name, t.Age)\n}\n\nfunc main() {\n    var err error\n    Regex, err = regexp.Compile(`([^,\\s]*)=([^,\\s]*)`)\n    if err != nil {\n        log.Panic(err)\n    }\n    for _, v := range ins {\n\n        test, err := ParseLine(v)\n        if err != nil {\n            fmt.Println(err)\n            log.Panic(err)\n        }\n        fmt.Println(test)\n    }\n}\n\nfunc ParseLine(inp string) (*Test, error) {\n    JSON := fmt.Sprintf(\"{%s}\", Regex.ReplaceAllString(inp, `\"$1\" : \"$2\"`))\n    test := &amp;Test{}\n    err := jsonpb.UnmarshalString(JSON, test)\n    if err != nil {\n        return nil, err\n    }\n    return test, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 2463, "user_id": 734748, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f4c88df46d0a7ff19707848263339ee?s=128&d=identicon&r=PG", "display_name": "drdot", "link": "https://stackoverflow.com/users/734748/drdot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 960, "favorite_count": 0, "accepted_answer_id": 43619246, "answer_count": 2, "score": 1, "last_activity_date": 1493158458, "creation_date": 1493143699, "last_edit_date": 1493144842, "question_id": 43618017, "link": "https://stackoverflow.com/questions/43618017/how-to-flatten-message-with-mutable-structure-into-protobuf", "title": "How to flatten message with mutable structure into protobuf?", "body": "<p>My proto buf format is this:</p>\n\n<pre><code>package main;\n\nmessage Test {\n  optional string id = 1;\n  optional string name = 2;\n  optional string age = 3;\n}\n</code></pre>\n\n<p>Then I populate the protobuf files from the input in golang using the following code. str is already parsed. </p>\n\n<pre><code>test = &amp;Test{\n  id: proto.String(str[0]),\n  name:  proto.String(str[1]),\n  age: proto.String(str[2]),\n},\n</code></pre>\n\n<p>One condition I have to handle is that one or more optional fields in the Test structure could be absent randomly and I do not know that in advance. How do I handle that in golang?</p>\n\n<p>To give more context, the real data can look like these in the file:</p>\n\n<pre><code>id=1, name=peter, age=24\nid=2, age=30\nname=mary, age=31\nid=100\nname=bob\nage=11\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493140498, "post_id": 43616676, "comment_id": 74283045, "body": "A slice is an object that references an array (Flimzy&#39;s answer). Also keep in mind that you can actually use bare arrays in go, but they are quite unwieldy compared to slices. They can be useful in certain circumstances though."}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 3196293, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1040298947/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/3196293/david"}, "edited": false, "score": 0, "creation_date": 1493140498, "post_id": 43616972, "comment_id": 74283046, "body": "This explains a lot! I thought that append return a new slice. Tanks!"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 325, "user_id": 3196293, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1040298947/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/3196293/david"}, "edited": false, "score": 0, "creation_date": 1493140797, "post_id": 43616972, "comment_id": 74283237, "body": "@David: <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">Go Slices: usage and internals</a> would be some good reading for you."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 3, "last_activity_date": 1493140056, "creation_date": 1493140056, "answer_id": 43616972, "question_id": 43616676, "link": "https://stackoverflow.com/questions/43616676/moving-an-slice-item-from-one-position-to-another-in-go/43616972#43616972", "title": "Moving an slice item from one position to another in go", "body": "<p>The problem is that <code>newSlice</code> is not a distinct copy of <code>slice</code>--they reference the same underlying array.</p>\n\n<p>So when you assign to <code>newSlice</code>, you're modifying the underlying array, and thus <code>slice</code>, too.</p>\n\n<p>To remedy this, you need to make an explicit copy:</p>\n\n<p><a href=\"https://play.golang.org/p/P74nOrHN3j\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    indexToRemove := 1\n    indexWhereToInsert := 4\n\n    slice := []int{0,1,2,3,4,5,6,7,8,9}\n\n    val := slice[indexToRemove]\n\n    slice = append(slice[:indexToRemove], slice[indexToRemove+1:]...)\n    fmt.Println(\"slice:\", slice)    \n\n    newSlice := make([]int, indexWhereToInsert+1)\n    copy(newSlice,slice[:indexWhereToInsert])\n    newSlice[indexWhereToInsert]=val\n    fmt.Println(\"newSlice:\", newSlice)\n    fmt.Println(\"slice:\", slice)\n\n    slice = append(newSlice, slice[indexWhereToInsert:]...)\n    fmt.Println(\"slice:\", slice)    \n}\n</code></pre>\n\n<p>(Note that I've also added the <code>val</code> variable, rather than hardcoding <code>1</code> as the value to be inserted.)</p>\n"}, {"tags": [], "owner": {"reputation": 1288, "user_id": 7225929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa26a9a36b086d9872cbe4c70355dfd3?s=128&d=identicon&r=PG&f=1", "display_name": "omotto", "link": "https://stackoverflow.com/users/7225929/omotto"}, "is_accepted": false, "score": 5, "last_activity_date": 1578656630, "creation_date": 1578656630, "answer_id": 59681020, "question_id": 43616676, "link": "https://stackoverflow.com/questions/43616676/moving-an-slice-item-from-one-position-to-another-in-go/59681020#59681020", "title": "Moving an slice item from one position to another in go", "body": "<p>I had the same issue before and I solved as:</p>\n\n<pre><code>func insertInt(array []int, value int, index int) []int {\n    return append(array[:index], append([]int{value}, array[index:]...)...)\n}\n\nfunc removeInt(array []int, index int) []int {\n    return append(array[:index], array[index+1:]...)\n}\n\nfunc moveInt(array []int, srcIndex int, dstIndex int) []int {\n    value := array[srcIndex]\n    return insertInt(removeInt(array, srcIndex), value, dstIndex)\n}\n\n\nfunc main() {\n    slice := []int{0,1,2,3,4,5,6,7,8,9}\n\n    fmt.Println(\"slice: \", slice)\n\n    slice = insertInt(slice, 2, 5)  \n    fmt.Println(\"slice: \", slice)\n\n    slice = removeInt(slice, 5) \n    fmt.Println(\"slice: \", slice)\n\n    slice = moveInt(slice, 1, 4) \n    fmt.Println(\"slice: \", slice)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Sfu1VsySieS\" rel=\"noreferrer\">https://play.golang.org/p/Sfu1VsySieS</a></p>\n"}], "owner": {"reputation": 325, "user_id": 3196293, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1040298947/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/3196293/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4952, "favorite_count": 0, "accepted_answer_id": 43616972, "answer_count": 2, "score": 6, "last_activity_date": 1578656630, "creation_date": 1493139120, "question_id": 43616676, "link": "https://stackoverflow.com/questions/43616676/moving-an-slice-item-from-one-position-to-another-in-go", "title": "Moving an slice item from one position to another in go", "body": "<p>I' trying to move an item from one position to another inside a slice. <a href=\"https://play.golang.org/p/JsYZ6TgKWQ\" rel=\"noreferrer\">Go Playground</a></p>\n\n<pre><code>indexToRemove := 1\nindexWhereToInsert := 4\n\nslice := []int{0,1,2,3,4,5,6,7,8,9}    \n\nslice = append(slice[:indexToRemove], slice[indexToRemove+1:]...)\nfmt.Println(\"slice:\", slice)    \n\nnewSlice := append(slice[:indexWhereToInsert], 1)\nfmt.Println(\"newSlice:\", newSlice)\n\nslice = append(newSlice, slice[indexWhereToInsert:]...)\nfmt.Println(\"slice:\", slice)\n</code></pre>\n\n<p>This produces to following output:</p>\n\n<pre><code>slice: [0 2 3 4 5 6 7 8 9]\nnewSlice: [0 2 3 4 1]\nslice: [0 2 3 4 1 1 6 7 8 9] \n</code></pre>\n\n<p>But I would expect the output be like this:</p>\n\n<pre><code>slice: [0 2 3 4 5 6 7 8 9]\nnewSlice: [0 2 3 4 1]\nslice: [0 2 3 4 1 **5** 6 7 8 9] \n</code></pre>\n\n<p>Where is my fault?</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1493140132, "post_id": 43616434, "comment_id": 74282848, "body": "A channel value is like any other value. If there are no references to it, it will be garbage collected. Related / useful to know: <a href=\"http://stackoverflow.com/questions/39015602/how-does-a-non-initialized-channel-behave/39016004#39016004\">How does a non initialized channel behave?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 2, "creation_date": 1493138945, "post_id": 43616486, "comment_id": 74282107, "body": "So, I understand that a good practice (maybe the best) is to close the channel. This way, even if there are other references to that channel I won&#39;t be able to use it and I will avoid memory leaks. (and this is exactly why I asked the question). Thanks for your reply!"}, {"owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "edited": false, "score": 0, "creation_date": 1493145889, "post_id": 43616486, "comment_id": 74286073, "body": "Thank you all! That was really helpful. @Flimzy, indeed the blog post is very useful."}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 17, "last_activity_date": 1493145364, "last_edit_date": 1493145364, "creation_date": 1493138563, "answer_id": 43616486, "question_id": 43616434, "link": "https://stackoverflow.com/questions/43616434/closed-channel-vs-nil-channel/43616486#43616486", "title": "Closed channel vs nil channel", "body": "<p>Setting a channel variable to nil simply sets the variable to nil, while leaving the channel it had previously referred to initialized.</p>\n\n<p>It's the same as setting any other variable to nil.</p>\n\n<p>If there are other references to the channel, you could still access it.  If there are not, it will be garbage collected.</p>\n\n<p>Additionally, <code>nil</code> versus closed channels behave differently when writing or reading.  From Dave Cheney's blog post, <a href=\"https://dave.cheney.net/2014/03/19/channel-axioms\" rel=\"noreferrer\"><em>Channel Axioms</em></a>, which I recommend reading in its entirety:</p>\n\n<blockquote>\n  <ul>\n  <li>A send to a nil channel blocks forever</li>\n  <li>A receive from a nil channel blocks forever</li>\n  <li>A send to a closed channel panics</li>\n  <li>A receive from a closed channel returns the zero value immediately</li>\n  </ul>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1493139024, "creation_date": 1493139024, "answer_id": 43616643, "question_id": 43616434, "link": "https://stackoverflow.com/questions/43616434/closed-channel-vs-nil-channel/43616643#43616643", "title": "Closed channel vs nil channel", "body": "<p>It's in a language specification.\nYou can receive from closed channel forever, but writing on closed channel cause runtime panic.\nBoth operation on a nil channel blocks forever.\nSuch a behaviour commonly used in synchronization schemes.</p>\n"}], "owner": {"reputation": 1445, "user_id": 5972487, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/024fcbdd0ee00e2dccefce0ef67bc434?s=128&d=identicon&r=PG", "display_name": "elmiomar", "link": "https://stackoverflow.com/users/5972487/elmiomar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3803, "favorite_count": 2, "accepted_answer_id": 43616486, "answer_count": 2, "score": 12, "last_activity_date": 1493145364, "creation_date": 1493138404, "last_edit_date": 1493140274, "question_id": 43616434, "link": "https://stackoverflow.com/questions/43616434/closed-channel-vs-nil-channel", "title": "Closed channel vs nil channel", "body": "<p>I am working with Go channels, and I was wondering what's the difference between closing a channel and setting it to nil?</p>\n\n<p><strong>Edit:</strong></p>\n\n<p>In this <a href=\"https://gist.github.com/elmiomar/16003c13dec80053d804db786615d9a5\" rel=\"noreferrer\">example</a>, I would like to disconnect the sender and receiver by, whether closing the channel or setting to nil. What's the best practice to do this?</p>\n"}, {"tags": ["go", "timer"], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1493139309, "post_id": 43616551, "comment_id": 74282332, "body": "That last edit hit the spot. It is a property of the time it takes a go routine to set up the timer object."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1493139403, "last_edit_date": 1493139403, "creation_date": 1493138710, "answer_id": 43616551, "question_id": 43616295, "link": "https://stackoverflow.com/questions/43616295/golang-timers-with-0-length/43616551#43616551", "title": "Golang Timers with 0 length", "body": "<p><a href=\"https://golang.org/pkg/time/#NewTimer\" rel=\"nofollow noreferrer\"><code>time.NewTimer()</code></a> does not guarantee maximum wait time. It only guarantees a <em>minimum</em> wait time. Quoting from its doc:</p>\n\n<blockquote>\n  <p>NewTimer creates a new Timer that will send the current time on its channel <strong>after at least duration d</strong>.</p>\n</blockquote>\n\n<p>So passing a zero duration to <code>time.NewTimer()</code>, it's not a surprise the returned <a href=\"https://golang.org/pkg/time/#Timer\" rel=\"nofollow noreferrer\"><code>time.Timer</code></a> is not \"expired\" immediately.</p>\n\n<p>The returned timer could be \"expired\" immediately if the implementation would check if the passed duration is zero, and would send a value on the timer's channel before returning it, but it does not. Instead it starts an internal timer normally as it does for any given duration, which will take care of sending a value on its channel, but only some time in the future. </p>\n\n<p>Note that with multiple CPU cores and with <a href=\"https://golang.org/pkg/runtime/#GOMAXPROCS\" rel=\"nofollow noreferrer\"><code>runtime.GOMAXPROCS()</code></a> being greater than 1 there is a slight chance that another goroutine (internal to the <code>time</code> package) sends a value on the timer's channel before <code>NewTimer()</code> returns, but this is a very small chance... Also since this is implementation detail, a future version might add this \"optimization\" to check for 0 passed duration, and act as you expected it, but as with all implementation details, don't count on it. Count on what's documented, and expect no more.</p>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1493138733, "last_edit_date": 1592644375, "creation_date": 1493138733, "answer_id": 43616555, "question_id": 43616295, "link": "https://stackoverflow.com/questions/43616295/golang-timers-with-0-length/43616555#43616555", "title": "Golang Timers with 0 length", "body": "<p>Go's timer functions guarantee to sleep <em>at least</em> the specified time. See the docs for <a href=\"https://golang.org/pkg/time/#Sleep\" rel=\"nofollow noreferrer\">Sleep</a> and <a href=\"https://golang.org/pkg/time/#Timer\" rel=\"nofollow noreferrer\">NewTimer</a> respectively:</p>\n<blockquote>\n<p>Sleep pauses the current goroutine for at <strong>least the duration d.</strong> A negative or zero duration causes Sleep to return immediately.</p>\n<p>NewTimer creates a new Timer that will send the current time on its channel <strong>after at least duration d.</strong></p>\n<p><em>(emphasis added)</em></p>\n</blockquote>\n<p>In your situation, you should probably just not use a timer in the situation that you don't want to sleep at all.</p>\n"}, {"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 0, "last_activity_date": 1493140170, "last_edit_date": 1493140170, "creation_date": 1493139518, "answer_id": 43616795, "question_id": 43616295, "link": "https://stackoverflow.com/questions/43616295/golang-timers-with-0-length/43616795#43616795", "title": "Golang Timers with 0 length", "body": "<p>This is due to the internal time it takes to set up the timer object. If you'll note in the playground link below the timer does expire at the proper time, but the internal go routine that sets it up and starts it takes longer than your <code>Expire</code> function does to check it.</p>\n\n<blockquote>\n  <p>When the Timer expires, the current time will be sent on C (the channel)</p>\n</blockquote>\n\n<p>So you'll notice that after it expires, it still sends the original time, because it has expired even before the nanosecond <code>Sleep</code> finished.</p>\n\n<p><a href=\"https://play.golang.org/p/Ghwq9kJq3J\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Ghwq9kJq3J</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    testTimer := time.NewTimer(0 * time.Millisecond)\n    Expired(testTimer)\n    time.Sleep(time.Nanosecond)\n    Expired(testTimer)\n    n := time.Now()\n    fmt.Printf(\"after waiting: %d\\n\", n.UnixNano())\n\n}\n\nfunc Expired(T *time.Timer) bool {\n    select {\n    case t:= &lt;-T.C:\n        fmt.Printf(\"expired %d\\n\", t.UnixNano())\n        return true\n    default:\n        n := time.Now()\n        fmt.Printf(\"not expired: %d\\n\", n.UnixNano())\n        return false\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 165, "user_id": 6475160, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/17a70867403bef59444d9b8722651424?s=128&d=identicon&r=PG&f=1", "display_name": "Qubert", "link": "https://stackoverflow.com/users/6475160/qubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2940, "favorite_count": 0, "accepted_answer_id": 43616551, "answer_count": 3, "score": 2, "last_activity_date": 1493140170, "creation_date": 1493137959, "question_id": 43616295, "link": "https://stackoverflow.com/questions/43616295/golang-timers-with-0-length", "title": "Golang Timers with 0 length", "body": "<p>I've written a code snipped that creates a timer with a 0 length time, and it does not immediately expire (which is what I expected). A very short sleep call does make it expire, but I'm confused as to why. </p>\n\n<p>The reason I care is that the code using this idea has a snippet that returns 0 on a low probability error, with the idea that the timer should be set to immediately expire, and retry a function. I do not believe that the nanosecond sleep needed here will affect my implementation, but it bothers me. </p>\n\n<p>Did I make a mistake, is this expected behaviour?</p>\n\n<p>Thanks!</p>\n\n<pre><code> package main\n\n    import (\n        \"fmt\"\n        \"time\"\n    )\n\n    func main() {\n        testTimer := time.NewTimer(time.Duration(0) * time.Millisecond)\n        fmt.Println(Expired(testTimer))\n        time.Sleep(time.Nanosecond)\n        fmt.Println(Expired(testTimer))\n    }\n\n    func Expired(T *time.Timer) bool {\n        select {\n        case &lt;-T.C:\n            return true\n        default:\n            return false\n        }\n    }\n</code></pre>\n\n<p>Playground link: <a href=\"https://play.golang.org/p/xLLHoR8aKq\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xLLHoR8aKq</a></p>\n\n<p>Prints</p>\n\n<pre><code>false\ntrue\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 116973, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58f3dd702b0b3beb1274a25326ab2069?s=128&d=identicon&r=PG", "display_name": "Martin M.", "link": "https://stackoverflow.com/users/116973/martin-m"}, "edited": false, "score": 0, "creation_date": 1493137265, "post_id": 43615993, "comment_id": 74281095, "body": "Are you saying I need to manually loop and calculate the values for <code>CopySourceRange</code> in the <code>UploadPartCopyInput</code>? That seems doable but ... cumbersome :("}, {"owner": {"reputation": 741, "user_id": 116973, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58f3dd702b0b3beb1274a25326ab2069?s=128&d=identicon&r=PG", "display_name": "Martin M.", "link": "https://stackoverflow.com/users/116973/martin-m"}, "edited": false, "score": 0, "creation_date": 1493137322, "post_id": 43615993, "comment_id": 74281131, "body": "Also, am I ethically required to upvote and accept if that is correct but I really really dislike how the AWS guys implemented this SDK? ;)"}, {"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "reply_to_user": {"reputation": 741, "user_id": 116973, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58f3dd702b0b3beb1274a25326ab2069?s=128&d=identicon&r=PG", "display_name": "Martin M.", "link": "https://stackoverflow.com/users/116973/martin-m"}, "edited": false, "score": 1, "creation_date": 1493137698, "post_id": 43615993, "comment_id": 74281385, "body": "I&#39;m saying that I think it&#39;d work if you manually looped, and that a cursory reading of the api endpoints don&#39;t offer any obvious alternatives. It&#39;s kind of surprising that they don&#39;t have anything that abstracts away the details in the client library though. Should definitely be added to <code>s3&#47;s3manager</code>..."}, {"owner": {"reputation": 741, "user_id": 116973, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58f3dd702b0b3beb1274a25326ab2069?s=128&d=identicon&r=PG", "display_name": "Martin M.", "link": "https://stackoverflow.com/users/116973/martin-m"}, "edited": false, "score": 1, "creation_date": 1607012276, "post_id": 43615993, "comment_id": 115144180, "body": "oh the pain. 3 years later and I run into the same bug and end up at this question..."}], "tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": false, "score": 2, "last_activity_date": 1493137004, "creation_date": 1493137004, "answer_id": 43615993, "question_id": 43614668, "link": "https://stackoverflow.com/questions/43614668/copy-s3-object-with-multipartupload/43615993#43615993", "title": "Copy S3 Object with MultiPartUpload", "body": "<p>I think that <code>ListPartsPages</code> is the wrong direction because it works on \"Multipart Uploads\" which is a different entity than an an s3 \"Object\". So you're listing the already-uploaded parts to the multipart upload you just created.</p>\n\n<p>Your first example is close to what's needed, but you need to manually split the original file into parts, with the range of each part specified by <code>UploadPartCopyInput</code>'s <code>CopySourceRange</code>. At least that's my take from reading the documentation.</p>\n"}], "owner": {"reputation": 741, "user_id": 116973, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/58f3dd702b0b3beb1274a25326ab2069?s=128&d=identicon&r=PG", "display_name": "Martin M.", "link": "https://stackoverflow.com/users/116973/martin-m"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1493137004, "creation_date": 1493133333, "question_id": 43614668, "link": "https://stackoverflow.com/questions/43614668/copy-s3-object-with-multipartupload", "title": "Copy S3 Object with MultiPartUpload", "body": "<p>I need to rename a quite a bunch of objects in AWS S3. For small objects the following snippet works flawlessly:</p>\n\n<pre><code>input := &amp;s3.CopyObjectInput{\n    Bucket:     aws.String(bucket),\n    Key:        aws.String(targetPrefix),\n    CopySource: aws.String(source),\n}\n_, err = svc.CopyObject(input)\nif err != nil {\n    panic(errors.Wrap(err, \"error copying object\"))\n}\n</code></pre>\n\n<p>I am running into the S3 size limitation for larger objects. I understand I need to copy the object using a multi part upload. This is what I tried so far:</p>\n\n<pre><code>multiPartUpload, err := svc.CreateMultipartUpload(\n    &amp;s3.CreateMultipartUploadInput{\n        Bucket: aws.String(bucket),\n        Key: aws.String(targetPrefix), // targetPrefix is the new name\n    },\n)\nif err != nil {\n    panic(errors.Wrap(err, \"could not create MultiPartUpload\"))\n}\nresp, err := svc.UploadPartCopy(\n    &amp;s3.UploadPartCopyInput{\n        UploadId:   multiPartUpload.UploadId,\n        Bucket:     aws.String(bucket),\n        Key:        aws.String(targetPrefix),\n        CopySource: aws.String(source),\n        PartNumber: aws.Int64(1),\n    },\n)\nif err != nil {\n    panic(errors.Wrap(err, \"error copying multipart object\"))\n}\nlog.Printf(\"copied: %v\", resp)\n</code></pre>\n\n<p>The golang SDK bails out on me with:</p>\n\n<pre><code>InvalidRequest: The specified copy source is larger than the maximum allowable size for a copy source: 5368709120\n</code></pre>\n\n<p>I have also tried the following approach but I do not get any parts listed here:</p>\n\n<pre><code>multiPartUpload, err := svc.CreateMultipartUpload(\n    &amp;s3.CreateMultipartUploadInput{\n        Bucket: aws.String(bucket),\n        Key: aws.String(targetPrefix), // targetPrefix is the new name\n    },\n)\nif err != nil {\n    panic(errors.Wrap(err, \"could not create MultiPartUpload\"))\n}\nerr = svc.ListPartsPages(\n    &amp;s3.ListPartsInput{\n        Bucket:   aws.String(bucket),       // Required\n        Key:      obj.Key,                  // Required\n        UploadId: multiPartUpload.UploadId, // Required\n    },\n    // Iterate over all parts in the `CopySource` object\n    func(parts *s3.ListPartsOutput, lastPage bool) bool {\n        log.Printf(\"parts:\\n%v\\n%v\", parts, parts.Parts)\n        // parts.Parts is an empty slice\n        for _, part := range parts.Parts {\n            log.Printf(\"copying %v part %v\", source, part.PartNumber)\n            resp, err := svc.UploadPartCopy(\n                &amp;s3.UploadPartCopyInput{\n                    UploadId:   multiPartUpload.UploadId,\n                    Bucket:     aws.String(bucket),\n                    Key:        aws.String(targetPrefix),\n                    CopySource: aws.String(source),\n                    PartNumber: part.PartNumber,\n                },\n            )\n            if err != nil {\n                panic(errors.Wrap(err, \"error copying object\"))\n            }\n            log.Printf(\"copied: %v\", resp)\n        }\n        return true\n    },\n)\nif err != nil {\n    panic(errors.Wrap(err, \"something went wrong with ListPartsPages!\"))\n}\n</code></pre>\n\n<p>What am I doing wrong or am I missunderstanding something?</p>\n"}, {"tags": ["go", "gorilla", "mux"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1493130419, "post_id": 43613311, "comment_id": 74275772, "body": "For serving a custom error page yourself, see <a href=\"http://stackoverflow.com/questions/30500322/httprouter-configuring-notfound/30500491#30500491\">httprouter configuring NotFound</a>."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1493130349, "creation_date": 1493130349, "answer_id": 43613452, "question_id": 43613311, "link": "https://stackoverflow.com/questions/43613311/make-a-custom-404-with-golang-and-mux/43613452#43613452", "title": "make a custom 404 with golang and mux", "body": "<p>Set the <a href=\"https://godoc.org/github.com/gorilla/mux#Router\" rel=\"nofollow noreferrer\"><code>NotFoundHandler</code></a> to a handler method that returns your custom 404 page.</p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 11, "last_activity_date": 1493130379, "creation_date": 1493130379, "answer_id": 43613468, "question_id": 43613311, "link": "https://stackoverflow.com/questions/43613311/make-a-custom-404-with-golang-and-mux/43613468#43613468", "title": "make a custom 404 with golang and mux", "body": "<p>The <a href=\"https://godoc.org/github.com/gorilla/mux#Router\" rel=\"noreferrer\">Router</a> exports a <code>NotFoundHandler</code> field which you can set to your custom handler.</p>\n\n<pre><code>r := mux.NewRouter()\nr.NotFoundHandler = MyCustom404Handler\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 704, "user_id": 4792552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a528513962a9c962ff32df92a1a350b?s=128&d=identicon&r=PG", "display_name": "Berkant Ipek", "link": "https://stackoverflow.com/users/4792552/berkant-ipek"}, "edited": false, "score": 0, "creation_date": 1564740583, "post_id": 56937571, "comment_id": 101138841, "body": "Cool solution. But you have to do this assigning either after declaring your real routes or by using <code>BuildOnly()</code> method to prevent this route from acting like a wildcard."}], "tags": [], "owner": {"reputation": 78, "user_id": 1313562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OOt6V.jpg?s=128&g=1", "display_name": "eexit", "link": "https://stackoverflow.com/users/1313562/eexit"}, "is_accepted": false, "score": 5, "last_activity_date": 1563210690, "last_edit_date": 1563210690, "creation_date": 1562597644, "answer_id": 56937571, "question_id": 43613311, "link": "https://stackoverflow.com/questions/43613311/make-a-custom-404-with-golang-and-mux/56937571#56937571", "title": "make a custom 404 with golang and mux", "body": "<p>Sometimes, you spend a lot of time building a stack of middleware that does many things like logging, sending metrics and so... And the default 404 handler just skips all the middlewares.</p>\n\n<p>I was able to solve this issue by re-setting the default 404 handler like this:</p>\n\n<pre><code>router := mux.NewRouter()\nrouter.Use(someMiddleware())\n// Re-define the default NotFound handler\nrouter.NotFoundHandler = router.NewRoute().HandlerFunc(http.NotFound).GetHandler()\n</code></pre>\n\n<p>Now, the 404 default handler is also going thru all the middlewares.</p>\n"}], "owner": {"reputation": 502, "user_id": 462794, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/590ab8e31e515d6d8666c8b81f3a1317?s=128&d=identicon&r=PG", "display_name": "Bussiere", "link": "https://stackoverflow.com/users/462794/bussiere"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6480, "favorite_count": 0, "accepted_answer_id": 43613468, "answer_count": 3, "score": 4, "last_activity_date": 1563210690, "creation_date": 1493130040, "last_edit_date": 1493130295, "question_id": 43613311, "link": "https://stackoverflow.com/questions/43613311/make-a-custom-404-with-golang-and-mux", "title": "make a custom 404 with golang and mux", "body": "<p>Here is my code about a little example webserver with golang and mux  :</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"net/http\"\n    \"github.com/gorilla/mux\"\n)\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    vars := mux.Vars(r)\nfmt.Fprintf(w, \"Hi there, I love %s!\", vars[\"username\"])\n}\n\nfunc homeHandler(w http.ResponseWriter, r *http.Request) {\n    if r.URL.Path != \"/\" {\n        errorHandler(w, r, http.StatusNotFound)\n        return\n    }\n    vars := mux.Vars(r)\n    fmt.Fprintf(w, \"Hi there, I love %s!\", vars[\"username\"])\n}\n\nfunc main() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/help/{username}/\", handler)\n    http.Handle(\"/\", r)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>But I don't find a way on how to do a custom 404 page, i would like to make a custom 404.</p>\n\n<p>But I can't make a r.HandleFunc(\"/\",...)   but it will be too greedy.</p>\n\n<p>If anyone have any idea.</p>\n"}, {"tags": ["go", "channel"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1493125144, "post_id": 43610646, "comment_id": 74271524, "body": "I guess this is homework?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1493127163, "post_id": 43610646, "comment_id": 74273174, "body": "You can&#39;t share the slice used by a bufio.Scanner -- from the docs: <code>The underlying array may point to data that will be overwritten by a subsequent call to Scan</code>"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1493133571, "post_id": 43610646, "comment_id": 74278464, "body": "please use <code>gofmt</code>. I know go gets quite a bit of criticism for being overly opinionated WRT coding style, but the way your code looks makes it harder to read for ppl who have become used to the golang standard formatting. The extra space in statements like ` sig := make (chan bool)` and the extra level of indentation for your <code>select-case</code> blocks shouldn&#39;t be there"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493136728, "post_id": 43610646, "comment_id": 74280767, "body": "@JimB: I stand corrected, it is possible to lose data, but the race detector doesn&#39;t seem to pick up on. I ran a small test reading from stdin (input 1, 2, 3, ...), and got output 1, 5, 6, 8, 9. Clearly a race condition, but <code>go run -race foo.go</code> didn&#39;t give a peep..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1493141103, "post_id": 43610646, "comment_id": 74283387, "body": "@EliasVanOotegem: Just because the output is logically incorrect doesn&#39;t mean the reads and writes happened concurrently -- the race detector can only detect when a race actually happens. For the same reason you initially thought there wasn&#39;t a race, this doesn&#39;t leave a very large window for it to happen. I just tested it out on some archives in the 100s of Mb and get only 1 or 2 data races per file."}, {"owner": {"reputation": 13, "user_id": 7364921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e54496472faf37044531ff352e22a3c7?s=128&d=identicon&r=PG&f=1", "display_name": "Anupam", "link": "https://stackoverflow.com/users/7364921/anupam"}, "edited": false, "score": 0, "creation_date": 1493144532, "post_id": 43610646, "comment_id": 74285323, "body": "Can anyone please suggest the code snippet for the expected output.... where we will read from stdin in one goroutine and write on stdout using fmt.Println....the communication among goroutine should happen via channels... as intended in the code..."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493144714, "post_id": 43610646, "comment_id": 74285410, "body": "@JimB for sure, race conditions are tricky to detect automatically. We&#39;ve all wasted too much time debugging code like this. My thinking was simply this: blocking write to an unbuffered channel, read + copy to a buffered one. My mistake was for me to think that the copy would&#39;ve been atomic. Clearly it isn&#39;t. Honest mistake on my part, but a mistake nonetheless"}], "answers": [{"comments": [{"owner": {"reputation": 13, "user_id": 7364921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e54496472faf37044531ff352e22a3c7?s=128&d=identicon&r=PG&f=1", "display_name": "Anupam", "link": "https://stackoverflow.com/users/7364921/anupam"}, "edited": false, "score": 0, "creation_date": 1493192089, "post_id": 43618464, "comment_id": 74304064, "body": "Thanks for the reply. I realized the mistake with the usage of select."}], "tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 4, "last_activity_date": 1493145306, "creation_date": 1493145306, "answer_id": 43618464, "question_id": 43610646, "link": "https://stackoverflow.com/questions/43610646/want-to-write-from-os-stdin-to-os-stdout-using-channels/43618464#43618464", "title": "Want to write from os.Stdin to os.Stdout using channels", "body": "<p>The problem is that you have two channel operations in your second <code>select</code> case.  Select only prevents the <em>outer</em> operation from blocking.  Thus the <code>&lt;-ch</code> call is evaluated immediately, and doesn't have the blocking protection of the select, so the entire select statement blocks until something else is received on that channel (which requires another input so <code>read()</code> can send again on that channel).</p>\n\n<p>Unfortunately, the fix isn't as clean.  If you change it to <code>case m := &lt;-ch:</code>, then sending <code>m</code> over <code>mes</code> will block the select, and can result in a deadlock if it's already at buffer.  Probably the easiest way to fix it is to only have a single channel, rather than two.  Example:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\n/* Function to run the groutine to run for stdin read */\nfunc read(r io.Reader) &lt;-chan string {\n    lines := make(chan string)\n    go func() {\n        defer close(lines)\n        scan := bufio.NewScanner(r)\n        for scan.Scan() {\n            lines &lt;- scan.Text()\n        }\n    }()\n    return lines\n}\n\nfunc main() {\n    mes := read(os.Stdin) //Reading from Stdin\n    for anu := range mes {\n        fmt.Println(\"Message to stdout\")\n        fmt.Println(anu) //Writing to Stdout\n    }\n}\n</code></pre>\n\n<p>Note that I changed your <code>scan.Bytes()</code> call to <code>scan.Text()</code>, because the comments for <code>scan.Bytes()</code> specifically state that the underlying array of the slice it returns is not safe against being overwritten by following Scan calls.</p>\n\n<p>Another alternative is to use a separate goroutine to translate the messages between the channels:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"io\"\n    \"os\"\n)\n\n/* Function to run the groutine to run for stdin read */\nfunc read(r io.Reader) &lt;-chan string {\n    lines := make(chan string)\n    go func() {\n        defer close(lines)\n        scan := bufio.NewScanner(r)\n        for scan.Scan() {\n            s := scan.Text()\n            lines &lt;- s\n        }\n    }()\n    return lines\n}\n\nfunc main() {\n    mes := make(chan string, 1)\n    ch := read(os.Stdin) //Reading from Stdin\n    go func() {\n        for m := range ch {\n            fmt.Println(\"Message to channel 2\")\n            mes &lt;- m\n        }\n    }()\n    for anu := range mes {\n        fmt.Println(\"Message to stdout\")\n        fmt.Println(anu) //Writing to Stdout\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 7364921, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e54496472faf37044531ff352e22a3c7?s=128&d=identicon&r=PG&f=1", "display_name": "Anupam", "link": "https://stackoverflow.com/users/7364921/anupam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3049, "favorite_count": 0, "accepted_answer_id": 43618464, "answer_count": 1, "score": -1, "last_activity_date": 1493145306, "creation_date": 1493123207, "last_edit_date": 1493129116, "question_id": 43610646, "link": "https://stackoverflow.com/questions/43610646/want-to-write-from-os-stdin-to-os-stdout-using-channels", "title": "Want to write from os.Stdin to os.Stdout using channels", "body": "<pre><code>/* Want to write from os.Stdin to os.Stdout(fmt.Println() in below code) using channels*/\npackage main\nimport (\n    \"fmt\"\n    \"io\"\n    \"os\"\n    \"bufio\"\n)\n\ntype message []byte\n/* Function to run the groutine to run for stdin read */\nfunc read (r io.Reader) &lt;-chan message{\n    lines := make (chan message)\n    go func() {\n        defer close(lines)\n        scan := bufio.NewScanner(r)\n        for scan.Scan() {\n            lines &lt;- message(scan.Bytes())\n        }   \n    }() \n    return lines\n}\n\n\nfunc main() {\n    mes := make (chan message, 1)\n    sig := make (chan bool)\n    ch := read (os.Stdin) //Reading from Stdin\n    for {\n        select {\n            case anu := &lt;-mes:\n                fmt.Println(\"Message to stdout\")\n                fmt.Println(string(anu)) //Writing to Stdout\n            case mes &lt;- &lt;-ch:\n                fmt.Println(\"Message to channel 2\")\n                continue\n        }   \n    }   \n    &lt;-sig\n\n/*\nThe O/P is :\n\ngo run writetochan.go \nGolang\nMessage to channel 2\nFun     &lt;&lt;&lt; Delayed O/P golang means after putting one more \n            message only we are getting First message\nMessage to stdout\nGolang\n\n\nExpected O/P:\ngo run writetochan.go \nGolang\nMessage to channel 2\nMessage to stdout\nGolang\nFun\nMessage to channel 2\n\n*/\n}\n</code></pre>\n\n<p>Want to achieve the O/P shown above.</p>\n\n<p>We are writing from one channel which reads all the stdin from the user and then writes to the stdout. Channel read is happening in goroutine. A dummy channel is formed (sig) so that we can run it indefinitely (Just for now).</p>\n"}, {"tags": ["git", "heroku", "go", "revel"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1493158869, "post_id": 43609169, "comment_id": 74292924, "body": "It is exactly that, <code>v0.14.0</code> includes braking changes like <code>RenderArgs</code> -&gt; <code>ViewArgs</code> and <code>RenderJson</code> -&gt; <code>RenderJSON</code>. See more here: <a href=\"https://github.com/revel/revel/releases/tag/v0.14.0\" rel=\"nofollow noreferrer\">github.com/revel/revel/releases/tag/v0.14.0</a>. You either need to updated your code to be compatible with 0.14 or you need to specify in your Godpes or whatever vendoring you&#39;re using that your app needs revel 0.13."}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493160789, "post_id": 43609169, "comment_id": 74293533, "body": "Thanks @mkopriva I am going to try it."}, {"owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493193865, "post_id": 43609169, "comment_id": 74305144, "body": "Thanks @mkopriva it works... if you want you can change your comment to an answer. It is the solution."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1493198761, "post_id": 43609169, "comment_id": 74308456, "body": "I&#39;ve only confirmed what you already suspected, so feel free to write the answer."}], "owner": {"reputation": 1254, "user_id": 2870438, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/3c587da2b868b56e3afb188bff722e8f?s=128&d=identicon&r=PG&f=1", "display_name": "Eloy Fern&#225;ndez Franco", "link": "https://stackoverflow.com/users/2870438/eloy-fern%c3%a1ndez-franco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 329, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493155511, "creation_date": 1493118891, "last_edit_date": 1493155511, "question_id": 43609169, "link": "https://stackoverflow.com/questions/43609169/revel-app-doesn%c2%b4t-compile-in-heroku", "title": "Revel app doesn&#180;t compile in heroku", "body": "<p>I am pushing to my heroku app after two months without push anything, and I am finding some compilation errors. This is the output when I try `git push heroku master' </p>\n\n<pre><code>Counting objects: 25, done.\nDelta compression using up to 4 threads.\nCompressing objects: 100% (25/25), done.\nWriting objects: 100% (25/25), 16.64 KiB | 0 bytes/s, done.\nTotal 25 (delta 19), reused 0 (delta 0)\nremote: Compressing source files... done.\nremote: Building source:\nremote:\nremote: -----&gt; Revel app detected\nremote: -----&gt; Using go1.4\nremote: -----&gt; Running: go get -tags heroku ./...\nremote: # ndc-console-test/app/controllers\nremote: app/controllers/app.go:160: c.RenderJson undefined (type App has no field or method RenderJson)\nremote: app/controllers/app.go:170: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:171: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:172: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:173: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:191: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:192: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:193: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:194: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:195: c.RenderArgs undefined (type App has no field or method RenderArgs)\nremote: app/controllers/app.go:195: too many errors\nremote: # ndc-console-test/app/routes\nremote: app/routes/routes.go:15: revel.MainRouter.Reverse(\"App.Index\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:22: revel.MainRouter.Reverse(\"App.Ndc\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:29: revel.MainRouter.Reverse(\"App.FlightPrice\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:36: revel.MainRouter.Reverse(\"App.SeatAvailability\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:43: revel.MainRouter.Reverse(\"App.OrderCreateRQ\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:50: revel.MainRouter.Reverse(\"App.ServicePrice\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:57: revel.MainRouter.Reverse(\"App.OrderRetrieve\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:64: revel.MainRouter.Reverse(\"App.OrderChange\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:71: revel.MainRouter.Reverse(\"App.OrderCancel\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:83: revel.MainRouter.Reverse(\"TestRunner.Index\", args).Url undefined (type *revel.ActionDefinition has no field or method Url)\nremote: app/routes/routes.go:83: too many errors\nremote:  !     Push rejected, failed to compile Revel app.\nremote:\nremote:  !     Push failed\nremote: Verifying deploy...\nremote:\nremote: !       Push rejected to ndc-console.\n</code></pre>\n\n<p>The app worked the last time I pushed and I didn\u00b4t modify the files where the errors are found... and the methods (in some cases) and fields (in other cases) should exist. </p>\n\n<p>Thank in advance.</p>\n\n<p>PS: The revel buildpack is added in the heroku app.</p>\n\n<h2>EDIT</h2>\n\n<p>Could be the go and/or revel version?? I have installed revel 0.13.1 and I had seen that v0.14.0 had been released (just less than two months ago). About golang I reinstall it and I have the latest version. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1493117039, "post_id": 43608294, "comment_id": 74265638, "body": "&quot;Adjust the iteration speed of this loop to the client&#39;s download speed.&quot; --- tcp stack does it for you already. Simply use <code>io.Copy</code>"}, {"owner": {"reputation": 1635, "user_id": 3918512, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001599098944/picture?type=large", "display_name": "Robin Nabel", "link": "https://stackoverflow.com/users/3918512/robin-nabel"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1493117373, "post_id": 43608294, "comment_id": 74265869, "body": "@zerkms If the data is not stored locally, say the content is generated, how could this be achieved? Which interfaces would the data generator need to implement?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 2, "creation_date": 1493117623, "post_id": 43608294, "comment_id": 74266038, "body": "<code>io.Reader</code> ....."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 3, "last_activity_date": 1493118111, "creation_date": 1493118111, "answer_id": 43608855, "question_id": 43608294, "link": "https://stackoverflow.com/questions/43608294/measure-upload-speed-when-using-http-responsebody/43608855#43608855", "title": "Measure upload speed when using http.ResponseBody", "body": "<p>You could implement a custom <code>http.ResponseWriter</code> that measures bytes sent, and calculates throughput.</p>\n\n<p>There are likely packages to do similar things already. Google found <a href=\"https://github.com/miolini/datacounter\" rel=\"nofollow noreferrer\">this one</a> (which I haven't used).</p>\n"}], "owner": {"reputation": 1635, "user_id": 3918512, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001599098944/picture?type=large", "display_name": "Robin Nabel", "link": "https://stackoverflow.com/users/3918512/robin-nabel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 0, "accepted_answer_id": 43608855, "answer_count": 1, "score": 0, "last_activity_date": 1493120558, "creation_date": 1493116477, "last_edit_date": 1493120558, "question_id": 43608294, "link": "https://stackoverflow.com/questions/43608294/measure-upload-speed-when-using-http-responsebody", "title": "Measure upload speed when using http.ResponseBody", "body": "<p>Is there a way to measure a client's download speed when uploading a large quantity of data using an <code>http.ResponseWriter</code>?</p>\n\n<p>Update for context: I'm writing a streaming download endpoint for blob storage which stores blobs in chunks. The files are very large, so loading and buffering whole blobs is not feasible. Being able to monitor the buffer state, bytes written or similar would allow better scheduling of the chunk downloads.</p>\n\n<p>E.g. when <code>Write()</code>ing to the response, is there a way to check how much data is already queued?</p>\n\n<p>An example of the context, but not using a file object.</p>\n\n<pre><code>func downloadHandler(w http.ResponseWriter, req *http.Request, ps httprouter.Params) {\n    // Open some file.\n    f := os.Open(\"somefile.txt\")\n\n    // Adjust the iteration speed of this loop to the client's download speed.\n    for\n    { \n        data := make([]byte, 1000)\n        count, err := f.Read(data)\n        if err != nil {\n            log.Fatal(err)\n        }\n        if count == 0 {\n            break\n        }\n       // Upload data chunk to client.\n       w.Write(data[:count])\n    }\n}\n</code></pre>\n"}, {"tags": ["postgresql", "stored-procedures", "go", "plpgsql", "pq"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 2, "creation_date": 1493117999, "post_id": 43608002, "comment_id": 74266285, "body": "The first question, you can not use PL/pgSQL like that. PL/pgSQL is supposed to be defined in server side as <code>function</code> or <code>procedure</code>. If you wish to use PL/pgSQL, you need to define a function in the db server, then call that function (and pass parameters) using <code>db.Query</code>/<code>db.QueryRow</code>. Can you elaborate the second question?"}, {"owner": {"reputation": 1364, "user_id": 4193473, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/809c47adff3412cabfe219351122672d?s=128&d=identicon&r=PG&f=1", "display_name": "hgl", "link": "https://stackoverflow.com/users/4193473/hgl"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493122518, "post_id": 43608002, "comment_id": 74269571, "body": "@putu Sorry the second question was unclear. I elaborated a bit. Hope it&#39;s clear now. As for executing PL/pgSQL, creating a function or procedure makes sense. I&#39;ll try that out, thanks."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 2, "last_activity_date": 1493181649, "creation_date": 1493181649, "answer_id": 43625195, "question_id": 43608002, "link": "https://stackoverflow.com/questions/43608002/how-to-pass-parameters-to-a-query-written-in-pl-pgsql/43625195#43625195", "title": "How to pass parameters to a query written in PL/pgSQL?", "body": "<p>You got error because PL/pgSQL is supposed to be defined in server side as <code>function</code> or <code>procedure</code>, but in your case, its being called from client side. Below is a simple example on how to define and call the function with parameter(s):</p>\n\n<pre><code>CREATE OR REPLACE FUNCTION myadd(a integer, b integer) RETURNS integer AS $$\n    BEGIN\n            RETURN a + b;\n    END;\n$$ LANGUAGE plpgsql;\n</code></pre>\n\n<p>Then, from client side you can call the function with parameters using <code>SELECT</code> query. Please note, even though your function contains <code>INSERT/UPDATE</code>, the function must be called using <code>SELECT</code> statement.</p>\n\n<pre><code>//...\na := 10\nrow := db.QueryRow(`SELECT * FROM myadd($1, $2)`, a, 130)\n//...\n</code></pre>\n\n<p>Next question, about transaction and PL/pgSQL. Yes, using PL/pgSQL you can reduce network traffic. <a href=\"https://www.postgresql.org/docs/9.6/static/plpgsql-overview.html\" rel=\"nofollow noreferrer\">Several advantages</a> of server side language (PL/pgSQL) are:</p>\n\n<ol>\n<li>Eliminate client-server round trip</li>\n<li>No need to transfer intermediate result to client, only the final result will be transferred. </li>\n<li>Avoid parsing queries multiple times (Send query to server --> server parsing query --> perform database operation --> return result to client, etc...)</li>\n</ol>\n\n<p>The rule when dealing with database (large data) is <code>You need to avoid to move your data around</code> and PL/pgSQL fits this rule. However, there are some circumstances in which you can not (need to avoid) use PL/pgSQL, e.g. DB admin/server owner does not allow server side programming (security/performance reason etc).</p>\n\n<p>Relation between <code>function</code> and <code>transaction</code> is clearly stated in <a href=\"https://www.postgresql.org/docs/current/static/plpgsql-structure.html\" rel=\"nofollow noreferrer\">the manual</a> :</p>\n\n<blockquote>\n  <p>It is important not to confuse the use of BEGIN/END for grouping statements in PL/pgSQL with the similarly-named SQL commands for transaction control. PL/pgSQL's BEGIN/END are only for grouping; they do not start or end a transaction. Functions and trigger procedures are always executed within a transaction established by an outer query \u2014 they cannot start or commit that transaction, since there would be no context for them to execute in. However, a block containing an EXCEPTION clause effectively forms a subtransaction that can be rolled back without affecting the outer transaction</p>\n</blockquote>\n\n<p>In summary, using PL/pgSQL you may get performance improvement. How much? It's depend. Please keep in mind, after using PL/pgSQL you need to manage more than one codebase, and sometimes it's difficult to debug. </p>\n"}], "owner": {"reputation": 1364, "user_id": 4193473, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/809c47adff3412cabfe219351122672d?s=128&d=identicon&r=PG&f=1", "display_name": "hgl", "link": "https://stackoverflow.com/users/4193473/hgl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3422, "favorite_count": 0, "accepted_answer_id": 43625195, "answer_count": 1, "score": 1, "last_activity_date": 1493181649, "creation_date": 1493115697, "last_edit_date": 1493122437, "question_id": 43608002, "link": "https://stackoverflow.com/questions/43608002/how-to-pass-parameters-to-a-query-written-in-pl-pgsql", "title": "How to pass parameters to a query written in PL/pgSQL?", "body": "<p>I wonder if it's possible to pass parameters to a query written in PL/pgSQL?</p>\n\n<p>I tried this, but it failed with <code>pq: got 1 parameters but the statement requires 0</code></p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n    \"log\"\n\n    _ \"github.com/lib/pq\"\n)\n\nfunc main() {\n    db, err := sql.Open(\"postgres\", \"host=localhost dbname=db user=user sslmode=disable password=pw\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    row := db.QueryRow(`\nDO $$\nBEGIN\n    IF true THEN\n        SELECT $1;\n    END IF;\nEND$$\n`, 1)\n    var num int\n    err = row.Scan(&amp;num)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(num)\n}\n</code></pre>\n\n<p>Another related question is that I want to use transactions, but the APIs provided by the <code>sql</code> package seems to connect to db every time a query is executed in a tx. I'd like everything to be executed in one go if that's possible. For example, with go you are supposed to use transactions like this</p>\n\n<pre><code>tx, err := db.Begin()\nrows, err := tx.Query(sql1)\nresult, err := tx.Exec(sql2)\ntx.Commit()\n</code></pre>\n\n<p>The problem is that calling <code>tx.Query</code> and <code>tx.Exec</code> makes two trips to PostgreSQL server if I'm not wrong. What I want to achieve is to merge <code>sql1</code> and <code>sql2</code>, wrap them inside <code>BEGIN</code> and <code>END</code> and execute them in one trip. And my question is that:</p>\n\n<ol>\n<li>Do you think it's necessary? I imagine that with enough traffic, the performance difference might be obvious, but I'm not sure.</li>\n<li>If so, what's the best way to execute this merged transaction? Create a function and run the transaction inside PL/pgSQL (since I might need to use conditional statements, etc)?</li>\n</ol>\n"}, {"tags": ["pointers", "go", "interface", "slice"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1493115932, "last_edit_date": 1493115932, "creation_date": 1493115559, "answer_id": 43607941, "question_id": 43607857, "link": "https://stackoverflow.com/questions/43607857/append-to-slice-of-interfaces/43607941#43607941", "title": "Append to slice of interfaces", "body": "<p>Don't use pointer to interface, only a slice of interfaces:</p>\n\n<pre><code>content []DocumentItem\n</code></pre>\n\n<p>If the dynamic value wrapped in the interface value is a pointer, you lose nothing, you will be able to modify the pointed object.</p>\n\n<p>This was the only thing that had to be changed. To verify, I added printing at the end:</p>\n\n<pre><code>fmt.Printf(\"%+v\", p)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/F21ynmMrEx\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&amp;{text:lalala}\n</code></pre>\n"}], "owner": {"reputation": 92, "user_id": 2131647, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HcC92.jpg?s=128&g=1", "display_name": "TheROX", "link": "https://stackoverflow.com/users/2131647/therox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 0, "accepted_answer_id": 43607941, "answer_count": 1, "score": 1, "last_activity_date": 1493115932, "creation_date": 1493115370, "last_edit_date": 1493115852, "question_id": 43607857, "link": "https://stackoverflow.com/questions/43607857/append-to-slice-of-interfaces", "title": "Append to slice of interfaces", "body": "<p>I'm writing a document generator. There is a <code>DocumentItem</code> interface - this is part of the document. </p>\n\n<pre><code>type DocumentItem interface {\n    compose() string\n}\n</code></pre>\n\n<p>For example, a document consists of paragraphs and tables.</p>\n\n<pre><code>type Paragraph struct {\n    text string\n}\ntype Table struct{}\n</code></pre>\n\n<p>The <code>Paragraph</code> and <code>Table</code> types correspond to the <code>DocumentItem</code> interface.</p>\n\n<pre><code>func (p *Paragraph) compose() string {\n    return \"\"\n}\n\nfunc (t *Table) compose() string {\n    return \"\"\n}\n</code></pre>\n\n<p>The <code>Document</code> type contains the <code>content []*DocumentItem</code> field. </p>\n\n<pre><code>type Document struct {\n    content []*DocumentItem\n}\n</code></pre>\n\n<p>I'm looking for a way that would allow <code>NewParagraph()</code> and <code>NewTable()</code> functions to create the necessary data types and add them to the <code>content</code> field. </p>\n\n<pre><code>func (d *Document) NewParagraph() *Paragraph {\n    p := Paragraph{}\n    d.content = append(d.content, &amp;p)\n    return &amp;p\n}\n\nfunc (d *Document) NewTable() *Table {\n    t := Table{}\n    d.content = append(d.content, &amp;t)\n    return &amp;t\n}\n</code></pre>\n\n<p>I use an slice of interface pointers in order to be able to modify the data in the corresponding variables after they are included in the document.</p>\n\n<pre><code>func (p *Paragraph) SetText(text string) {\n    p.text = text\n}\n\nfunc main() {\n    d := Document{}\n    p := d.NewParagraph()\n    p.SetText(\"lalala\")\n    t := d.NewTable()\n    // ...    \n}\n</code></pre>\n\n<p>But I get compiler errors:</p>\n\n<pre><code>cannot use &amp;p (type *Paragraph) as type *DocumentItem in append\ncannot use &amp;t (type *Table) as type *DocumentItem in append\n</code></pre>\n\n<p>If I cast the types to an <code>DocumentItem</code> interface, I will lose access to specific functions, which in the case of one type may differ from the other. For example, add text to a paragraph and add a row of cells and then add text to cell for the table.</p>\n\n<p>Is it possible at all?</p>\n\n<p>Full example at <a href=\"https://play.golang.org/p/uJfKs5tJ98\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uJfKs5tJ98</a></p>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1493110682, "post_id": 43605790, "comment_id": 74261175, "body": "<a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">tour.golang.org/methods/15</a> <a href=\"https://tour.golang.org/methods/16\" rel=\"nofollow noreferrer\">tour.golang.org/methods/16</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1493120503, "post_id": 43605790, "comment_id": 74268086, "body": "There is no direct / exact answer, partly blamed on the <code>net</code> package authors. Related / useful questions (about error handling): <a href=\"http://stackoverflow.com/questions/23494950/specifically-check-for-timeout-error\">Specifically check for timeout error</a>; and <a href=\"http://stackoverflow.com/questions/30177860/does-go-have-standard-err-variables/30178766#30178766\">Does go have standard Err variables?</a>; and <a href=\"http://stackoverflow.com/questions/37346694/go-best-practice-to-handle-error-from-multiple-abstract-level/37347531#37347531\">Go. Best practice to handle error from multiple abstract level</a>."}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 10, "last_activity_date": 1493124498, "last_edit_date": 1493124498, "creation_date": 1493111179, "answer_id": 43606199, "question_id": 43605790, "link": "https://stackoverflow.com/questions/43605790/how-to-catch-specific-errors/43606199#43606199", "title": "How to `catch` specific errors", "body": "<p>There's no standard way to do this.</p>\n\n<p>The most obvious way, which should only be used if no other method is available, is to compare the error string against what you expect:</p>\n\n<pre><code>if err.Error() == \"connection lost\" { ... }\n</code></pre>\n\n<p>Or perhaps more robust in some situations:</p>\n\n<pre><code>if strings.HasSuffix(err.Error(), \": connection lost\") { ... }\n</code></pre>\n\n<p>But many libraries will return specific error types, which makes this much easier.</p>\n\n<p>In your case, what's relevant are the various error types exported by the <a href=\"https://golang.org/pkg/net\" rel=\"noreferrer\"><code>net</code></a> package: <a href=\"https://golang.org/pkg/net/#AddrError\" rel=\"noreferrer\">AddrError</a>, <a href=\"https://golang.org/pkg/net/#DNSConfigError\" rel=\"noreferrer\">DNSConfigError</a>, <a href=\"https://golang.org/pkg/net/#DNSError\" rel=\"noreferrer\">DNSError</a>, <a href=\"https://golang.org/pkg/net/#Error\" rel=\"noreferrer\">Error</a>, etc.</p>\n\n<p>You probably care most about <a href=\"https://golang.org/pkg/net/#Error\" rel=\"noreferrer\">net.Error</a>, which is used for network errors.  So you could check thusly:</p>\n\n<pre><code>if _, ok := err.(net.Error); ok {\n    // You know it's a net.Error instance\n    if err.Error() == \"connection lost\" { ... }\n}\n</code></pre>\n\n<blockquote>\n  <p>What's more, how to get all the errors a specific standard library function may return?</p>\n</blockquote>\n\n<p>The only fool-proof way to do this is to read the source for the library. Before going to that extreme, a first step is simply to read the godoc, as in the case of the <code>net</code> package, the errors are pretty well documented.</p>\n"}], "owner": {"reputation": 346, "user_id": 4476748, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9411f33f09008556e0b6b5323f78fc35?s=128&d=identicon&r=PG&f=1", "display_name": "fding", "link": "https://stackoverflow.com/users/4476748/fding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7235, "favorite_count": 1, "accepted_answer_id": 43606199, "answer_count": 1, "score": 15, "last_activity_date": 1575237456, "creation_date": 1493110036, "last_edit_date": 1575237456, "question_id": 43605790, "link": "https://stackoverflow.com/questions/43605790/how-to-catch-specific-errors", "title": "How to `catch` specific errors", "body": "<p>For example, I am using one Go standard library function as:</p>\n\n<pre><code>func Dial(network, address string) (*Client, error)\n</code></pre>\n\n<p>This function may return errors, and I just care about errors which report \"connection lost\" or \"connection refused\", then do some code to fix these.<br>\nIt seems like:  </p>\n\n<pre><code>client, err := rpc.Dial(\"tcp\", \":1234\")  \nif err == KindOf(ConnectionRefused) {\n  // do something\n}\n</code></pre>\n\n<p>What's more, how to get all the errors a specific standard library function may return?</p>\n"}, {"tags": ["go", "openssl"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1493108110, "post_id": 43603590, "comment_id": 74259511, "body": "It depends on the content of parameters <code>chiper</code>, <code>byteKey</code>, <code>iv</code>. Without detail information, its hard to find what was wrong."}, {"owner": {"reputation": 5562, "user_id": 1946679, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ed74e2cdc59d058b76a76c90dd3c3bdc?s=128&d=identicon&r=PG", "display_name": "Matt Caswell", "link": "https://stackoverflow.com/users/1946679/matt-caswell"}, "edited": false, "score": 0, "creation_date": 1493110451, "post_id": 43603590, "comment_id": 74261026, "body": "My guess is that your cipher has been defined to have a zero length IV. What cipher are you using?"}, {"owner": {"reputation": 73, "user_id": 5130278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/77cRQ.jpg?s=128&g=1", "display_name": "Abu3odeh", "link": "https://stackoverflow.com/users/5130278/abu3odeh"}, "edited": false, "score": 0, "creation_date": 1493136830, "post_id": 43603590, "comment_id": 74280844, "body": "I&#39;m using aes-128-ecb. I added it to the post"}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 5130278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/77cRQ.jpg?s=128&g=1", "display_name": "Abu3odeh", "link": "https://stackoverflow.com/users/5130278/abu3odeh"}, "is_accepted": false, "score": 0, "last_activity_date": 1493140620, "creation_date": 1493140620, "answer_id": 43617107, "question_id": 43603590, "link": "https://stackoverflow.com/questions/43603590/golang-openssl-bad-iv-size/43617107#43617107", "title": "Golang OpenSSL bad iv size", "body": "<p>I used ECB the first time, and I wanted to change it to CBC. I forgot to change it to aes-cbc and so I got an error when I tried adding an IV.</p>\n"}], "owner": {"reputation": 73, "user_id": 5130278, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/77cRQ.jpg?s=128&g=1", "display_name": "Abu3odeh", "link": "https://stackoverflow.com/users/5130278/abu3odeh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1493140620, "creation_date": 1493103024, "last_edit_date": 1493140400, "question_id": 43603590, "link": "https://stackoverflow.com/questions/43603590/golang-openssl-bad-iv-size", "title": "Golang OpenSSL bad iv size", "body": "<p>I'm trying to create the following:</p>\n\n<pre><code>cipher, err := openssl.GetCipherByName(\"aes-128-ecb\")\ndecryptionTool, err := openssl.NewDecryptionCipherCtx(cipher, nil, byteKey, iv)\n</code></pre>\n\n<p>The byteKey and iv are both 16 bytes long.</p>\n\n<p>When I build my code, I get the following error:</p>\n\n<pre><code>panic: bad IV size (16 bytes instead of 0)\n</code></pre>\n\n<p>I read the documentation, and checked the source code, but I still can't find a way to add the IV without getting an error. I am using spacemonkeygo's OpenSSL.</p>\n\n<p>Does anyone know what's wrong?\nAnd thanks in advance!</p>\n\n<p>EDIT: I added the cipher type above, and a bit more details about biteKey and iv</p>\n\n<p>EDIT 2: ECB has no IV! I totally forgot about that. Well I guess that solves it.</p>\n"}, {"tags": ["pointers", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1493098169, "post_id": 43602060, "comment_id": 74254034, "body": "To add to this, You pretty much never want a pointer to an interface type. It already is a pointer underneath."}], "tags": [], "owner": {"reputation": 2028, "user_id": 3435777, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1f1a766d687b55f0f8a9bd80ce02491?s=128&d=identicon&r=PG&f=1", "display_name": "zzn", "link": "https://stackoverflow.com/users/3435777/zzn"}, "is_accepted": false, "score": 3, "last_activity_date": 1493097438, "last_edit_date": 1493097438, "creation_date": 1493096928, "answer_id": 43602060, "question_id": 43601858, "link": "https://stackoverflow.com/questions/43601858/how-can-i-define-an-implementation-of-go-interface-method-that-receives-pointer/43602060#43602060", "title": "How can I define an implementation of Go interface method that receives pointer?", "body": "<pre><code>func invokeHello(p *Person) {\n    p.Hello()\n}\n</code></pre>\n\n<p><code>p</code> is type <code>*Person</code>,  <code>*Joker</code> implement interface <code>Person</code>, revert <code>invokeHello</code> to: </p>\n\n<pre><code>func invokeHello(p Person) {\n    p.Hello()\n}\n</code></pre>\n\n<p>this will fix the second program.</p>\n\n<p>I think you have misleading about <a href=\"https://golang.org/ref/spec#Interface_types\" rel=\"nofollow noreferrer\">golang interface type</a></p>\n\n<blockquote>\n  <p>An interface type specifies a method set called its interface. A variable of interface type can store a value of any type with a method set that is any superset of the interface. Such a type is said to implement the interface.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "edited": false, "score": 0, "creation_date": 1493119283, "post_id": 43605883, "comment_id": 74267162, "body": "<i>&quot;If you want to receive pointer to a type in a function which expects an interface type, implement the interface with pointer receiver, like you did in a second example.&quot;</i> -- Can you add some code that demonstrates this point? I thought this is what I tried but clearly my second example does not work. Can you show some working code where I can receive a pointer to a type in a function that expects an interface type?"}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "edited": false, "score": 0, "creation_date": 1493120359, "post_id": 43605883, "comment_id": 74267966, "body": "@LoneLearner, yep sure. Keep an eye on the post. I&#39;ll update it in a half of an hour."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "edited": false, "score": 0, "creation_date": 1493127268, "post_id": 43605883, "comment_id": 74273262, "body": "@LoneLearner, sorry for delay. Here is your snippet with comments and types printing. I hope it is helpful."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "edited": false, "score": 0, "creation_date": 1493704306, "post_id": 43605883, "comment_id": 74505014, "body": "@LoneLearner , invokeHello receives interface type but not pointer to the interface."}, {"owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "edited": false, "score": 0, "creation_date": 1493732712, "post_id": 43605883, "comment_id": 74521869, "body": "I am still confused. Your code example seems to be same as my first example (in my question). In my first example, <code>invokeHello</code> receives interface type (not a pointer)."}, {"owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "reply_to_user": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "edited": false, "score": 0, "creation_date": 1493735193, "post_id": 43605883, "comment_id": 74523771, "body": "@LoneLearner, in your first example the (j Joker) Hello has value receiver, but in my example (j *Joker) Hello has pointer receiver. That is the difference."}], "tags": [], "owner": {"reputation": 24361, "user_id": 629685, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/cadce7a59af35a66f18b9aaddebfd50f?s=128&d=identicon&r=PG", "display_name": "I159", "link": "https://stackoverflow.com/users/629685/i159"}, "is_accepted": false, "score": 0, "last_activity_date": 1493129746, "last_edit_date": 1493129746, "creation_date": 1493110319, "answer_id": 43605883, "question_id": 43601858, "link": "https://stackoverflow.com/questions/43601858/how-can-i-define-an-implementation-of-go-interface-method-that-receives-pointer/43605883#43605883", "title": "How can I define an implementation of Go interface method that receives pointer?", "body": "<h3>Fix</h3>\n\n<p>You can't use pointers to <code>interface</code> type.\nThat is the problem:    </p>\n\n<pre><code>func invokeHello(p *Person) {\n    p.Hello()\n}\n</code></pre>\n\n<p>Should be:</p>\n\n<pre><code>func invokeHello(p Person) {\n    p.Hello()\n}\n</code></pre>\n\n<h3>Interface implementation</h3>\n\n<p>Types implement interfaces. If type has methods appropriate to a methods declared in an interface than the interface is implemented by the type. </p>\n\n<blockquote>\n  <p>Interfaces in Go provide a way to specify the behavior of an object: if something can do this, then it can be used here.</p>\n</blockquote>\n\n<h3>Types vs pointers to a types</h3>\n\n<p><code>Type</code> and <code>*Type</code> are different types. For example <code>*Type</code> could implement an interface but <code>Type</code> can not implement it. But <code>*InterfaceType</code> really has no sence to use.</p>\n\n<p>If you want to receive pointer to a type in a function which expects an interface type, implement the interface with pointer receiver, like you did in a second example. </p>\n\n<p><a href=\"https://play.golang.org/p/4ON3aS2zHq\" rel=\"nofollow noreferrer\">Example</a>:</p>\n\n<pre><code>type Person interface {\n    Hello()\n}\n\ntype Joker struct {\n    Name string\n}\n\n/*\nA Hello method declared with a pointer receiver which means that a pointer to\nthe Joker type (*Joker) not Joker type itself implements Person interface.\n*/\nfunc (j *Joker) Hello() {\n    fmt.Println(j.Name, \"says, \\\"Hello!\\\"\")\n}\n\n/*\ninvokeHello receives ANY type which statisfies Person interface.\nIn this case this is pointer to Joker type.\n*/\nfunc invokeHello(p Person) {\n    p.Hello()\n}\n\nfunc main() {\n    i := Joker{\"Peter\"}\n    j := &amp;i\n    // Note difference between types\n    fmt.Printf(\n        \"Joker type: %s\\nPointer to Joker type: %s\\n\",\n        reflect.TypeOf(i), reflect.TypeOf(j))\n    invokeHello(j)\n}\n</code></pre>\n\n<p>Otherwise if you want to receive a value of a type, implement the interface with value receiver, like you did in a first example.</p>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1493129746, "creation_date": 1493095844, "question_id": 43601858, "link": "https://stackoverflow.com/questions/43601858/how-can-i-define-an-implementation-of-go-interface-method-that-receives-pointer", "title": "How can I define an implementation of Go interface method that receives pointer?", "body": "<p>The following program runs fine.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Person interface {\n    Hello()\n}\n\ntype Joker struct {\n    Name string\n}\n\nfunc (j Joker) Hello() {\n    fmt.Println(j.Name, \"says, \\\"Hello!\\\"\")\n}\n\nfunc main() {\n    var j Joker = Joker{\"Peter\"}\n    invokeHello(j)\n}\n\nfunc invokeHello(p Person) {\n    p.Hello()\n}\n</code></pre>\n\n<p>Here is the output.</p>\n\n<pre><code>$ go run foo.go\nPeter says, \"Hello!\"\n</code></pre>\n\n<p>But when I change the <code>Hello</code> method to receive a pointer, I get errors.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Person interface {\n    Hello()\n}\n\ntype Joker struct {\n    Name string\n}\n\nfunc (j *Joker) Hello() {\n    fmt.Println(j.Name, \"says, \\\"Hello!\\\"\")\n}\n\nfunc main() {\n    var j *Joker = &amp;Joker{\"Peter\"}\n    invokeHello(j)\n}\n\nfunc invokeHello(p *Person) {\n    p.Hello()\n}\n</code></pre>\n\n<p>Here are the errors.</p>\n\n<pre><code>$ go run bar.go\n# command-line-arguments\n./bar.go:21: cannot use j (type *Joker) as type *Person in argument to invokeHello:\n    *Person is pointer to interface, not interface\n./bar.go:25: p.Hello undefined (type *Person has no field or method Hello)\n</code></pre>\n\n<p>How can I fix the second program?</p>\n"}, {"tags": ["go", "ffmpeg", "udp", "video-streaming"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 4, "last_activity_date": 1493099577, "creation_date": 1493099577, "answer_id": 43602656, "question_id": 43601846, "link": "https://stackoverflow.com/questions/43601846/golang-and-ffmpeg-realtime-streaming-input-output/43602656#43602656", "title": "Golang and ffmpeg realtime streaming input/output", "body": "<p>You must check return values of <code>stdout.Read</code>. Please note that the number of bytes read (nr) may be smaller than the buffer size, so you need to re-slice the buffer to get a valid content. Modify reading loop as follows:</p>\n\n<pre><code>chunk := make([]byte, 40*1024)\nfor {\n    nr, err5 := stdout.Read(chunk)\n    fmt.Printf(\"Read %d bytes\\n\", nr)\n\n    //do something with the data\n    //e.g. write to file\n    if nr &gt; 0 {\n        validData := chunk[:nr]\n        nw, err6 := f.Write(validData)\n        fmt.Printf(\"Write %d bytes\\n\", nw)\n        verificaErro(err6)\n    }\n\n    if err5 != nil {\n        //Reach end of file (stream), exit from loop\n        if err5 == io.EOF {\n            break\n        }\n        fmt.Printf(\"Error = %v\\n\", err5)\n        continue\n    }\n}\n\nif err := cmd.Wait(); err != nil {\n    fmt.Printf(\"Wait command error: %v\\n\", err)\n}\n</code></pre>\n\n<p>Another solution is utilizing <code>io.Copy</code> to copy the whole output into golang buffer. The code snippet will look like:</p>\n\n<pre><code>var buf bytes.Buffer\n\nn, err := io.Copy(&amp;buf, stdout)\nverificaErro(err)\nfmt.Printf(\"Copied %d bytes\\n\", n)\n\nerr = cmd.Wait()\nfmt.Printf(\"Wait error %v\\n\", err)\n\n//do something with the data\ndata := buf.Bytes()\nf, err4 := os.OpenFile(dir+\"/out.raw\", os.O_RDWR|os.O_APPEND, 0666)\nverificaErro(err4)\ndefer f.Close()\nnw, err := f.Write(data)\nf.Sync()\nfmt.Printf(\"Write size %d bytes\\n\", nw)\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 4206026, "user_type": "registered", "accept_rate": 12, "profile_image": "https://graph.facebook.com/100006809166027/picture?type=large", "display_name": "Anderson Scouto da Silva", "link": "https://stackoverflow.com/users/4206026/anderson-scouto-da-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6093, "favorite_count": 2, "accepted_answer_id": 43602656, "answer_count": 1, "score": 3, "last_activity_date": 1493099577, "creation_date": 1493095776, "question_id": 43601846, "link": "https://stackoverflow.com/questions/43601846/golang-and-ffmpeg-realtime-streaming-input-output", "title": "Golang and ffmpeg realtime streaming input/output", "body": "<p>I'm new to Go!</p>\n\n<p>I'm doing a simple test that is reading the output from ffmpeg and writing to a file.</p>\n\n<p>I know I can do it in a different way, simply convert, but this is the beginning of a project where I want to later manipulate the bytes read, changing them and then sending them to the output. And the input will be UDP and output will be UDP too, that is, I will get the ffmpeg output I will treat the bytes as I wish to do and then I will throw these bytes as input into another ffmpeg process which output is UDP as well.</p>\n\n<p>With this simple test the result of the file does not run in VLC, I believe I'm writing the bytes in the output file correctly, but the output file always has 1MB less than the input file.</p>\n\n<p>I would like some help to elucidate what would be the best way to write this test that I am doing, based on that I can get out of the place. I do not know if it's exactly wrong, but I have the impression that it is.</p>\n\n<p>The input file is a video in 4K, h264, I believe the output should be the same, because in this simple test I am simply reading what goes out in the cmd writing in the file.</p>\n\n<p>Follow the code for analysis:</p>\n\n<pre><code>package main\n\nimport (\n    \"os/exec\"\n    \"os\"\n)\n\nfunc verificaErro(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\n\nfunc main() {\n    dir, _ := os.Getwd()\n\n    cmdName := \"ffmpeg\"\n    args := []string{\n        \"-hide_banner\",\n        \"-re\",\n        \"-i\",\n        dir + \"\\\\teste-4k.mp4\",\n        \"-preset\",\n        \"superfast\",\n        \"-c:v\",\n        \"h264\",\n        \"-crf\",\n        \"0\",\n        \"-c\",\n        \"copy\",\n        \"-f\", \"rawvideo\", \"-\",\n    }\n    cmd := exec.Command(cmdName, args...)\n\n    stdout, err := cmd.StdoutPipe()\n    verificaErro(err)\n    err2 := cmd.Start()\n    verificaErro(err2)\n\n    fileOutput := dir + \"/out.raw\"\n    var _, err3 = os.Stat(fileOutput)\n\n    if os.IsNotExist(err3) {\n        var file, err = os.Create(fileOutput)\n        verificaErro(err)\n        defer file.Close()\n    }\n\n    f, err4 := os.OpenFile(dir+\"/out.raw\", os.O_RDWR|os.O_APPEND, 0666)\n\n    verificaErro(err4)\n\n    bytes := make([]byte, 1024)\n    for {\n        _, err5 := stdout.Read(bytes)\n        if err5 != nil {\n            continue\n        }\n        if len(bytes) &gt; 0 {\n            _, err6 := f.Write(bytes)\n            verificaErro(err6)\n        } else {\n            break\n        }\n    }\n\n    f.Close()\n}\n</code></pre>\n"}, {"tags": ["go", "web-applications", "server"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1493103220, "post_id": 43601359, "comment_id": 74256438, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28899675/include-js-file-in-go-template/28899786#28899786\">Include js file in Go template</a>; and <a href=\"http://stackoverflow.com/questions/28745161/with-golang-webserver-where-does-the-root-of-the-website-map-onto-the-filesystem/28745280#28745280\">With golang webserver where does the root of the website map onto the filesystem?</a>"}, {"owner": {"reputation": 136, "user_id": 6390296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea56caa3d5b02a61b4758be4cd57eadb?s=128&d=identicon&r=PG", "display_name": "Huy Ngo", "link": "https://stackoverflow.com/users/6390296/huy-ngo"}, "edited": false, "score": 0, "creation_date": 1540734168, "post_id": 43601359, "comment_id": 92964680, "body": "Why is the link in html tag is &quot;/assets/&quot; but in the pic &quot;/static/&quot;?"}, {"owner": {"reputation": 136, "user_id": 6390296, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea56caa3d5b02a61b4758be4cd57eadb?s=128&d=identicon&r=PG", "display_name": "Huy Ngo", "link": "https://stackoverflow.com/users/6390296/huy-ngo"}, "edited": false, "score": 0, "creation_date": 1541240966, "post_id": 43601359, "comment_id": 93154528, "body": "Can I ask where you put your executable file? I&#39;m having the same problem and I don&#39;t know how I should write the file path."}, {"owner": {"reputation": 1111, "user_id": 1131607, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/xLKUc.jpg?s=128&g=1", "display_name": "Arun", "link": "https://stackoverflow.com/users/1131607/arun"}, "edited": false, "score": 0, "creation_date": 1581921983, "post_id": 43601359, "comment_id": 106584458, "body": "A Wonderful tutorial <a href=\"https://www.alexedwards.net/blog/serving-static-sites-with-go\" rel=\"nofollow noreferrer\">alexedwards.net/blog/serving-static-sites-with-go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 453, "user_id": 4868267, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d390efb3fd7d28967f9bf357d2d9f48e?s=128&d=identicon&r=PG&f=1", "display_name": "bmacrevolution", "link": "https://stackoverflow.com/users/4868267/bmacrevolution"}, "edited": false, "score": 1, "creation_date": 1493093294, "post_id": 43601392, "comment_id": 74252525, "body": "Where should I place that line of code? In main with all the function handlers or in my function that serves the index template for example"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 453, "user_id": 4868267, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d390efb3fd7d28967f9bf357d2d9f48e?s=128&d=identicon&r=PG&f=1", "display_name": "bmacrevolution", "link": "https://stackoverflow.com/users/4868267/bmacrevolution"}, "edited": false, "score": 0, "creation_date": 1493093353, "post_id": 43601392, "comment_id": 74252536, "body": "Anytime. Usually before <code>http.ListenAndServe</code>. So probably in your main."}, {"owner": {"reputation": 453, "user_id": 4868267, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d390efb3fd7d28967f9bf357d2d9f48e?s=128&d=identicon&r=PG&f=1", "display_name": "bmacrevolution", "link": "https://stackoverflow.com/users/4868267/bmacrevolution"}, "edited": false, "score": 0, "creation_date": 1493094154, "post_id": 43601392, "comment_id": 74252732, "body": "Doing it that way does not seem to have worked. I posted some updated code"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 453, "user_id": 4868267, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d390efb3fd7d28967f9bf357d2d9f48e?s=128&d=identicon&r=PG&f=1", "display_name": "bmacrevolution", "link": "https://stackoverflow.com/users/4868267/bmacrevolution"}, "edited": false, "score": 0, "creation_date": 1493094337, "post_id": 43601392, "comment_id": 74252795, "body": "Use either the <code>&#47;static&#47;</code> path I added to my answer, or do one for each css and js, e.g. <code>http.Handle(&quot;&#47;css&#47;&quot;, http.FileServer(http.Dir(&quot;css&#47;&quot;)))</code> and <code>http.Handle(&quot;&#47;js&#47;&quot;, http.FileServer(http.Dir(&quot;js&#47;&quot;)))</code>"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493094366, "post_id": 43601392, "comment_id": 74252810, "body": "You may need to use <code>http.StripPrefix</code> also to get the path right"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493094610, "post_id": 43601392, "comment_id": 74252870, "body": "@JohnWeldon I just realized that"}, {"owner": {"reputation": 453, "user_id": 4868267, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d390efb3fd7d28967f9bf357d2d9f48e?s=128&d=identicon&r=PG&f=1", "display_name": "bmacrevolution", "link": "https://stackoverflow.com/users/4868267/bmacrevolution"}, "edited": false, "score": 0, "creation_date": 1493094927, "post_id": 43601392, "comment_id": 74252964, "body": "I tried replaced the http handle line with both http.Handle(&quot;/static/&quot;, http.StripPrefix(&quot;/static/&quot;, http.FileServer(http.Dir(&quot;/static&quot;)))) and http.Handle(&quot;/static/&quot;, http.FileServer(http.Dir(&quot;static/&quot;))) but still no luck. I also renamed the assets file to static so that the path names would be correct. My new screenshot reflects that change. I also added that line of code to the main function snippet above"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1493095090, "post_id": 43601392, "comment_id": 74253001, "body": "Your code shows you are using <code>http.Dir(&quot;&#47;static&quot;)</code>. Remove the <code>&#47;</code>. Using it tells Go to look for the directory at the root of your filesystem. No <code>&#47;</code> tells it to look relative to the go application. Admittedly... my example has the slash, so that&#39;s my bad (fixed)"}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 27, "last_activity_date": 1563901516, "last_edit_date": 1563901516, "creation_date": 1493093180, "answer_id": 43601392, "question_id": 43601359, "link": "https://stackoverflow.com/questions/43601359/how-do-i-serve-css-and-js-in-go/43601392#43601392", "title": "How do I serve CSS and JS in Go", "body": "<pre><code>http.Handle(\"/\", http.FileServer(http.Dir(\"css/\")))\n</code></pre>\n\n<p>Would serve your <code>css</code> directory at <code>/</code>. Of course you can serve whichever directory at whatever path you choose.</p>\n\n<p>You probably want to make sure that the static path isn't in the way of other paths and use something like this.</p>\n\n<pre><code>http.Handle(\"/static/\", http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"static\"))))\n</code></pre>\n\n<p>Placing both your <code>js</code> and <code>css</code> in the directory <code>static</code> in your project. This would then serve them at <code>domain.com/static/css/filename.css</code> and <code>domain.com/static/js/filename.js</code></p>\n\n<p>The <code>StripPrefix</code> method removes the prefix, so it doesn't try to search e.g. in the <code>static</code> directory for <code>static/css/filename.css</code> which, of course, it wouldn't find. It would look for <code>css/filename.css</code> in the <code>static</code> directory, which would be correct.</p>\n"}, {"tags": [], "owner": {"reputation": 7, "user_id": 11944291, "user_type": "registered", "profile_image": "https://graph.facebook.com/10157250692178267/picture?type=large", "display_name": "Lyn Samuel", "link": "https://stackoverflow.com/users/11944291/lyn-samuel"}, "is_accepted": false, "score": 1, "last_activity_date": 1566194535, "last_edit_date": 1566194535, "creation_date": 1566177234, "answer_id": 57549524, "question_id": 43601359, "link": "https://stackoverflow.com/questions/43601359/how-do-i-serve-css-and-js-in-go/57549524#57549524", "title": "How do I serve CSS and JS in Go", "body": "<p>I added a link to my apache servers css dir into the head section of my template files. I keep the template and data files used by any go application under dir that the go application is running from. In this instance cgi-bin.</p>\n\n<p>The template uses the css from my apache server <code>assets/css</code> directory  :</p>\n\n<pre><code>&lt;link rel=\"stylesheet\" href=\"/assets/css/main.css\" /&gt;\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/yOyWi.png\" rel=\"nofollow noreferrer\">go apps run from my cgi-bin dir</a></p>\n\n<p><a href=\"https://i.stack.imgur.com/wmMRl.png\" rel=\"nofollow noreferrer\">sytle sheets are served from my apache assets/css dir </a></p>\n"}], "owner": {"reputation": 453, "user_id": 4868267, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d390efb3fd7d28967f9bf357d2d9f48e?s=128&d=identicon&r=PG&f=1", "display_name": "bmacrevolution", "link": "https://stackoverflow.com/users/4868267/bmacrevolution"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26127, "favorite_count": 10, "accepted_answer_id": 43601392, "answer_count": 2, "score": 23, "last_activity_date": 1597593053, "creation_date": 1493092945, "last_edit_date": 1597593053, "question_id": 43601359, "link": "https://stackoverflow.com/questions/43601359/how-do-i-serve-css-and-js-in-go", "title": "How do I serve CSS and JS in Go", "body": "<p>I followed the <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">Go Writing Web Applications</a> tutorial but for whatever reason I am having trouble getting the app to serve CSS and JS. If I run my static page without the Go server the page CSS works fine. When I run the Go server on the other hand the CSS just doesn't work.</p>\n<p>Here is what my HTML sort of looks like:</p>\n<pre><code>&lt;link rel=&quot;stylesheet&quot; href=&quot;../assets/css/bootstrap.min.css&quot;&gt;\n&lt;link rel=&quot;stylesheet&quot; href=&quot;../assets/css/bootstrap-theme.min.css&quot;&gt;\n&lt;link rel=&quot;stylesheet&quot; href=&quot;../assets/css/custom.css&quot;&gt;\n        \n</code></pre>\n<p>then under the <code>body</code> tag:</p>\n<pre><code>&lt;script src=&quot;../assets/js/jquery.min.js&quot;&gt;&lt;/script&gt;\n&lt;script src=&quot;../assets/js/bootstrap.min.js&quot;&gt;&lt;/script&gt;\n</code></pre>\n<p>My file tree looks like this:</p>\n<pre><code>go-affect/\n\u251c\u2500\u2500 data\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 \u2026\n\u251c\u2500\u2500 static\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 css\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 \u2026\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 js\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 \u2026\n\u251c\u2500\u2500 tmpl\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 edit.html\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 index.html\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 view.html\n\u2514\u2500\u2500 main.go\n</code></pre>\n<p>How do I get my Go application to serve the CSS and JavaScript I need?</p>\n<p><strong>EDIT:</strong></p>\n<p>The problem has since been solved, here is the working main:</p>\n<pre><code>func main() {\n    http.HandleFunc(&quot;/view/&quot;, makeHandler(viewHandler))\n    http.HandleFunc(&quot;/edit/&quot;, makeHandler(editHandler))\n    http.HandleFunc(&quot;/save/&quot;, makeHandler(saveHandler))\n    http.HandleFunc(&quot;/index/&quot;, makeHandler(indexHandler))\n\n    \n    http.Handle(&quot;/static/&quot;, http.StripPrefix(&quot;/static/&quot;, http.FileServer(http.Dir(&quot;static&quot;))))\n\n    http.ListenAndServe(&quot;:8080&quot;, nil)\n}\n</code></pre>\n<p>Here is an example of the handlers I am using:</p>\n<pre><code>func indexHandler(w http.ResponseWriter, r *http.Request, title string) {\n    p := &amp;Page{Title: title}\n    err := templates.ExecuteTemplate(w, &quot;index.html&quot;, p)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 3, "last_activity_date": 1493089875, "creation_date": 1493089875, "answer_id": 43600923, "question_id": 43600768, "link": "https://stackoverflow.com/questions/43600768/multiple-dir-serving-is-not-working/43600923#43600923", "title": "Multiple Dir serving is not working", "body": "<p>One of the issues with using <code>http.FileServer</code> is that the request path is used to build the file name, so if you're serving from anywhere but the root you need to strip the route prefix to that handler.</p>\n\n<p>The standard library includes a helpful tool for that <code>http.StripPrefix</code>, but that only works on <code>http.Handler</code>s, not <code>http.HandleFunc</code>s, so to use it you need to adapt your <code>HandleFunc</code> to a <code>Handler</code>.</p>\n\n<p>Here is a working version that should do what you want. Note that wHandler is just an adapter from your <code>HttpFunc</code> methods to <code>Hander</code> interface:</p>\n\n<pre><code>package main\n\nimport (\n        \"log\"\n        \"net/http\"\n)\n\nfunc serveIDE(w http.ResponseWriter, r *http.Request) {\n        http.FileServer(http.Dir(\"/home/user/ide\")).ServeHTTP(w, r)\n}\n\nfunc serveConsole(w http.ResponseWriter, r *http.Request) {\n        http.FileServer(http.Dir(\"/home/user/console\")).ServeHTTP(w, r)\n}\n\ntype wHandler struct {\n        fn http.HandlerFunc\n}\n\nfunc (h *wHandler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n        log.Printf(\"Handle request: %s %s\", r.Method, r.RequestURI)\n        defer log.Printf(\"Done with request: %s %s\", r.Method, r.RequestURI)\n        h.fn(w, r)\n}\n\nfunc main() {\n        http.Handle(\"/ide\", http.StripPrefix(\"/ide\", &amp;wHandler{fn: serveIDE}))\n        http.Handle(\"/console\", http.StripPrefix(\"/console\", &amp;wHandler{fn: serveConsole}))\n        err := http.ListenAndServe(\":9090\", nil)\n        if err != nil {\n                log.Fatal(\"ListenAndServe: \", err)\n        }\n}\n</code></pre>\n"}], "owner": {"reputation": 1455, "user_id": 465147, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/e824e3adb5aa777566fa8e53f89bebbe?s=128&d=identicon&r=PG", "display_name": "sprabhakaran", "link": "https://stackoverflow.com/users/465147/sprabhakaran"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 81, "favorite_count": 0, "accepted_answer_id": 43600923, "answer_count": 1, "score": 0, "last_activity_date": 1493089875, "creation_date": 1493088692, "question_id": 43600768, "link": "https://stackoverflow.com/questions/43600768/multiple-dir-serving-is-not-working", "title": "Multiple Dir serving is not working", "body": "<p>Any mistakes in below code? Multiple directory serving is not working from the below code. When I access the localhost:9090/ide, the server will return 404 error.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc serveIDE(w http.ResponseWriter, r *http.Request) {\n    http.FileServer(http.Dir(\"/home/user/ide\")).ServeHTTP(w, r)\n}\n\nfunc serveConsole(w http.ResponseWriter, r *http.Request) {\n    http.FileServer(http.Dir(\"/home/user/console\")).ServeHTTP(w, r)\n}\n\nfunc main() {\n    http.HandleFunc(\"/ide\", serveIDE)         \n    http.HandleFunc(\"/console\", serveConsole) \n    err := http.ListenAndServe(\":9090\", nil)  \n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>When I change the code like this,</p>\n\n<pre><code>http.HandleFunc(\"/\", serveIDE)\n</code></pre>\n\n<p>It will work as I expected.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493086693, "post_id": 43600427, "comment_id": 74251002, "body": "You&#39;re not checking the error on <code>os.Create</code>, make sure that&#39;s nil before writing the file."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1493086839, "post_id": 43600427, "comment_id": 74251035, "body": "You need to use <code>strconv</code> or <code>fmt.Sprintf</code> to convert <code>integer</code> to <code>string</code>. Take a look at <a href=\"https://stackoverflow.com/questions/10105935/how-to-convert-an-int-value-to-string-in-go\">this QA</a>."}], "answers": [{"comments": [{"owner": {"reputation": 212, "user_id": 4584097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-6K_pX8tNuPo/AAAAAAAAAAI/AAAAAAAAAc4/0XJflOsKhVI/photo.jpg?sz=128", "display_name": "Marcus Pereira", "link": "https://stackoverflow.com/users/4584097/marcus-pereira"}, "edited": false, "score": 1, "creation_date": 1493089487, "post_id": 43600549, "comment_id": 74251650, "body": "Thanks John for reply, +1"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 212, "user_id": 4584097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-6K_pX8tNuPo/AAAAAAAAAAI/AAAAAAAAAc4/0XJflOsKhVI/photo.jpg?sz=128", "display_name": "Marcus Pereira", "link": "https://stackoverflow.com/users/4584097/marcus-pereira"}, "edited": false, "score": 0, "creation_date": 1493089935, "post_id": 43600549, "comment_id": 74251751, "body": "You&#39;re welcome, feel free to upvote and accept if this solves your issue @MarcusPereira"}, {"owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "edited": false, "score": 0, "creation_date": 1530896486, "post_id": 43600549, "comment_id": 89410768, "body": "Is there a reason not to use <code>fmt.Fprintf(f, &quot;%d\\n&quot;, i)</code> instead of <code>f.WriteString(fmt.Sprintf(&quot;%d\\n&quot;, i))</code>?"}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 6, "last_activity_date": 1493087353, "last_edit_date": 1493087353, "creation_date": 1493087003, "answer_id": 43600549, "question_id": 43600427, "link": "https://stackoverflow.com/questions/43600427/how-to-write-integers-in-a-file-using-golang/43600549#43600549", "title": "How to write integers in a file using Golang?", "body": "<p>There are a few issues with your code.</p>\n\n<p>1) You're opening the file multiple times, every iteration of your loop; <code>os.Create</code> will truncate the file if it already exists, so you may be writing and truncating it on each iteration.</p>\n\n<p>2) You're not checking that the file opens correctly without error</p>\n\n<p>3) <code>defer</code> schedules code to run when the function ends, not at the end of the scope. (i.e. at the end of the iteration)</p>\n\n<p>4) You should convert the integer properly, using a conversion and checking the error: <code>_, err := f.WriteString(fmt.Sprintf(\"%d\",i))</code>, and then check the error.</p>\n\n<p>Try this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    f, err := os.Create(\"h.txt\") // creating...\n    if err != nil {\n        fmt.Printf(\"error creating file: %v\", err)\n        return\n    }\n    defer f.Close()\n    for i := 0; i &lt; 10; i++ { // Generating...\n        _, err = f.WriteString(fmt.Sprintf(\"%d\\n\", i)) // writing...\n        if err != nil {\n            fmt.Printf(\"error writing string: %v\", err)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 212, "user_id": 4584097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-6K_pX8tNuPo/AAAAAAAAAAI/AAAAAAAAAc4/0XJflOsKhVI/photo.jpg?sz=128", "display_name": "Marcus Pereira", "link": "https://stackoverflow.com/users/4584097/marcus-pereira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4985, "favorite_count": 0, "accepted_answer_id": 43600549, "answer_count": 1, "score": 2, "last_activity_date": 1493087353, "creation_date": 1493086121, "question_id": 43600427, "link": "https://stackoverflow.com/questions/43600427/how-to-write-integers-in-a-file-using-golang", "title": "How to write integers in a file using Golang?", "body": "<ol>\n<li>I generate numbers from 0 to 10</li>\n<li>I create a file</li>\n<li>And I try to write to the file by converting integers to string</li>\n</ol>\n\n<p>But when I open the h.txt file there is nothing written</p>\n\n<p>How to fix this and have the numbers written to the h.txt file?</p>\n\n<pre><code>package main\n\nimport \"os\"\n\nfunc main() {\n    for i := 0; i &lt; 10; i++ { // Generating...\n\n        f, _ := os.Create(\"h.txt\") // creating...\n\n        f.WriteString(string(i)) // writing...\n\n        defer f.Close()\n    }\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["macos", "docker", "go"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493080790, "post_id": 43599676, "comment_id": 74249604, "body": "Have you checked that your firewall isn&#39;t blocking it?"}, {"owner": {"reputation": 967, "user_id": 2569807, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FHwBd.jpg?s=128&g=1", "display_name": "daplho", "link": "https://stackoverflow.com/users/2569807/daplho"}, "edited": false, "score": 1, "creation_date": 1493081313, "post_id": 43599676, "comment_id": 74249726, "body": "could you share the code for your server so I could test it locally?"}, {"owner": {"reputation": 9441, "user_id": 1000254, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/e1621f7d5eef73c430632061efdc97b0?s=128&d=identicon&r=PG", "display_name": "shizhz", "link": "https://stackoverflow.com/users/1000254/shizhz"}, "edited": false, "score": 0, "creation_date": 1493085328, "post_id": 43599676, "comment_id": 74250618, "body": "Does your webserver listen only on <code>localhost:8000</code>? It&#39;s supposed to listen on <code>0.0.0.0:8000</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1536, "user_id": 1793374, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qK8kV.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1793374/mike"}, "edited": false, "score": 0, "creation_date": 1493082696, "post_id": 43599767, "comment_id": 74250013, "body": "Still not working; I&#39;ve turned my firewall off and restarted the docker container"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "reply_to_user": {"reputation": 1536, "user_id": 1793374, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qK8kV.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1793374/mike"}, "edited": false, "score": 1, "creation_date": 1493084857, "post_id": 43599767, "comment_id": 74250474, "body": "That means that likely your code is listening on the localhost interface rather than the public interface of your container... Is your code binding to <code>127.0.0.1</code>?"}, {"owner": {"reputation": 1536, "user_id": 1793374, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qK8kV.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1793374/mike"}, "edited": false, "score": 0, "creation_date": 1493085657, "post_id": 43599767, "comment_id": 74250722, "body": "Changing the binding to 0.0.0.0 worked rather 127.0.0.1!"}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 2, "last_activity_date": 1493084767, "last_edit_date": 1493084767, "creation_date": 1493081007, "answer_id": 43599767, "question_id": 43599676, "link": "https://stackoverflow.com/questions/43599676/cant-expose-web-server-using-docker-on-osx/43599767#43599767", "title": "Can&#39;t expose web server using docker on OSX", "body": "<p>The newer versions of docker use <code>vpnkit</code> on OSX to manage the port forwarding to the containers... you should allow vpnkit through your firewall if you want to expose the container ports.</p>\n\n<p>Also, in your Go code, make sure to bind to <code>0.0.0.0</code> rather than <code>127.0.0.1</code> for your webserver code.</p>\n"}], "owner": {"reputation": 1536, "user_id": 1793374, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qK8kV.png?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/1793374/mike"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "accepted_answer_id": 43599767, "answer_count": 1, "score": 0, "last_activity_date": 1493084886, "creation_date": 1493080362, "last_edit_date": 1493084886, "question_id": 43599676, "link": "https://stackoverflow.com/questions/43599676/cant-expose-web-server-using-docker-on-osx", "title": "Can&#39;t expose web server using docker on OSX", "body": "<p>I have a docker image that runs a webserver and I would like to access it from my local OSX, but I'm having issues. </p>\n\n<p>I start the container with: <code>docker run -p 8000:8000 &lt;container-name&gt;</code></p>\n\n<p>and I can see log messages telling me that the local server is listening on <code>localhost:8000</code></p>\n\n<p>I am able to get a successful response from running:</p>\n\n<p><code>docker exec &lt;IMAGE-ID&gt; curl \"http://localhost:8000/\"</code></p>\n\n<p>Addresses I've tried on my local OSX are:</p>\n\n<ul>\n<li><code>http://localhost:8000/</code></li>\n<li><code>http://&lt;DOCKER-IP-172.17.0.2:8000/</code></li>\n</ul>\n\n<p>Neither of those work. Any suggestions?</p>\n\n<ul>\n<li>Container is built from <code>golang:1.8</code></li>\n<li>Docker Version: <code>Version 17.03.1-ce-mac5 (16048)</code></li>\n<li>MacOS Sierra: <code>10.12.4</code></li>\n<li>Firewall is turned off for testing purposes</li>\n</ul>\n\n<p>I've tried the same process on Ubuntu 16.04 and no luck their either.</p>\n"}, {"tags": ["javascript", "go"], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "edited": false, "score": 2, "creation_date": 1493082173, "post_id": 43599582, "comment_id": 74249903, "body": "The solution seems logical, i have to tried it but i have difficulties when register second handler. It seems i can&#39;t register handler except for &quot;/&quot;. I keep recieve this error in my browser <code>GET http:&#47;&#47;localhost:8080&#47;thirdparty 404 (Not Found)</code>."}], "tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 3, "last_activity_date": 1493079510, "creation_date": 1493079510, "answer_id": 43599582, "question_id": 43599513, "link": "https://stackoverflow.com/questions/43599513/golang-serve-static-files-in-different-directory/43599582#43599582", "title": "Golang serve static files in different directory", "body": "<p>You could add a second handler for javascript that serves from a different folder (which could even be configurable):</p>\n\n<pre><code>thirdPartyDir := \"&lt;configuration driven dir name&gt;\"\nhttp.Handle(\"/\", http.FileServer(http.Dir(\"static\"))\nhttp.Handle(\"/thirdparty\", http.FileServer(http.Dir(thirdPartyDir))\n</code></pre>\n\n<p>And then in your <code>index.js</code> you could include 3rd party code like:</p>\n\n<pre><code>&lt;script src='/thirdparty/foo.js'/&gt;\n</code></pre>\n"}], "owner": {"reputation": 327, "user_id": 6878109, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/0203bee52f4e9266945f07732403a43a?s=128&d=identicon&r=PG&f=1", "display_name": "billyzaelani", "link": "https://stackoverflow.com/users/6878109/billyzaelani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2033, "favorite_count": 1, "accepted_answer_id": 43599582, "answer_count": 1, "score": 0, "last_activity_date": 1493079510, "creation_date": 1493078936, "question_id": 43599513, "link": "https://stackoverflow.com/questions/43599513/golang-serve-static-files-in-different-directory", "title": "Golang serve static files in different directory", "body": "<p>I have a library for go webserver and contain js file as well, so this is supposed to be the directory trees of users app. <code>myapp</code> is users app and <code>mylib</code> is library that fetched through <code>go get</code>.</p>\n\n<pre><code>src\n`-- github.com\n    |-- mylib\n    |   |-- myJSlib\n    |   `-- myGOlib\n    `-- myapp\n        |-- main.go\n        `-- static\n            |-- index.html\n            |-- js\n            `-- css\n</code></pre>\n\n<p>The web server of user app will serve static html in <code>static</code> subdirectory via</p>\n\n<pre><code>http.Handle(\"/\", http.FileServer(http.Dir(\"static\"))\n</code></pre>\n\n<p>My problem is i can't include the script of library into <code>index.html</code> because the <code>http.FileServer</code> serve in directory <code>static</code>. Naive solution is i move the root of <code>http.FileServer</code> into <code>src</code>. But this is not the solution i want because it's to verbose when include the script from <code>src</code>. The other solution is i tell the user move the js file into <code>static</code> directory, this is fine if user in production mode and i have minified version of my jslib but in development mode that require structured tree folder this is just can't solve it. Maybe i can separate repo for myGOlib and myJSlib and user can use <code>go get</code> to fetch the myGOlib and clone the myJSlib into static directory. But i want user just simply use <code>go get</code> and everything works both lib without structurize things again.</p>\n\n<p>Any solution would be appreciate. thanks</p>\n"}, {"tags": ["string", "go", "split"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493078592, "post_id": 43599404, "comment_id": 74249147, "body": "Is there a reason you wouldn&#39;t want to use <code>strings.Split</code>? <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow noreferrer\">golang.org/pkg/strings/#Split</a>"}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493078901, "post_id": 43599404, "comment_id": 74249214, "body": "ye becouse i want <code>separator</code> to be included and in my case separator can be different for example <code>{name}&#47;{surname}</code>. You dont rly know what string is between <code>{}</code> and how many of them there is"}, {"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 1, "creation_date": 1493079143, "post_id": 43599404, "comment_id": 74249275, "body": "I still think you&#39;ll get the best result from using strings.Split, but you may be interested in writing a parser; they&#39;re fun and Rob Pike has a relatively famous talk explaining how to write a custom lexical scanner, which is fun too."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493079802, "post_id": 43599404, "comment_id": 74249413, "body": "I&#39;m not sure I understand your requirements but is this what you&#39;re looking for? <a href=\"https://play.golang.org/p/qcqBgld2_I\" rel=\"nofollow noreferrer\">play.golang.org/p/qcqBgld2_I</a>"}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493080030, "post_id": 43599404, "comment_id": 74249464, "body": "yes, perfect with a quick look i think it works as i wanted. Thanks, i will now do parser/lexer solution as @JohnWeldon mention and then compare performance of this two"}], "answers": [{"tags": [], "owner": {"reputation": 156, "user_id": 7631803, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Ui1mz.jpg?s=128&g=1", "display_name": "Zac R.", "link": "https://stackoverflow.com/users/7631803/zac-r"}, "is_accepted": true, "score": 0, "last_activity_date": 1493093731, "creation_date": 1493093731, "answer_id": 43601473, "question_id": 43599404, "link": "https://stackoverflow.com/questions/43599404/go-how-can-i-efficient-split-string-into-parts/43601473#43601473", "title": "Go how can i efficient split string into parts", "body": "<p>Here is a solution:</p>\n\n<pre><code>var validPathRe = regexp.MustCompile(\"^(/{[[:alpha:]]+}|/[-_.[:alnum:]]+)+$\")\nvar splitPathRe = regexp.MustCompile(\"({[[:alpha:]]+}|[-_.[:alnum:]]+)\")\n\nfunc splitPath(path string) parts{\n    var retPaths parts\n\n    if !validPathRe.MatchString(path) {\n        return retPaths\n    }\n\n    retPaths = splitPathRe.FindAllString(path, -1)\n\n    return retPaths\n}\n</code></pre>\n\n<p>I made this by creating two regular expressions, one to check if the path was valid or not, the other to extract the various parts of the path and return them. If the path is not valid it will return an empty list. The return of this will look like this:</p>\n\n<pre><code>splitPath(\"/path/{to}/your/file.txt\")\n[\"path\" \"{to}\" \"your\" \"file.txt\"]\n</code></pre>\n\n<p>This doesn't include the '/' character because you already know that all strings in the return but the last string is a directory and the last string is the file name. Because of the validity check you can assume this.</p>\n"}], "owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "accepted_answer_id": 43601473, "answer_count": 1, "score": 0, "last_activity_date": 1493093731, "creation_date": 1493078036, "question_id": 43599404, "link": "https://stackoverflow.com/questions/43599404/go-how-can-i-efficient-split-string-into-parts", "title": "Go how can i efficient split string into parts", "body": "<p>i am fighting with a string splitting. I want to split string by <em>wildcard</em>s into a slice, but this slice should contain this wildcards as well.</p>\n\n<p>For example: <code>/applications/{name}/tokens/{name}</code> should be split into <code>[/applications/ {name} /tokens/ {name}]</code> etc.</p>\n\n<p>Here is a sample code i wrote, but it is not working correctly, and i don't feel good about it either.</p>\n\n<p><a href=\"https://play.golang.org/p/VMOsJeaI4l\" rel=\"nofollow noreferrer\">https://play.golang.org/p/VMOsJeaI4l</a></p>\n\n<p>There are some example routes to be tested. Method <code>splitPath</code> split path into parts and display both: before and after.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1493081887, "post_id": 43599430, "comment_id": 74249840, "body": "In Go, check return values (<a href=\"https://golang.org/pkg/bufio/#Scanner.Scan\" rel=\"nofollow noreferrer\"><code>func (s *Scanner) Scan() bool</code></a>) and errors (<a href=\"https://golang.org/pkg/strconv/#Atoi\" rel=\"nofollow noreferrer\"><code>func Atoi(s string) (int, error)</code></a>)."}], "tags": [], "owner": {"reputation": 2346, "user_id": 2329708, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5Du22.jpg?s=128&g=1", "display_name": "Nate Jenson", "link": "https://stackoverflow.com/users/2329708/nate-jenson"}, "is_accepted": false, "score": 1, "last_activity_date": 1493078252, "creation_date": 1493078252, "answer_id": 43599430, "question_id": 43599253, "link": "https://stackoverflow.com/questions/43599253/read-space-separated-integers-from-stdin-into-int-slice/43599430#43599430", "title": "Read space separated integers from stdin into int slice", "body": "<p>So, this is what I ended up doing. There is likely a more idiomatic way of solving it, though.</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"os\"\n    \"bufio\"\n    \"strings\"\n    \"strconv\"\n)\n\nfunc main() {\n\n    scanner := bufio.NewScanner(os.Stdin)\n\n    scanner.Scan()\n    parts := strings.Split(scanner.Text(), \" \")\n    lineOne := createIntSlice(parts)\n\n    scanner.Scan()\n    parts = strings.Split(scanner.Text(), \" \")\n    lineTwo := createIntSlice(parts)\n\n    fmt.Println(lineOne)\n    fmt.Println(lineTwo)\n}\n\nfunc createIntSlice(nums []string) []int {\n    var r []int\n    for _, v := range nums {\n        i, _ := strconv.Atoi(v)\n        r = append(r, i)\n    }\n    return r\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 411, "user_id": 10595057, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hQZrS.jpg?s=128&g=1", "display_name": "incrypt0", "link": "https://stackoverflow.com/users/10595057/incrypt0"}, "edited": false, "score": 2, "creation_date": 1586338173, "post_id": 43599651, "comment_id": 108089300, "body": "So it will take this long piece of code to do that? Is&#39;nt there a shorter way?"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 8, "last_activity_date": 1493083157, "last_edit_date": 1493083157, "creation_date": 1493080179, "answer_id": 43599651, "question_id": 43599253, "link": "https://stackoverflow.com/questions/43599253/read-space-separated-integers-from-stdin-into-int-slice/43599651#43599651", "title": "Read space separated integers from stdin into int slice", "body": "<p>For example,</p>\n\n<p><code>numbers.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc numbers(s string) []int {\n    var n []int\n    for _, f := range strings.Fields(s) {\n        i, err := strconv.Atoi(f)\n        if err == nil {\n            n = append(n, i)\n        }\n    }\n    return n\n}\n\nfunc main() {\n    var firstLine, secondLine []int\n    scanner := bufio.NewScanner(os.Stdin)\n    for i := 1; i &lt;= 2 &amp;&amp; scanner.Scan(); i++ {\n        switch i {\n        case 1:\n            firstLine = numbers(scanner.Text())\n        case 2:\n            secondLine = numbers(scanner.Text())\n        }\n    }\n    fmt.Println(firstLine)\n    fmt.Println(secondLine)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>$ go run numbers.go\n1 2 3\n4 5 6\n[1 2 3]\n[4 5 6]\n$\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 212, "user_id": 4584097, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh5.googleusercontent.com/-6K_pX8tNuPo/AAAAAAAAAAI/AAAAAAAAAc4/0XJflOsKhVI/photo.jpg?sz=128", "display_name": "Marcus Pereira", "link": "https://stackoverflow.com/users/4584097/marcus-pereira"}, "is_accepted": false, "score": -1, "last_activity_date": 1493132482, "last_edit_date": 1493132482, "creation_date": 1493132043, "answer_id": 43614150, "question_id": 43599253, "link": "https://stackoverflow.com/questions/43599253/read-space-separated-integers-from-stdin-into-int-slice/43614150#43614150", "title": "Read space separated integers from stdin into int slice", "body": "<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"strings\"\n)\n\n// You receive a string as parameter\n// List receives N As a string slice\n// Returns N as a string slice\nfunc number(n string) []string {\n    list := strings.Fields(n)\n\n    return list\n}\n\nfunc main() {\n    scanner := bufio.NewScanner(os.Stdin) //Receiving user data ...\n\n    list := make([][]string, 0) // Declare a slice to receive other slices inside it\n\n    for scanner.Scan() { // Scrolls all typed data to true\n\n        // If the user does not type anything, that is, if he presses Enter an interrupt will occur\n        if scanner.Text() == \"\" {\n            break\n        } else {\n            list = append(list, number(scanner.Text())) // Adding the slice inside list\n        }\n    }\n\n    fmt.Println(list) // print list\n}\n</code></pre>\n\n<p>All data is going and returning as string, but you can convert them to integers easily.</p>\n"}, {"comments": [{"owner": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "edited": false, "score": 0, "creation_date": 1535054382, "post_id": 51992900, "comment_id": 90936427, "body": "If I am not mistaken, that does not stop reading after 2 new lines. I am also not sure if breaking after 2 new lines can easily be accomplished with <code>Fscan</code>, as it treats newlines line whitespace. Maybe <code>Fscanln</code> could help there."}], "tags": [], "owner": {"reputation": 21, "user_id": 10266532, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9a596d386788eef1c0c12a9e33b5ba08?s=128&d=identicon&r=PG", "display_name": "Aswin", "link": "https://stackoverflow.com/users/10266532/aswin"}, "is_accepted": false, "score": 2, "last_activity_date": 1535052454, "last_edit_date": 1535052454, "creation_date": 1535052095, "answer_id": 51992900, "question_id": 43599253, "link": "https://stackoverflow.com/questions/43599253/read-space-separated-integers-from-stdin-into-int-slice/51992900#51992900", "title": "Read space separated integers from stdin into int slice", "body": "<p>If you are looking for code to read input to solve problems in hackathons, here is your best solution</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"os\"\n    \"fmt\"\n)\n\nfunc main() {\n\n    reader := bufio.NewReader(os.Stdin)\n\n    a:= read(reader,100000)\n\n    fmt.Println(a)\n}\n\nfunc read (reader *bufio.Reader, n int)([]uint32) {\n\n    a := make([]uint32, n)\n    for i:=0; i&lt;n; i++ {\n        fmt.Fscan(reader, &amp;a[i])\n    }\n\n    return a\n}\n</code></pre>\n"}], "owner": {"reputation": 2346, "user_id": 2329708, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/5Du22.jpg?s=128&g=1", "display_name": "Nate Jenson", "link": "https://stackoverflow.com/users/2329708/nate-jenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4249, "favorite_count": 1, "accepted_answer_id": 43599651, "answer_count": 4, "score": 7, "last_activity_date": 1535052454, "creation_date": 1493076822, "question_id": 43599253, "link": "https://stackoverflow.com/questions/43599253/read-space-separated-integers-from-stdin-into-int-slice", "title": "Read space separated integers from stdin into int slice", "body": "<p>I'm trying to read from stdin two lines of an unknown number of space-separated integers. I would like to store each lines ints into their own int slice.</p>\n\n<p>For example, my input may look like this:</p>\n\n<pre><code>1 2 3\n4 5 6\n</code></pre>\n\n<p>and I want to read this into two <code>[]int</code>:</p>\n\n<pre><code>[1,2,3]\n[4,5,6]\n</code></pre>\n\n<p>This is what I have so far. <code>scanner.Scan()</code> is giving me the line, but I'm not sure how to convert that into a <code>[]int</code>:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"os\"\n    \"bufio\"\n)\n\nfunc main() {\n    var firstLine []int\n    var secondLine []int\n\n    scanner := bufio.NewScanner(os.Stdin)\n    for scanner.Scan() {\n        t := scanner.Text()\n    }\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "replication", "connection-pooling", "postgresql-bdr"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 2, "creation_date": 1493092474, "post_id": 43599172, "comment_id": 74252343, "body": "Connection pool in golang is per <code>configuration</code> (in case of PostgreSQL per schema, for MySQL you can use &quot;same&quot; connection to access multiple database/schema in the same server). If you need to connect to multiple servers, you need to create different connection pool for each server, then manage it manually. IMHO, in your case, you should use pgBouncer."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 5, "last_activity_date": 1493263089, "creation_date": 1493263089, "answer_id": 43648067, "question_id": 43599172, "link": "https://stackoverflow.com/questions/43599172/how-do-i-get-a-golang-database-connection-pool-to-manage-connections-to-multiple/43648067#43648067", "title": "How do I get a Golang Database connection pool to manage connections to multiple hosts in a cluster?", "body": "<p>Connection pool in golang is created whenever you call <code>sql.Open(driverName, dataSourceName)</code>, where <code>dataSourceName</code> is driver specific <code>configuration</code> for connecting to database. Whenever we change the <code>configuration</code> (i.e. changing host address, schema, username, etc) we need to open new connection, thus new connection pool will be created. If a driver can handle load balancing, it should be configurable in <code>dataSourceName</code>, e.g. as in <a href=\"https://mariadb.com/kb/en/mariadb/failover-and-high-availability-with-mariadb-connector-j/\" rel=\"noreferrer\">MariaDB Connector/J</a> high availability configuration. </p>\n\n<p>AFAIK, load balancing not yet supported in <a href=\"https://github.com/lib/pq\" rel=\"noreferrer\">lib/pq</a> and <a href=\"https://github.com/jackc/pgx\" rel=\"noreferrer\">pgx</a>. In your case, to connect to database servers in cluster, you need to open different connection pool for each server, then manage the connections (and perform load balancing) manually. This approach needs a lot of work to be done. I think it is better to use pgBouncer.</p>\n"}], "owner": {"reputation": 8200, "user_id": 79202, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/397f829eea921e02e35c37c22f9e6d3b?s=128&d=identicon&r=PG", "display_name": "theory", "link": "https://stackoverflow.com/users/79202/theory"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6078, "favorite_count": 0, "accepted_answer_id": 43648067, "answer_count": 1, "score": 3, "last_activity_date": 1496112141, "creation_date": 1493076193, "last_edit_date": 1496112141, "question_id": 43599172, "link": "https://stackoverflow.com/questions/43599172/how-do-i-get-a-golang-database-connection-pool-to-manage-connections-to-multiple", "title": "How do I get a Golang Database connection pool to manage connections to multiple hosts in a cluster?", "body": "<p>I'm setting up <a href=\"http://bdr-project.org\" rel=\"nofollow noreferrer\">bi-direction replication</a> between four PostgreSQL workers, and I'd like to have my Go database connection pool handle connections to all four. It ought to be able to create multiple connections to them all, randomly select one for any given query, and fail over when a connection drops. Is this doable in the Go database library? Or should I just use <a href=\"https://pgbouncer.github.io\" rel=\"nofollow noreferrer\">pgBouncer</a> and not try to get <a href=\"https://golang.org/pkg/database/sql/\" rel=\"nofollow noreferrer\">database/sql</a> or <a href=\"https://godoc.org/github.com/jackc/pgx\" rel=\"nofollow noreferrer\">pgx</a> to handle that balancing?</p>\n"}, {"tags": ["go", "methods", "routing", "gorilla"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1493074176, "post_id": 43598861, "comment_id": 74247982, "body": "Looking for <code>Methods(&quot;GET&quot;,&quot;POST&quot;)</code>? Or maybe you just want <code>GET</code> for the one and <code>POST</code> for the other. <a href=\"https://godoc.org/github.com/gorilla/mux#Route.Methods\" rel=\"nofollow noreferrer\">godoc.org/github.com/gorilla/mux#Route.Methods</a>"}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1493074432, "creation_date": 1493074432, "answer_id": 43598933, "question_id": 43598861, "link": "https://stackoverflow.com/questions/43598861/golang-v1-8-error-type-mux-route-has-no-field-or-method-method/43598933#43598933", "title": "Golang (v1.8) - Error: type *mux.Route has no field or method Method", "body": "<p>There is no method <code>Method</code>, you need to use <a href=\"https://godoc.org/github.com/gorilla/mux#Route.Methods\" rel=\"nofollow noreferrer\"><code>Methods</code></a></p>\n"}], "owner": {"reputation": 379, "user_id": 6567055, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-54co2AZ0T6Q/AAAAAAAAAAI/AAAAAAAASWI/ArbHxGqzEeo/photo.jpg?sz=128", "display_name": "Nathaniel Rand", "link": "https://stackoverflow.com/users/6567055/nathaniel-rand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 917, "favorite_count": 0, "accepted_answer_id": 43598933, "answer_count": 1, "score": 0, "last_activity_date": 1493074432, "creation_date": 1493073995, "question_id": 43598861, "link": "https://stackoverflow.com/questions/43598861/golang-v1-8-error-type-mux-route-has-no-field-or-method-method", "title": "Golang (v1.8) - Error: type *mux.Route has no field or method Method", "body": "<p>I have a go/golang application equipped the gorilla toolkit. I am trying to utilize the gorilla/mux package for routing. My routes and the error message are below. Any pointers?</p>\n\n<p>Routes\n   `</p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/\", landing)\nr.HandleFunc(\"/contact\", contact)\nr.HandleFunc(\"/faq\", faq)\nr.HandleFunc(\"/register\", accountsC.New).Method(\"GET\")\nr.HandleFunc(\"/register\", accountsC.Create).Method(\"POST\")\nhttp.ListenAndServe(\":8080\", r)`\n</code></pre>\n\n<p>I have received this error:</p>\n\n<pre><code># command-line-arguments\n./main.go:27: r.HandleFunc(\"/register\", accountsC.New).Method undefined \n(type *mux.Route has no field or method Method)\n./main.go:28: r.HandleFunc(\"/register\", accountsC.Create).Method undefined \n(type *mux.Route has no field or method Method)\n</code></pre>\n"}, {"tags": ["go", "qor"], "comments": [{"owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493075372, "post_id": 43597796, "comment_id": 74248294, "body": "Can you provide the exact error message, rather than an approximation?"}, {"owner": {"reputation": 841, "user_id": 5505164, "user_type": "registered", "profile_image": "https://graph.facebook.com/1483647971940832/picture?type=large", "display_name": "Roman Shishkin", "link": "https://stackoverflow.com/users/5505164/roman-shishkin"}, "reply_to_user": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "edited": false, "score": 0, "creation_date": 1493076784, "post_id": 43597796, "comment_id": 74248710, "body": "I&#39;ve extended message with detail log trace. There is a big golang stack trace too. Not sure about posting it here instead of github."}, {"owner": {"reputation": 4805, "user_id": 1085264, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b8e1b984756a7ed46d210e80c0957895?s=128&d=identicon&r=PG", "display_name": "straya", "link": "https://stackoverflow.com/users/1085264/straya"}, "edited": false, "score": 0, "creation_date": 1493249654, "post_id": 43597796, "comment_id": 74340792, "body": "@Roman Shishkin this is the place to ask such questions and post associated info, Github should be for issues with QOR itself."}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 1, "last_activity_date": 1493077210, "creation_date": 1493077210, "answer_id": 43599290, "question_id": 43597796, "link": "https://stackoverflow.com/questions/43597796/how-to-make-fields-in-qor-model-readonly/43599290#43599290", "title": "How to make fields in QoR model readonly?", "body": "<p>That particular error is being caused by <code>qor</code> not finding a template file at <code>.../metas/form/Etag.tmpl</code>, which is presumably needed to actually render the <code>Etag</code> to the form.  (You can make the template render a readonly/static element rather than an input)</p>\n"}, {"tags": [], "owner": {"reputation": 1810, "user_id": 875879, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/686e1bd47adfe2328fc85d06eff6cdcb?s=128&d=identicon&r=PG", "display_name": "Sandip Agarwal", "link": "https://stackoverflow.com/users/875879/sandip-agarwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1553695832, "creation_date": 1553695832, "answer_id": 55379323, "question_id": 43597796, "link": "https://stackoverflow.com/questions/43597796/how-to-make-fields-in-qor-model-readonly/55379323#55379323", "title": "How to make fields in QoR model readonly?", "body": "<p><code>EpgResource.Meta(&amp;admin.Meta{Name: \"Etag\", Type: \"Readonly\"})</code> would work only on darwin (Mac) machines. But, not on linux machines.</p>\n\n<p>Do the following:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>EpgResource.Meta(&amp;admin.Meta{Name: \"Etag\", Type: \"readonly\"})\n</code></pre>\n\n<p>I hope this helps.</p>\n\n<p>Reference: <a href=\"https://doc.getqor.com/admin/metas/hidden-readonly.html#readonly\" rel=\"nofollow noreferrer\">https://doc.getqor.com/admin/metas/hidden-readonly.html#readonly</a></p>\n"}], "owner": {"reputation": 841, "user_id": 5505164, "user_type": "registered", "profile_image": "https://graph.facebook.com/1483647971940832/picture?type=large", "display_name": "Roman Shishkin", "link": "https://stackoverflow.com/users/5505164/roman-shishkin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1553695832, "creation_date": 1493068308, "last_edit_date": 1493076582, "question_id": 43597796, "link": "https://stackoverflow.com/questions/43597796/how-to-make-fields-in-qor-model-readonly", "title": "How to make fields in QoR model readonly?", "body": "<p>I have a data model:</p>\n\n<pre><code>type Epg struct {\n    gorm.Model\n    Uri     string `gorm:\";not null;unique\"`\n    Prefix  string `gorm:\"size:64;not null;default:''\"`\n    Etag    string\n    Updated time.Time\n    Status  bool `gorm:\"default:true\"`\n}\n</code></pre>\n\n<p>I publish this data model in menu: </p>\n\n<pre><code>EpgResource := Admin.AddResource(&amp;models.Epg{}, &amp;admin.Config{Menu: []string{\"Content\"}})\n</code></pre>\n\n<p>Now I can view and edit data via QoR Admin panel. But I want to make values <code>Etag</code>, <code>Updated</code>, <code>Status</code> to be readonly because they are updated by the system.</p>\n\n<p>If I try to make this fields readonly according <a href=\"https://doc.getqor.com/metas/hidden-readonly.html\" rel=\"nofollow noreferrer\">documentation</a>:</p>\n\n<pre><code>EpgResource.Meta(&amp;admin.Meta{Name: \"Etag\", Type: \"Readonly\"})\n</code></pre>\n\n<p>I got an error. Is it possible to make some fields in data model visible but readonly? How to do that?</p>\n\n<p>Error log trace.</p>\n\n<blockquote>\n  <p>2017/04/25 01:16:04 Finish [GET] /admin/epgs Took 19.59ms\n  /usr/local/go/src/text/template/exec.go:433\n  /usr/local/go/src/text/template/exec.go:536\n  /usr/local/go/src/text/template/exec.go:668\n  /usr/local/go/src/reflect/value.go:302\n  /usr/local/go/src/reflect/value.go:434\n  /usr/local/go/src/runtime/asm_amd64.s:515\n  /home/rns/golang/src/github.com/qor/admin/func_map.go:1051\n  /home/rns/golang/src/github.com/qor/admin/func_map.go:220\n  /home/rns/golang/src/github.com/qor/admin/func_map.go:236\n  /home/rns/golang/src/github.com/qor/admin/func_map.go:393\n  got error when render form template for Etag(Readonly): haven't found form\n  template for meta Etag</p>\n</blockquote>\n"}, {"tags": ["go", "data-structures"], "comments": [{"owner": {"reputation": 49, "user_id": 7915059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c09ae2684fc2fbdf3138fa900983f470?s=128&d=identicon&r=PG&f=1", "display_name": "user7915059", "link": "https://stackoverflow.com/users/7915059/user7915059"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1493065572, "post_id": 43596681, "comment_id": 74244486, "body": "gateNor is a function that is meant to evaluate the logical gate NOR function for the two inputs of A and B for a given gate struct. I have already created the a functioning gateNor function - full code available in the link to play.golang.org is working apart from my understanding/lack of knowledge in how to do this with structs and to create a better data structure to enable this to expand further."}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": false, "score": 1, "last_activity_date": 1493065944, "creation_date": 1493065944, "answer_id": 43597213, "question_id": 43596681, "link": "https://stackoverflow.com/questions/43596681/how-to-append-a-function-call-to-a-golang-struct/43597213#43597213", "title": "How to append a function call to a golang struct?", "body": "<p>You can't refer to the members of Gate within the object-initializer; you could do something like:</p>\n\n<pre><code>inputA, inputB := \"1\", \"1\"\ngate3 := &amp;Gate{\n    Id:      \"U3\",\n    Funct:   \"NOR\",\n    InputA:  inputA,\n    InputB:  inputB,\n    OutputY: gateNor(inputA,inputB),\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1493074488, "last_edit_date": 1493074488, "creation_date": 1493066057, "answer_id": 43597234, "question_id": 43596681, "link": "https://stackoverflow.com/questions/43596681/how-to-append-a-function-call-to-a-golang-struct/43597234#43597234", "title": "How to append a function call to a golang struct?", "body": "<p>For example,</p>\n\n<pre><code>gate0 := &amp;Gate{\n    Id:     \"U0\",\n    Funct:  \"NOR\",\n    InputA: \"0\",\n    InputB: \"0\",\n}\ngate0.OutputY = gateNor(gate0.InputA, gate0.InputB)\n</code></pre>\n\n<p>Or, more elegantly,</p>\n\n<pre><code>func NewNORGate(id, a, b string) *Gate {\n    gate := &amp;Gate{\n        Id:     id,\n        Funct:  \"NOR\",\n        InputA: a,\n        InputB: b,\n    }\n    gate.OutputY = gateNor(gate.InputA, gate.InputB)\n    return gate\n}\n\nfunc main() {\n    gate0 := NewNORGate(\"U0\", \"0\", \"0\")\n    gate1 := NewNORGate(\"U1\", \"0\", \"1\")\n    gate2 := NewNORGate(\"U2\", \"1\", \"0\")\n    gate3 := NewNORGate(\"U3\", \"1\", \"1\")\n\n    GetEvaluation(gate0)\n    GetEvaluation(gate1)\n    GetEvaluation(gate2)\n    GetEvaluation(gate3)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/WC-jlV-jqd\" rel=\"nofollow noreferrer\">https://play.golang.org/p/WC-jlV-jqd</a></p>\n\n<p>Or, most elegantly,</p>\n\n<pre><code>func NewNORGate(id, a, b string) *Gate {\n    gate := &amp;Gate{\n        Id:     id,\n        Funct:  \"NOR\",\n        InputA: a,\n        InputB: b,\n    }\n    gate.OutputY = gateNor(gate.InputA, gate.InputB)\n    return gate\n}\n\nfunc main() {\n    GetEvaluation(NewNORGate(\"U0\", \"0\", \"0\"))\n    GetEvaluation(NewNORGate(\"U1\", \"0\", \"1\"))\n    GetEvaluation(NewNORGate(\"U2\", \"1\", \"0\"))\n    GetEvaluation(NewNORGate(\"U3\", \"1\", \"1\"))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/TOPuwSJ-xe\" rel=\"nofollow noreferrer\">https://play.golang.org/p/TOPuwSJ-xe</a></p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 1, "last_activity_date": 1493143071, "creation_date": 1493143071, "answer_id": 43617847, "question_id": 43596681, "link": "https://stackoverflow.com/questions/43596681/how-to-append-a-function-call-to-a-golang-struct/43617847#43617847", "title": "How to append a function call to a golang struct?", "body": "<p>Maybe not too elegant, but I'd rather define a method </p>\n\n<blockquote>\n  <p>to append a function call to a golang struct</p>\n</blockquote>\n\n<pre><code>type Gate struct {\n   Id      string\n   Funct   string\n   InputA  string\n   InputB  string\n}\nfunc (g Gate) OutputY()string{\n   return gateNor(g.InputA, g.InputB)\n}\n</code></pre>\n\n<p>and have</p>\n\n<pre><code>g.OutputY()\n</code></pre>\n\n<p>lazily on demand. <code>g.OutputY()</code> not much more verbose then <code>g.OutputY</code> and laziness can matter in case of hard computation. Also on demand you get consistent value of <code>g.OutputY()</code>. How another way you assume maintain <code>g.Output</code> after changing say <code>g.InputA=\"1\"</code> ?</p>\n"}], "owner": {"reputation": 49, "user_id": 7915059, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c09ae2684fc2fbdf3138fa900983f470?s=128&d=identicon&r=PG&f=1", "display_name": "user7915059", "link": "https://stackoverflow.com/users/7915059/user7915059"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 587, "favorite_count": 1, "answer_count": 3, "score": 4, "last_activity_date": 1493143071, "creation_date": 1493063837, "last_edit_date": 1493131022, "question_id": 43596681, "link": "https://stackoverflow.com/questions/43596681/how-to-append-a-function-call-to-a-golang-struct", "title": "How to append a function call to a golang struct?", "body": "<p>I have the following go code which I was wanting get interfaces working:</p>\n\n<p><a href=\"https://play.golang.org/p/A29etweYN_\" rel=\"nofollow noreferrer\">https://play.golang.org/p/A29etweYN_</a></p>\n\n<p>to provide the following output:</p>\n\n<pre><code>Gate: Evaluation ID U0 NOR true 0 0\nGate: Evaluation ID U1 NOR false 0 1\nGate: Evaluation ID U2 NOR false 1 0\nGate: Evaluation ID U3 NOR false 1 1\n</code></pre>\n\n<p>I am finding it difficult to understand why the commented out line </p>\n\n<pre><code>//OutputY: gateNor(InputA,InputB) \n</code></pre>\n\n<p>does not work - gateNor is a function which I want to call and append to the Gate struct</p>\n\n<p>What would be a more elegant way to implement this?</p>\n\n<pre><code>type Gate struct {\n   Id      string\n   Funct   string\n   InputA  string\n   InputB  string\n   OutputY string\n}\n\nfunc (g *Gate) Notify() error {\n    fmt.Printf(\"Gate: Evaluation ID %s %s %s %s %s\\n\",\n        g.Id,\n        g.Funct,\n        g.OutputY,\n        g.InputA,\n        g.InputB,\n    )\n    return nil\n}\n\ngate0 := &amp;Gate{\n    Id:      \"U0\",\n    Funct:   \"NOR\",\n    InputA:  \"0\",\n    InputB:  \"0\",\n    OutputY: gateNor(\"0\", \"0\"),\n    //OutputY: gateNor(InputA,InputB),\n}\n</code></pre>\n\n<p>gateNor returns the string true for input A=0 and InputB = 0,\nfor the gate0 (ID U0) struct following output is working:</p>\n\n<pre><code>Gate: Evaluation ID U0 NOR true 0 0\n</code></pre>\n"}, {"tags": ["java", "go", "synchronization"], "comments": [{"owner": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "edited": false, "score": 0, "creation_date": 1493062199, "post_id": 43596253, "comment_id": 74242560, "body": "I think you mean SynchronousQueue which passes from one thread to another without buffering. Generally you are better off starting with Parallel Streams to use multiple threads if you can in Java 8."}, {"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "reply_to_user": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "edited": false, "score": 1, "creation_date": 1493062677, "post_id": 43596253, "comment_id": 74242829, "body": "@PeterLawrey Thanks. My interest is academic. I don&#39;t want to use the queue -- I want to understand how it&#39;s implemented. Now that you&#39;ve given me the right terminology, I&#39;ll look it up."}, {"owner": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "edited": false, "score": 0, "creation_date": 1493062824, "post_id": 43596253, "comment_id": 74242892, "body": "You should be able to read it&#39;s source. Note: a synchronous queue is pretty simple as it doesn&#39;t store anything."}, {"owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "reply_to_user": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "edited": false, "score": 0, "creation_date": 1493063459, "post_id": 43596253, "comment_id": 74243264, "body": "@PeterLawrey I know you already have plenty of reputation, but would you like to give the answer? <a href=\"http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/6-b14/java/util/concurrent/SynchronousQueue.java\" rel=\"nofollow noreferrer\">grepcode.com/file/repository.grepcode.com/java/root/jdk/open&zwnj;&#8203;jdk/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 496316, "user_id": 57695, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/53ee9941b3fefef67175daf212e62d41?s=128&d=identicon&r=PG", "display_name": "Peter Lawrey", "link": "https://stackoverflow.com/users/57695/peter-lawrey"}, "is_accepted": true, "score": 1, "last_activity_date": 1493064959, "creation_date": 1493064959, "answer_id": 43596987, "question_id": 43596253, "link": "https://stackoverflow.com/questions/43596253/how-would-i-implement-gos-unbuffered-channels-in-java/43596987#43596987", "title": "How would I implement Go&#39;s unbuffered channels in Java?", "body": "<p>In Java you can use a <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/concurrent/SynchronousQueue.html\" rel=\"nofollow noreferrer\">SynchronousQueue</a>, the source for Java 8 is here</p>\n\n<p><a href=\"http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/concurrent/SynchronousQueue.java?av=f\" rel=\"nofollow noreferrer\">http://grepcode.com/file/repository.grepcode.com/java/root/jdk/openjdk/8u40-b25/java/util/concurrent/SynchronousQueue.java?av=f</a></p>\n"}, {"tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1493132182, "last_edit_date": 1495542848, "creation_date": 1493131824, "answer_id": 43614053, "question_id": 43596253, "link": "https://stackoverflow.com/questions/43596253/how-would-i-implement-gos-unbuffered-channels-in-java/43614053#43614053", "title": "How would I implement Go&#39;s unbuffered channels in Java?", "body": "<p>I suggest you also look into the <a href=\"http://www.cs.kent.ac.uk/projects/ofa/jcsp/\" rel=\"nofollow noreferrer\"><strong>JCSP</strong></a> library. There are further details of JCSP in <a href=\"https://stackoverflow.com/questions/22561110/equivalent-of-golang-channel-in-java/22575554#22575554\">this answer</a>.</p>\n\n<p>Java does not have anything that is equivalent to Goroutines, alas. (Once, there were 'Green Threads' long ago, but they were abandoned). So if you use threads instead, you will endure a heavy memory footprint as soon as the number of threads starts getting interesting (e.g. more than ten thousand). Every Java thread requires an operating system thread and a large stack space.</p>\n"}], "owner": {"reputation": 5825, "user_id": 631051, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/88a9701bb32b465a3b8357a2aa092815?s=128&d=identicon&r=PG", "display_name": "Ellen Spertus", "link": "https://stackoverflow.com/users/631051/ellen-spertus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 194, "favorite_count": 0, "accepted_answer_id": 43596987, "answer_count": 2, "score": 0, "last_activity_date": 1493132182, "creation_date": 1493062085, "question_id": 43596253, "link": "https://stackoverflow.com/questions/43596253/how-would-i-implement-gos-unbuffered-channels-in-java", "title": "How would I implement Go&#39;s unbuffered channels in Java?", "body": "<p>Go offers both <a href=\"https://www.goinggo.net/2014/02/the-nature-of-channels-in-go.html\" rel=\"nofollow noreferrer\">unbuffered and buffered channels</a> for communication among goroutines (threads). It is <a href=\"http://www.cs.odu.edu/~cs471w/code/oscj8e-final-src/ch6/java-synchronization/boundedbuffer/BoundedBuffer.java\" rel=\"nofollow noreferrer\">straightforward</a> to implement buffered channels as bounded buffers in Java. </p>\n\n<p>Go's unbuffered channels require one goroutine to be sending when the other goroutine is receiving. Can anyone explain to me how to implement that in Java?</p>\n"}, {"tags": ["go", "amazon-s3", "aws-sdk-go"], "answers": [{"comments": [{"owner": {"reputation": 836, "user_id": 3165535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f693f2c6c6f0a65f824bb6ff36edfb04?s=128&d=identicon&r=PG", "display_name": "xxorde", "link": "https://stackoverflow.com/users/3165535/xxorde"}, "edited": false, "score": 0, "creation_date": 1493301213, "post_id": 43599414, "comment_id": 74366863, "body": "Thank you very much. I did some testing and get a constant memory usage of ~500MB no matter if I store 5GB or 25GB of data. This is far from perfect, but acceptable. :)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 836, "user_id": 3165535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f693f2c6c6f0a65f824bb6ff36edfb04?s=128&d=identicon&r=PG", "display_name": "xxorde", "link": "https://stackoverflow.com/users/3165535/xxorde"}, "edited": false, "score": 0, "creation_date": 1493301758, "post_id": 43599414, "comment_id": 74367255, "body": "I&#39;m glad I could help. What part size are you using and how many concurrent uploads are you allowing?"}, {"owner": {"reputation": 836, "user_id": 3165535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f693f2c6c6f0a65f824bb6ff36edfb04?s=128&d=identicon&r=PG", "display_name": "xxorde", "link": "https://stackoverflow.com/users/3165535/xxorde"}, "edited": false, "score": 0, "creation_date": 1493302537, "post_id": 43599414, "comment_id": 74367819, "body": "I did not explicit set concurrent uploads and used your 20MB as PartSize. I just tried 256MB and it consumes ~2.1 GB memory. With PartSize =  5MB it consumes 132MB. I start to see a pattern here ;)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 836, "user_id": 3165535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f693f2c6c6f0a65f824bb6ff36edfb04?s=128&d=identicon&r=PG", "display_name": "xxorde", "link": "https://stackoverflow.com/users/3165535/xxorde"}, "edited": false, "score": 0, "creation_date": 1493302899, "post_id": 43599414, "comment_id": 74368079, "body": "By default i think it does 5 concurrent uploads so at 20mb per part it should be 100mb? and at 256mb it should 1.2gb? but that&#39;s me assuming that nothing else is consuming memory..."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 7, "last_activity_date": 1493078101, "creation_date": 1493078101, "answer_id": 43599414, "question_id": 43595911, "link": "https://stackoverflow.com/questions/43595911/how-to-save-data-streams-in-s3-aws-sdk-go-example-not-working/43599414#43599414", "title": "How to save data streams in S3? aws-sdk-go example not working?", "body": "<p>You can use the sdk's <a href=\"http://docs.aws.amazon.com/sdk-for-go/api/service/s3/s3manager/#Uploader\" rel=\"noreferrer\">Uploader</a> to handle uploads of unknown size but you'll need to make the <code>os.Stdin</code> \"unseekable\" by wrapping it into an <code>io.Reader</code>. This is because the <code>Uploader</code>, while it requires only an <code>io.Reader</code> as the input body, under the hood it does a check to see whether the input body is also a <code>Seeker</code> and if it is, it does call <code>Seek</code> on it. And since <code>os.Stdin</code> is just an <code>*os.File</code> which implements the <code>Seeker</code> interface, by default, you would get the same error you got from <code>PutObjectWithContext</code>.</p>\n\n<p>The <code>Uploader</code> also allows you to upload the data in chunks whose size you can configure and you can also configure how many of those chunks should be uploaded concurrently.</p>\n\n<p>Here's a modified version of the linked example, stripped off of code that can remain unchanged.</p>\n\n<pre><code>package main\n\nimport (\n    // ...\n    \"io\"\n    \"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n)\n\ntype reader struct {\n    r io.Reader\n}\n\nfunc (r *reader) Read(p []byte) (int, error) {\n    return r.r.Read(p)\n}\n\nfunc main() {\n    // ... parse flags\n\n    sess := session.Must(session.NewSession())\n    uploader := s3manager.NewUploader(sess, func(u *s3manager.Uploader) {\n        u.PartSize = 20 &lt;&lt; 20 // 20MB\n        // ... more configuration\n    })\n\n    // ... context stuff\n\n    _, err := uploader.UploadWithContext(ctx, &amp;s3manager.UploadInput{\n        Bucket: aws.String(bucket),\n        Key:    aws.String(key),\n        Body:   &amp;reader{os.Stdin},\n    })\n\n    // ... handle error\n}\n</code></pre>\n\n<p>As to whether this is a better solution than <code>minio-go</code> I do not know, you'll have to test that yourself.</p>\n"}], "owner": {"reputation": 836, "user_id": 3165535, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f693f2c6c6f0a65f824bb6ff36edfb04?s=128&d=identicon&r=PG", "display_name": "xxorde", "link": "https://stackoverflow.com/users/3165535/xxorde"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2223, "favorite_count": 2, "accepted_answer_id": 43599414, "answer_count": 1, "score": 6, "last_activity_date": 1493078101, "creation_date": 1493060780, "last_edit_date": 1493067243, "question_id": 43595911, "link": "https://stackoverflow.com/questions/43595911/how-to-save-data-streams-in-s3-aws-sdk-go-example-not-working", "title": "How to save data streams in S3? aws-sdk-go example not working?", "body": "<p>I am trying to persist a given stream of data to an S3 compatible storage.\nThe size is not known before the stream ends and can vary from 5MB to ~500GB.</p>\n\n<p>I tried different possibilities but did not find a better solution than to implement sharding myself. My best guess is to make a buffer of a fixed size fill it with my stream and write it to the S3.\nIs there a better solution? Maybe a way where this is transparent to me, without writing the whole stream to memory?</p>\n\n<p>The aws-sdk-go readme has an example programm that takes data from stdin and writes it to S3: <a href=\"https://github.com/aws/aws-sdk-go#using-the-go-sdk\" rel=\"noreferrer\">https://github.com/aws/aws-sdk-go#using-the-go-sdk</a></p>\n\n<p>When I try to pipe data in with a pipe <code>|</code> I get the following error:\n<code>\nfailed to upload object, SerializationError: failed to compute request body size\ncaused by: seek /dev/stdin: illegal seek\n</code>\nAm I doing something wrong or is the example not working as I expect it to?</p>\n\n<p>I although tried minio-go, with <a href=\"https://github.com/xxorde/minio-steam-to-s3/blob/018b08b15b35ce528abc9af621bef28490fff67e/main.go\" rel=\"noreferrer\">PutObject()</a> or <a href=\"https://github.com/xxorde/minio-steam-to-s3/blob/e74829acddc8f8693efc54da2d8d086d1a5e8a3f/main.go\" rel=\"noreferrer\">client.PutObjectStreaming()</a>.\nThis is functional but consumes as much memory as the data to store.</p>\n\n<ol>\n<li>Is there a better solution?</li>\n<li>Is there a small example program that can pipe arbitrary data into S3?</li>\n</ol>\n"}, {"tags": ["go", "amazon-s3"], "comments": [{"owner": {"reputation": 1585, "user_id": 2987497, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tg541.png?s=128&g=1", "display_name": "Henrique dos Santos Goulart", "link": "https://stackoverflow.com/users/2987497/henrique-dos-santos-goulart"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493048246, "post_id": 43592034, "comment_id": 74234231, "body": "@Flimzy I added full code including comments now. No, i don&#39;t have any other deffered statements. I tried to add <code>defer gzipReader.Close()</code> after error checking but still doesn&#39;t working."}, {"owner": {"reputation": 1585, "user_id": 2987497, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tg541.png?s=128&g=1", "display_name": "Henrique dos Santos Goulart", "link": "https://stackoverflow.com/users/2987497/henrique-dos-santos-goulart"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493048534, "post_id": 43592034, "comment_id": 74234448, "body": "@Flimzy my bad. It was saying that the problematic line was <code>gzip.NewReader(...)</code>. I tried to defer but still not working"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493048827, "post_id": 43592034, "comment_id": 74234646, "body": "So what is the meaning of <code>&#47;&#47; line 28</code> at the end of your first code snippet?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1493048890, "post_id": 43592034, "comment_id": 74234690, "body": "if <code>gzip.NewReader()</code> is giving an <code>invalid memory address or nil pointer dereference</code> error, it probably means that <code>resp</code> or <code>resp.Body</code> are nil."}, {"owner": {"reputation": 1585, "user_id": 2987497, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tg541.png?s=128&g=1", "display_name": "Henrique dos Santos Goulart", "link": "https://stackoverflow.com/users/2987497/henrique-dos-santos-goulart"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493052946, "post_id": 43592034, "comment_id": 74237249, "body": "Fixed <code>&#47;&#47; line 28</code> on wrong line"}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 1, "creation_date": 1493088355, "post_id": 43592034, "comment_id": 74251379, "body": "Put the line <code>defer cancelFn()</code> inside the if, currently cancelFn() is not set if the timeout is 0, that provokes\u200b a null pointer when the defer is executed."}, {"owner": {"reputation": 1585, "user_id": 2987497, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tg541.png?s=128&g=1", "display_name": "Henrique dos Santos Goulart", "link": "https://stackoverflow.com/users/2987497/henrique-dos-santos-goulart"}, "reply_to_user": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1493127849, "post_id": 43592034, "comment_id": 74273730, "body": "oohh thank you @Motakjuq!! It works! Post an answer and I will accept. This example is a copy/past from AWS SKD for GO. So, probably another people will have the same issue. Copy from: <a href=\"https://github.com/aws/aws-sdk-go\" rel=\"nofollow noreferrer\">github.com/aws/aws-sdk-go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "is_accepted": true, "score": 0, "last_activity_date": 1493281539, "creation_date": 1493281539, "answer_id": 43652459, "question_id": 43592034, "link": "https://stackoverflow.com/questions/43592034/golang-io-reading-file-invalid-memory-address/43652459#43652459", "title": "Golang IO reading file invalid memory address", "body": "<p>The problem is related with the <code>defer cancelFn()</code>, currently that func is not set if the timeout is 0, this provoke a panic with a null pointer, so, you should move the <code>defer</code> inside of the previous if statement because it's the only point when is required to be used. The code of <code>aws/s3.go</code> have to be as the following.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>...\n// Create a context with a timeout that will abort the download if it takes\n// more than the passed in timeout.\nctx := context.Background()\nvar cancelFn func()\nif timeout &gt; 0 {\n    ctx, cancelFn = context.WithTimeout(ctx, timeout)\n    // Ensure the context is canceled to prevent leaking.\n    // See context package for more information, https://golang.org/pkg/context/\n    defer cancelFn()\n}\n...\n</code></pre>\n"}], "owner": {"reputation": 1585, "user_id": 2987497, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/tg541.png?s=128&g=1", "display_name": "Henrique dos Santos Goulart", "link": "https://stackoverflow.com/users/2987497/henrique-dos-santos-goulart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 496, "favorite_count": 0, "accepted_answer_id": 43652459, "answer_count": 1, "score": 1, "last_activity_date": 1493281539, "creation_date": 1493047516, "last_edit_date": 1493052897, "question_id": 43592034, "link": "https://stackoverflow.com/questions/43592034/golang-io-reading-file-invalid-memory-address", "title": "Golang IO reading file invalid memory address", "body": "<p>I'm having some troubles trying to read a GZIP file from AWS S3.\nI have only a simple code and I'm getting the error <code>panic: runtime error: invalid memory address or nil pointer dereference</code>. But it still hard to find the problem. </p>\n\n<p>The error message is saying that is the <code>gzip.NewReader...</code>. Why <code>golang</code> is reporting it? How could i solve it?</p>\n\n<pre><code>goroutine 1 [running]:\ngithub.com/hensg/pushego/aws.GetGZIPProductsDump(0x7ffead44098f, 0xc, 0x7ffead44099f, 0x2f, 0x0, 0xc420190580, 0x0, 0x0)\n        /home/henrique/go/src/github.com/hensg/pushego/aws/s3.go:47 +0x2e7\nmain.main()\n        /home/henrique/go/src/github.com/hensg/pushego/pushego.go:28 +0x249\n</code></pre>\n\n<p>Main code (pushego.go)\n    </p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"flag\"\n    \"log\"\n    \"os\"\n    \"time\"\n\n    \"github.com/hensg/pushego/aws\"\n)\n\nfunc init() {\n    log.SetOutput(os.Stdout)\n}\n\nfunc main() {\n    log.Println(\"Starting...\")\n\n    var bucket, key string\n    var timeout time.Duration\n\n    flag.StringVar(&amp;bucket, \"b\", \"\", \"Bucket name\")\n    flag.StringVar(&amp;key, \"k\", \"\", \"Object key name\")\n    flag.DurationVar(&amp;timeout, \"d\", 0, \"Download timeout\")\n    flag.Parse()\n\n    gzipReader, err := aws.GetGZIPDump(bucket, key, timeout) // line 28\n    if err != nil {\n        log.Fatal(\"Failed to create GZIP reader\")\n    }\n   defer gzipReader.Close()\n\n    scanner := bufio.NewScanner(gzipReader)\n    for scanner.Scan() {\n        log.Printf(\"Read: %s\\n\", scanner.Text())\n    }\n\n    log.Printf(\"Successfully download file from %s/%s\\n\", bucket, key)\n}\n</code></pre>\n\n<p>Aws code (aws/s3.go)\n    </p>\n\n<pre><code>package aws\n\nimport (\n    \"compress/gzip\"\n    \"context\"\n    \"log\"\n    \"time\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/awserr\"\n    \"github.com/aws/aws-sdk-go/aws/request\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/s3\"\n)\n\nfunc GetGZIPProductsDump(bucket, key string, timeout time.Duration) (*gzip.Reader, error) {\n    sess := session.Must(session.NewSession())\n    svc := s3.New(sess)\n\n    // Create a context with a timeout that will abort the download if it takes\n    // more than the passed in timeout.\n    ctx := context.Background()\n    var cancelFn func()\n    if timeout &gt; 0 {\n        ctx, cancelFn = context.WithTimeout(ctx, timeout)\n    }\n    // Ensure the context is canceled to prevent leaking.\n    // See context package for more information, https://golang.org/pkg/context/\n    defer cancelFn()\n\n    // Uploads the object to S3. The Context will interrupt the request if the\n    // timeout expires.\n    resp, err := svc.GetObjectWithContext(ctx, &amp;s3.GetObjectInput{\n        Bucket: aws.String(bucket),\n        Key:    aws.String(key),\n    })\n    if err != nil {\n        if aerr, ok := err.(awserr.Error); ok &amp;&amp; aerr.Code() == request.CanceledErrorCode {\n            // If the SDK can determine the request or retry delay was canceled\n            // by a context the CanceledErrorCode error code will be returned.\n            log.Fatal(\"Download canceled due to timeout, %v\\n\", err)\n        } else {\n            log.Fatal(\"Failed to download object, %v\\n\", err)\n        }\n    }\n\n    return gzip.NewReader(resp.Body) // line 47\n}\n</code></pre>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 0, "creation_date": 1493236600, "post_id": 43641355, "comment_id": 74335156, "body": "I attempted to do what you suggested and it didn&#39;t work. I added my attempt to the OP."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "edited": false, "score": 1, "creation_date": 1493237409, "post_id": 43641355, "comment_id": 74335612, "body": "@BryanWheelock You just moved the SDK into your go source folder. It goes in your home directory one level up. It should be in <code>~&#47;google-cloud-sdk</code> Leave your <code>$GOPATH</code> set to <code>$HOME&#47;go</code> unless your sources are all in the <code>work&#47;gocode</code> directory you mentioned, then use that, though I&#39;m pretty sure you want <code>$HOME&#47;go</code>. Also, your project has to be placed in your $GOPATH/src` directory."}], "tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 7, "last_activity_date": 1493239956, "last_edit_date": 1493239956, "creation_date": 1493229427, "answer_id": 43641355, "question_id": 43591772, "link": "https://stackoverflow.com/questions/43591772/where-does-go-look-for-google-cloud-sdk-what-should-gopath-be/43641355#43641355", "title": "Where does GO look for google-cloud-sdk ? What should GOPATH be?", "body": "<p>It goes in neither $GOROOT or $GOPATH. Just unpack it to your $HOME directory and run the installer. If necessary, add it to your $PATH by adding this line to your <code>.bash_profile</code>.</p>\n\n<pre><code>export PATH=$HOME/google-cloud-sdk:$PATH\n</code></pre>\n\n<p>Make sure you grab the golang SDK as well with <code>gcloud components install app-engine-go</code> <a href=\"https://cloud.google.com/appengine/docs/standard/go/download\" rel=\"noreferrer\">https://cloud.google.com/appengine/docs/standard/go/download</a></p>\n\n<p>DO NOT change your path to include the src dir in <code>google-cloud-sdk/platform/google_appengine/goroot/src</code>. That will break things. You leave your $GOPATH to be your normal installation. Using the App Engine SDK for Go automatically uses the sources in that dir without any manipulation.</p>\n\n<p>Also, you should NEVER MANUALLY change $GOROOT unless you plan on compiling a new Go version from source (as in a new version of the language). It will automatically set the proper $GOROOT for you. <a href=\"https://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really\" rel=\"noreferrer\">https://dave.cheney.net/2013/06/14/you-dont-need-to-set-goroot-really</a></p>\n\n<p>If your install is messed up beyond reason (happened to me once), just remove the cloud SDK and any references to it in your $PATH. Also completely uninstall the regular Go installation. Then start from scratch. Install Go, unpack google-cloud-sdk, run installer (add to $PATH if needed), <code>gcloud components install app-engine-go</code>. Voila.</p>\n\n<p>When developing for App Engine, your go sources go into your REGULAR $GOPATH. They DO NOT go in <code>google-cloud-sdk/...</code> anywhere. To run the dev_appserver locally, run <code>dev_appserver.py [path-to-source]</code> where the given path contains your code and the app.yaml. I usually <code>cd</code> in to my project path (e.g. <code>cd $HOME/go/src/myproject</code>) and run with <code>dev_appserver.py ./</code>. <a href=\"https://cloud.google.com/appengine/docs/standard/go/tools/using-local-server\" rel=\"noreferrer\">https://cloud.google.com/appengine/docs/standard/go/tools/using-local-server</a></p>\n\n<p>Deployment is covered here. <a href=\"https://cloud.google.com/appengine/docs/standard/go/tools/uploadinganapp\" rel=\"noreferrer\">https://cloud.google.com/appengine/docs/standard/go/tools/uploadinganapp</a></p>\n\n<p>EDIT: Folder structure.</p>\n\n<p>$GOPATH = $HOME/go</p>\n\n<p><a href=\"https://i.stack.imgur.com/17FNR.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/17FNR.png\" alt=\"enter image description here\"></a></p>\n\n<p>Location for google-cloud-sdk folder</p>\n\n<p><a href=\"https://i.stack.imgur.com/ixmEx.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/ixmEx.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 11316, "user_id": 86731, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/876564dd7625975a8e9029fde0b48af0?s=128&d=identicon&r=PG", "display_name": "BryanWheelock", "link": "https://stackoverflow.com/users/86731/bryanwheelock"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1657, "favorite_count": 4, "accepted_answer_id": 43641355, "answer_count": 1, "score": 13, "last_activity_date": 1493239956, "creation_date": 1493046732, "last_edit_date": 1495540943, "question_id": 43591772, "link": "https://stackoverflow.com/questions/43591772/where-does-go-look-for-google-cloud-sdk-what-should-gopath-be", "title": "Where does GO look for google-cloud-sdk ? What should GOPATH be?", "body": "<p>I'm having trouble setting up Go App engine on osX. Should the google-cloud-sdk path be in GOROOT or GOPATH?</p>\n\n<p>I put the google-cloud-sdk in /usr/local</p>\n\n<p>It looks like there is source code in:  goroot/</p>\n\n<pre><code>/usr/local/google-cloud-sdk/platform/google_appengine/goroot/\n</code></pre>\n\n<p>go env  </p>\n\n<pre><code>GOPATH=\"/usr/local/google-cloud-sdk/platform/google_appengine/goroot\"  \nGORACE=\"\"  \nGOROOT=\"/usr/local/go\"  \nGOTOOLDIR=\"/usr/local/go/pkg/tool/darwin_amd64\" \n</code></pre>\n\n<p>$ go get</p>\n\n<pre><code>package google.golang.org/appengine: cannot download, /usr/local/google-cloud-sdk/platform/google_appengine/goroot is a GOROOT, not a GOPATH. For more details see: 'go help gopath'   \npackage google.golang.org/appengine/datastore: cannot download, /usr/local/google-cloud-sdk/platform/google_appengine/goroot is a GOROOT, not a GOPATH. For more details see: 'go help gopath'  \n</code></pre>\n\n<p>When I attempted to change the PATH to include /src:  </p>\n\n<pre><code>GOPATH=\"/usr/local/google-cloud-sdk/platform/google_appengine/goroot/src\"  \n</code></pre>\n\n<p>$ go get   </p>\n\n<pre><code>package google.golang.org/appengine: mkdir /usr/local/google-cloud-sdk/platform/google_appengine/goroot/src/src: permission denied  \npackage google.golang.org/appengine/datastore: cannot find package \"google.golang.org/appengine/datastore\" in any of:  \n    /usr/local/go/src/google.golang.org/appengine/datastore (from $GOROOT)  \n    /usr/local/google-cloud-sdk/platform/google_appengine/goroot/src/src/google.golang.org/appengine/datastore (from $GOPATH)  \n</code></pre>\n\n<p>I appended the path to google-cloud-sdk to GOROOT:  </p>\n\n<pre><code>export GOROOT=\"/usr/local/go/:/usr/local/google-cloud-sdk/platform/google_appengine/goroot\"\n</code></pre>\n\n<p>GO doesn't seem to like multiple paths in GOROOT:<br>\n$ go get   </p>\n\n<pre><code>go: cannot find GOROOT directory: /usr/local/go/:/usr/local/google-cloud-sdk/platform/google_appengine/goroot\n</code></pre>\n\n<p>I did run the ./install.sh script after I copied the source to /usr/local</p>\n\n<p>The additional PATH's added did not fix the errors I was having.</p>\n\n<p>I saw this answer: <a href=\"https://stackoverflow.com/questions/11286534/test-cases-for-go-and-appengine\">Test cases for go and appengine</a> </p>\n\n<p>But it's from 5 years ago and it seems clunky/hacky. It would seem in 5 years there would be a more elegant solution that copying individual directories and creating symlinks.</p>\n\n<p>EDIT **********************<br>\n <code>mv /usr/local/google-cloud-sdk/ ~/go/</code>  then deleted GOPATH and GOROOT from .bash_profile</p>\n\n<p>I then ran ./install.sh </p>\n\n<p>I attempted to run 'go get':</p>\n\n<p>$ go get  </p>\n\n<pre><code>go install: no install location for directory /Users/Bryan/work/gocode/skincarereview outside GOPATH\n</code></pre>\n\n<p>Since that failed, I added the path to the working directory of code AND appended the path to google-cloud-sdk to PATH:  </p>\n\n<pre><code>export GOPATH = \"/Users/Bryan/work/gocode/skincarereview\"\nexport PATH=$HOME/google-cloud-sdk:$PATH\n</code></pre>\n\n<p><code>go get</code> get failed with the same message:</p>\n\n<pre><code>$ go get  \n\ngo install: no install location for directory /Users/Bryan/work/gocode/skincarereview outside GOPATH  \n    For more details see: 'go help gopath'  \n</code></pre>\n"}, {"tags": ["pointers", "go", "system-calls", "mmap", "virtualalloc"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1493045087, "post_id": 43591047, "comment_id": 74231832, "body": "Try this <a href=\"https://github.com/golang/sys/blob/d75a52659825e75fff6158388dddc6a5b04f9ba5/unix/syscall_unix.go#L72-L80\" rel=\"nofollow noreferrer\">github.com/golang/sys/blob/&hellip;</a> (<a href=\"https://play.golang.org/p/An7jG5xl2W\" rel=\"nofollow noreferrer\">Playground example</a>)"}, {"owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493048362, "post_id": 43591047, "comment_id": 74234329, "body": "@mkopriva Wow, can&#39;t believe I missed that. Could you post that as an answer?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1493049003, "post_id": 43591047, "comment_id": 74234759, "body": "the comment is now posted as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "is_accepted": false, "score": 3, "last_activity_date": 1493045141, "creation_date": 1493045141, "answer_id": 43591208, "question_id": 43591047, "link": "https://stackoverflow.com/questions/43591047/converting-a-pointer-to-a-byte-slice/43591208#43591208", "title": "Converting a pointer to a byte slice", "body": "<p>You could use something like <code>C.GoBytes</code> (e.g. <a href=\"https://golang.org/cmd/cgo/#hdr-Go_references_to_C\" rel=\"nofollow noreferrer\">see here</a>):</p>\n\n<pre><code>// C data with explicit length to Go []byte\nfunc C.GoBytes(unsafe.Pointer, C.int) []byte\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 5, "last_activity_date": 1493048891, "creation_date": 1493048891, "answer_id": 43592538, "question_id": 43591047, "link": "https://stackoverflow.com/questions/43591047/converting-a-pointer-to-a-byte-slice/43592538#43592538", "title": "Converting a pointer to a byte slice", "body": "<p>Using the <code>unsafe</code> package you can do the same thing <code>golang.org/x/sys/unix</code> does in the <a href=\"https://github.com/golang/sys/blob/d75a52659825e75fff6158388dddc6a5b04f9ba5/unix/syscall_unix.go#L72-L80\" rel=\"noreferrer\">Mmap</a> method of its unexported <code>mmapper</code> type:</p>\n\n<pre><code>// Slice memory layout\nvar sl = struct {\n    addr uintptr\n    len  int\n    cap  int\n}{addr, length, length}\n\n// Use unsafe to turn sl into a []byte.\nb := *(*[]byte)(unsafe.Pointer(&amp;sl))\n</code></pre>\n\n<p>Here's a <a href=\"https://play.golang.org/p/An7jG5xl2W\" rel=\"noreferrer\">playground example</a>.</p>\n"}], "owner": {"reputation": 708, "user_id": 3302584, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/19cai.jpg?s=128&g=1", "display_name": "Awn", "link": "https://stackoverflow.com/users/3302584/awn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4527, "favorite_count": 1, "accepted_answer_id": 43592538, "answer_count": 2, "score": 2, "last_activity_date": 1493048891, "creation_date": 1493044747, "question_id": 43591047, "link": "https://stackoverflow.com/questions/43591047/converting-a-pointer-to-a-byte-slice", "title": "Converting a pointer to a byte slice", "body": "<p>The <code>Mmap()</code> syscall in the <code>x/sys/unix</code> <a href=\"https://godoc.org/golang.org/x/sys/unix#Mmap\" rel=\"nofollow noreferrer\">package</a> in Golang returns a <code>[]byte</code> type, while the underlying syscall actually returns a pointer. How does it do this?</p>\n\n<p>More specifically, in <a href=\"https://github.com/alexbrainman/winapi/blob/master/zsyscall_windows.go#L225\" rel=\"nofollow noreferrer\">this</a> package by a Golang developer, the <code>VirtualAlloc</code> function simply returns a pointer. How can this be converted to a byte slice, the same way as it's done in the Unix package?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1493040290, "post_id": 43589198, "comment_id": 74228042, "body": "Did you run <code>go install packagename</code>? What package are you trying to build?"}, {"owner": {"reputation": 327, "user_id": 973729, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3ff92c5bd2e63144b4216c1c8c9c7c8?s=128&d=identicon&r=PG", "display_name": "bitstore", "link": "https://stackoverflow.com/users/973729/bitstore"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493040960, "post_id": 43589198, "comment_id": 74228543, "body": "@JimB text/scanner, it&#39;s not in gopath, it&#39;s standard library in goroot"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493041965, "post_id": 43589198, "comment_id": 74229390, "body": "OK, but have you tried <code>go install text&#47;scanner</code>? That&#39;s how you install any package. (Or you can just install Go from source, and use the same procedure)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1493041999, "post_id": 43589198, "comment_id": 74229420, "body": "Read <a href=\"https://golang.org/doc/install/source\" rel=\"nofollow noreferrer\">golang.org/doc/install/source</a>"}, {"owner": {"reputation": 327, "user_id": 973729, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3ff92c5bd2e63144b4216c1c8c9c7c8?s=128&d=identicon&r=PG", "display_name": "bitstore", "link": "https://stackoverflow.com/users/973729/bitstore"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1493042484, "post_id": 43589198, "comment_id": 74229797, "body": "@JimB yes , I tried this. But not help."}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 973729, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3ff92c5bd2e63144b4216c1c8c9c7c8?s=128&d=identicon&r=PG", "display_name": "bitstore", "link": "https://stackoverflow.com/users/973729/bitstore"}, "edited": false, "score": 0, "creation_date": 1493043114, "post_id": 43590173, "comment_id": 74230292, "body": "3ks for answering, I update the question with detailed information"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 327, "user_id": 973729, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3ff92c5bd2e63144b4216c1c8c9c7c8?s=128&d=identicon&r=PG", "display_name": "bitstore", "link": "https://stackoverflow.com/users/973729/bitstore"}, "edited": false, "score": 0, "creation_date": 1493043354, "post_id": 43590173, "comment_id": 74230480, "body": "You didn&#39;t <code>touch &#47;usr&#47;local&#47;go1.8.1&#47;src&#47;text&#47;scanner&#47;scanner.go</code> before <code>go install -v text&#47;scanner</code>."}, {"owner": {"reputation": 327, "user_id": 973729, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3ff92c5bd2e63144b4216c1c8c9c7c8?s=128&d=identicon&r=PG", "display_name": "bitstore", "link": "https://stackoverflow.com/users/973729/bitstore"}, "edited": false, "score": 0, "creation_date": 1493043747, "post_id": 43590173, "comment_id": 74230793, "body": "i have touch it, but the .a file still seems not change, as i updated"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1493043008, "last_edit_date": 1493043008, "creation_date": 1493042472, "answer_id": 43590173, "question_id": 43589198, "link": "https://stackoverflow.com/questions/43589198/how-to-build-stdlib-a-file-in-golang/43590173#43590173", "title": "How to build stdlib a file in golang?", "body": "<p>The Go tools look at the source timestamps to see if installation is necessary. For example,</p>\n\n<pre><code>$ cd ~\n$ touch /home/peter/go/src/text/scanner/scanner.go\n$ go install -v text/scanner/\ntext/scanner\n$ go install -v text/scanner/\n$ \n</code></pre>\n\n<p><code>go install</code> looks in <code>$GOROOT</code> then <code>$GOPATH</code>.</p>\n\n<p>What is your output from the <code>go version</code> and <code>go env</code> commands?</p>\n\n<pre><code>$ go version\ngo version devel +1737aef Mon Apr 24 12:37:49 2017 +0000 linux/amd64\n\n$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/peter/gopath\"\nGORACE=\"\"\nGOROOT=\"/home/peter/go\"\nGOTOOLDIR=\"/home/peter/go/pkg/tool/linux_amd64\"\nGCCGO=\"gccgo\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build148116572=/tmp/go-build -gno-record-gcc-switches\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\nPKG_CONFIG=\"pkg-config\"\n$ \n</code></pre>\n\n<p>How did you install Go?</p>\n"}], "owner": {"reputation": 327, "user_id": 973729, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f3ff92c5bd2e63144b4216c1c8c9c7c8?s=128&d=identicon&r=PG", "display_name": "bitstore", "link": "https://stackoverflow.com/users/973729/bitstore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 2, "answer_count": 1, "score": -1, "last_activity_date": 1493043685, "creation_date": 1493039877, "last_edit_date": 1493043685, "question_id": 43589198, "link": "https://stackoverflow.com/questions/43589198/how-to-build-stdlib-a-file-in-golang", "title": "How to build stdlib a file in golang?", "body": "<p>I want to debug standard library in go language, so I add some log to a standard library file, but this does not make any difference, I think I should rebuild the .a file, how can I do this?</p>\n\n<pre><code>$ go version\ngo version go1.8.1 darwin/amd64\n\n$ go env\nGOARCH=\"amd64\"\nGOBIN=\"/usr/local/go1.8.1/bin\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"darwin\"\nGOOS=\"darwin\"\nGOPATH=\"/Users/bitstore/Projects/go\"\nGORACE=\"\"\nGOROOT=\"/usr/local/go1.8.1\"\nGOTOOLDIR=\"/usr/local/go1.8.1/pkg/tool/darwin_amd64\"\nGCCGO=\"gccgo\"\nCC=\"clang\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fno-caret-diagnostics -Qunused-arguments -fmessage-length=0 -fdebug-prefix-map=/var/folders/4r/62myx2852db5cdvrtqx63gl40000gn/T/go-build009034286=/tmp/go-build -gno-record-gcc-switches -fno-common\"\nCXX=\"clang++\"\nCGO_ENABLED=\"1\"\nPKG_CONFIG=\"pkg-config\"\nCGO_CFLAGS=\"-g -O2\"\nCGO_CPPFLAGS=\"\"\nCGO_CXXFLAGS=\"-g -O2\"\nCGO_FFLAGS=\"-g -O2\"\nCGO_LDFLAGS=\"-g -O2\"\n\n$ go install -v text/scanner\noutput nothing\n\nI install use environment variables\nexport GOROOT=/usr/local/go1.8.1\nexport GOBIN=$GOROOT/bin\nexport GOPATH=$HOME/Projects/go\nexport PATH=$PATH:$GOBIN:$GOPATH/bin\n\n$ ls -la /usr/local/go1.8.1/src/text/scanner/scanner.go\n-rw-r--r--  1 bitstore  staff  17545  4 24 22:19 /usr/local/go1.8.1/src/text/scanner/scanner.go\n$ go install -v text/scanner\n$ ls -la /usr/local/go1.8.1/pkg/darwin_amd64/text/scanner.a\n-rw-r--r--@ 1 bitstore  staff  53838  4  8 00:54 /usr/local/go1.8.1/pkg/darwin_amd64/text/scanner.a\n</code></pre>\n"}, {"tags": ["database", "go", "go-gorm", "notnull"], "comments": [{"owner": {"reputation": 15219, "user_id": 894977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2f18198ad9bdf73fa1d90956f7028254?s=128&d=identicon&r=PG", "display_name": "Cetin Basoz", "link": "https://stackoverflow.com/users/894977/cetin-basoz"}, "edited": false, "score": 0, "creation_date": 1493035791, "post_id": 43587610, "comment_id": 74224576, "body": "An empty string is the &quot;not null&quot; version of a string, no?"}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1493035891, "post_id": 43587610, "comment_id": 74224653, "body": "its not enforcing it for me..If I got to my db manually and try to enter a null field then it says it violates not null constraint, but if I enter &#39;&#39; then it accepts it"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1493036341, "post_id": 43587610, "comment_id": 74224983, "body": "@deltaskelta: That&#39;s exactly what it should do. What&#39;s your question?"}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "edited": false, "score": 0, "creation_date": 1493036448, "post_id": 43587610, "comment_id": 74225067, "body": "the last line of my question is what I am asking. Is there a way to prevent an empty string from being valid without strictly enforcing it through application code?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1493037275, "post_id": 43587610, "comment_id": 74225711, "body": "No, there&#39;s no way within a struct definition to specify that some specific value is invalid."}, {"owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "edited": false, "score": 0, "creation_date": 1493043526, "post_id": 43587610, "comment_id": 74230628, "body": "why don&#39;t you declare your field as sql.NullString?"}, {"owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "edited": false, "score": 0, "creation_date": 1493046741, "post_id": 43587610, "comment_id": 74233089, "body": "Use defaults instead <code>gorm:&quot;default:&#39;empty&#39;&quot;</code>. Or prevent calls to db.Create at application level."}], "answers": [{"tags": [], "owner": {"reputation": 869, "user_id": 10912122, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dstX1.jpg?s=128&g=1", "display_name": "Umar Hayat", "link": "https://stackoverflow.com/users/10912122/umar-hayat"}, "is_accepted": false, "score": 8, "last_activity_date": 1596797862, "last_edit_date": 1596797862, "creation_date": 1576671499, "answer_id": 59391882, "question_id": 43587610, "link": "https://stackoverflow.com/questions/43587610/preventing-null-or-empty-string-values-in-the-db/59391882#59391882", "title": "Preventing null (or empty string values in the db)", "body": "<p>You can solve this problem of preventing '' (empty) string insertion into the database by <code>using default: null</code> and <code>not null</code> constraint together. SO if Struct field values are empty it will be consider as default value <code>null</code> and gorm will throw an error.</p>\n<blockquote>\n<p><code>gorm:&quot;unique;not null;type:varchar(100);default:null&quot;</code></p>\n</blockquote>\n<p>Example is:</p>\n<pre><code>type User struct {\n    gorm.Model\n    Email  string    `gorm:&quot;unique;not null;type:varchar(100);default:null&quot;`\n\n}\n</code></pre>\n<p>SO gorm for empty <code>User.Email</code>  will throw an error.</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2223, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1596797862, "creation_date": 1493035480, "last_edit_date": 1527757146, "question_id": 43587610, "link": "https://stackoverflow.com/questions/43587610/preventing-null-or-empty-string-values-in-the-db", "title": "Preventing null (or empty string values in the db)", "body": "<p>I'm using PostgreSQL and GORM in my Go app.</p>\n\n<p>I thought that using the sql tab of <code>sql:\"not null\"</code> would do the trick of preventing a null entry, but when go initializes structs with a string type then it defaults to an empty string which is not the same as null in the db. </p>\n\n<p>I am wondering if there is a way to prevent this from happening in a struct definition so I wouldn't have to strictly enforce it at all levels in the application code.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1493033665, "post_id": 43586607, "comment_id": 74222937, "body": "Storing user info in context under a customly-typed key sounds perfectly reasonable."}, {"owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1493034153, "post_id": 43586607, "comment_id": 74223296, "body": "then how would you see pulling the user out? by a function call?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1493035809, "post_id": 43586607, "comment_id": 74224589, "body": "Yes. With functions like <code>withUser(ctx, user)</code> and <code>userFromCtx(ctx)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 36869, "user_id": 102371, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/262d914b9ff3f5b7f599de600cf463a8?s=128&d=identicon&r=PG", "display_name": "John Weldon", "link": "https://stackoverflow.com/users/102371/john-weldon"}, "is_accepted": true, "score": 1, "last_activity_date": 1493062687, "creation_date": 1493062687, "answer_id": 43596392, "question_id": 43586607, "link": "https://stackoverflow.com/questions/43586607/store-users-in-context-or-somewhere-else/43596392#43596392", "title": "Store users in context or somewhere else?", "body": "<p>Yes, <a href=\"https://golang.org/pkg/context/\" rel=\"nofollow noreferrer\">context.Context</a> is specifically for request scoped variables, among other things.  (Notice, per request, so not suitable for storing data you mean to access between requests; for that you should consider some sort of session mechanism)</p>\n\n<p>the <code>context.Value(key interface{}) interface{}</code> interface function is how you retrieve values back out of the context.</p>\n"}], "owner": {"reputation": 7540, "user_id": 4400804, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/ae6154c51ff5832ca23eb2ca5fb18aef?s=128&d=identicon&r=PG&f=1", "display_name": "deltaskelta", "link": "https://stackoverflow.com/users/4400804/deltaskelta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "accepted_answer_id": 43596392, "answer_count": 1, "score": 1, "last_activity_date": 1493062687, "creation_date": 1493032522, "last_edit_date": 1493033142, "question_id": 43586607, "link": "https://stackoverflow.com/questions/43586607/store-users-in-context-or-somewhere-else", "title": "Store users in context or somewhere else?", "body": "<p>I am having a hard time finding out if I am thinking about things in the best way. I want to know what to do with a user after they have been authenticated through some type of middleware, either <code>BasicAuth</code> or <code>JWT</code>.</p>\n\n<p>Should I store all the relevant user fields in the context as a value? If I store them in the context then do I need a special function to pull them out? (which would use a user defined contextKey type to retrieve and convert its type back to the proper struct)</p>\n\n<p>I can come up with something that works, but IDK if it is the most reasonable way to go about it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493031921, "post_id": 43586351, "comment_id": 74221668, "body": "Would you be happy with something like <code>var myString = string([]byte{0x74, 0x65, 0x73, 0x74,   0x20, 0x73, 0x74, 0x72, 0x69, 0x6e,  0x67})&quot;</code>?  Or do you need the source to still be readable?"}, {"owner": {"reputation": 1213, "user_id": 7477397, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/f7b37f35aaf354127cf2c21b27c5c2db?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson J", "link": "https://stackoverflow.com/users/7477397/jackson-j"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493032116, "post_id": 43586351, "comment_id": 74221781, "body": "Ok, this might help, but may be there is a better solution?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1493032145, "post_id": 43586351, "comment_id": 74221802, "body": "You can&#39;t store sensitive data in plaintext in your binary. If it&#39;s there, someone will find it - saying it protects you from &quot;casual&quot; users is ridiculous."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493032427, "post_id": 43586351, "comment_id": 74222001, "body": "Better in what sense?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 2, "creation_date": 1493032535, "post_id": 43586351, "comment_id": 74222072, "body": "Indeed. Anybody sophisticated and interested enough to run &#39;grep&#39; on your file, is also fully capable of reading a hex dump, or any other level of reverse-engineering."}], "answers": [{"tags": [], "owner": {"reputation": 667, "user_id": 5627286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeYlo.jpg?s=128&g=1", "display_name": "aMike", "link": "https://stackoverflow.com/users/5627286/amike"}, "is_accepted": false, "score": 1, "last_activity_date": 1493074620, "creation_date": 1493074620, "answer_id": 43598959, "question_id": 43586351, "link": "https://stackoverflow.com/questions/43586351/hide-static-strings-in-compiled-golang-executable/43598959#43598959", "title": "Hide static strings in compiled golang executable", "body": "<p>Writing the text as a series of hex bytes won't help you -- the string will still appear as-is in the binary.  </p>\n\n<p>One solution is to scramble it, rot-13 maybe, or XOR all the bytes with some value, or even XOR the values with a random number generator that's initialized with a known seed value. At run-time, you will have to regenerate the string you want from the \"messed-up\" version.</p>\n\n<p>A second issue: that variable probably has an interesting name which appears in the symbol table of the executable, so maybe pick a \"dull\" name for the encoded string. Maybe even bury the encoded string within a longer string.</p>\n\n<p>As everyone else has noted - someone will find a way to undo your efforts and find the string no matter what you do, but maybe these ideas will help you.</p>\n\n<p>Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 5233, "user_id": 414521, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/0ed12f2bb7ec4f26252d3e8328243861?s=128&d=identicon&r=PG", "display_name": "SSpoke", "link": "https://stackoverflow.com/users/414521/sspoke"}, "is_accepted": false, "score": 0, "last_activity_date": 1581329686, "creation_date": 1581329686, "answer_id": 60148158, "question_id": 43586351, "link": "https://stackoverflow.com/questions/43586351/hide-static-strings-in-compiled-golang-executable/60148158#60148158", "title": "Hide static strings in compiled golang executable", "body": "<p>C++ solution if you ported over from golang</p>\n\n<p>Here is what I currently use it has hacks to support sprintf functions which spilled plain-text in compiled binary file. You could now use w_sprintf_s instead of sprintf, like so </p>\n\n<pre><code>char test[256] = { 0 };\nw_sprintf_s(test, 256, XorStr(\"test test :D %d %+d\\n\"), 1, 1337);\n</code></pre>\n\n<p>or use it like this to print stuff on screen for example</p>\n\n<pre><code>w_printf(XorStr(\"test I print this and can't see me inside .dll or .exe\"));\n</code></pre>\n\n<p>works on variables, if you have a custom printf() you could use that as well..</p>\n\n<pre><code>char szGuid[255] = { 0 };\n//generate serial code removed.\nchar finalSerial[512] = { 0 };\nXorCompileTime::w_sprintf(finalSerial, XorStr(\"serial information=%s\"), szGuid);\nmyprintf(XorStr(\"Your Hardware ID: %s\\n\"), szGuid);\n</code></pre>\n\n<p><br>\nMay add support for wchar_t wide strings like arkan did.. but I have no use for them right now as I don't write anything in symbols / unicode.\n<br></p>\n\n<p>Here is a file just rename the code below to a <code>XorString.h</code> file and include it in your project simple as that</p>\n\n<pre><code>#pragma once\n#include &lt;string&gt;\n#include &lt;array&gt;\n#include &lt;cstdarg&gt;\n\n#define BEGIN_NAMESPACE( x ) namespace x {\n#define END_NAMESPACE }\n\nBEGIN_NAMESPACE(XorCompileTime)\n\nconstexpr auto time = __TIME__;\nconstexpr auto seed = static_cast&lt; int &gt;(time[7]) + static_cast&lt; int &gt;(time[6]) * 10 + static_cast&lt; int &gt;(time[4]) * 60 + static_cast&lt; int &gt;(time[3]) * 600 + static_cast&lt; int &gt;(time[1]) * 3600 + static_cast&lt; int &gt;(time[0]) * 36000;\n\n// 1988, Stephen Park and Keith Miller\n// \"Random Number Generators: Good Ones Are Hard To Find\", considered as \"minimal standard\"\n// Park-Miller 31 bit pseudo-random number generator, implemented with G. Carta's optimisation:\n// with 32-bit math and without division\n\ntemplate &lt; int N &gt;\nstruct RandomGenerator\n{\nprivate:\n    static constexpr unsigned a = 16807; // 7^5\n    static constexpr unsigned m = 2147483647; // 2^31 - 1\n\n    static constexpr unsigned s = RandomGenerator&lt; N - 1 &gt;::value;\n    static constexpr unsigned lo = a * (s &amp; 0xFFFF); // Multiply lower 16 bits by 16807\n    static constexpr unsigned hi = a * (s &gt;&gt; 16); // Multiply higher 16 bits by 16807\n    static constexpr unsigned lo2 = lo + ((hi &amp; 0x7FFF) &lt;&lt; 16); // Combine lower 15 bits of hi with lo's upper bits\n    static constexpr unsigned hi2 = hi &gt;&gt; 15; // Discard lower 15 bits of hi\n    static constexpr unsigned lo3 = lo2 + hi;\n\npublic:\n    static constexpr unsigned max = m;\n    static constexpr unsigned value = lo3 &gt; m ? lo3 - m : lo3;\n};\n\ntemplate &lt;&gt;\nstruct RandomGenerator&lt; 0 &gt;\n{\n    static constexpr unsigned value = seed;\n};\n\ntemplate &lt; int N, int M &gt;\nstruct RandomInt\n{\n    static constexpr auto value = RandomGenerator&lt; N + 1 &gt;::value % M;\n};\n\ntemplate &lt; int N &gt;\nstruct RandomChar\n{\n    static const char value = static_cast&lt; char &gt;(1 + RandomInt&lt; N, 0x7F - 1 &gt;::value);\n};\n\ntemplate &lt; size_t N, int K &gt;\nstruct XorString\n{\nprivate:\n    const char _key;\n    std::array&lt; char, N + 1 &gt; _encrypted;\n\n    constexpr char enc(char c) const\n    {\n        return c ^ _key;\n    }\n\n    char dec(char c) const\n    {\n        return c ^ _key;\n    }\n\npublic:\n    template &lt; size_t... Is &gt;\n    constexpr __forceinline XorString(const char* str, std::index_sequence&lt; Is... &gt;) : _key(RandomChar&lt; K &gt;::value), _encrypted{ enc(str[Is])... }\n    {\n    }\n\n    __forceinline decltype(auto) decrypt(void)\n    {\n        for (size_t i = 0; i &lt; N; ++i) {\n            _encrypted[i] = dec(_encrypted[i]);\n        }\n        _encrypted[N] = '\\0';\n        return _encrypted.data();\n    }\n};\n\n//--------------------------------------------------------------------------------\n//-- Note: XorStr will __NOT__ work directly with functions like printf.\n//         To work with them you need a wrapper function that takes a const char*\n//         as parameter and passes it to printf and alike.\n//\n//         The Microsoft Compiler/Linker is not working correctly with variadic \n//         templates!\n//  \n//         Use the functions below or use std::cout (and similar)!\n//--------------------------------------------------------------------------------\n\nstatic auto w_printf = [](const char* fmt, ...) {\n    va_list args;\n    va_start(args, fmt);\n    vprintf_s(fmt, args);\n    va_end(args);\n};\n\nstatic auto w_printf_s = [](const char* fmt, ...) {\n    va_list args;\n    va_start(args, fmt);\n    vprintf_s(fmt, args);\n    va_end(args);\n};\n\nstatic auto w_sprintf = [](char* buf, const char* fmt, ...) {\n    va_list args;\n    va_start(args, fmt);\n    vsprintf(buf, fmt, args);\n    va_end(args);\n};\n\nstatic auto w_sprintf_s = [](char* buf, size_t buf_size, const char* fmt, ...) {\n    va_list args;\n    va_start(args, fmt);\n    vsprintf_s(buf, buf_size, fmt, args);\n    va_end(args);\n};\n\n#define XorStr( s ) ( XorCompileTime::XorString&lt; sizeof( s ) - 1, __COUNTER__ &gt;( s, std::make_index_sequence&lt; sizeof( s ) - 1&gt;() ).decrypt() )\n\nEND_NAMESPACE\n</code></pre>\n\n<blockquote>\n  <p>Blockquote</p>\n</blockquote>\n"}], "owner": {"reputation": 1213, "user_id": 7477397, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/f7b37f35aaf354127cf2c21b27c5c2db?s=128&d=identicon&r=PG&f=1", "display_name": "Jackson J", "link": "https://stackoverflow.com/users/7477397/jackson-j"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1083, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1581329686, "creation_date": 1493031687, "question_id": 43586351, "link": "https://stackoverflow.com/questions/43586351/hide-static-strings-in-compiled-golang-executable", "title": "Hide static strings in compiled golang executable", "body": "<p>I have somethind like this in code</p>\n\n<pre><code>var myString = \"test string\"\n</code></pre>\n\n<p>I compile it and run</p>\n\n<pre><code>strings myexecutable | grep \"test string\"\n</code></pre>\n\n<p>And I see it in output. Is there some way to hide clear text strings in executable in golang? Separate file is not an option.</p>\n\n<p>It's protection not from qualified hackers, but against simple users who can open executable in notepad and find encryption key.</p>\n"}, {"tags": ["regex", "go", "regex-group"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1493031562, "post_id": 43586091, "comment_id": 74221427, "body": "Also, <a href=\"http://stackoverflow.com/questions/34673039/go-replaceallstring/34673443#34673443\">Go ReplaceAllString</a> is interesting :)"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 13, "last_activity_date": 1493031054, "creation_date": 1493031054, "answer_id": 43586154, "question_id": 43586091, "link": "https://stackoverflow.com/questions/43586091/how-golang-replace-string-by-regex-group/43586154#43586154", "title": "How golang replace string by regex group?", "body": "<p>Use <code>$1</code>, <code>$2</code>, etc in replacement. For example:</p>\n\n<pre><code>re := regexp.MustCompile(`(foo)`)\ns := re.ReplaceAllString(\"foo\", \"$1$1\")\nfmt.Println(s)\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/ZHoz-X1scf\" rel=\"noreferrer\">https://play.golang.org/p/ZHoz-X1scf</a>.</p>\n\n<p>Docs: <a href=\"https://golang.org/pkg/regexp/#Regexp.ReplaceAllString\" rel=\"noreferrer\">https://golang.org/pkg/regexp/#Regexp.ReplaceAllString</a>.</p>\n"}], "owner": {"reputation": 6317, "user_id": 2849157, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/81de56159f8a6f58c78e3e7d88d7fbe5?s=128&d=identicon&r=PG&f=1", "display_name": "roger", "link": "https://stackoverflow.com/users/2849157/roger"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8524, "favorite_count": 0, "closed_date": 1493032237, "accepted_answer_id": 43586154, "answer_count": 1, "score": 4, "last_activity_date": 1494076464, "creation_date": 1493030884, "last_edit_date": 1494076464, "question_id": 43586091, "link": "https://stackoverflow.com/questions/43586091/how-golang-replace-string-by-regex-group", "closed_reason": "Duplicate", "title": "How golang replace string by regex group?", "body": "<p>I want to use regex group to replace string in <code>golang</code>, just like as follow in <code>python</code>:</p>\n\n<pre><code>re.sub(r\"(\\d.*?)[a-z]+(\\d.*?)\", r\"\\1 \\2\", \"123abc123\") # python code\n</code></pre>\n\n<p>So how do I implement this in golang?</p>\n"}, {"tags": ["testing", "go", "reflection"], "comments": [{"owner": {"reputation": 975, "user_id": 865779, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/sgNMc.png?s=128&g=1", "display_name": "Minty", "link": "https://stackoverflow.com/users/865779/minty"}, "edited": false, "score": 0, "creation_date": 1493047886, "post_id": 43584377, "comment_id": 74233991, "body": "Isnt this what you want? <code>for k, v := range APIErrorCodeMessages{ \tfmt.Printf(&quot;%T %T&quot;,k, v) \t }</code>"}], "answers": [{"comments": [{"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1493027037, "post_id": 43584518, "comment_id": 74218383, "body": "Ideally, the known list would be the definition of the individual const values so that no redundant information must be kept. Regarding your last comment, the whole idea of the test would be to ensure that <code>APIErrorCodeMessages</code> will be up-to-date :)"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1493027117, "post_id": 43584518, "comment_id": 74218431, "body": "@fhe: I understand the desire! Sadly, there&#39;s no way to do that, short of source-code analysis. (Although there are a ton of Go source analysis tools, so it&#39;s not outside the realm of possibility to create a tool to do that.  It would have to be a pre-compilation step, though)"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 0, "last_activity_date": 1493026356, "creation_date": 1493026356, "answer_id": 43584518, "question_id": 43584377, "link": "https://stackoverflow.com/questions/43584377/how-to-enumerate-constants-of-a-certain-type/43584518#43584518", "title": "How to enumerate constants of a certain type", "body": "<p>Short of static code analysis, which generates your tests, you can't.</p>\n\n<p>You'll just need to maintain a list of known types somewhere. The most obvious place is probably in your test:</p>\n\n<pre><code>func TestAPICodes(t *testing.T) {\n    for _, code := range []APIErrorCode{APIErrorCodeAuthentication, ...} {\n        // Do your test here\n    }\n}\n</code></pre>\n\n<p>If you want the list defined closer to the code definitions, you could also put it in your main package:</p>\n\n<pre><code>// APIErrorCode represents the API error code\ntype APIErrorCode int\n\nconst (\n    // APIErrorCodeAuthentication represents an authentication error and corresponds with HTTP 401\n    APIErrorCodeAuthentication APIErrorCode = 1000\n    // APIErrorCodeInternalError represents an unknown internal error and corresponds with HTTP 500\n    APIErrorCodeInternalError APIErrorCode = 1001\n)\n\nvar allCodes = []APIErrorCode{APIErrorCodeAuthentication, ...}\n</code></pre>\n\n<p>Or, if you're confident that your <code>APIErrorCodeMessages</code> map will be kept up-to-date, then you already have the solution. Just loop over that map in your test:</p>\n\n<pre><code>func TestAPICodes(t *testing.T) {\n    for code := range APIErrorCodeMessages {\n        // Do your tests...\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1493044994, "post_id": 43586761, "comment_id": 74231761, "body": "Thanks, @icza \u2013 this was I was looking for!"}, {"owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1493114496, "post_id": 43586761, "comment_id": 74263901, "body": "Just FYI, the full detection based on the type name requires constants to be specified with the type \u2013 and not using the short-hand notation where you can omit the type after the first declaration. The basic detection doesn&#39;t require this as it looks at the name only."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "edited": false, "score": 0, "creation_date": 1493115246, "post_id": 43586761, "comment_id": 74264420, "body": "@fhe If you omit the type from the <code>const</code> declaration as in <code>APIErrorCodeInternalError = 1001</code>, it will not be of type <code>APIErrorCode</code> but an untyped integer constant, that&#39;s why it&#39;s not picked by by the full version (because it checks for constants of type <code>APIErrorCode</code>). See example to verify: <a href=\"https://play.golang.org/p/gHWTVCVG9-\" rel=\"nofollow noreferrer\">Go Playground</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1493038087, "last_edit_date": 1495541873, "creation_date": 1493032961, "answer_id": 43586761, "question_id": 43584377, "link": "https://stackoverflow.com/questions/43584377/how-to-enumerate-constants-of-a-certain-type/43586761#43586761", "title": "How to enumerate constants of a certain type", "body": "<h1>Basic concept</h1>\n\n<p>The <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\"><code>reflect</code></a> package does not provide access to exported identifiers, as there is no guarantee they will be linked to the executable binary (and thus available at runtime); more on this: <a href=\"https://stackoverflow.com/questions/38875016/splitting-client-server-code/38875901#38875901\">Splitting client/server code</a>; and <a href=\"https://stackoverflow.com/questions/42825926/how-to-remove-unused-code-at-compile-time/42827979#42827979\">How to remove unused code at compile time?</a></p>\n\n<p>This is a source-code level checking. What I would do is write a test that checks if the number of error code constants matches the map length. The solution below will only check the map length. An improved version (see below) may also check if the keys in the map match the values of the constant declarations too.</p>\n\n<p>You may use the <a href=\"https://golang.org/pkg/go/parser/\" rel=\"nofollow noreferrer\"><code>go/parser</code></a> to parse the Go file containing the error code constants, which gives you an <a href=\"https://golang.org/pkg/go/ast/#File\" rel=\"nofollow noreferrer\"><code>ast.File</code></a> describing the file, containing the constant declarations. You just need to walk through it, and count the error code constant declarations.</p>\n\n<p>Let's say your original file is named <code>\"errcodes.go\"</code>, write a test file named <code>\"errcodes_test.go\"</code>.</p>\n\n<p>This is how the test function could look like:</p>\n\n<pre><code>func TestMap(t *testing.T) {\n    fset := token.NewFileSet()\n    f, err := parser.ParseFile(fset, \"errcodes.go\", nil, 0)\n    if err != nil {\n        t.Errorf(\"Failed to parse file: %v\", err)\n        return\n    }\n\n    errCodeCount := 0\n    // Range through declarations:\n    for _, dd := range f.Decls {\n        if gd, ok := dd.(*ast.GenDecl); ok {\n            // Find constant declrations:\n            if gd.Tok == token.CONST {\n                for _, sp := range gd.Specs {\n                    if valSp, ok := sp.(*ast.ValueSpec); ok {\n                        for _, name := range valSp.Names {\n                            // Count those that start with \"APIErrorCode\"\n                            if strings.HasPrefix(name.Name, \"APIErrorCode\") {\n                                errCodeCount++\n                            }\n                        }\n                    }\n                }\n            }\n        }\n    }\n    if exp, got := errCodeCount, len(APIErrorCodeMessages); exp != got {\n        t.Errorf(\"Expected %d err codes, got: %d\", exp, got)\n    }\n}\n</code></pre>\n\n<p>Running <code>go test</code> will result in:</p>\n\n<pre><code>--- FAIL: TestMap (0.00s)\n    errcodes_test.go:39: Expected 2 err codes, got: 1\n</code></pre>\n\n<p>The test properly reveals that there are 2 constant error code declarations, but the <code>APIErrorCodeMessages</code> map contains only 1 entry.</p>\n\n<p>If we now \"complete\" the map:</p>\n\n<pre><code>var APIErrorCodeMessages = map[APIErrorCode]string{\n    APIErrorCodeInternalError:  \"Internal Error\",\n    APIErrorCodeAuthentication: \"asdf\",\n}\n</code></pre>\n\n<p>And run <code>go test</code> again:</p>\n\n<pre><code>PASS\n</code></pre>\n\n<p>Note: it's a matter of style, but the big loop may be written this way to decrease nesting level:</p>\n\n<pre><code>// Range through declarations:\nfor _, dd := range f.Decls {\n    gd, ok := dd.(*ast.GenDecl)\n    if !ok {\n        continue\n    }\n    // Find constant declrations:\n    if gd.Tok != token.CONST {\n        continue\n    }\n    for _, sp := range gd.Specs {\n        valSp, ok := sp.(*ast.ValueSpec)\n        if !ok {\n            continue\n        }\n        for _, name := range valSp.Names {\n            // Count those that start with \"APIErrorCode\"\n            if strings.HasPrefix(name.Name, \"APIErrorCode\") {\n                errCodeCount++\n            }\n        }\n    }\n}\n</code></pre>\n\n<h1>Full, improved detection</h1>\n\n<p>This time we will check the exact type of the constants, not their names. We will also gather all the constant values, and in the end we will check each if that exact constant value is in the map. If something is missing, we will print the exact values of the missing codes.</p>\n\n<p>So here it is:</p>\n\n<pre><code>func TestMap(t *testing.T) {\n    fset := token.NewFileSet()\n    f, err := parser.ParseFile(fset, \"errcodes.go\", nil, 0)\n    if err != nil {\n        t.Errorf(\"Failed to parse file: %v\", err)\n        return\n    }\n\n    var keys []APIErrorCode\n    // Range through declarations:\n    for _, dd := range f.Decls {\n        gd, ok := dd.(*ast.GenDecl)\n        if !ok {\n            continue\n        }\n        // Find constant declrations:\n        if gd.Tok != token.CONST {\n            continue\n        }\n        for _, sp := range gd.Specs {\n            // Filter by APIErrorCode type:\n            valSp, ok := sp.(*ast.ValueSpec)\n            if !ok {\n                continue\n            }\n            if id, ok2 := valSp.Type.(*ast.Ident); !ok2 ||\n                id.Name != \"APIErrorCode\" {\n                continue\n            }\n            // And gather the constant values in keys:\n            for _, value := range valSp.Values {\n                bslit, ok := value.(*ast.BasicLit)\n                if !ok {\n                    continue\n                }\n                keyValue, err := strconv.Atoi(bslit.Value)\n                if err != nil {\n                    t.Errorf(\"Could not parse value from %v: %v\",\n                        bslit.Value, err)\n                }\n                keys = append(keys, APIErrorCode(keyValue))\n            }\n        }\n    }\n\n    for _, key := range keys {\n        if _, found := APIErrorCodeMessages[key]; !found {\n            t.Errorf(\"Could not found key in map: %v\", key)\n        }\n    }\n}\n</code></pre>\n\n<p>Running <code>go test</code> with an \"incomplete\" <code>APIErrorCodeMessages</code> map, we get the following output:</p>\n\n<pre><code>--- FAIL: TestMap (0.00s)\n    errcodes_test.go:58: Could not found key in map: 1000\n</code></pre>\n"}], "owner": {"reputation": 5837, "user_id": 4445, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/6bc9f6e38b74914b7a1bd08694f42a58?s=128&d=identicon&r=PG", "display_name": "fhe", "link": "https://stackoverflow.com/users/4445/fhe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 159, "favorite_count": 1, "accepted_answer_id": 43586761, "answer_count": 2, "score": 2, "last_activity_date": 1493038087, "creation_date": 1493025987, "question_id": 43584377, "link": "https://stackoverflow.com/questions/43584377/how-to-enumerate-constants-of-a-certain-type", "title": "How to enumerate constants of a certain type", "body": "<p>I'd like to ensure with a test, that for each <code>APIErrorCode</code> constant defined as below, the map <code>APIErrorCodeMessages</code> contains an entry. How can I enumerate all constants of a certain type in Go?</p>\n\n<pre><code>// APIErrorCode represents the API error code\ntype APIErrorCode int\n\nconst (\n    // APIErrorCodeAuthentication represents an authentication error and corresponds with HTTP 401\n    APIErrorCodeAuthentication APIErrorCode = 1000\n    // APIErrorCodeInternalError represents an unknown internal error and corresponds with HTTP 500\n    APIErrorCodeInternalError APIErrorCode = 1001\n)\n\n// APIErrorCodeMessages holds all error messages for APIErrorCodes\nvar APIErrorCodeMessages = map[APIErrorCode]string{\n    APIErrorCodeInternalError: \"Internal Error\",\n}\n</code></pre>\n\n<p>I've looked into <code>reflect</code> and <code>go/importer</code> and tried <code>tools/cmd/stringer</code> without success.</p>\n"}, {"tags": ["debugging", "go", "visual-studio-code"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 1, "last_activity_date": 1493079109, "creation_date": 1493079109, "answer_id": 43599533, "question_id": 43582024, "link": "https://stackoverflow.com/questions/43582024/debugging-go-with-tags-in-visual-studio-code-and-delve-debugger/43599533#43599533", "title": "Debugging Go with tags in Visual Studio Code and Delve debugger", "body": "<p>You can attach pre-built binary to debugger.</p>\n\n<ol>\n<li>Build the application from command line, e.g. <code>go build -o myapp.exe -tags THISISAFLAG</code></li>\n<li><p>Add configuration <code>Launch Exe</code> to <code>launch.json</code></p>\n\n<pre><code>{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \"Launch Debug\",  //existing config\n      \"type\": \"go\",\n      \"request\": \"launch\",\n      \"mode\": \"debug\",\n      \"remotePath\": \"\",\n      \"port\": 2345,\n      \"host\": \"127.0.0.1\",\n      \"program\": \"${fileDirname}\",\n      \"env\": {},\n      \"args\": [],\n      \"showLog\": true\n    },\n    {\n      \"name\": \"Launch EXE\",    //added config\n      \"type\": \"go\",\n      \"request\": \"launch\",\n      \"mode\": \"exec\",\n      \"remotePath\": \"\",\n      \"port\": 2345,\n      \"host\": \"127.0.0.1\",\n      \"program\": \"${workspaceRoot}/myapp.exe\",\n      \"env\": {},\n      \"args\": [],\n      \"showLog\": true\n    }\n  ]\n} \n</code></pre></li>\n</ol>\n\n<p><strong>Note:</strong></p>\n\n<p>Due to compiler optimization and <a href=\"https://github.com/golang/go/issues/14319\" rel=\"nofollow noreferrer\">this issue</a>, some variables may not being displayed or displayed with different name during debug session (see below). In the future, you may add <code>-gcflags='-N -l'</code> when building the application to disable compiler optimization. </p>\n\n<p><a href=\"https://i.stack.imgur.com/fOQnX.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/fOQnX.jpg\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 749, "user_id": 500309, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b31f5bb68e4ed0d34972960510c7cc1?s=128&d=identicon&r=PG", "display_name": "jpap", "link": "https://stackoverflow.com/users/500309/jpap"}, "is_accepted": false, "score": 3, "last_activity_date": 1535761612, "last_edit_date": 1535761612, "creation_date": 1535655543, "answer_id": 52103738, "question_id": 43582024, "link": "https://stackoverflow.com/questions/43582024/debugging-go-with-tags-in-visual-studio-code-and-delve-debugger/52103738#52103738", "title": "Debugging Go with tags in Visual Studio Code and Delve debugger", "body": "<p>The <a href=\"https://github.com/Microsoft/vscode-go\" rel=\"nofollow noreferrer\">Visual Studio Code Go plugin</a> now supports a <code>launch.json</code> key called <code>buildFlags</code> that allows you to specify the build tags with a corresponding value of <code>\"-tags Tag\"</code>.  (There appears to be <a href=\"https://github.com/Microsoft/vscode-go/issues/1901\" rel=\"nofollow noreferrer\">a bug disallowing multiple tags</a>.).</p>\n\n<p>Relevant <a href=\"https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code\" rel=\"nofollow noreferrer\">excerpt from the plugin Wiki</a>:</p>\n\n<blockquote>\n  <p>If your build needs build tags (e.g. go build -tags whatever_tag), then add the parameter buildFlags with the content \"-tags whatever_tag\".</p>\n</blockquote>\n\n<p>If you have different build configurations each requiring their own build tag, you can create separate launch configurations for each.</p>\n"}], "owner": {"reputation": 325, "user_id": 3196293, "user_type": "registered", "accept_rate": 45, "profile_image": "https://graph.facebook.com/1040298947/picture?type=large", "display_name": "David", "link": "https://stackoverflow.com/users/3196293/david"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1746, "favorite_count": 1, "accepted_answer_id": 43599533, "answer_count": 2, "score": 3, "last_activity_date": 1535761612, "creation_date": 1493018432, "last_edit_date": 1493109235, "question_id": 43582024, "link": "https://stackoverflow.com/questions/43582024/debugging-go-with-tags-in-visual-studio-code-and-delve-debugger", "title": "Debugging Go with tags in Visual Studio Code and Delve debugger", "body": "<p><strong>Answer:</strong>\nBased on putus answer, I figured out the following configuration to build and debug with one click</p>\n\n<p>At first you need to add a task to build the binary with the respective tags.</p>\n\n<pre><code>{\n  // See https://go.microsoft.com/fwlink/?LinkId=733558\n  // for the documentation about the tasks.json format\n  \"version\": \"0.1.0\",\n  \"command\": \"bash\",\n  \"isShellCommand\": true,\n  \"args\": [\"\"],\n  \"showOutput\": \"always\",\n  \"tasks\": [\n        {\n            \"taskName\": \"buildBinWithTag\",\n            \"command\": \"go\",\n            \"args\": [\"build\", \"-o\", \"BinaryName\", \"-tags\", \"THISISATAG\"],\n            \"isShellCommand\": true            \n        }       \n    ]\n}\n</code></pre>\n\n<p>This task should be executed before the debugger launches.</p>\n\n<pre><code>{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \"DebugBinWithTag\",    //added config\n      \"type\": \"go\",\n      \"request\": \"launch\",\n      \"mode\": \"exec\",\n      \"remotePath\": \"\",\n      \"port\": 2345,\n      \"host\": \"127.0.0.1\",\n      \"program\": \"${workspaceRoot}/BinaryName\",\n      \"env\": {},\n      \"args\": [],\n      \"showLog\": true,\n      \"preLaunchTask\": \"buildBinWithTag\"\n    }\n  ]\n} \n</code></pre>\n\n<p><strong>Original question</strong>:I'm using build tags for compiling different versions of a Go program and I compile it with \"go build -tags THISISAFLAG\"</p>\n\n<pre><code>//+build THISISAFLAG\n\npackage main\n</code></pre>\n\n<p>This works perfectly. But is there a way to tell the debugger to use these flags. I've tried to use a launch configuration like the following, but it didn't work.</p>\n\n<pre><code>{\n  \"version\": \"0.2.0\",\n  \"configurations\": [\n    {\n      \"name\": \"Launch\",\n      \"type\": \"go\",\n      \"request\": \"launch\",\n      \"mode\": \"debug\",\n      \"remotePath\": \"\",\n      \"port\": 2345,\n      \"host\": \"127.0.0.1\",\n      \"program\": \"${fileDirname}\",\n      \"env\": {},\n      \"args\": [\"-flags THISISAFLAG\"],\n      \"showLog\": true\n    }\n  ]\n}\n</code></pre>\n"}, {"tags": ["docker", "go", "blockchain", "hyperledger", "hyperledger-fabric"], "answers": [{"tags": [], "owner": {"reputation": 981, "user_id": 6925001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b72670bf5e25a9a80bf5bd136428a50?s=128&d=identicon&r=PG&f=1", "display_name": "jaswanth", "link": "https://stackoverflow.com/users/6925001/jaswanth"}, "is_accepted": true, "score": -2, "last_activity_date": 1493984032, "creation_date": 1493984032, "answer_id": 43803922, "question_id": 43581283, "link": "https://stackoverflow.com/questions/43581283/stub-gethistorykeys-reporting-gethistorykeys-function-undefined-when-tried/43803922#43803922", "title": "stub.GetHistoryKeys() reporting GetHistoryKeys() function undefined. when tried go build on my Chaincode", "body": "<p>At last I am able to figure it out to get the hyperledger images to support my chaincode.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 4010471, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bfd510d14717ef3465f9d620479ae3c1?s=128&d=identicon&r=PG&f=1", "display_name": "Shobhit Srivastava", "link": "https://stackoverflow.com/users/4010471/shobhit-srivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1528805077, "creation_date": 1528805077, "answer_id": 50816768, "question_id": 43581283, "link": "https://stackoverflow.com/questions/43581283/stub-gethistorykeys-reporting-gethistorykeys-function-undefined-when-tried/50816768#50816768", "title": "stub.GetHistoryKeys() reporting GetHistoryKeys() function undefined. when tried go build on my Chaincode", "body": "<p>Please download latest version of fabric image, (\nhyperledger/fabric-peer                                                                               x86_64-1.1.0  ). It can be downloaded from script mentioned on hyperledger official website (Install binary)=> (<a href=\"https://hyperledger-fabric.readthedocs.io/en/latest/install.html\" rel=\"nofollow noreferrer\">https://hyperledger-fabric.readthedocs.io/en/latest/install.html</a>. Can't paste url due to stackover flow policy issue). Once you have it. Create a go code. Simply add one json record on one key add then try to add some change some field of json and again add to same key. Once you have done that, fire the below code for gethistory:=></p>\n\n<p>func (s *SmartContract) getAllTransactionForid(APIstub shim.ChaincodeStubInterface, args []string) sc.Response {\n    fmt.Println(\"getAllTransactionForNumber called\")\n    id:= args[0]</p>\n\n<pre><code>resultsIterator, err := APIstub.GetHistoryForKey(id)\nif err != nil {\n    return shim.Error(err.Error())\n}\ndefer resultsIterator.Close()\n\n// buffer is a JSON array containing historic values for the number\nvar buffer bytes.Buffer\nbuffer.WriteString(\"[\")\n\nbArrayMemberAlreadyWritten := false\nfor resultsIterator.HasNext() {\n    response, err := resultsIterator.Next()\n    if err != nil {\n        return shim.Error(err.Error())\n    }\n    // Add a comma before array members, suppress it for the first array member\n    if bArrayMemberAlreadyWritten == true {\n        buffer.WriteString(\",\")\n    }\n    buffer.WriteString(\"{\\\"TxId\\\":\")\n    buffer.WriteString(\"\\\"\")\n    buffer.WriteString(response.TxId)\n    buffer.WriteString(\"\\\"\")\n\n    buffer.WriteString(\", \\\"Value\\\":\")\n    // if it was a delete operation on given key, then we need to set the\n    //corresponding value null. Else, we will write the response.Value\n    //as-is (as the Value itself a JSON marble)\n    if response.IsDelete {\n        buffer.WriteString(\"null\")\n    } else {\n        buffer.WriteString(string(response.Value))\n    }\n\n    buffer.WriteString(\", \\\"Timestamp\\\":\")\n    buffer.WriteString(\"\\\"\")\n    buffer.WriteString(time.Unix(response.Timestamp.Seconds, int64(response.Timestamp.Nanos)).String())\n    buffer.WriteString(\"\\\"\")\n\n    buffer.WriteString(\", \\\"IsDelete\\\":\")\n    buffer.WriteString(\"\\\"\")\n    buffer.WriteString(strconv.FormatBool(response.IsDelete))\n    buffer.WriteString(\"\\\"\")\n\n    buffer.WriteString(\"}\")\n    bArrayMemberAlreadyWritten = true\n}\nif !bArrayMemberAlreadyWritten {\n    buffer.WriteString(\"No record found\")\n}\nbuffer.WriteString(\"]\")\n\nfmt.Printf(\"- getAllTransactionForNumber returning:\\n%s\\n\", buffer.String())\n\nreturn shim.Success(buffer.Bytes())\n</code></pre>\n\n<p>}</p>\n\n<p>If still in doubt, please revert. I will give you my whole source code to make it work. But I hope this will make your problem go away :-)</p>\n"}], "owner": {"reputation": 981, "user_id": 6925001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b72670bf5e25a9a80bf5bd136428a50?s=128&d=identicon&r=PG&f=1", "display_name": "jaswanth", "link": "https://stackoverflow.com/users/6925001/jaswanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 654, "favorite_count": 2, "accepted_answer_id": 43803922, "answer_count": 2, "score": 0, "last_activity_date": 1528805077, "creation_date": 1493015685, "last_edit_date": 1493098282, "question_id": 43581283, "link": "https://stackoverflow.com/questions/43581283/stub-gethistorykeys-reporting-gethistorykeys-function-undefined-when-tried", "title": "stub.GetHistoryKeys() reporting GetHistoryKeys() function undefined. when tried go build on my Chaincode", "body": "<p>I am new to <a href=\"https://www.hyperledger.org/\" rel=\"nofollow noreferrer\">Hyperledger</a> .I am using docker to run Hyperledger. Pulled <code>hyperledger/fabric-peer:latest</code> from Docker hub and\nable to run <code>stub.CreateTable()</code> ,<code>stub.GetRows()</code> , <code>stub.InsertRows()</code> and some other functions in my Chaincode. But when i tried to run  </p>\n\n<p><code>stub.GetHistoryKeys() or stub.GetCompositeKeys() ...etc</code>  in my chaincode\nIt's reporting  an error </p>\n\n<pre><code> stub.GetHistoryForKey undefined (type shim.ChaincodeStubInterface has no field \n  or method GetHistoryForKey)\n</code></pre>\n\n<p>I found that in my <a href=\"https://github.com/hyperledger/fabric/blob/v0.6/core/chaincode/shim/interfaces.go\" rel=\"nofollow noreferrer\">interface.go</a> file there are no such functions . Googled a lot but found nothing .Can anyone tell the correct <code>hyperledger/fabric-peer</code> image to pull so that the above functions can run in Chaincode.</p>\n"}, {"tags": ["html", "go", "html-parsing", "beego"], "answers": [{"tags": [], "owner": {"reputation": 278, "user_id": 5389781, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6rGNr.jpg?s=128&g=1", "display_name": "tanglong", "link": "https://stackoverflow.com/users/5389781/tanglong"}, "is_accepted": true, "score": 3, "last_activity_date": 1493021285, "last_edit_date": 1495540018, "creation_date": 1493020778, "answer_id": 43582725, "question_id": 43580900, "link": "https://stackoverflow.com/questions/43580900/r-fromusername-giving-empty-values/43582725#43582725", "title": "r.From[&quot;username&quot;] giving empty values", "body": "<p>Comment the code below:</p>\n\n<pre><code>requestbody, _ := ioutil.ReadAll(r.Body)\n</code></pre>\n\n<p>Because <code>Request.Body</code>'s type is <code>ReadCloser</code> that will empty <code>r.Body</code>.</p>\n\n<p>FYI, <a href=\"https://stackoverflow.com/questions/43021058/golang-read-request-body\">Golang read request body</a></p>\n"}], "owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 43582725, "answer_count": 1, "score": 1, "last_activity_date": 1493025913, "creation_date": 1493014272, "last_edit_date": 1493025913, "question_id": 43580900, "link": "https://stackoverflow.com/questions/43580900/r-fromusername-giving-empty-values", "title": "r.From[&quot;username&quot;] giving empty values", "body": "<p>I have written an small web app using golang</p>\n\n<blockquote>\n  <p>go version go1.7.4 linux/amd64\n  Go Code:</p>\n</blockquote>\n\n<pre><code>r.ParseForm()\n        // logic part of log in\n        fmt.Println(\"username:\", r.Form[\"username\"])\n        fmt.Println(\"password:\", r.Form[\"password\"])\n</code></pre>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>    \r\nHTML template\r\n&lt;body&gt;\r\n    &lt;div class=\"container\"&gt;\r\n        &lt;h1&gt;Login In&lt;/h1&gt;\r\n        &lt;form action=\"/login\" method=\"POST\"&gt;\r\n            &lt;div class=\"form-group\"&gt;\r\n                &lt;label for=\"username\"&gt;User Name&lt;/label&gt;\r\n                &lt;input type=\"text\" class=\"form-control\" name=\"username\" placeholder=\"Please enter your user name\"&gt;\r\n            &lt;/div&gt;\r\n            &lt;div class=\"form-group\"&gt;\r\n                &lt;label for=\"password\"&gt;Password&lt;/label&gt;\r\n                &lt;input type=\"password\" class=\"form-control\" name=\"password\" placeholder=\"Please enter your password\"&gt;\r\n            &lt;/div&gt;\r\n            &lt;button type=\"submit\" class=\"btn btn-success\"&gt;Login&lt;/button&gt;\r\n        &lt;/form&gt;\r\n    &lt;/div&gt;\r\n&lt;/body&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>When I am printing using </p>\n\n<pre><code>requestbody, _ := ioutil.ReadAll(r.Body)\nlog.Println(\"request body is\", string(requestbody))\n</code></pre>\n\n<p>it's printing correct values along with entered username and password.\nBut when I tried to print it using <code>r.Form</code> it's giving empty value.\nIs anything wrong in this approach?</p>\n\n<pre><code>func loginHandler(w http.ResponseWriter, r *http.Request) {\n    log.Println(\"loginHandler\")\n    log.Println(\"request url is\", r.RequestURI)\n    log.Println(\"request method\", r.Method)\n    requestbody, _ := ioutil.ReadAll(r.Body)\n    log.Println(\"request body is\", string(requestbody))\n    if r.Method == \"POST\" {\n        r.ParseForm()\n        // logic part of log in\n        fmt.Println(\"username:\", r.Form[\"username\"])\n        fmt.Println(\"password:\", r.Form[\"password\"])\n        us, err := globalSessions.SessionStart(w, r)\n        if err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n        w.Header().Set(\"Location\", \"/auth\")\n        w.WriteHeader(http.StatusFound)\n        return\n    }\n    outputHTML(w, r, \"static/login.html\")\n}\n</code></pre>\n"}, {"tags": ["windows", "go", "build", "hyperledger-fabric", "cgo"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1493013424, "post_id": 43580131, "comment_id": 74210780, "body": "So what is your question?"}, {"owner": {"reputation": 981, "user_id": 6925001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b72670bf5e25a9a80bf5bd136428a50?s=128&d=identicon&r=PG&f=1", "display_name": "jaswanth", "link": "https://stackoverflow.com/users/6925001/jaswanth"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1493015663, "post_id": 43580131, "comment_id": 74211720, "body": "go build  command giving the above gcc error ... how can i solve it"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1493015977, "post_id": 43580131, "comment_id": 74211887, "body": "Do you have <code>gcc</code> installed?"}, {"owner": {"reputation": 981, "user_id": 6925001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b72670bf5e25a9a80bf5bd136428a50?s=128&d=identicon&r=PG&f=1", "display_name": "jaswanth", "link": "https://stackoverflow.com/users/6925001/jaswanth"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1493016532, "post_id": 43580131, "comment_id": 74212123, "body": "no .. is it required ?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493016634, "post_id": 43580131, "comment_id": 74212175, "body": "Well, yes of course."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1493024800, "post_id": 43580131, "comment_id": 74216865, "body": "@jaswanth: Your error message is <code>&quot;gcc&quot;: executable file not found</code>. That should be your first clue that &quot;gcc&quot; is required but not found."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4492631, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-0h8OKghy2tY/AAAAAAAAAAI/AAAAAAAAAAs/R6ABM1D8TeI/photo.jpg?sz=128", "display_name": "oasf", "link": "https://stackoverflow.com/users/4492631/oasf"}, "is_accepted": false, "score": 0, "last_activity_date": 1494284259, "last_edit_date": 1494284259, "creation_date": 1493022922, "answer_id": 43583320, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/43583320#43583320", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>gcc should not be necessary, unless you are cross compiling for a non-windows platform, or use cgo.\nIf you still need gcc, however, you should install MinGW, which provides a gcc port for Windows (Cygwin and msys should also work, although I have never actually tested this).</p>\n\n<p>Edit: I see from your error message now, that it is a dependency that requires gcc. If you didn't already know this, gcc is a c/c++ compiler, and in this case it is probably needed to compile c source files included by a dependency or sub-dependency.</p>\n"}, {"comments": [{"owner": {"reputation": 981, "user_id": 6925001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b72670bf5e25a9a80bf5bd136428a50?s=128&d=identicon&r=PG&f=1", "display_name": "jaswanth", "link": "https://stackoverflow.com/users/6925001/jaswanth"}, "edited": false, "score": 1, "creation_date": 1493093000, "post_id": 43588236, "comment_id": 74252448, "body": "tq it worked but getting different error now <code>.\\hyperledger\\fabric\\vendor\\github.com\\miekg\\pkcs11\\pkcs11.g&zwnj;&#8203;o:29:18: fatal error: ltdl.h: No such file or directory compilation terminated.</code>"}, {"owner": {"reputation": 981, "user_id": 6925001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b72670bf5e25a9a80bf5bd136428a50?s=128&d=identicon&r=PG&f=1", "display_name": "jaswanth", "link": "https://stackoverflow.com/users/6925001/jaswanth"}, "edited": false, "score": 0, "creation_date": 1493190145, "post_id": 43588236, "comment_id": 74302854, "body": "I installed <a href=\"http://gnuwin32.sourceforge.net/packages/libtool.htm\" rel=\"nofollow noreferrer\">libtools</a> but its not working"}, {"owner": {"reputation": 511, "user_id": 1927119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5950d806d7c18ae9a06104382e44073a?s=128&d=identicon&r=PG", "display_name": "pkmelee337", "link": "https://stackoverflow.com/users/1927119/pkmelee337"}, "edited": false, "score": 0, "creation_date": 1527721013, "post_id": 43588236, "comment_id": 88238600, "body": "jaswanth, check out the answer @Ashinkel has given. I did have the same problem, but that worked for me."}, {"owner": {"reputation": 1649, "user_id": 1583763, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/ed0c023607ce92fbb53e0c5cae608234?s=128&d=identicon&r=PG", "display_name": "Kent", "link": "https://stackoverflow.com/users/1583763/kent"}, "edited": false, "score": 0, "creation_date": 1555036912, "post_id": 43588236, "comment_id": 97977238, "body": "When downloading the TDM-GCC installer for Windows, use the x64 version.  The 32-bit version did not solve the problem for me."}, {"owner": {"reputation": 133, "user_id": 10747174, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-b9DsdZPZyfw/AAAAAAAAAAI/AAAAAAAAj5Q/NWjr7a4QvbY/photo.jpg?sz=128", "display_name": "Camilo Caquimbo", "link": "https://stackoverflow.com/users/10747174/camilo-caquimbo"}, "edited": false, "score": 0, "creation_date": 1598588332, "post_id": 43588236, "comment_id": 112513512, "body": "Installation of TDM-GCC [<a href=\"https://jmeubank.github.io/tdm-gcc/]\" rel=\"nofollow noreferrer\">jmeubank.github.io/tdm-gcc/]</a> works fine for me Windows 10 testing execution with fyne [<a href=\"https://fyne.io]\" rel=\"nofollow noreferrer\">fyne.io]</a>"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 90, "last_activity_date": 1493039343, "last_edit_date": 1493039343, "creation_date": 1493037288, "answer_id": 43588236, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/43588236#43588236", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p><a href=\"https://gcc.gnu.org/\" rel=\"noreferrer\">gcc</a> (the GNU Compiler Collection) provides a C compiler. On Windows, install <a href=\"http://tdm-gcc.tdragon.net/download\" rel=\"noreferrer\">TDM-GCC</a>. The <a href=\"https://github.com/miekg/pkcs11\" rel=\"noreferrer\"><code>github.com/miekg/pkcs11</code></a> package uses <a href=\"https://golang.org/cmd/cgo/\" rel=\"noreferrer\">cgo</a>. Cgo enables the creation of Go packages that call C code. </p>\n"}, {"comments": [{"owner": {"reputation": 511, "user_id": 1927119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5950d806d7c18ae9a06104382e44073a?s=128&d=identicon&r=PG", "display_name": "pkmelee337", "link": "https://stackoverflow.com/users/1927119/pkmelee337"}, "edited": false, "score": 1, "creation_date": 1527720958, "post_id": 45071404, "comment_id": 88238585, "body": "Awesome! Thanks! If you use Visual Studio Code as windows editor you can add this to your settings with the following setting: &quot;go.buildTags&quot;: &quot;nopkcs11&quot;"}], "tags": [], "owner": {"reputation": 825, "user_id": 3824841, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hUElY.jpg?s=128&g=1", "display_name": "Ashishkel", "link": "https://stackoverflow.com/users/3824841/ashishkel"}, "is_accepted": false, "score": 3, "last_activity_date": 1499920100, "creation_date": 1499920100, "answer_id": 45071404, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/45071404#45071404", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>The proper explanations why go build does not work for hyperledger in Windows environment are given as other answers.\nFor your compilation purposes, just to make it work without installing anything extra, you can try the following</p>\n\n<pre><code>go build --tags nopkcs11\n</code></pre>\n\n<p>It worked for me. I hope same works for you too.</p>\n"}, {"tags": [], "owner": {"reputation": 96, "user_id": 7899140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/EFhDs.png?s=128&g=1", "display_name": "paulg", "link": "https://stackoverflow.com/users/7899140/paulg"}, "is_accepted": false, "score": 0, "last_activity_date": 1502759845, "creation_date": 1502759845, "answer_id": 45685203, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/45685203#45685203", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<ol>\n<li>you need to download MingGW64</li>\n<li>put MingGW64 folder into your $PATH</li>\n<li>run go build xxx.go (with cgo library)</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 5648313, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/781d8e39aca346617039811592d59667?s=128&d=identicon&r=PG", "display_name": "kartamihardja", "link": "https://stackoverflow.com/users/5648313/kartamihardja"}, "is_accepted": false, "score": 0, "last_activity_date": 1523686861, "creation_date": 1523686861, "answer_id": 49828569, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/49828569#49828569", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>Hi jaswanth the main problem is that you haven't register your %GO_HOME%\\pkg\\tool\\windows_amd64 to yuour Environment Path.\n%GO_HOME% is the repository where you install your go at the first time.</p>\n"}, {"comments": [{"owner": {"reputation": 2269, "user_id": 1329396, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/Cg8rf.png?s=128&g=1", "display_name": "Robert Snyder", "link": "https://stackoverflow.com/users/1329396/robert-snyder"}, "edited": false, "score": 0, "creation_date": 1538883115, "post_id": 50078531, "comment_id": 92298054, "body": "which path? I installed msys to <code>c:\\tools\\msys64</code> and I think i&#39;m supposed to use <code>c:\\tools\\msys64\\usr\\bin</code> to my PATH is that right?"}], "tags": [], "owner": {"reputation": 2213, "user_id": 5157221, "user_type": "registered", "accept_rate": 70, "profile_image": "https://lh4.googleusercontent.com/-YW9dXs0bMLY/AAAAAAAAAAI/AAAAAAAAD3E/cEQZYkX5qWw/photo.jpg?sz=128", "display_name": "Suriyaa", "link": "https://stackoverflow.com/users/5157221/suriyaa"}, "is_accepted": false, "score": 2, "last_activity_date": 1524931942, "creation_date": 1524931942, "answer_id": 50078531, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/50078531#50078531", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>Instruction to fix the \"<em>exec: \u201cgcc\u201d: executable file not found in %PATH%</em>\" error with MSYS2:</p>\n\n<ul>\n<li>Download MSYS2.</li>\n<li>Put MSYS2 folder into your $PATH.</li>\n<li>Start the MSYS2 command line program.</li>\n<li><strong>Run this command: <code>pacman -S gcc</code></strong>.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 23850, "user_id": 196679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fXUzE.jpg?s=128&g=1", "display_name": "Bazzz", "link": "https://stackoverflow.com/users/196679/bazzz"}, "edited": false, "score": 2, "creation_date": 1552814098, "post_id": 53394557, "comment_id": 97147288, "body": "This explanation is a little cryptic but I managed to solve the issue by reading well what is said here and &quot;interpret&quot; Alex&#39;s intentions: apply step 1.2 <i>whilst</i> installing the application in step 1, and only after that go to step 2."}, {"owner": {"reputation": 291, "user_id": 3141154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/D0xIs.jpg?s=128&g=1", "display_name": "T1960CT", "link": "https://stackoverflow.com/users/3141154/t1960ct"}, "edited": false, "score": 1, "creation_date": 1567971687, "post_id": 53394557, "comment_id": 102117610, "body": "<code>C:\\Program Files\\Git\\mingw64\\bin</code> in my case, since I installed the Git client and it uses mingw64"}, {"owner": {"reputation": 564, "user_id": 4350181, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6IkTc.jpg?s=128&g=1", "display_name": "lucsan", "link": "https://stackoverflow.com/users/4350181/lucsan"}, "edited": false, "score": 2, "creation_date": 1573398638, "post_id": 53394557, "comment_id": 103861683, "body": "On Windows, once you have edited the PATH in System Environment Variables, remember you need to exit/kill any open command terminals you intend using, as they will not receive a PATH update."}], "tags": [], "owner": {"reputation": 397, "user_id": 7455192, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SFuGK.png?s=128&g=1", "display_name": "ame", "link": "https://stackoverflow.com/users/7455192/ame"}, "is_accepted": false, "score": 13, "last_activity_date": 1542722051, "creation_date": 1542722051, "answer_id": 53394557, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/53394557#53394557", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>1) Install <code>.exe</code> from > <a href=\"https://sourceforge.net/projects/mingw-w64/\" rel=\"noreferrer\">https://sourceforge.net/projects/mingw-w64/</a></p>\n\n<p>1.2) ! use <code>x86_64</code> architecture</p>\n\n<p>2) Add <code>C:\\Program Files\\mingw-w64\\x86_64-8.1.0-posix-seh-rt_v6-rev0\\mingw64\\bin</code> to <code>PATH</code> in <code>User Variables</code> and in <code>System Variables</code>. For me it works. </p>\n\n<p>! To edit <code>Path</code> variable press <code>Windows</code> key, type 'path', choose 'Edit the system environment variables', click 'Environment Variables', find <code>Path</code> variable in <code>System variables</code> and in <code>User variables</code> then edit.</p>\n"}, {"comments": [{"owner": {"reputation": 319, "user_id": 4662031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bVoOM.jpg?s=128&g=1", "display_name": "Neo Ravi", "link": "https://stackoverflow.com/users/4662031/neo-ravi"}, "edited": false, "score": 6, "creation_date": 1568649784, "post_id": 55705493, "comment_id": 102332906, "body": "use this command, when you are facing the issue in Ubuntu with sudo"}, {"owner": {"reputation": 411, "user_id": 4185058, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/079dd7a8c7c0f467db03b9945f88af3e?s=128&d=identicon&r=PG&f=1", "display_name": "ilya_direct", "link": "https://stackoverflow.com/users/4185058/ilya-direct"}, "edited": false, "score": 0, "creation_date": 1573756875, "post_id": 55705493, "comment_id": 103998098, "body": "If you are facing with dependencies when installing try \u2018sudo aptitude install build-essential\u2019"}, {"owner": {"reputation": 21464, "user_id": 257645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/SE5gW.jpg?s=128&g=1", "display_name": "kfsone", "link": "https://stackoverflow.com/users/257645/kfsone"}, "edited": false, "score": 0, "creation_date": 1596580816, "post_id": 55705493, "comment_id": 111855898, "body": "Which Ubuntu shell stores the path in a variable called %PATH%?"}], "tags": [], "owner": {"reputation": 983, "user_id": 6499004, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-I0fHv3jbsbs/AAAAAAAAAAI/AAAAAAAADUo/bejrpeXzWwg/photo.jpg?sz=128", "display_name": "mahima", "link": "https://stackoverflow.com/users/6499004/mahima"}, "is_accepted": false, "score": 67, "last_activity_date": 1578495652, "last_edit_date": 1578495652, "creation_date": 1555408824, "answer_id": 55705493, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/55705493#55705493", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>If you are running Ubuntu do:</p>\n\n<pre><code>apt-get install build-essential\n</code></pre>\n\n<p>This solved the problem. It installs the gcc/g++ compilers and libraries.</p>\n"}, {"comments": [{"owner": {"reputation": 1994, "user_id": 401247, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/81842c3186cf426caca39581bc518700?s=128&d=identicon&r=PG", "display_name": "rhody", "link": "https://stackoverflow.com/users/401247/rhody"}, "edited": false, "score": 3, "creation_date": 1586996999, "post_id": 56230658, "comment_id": 108339431, "body": "You don&#39;t need to reset your PC. Just restart whatever shell you&#39;re using."}], "tags": [], "owner": {"reputation": 103, "user_id": 6144218, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efe73e75f8815598b039d4a4221e6dd4?s=128&d=identicon&r=PG&f=1", "display_name": "Le Nguyen", "link": "https://stackoverflow.com/users/6144218/le-nguyen"}, "is_accepted": false, "score": 6, "last_activity_date": 1558409067, "creation_date": 1558409067, "answer_id": 56230658, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/56230658#56230658", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>On window install <a href=\"http://tdm-gcc.tdragon.net/download\" rel=\"noreferrer\">http://tdm-gcc.tdragon.net/download</a>, after installed it, you need to reset your PC. that all</p>\n"}, {"tags": [], "owner": {"reputation": 836, "user_id": 2643124, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/9kiH1.jpg?s=128&g=1", "display_name": "Alexey Shevelyov", "link": "https://stackoverflow.com/users/2643124/alexey-shevelyov"}, "is_accepted": false, "score": 4, "last_activity_date": 1575816122, "last_edit_date": 1575816122, "creation_date": 1573489281, "answer_id": 58805043, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/58805043#58805043", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>You can try - this is not a solution but a temp workaround</p>\n\n<pre><code>cgo_enabled=0 go build \n</code></pre>\n\n<p>Once you install gcc - and make sure %PATH has a way to find it (gcc.exe) - this should go away.</p>\n\n<p>Also running this one will ensure the cgo_enabled variable will stay this way as long as terminal is open. That way you don't have to prefix it each time you do a build.</p>\n\n<pre><code>export cgo_enabled=0 go build \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12681737, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-AF19jpxyMao/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rdod5_m8DjyCHRc9B5DeZxKbL9DFg/photo.jpg?sz=128", "display_name": "Tangerang Bebas", "link": "https://stackoverflow.com/users/12681737/tangerang-bebas"}, "is_accepted": false, "score": 0, "last_activity_date": 1578565322, "creation_date": 1578565322, "answer_id": 59661812, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/59661812#59661812", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>same as other, just install tdm-gcc, but you can use its terminal, \"MinGW\", you can access it from start menu folder tdm-gcc, after start, browse to your project, and run it again</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 6794147, "user_type": "registered", "profile_image": "https://graph.facebook.com/1755446098042810/picture?type=large", "display_name": "premnikf7", "link": "https://stackoverflow.com/users/6794147/premnikf7"}, "is_accepted": false, "score": 1, "last_activity_date": 1583467933, "creation_date": 1583467933, "answer_id": 60557460, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/60557460#60557460", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>Kindly install the MINGW after GUI will automatically take.</p>\n\n<p><a href=\"http://mingw.org/wiki/Getting_Started\" rel=\"nofollow noreferrer\">http://mingw.org/wiki/Getting_Started</a> </p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 12790371, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21c80bfc401eb59f1b90cb0d8c89ae04?s=128&d=identicon&r=PG", "display_name": "Romen Rodr&#237;guez", "link": "https://stackoverflow.com/users/12790371/romen-rodr%c3%adguez"}, "is_accepted": false, "score": 2, "last_activity_date": 1584587282, "last_edit_date": 1584587282, "creation_date": 1584548717, "answer_id": 60743616, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/60743616#60743616", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>on Ubuntu its very easy but on windows need to do it:</p>\n\n<ol>\n<li>download MinGW on <a href=\"http://www.mingw.org/\" rel=\"nofollow noreferrer\">http://www.mingw.org/</a> </li>\n<li>install on basic package Gcc-g++ (see <a href=\"https://i.stack.imgur.com/Wu2MI.png]\" rel=\"nofollow noreferrer\">this image</a>)</li>\n<li>add on environment Patch of windows variables. </li>\n<li>restart and continue with \"go get ...\"</li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 36, "user_id": 13761929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1fee403cc19757d7321469b5a9fc5b5f?s=128&d=identicon&r=PG&f=1", "display_name": "Aman Agarwal", "link": "https://stackoverflow.com/users/13761929/aman-agarwal"}, "is_accepted": false, "score": 0, "last_activity_date": 1604991296, "creation_date": 1604991296, "answer_id": 64764170, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/64764170#64764170", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<pre><code>$ go env\n</code></pre>\n<p>check <strong>CGO_ENABLED</strong> if its <strong>1</strong> change it to <strong>0</strong> by</p>\n<pre><code>$export CGO_ENBLED=0 \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4957, "user_id": 13161155, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4SPLU.jpg?s=128&g=1", "display_name": "Yagiz Degirmenci", "link": "https://stackoverflow.com/users/13161155/yagiz-degirmenci"}, "is_accepted": false, "score": 1, "last_activity_date": 1608036421, "creation_date": 1608036421, "answer_id": 65306134, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/65306134#65306134", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>If you are using an alpine based image with your Dockerfile</p>\n<p>Install <code>build-base</code> which will be met with your requirements.</p>\n<pre><code>apk add build-base\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 13092018, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ada659a7684f0344fd28e7cdc440e51?s=128&d=identicon&r=PG&f=1", "display_name": "vraj9845", "link": "https://stackoverflow.com/users/13092018/vraj9845"}, "is_accepted": false, "score": 2, "last_activity_date": 1609297994, "creation_date": 1609297994, "answer_id": 65501562, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/65501562#65501562", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>If you are running Ubuntu do:</p>\n<pre><code>sudo apt-get update\nsudo apt-get install build-essential.\n</code></pre>\n<p>If the above commands do not work do:</p>\n<pre><code>sudo add-apt-repository &quot;deb http://archive.ubuntu.com/ubuntu $(lsb_release -sc) main universe&quot;\n</code></pre>\n<p>The main component contains applications that are free software, can be freely redistributed and are fully supported by the Ubuntu team. &amp; The universe component is a snapshot of the free, open-source, and Linux world.</p>\n<p>Then install package by following command in terminal:</p>\n<pre><code>sudo apt-get update\nsudo apt-get install build-essential.\n</code></pre>\n<p>For more info click here: <a href=\"https://itectec.com/ubuntu/ubuntu-problem-installing-build-essential-on-14-04-1-lts-duplicate/\" rel=\"nofollow noreferrer\">https://itectec.com/ubuntu/ubuntu-problem-installing-build-essential-on-14-04-1-lts-duplicate/</a></p>\n"}, {"comments": [{"owner": {"reputation": 461, "user_id": 6040845, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/58d857fe106deab72a45f1752cd261fd?s=128&d=identicon&r=PG", "display_name": "SlyOtis", "link": "https://stackoverflow.com/users/6040845/slyotis"}, "edited": false, "score": 0, "creation_date": 1618313169, "post_id": 66449449, "comment_id": 118558693, "body": "You mad genius, thanks ;)"}], "tags": [], "owner": {"reputation": 1648, "user_id": 9935654, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XdoefqMBYAQ/AAAAAAAAAAI/AAAAAAAAIfg/qFXt_RO4q5s/photo.jpg?sz=128", "display_name": "Carson", "link": "https://stackoverflow.com/users/9935654/carson"}, "is_accepted": false, "score": 2, "last_activity_date": 1614734924, "creation_date": 1614734924, "answer_id": 66449449, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/66449449#66449449", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>I also encountered this message, but in my case, it was missing <code>gcc.exe</code>. I used <a href=\"https://chocolatey.org/\" rel=\"nofollow noreferrer\">choco</a> and installed <code>mingw</code>, and then it worked.</p>\n<p>details:</p>\n<ol>\n<li>download <a href=\"https://chocolatey.org/install\" rel=\"nofollow noreferrer\">choco</a></li>\n<li><code>choco install mingw -y</code></li>\n<li>check: <code>gcc -v</code></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 9314999, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ebk6F8EE6oU/AAAAAAAAAAI/AAAAAAAADK4/sPkRnmTPses/photo.jpg?sz=128", "display_name": "Peter Santoso", "link": "https://stackoverflow.com/users/9314999/peter-santoso"}, "is_accepted": false, "score": 0, "last_activity_date": 1618059061, "creation_date": 1618059061, "answer_id": 67034546, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build/67034546#67034546", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>On Windows, you can install gcc by Scoop:</p>\n<pre><code>scoop install gcc\n</code></pre>\n"}], "owner": {"reputation": 981, "user_id": 6925001, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9b72670bf5e25a9a80bf5bd136428a50?s=128&d=identicon&r=PG&f=1", "display_name": "jaswanth", "link": "https://stackoverflow.com/users/6925001/jaswanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106318, "favorite_count": 19, "accepted_answer_id": 43588236, "answer_count": 18, "score": 76, "last_activity_date": 1618059061, "creation_date": 1493010205, "last_edit_date": 1499770120, "question_id": 43580131, "link": "https://stackoverflow.com/questions/43580131/exec-gcc-executable-file-not-found-in-path-when-trying-go-build", "title": "exec: &quot;gcc&quot;: executable file not found in %PATH% when trying go build", "body": "<p>I am using Windows 10. When I tried to build <a href=\"http://hyperledger-fabric.readthedocs.io/en/latest/chaincode.html\" rel=\"noreferrer\">Chaincode</a> it reported this error</p>\n\n<pre><code># github.com/hyperledger/fabric/vendor/github.com/miekg/pkcs11 \nexec: \"gcc\": executable file not found in %PATH%\n</code></pre>\n\n<p>My chaincode imports:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"strconv\"\n\n    \"github.com/hyperledger/fabric/core/chaincode/shim\"\n    pb \"github.com/hyperledger/fabric/protos/peer\"\n)\n</code></pre>\n\n<p>It's running fine in <a href=\"https://www.docker.com/\" rel=\"noreferrer\">Docker</a>.</p>\n"}, {"tags": ["go", "import", "package"], "answers": [{"comments": [{"owner": {"reputation": 22380, "user_id": 284111, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7540f1aac4d78cc963f6551e8307b757?s=128&d=identicon&r=PG", "display_name": "Andrew Savinykh", "link": "https://stackoverflow.com/users/284111/andrew-savinykh"}, "edited": false, "score": 1, "creation_date": 1615189275, "post_id": 43580332, "comment_id": 117604197, "body": "There is no <code>#PackageNames</code> under ` <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>` any longer."}], "tags": [], "owner": {"reputation": 6247, "user_id": 1307186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/387ed5b468ef3d8d0d668ea772a4d043?s=128&d=identicon&r=PG", "display_name": "darethas", "link": "https://stackoverflow.com/users/1307186/darethas"}, "is_accepted": true, "score": 20, "last_activity_date": 1609746096, "last_edit_date": 1609746096, "creation_date": 1493011247, "answer_id": 43580332, "question_id": 43579838, "link": "https://stackoverflow.com/questions/43579838/relationship-between-a-package-statement-and-the-directory-of-a-go-file/43580332#43580332", "title": "Relationship between a package statement and the directory of a .go file", "body": "<p>If what you said was true, then your function call would actually be 1-<code>foodir.FooFunc()</code> instead of <code>foopkg.FooFunc()</code>. Instead, go sees the package name in 2-foofile.go and imports it as <code>foopkg</code> because in go the name of the package is exactly what comes after the words <code>package</code> at the top of .go files, provided it is a valid identifier.</p>\n<p>The only use of the directory is for collecting a set of files that share the same package name. This is reiterated in <a href=\"https://golang.org/ref/spec#Package_clause\" rel=\"nofollow noreferrer\">the spec</a></p>\n<blockquote>\n<p>A set of files sharing the same PackageName form the implementation of a package. An implementation may require that all source files for a package inhabit the same directory.</p>\n</blockquote>\n<p>In go, it is convention that the directory match the package name but this doesn't have to be the case, and often it is not with 3rd party packages. The stdlib does do a good job of sticking to this convention.</p>\n<p>Now where directories <em>do</em> come into play is the import path. You could have 2 packages named 'foo' in your single binary as long as they had <em>different</em> import paths, i.e.</p>\n<p><code>/some/path/1/foo</code> and <code>/some/path/2/foo</code></p>\n<p>And we can get really swanky and alias the imports to whatever we wanted, for example I could do</p>\n<pre><code>import (\n    bar &quot;/some/path/1/foo&quot;\n    baz &quot;/some/path/2/foo&quot;\n)\n</code></pre>\n<p>Again the reason this works is not because the package name has to be unique, but the package import path must be unique.</p>\n<p>Another bit of insight to glean from this statement is -- within a directory, you cannot have two package names. The go compiler will throw an error stating it <code>cannot load package</code> and that it <code>found packages foo (foo.go) and bar (bar.go)</code>.</p>\n<p>See <a href=\"https://golang.org/doc/code.html#PackageNames\" rel=\"nofollow noreferrer\">https://golang.org/doc/code.html#PackageNames</a> for more information.</p>\n"}, {"comments": [{"owner": {"reputation": 6247, "user_id": 1307186, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/387ed5b468ef3d8d0d668ea772a4d043?s=128&d=identicon&r=PG", "display_name": "darethas", "link": "https://stackoverflow.com/users/1307186/darethas"}, "edited": false, "score": 0, "creation_date": 1493039160, "post_id": 43581869, "comment_id": 74227171, "body": "plus one for the bit about the go tools I missed that in my answer."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 7, "last_activity_date": 1493017820, "creation_date": 1493017820, "answer_id": 43581869, "question_id": 43579838, "link": "https://stackoverflow.com/questions/43579838/relationship-between-a-package-statement-and-the-directory-of-a-go-file/43581869#43581869", "title": "Relationship between a package statement and the directory of a .go file", "body": "<p>Roughly for the why:</p>\n\n<ol>\n<li><p>Packages have a \"name\" which is set by the package clause, the <code>package thepackagename</code> at the start of your source code.</p></li>\n<li><p>Importing packages happens by pretty much opaque strings: the import path in the import declarations.</p></li>\n</ol>\n\n<p>The first is the name and the second how to find that name. The first is for the programmer, the second for the compiler / the toolchain.\nIt is very convenient (for compilers and programmers) to state</p>\n\n<blockquote>\n  <p>Please import the package found in <code>\"/some/hierarchical/location\"</code></p>\n</blockquote>\n\n<p>and then refer to that package by it's simple name like <code>robot</code> in statements like</p>\n\n<pre><code>robot.MoveTo(3,7)\n</code></pre>\n\n<p>Note that using this package like </p>\n\n<pre><code>/some/hierarchical/location.MoveTo(3.7)\n</code></pre>\n\n<p>would not be legal code and neither readable nor clear nor convenient.\nBut to for the compiler / the toolchain it is nice if the import path has structure and allows to express arbitrary package locations, i.e. not only locations in a filesystem, but e.g. inside an archive or on remote machines, or or or.</p>\n\n<p>Also important to note in all this: There is the Go compiler and the <code>go</code> tool. The Go compiler and the go tool are different things and the go tool imposes more restrictions on how you lay out your code, your workspace and your packages than what the Go compiler and the language spec would require. (E.g. the Go compiler allows to compile files from different directories into one package without any problems.)</p>\n\n<p>The <code>go</code> tool mandates that all (there are special cases, I know) your source files of a package reside in one file system directory and common sense mandates that this directory should be \"named like the package\".</p>\n"}, {"tags": [], "owner": {"reputation": 1163, "user_id": 5335565, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-coM64Z-2njg/AAAAAAAAAAI/AAAAAAAAADs/r4GxkKH6FII/photo.jpg?sz=128", "display_name": "Izana", "link": "https://stackoverflow.com/users/5335565/izana"}, "is_accepted": false, "score": 1, "last_activity_date": 1609783077, "last_edit_date": 1609783077, "creation_date": 1609782582, "answer_id": 65567375, "question_id": 43579838, "link": "https://stackoverflow.com/questions/43579838/relationship-between-a-package-statement-and-the-directory-of-a-go-file/65567375#65567375", "title": "Relationship between a package statement and the directory of a .go file", "body": "<p>First thing first, the package clause and import path are different things.</p>\n<p><a href=\"https://golang.org/ref/spec#Package_clause\" rel=\"nofollow noreferrer\">package clause</a> declares <code>PackageName</code>:</p>\n<pre><code>PackageClause  = &quot;package&quot; PackageName .\nPackageName    = identifier .\n</code></pre>\n<p>The purpose of a package clause is to group files:</p>\n<blockquote>\n<p>A set of files sharing the same PackageName form the implementation of a package.</p>\n</blockquote>\n<p><strong>By convention</strong>, the path basename (directory name) of <code>ImportPath</code> (see below) is the same as <code>PackageName</code>. It's recommended for convenient purposes that you don't need to ponder what's the <code>PackageName</code> to be used.</p>\n<p>However, they can be different.</p>\n<p>The basename only affects the <code>ImportPath</code>, check <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">spec for import declartions</a>:</p>\n<pre><code>ImportDecl       = &quot;import&quot; ( ImportSpec | &quot;(&quot; { ImportSpec &quot;;&quot; } &quot;)&quot; ) .\nImportSpec       = [ &quot;.&quot; | PackageName ] ImportPath .\nImportPath       = string_lit .\n</code></pre>\n<blockquote>\n<p>If the PackageName is omitted, it defaults to the identifier specified in the package clause of the imported package.</p>\n</blockquote>\n<p>For example, if you have a dir <code>foo</code> but you declare <code>package bar</code> in a source file resides in it, when you <code>import &lt;prefix&gt;/foo</code>, you will use <code>bar</code> as a prefix to reference any exported symbols from that package.</p>\n<p><a href=\"https://stackoverflow.com/a/43580332/5335565\">darehas' answer</a> raises a good point: you can't declare multiple packages under the same basename. However, according to <a href=\"https://golang.org/ref/spec#Package_clause\" rel=\"nofollow noreferrer\">package clause</a>, you can spread the same package over different basenames:</p>\n<blockquote>\n<p>An implementation <strong>may</strong> require that all source files for a package inhabit the same directory.</p>\n</blockquote>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6175, "favorite_count": 2, "accepted_answer_id": 43580332, "answer_count": 3, "score": 22, "last_activity_date": 1609783077, "creation_date": 1493008176, "last_edit_date": 1493011797, "question_id": 43579838, "link": "https://stackoverflow.com/questions/43579838/relationship-between-a-package-statement-and-the-directory-of-a-go-file", "title": "Relationship between a package statement and the directory of a .go file", "body": "<p>See this experiment.</p>\n\n<pre><code>~/go/src$ tree -F\n.\n\u251c\u2500\u2500 1-foodir/\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 2-foofile.go\n\u2514\u2500\u2500 demo.go\n\n1 directory, 2 files\n\n~/go/src$ cat demo.go \npackage main\n\nimport (\n    \"fmt\"\n    \"1-foodir\"\n)\n\nfunc main() {\n    fmt.Println(foopkg.FooFunc())\n}\n\n~/go/src$ cat 1-foodir/2-foofile.go \npackage foopkg\n\nfunc FooFunc() string {\n    return \"FooFunc\"\n}\n\n~/go/src$ GOPATH=~/go go run demo.go \nFooFunc\n</code></pre>\n\n<p>I thought that we always import a package name. But the above example\nshows that we actually import a package directory name (<code>\"1-foodir\"</code>)\nbut while invoking exported names within that package, we use the\npackage name declared in the Go files (<code>foopkg.FooFunc</code>).</p>\n\n<p>This is confusing for a beginner like me who comes from Java and Python world,\nwhere the directory name itself is the package name used to qualify\nmodules/classes defined in the package.</p>\n\n<p>Why is there a difference in the way we use <code>import</code> statement and\nrefer to names defined in the package in Go? Can you explain the rules\nbehind these things about Go?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1493018644, "post_id": 43579805, "comment_id": 74213317, "body": "I think the main problem is a conceptual. Who owns the data? Who the rules? what is the difference between a <code>Rule</code> and a <code>Condition</code>. Your point 2 indicates that getData() always returns the same type of data, otherwise it <i>cannot</i> be abstracted or Data has to conform to a certain interface. I think your point 2 is the main problem in your design: The different rules operate on different data and the only thing in common is that rules can be evaluated. Maybe you could clarify your ideas a bit more?"}, {"owner": {"reputation": 185, "user_id": 1505303, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sG4lw.jpg?s=128&g=1", "display_name": "krystalcode", "link": "https://stackoverflow.com/users/1505303/krystalcode"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493059384, "post_id": 43579805, "comment_id": 74240921, "body": "Hi @Volker, thanks for the comment. Quite possibly the design might need improvement. I saw some value in decoupling fetching/preparing the data and evaluating the conditions, and I can implement this design in other OOP languages by skipping type checking on the Data only, so I went for that. But most likely in most cases the structure of the data will be tightly coupled with the conditions evaluated upon them, so it might be appropriate to put them together. I&#39;ll look into that direction and I&#39;ll post if there&#39;s anything interesting."}], "owner": {"reputation": 185, "user_id": 1505303, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/sG4lw.jpg?s=128&g=1", "display_name": "krystalcode", "link": "https://stackoverflow.com/users/1505303/krystalcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493022073, "creation_date": 1493007974, "question_id": 43579805, "link": "https://stackoverflow.com/questions/43579805/overcoming-interface-limitations-in-complex-design-in-go", "title": "Overcoming interface limitations in complex design in Go", "body": "<p>I want to set an interface that enforces the following behavior. Structs that implement the Rules interface, implement a prepareData() function, they contain Conditions that Evaluate() the prepared data, and return a result. If the data passes all conditions, actions can be triggered.</p>\n\n<p>There may be different structs that implement this Rules interface e.g. a JSONRules object as in the example below, where the prepared data are in JSON format, and a JSON Condition that simply checks for a value of a field in the JSON object. Or it could be something completely different e.g. GET a URL and check if it is reachable with HTTP status is 200.</p>\n\n<p>There's 3 objectives in the design:</p>\n\n<ol>\n<li><p>The main program should be agnostic to the implementation e.g. whether it's JSONRules or a URLRules that it's executing. It should simply be able to say Do(Rules) e.g. do what you have to do and let me know the result.</p></li>\n<li><p>The sequence of execution e.g. prepareData(), evaluateConditions() should be abstracted since it is the same for all Rules and we shouldn't have to write it all over again.</p></li>\n<li><p>As part of the sequence of execution, actions will be triggered via a separate, specialized component which could be an external API, which is one more reason that this part should be abstracted and not re-implemented by each individual rules.</p></li>\n</ol>\n\n<p>Below is an example of how I went about implementing this. The problem that I face is that the Data and the way the data are evaluated by each Condition are different for every implementation, which means that the Condition interface cannot be aware of certain fields or functions, but yet, the implementations need to follow the interfaces. I therefore get a \"data.actualValue undefined (type Data is interface with no methods)\" error in the following example.</p>\n\n<p>The code should speak for itself, if I'm not explaining this well. Are there are any design pattern in Go that would help overcoming the limitations in interfaces in Go?</p>\n\n<p>Here is a link to the code at the Go Playground:\n<a href=\"https://play.golang.org/p/G9XnEZ74bM\" rel=\"nofollow noreferrer\">https://play.golang.org/p/G9XnEZ74bM</a></p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n)\n\nfunc main() {\n  condition := JSONCondition{ \"Expected Value\" }\n  rules := JSONRules{\n    RulesBase{\n      data : nil,\n      conditions : []Condition{ condition },\n    },\n  }                                                                                                                                                                                                                         \n  Do(rules)\n}\n\ntype Rules interface {\n  getData() Data\n  getConditions() []Condition\n  prepareData()\n  evaluateConditions() bool\n}\n\ntype RulesBase struct {\n  data         Data\n  conditions []Condition\n}\n\nfunc (rules RulesBase) getData() Data {\n  return rules.data\n}\n\nfunc (rules RulesBase) getConditions() []Condition {\n  return rules.conditions\n}\n\nfunc (rules RulesBase) evaluateConditions() bool {\n  allOk := true\n  for _, condition := range rules.getConditions() {\n    ok := condition.Evaluate(rules.getData())\n    if !ok {\n      allOk = false\n      break\n    }\n  }  \n\n  return allOk\n}\n\nfunc Do(rules Rules) {\n  rules.prepareData()\n  ok := rules.evaluateConditions()\n\n  if ok {\n    // Take some actions if the conditions evaluated successfully.                                                                                                                                                                           \n    fmt.Println(\"Conditions passed.\")\n  }\n}\n\ntype Data interface {}\n\ntype Condition interface {\n  Evaluate(Data) bool\n}\n\ntype JSONRules struct {\n  RulesBase\n  // Could have additional fields that would be used to prepare the data such as                                                                                                                                                             \n  // a URL to fetch data from in the prepareData() function.                                                                                                                                                                                 \n}\n\nfunc (rules JSONRules) prepareData() {\n  rules.data = JSONData {\n    actualValue : \"Expected Value\",\n  }\n}\n\ntype JSONData struct {\n  actualValue string\n}\n\ntype JSONCondition struct {\n  expectedValue string\n}\n\nfunc (condition JSONCondition) Evaluate(data Data) bool {\n  if data.actualValue == condition.expectedValue {\n    return true\n  }\n\n  return false\n}\n</code></pre>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493007936, "post_id": 43579391, "comment_id": 74209057, "body": "Writing your own &quot;generic&quot; CopyStruct when a simple <code>a=b</code> would do seems rather strange."}, {"owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493013072, "post_id": 43579391, "comment_id": 74210667, "body": "but this a and b are of different struct type.So i cannot use a=b...."}, {"owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493013859, "post_id": 43579391, "comment_id": 74210942, "body": "i have added the sample code in go playgroundThanks"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1493015706, "post_id": 43579391, "comment_id": 74211750, "body": "Okay, I understand. This is not a copy so you should not call it a copy. Note that this is a difficult task. Please read <a href=\"https://blog.golang.org/laws-of-reflection\" rel=\"nofollow noreferrer\">blog.golang.org/laws-of-reflection</a> <i>at</i> <i>least</i> <i>twice</i> and make sure you understand every word in there. Then note that two nested loops over the fields is overkill and probably wrong: Iterate once, find the field by name and set it. Also note that you <i>do</i> <i>not</i> need to type assert stuff here, all you need is the right level of indirection."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1493015755, "post_id": 43579391, "comment_id": 74211788, "body": "Shameless plug: Take a look at <a href=\"https://github.com/vdobler/ht/tree/master/populate\" rel=\"nofollow noreferrer\">github.com/vdobler/ht/tree/master/populate</a> how copying one structure into an other structure can be done. Note especially how <a href=\"https://github.com/vdobler/ht/blob/master/populate/populate.go#L277\" rel=\"nofollow noreferrer\">github.com/vdobler/ht/blob/master/populate/populate.go#L277</a> handles interface values and pointers."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1493025695, "post_id": 43579391, "comment_id": 74217490, "body": "Also note that Go convention is to have the destination argument be first, and the source argument second--opposite of what you&#39;ve done."}, {"owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1493104003, "post_id": 43579391, "comment_id": 74256867, "body": "Thanks Volker...Your link is showing me a good example of how to do it.Thanks very much...."}, {"owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "edited": false, "score": 0, "creation_date": 1493104126, "post_id": 43579391, "comment_id": 74256937, "body": "Thanks for your info..Much appreciated...Flimzy...."}], "owner": {"reputation": 232, "user_id": 7590816, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8e7262f8d0422f90bb77ac563ca9ad15?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh kumar", "link": "https://stackoverflow.com/users/7590816/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 612, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1493042875, "creation_date": 1493004910, "last_edit_date": 1493042875, "question_id": 43579391, "link": "https://stackoverflow.com/questions/43579391/need-to-do-dynamic-type-assertion-to-interface", "title": "Need to do dynamic type assertion to interface", "body": "<p>I would like to copy the values from one struct to another. I will be using this function many times and each time object of different struct types are passed. So I use a generic <code>interface{}</code> type as the arguments of the function.</p>\n\n<p>For reference, please look this code <a href=\"https://play.golang.org/p/d6JDySAU0v\" rel=\"nofollow noreferrer\">https://play.golang.org/p/d6JDySAU0v</a></p>\n\n<pre><code>func CopyStruct(oldValue interface{}, newValue interface{}) interface{} {\n   /*Please do note that the arguments oldValue and newValue of CopyStruct function is \n      of different struct types.*/     \n            oldReflect := reflect.ValueOf(oldValue)\n            newReflect := reflect.ValueOf(newValue)\n            newReflectAdd := reflect.ValueOf(&amp;newValue)\n\n            for i := 0; i &lt; oldReflect.NumField(); i++ {\n                field := oldReflect.Field(i)\n                ValueType := oldReflect.Type().Field(i)\n                for j := 0; j &lt; newReflect.NumField(); j++ {\n\n                    newType := newReflect.Type().Field(j)\n                    switch field.Kind() {\n                    case reflect.String:\n                         if ValueType.Name == newType.Name {                           \n                               newReflect.Elem().FieldByName(newType.Name).SetString(field.String())\n                        }       \n                    case reflect.Int:\n                        if ValueType.Name == newType.Name {\n                              newReflectAdd.Elem().FieldByName(newType.Name).SetInt(field.Int())\n                        }\n                    }\n                }\n            }\n            return newReflectAdd\n        }\n</code></pre>\n\n<p>The above code produces the following error:</p>\n\n<pre><code>Handler crashed with error reflect: call of reflect.Value.FieldByName on interface Value\n</code></pre>\n\n<p>It seems the error is the following line:</p>\n\n<pre><code>newReflectAdd.Elem().FieldByName(newType.Name).SetString(field.String())\n</code></pre>\n\n<p>But if I use type assertion for <code>newValue</code> before this line then there is no error.</p>\n\n<pre><code>typeAssert := newValue.(Info)\nnewReflectAdd := reflect.ValueOf(&amp;typeAssert)\n</code></pre>\n\n<p>Since I am going to use this function as generic for many struct types I don't know how to type assert dynamically.</p>\n"}, {"tags": ["go", "solid-principles"], "answers": [{"tags": [], "owner": {"reputation": 4480, "user_id": 1440057, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/TBIqJ.jpg?s=128&g=1", "display_name": "Nikhil Vartak", "link": "https://stackoverflow.com/users/1440057/nikhil-vartak"}, "is_accepted": false, "score": 1, "last_activity_date": 1493007234, "creation_date": 1493007234, "answer_id": 43579699, "question_id": 43578965, "link": "https://stackoverflow.com/questions/43578965/implementing-solid-design-in-go-application/43579699#43579699", "title": "Implementing SOLID Design in Go application", "body": "<p>I am not a Go guy but since it's a design question, it doesn't matter. Disallowing duplicate emails is a business requirement. Moreover as per business requirements there can be other stuff that you need to do before/after validations but before hitting database store.</p>\n\n<p>I would put validations in another package which will act as a business logic layer and references model and store packages. I will keep models clean like we have POCO, POJO in C#, Java respectively. Don't know what to call them in Go context. POGO is reserved for Groovy :).</p>\n\n<p>See the pseudo code below:</p>\n\n<pre><code>// business\nfunction AddUser(email) {\n    User user;\n    // validate\n    user = store.GetUserByEmail(email);\n    if (user) {\n        // shout\n    }\n    else {\n        user = new User { Email = email }; // basically initialize user instance to store\n        store.InsertUser(user); \n    }\n}\n</code></pre>\n\n<p>That's just basic I talked about. You could define interfaces that your business package uses to talk to store, followed by dependency injection and what not.</p>\n"}], "owner": {"reputation": 2103, "user_id": 3162553, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/5a4b9cec47f016074898f79d29293d9b?s=128&d=identicon&r=PG&f=1", "display_name": "user3162553", "link": "https://stackoverflow.com/users/3162553/user3162553"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 388, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1493025914, "creation_date": 1493001755, "last_edit_date": 1493025914, "question_id": 43578965, "link": "https://stackoverflow.com/questions/43578965/implementing-solid-design-in-go-application", "title": "Implementing SOLID Design in Go application", "body": "<p><strong>What's the best way to model a model (user) and a database without running into circular dependencies?</strong></p>\n\n<p>I have a Go application that I'm trying to set up.  The structure of imports is confusing because it doesn't cleanly appear to divide along separation of concerns. I would like to have a database store that requires access to the names of models to migrate them. It seems odd to have models migrate themselves and that seems like an unrelated concern to the models. At the same time, I would like to have validations per model that require the importing of the database store. It seems even more odd to have the store validate individual models. This creates a circular dependency however.</p>\n\n<p>structure:</p>\n\n<pre><code>models\n  - user.go\nconfig\n  - store.go\n</code></pre>\n\n<p><code>store.go</code></p>\n\n<pre><code>...\n// CreateDb - creates table\nfunc (i *Store) CreateDb() {\n    ...\n    i.DB.AutoMigrate(&amp;models.User{})\n    ...\n}\n...\n</code></pre>\n\n<p><code>user.go</code></p>\n\n<pre><code>package models\n\ntype User struct {\n  Email string\n}\n\nfunc (u *User) ValidateUser() (err []error) {\n    messages := make([]error, 0)\n\n    // Uniqueness Validations\n    email := \"\"\n\n    email = config.Database.DB.Where(\"email LIKE ?\", u.Email).First(&amp;User)\n    if email != \"\" {\n        messages = append(messages, errors.New(\"Email has to be unique\"))\n\n    }\n\n    return messages\n}\n</code></pre>\n\n<p>I've tried putting them into a third package but that fails because they both require the same dependency - store.  I've also tried putting them all into the same package which I suppose works but that seems to breakdown all structure and sep of concerns.</p>\n\n<p>Advice?</p>\n\n<p><strong>My solution</strong></p>\n\n<p>I ended up decoupling the database pointer into a separate package and then made the migrations a part of a bootstrap process. I kept validations in line with the models package however. </p>\n"}, {"tags": ["go", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492984616, "post_id": 43575101, "comment_id": 74204016, "body": "That&#39;s one of those cases when using monads is practical (not to simply look cool): implement an <code>Either</code> monad and your expression would convert to <code>pkg := Either.Of(expression).Bind(GetExpStmt).Bind(GetX).Bind(...)</code>. It would return the value that either what you want or an error/null/a structure with additional data, that you can handle gracefully."}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1492984842, "creation_date": 1492984842, "answer_id": 43576979, "question_id": 43575101, "link": "https://stackoverflow.com/questions/43575101/concise-way-to-do-multiple-interface-conversions-in-golang/43576979#43576979", "title": "Concise way to do multiple interface conversions in Golang?", "body": "<p>There is no way, that I know of, to chain <em>type assertions</em>. But you can simplify this specific example by extracting duplicate code into its own function.</p>\n\n<pre><code>func fnSelExpr(s ast.Stmt) (*ast.SelectorExpr, bool) {\n    if xs, ok := s.(*ast.ExprStmt); ok {\n        if cx, ok := xs.X.(*ast.CallExpr); ok {\n            return cx.Fun.(*ast.SelectorExpr)\n        }\n    }\n    return nil, false\n}\n</code></pre>\n\n<p>Then you can simplify your <code>processFunction</code> like this.</p>\n\n<pre><code>func processFunction(e *ast.FuncDecl) {\n    // Save wrapper function name\n    f := e.Name.Name\n\n    for _, expression := range e.Body.List {\n        logrus.Printf(\"Current stmt: %#v\", expression)\n\n        sx, ok := fnSelExpr(expression)\n        if !ok {\n            continue\n        }\n\n        var pkg string\n        if id, ok := sx.X.(*ast.Ident); ok {\n            pkg = id.Name\n        }\n        fn := sx.Sel.Name\n\n        fcall := fmt.Sprintf(\"%s.%s\", pkg, fn)\n        logrus.Printf(\"Yay. found my function call: \", fcall)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 14735, "user_id": 167814, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/53ee4a3bcfdb4e8f4c37991900ab48ef?s=128&d=identicon&r=PG", "display_name": "Abhijeet Rastogi", "link": "https://stackoverflow.com/users/167814/abhijeet-rastogi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 224, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1492984842, "creation_date": 1492973252, "last_edit_date": 1492978447, "question_id": 43575101, "link": "https://stackoverflow.com/questions/43575101/concise-way-to-do-multiple-interface-conversions-in-golang", "title": "Concise way to do multiple interface conversions in Golang?", "body": "<p>I'm trying to parse function calls from a code using <code>go/ast</code> package.</p>\n\n<p>To do that, I first find all function calls like:</p>\n\n<pre><code>ast.Inspect(f, func(n ast.Node) bool {\n    switch x := n.(type) {\n    case *ast.FuncDecl:\n        processFunction(x)\n    }\n    return true\n})\n</code></pre>\n\n<p>And then, processFunction() looks like this:</p>\n\n<pre><code>func processFunction(e *ast.FuncDecl) {\n    // Save wrapper function name\n    f := e.Name.Name\n\n    for _, expression := range e.Body.List {\n        logrus.Printf(\"Current stmt: %#v\", expression)\n        pkg := expression.(*ast.ExprStmt).X.(*ast.CallExpr).Fun.(*ast.SelectorExpr).X.(*ast.Ident).Name\n        fn := expression.(*ast.ExprStmt).X.(*ast.CallExpr).Fun.(*ast.SelectorExpr).Sel.Name\n        fcall := fmt.Sprintf(\"%s.%s\", pkg, fn)\n        logrus.Printf(\"Yay. found my function call: \", fcall)\n    }\n\n}\n</code></pre>\n\n<p>The problem with this code is that if that particular hierarchy is not found in AST, the program panics. I know that we can do interface conversions gracefully via</p>\n\n<pre><code>x, ok := x.(type)\n</code></pre>\n\n<p>But, if I do each conversion like this, my code will be huge. Trying to use that in this fails of course.</p>\n\n<pre><code>    pkg, ok := expression.(*ast.ExprStmt).X.(*ast.CallExpr).Fun.(*ast.SelectorExpr).X.(*ast.Ident).Name\n    if !ok {\n        continue\n    }\n</code></pre>\n\n<p>Error:</p>\n\n<pre><code>./parser.go:41: assignment count mismatch: 2 = 1\n</code></pre>\n\n<p>Is there a concise way to do these series of conversions and also fail gracefully if this hierarchy is not found?</p>\n"}, {"tags": ["file", "go", "overwrite"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1492982934, "post_id": 43573849, "comment_id": 74203532, "body": "Can you maybe share the content of the body? And what&#39;s the last byte that&#39;s not getting overwritten? Using your code I can&#39;t seem to be able to recreate your issue. <a href=\"https://play.golang.org/p/0mASED0hSs\" rel=\"nofollow noreferrer\">Here&#39;s the playground</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1493040883, "post_id": 43573849, "comment_id": 74228487, "body": "You haven&#39;t provided code to reproduce the problem. Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself."}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 1, "last_activity_date": 1493026620, "creation_date": 1493026620, "answer_id": 43584623, "question_id": 43573849, "link": "https://stackoverflow.com/questions/43573849/trouble-overwriting-file-content/43584623#43584623", "title": "Trouble overwriting file content", "body": "<p>The problem may occurred because the data is written into a same file (shared resource) inside an http handler, and the handler itself may be executed concurrently. You need to lock access to the file during data serialization (overwriting process). Quick solution will be:</p>\n\n<pre><code>import (\n   \"sync\"\n   //... other packages\n)\n\nvar muFile sync.Mutex\n\nfunc (h PostKey) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    muFile.Lock()\n    defer muFile.Unlock()\n\n    f, err := os.Create(\"received.dat\")\n    //other statements\n    //...\n}\n</code></pre>\n\n<p>If your server load is low, the above solution will be fine. But if your server needs to handle a lot of requests concurrently, you need to use different approach (although the rule is the same, lock access to any shared resource). </p>\n"}, {"tags": [], "owner": {"reputation": 135, "user_id": 4031013, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joachim Havloujian", "link": "https://stackoverflow.com/users/4031013/joachim-havloujian"}, "is_accepted": true, "score": 0, "last_activity_date": 1493055186, "creation_date": 1493055186, "answer_id": 43594456, "question_id": 43573849, "link": "https://stackoverflow.com/questions/43573849/trouble-overwriting-file-content/43594456#43594456", "title": "Trouble overwriting file content", "body": "<p>I was writing to the file and trying to overwrite it in the same context, and so parts of the first write operation were still in memory and not yet written to the disk. By using <code>f.Sync()</code> to flush everything after copying the bodys content I was able to fix the issue.</p>\n"}], "owner": {"reputation": 135, "user_id": 4031013, "user_type": "registered", "accept_rate": 88, "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Joachim Havloujian", "link": "https://stackoverflow.com/users/4031013/joachim-havloujian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1573, "favorite_count": 0, "accepted_answer_id": 43594456, "answer_count": 2, "score": -1, "last_activity_date": 1493055186, "creation_date": 1492965846, "question_id": 43573849, "link": "https://stackoverflow.com/questions/43573849/trouble-overwriting-file-content", "title": "Trouble overwriting file content", "body": "<p>I've got trouble overwriting a files content with zeros. The problem is that the very last byte of the original file remains, even when I exceed its size by 100 bytes. Someone got an idea what I'm missing?</p>\n\n<pre><code>func (h PostKey) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    f, err := os.Create(\"received.dat\")\n    if err != nil {\n        w.WriteHeader(http.StatusInternalServerError)\n        return\n    }\n    defer f.Close()\n\n    _, err = io.Copy(f, r.Body)\n    if err != nil {\n        w.WriteHeader(http.StatusInternalServerError)\n        return\n    }\n\n    // Retrieve filesize\n    size, _ := f.Seek(0, 1)\n    zeroFilled := make([]byte, size + 100)\n    n, err := f.WriteAt(zeroFilled, 0)\n    if err != nil {\n        return\n    }\n\n    fmt.Printf(\"Size: %d\\n\", size) // prints 13\n    fmt.Printf(\"Bytes written: %d\\n\", n) // prints 113\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 1, "creation_date": 1492962197, "post_id": 43572928, "comment_id": 74196078, "body": "Sorry, that was a typo on my part. The async function should indeed take in that receiver. I&#39;ve updated my code."}, {"owner": {"reputation": 1362, "user_id": 1638814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/79045cf2a5e6cd8d939d0e6d39327133?s=128&d=identicon&r=PG", "display_name": "nvartolomei", "link": "https://stackoverflow.com/users/1638814/nvartolomei"}, "edited": false, "score": 0, "creation_date": 1492974795, "post_id": 43572928, "comment_id": 74200867, "body": "<code>atomic.LoadInt32(&amp;currProc) &lt;= maxProc</code> this condition shouldn&#39;t be negated? currProc will break on first iteration, even before spawned goroutines take chance to run"}], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 1, "last_activity_date": 1492963983, "creation_date": 1492963983, "answer_id": 43573527, "question_id": 43572928, "link": "https://stackoverflow.com/questions/43572928/goroutine-that-takes-a-channel-receiver-and-sends-string-to-channel/43573527#43573527", "title": "goroutine that takes a channel receiver and sends string to channel", "body": "<p>One problem with your code is that the closure around your go routine invocation is too big.</p>\n\n<pre><code>for _, item := range list {\n    go func() {\n        doAsyncAndIncrement(item, strReceiver, &amp;currProc)\n        str += &lt;-strReceiver \n    }()\n}\n</code></pre>\n\n<p><code>item</code> is scoped to the for loop, not the anonymous function in your goroutine, so while you firing off N goroutines, your <code>item</code> variable meanwhile is being updated in a for loop.  To remedy this, pass the variable to your goroutine explicitly, to avoid using a closure:</p>\n\n<pre><code>for _, item := range list {\n    go func(item string) {\n        doAsyncAndIncrement(item, strReceiver, &amp;currProc)\n        str += &lt;-strReceiver \n    }(item)\n}\n</code></pre>\n"}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 181, "favorite_count": 0, "accepted_answer_id": 43573527, "answer_count": 1, "score": 3, "last_activity_date": 1492963983, "creation_date": 1492960809, "last_edit_date": 1492962212, "question_id": 43572928, "link": "https://stackoverflow.com/questions/43572928/goroutine-that-takes-a-channel-receiver-and-sends-string-to-channel", "title": "goroutine that takes a channel receiver and sends string to channel", "body": "<p>I am trying to make a loop of goroutines that take a channel that receives strings, and every time it is received it should append the value to another string. Only at the end of all goroutines (the goroutine count should be the length of the <code>list</code> passed in), should the code continue on.</p>\n\n<p>My example below doesn't seem to append the values from the <code>strReceiver</code> channel onto <code>str</code>, because str is never modified.</p>\n\n<p>Anyone know what's wrong?</p>\n\n<pre><code>func appendToStr(str string, list []string, origin *url.URL) {\n    var currProc int32 = 0;\n    var maxProc int32 = int32(len(list))\n\n    var strReceiver := make(chan string, len(list))\n    for _, item := range list {\n        go func() {\n            doAsyncAndIncrement(item, strReceiver, &amp;currProc)\n            str += &lt;-strReceiver \n        }()\n    }\n\n    for {\n        if atomic.LoadInt32(&amp;currProc) &lt;= maxProc {\n            break;\n        }\n    }\n\n    // continue on using 'str' which now contains the append values from the 'strReceiver' channel\n}\n\nfunc doAsyncAndIncrement(item string, receiver chan&lt;- string, count *int32) {\n    defer atomic.AddInt32(count, 1)\n\n    var val string\n    // do something with 'item' and set 'val'...\n\n    receiver &lt;- val\n}\n</code></pre>\n"}, {"tags": ["go", "timestamp", "mariadb"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1492950863, "post_id": 43571120, "comment_id": 74191961, "body": "&quot;Unfortunately values within the past 60 minutes are converted by humanize.Time() as 1 hour from now&quot; --- that does not sound right: <a href=\"https://github.com/dustin/go-humanize/blob/master/times_test.go\" rel=\"nofollow noreferrer\">github.com/dustin/go-humanize/blob/master/times_test.go</a> What do you expect to get as a result?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492950881, "post_id": 43571120, "comment_id": 74191965, "body": "This doesn&#39;t sound like a problem with the database at all, but with humanize.Time. Am I misunderstanding something?  What happens if you limit your test code to using a manually-input time, instead of reading from the db? Do you get the same behavior?"}, {"owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "edited": false, "score": 0, "creation_date": 1492951324, "post_id": 43571120, "comment_id": 74192120, "body": "The humanize package works fine; when I use time.Time() in the humanize.Time() function, I receive values like &quot;4 seconds ago&quot;. So that&#39;s great. My problem is that I cannot convert the database value <code>2017-04-23 14:00:16 +0000 UTC</code> to <code>2017-04-23 14:00:16 +0000 UTC</code>. So I think I need to convert UTC to CEST."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492952755, "post_id": 43571120, "comment_id": 74192604, "body": "I suggest focusing your question on &quot;I cannot convert the database value <code>2017-04-23 14:00:16 +0000 UTC</code> to 2<code>017-04-23 14:00:16 +0000 UTC</code>&quot; and removing the details about humanize.Time"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1492952783, "post_id": 43571120, "comment_id": 74192611, "body": "You don&#39;t need to convert it manually, <code>time.Parse</code> will do the job. You can verify the result by adding <code>fmt.Printf(&quot;Time Difference = %v\\n&quot;, time.Now().Sub(t))</code> to your example."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1492955143, "post_id": 43571120, "comment_id": 74193481, "body": "IMHO, nothing is wrong with the example code. I guess, the time is stored in the database as <code>Local</code> timestamp, but when you read it through go code, it&#39;s interpreted as UTC timestamp. If yes, according to <a href=\"https://github.com/go-sql-driver/mysql#timetime-support\" rel=\"nofollow noreferrer\">this</a>, you may need to specify the timezone explicitly by adding <code>loc=CEST</code> to the connection string."}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 118, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492950622, "creation_date": 1492950229, "last_edit_date": 1492950622, "question_id": 43571120, "link": "https://stackoverflow.com/questions/43571120/use-timestamp-from-mysql-in-humanize-time-package", "title": "Use timestamp from Mysql in humanize.Time() package", "body": "<p>I have a mariaDB database with a timestamp field. I want the values from that field being parsed to <code>time.Time()</code> values. This is possible by adding the <code>?parseTime=true</code> to the connection string. After fetching a row, I want to use the value (which is time.Time) with <a href=\"https://github.com/dustin/go-humanize\" rel=\"nofollow noreferrer\">humanize.Time()</a>. Unfortunately values within the past 60 minutes are converted by humanize.Time() as <code>1 hour from now</code>. When I put directly a time.Time() value into humanize.Time(), it gives me <code>x seconds ago</code>.</p>\n\n<p>So I don't know what I'm doing wrong here. I think I need to convert <code>2017-04-23 14:00:16 +0000 UTC</code> to <code>2017-04-23 14:00:16.370758048 +0200 CEST</code>, but how?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"time\"\n\n    humanize \"github.com/dustin/go-humanize\"\n)\n\n// value from database: 2017-04-23 14:00:16 +0000 UTC\n// typical time.Now() value: 2017-04-23 14:00:16.370758048 +0200 CEST\n\nfunc main() {\n    layout := \"2006-01-02 15:04:05 -0700 MST\"\n    beforeParsing := \"2017-04-23 14:00:16 +0000 UTC\"\n\n    t, err := time.Parse(layout, beforeParsing)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Println(t)\n    fmt.Println(humanize.Time(t))\n}\n</code></pre>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 789, "user_id": 7641174, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-mT1i-1QabTQ/AAAAAAAAAAI/AAAAAAAAAcU/tMWPD90e4Uw/photo.jpg?sz=128", "display_name": "Mustansir Zia", "link": "https://stackoverflow.com/users/7641174/mustansir-zia"}, "is_accepted": false, "score": -1, "last_activity_date": 1504640974, "last_edit_date": 1504640974, "creation_date": 1504637138, "answer_id": 46061470, "question_id": 43570981, "link": "https://stackoverflow.com/questions/43570981/protobuf-golang-import-proto-and-pb-proto-from-different-directories/46061470#46061470", "title": "protobuf golang import .proto and .pb.proto from different directories", "body": "<p>Use <code>package generated;</code> inside your <code>hello.proto</code> file.</p>\n\n<p>Then, <code>protoc -I proto/ proto/*.proto --go_out=generated</code> will generate a <code>hello.pb.go</code> inside <code>generated</code> folder by the package name of <code>generated</code>.</p>\n\n<p>The package inside the proto files tells the protobuf generator which package to use inside the generated file. </p>\n"}, {"tags": [], "owner": {"reputation": 166, "user_id": 3832688, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40ebe86abe805ad3184eec19574c932e?s=128&d=identicon&r=PG&f=1", "display_name": "Jendrik", "link": "https://stackoverflow.com/users/3832688/jendrik"}, "is_accepted": false, "score": 1, "last_activity_date": 1566994700, "last_edit_date": 1566994700, "creation_date": 1566986112, "answer_id": 57689674, "question_id": 43570981, "link": "https://stackoverflow.com/questions/43570981/protobuf-golang-import-proto-and-pb-proto-from-different-directories/57689674#57689674", "title": "protobuf golang import .proto and .pb.proto from different directories", "body": "<p>What worked for me is to define <code>option go_package = \"github.com/&lt;your-account&gt;/&lt;your-cool-project&gt;/&lt;sub-dirs&gt;</code></p>\n\n<p>Let's assume you have the folder structure your stated:</p>\n\n<pre><code>.\n|-- proto\n|---- hello.proto\n|\n|-- generated\n\u2514---- hello.pb.go\n</code></pre>\n\n<p>In your case you would add <code>option go_package = \"&lt;path&gt;/&lt;in&gt;/&lt;GOPATH&gt;/generated\"</code> to <code>hello.proto</code>.\nWhat is important is that you then have to run</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>protoc -I. --go_out=$GOPATH ./*.proto\n</code></pre>\n\n<p>Generally, I would generate the go files alongside the proto files to keep the import paths the same for proto and go files. But this might be a matter of taste. In that case you would then simply set <code>option go_package = \"&lt;path&gt;/&lt;in&gt;/&lt;GOPATH&gt;/proto\"</code> to <code>hello.proto</code>. </p>\n\n<p>In both cases a relative import of the <code>.proto</code> file should now resolve to the proper import in the generated Go code and the <code>.pb.go</code> files should also be put into the proper Go package folders.</p>\n"}], "owner": {"reputation": 4212, "user_id": 1660762, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/x6IJ8.jpg?s=128&g=1", "display_name": "Dotan", "link": "https://stackoverflow.com/users/1660762/dotan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4661, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1566994700, "creation_date": 1492949478, "last_edit_date": 1492950955, "question_id": 43570981, "link": "https://stackoverflow.com/questions/43570981/protobuf-golang-import-proto-and-pb-proto-from-different-directories", "title": "protobuf golang import .proto and .pb.proto from different directories", "body": "<p>I have a library called myProtos which looks like this</p>\n\n<pre><code>.\n|-- proto\n|---- hello.proto\n|\n|-- generated\n\u2514---- hello.pb.go\n</code></pre>\n\n<p>I have a .proto file outside called <code>example.proto</code> that should import <code>hello.proto</code></p>\n\n<p>So the top of the file looks like this:</p>\n\n<pre><code>syntax = \"proto3\";\npackage example;\nimport \"path/to/myProtos/proto/hello.proto\"\n</code></pre>\n\n<p>Now, when I compile <code>example.proto</code> I get an import error on <code>example.pb.go</code> because it has the import line import \"path/to/myProtos/proto/hello.pb.go\"</p>\n\n<p>I tried adding both import paths, but I get an 'import but not used error'. I also tried doing relative imports and passing both directories as flags to protoc, which worked, but I need the import path in the go file to be absolute.</p>\n\n<p>How can I tell protoc that on the go file the path is different?</p>\n\n<p>Is there a better 'best practice' in this case?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1492944835, "post_id": 43570119, "comment_id": 74190110, "body": "Check out this related / possible duplicate question+answer: <a href=\"http://stackoverflow.com/questions/40823315/go-x-does-not-implement-y-method-has-a-pointer-receiver/40824044#40824044\">Go, X does not implement Y (\u2026 method has a pointer receiver)</a>"}], "answers": [{"comments": [{"owner": {"reputation": 35680, "user_id": 1206051, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZYa1h.png?s=128&g=1", "display_name": "treecoder", "link": "https://stackoverflow.com/users/1206051/treecoder"}, "edited": false, "score": 0, "creation_date": 1498482855, "post_id": 43570687, "comment_id": 76501877, "body": "Alright, now I understand the difference between pointer and value receivers. One question then. Why does <code>a.Compare(&amp;b)</code> work? I am defining a pointer receiver, but <code>a := Apple{&quot;red&quot;}</code> makes <code>a</code> a value, not a pointer. Then why does <code>a.Compare(&amp;b)</code> compile?"}, {"owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "reply_to_user": {"reputation": 35680, "user_id": 1206051, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZYa1h.png?s=128&g=1", "display_name": "treecoder", "link": "https://stackoverflow.com/users/1206051/treecoder"}, "edited": false, "score": 1, "creation_date": 1500571448, "post_id": 43570687, "comment_id": 77409019, "body": "From <a href=\"https://golang.org/doc/effective_go.html#methods\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#methods</a>: &quot;The rule about pointers vs. values for receivers is that value methods can be invoked on pointers and values, but pointer methods can only be invoked on pointers.&quot; followed by some words on why the language has been designed like that"}], "tags": [], "owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "is_accepted": false, "score": 3, "last_activity_date": 1492947646, "last_edit_date": 1495541864, "creation_date": 1492947646, "answer_id": 43570687, "question_id": 43570119, "link": "https://stackoverflow.com/questions/43570119/understanding-type-assertions-with-interfaces-and-pointers-in-go/43570687#43570687", "title": "Understanding type assertions with interfaces and pointers in Go", "body": "<p>For reasons outlined in <a href=\"https://stackoverflow.com/a/11131348/5085211\">this answer</a>, <code>Apple</code> does not implement <code>Fruit</code>, but <code>*Apple</code> does. If you define <code>Color</code> on <code>Apple</code> (instead of <code>*Apple</code>), the code compiles:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\ntype Fruit interface {\n    Color() string\n}\n\ntype Apple struct {\n    color string\n}\n\nfunc (x Apple) Color() string {\n    return x.color\n}\n\nfunc (x Apple) Compare(y Fruit) bool {\n    _, ok := y.(Apple)\n\n    if ok {\n        ok = y.Color() == x.Color()\n    }\n\n    return ok\n}\n\nfunc main() {\n    a := Apple{\"red\"}\n    b := Apple{\"green\"}\n\n    fmt.Println(a.Compare(b))\n}\n</code></pre>\n"}], "owner": {"reputation": 35680, "user_id": 1206051, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/ZYa1h.png?s=128&g=1", "display_name": "treecoder", "link": "https://stackoverflow.com/users/1206051/treecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 318, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1492953159, "creation_date": 1492944272, "last_edit_date": 1492953159, "question_id": 43570119, "link": "https://stackoverflow.com/questions/43570119/understanding-type-assertions-with-interfaces-and-pointers-in-go", "title": "Understanding type assertions with interfaces and pointers in Go", "body": "<p>Let's consider the following program</p>\n\n<pre><code>type Fruit interface {\n    Color() string\n}\n\ntype Apple struct {\n    color string\n}\n\nfunc (x *Apple) Color() string {\n    return x.color\n}\n\nfunc (x *Apple) Compare(y Fruit) bool {\n    _, ok := y.(*Apple)\n\n    if ok {\n        ok = y.Color() == x.Color()\n    }\n\n    return ok\n}\n\nfunc main() {\n    a := Apple{\"red\"}\n    b := Apple{\"green\"}\n\n    a.Compare(&amp;b)\n}\n</code></pre>\n\n<p>Now, note the last line that says <code>a.Compare(&amp;b)</code>. Here I am passing a pointer to <code>Apple</code>. This works <strong>correctly</strong>, but note that my <code>Compare</code>\nfunction does NOT accept the pointer <code>(y Fruit)</code>.</p>\n\n<p>Now if I change the last line to say <code>a.Compare(b)</code> then it gives me the following error:</p>\n\n<p><code>cannot use b (type Apple) as type Fruit in argument to a.Compare:\n    Apple does not implement Fruit (Color method has pointer receiver)\n</code></p>\n\n<p>What is [go]ing on here?</p>\n"}, {"tags": ["windows", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 5, "creation_date": 1492941333, "post_id": 43569617, "comment_id": 74189171, "body": "You should follow the <a href=\"https://golang.org/doc/install\" rel=\"nofollow noreferrer\">installation instructions</a>, which include upgrade instructions (by way of removal and installation). It&#39;s done entirely from the command line (at least for Unix-based OSes)."}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1493439435, "post_id": 43569617, "comment_id": 74429473, "body": "What is your OS ?   Install is OS specific"}, {"owner": {"reputation": 419, "user_id": 4400203, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2e5fea776f47fd32c002d302469cc952?s=128&d=identicon&r=PG&f=1", "display_name": "Saransh", "link": "https://stackoverflow.com/users/4400203/saransh"}, "edited": false, "score": 0, "creation_date": 1493526685, "post_id": 43569617, "comment_id": 74450588, "body": "I have windows 8.1"}, {"owner": {"reputation": 552, "user_id": 10069848, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ff64f056e636f925dbf03f5c0343064?s=128&d=identicon&r=PG&f=1", "display_name": "iBlehhz", "link": "https://stackoverflow.com/users/10069848/iblehhz"}, "edited": false, "score": 0, "creation_date": 1572415435, "post_id": 43569617, "comment_id": 103547660, "body": "I gave up and did the manual way. Just delete the Go file in whatever location you placed it in (mine was in C drive), uninstalled the previous msi version (I think this step should be optional) and installed the latest."}], "answers": [{"comments": [{"owner": {"reputation": 3784, "user_id": 6182569, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/595afc3cb368ac51e5643e7e71dfdb4d?s=128&d=identicon&r=PG", "display_name": "Mihailo", "link": "https://stackoverflow.com/users/6182569/mihailo"}, "edited": false, "score": 0, "creation_date": 1513276557, "post_id": 43569710, "comment_id": 82602184, "body": "In my personal experience gvm is not worth it. I&#39;ve already had go set-up. I just wanted make the updating <b>easier/faster</b>. A couple of basic functionalities were not working. Doing it the regular way seems cleaner and better <i>(to me)</i>."}, {"owner": {"reputation": 122, "user_id": 2795622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0kBLx.jpg?s=128&g=1", "display_name": "Goma_BR", "link": "https://stackoverflow.com/users/2795622/goma-br"}, "reply_to_user": {"reputation": 616, "user_id": 5911998, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-xjU7BaHGqcg/AAAAAAAAAAI/AAAAAAAAABU/JP57QVLOAl0/photo.jpg?sz=128", "display_name": "Joyston", "link": "https://stackoverflow.com/users/5911998/joyston"}, "edited": false, "score": 3, "creation_date": 1525157304, "post_id": 43569710, "comment_id": 87241954, "body": "@Joyston. As far as I know it doesn&#39;t work on Windows(there is nothing about it on their website and I&#39;m not a Windows user to be sure). However, it might work on the new bash for Windows 10. I&#39;m not sure though."}], "tags": [], "owner": {"reputation": 122, "user_id": 2795622, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0kBLx.jpg?s=128&g=1", "display_name": "Goma_BR", "link": "https://stackoverflow.com/users/2795622/goma-br"}, "is_accepted": true, "score": 5, "last_activity_date": 1492941751, "creation_date": 1492941751, "answer_id": 43569710, "question_id": 43569617, "link": "https://stackoverflow.com/questions/43569617/how-do-i-update-golang-from-command-prompt-on-windows/43569710#43569710", "title": "How do I update golang from command prompt on Windows?", "body": "<p>I think that GVM could be a good option for that. GVM is an interface to manage Go versions in your computer. It allows you to change the Go version and even installing/uninstalling different golang versions by command prompt.</p>\n\n<p>You can install a new version by typing:</p>\n\n<pre><code>gvm install go1.4 -B\ngvm use go1.4\nexport GOROOT_BOOTSTRAP=$GOROOT\ngvm install go1.5\n</code></pre>\n\n<p>Or even get a list of golang versions installed in your computer:</p>\n\n<pre><code>gvm list\n</code></pre>\n\n<p>More information can be found on their website: <a href=\"https://github.com/moovweb/gvm\" rel=\"noreferrer\">https://github.com/moovweb/gvm</a></p>\n"}, {"comments": [{"owner": {"reputation": 2313, "user_id": 862919, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/B7VG8.jpg?s=128&g=1", "display_name": "Spets", "link": "https://stackoverflow.com/users/862919/spets"}, "edited": false, "score": 26, "creation_date": 1506321720, "post_id": 43691353, "comment_id": 79755085, "body": "This is poor form, telling people to make a blanket download of your utility and then invoking it via sudo.   I looked at the repo and it looks relatively legit still poor form and should not be recommended."}, {"owner": {"reputation": 3549, "user_id": 658270, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/56a007a4b2c47b141bd39790278f88a7?s=128&d=identicon&r=PG", "display_name": "Sonia Hamilton", "link": "https://stackoverflow.com/users/658270/sonia-hamilton"}, "edited": false, "score": 1, "creation_date": 1507164896, "post_id": 43691353, "comment_id": 80105921, "body": "Works for me, obrigada Everton/udhos :-)"}, {"owner": {"reputation": 1040, "user_id": 1323161, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7e9eb6fc4ba95a7c2fe0219637ab5650?s=128&d=identicon&r=PG", "display_name": "lee penkman", "link": "https://stackoverflow.com/users/1323161/lee-penkman"}, "edited": false, "score": 1, "creation_date": 1513281599, "post_id": 43691353, "comment_id": 82604754, "body": "Looks like it kind of worked for me :) had to simlink old /usr/bin/go which was still 1.6 to the newly installed /usr/local/go/bin/go afterwards."}, {"owner": {"reputation": 22380, "user_id": 284111, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/7540f1aac4d78cc963f6551e8307b757?s=128&d=identicon&r=PG", "display_name": "Andrew Savinykh", "link": "https://stackoverflow.com/users/284111/andrew-savinykh"}, "edited": false, "score": 23, "creation_date": 1523404019, "post_id": 43691353, "comment_id": 86544285, "body": "sudo? sh? On windows?"}, {"owner": {"reputation": 1861, "user_id": 1626185, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/a5875fb58f47e44741a116e652225407?s=128&d=identicon&r=PG&f=1", "display_name": "Eduardo La Hoz Miranda", "link": "https://stackoverflow.com/users/1626185/eduardo-la-hoz-miranda"}, "edited": false, "score": 1, "creation_date": 1546872946, "post_id": 43691353, "comment_id": 94986524, "body": "this comment should really be removed since OP is asking for Windows."}], "tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": false, "score": -9, "last_activity_date": 1493434668, "creation_date": 1493434668, "answer_id": 43691353, "question_id": 43569617, "link": "https://stackoverflow.com/questions/43569617/how-do-i-update-golang-from-command-prompt-on-windows/43691353#43691353", "title": "How do I update golang from command prompt on Windows?", "body": "<p>A simple way is to use the update-golang script:</p>\n\n<pre><code>git clone https://github.com/udhos/update-golang\ncd update-golang\nsudo ./update-golang.sh\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 939, "user_id": 860246, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/c0fcb6dc464f7419223fd6062b0e794b?s=128&d=identicon&r=PG", "display_name": "Mickael V.", "link": "https://stackoverflow.com/users/860246/mickael-v"}, "is_accepted": false, "score": 0, "last_activity_date": 1574930386, "creation_date": 1574930386, "answer_id": 59084695, "question_id": 43569617, "link": "https://stackoverflow.com/questions/43569617/how-do-i-update-golang-from-command-prompt-on-windows/59084695#59084695", "title": "How do I update golang from command prompt on Windows?", "body": "<p>The \"normal\" way for Windows is to use the MSI package that can be found here : <a href=\"https://golang.org/dl/\" rel=\"nofollow noreferrer\">https://golang.org/dl/</a>.</p>\n\n<p>Now if you <em>really</em> want to do it from the command line, you <strong>will nee</strong>d to know the version (current is 1.13.4). There are several ways I can think of, including scraping the golang website or leveraging the Docker tags matching image with <em>latest</em>.<br>\nIf you're doing this for administrative reasons, the version can also easily just be an input variable in your system.</p>\n\n<p>Once you know the version you need to download the file at <code>https://dl.google.com/go/go&lt;version&gt;.windows-amd64.msi</code>.<br>\nYou can use something like wget for Windows or just Powershell capabilities :<br>\n<code>Invoke-WebRequest -OutFile go1.13.4.windows-amd64.msi https://dl.google.com/go/go1.13.4.windows-amd64.msi</code></p>\n\n<p>Then you can just use the MSI in quiet mode :<br>\n<code>msiexec.exe /package go1.13.4.windows-amd64.msi /quiet</code></p>\n"}, {"comments": [{"owner": {"reputation": 2557, "user_id": 98694, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f37ce4c397c2854e6709f6a84f0c0821?s=128&d=identicon&r=PG", "display_name": "Dror Harari", "link": "https://stackoverflow.com/users/98694/dror-harari"}, "edited": false, "score": 0, "creation_date": 1614468675, "post_id": 61454833, "comment_id": 117395921, "body": "worked like charm updating from go1.11 to go1.16"}], "tags": [], "owner": {"reputation": 11, "user_id": 13416202, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/6126703214d14f9d99d1794d77538358?s=128&d=identicon&r=PG", "display_name": "David", "link": "https://stackoverflow.com/users/13416202/david"}, "is_accepted": false, "score": 0, "last_activity_date": 1587976728, "creation_date": 1587976728, "answer_id": 61454833, "question_id": 43569617, "link": "https://stackoverflow.com/questions/43569617/how-do-i-update-golang-from-command-prompt-on-windows/61454833#61454833", "title": "How do I update golang from command prompt on Windows?", "body": "<p>Go can also be updated using the <a href=\"https://chocolatey.org/packages/golang\" rel=\"nofollow noreferrer\">Chocolatey</a> package manager. Run from an elevated shell to minimize the risk of installation issues.</p>\n\n<p>Install using:</p>\n\n<pre><code>choco install golang -y\n</code></pre>\n\n<p>Update using:</p>\n\n<pre><code>choco upgrade golang -y\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15385989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a79bd67f4abd549a1ea753e5c575fd6?s=128&d=identicon&r=PG&f=1", "display_name": "Element-6", "link": "https://stackoverflow.com/users/15385989/element-6"}, "is_accepted": false, "score": 0, "last_activity_date": 1615595033, "creation_date": 1615595033, "answer_id": 66608882, "question_id": 43569617, "link": "https://stackoverflow.com/questions/43569617/how-do-i-update-golang-from-command-prompt-on-windows/66608882#66608882", "title": "How do I update golang from command prompt on Windows?", "body": "<p>If using Chocolatey mode of upgrade as David suggested, there is a possibility that the GOPATH defined on your system may not match with the existing one (if you had set a custom path via manual install).\nChocolatey, will install the Go binaries under %USERPROFILE%/go/bin --&gt; C:\\Program Files\\Go\\bin\nSo please ensure the path and update your environment variables accordingly.</p>\n<p>Installation message may look something like below, if the path changes.</p>\n<p>&quot;<em>Environment Vars (like PATH) have changed. Close/reopen your shell to\nsee the changes (or in powershell/cmd.exe just type <code>refreshenv</code>).\nThe upgrade of golang was successful.\nSoftware installed as 'msi', install location is likely default.</em>&quot;</p>\n"}], "owner": {"reputation": 419, "user_id": 4400203, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2e5fea776f47fd32c002d302469cc952?s=128&d=identicon&r=PG&f=1", "display_name": "Saransh", "link": "https://stackoverflow.com/users/4400203/saransh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25335, "favorite_count": 4, "accepted_answer_id": 43569710, "answer_count": 5, "score": 17, "last_activity_date": 1615595033, "creation_date": 1492941041, "last_edit_date": 1514940390, "question_id": 43569617, "link": "https://stackoverflow.com/questions/43569617/how-do-i-update-golang-from-command-prompt-on-windows", "title": "How do I update golang from command prompt on Windows?", "body": "<p>I have 1.7 version of golang and I want to update golang to 1.8 from command prompt. Uninstalling and Installing it again is always an option, but can I update it using commands on Windows 8.1?</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 6123704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e20c7424a7c984940268f4d65aa4aa74?s=128&d=identicon&r=PG", "display_name": "Florian Harwoeck", "link": "https://stackoverflow.com/users/6123704/florian-harwoeck"}, "edited": false, "score": 0, "creation_date": 1492940558, "post_id": 43569471, "comment_id": 74188917, "body": "Thanks! I knew the first part but didn&#39;t know there&#39;s something like <code>transaction</code>. Thank you! :)"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 1, "last_activity_date": 1505288661, "last_edit_date": 1505288661, "creation_date": 1492940054, "answer_id": 43569471, "question_id": 43569436, "link": "https://stackoverflow.com/questions/43569436/does-statement-close-affect-mysqls-thread-safe-last-insert-id-in-golang/43569471#43569471", "title": "Does Statement.Close affect mysql&#39;s thread-safe LAST_INSERT_ID in golang?", "body": "<p>Closing the statement, as you're doing, does not close the database connection.  The database connection is what's important for <code>LAST_INSERT_ID</code>.  Unless you call <a href=\"https://golang.org/pkg/database/sql/#DB.Close\" rel=\"nofollow noreferrer\"><code>db.Close()</code></a>, which closes the underlying connection, your connection remains open.</p>\n\n<p>However, <code>db</code> is a <em>pool</em> of connections, so there is no guarantee that you'll get the same connection on subsequent queries, regardless of closing the connection, unless you use a transaction.</p>\n\n<p>So in summary, you should do this (adding error handling, of course)</p>\n\n<pre><code>tx, _ := db.Begin()\n\nstmt, _ := tx.Prepare(\"INSERT INTO msg (message) VALUES(?)\")\nstmt.Exec(msg)\nstmt.Close()\n\nstmt, _ = tx.Prepare(\"SELECT LAST_INSERT_ID()\")\nstmt.QueryRow().Scan(&amp;msgid)\nstmt.Close()\n\n_ = tx.Commit()\n</code></pre>\n\n<hr>\n\n<p>However, note that a better way to do this is with <a href=\"https://golang.org/pkg/database/sql/#Result\" rel=\"nofollow noreferrer\">Result.LastInsertId</a>:</p>\n\n<pre><code>stmt, _ := tx.Prepare(\"INSERT INTO msg (message) VALUES(?)\")\nres, _ := stmt.Exec(msg)\nstmt.Close()\n\nmsgid := res.LastInsertId()\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 6123704, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e20c7424a7c984940268f4d65aa4aa74?s=128&d=identicon&r=PG", "display_name": "Florian Harwoeck", "link": "https://stackoverflow.com/users/6123704/florian-harwoeck"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 286, "favorite_count": 0, "accepted_answer_id": 43569471, "answer_count": 1, "score": 2, "last_activity_date": 1505288661, "creation_date": 1492939735, "last_edit_date": 1492939967, "question_id": 43569436, "link": "https://stackoverflow.com/questions/43569436/does-statement-close-affect-mysqls-thread-safe-last-insert-id-in-golang", "title": "Does Statement.Close affect mysql&#39;s thread-safe LAST_INSERT_ID in golang?", "body": "<p>I'm using go to insert a new user into the mysql database. Before inserting the user I save some kind of \"log-message\" in the <code>msg</code> table. Both tables (<code>msg</code>and <code>user</code>) have <code>auto-increment</code>. In order to receive the id chosen by auto-increment I use mysql's <code>LAST_INSERT_ID()</code> function. This should be thread-safe as pointed out in lots of other discussions on stack overflow, because it's bound to a single connection.</p>\n\n<p>I asked myself if <code>stmt.Close()</code> after every <code>stmt.Exec()</code> will change mysql's behavior (specially thread-safeness) in any way?</p>\n\n<pre><code>stmt, _ := db.Prepare(\"INSERT INTO msg (message) VALUES(?)\")\nstmt.Exec(msg)\nstmt.Close()\n\nstmt, _ = db.Prepare(\"SELECT LAST_INSERT_ID()\")\nstmt.QueryRow().Scan(&amp;msgid)\nstmt.Close()\n\nstmt, _ = db.Prepare(\"INSERT INTO user (msg_id) VALUES(?)\")\nstmt.Exec(msgid)\nstmt.Close()\n\nstmt, _ = db.Prepare(\"SELECT LAST_INSERT_ID()\")\nstmt.QueryRow().Scan(&amp;id)\nstmt.Close()\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492957171, "post_id": 43568404, "comment_id": 74194213, "body": "Much improved. Thank you."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492957209, "post_id": 43568404, "comment_id": 74194234, "body": "Two observations: 1. The text you claim to have is NOT JSON. (I&#39;m not sure what it is, though). 2. You&#39;re ignoring errors from <code>json.Unmarshal</code>. If you stop ignoring errors there, what do you learn?"}, {"owner": {"reputation": 1, "user_id": 7908336, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203144305764709/picture?type=large", "display_name": "Bijon", "link": "https://stackoverflow.com/users/7908336/bijon"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492964175, "post_id": 43568404, "comment_id": 74196918, "body": "Is there any way to convert that text/string into JSON? Thank you"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492964212, "post_id": 43568404, "comment_id": 74196934, "body": "There&#39;s a way to do anything you put your mind to. <i>How</i> to do it depends on your requirements. What form of JSON do you want?"}, {"owner": {"reputation": 1, "user_id": 7908336, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203144305764709/picture?type=large", "display_name": "Bijon", "link": "https://stackoverflow.com/users/7908336/bijon"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492964536, "post_id": 43568404, "comment_id": 74197060, "body": "In a form that I can use it to Unmarshal to Transaction type.."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1492964616, "post_id": 43568404, "comment_id": 74197095, "body": "It would be easier just to parse the string, rather than to parse it, then convert it into JSON, so that you can parse it again."}], "answers": [{"tags": [], "owner": {"reputation": 14311, "user_id": 5085211, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/eEZjd.png?s=128&g=1", "display_name": "fuglede", "link": "https://stackoverflow.com/users/5085211/fuglede"}, "is_accepted": false, "score": 0, "last_activity_date": 1492941817, "creation_date": 1492941817, "answer_id": 43569722, "question_id": 43568404, "link": "https://stackoverflow.com/questions/43568404/use-string-as-struct-value/43569722#43569722", "title": "Use string as struct value", "body": "<p>Given the comment, it looks like you are trying to unmarshal the string as JSON, but as it stands, the string is not valid JSON; if it were, you would be able to unmarshal it as follows, ignoring the fact that the fields to not appear to match up with the desired structure;</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype Transaction struct {\n    Bin               string `json:\"bin\"`\n    Fun               string `json:\"fun\"`\n    ID                string `json:\"id\"`\n    Timestamp         string `json:\"timestamp\"`\n    TraderA           string `json:\"traderA\"`\n    TraderB           string `json:\"traderB\"`\n    Seller            string `json:\"seller\"`\n    PointAmount       string `json:\"pointAmount\"`\n    PrevTransactionID string `json:\"prevTransactionId\"`\n}\n\nfunc main() {\n    snippet := `{\n        \"bin\": \"7f1acf61810da83210966b4f36765e96b1cd499b8926f4054ad978e78df7304a8fe035f6aa0a816c7f61e4fdd452383d9fe9d416b2db8a15bdd203fe67b9962f\",\n        \"fun\": \"init_transaction\",\n        \"id\": \"000117\",\n        \"timestamp\": \"gio\",\n        \"traderA\": \"moha\",\n        \"traderB\": \"5\",\n        \"seller\": \"12\",\n        \"pointAmount\": \"98773\",\n        \"prevTransactionId\": \"2017422\"\n        }`\n    t := Transaction{}\n    json.Unmarshal([]byte(snippet), &amp;t)\n    fmt.Println(t)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 7908336, "user_type": "registered", "profile_image": "https://graph.facebook.com/10203144305764709/picture?type=large", "display_name": "Bijon", "link": "https://stackoverflow.com/users/7908336/bijon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1492956496, "creation_date": 1492931727, "last_edit_date": 1492956496, "question_id": 43568404, "link": "https://stackoverflow.com/questions/43568404/use-string-as-struct-value", "title": "Use string as struct value", "body": "<p>I have this code. What I need is to get the transaction details from the transaction ID returned from blockchain</p>\n\n<pre><code>    package main\n\n    import (\n        \"encoding/base64\"\n        \"encoding/json\"\n        \"fmt\"\n        \"io/ioutil\"\n        \"log\"\n        \"net/http\"\n        \"strings\"\n    )\n\n    type Transaction struct {\n        Bid               string `json:\"bid\"`\n        Fun               string `json:\"fun\"`\n        ID                string `json:\"id\"`\n        Timestamp         string `json:\"timestamp\"`\n        TraderA           string `json:\"traderA\"`\n        TraderB           string `json:\"traderB\"`\n        Seller            string `json:\"seller\"`\n        PointAmount       string `json:\"pointAmount\"`\n        PrevTransactionID string `json:\"prevTransactionId\"`\n    }\n\n    type AllTxs struct {\n        TXs []Transaction `json:\"tx\"`\n    }\n    type Transact struct {\n        Cert        string `json:\"cert\"`\n        ChaincodeID string `json:\"chaincodeID\"`\n        Nonce       string `json:\"nonce\"`\n        Payload     string `json:\"payload\"`\n        Signature   string `json:\"signature\"`\n        Timestamp   string `json:\"nanos\"`\n        Txid        string `json:\"txid\"`\n        Type        int    `json:\"type\"`\n    }\n\n    func main() {\n        resp, err := http.Get(\"http://blockchain_transactions_url/trans_id\")\n        if err != nil {\n            // handle error\n        }\n        defer resp.Body.Close()\n        body, err := ioutil.ReadAll(resp.Body)\n        if err != nil {\n            log.Fatal(err)\n        }\n        byteArray := []byte(body)\n        var t Transact\n        json.Unmarshal(byteArray, &amp;t)\n        //I get all the values base64 encoded\n        st, err := base64.StdEncoding.DecodeString(t.Payload)\n        if err != nil {\n            log.Fatal(err)\n        }\n        trd := string(st)\n        sp := strings.Split(trd, \"\\n\")\n        result := strings.Join(sp, \",\")\n        res := strings.Replace(result, \",\", `\", \"`, -1)\n        ret := strings.Replace(res, `\", \"`, `{\"`, 1) + `\"}`\n\n        byteA := []byte(ret)\n        var tf AllTxs\n        json.Unmarshal(byteA, &amp;tf)\n        //the tf... \n        ref := Transaction{}\n\n        fmt.Println(ref.Id)\n\n    }\n</code></pre>\n\n<p><i>the t.Payload I get is </p>\n\n<p>\"CsYBCAESgwESgAE3ZjFhY2Y2MTgxMGRhODMyMTA5NjZiNGYzNjc2NWU5NmIxY2Q0OTliODkyNmY0MDU0YWQ5NzhlNzhkZjczMDRhOGZlMDM1ZjZhYTBhODE2YzdmNjFlNGZkZDQ1MjM4M2Q5ZmU5ZDQxNmIyZGI4YTE1YmRkMjAzZmU2N2I5OTYyZho8ChBpbml0X3RyYW5zYWN0aW9uCgYwMDAxMTcKA2dpbwoEbW9oYQoBNQoCMTIKBTk4NzczCgcyMDE3NDIy\"</i></p>\n\n<p><i>the tf I get is </p>\n\n<p>{\"??7f1acf61810da83210966b4f36765e96b1cd499b8926f4054ad978e78df7304a8fe035f6aa0a816c7f61e4fdd452383d9fe9d416b2db8a15bdd203fe67b9962f&lt;\", \"init_transaction\", \"000117\", \"gio\", \"moha\", \"5\", \"12\", \"98773\", \"2017422\"}</i></p>\n\n<p>At the last  how can I get the JSON of Transaction/AllTxs type?</p>\n"}, {"tags": ["for-loop", "go", "variable-declaration"], "comments": [{"owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "edited": false, "score": 0, "creation_date": 1492927330, "post_id": 43567914, "comment_id": 74186060, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/27960404/variable-declaration-in-init-statement-of-for-loop\">variable declaration in init statement of for loop</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492928454, "post_id": 43567914, "comment_id": 74186262, "body": "Why do you want to do that? There&#39;s probably a better solution."}, {"owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492933774, "post_id": 43567914, "comment_id": 74187378, "body": "@Flimzy I want to do that to learn if it is possible or not in the Go language."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492933999, "post_id": 43567914, "comment_id": 74187423, "body": "It&#39;s not possible to do that in Go. It is possible to accomplish the same goals in other ways, depending on what your exact needs are."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492957568, "post_id": 43567914, "comment_id": 74194364, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/15928071/in-go-how-can-i-automatically-coerce-my-loop-index-into-an-uint\">In Go, how can I automatically coerce my loop index into an uint?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 955936, "user_id": 29407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/e3a181e9cdd4757a8b416d93878770c5?s=128&d=identicon&r=PG", "display_name": "Darin Dimitrov", "link": "https://stackoverflow.com/users/29407/darin-dimitrov"}, "is_accepted": true, "score": 1, "last_activity_date": 1492927545, "creation_date": 1492927545, "answer_id": 43567957, "question_id": 43567914, "link": "https://stackoverflow.com/questions/43567914/how-to-declare-variable-types-for-loop-variables-in-go/43567957#43567957", "title": "How to declare variable types for loop variables in Go?", "body": "<p>Unfortunately the language specification doesn't allow you to declare the variable type in the for loop. The closest you could get is this:</p>\n\n<pre><code>var a int\nvar b string\nfor a, b = range arr {\n    fmt.Println(a, b)\n}\n</code></pre>\n\n<p>But normally if you give your variable meaningful names, their type would be clear as well:</p>\n\n<pre><code>for index, element := range arr {\n    fmt.Println(index, element)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3688, "user_id": 1957432, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ifc7y.jpg?s=128&g=1", "display_name": "Riad", "link": "https://stackoverflow.com/users/1957432/riad"}, "is_accepted": false, "score": 2, "last_activity_date": 1492927760, "creation_date": 1492927760, "answer_id": 43567978, "question_id": 43567914, "link": "https://stackoverflow.com/questions/43567914/how-to-declare-variable-types-for-loop-variables-in-go/43567978#43567978", "title": "How to declare variable types for loop variables in Go?", "body": "<p>You need to declare first the <code>vars</code>. </p>\n\n<pre><code>var x int\nvar y string ...// now it should be ok.\n\nfor x,y = range arr {\n    fmt.Println(x, y) // it should be x and y instead of a,b\n}\n</code></pre>\n\n<p>Check the <a href=\"https://tour.golang.org/flowcontrol/1\" rel=\"nofollow noreferrer\">fiddle</a></p>\n"}, {"comments": [{"owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "edited": false, "score": 0, "creation_date": 1492935903, "post_id": 43567988, "comment_id": 74187830, "body": "Is there a reason to explicitly specify the type of the variable in this statement: <code>var a int = 10</code>? I guess not. Why is this allowed then?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1492951110, "post_id": 43567988, "comment_id": 74192056, "body": "Yes, there is. Taken from your example, <code>10</code> is a valid value for any numeric type e.g. <code>byte&#47;int16&#47;int&#47;int64</code>. If you don&#39;t specify the type explicitly, the compiler will deduced the type as an <code>int</code>. If you want to declare a variable other than <code>int</code>, you need to specify it explicitly: <code>var x float32 = 10</code>"}, {"owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1492952103, "post_id": 43567988, "comment_id": 74192394, "body": "@putu How about <code>var s string = &quot;Foo&quot;</code>? Is there a reason to explicitly specify the type of the variable in this statement?"}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1492952525, "post_id": 43567988, "comment_id": 74192540, "body": "Quoting from the language specification (<a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Short_variable_declarations</a>):  &quot;Unlike regular variable declarations, a short variable declaration may redeclare variables provided they were originally declared earlier in the same block (or the parameter lists if the block is the function body) with the same type, and at least one of the non-blank variables is new. As a consequence, redeclaration can only appear in a multi-variable short declaration. Redeclaration does not introduce a new variable; it just assigns a new value to the original.&quot;"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1492953961, "post_id": 43567988, "comment_id": 74193058, "body": "If the type of right hand value is &quot;unique&quot;, you don&#39;t need to specify the variable type explicitly. Specifying the type explicitly will make the declaration much longer without added information (compared to short version)."}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 2, "last_activity_date": 1492927866, "creation_date": 1492927866, "answer_id": 43567988, "question_id": 43567914, "link": "https://stackoverflow.com/questions/43567914/how-to-declare-variable-types-for-loop-variables-in-go/43567988#43567988", "title": "How to declare variable types for loop variables in Go?", "body": "<p>First of all your code is not a valid Go code. The for range loop returns the index and the value of an array, slice, string, or map, so there is no reason the explicitly specify the type of the value and the index. </p>\n\n<p>You are specifying the type of the values at the variable initialization, and the language will deduce the type on the range iteration.</p>\n\n<p>One special case is when you are using <code>interface{}</code> as variable type. In this case, you if you need to know the type of the value you can use the <code>reflect</code> package to deduce the type of the value.</p>\n\n<pre><code>switch reflect.TypeOf(t).Kind() {\ncase reflect.Slice:\n    s := reflect.ValueOf(t)\n\n    for i := 0; i &lt; s.Len(); i++ {\n        fmt.Println(s.Index(i))\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5952594"}, "is_accepted": false, "score": 0, "last_activity_date": 1492928450, "creation_date": 1492928450, "answer_id": 43568052, "question_id": 43567914, "link": "https://stackoverflow.com/questions/43567914/how-to-declare-variable-types-for-loop-variables-in-go/43568052#43568052", "title": "How to declare variable types for loop variables in Go?", "body": "<p>It's not possible as you are trying to declare two different types of data in same line, if you want explicitly declare variables, then you need to declare them before itself like above answers, but if you want them to be of other type then you need to covert them as for your needs,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var arr = [4]string{\"foo\", \"bar\", \"baz\", \"qux\"}\n\n    var x int64\n    var b []byte\n    for x = 0; x &lt; int64(len(arr)); x++ {\n        b = []byte(arr[x])\n        fmt.Println(x, b)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 11828, "user_id": 1175080, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/5c1ca2e94db0e6c1dba18ddd8d563216?s=128&d=identicon&r=PG", "display_name": "Lone Learner", "link": "https://stackoverflow.com/users/1175080/lone-learner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1643, "favorite_count": 1, "accepted_answer_id": 43567957, "answer_count": 4, "score": 3, "last_activity_date": 1492928450, "creation_date": 1492926974, "question_id": 43567914, "link": "https://stackoverflow.com/questions/43567914/how-to-declare-variable-types-for-loop-variables-in-go", "title": "How to declare variable types for loop variables in Go?", "body": "<p>See this code.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var arr [4]string = [4]string{\"foo\", \"bar\", \"baz\", \"qux\"}\n\n    for a, b := range arr {\n        fmt.Println(a, b)\n    }\n\n    // How can I fix this code?\n    /*\n    for x int, y string = range arr {\n        fmt.Println(a, b)\n    }\n    */\n}\n</code></pre>\n\n<p>The first for loop uses the <code>:=</code> operator to automatically deduce the types of <code>a</code> and <code>b</code>. But what if I want to explicitly specify the types of the loop variables? My attempt to do this is in the second block of commented code which of course failed with the following error.</p>\n\n<pre><code># command-line-arguments\n./foo.go:15: syntax error: unexpected name, expecting {\n./foo.go:18: syntax error: unexpected }\n</code></pre>\n\n<p>Can you help me fix the second block of code such that I can specify the types of <code>x</code> and <code>y</code> explicitly?</p>\n"}, {"tags": ["go", "gob"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1492947698, "post_id": 43567907, "comment_id": 74190963, "body": "I got this error: <code>gob: type not registered for interface: http.bodyEOFSignal</code>. Are sure that you want to encode the whole part of <a href=\"https://golang.org/pkg/net/http/#Response\" rel=\"nofollow noreferrer\"><code>http.Response</code></a>?  The content (HTML page) of <code>http.Get</code> response is available through <code>Body</code> field (which is an interface and the data itself may not yet available immediately or it may be encoded in gzip etc.) and you should read it first into a buffer (or create a wrapper) then passing it to the gob encoder."}], "answers": [{"tags": [], "owner": {"reputation": 768, "user_id": 1038386, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SOhSk.jpg?s=128&g=1", "display_name": "Meehow", "link": "https://stackoverflow.com/users/1038386/meehow"}, "is_accepted": false, "score": 0, "last_activity_date": 1508581084, "creation_date": 1508581084, "answer_id": 46862236, "question_id": 43567907, "link": "https://stackoverflow.com/questions/43567907/gob-type-not-registered-for-interface-http-gzipreader/46862236#46862236", "title": "gob: type not registered for interface: http.gzipReader", "body": "<p>I solved this issue by implementing my own <code>ReadCloser</code>. Check <a href=\"https://github.com/meehow/http-caching-client/blob/master/client.go#L21\" rel=\"nofollow noreferrer\">HTTP Caching Client</a></p>\n"}], "owner": {"reputation": 731, "user_id": 5285339, "user_type": "registered", "accept_rate": 60, "profile_image": "https://lh6.googleusercontent.com/-h4ZkiWRb8vY/AAAAAAAAAAI/AAAAAAAAADU/Y0v70lrVKxc/photo.jpg?sz=128", "display_name": "Raja Hammad Farooq", "link": "https://stackoverflow.com/users/5285339/raja-hammad-farooq"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 479, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508581084, "creation_date": 1492926904, "question_id": 43567907, "link": "https://stackoverflow.com/questions/43567907/gob-type-not-registered-for-interface-http-gzipreader", "title": "gob: type not registered for interface: http.gzipReader", "body": "<p>I a simple TCP server that accept connection , Get a URL using http.Get and then encode the response using gob. But gob fails to encode http.gzipReader.\nOn encoding it gives following error message:</p>\n\n<pre><code>gob: type not registered for interface: http.gzipReader\n</code></pre>\n\n<p>My code is given below:</p>\n\n<pre><code>package main\nimport (\n    \"encoding/gob\"\n    \"fmt\"\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"os\"\n)\nconst (\n    CONN_HOST = \"localhost\"\n    CONN_PORT = \"3333\"\n    CONN_TYPE = \"tcp\"\n)\n\nfunc main() {\n    // Listen for incoming connections.\n    l, err := net.Listen(CONN_TYPE, CONN_HOST+\":\"+CONN_PORT)\n    if err != nil {\n        fmt.Println(\"Error listening:\", err.Error())\n        os.Exit(1)\n    }\n    for {\n        conn, err := l.Accept()\n        if err != nil {\n            fmt.Println(\"Error accepting: \", err.Error())\n            os.Exit(1)\n        }\n        go handleRequest(conn)\n    }\n}\nfunc handleRequest(conn net.Conn) {\n    res, err :=\n        http.Get(\"http://info.cern.ch/hypertext/WWW/TheProject.html\")\n    if err != nil {\n        log.Fatal(err)\n    } else {\n        encoder := gob.NewEncoder(conn)\n        er := encoder.Encode(res)\n        if er != nil {\n            fmt.Println(er)\n        }\n    }\n    conn.Write([]byte(\"Message received.\"))\n    conn.Close()\n}\n</code></pre>\n\n<p>Is there any way to encode  http.gzipReaderc ?? I saw an example of gob.Register() , but I am trying to registrer http.gzipReaderc . But unable to do so. can any one suggest me solution to this problem ?</p>\n"}, {"tags": ["go", "concurrency", "aws-lambda", "goroutine"], "comments": [{"owner": {"reputation": 1559, "user_id": 4108461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/naWEr.jpg?s=128&g=1", "display_name": "grepe", "link": "https://stackoverflow.com/users/4108461/grepe"}, "edited": false, "score": 0, "creation_date": 1492975120, "post_id": 43564886, "comment_id": 74200976, "body": "By default you cannot run more than 100 concurrent lambda functions on AWS. This limit can be lifted by submitting a request to support, but I don&#39;t think that&#39;s the best approach in your case. Do you really need to run all the requests for all users in parallel or would, say, 100 users at a time be enough? If so, there are better options than running 100 parallel lambdas."}, {"owner": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1492984853, "post_id": 43564886, "comment_id": 74204087, "body": "Be careful -- your database might become a bottleneck if you suddenly hit it with hundreds of concurrent requests. Might be better to spread requests out over a period of time rather than running them all at once."}, {"owner": {"reputation": 99, "user_id": 3249865, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7ca1a674460e6060f51f4da9328ae78?s=128&d=identicon&r=PG&f=1", "display_name": "invincible", "link": "https://stackoverflow.com/users/3249865/invincible"}, "reply_to_user": {"reputation": 1559, "user_id": 4108461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/naWEr.jpg?s=128&g=1", "display_name": "grepe", "link": "https://stackoverflow.com/users/4108461/grepe"}, "edited": false, "score": 0, "creation_date": 1492989947, "post_id": 43564886, "comment_id": 74205218, "body": "@grepe no 100 users at a time cant be enough, because its a system that tracks user activities by making some requests to apis every on hour in every day for all users, its like an analytics tool. i think 100 concurrent lambda functions with some delay optimisation would work but i am not sure"}, {"owner": {"reputation": 99, "user_id": 3249865, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7ca1a674460e6060f51f4da9328ae78?s=128&d=identicon&r=PG&f=1", "display_name": "invincible", "link": "https://stackoverflow.com/users/3249865/invincible"}, "reply_to_user": {"reputation": 162605, "user_id": 174777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6PnNW.jpg?s=128&g=1", "display_name": "John Rotenstein", "link": "https://stackoverflow.com/users/174777/john-rotenstein"}, "edited": false, "score": 0, "creation_date": 1492990025, "post_id": 43564886, "comment_id": 74205235, "body": "@JohnRotenstein thanks, i did not notice that db problem, i will think about that."}, {"owner": {"reputation": 1559, "user_id": 4108461, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/naWEr.jpg?s=128&g=1", "display_name": "grepe", "link": "https://stackoverflow.com/users/4108461/grepe"}, "edited": false, "score": 0, "creation_date": 1493051302, "post_id": 43564886, "comment_id": 74236261, "body": "@invincible i was going to suggest you put the users on kinesis stream, take them from there in chunks and send chunks of requests to the API... but thinking about it again i will only say that it&#39;s probably time to re-design your API (or app). receiving 100,000 concurrent requests is something any reasonable sysadmin would consider a DDOS attack (btw, 65535 is maximum IP connection can handle)."}], "answers": [{"comments": [{"owner": {"reputation": 99, "user_id": 3249865, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7ca1a674460e6060f51f4da9328ae78?s=128&d=identicon&r=PG&f=1", "display_name": "invincible", "link": "https://stackoverflow.com/users/3249865/invincible"}, "edited": false, "score": 0, "creation_date": 1492990267, "post_id": 43576438, "comment_id": 74205274, "body": "yes, i thought the same way chunking users for each lambda. Say, i have 100.000 users and our limit 100 lambdas. So, 1k users for each lambda. Is there a max concurrent request count for a lambda ? if so, say its 10k concurrent request and our total 30k(approx.) for each, can we put a delay for each 10k and over come this limit ? minor delays are not a big deal within each request or chunk of concurrent requests."}], "tags": [], "owner": {"reputation": 16752, "user_id": 5567387, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/dyfPK.jpg?s=128&g=1", "display_name": "Zohaib Ijaz", "link": "https://stackoverflow.com/users/5567387/zohaib-ijaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1492991163, "last_edit_date": 1592644375, "creation_date": 1492981165, "answer_id": 43576438, "question_id": 43564886, "link": "https://stackoverflow.com/questions/43564886/how-can-i-distribute-multiple-concurrent-requests-to-aws-lambda-functions/43576438#43576438", "title": "How can I distribute multiple concurrent requests to aws lambda functions?", "body": "<p>Here is my solution:</p>\n<p>if 100 concurrent lambdas are not enough for your need, create a ticket to increase your limit, you will be charged what will you use.</p>\n<p>However, still you can't determine that how many lambdas will be required in future. It is not necessary to process each user in a separate lambda, instead you can invoke a lambda with a chunk of user data. e.g. Let's say, your max. lambda limit is 100 and there are 1000 users then you can do something (i don't know <code>go</code>, here is a <code>python</code> code which may not be 100% syntactically correct)</p>\n<pre><code>users = get_users_fromdb()   # users = [1,2,3,... 1000]\nnumber_of_users = len(users)\nchunk_size = number_of_users / 100   # 100 is your lambda limit\nfor i in range(0, number_of_users, chunk_size)\n    # e.g. chunk_users_data = [1,2,3 ... 10]\n    chunk_users_data = users[i * chunk_size : (i + 1) * chunk_size ]\n    invoke_lambda_to_process_users_chunk_data()\n</code></pre>\n<p>Here is what you can do in other lambda</p>\n<pre><code>users = event.get('users')\nfor user in users:\n    try:\n       process_user(user)\n    except Exception as e:\n        print(e)  # handle exception / error if you want\n</code></pre>\n<h2>Update:</h2>\n<p>By default, 100 is limit for concurrent running lambdas. If you have 100K users, IMO, you should go for a support case to increase your account's concurrent lambda limit to 1000 or more. I am working on lambda and we have 10K limit. One more thing to keep in mind that it is not sure that your one lambda invocation will be able to process all users in a chunk, so add some logic to reinvoke with remaining users before timeout. A lambda can run upto max. of 5 minutes. YOu can get remaining time from <code>context</code> object in milli seconds.</p>\n"}], "owner": {"reputation": 99, "user_id": 3249865, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/d7ca1a674460e6060f51f4da9328ae78?s=128&d=identicon&r=PG&f=1", "display_name": "invincible", "link": "https://stackoverflow.com/users/3249865/invincible"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 802, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492991163, "creation_date": 1492896972, "last_edit_date": 1492924003, "question_id": 43564886, "link": "https://stackoverflow.com/questions/43564886/how-can-i-distribute-multiple-concurrent-requests-to-aws-lambda-functions", "title": "How can I distribute multiple concurrent requests to aws lambda functions?", "body": "<p>I want to build a cronjob like system that gets all users from database and make multiple (I mean lots of) concurrent requests for each of them and make some executions and save the result to db. It will run every hour in every day 7/24.</p>\n\n<p>I came up with the solution that:</p>\n\n<ol>\n<li>Gets all users from db (that's the easy part)</li>\n<li>Dynamically creates lambda functions and distributes all users to these functions</li>\n<li>Each lambda function makes concurrent requests and executions\n(handling results and saving them to db)</li>\n<li>Communicate these functions with SNS when needed</li>\n</ol>\n\n<p>So, does my approach make sense for this situation?</p>\n\n<p>The most important thing here is scaling (that's why I thought to distribute all users to lambda functions, for limiting concurrent requests and resources), how we can come with an scalable and efficient idea for exponentially increased user count?</p>\n\n<p>Or any other suggestions?</p>\n"}, {"tags": ["mysql", "heroku", "go", "cleardb"], "answers": [{"tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": true, "score": 6, "last_activity_date": 1492901111, "creation_date": 1492901111, "answer_id": 43565424, "question_id": 43562091, "link": "https://stackoverflow.com/questions/43562091/heroku-cleardb-connection-default-addr-for-network-unknown/43565424#43565424", "title": "Heroku cleardb connection default addr for network unknown", "body": "<p>This is a <code>Go</code> specific problem. Three changes are required:</p>\n\n<ol>\n<li><code>Go</code>'s <code>sql.Open</code> already takes scheme as its first parameter so it needs to be stripped off of <code>DATABASE_URL</code>.</li>\n<li>Connection string shouldn't have any query parameters (remove <code>?reconnect=true</code>).</li>\n<li>Protocol (tcp) and port (3306 for MySQL) number <em>are</em> required.</li>\n</ol>\n\n<p>Thus final database URL would be:</p>\n\n<pre><code>DATABASE_URL='user:pass@tcp(us-cdbr-iron-east-03.cleardb.net:3306)/your_heroku_database'\n</code></pre>\n"}], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 786, "favorite_count": 1, "accepted_answer_id": 43565424, "answer_count": 1, "score": 3, "last_activity_date": 1492901175, "creation_date": 1492880805, "last_edit_date": 1492901175, "question_id": 43562091, "link": "https://stackoverflow.com/questions/43562091/heroku-cleardb-connection-default-addr-for-network-unknown", "title": "Heroku cleardb connection default addr for network unknown", "body": "<p>I have created a free instance of Heroku cleardb instance for my app. I set the database URL as:</p>\n\n<pre><code>heroku config:set DATABASE_URL='mysql://user:pass@us-cdbr-iron-east-03.cleardb.net/heroku_database?reconnect=true'\n</code></pre>\n\n<p>I'm trying to connect using a <code>Go</code> app. But when I try to access my application, it gives the following mysql error:</p>\n\n<pre><code>default addr for network 'us-cdbr-iron-east-03.cleardb.net' unknown\n</code></pre>\n\n<p>I tried to set the database url with protocol and port as well:</p>\n\n<pre><code>heroku config:set DATABASE_URL='mysql://user:pass@tcp(us-cdbr-iron-east-03.cleardb.net:3306)/heroku__database?reconnect=true'\n</code></pre>\n\n<p>This changes the errror to:</p>\n\n<pre><code>Access denied for user\n</code></pre>\n\n<p>which i'm guessing is because direct access to port is disallowed. Does anybody know what is the issue here?</p>\n"}, {"tags": ["opencv", "go"], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 4621508, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7edbd50ad77354c926f108838b77b938?s=128&d=identicon&r=PG&f=1", "display_name": "rumdrums", "link": "https://stackoverflow.com/users/4621508/rumdrums"}, "edited": false, "score": 0, "creation_date": 1492882681, "post_id": 43560571, "comment_id": 74175689, "body": "Thanks for the reply. That makes sense and was actually what I was initially doing -- I changed it to what&#39;s posted just for the sake of trying anything... either way, it doesn&#39;t fix the problem."}], "tags": [], "owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "is_accepted": false, "score": 0, "last_activity_date": 1492872490, "creation_date": 1492872490, "answer_id": 43560571, "question_id": 43556925, "link": "https://stackoverflow.com/questions/43556925/go-opencv-filter-contours/43560571#43560571", "title": "Go/OpenCV: Filter Contours", "body": "<p>You're taking the <code>Sizeof</code> the pointer that would be returned by CreateSeq. You probably want the <code>Sizeof</code> the struct <code>opencv.CVPoint{}</code> instead.</p>\n"}], "owner": {"reputation": 1172, "user_id": 4621508, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7edbd50ad77354c926f108838b77b938?s=128&d=identicon&r=PG&f=1", "display_name": "rumdrums", "link": "https://stackoverflow.com/users/4621508/rumdrums"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 287, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1492923463, "creation_date": 1492849051, "last_edit_date": 1492923463, "question_id": 43556925, "link": "https://stackoverflow.com/questions/43556925/go-opencv-filter-contours", "title": "Go/OpenCV: Filter Contours", "body": "<p>I'm using <a href=\"https://github.com/lazywei/go-opencv\" rel=\"nofollow noreferrer\">this library</a> to write an OpenCV app in Golang. I'm trying to do something very basic but can't seem to make it work. I simply want to take a set of contours, remove those contours that don't have a minimum area, then return the filtered result. </p>\n\n<p>This is the current state of my code:</p>\n\n<pre><code>// given *opencv.Seq and image, draw all the contours\nfunc opencvDrawRectangles(img *opencv.IplImage, contours *opencv.Seq) {\n    for c := contours; c != nil; c = c.HNext() {\n        rect := opencv.BoundingRect(unsafe.Pointer(c))\n        fmt.Println(\"Rectangle: \", rect.X(), rect.Y())\n        opencv.Rectangle(img, \n            opencv.Point{ rect.X(), rect.Y() }, \n            opencv.Point{ rect.X() + rect.Width(), rect.Y() + rect.Height() },\n            opencv.ScalarAll(255.0), \n            1, 1, 0)\n    }\n}\n\n// return contours that meet the threshold\nfunc opencvFindContours(img *opencv.IplImage, threshold float64) *opencv.Seq {\n    defaultThresh := 10.0\n    if threshold == 0.0 {\n        threshold = defaultThresh\n    }\n    contours := img.FindContours(opencv.CV_RETR_LIST, opencv.CV_CHAIN_APPROX_SIMPLE, opencv.Point{0, 0})\n\n    if contours == nil {\n        return nil\n    }\n\n    defer contours.Release()\n\n    threshContours := opencv.CreateSeq(opencv.CV_SEQ_ELTYPE_POINT,\n                            int(unsafe.Sizeof(opencv.CvPoint{})))\n\n    for ; contours != nil; contours = contours.HNext() {\n        v := *contours\n        if opencv.ContourArea(contours, opencv.WholeSeq(), 0) &gt; threshold {\n            threshContours.Push(unsafe.Pointer(&amp;v))\n        }\n    }\n    return threshContours\n}\n</code></pre>\n\n<p>In <code>opencvFindContours</code>, I'm trying to add to a new variable only those contours that meet the area threshold. When I take those results and pass them into <code>opencvDrawRectangles</code>, <code>contours</code> is filled with nonsense data. If, on the other hand, I just return <code>contours</code> directly in <code>opencvFindContours</code> then pass that to <code>opencvDrawRectangles</code>, I get the rectangles I would expect based on the motion detected in the image.  </p>\n\n<p>Does anyone know how to properly filter the contours using this library? I'm clearly missing something about how these data structures work, just not sure what.</p>\n\n<p>However it's best implemented, the main thing I'm trying to figure out here is simply how to take a sequence of contours and filter out ones that fall below a certain area.... all the c++ examples I've seen make this look pretty easy, but I'm finding it quite challenging using a Go wrapper of the C API.</p>\n"}, {"tags": ["docker", "go", "docker-compose"], "comments": [{"owner": {"reputation": 50397, "user_id": 1318694, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/JPEVC.png?s=128&g=1", "display_name": "Matt", "link": "https://stackoverflow.com/users/1318694/matt"}, "edited": false, "score": 0, "creation_date": 1492847483, "post_id": 43555213, "comment_id": 74164909, "body": "What are you trying to run in this container?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492856613, "post_id": 43555213, "comment_id": 74167265, "body": "Did you try specifying a command?"}], "answers": [{"tags": [], "owner": {"reputation": 23608, "user_id": 2915097, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91318014af3b3d389901d50d5f9276d5?s=128&d=identicon&r=PG&f=1", "display_name": "user2915097", "link": "https://stackoverflow.com/users/2915097/user2915097"}, "is_accepted": true, "score": 1, "last_activity_date": 1492838879, "creation_date": 1492838879, "answer_id": 43555605, "question_id": 43555213, "link": "https://stackoverflow.com/questions/43555213/unable-to-download-docker-golang-image-no-command-specified/43555605#43555605", "title": "Unable to download docker golang image: No command specified", "body": "<p>Golang:1.7-alpine is just a basis for building a Go container, and does not have a CMD or an ENTRYPOINT, so ends immediately.</p>\n\n<p>Use an image doing really something, like printing hello world every 45 seconds</p>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1492838932, "creation_date": 1492838932, "answer_id": 43555614, "question_id": 43555213, "link": "https://stackoverflow.com/questions/43555213/unable-to-download-docker-golang-image-no-command-specified/43555614#43555614", "title": "Unable to download docker golang image: No command specified", "body": "<p>You should run your container with an argument which will be passed to the default <code>ENTRYPOINT</code>, to be executed as a command</p>\n\n<p>But the best practice these days is to use multistage, in order to generate a smaller image with just your application.</p>\n\n<p>Or you can define your <code>ENTRYPOINT</code> being your build Go application.</p>\n\n<p>See '<a href=\"http://blog.frankgrecojr.com/gobuild/\" rel=\"nofollow noreferrer\">Using Docker Multi-Stage Builds with Go </a>', using the new <code>AS build-stage</code> keyword.</p>\n\n<p>Your Dockerfile would be:</p>\n\n<pre><code># build stage\nARG GO_VERSION=1.8.1  \nFROM golang:${GO_VERSION}-alpine AS build-stage  \nMAINTAINER fbgrecojr@me.com  \nWORKDIR /go/src/github.com/frankgreco/gobuild/  \nCOPY ./ /go/src/github.com/frankgreco/gobuild/  \nRUN apk add --update --no-cache \\  \n        wget \\\n        curl \\\n        git \\\n    &amp;&amp; wget \"https://github.com/Masterminds/glide/releases/download/v0.12.3/glide-v0.12.3-`go env GOHOSTOS`-`go env GOHOSTARCH`.tar.gz\" -O /tmp/glide.tar.gz \\\n    &amp;&amp; mkdir /tmp/glide \\\n    &amp;&amp; tar --directory=/tmp/glide -xvf /tmp/glide.tar.gz \\\n    &amp;&amp; rm -rf /tmp/glide.tar.gz \\\n    &amp;&amp; export PATH=$PATH:/tmp/glide/`go env GOHOSTOS`-`go env GOHOSTARCH` \\\n    &amp;&amp; glide update -v \\\n    &amp;&amp; glide install \\\n    &amp;&amp; CGO_ENABLED=0 GOOS=`go env GOHOSTOS` GOARCH=`go env GOHOSTARCH` go build -o foo \\\n    &amp;&amp; go test $(go list ./... | grep -v /vendor/) \\\n    &amp;&amp; apk del wget curl git\n\n# production stage\nFROM alpine:3.5  \nMAINTAINER fbgrecojr@me.com  \nCOPY --from=build-stage /go/src/github.com/frankgreco/go-docker-build/foo .  \nENTRYPOINT [\"/foo\"]  \n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1006, "user_id": 1838740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd956ce58030560446b3ac0d6965d61?s=128&d=identicon&r=PG", "display_name": "Sameh Sharaf", "link": "https://stackoverflow.com/users/1838740/sameh-sharaf"}, "is_accepted": false, "score": 1, "last_activity_date": 1493214114, "creation_date": 1493214114, "answer_id": 43635972, "question_id": 43555213, "link": "https://stackoverflow.com/questions/43555213/unable-to-download-docker-golang-image-no-command-specified/43635972#43635972", "title": "Unable to download docker golang image: No command specified", "body": "<p>I solved it by using <code>golang:1.7</code> instead of <code>golang:1.7-alpine</code>.</p>\n"}], "owner": {"reputation": 1006, "user_id": 1838740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/abd956ce58030560446b3ac0d6965d61?s=128&d=identicon&r=PG", "display_name": "Sameh Sharaf", "link": "https://stackoverflow.com/users/1838740/sameh-sharaf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 1, "accepted_answer_id": 43555605, "answer_count": 3, "score": 1, "last_activity_date": 1493214114, "creation_date": 1492835130, "last_edit_date": 1492918777, "question_id": 43555213, "link": "https://stackoverflow.com/questions/43555213/unable-to-download-docker-golang-image-no-command-specified", "title": "Unable to download docker golang image: No command specified", "body": "<p>Newbie in docker here.</p>\n\n<p>I want to build a project using <code>go</code> language and my <code>docker-compose.yml</code> file has the following:</p>\n\n<pre><code>go:\n    image: golang:1.7-alpine\n    volumes:\n      - ./:/server/http\n    ports:\n        - \"80:8080\"\n    links:\n        - postgres\n        - mongodb\n        - redis\n    environment:\n        DEBUG: 'true'\n        PORT: '8080'\n</code></pre>\n\n<p>When I run <code>docker-compose up -d</code> in terminal, it returns the following error:</p>\n\n<pre><code>`ERROR: for go  Cannot create container for service go: No command specified`\n</code></pre>\n\n<p>How should I fix it?</p>\n"}, {"tags": ["go", "sqlx"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492814212, "post_id": 43552813, "comment_id": 74158253, "body": "What is the value in the database itself? <code>0001-01-01 00:00:00 +0000 UTC</code> looks like it read a zero time from the database--if it had read NULL, I would expect it to be <code>nil</code>."}, {"owner": {"reputation": 7636, "user_id": 1650674, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6U9F1.png?s=128&g=1", "display_name": "tir38", "link": "https://stackoverflow.com/users/1650674/tir38"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492814725, "post_id": 43552813, "comment_id": 74158414, "body": "The value in the DB looks like <code>2017-04-20 12:05:37-04</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492815618, "post_id": 43552813, "comment_id": 74158661, "body": "Just a guess, but did you try changing the order of <code>PgOrder</code>&#39;s fields? That is, have the embedded <code>Order</code> at the bottom and above it have the <code>PickupTime pq.NullTime</code>... e.g. like here: <a href=\"https://play.golang.org/p/_QdVNbWcqS\" rel=\"nofollow noreferrer\">play.golang.org/p/_QdVNbWcqS</a>"}], "answers": [{"tags": [], "owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "is_accepted": false, "score": 2, "last_activity_date": 1492831633, "creation_date": 1492831633, "answer_id": 43554905, "question_id": 43552813, "link": "https://stackoverflow.com/questions/43552813/struct-embedding-with-sqlx-not-returning-value-from-db/43554905#43554905", "title": "Struct embedding with sqlx not returning value from db", "body": "<p>It looks like you're shadowing PickupTime. If I'm reading the sqlx docs right that means it will store the value in the first one it found (in Order) and then when you read the one in PgOrder it's an uninitialized time.Time. You can check the Valid field of PgOrder.PickupTime to confirm this (it should be invalid).</p>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1492847642, "creation_date": 1492847642, "answer_id": 43556747, "question_id": 43552813, "link": "https://stackoverflow.com/questions/43552813/struct-embedding-with-sqlx-not-returning-value-from-db/43556747#43556747", "title": "Struct embedding with sqlx not returning value from db", "body": "<p>If your field is a pointer to something, e.g. <code>*time.Time</code>, or <code>*string</code> you shouldn't need to use the <code>NullXxx</code> types. Those types are to be used when you have a non-nil field, e.g. <code>time.Time</code>, or <code>string</code> while it's corresponding column can be <code>NULL</code>.</p>\n\n<p>If you want to ebmed your type anyway, to avoid potential shadowing already mentioned by @Dmitri Goldring, you can to tell <code>sqlx</code> to skip the field you don't want it to scan the column into. So just as you did with the <code>json</code> tag, you can do so with the <code>db</code> tag:</p>\n\n<pre><code>type Order struct {\n    ...\n    PickupTime *time.Time `json:\"-\" db:\"-\"`\n}\n\ntype PgOrder struct {\n    Order\n    PickupTime pq.NullTime\n}\n</code></pre>\n"}], "owner": {"reputation": 7636, "user_id": 1650674, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/6U9F1.png?s=128&g=1", "display_name": "tir38", "link": "https://stackoverflow.com/users/1650674/tir38"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 0, "accepted_answer_id": 43556747, "answer_count": 2, "score": 2, "last_activity_date": 1492847642, "creation_date": 1492813034, "last_edit_date": 1495541395, "question_id": 43552813, "link": "https://stackoverflow.com/questions/43552813/struct-embedding-with-sqlx-not-returning-value-from-db", "title": "Struct embedding with sqlx not returning value from db", "body": "<p>I have a struct with a time field that may be nil:</p>\n\n<pre><code>type Order struct {\n    ...\n    PickupTime  *time.Time    `json:\"-\"`\n}\n</code></pre>\n\n<p>I want to save this to DB with <code>sqlx</code> so I figure I need to use <code>pq.NullTime</code> as suggested <a href=\"https://stackoverflow.com/questions/24564619/nullable-time-time-in-golang\">here</a>.</p>\n\n<p>Instead of updating the <code>Order</code> object (I don't want to leak DB code into the model layer), I figured I could embedd Order in a <code>PgOrder</code> and alter the <code>PickupTime</code> type:</p>\n\n<pre><code>type PgOrder struct {\n    Order\n    PickupTime pq.NullTime\n}\n</code></pre>\n\n<p>The problem is that when I simply update an <code>Order</code> in DB, then turn around and fetch that order, the returned <code>PickupTime</code> is empty.</p>\n\n<pre><code>// update\nfunc (pg Postgres) UpdateOrderPickupTime(order *Order, pickupTime time.Time) error {\n    _, err := pg.Exec(`UPDATE orders SET pickup_time = $1 WHERE id = $2`, pickupTime, order.ID)\n    return err\n}\n\n// retrieve\nfunc (pg Postgres) GetOrder(orderID DatabaseID) (*Order, error) {\n    pgOrder := PgOrder{}\n    err := pg.Get(&amp;pgOrder, `SELECT * FROM orders WHERE id = $1`, orderID)\n    if err == sql.ErrNoRows {\n        return nil, nil\n    }\n    ... // at this point pgOrder.PickupTime is 0001-01-01 00:00:00 +0000 UTC\n\n}\n</code></pre>\n\n<p>If I put a breakpoint betwen updating and retrieving, I can inspect the DB and see that a value is being saved as <code>2017-04-20 12:05:37-04</code>. So the problem must be in the retrieve portion. If I understand right from the <a href=\"http://jmoiron.github.io/sqlx/#advancedScanning\" rel=\"nofollow noreferrer\">docs</a>, sqlx should be able to handle embedded structs.</p>\n"}, {"tags": ["go", "go-cobra"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492808385, "post_id": 43551721, "comment_id": 74156037, "body": "Did you try installing the pflag package? I&#39;m guessing you do have it installed, and don&#39;t realize it, otherwise you&#39;d get a different error."}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1492808457, "post_id": 43551721, "comment_id": 74156069, "body": "Did you actually run <code>glide</code>? Or did you just put it in the <code>glide.yaml</code>? Usually, glide should take care of the dependencies for you."}, {"owner": {"reputation": 537, "user_id": 1096247, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1c990c783b2a26b5251b583d452defd9?s=128&d=identicon&r=PG", "display_name": "Amal", "link": "https://stackoverflow.com/users/1096247/amal"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1492840428, "post_id": 43551721, "comment_id": 74163321, "body": "@Flimzy pflag package is automatically installed and is present in my vendor dir. ls on ./vendor/github.com/spf13/ gives output cobra  pflag"}, {"owner": {"reputation": 537, "user_id": 1096247, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1c990c783b2a26b5251b583d452defd9?s=128&d=identicon&r=PG", "display_name": "Amal", "link": "https://stackoverflow.com/users/1096247/amal"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1492840643, "post_id": 43551721, "comment_id": 74163373, "body": "@Carpetsmoker obviously I did a glide install :)"}], "answers": [{"tags": [], "owner": {"reputation": 537, "user_id": 1096247, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1c990c783b2a26b5251b583d452defd9?s=128&d=identicon&r=PG", "display_name": "Amal", "link": "https://stackoverflow.com/users/1096247/amal"}, "is_accepted": true, "score": 1, "last_activity_date": 1492854265, "creation_date": 1492854265, "answer_id": 43557669, "question_id": 43551721, "link": "https://stackoverflow.com/questions/43551721/error-adding-golang-cobra-package-with-glide/43557669#43557669", "title": "error adding golang cobra package with glide", "body": "<p>It was problem with glide cache not updating why old version of pflag package was getting installed. More detailed info: <a href=\"https://github.com/spf13/cobra/issues/420\" rel=\"nofollow noreferrer\">https://github.com/spf13/cobra/issues/420</a></p>\n"}], "owner": {"reputation": 537, "user_id": 1096247, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1c990c783b2a26b5251b583d452defd9?s=128&d=identicon&r=PG", "display_name": "Amal", "link": "https://stackoverflow.com/users/1096247/amal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 299, "favorite_count": 0, "accepted_answer_id": 43557669, "answer_count": 1, "score": 0, "last_activity_date": 1492854265, "creation_date": 1492807500, "last_edit_date": 1492808310, "question_id": 43551721, "link": "https://stackoverflow.com/questions/43551721/error-adding-golang-cobra-package-with-glide", "title": "error adding golang cobra package with glide", "body": "<p>My glide.yaml import section is</p>\n\n<pre><code>import:\n  - package: github.com/spf13/cobra\n</code></pre>\n\n<p>I have</p>\n\n<pre><code>import (\n   \"github.com/spf13/cobra\"\n)\n</code></pre>\n\n<p>in my code.</p>\n\n<p>but I am getting the error</p>\n\n<blockquote>\n  <p>vendor/github.com/spf13/cobra/command.go:1092: c.lflags.SortFlags undefined (type *pflag.FlagSet has no field or method SortFlags)<br>\n  vendor/github.com/spf13/cobra/command.go:1092: c.Flags().SortFlags undefined (type *pflag.FlagSet has no field or method SortFlags)<br>\n  vendor/github.com/spf13/cobra/command.go:1240: c.parentsPflags.SortFlags undefined (type *pflag.FlagSet has no field or method SortFlags)</p>\n</blockquote>\n\n<p>couples of issues on cobra repo says that can happen if pflag package is old version but in my case don't have that package installed separately.\nany idea what am I doing wrong? thanks in advance!</p>\n"}, {"tags": ["unit-testing", "testing", "go", "mocking"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 6, "creation_date": 1492803995, "post_id": 43550727, "comment_id": 74153916, "body": "You can define the interface yourself for any exported functionality of the package, remember interfaces in Go are implemented <b>implicitly</b>."}, {"owner": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1492805315, "post_id": 43550727, "comment_id": 74154570, "body": "@mkopriva This is what I&#39;ve been trying to do but the problem is that I have to return structs created in the package to create my interface which leads to a number of problems"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1492805465, "post_id": 43550727, "comment_id": 74154631, "body": "What problems sepcifically? Do you mind updating your question with a description of those specific problems?"}], "answers": [{"comments": [{"owner": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "edited": false, "score": 0, "creation_date": 1492812366, "post_id": 43551401, "comment_id": 74157576, "body": "This is great, would you mind elaborating on the getter/setter idea"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 5, "last_activity_date": 1492814075, "last_edit_date": 1492814075, "creation_date": 1492806113, "answer_id": 43551401, "question_id": 43550727, "link": "https://stackoverflow.com/questions/43550727/whats-the-best-way-to-mock-a-dependency-in-go-when-the-dependency-doesnt-expos/43551401#43551401", "title": "What&#39;s the best way to mock a dependency in GO when the dependency doesn&#39;t expose an interface", "body": "<p>Create your own interface.</p>\n\n<p>It doesn't even need to be complete, either, it only needs to cover the methods you actually use.</p>\n\n<p>Suppose you have a type <code>Foo</code> with the following methods: <code>Bar()</code>, <code>Baz()</code>, and <code>Qux()</code>.</p>\n\n<p>And you use this in your code:</p>\n\n<pre><code>func Frobnicate(f *Foo) err {\n    if err := f.Bar() error; err != nil {\n        return err\n    }\n    return nil\n}\n</code></pre>\n\n<p>Just change this to use your new custom interface:</p>\n\n<pre><code>type barer interface() {\n    Bar() error\n}\n</code></pre>\n\n<p>Then update your function signature:</p>\n\n<pre><code>func Frobnicate(f fooer) err {\n    // The rest the same as before\n</code></pre>\n\n<p>Now create your own <code>fooer</code> implementation, and mock away.</p>\n\n<p>If the type you need to mock is a simple struct with data, instead of with methods, you may wrap the method with getter/setter methods, so that an interface will work around it. Example, given this type:</p>\n\n<pre><code>type Foo struct {\n    Name string\n}\n</code></pre>\n\n<p>You can create a wrapper:</p>\n\n<pre><code>type FooWrapper struct {\n    Foo\n}\n\nfunc (w *FooWrapper) Name() string {\n    return w.Foo.Name\n}\n</code></pre>\n\n<p>Now the <code>Foo</code> type can be accessed using a custom interface for mocking.</p>\n"}], "owner": {"reputation": 7628, "user_id": 4885784, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9b10fe019f6c7800bef029835802cb38?s=128&d=identicon&r=PG&f=1", "display_name": "Daniel Kobe", "link": "https://stackoverflow.com/users/4885784/daniel-kobe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 43551401, "answer_count": 1, "score": 2, "last_activity_date": 1492814075, "creation_date": 1492803529, "question_id": 43550727, "link": "https://stackoverflow.com/questions/43550727/whats-the-best-way-to-mock-a-dependency-in-go-when-the-dependency-doesnt-expos", "title": "What&#39;s the best way to mock a dependency in GO when the dependency doesn&#39;t expose an interface", "body": "<p>Im trying to mock <a href=\"https://gopkg.in/olivere/elastic.v2\" rel=\"nofollow noreferrer\">https://gopkg.in/olivere/elastic.v2</a> and its proven to be a nightmare. I usually use gomock but I can't because theres no interface file for the dep. What's the best way to go about this?</p>\n"}, {"tags": ["go", "google-cloud-datastore", "uuid"], "answers": [{"tags": [], "owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "is_accepted": true, "score": 3, "last_activity_date": 1492817176, "last_edit_date": 1492817176, "creation_date": 1492804202, "answer_id": 43550909, "question_id": 43549905, "link": "https://stackoverflow.com/questions/43549905/cant-store-byte-array-in-googles-datastore/43550909#43550909", "title": "Can&#39;t store byte array in google&#39;s datastore", "body": "<p>Per <a href=\"https://cloud.google.com/appengine/docs/standard/go/datastore/reference\" rel=\"nofollow noreferrer\">Google's Documentation</a>:</p>\n\n<blockquote>\n  <p>Valid value types are:</p>\n  \n  <ul>\n  <li>signed integers (int, int8, int16, int32 and int64),</li>\n  <li>bool,</li>\n  <li>string,</li>\n  <li>float32 and float64,</li>\n  <li>[]byte (up to 1 megabyte in length),</li>\n  <li>any type whose underlying type is one of the above predeclared types,</li>\n  <li>ByteString,</li>\n  <li>*Key,</li>\n  <li>time.Time (stored with microsecond precision),</li>\n  <li>appengine.BlobKey,</li>\n  <li>appengine.GeoPoint,</li>\n  <li>structs whose fields are all valid value types,</li>\n  <li>slices of any of the above.</li>\n  </ul>\n</blockquote>\n\n<p>So, you will have to use a byte slice or string. You could do some behind the scenes manipulation when you need to do your setting or getting like (<a href=\"https://play.golang.org/p/Ma72q5Ox0l\" rel=\"nofollow noreferrer\">Playground Example</a>): </p>\n\n<pre><code>type uuid [16]byte\n\ntype song struct {\n    u []byte\n}\n\nfunc main() {\n    var b [16]byte\n    copy(b[:], \"0123456789012345\")\n\n    var u uuid = uuid(b) //this would represent when you get the uuid\n\n    s := song{u: []byte(u[:])}\n\n    copy(b[:], s.u)\n    u = uuid(b)\n    fmt.Println(u)\n}\n</code></pre>\n\n<p>This could also be done through methods. (<a href=\"https://play.golang.org/p/lOdFTLRKOW\" rel=\"nofollow noreferrer\">Playground example</a>)</p>\n\n<p>Alternatively, you could have an entity specific to the datastore that carries the byte slice, and the transformers that go to and from that entity know how to do the conversion.</p>\n"}], "owner": {"reputation": 1322, "user_id": 4505331, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/3Lh1Z.jpg?s=128&g=1", "display_name": "Lawrence Benson", "link": "https://stackoverflow.com/users/4505331/lawrence-benson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 446, "favorite_count": 1, "accepted_answer_id": 43550909, "answer_count": 1, "score": 2, "last_activity_date": 1492817176, "creation_date": 1492800281, "last_edit_date": 1492800710, "question_id": 43549905, "link": "https://stackoverflow.com/questions/43549905/cant-store-byte-array-in-googles-datastore", "title": "Can&#39;t store byte array in google&#39;s datastore", "body": "<p>I'm using Google's datastore in my Go app. I have a <code>Song</code> struct, which has a <code>uuid.UUID</code> field. </p>\n\n<pre><code>type Song struct {\n    ID: uuid.UUID\n    Title: string\n    ...\n}\n</code></pre>\n\n<p>This <code>UUID</code> is taken from <a href=\"https://github.com/satori/go.uuid/blob/master/uuid.go#L128\" rel=\"nofollow noreferrer\">github.com/satori/go.uuid</a> and is defined as</p>\n\n<pre><code>type UUID [16]byte\n</code></pre>\n\n<p>It seems that datastore can't handle byte arrays but in this use case only byte slices or strings. In the <code>json</code> package I can use a tag to interpret it as a string</p>\n\n<pre><code>type Song struct {\n    ID: uuid.UUID `json:\"id,string\"`\n    ....\n}\n</code></pre>\n\n<p>Is there a way of telling datastore to interpret the <code>UUID</code> as a slice/string or do I either have to give up \"type\"-safety and just store a string or use a custom <code>PropertyLoadSaver</code>?</p>\n"}, {"tags": ["web-services", "go", "gorilla", "mux"], "answers": [{"comments": [{"owner": {"reputation": 105, "user_id": 5270553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c823cbdcaf199ae2607c8be8443e8da?s=128&d=identicon&r=PG&f=1", "display_name": "Clarko", "link": "https://stackoverflow.com/users/5270553/clarko"}, "edited": false, "score": 0, "creation_date": 1492798411, "post_id": 43549158, "comment_id": 74151118, "body": "seems like that fixed the 404 error, I also had to change the &quot;/Login/&quot; prefix to &quot;/&quot;"}, {"owner": {"reputation": 353, "user_id": 290239, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/034b4b30d1045f2b8d1b1e85c431dfc9?s=128&d=identicon&r=PG", "display_name": "lowatt", "link": "https://stackoverflow.com/users/290239/lowatt"}, "edited": false, "score": 0, "creation_date": 1492819456, "post_id": 43549158, "comment_id": 74159573, "body": "If you don&#39;t like absolute paths, use <code>currentUser.HomeDir</code> to get the home path. See more at: <a href=\"https://golang.org/pkg/os/user/#User\" rel=\"nofollow noreferrer\">golang.org/pkg/os/user/#User</a>"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 0, "last_activity_date": 1492798603, "last_edit_date": 1492798603, "creation_date": 1492797273, "answer_id": 43549158, "question_id": 43549116, "link": "https://stackoverflow.com/questions/43549116/404-error-while-using-gorilla-mux-golang-library/43549158#43549158", "title": "404 Error while using gorilla/mux golang library", "body": "<p>Go won't interpret <code>$HOME</code>. Use an explicit path such as <code>/home/username/Documents/TEST/Login/</code>.</p>\n"}], "owner": {"reputation": 105, "user_id": 5270553, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2c823cbdcaf199ae2607c8be8443e8da?s=128&d=identicon&r=PG&f=1", "display_name": "Clarko", "link": "https://stackoverflow.com/users/5270553/clarko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 43549158, "answer_count": 1, "score": 0, "last_activity_date": 1492798603, "creation_date": 1492797093, "question_id": 43549116, "link": "https://stackoverflow.com/questions/43549116/404-error-while-using-gorilla-mux-golang-library", "title": "404 Error while using gorilla/mux golang library", "body": "<p>I am fairly new to golang and am finding myself frustrated with a simple file service program. I am suspecting that there is something wrong with my file prefix/ directory in the handler for my router r. I have tried many different formats for the directory. the html file i would like serviced is $HOME/Documents/TEST/Login on my system. Below is my code, note the <code>{address}</code> replaces the ip address.</p>\n\n<pre><code>    package main\n\n    import (\n       \"log\"\n       \"github.com/gorilla/mux\"\n       \"net/http\"\n       \"time\"\n     )\n\n   func main() {\n   r := mux.NewRouter()\n   r.PathPrefix(\"/Login/\").Handler(http.StripPrefix(\"/Login/\", \n   http.FileServer(http.Dir(\"$HOME/Documents/TEST/Login\"))))\n\n   srv := &amp;http.Server{\n       Handler:      r,\n       Addr:         \"{address}:9999\",\n       WriteTimeout: 600 * time.Second,\n       ReadTimeout:  600 * time.Second,\n   }\n\n   log.Fatal(srv.ListenAndServe())\n   }\n</code></pre>\n"}, {"tags": ["debugging", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 0, "last_activity_date": 1492793480, "last_edit_date": 1492793480, "creation_date": 1492793165, "answer_id": 43548045, "question_id": 43547565, "link": "https://stackoverflow.com/questions/43547565/any-way-to-get-a-stack-trace-for-http-response-writeheader-on-hijacked-connect/43548045#43548045", "title": "Any way to get a stack trace for &#39;http: response.WriteHeader on hijacked connection&#39; errors?", "body": "<p>If you are using a debugger, set a breakpoint <a href=\"https://github.com/golang/go/blob/24c52ee57046f5e58ce6db158b0efad02ced6606/src/net/http/server.go#L1049\" rel=\"nofollow noreferrer\">on the line where the message is logged</a>.  Examine the stack from there.</p>\n\n<p>If not using a debugger, then temporarily add a call to panic at the line and rebuild the net/http package with <code>go install net/http</code>.  The stack trace will show the cause of the problem.</p>\n\n<p>Another option is to create an io.Writer that calls <a href=\"https://godoc.org/runtime/debug#PrintStack\" rel=\"nofollow noreferrer\">debug.PrintStack</a> on every call to Write.  Use this writer to <a href=\"https://godoc.org/log#New\" rel=\"nofollow noreferrer\">create a log.Logger</a>.  Set this logger as the <a href=\"https://godoc.org/net/http#Server.ErrorLog\" rel=\"nofollow noreferrer\">server's ErrorLog</a>. Examine the printed stack traces to find the cause of the error.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1492793663, "last_edit_date": 1492793663, "creation_date": 1492793339, "answer_id": 43548101, "question_id": 43547565, "link": "https://stackoverflow.com/questions/43547565/any-way-to-get-a-stack-trace-for-http-response-writeheader-on-hijacked-connect/43548101#43548101", "title": "Any way to get a stack trace for &#39;http: response.WriteHeader on hijacked connection&#39; errors?", "body": "<p>Since the error is never returned, and written directly to the <code>http.Server.ErrorLog</code>, that is the only place you could intercept it.</p>\n\n<p>You can run it in a debugger and break at that point, but that may not be useful if this is running in production.</p>\n\n<p>You can create a new <code>*log.Logger</code> with an <code>io.Writer</code> which adds the stack trace to the output when it encounters that particular message. </p>\n\n<pre><code>type stackWriter struct {\n    w io.Writer\n}\nfunc (s stackWriter) Write(d []byte) (int, error) {\n    if bytes.Contains(d, []byte(\"WriteHeader on hijacked connection\")) {\n        s.w.Write(debug.Stack())\n    }\n    return s.w.Write(d)\n}\n</code></pre>\n\n<p>Another option of course is to modify <code>net/http/server.go</code> to print the stack at that point.</p>\n"}], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 417, "favorite_count": 2, "answer_count": 2, "score": -1, "last_activity_date": 1492793663, "creation_date": 1492791554, "last_edit_date": 1492792602, "question_id": 43547565, "link": "https://stackoverflow.com/questions/43547565/any-way-to-get-a-stack-trace-for-http-response-writeheader-on-hijacked-connect", "title": "Any way to get a stack trace for &#39;http: response.WriteHeader on hijacked connection&#39; errors?", "body": "<p>Our web application is logging a large number of 'http: response.WriteHeader on hijacked connection' messages to stderr.</p>\n\n<p>Is there any way to make the <code>http</code> library output a stack trace, or additional debugging information, along with this message, (or upgrade it to an error) to make it possible to track down where in our application this is occurring?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "edited": false, "score": 0, "creation_date": 1492791110, "post_id": 43546826, "comment_id": 74146840, "body": "Thanks @Nevermore, this is a more elegant way to copy the <code>slice</code>. Just to make sure. There is no way that I can pass a <code>slice</code> copy directly to a function? The only way is to create a new <code>slice</code> manually and copy the values from the original <code>slice</code>? I&#39;m just asking it because I&#39;m coming from <code>C++</code> and there I can pass vectors by reference or by value."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "edited": false, "score": 0, "creation_date": 1492794379, "post_id": 43546826, "comment_id": 74148893, "body": "@KelvinSalton go has absolutely no notion of &quot;pass by reference&quot;. Everything is passed by value. A slice is a descriptor into an underlying array. If you want a copy of that part of the array you have to make a copy. Go&#39;s focus is not &quot;elegant&quot; or &quot;syntactic sugar&quot; but &quot;explicit&quot;:"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1492842176, "post_id": 43546826, "comment_id": 74163676, "body": "It&#39;s also possible to do <code>b := append([]byte(nil), a...)</code> which appends the whole <code>a</code> to a nil slice \u2014 essentially producing a copy which gets assigned to <code>b</code>."}], "tags": [], "owner": {"reputation": 6434, "user_id": 4443226, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/C3vUB.png?s=128&g=1", "display_name": "Nevermore", "link": "https://stackoverflow.com/users/4443226/nevermore"}, "is_accepted": true, "score": 7, "last_activity_date": 1494243562, "last_edit_date": 1494243562, "creation_date": 1492789251, "answer_id": 43546826, "question_id": 43546742, "link": "https://stackoverflow.com/questions/43546742/how-to-pass-a-copy-of-a-slice-to-a-function/43546826#43546826", "title": "How to pass a copy of a slice to a function?", "body": "<p>There is a built in function, <code>copy</code>, <code>func copy(dst, src []T) int</code> which is probably what you're looking for. It copies a slice of any type into another slice.</p>\n\n<p>From the <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"noreferrer\">docs</a>:</p>\n\n<blockquote>\n  <p>The copy function supports copying between slices of different lengths (it will copy only up to the smaller number of elements). In addition, copy can handle source and destination slices that share the same underlying array, handling overlapping slices correctly.</p>\n</blockquote>\n\n<p>So </p>\n\n<pre><code>list := []string{\"hello\", \"world\"}\nnewList := make([]string, len(list))\nn := copy(newList, list)\n// n is the number of values copied\n</code></pre>\n\n<p>Will copy <code>list</code> into a new slice <code>newList</code>, which share values but not the reference in memory. The <code>int</code> <code>copy</code> returns is the number of values copied.</p>\n\n<hr>\n\n<p>For an alternative way, from Kostix's comment, you can append the slice to an empty slice. Which is kind of like copying it. It might not be idiomatic, but it allows you to pass the slice into a <code>func</code> as a copy, <em>sort of</em>. If you do this, I recommend copious comments.</p>\n\n<pre><code>thisFuncTakesSliceCopy( append([]string(nil), list...) )\n</code></pre>\n\n<p>To append a slice to another slice, remember the ellipses (<code>...</code>). </p>\n"}], "owner": {"reputation": 2254, "user_id": 4946821, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/R7FRn.jpg?s=128&g=1", "display_name": "KelvinS", "link": "https://stackoverflow.com/users/4946821/kelvins"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2644, "favorite_count": 0, "accepted_answer_id": 43546826, "answer_count": 1, "score": 4, "last_activity_date": 1581766831, "creation_date": 1492788967, "last_edit_date": 1581766831, "question_id": 43546742, "link": "https://stackoverflow.com/questions/43546742/how-to-pass-a-copy-of-a-slice-to-a-function", "title": "How to pass a copy of a slice to a function?", "body": "<p>I have a doubt about passing slices to functions. </p>\n\n<p>If I'm not wrong the slices are passed by reference in Go, so if I do something like this:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    slice := []int{1, 2, 3, 4, 5}\n    fmt.Println(slice)\n    testSlice(slice)\n    fmt.Println(slice)\n}\n\nfunc testSlice(slice []int) {\n    slice[0] = 5\n    slice[4] = 1\n}\n</code></pre>\n\n<p>The <code>testSlice</code> function will actually change the values in the original slice, because it was passed by reference (by default).</p>\n\n<p>There is some easy way that I can directly pass a copy of the slice to the <code>testSlice</code> function?</p>\n\n<p>Sure I can do something like this to create a copy of the slice:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    slice := []int{1, 2, 3, 4, 5}\n    fmt.Println(slice)\n    testSlice(slice)\n    fmt.Println(slice)\n}\n\nfunc testSlice(slice []int) {\n    var newSlice []int\n    for i := 0; i &lt; len(slice); i++ {\n        newSlice = append(newSlice, slice[i])\n    }\n    newSlice[0] = 5\n    newSlice[4] = 1\n}\n</code></pre>\n\n<p>But it needs to go through all values in the original slice to copy each of them, and it doesn't seem to be a great solution.</p>\n"}, {"tags": ["go", "garbage-collection", "maps"], "comments": [{"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1492789990, "post_id": 43546731, "comment_id": 74146134, "body": "I don&#39;t see anything wrong with what you&#39;re doing. When you call <code>delete</code>, that entry is deleted from the map, so you won&#39;t see it on further iterations. You shouldn&#39;t need to run the garbage collector manually to make this work. Can you provide a minimal, complete, verifiable example that exhibits the problem?"}, {"owner": {"reputation": 37, "user_id": 5119757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c25ea3fe337c6b1923b2ec240e12b4?s=128&d=identicon&r=PG&f=1", "display_name": "hiqluid", "link": "https://stackoverflow.com/users/5119757/hiqluid"}, "reply_to_user": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 0, "creation_date": 1492790349, "post_id": 43546731, "comment_id": 74146367, "body": "In my knowledge a map contains an internal variable which defines if a key exists and if the memory it used can be re-used. I tried to reproduce this in a small application, but failed."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1492798680, "post_id": 43546731, "comment_id": 74151260, "body": "@hiqluid: you&#39;re searching for magic where there is none. If the data is still accessible in the map, it&#39;s not because of lack of garbage collection. Have you tested your code with the race detector? Otherwise we need a more complete example that may reproduce the issue."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1492842505, "post_id": 43546731, "comment_id": 74163749, "body": "You do not appear to re-initialize the <code>sessionFinished</code> variable to <code>false</code> at the beginning of each loop iteration."}], "owner": {"reputation": 37, "user_id": 5119757, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89c25ea3fe337c6b1923b2ec240e12b4?s=128&d=identicon&r=PG&f=1", "display_name": "hiqluid", "link": "https://stackoverflow.com/users/5119757/hiqluid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 624, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1492788929, "creation_date": 1492788929, "question_id": 43546731, "link": "https://stackoverflow.com/questions/43546731/golang-garbage-collector-and-maps", "title": "Golang garbage collector and maps", "body": "<p>I'm processing some user session data inside of a goroutine and creating a map to keep track of user id -> session data inside of it. The goroutine loops through a slice and if a SessionEnd event is found, the map key is deleted inside the same iteration. This doesn't seem to always be the case, as I can still retrieve some of the data as well as the 'key exists' bool variable sometimes in the following iterations. It's as if some variables haven't yet been zeroed.</p>\n\n<p>Each map has only one goroutine writing/reading from it. From my understanding there shouldn't be a race condition, but it definitely seems that there is with the map and delete(). </p>\n\n<p>The code works fine if the garbage collector is run on every iteration. Am I using a map for the wrong purpose?</p>\n\n<p>Pseudocode (a function that is run inside a single goroutine, lines is passed as a variable):</p>\n\n<pre><code>active := make(ActiveSessions) // map[int]UserSession\n\nfor _, l := range lines { // lines is a slice of a parsed log\n    u = l.EventData.(parser.User)\n    s, exists = active[u.SessionID]\n\n    switch l.Event {\n    // Contains cases which can check if exists is true or false\n    // errors if contains an event that can't happen, \n    // for example UserDisconnect before UserConnect,\n    // or UserConnect while a session is already active\n\n    case \"UserConnect\":\n        if exists {\n            // error, can't occur\n\n            // The same session id can occur in the log after a prior session has completed,\n            // which is exactly when the problems occur\n        }        \n\n    case \"UserDisconnect\":\n        sessionFinished = true\n\n    }\n\n    // ...\n\n    if sessionFinished {\n        // &lt;add session to finished sessions&gt;\n\n        delete(active, u.SessionID)\n\n        // Code works only if runtime.GC() is executed here, could just be a coincidence\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "godoc"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1492788546, "post_id": 43546113, "comment_id": 74145226, "body": "It auto-reloads docs for me perfectly, works as intended. I changed something in docs in go source, refreshed page in browser, and I saw the changes. Need more info."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1492788667, "post_id": 43546113, "comment_id": 74145310, "body": "Maybe it&#39;s a browser caching issue? Which browser are you using?"}], "answers": [{"comments": [{"owner": {"reputation": 3666, "user_id": 3538165, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/M1snF.jpg?s=128&g=1", "display_name": "Radon Rosborough", "link": "https://stackoverflow.com/users/3538165/radon-rosborough"}, "edited": false, "score": 0, "creation_date": 1563211693, "post_id": 45966511, "comment_id": 100616898, "body": "This is disappointing to hear; is there any plan to fix the problem?"}], "tags": [], "owner": {"reputation": 1367, "user_id": 70458, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/0abb4322fa05c977a9b215b90dec809e?s=128&d=identicon&r=PG", "display_name": "Gabe Johnson", "link": "https://stackoverflow.com/users/70458/gabe-johnson"}, "is_accepted": false, "score": 2, "last_activity_date": 1504114308, "creation_date": 1504114308, "answer_id": 45966511, "question_id": 43546113, "link": "https://stackoverflow.com/questions/43546113/godoc-http-server-doesnt-seem-to-live-reload-changes/45966511#45966511", "title": "godoc http server doesn&#39;t seem to live reload changes", "body": "<p>Godoc for a directory (\"Directory /src/github.com/someuser\" at the top) does not automatically update.</p>\n\n<p>Godoc for a package (\"Package yourthing\" at the top) will automatically update, but you must reload the page to see the change.</p>\n"}], "owner": {"reputation": 1421, "user_id": 706521, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/gj7QH.jpg?s=128&g=1", "display_name": "Adrian Forsius", "link": "https://stackoverflow.com/users/706521/adrian-forsius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 896, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1504114308, "creation_date": 1492787181, "last_edit_date": 1492789301, "question_id": 43546113, "link": "https://stackoverflow.com/questions/43546113/godoc-http-server-doesnt-seem-to-live-reload-changes", "title": "godoc http server doesn&#39;t seem to live reload changes", "body": "<p>I seem to be unable to find an answer to the question, does the godoc server support live reload changes in for my own projects?</p>\n\n<p>According to <a href=\"http://whipperstacker.com/2015/10/03/run-a-godoc-server-locally-to-see-documentation-for-unpublished-packages/\" rel=\"nofollow noreferrer\">this article</a> it should be supported however whenever I change my code (update documentation) no changes appear until restart of the web server</p>\n\n<p>My documentation updates/appear every time I start the the sever:</p>\n\n<pre><code>godoc -http=:6060 &amp;\n</code></pre>\n\n<p>I don't want to restart the server for every change, is this expected behavior, what can I do to update my changes with the least amount of effort?</p>\n\n<p>My go version:</p>\n\n<pre><code>$ go version\ngo version go1.8 darwin/amd64\n</code></pre>\n\n<p>Using browser with incognito mode:</p>\n\n<pre><code>Chrome Version 57.0.2987.133 (64-bit)\n</code></pre>\n"}, {"tags": ["go", "stripe-payments"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1492789016, "post_id": 43545819, "comment_id": 74145541, "body": "Questions seeking debugging help (&quot;why isn&#39;t this code working?&quot;) must include the desired behavior, a specific problem or error and the shortest code necessary to reproduce it in the question itself. Questions without a clear problem statement are not useful to other readers. See: <a href=\"http://stackoverflow.com/help/mcve\">How to create a Minimal, Complete, and Verifiable example.</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "edited": false, "score": 0, "creation_date": 1492799600, "post_id": 43546808, "comment_id": 74151804, "body": "So how can I create a payment source for that new customer and then tie that to the charge? I already have Checkout tokenizing the card number."}, {"owner": {"reputation": 642, "user_id": 7841637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a2cbdfd3ba468100784c5c463cb824?s=128&d=identicon&r=PG&f=1", "display_name": "hpar", "link": "https://stackoverflow.com/users/7841637/hpar"}, "reply_to_user": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "edited": false, "score": 0, "creation_date": 1492887234, "post_id": 43546808, "comment_id": 74177396, "body": "By passing the token in the <code>source</code> parameter in the &quot;create customer&quot; request, you simultaneously create the customer&#39;s payment source. Since it&#39;s a new customer, they will have only one payment source, and you can charge that source by passing <code>customer=cus.ID</code> as you&#39;ve done below. If, later on, you have a customer with multiple sources then you can specify which one to use by passing both <code>customer</code> and <code>source</code> to &quot;create charge&quot;:  <a href=\"https://stripe.com/docs/api/#create_charge-customer\" rel=\"nofollow noreferrer\">stripe.com/docs/api/#create_charge-customer</a>  <a href=\"https://stripe.com/docs/api/#create_charge-source\" rel=\"nofollow noreferrer\">stripe.com/docs/api/#create_charge-source</a>"}, {"owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "edited": false, "score": 0, "creation_date": 1492977946, "post_id": 43546808, "comment_id": 74201975, "body": "I am setting the source in the create customer request. And that is what isn&#39;t working."}, {"owner": {"reputation": 642, "user_id": 7841637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a2cbdfd3ba468100784c5c463cb824?s=128&d=identicon&r=PG&f=1", "display_name": "hpar", "link": "https://stackoverflow.com/users/7841637/hpar"}, "reply_to_user": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "edited": false, "score": 0, "creation_date": 1493068154, "post_id": 43546808, "comment_id": 74245763, "body": "I would highly recommend writing into Stripe support with this link:  <a href=\"https://support.stripe.com/email/login\" rel=\"nofollow noreferrer\">support.stripe.com/email/login</a>  If you have the ID of a request from your logs this can be very helpful. It&#39;s req_XXX in the URL when you&#39;re looking at your dashboard logs."}], "tags": [], "owner": {"reputation": 642, "user_id": 7841637, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64a2cbdfd3ba468100784c5c463cb824?s=128&d=identicon&r=PG&f=1", "display_name": "hpar", "link": "https://stackoverflow.com/users/7841637/hpar"}, "is_accepted": false, "score": 0, "last_activity_date": 1492789202, "creation_date": 1492789202, "answer_id": 43546808, "question_id": 43545819, "link": "https://stackoverflow.com/questions/43545819/associate-a-charge-with-a-customer-with-stripe/43546808#43546808", "title": "Associate a charge with a customer with Stripe", "body": "<p>That's expected: the customer you just created doesn't have a payment source attached, so they can't pay your $1.00 charge. You can make the above succeed by, for example, using one of the test tokens when you create the customer:</p>\n\n<pre><code>customerParams := &amp;stripe.CustomerParams{\n    Desc:          \"Customer for xyz.com\",\n    Email:         \"test@email.com\",\n    Source:        \"test_visa\"\n}\n</code></pre>\n\n<p>More on test cards and sources here: <a href=\"https://stripe.com/docs/testing#cards\" rel=\"nofollow noreferrer\">https://stripe.com/docs/testing#cards</a></p>\n\n<p>You will of course want to use Elements or Checkout to tokenize card numbers in your production application, which makes sure that raw credit card numbers pass only to Stripe and not your application servers:\n<a href=\"https://stripe.com/docs/elements\" rel=\"nofollow noreferrer\">https://stripe.com/docs/elements</a></p>\n"}, {"comments": [{"owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "edited": false, "score": 0, "creation_date": 1530726019, "post_id": 43591474, "comment_id": 89340016, "body": "I have similar code that worked last year for subscriptions but is giving me same errors today."}], "tags": [], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "is_accepted": true, "score": 2, "last_activity_date": 1493045849, "creation_date": 1493045849, "answer_id": 43591474, "question_id": 43545819, "link": "https://stackoverflow.com/questions/43545819/associate-a-charge-with-a-customer-with-stripe/43591474#43591474", "title": "Associate a charge with a customer with Stripe", "body": "<p>Turns out the issue was setting the token source on the charge params after I had already set the source of the new customer I was charging. The following worked as expected to create a new customer and associate the new charge with the customer:</p>\n\n<pre><code>stripe.Key = \"sk_test_################\"\n\ncustomerParams := &amp;stripe.CustomerParams{\n    Desc:          \"Customer for xyz.com\",\n    Email:         \"test@email.com\",\n}\n\nerr := customerParams.SetSource(\"tok_####################\")\nif err != nil {\n    return nil, err\n}\n\ncus, err := customer.New(customerParams)\nif err != nil {\n    return nil, err\n}\n\n// Charge the user's card\ncp := &amp;stripe.ChargeParams{\n    Amount:   100,\n    Currency: \"usd\",\n    Desc:     \"some description\",\n    Customer: cus.ID,\n}\n\nerr = charge.New(cp)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1704, "user_id": 2912740, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/4730dc939ce11655d239d1f54a9cd399?s=128&d=identicon&r=PG&f=1", "display_name": "Edwinner", "link": "https://stackoverflow.com/users/2912740/edwinner"}, "is_accepted": false, "score": 0, "last_activity_date": 1530733148, "creation_date": 1530733148, "answer_id": 51179978, "question_id": 43545819, "link": "https://stackoverflow.com/questions/43545819/associate-a-charge-with-a-customer-with-stripe/51179978#51179978", "title": "Associate a charge with a customer with Stripe", "body": "<p>I had the same problem with stripe subscriptions.</p>\n\n<p>Bottom line, if a customer already exists without a valid payment source; </p>\n\n<ol>\n<li>You either need add/associate a source to a customer after the fact <a href=\"https://stripe.com/docs/sources/customers#attaching-a-source-to-an-existing-customer-object\" rel=\"nofollow noreferrer\">Attaching a Source to an existing Customer object</a> or,</li>\n<li><p>Update existing customer with a new token as the source from checkout i.e \n<a href=\"https://stripe.com/docs/api/go#update_customer\" rel=\"nofollow noreferrer\">update customer</a></p>\n\n<p><code>func updateCustomer(custID, email, source string) (cus *stripe.Customer, err error){\n    params := &amp;stripe.CustomerParams{\n        Email:email,\n    }\n    params.SetSource(source)\n    cus, err = customer.Update(custID, params)\n    return\n}</code></p></li>\n</ol>\n"}], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1460, "favorite_count": 0, "accepted_answer_id": 43591474, "answer_count": 3, "score": 1, "last_activity_date": 1530733148, "creation_date": 1492786415, "last_edit_date": 1492786630, "question_id": 43545819, "link": "https://stackoverflow.com/questions/43545819/associate-a-charge-with-a-customer-with-stripe", "title": "Associate a charge with a customer with Stripe", "body": "<p>I am creating a simple web page where the <a href=\"https://stripe.com/checkout\" rel=\"nofollow noreferrer\">Stripe Checkout</a> will prompt the user for their card info, generate a token, and send it to my backend Go webserver that processes the payment for that token. The issue I'm having is that when I get the token, I try and create a customer and set the source to the token created by Stripe, but I get this response everytime:</p>\n\n<pre><code>charge failed: {\"type\":\"invalid_request_error\",\"message\":\"Customer cus_######### does not have a linked source with ID tok_#########.\",\"code\":\"missing\",\"param\":\"source\",\"request_id\":\"req_######\",\"status\":404}\n</code></pre>\n\n<p>Creating the customer and associating the card with that customer works just fine. But, charging the card based on the token Stripe generated fails. Even though in the logs for that customer in my Stripe Dashboard it shows the attempted charge. So, it's trying to associate the charge with the correct customer, but failing because the token was generated without a specific customer in mind? I'm not really sure what is going on. </p>\n\n<p>The code I have on the backend that accepts the token and processes everything is below:</p>\n\n<pre><code>stripe.Key = \"sk_test_################\"\n\ncustomerParams := &amp;stripe.CustomerParams{\n    Desc:          \"Customer for xyz.com\",\n    Email:         \"test@email.com\",\n}\n\nerr := customerParams.SetSource(\"tok_####################\")\nif err != nil {\n    return nil, err\n}\n\ncus, err := customer.New(customerParams)\nif err != nil {\n    return nil, err\n}\n\n// Charge the user's card\ncp := &amp;stripe.ChargeParams{\n    Amount:   100,\n    Currency: \"usd\",\n    Desc:     \"some description\",\n    Customer: cus.ID,\n}\n\nerr = cp.SetSource(\"tok_####################\")\nif err != nil {\n    return nil, err\n}\n\nerr = charge.New(cp)\n</code></pre>\n\n<p>Also, if I remove the customer portion of this example, the charge goes through just fine with the above code. It just doesn't associate the charge with a customer obviously. However, as soon as I try to set the customer on the charge it fails. </p>\n"}]