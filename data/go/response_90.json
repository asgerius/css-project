[{"tags": ["go", "cryptography", "rsa", "private-key", "pem"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1475105927, "post_id": 39759153, "comment_id": 66814443, "body": "Needless to say I hope this is a throwaway private key :)"}, {"owner": {"reputation": 123, "user_id": 6085440, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ef8e54767d574352300bcf6a303f273d?s=128&d=identicon&r=PG&f=1", "display_name": "Khalil Claybon", "link": "https://stackoverflow.com/users/6085440/khalil-claybon"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1475106012, "post_id": 39759153, "comment_id": 66814463, "body": "yes it is @twotwotwo"}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 3, "creation_date": 1475107899, "post_id": 39759189, "comment_id": 66814830, "body": "Another trick is to use backticks: <a href=\"https://play.golang.org/p/LifNuyiGUI\" rel=\"nofollow noreferrer\">play.golang.org/p/LifNuyiGUI</a>"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 6, "last_activity_date": 1475105725, "creation_date": 1475105725, "answer_id": 39759189, "question_id": 39759153, "link": "https://stackoverflow.com/questions/39759153/generate-private-key-from-pem-string-golang/39759189#39759189", "title": "Generate Private Key from Pem String Golang", "body": "<p>There needs to be a newline after <code>\"-----BEGIN PRIVATE KEY-----\"</code> and before <code>\"-----END PRIVATE KEY-----\"</code></p>\n\n<p><a href=\"https://play.golang.org/p/T0jR2uzGp5\" rel=\"noreferrer\">https://play.golang.org/p/T0jR2uzGp5</a></p>\n"}], "owner": {"reputation": 123, "user_id": 6085440, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/ef8e54767d574352300bcf6a303f273d?s=128&d=identicon&r=PG&f=1", "display_name": "Khalil Claybon", "link": "https://stackoverflow.com/users/6085440/khalil-claybon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3047, "favorite_count": 1, "accepted_answer_id": 39759189, "answer_count": 1, "score": 6, "last_activity_date": 1475105725, "creation_date": 1475105466, "question_id": 39759153, "link": "https://stackoverflow.com/questions/39759153/generate-private-key-from-pem-string-golang", "title": "Generate Private Key from Pem String Golang", "body": "<p>I am trying to generate private and public key objects in Golang from PEM strings heres my example </p>\n\n<pre><code>    r := strings.NewReader(privateKey)\n    pemBytes, err := ioutil.ReadAll(r)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    block, _ := pem.Decode(pemBytes)\n    if block == nil {\n        log.Println(block)\n    }\n</code></pre>\n\n<p>Heres my PEM string </p>\n\n<pre><code> var privk = \"-----BEGIN PRIVATE KEY-----\"+\n\"MIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoIBAQDKlvdvjS7EEkYm\"+\n\"RcMYBemMNvIbMRoJPBuwtRHph8pehi/BUXmTUsGUSDelFAl6tH2eMpHD6FpMJkiu\"+\n\"PAm875yJYo9nxgnH8SNzS1FSR05qoFkJGSvkQwLd++V4Z17kqg9LyzQf/XGSiGGm\"+\n\"VbvPS8rkJUdrFxgTjqhw8KIfNXGG4zLNcB6i0YgW2lZFgaFB16J3/O4KDm21bgdi\"+\n\"qI6F5xKel/YSQl+AfF2NlFt5xI3wuZ4YhD7wrp3WWgiS/JIxu0ESDmJTYExdb3K0\"+\n\"Dh6bmQl+wYJbkBpO2csNRDehtM2YEU83N8mmlSbIbSSinZYT3KwT9JQbd8QqJZCP\"+\n\"/mOPFacrAgMBAAECggEAMqGWR3fWd0RF6ezHfGqF2vgke+1Cn4o5NWmbh2zbg9Iv\"+\n\"fzYYl1w4axG9bnFaiSMwvefPjFG2t49d3MW+fUy5J5DNXFcfPKwkev0Y3uJZU8at\"+\n\"WdvDn3Gr9sSsrfHPwoBKAFxRs6kIyGFzXjnRDVbY5zn15mrIJqMhr9BEBF6798TA\"+\n\"qTG0FYTqkGK0D+FVfaWXvQ0u9Jw0KootS4kKHNwDmbZK2xYI2Ilt1ikeN9MMt8ZD\"+\n\"tXV4shTnQaYPty5Atr9Dzh052FTnlwsclVo33XHF2N2dfe7TaJYTaf5uXuh7Vkj3\"+\n\"99bKuvA8iLmEVe+i86L9K9LD5QEywO/sNcqQkNU8sQKBgQDkycMSv1dfSAgSZywU\"+\n\"hcJqFWJ3TpAP5aoWqw8Svill3Qs6/2zatU4XC4tzRX9KW437M4ORNee/XrCi9z4L\"+\n\"VOeOtR+gp/zn9DebBzaEdTfMlof+znPfx9fVIpBkpjezDgiFNkeeMnKTQrT/kULl\"+\n\"Zso29pCfgO/57L9Vi3pjiqKt0wKBgQDir4EDVesZTGcBstSRLIGrUQFmvxICPaMm\"+\n\"0PogvQhUv8UFMxx6nBl/ZB7AZWQH0TRlpVL7iqS2clO1dQOgrtgwgUV4m3Ml9Ivr\"+\n\"vI2fgCWzFudPst3oSu9Udc9Pq995Pl2nnwV612p3P6p3wgCaFjbouyyJZxNmHQj/\"+\n\"JPtv65nSSQKBgQDVcRnJorLLlHLbYF9yYfunZn3vWl7yRcvxy/KLBNewTZENoIAY\"+\n\"Zm8M9ttJVjvTziheg4ep8EVdduSJlOnQPoysyXNROYeril5aBlepKYY+Gu2THV5j\"+\n\"FpjYIZ/eFmf+Zwgx5xrXjq7vjZs4lnd3dvcOYec4t1yqqGE0WKR8uzjbuwKBgAYL\"+\n\"0FEadY7TLtwovOqyWTMMkhD/f6d3pWZfpIxC/nnkM4kT9+p9R2DSds+C5MwglFkx\"+\n\"s6jp5cLIAduRJ2udvj5s9EFnRAb7ItBC0zQx4s+ICNtjVe/gL8n86m6hkvBU7YKP\"+\n\"B0JjhH9xv0Y6cnGprgU/GM0BZs8ObzL+9YXirtOhAoGACk1TGT6I5oMHLDB4yOOe\"+\n\"a7dT+kAY6a2W2Sq2e0VN70EkVmXGC6ODpRzPcH7nojcMN5jk8QHHosWNK8DECwAj\"+\n\"uCGYn8G/0yAlhkddzE1+y1f5nVm+GCQTrdMMuqOwJnosifdoNDbWg4oGiBRt1uwI\"+\n\"aoxbWonlDAZaLC+8Bxe1Hss=\"+\n\"-----END PRIVATE KEY-----\"\n</code></pre>\n\n<p>The pem.Decode function returns nil everytime what am I doing wrong?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475110069, "post_id": 39759625, "comment_id": 66815295, "body": "cannot use cmd.Stdout (type io.Writer) as type io.Reader in argument to ioutil.ReadAll: \tio.Writer does not implement io.Reader (missing Read method)"}, {"owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475110091, "post_id": 39759625, "comment_id": 66815301, "body": "i used your statement before and after run both times same error."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475110388, "post_id": 39759625, "comment_id": 66815354, "body": "Yeah sorry, I was looking at an example with some different settings supplied to <code>Run</code>. Try making that <code>cmd.StdoutPipe()</code> instead <a href=\"https://golang.org/pkg/os/exec/#Cmd.StdoutPipe\" rel=\"nofollow noreferrer\">golang.org/pkg/os/exec/#Cmd.StdoutPipe</a> - I updated the example to more closely reflect whats in the docs there. You may still need some other changes to your programs control flow for it to function well."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475110481, "post_id": 39759625, "comment_id": 66815369, "body": "@Victor also check out this answer; <a href=\"http://stackoverflow.com/questions/1877045/how-do-you-get-the-output-of-a-system-command-in-go\" title=\"how do you get the output of a system command in go\">stackoverflow.com/questions/1877045/&hellip;</a> if you call an overload of run you can reduce your code quite a bit."}, {"owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475119963, "post_id": 39759625, "comment_id": 66817416, "body": "isnt run a blocking call ? readall is also blocking so should i run readall in separate thread ?"}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1475110423, "last_edit_date": 1475110423, "creation_date": 1475109413, "answer_id": 39759625, "question_id": 39758689, "link": "https://stackoverflow.com/questions/39758689/how-to-capture-log-everything-after-spawning-an-interactive-program/39759625#39759625", "title": "How to capture/log everything after spawning an interactive program", "body": "<p>Rather than redirecting it's output to the terminal read it and then you can log/print do whatever you want with it.</p>\n\n<pre><code>    stdout, err := cmd.StdoutPipe()\n    b, _ := ioutil.ReadAll(stdout)\n    fmt.Println(string(b))\n</code></pre>\n\n<p>Something like the code above would work though there are many options. I think you'll want to remove all that code you have to redirect to the terminal. </p>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475282803, "post_id": 39760283, "comment_id": 66895980, "body": "good idea, but if the program is interactive such as ftp, then it wont print until the run command exits. e.g., if cmd1 is &#39;ftp&#39;"}], "tags": [], "owner": {"reputation": 21, "user_id": 6889766, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kiLki.png?s=128&g=1", "display_name": "benmcclelland", "link": "https://stackoverflow.com/users/6889766/benmcclelland"}, "is_accepted": false, "score": 0, "last_activity_date": 1475115110, "creation_date": 1475115110, "answer_id": 39760283, "question_id": 39758689, "link": "https://stackoverflow.com/questions/39758689/how-to-capture-log-everything-after-spawning-an-interactive-program/39760283#39760283", "title": "How to capture/log everything after spawning an interactive program", "body": "<p>you could store the output in a temporary buffer and write it to several places</p>\n\n<pre><code>outBuf := bytes.Buffer{}\ncmd := exec.Command(cmd1, slice...)\n\ncmd.Stdout = &amp;outBuf\n\ncmd.Run()\n\nif outBuf.Len() &gt; 0 {\n    log.Printf(\"%s\", outBuf.String())\n    fmt.Fprintf(os.Stdout, \"%s\", outBuf.String())\n}\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 95, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1475288131, "creation_date": 1475102068, "last_edit_date": 1475288131, "question_id": 39758689, "link": "https://stackoverflow.com/questions/39758689/how-to-capture-log-everything-after-spawning-an-interactive-program", "title": "How to capture/log everything after spawning an interactive program", "body": "<p>I have a method that can spawn an interactive process, now how do I log everything (including stdin and stdout) after spawning ?</p>\n\n<p>e.g.,</p>\n\n<pre><code>func execute(cmd1 string, slice []string) {\n\n    cmd := exec.Command(cmd1, slice...)\n\n    // redirect the output to terminal\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    cmd.Stdin = os.Stdin\n\n    cmd.Run()\n}\n</code></pre>\n\n<p>..\nThe interactive program could be :\nexecute(ftp) </p>\n\n<p>I think I have to dup stdin, stdout and read write in separate thread.</p>\n"}, {"tags": ["pointers", "methods", "go", "types"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1475101349, "post_id": 39758543, "comment_id": 66813212, "body": "Either it&#39;s a bug or a deliberate part of the implementation because having both versions of the method is just stupid. That&#39;s what dereferencing/address of is there for. If you have a pointer or an instance you can get the other quite easily."}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1475102782, "post_id": 39758543, "comment_id": 66813623, "body": "Consider <code>interface{GetName()string}</code> which method would get called if you would pass a struct implementing this interface to a function that would take this interface as an argument ?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1475103559, "last_edit_date": 1475103559, "creation_date": 1475103021, "answer_id": 39758817, "question_id": 39758543, "link": "https://stackoverflow.com/questions/39758543/why-cant-methods-with-pointer-and-non-pointer-receivers-have-the-same-name-in-g/39758817#39758817", "title": "Why can&#39;t methods with pointer and non-pointer receivers have the same name in Go?", "body": "<p><a href=\"https://golang.org/ref/spec#Method_sets\">Spec: Method sets:</a></p>\n\n<blockquote>\n  <p>The method set of any other type <code>T</code> consists of all methods declared with receiver type <code>T</code>. The method set of the corresponding pointer type <code>*T</code> is <strong>the set of all methods declared with receiver <code>*T</code> or <code>T</code> (that is, it also contains the method set of <code>T</code>).</strong></p>\n</blockquote>\n\n<p>So if you have a method with <code>Cat</code> as the receiver type, that method is also part of the method set of <code>*Cat</code>. So <code>*Cat</code> will already have that method, attempting to declare \"another\" one with the same name and <code>*Cat</code> as the receiver type will be a duplicate.</p>\n\n<p>To verify it, see this example:</p>\n\n<pre><code>type Cat struct{ Name string }\n\nfunc (c Cat) GetName() string { return c.Name }\n</code></pre>\n\n<p>We only declare one method with non-pointer receiver. If we check / print the methods of the corresponding <code>*Cat</code> type:</p>\n\n<pre><code>func main() {\n    var cp *Cat = &amp;Cat{} // Pointer\n    t := reflect.TypeOf(cp)\n    for i := 0; i &lt; t.NumMethod(); i++ {\n        fmt.Println(t.Method(i).Name)\n    }\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/3Wv4JPsfaV\">Go Playground</a>):</p>\n\n<pre><code>GetName\n</code></pre>\n\n<p>The type <code>*Cat</code> already has a <code>GetName</code> method. Adding another one with <code>*Cat</code> receiver would collide with the one above.</p>\n\n<p>Related question from the official FAQ: <a href=\"https://golang.org/doc/faq#overloading\">Why does Go not support overloading of methods and operators?</a></p>\n"}], "owner": {"reputation": 839, "user_id": 2069181, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2f6552b287743077c6b2c494c1ba37cb?s=128&d=identicon&r=PG", "display_name": "Wolfgang", "link": "https://stackoverflow.com/users/2069181/wolfgang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 291, "favorite_count": 0, "accepted_answer_id": 39758817, "answer_count": 1, "score": 3, "last_activity_date": 1475135267, "creation_date": 1475101092, "last_edit_date": 1475135267, "question_id": 39758543, "link": "https://stackoverflow.com/questions/39758543/why-cant-methods-with-pointer-and-non-pointer-receivers-have-the-same-name-in-g", "title": "Why can&#39;t methods with pointer and non-pointer receivers have the same name in Go?", "body": "<p>My understanding is that <code>Cat</code> and <code>*Cat</code> are different types in Go. So why do their names conflict? </p>\n\n<pre><code>type Animal interface {\n    GetName() string\n    SetName(string) \n}\n\ntype Cat struct {\n    Name string\n}\n\nfunc (c *Cat) GetName() string {\n    return c.Name\n}\n\nfunc (c Cat) GetName() string {\n    return c.Name\n}\n\nfunc (c *Cat) SetName(s string) {\n    c.Name = s\n}\n</code></pre>\n\n<p>Comiler response:</p>\n\n<blockquote>\n  <p>method redeclared: Cat.GetName</p>\n</blockquote>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1475123388, "post_id": 39758304, "comment_id": 66818222, "body": "These types of constructs are pretty basic stuff for Go and explained <i>very</i> well in the Tour of Go (<a href=\"https://tour.golang.org/\" rel=\"nofollow noreferrer\">tour.golang.org</a>). How about working your way through the tour once more?"}, {"owner": {"reputation": 2191, "user_id": 123800, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9361d516ffc27536fd2b535b86b4bb5?s=128&d=identicon&r=PG", "display_name": "kind_robot", "link": "https://stackoverflow.com/users/123800/kind-robot"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1475164552, "post_id": 39758304, "comment_id": 66844059, "body": "There is subtly which is not clear in the tour. There is a difference in getting a pointer vs instance itself when initializing a struct. When and why would I use one way VS the other."}], "answers": [{"comments": [{"owner": {"reputation": 2191, "user_id": 123800, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9361d516ffc27536fd2b535b86b4bb5?s=128&d=identicon&r=PG", "display_name": "kind_robot", "link": "https://stackoverflow.com/users/123800/kind-robot"}, "edited": false, "score": 0, "creation_date": 1475103440, "post_id": 39758309, "comment_id": 66813815, "body": "e1.SomeMethod() vs *e2.SomeMethod is essentially the same right? Go will be doing (*e1).SomeMethod(), if I am not mistaken."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 2191, "user_id": 123800, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9361d516ffc27536fd2b535b86b4bb5?s=128&d=identicon&r=PG", "display_name": "kind_robot", "link": "https://stackoverflow.com/users/123800/kind-robot"}, "edited": false, "score": 0, "creation_date": 1475104732, "post_id": 39758309, "comment_id": 66814165, "body": "@sheldon_cooper not exactly, they are different types. If I had a method like <code>func (e *Event) Test()</code> and tried to do <code>e1.Test()</code> I would get a compiler error. I could do <code>ep := &amp;e1</code> and then do <code>ep.Test()</code> or you could maybe do that inline or whatever but you would have to get the pointer in order to call the method defined with a pointer as the receiver. Basically, when calling methods, go will not massage or coerce the type for you. It must match what is in the method definition. You can convert value to pointer or pointer to value quite easily though."}, {"owner": {"reputation": 2191, "user_id": 123800, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9361d516ffc27536fd2b535b86b4bb5?s=128&d=identicon&r=PG", "display_name": "kind_robot", "link": "https://stackoverflow.com/users/123800/kind-robot"}, "edited": false, "score": 1, "creation_date": 1475165086, "post_id": 39758309, "comment_id": 66844385, "body": "Yup, I understand the difference between reference vs value receiver types.  I was referring this in the spec &quot;A method call x.m() is valid if the method set of (the type of) x contains m and the argument list can be assigned to the parameter list of m. If x is addressable and &amp;x&#39;s method set contains m, x.m() is shorthand for (&amp;x).m():&quot; URL to spec is :<a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Calls</a>. Thank you for the explanation. I&#39;ll experiment with this."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 4, "last_activity_date": 1475099743, "creation_date": 1475099743, "answer_id": 39758309, "question_id": 39758304, "link": "https://stackoverflow.com/questions/39758304/golang-struct-initialization/39758309#39758309", "title": "Golang struct initialization", "body": "<p>The type of <code>e1</code> is <code>Event</code> the type of <code>e2</code> is <code>*Event</code>. The initialization is actually the same (using composite literal syntax, also not sure if that jargon is Go or C# or both?) but with <code>e2</code> you using the 'address of operator' <code>&amp;</code> so it returns a pointer to that object rather than the instance itself.</p>\n"}, {"comments": [{"owner": {"reputation": 39263, "user_id": 323924, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19c51b649e40894c34905f0225196907?s=128&d=identicon&r=PG", "display_name": "Cheng Chen", "link": "https://stackoverflow.com/users/323924/cheng-chen"}, "edited": false, "score": 0, "creation_date": 1493969682, "post_id": 39780979, "comment_id": 74638082, "body": "&quot;Then e1 is not able to use the ChangeName method, while e2 is.&quot; is this conclusion still correct?"}, {"owner": {"reputation": 829, "user_id": 4667256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/860591147318225/picture?type=large", "display_name": "Gilbert Nwaiwu", "link": "https://stackoverflow.com/users/4667256/gilbert-nwaiwu"}, "reply_to_user": {"reputation": 39263, "user_id": 323924, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/19c51b649e40894c34905f0225196907?s=128&d=identicon&r=PG", "display_name": "Cheng Chen", "link": "https://stackoverflow.com/users/323924/cheng-chen"}, "edited": false, "score": 0, "creation_date": 1500574609, "post_id": 39780979, "comment_id": 77410882, "body": "@DannyChen: just tested. Not correct. Both could use the method"}, {"owner": {"reputation": 416, "user_id": 6762387, "user_type": "registered", "profile_image": "https://graph.facebook.com/1134342426612539/picture?type=large", "display_name": "Clemente Cuevas", "link": "https://stackoverflow.com/users/6762387/clemente-cuevas"}, "reply_to_user": {"reputation": 829, "user_id": 4667256, "user_type": "registered", "accept_rate": 76, "profile_image": "https://graph.facebook.com/860591147318225/picture?type=large", "display_name": "Gilbert Nwaiwu", "link": "https://stackoverflow.com/users/4667256/gilbert-nwaiwu"}, "edited": false, "score": 0, "creation_date": 1500667415, "post_id": 39780979, "comment_id": 77457770, "body": "@GilbertNwaiwu   It seems this is not the case, consistent with what you described, I will edit the original post, thanks for finding this inconsistency.  I am somewhat interested as to whether or not it has always been the case that a method defined on a pointer to a type is unable to be called by values of that type, or if this is a more recent development."}, {"owner": {"reputation": 416, "user_id": 6762387, "user_type": "registered", "profile_image": "https://graph.facebook.com/1134342426612539/picture?type=large", "display_name": "Clemente Cuevas", "link": "https://stackoverflow.com/users/6762387/clemente-cuevas"}, "edited": false, "score": 0, "creation_date": 1500667565, "post_id": 39780979, "comment_id": 77457843, "body": "A cursory search shows this post: <a href=\"https://stackoverflow.com/questions/27775376/value-receiver-vs-pointer-receiver-in-golang\" title=\"value receiver vs pointer receiver in golang\">stackoverflow.com/questions/27775376/&hellip;</a>  Linking to this thread: <a href=\"http://grokbase.com/t/gg/golang-nuts/1478q5p81c/go-nuts-making-a-copy-of-a-pointer-receiver\" rel=\"nofollow noreferrer\">grokbase.com/t/gg/golang-nuts/1478q5p81c/&hellip;</a>  So maybe this was changed in a recent update to Go, but googling about pointer method receivers hasn&#39;t returned anything from the Go release histories. I haven&#39;t written any Go in a while, so I am out of touch with recent changes to the language, and I am not about to look through the release histories on this.   Maybe someone can chime in."}], "tags": [], "owner": {"reputation": 416, "user_id": 6762387, "user_type": "registered", "profile_image": "https://graph.facebook.com/1134342426612539/picture?type=large", "display_name": "Clemente Cuevas", "link": "https://stackoverflow.com/users/6762387/clemente-cuevas"}, "is_accepted": true, "score": 31, "last_activity_date": 1567017817, "last_edit_date": 1567017817, "creation_date": 1475188092, "answer_id": 39780979, "question_id": 39758304, "link": "https://stackoverflow.com/questions/39758304/golang-struct-initialization/39780979#39780979", "title": "Golang struct initialization", "body": "<p>The first method</p>\n\n<pre><code>e1 := Event{Id: 1, Name: \"event 1\"}\n</code></pre>\n\n<p>is initializing the variable <code>e1</code> as a value with type <code>Event</code>.</p>\n\n<p>The second </p>\n\n<pre><code>e2 := &amp;Event{Id: 1, Name: \"event1\"}\n</code></pre>\n\n<p>is initializing <code>e2</code> as a pointer to a value of type <code>Event</code> <s>As you stated in the comments, the set of methods defined on a value of a given type are a subset of the set of methods defined on a pointer to a value of that type. This means that if you have a method</p>\n\n<pre><code>func (e Event) GetName() string {\n    return e.Name\n}\n</code></pre>\n\n<p>then both <code>e1</code> and <code>e2</code> can call this method, but if you had another method, say:</p>\n\n<pre><code>func (e *Event) ChangeName(s string) {\n    e.Name = s\n}\n</code></pre>\n\n<p>Then <code>e1</code> is not able to use the <code>ChangeName</code> method, while <code>e2</code> is.</s></p>\n\n<p><strong>This (<code>e1</code> is not able to use the <code>ChangeName</code> method, while <code>e2</code> is) is not the case (although it may have been at the time of writing for this help), thanks to @DannyChen for bringing this up and @GilbertNwaiwu for testing and posting in the comments below.</strong></p>\n\n<p>(To address the striked out section above: The set of methods defined on a struct type consist of the methods defined for the type and pointers to the type. </p>\n\n<p>Instead, Go now automatically dereferences the argument to a method, so that if a method receives a pointer, Go calls the method on a pointer to that struct, and if the method receives a value, Go calls the method on the value pointed to by that struct. At this point my attempt to update this answer may be missing something important in semantics so if someone would like to correct this or clarify feel free to add a comment pointing to a more comprehensive answer. Here is a bit from the go playground illustrating this issue: <a href=\"https://play.golang.org/p/JcD0izXZGz\" rel=\"noreferrer\">https://play.golang.org/p/JcD0izXZGz</a>. </p>\n\n<p>To some extent, this change in how pointers and values work as arguments to methods defined on function affects some areas of the discourse below but I will leave the rest unedited unless someone encourages me to update it as it seems to be more or less correct within the context of general semantics of languages that pass by value vs. pointer.) </p>\n\n<p>As to the difference between pointers and values, this example is illustrative, as pointers are ordinarily used in Go to allow you to mutate the values a variable is pointing to (but there are many more reasons one might use pointers as well! Although for typical use, this is normally a solid assumption). Thus, if you defined <code>ChangeName</code> instead as:</p>\n\n<pre><code>func (e Event) ChangeName(s string) {\n    e.Name = s\n}\n</code></pre>\n\n<p>This function would not be very useful if called on the value receiver, as values (not pointers) won't keep changes that are made to them if they're passed into a function. This has to do with an area of language design around how variables are assigned and passed: <a href=\"https://stackoverflow.com/questions/373419/whats-the-difference-between-passing-by-reference-vs-passing-by-value\">What&#39;s the difference between passing by reference vs. passing by value?</a></p>\n\n<p>You can see this on this example in the Go Playground: <a href=\"https://play.golang.org/p/j7yxvu3Fe6\" rel=\"noreferrer\">https://play.golang.org/p/j7yxvu3Fe6</a></p>\n"}], "owner": {"reputation": 2191, "user_id": 123800, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/c9361d516ffc27536fd2b535b86b4bb5?s=128&d=identicon&r=PG", "display_name": "kind_robot", "link": "https://stackoverflow.com/users/123800/kind-robot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50915, "favorite_count": 13, "accepted_answer_id": 39780979, "answer_count": 2, "score": 30, "last_activity_date": 1567017817, "creation_date": 1475099690, "last_edit_date": 1567017308, "question_id": 39758304, "link": "https://stackoverflow.com/questions/39758304/golang-struct-initialization", "title": "Golang struct initialization", "body": "<p>There is a simple struct like this:</p>\n\n<pre><code>type Event struct {\n    Id         int\n    Name       string\n}\n</code></pre>\n\n<p>What is the difference between these two initialization methods?</p>\n\n<pre><code>e1 := Event{Id: 1, Name: \"event 1\"}\ne2 := &amp;Event{Id: 2, Name: \"event 2\"}\n</code></pre>\n\n<p>Any why would I use either of these initialization methods?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 0, "creation_date": 1475096411, "post_id": 39757448, "comment_id": 66811102, "body": "Ok, but why does go test -cover manage to give me a percentage?"}, {"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "reply_to_user": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 2, "creation_date": 1475096536, "post_id": 39757448, "comment_id": 66811165, "body": "@GertCuykens I&#39;m just speculating here but I&#39;d say it&#39;s because when you run <code>go test</code> it knows the code it&#39;s testing but when you try to run <code>go tool cover</code> later it has to go off the package names in the <code>coverage.out</code> and can&#39;t find them."}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "edited": false, "score": 2, "creation_date": 1475096791, "post_id": 39757448, "comment_id": 66811306, "body": "Ok thanks your answer is correct but I am going to create a feature request on github I think for this because for me it&#39;s counter intuitive to be forced to put your src it in gopath just for the cover tool"}], "tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": true, "score": 6, "last_activity_date": 1475095947, "creation_date": 1475095947, "answer_id": 39757448, "question_id": 39756930, "link": "https://stackoverflow.com/questions/39756930/go-test-coverprofile-cannot-find-package/39757448#39757448", "title": "go test coverprofile cannot find package", "body": "<p>Your package <code>/Users/gert/Desktop/httx/</code> is outside of your <code>$GOPATH</code> which is <code>/Users/gert/go</code>. Move the <code>httx</code> package somewhere under your <code>$GOPATH</code> and it will work fine. You could move it to <code>/Users/gert/go/src/httx</code> or probably something like <code>/Users/gert/go/src/github.com/your-github-name/httx</code> (assuming you use GitHub).</p>\n"}, {"tags": [], "owner": {"reputation": 831, "user_id": 1048072, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53725fd0dee3ecda7cab96db0c5fd0b?s=128&d=identicon&r=PG", "display_name": "hustljian", "link": "https://stackoverflow.com/users/1048072/hustljian"}, "is_accepted": false, "score": 3, "last_activity_date": 1536048394, "creation_date": 1536048394, "answer_id": 52161617, "question_id": 39756930, "link": "https://stackoverflow.com/questions/39756930/go-test-coverprofile-cannot-find-package/52161617#52161617", "title": "go test coverprofile cannot find package", "body": "<p>see <a href=\"https://github.com/golang/go/issues/22430#issuecomment-414668599\" rel=\"nofollow noreferrer\">use relative path</a></p>\n\n<p>change coverage path to <code>./</code> :</p>\n\n<pre><code>sed -i \"s/_$(pwd|sed 's/\\//\\\\\\//g')/./g\" coverage.out\n</code></pre>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1595, "favorite_count": 1, "accepted_answer_id": 39757448, "answer_count": 2, "score": 4, "last_activity_date": 1536048394, "creation_date": 1475093996, "last_edit_date": 1475096471, "question_id": 39756930, "link": "https://stackoverflow.com/questions/39756930/go-test-coverprofile-cannot-find-package", "title": "go test coverprofile cannot find package", "body": "<p>When I try the following</p>\n\n<pre><code>go test -coverprofile=coverage.out\n</code></pre>\n\n<p>I get this coverage.out:</p>\n\n<pre><code>mode: set\n_/Users/gert/Desktop/httx/auth.go:10.66,11.54 1 0\n_/Users/gert/Desktop/httx/auth.go:11.54,13.89 2 0\n_/Users/gert/Desktop/httx/auth.go:17.3,17.11 1 0\n_/Users/gert/Desktop/httx/auth.go:13.89,16.4 2 0\n_/Users/gert/Desktop/httx/auth.go:22.42,25.2 2 0\n...\n</code></pre>\n\n<p>But when I then do</p>\n\n<pre><code>go tool cover -func=coverage.out\n</code></pre>\n\n<p>coverage.out doesn't seem to be correctly formatted?</p>\n\n<pre><code>cover: can't find \"auth.go\": cannot find package \"_/Users/gert/Desktop/httx/\" in any of:                                     \n        /usr/local/Cellar/go/1.7.1/libexec/src/_/Users/gert/Desktop/httx (from $GOROOT)                                      \n        /Users/gert/go/src/_/Users/gert/Desktop/httx (from $GOPATH)\n</code></pre>\n\n<p>EDIT: Note that <code>go test -cover</code> works. </p>\n\n<pre><code>PASS                                                                                                                         \ncoverage: 29.7% of statements                                                                                                \nok      _/Users/gert/Desktop/httx       0.015s\n</code></pre>\n"}, {"tags": ["random", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 2, "creation_date": 1475091702, "post_id": 39756133, "comment_id": 66808445, "body": "That issue suggested using two random uint32&#39;s, any reason that doesn&#39;t work for you?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 3, "creation_date": 1475091720, "post_id": 39756133, "comment_id": 66808457, "body": "you can shift-OR two int32 numbers, or something similar. You can also use the crypto/rand package and copy a byte buffer to a uint64."}, {"owner": {"reputation": 4884, "user_id": 1087001, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/8k294.jpg?s=128&g=1", "display_name": "Sam Whited", "link": "https://stackoverflow.com/users/1087001/sam-whited"}, "edited": false, "score": 1, "creation_date": 1475250991, "post_id": 39756133, "comment_id": 66883874, "body": "This should be fixed before the 1.8 release cycle is over at the end of October: <a href=\"https://go-review.googlesource.com/c/27253/1\" rel=\"nofollow noreferrer\">go-review.googlesource.com/c/27253/1</a>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 9, "last_activity_date": 1475093128, "last_edit_date": 1475093128, "creation_date": 1475091696, "answer_id": 39756320, "question_id": 39756133, "link": "https://stackoverflow.com/questions/39756133/how-do-you-generate-a-random-uint64-in-go/39756320#39756320", "title": "How do you generate a random uint64 in Go?", "body": "<p>The easiest would be to call <a href=\"https://golang.org/pkg/math/rand/#Uint32\" rel=\"noreferrer\"><code>rand.Uint32()</code></a> twice:</p>\n\n<pre><code>func Uint64() uint64 {\n    return uint64(rand.Uint32())&lt;&lt;32 + uint64(rand.Uint32())\n}\n</code></pre>\n\n<p>Another option is to call <a href=\"https://golang.org/pkg/math/rand/#Read\" rel=\"noreferrer\"><code>rand.Read()</code></a> (<a href=\"https://golang.org/doc/go1.7#minor_library_changes\" rel=\"noreferrer\">was added in Go 1.7</a>) to read 8 bytes, then use the <a href=\"https://golang.org/pkg/encoding/binary/\" rel=\"noreferrer\"><code>encoding/binary</code></a> package to obtain a <code>uint64</code> value from it:</p>\n\n<pre><code>func Uint64() uint64 {\n    buf := make([]byte, 8)\n    rand.Read(buf) // Always succeeds, no need to check error\n    return binary.LittleEndian.Uint64(buf)\n}\n</code></pre>\n\n<p>Note: as the doc of <code>rand.Read()</code> states, it always reads as many bytes as the length of the passed slice, and it always returns <code>nil</code> error, so no need to check error in this case.</p>\n\n<p>Note #2: you could also use <code>binary.BigEndian</code> instead of <code>binary.LittleEndian</code>, as we're generating a random number using all its bytes, order of bytes is completely irrelevant.</p>\n"}, {"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1475091810, "creation_date": 1475091810, "answer_id": 39756366, "question_id": 39756133, "link": "https://stackoverflow.com/questions/39756133/how-do-you-generate-a-random-uint64-in-go/39756366#39756366", "title": "How do you generate a random uint64 in Go?", "body": "<p>You can also read 8 random bytes, and convert to a uint64</p>\n\n<pre><code>b := make([]byte, 8)\n_, err := rand.Read(b)\nreturn binary.LittleEndian.Uint64(b), err\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11296, "user_id": 1931641, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d97ff8806b1550dfde5f6c9f09af6f92?s=128&d=identicon&r=PG", "display_name": "PassKit", "link": "https://stackoverflow.com/users/1931641/passkit"}, "edited": false, "score": 0, "creation_date": 1545309356, "post_id": 49831984, "comment_id": 94584603, "body": "Note that this would not be cryptographically secure and therefore not suitable for many applications."}], "tags": [], "owner": {"reputation": 555, "user_id": 4461141, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/0dhjb.jpg?s=128&g=1", "display_name": "hbd", "link": "https://stackoverflow.com/users/4461141/hbd"}, "is_accepted": false, "score": 2, "last_activity_date": 1523712694, "creation_date": 1523712694, "answer_id": 49831984, "question_id": 39756133, "link": "https://stackoverflow.com/questions/39756133/how-do-you-generate-a-random-uint64-in-go/49831984#49831984", "title": "How do you generate a random uint64 in Go?", "body": "<p>You can call <code>rand.Uint64()</code> directly:\n<code>\nr := rand.Uint64()\n</code></p>\n\n<blockquote>\n  <p>Uint64 returns a pseudo-random 64-bit value as a uint64 from the default Source.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/pkg/math/rand/#Uint64\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/rand/#Uint64</a></p>\n\n<p>This is available in versions <code>1.8</code> and up: <a href=\"https://golang.org/doc/go1.8#math_rand\" rel=\"nofollow noreferrer\">changelog</a></p>\n"}], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3782, "favorite_count": 1, "accepted_answer_id": 39756320, "answer_count": 3, "score": 8, "last_activity_date": 1523712694, "creation_date": 1475091078, "question_id": 39756133, "link": "https://stackoverflow.com/questions/39756133/how-do-you-generate-a-random-uint64-in-go", "title": "How do you generate a random uint64 in Go?", "body": "<p>Go's <code>math/random</code> library is missing a function to generate 64-bit numbers. This has been <a href=\"https://github.com/golang/go/issues/4254\" rel=\"noreferrer\">an open issue</a> for about four years. In the meantime, what does a workaround look like?</p>\n"}, {"tags": ["go", "gorilla"], "answers": [{"comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 2, "creation_date": 1475087271, "post_id": 39754861, "comment_id": 66806227, "body": "There are plenty HTTP routers around there, which are more secure and more efficient. You can find a small list under <a href=\"http://awesome-go.com/#middlewares\" rel=\"nofollow noreferrer\">awesome-go.com/#middlewares</a>. Problem with your implementation: Possibility to render arbitrary files (/users/../../../../etc/passwd)"}, {"owner": {"reputation": 874, "user_id": 1592901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09688668c0aeac78df901bd5725282dd?s=128&d=identicon&r=PG", "display_name": "jlonganecker", "link": "https://stackoverflow.com/users/1592901/jlonganecker"}, "reply_to_user": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1475088187, "post_id": 39754861, "comment_id": 66806719, "body": "Thanks for the resource I will check that out.For my use case it is an internal tool, and it isn&#39;t serving  static files, it is just matching an incoming path and calling a provided ResponseWriter. Can you clarify why this answer is not secure?  I also mentioned performance in my answer."}], "tags": [], "owner": {"reputation": 874, "user_id": 1592901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09688668c0aeac78df901bd5725282dd?s=128&d=identicon&r=PG", "display_name": "jlonganecker", "link": "https://stackoverflow.com/users/1592901/jlonganecker"}, "is_accepted": false, "score": 0, "last_activity_date": 1475086592, "creation_date": 1475086592, "answer_id": 39754861, "question_id": 39754860, "link": "https://stackoverflow.com/questions/39754860/how-to-use-gorilla-mux-to-match-entire-path-with-regex/39754861#39754861", "title": "How to use Gorilla Mux to match entire path with regex", "body": "<p>I ended up writing my own custom matcher function and used go's regex package. It was very easy to do and here is an example:</p>\n\n<pre><code>import (\n  ...\n    \"net/http\"\n    \"net/url\"\n    \"regexp\"\n    \"github.com/gorilla/mux\"\n  ...\n)\n\n...\n\nmuxRouter := mux.NewRouter()\n\nmuxRouter.\n  Methods(\"GET\", \"POST\").\n  Schemes(\"https\").\n  MatcherFunc(func(r *http.Request, rm *mux.RouteMatch) bool {\n    match, _ := regexp.MatchString(\"/users.*\", r.URL.Path)\n    // TODO handle error from regex\n    return match\n  }).\n  HandlerFunc(m.ServeHTTP)\n</code></pre>\n\n<p><strong>The key is to use:</strong><br>\n<code>HandlerFunc(f func(http.ResponseWriter, *http.Request))</code></p>\n\n<p><strong>and not:</strong><br>\n<code>HandleFunc(path string, f func(http.ResponseWriter, *http.Request))</code>. </p>\n\n<p><code>HandlerFunc</code> must come after your matchers. This will allow you to write your own custom matcher function.</p>\n\n<p><strong>Performance</strong><br>\nFor my use case this performs well, but if you want better performance you could try using a precompiled <code>r, _ := regexp.Compile(\"p([a-z]+)ch\")</code>.</p>\n\n<p>You would probably need to use a struct with a <code>f func(http.ResponseWriter, *http.Request)</code> that already has a precompile regex pattern stored in the struct.</p>\n\n<p><strong>Go Regex Examples:</strong><Br>\n<a href=\"https://gobyexample.com/regular-expressions\" rel=\"nofollow\">https://gobyexample.com/regular-expressions</a></p>\n\n<p>Go to Town! Hope you guys find this helpful.</p>\n"}], "owner": {"reputation": 874, "user_id": 1592901, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/09688668c0aeac78df901bd5725282dd?s=128&d=identicon&r=PG", "display_name": "jlonganecker", "link": "https://stackoverflow.com/users/1592901/jlonganecker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1631, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475086592, "creation_date": 1475086592, "question_id": 39754860, "link": "https://stackoverflow.com/questions/39754860/how-to-use-gorilla-mux-to-match-entire-path-with-regex", "title": "How to use Gorilla Mux to match entire path with regex", "body": "<p>I would like to be able to use regex to match the entire path not just a portion of it.</p>\n\n<p>For Example:</p>\n\n<pre><code>/users.*\n</code></pre>\n\n<p>would match</p>\n\n<pre><code>/users\n/users/bob\n/users/bob/repos\n</code></pre>\n\n<p>Currently with Mux's <code>HandleFunc</code> you would have to match multiple paths</p>\n\n<pre><code>/users\n/users/{.*}\n/users/{.*}/{.*}\n...\n</code></pre>\n"}, {"tags": ["mongodb", "rest", "go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1475106501, "post_id": 39754835, "comment_id": 66814570, "body": "You need to use <code>$set</code> <a href=\"https://docs.mongodb.com/manual/reference/operator/update/set/\" rel=\"nofollow noreferrer\">operator</a>. This <a href=\"http://stackoverflow.com/questions/23583198/partial-update-using-mgo\">answer</a> is related to your question."}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "edited": false, "score": 1, "creation_date": 1475133822, "post_id": 39754835, "comment_id": 66822736, "body": "And in order to use the PATCH as expected, you need to use <code>$set</code> with the <code>bson&#47;map[string]interface{}</code> with that exact path to update. If you use <code>user</code>, it will become PUT and whole data will be overwritten."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1475180277, "post_id": 39754835, "comment_id": 66852799, "body": "thaks @putu . think I got it now"}], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 441, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475179766, "creation_date": 1475086497, "last_edit_date": 1475179766, "question_id": 39754835, "link": "https://stackoverflow.com/questions/39754835/put-and-path-methods-with-mongodb-and-golang-for-rest-api", "title": "PUT and PATH methods with MongoDB and Golang for REST API", "body": "<p>I have been using the mgo driver for a while, but now its my first time having to write a fully tested REST API with it. </p>\n\n<p>Here it my goal</p>\n\n<pre><code>GET /users - Retrieves a list of users\nGET /users/12 - Retrieves a specific users\nPOST /users - Creates a new user \nPUT /users/12 - Updates user #12 \nPATCH /users/12 - Partially updates user #12\nDELETE /users/12 - Deletes user #12\n</code></pre>\n\n<p>My problems arise from the PATCH/PUT method. Here its what I have so far </p>\n\n<pre><code>dao := daos.NewUserCollection(r)\nuserRequest, err := dao.GetUserRequest(r)\nfound, err := dao.GetByID(mux.Vars(r)[\"id\"])\nerr = dao.Patch(mux.Vars(r)[\"id\"],userRequest)\nupdated, err := dao.GetByID(mux.Vars(r)[\"id\"])\nlog.Println(\"##################################################\")\nlog.Println(\"URL PARAMETER\", mux.Vars(r)[\"id\"])\nlog.Println(\"USER FROM BODY\",util.Marshall(userRequest))\nlog.Println(\"USER FROM DB\",util.Marshall(found))\nlog.Println(\"UPDATED USER FROM DB\",util.Marshall(updated))\nlog.Println(\"##################################################\")\n</code></pre>\n\n<p>I am getting the user like</p>\n\n<pre><code>func (c *UserCollection) GetByID(id string) (models.User, error) {\n    result := models.User{}\n    err := c.FindId(bson.ObjectIdHex(id)).One(&amp;result)\n    return result, err\n}\n</code></pre>\n\n<p>I am doing the patching like </p>\n\n<pre><code>func (c *UserCollection) Patch(selector string, user models.User) ( error) {\n    err := c.UpdateId(bson.ObjectIdHex(selector),user)\n    return  err\n}\n</code></pre>\n\n<p>But the logs show me an unwanted behaviour</p>\n\n<pre><code>2016/09/28 14:10:57 ##################################################\n2016/09/28 14:10:57 URL PARAMETER 57ebf9a1926bbc5bd0e666d9\n2016/09/28 14:10:57 USER FROM BODY {\"id\":\"57ebf9a1926bbc5bd0e666d9\",\"username\":\"Snarlripple\",\"email\":\"Slavefair@confirmed.com\",\"password\":\"password\",\"role\":\"\",\"devices\":[\"POWERDEVICE\"],\"confirmed\":false,\"notification\":false}\n2016/09/28 14:10:57 USER FROM DB {\"id\":\"57ebf9a1926bbc5bd0e666d9\",\"username\":\"Snarlripple\",\"email\":\"Slavefair@confirmed.com\",\"password\":\"$2a$04$gWErsTOWohjoJNON8l0O8OBQU0zHesFxS2vtgcqrOzcbwCEvxfUC.\",\"role\":\"user\",\"devices\":[],\"confirmed\":true,\"notification\":false}\n2016/09/28 14:10:57 UPDATED USER FROM DB {\"id\":\"57ebf9a1926bbc5bd0e666d9\",\"username\":\"Snarlripple\",\"email\":\"Slavefair@confirmed.com\",\"password\":\"password\",\"role\":\"\",\"devices\":[\"POWERDEVICE\"],\"confirmed\":false,\"notification\":false}\n2016/09/28 14:10:57 ##################################################\n</code></pre>\n\n<p>The api is changing the password and the role of the user. I do not want my clients to be able to do this. I want to make it so there are just a few fields it has  Whats the idiomatic way of doing this? </p>\n\n<h2>UPDATE</h2>\n\n<p>I got it to work with the below. Not sure if it the best way, but works.</p>\n\n<pre><code>func (c *UserCollection) Patch(id string, user User) error {\n    coolmap := structs.Map(&amp;user)\n     setBSON := bson.M{}\n    for key, value := range coolmap{\n        if !contains([]string{\"ID\",\"Role\", \"Password\", \"Devices\"},key) {\n            setBSON[strings.ToLower(key)] =value\n        }\n    }\n    changes := bson.M{\"$set\": setBSON }\n    err := c.UpdateId(bson.ObjectIdHex(id),changes)\n    return err\n}\n\n\nfunc contains(s []string, e string) bool {\n    for _, a := range s {\n        if a == e {\n            return true\n        }\n    }\n    return false\n}\n</code></pre>\n"}, {"tags": ["arrays", "go", "types", "slice"], "comments": [{"owner": {"reputation": 375, "user_id": 3150550, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aec1172df116b59824119f1d72080c0c?s=128&d=identicon&r=PG", "display_name": "cderwin", "link": "https://stackoverflow.com/users/3150550/cderwin"}, "edited": false, "score": 0, "creation_date": 1475084427, "post_id": 39754151, "comment_id": 66804479, "body": "Oh wait is it because <code>[]byte</code> is equivalent to <code>string</code> and iterating through a <code>string</code> should give you a <code>rune</code>?  This is mad confusing, why not limit that sort of behavior to the <code>string</code> type?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 7, "creation_date": 1475084489, "post_id": 39754151, "comment_id": 66804512, "body": "No, <code>for i := range thing</code> sets i to <i>indices</i> into thing (unlike Python or such). <code>for i, b := range byteslice</code> would put the index in <code>i</code> and byte in <code>b</code>, and <code>for _, b := range byteslice</code> would just put the byte in <code>b</code>."}, {"owner": {"reputation": 375, "user_id": 3150550, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aec1172df116b59824119f1d72080c0c?s=128&d=identicon&r=PG", "display_name": "cderwin", "link": "https://stackoverflow.com/users/3150550/cderwin"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1475084934, "post_id": 39754151, "comment_id": 66804786, "body": "Oh gosh, I&#39;m stupid, thanks a ton.  If you want to make that an answer i&#39;ll mark it as correct."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1475085459, "creation_date": 1475085459, "answer_id": 39754533, "question_id": 39754151, "link": "https://stackoverflow.com/questions/39754151/why-are-elements-of-byte-slices-returned-as-ints-in-go/39754533#39754533", "title": "Why are Elements of Byte Slices Returned as Ints in Go?", "body": "<p>It's not the slice/bytes/strings/runes causing the problem. It's your use of range. You're expecting to be looking at the current item but you're actually looking at the integer that represents the current index on each iteration of the loop.</p>\n\n<p>To be clear, if your loops form is; <code>for i, v := range</code> then <code>i</code> is an int representing the current index while <code>v</code> is a block of temporary storage that the value at index <code>i</code> is assigned to. If you want only the values then your loop would be; <code>for _, v := range</code>. When you only have one identifier on the left it assigned the index, not the value.</p>\n"}, {"tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": true, "score": 4, "last_activity_date": 1475101325, "last_edit_date": 1475101325, "creation_date": 1475085697, "answer_id": 39754615, "question_id": 39754151, "link": "https://stackoverflow.com/questions/39754151/why-are-elements-of-byte-slices-returned-as-ints-in-go/39754615#39754615", "title": "Why are Elements of Byte Slices Returned as Ints in Go?", "body": "<p><code>for i := range thing</code> sets <code>i</code> to indices into the thing (unlike Python or such). <code>for i, b := range byteslice</code> would put the <em>index</em> in <code>i</code> and byte in <code>b</code>, and <code>for _, b := range byteslice</code> would just put the byte in <code>b</code>.</p>\n\n<p><a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow\">The spec on for statements</a> lays out all the different special cases related to <code>range</code> expressions (including strings, channels, and maps as well).</p>\n"}], "owner": {"reputation": 375, "user_id": 3150550, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aec1172df116b59824119f1d72080c0c?s=128&d=identicon&r=PG", "display_name": "cderwin", "link": "https://stackoverflow.com/users/3150550/cderwin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 39754615, "answer_count": 2, "score": -1, "last_activity_date": 1475101325, "creation_date": 1475084026, "question_id": 39754151, "link": "https://stackoverflow.com/questions/39754151/why-are-elements-of-byte-slices-returned-as-ints-in-go", "title": "Why are Elements of Byte Slices Returned as Ints in Go?", "body": "<p>On the go playground, this code</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nvar a = []byte{ 0xff, 0xaa, 0x66, 0x33, 0x00 }\n\nfunc main() {\n    for b := range a {\n        fmt.Printf(\"%T\\n\", b)\n    }\n}\n</code></pre>\n\n<p>prints</p>\n\n<pre><code>int\nint\nint\nint\nint\n</code></pre>\n\n<p>Why in the world wouldn't a slice of bytes give you bytes when you iterate through it (or at least uint8 or something)?</p>\n\n<p>Here's the link to the playground: <a href=\"https://play.golang.org/p/V1uZZWWq-X\" rel=\"nofollow\">https://play.golang.org/p/V1uZZWWq-X</a>.</p>\n"}, {"tags": ["go", "yarn", "h2o"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1475084340, "post_id": 39754003, "comment_id": 66804426, "body": "Use Go 1.7.1 or higher as stated in the <a href=\"https://github.com/h2oai/steam/blob/master/DEVEL.md\" rel=\"nofollow noreferrer\">developer instructions</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1571, "user_id": 1732222, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/QD9zN.png?s=128&g=1", "display_name": "Micah Stubbs", "link": "https://stackoverflow.com/users/1732222/micah-stubbs"}, "is_accepted": false, "score": 1, "last_activity_date": 1475097353, "creation_date": 1475097353, "answer_id": 39757792, "question_id": 39754003, "link": "https://stackoverflow.com/questions/39754003/error-building-h2o-steam-binary-lib-yarn-yarn-go222-cannot-find-package-con/39757792#39757792", "title": "error building h2o steam binary: lib/yarn/yarn.go:22:2: cannot find package &quot;context&quot; in any of:", "body": "<p>updating go to <code>go1.7.1</code> resolved the issue. to update, follow the instructions at golang.org to:</p>\n\n<ul>\n<li><a href=\"https://golang.org/doc/install#uninstall\" rel=\"nofollow\">uninstall the old version of go</a></li>\n<li><a href=\"https://golang.org/doc/install\" rel=\"nofollow\">install the latest version of go</a></li>\n</ul>\n"}], "owner": {"reputation": 1571, "user_id": 1732222, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/QD9zN.png?s=128&g=1", "display_name": "Micah Stubbs", "link": "https://stackoverflow.com/users/1732222/micah-stubbs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 143, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475097353, "creation_date": 1475083518, "last_edit_date": 1495541212, "question_id": 39754003, "link": "https://stackoverflow.com/questions/39754003/error-building-h2o-steam-binary-lib-yarn-yarn-go222-cannot-find-package-con", "title": "error building h2o steam binary: lib/yarn/yarn.go:22:2: cannot find package &quot;context&quot; in any of:", "body": "<p>while following the <a href=\"https://stackoverflow.com/questions/ask\">dev setup guide</a> for h2o steam I encounter this error:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pVc5z.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pVc5z.png\" alt=\"enter image description here\"></a></p>\n\n<p>as text </p>\n\n<p><code>\n\u279c  steam git:(master) pwd\n/Users/m/workspace/go-workspace/src/github.com/h2oai/steam\n\u279c  steam git:(master) make\ngo build\nlib/yarn/yarn.go:22:2: cannot find package \"context\" in any of:\n    /Users/m/workspace/go-workspace/src/github.com/h2oai/steam/vendor/context (vendor tree)\n    /usr/local/go/src/context (from $GOROOT)\n    /Users/m/workspace/go-workspace/src/context (from $GOPATH)\nmake: *** [build] Error 1\n</code></p>\n\n<p>how can I run <code>make</code> successfully?</p>\n"}, {"tags": ["sql", "database", "sqlite", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1475086789, "post_id": 39753941, "comment_id": 66805963, "body": "Since when does MySQL store data in something other than clear text without you explicitly telling it to?"}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1475087183, "post_id": 39753941, "comment_id": 66806181, "body": "Do you also store the compiled Go code in the SCM? Why can&#39;t you use the SQL source?"}, {"owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1475094545, "post_id": 39753941, "comment_id": 66810065, "body": "@evanmcdonnal, the MySQL on-disk format is built around b-trees as far as I know. To every SCM system I&#39;ve seen that will look like a binary blob-- it won&#39;t calculate a line-by-line diff, it&#39;ll just say &quot;these blobs are different&quot;. The fact that there are cleartext strings within that blob doesn&#39;t help-- they are separated by non-printable characters."}, {"owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "reply_to_user": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1475094583, "post_id": 39753941, "comment_id": 66810087, "body": "@CL we do not store the compiled Go code in the SCM, no. I&#39;m not sure I understand your question &quot;Why can&#39;t you use the SQL source&quot;."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1475095194, "post_id": 39753941, "comment_id": 66810454, "body": "I see... What about building a service between MySQL and SCM that just reads data from MySQL and makes it available to SCM in a format that it works with? I mean, does SCM try to read the raw data files off disk? Why doesn&#39;t it query the database like a normal application?"}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1475096199, "post_id": 39753941, "comment_id": 66810992, "body": "Dump the database as SQL text; store that in the SCM."}, {"owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1475109843, "post_id": 39753941, "comment_id": 66815253, "body": "@evanmcdonnal SCM stands for &quot;source code management&quot;, e.g. Git, SVN, Perforce, so on. They are themselves repositories for versioned text; they don&#39;t query, we push and pull data into/out of them."}, {"owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "reply_to_user": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1475109883, "post_id": 39753941, "comment_id": 66815261, "body": "@CL that&#39;s actually a pretty good suggestion. Submit it as an answer and I&#39;ll upvote it, and accept it if nothing better comes up."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1475110587, "post_id": 39753941, "comment_id": 66815395, "body": "Ah ok, yeah didn&#39;t get that acronym. I googled it and found some very different results. Yea, CL&#39;s suggestion is about right and similar to what I was alluding to with a service reading the data then writing it in a format that the SCM can work with."}, {"owner": {"reputation": 157205, "user_id": 11654, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/586424ca0847070dc1868aa58077003e?s=128&d=identicon&r=PG", "display_name": "CL.", "link": "https://stackoverflow.com/users/11654/cl"}, "edited": false, "score": 0, "creation_date": 1475133144, "post_id": 39753941, "comment_id": 66822338, "body": "Also see <a href=\"http://stackoverflow.com/q/33809881/11654\">What&#39;s a good way (or tool) to version control a SQLite database (schema only)?</a>"}], "owner": {"reputation": 278, "user_id": 3882761, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/de53bc6a417356dca44b12d601d0db28?s=128&d=identicon&r=PG&f=1", "display_name": "SAyotte", "link": "https://stackoverflow.com/users/3882761/sayotte"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "closed_date": 1475133123, "answer_count": 0, "score": 0, "last_activity_date": 1475083265, "creation_date": 1475083265, "question_id": 39753941, "link": "https://stackoverflow.com/questions/39753941/sql-or-any-relational-db-engine-with-scm-friendly-backing-store", "closed_reason": "Duplicate", "title": "SQL (or any relational db) engine with SCM-friendly backing store", "body": "<p>I have a bunch of data that's clearly relational: object A has a many:1 relationship with B, and B has a 1:many relationship with C, and so on. I can write a bunch of code to maintain this without insert/update/delete anomalies, but it feels like reinventing the wheel: relational DBs do a great job at this.</p>\n\n<p>SQLite would actually be a <em>great</em> fit here, if not for one thing...</p>\n\n<p>The data, once updated, has to be stored in an SCM system, and changes to the data need to be auditable by humans, which (in my estimation) requires cleartext storage.</p>\n\n<p>Is there an engine out there that will give me relational semantics but store the data in cleartext?</p>\n\n<p>Recapping, what I think my requirements are:</p>\n\n<ul>\n<li>Stores data in cleartext</li>\n<li>Maintains/enforces referential integrity</li>\n<li>(nice to have) implemented as a library rather than a standalone executable, a la SQLite</li>\n<li>(nice to have) bindings for the Go language</li>\n</ul>\n\n<p>And here are some things that are <em>not</em> requirements:</p>\n\n<ul>\n<li>SQL; any interface is fine</li>\n<li>High performance; I don't care if access is somewhat slow, it'll be dealing with megabytes of data / hundreds of thousands of records at most.</li>\n</ul>\n"}, {"tags": ["go", "docker", "dockerfile"], "answers": [{"tags": [], "owner": {"reputation": 1232, "user_id": 290293, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iCDyQ.gif?s=128&g=1", "display_name": "STLMikey", "link": "https://stackoverflow.com/users/290293/stlmikey"}, "is_accepted": false, "score": 1, "last_activity_date": 1475087404, "creation_date": 1475087404, "answer_id": 39755102, "question_id": 39753803, "link": "https://stackoverflow.com/questions/39753803/docker-golang-onbuild-custom-action-at-docker-run/39755102#39755102", "title": "Docker Golang onbuild custom action at docker run", "body": "<p>One option is to use the <code>--entrypoint</code> option during docker run:</p>\n\n<pre><code>docker run --entrypoint /some/sh/script.sh &lt;imagename&gt;\n</code></pre>\n\n<p>where script.sh is a file <em>inside</em> your container, and contains something like:</p>\n\n<pre><code>#!/bin/env bash    \nif [[ \"$myenvvar\" == 'myvalue' ]]; then\n    # sed your file here\nelse\n    #don't do that\nfi\n</code></pre>\n\n<p>If you dont like the idea of overriding the entrypoint at run time, you might consider using the <code>CMD</code> or <code>ENTRYPOINT</code> options in your Dockerfile.</p>\n"}, {"tags": [], "owner": {"reputation": 3678, "user_id": 2715438, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/qk6Uu.jpg?s=128&g=1", "display_name": "VladoDemcak", "link": "https://stackoverflow.com/users/2715438/vladodemcak"}, "is_accepted": true, "score": 1, "last_activity_date": 1475091984, "last_edit_date": 1475091984, "creation_date": 1475088462, "answer_id": 39755423, "question_id": 39753803, "link": "https://stackoverflow.com/questions/39753803/docker-golang-onbuild-custom-action-at-docker-run/39755423#39755423", "title": "Docker Golang onbuild custom action at docker run", "body": "<p>You can try something like this:</p>\n\n<pre><code>FROM golang:onbuild\nCOPY ./docker-entrypoint.sh /\n\nEXPOSE 5000 5001\nENTRYPOINT [\"/docker-entrypoint.sh\"]\n</code></pre>\n\n<p><strong>Note</strong>: you need to copy entry point file with your sed script somewhere into container (done on line 2)</p>\n\n<p>and <em>docker-entrypoint.sh</em> with your <code>sed</code> script</p>\n\n<pre><code># execute sed only **if variable exists**\nsed -ri \"s/&lt;title&gt;.*/&lt;title&gt;$ENVIRONMENT_VARIABLE&lt;/title&gt;/\" /path_to_html_file/index.html\n</code></pre>\n\n<p>- simple example of replacement line with new title (passed in run as env. variable) in index.html file</p>\n\n<p><strong>Note</strong>: just keep in mind to run sed only if environment variable was served as @STLMikey shows.</p>\n\n<p>and run docker container with <code>$ENVIRONMENT_VARIABLE</code></p>\n\n<p>eg:</p>\n\n<pre><code>docker run -d -t -i -e ENVIRONMENT_VARIABLE='New website title' --name=container_name IMAGE_NAME \n</code></pre>\n"}], "owner": {"reputation": 2122, "user_id": 433253, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8661e1fc24e3041a462484721277c2d1?s=128&d=identicon&r=PG", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/433253/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 39755423, "answer_count": 2, "score": 1, "last_activity_date": 1476904523, "creation_date": 1475082814, "last_edit_date": 1476904523, "question_id": 39753803, "link": "https://stackoverflow.com/questions/39753803/docker-golang-onbuild-custom-action-at-docker-run", "title": "Docker Golang onbuild custom action at docker run", "body": "<p>I have a fairly easy Dockerfile for a Go app:</p>\n\n<pre><code>FROM golang:onbuild\nEXPOSE 5000 5001\n</code></pre>\n\n<p>Now when I run it (not when building the image!) I would like to change a value in a html file which gets statically served, possibly using <code>sed</code> to use an environment variable previously specified with <code>-e</code> to docker run. How can I do that?</p>\n"}, {"tags": ["go", "wxwidgets"], "comments": [{"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1475083897, "post_id": 39753535, "comment_id": 66804175, "body": "What&#39;s OSX version? What&#39;s wx version? Can you build wx and try the dialog sample?"}, {"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1475086778, "post_id": 39753535, "comment_id": 66805952, "body": "10.11.6, master from github.com/dontpanic92/wxGo/wx which is wxWidgets-3.1.0, yeah the sample included builds fine but does not have any threads like my example"}, {"owner": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1475089857, "post_id": 39753535, "comment_id": 66807590, "body": "are you trying to work with the gauge and the window from the secondary thread?"}, {"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "reply_to_user": {"reputation": 4317, "user_id": 945871, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/b9b646cc701a3b906179ccf9ee68c350?s=128&d=identicon&r=PG", "display_name": "Igor", "link": "https://stackoverflow.com/users/945871/igor"}, "edited": false, "score": 0, "creation_date": 1475100090, "post_id": 39753535, "comment_id": 66812735, "body": "yeah, i&#39;m just trying to make the gauge grow slowly over the course of like 30 seconds to simulate progress in another thread."}], "answers": [{"comments": [{"owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1475220224, "post_id": 39773691, "comment_id": 66865510, "body": "thank you, I&#39;ve been reading <a href=\"http://docs.wxwidgets.org/trunk/overview_thread.html\" rel=\"nofollow noreferrer\">docs.wxwidgets.org/trunk/overview_thread.html</a> over and over but I can&#39;t get my wxPaintEvent that I add to to my Frame&#39;s wxEventHandler to do anything."}, {"owner": {"reputation": 18238, "user_id": 15275, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WNTZ3.jpg?s=128&g=1", "display_name": "VZ.", "link": "https://stackoverflow.com/users/15275/vz"}, "reply_to_user": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "edited": false, "score": 0, "creation_date": 1475316194, "post_id": 39773691, "comment_id": 66902204, "body": "You can&#39;t generate <code>wxPaintEvent</code>s directly, this is the job for the underlying GUI itself. You really do need to call <code>Refresh()</code> from the main thread."}], "tags": [], "owner": {"reputation": 18238, "user_id": 15275, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/WNTZ3.jpg?s=128&g=1", "display_name": "VZ.", "link": "https://stackoverflow.com/users/15275/vz"}, "is_accepted": false, "score": 0, "last_activity_date": 1475161034, "creation_date": 1475161034, "answer_id": 39773691, "question_id": 39753535, "link": "https://stackoverflow.com/questions/39753535/how-do-i-make-wxwidgets-using-golang-repaint-window-on-macos/39773691#39773691", "title": "how do I make wxWidgets (using golang) repaint window on MacOS?", "body": "<p>Generally speaking, doing anything with GUI objects from the non-main (i.e. not the one that initialized the library) thread is not supported by wxWidgets.</p>\n\n<p>The usual workaround is to post an event to the main thread asking it to update the widget instead of doing it directly in the worker thread. In C++ this can be done easily and elegantly using <a href=\"http://wxwidgets.blogspot.com/2013/01/about-benefits-of-procrastination.html\" rel=\"nofollow\">CallAfter()</a>, but I don't know enough about Go and wxGo to show you an example of doing it in this language.</p>\n"}, {"tags": [], "owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "is_accepted": true, "score": 0, "last_activity_date": 1475261076, "creation_date": 1475261076, "answer_id": 39798146, "question_id": 39753535, "link": "https://stackoverflow.com/questions/39753535/how-do-i-make-wxwidgets-using-golang-repaint-window-on-macos/39798146#39798146", "title": "how do I make wxWidgets (using golang) repaint window on MacOS?", "body": "<p>author of wxGo fixed it:</p>\n\n<p><a href=\"https://github.com/dontpanic92/wxGo/issues/10\" rel=\"nofollow\">https://github.com/dontpanic92/wxGo/issues/10</a></p>\n\n<pre><code>  wx.Bind(f, wx.EVT_THREAD, func(e wx.Event) {\n    threadEvent := wx.ToThreadEvent(e)\n    the_gauge.SetValue(threadEvent.GetInt())\n  }, UPLOAD_WORKER_ID)\n</code></pre>\n\n<p>then in the thread:</p>\n\n<pre><code>threadEvent := wx.NewThreadEvent(wx.EVT_THREAD, UPLOAD_WORKER_ID)\nthreadEvent.SetInt(50)\nf.QueueEvent(threadEvent)\n</code></pre>\n"}], "owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 281, "favorite_count": 1, "accepted_answer_id": 39798146, "answer_count": 2, "score": 2, "last_activity_date": 1475261076, "creation_date": 1475081950, "last_edit_date": 1475220360, "question_id": 39753535, "link": "https://stackoverflow.com/questions/39753535/how-do-i-make-wxwidgets-using-golang-repaint-window-on-macos", "title": "how do I make wxWidgets (using golang) repaint window on MacOS?", "body": "<p>Here's some sample code that puts a Gauge on the screen and make the progress bar increase 1 value every second. On MacOS I don't see the progress bar update unless I drag the window around or resize it manually with the mouse. Any idea how to force the whole thing to repaint? I'm calling f.Refresh() and f.Update()</p>\n\n<pre><code>package main\n\nimport \"github.com/dontpanic92/wxGo/wx\"\nimport \"time\"\n\nvar g wx.Gauge\n\ntype MyFrame struct {\n    wx.Frame\n}\n\nfunc (f *MyFrame) startUpload() {\n    for {\n        time.Sleep(time.Second)\n        g.SetValue(g.GetValue() + 1)\n        f.Refresh()\n        f.Update()\n    }\n}\n\nfunc NewMyFrame() MyFrame {\n    f := MyFrame{}\n    f.Frame = wx.NewFrame(wx.NullWindow, -1, \"Test Thread\")\n    mainSizer := wx.NewBoxSizer(wx.HORIZONTAL)\n    g = wx.NewGauge(f, wx.ID_ANY, 100, wx.DefaultPosition, wx.NewSize(600, 40), 0)\n    f.SetSizer(mainSizer)\n    mainSizer.Add(g, 100, wx.ALL|wx.EXPAND, 50)\n    f.Layout()\n    go f.startUpload()\n    return f\n}\n\nfunc main() {\n    wx1 := wx.NewApp()\n    f := NewMyFrame()\n    f.Show()\n    wx1.MainLoop()\n    return\n}\n</code></pre>\n\n<p>Update: I've been reading <a href=\"http://docs.wxwidgets.org/trunk/overview_thread.html\" rel=\"nofollow\">http://docs.wxwidgets.org/trunk/overview_thread.html</a> and I'm trying code like:</p>\n\n<pre><code>b := wx.NewPaintEvent()\nf.GetEventHandler().QueueEvent(b)\n</code></pre>\n\n<p>instead of calling Refresh and Update but my wx.NewPaintEvent doesn't do anything. Maybe I'm making the wx.NewPaintEvent wrong? Or I'm adding it to the wrong EventHandler?</p>\n"}, {"tags": ["go", "ssh"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475077830, "post_id": 39751899, "comment_id": 66800498, "body": "Fingerprint of what? Your remote server, your local ssh server, a particular publickey in your ssh-agent, a local file? (and BTW, that pattern you&#39;re showing as an example is the an md5 fingerprint which isn&#39;t used any longer)"}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475078119, "post_id": 39751899, "comment_id": 66800666, "body": "@JimB My local machine. I need it to use with terraform."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475079191, "post_id": 39751899, "comment_id": 66801389, "body": "@JimB  <a href=\"https://www.terraform.io/docs/providers/do/r/droplet.html\" rel=\"nofollow noreferrer\">terraform.io/docs/providers/do/r/droplet.html</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475080075, "post_id": 39751899, "comment_id": 66801990, "body": "The keys to access the droplet don&#39;t have anything to do with the publickey of your local machine&#39;s ssh daemon. If you&#39;re trying to define the key to access a droplet, you need to add that key in DigitalOcean, and then refer to it either by ID or or fingerprint, both of which they provide."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1475081383, "post_id": 39751899, "comment_id": 66802807, "body": "I&#39;d have to review the <code>ssh</code> package to see what it offers but if all else fails you can just run the command you noted above from your go code and read off stdout."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1475081462, "post_id": 39751899, "comment_id": 66802860, "body": "@evanmcdonnal Thanks! I have done it, but could not find it!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475083612, "post_id": 39751899, "comment_id": 66804012, "body": "@CESCO: ok, and example of what you&#39;re actually trying to do helps!"}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475083814, "post_id": 39751899, "comment_id": 66804136, "body": "@JimB  As evanmcdonnal mentioned, I am currently running the code with go and reading off stdout. I am writing a cli to deploy self-hosted Kubernetes on DO."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1475088323, "post_id": 39751899, "comment_id": 66806796, "body": "@CESCO: I&#39;m still going to repeat that the keys in DO are <i>not</i> referencing your local keys, but keys you registered with them, and you can get the fingerprint they&#39;re using via their API (with the ID). In terraform we would normally reference the key from elsewhere in the config like <code>ssh_keys  = [&quot;${digitalocean_ssh_key.foobar.id}&quot;]</code>, so there&#39;s no reason to try and calculate the fingerprint."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475092480, "post_id": 39751899, "comment_id": 66808888, "body": "@JimB you are right!"}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475119331, "post_id": 39751899, "comment_id": 66817278, "body": "@JimB looks like you cant use this <a href=\"https://www.terraform.io/docs/providers/do/r/ssh_key.html\" rel=\"nofollow noreferrer\">terraform.io/docs/providers/do/r/ssh_key.html</a> on two different projects. I get <code>422 SSH Key is already in use on your account</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475152983, "post_id": 39751899, "comment_id": 66835640, "body": "@CESCO: that&#39;s correct, you can&#39;t register the same key a second time. You should have a single terraform config/module handling that key, or even better, use separate keys for separate projects."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475175840, "post_id": 39751899, "comment_id": 66850485, "body": "@JimB So it turns out that is wiser to create an ssh key with go <a href=\"http://stackoverflow.com/a/21171325/3074508\">stackoverflow.com/a/21171325/3074508</a> and then create a DO ssh_key block referencing it. Does that sounds better?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475243959, "post_id": 39751899, "comment_id": 66879463, "body": "@CESCO: Is it wiser? Managing keys is usually left up to the user for a reason, since there are other security considerations. How are you going to securely manage that new private key? Are you going to encrypt the private key, and how would you do that? What if the user prefers ED25519 keys, or requires 4096 bit keys instead of 2048? Not saying you can&#39;t do it, but you have to be very careful in this area."}], "answers": [{"comments": [{"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1475084125, "post_id": 39754085, "comment_id": 66804292, "body": "perfect! Just need to append the : every two characther to consider as the right answer."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1475086360, "post_id": 39754085, "comment_id": 66805645, "body": "I am still having trouble getting the final result into a string. @JimB"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1475086869, "post_id": 39754085, "comment_id": 66806008, "body": "@CESCO: what exactly are you having trouble with? The example prints to stdout, but the string manipulation is pretty much the same."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "edited": false, "score": 0, "creation_date": 1475091482, "post_id": 39754085, "comment_id": 66808332, "body": "got it <code>str:= strings.ToUpper(hex.EncodeToString(fp[:]))</code>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1475084695, "last_edit_date": 1475084695, "creation_date": 1475083792, "answer_id": 39754085, "question_id": 39751899, "link": "https://stackoverflow.com/questions/39751899/ssh-fingerprint-with-golang/39754085#39754085", "title": "SSH Fingerprint with Golang", "body": "<p>A key signature is is just a cryptographic hash of the unencoded key data in ssh wire format.</p>\n\n<p>Here is a basic example of parsing an ssh key from the OpenSSH format public key, and getting an MD5 fingerprint:</p>\n\n<pre><code>key, err := ioutil.ReadFile(\"/path/to/id_rsa.pub\")\nif err != nil {\n    log.Fatal(err)\n}\n\nparts := strings.Fields(string(key))\nif len(parts) &lt; 2 {\n    log.Fatal(\"bad key\")\n}\n\nk, err := base64.StdEncoding.DecodeString(parts[1])\nif err != nil {\n    log.Fatal(err)\n}\n\nfp := md5.Sum([]byte(k))\nfmt.Print(\"MD5:\")\nfor i, b := range fp {\n    fmt.Printf(\"%02x\", b)\n    if i &lt; len(fp)-1 {\n        fmt.Print(\":\")\n    }\n}\nfmt.Println()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8142, "user_id": 1601137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VbZbR.jpg?s=128&g=1", "display_name": "Kenny Grant", "link": "https://stackoverflow.com/users/1601137/kenny-grant"}, "is_accepted": false, "score": 2, "last_activity_date": 1506438744, "creation_date": 1506438744, "answer_id": 46430167, "question_id": 39751899, "link": "https://stackoverflow.com/questions/39751899/ssh-fingerprint-with-golang/46430167#46430167", "title": "SSH Fingerprint with Golang", "body": "<p>Another way to do this is to parse the key using the ssh package and then use FingerprintLegacyMD5 in order to generate the fingerprint. See this answer:</p>\n\n<p><a href=\"https://stackoverflow.com/a/46430102/1601137\">https://stackoverflow.com/a/46430102/1601137</a></p>\n"}], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1900, "favorite_count": 0, "accepted_answer_id": 39754085, "answer_count": 2, "score": 0, "last_activity_date": 1506438744, "creation_date": 1475076824, "question_id": 39751899, "link": "https://stackoverflow.com/questions/39751899/ssh-fingerprint-with-golang", "title": "SSH Fingerprint with Golang", "body": "<p>How can I get my own ssh fingerprint with Go?</p>\n\n<pre><code>Finger, err := ssh.**\nlog.Println(Finger)\n// 12:f8:7e:78:61:b4:bf:e2:de:24:15:96:4e:d4:72:53\n</code></pre>\n"}, {"tags": ["go", "import", "vendor"], "comments": [{"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 0, "creation_date": 1475077120, "post_id": 39751831, "comment_id": 66800031, "body": "does the .gitmodule file changes the behavior of git relative to go get ? maybe you need to add that file too ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 0, "creation_date": 1475079591, "post_id": 39751831, "comment_id": 66801650, "body": "Note: <code>go get</code> never checks out or updates code stored in vendor directories.   do you have this path: <code>%GOPATH%\\src\\github.com\\mcandre\\mcandre\\go\\ddg\\vendor\\github&zwnj;&#8203;\u200c\u200b.com\\skratchdot\\op&zwnj;&#8203;en\u200c\u200b-golang\\open</code> Or this one: <code>%GOPATH%\\src\\github.com\\skratchdot\\open-golang\\open</code>"}], "owner": {"reputation": 19178, "user_id": 350106, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/dfe88469b75efc87cbcbbbc2a975850a?s=128&d=identicon&r=PG", "display_name": "mcandre", "link": "https://stackoverflow.com/users/350106/mcandre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 116, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1475076649, "creation_date": 1475076649, "question_id": 39751831, "link": "https://stackoverflow.com/questions/39751831/vendored-go-dependencies-fail-to-import", "title": "Vendored Go dependencies fail to import", "body": "<p>A tale of two projects:</p>\n\n<p>I wrote go-ios7crypt as a quick way to learn Go packaging. The dependencies are vendored using git submodules, and installation is as easy as <code>go get github.com/mcandre/go-ios7crypt/...</code></p>\n\n<p>Source: <a href=\"https://github.com/mcandre/go-ios7crypt\" rel=\"nofollow\">https://github.com/mcandre/go-ios7crypt</a></p>\n\n<p>However, I tried to repeat this pattern for another project, a DuckDuckGo command line launcher. I'm curious what I've done wrong, as neither <code>go get</code> nor <code>go build</code> work when applying the same git submodule-based vendoring to the dependencies for ddg.</p>\n\n<p>Trace:</p>\n\n<pre><code>&gt; go get github.com/mcandre/mcandre/go/ddg/...\n</code></pre>\n\n<p>(This silently fails to build the ddg binary.)</p>\n\n<pre><code>&gt; where.exe ddg\nINFO: Could not find files for the given pattern(s).\n</code></pre>\n\n<p>Also, the project fails to build from local sources:</p>\n\n<pre><code>&gt; go build\nmain.go:4:2: cannot find package \"github.com/skratchdot/open-golang/open\" in any of:\n        C:\\tools\\go1.7\\src\\github.com\\skratchdot\\open-golang\\open (from $GOROOT)\n        C:\\Users\\andrew\\go\\src\\github.com\\skratchdot\\open-golang\\open (from $GOPATH)\n\n&gt; echo $env:GOPATH\nC:\\Users\\andrew\\go\n</code></pre>\n\n<p>Source: <a href=\"https://github.com/mcandre/mcandre/tree/master/go/ddg\" rel=\"nofollow\">https://github.com/mcandre/mcandre/tree/master/go/ddg</a></p>\n\n<p>Could the problem be that ddg is a nested project? For comparison, github.com/mcandre/blah/blah/blah is a collection of Go and non-Go projects, whereas github.com/mcandre/go-ios7crypt is a single Go project.</p>\n\n<p>For what it's worth, I'm using Go 1.7 via gvm 1.0.0, with git 2.8.4, in PowerShell, on Windows 10 Professional x86_64.</p>\n"}, {"tags": ["go", "reflection"], "answers": [{"comments": [{"owner": {"reputation": 436, "user_id": 1638158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlmL8.jpg?s=128&g=1", "display_name": "John Dowling", "link": "https://stackoverflow.com/users/1638158/john-dowling"}, "edited": false, "score": 0, "creation_date": 1475142693, "post_id": 39751753, "comment_id": 66828496, "body": "Perfect, I did note that I could just do &quot;if result[0].Interface() == nil&quot; and remove the need to have the intermediary var, but solved my issue nether the less, thanks."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 436, "user_id": 1638158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlmL8.jpg?s=128&g=1", "display_name": "John Dowling", "link": "https://stackoverflow.com/users/1638158/john-dowling"}, "edited": false, "score": 1, "creation_date": 1475142863, "post_id": 39751753, "comment_id": 66828622, "body": "@JohnDowling Yes, of course you can do that, I broke it to multiple lines to show the steps and make it easier to understand."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1475076443, "creation_date": 1475076443, "answer_id": 39751753, "question_id": 39751508, "link": "https://stackoverflow.com/questions/39751508/reflect-return-values/39751753#39751753", "title": "Reflect return values", "body": "<p><a href=\"https://golang.org/pkg/reflect/#Value.Call\" rel=\"noreferrer\"><code>Value.Call()</code></a> calls the function represented by the value, and returns a <em>slice</em> which represents the return values of the function (it must be a slice as in Go functions and methods may have multiple return values). The returned slice is of type <code>[]reflect.Value</code> (so its elements are of type <code>reflect.Value</code> and not <code>interface{}</code>).</p>\n\n<p>If your function or method returns an error too, you may examine the corresponding element in the returned slice. You may use <a href=\"https://golang.org/pkg/reflect/#Value.Interface\" rel=\"noreferrer\"><code>Value.Interface()</code></a> to obtain the value as an <code>interface{}</code> from the <code>reflect.Value</code> value.</p>\n\n<p>See this example:</p>\n\n<pre><code>type My int\n\nfunc (m My) Get() error {\n    return nil\n}\n\nfunc (m My) GetError() error {\n    return fmt.Errorf(\"artificial error\")\n}\n</code></pre>\n\n<p>Calling <code>My.Get()</code> never returns an error (it returns <code>nil</code>), and calling <code>My.GetError()</code> always returns a non-<code>nil</code> error.</p>\n\n<p>Calling them with reflection:</p>\n\n<pre><code>methods := []string{\"Get\", \"GetError\"}\nfor _, m := range methods {\n    result := reflect.ValueOf(My(0)).MethodByName(m).Call(nil)\n    err := result[0].Interface()\n    if err == nil {\n        fmt.Println(\"No error returned by\", m)\n    } else {\n        fmt.Printf(\"Error calling %s: %v\", m, err)\n    }\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/6I8tSEcQtV\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>No error returned by Get\nError calling GetError: artificial error\n</code></pre>\n"}], "owner": {"reputation": 436, "user_id": 1638158, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NlmL8.jpg?s=128&g=1", "display_name": "John Dowling", "link": "https://stackoverflow.com/users/1638158/john-dowling"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3663, "favorite_count": 0, "accepted_answer_id": 39751753, "answer_count": 1, "score": 2, "last_activity_date": 1545743821, "creation_date": 1475075805, "last_edit_date": 1545743821, "question_id": 39751508, "link": "https://stackoverflow.com/questions/39751508/reflect-return-values", "title": "Reflect return values", "body": "<p>I am having a few issues with return values on a call, I have the below</p>\n\n<pre><code>err := reflect.ValueOf(a.a).MethodByName(gatherList[x]).Call([]reflect.Value{})\n</code></pre>\n\n<p>The issue is with the return value which is nil </p>\n\n<p>I can't do the usual error check as I get the following.</p>\n\n<pre><code>cannot convert nil to type reflect.Value\n</code></pre>\n\n<p>when I try to print the contents of err i get;</p>\n\n<pre><code>[&lt;error Value&gt;]\n</code></pre>\n\n<p>not really sure how to move forward with this error check, any help would be great. </p>\n"}, {"tags": ["arrays", "algorithm", "go", "hashmap", "range"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 5, "creation_date": 1475068345, "post_id": 39748476, "comment_id": 66793212, "body": "If the classes are <i>disjunct</i> and <i>cover</i> the whole range then a range can be identified by its start (the and if the range is the start of the next range - 1). Just put the ranges into a sorted slice. Lookup is log n."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1475072221, "last_edit_date": 1492087233, "creation_date": 1475068965, "answer_id": 39748833, "question_id": 39748476, "link": "https://stackoverflow.com/questions/39748476/lookup-in-a-map-of-integer-ranges-in-golang/39748833#39748833", "title": "Lookup in a map of Integer ranges in Golang", "body": "<p>If ranges are <em>disjunct</em> (that is a concrete number can only belong to one range), you can find a range using a binary search. This is <code>O(log(n))</code> complexity.</p>\n\n<p>If ranges are <em>contiguous</em>, it is also enough to \"model\" a range using only one number, either with its start or its end. This also applies in your case.</p>\n\n<p>We can list the range boundaries in an <code>int</code> slice in ascendent order, and we can perform a binary search in this sorted slice. We  model ranges with their maximum value since the sequence of ranges is without any holes. This will give us the index of the range. We can store the names in a separate slice, and return the  name at the index we just found as the result of binary search.</p>\n\n<p><em>Here's the surprisingly short implementation, a <strong>one-line function</strong>:</em></p>\n\n<pre><code>var ranges = []int{-1, 4, 8, 18, 21, 22}\nvar names = []string{\"\", \"dog\", \"cat\", \"bird\", \"dog\", \"bird\", \"\"}\n\nfunc getName(n int) string {\n    return names[sort.SearchInts(ranges, n)]\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>nums := []int{-1, 3, 6, 10, 20, 22, 100}\nfor _, n := range nums {\n    if name := getName(n); name == \"\" {\n        fmt.Printf(\"Invalid number: %4d\\n\", n)\n    } else {\n        fmt.Printf(\"Number        : %4d, Name: %s\\n\", n, name)\n    }\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/K0BNzVcFYu\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Invalid number:   -1\nNumber        :    3, Name: dog\nNumber        :    6, Name: cat\nNumber        :   10, Name: bird\nNumber        :   20, Name: dog\nNumber        :   22, Name: bird\nInvalid number:  100\n</code></pre>\n\n<p>Note: this solution is also used in a similar question on the <a href=\"https://codereview.stackexchange.com/\">Code Review</a> StackExchange site: <a href=\"https://codereview.stackexchange.com/questions/100690/classifying-by-age\">Classifying by age</a></p>\n\n<h3>Handling non-contiguous ranges</h3>\n\n<p>If ranges would not cover every number (meaning there are \"holes\" between ranges), then you may easily handle that by adding the holes as \"virtual\" ranges, and give them the empty string <code>\"\"</code> name (which we used for invalid ranges). That's all.</p>\n\n<p>For example, let's modify your original problem to this:</p>\n\n<pre><code>0-4: dog,\n5-8: cat,\n9-15: bird,\n19-21: dog,\n22-22: bird,\n</code></pre>\n\n<p>As you can see, there is a \"hole\" between <code>9-15: bird</code> and <code>19-21:dog</code>. The range <code>16-17</code> is invalid. Here's how you can map this:</p>\n\n<pre><code>var ranges = []int{-1, 4, 8, 15, 18, 21, 22}\nvar names = []string{\"\", \"dog\", \"cat\", \"bird\", \"\", \"dog\", \"bird\", \"\"}\n</code></pre>\n\n<p>There is an empty <code>\"\"</code> name for the range between <code>15</code> and <code>18</code>. Testing it:</p>\n\n<pre><code>nums := []int{15, 16, 19}\nfor _, n := range nums {\n    if name := getName(n); name == \"\" {\n        fmt.Printf(\"Invalid number: %4d\\n\", n)\n    } else {\n        fmt.Printf(\"Number        : %4d, Name: %s\\n\", n, name)\n    }\n}\n</code></pre>\n\n<p>Output (try this variant on the <a href=\"https://play.golang.org/p/Ucfdy3PvL1\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Number        :   15, Name: bird\nInvalid number:   16\nNumber        :   19, Name: dog\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 4, "last_activity_date": 1475072792, "creation_date": 1475072792, "answer_id": 39750394, "question_id": 39748476, "link": "https://stackoverflow.com/questions/39748476/lookup-in-a-map-of-integer-ranges-in-golang/39750394#39750394", "title": "Lookup in a map of Integer ranges in Golang", "body": "<p>A slightly different approach that implements the <a href=\"https://golang.org/pkg/sort/#Interface\" rel=\"nofollow\"><code>sort.Interface</code></a> rather than using 2 slices and handles non-contiguous ranges:</p>\n\n<pre><code>type Range struct {\n    Min, Max int\n    Value    string\n}\ntype Ranges []Range\n\nfunc (r Ranges) Len() int           { return len(r) }\nfunc (r Ranges) Less(i, j int) bool { return r[i].Min &lt; r[j].Min }\nfunc (r Ranges) Swap(i, j int)      { r[i], r[j] = r[j], r[i] }\nfunc (r Ranges) Sort()              { sort.Sort(r) }\nfunc (r Ranges) Search(v int) string {\n    ln := r.Len()\n    if i := sort.Search(ln, func(i int) bool { return v &lt;= r[i].Max }); i &lt; ln {\n        if it := &amp;r[i]; v &gt;= it.Min &amp;&amp; v &lt;= it.Max {\n            return it.Value\n        }\n    }\n    return \"\"\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/5DNqKkNPuA\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 1738, "user_id": 1565438, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/318853d66f7493ae314e9be936cd0189?s=128&d=identicon&r=PG", "display_name": "mazieres", "link": "https://stackoverflow.com/users/1565438/mazieres"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1258, "favorite_count": 2, "accepted_answer_id": 39748833, "answer_count": 2, "score": 6, "last_activity_date": 1475072792, "creation_date": 1475068058, "question_id": 39748476, "link": "https://stackoverflow.com/questions/39748476/lookup-in-a-map-of-integer-ranges-in-golang", "title": "Lookup in a map of Integer ranges in Golang", "body": "<p>The problem I want to resolve can be expressed this way: I want to lookup an Integer in a hashmap of integer ranges.</p>\n\n<pre><code>0-4: dog,\n5-8: cat,\n9-18: bird,\n19-21: dog,\n22-22: bird,\n...\n</code></pre>\n\n<p>Where:</p>\n\n<pre><code>lookup(3) -&gt; dog\nlookup(10) -&gt; bird\n</code></pre>\n\n<p>However, thinking of this problem as a hashmap is probably not the right way to go.\nI'm working with ~ 140,000 ranges, which belong to one of ~ 200 possible classes.</p>\n\n<p>Any idea of how to do this in Golang ? Or which track to follow to reach a reasonable solution (~O(log(n) ?) ? A way to describe this problem more generically ?</p>\n\n<p>Thanks for your help !</p>\n"}, {"tags": ["windows", "go", "notifications"], "comments": [{"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 1, "creation_date": 1475066222, "post_id": 39747426, "comment_id": 66791583, "body": "What are &quot;system notifications&quot; ? write events in a journal ?"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1475066288, "post_id": 39747426, "comment_id": 66791628, "body": "small info popups from OS notification tray, i think growl does that for mac"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 3, "creation_date": 1475066403, "post_id": 39747426, "comment_id": 66791717, "body": "<a href=\"https://github.com/go-toast/toast\" rel=\"nofollow noreferrer\">github.com/go-toast/toast</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "is_accepted": false, "score": 5, "last_activity_date": 1475076732, "creation_date": 1475076732, "answer_id": 39751869, "question_id": 39747426, "link": "https://stackoverflow.com/questions/39747426/how-to-send-system-notifications-for-windows-in-golang/39751869#39751869", "title": "How to send system notifications for windows in golang", "body": "<p>I'm assuming you are looking for desktop notifications.  There are a few different libraries that can do this for you.  <strong>Originally I found this with a simple Google search</strong></p>\n\n<p>Link / Dependency URL:  <a href=\"https://github.com/0xAX/notificator\" rel=\"noreferrer\">github.com/0xAX/notificator</a></p>\n\n<p>Here is the example on their README.md page:</p>\n\n<pre><code>package main\n\nimport (\n  \"github.com/0xAX/notificator\"\n)\n\nvar notify *notificator.Notificator\n\nfunc main() {\n\n  notify = notificator.New(notificator.Options{\n    DefaultIcon: \"icon/default.png\",\n    AppName:     \"My test App\",\n  })\n\n  notify.Push(\"title\", \"text\", \"/home/user/icon.png\", notificator.UR_CRITICAL)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 3168, "user_id": 5558126, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/222b3385ea809d92778c8d79a0498115?s=128&d=identicon&r=PG&f=1", "display_name": "Pim verleg", "link": "https://stackoverflow.com/users/5558126/pim-verleg"}, "edited": false, "score": 1, "creation_date": 1591171080, "post_id": 62167776, "comment_id": 109950165, "body": "Thank you :-) i love beep sounds :-)"}, {"owner": {"reputation": 1193, "user_id": 3168185, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iWFTu.jpg?s=128&g=1", "display_name": "Bayu", "link": "https://stackoverflow.com/users/3168185/bayu"}, "reply_to_user": {"reputation": 3168, "user_id": 5558126, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/222b3385ea809d92778c8d79a0498115?s=128&d=identicon&r=PG&f=1", "display_name": "Pim verleg", "link": "https://stackoverflow.com/users/5558126/pim-verleg"}, "edited": false, "score": 1, "creation_date": 1591172231, "post_id": 62167776, "comment_id": 109950690, "body": "Great to know :)"}], "tags": [], "owner": {"reputation": 1193, "user_id": 3168185, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iWFTu.jpg?s=128&g=1", "display_name": "Bayu", "link": "https://stackoverflow.com/users/3168185/bayu"}, "is_accepted": true, "score": 3, "last_activity_date": 1591170600, "creation_date": 1591170600, "answer_id": 62167776, "question_id": 39747426, "link": "https://stackoverflow.com/questions/39747426/how-to-send-system-notifications-for-windows-in-golang/62167776#62167776", "title": "How to send system notifications for windows in golang", "body": "<p>Finding system notification with Golang in 2020 and found this: <a href=\"https://github.com/gen2brain/beeep\" rel=\"nofollow noreferrer\">https://github.com/gen2brain/beeep</a> . It looks like currently still actively maintained.</p>\n\n<p>Example from repo:</p>\n\n<pre><code>err := beeep.Notify(\"Title\", \"Message body\", \"assets/information.png\")\nif err != nil {\n    panic(err)\n}\n</code></pre>\n\n<p>Even it works great, actually I feel that this app was made mainly for producing \"beep\" sound on the computer speaker. Based on the app name which is \"beeep\" :). You can check on example page if interest in makes those \"beep\" sound too.</p>\n"}], "owner": {"reputation": 3168, "user_id": 5558126, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/222b3385ea809d92778c8d79a0498115?s=128&d=identicon&r=PG&f=1", "display_name": "Pim verleg", "link": "https://stackoverflow.com/users/5558126/pim-verleg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3059, "favorite_count": 0, "accepted_answer_id": 62167776, "answer_count": 2, "score": 6, "last_activity_date": 1591170600, "creation_date": 1475065434, "question_id": 39747426, "link": "https://stackoverflow.com/questions/39747426/how-to-send-system-notifications-for-windows-in-golang", "title": "How to send system notifications for windows in golang", "body": "<p>I want to send a system notifications to windows using golang.</p>\n\n<p>How can this be done?\nif you awnser contains a cross platform solution it would be even better.</p>\n"}, {"tags": ["mongodb", "go", "aggregation-framework", "mgo", "mongodb-aggregation"], "answers": [{"tags": [], "owner": {"reputation": 87200, "user_id": 122005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/MX2CF.jpg?s=128&g=1", "display_name": "chridam", "link": "https://stackoverflow.com/users/122005/chridam"}, "is_accepted": false, "score": 0, "last_activity_date": 1475067996, "creation_date": 1475067996, "answer_id": 39748453, "question_id": 39747073, "link": "https://stackoverflow.com/questions/39747073/can-i-aggregate-two-mongodb-queries-in-one-query-using-golang-mgo/39748453#39748453", "title": "Can i aggregate two mongodb queries in one query using golang (mgo)?", "body": "<p>Yes, you would need to run an aggregation pipeline of the form:</p>\n\n<pre><code>var pipeline = [    \n    {\n        \"$group\": {\n            \"_id\": \"$groupId\",\n            \"entries\": {\n                \"$push\": {\n                    \"name\": \"$name\",\n                    \"value\": \"$value\"\n                }\n            }\n        }\n    },\n    {\n        \"$match\": {\n            \"entries.name\" : \"phoneNumber\", \n            \"entries.value\" : \"000000000\"\n        }\n    },\n    {\n        \"$project\": {\n            \"item\": {\n                \"$arrayElemAt\": [\n                    {\n                        \"$filter\": {\n                            \"input\": \"$entries\",\n                            \"as\": \"item\",\n                            \"cond\": { \"$eq\": [ \"$$item.name\", \"email\" ] }\n                        }\n                    }, 0\n                ]\n            }\n        }\n    },\n    {\n        \"$project\": {\n            \"_id\": 0,\n            \"email\": \"$item.value\"\n        }\n    }\n\n]);\ndb.collection.aggregate(pipeline);\n</code></pre>\n\n<p><strong>Sample Output</strong></p>\n\n<pre><code>{ \"email\" : \"11@11.com\" }\n</code></pre>\n\n<p>of which the equivalent mGo expression follows (untested):</p>\n\n<pre><code>pipeline := []bson.D{   \n    bson.M{\n        \"$group\": bson.M{\n            \"_id\": \"$groupId\",\n            \"entries\": bson.M{\n                \"$push\": bson.M{\n                    \"name\": \"$name\",\n                    \"value\": \"$value\"\n                }\n            }\n        }\n    },\n    bson.M{\n        \"$match\": bson.M{\n            \"entries.name\" : \"phoneNumber\", \n            \"entries.value\" : \"000000000\"\n        }\n    },\n    bson.M{\n        \"$project\": bson.M{\n            \"item\": bson.M{\n                \"$arrayElemAt\": [\n                    bson.M{\n                        \"$filter\": bson.M{\n                            \"input\": \"$entries\",\n                            \"as\": \"item\",\n                            \"cond\": bson.M{ \"$eq\": \n                                []interface{}{  \"$$item.name\", \"email\" }    \n                            }\n                        }\n                    }, 0\n                ]\n            }\n        }\n    },\n    bson.M{\n        \"$project\": bson.M{\n            \"_id\": 0,\n            \"email\": \"$item.value\"\n        }\n    }\n}\n\npipe := collection.Pipe(pipeline)\niter := pipe.Iter()\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6893506, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5740beb304cfcd4d2deeadbcc515b49c?s=128&d=identicon&r=PG&f=1", "display_name": " I. Len", "link": "https://stackoverflow.com/users/6893506/i-len"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1202, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475068228, "creation_date": 1475064554, "last_edit_date": 1475068228, "question_id": 39747073, "link": "https://stackoverflow.com/questions/39747073/can-i-aggregate-two-mongodb-queries-in-one-query-using-golang-mgo", "title": "Can i aggregate two mongodb queries in one query using golang (mgo)?", "body": "<p>I use <code>golang</code> and <code>mgo</code>, <code>mongodb version is 3.2.9</code></p>\n\n<blockquote>\n  <p>For example i have two documents in one collection:</p>\n</blockquote>\n\n<pre><code>{\"groupId\" : 4, \"name\" : \"email\", \"value\" : \"11@11.com\"}\n\n{\"groupId\" : 4,\"name\" : \"phoneNumber\",\"value\" : \"000000000\"}\n</code></pre>\n\n<p>I know <code>phoneNumber (value and name)</code> and I need to find email (value).\nIt can be simple done in two queries: first by phoneNumber I found groupId and then by groupId i found email.\nIs it possible to do it in one query (using golang and mgo)?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5796, "user_id": 328730, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/6f9395f6a8e5bf4970661b80194105b0?s=128&d=identicon&r=PG", "display_name": "Dr Rob Lang", "link": "https://stackoverflow.com/users/328730/dr-rob-lang"}, "edited": false, "score": 0, "creation_date": 1475064581, "post_id": 39746739, "comment_id": 66790361, "body": "Please title your question with the question you wish to ask and explain a little more about what you are trying to achieve."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475066835, "post_id": 39746739, "comment_id": 66792052, "body": "This is all very dependent on the compiler implementation you&#39;re using. You didn&#39;t mention the compiler or version, but the standard gc compiler is continuously evolving, and may or may not produce the same output in future versions."}], "answers": [{"tags": [], "owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "is_accepted": false, "score": 1, "last_activity_date": 1475067549, "last_edit_date": 1475067549, "creation_date": 1475066101, "answer_id": 39747705, "question_id": 39746739, "link": "https://stackoverflow.com/questions/39746739/golang-assemble-for-memory-allocation/39747705#39747705", "title": "golang assemble for memory allocation", "body": "<p>I think it's the variable nature of your <code>cap</code> variable - if you change this to <code>const cap = 1024</code> the <code>runtime.makeslice</code> call disappears. It seems the Go compiler* is currently unable to infer that <code>cap</code> doesn't mutate, i.e. not change in value. As you state; in the last example <code>a</code> is evaluated to 1000 at compile time.</p>\n\n<p><em>* go version go1.7.1 linux/amd64</em></p>\n"}], "owner": {"reputation": 11, "user_id": 6893538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1ca5109e160fca1dc66b86c7fca9c15?s=128&d=identicon&r=PG&f=1", "display_name": "\u5218\u6842\u7965", "link": "https://stackoverflow.com/users/6893538/%e5%88%98%e6%a1%82%e7%a5%a5"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 110, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1475067549, "creation_date": 1475063716, "question_id": 39746739, "link": "https://stackoverflow.com/questions/39746739/golang-assemble-for-memory-allocation", "title": "golang assemble for memory allocation", "body": "<pre><code>//  example1.go\n\npackge main\n\nfunc main() {\n    s := make([]byte, 1024, 1024)\n   _ = s\n}\n</code></pre>\n\n<p>s will be allocated in stack and lookup assemble code  not call runtime.makeslice</p>\n\n<pre><code>// example2.go\npackge main\n\nfunc main() {\n    cap := 1024\n    s := make([]byte, 1024, cap)\n    _ = s\n}\n</code></pre>\n\n<p>s will be allocated in heap and lookup assemble code there is runtime.makeslice   why this ???</p>\n\n<pre><code>// example3.go\npackage main\n\nfunc main() {\n    a := 100\n    if a&gt;1 {\n        a = 1000\n    }\n    b := interface{}(a)\n    _ = b\n}\n</code></pre>\n\n<p>lookup the assemble code and see the compiler is very clever to opt that but in example2.go why don't do this </p>\n"}, {"tags": ["go", "tcp", "packet-capture"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 1, "creation_date": 1475064174, "post_id": 39743021, "comment_id": 66790066, "body": "You should update your question, if you have more infos, not adding comments."}], "owner": {"reputation": 21, "user_id": 4235299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/645e8703c83827bbb9c8051d569eee6c?s=128&d=identicon&r=PG&f=1", "display_name": "bkhan", "link": "https://stackoverflow.com/users/4235299/bkhan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 324, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1475092858, "creation_date": 1475054209, "last_edit_date": 1475092858, "question_id": 39743021, "link": "https://stackoverflow.com/questions/39743021/go-tcp-assembly-missing-packets-for-large-dataset", "title": "go tcp assembly missing packets for large dataset?", "body": "<p>I am trying to use use the tcp assembly package to start reassembling TCP streams. I have looked at two examples </p>\n\n<p><a href=\"https://github.com/google/gopacket/tree/master/examples/httpassembly\" rel=\"nofollow\">https://github.com/google/gopacket/tree/master/examples/httpassembly</a>\nand\n<a href=\"https://github.com/google/gopacket/tree/master/examples/statsassembly\" rel=\"nofollow\">https://github.com/google/gopacket/tree/master/examples/statsassembly</a> </p>\n\n<p>These example work fine if I am sending small data chunks. If I send bigger data, for example 5MB file from source to destination, the golang TCP assembly seems to loose data.</p>\n\n<p>When I use tcpdump with tcpflow I can reconstruct the data I sent but the golang examples miss big chunks of data during reassembly and I cannot reproduce the data that I sent.</p>\n\n<p>For example when I transfer file using netcat from source to destination I am not able to reproduce the file when I assemble the data using golang TCP assembly.</p>\n\n<p>I made very minor modification to the code in   <a href=\"https://github.com/google/gopacket/tree/master/examples/statsassembly\" rel=\"nofollow\">https://github.com/google/gopacket/tree/master/examples/statsassembly</a>.</p>\n\n<p>added \n<code>payload  []byte</code> to statsStream struct.</p>\n\n<p>and then \n<code>s.payload = append(s.payload, reassembly.Bytes...)</code>\njust before </p>\n\n<p><code>s.bytes += int64(len(reassembly.Bytes))</code>.</p>\n\n<p>When I print the data in <em>ReassemblyComplete</em> it only have a portion of the data and does not contain the rest of the data.</p>\n\n<p>I have changed snaplength as well</p>\n\n<p><code>var snaplen = flag.Int(\"s\", 65536, \"SnapLen for pcap packet capture\")</code></p>\n\n<p>When I use tc command to slow down traffic, then the application works just fine. That's strange. Is there a limit to the speed at which go library can capture packets? Tcpdump seems to capture all the traffic just fine.</p>\n"}, {"tags": ["amazon-web-services", "go"], "answers": [{"tags": [], "owner": {"reputation": 1684, "user_id": 617186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddbdde4cc6f7ceb70869e8ad4916565e?s=128&d=identicon&r=PG", "display_name": "at0mzk", "link": "https://stackoverflow.com/users/617186/at0mzk"}, "is_accepted": true, "score": 2, "last_activity_date": 1475049338, "creation_date": 1475049338, "answer_id": 39741327, "question_id": 39741159, "link": "https://stackoverflow.com/questions/39741159/how-to-set-localhost-as-endpoint-of-a-topic-subscription-amazon-sns-service/39741327#39741327", "title": "How to set localhost as endpoint of a topic subscription - Amazon sns service", "body": "<p>I guess you mean an HTTP/S endpoint? SNS is run by Amazon, so localhost points to their server. You will need to make your endpoint accessible from the internet. Please see Step 1 here: <a href=\"http://docs.aws.amazon.com/sns/latest/dg/SendMessageToHttp.html#SendMessageToHttp.subscribe\" rel=\"nofollow\">http://docs.aws.amazon.com/sns/latest/dg/SendMessageToHttp.html#SendMessageToHttp.subscribe</a></p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5389646, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9bb36de2a327b01d653c1362df39a5c4?s=128&d=identicon&r=PG&f=1", "display_name": "Sandy", "link": "https://stackoverflow.com/users/5389646/sandy"}, "is_accepted": false, "score": 2, "last_activity_date": 1587221307, "last_edit_date": 1587221307, "creation_date": 1587220908, "answer_id": 61290973, "question_id": 39741159, "link": "https://stackoverflow.com/questions/39741159/how-to-set-localhost-as-endpoint-of-a-topic-subscription-amazon-sns-service/61290973#61290973", "title": "How to set localhost as endpoint of a topic subscription - Amazon sns service", "body": "<p>Now, this is really an old post. But I tried something similar recently using the ngrok service. <a href=\"https://ngrok.com/\" rel=\"nofollow noreferrer\">https://ngrok.com/</a> </p>\n\n<p>This service assigns a temporary endpoint to your localhost and this endpoint is completely resolvable from the public internet. </p>\n\n<p>For example if you are running an HTTP server at point 8080, you can start the ngrok with the command \"ngrok HTTP 8080\" (of course this requires that ngrok desktop binary is download and set in the path variable). But once you start this command, every traffic which is coming to the temporary ngrok endpoint is redirected to your local service.</p>\n\n<p>Something like this:</p>\n\n<p><a href=\"http://c5fdddc8.ngrok.io\" rel=\"nofollow noreferrer\">http://c5fdddc8.ngrok.io</a> -> <a href=\"http://localhost:8080\" rel=\"nofollow noreferrer\">http://localhost:8080</a></p>\n\n<p>You can subscribe to the ngrok endpoint in the AWS sns topic and it will redirect the HTTP request to the service running in your localhost.</p>\n"}], "owner": {"reputation": 173, "user_id": 6856556, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/znty0.jpg?s=128&g=1", "display_name": "Moss", "link": "https://stackoverflow.com/users/6856556/moss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3548, "favorite_count": 1, "accepted_answer_id": 39741327, "answer_count": 2, "score": 2, "last_activity_date": 1587221307, "creation_date": 1475048845, "last_edit_date": 1475054001, "question_id": 39741159, "link": "https://stackoverflow.com/questions/39741159/how-to-set-localhost-as-endpoint-of-a-topic-subscription-amazon-sns-service", "title": "How to set localhost as endpoint of a topic subscription - Amazon sns service", "body": "<p>I need to implement amazon sns service in my localhost to test an Go Application but when i tried to set my localhost as Topic subscription's  Endpoint it shows Error:</p>\n\n<pre><code>Not authorized to subscribe internal endpoints (Service: AmazonSNS; Status Code: 403; Error Code: AuthorizationError; Request ID: 14bc8224-4b0d-5b9a-a61c-d24122fdf703)\n</code></pre>\n\n<p>is it Possible?I am new to this</p>\n"}, {"tags": ["pointers", "memory", "go", "struct", "interface"], "comments": [{"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1475045428, "post_id": 39739743, "comment_id": 66777358, "body": "You should use the <code>reflect</code> package in this case. <code>reflect.ValueOf(&amp;ad).Pointer()</code> will return &amp;ad (which is a pointer value) as <code>uintptr</code>."}, {"owner": {"reputation": 41, "user_id": 4780955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-x6VZfsNx5bY/AAAAAAAAAAI/AAAAAAAAQ80/Upuy-T4hutg/photo.jpg?sz=128", "display_name": "Gentry Rolofson", "link": "https://stackoverflow.com/users/4780955/gentry-rolofson"}, "reply_to_user": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1475045815, "post_id": 39739743, "comment_id": 66777579, "body": "Thank you, just looked up reflect am now reading laws of reflection."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4780955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-x6VZfsNx5bY/AAAAAAAAAAI/AAAAAAAAQ80/Upuy-T4hutg/photo.jpg?sz=128", "display_name": "Gentry Rolofson", "link": "https://stackoverflow.com/users/4780955/gentry-rolofson"}, "edited": false, "score": 0, "creation_date": 1475046242, "post_id": 39740087, "comment_id": 66777838, "body": "I made the changes you suggested and they worked exactly as I how I wanted this too thank you, for that concise answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1475046757, "last_edit_date": 1475046757, "creation_date": 1475045796, "answer_id": 39740087, "question_id": 39739743, "link": "https://stackoverflow.com/questions/39739743/golang-interface-func-to-print-memory-address/39740087#39740087", "title": "Golang: interface func to print memory address", "body": "<p>Because in your second case inside the <code>memory()</code> method:</p>\n\n<pre><code>func (ad address) memory() {\n    fmt.Println(\"a - \", ad)\n    fmt.Println(\"a's memory address --&gt; \", &amp;ad)\n}\n</code></pre>\n\n<p><code>ad</code> is not an <code>int</code> but a struct, <code>ad</code> is of type <code>address</code>. And you're not printing the address of an <code>int</code> but an address of a <code>struct</code>. And the default formatting for pointer to a struct is: <code>&amp;{}</code>.</p>\n\n<p>Quoting from package doc of <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow\"><code>fmt</code></a> regarding default formats:</p>\n\n<blockquote>\n<pre><code>struct:             {field0 field1 ...}\narray, slice:       [elem0 elem1 ...]\nmaps:               map[key1:value1 key2:value2]\npointer to above:   &amp;{}, &amp;[], &amp;map[]\n</code></pre>\n</blockquote>\n\n<p>If you modify the line to print the address of the <code>address.a</code> field which is of type <code>int</code>:</p>\n\n<pre><code>fmt.Println(\"a's memory address --&gt; \", &amp;ad.a)\n</code></pre>\n\n<p>You will see the same pointer format printed in hexadecimal format, e.g.:</p>\n\n<pre><code>a's memory address --&gt;  0x1040e13c\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4780955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-x6VZfsNx5bY/AAAAAAAAAAI/AAAAAAAAQ80/Upuy-T4hutg/photo.jpg?sz=128", "display_name": "Gentry Rolofson", "link": "https://stackoverflow.com/users/4780955/gentry-rolofson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1407, "favorite_count": 1, "accepted_answer_id": 39740087, "answer_count": 1, "score": 1, "last_activity_date": 1475048166, "creation_date": 1475044655, "last_edit_date": 1475048166, "question_id": 39739743, "link": "https://stackoverflow.com/questions/39739743/golang-interface-func-to-print-memory-address", "title": "Golang: interface func to print memory address", "body": "<p>I am curious as to why just printing the memory address on a var directly works but trying to do the same action through an interface doesn't print out the memory address?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype address struct {\n    a int\n}\n\ntype this interface {\n    memory()\n}\n\nfunc (ad address) memory() {\n    fmt.Println(\"a - \", ad)\n    fmt.Println(\"a's memory address --&gt; \", &amp;ad)\n}\n\nfunc main() {\n    ad := 43\n    fmt.Println(\"a - \", ad)\n    fmt.Println(\"a's memory address --&gt; \", &amp;ad)\n\n    //code init in here\n    thisAddress := address{\n        a: 42,\n    }\n    // not sure why this doesnt return memory address as well?\n    var i this\n    i = thisAddress\n    i.memory()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Ko8sEVfehv\" rel=\"nofollow\">https://play.golang.org/p/Ko8sEVfehv</a></p>\n\n<p>Just wanted to add this after fixing errors, it now functions as expected.\nTesting shifting memory pointers</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype address struct {\n  a int\n}\n\ntype this interface {\n  memory() *int\n}\n\nfunc (ad address) memory() *int {\n\n  /*reflect.ValueOf(&amp;ad).Pointer() research laws of reflection */\n  var b = &amp;ad.a\n\n  return b\n}\n\nfunc main() {\n\n\n\n  thisAddress := address{\n      a: 42,\n  }\n  thatAddress := address{\n      a: 43,\n  }\n\n  var i this\n  i = thisAddress\n  a := i.memory()\n\n  fmt.Println(\"I am retruned\", a)\n  fmt.Println(\"I am retruned\", *a)\n  i = thatAddress\n  c := i.memory()\n  fmt.Println(\"I am retruned\", c)\n  fmt.Println(\"I am retruned\", *c)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/BnB14-yX8B\" rel=\"nofollow\">https://play.golang.org/p/BnB14-yX8B</a></p>\n"}, {"tags": ["go", "sqlx"], "comments": [{"owner": {"reputation": 1894, "user_id": 2269979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22a1e835980e29baccf08a62e7ff71?s=128&d=identicon&r=PG", "display_name": "molivier", "link": "https://stackoverflow.com/users/2269979/molivier"}, "edited": false, "score": 0, "creation_date": 1475053437, "post_id": 39739710, "comment_id": 66782374, "body": "Have a look to: <a href=\"https://github.com/jmoiron/sqlx/blob/master/sqlx_test.go#L470\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx/blob/master/sqlx_test.go#L470</a>"}, {"owner": {"reputation": 1502, "user_id": 1489402, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/89a45ba9244d452a03761a295eb480ea?s=128&d=identicon&r=PG", "display_name": "mattinsalto", "link": "https://stackoverflow.com/users/1489402/mattinsalto"}, "reply_to_user": {"reputation": 1894, "user_id": 2269979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22a1e835980e29baccf08a62e7ff71?s=128&d=identicon&r=PG", "display_name": "molivier", "link": "https://stackoverflow.com/users/2269979/molivier"}, "edited": false, "score": 0, "creation_date": 1475069077, "post_id": 39739710, "comment_id": 66793795, "body": "Thanks @molivier, I&#39;ve tryed that, but as #mpm says it only works with one to one relationships. It doesn&#39;t populate episodes array."}], "answers": [{"tags": [], "owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "is_accepted": true, "score": 2, "last_activity_date": 1475066137, "creation_date": 1475066137, "answer_id": 39747719, "question_id": 39739710, "link": "https://stackoverflow.com/questions/39739710/sqlx-structscan-join-query/39747719#39747719", "title": "sqlx structscan join query", "body": "<p>It's not going to work since database/sql or sqlx aren't object relational mappers and don't know how to \"populate\" your type <code>[]Episodes</code>. sqlx can assign single struct fields within a parent struct with the \"structName.fieldName\" syntax but that's it. It can't take all your rows, know what is what and assign all <code>Episodes</code> to the correct <code>Patient</code>. You need an ORM for that.</p>\n"}], "owner": {"reputation": 1502, "user_id": 1489402, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/89a45ba9244d452a03761a295eb480ea?s=128&d=identicon&r=PG", "display_name": "mattinsalto", "link": "https://stackoverflow.com/users/1489402/mattinsalto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3467, "favorite_count": 1, "accepted_answer_id": 39747719, "answer_count": 1, "score": 2, "last_activity_date": 1475066137, "creation_date": 1475044567, "question_id": 39739710, "link": "https://stackoverflow.com/questions/39739710/sqlx-structscan-join-query", "title": "sqlx structscan join query", "body": "<p>I'm new to go and sqlx and I would want to know if its posible to strutscan a master -> detail join clause in one query. A patient has many episodes so I want to query all patients and embed an Episode array in each Patient struct</p>\n\n<p>Something like this:</p>\n\n<pre><code>type Episode struct {\n        EpisodeID int    `db:\"episode_id\"`\n        PatientID int    `db:\"patient_id\"`\n        Status    string `db:\"status\"`\n    }\n\n    type Patient struct {\n        PatientID    int            `db:\"patient_id\"`\n        FirstName    string         `db:\"first_name\"`\n        MiddleName   sql.NullString `db:\"middle_name\"`\n        LastName     string         `db:\"last_name\"`\n        Episodes     []Episode\n    }\n\n    query := `SELECT \n    mr_patients.patient_id, \n    mr_patients.first_name, \n    mr_patients.middle_name, \n    mr_patients.last_name, \n    mr_episode_statuses.status, \n    mr_episodes.episode_id, \n    mr_episodes.created_at \n    FROM mr_patients \n    INNER JOIN mr_episodes ON mr_patients.patient_id = mr_episodes.patient_id \n    INNER JOIN mr_episode_statuses ON mr_episodes.status_id = mr_episode_statuses.status_id\n    ORDER BY mr_patients.patient_id, mr_episodes.episode_id`\n\n    rows, err := db.Queryx(query)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    var patients []Patient\n\n    for rows.Next() {\n        var p Patient\n        err = rows.StructScan(&amp;p)\n        if err != nil {\n            log.Fatalln(err)\n        } else {\n            patients = append(patients, p)\n        }\n    }\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "goconvey"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1475062489, "post_id": 39737599, "comment_id": 66788905, "body": "did you try <code>go test .&#47;util</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475058806, "post_id": 39737747, "comment_id": 66786356, "body": "No, the test files should generally have the same package name. You need to test the package as a whole, not individual files."}, {"owner": {"reputation": 6338, "user_id": 641170, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mc98F.jpg?s=128&g=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/641170/rudy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475058997, "post_id": 39737747, "comment_id": 66786486, "body": "actually, not. Refer to the accepted answer of this <a href=\"http://stackoverflow.com/questions/19998250/proper-package-naming-for-testing-in-golang\" title=\"proper package naming for testing in golang\">stackoverflow.com/questions/19998250/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475060180, "post_id": 39737747, "comment_id": 66787330, "body": "I said generally, the separate package pattern is very uncommon, and you haven&#39;t shown anything here to indicate that you require a special case for a separate package. The command you&#39;re running is incorrect, and you should be testing a package as a whole, rather than as individual files."}, {"owner": {"reputation": 6338, "user_id": 641170, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mc98F.jpg?s=128&g=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/641170/rudy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1475060375, "post_id": 39737747, "comment_id": 66787446, "body": "I tested the package as a whole. it still has the same issue. Anyway, the issue is gone after I separate the package. If you think this is a wrong approach, it would be helpful if  you can suggest a way to work around my problem."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475061719, "post_id": 39737747, "comment_id": 66788403, "body": "What you have here isn&#39;t showing the problem, so it&#39;s hard to prescribe an exact solution.. The second error though indicates your package is trying to import itself. Remove the extra import and refer to the identifiers without the package name"}], "tags": [], "owner": {"reputation": 6338, "user_id": 641170, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mc98F.jpg?s=128&g=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/641170/rudy"}, "is_accepted": true, "score": 0, "last_activity_date": 1475059386, "last_edit_date": 1475059386, "creation_date": 1475034780, "answer_id": 39737747, "question_id": 39737599, "link": "https://stackoverflow.com/questions/39737599/golang-not-able-to-test-in-same-package/39737747#39737747", "title": "Golang not able to test in same package", "body": "<p>Just realize it is a silly mistake. The package for the test should be \"util_test\". Putting the test in the separate package ( but still in the same folder) help solve import cycle issue, yet still allow to solve the undefined error.</p>\n"}, {"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 0, "last_activity_date": 1475062046, "creation_date": 1475062046, "answer_id": 39746126, "question_id": 39737599, "link": "https://stackoverflow.com/questions/39737599/golang-not-able-to-test-in-same-package/39746126#39746126", "title": "Golang not able to test in same package", "body": "<p>The way I normally write Go unit tests is to have one (or more) <code>..._test.go</code> files, in the same package as the code being tested, with one <code>Test...</code> function for each broad set of tests to be done.</p>\n\n<pre><code>package util\n\nimport \"testing\n\nfunc TestGenerateUniqueID(t *testing.T) {\n   var uuid1, uuid2 string\n   uuid1, err = GenerateUniqueID(\"test\")\n   if err != nil {\n     t.Errorf(\"Expected no error, got %s\", err) // Maybe Fatalf?\n   }\n   if uuid1 == \"\" {\n     t.Errorf(\"Expected non-empty string, got empty string (uuid1)\")\n   }\n   uuid2, err = GenerateUniqueID(\"test\")\n   if err != nil {\n     t.Errorf(\"Expected no error, got %s\", err) // Maybe Fatalf?\n   }\n   if uuid2 == \"\" {\n     t.Errorf(\"Expected non-empty string, got empty string (uuid2)\")\n   }\n   if uuid1 == uuid2 {\n     t.Errorf(\"Expected uuid1 and uuid2 to be different, both are %s\", uuid1)\n   }\n}\n</code></pre>\n\n<p>One of the reasons I tend towards whitebox testing (where I can do \"blackbox testing\" by carefully not accessing package internals) is that there's usually a whole slew of non-exported code that really should be tested as well. In this specific, small, example, there's no massive argument for one over the other, since all the functionality that can be tested is already exported.</p>\n"}, {"tags": [], "owner": {"reputation": 126, "user_id": 3362530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/56e1fbd572790631b785972e81e2983b?s=128&d=identicon&r=PG", "display_name": "fitek", "link": "https://stackoverflow.com/users/3362530/fitek"}, "is_accepted": false, "score": 0, "last_activity_date": 1618218107, "creation_date": 1618218107, "answer_id": 67055545, "question_id": 39737599, "link": "https://stackoverflow.com/questions/39737599/golang-not-able-to-test-in-same-package/67055545#67055545", "title": "Golang not able to test in same package", "body": "<p>I've run into a similar problem, when I was trying to run a single test file.</p>\n<p>I wanted that, as it was a kind of test driven development thing, where I wanted to run tests only for the code I was working on at the moment, and not all the x-minutes running tests.</p>\n<p>The solution turned out to be not running tests from a file, but rather running a specific test by name (actually a regex). So in your case I guess it would be:</p>\n<pre><code>go test ./util -run TestCommonUtil\n</code></pre>\n<p>An alternative seems to be listing all the files needed to build your test code:</p>\n<pre><code>go test util/commonutil_test.go util/commonutil.go\n</code></pre>\n"}], "owner": {"reputation": 6338, "user_id": 641170, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mc98F.jpg?s=128&g=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/641170/rudy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1996, "favorite_count": 1, "accepted_answer_id": 39737747, "answer_count": 3, "score": -1, "last_activity_date": 1618218107, "creation_date": 1475033721, "last_edit_date": 1475059348, "question_id": 39737599, "link": "https://stackoverflow.com/questions/39737599/golang-not-able-to-test-in-same-package", "title": "Golang not able to test in same package", "body": "<p>Having issue creating unit test of one of my source file ( commonutil.go )</p>\n\n<pre><code>package util\n\nimport \"github.com/nu7hatch/gouuid\"\n\n// GenerateUUID Returns generated UUID sequence\nfunc GenerateUniqueID(hostname string) (string, error) {\n    var result, err = uuid.NewV4()\n    return hostname + \":\" + result.String(), err\n}\n</code></pre>\n\n<p>For the above source, I created the test file \"commonutil_test.go\" ( in the same package )</p>\n\n<pre><code>package util\n\nimport \"testing\" \nfunc TestCommonUtil(t *testing.T) {\nt.Run(\"Test generate UUID\", func(t *testing.T) {\n\n    var uuid, _ = GenerateUniqueID (\"test\")\n    //fmt.Printf(\"UUID isa %v \\n\", uuid)\n    if uuid == \"\" {\n        t.Errorf(\"UUID expected, but result is empty \")\n    }\n})\n</code></pre>\n\n<p>However when trying executing \"go test util/commonutil_test.go\" it shows :</p>\n\n<blockquote>\n  <p>util\\commonutil_test.go:8: undefined: GenerateUniqueID<br>\n    FAIL    command-line-arguments [build failed]       </p>\n</blockquote>\n\n<p>Changing to util.GenerateUniqueID in the test solve the problem, however when running coverage using <strong>Goconvey</strong> will cause build failure  : </p>\n\n<blockquote>\n  <p>can't load package: import cycle not allowed\n  package rudygunawan.com/MyProject/HFLC-Go/util\n      imports rudygunawan.com/MyProject/HFLC-Go/util</p>\n</blockquote>\n\n<p>Any idea to solve this issue? I am confused.</p>\n\n<p>Go version is go1.7.1 windows/386 </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "edited": false, "score": 0, "creation_date": 1475031040, "post_id": 39736631, "comment_id": 66772431, "body": "Thank you for that"}], "tags": [], "owner": {"reputation": 12557, "user_id": 1270789, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/FXwoB.png?s=128&g=1", "display_name": "Ken Y-N", "link": "https://stackoverflow.com/users/1270789/ken-y-n"}, "is_accepted": true, "score": 1, "last_activity_date": 1475036877, "last_edit_date": 1495540896, "creation_date": 1475026072, "answer_id": 39736631, "question_id": 39736530, "link": "https://stackoverflow.com/questions/39736530/golfing-postgres-how-can-i-return-count-number-from-the-query/39736631#39736631", "title": "Golfing postgres how can I return count number from the query", "body": "<p>Looking at <a href=\"https://golang.org/pkg/database/sql/#Rows\" rel=\"nofollow noreferrer\">the documentation</a>, you need to call <code>rows.Next()</code> and check that it succeeds:</p>\n\n<pre><code>if rows.Next() {\n    fmt.Fprintf(w, \"Duplicate Email\")\n}\nelse if rows.Err() {\n    fmt.Fprintf(w, \"Oops, error %s\", rows.Err())\n}\nelse {\n    fmt.Fprintf(w, \"OK, unique email address\")\n}\n</code></pre>\n\n<p>If there is no data, <code>rows.Next()</code> will return <code>nil</code> - <code>rows.Err()</code> should also be called to check for errors.</p>\n\n<p>Please also note <a href=\"https://stackoverflow.com/a/39736696/1270789\">the other answer from BJ Black</a> - the <code>check_duplicate_emails.Exec(email)</code> line is also wrong.</p>\n"}, {"tags": [], "owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "is_accepted": false, "score": 3, "last_activity_date": 1475026684, "creation_date": 1475026684, "answer_id": 39736696, "question_id": 39736530, "link": "https://stackoverflow.com/questions/39736530/golfing-postgres-how-can-i-return-count-number-from-the-query/39736696#39736696", "title": "Golfing postgres how can I return count number from the query", "body": "<p>What's happening here is that you've told Go that your query won't be returning any rows (see <a href=\"https://golang.org/pkg/database/sql/#DB.Exec\" rel=\"nofollow\">docs for Exec()</a>)</p>\n\n<p>You should probably use either:</p>\n\n<ul>\n<li>a combination of <a href=\"https://golang.org/pkg/database/sql/#DB.QueryRow\" rel=\"nofollow\">QueryRow</a> and <a href=\"https://golang.org/pkg/database/sql/#NullFloat64.Scan\" rel=\"nofollow\">Scan()</a> (example in QueryRow is a good one), or</li>\n<li>a \"select somecol from ... where ...\" <strong>without</strong> the count(*) query with <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow\">Query</a> and look at the rows.Next() to see if there was a first row.</li>\n</ul>\n"}], "owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "accepted_answer_id": 39736631, "answer_count": 2, "score": 5, "last_activity_date": 1476400270, "creation_date": 1475025087, "last_edit_date": 1476400270, "question_id": 39736530, "link": "https://stackoverflow.com/questions/39736530/golfing-postgres-how-can-i-return-count-number-from-the-query", "title": "Golfing postgres how can I return count number from the query", "body": "<p>I am very new to Golang and am using the PQ package for postgres. What I am trying to do is prevent duplicate emails, so I have a query that checks to see if a user email is already in the database </p>\n\n<pre><code>check_duplicate_emails, err := db.Prepare(\"select count(*) from profiles where email=$1\")\n    rows, err := check_duplicate_emails.Exec(email)\n\n        if rows != nil {\n        fmt.Fprintf(w,\"Duplicate Email\")\n    } \n</code></pre>\n\n<p>That is my code above how can I make it such that I can check like this</p>\n\n<pre><code>if rows &gt;0 { ...}\n</code></pre>\n\n<p>when I try to do that I get the error</p>\n\n<blockquote>\n  <p>invalid operation: rows > 0 (mismatched types sql.Result and int)</p>\n</blockquote>\n\n<p>How can I solve this issue as I been looking around to resolve it for a bit now.</p>\n"}, {"tags": ["go", "mgo", "go-gin"], "answers": [{"tags": [], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "is_accepted": false, "score": 0, "last_activity_date": 1475033705, "creation_date": 1475033705, "answer_id": 39737595, "question_id": 39736243, "link": "https://stackoverflow.com/questions/39736243/ho-to-bind-to-slice-values-in-go-gin-form/39737595#39737595", "title": "Ho to bind to slice values in go (gin) form?", "body": "<p>The problem was in the model struct. \nI forgot to add <code>form:\"tag\"</code> to the model. So the tag did not bind. </p>\n"}], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1311, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475033705, "creation_date": 1475022346, "last_edit_date": 1475024142, "question_id": 39736243, "link": "https://stackoverflow.com/questions/39736243/ho-to-bind-to-slice-values-in-go-gin-form", "title": "Ho to bind to slice values in go (gin) form?", "body": "<p>Using go and gin-gonic, I'd like to post a simple form containing two tag fields and then save it to mongodb. </p>\n\n<p>Here is the form:</p>\n\n<pre><code>      &lt;form action=\"/quotes/{{ .quote.Id.Hex }}\" method=\"POST\"&gt;    \n          &lt;input type=\"text\" name=\"author\" value=\"{{ .quote.Author }}\"&gt;     \n          &lt;textarea name=\"body\" rows=\"3\"&gt;{{ .quote.Body }}&lt;/textarea&gt;       \n\n          &lt;input name=\"tag\" value=\"\" &gt;    \n          &lt;input name=\"tag\" value=\"\" &gt;      \n\n         &lt;button type=\"submit\"&gt;Submit&lt;/button&gt;\n  &lt;/form&gt;\n</code></pre>\n\n<p>And the handler is:</p>\n\n<pre><code>func Create(c *gin.Context) {\n    db := c.MustGet(\"db\").(*mgo.Database)\n    quote := models.Quote{}\n    err := c.Bind(&amp;quote)\n    if err != nil {\n        c.Error(err)\n        return\n    }\n\n    //To debug\n    fmt.Println(\"form post values\\n\")\n    for t, v := range c.Request.Form[\"tag\"] {\n      fmt.Println(t, v) \n    }\n\n    //To debug\n    fmt.Println(quote)\n\n    err = db.C(models.CollectionQuote).Insert(quote)\n    if err != nil {\n        c.Error(err)\n    }\n    c.Redirect(http.StatusMovedPermanently, \"/quotes\")\n}\n</code></pre>\n\n<p>Now the problem is as for <code>form post values</code> I get:</p>\n\n<pre><code>0 mytag1\n1 mytag2\n</code></pre>\n\n<p>and  <code>quote details</code> yields something like:</p>\n\n<pre><code>{ObjectIdHex(\"\") some-author somebody [] }\n</code></pre>\n\n<p>The quote model is like this:</p>\n\n<pre><code>// Quote model\ntype Quote struct {\n    Id        bson.ObjectId `json:\"_id,omitempty\" bson:\"_id,omitempty\"`\n    Author     string        `json:\"author\" form:\"author\" binding:\"required\" bson:\"author\"`\n    Body      string        `json:\"body\" form:\"body\" binding:\"required\" bson:\"body\"`\n    Tag       []string      `json:\"tag\" bson:\"tag\"`\n\n}\n</code></pre>\n\n<p>So the tag values are received but not binded. \nI'm wondeirng how can I fix this and get the tags from the form? \nI've looked at the gin <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow\">guid</a> but could not find anything about this sort of forms.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1475014678, "post_id": 39735171, "comment_id": 66768231, "body": "How are you going to supply the <code>ftp</code> command with input?"}, {"owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1475015215, "post_id": 39735171, "comment_id": 66768395, "body": "The non interactive part is easy right ? just do  : if len(os.Args) &gt; 1 { \t\tstr = cmd + &quot; &quot; + strings.Join(os.Args[1:], &quot; &quot;) \t} else { \t\tstr = cmd \t}"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475015810, "post_id": 39735171, "comment_id": 66768601, "body": "@Victor: You can&#39;t just concatenate command arguments in a single string unless you&#39;re going to have a shell lex them again. What exactly do you want to do with stdin? Are you supplying a stream, or are you trying connect it to a ptty and emulate user input? Show exactly what you&#39;re trying to do, what you&#39;ve tried, and what you expect to happen."}, {"owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1475017495, "post_id": 39735171, "comment_id": 66769058, "body": "@JimB I have added shell script example, How can I do it in golang ?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1475018826, "post_id": 39735171, "comment_id": 66769438, "body": "I think you&#39;ll have to use additional commands. It&#39;s not like you can keep an interactive prompt running, you issue a command, you read it&#39;s output from stdout, you do whatever logic is necessary in the code to prepare the next command and then run it and continue this process either as a list of statements or in a loop until you have no more commands to run."}, {"owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "edited": false, "score": 0, "creation_date": 1475037892, "post_id": 39735171, "comment_id": 66774135, "body": "Please provide a runnable example via <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">play.golang.org</a>"}], "answers": [{"comments": [{"owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "edited": false, "score": 1, "creation_date": 1475027736, "post_id": 39736519, "comment_id": 66771627, "body": "Worth mentioning that Gexpect has built-in timeout management and an example for ftp specifically at <a href=\"https://github.com/ThomasRooney/gexpect/blob/master/examples/ftp.go\" rel=\"nofollow noreferrer\">github.com/ThomasRooney/gexpect/blob/master/examples/ftp.go</a>"}], "tags": [], "owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "is_accepted": false, "score": 1, "last_activity_date": 1475024993, "creation_date": 1475024993, "answer_id": 39736519, "question_id": 39735171, "link": "https://stackoverflow.com/questions/39735171/how-wrap-a-command-that-is-interactive/39736519#39736519", "title": "How wrap a command that is interactive", "body": "<p>Traditionally these sorts of interactive scripting exercises are best done with expect.  May I suggest checking out a <a href=\"https://github.com/ThomasRooney/gexpect\" rel=\"nofollow\">pure Go equivalent</a>?</p>\n\n<p>From the readme:</p>\n\n<pre><code>child, err := gexpect.Spawn(\"python\")\nif err != nil { panic(err) }\nchild.Expect(\"&gt;&gt;&gt;\")\nchild.SendLine(\"print 'Hello World'\")\nchild.Interact()\nchild.Close()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475033250, "post_id": 39736673, "comment_id": 66772939, "body": "i saw this on redit but if you replace the ls with ftp it doesnt prompt me, it just dies."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475034168, "post_id": 39736673, "comment_id": 66773155, "body": "Oh I see. Check out this stack so that you can set stdin  <a href=\"http://stackoverflow.com/questions/11321437/golang-how-to-execute-command-which-requires-input-from-user\" title=\"golang how to execute command which requires input from user\">stackoverflow.com/questions/11321437/&hellip;</a>"}, {"owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 0, "creation_date": 1475036343, "post_id": 39736673, "comment_id": 66773694, "body": "Seems to work for interactive but doesnt for no interactive like if you compile it and pass in an argument e.g., cmd := exec.Command(&quot;ftp --help&quot;) It doesnt output anything. any idea?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "edited": false, "score": 2, "creation_date": 1475036652, "post_id": 39736673, "comment_id": 66773770, "body": "@Victor see this article I think this will help tons <a href=\"https://nathanleclaire.com/blog/2014/12/29/shelled-out-commands-in-golang/\" rel=\"nofollow noreferrer\">nathanleclaire.com/blog/2014/12/29/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": true, "score": 3, "last_activity_date": 1475026471, "creation_date": 1475026471, "answer_id": 39736673, "question_id": 39735171, "link": "https://stackoverflow.com/questions/39735171/how-wrap-a-command-that-is-interactive/39736673#39736673", "title": "How wrap a command that is interactive", "body": "<p>I would probably do something like this which is more native and doesn't involve an external package</p>\n\n<pre><code>package main\nimport (\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n\n    cmd := exec.Command(\"ls\")\n    // redirect the output to terminal\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n\n    cmd.Run()\n\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 41, "user_id": 12271562, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-GvSdxsPxkTE/AAAAAAAAAAI/AAAAAAAAAB8/DYogEKMsawM/photo.jpg?sz=128", "display_name": "Vidhi Shah", "link": "https://stackoverflow.com/users/12271562/vidhi-shah"}, "is_accepted": false, "score": 0, "last_activity_date": 1571964854, "creation_date": 1571964854, "answer_id": 58550855, "question_id": 39735171, "link": "https://stackoverflow.com/questions/39735171/how-wrap-a-command-that-is-interactive/58550855#58550855", "title": "How wrap a command that is interactive", "body": "<p>To run any commands which will prompt for user input: </p>\n\n<pre><code>cmd := exec.Command(\"cf\", \"login\")\ncmd.Stdout = os.Stdout\ncmd.Stdin = os.Stdin\n\ncmd.Run()\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 489, "user_id": 7069140, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gtrw9.jpg?s=128&g=1", "display_name": "inkychris", "link": "https://stackoverflow.com/users/7069140/inkychris"}, "is_accepted": false, "score": 0, "last_activity_date": 1600422374, "creation_date": 1600422374, "answer_id": 63953332, "question_id": 39735171, "link": "https://stackoverflow.com/questions/39735171/how-wrap-a-command-that-is-interactive/63953332#63953332", "title": "How wrap a command that is interactive", "body": "<p>A command can be &quot;wrapped&quot; using the following complete script, based on <a href=\"https://stackoverflow.com/a/39736673/7069140\">reticentroot's answer</a> and <a href=\"https://stackoverflow.com/a/55055100/7069140\">this answer</a> regarding obtaining exec command return codes (go 1.12+):</p>\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;os&quot;\n    &quot;os/exec&quot;\n)\n\nvar (\n    bin = &quot;py&quot;\n    args = []string{&quot;-3.8&quot;}\n)\n\nfunc main() {\n    cmd := exec.Command(bin, append(args, os.Args[1:]...)...)\n    cmd.Stdout = os.Stdout\n    cmd.Stderr = os.Stderr\n    cmd.Stdin = os.Stdin\n    if err := cmd.Run() ; err != nil {\n        if exitError, ok := err.(*exec.ExitError); ok {\n            os.Exit(exitError.ExitCode())\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 307, "user_id": 5280950, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6e26eaee96d0aa35c5f5afacb6e464d7?s=128&d=identicon&r=PG&f=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/5280950/victor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1509, "favorite_count": 0, "accepted_answer_id": 39736673, "answer_count": 4, "score": 2, "last_activity_date": 1600422374, "creation_date": 1475014511, "last_edit_date": 1475034704, "question_id": 39735171, "link": "https://stackoverflow.com/questions/39735171/how-wrap-a-command-that-is-interactive", "title": "How wrap a command that is interactive", "body": "<p>I am building an ftp wrapper that does some stuff before I spawn, I could easily do it in a shell script but wondering how I could do it in go </p>\n\n<p>While exec.Command works for simple commands.</p>\n\n<pre><code>out, err := exec.Command(\"ls\").Output() // Works\n</code></pre>\n\n<p>How do I wrap commands that are interactive e.g., ftp</p>\n\n<pre><code>out, err := exec.Command(\"ftp\").Output()\n</code></pre>\n\n<p>It just exits. How do I deal with stdin ?</p>\n\n<p>e.g., bash equivalent :</p>\n\n<pre><code>&gt; ./t.sh \nWelcome to myftp \n\nftp&gt; open blahblah.com\n\n&gt; cat t.sh \n#!/bin/bash\necho \"Welcome to myftp \"\n#extra commands such as auth/authoriz.. etc.,\nshift\necho \"$@\"\nftp\n</code></pre>\n\n<p>c++ equivalent :</p>\n\n<pre><code>int main() {\n    system(\"ftp\");\n    return 0;\n}\n</code></pre>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1475014350, "post_id": 39734832, "comment_id": 66768111, "body": "pretty weird. does it work with <code>go test -v github.com&#47;Jana&#47;MyRepo&#47;...</code>?"}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 1, "creation_date": 1475029489, "post_id": 39734832, "comment_id": 66772072, "body": "Can you confirm the same behavior with this simple example? <a href=\"https://gist.github.com/benjic/956cc4b7bd50d4b5f7dc229b73a7b1ae\" rel=\"nofollow noreferrer\">gist.github.com/benjic/956cc4b7bd50d4b5f7dc229b73a7b1ae</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4786, "user_id": 1012149, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/754c40373db2331c02a81ef7654ca0c7?s=128&d=identicon&r=PG", "display_name": "Jana", "link": "https://stackoverflow.com/users/1012149/jana"}, "is_accepted": true, "score": 1, "last_activity_date": 1476323873, "creation_date": 1476323873, "answer_id": 40011058, "question_id": 39734832, "link": "https://stackoverflow.com/questions/39734832/golang-test-gives-inconsistent-results-when-ran-in-verbose-mode/40011058#40011058", "title": "Golang test gives inconsistent results when ran in verbose mode", "body": "<p>This turned out to be a problem with the code I was testing which expects its own arguments and contained this line:</p>\n\n<pre><code>kingpin.MustParse(cli.Parse(os.Args[1:]))\n</code></pre>\n\n<p>I know disallow parsing of arguments in the test. </p>\n"}], "owner": {"reputation": 4786, "user_id": 1012149, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/754c40373db2331c02a81ef7654ca0c7?s=128&d=identicon&r=PG", "display_name": "Jana", "link": "https://stackoverflow.com/users/1012149/jana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 40011058, "answer_count": 1, "score": 1, "last_activity_date": 1476323873, "creation_date": 1475012789, "question_id": 39734832, "link": "https://stackoverflow.com/questions/39734832/golang-test-gives-inconsistent-results-when-ran-in-verbose-mode", "title": "Golang test gives inconsistent results when ran in verbose mode", "body": "<p>I have a single test function in my _test.go file with a bunch of sub tests.\nIt looks like this:</p>\n\n<pre><code>func MyTest(t *testing.T) { \n    t.Run(\"Subtest1\", func(t *testing.T) {\n       ...\n    })\n    t.Run(\"Subtest2\", func(t *testing.T) {\n       ...\n    })\n}\n</code></pre>\n\n<p>I run the test with <code>go test</code> and get</p>\n\n<pre><code>PASS\nok      package_path    9.137s\n</code></pre>\n\n<p>However, I would like to see listed all my subtests in the result. Looking at the <code>Run</code> function in <code>$GOROOT/src/testing/testing.go</code> it looks like I need the test to be <code>chatty</code>.</p>\n\n<p>So I tried to run the test via <code>go test -v</code> but I still do not get the desired output. Instead my test is now failing:</p>\n\n<pre><code>=== RUN   MyTest\napi.test: error: expected argument for flag '-t', try --help\nexit status 1\nFAIL    package_path    0.004s\n</code></pre>\n\n<p><code>--help</code> does not show anything about <code>-t</code></p>\n"}, {"tags": ["testing", "go", "test-coverage"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1475007412, "post_id": 39733494, "comment_id": 66764934, "body": "&quot;not tracked&quot; just means it&#39;s not executable code, so there&#39;s no such thing as &quot;coverage&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 627, "user_id": 2000569, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3fc2a25dae524b3e09735e1a0f1f6a69?s=128&d=identicon&r=PG", "display_name": "fvosberg", "link": "https://stackoverflow.com/users/2000569/fvosberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1475008695, "creation_date": 1475008695, "answer_id": 39733882, "question_id": 39733494, "link": "https://stackoverflow.com/questions/39733494/what-is-the-meaning-of-covered-and-not-tracked-in-go-test-coverage/39733882#39733882", "title": "What is the meaning of covered and not tracked in Go test coverage?", "body": "<p>Thanks, so \"not tracked\" it is not considered in the coverage percentage.</p>\n"}], "owner": {"reputation": 627, "user_id": 2000569, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3fc2a25dae524b3e09735e1a0f1f6a69?s=128&d=identicon&r=PG", "display_name": "fvosberg", "link": "https://stackoverflow.com/users/2000569/fvosberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 604, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1561720596, "creation_date": 1475007145, "last_edit_date": 1561720596, "question_id": 39733494, "link": "https://stackoverflow.com/questions/39733494/what-is-the-meaning-of-covered-and-not-tracked-in-go-test-coverage", "title": "What is the meaning of covered and not tracked in Go test coverage?", "body": "<p>I've started a small Go application to test it out and learn. In the main package I have a <code>main.go</code> with for example a function called <code>NewApp</code>. </p>\n\n<p>In my test file I've called it several times, but in the coverage report its first line is marked as \"not tracked\". This function returns an <code>App struct</code>, but the whole struct definition is marked as \"not tracked\" to. </p>\n\n<p>On the other hand I can't understand the difference between \"not covered\" and \"not tracked\". And is there a way to test the main function? I can't see the advantage of that. </p>\n\n<p>My code is <a href=\"https://github.com/fvosberg/mrsjenkins/tree/d81a3f3d5bc49e06e29a3e4a2bee60b05cbb9cfd\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}, {"tags": ["go", "neo4j"], "comments": [{"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 2, "creation_date": 1475006022, "post_id": 39732802, "comment_id": 66764128, "body": "<a href=\"https://godoc.org/github.com/jmcvetta/neoism#Database.Cypher\" rel=\"nofollow noreferrer\">db.Cypher</a> returns an error. Can you capture that (<code>err := db.Cypher(&amp;cq1)</code>) and update your question with the value of <code>err</code> ?"}], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 6889440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40310f7f6eb14108430dc3bd3ca65e42?s=128&d=identicon&r=PG", "display_name": "Grace", "link": "https://stackoverflow.com/users/6889440/grace"}, "edited": false, "score": 0, "creation_date": 1475437067, "post_id": 39788434, "comment_id": 66932226, "body": "Thank you, Shivendra! I will check this while looking at my code tomorrow at work."}], "tags": [], "owner": {"reputation": 1157, "user_id": 5154802, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-ZqLky3QxN2E/AAAAAAAAAAI/AAAAAAAAAEE/MyYiHfmqVe0/photo.jpg?sz=128", "display_name": "shivendra pratap singh", "link": "https://stackoverflow.com/users/5154802/shivendra-pratap-singh"}, "is_accepted": false, "score": 0, "last_activity_date": 1475228563, "creation_date": 1475228563, "answer_id": 39788434, "question_id": 39732802, "link": "https://stackoverflow.com/questions/39732802/how-do-you-run-a-cypher-query-on-a-neo4j-database-in-go/39788434#39788434", "title": "How do you run a Cypher Query on a Neo4j Database in Go?", "body": "<p>I know what you are facing right now. Some time before I was facing the same issue. \nThere are 2 possible cases are there:-</p>\n\n<p>1) You should always declare struct variable Capital.</p>\n\n<p><code>res1 := []struct {\n        CAPITAL_STR1 string `json:\"path1\"`\n        CAPITAL_STR2 string `json:\"path2\"`\n    }{}\n</code>\nwhich you are doing exactly right A and B.</p>\n\n<p>2) You have to paste exact json type (There is mistake)</p>\n\n<p><code>res1 := []struct {\n        CAPITAL_STR1 string `json:\"path1.distance\"`\n        CAPITAL_STR2 string `json:\"path2.distance\"`\n    }{}\n</code></p>\n\n<p>For getting exact json format check output json response at your Neo4J in browser. It is available under section code.</p>\n"}], "owner": {"reputation": 33, "user_id": 6889440, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/40310f7f6eb14108430dc3bd3ca65e42?s=128&d=identicon&r=PG", "display_name": "Grace", "link": "https://stackoverflow.com/users/6889440/grace"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 539, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1475228563, "creation_date": 1475004421, "question_id": 39732802, "link": "https://stackoverflow.com/questions/39732802/how-do-you-run-a-cypher-query-on-a-neo4j-database-in-go", "title": "How do you run a Cypher Query on a Neo4j Database in Go?", "body": "<p>I've been working on this problem for a few hours, and I haven't had much luck with the community Golang drivers for Neo4j.</p>\n\n<p>I've attempted to run \"movies-go-cq\" and \"neoism\" examples. The <a href=\"https://github.com/neo4j-examples/movies-go-cq\" rel=\"nofollow\">movies-go-cq</a> example doesn't work for me, <a href=\"http://imgur.com/a/OkbwN\" rel=\"nofollow\">it crashes when localhost:8080 is loaded in the browser</a>.</p>\n\n<p>Cypher queries on my Neo4j database with neoism only return empty/blank data. However, when I run the same query in the Neo4j browser at localhost:7474, the expected data is returned.</p>\n\n<p>Here is the Go code I am running with neoism:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/jmcvetta/neoism\"\n)\n\nfunc main() {\n    // Reference: https://godoc.org/github.com/jmcvetta/neoism\n\n    // Connect to the Neo4j server\n    db, _ := neoism.Connect(\"http://localhost:7474/db/data\")\n\n    // Issue a query\n    res1 := []struct {\n        A string `json:\"path1\"` // `json` tag matches column name in query\n        B string `json:\"path2\"`\n    }{}\n    cq1 := neoism.CypherQuery{\n        // Use backticks for long statements - Cypher is whitespace indifferent\n        Statement: `\n        MATCH path1 = shortestPath( (plant:Plant {Term: \"Vaccinium corymbosum\"})-[*..5]-(gene:Gene {Description: \"adenylate cyclase activating polypeptide 1\"}) )\n        MATCH path2 = shortestPath( (gene)-[*..5]-(disease:Medical_Heading {Term: \"Alzheimer Disease\"}) )\n        RETURN path1, path2\n        `,\n        Result: &amp;res1,\n    }\n    db.Cypher(&amp;cq1)\n    r := res1[0]\n    fmt.Println(r.A, r.B)\n}\n</code></pre>\n\n<p>I am considering writing my own API wrapper in Go that uses Neo4j's HTTP RESTful API if I can't get existing Go drivers to work properly; I am new to Golang, and I would be thankful for any advice for debugging Go code or tips for working with Neo4j in Golang. Thank you for your time.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 273, "user_id": 623488, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189cb6d2194386d12ca514b9e7da8983?s=128&d=identicon&r=PG", "display_name": "Merl", "link": "https://stackoverflow.com/users/623488/merl"}, "edited": false, "score": 2, "creation_date": 1475002512, "post_id": 39731846, "comment_id": 66762264, "body": "Thanks @amd.  Your initial answer pointed out the obvious recursion... But using the new string (<code>string(x)</code>) loses the struct reference, so there&#39;s still no way to use the &quot;+&quot; flag...   however, your solution in your playground to use the &quot;#&quot; flag in the String() method uses Go&#39;s &quot;syntax representation&quot;, gives me the labels, and avoids the recursion.  Thanks!"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 7, "last_activity_date": 1475002067, "last_edit_date": 1475002067, "creation_date": 1475000797, "answer_id": 39731846, "question_id": 39731608, "link": "https://stackoverflow.com/questions/39731608/struct-string-implemention-causes-stack-overflow-with-sprintf-flag/39731846#39731846", "title": "struct String() implemention causes stack overflow with Sprintf &quot;+&quot; flag", "body": "<p>See <a href=\"https://golang.org/pkg/fmt/\" rel=\"noreferrer\">Package fmt Docs</a>:</p>\n\n<blockquote>\n  <p>Except when printed using the verbs <code>%T</code> and <code>%p</code>, special formatting\n  considerations apply for operands that implement certain interfaces.\n  In order of application:</p>\n  \n  <ol start=\"5\">\n  <li>If an operand implements method <code>String() string</code>, that method will be invoked to convert the object to a string, which will then be\n  formatted as required by the verb (if any).</li>\n  </ol>\n  \n  <p><strong>To avoid recursion in cases such as</strong></p>\n\n<pre><code>type X string \nfunc (x X) String() string { return Sprintf(\"&lt;%s&gt;\", x) }\n</code></pre>\n  \n  <p>convert the value before recurring:</p>\n\n<pre><code>func (x X) String() string { return Sprintf(\"&lt;%s&gt;\", string(x)) }\n</code></pre>\n  \n  <p>Infinite recursion can also be triggered by self-referential data\n  structures, such as a slice that contains itself as an element, if\n  that type has a String method. Such pathologies are rare, however, and\n  the package does not protect against them.</p>\n</blockquote>\n\n<hr>\n\n<p>Inside:</p>\n\n<pre><code>func (c Color) String() string {\n    // THIS CAUSES STACK OVERFLOW\n    return fmt.Sprint(c)\n}\n</code></pre>\n\n<p>The call to</p>\n\n<pre><code>fmt.Sprint(c)\n</code></pre>\n\n<p>or <code>fmt.Println(c)</code>  which calls <code>func (c Color) String() string</code> again recursively causes overflow: try it on <a href=\"https://play.golang.org/p/UKlhSlzG8T\" rel=\"noreferrer\">The Go Playground</a></p>\n\n<hr>\n\n<p>Also this works fine: <a href=\"https://play.golang.org/p/NYLtrxUeiA\" rel=\"noreferrer\">https://play.golang.org/p/NYLtrxUeiA</a></p>\n"}], "owner": {"reputation": 273, "user_id": 623488, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/189cb6d2194386d12ca514b9e7da8983?s=128&d=identicon&r=PG", "display_name": "Merl", "link": "https://stackoverflow.com/users/623488/merl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 971, "favorite_count": 0, "accepted_answer_id": 39731846, "answer_count": 1, "score": 2, "last_activity_date": 1475002067, "creation_date": 1474999990, "last_edit_date": 1495540389, "question_id": 39731608, "link": "https://stackoverflow.com/questions/39731608/struct-string-implemention-causes-stack-overflow-with-sprintf-flag", "title": "struct String() implemention causes stack overflow with Sprintf &quot;+&quot; flag", "body": "<p>Golang noob question:  Why can I <em>not</em> use the <code>\"%+v\"</code> flag for a struct in the String() implementation method?</p>\n\n<p>I have a struct where I want to implement a <code>String()</code> method for pretty print.  I like the answer given <a href=\"https://stackoverflow.com/a/33252434\">here</a>, but I don't like to type, so I'm trying to modify it to return a string using the <code>\"%+v\"</code> format flag for structs.  from the <a href=\"https://golang.org/pkg/fmt\" rel=\"nofollow noreferrer\">fmt</a> doc:</p>\n\n<blockquote>\n  <p>%v    the value in a default format   when printing structs, the plus flag\n  (%+v) adds field names</p>\n</blockquote>\n\n<p>This works fine if I simply call it with <code>fmt.Printf(\"%+v\", color)</code>, but if I try to put the <code>+</code> flag in the <code>String()</code> implementation, I get a stack overflow (my first chance to ask a \"stack overflow\" question on stackoverflow.com ;) ) </p>\n\n<p>I'm sure I'm not understanding a pointer reference here, or there is some recursion.  I doubt this noob found my first Golang bug, so can someone please explain?</p>\n\n<p>see go play demonstration here <a href=\"https://play.golang.org/p/13_qI8Iwwa\" rel=\"nofollow noreferrer\">https://play.golang.org/p/13_qI8Iwwa</a></p>\n"}, {"tags": ["go", "compiler-errors"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1474989183, "post_id": 39728062, "comment_id": 66754028, "body": "Properly format the code and see if it shows the issue. Otherwise, create a reproducible example and show the complete error message, as this code has too many possible errors to know what is going on."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474993538, "post_id": 39728062, "comment_id": 66757037, "body": "As you could (and really <i>had to)</i> try by yourself <a href=\"https://play.golang.org/p/0n_KSMqs7H\" rel=\"nofollow noreferrer\">there&#39;s nothing wrong with a <code>%</code> character in the condition part of an <code>if</code> statement</a>.  This means your real error is indeed elsewhere.  So I&#39;m indeed with @JimB on this."}], "answers": [{"tags": [], "owner": {"reputation": 2273, "user_id": 6020403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38f0a9f540105e654ef7d03edc36ad3a?s=128&d=identicon&r=PG", "display_name": "BJ Black", "link": "https://stackoverflow.com/users/6020403/bj-black"}, "is_accepted": false, "score": 0, "last_activity_date": 1475053121, "creation_date": 1475053121, "answer_id": 39742598, "question_id": 39728062, "link": "https://stackoverflow.com/questions/39728062/go-error-not-allowed/39742598#39742598", "title": "go error % not allowed", "body": "<p>There are two problems here:</p>\n\n<ul>\n<li>n must be a float because TT must be a float, because that's ultimately a function of two floats.  This conflicts with the n := 0 default int definition at the top.</li>\n<li>the modulus operator on floats is undefined (see <a href=\"https://play.golang.org/p/C64rxczVbd\" rel=\"nofollow\">this playground</a> for what happens when you try).</li>\n</ul>\n\n<p>This means you have a very weird Go implementation or we're not seeing everything.</p>\n\n<p>In any case, either you have to either coerce n to an int (as you do in your second if) or use <a href=\"https://golang.org/pkg/math/#Mod\" rel=\"nofollow\">math.Mod</a> somehow.</p>\n"}], "owner": {"reputation": 11, "user_id": 6888632, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f39e990bc26d6832edfda49761f534e?s=128&d=identicon&r=PG&f=1", "display_name": "AdriP", "link": "https://stackoverflow.com/users/6888632/adrip"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1475053121, "creation_date": 1474988562, "question_id": 39728062, "link": "https://stackoverflow.com/questions/39728062/go-error-not-allowed", "title": "go error % not allowed", "body": "<p>I have written a program for Mumax with a go syntax but I don't understant my error. Here the script where the error appears : </p>\n\n<pre><code>n:=0\n\nDtr0:=5*1e-12\nDtd0 :=300*1e-12\nDtf0:=5*1e-12\nDtz0:=20000*1e-12\ntr0:=Dtr0\ntd0:=Dtd0+tr0\ntf0:=Dtf0+td0\ntz0:=Dtz0+tf0\nTT:=tz0\nn=t/TT\ntr:=tr0+(n*TT)\ntd:=td0+(n*TT)\ntf:=tf0+(n*TT)\ntz:=tz0+(n*TT)\n\nif (n % 2 == 0) {\n        if (n&lt;1 &amp;&amp; t&lt;tr) {\n                a:=(t/tr)\n        } else if (n&gt;=1 &amp;&amp; t&gt;=tz0+((n-1)*TT) &amp;&amp; t&lt;tr) {\n                a:=1/(tr-(tz0+((n-1)*TT)))*(t-(tz0+((n-1)*TT)))\n        } else if (t&gt;=tr &amp;&amp; t&lt;=td) {\n                a:=1\n        } else if (t&gt;td &amp;&amp; t&lt;=tf) {\n                a:=(-1/(tf-td))*(t-td)+1\n        } else if (t&gt;tf &amp;&amp; t&lt;tz) {\n                a:=0\n        }\n}\nif (int(n)%2==1) {\n        if (n&lt;1 &amp;&amp; t&lt;tr) {\n                a:=-(t/tr)\n        } else if (n&gt;=1.0 &amp;&amp; t&gt;=tz0+((n-1)*TT) &amp;&amp; t&lt;tr) {\n                a:=-(1/(tr-(tz0+((n-1)*TT)))*(t-(tz0+((n-1)*TT))))\n        } else if (t&gt;=tr &amp;&amp; t&lt;=td) {\n                a:=-1\n        } else if (t&gt;td &amp;&amp; t&lt;=tf) {\n                a:=-((-1/(tf-td))*(t-td)+1)\n        } else if (t&gt;tf &amp;&amp; t&lt;tz) {\n                a:=0\n        }\n}\n</code></pre>\n\n<p>And the error message is : line 37: if (n % 2 == 0) {: not allowed: %</p>\n\n<p>Thank's a lot</p>\n"}, {"tags": ["go", "github-api"], "comments": [{"owner": {"reputation": 5292, "user_id": 246534, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ukMU2.jpg?s=128&g=1", "display_name": "kfb", "link": "https://stackoverflow.com/users/246534/kfb"}, "edited": false, "score": 0, "creation_date": 1474985395, "post_id": 39725830, "comment_id": 66751179, "body": "<code>repo</code> should be enough to create an issue. I would expect if the scopes were incorrect that you would receive a 404 error as GitHub would hide the repo from view, so I wonder if there&#39;s some other problem with your token?"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 5292, "user_id": 246534, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ukMU2.jpg?s=128&g=1", "display_name": "kfb", "link": "https://stackoverflow.com/users/246534/kfb"}, "edited": false, "score": 0, "creation_date": 1474986148, "post_id": 39725830, "comment_id": 66751752, "body": "I tried two things, give all permissions to the token, it did not work. Then, i tried with a basic auth (user+pwd auth), it worked. No clue."}, {"owner": {"reputation": 5292, "user_id": 246534, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ukMU2.jpg?s=128&g=1", "display_name": "kfb", "link": "https://stackoverflow.com/users/246534/kfb"}, "edited": false, "score": 0, "creation_date": 1474990887, "post_id": 39725830, "comment_id": 66755275, "body": "That&#39;s really strange. As it happens, I just went to look at the issues list in <code>go-github</code>&#39;s repo and found someone with exactly the same problem you describe ;)"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "reply_to_user": {"reputation": 5292, "user_id": 246534, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ukMU2.jpg?s=128&g=1", "display_name": "kfb", "link": "https://stackoverflow.com/users/246534/kfb"}, "edited": false, "score": 1, "creation_date": 1475005563, "post_id": 39725830, "comment_id": 66763901, "body": "yes! btw, shame on me, I let a damn space hanging in my token.... This explained that. To answer the initial question, <code>public_repo</code> is required to create issues!"}, {"owner": {"reputation": 5292, "user_id": 246534, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/ukMU2.jpg?s=128&g=1", "display_name": "kfb", "link": "https://stackoverflow.com/users/246534/kfb"}, "edited": false, "score": 0, "creation_date": 1475050021, "post_id": 39725830, "comment_id": 66780160, "body": "Thanks for explaining\u2014glad you got it sorted!"}], "owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474990410, "creation_date": 1474982597, "last_edit_date": 1474990410, "question_id": 39725830, "link": "https://stackoverflow.com/questions/39725830/which-permissions-are-required-to-create-an-issue-via-github-api-v3", "title": "Which permissions are required to create an issue via Github API v3", "body": "<p>When I try to create an issue with <code>go-github</code> API using a personal access token \nit responds with a <code>401 bad credentials</code> error:</p>\n\n<pre><code>POST https://api.github.com/repos/mh-cbon/demotest/issues: 401 Bad credentials []\n</code></pre>\n\n<p>I am using the following code:</p>\n\n<pre><code>input := &amp;github.IssueRequest{\n    Title:    &amp;g.IssueTitle,\n    Body:     &amp;body,\n}\n\nts := oauth2.StaticTokenSource(\n    &amp;oauth2.Token{AccessToken: g.Token},\n)\ntc := oauth2.NewClient(oauth2.NoContext, ts)\nclient := github.NewClient(tc)\n\n  _, _, err = client.Issues.Create(g.Owner, g.Repo, input)\n</code></pre>\n\n<p>The <code>g.Token</code> is the value of the token I created with the following permissions:</p>\n\n<pre><code>repo\nrepo:status\nrepo:repo_deployment \nrepo:public_repo\nuser\nuser:email\nuser:follow\n</code></pre>\n"}, {"tags": ["go", "struct", "interface", "go-interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1474981183, "post_id": 39725223, "comment_id": 66748068, "body": "No, you can&#39;t assign different types to the same variable. You could an empty <code>interface{}</code> (<a href=\"https://play.golang.org/p/h5vPe3Et1O\" rel=\"nofollow noreferrer\">play.golang.org/p/h5vPe3Et1O</a>), but that&#39;s not an very good solution. In Go you usually use separate error values. Have you gone through any of the introductory materials?"}, {"owner": {"reputation": 383, "user_id": 1322150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4357d4df23aecf2a539bb67d263d853e?s=128&d=identicon&r=PG", "display_name": "tsg", "link": "https://stackoverflow.com/users/1322150/tsg"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474981440, "post_id": 39725223, "comment_id": 66748267, "body": "@JimB, yes but interfaces still wasn&#39;t clear for me enough :)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474981551, "post_id": 39725223, "comment_id": 66748333, "body": "There is no problem as there is no need to unite these two types."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474981774, "post_id": 39725223, "comment_id": 66748481, "body": "@tsg, as Volker said, there&#39;s no need to combine these, you can use separate values. Since neither type has any methods, the only method set that satisfies the same interface would be the empty <code>interface{}</code>."}], "answers": [{"comments": [{"owner": {"reputation": 383, "user_id": 1322150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4357d4df23aecf2a539bb67d263d853e?s=128&d=identicon&r=PG", "display_name": "tsg", "link": "https://stackoverflow.com/users/1322150/tsg"}, "edited": false, "score": 0, "creation_date": 1474985400, "post_id": 39726860, "comment_id": 66751184, "body": "thanks for your quick response. It&#39;s very interesting for me :)"}], "tags": [], "owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "is_accepted": false, "score": 1, "last_activity_date": 1474985177, "creation_date": 1474985177, "answer_id": 39726860, "question_id": 39725223, "link": "https://stackoverflow.com/questions/39725223/how-to-unite-two-different-struct-using-interface/39726860#39726860", "title": "How to unite two different struct using interface?", "body": "<p>You can't assign 2 different types that are not \"assignable\" to the same variable ... unless you use a specific interface signature or empty interface.</p>\n\n<p><a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow\">https://golang.org/ref/spec#Assignability</a></p>\n\n<p>that code would compile :</p>\n\n<pre><code>func main() {\n    var response interface{} // empty interface AKA Object AKA void pointer\n    response = Data{Id: 100, Name: `Name`}\n    if true {\n        response = DataError{Message: `message`, ErrorCode: `code`}\n    }\n    log.Println(response)\n}\n</code></pre>\n\n<p>since every type implements empty interface, but you want to do that only if there is no other options.</p>\n\n<p>if 2 types share some methods use a specific interface, for instance (pseudo-code) :</p>\n\n<pre><code>type Responder interface {\n    Respond() string\n}\n\ntype Data struct { /* code */\n}\n\nfunc (d Data) Respond() string { return \"\" }\n\ntype DataError struct { /* code */\n}\n\nfunc (d DataError) Respond() string { return \"\" }\n\nfunc main() {\n\n    var response Responder // declared as interface\n    response = Data{}\n    response = DataError{}\n    fmt.Println(response)\n\n}\n</code></pre>\n\n<p>Whenever you have doubts a quick scan of the go spec is useful, it is the only authority and pretty well written compared to most specs out there. For the most part the rules are crystal clear, and that's a strength of Go.</p>\n"}, {"comments": [{"owner": {"reputation": 383, "user_id": 1322150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4357d4df23aecf2a539bb67d263d853e?s=128&d=identicon&r=PG", "display_name": "tsg", "link": "https://stackoverflow.com/users/1322150/tsg"}, "edited": false, "score": 1, "creation_date": 1474990882, "post_id": 39728528, "comment_id": 66755269, "body": "it&#39;s exactly what I needed! thanks a lot! Very detailed answer :)"}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 383, "user_id": 1322150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4357d4df23aecf2a539bb67d263d853e?s=128&d=identicon&r=PG", "display_name": "tsg", "link": "https://stackoverflow.com/users/1322150/tsg"}, "edited": false, "score": 0, "creation_date": 1474990971, "post_id": 39728528, "comment_id": 66755327, "body": "@tsg Happy to help. :)"}], "tags": [], "owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "is_accepted": true, "score": 5, "last_activity_date": 1474989840, "creation_date": 1474989840, "answer_id": 39728528, "question_id": 39725223, "link": "https://stackoverflow.com/questions/39725223/how-to-unite-two-different-struct-using-interface/39728528#39728528", "title": "How to unite two different struct using interface?", "body": "<p>It looks like you're trying to make a union type (what the ML-family of languages calls \"enum\"). I know of a couple of patterns for this:</p>\n\n<p><strong>0. Basic error handling (<a href=\"https://play.golang.org/p/OO0KBb4aMo\" rel=\"noreferrer\">playground</a>)</strong></p>\n\n<p>I suspect what you're doing is just basic error handling. In Go, we use multiple return values and check the result. This is almost certainly what you want to do:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n)\n\ntype Data struct {\n    ID   int\n    Name string\n}\n\ntype DataError struct {\n    Message   string\n    ErrorCode string\n}\n\n// Implement the `error` interface. `error` is an interface with\n// a single `Error() string` method\nfunc (err DataError) Error() string {\n    return fmt.Sprintf(\"%s: %s\", err.ErrorCode, err.Message)\n}\n\nfunc SomeFunction(returnData bool) (Data, error) {\n    if returnData {\n        return Data{ID: 42, Name: \"Answer\"}, nil\n    }\n    return Data{}, DataError{\n        Message:   \"A thing happened\",\n        ErrorCode: \"Oops!\",\n    }\n}\n\nfunc main() {\n    // this bool argument controls whether or not an error is returned\n    data, err := SomeFunction(false)\n    if err != nil {\n        log.Fatalln(err)\n    }\n    fmt.Println(data)\n}\n</code></pre>\n\n<p><strong>1. Interfaces (<a href=\"https://play.golang.org/p/1F4LWAdXf6\" rel=\"noreferrer\">playground</a>)</strong></p>\n\n<p>Again, if your options are good-data and error, you should probably use the first case (stick with the idiom/convention), but other times you might have multiple \"good data\" options. We can use interfaces to solve this problem. Here we're adding a dummy method to tell the compiler to constrain the possible types that can implement this interface to those that have an IsResult() method. The biggest downside to this is that sticking things into an interface can incur an allocation, which can be detrimental in a tight loop. This pattern isn't terribly common.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Result interface {\n    // a dummy method to limit the possible types that can\n    // satisfy this interface\n    IsResult()\n}\n\ntype Data struct {\n    ID   int\n    Name string\n}\n\nfunc (d Data) IsResult() {}\n\ntype DataError struct {\n    Message   string\n    ErrorCode string\n}\n\nfunc (err DataError) IsResult() {}\n\nfunc SomeFunction(isGoodData bool) Result {\n    if isGoodData {\n        return Data{ID: 42, Name: \"answer\"}\n    }\n    return DataError{Message: \"A thing happened\", ErrorCode: \"Oops!\"}\n}\n\nfunc main() {\n    fmt.Println(SomeFunction(true))\n}\n</code></pre>\n\n<p><strong>2. Tagged Union (<a href=\"https://play.golang.org/p/frfk6q7MCP\" rel=\"noreferrer\">playground</a>)</strong></p>\n\n<p>This case is similar to the previous case, except instead of using an interface, we're using a struct with a tag that tells us which type of data the struct contains (this is similar to a tagged union in C, except the size of the struct is the sum of its potential types instead of the size of its largest potential type). While this takes up more space, it can easily be stack-allocated, thus making it tight-loop friendly (I've used this technique to reduce allocs from O(n) to O(1)). In this case, our tag is a bool because we only have two possible types (Data and DataError), but you could also use a C-like enum.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Data struct {\n    ID   int\n    Name string\n}\n\ntype DataError struct {\n    Message   string\n    ErrorCode string\n}\n\ntype Result struct {\n    IsGoodData bool\n    Data       Data\n    Error      DataError\n}\n\n// Implements the `fmt.Stringer` interface; this is automatically\n// detected and invoked by fmt.Println() and friends\nfunc (r Result) String() string {\n    if r.IsGoodData {\n        return fmt.Sprint(r.Data)\n    }\n    return fmt.Sprint(r.Error)\n}\n\nfunc SomeFunction(isGoodData bool) Result {\n    if isGoodData {\n        return Result{\n            IsGoodData: true,\n            Data:       Data{ID: 42, Name: \"Answer\"},\n        }\n    }\n    return Result{\n        IsGoodData: false,\n        Error: DataError{\n            Message:   \"A thing happened\",\n            ErrorCode: \"Oops!\",\n        },\n    }\n}\n\nfunc main() {\n    // this bool argument controls whether or not an error is returned\n    fmt.Println(SomeFunction(true))\n}\n</code></pre>\n"}], "owner": {"reputation": 383, "user_id": 1322150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4357d4df23aecf2a539bb67d263d853e?s=128&d=identicon&r=PG", "display_name": "tsg", "link": "https://stackoverflow.com/users/1322150/tsg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1705, "favorite_count": 1, "accepted_answer_id": 39728528, "answer_count": 2, "score": 2, "last_activity_date": 1474989840, "creation_date": 1474980770, "question_id": 39725223, "link": "https://stackoverflow.com/questions/39725223/how-to-unite-two-different-struct-using-interface", "title": "How to unite two different struct using interface?", "body": "<p>I have the following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n)\n\ntype Data struct {\n    Id int\n    Name string\n}\n\ntype DataError struct {\n    Message string\n    ErrorCode string\n}\n\nfunc main() {\n    response := Data{Id: 100, Name: `Name`}\n    if true {\n        response = DataError{Message: `message`, ErrorCode: `code`}\n    }\n    log.Println(response)\n}\n</code></pre>\n\n<p>This code returns me an error:</p>\n\n<blockquote>\n  <p>./start.go:20: cannot use DataError literal (type DataError) as type\n  Data in assignment</p>\n</blockquote>\n\n<p>Seems to be that I could not assign to <code>response</code> var data with different type (in my case <code>DataError</code>). I heard that possible solution could be to unite <code>Data</code> and <code>DataError</code> structs via interface. Or maybe there is another better solution?</p>\n\n<p>Could you please point me how to resolve this problem?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["testing", "go", "routing", "integration-testing"], "comments": [{"owner": {"reputation": 436, "user_id": 5511980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0174993a67ce7b3ad2bcb2f12e135661?s=128&d=identicon&r=PG&f=1", "display_name": "W. Cybriwsky", "link": "https://stackoverflow.com/users/5511980/w-cybriwsky"}, "edited": false, "score": 0, "creation_date": 1474997047, "post_id": 39724919, "comment_id": 66759074, "body": "is it that you want to see the coverage on that package? or you want to write new tests and are wondering how to go about that? if you want to see the coverage stats from the todo package while you are testing the main package, you can use go test&#39;s -coverpkg option:     -coverpkg pkg1,pkg2,pkg3     Apply coverage analysis in each test to the given list of packages.     The default is for each test to analyze only the package being tested.     Packages are specified as import paths.     Sets -cover."}, {"owner": {"reputation": 627, "user_id": 2000569, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3fc2a25dae524b3e09735e1a0f1f6a69?s=128&d=identicon&r=PG", "display_name": "fvosberg", "link": "https://stackoverflow.com/users/2000569/fvosberg"}, "reply_to_user": {"reputation": 436, "user_id": 5511980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0174993a67ce7b3ad2bcb2f12e135661?s=128&d=identicon&r=PG&f=1", "display_name": "W. Cybriwsky", "link": "https://stackoverflow.com/users/5511980/w-cybriwsky"}, "edited": false, "score": 0, "creation_date": 1475006431, "post_id": 39724919, "comment_id": 66764358, "body": "Hi, thanks for your reply. Yeah, I&#39;m not sure what I want. The coverpkg option is new for me, thanks for that. But I think I&#39;ve realized that I want to seperate the concerns of my packages more. So my question in a nutshell: How do you separate the concerns of routing from the the logic in the handler in a test. I know of the response recorder, so this side is clear to me. I&#39;ve updated my git repository with my new approach and I wonder what experienced go developers think about that. Thanks!"}], "owner": {"reputation": 627, "user_id": 2000569, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3fc2a25dae524b3e09735e1a0f1f6a69?s=128&d=identicon&r=PG", "display_name": "fvosberg", "link": "https://stackoverflow.com/users/2000569/fvosberg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 402, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474979924, "creation_date": 1474979924, "question_id": 39724919, "link": "https://stackoverflow.com/questions/39724919/integration-tests-in-golang-how-to-test-the-link-between-the-router-and-the-ht", "title": "Integration tests in golang - how to test the link between the router and the http.Handlers?", "body": "<p>I've been tinkering around with golang and I try to implement a little todo application which should grow with the time. My thoughts about the applications architecture are the following:</p>\n\n<ul>\n<li>The main package sets up the server and integrates the \"services/handler\" of the other packages in it's router under the corresponding path prefixes. </li>\n<li>Every \"service\" has its own handlers and routes them correctly</li>\n</ul>\n\n<p>So I've started just with the main package and wrote some todo handlers. To test the API I've written some integration tests (request/response). Now, I've removed the todo logic from the main package into it's own. When I execute go <code>test -cover</code> it shows me just the coverage of the main.go, but not for the todo package. That leads me to the conclusion that each package has to test on it's own. </p>\n\n<p>So I have not to test the API in the main package but the integration, that '/todos' ends up in the todo package and nothing more, is that right? How can I test that? And in the todo package I have to test:</p>\n\n<ul>\n<li>The routing in the package</li>\n<li>And with a response recorder the API implementation</li>\n</ul>\n\n<p>Is that right too? So how can I test the routing on it's own? Is that possible?</p>\n\n<p>Here is my git repository:\n<a href=\"https://github.com/fvosberg/mrsjenkins\" rel=\"nofollow\">https://github.com/fvosberg/mrsjenkins</a></p>\n\n<p>Thanks in advance </p>\n"}, {"tags": ["testing", "go", "mocking", "go-gin"], "comments": [{"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1474990806, "post_id": 39723345, "comment_id": 66755213, "body": "I have an answer to a similar question over here: <a href=\"http://stackoverflow.com/questions/19167970/mock-functions-in-go/19168875#19168875\" title=\"mock functions in go\">stackoverflow.com/questions/19167970/mock-functions-in-go/&hellip;</a>  Long story short: you need to inject your FindAndCompleteOperation() function in order to mock it."}, {"owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "edited": false, "score": 0, "creation_date": 1515680623, "post_id": 39723345, "comment_id": 83399365, "body": "Here&#39;s another approach with a full example that should make clear how it is possible to write testable code in Go: <a href=\"https://stackoverflow.com/a/48206430/828366\">stackoverflow.com/a/48206430/828366</a>"}, {"owner": {"reputation": 22099, "user_id": 828366, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/V8V1N.jpg?s=128&g=1", "display_name": "Francesco Casula", "link": "https://stackoverflow.com/users/828366/francesco-casula"}, "edited": false, "score": 0, "creation_date": 1515680687, "post_id": 39723345, "comment_id": 83399431, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/19167970/mock-functions-in-go\">Mock functions in Go</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474988722, "post_id": 39727298, "comment_id": 66753711, "body": "Thanks, would it be possible to expand on this in the context of my current test. I&#39;m still unsure how it all fits together. J"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 1, "creation_date": 1474990722, "post_id": 39727298, "comment_id": 66755142, "body": "TLDR; change your code to make it &quot;mockable&quot;, because the piece of code showed me is not. You can&#39;t mock anything if you don&#39;t inject dependencies that are interfaces when creating your handlers. It&#39;s no different from other statically typed languages. In Java it would be exactly the same thing, your methods should accept interfaces as argument instead of concrete types and you should not rely on types that are not injected."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474991442, "post_id": 39727298, "comment_id": 66755616, "body": "Ok - I understand this. But that is exactly what I need help with. I don&#39;t know how to actually implement. If I knew, I wouldn&#39;t have wasted the time asking the question."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474991795, "post_id": 39727298, "comment_id": 66755830, "body": "Also, it&#39;s not possible to use a closure or method of a struct in that gin function. Or at least, I don&#39;t see how that&#39;s possible."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474992881, "post_id": 39727298, "comment_id": 66756584, "body": "@JennyBlunt You&#39;re right that you can&#39;t use a closure or method <i>in</i> your UpdateOperation function, so we need to <i>make</i> that function into a closure so we can parameterize it. See my answer."}], "tags": [], "owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "is_accepted": false, "score": 1, "last_activity_date": 1474986326, "creation_date": 1474986326, "answer_id": 39727298, "question_id": 39723345, "link": "https://stackoverflow.com/questions/39723345/mocking-functions-in-golang-to-test-my-http-routes/39727298#39727298", "title": "Mocking functions in Golang to test my http routes", "body": "<p>You can't mock if you use globals that can't be mocked in an handler. Either your globals are mockable (i.e. declared as variables of interface type) or you need to use dependency injection.</p>\n\n<pre><code>func (oi OperationInfoer) FindAndCompleteOp(id string, report Report) error {...}\n</code></pre>\n\n<p>looks like a method of a struct, so you should be able to inject that struct into an handler, at the very least.</p>\n\n<pre><code>type OperationInfoer interface {\n   FindAndCompleteOp(id string, report Report) error \n} \n\ntype ConcreteOperationInfoer struct { /* actual implementation */ }\n\nfunc UpdateOperation(oi OperationInfoer) func(c *gin.Context) {\n    return func (c *gin.Context){\n        // the code\n    }\n}\n</code></pre>\n\n<p>then mocking becomes a breeze in your tests : </p>\n\n<pre><code>UpdateOperation(mockOperationInfoer)(ginContext)\n</code></pre>\n\n<p>You can use a struct instead of closures</p>\n\n<pre><code>type UpdateOperationHandler struct {\n    Oi OperationInfoer\n}\nfunc (h UpdateOperationHandler ) UpdateOperation (c *gin.Context) {\n    h.Oi.FindAndCompleteOp(/* code */ )\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474992140, "post_id": 39729274, "comment_id": 66756053, "body": "Could you put the test in there too?"}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474992583, "post_id": 39729274, "comment_id": 66756367, "body": "@JennyBlunt Test added."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474993385, "post_id": 39729274, "comment_id": 66756929, "body": "Getting there slowly, this is breaking me. I don&#39;t know why :( In my case, I need to test the whole route. I&#39;ve now updated my functions but still don&#39;t see what I need to put in the test in my example."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474993714, "post_id": 39729274, "comment_id": 66757124, "body": "@JennyBlunt No worries. To test your whole route, you&#39;ll need to parameterize your SetupRouter() function to take the <code>findAndComplete</code> closure as a parameter. From there you just invoke the <code>gin.Engine</code>&#39;s <code>ServeHTTP()</code> method with the proper request (and probably some mock <code>http.ResponseWriter</code>). <code>ServeHTTP()</code> allows the engine to implement the standard library&#39;s <code>http.Handler</code> interface, so you should be able to find more information about testing by Googling &quot;http testing in golang&quot;--you&#39;re not restricted to gin-specific examples here."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474993846, "post_id": 39729274, "comment_id": 66757198, "body": "If you&#39;re still struggling, I can put together a more case-specific example tonight."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474994042, "post_id": 39729274, "comment_id": 66757340, "body": "That&#39;d be great, thanks. Just cant put the pieces together. That makes sense though, I kinda thought there would be a simple way to stub that particular function so it returned whatever... Guess I&#39;m spoiled by Ruby.. In the meantime, I will read up on general http testing. Thanks again."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474994480, "post_id": 39729274, "comment_id": 66757588, "body": "@JennyBlunt I&#39;m guessing the hard part isn&#39;t creating the stub, but actually replacing the real call with the stub. This is hard because your code is tightly coupled. Ruby lets you test tightly coupled code via patching, but really you should try to avoid tightly coupled code in the first place (patching is a sign of poor architecture)."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474994769, "post_id": 39729274, "comment_id": 66757735, "body": "Yeah, it looks that way. And I have a function (just about to add to the above question) that sets up the routes. I can override this but then I&#39;m not actually testing anything..."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474994824, "post_id": 39729274, "comment_id": 66757775, "body": "Actually it&#39;s in there already - SetupRouter() *gin.Engine. My bad."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474995836, "post_id": 39729274, "comment_id": 66758348, "body": "Just found this but it&#39;s epic. <a href=\"https://dev.makeitsocial.com/blog/2015/12/04/golang-test-http/\" rel=\"nofollow noreferrer\">dev.makeitsocial.com/blog/2015/12/04/golang-test-http</a>"}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 1, "creation_date": 1474997046, "post_id": 39729274, "comment_id": 66759073, "body": "@JennyBlunt I updated my example. You can copy/paste this and it will run."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1474999674, "post_id": 39729274, "comment_id": 66760597, "body": "Cool, it&#39;s starting to make some sense. OMG. Presumably I should change findAndComplete (which gets sent to the Setup fn) to an interface, rather than a function? That way I can add multiple routes to the setup and test them in similar ways??"}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1475003116, "post_id": 39729274, "comment_id": 66762598, "body": "@JennyBlunt Probably. Interfaces and closures serve similar purposes. If you have a lot of closures that close over similar state, you probably want an interface. Otherwise it&#39;s pretty much personal preference."}, {"owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1475012258, "post_id": 39729274, "comment_id": 66767338, "body": "Ok thanks for the help. Still a bit unsure but you&#39;ve helped a lot. J"}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "edited": false, "score": 0, "creation_date": 1475014173, "post_id": 39729274, "comment_id": 66768060, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/124356/discussion-between-weberc2-and-jenny-blunt\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "is_accepted": true, "score": 2, "last_activity_date": 1474997501, "last_edit_date": 1495535358, "creation_date": 1474991913, "answer_id": 39729274, "question_id": 39723345, "link": "https://stackoverflow.com/questions/39723345/mocking-functions-in-golang-to-test-my-http-routes/39729274#39729274", "title": "Mocking functions in Golang to test my http routes", "body": "<p>I have another relevant, more informative answer to a similar question <a href=\"https://stackoverflow.com/questions/19167970/mock-functions-in-go/19168875#19168875\">here</a>, but here's an answer for your specific scenario:</p>\n\n<p>Update your <code>SetupRouter()</code> function to take a function that can either be the real <code>FindAndCompleteOperation</code> function or a stub function:</p>\n\n<p><a href=\"https://play.golang.org/p/ns7k9Yb-Jg\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<pre><code>package main\n\nimport \"github.com/gin-gonic/gin\"\n\n// m.Response.Report\ntype Report struct {\n    // ...\n}\n\n// m.OperationInfoer\ntype OperationInfoer struct {\n    // ...\n}\n\ntype findAndComplete func(s OperationInfoer, id string, report Report) error\n\nfunc FindAndCompleteOperation(OperationInfoer, string, Report) error {\n    // ...\n    return nil\n}\n\nfunc SetupRouter(f findAndComplete) *gin.Engine {\n    r := gin.Default()\n    r.Group(\"v1\").PATCH(\"/:id\", func(c *gin.Context) {\n        if f(OperationInfoer{}, c.Param(\"id\"), Report{}) == nil {\n            c.JSON(200, gin.H{\"message\": \"Operation completed\"})\n        }\n    })\n    return r\n}\n\nfunc main() {\n    r := SetupRouter(FindAndCompleteOperation)\n    if err := r.Run(\":8080\"); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p><strong>Test/mocking example</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"net/http/httptest\"\n    \"strings\"\n    \"testing\"\n)\n\nfunc TestUpdateRoute(t *testing.T) {\n    // build findAndComplete stub\n    var callCount int\n    var lastInfoer OperationInfoer\n    var lastID string\n    var lastReport Report\n    stub := func(s OperationInfoer, id string, report Report) error {\n        callCount++\n        lastInfoer = s\n        lastID = id\n        lastReport = report\n        return nil // or `fmt.Errorf(\"Err msg\")` if you want to test fault path\n    }\n\n    // invoke endpoint\n    w := httptest.NewRecorder()\n    r := httptest.NewRequest(\n        \"PATCH\",\n        \"/v1/id_value\",\n        strings.NewReader(\"\"),\n    )\n    SetupRouter(stub).ServeHTTP(w, r)\n\n    // check that the stub was invoked correctly\n    if callCount != 1 {\n        t.Fatal(\"Wanted 1 call; got\", callCount)\n    }\n    if lastInfoer != (OperationInfoer{}) {\n        t.Fatalf(\"Wanted %v; got %v\", OperationInfoer{}, lastInfoer)\n    }\n    if lastID != \"id_value\" {\n        t.Fatalf(\"Wanted 'id_value'; got '%s'\", lastID)\n    }\n    if lastReport != (Report{}) {\n        t.Fatalf(\"Wanted %v; got %v\", Report{}, lastReport)\n    }\n\n    // check that the correct response was returned\n    if w.Code != 200 {\n        t.Fatal(\"Wanted HTTP 200; got HTTP\", w.Code)\n    }\n\n    var body map[string]string\n    if err := json.Unmarshal(w.Body.Bytes(), &amp;body); err != nil {\n        t.Fatal(\"Unexpected error:\", err)\n    }\n    if body[\"message\"] != \"Operation completed\" {\n        t.Fatal(\"Wanted 'Operation completed'; got %s\", body[\"message\"])\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1326, "user_id": 789125, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/7484bfbfd4f46d5621315de848b5a996?s=128&d=identicon&r=PG", "display_name": "Jenny Blunt", "link": "https://stackoverflow.com/users/789125/jenny-blunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1923, "favorite_count": 1, "accepted_answer_id": 39729274, "answer_count": 2, "score": 3, "last_activity_date": 1474997501, "creation_date": 1474975313, "last_edit_date": 1474987197, "question_id": 39723345, "link": "https://stackoverflow.com/questions/39723345/mocking-functions-in-golang-to-test-my-http-routes", "title": "Mocking functions in Golang to test my http routes", "body": "<p>I'm totally confused figuring out how I can mock a function, without using any additional packages like golang/mock. I'm just trying to learn how to do so but can't find many decent online resources.</p>\n\n<p>Essentially, I <a href=\"https://nathanleclaire.com/blog/2015/10/10/interfaces-and-composition-for-effective-unit-testing-in-golang/\" rel=\"nofollow\">followed this excellent article</a> that explains how to use an interface to mock things.</p>\n\n<p>As so, I've re-written the function I wanted to test. The function just inserts some data into datastore. My tests for that are ok - I can mock the function directly. </p>\n\n<p>The issue I'm having is mocking it 'within' an http route I'm trying to test. Am using the Gin framework.</p>\n\n<p>My router (simplified) looks like this:</p>\n\n<pre><code>func SetupRouter() *gin.Engine {\n\n    r := gin.Default()\n    r.Use(gin.Logger())\n    r.Use(gin.Recovery())\n\n    v1 := r.Group(\"v1\")\n    v1.PATCH(\"operations/:id\", controllers.UpdateOperation)\n}\n</code></pre>\n\n<p>Which calls the UpdateOperation function:</p>\n\n<pre><code>func UpdateOperation(c *gin.Context) {\n    id := c.Param(\"id\")\n    r := m.Response{}\n\n    str := m.OperationInfoer{}\n    err := m.FindAndCompleteOperation(str, id, r.Report)\n\n    if err == nil {\n      c.JSON(200, gin.H{\n          \"message\": \"Operation completed\",\n      })\n    }\n}\n</code></pre>\n\n<p><strong>So, I need to mock the FindAndCompleteOperation() function.</strong></p>\n\n<p>The main (simplified) functions looks like this:</p>\n\n<pre><code>func (oi OperationInfoer) FindAndCompleteOp(id string, report Report) error {\n    ctx := context.Background()\n    q := datastore.NewQuery(\"Operation\").\n        Filter(\"Unique_Id =\", id).\n        Limit(1)\n\n    var ops []Operation\n\n    if ts, err := db.Datastore.GetAll(ctx, q, &amp;ops); err == nil {\n        {\n            if len(ops) &gt; 0 {\n                ops[0].Id = ts[0].ID()\n                ops[0].Complete = true\n\n                // Do stuff\n\n                _, err := db.Datastore.Put(ctx, key, &amp;o)\n                if err == nil {\n                  log.Print(\"OPERATION COMPLETED\")\n                }\n            }\n        }\n    }\n\n    err := errors.New(\"Not found\")\n    return err\n}\n\nfunc FindAndCompleteOperation(ri OperationInfoer, id string, report Report) error {\n    return ri.FindAndCompleteOp(id, report)\n}\n\ntype OperationInfoer struct{}\n</code></pre>\n\n<p>To test the route that updates the operation, I have something like so:</p>\n\n<pre><code>FIt(\"Return 200, updates operation\", func() {\n    testRouter := SetupRouter()\n\n    param := make(url.Values)\n    param[\"access_token\"] = []string{public_token}\n\n    report := m.Report{}\n    report.Success = true\n    report.Output = \"my output\"\n\n    jsonStr, _ := json.Marshal(report)\n    req, _ := http.NewRequest(\"PATCH\", \"/v1/operations/123?\"+param.Encode(), bytes.NewBuffer(jsonStr))\n\n    resp := httptest.NewRecorder()\n    testRouter.ServeHTTP(resp, req)\n\n    Expect(resp.Code).To(Equal(200))\n\n    o := FakeResponse{}\n    json.NewDecoder(resp.Body).Decode(&amp;o)\n    Expect(o.Message).To(Equal(\"Operation completed\"))\n})\n</code></pre>\n\n<p>Originally, I tried to cheat a bit and just tried something like this:</p>\n\n<pre><code>m.FindAndCompleteOperation = func(string, m.Report) error {\n  return nil\n}\n</code></pre>\n\n<p>But that affects all the other tests etc.</p>\n\n<p>I'm hoping someone can explain simply what the best way to mock the FindAndCompleteOperation function so I can test the routes, without relying on datastore etc.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 451, "user_id": 933670, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/u1O9u.jpg?s=128&g=1", "display_name": "etnbrd", "link": "https://stackoverflow.com/users/933670/etnbrd"}, "edited": false, "score": 0, "creation_date": 1474970980, "post_id": 39721014, "comment_id": 66741162, "body": "I tried this, but it feels strange to have the function <code>create</code> not being a method. The reason is that I might have several kinds of entity. Identified ones, and unidentified ones for example. And I need to implement the <code>create</code> function differently for these different entities. So I wanted to make it a method for each entity, but it ended up being a mess. But I guess I will have to name these functions differently, like <code>createIdedEnt</code> and <code>createUnidedEnt</code>, instead of relying on methods."}, {"owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "reply_to_user": {"reputation": 451, "user_id": 933670, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/u1O9u.jpg?s=128&g=1", "display_name": "etnbrd", "link": "https://stackoverflow.com/users/933670/etnbrd"}, "edited": false, "score": 0, "creation_date": 1474983939, "post_id": 39721014, "comment_id": 66750079, "body": "I would decouple data access layer from entity.  like: AccountDal().Create(ctx, account)."}], "tags": [], "owner": {"reputation": 5174, "user_id": 1975086, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e01df0a60ee2c34233ce48e32c21a3b8?s=128&d=identicon&r=PG", "display_name": "Alexander Trakhimenok", "link": "https://stackoverflow.com/users/1975086/alexander-trakhimenok"}, "is_accepted": true, "score": 3, "last_activity_date": 1474968501, "creation_date": 1474968501, "answer_id": 39721014, "question_id": 39720221, "link": "https://stackoverflow.com/questions/39720221/avoid-code-duplication-with-interface-in-golang/39721014#39721014", "title": "Avoid code duplication with interface in golang", "body": "<p>Use interface to define methods <code>NewKey()</code> &amp; <code>SetID()</code></p>\n\n<pre><code>type Entity interface {\n  SetId(id int64)\n  NewKey(c context.Context) *datastore.Key\n}\n\nfunc create(c context.Context, entity Entity) error { \n  if ret, err := datastore.Put(c, entity.NewKey(c), entity ); err != nil {\n    log.Errorf(c, \"Error while creating entity: %v\\n\", err)\n    return err\n  } else {\n    entity.SetId(ret.IntID())\n    return nil\n  }\n}\n\nfunc (index *Index) Create(c context.Context) (*Index, error) {\n  return index, create(c, index)\n}\n\nfunc (account *Account) Create(c context.Context) (*Account, error) {\n  return account, create(c, account)\n}\n</code></pre>\n"}], "owner": {"reputation": 451, "user_id": 933670, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/u1O9u.jpg?s=128&g=1", "display_name": "etnbrd", "link": "https://stackoverflow.com/users/933670/etnbrd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 124, "favorite_count": 0, "accepted_answer_id": 39721014, "answer_count": 1, "score": 3, "last_activity_date": 1474976332, "creation_date": 1474966290, "last_edit_date": 1474976332, "question_id": 39720221, "link": "https://stackoverflow.com/questions/39720221/avoid-code-duplication-with-interface-in-golang", "title": "Avoid code duplication with interface in golang", "body": "<p>I am using the Google Cloud Datastore (or the google app engine datastore), to store different objects. Most of these objects are similar, hence I end up with lots of code duplication.</p>\n\n<p>As an example, here are two create methods, of two different objects, <code>account</code> and <code>index</code>.</p>\n\n<pre><code>func (account *Account) Create(ctx context.Context) (*Account, error) {\n  if ret, err := datastore.Put(ctx, account.newKey(ctx), account); err != nil {\n    log.Errorf(ctx, \"Error while creating Account : %v\\n\", err)\n    return nil, err\n  } else {\n    account.Id = strconv.FormatInt(ret.IntID(), 10)\n  }\n\n  return account, nil\n}\n</code></pre>\n\n<hr>\n\n<pre><code>func (index *Index) Create(ctx context.Context) (*Index, error) { \n  if ret, err := datastore.Put(ctx, index.newKey(ctx), index); err != nil {\n    log.Errorf(ctx, \"Error while creating Index : %v\\n\", err)\n    return nil, err\n  } else {\n    index.Id = strconv.FormatInt(ret.IntID(), 10)\n  }\n\n  return index, nil\n}\n</code></pre>\n\n<p>As you can see, the two snippets are identical, excepts for the holder type, the return type, and the error message.</p>\n\n<p><strong>What is the idiomatic way to avoid this kind of code duplication ?</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1474960359, "post_id": 39718228, "comment_id": 66734007, "body": "To the editor: it doesn&#39;t really seem better with more space"}, {"owner": {"reputation": 332774, "user_id": 263525, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/ec289925069b35f18f1230b90dc654e5?s=128&d=identicon&r=PG", "display_name": "Denys S&#233;guret", "link": "https://stackoverflow.com/users/263525/denys-s%c3%a9guret"}, "edited": false, "score": 0, "creation_date": 1474960516, "post_id": 39718228, "comment_id": 66734119, "body": "A problem is that there&#39;s no generics in go. So if your API are typed, you might want to use channels or slices in order to retain the type."}, {"owner": {"reputation": 1217, "user_id": 5066719, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/902c0e0e880e8e5d5395c6872f05fb05?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Soni", "link": "https://stackoverflow.com/users/5066719/abhishek-soni"}, "edited": false, "score": 0, "creation_date": 1474965745, "post_id": 39718228, "comment_id": 66737546, "body": "Roger i would definitely suggest you Channels because as per your requirement you need somewhat like streamed feed where you didn&#39;t expect slice, in this case channels would b the best way because you are saved from creating your own custom Iterator which otherwise would be implemented in the same way."}, {"owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1474983132, "post_id": 39718228, "comment_id": 66749503, "body": "I ended up using a callback instead, that way, I can use all of the above solutions if I want to, just pass different callbacks.."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1474998377, "post_id": 39718228, "comment_id": 66759902, "body": "Just build an iterator. These are nicer IMO because you don&#39;t have to spin up a goroutine (i.e., you don&#39;t have to worry about race conditions, deadlocks, etc) and they&#39;re still very easy to implement. If you want concurrency/parallelism, you can always wrap the iterator in a goroutine later."}], "answers": [{"tags": [], "owner": {"reputation": 88, "user_id": 9640539, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-edmbUAlE0F8/AAAAAAAAAAI/AAAAAAAAAAc/Uv1tsF56-Co/photo.jpg?sz=128", "display_name": "Jess", "link": "https://stackoverflow.com/users/9640539/jess"}, "is_accepted": false, "score": 0, "last_activity_date": 1562129455, "creation_date": 1562129455, "answer_id": 56863077, "question_id": 39718228, "link": "https://stackoverflow.com/questions/39718228/return-slice-channel-or-custom-iterator-from-db-repository/56863077#56863077", "title": "Return Slice, Channel or Custom Iterator from DB Repository?", "body": "<p>Maps</p>\n\n<p>I learned it more <a href=\"https://manuel.kiessling.net/2012/09/28/applying-the-clean-architecture-to-go-applications/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<ul>\n<li>First, generate a struct with db handlers.</li>\n<li>Second, make interfaces matching dbhandler methods.</li>\n<li>Third, specify the custom interface as the key of the map.</li>\n</ul>\n\n<p>Now, regardless of the Model struct you should be able to use db handler's methods</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>dbHandler := infrastructure.NewSqliteHandler(\"/var/tmp/production.sqlite\")\n\nhandlers := make(map[string] interfaces.DbHandler)\nhandlers[\"DbUserRepo\"] = dbHandler\nhandlers[\"DbCustomerRepo\"] = dbHandler\nhandlers[\"DbItemRepo\"] = dbHandler\nhandlers[\"DbOrderRepo\"] = dbHandler\n</code></pre>\n"}], "owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1562129455, "creation_date": 1474960170, "last_edit_date": 1474960325, "question_id": 39718228, "link": "https://stackoverflow.com/questions/39718228/return-slice-channel-or-custom-iterator-from-db-repository", "title": "Return Slice, Channel or Custom Iterator from DB Repository?", "body": "<p>What would be the idiomatic way to design database repository for Go ?</p>\n\n<p>I am using Couchbase cbgo to fetch the items which returns a reader where. I get each item one by one.</p>\n\n<p>I do not want to return this abstraction to the end user of my lib.</p>\n\n<p>So what would be the best way to do this ?</p>\n\n<p>I could just iterate over the items and append them to a Slice.</p>\n\n<p>Or, I could return a Channel, and then push each row to the channel so that the client can for range over it.</p>\n\n<p>Or I could make my own iterator abstraction.</p>\n\n<p>What do others do in this kind of scenarios ?</p>\n\n<p>I don't really need to have the result as a slice as the data is just piped to other modules.</p>\n"}, {"tags": ["go", "types", "casting"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 5, "creation_date": 1474942531, "post_id": 39714950, "comment_id": 66727899, "body": "You don&#39;t need to convert the the type when it&#39;s assignable: <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Assignability</a>"}, {"owner": {"reputation": 1517, "user_id": 1652820, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/239c4c728f22317fd010b2ce40558085?s=128&d=identicon&r=PG", "display_name": "thisisnotabus", "link": "https://stackoverflow.com/users/1652820/thisisnotabus"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474943299, "post_id": 39714950, "comment_id": 66728052, "body": "So, what is the specific usecase for <code>type Something string</code> if you&#39;d get the same type-safety from just using <code>string</code> itself?"}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "edited": false, "score": 1, "creation_date": 1474945423, "post_id": 39714950, "comment_id": 66728490, "body": "&quot;x&#39;s type V and T have identical underlying types and at least one of V or T is not a named type.&quot; I quote the doc JimB linked. Search underlying type is string and string is an unnamed type."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1474951184, "post_id": 39714950, "comment_id": 66729905, "body": "It is about the method set which is different. Using string as an example makes a <i>very</i> bad example here."}, {"owner": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474963534, "post_id": 39714950, "comment_id": 66736102, "body": "@JimB Then why do you have to convert it when the type and function definitions are also in the main package, instead of search package?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1474967884, "post_id": 39714950, "comment_id": 66739003, "body": "@thisisnotabus I&#39;ve just repeated your example and I&#39;m getting <code>cannot use StringTerm (type string) as type a.Search in argument to a.PrintSearch</code>. Are you sure you aren&#39;t using constants in your original code?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2547, "user_id": 6255980, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/454bc16f39711097b06e71a597725238?s=128&d=identicon&r=PG&f=1", "display_name": "jussius", "link": "https://stackoverflow.com/users/6255980/jussius"}, "edited": false, "score": 0, "creation_date": 1474982492, "post_id": 39714950, "comment_id": 66748995, "body": "@jussius: I think I see what you&#39;re asking now, but that <i>does</i> fail in the main package too: <a href=\"https://play.golang.org/p/xXk5tTdTe4\" rel=\"nofollow noreferrer\">play.golang.org/p/xXk5tTdTe4</a> -- like Ainar-G asked, are you using constants to test?"}, {"owner": {"reputation": 1517, "user_id": 1652820, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/239c4c728f22317fd010b2ce40558085?s=128&d=identicon&r=PG", "display_name": "thisisnotabus", "link": "https://stackoverflow.com/users/1652820/thisisnotabus"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474987465, "post_id": 39714950, "comment_id": 66752769, "body": "@JimB It throws a compiler error if everything is done in the same package. As in, if I define the Search type and PrintSearch method in the same package as main/as they&#39;re being used, I get a compiler error. If I define them in a separate package and import them, I do not. I am definitely not using constants."}, {"owner": {"reputation": 1517, "user_id": 1652820, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/239c4c728f22317fd010b2ce40558085?s=128&d=identicon&r=PG", "display_name": "thisisnotabus", "link": "https://stackoverflow.com/users/1652820/thisisnotabus"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474987501, "post_id": 39714950, "comment_id": 66752808, "body": "@Ainar-G If you repeated it all in one package/in main, the compiler will throw an exception. Try moving the Search type/the PrintSearch method to its own package and import it in main."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474988680, "post_id": 39714950, "comment_id": 66753684, "body": "@thisisnotabus: no, it throws an error in both cases, so I&#39;m still confused as to what you&#39;re doing. Maybe you&#39;re not importing what you think you are? Please try to make a complete, reproducible example."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1475000132, "post_id": 39714950, "comment_id": 66760856, "body": "@thisisnotabus No, I did it in two packages. But if you used constants instead of variables, it would work just as you described."}, {"owner": {"reputation": 1517, "user_id": 1652820, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/239c4c728f22317fd010b2ce40558085?s=128&d=identicon&r=PG", "display_name": "thisisnotabus", "link": "https://stackoverflow.com/users/1652820/thisisnotabus"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1475008342, "post_id": 39714950, "comment_id": 66765389, "body": "@Ainar-G unless <code>:=</code> declares constants, I am not using constants."}], "answers": [{"tags": [], "owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "is_accepted": true, "score": 1, "last_activity_date": 1474993239, "creation_date": 1474993239, "answer_id": 39729715, "question_id": 39714950, "link": "https://stackoverflow.com/questions/39714950/go-type-automatically-converting-when-it-seems-like-it-shouldnt/39729715#39729715", "title": "Go type automatically converting when it seems like it shouldn&#39;t", "body": "<p>We can simplify this example a bit further (<a href=\"https://play.golang.org/p/i6_d1zTGwn\" rel=\"nofollow\">playground</a>):</p>\n\n<pre><code>package main\n\ntype Foo string\n\ntype Bar int\n\nfunc main() {\n    var f Foo = \"foo\"\n    var b Bar = 1\n\n    println(f, b)\n}\n</code></pre>\n\n<p>This is explained in the <a href=\"http://golang.org/ref/spec#Assignability\" rel=\"nofollow\">spec's assignability section</a>.</p>\n\n<blockquote>\n  <p>A value x is assignable to a variable of type T (\"x is assignable to\n  T\") in any of these cases:</p>\n  \n  <ul>\n  <li>x's type is identical to T.</li>\n  <li>x's type V and T have identical underlying types and at least one of V or T is not a named type.</li>\n  <li>T is an interface type and x implements T.</li>\n  <li>x is a bidirectional channel value, T is a channel type, x's type V and T have identical element types, and at least one of V or T is not a named type.</li>\n  <li>x is the predeclared identifier nil and T is a pointer, function, slice, map, channel, or interface type.</li>\n  <li>x is an untyped constant representable by a value of type T.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 1517, "user_id": 1652820, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/239c4c728f22317fd010b2ce40558085?s=128&d=identicon&r=PG", "display_name": "thisisnotabus", "link": "https://stackoverflow.com/users/1652820/thisisnotabus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 39729715, "answer_count": 1, "score": 1, "last_activity_date": 1474993239, "creation_date": 1474942023, "question_id": 39714950, "link": "https://stackoverflow.com/questions/39714950/go-type-automatically-converting-when-it-seems-like-it-shouldnt", "title": "Go type automatically converting when it seems like it shouldn&#39;t", "body": "<p>Sorry for the ambiguous title. I'm not getting a compiler error when I believe that I should, based on creating a new type and a function that takes an argument of that type.</p>\n\n<p>The example:</p>\n\n<pre><code>package search\n\n//Some random type alias\ntype Search string\n\n//Takes a string and returns Search\nfunc NewSearch(s string) Search {\n   return Search(s)\n}\n\n//This is where things are getting weird\n//Returns an int just for arbitrary testing\nfunc PrintSearch(s Search) int{\n    return 5\n}\n</code></pre>\n\n<p>Now my assumption would be, if I created an object using <code>NewSearch</code>, I would be able to pass it to PrintSearch and have everything run as expected, but if I passed PrintSearch a primitive string, it should not compile.  I am not experiencing this behavior.</p>\n\n<p>The main code:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \".../search\" //no need to type the whole path here\n)\n\nfunc main() {\n   SearchTerm := search.NewSearch(\"Test\")\n   StringTerm := \"Another test\"\n\n   fmt.Println(search.PrintSearch(SearchTerm)) // This should print 5\n   fmt.Println(search.PrintSearch(StringTerm)) // This should throw a compiler error, but it is not\n}\n</code></pre>\n\n<p>It seems like if I write the type and the function in the same package as main, everything works as I'd expect? As in, it throws a compiler error. Is there something I've missed about cross-package type coercion?</p>\n"}, {"tags": ["oop", "object", "methods", "go"], "comments": [{"owner": {"reputation": 41, "user_id": 4780955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-x6VZfsNx5bY/AAAAAAAAAAI/AAAAAAAAQ80/Upuy-T4hutg/photo.jpg?sz=128", "display_name": "Gentry Rolofson", "link": "https://stackoverflow.com/users/4780955/gentry-rolofson"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1474941700, "post_id": 39714772, "comment_id": 66727722, "body": "Could you explain please?         <a href=\"https://play.golang.org/p/hwgVR0qGuh\" rel=\"nofollow noreferrer\">play.golang.org/p/hwgVR0qGuh</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474942280, "post_id": 39714772, "comment_id": 66727841, "body": "Using a <a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow noreferrer\">method expression</a> in general is extremely uncommon, and almost never used for a constructor. Using a regular function as a constructor is idiomatic and would be what most programmers expect."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1474950974, "post_id": 39714772, "comment_id": 66729844, "body": "The answers are right, but to put it another way, your method is declared to <i>take an already-existing <code>person</code></i>. The standard thing is, as JimB says, <code>newPerson</code> returning a <code>person</code> or <code>*person</code>--<code>godoc</code> is smart enough to recognize that that is, in effect, a constructor, and group it under the type. It&#39;s not uncommon to have multiple constructors with different params like <code>compress&#47;zlib</code>&#39;s <code>NewWriter</code> and <code>NewWriterLevel</code>, and it&#39;s also alloed to just let callers initialize with a struct literal (e.g. <code>http.Server</code>) or the zero value (<code>sync.Mutex</code>, <code>bytes.Buffer</code>, <code>bufio.Reader</code>, etc.)."}], "answers": [{"tags": [], "owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "is_accepted": false, "score": 3, "last_activity_date": 1474950411, "last_edit_date": 1474950411, "creation_date": 1474949902, "answer_id": 39715889, "question_id": 39714772, "link": "https://stackoverflow.com/questions/39714772/golang-method-expressions-instances-of-object/39715889#39715889", "title": "Golang: Method expressions instances of Object", "body": "<p>Your problem has nothing to do with variadics.</p>\n\n<p>You need to read and learn about method expressions :</p>\n\n<p><a href=\"https://golang.org/ref/spec#Method_expressions\" rel=\"nofollow\">https://golang.org/ref/spec#Method_expressions</a></p>\n\n<pre><code>package main\n\ntype person struct {\n    name string\n}\n\nfunc (p person) constructor(params ...string) person {\n    name := \"Unnamed Person\" // Default name\n    if len(params) &gt; 0 {\n        name = params[0]\n    }\n    return person{name: name}\n}\nfunc main() {\n    // THIS WORKS\n    person.constructor(person{},\"Bob\")\n}\n</code></pre>\n\n<p>This compiles but it makes very little sense to do that in your case. the constructor function expect a person receiver. Whether you put it before like </p>\n\n<p>like <code>person{}.constructor(\"bob\")</code> or after like <code>person.constructor(person{},\"bob\")</code> doesn't matter. constructor expects a  person receiver . constructor method is not a \"field of some person namespace\", this isn't javascript.</p>\n\n<p>If you want to write a constructor function write a factory without a receiver</p>\n\n<pre><code>func NewPerson(params...string)*Person{\n   // code\n}\n</code></pre>\n\n<p>that's the idiomatic way to do that in Go. </p>\n\n<p>I suggest you to go through the spec once at least.</p>\n"}, {"comments": [{"owner": {"reputation": 476, "user_id": 12817546, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-7Y79xcMm5cw/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rePp9zs2ylgFHtZKiaQLj2QI9Xc7w/photo.jpg?sz=128", "display_name": "Tom L", "link": "https://stackoverflow.com/users/12817546/tom-l"}, "edited": false, "score": 0, "creation_date": 1599622547, "post_id": 39715965, "comment_id": 112826720, "body": "A slightly different way to solve it. See <a href=\"https://play.golang.org/p/cdYQB26my1z\" rel=\"nofollow noreferrer\">play.golang.org/p/cdYQB26my1z</a>."}], "tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": true, "score": 3, "last_activity_date": 1474950445, "last_edit_date": 1592644375, "creation_date": 1474950445, "answer_id": 39715965, "question_id": 39714772, "link": "https://stackoverflow.com/questions/39714772/golang-method-expressions-instances-of-object/39715965#39715965", "title": "Golang: Method expressions instances of Object", "body": "<p>The introduction in the <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">Go tour</a> provides a concise answer to your question.</p>\n<blockquote>\n<p>Go does not have classes. However, you can define methods on types.</p>\n</blockquote>\n<p>Your examples assume that the <code>constructor</code> function is defined on the definition of the <code>person</code> struct. This is not the case. A method operates on an instance of a type referred to as a <a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\"><em>receiver</em></a>. A constructor is not possible in this mechanism. The established pattern within the Go community is to use a factory function to initialize a struct and is exemplified in your first function definition.</p>\n<p>The second example provided is failing because <code>constructor</code> is expecting to be called on an instance of a person which is undefined. If you construct a new instance of a <code>person</code> struct the function behaves as expected.</p>\n<pre><code>// https://play.golang.org/p/5XDGSTMVj9\n\nfunc (p person) constructor(params ...string) person {\n    name := &quot;Unnamed Person&quot; // Default name\n    if len(params) &gt; 0 {\n        name = params[0]\n    }\n    return person{name: name}\n}\n\nfunc main() {\n    // Lets define a new instance of a person struct\n    p := person{}\n\n    // The function, when called on a instance, works as expected\n    bob := p.constructor(&quot;Bob&quot;)\n\n    fmt.Printf(&quot;%+v\\n&quot;, bob)\n}\n</code></pre>\n<p>This illustrates that methods are attributed to an instance of a particular type.</p>\n"}], "owner": {"reputation": 41, "user_id": 4780955, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-x6VZfsNx5bY/AAAAAAAAAAI/AAAAAAAAQ80/Upuy-T4hutg/photo.jpg?sz=128", "display_name": "Gentry Rolofson", "link": "https://stackoverflow.com/users/4780955/gentry-rolofson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "accepted_answer_id": 39715965, "answer_count": 2, "score": -1, "last_activity_date": 1474952120, "creation_date": 1474940282, "last_edit_date": 1474952120, "question_id": 39714772, "link": "https://stackoverflow.com/questions/39714772/golang-method-expressions-instances-of-object", "title": "Golang: Method expressions instances of Object", "body": "<p>I'm trying to build a variadic function for a constructor in golang and I've ran into an interesting issue. This function is working...</p>\n\n<pre><code>package main\nimport \"fmt\"\ntype person struct {\n    name string\n}\n\n// This is working, but a really Not how I want to do this\nfunc personConstructor(params ...string) person {\n    name := \"Unnamed Person\" // Default name\n    if len(params) &gt; 0 {\n        name = params[0]\n    }\n    return person{name: name}\n}\n\nfunc main() {\n    bob := personConstructor(\"Bob\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/dcAdHEQtYz\" rel=\"nofollow\">https://play.golang.org/p/dcAdHEQtYz</a></p>\n\n<p>And yet this, isn't.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype person struct {\n    name string\n}\n\n// This isn't working\nfunc (p person) constructor(params ...string) person {\n    name := \"Unnamed Person\" // Default name\n    if len(params) &gt; 0 {\n        name = params[0]\n    }\n    return person{name: name}\n}\nfunc main() {\n    bob := person.constructor(\"Bob\")\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/YiTQctu-1A\" rel=\"nofollow\">https://play.golang.org/p/YiTQctu-1A</a></p>\n\n<p>Any idea as to why this is?</p>\n"}, {"tags": ["http", "file-upload", "go", "multipartform-data"], "answers": [{"comments": [{"owner": {"reputation": 519, "user_id": 266300, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/05d7b6c8aaeaa9999f19939896b83201?s=128&d=identicon&r=PG", "display_name": "Stanley", "link": "https://stackoverflow.com/users/266300/stanley"}, "edited": false, "score": 0, "creation_date": 1474985165, "post_id": 39726373, "comment_id": 66751002, "body": "Thanks JimB!  That was it!  I knew it had to be something simple. :D"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1474983924, "creation_date": 1474983924, "answer_id": 39726373, "question_id": 39713441, "link": "https://stackoverflow.com/questions/39713441/forwarding-a-file-upload/39726373#39726373", "title": "Forwarding a file upload", "body": "<p>You're not setting the <code>Content-Type</code> for the request. Even if the header gets set automatically to <code>multipart/form-data</code>, it's missing the data boundary. </p>\n\n<pre><code>req, err := http.NewRequest(\"POST\", uri, body)\nif err != nil {\n    return FileForwardedResponse{}, err\n}\nreq.Header.Set(\"Content-Type\", bodyWriter.FormDataContentType())\n...\n</code></pre>\n"}], "owner": {"reputation": 519, "user_id": 266300, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/05d7b6c8aaeaa9999f19939896b83201?s=128&d=identicon&r=PG", "display_name": "Stanley", "link": "https://stackoverflow.com/users/266300/stanley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 359, "favorite_count": 0, "accepted_answer_id": 39726373, "answer_count": 1, "score": 0, "last_activity_date": 1474983924, "creation_date": 1474929307, "last_edit_date": 1474935479, "question_id": 39713441, "link": "https://stackoverflow.com/questions/39713441/forwarding-a-file-upload", "title": "Forwarding a file upload", "body": "<p>I'm working on an api endpoint in go that will accept an upload and then immediately forward to another API.  I don't want to write the file to disk anywhere, but I'm not sure storing the file temporarily in memory the way I have is correct either.  All the examples that I can find deal with saving the file to disk.  I've posted what I'm doing below.  The response I get back from the second API is that I failed to post a file, but I can see that it is receiving the \"userID\" field.  Can someone please point out what I'm doing wrong as well as possibly advise if this is the best way to go about this?</p>\n\n<p>Route Handler</p>\n\n<pre><code>func (r *Routes) forwardFile(w http.ResponseWriter, req *http.Request){ \n    parameters := mux.Vars(req)\n    userID := parameters[\"userID\"]\n\n    const maxFileSize = 1 * 1024 * 1024 // 1MB\n\n    // pull in the uploaded file into memory\n    req.ParseMultipartForm(maxFileSize)\n\n\n    file, fileHeader, err := req.FormFile(\"fileUpload\")\n    if err != nil {\n        encodeResponse(w, req, response{obj: nil, err: err})\n        return\n    }\n    defer file.Close()\n\n    success, err := service.DoForwardFile(userID, file, fileHeader)\n    encodeResponse(w, req, response{obj: success, err: err})\n}\n</code></pre>\n\n<p>Service Handler</p>\n\n<pre><code>func (b *base) DoForwardFile(userID int, file multipart.File, fileHeader *multipart.FileHeader) (FileForwardedResponse, error) {\n    // start building our request to forward the file\n    var resp *http.Response\n    defer func() {\n        if resp != nil {\n            resp.Body.Close()\n        }\n        reportStat.Complete(0)\n    }()\n\n    // build a form body\n    body := &amp;bytes.Buffer{}\n    bodyWriter := multipart.NewWriter(body)\n\n    // add form fields\n    bodyWriter.WriteField(\"userID\", userID)\n\n    // add a form file to the body\n    fileWriter, err := bodyWriter.CreateFormFile(\"fileUpload\", fileHeader.Filename)\n    if err != nil {\n        return FileForwardedResponse{}, err\n    }\n    // copy the file into the fileWriter\n    _, err = io.Copy(fileWriter, file)\n    if err != nil {\n        return FileForwardedResponse{}, err\n    }\n\n    // Close the body writer\n    bodyWriter.Close()\n\n    // build request url\n    apiURL := fmt.Sprintf(\"%s/v2/users/%d/files\", config.APIURL, userID)\n\n    // send request\n    client := &amp;http.Client{Timeout: time.Second * 10}\n    req, err := http.NewRequest(\"POST\", apiURL, body)\n    resp, err = client.Do(req)\n\n    ... \n\n\n  }\n</code></pre>\n"}, {"tags": ["go", "protocol-buffers"], "comments": [{"owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "edited": false, "score": 0, "creation_date": 1474956958, "post_id": 39712915, "comment_id": 66732121, "body": "I found the cause of this, some of my code used the real google protobuf lib, some used the gogo protobuf lib. same api, different state storage..."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6211407, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f666aebe53a8ec143616cd9d543975b?s=128&d=identicon&r=PG", "display_name": "Mark Novikov", "link": "https://stackoverflow.com/users/6211407/mark-novikov"}, "is_accepted": false, "score": 1, "last_activity_date": 1549963775, "last_edit_date": 1549963775, "creation_date": 1549913060, "answer_id": 54637675, "question_id": 39712915, "link": "https://stackoverflow.com/questions/39712915/proto-messagename-returns-empty-string/54637675#54637675", "title": "proto.MessageName returns empty string", "body": "<p>No, type registry isn't cleared.</p>\n\n<p>Most probably you are using different implementations of <code>proto</code> package in your generated code, where <code>proto</code> package implementation choice is addressed by your proto code generator of choice. In your code you are actually trying to get <code>MessageName</code>.</p>\n\n<p>Each imported package in Go is initialized exactly one time during the go binary process lifetime. Each initialized package has it's own table of names (both exported and unexported) and their corresponding values. <code>proto</code> package in particular maintains so called \"registry\" of known proto message names and types. A bit simplified, registry is a package-scoped map associating message types with their corresponding names. This map is initialized and populated on package initialization. Then, to retrieve <code>MessageName</code> you access it indirectly through some helper function. The key point is, if you use different <code>proto</code> package implementations imported in your code, your generated code, or in your dependencies, then chances are, on app start you populate one registry, and then later on, you are trying to retrieve <code>MessageName</code> from some other registry that know nothing about it. The rule of thumb is to always use protoc code generator plugin, pregenerated proto type libraries, and <code>proto</code> package implementation from a single vendor through out your app.</p>\n\n<p>Most popular <code>proto</code> packages (I've never used or encountered any other) are <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">https://github.com/golang/protobuf</a> and <a href=\"https://github.com/gogo/protobuf\" rel=\"nofollow noreferrer\">https://github.com/gogo/protobuf</a>.\nDouble check your protoc generator plugin and package imports and I hope it'll be all fine.</p>\n"}], "owner": {"reputation": 20971, "user_id": 317384, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/be674120f51c26ee1091e887114a8e1a?s=128&d=identicon&r=PG", "display_name": "Roger Johansson", "link": "https://stackoverflow.com/users/317384/roger-johansson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 845, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1549963775, "creation_date": 1474926281, "last_edit_date": 1474926933, "question_id": 39712915, "link": "https://stackoverflow.com/questions/39712915/proto-messagename-returns-empty-string", "title": "proto.MessageName returns empty string", "body": "<p>I'm completely stuck on a problem with Protobuf in Go</p>\n\n<p>Given the following bit of code:</p>\n\n<pre><code>if proto.MessageName(&amp;messages.AddedItemEvent{}) == \"\" {\n    log.Fatal(\"empty\")\n}\n</code></pre>\n\n<p>This will evaluate to <code>true</code> and exit the application.\nWhat can possibly make protobuf return empty string on <code>MessageName</code>?\nI can see that the types and their names are registered as they should in the generated protobuf message code:</p>\n\n<pre><code>func init() {\n    proto.RegisterType((*AddItemCommand)(nil), \"messages.AddItemCommand\")\n    proto.RegisterType((*AddedItemEvent)(nil), \"messages.AddedItemEvent\")\n    proto.RegisterType((*RenameCommand)(nil), \"messages.RenameCommand\")\n    proto.RegisterType((*RenamedEvent)(nil), \"messages.RenamedEvent\")\n    proto.RegisterType((*DumpCommand)(nil), \"messages.DumpCommand\")\n}\n</code></pre>\n\n<p>I have also verified that the above <code>init</code> actually runs, and it does.</p>\n\n<p>I have other generated proto messages, which returns their names as expected.\nSo what is going wrong here?</p>\n\n<p>Edit\nThe protofile looks like this</p>\n\n<pre><code>syntax = \"proto3\";\npackage messages;\n\n//user messages\nmessage AddItemCommand {\n  string item = 1;\n}\nmessage AddedItemEvent {\n  string item = 1;\n}\nmessage RenameCommand {\n  string name = 1;\n}\nmessage RenamedEvent {\n  string name = 1;\n}\nmessage DumpCommand {}\n</code></pre>\n\n<p>Edit again.\nManually calling \n    proto.RegisterType((*messages.AddedItemEvent)(nil), \"messages.AddedItemEvent\")</p>\n\n<p>From the <code>main</code> func, makes it work.\nSo somehow the type registry is cleared somewhere between the <code>messages.init</code> and <code>main</code></p>\n\n<p>Anyone?</p>\n"}, {"tags": ["html", "http", "go", "go-templates"], "answers": [{"tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 1, "last_activity_date": 1474920482, "creation_date": 1474920482, "answer_id": 39711522, "question_id": 39711287, "link": "https://stackoverflow.com/questions/39711287/how-to-set-different-content-types-when-using-html-template-package-in-go/39711522#39711522", "title": "How to set different content types when using HTML/TEMPLATE package in Go", "body": "<p>Templating i.e. generating the HTML which is the body of the HTTP response is totally decoupeled from the content type which is transmitted via a HTTP header. Just set the Content-Type to whatever is appropriate <em>before</em> generating the body via <code>tmpl.Execute(w, ...)</code> :</p>\n\n<pre><code>w.Header().Set(\"Content-Type\", \"text/css\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 1, "creation_date": 1474922243, "post_id": 39711557, "comment_id": 66721950, "body": "Thank you! This was extremely informative! I manually served my .css style sheet separately for now (and it works now!) but I am currently reading ParseFiles and ParseGlob in the specs to do this elegantly as you suggest."}, {"owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "edited": false, "score": 1, "creation_date": 1474922921, "post_id": 39711557, "comment_id": 66722325, "body": "Thanks for also pointing out the need to avoid parsing inside my handler. I will review."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1516282607, "last_edit_date": 1516282607, "creation_date": 1474920649, "answer_id": 39711557, "question_id": 39711287, "link": "https://stackoverflow.com/questions/39711287/how-to-set-different-content-types-when-using-html-template-package-in-go/39711557#39711557", "title": "How to set different content types when using HTML/TEMPLATE package in Go", "body": "<p><a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow noreferrer\"><code>Template.Execute()</code></a> will \"deliver\" the content by calling the <code>Write()</code> method of the passed <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow noreferrer\"><code>io.Writer</code></a> which in your case is the <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow noreferrer\"><code>http.ResponseWriter</code></a>.</p>\n\n<p>If you don't set the content type prior to the first call to <code>ResponseWriter.Write()</code> (you don't in your example), then the <a href=\"https://golang.org/pkg/net/http/\" rel=\"nofollow noreferrer\"><code>net/http</code></a> package will attempt to detect the content type (based on the first 512 bytes written), and will set it automatically for you (along with <code>WriteHeader(http.StatusOK)</code> if <code>ResponseWriter.WriteHeader()</code> has not been called).</p>\n\n<p>This is documented at <code>http.ResponseWriter.Write()</code>:</p>\n\n<pre><code>// Write writes the data to the connection as part of an HTTP reply.\n//\n// If WriteHeader has not yet been called, Write calls\n// WriteHeader(http.StatusOK) before writing the data. If the Header\n// does not contain a Content-Type line, Write adds a Content-Type set\n// to the result of passing the initial 512 bytes of written data to\n// DetectContentType.\n//\n// ...\nWrite([]byte) (int, error)\n</code></pre>\n\n<p>So if your <code>index.html</code> would look like this:</p>\n\n<pre><code>&lt;html&gt;\n  &lt;body&gt;\n    This is the body!\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p>Then this would be properly detected as an HTML document and thus <code>text/html</code> content type would be automatically set. If this doesn't happen for you, that means your <code>index.html</code> is not recognized as an HTML document. So just make sure you make your template files valid HTML / CSS / etc. documents and content type will be inferred automatically and properly.</p>\n\n<p>Also note that if it wouldn't work in some \"extreme\" cases, you can always \"override\" it by manually setting it prior to calling <code>Template.Execute()</code> like this:</p>\n\n<pre><code>w.Header().Set(\"Content-Type\", \"text/html\")\ntempl.Execute(w, Message)\n</code></pre>\n\n<p>Side note: don't read and parse templates inside your handlers, for details see related question: <a href=\"https://stackoverflow.com/questions/28451675/it-takes-too-much-time-when-using-template-package-to-generate-a-dynamic-web-p\">It takes too much time when using &quot;template&quot; package to generate a dynamic web page to client in golang</a></p>\n\n<hr>\n\n<p>If a template served by you references other templates, they will not be magically loaded and executed. In such cases you should have a \"pre-loaded\" templates containing all the templates. <a href=\"https://golang.org/pkg/html/template/#ParseFiles\" rel=\"nofollow noreferrer\"><code>template.ParseFiles()</code></a> and <a href=\"https://golang.org/pkg/html/template/#ParseGlob\" rel=\"nofollow noreferrer\"><code>template.ParseGlob()</code></a> are good \"tools\" to load multiple template files at once.</p>\n\n<p>So if your <code>index.html</code> references <code>style.css</code>, then you have to take care about serving <code>style.css</code> too. If it is not a template (but e.g. a static file), you may serve it using multiple options presented here: <a href=\"https://stackoverflow.com/questions/28899675/include-js-file-in-go-template\">Include js file in Go template</a></p>\n\n<p>If it is also a template, then you also have to load it and serve it by calling <a href=\"https://golang.org/pkg/html/template/#Template.ExecuteTemplate\" rel=\"nofollow noreferrer\"><code>Template.ExecuteTemplate()</code></a>.</p>\n\n<p>An example solution would be to load both using <code>template.ParseFiles()</code>, and use the path to \"designate\" which template you want to have served (from the client / browser side).</p>\n\n<p>E.g. requesting the path <code>/hello/index.html</code> could serve the <code>\"index.html\"</code> template, requesting the path <code>/hello/style.css</code> (<em>this will be done automatically by the browser after receiving and processing the <code>index.html</code></em>) could serve the <code>\"style.css\"</code> template. It could look like this (error checks omitted for brevity):</p>\n\n<pre><code>parts := strings.Split(req.URL.Path, \"/\") // Parts of the path\ntemplName := parts[len(parts)-1]          // The last part\ntempl.ExecuteTemplate(w, templName, someDataForTemplate)\n</code></pre>\n"}], "owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2677, "favorite_count": 1, "accepted_answer_id": 39711557, "answer_count": 2, "score": 5, "last_activity_date": 1516282607, "creation_date": 1474919687, "last_edit_date": 1478460744, "question_id": 39711287, "link": "https://stackoverflow.com/questions/39711287/how-to-set-different-content-types-when-using-html-template-package-in-go", "title": "How to set different content types when using HTML/TEMPLATE package in Go", "body": "<p>When trying to pass a value into <code>.html</code> code I'm using the <code>html/template</code> package.</p>\n\n<p>However, I can't seem to set the <code>.css</code> content type that is referenced in my <code>.html</code> file. It is being served to the browser as plain text and thus formatting is ignored.</p>\n\n<p>In a static <code>.html</code> file I can use the built-in <code>http.Fileserver</code> which takes care of content types but then templating doesn't work. I can't pass in the variable. It just displays as <code>{{.}}</code></p>\n\n<p>Is there a way to combine the <code>content-type</code> convenience of the built-in fileserver <code>http.Fileserver</code> with the template ability of <code>http.HandleFunc</code>?</p>\n\n<p>Here is my code as it stands without using <code>http.Fileserver</code>. Note, my <code>Go</code> file is in the starting directory and the <code>index.html</code> and <code>.css</code> files are in a subdirectory <code>/hello/</code>:</p>\n\n<pre><code>package main\n\nimport (\n        \"html/template\"\n        \"io/ioutil\"\n        \"log\"\n        \"net/http\"\n)\n\nvar Message string = \"test page\"\n\nfunc servePipe(w http.ResponseWriter, req *http.Request) {\n\n        dat, err := ioutil.ReadFile(\"hello/index.html\")\n        if err != nil {\n                log.Fatal(\"couldn't read file:\", err)\n        }   \n\n        templ, err := template.New(\"Test\").Parse(string(dat))\n\n        if err != nil {\n                log.Fatal(\"couldn't parse page:\", err)\n        }   \n\n        templ.Execute(w, Message)\n\n}\n\nfunc main() {\n\n        http.HandleFunc(\"/hello/\", servePipe)\n        http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Here is my <code>.html</code> file. The html page is being served without any issues. It's the separate <code>.css</code> file that is not being served (linked in the <code>.html</code> file) thus the formatting doesn't occur.</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;title&gt;Test Page&lt;/title&gt;\n\n        &lt;link rel=\"stylesheet\" type=\"text/css\" href=\"style.css\"/&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n        &lt;p&gt;{{.}}&lt;/p&gt;\n\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["go", "tcp", "ftp"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1474918300, "post_id": 39710874, "comment_id": 66719692, "body": "This is how TCP works. You need some higher level protocol to determine if the connection closed early."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474922578, "post_id": 39710874, "comment_id": 66722131, "body": "@JimB is right. TCP is a &quot;streaming&quot; protocol that streams bytes, not a packet/block based protocol."}, {"owner": {"reputation": 45534, "user_id": 106104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/c88b9310b92a937108ec4336c2832f92?s=128&d=identicon&r=PG", "display_name": "user253751", "link": "https://stackoverflow.com/users/106104/user253751"}, "edited": false, "score": 0, "creation_date": 1474967260, "post_id": 39710874, "comment_id": 66738550, "body": "Well, how does Go know the EOF is unexpected?"}], "answers": [{"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 1, "last_activity_date": 1474923856, "creation_date": 1474923856, "answer_id": 39712365, "question_id": 39710874, "link": "https://stackoverflow.com/questions/39710874/when-all-i-get-is-eof-from-a-net-tcpconn-how-do-i-know-if-the-connection-has-be/39712365#39712365", "title": "when all I get is EOF from a net.TCPConn, how do I know if the connection has been dropped?", "body": "<p>TCP is a streaming protocol; a stream of bytes. That's why file transfer protocols invented/implemented upon TCP, like FTP (File Transfer Protocol).</p>\n\n<p>But (not recommended/thought experiment) if you can send your files in chunks that does not contain a certain character/byte (like base64 + \\n as that certain character), then you can use that certain character as delimiter.</p>\n\n<p>Now if we handle our connections using a function similar to this:</p>\n\n<pre><code>func (srv *Server) handler(conn net.Conn) {\n    //...\n\n    defer srv.closeConnection(conn, nil)\n\n    reader := bufio.NewReader(conn)\n    writer := bufio.NewWriter(conn)\n\n    //...\n\n    conn.SetDeadline(time.Now().Add(conf.ClientTimeout))\n\n    for {\n        select {\n        case &lt;-conf.QuitSignal:\n            return\n        default:\n            line, err := reader.ReadBytes('\\n')\n            if err != nil {\n                return\n            }\n\n            //...\n        }\n\n        conn.SetDeadline(time.Now().Add(conf.ClientTimeout))\n    }\n}\n\nfunc (srv *Server) closeConnection(conn net.Conn, err error) {\n    conn.Close()\n    //...\n}\n</code></pre>\n\n<p>From the documentation of <code>Reader.ReadBytes</code> we read <em>ReadBytes returns err != nil <strong>if and only if</strong> the returned data does not end in delimiter</em>. This way we can recognize a broken chunk.</p>\n"}], "owner": {"reputation": 4263, "user_id": 148736, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/98ce675339d7e7c8269349943d6a0823?s=128&d=identicon&r=PG", "display_name": "Andrew Arrow", "link": "https://stackoverflow.com/users/148736/andrew-arrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1744, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474923856, "creation_date": 1474918195, "question_id": 39710874, "link": "https://stackoverflow.com/questions/39710874/when-all-i-get-is-eof-from-a-net-tcpconn-how-do-i-know-if-the-connection-has-be", "title": "when all I get is EOF from a net.TCPConn, how do I know if the connection has been dropped?", "body": "<p>The godocs say:</p>\n\n<p>\"EOF is the error returned by Read when no more input is available. Functions should return EOF only to signal a graceful end of input. If the EOF occurs unexpectedly in a structured data stream, the appropriate error is either ErrUnexpectedEOF or some other error giving more detail.\"</p>\n\n<p>and in my program I would <code>love</code> love to get ErrUnexpectedEOF, but I don't. I always get just EOF even when the client terminates in the middle of sending a file.</p>\n\n<p>so, i'm stuck. Successful files that transfer 100% of the way thru send EOF at end. And files that quit 50% thru with error also send EOF as the error. I do not know the total size of the file before the transfer.</p>\n\n<p>Is there any more information I could get from the net.TCPConn to know was this a full file or not?</p>\n"}, {"tags": ["go", "struct", "import"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1474917206, "post_id": 39710558, "comment_id": 66719112, "body": "Could just be an incomplete example but <code>product = Product{Name: &quot;Shoes&quot;}</code> isn&#39;t a valid statement so you may be misinterpreting the error. You need to use <code>:=</code> in that assignment because <code>product</code> isn&#39;t previously declared."}], "answers": [{"comments": [{"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1474917868, "post_id": 39710634, "comment_id": 66719457, "body": "if I import the models folder with the <code>.</code> preceding the import and used the struct <code>Post</code> in the following method <code>func (p *Post) All(){fmt.Println(&quot;foo&quot;)}</code> it still shows up undefined though??"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 1, "creation_date": 1474917957, "post_id": 39710634, "comment_id": 66719509, "body": "@ColleenLarsen Using &quot;dot-import&quot; is not recommended (only for testing purposes) because whether it works or not depends on how and from where you try to compile/run the code."}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1474918446, "post_id": 39710634, "comment_id": 66719788, "body": "Ok using the same method having removed the <code>.</code> on the import as <code>func (p *models.Post)</code> the <code>models</code> is undefined for some reason?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1474918682, "post_id": 39710634, "comment_id": 66719942, "body": "@ColleenLarsen Your <code>product.go</code> must be in <code>$GOPATH&#47;src&#47;models</code>."}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1474920950, "post_id": 39710634, "comment_id": 66721217, "body": "I have updated the question,  with the path to models correctly represented. but I still get the error"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1474921158, "post_id": 39710634, "comment_id": 66721340, "body": "@ColleenLarsen Then please post your &quot;file system view&quot;, meaning what files you have and in what folders. Most likely you have them in the wrong folder."}, {"owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "edited": false, "score": 0, "creation_date": 1474975870, "post_id": 39710634, "comment_id": 66744379, "body": "@icza The import was successful, so the problem is probably that he is importing the wrong package."}, {"owner": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "reply_to_user": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 1, "creation_date": 1474976061, "post_id": 39710634, "comment_id": 66744520, "body": "@ColleenLarsen, the name of the imported library is the last part of your import path, which seems to be <code>product</code> not <code>model</code>."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1288, "user_id": 1876626, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e81a0d90315dfb0b3f64c0936a34699e?s=128&d=identicon&r=PG", "display_name": "Joonazan", "link": "https://stackoverflow.com/users/1876626/joonazan"}, "edited": false, "score": 0, "creation_date": 1474978198, "post_id": 39710634, "comment_id": 66745934, "body": "@Joonazan Your right, he edited the wrong package path into my answer later. Fixed it."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 8, "last_activity_date": 1474978111, "last_edit_date": 1495541966, "creation_date": 1474917341, "answer_id": 39710634, "question_id": 39710558, "link": "https://stackoverflow.com/questions/39710558/how-to-access-a-struct-from-an-external-package-in-go/39710634#39710634", "title": "How to access a struct from an external package in Go", "body": "<p>In Go you import \"complete\" <em>packages</em>, not functions or types from packages.<br>\n(See this related question for more details: <a href=\"https://stackoverflow.com/questions/38904423/whats-cs-using-equivalent-in-golang\">What&#39;s C++&#39;s `using` equivalent in golang</a>)</p>\n\n<p>See <a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">Spec: Import declarations</a> for syntax and deeper explanation of the <code>import</code> keyword and import declarations.</p>\n\n<p>Once you import a package, you may refer to its <a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow noreferrer\">exported identifiers</a> with <a href=\"https://golang.org/ref/spec#Qualified_identifiers\" rel=\"nofollow noreferrer\">qualified identifiers</a> which has the form: <code>packageName.Identifier</code>.</p>\n\n<p>So your example could look like this:</p>\n\n<pre><code>import \"path/to/models/product\"\nimport \"fmt\"\n\nfunc main() {\n    p := product.Product{Name: \"Shoes\"}\n    // Use product, e.g. print it:\n    fmt.Println(p) // This requires `import \"fmt\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8159, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1541620408, "creation_date": 1474917022, "last_edit_date": 1541620408, "question_id": 39710558, "link": "https://stackoverflow.com/questions/39710558/how-to-access-a-struct-from-an-external-package-in-go", "title": "How to access a struct from an external package in Go", "body": "<p>I'm trying to import a struct from another package in the following file:</p>\n\n<pre><code>// main.go\nimport \"path/to/models/product\"    \nproduct = Product{Name: \"Shoes\"}\n\n// models/product.go\ntype Product struct{\n Name string\n}\n</code></pre>\n\n<p>But in the <code>main.go</code> file the struct <code>Product</code> is undefined. How do I import the struct?</p>\n"}, {"tags": ["c", "go", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474911881, "post_id": 39708874, "comment_id": 66716147, "body": "If you read the documentation under that, there will be a <code>_cgo_export.h </code> generated with the type <code>GoString</code> which you can use. It looks like: <code>typedef struct { const char *p; GoInt n; } GoString</code>"}], "answers": [{"comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474911299, "post_id": 39708992, "comment_id": 66715876, "body": "I think OP was asking, how can one call a Go function that only accepts Go strings. But I guess creating a wrapper function is one way to do it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474911380, "post_id": 39708992, "comment_id": 66715907, "body": "@Ainar-G: good point, I should have have just waited for the comment reply ;)"}, {"owner": {"reputation": 33, "user_id": 6882955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ah1rs.jpg?s=128&g=1", "display_name": "Joe Perks", "link": "https://stackoverflow.com/users/6882955/joe-perks"}, "edited": false, "score": 0, "creation_date": 1474911518, "post_id": 39708992, "comment_id": 66715968, "body": "This works!  When I tried this while troubleshooting I incorrectly used <code>str *C.Char</code>, resulting in the error <code>could not determine kind of name for C.Char</code>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 33, "user_id": 6882955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ah1rs.jpg?s=128&g=1", "display_name": "Joe Perks", "link": "https://stackoverflow.com/users/6882955/joe-perks"}, "edited": false, "score": 0, "creation_date": 1474912017, "post_id": 39708992, "comment_id": 66716209, "body": "@JoePrvacy See my answer if you actually need <code>str</code> to be <code>string</code>."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1474911195, "creation_date": 1474911195, "answer_id": 39708992, "question_id": 39708874, "link": "https://stackoverflow.com/questions/39708874/call-go-function-with-string-parameter-from-c/39708992#39708992", "title": "Call Go function with string parameter from C?", "body": "<p>A string in C is a <code>*C.char</code>, not a Go <code>string</code>.\nHave your exported function accept the correct C type, and convert it as necessary in Go:</p>\n\n<pre><code>//export GoFunction\nfunc GoFunction(str *C.char) {\n    fmt.Println(\"Hello from GoFunction!\")\n    fmt.Println(C.GoString(str))\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 33, "user_id": 6882955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ah1rs.jpg?s=128&g=1", "display_name": "Joe Perks", "link": "https://stackoverflow.com/users/6882955/joe-perks"}, "edited": false, "score": 1, "creation_date": 1474912850, "post_id": 39709166, "comment_id": 66716675, "body": "Thanks much! I upvoted but it won&#39;t show on the counter since I am low rep."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1474911836, "creation_date": 1474911836, "answer_id": 39709166, "question_id": 39708874, "link": "https://stackoverflow.com/questions/39708874/call-go-function-with-string-parameter-from-c/39709166#39709166", "title": "Call Go function with string parameter from C?", "body": "<p>If you want to pass a C string to a function that accepts only Go strings, you can use <code>GoString</code> type on the C side:</p>\n\n<pre><code>char message[] = \"Hello World from CFunction!\";\nprintf(\"CFunction says: %s\\n\", message);\nGoString go_str = {p: message, n: sizeof(message)}; // N.B. sizeof(message) will\n                                                    // only work for arrays, not\n                                                    // pointers.\nGoFunction(go_str);\nreturn 0;\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 6882955, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ah1rs.jpg?s=128&g=1", "display_name": "Joe Perks", "link": "https://stackoverflow.com/users/6882955/joe-perks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2531, "favorite_count": 0, "accepted_answer_id": 39708992, "answer_count": 2, "score": 3, "last_activity_date": 1474911836, "creation_date": 1474910782, "question_id": 39708874, "link": "https://stackoverflow.com/questions/39708874/call-go-function-with-string-parameter-from-c", "title": "Call Go function with string parameter from C?", "body": "<p>I can call a Go function without parameters from C, <a href=\"https://github.com/joeprivacy/crefgo_hello_world\" rel=\"nofollow\">per below</a>. This compiles via <code>go build</code> and prints</p>\n\n<p><code>Hello from Golang main function!\nCFunction says: Hello World from CFunction!\nHello from GoFunction!</code></p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\n//extern int CFunction();\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n  fmt.Println(\"Hello from Golang main function!\")\n  //Calling a CFunction in order to have C call the GoFunction\n  C.CFunction();\n}\n\n//export GoFunction\nfunc GoFunction() {\n  fmt.Println(\"Hello from GoFunction!\")\n}\n</code></pre>\n\n<p><strong>file1.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"_cgo_export.h\"\n\nint CFunction() {\n  char message[] = \"Hello World from CFunction!\";\n  printf(\"CFunction says: %s\\n\", message);\n  GoFunction();\n  return 0;\n}\n</code></pre>\n\n<p>Now, I want to pass a string/char array from C to GoFunction.</p>\n\n<p>According to \"C references to Go\" in the <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">cgo documentation</a> this is possible, so I add a string parameter to GoFunction and pass the char array <code>message</code> to GoFunction:</p>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\n//extern int CFunction();\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n  fmt.Println(\"Hello from Golang main function!\")\n  //Calling a CFunction in order to have C call the GoFunction\n  C.CFunction();\n}\n\n//export GoFunction\nfunc GoFunction(str string) {\n  fmt.Println(\"Hello from GoFunction!\")\n}\n</code></pre>\n\n<p><strong>file1.c</strong></p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"_cgo_export.h\"\n\nint CFunction() {\n  char message[] = \"Hello World from CFunction!\";\n  printf(\"CFunction says: %s\\n\", message);\n  GoFunction(message);\n  return 0;\n}\n</code></pre>\n\n<p>Upon <code>go build</code> I receive this error:</p>\n\n<p><code>./file1.c:7:14: error: passing 'char [28]' to parameter of incompatible type 'GoString'\n./main.go:50:33: note: passing argument to parameter 'p0' here</code></p>\n\n<p>Other references:\n<code>https://blog.golang.org/c-go-cgo</code> (not enough reputation to post 3 links)\nAccording to the \"strings and things\" section of the above blog post: \"Conversion between Go and C strings is done with the C.CString, C.GoString, and C.GoStringN functions.\" but these are for use in Go, and not helpful if I want to pass string data into Go.</p>\n"}, {"tags": ["loops", "go", "go-templates", "go-iris"], "comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 2, "creation_date": 1474903677, "post_id": 39706336, "comment_id": 66711467, "body": "What error message do you get?"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1474904420, "post_id": 39706336, "comment_id": 66711949, "body": "Show the definition of <code>prodcont</code>. Also, have you tried <code>{{for post := range .Posts}}</code>?"}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1474906264, "post_id": 39706336, "comment_id": 66713104, "body": "Hi thanks, I have added the error message and the <code>prodcont</code> struct"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474907167, "post_id": 39706336, "comment_id": 66713583, "body": "@ColleenLarsen Try <code>{{for post := range .List}}</code>."}, {"owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "edited": false, "score": 0, "creation_date": 1474907659, "post_id": 39706336, "comment_id": 66713850, "body": "I still get the same error <code>template: template&#47;admin_template.html:61:7: executing &quot;template&#47;admin_template.html&quot; at &lt;yield&gt;: error calling yield: html&#47;template: &quot;admin&#47;post&#47;index.html&quot; is an incomplete template</code>"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474910556, "post_id": 39706336, "comment_id": 66715482, "body": "Something is wrong in the other template. Seems like your layout template is bad."}], "answers": [{"tags": [], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "is_accepted": false, "score": 2, "last_activity_date": 1474914948, "creation_date": 1474914948, "answer_id": 39709988, "question_id": 39706336, "link": "https://stackoverflow.com/questions/39706336/how-to-range-through-a-slice-of-structs-in-the-iris-go-framework/39709988#39709988", "title": "How to range through a slice of structs in the Iris Go framework?", "body": "<p>Fixed the problem by removing <code>for post :=</code> in the following example with <code>{{range .List}}</code></p>\n\n<pre><code> {{range .List}}\n&lt;tr&gt;\n    &lt;td&gt;&lt;input class=\"checkbox\" type=\"checkbox\" name=\"category\" value=\"\"&gt;&lt;/td&gt;\n    &lt;td&gt;{{.Id}}&lt;/td&gt;\n    &lt;td&gt;{{.Title}}&lt;/td&gt;\n    &lt;td&gt;{{.Slug}}&lt;/td&gt;\n\n&lt;/tr&gt;\n{{end}}\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 750, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1527045339, "creation_date": 1474902515, "last_edit_date": 1527045339, "question_id": 39706336, "link": "https://stackoverflow.com/questions/39706336/how-to-range-through-a-slice-of-structs-in-the-iris-go-framework", "title": "How to range through a slice of structs in the Iris Go framework?", "body": "<p>I am trying to range through a slice of structs in iris the golang web framework as follows.</p>\n\n<pre><code>type prodcont struct{\nList []Post\n}\n\n\ntype Post struct{\n    Id int\n    Title string\n    Slug string\n    ShortDescription string\n    Content string\n}\n\nvar Posts = []Post{\n    Post{content ommitted}\n }   \n\n\n //GET categories\nfunc IndexPost(c *iris.Context){\n    c.Render(\"admin/post/index.html\", prodcont{Posts}, iris.RenderOptions{\"gzip\": true})\n}\n\n\n    &lt;table class=\"table table-striped table-bordered\"&gt;\n        &lt;thead&gt;\n            &lt;thead&gt;\n                table head...\n            &lt;/thead&gt;\n        &lt;/thead&gt;\n        &lt;tbody&gt;\n   {{run range here}}\n    &lt;tr&gt;\n        &lt;td&gt;{{post.Id}}&lt;/td&gt;\n        &lt;td&gt;{{post.Title}}&lt;/td&gt;\n        &lt;td&gt;{{post.Slug}}&lt;/td&gt;\n        &lt;td&gt;{{post.Shortdescription}}&lt;/td&gt;\n        &lt;td&gt;{{post.Content}}&lt;/td&gt;\n    &lt;/tr&gt;\n    {{end}}\n        &lt;/tbody&gt;\n    &lt;/table&gt;\n</code></pre>\n\n<p>I have tried <code>{{range .}}</code> , <code>{{for _posts := range Posts}}</code> .etc which have not worked?</p>\n\n<p>Here is the error I get</p>\n\n<pre><code>template: template/admin_template.html:61:7: executing \"template/admin_template.html\" at &lt;yield&gt;: error calling yield: html/template: \"admin/post/index.html\" is an incomplete template\n</code></pre>\n\n<p>How would I be able to range through a slice of structs as seen above effectively in the Go Iris framework?\nThanks</p>\n"}, {"tags": ["go", "oauth-2.0", "google-oauth", "refresh-token"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1474910699, "post_id": 39705151, "comment_id": 66715556, "body": "What oauth2.AccessType have you used when you make the request for redirect url ?"}], "answers": [{"tags": [], "owner": {"reputation": 66, "user_id": 10784676, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/385b5eccc1280813b9f8f920419ae925?s=128&d=identicon&r=PG&f=1", "display_name": "yebowhatsay", "link": "https://stackoverflow.com/users/10784676/yebowhatsay"}, "is_accepted": false, "score": 0, "last_activity_date": 1613217272, "creation_date": 1613217272, "answer_id": 66184816, "question_id": 39705151, "link": "https://stackoverflow.com/questions/39705151/golang-oauth-client-and-refresh-token/66184816#66184816", "title": "Golang OAuth client and refresh token", "body": "<p>The following function in the &quot;golang.org/x/oauth2&quot; package auto-refreshes the token as necessary.</p>\n<p><code>func (*oauth2.Config).Client(ctx context.Context, t *oauth2.Token) *http.Client</code></p>\n<p><a href=\"https://pkg.go.dev/golang.org/x/oauth2#Config.Client\" rel=\"nofollow noreferrer\">https://pkg.go.dev/golang.org/x/oauth2#Config.Client</a></p>\n"}], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1088, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1613217272, "creation_date": 1474899013, "question_id": 39705151, "link": "https://stackoverflow.com/questions/39705151/golang-oauth-client-and-refresh-token", "title": "Golang OAuth client and refresh token", "body": "<p>I have configured Go with OAuth against Google. I am then using the access token to do requests against gmail api, contacts api, drive api etc etc. These need the string that is the actual access token, as opposed to the object <code>*oauth2.Token</code>.</p>\n\n<p>Everything works while the access token is valid. Once its not valid, I can't access the data. This makes sense as I need to use the refresh token to get a new access token, before doing the queries against the services.</p>\n\n<p>My understanding is the <code>*http.Client</code> that you create from the OAuth token will do the refresh for a new access token if its necessary, automatically.</p>\n\n<p>However what I am not sure about is how to get the latest access token out of the client to then use as part of the <code>GET</code> request against Google APIs to auth the service.</p>\n\n<p>So to summarize:</p>\n\n<pre><code>//generate client\n//get accessToken.AccessToken from client\n//do HTTP GET request to get a users image from contact api (or something)\n//pass as either a GET parameter, or as a header the access token\n</code></pre>\n\n<p>If the client handles refreshing the token, then I need to use the client to get the access token so its valid. \nHow do you do that? I've looked into using <code>config.TokenSource(ctx, tok)</code> and then i can call TokenSource on that, but that doesn't need the client and therefore the token is not refreshed as far as I can tell.</p>\n"}, {"tags": ["go", "blockchain", "hyperledger", "hyperledger-fabric"], "comments": [{"owner": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1474895374, "post_id": 39703420, "comment_id": 66705565, "body": "kind have a look, <a href=\"https://github.com/hyperledger-archives/fabric/pull/2001\" rel=\"nofollow noreferrer\">github.com/hyperledger-archives/fabric/pull/2001</a>"}, {"owner": {"reputation": 337, "user_id": 4071894, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/890bc72ab1a0898c2002c3b22609faed?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousWaffle", "link": "https://stackoverflow.com/users/4071894/mysteriouswaffle"}, "reply_to_user": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1474896999, "post_id": 39703420, "comment_id": 66706804, "body": "I&#39;m afraid I don&#39;t see how I can find the name of a user from this? - it just seems to say that it&#39;s been removed...  (sorry if I&#39;m missing something obvious)"}, {"owner": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1474933107, "post_id": 39703420, "comment_id": 66725853, "body": "kindly read the answer i posted"}], "answers": [{"tags": [], "owner": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "is_accepted": false, "score": 0, "last_activity_date": 1474933082, "creation_date": 1474933082, "answer_id": 39713933, "question_id": 39703420, "link": "https://stackoverflow.com/questions/39703420/find-the-name-of-the-caller-in-hyperledger/39713933#39713933", "title": "Find the name of the caller in hyperledger", "body": "<p>This is totally intentional to exclude <code>enrollID</code> from the subject of transaction certificate this is because <code>tcerts</code> are used for <strong>unlinkability</strong>.</p>\n\n<p>You can read <a href=\"https://github.com/hyperledger-archives/fabric/issues/1409\" rel=\"nofollow\">this</a> for more information.</p>\n"}], "owner": {"reputation": 337, "user_id": 4071894, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/890bc72ab1a0898c2002c3b22609faed?s=128&d=identicon&r=PG&f=1", "display_name": "MysteriousWaffle", "link": "https://stackoverflow.com/users/4071894/mysteriouswaffle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 351, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474933082, "creation_date": 1474894400, "question_id": 39703420, "link": "https://stackoverflow.com/questions/39703420/find-the-name-of-the-caller-in-hyperledger", "title": "Find the name of the caller in hyperledger", "body": "<p>How would I find the name of the user invoking chaincode in hyperledger?</p>\n\n<p>in v0.5 this information was included in the transaction certificate however in v0.6 the 'common name' attribute has been changed to just say \"Transaction Certificate\" - the name has been removed.</p>\n"}, {"tags": ["go", "sqlx"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 37, "last_activity_date": 1474894555, "creation_date": 1474894555, "answer_id": 39703481, "question_id": 39702192, "link": "https://stackoverflow.com/questions/39702192/sqlx-non-struct-dest-type-struct-with-1-columns-2/39703481#39703481", "title": "sqlx - non-struct dest type struct with &gt;1 columns (2)", "body": "<p>It works if you export your fields:</p>\n\n<pre><code>type Film struct {\n    Code int\n    Name string\n}\n</code></pre>\n\n<p>Notice the uppercase (<code>Code</code>, not <code>code</code>).</p>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6759, "favorite_count": 0, "accepted_answer_id": 39703481, "answer_count": 1, "score": 18, "last_activity_date": 1597984907, "creation_date": 1474890957, "question_id": 39702192, "link": "https://stackoverflow.com/questions/39702192/sqlx-non-struct-dest-type-struct-with-1-columns-2", "title": "sqlx - non-struct dest type struct with &gt;1 columns (2)", "body": "<p>I have searched the error and I have find two questions:</p>\n\n<ul>\n<li><a href=\"https://stackoverflow.com/questions/24487943/invoke-golang-struct-function-gives-cannot-refer-to-unexported-field-or-method\">This one</a>, but my question is not duplicate  of it</li>\n<li><a href=\"https://stackoverflow.com/questions/28710974/non-struct-dest-type-struct-with-1-columns\">And this one</a>, but there is no answer in this question.</li>\n</ul>\n\n<p>Here is my code:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n\n    \"github.com/jmoiron/sqlx\"\n\n    _ \"github.com/lib/pq\"\n)\n\nvar schema = `\nCREATE TABLE films (\n  code int,\n  name VARCHAR(10)\n)`\n\ntype Film struct {\n    code int\n    name string\n}\n\nfunc main() {\n    db, err := sqlx.Open(\"postgres\", \"user=demas password=root host=192.168.99.100 port=32768 dbname=mydb sslmode=disable\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    db.MustExec(schema)\n\n    tx := db.MustBegin()\n    tx.MustExec(\"INSERT INTO films(code, name) VALUES($1, $2)\", 10, \"one\")\n    tx.MustExec(\"INSERT INTO films(code, name) VALUES($1, $2)\", 20, \"two\")\n    tx.Commit()\n\n    films := []Film{}\n    err = db.Select(&amp;films, \"SELECT * FROM public.films\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n}\n</code></pre>\n\n<p>It creates table and insert 2 records, but can not return them back:</p>\n\n<pre><code>\u03bb go run main.go\n2016/09/26 14:46:04 non-struct dest type struct with &gt;1 columns (2)\nexit status 1\n</code></pre>\n\n<p>How can I fix it ?</p>\n"}, {"tags": ["go", "hyperledger", "hyperledger-fabric"], "answers": [{"comments": [{"owner": {"reputation": 566, "user_id": 2571544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ced17debdbc0793f64f913f0c96378c?s=128&d=identicon&r=PG&f=1", "display_name": "shimron", "link": "https://stackoverflow.com/users/2571544/shimron"}, "edited": false, "score": 0, "creation_date": 1474898144, "post_id": 39701671, "comment_id": 66707728, "body": "I don&#39;t think so. The official api docs say: &quot;The CreateCertificatePair function allows a user to create and read their enrollment certificate pair. For this, the user has to do two successive invocations of this function.&quot;  pls check  <a href=\"http://hyperledger-fabric.readthedocs.io/en/latest/API/MemberServicesAPI/\" rel=\"nofollow noreferrer\">hyperledger-fabric.readthedocs.io/en/latest/API/&hellip;</a>"}, {"owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "reply_to_user": {"reputation": 566, "user_id": 2571544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ced17debdbc0793f64f913f0c96378c?s=128&d=identicon&r=PG&f=1", "display_name": "shimron", "link": "https://stackoverflow.com/users/2571544/shimron"}, "edited": false, "score": 1, "creation_date": 1474924483, "post_id": 39701671, "comment_id": 66723076, "body": "Next phrase from the same document - &quot;Firstly, both the signature and encryption public keys have to be handed to the ECA together with the one-time password previously returned by the RegisterUser function invocation.&quot; the one-time password cannot be used again in second login attempt."}, {"owner": {"reputation": 566, "user_id": 2571544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ced17debdbc0793f64f913f0c96378c?s=128&d=identicon&r=PG&f=1", "display_name": "shimron", "link": "https://stackoverflow.com/users/2571544/shimron"}, "edited": false, "score": 0, "creation_date": 1474945377, "post_id": 39701671, "comment_id": 66728480, "body": "actually, the second call used a new token.    out, err :=ecies.Process(resp.Tok.Tok) req.Tok.Tok = out"}, {"owner": {"reputation": 566, "user_id": 2571544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ced17debdbc0793f64f913f0c96378c?s=128&d=identicon&r=PG&f=1", "display_name": "shimron", "link": "https://stackoverflow.com/users/2571544/shimron"}, "edited": false, "score": 0, "creation_date": 1474945476, "post_id": 39701671, "comment_id": 66728499, "body": "besides, if I use the one-time password twice, the message will be &quot;identity or token not match&quot;"}], "tags": [], "owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "is_accepted": false, "score": 0, "last_activity_date": 1474889425, "creation_date": 1474889425, "answer_id": 39701671, "question_id": 39701198, "link": "https://stackoverflow.com/questions/39701198/enroll-member-request-fails-with-signature-verification/39701671#39701671", "title": "enroll member request fails with signature verification", "body": "<p>CreateCertificatePair requests the creation of a new enrolment certificate pair by the ECA.\n\"enrolment\" certificate is unique and can be created just once per user by ECA </p>\n\n<p>Second call to <code>CreateCertificatePair</code> for the same user will lead to error.</p>\n"}, {"comments": [{"owner": {"reputation": 566, "user_id": 2571544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ced17debdbc0793f64f913f0c96378c?s=128&d=identicon&r=PG&f=1", "display_name": "shimron", "link": "https://stackoverflow.com/users/2571544/shimron"}, "edited": false, "score": 0, "creation_date": 1474898353, "post_id": 39702450, "comment_id": 66707901, "body": "well... the enrollUser function in the &quot;eca_test.go&quot; file, which do calls CreateCertificatePair twice. In addition, the official api docs also mention that &quot;The CreateCertificatePair function allows a user to create and read their enrollment certificate pair. For this, the user has to do two successive invocations of this function. &quot;  <a href=\"http://hyperledger-fabric.readthedocs.io/en/latest/API/MemberServicesAPI/\" rel=\"nofollow noreferrer\">hyperledger-fabric.readthedocs.io/en/latest/API/&hellip;</a>"}, {"owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "edited": false, "score": 1, "creation_date": 1474926878, "post_id": 39702450, "comment_id": 66724021, "body": "Just keep in mind that &quot;rm -rf /var/hyperledger/production&quot; will remove everything including ledger with all blocks in addition to certificates and keys..."}, {"owner": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1474932720, "post_id": 39702450, "comment_id": 66725768, "body": "Thanks Sergey for that.  the certificates however are located in the subdirectory <code>&#47;var&#47;hyperledger&#47;production&#47;crypto&#47;client&#47;</code> you can remove it instead if you want to keep your ledger and blocks."}, {"owner": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "edited": false, "score": 0, "creation_date": 1475250919, "post_id": 39702450, "comment_id": 66883832, "body": "you would still only be able to enroll once."}], "tags": [], "owner": {"reputation": 15819, "user_id": 1149423, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/KmNLc.png?s=128&g=1", "display_name": "Sufiyan Ghori", "link": "https://stackoverflow.com/users/1149423/sufiyan-ghori"}, "is_accepted": false, "score": 1, "last_activity_date": 1474893227, "last_edit_date": 1474893227, "creation_date": 1474891845, "answer_id": 39702450, "question_id": 39701198, "link": "https://stackoverflow.com/questions/39701198/enroll-member-request-fails-with-signature-verification/39702450#39702450", "title": "enroll member request fails with signature verification", "body": "<p>As Sergey mentioned, <code>CreateCertificatePair</code> requests the creation of a new certificate pair,<br>\nand according to the documentation,</p>\n\n<p>During registration, the application sends a request to the certificate authority to verify the user registration and if successful, the CA responds with the user certificates and keys. </p>\n\n<p><strong>Upon successful user authentication, the application will perform user registration with the CA exactly once. If registration is attempted a second time for the same user, an error will result.</strong> \nThis is the reason why the second call to <code>CreateCertificatePair</code> is failing. \nIf you really want to register a user who has already been registered previously, you need to remove the temporary files ( the client enrollment certificate, enrollment key, transaction certificate chain, etc.) that were created by the CA server process, and to do that, run the following command,</p>\n\n<pre><code>rm -rf /var/hyperledger/production\n</code></pre>\n\n<p><code>/var/hyperledger/production</code> is the directory where the certificates received from CA are stored.</p>\n\n<p>Souce: <a href=\"https://github.com/hyperledger/fabric/blob/master/docs/Setup/Chaincode-setup.md#note-on-security-functionality\" rel=\"nofollow\">Note on security functionality</a></p>\n"}], "owner": {"reputation": 566, "user_id": 2571544, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/4ced17debdbc0793f64f913f0c96378c?s=128&d=identicon&r=PG&f=1", "display_name": "shimron", "link": "https://stackoverflow.com/users/2571544/shimron"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 274, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1474893227, "creation_date": 1474888017, "question_id": 39701198, "link": "https://stackoverflow.com/questions/39701198/enroll-member-request-fails-with-signature-verification", "title": "enroll member request fails with signature verification", "body": "<p>when I tried to enroll the \"admin\" user, the second call to CreateCertificatePair failed with the \"Signature verification failed\" message. BTW, I copied the enrollUser function from the eca_test.go. And those tests under membersrvc/ca package can be passed. </p>\n\n<pre><code>//Phase 2 of the protocol\nspi := ecies.NewSPI()\neciesKey, err := spi.NewPrivateKey(nil, encPriv)\nif err != nil {\n    return err\n}\n\necies, err := spi.NewAsymmetricCipherFromPublicKey(eciesKey)\nif err != nil {\n    return err\n}\n\nout, err := ecies.Process(resp.Tok.Tok)\nif err != nil {\n    return err\n}\n\nreq.Tok.Tok = out\nreq.Sig = nil\n\nhash := primitives.NewHash()\nraw, _ := proto.Marshal(req)\nhash.Write(raw)\n\nr, s, err := ecdsa.Sign(rand.Reader, signPriv, hash.Sum(nil))\nif err != nil {\n    return err\n}\nR, _ := r.MarshalText()\nS, _ := s.MarshalText()\nreq.Sig = &amp;pb.Signature{Type: pb.CryptoType_ECDSA, R: R, S: S}\n\nresp, err = ecapCient.CreateCertificatePair(context.Background(), req)\n</code></pre>\n"}, {"tags": ["xml", "parsing", "networking", "go", "xml-parsing"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1474893731, "last_edit_date": 1474893731, "creation_date": 1474891517, "answer_id": 39702362, "question_id": 39700817, "link": "https://stackoverflow.com/questions/39700817/golang-read-single-xml-document-from-net-conn/39702362#39702362", "title": "Golang: Read single XML document from net.Conn", "body": "<p>You may use <a href=\"https://golang.org/pkg/encoding/xml/#Decoder\" rel=\"nofollow\"><code>xml.Decoder</code></a> from the standard library for this purpose. You may use <a href=\"https://golang.org/pkg/encoding/xml/#NewDecoder\" rel=\"nofollow\"><code>xml.NewDecoder()</code></a> to create a new <code>xml.Decoder</code> which expects an <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow\"><code>io.Reader</code></a> to read the data from. <a href=\"https://golang.org/pkg/net/#Conn\" rel=\"nofollow\"><code>net.Conn</code></a> qualifies as it implements <code>io.Reader</code>. The <a href=\"https://golang.org/pkg/encoding/xml/#Decoder.Decode\" rel=\"nofollow\"><code>Decoder.Decode()</code></a> method will read and process 1 XML document.</p>\n\n<p>Let's see an example. The source will contain 2 XML documents concatenated, and we call <code>Decoder.Decode()</code> twice to read and parse those 2 documents.</p>\n\n<p>The XML source: 2 XML documents (2 <code>&lt;Person&gt;</code>):</p>\n\n<pre><code>const data = `&lt;Person&gt;\n    &lt;Name&gt;Bob&lt;/Name&gt;\n    &lt;Age&gt;23&lt;/Age&gt;\n&lt;/Person&gt;\n&lt;Person&gt;\n    &lt;Name&gt;Alice&lt;/Name&gt;\n    &lt;Age&gt;21&lt;/Age&gt;\n&lt;/Person&gt;\n`\n</code></pre>\n\n<p>Go struct to model the XML documents:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Age  int\n}\n</code></pre>\n\n<p>Code to read those 2 XML documents:</p>\n\n<pre><code>buf := bytes.NewBuffer([]byte(data))\nd := xml.NewDecoder(buf)\n\nfor i := 0; i &lt; 2; i++ {\n    p := Person{}\n    if err := d.Decode(&amp;p); err != nil {\n        fmt.Println(err)\n    } else {\n        fmt.Printf(\"%+v\\n\", p)\n    }\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/6gxDi5v9FK\" rel=\"nofollow\">Go Playground</a>):</p>\n\n<pre><code>{Name:Bob Age:23}\n{Name:Alice Age:21}\n</code></pre>\n\n<p>Note that <code>Decoder.Decode()</code> will return <code>io.EOF</code> if no more data is available. To read all XML documents from the input, you may do it like this:</p>\n\n<pre><code>for {\n    p := Person{}\n    if err := d.Decode(&amp;p); err != nil {\n        if err == io.EOF {\n            fmt.Println(\"EOF, breaking\")\n            break\n        }\n        fmt.Println(err)\n    } else {\n        fmt.Printf(\"%+v\\n\", p)\n    }\n}\n</code></pre>\n\n<h3>Back to your example</h3>\n\n<p>If you want to read XML documents transmitted over a TCP connection, you may simply pass the <code>net.Conn</code> value (which implements <code>io.Reader</code>) to <code>xml.NewDecoder()</code>:</p>\n\n<pre><code>var con net.Conn\n// Initialize / obtain connection\n\nd := xml.NewDecoder(con)\nvar doc YourDocType\nif err := d.Decode(&amp;doc); err != nil {\n    // Handle error\n    return\n}\n// No error, use doc:\nfmt.Printf(\"%+v\", doc)\n</code></pre>\n"}], "owner": {"reputation": 1101, "user_id": 4254425, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/232cb0401b3c3e7b28959cf0606742c5?s=128&d=identicon&r=PG", "display_name": "Viacheslav Kroilov", "link": "https://stackoverflow.com/users/4254425/viacheslav-kroilov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 2, "accepted_answer_id": 39702362, "answer_count": 1, "score": 1, "last_activity_date": 1474893731, "creation_date": 1474886841, "question_id": 39700817, "link": "https://stackoverflow.com/questions/39700817/golang-read-single-xml-document-from-net-conn", "title": "Golang: Read single XML document from net.Conn", "body": "<p>I have a client-server connection. They communicate through xml and multiple xml documents are transmitted during one session. <code>xml.Unmarshal</code> wants a slice of bytes, but I can't just <code>ReadAll</code> all bytes from socket (it will try to read more then a single xml and therefore block). </p>\n\n<p><strong>Is there a standard xml parser or a library, that can parse from a stream of bytes and read no more data than it actually needs?</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474886641, "post_id": 39700671, "comment_id": 66699645, "body": "func(p *path) { ... (*p)[i] = ... }"}], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5183303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3252e71f0e21ce04d70acc60556b202c?s=128&d=identicon&r=PG&f=1", "display_name": "location", "link": "https://stackoverflow.com/users/5183303/location"}, "edited": false, "score": 0, "creation_date": 1474887332, "post_id": 39700862, "comment_id": 66700040, "body": "i was running it in the sandbox so it tells me. tmp/sandbox605541423/main.go:21: invalid operation: p[i] (type *path does not support indexing)"}, {"owner": {"reputation": 39, "user_id": 5183303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3252e71f0e21ce04d70acc60556b202c?s=128&d=identicon&r=PG&f=1", "display_name": "location", "link": "https://stackoverflow.com/users/5183303/location"}, "edited": false, "score": 0, "creation_date": 1474887385, "post_id": 39700862, "comment_id": 66700072, "body": "@abhnik one question why we&#39;re dereferencing (*p) using parentheses ?"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "reply_to_user": {"reputation": 39, "user_id": 5183303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3252e71f0e21ce04d70acc60556b202c?s=128&d=identicon&r=PG&f=1", "display_name": "location", "link": "https://stackoverflow.com/users/5183303/location"}, "edited": false, "score": 0, "creation_date": 1474893094, "post_id": 39700862, "comment_id": 66703968, "body": "That is because of operator precedence. The indexing operator <code>[]</code> have a higher precedence than dereference operator <code>*</code>. So without the parentheses, <code>*p[i]</code> will try to index <code>p</code> directly, which is a pointer type value and does not support indexing. With parentheses, <code>p</code> is dereferenced first through application of <code>*</code> and then the resultant value, which is a slice, is indexed by the <code>[]</code>. This is also the reason you were getting the <i>(type *path does not support indexing)</i> error."}], "tags": [], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "is_accepted": false, "score": 1, "last_activity_date": 1474886974, "creation_date": 1474886974, "answer_id": 39700862, "question_id": 39700671, "link": "https://stackoverflow.com/questions/39700671/from-blog-golang-arrays-slices-and-strings/39700862#39700862", "title": "From blog golang arrays slices and strings", "body": "<p>Since <code>path</code> is a type defined on a <code>[]byte</code> which happens to be a slice, there is no need to use a pointer receiver since slice types are already reference types.</p>\n\n<p>However, if a pointer receiver is required, you'll need to dereference the pointer value everywhere in your method to get the underlying slice value:</p>\n\n<pre><code>func (p *path) ToUpper() {\n    for i, b := range *p { // dereference p with a * to get the\n                           // underlying []byte slice\n        if 'a' &lt;= b &amp;&amp; b &lt;= 'z' {\n            (*p)[i] = b + 'A' - 'a' // derefernce p here as well\n        }\n    }\n}\n</code></pre>\n\n<p>Working code: <a href=\"https://play.golang.org/p/feqeAlb80z\" rel=\"nofollow\">https://play.golang.org/p/feqeAlb80z</a></p>\n"}], "owner": {"reputation": 39, "user_id": 5183303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3252e71f0e21ce04d70acc60556b202c?s=128&d=identicon&r=PG&f=1", "display_name": "location", "link": "https://stackoverflow.com/users/5183303/location"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474886974, "creation_date": 1474886384, "question_id": 39700671, "link": "https://stackoverflow.com/questions/39700671/from-blog-golang-arrays-slices-and-strings", "title": "From blog golang arrays slices and strings", "body": "<pre><code>type path []byte\n\nfunc (p path) ToUpper() {\n    for i, b := range p {\n        if 'a' &lt;= b &amp;&amp; b &lt;= 'z' {\n            p[i] = b + 'A' - 'a'\n        }\n    }\n}\n\nfunc main() {\n    pathName := path(\"/usr/bin/tso\")\n    pathName.ToUpper()\n    fmt.Printf(\"%s\\n\", pathName)\n}\n</code></pre>\n\n<p>[Exercise: Convert the ToUpper method to use a pointer receiver and see if its behavior changes.]<br>\nhow to use a pointer method ? i have tried to dereference *p and tried to delete i from range but it keeps saying mismatched types.</p>\n"}, {"tags": ["go", "google-cloud-platform", "gmail-api"], "answers": [{"comments": [{"owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "edited": false, "score": 1, "creation_date": 1474898574, "post_id": 39703060, "comment_id": 66708065, "body": "Hmm I was doing this, it turned out, that if you are not responding with a success (200, 204 etc) Google continues to try as far as I can see, indefinately to get a success from your server. So even after a <code>stop()</code> it was continuing to push.... Fixed now..."}], "tags": [], "owner": {"reputation": 81718, "user_id": 3617886, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/y26OT.jpg?s=128&g=1", "display_name": "Tholle", "link": "https://stackoverflow.com/users/3617886/tholle"}, "is_accepted": false, "score": 1, "last_activity_date": 1474893503, "creation_date": 1474893503, "answer_id": 39703060, "question_id": 39700619, "link": "https://stackoverflow.com/questions/39700619/gmail-api-pub-sub-push-not-stopping/39703060#39703060", "title": "Gmail API Pub/Sub Push not stopping", "body": "<p>You also have to send a request to <a href=\"https://developers.google.com/gmail/api/v1/reference/users/stop\" rel=\"nofollow\">stop watching</a> the user's mailbox:</p>\n\n<pre><code>POST https://www.googleapis.com/gmail/v1/users/me/stop?access_token={access_token}\n</code></pre>\n"}], "owner": {"reputation": 2849, "user_id": 1414721, "user_type": "registered", "accept_rate": 21, "profile_image": "https://www.gravatar.com/avatar/1fa39b39445863fdb74031c89f5e0e3e?s=128&d=identicon&r=PG", "display_name": "amlwwalker", "link": "https://stackoverflow.com/users/1414721/amlwwalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 226, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474893503, "creation_date": 1474886250, "question_id": 39700619, "link": "https://stackoverflow.com/questions/39700619/gmail-api-pub-sub-push-not-stopping", "title": "Gmail API Pub/Sub Push not stopping", "body": "<p>I am developing with the Gmail API, and everything is working, I can authorize a user account to Push emails to my endpoint and send the next History ID.\nThe issue is with removing the account. I have deleted the account from the Google Cloud Platform, I have removed the app from Account/Settings/Connected Apps and Sites from within Gmail, however something is STILL pushing updates to my web server. I can see the request coming in and not being authorized, but it never the less is still pushing. How do I stop it in Gmail???</p>\n\n<p>I receive this on my server:</p>\n\n<pre><code>2016/09/26 10:34:30 [D] [server.go:2202] | 503 |  41.984725ms|   match|  POST    /push   r:/push\nd:  {user@name.com 2776948}\ncurrent user:  user@name.com\nlast history id:  2776700\ndoing error:  Get https://www.googleapis.com/gmail/v1/users/me/history?alt=json&amp;startHistoryId=2776700: oauth2: cannot fetch token: 401 Unauthorized\nResponse: {\n  \"error\" : \"deleted_client\",\n  \"error_description\" : \"The OAuth client was deleted.\"\n}\n</code></pre>\n\n<p>So the client is revoked, but the push still occurs. Verry weird...</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 39, "user_id": 5183303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3252e71f0e21ce04d70acc60556b202c?s=128&d=identicon&r=PG&f=1", "display_name": "location", "link": "https://stackoverflow.com/users/5183303/location"}, "edited": false, "score": 0, "creation_date": 1474882465, "post_id": 39698929, "comment_id": 66696863, "body": "this helped me, i was a bit confused."}], "tags": [], "owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "is_accepted": false, "score": 1, "last_activity_date": 1474881393, "creation_date": 1474881393, "answer_id": 39698929, "question_id": 39698436, "link": "https://stackoverflow.com/questions/39698436/golang-blog-slices-and-internals/39698929#39698929", "title": "Golang blog slices and internals", "body": "<p><a href=\"https://play.golang.org/p/Asc4v08wDO\" rel=\"nofollow\">https://play.golang.org/p/Asc4v08wDO</a></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\n// Filter returns a new slice holding only\n// the elements of s that satisfy f()\nfunc Filter(s []int, fn func(int) bool) []int {\n    var p []int // == nil\n    for _, v := range s {\n        if fn(v) {\n            p = append(p, v)\n        }\n    }\n    return p\n}\n\nfunc odd(i int) bool {\n    return i%2 != 0\n}\n\nfunc even(i int) bool {\n    return !odd(i)\n}\n\nfunc main() {\n    v := []int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}\n\n    fmt.Println(Filter(v, odd))\n    fmt.Println(Filter(v, even))\n}\n</code></pre>\n"}], "owner": {"reputation": 39, "user_id": 5183303, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3252e71f0e21ce04d70acc60556b202c?s=128&d=identicon&r=PG&f=1", "display_name": "location", "link": "https://stackoverflow.com/users/5183303/location"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 86, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1474881393, "creation_date": 1474879978, "question_id": 39698436, "link": "https://stackoverflow.com/questions/39698436/golang-blog-slices-and-internals", "title": "Golang blog slices and internals", "body": "<pre><code>// Filter returns a new slice holding only\n// the elements of s that satisfy f()\nfunc Filter(s []int, fn func(int) bool) []int {\n    var p []int // == nil\n    for _, v := range s {\n        if fn(v) {\n            p = append(p, v)\n        }\n    }\n    return p\n}\n</code></pre>\n\n<p>I have no i idea how to use this function, any help would be appreciated.</p>\n"}, {"tags": ["mongodb", "dictionary", "go", "struct", "mgo"], "comments": [{"owner": {"reputation": 2836, "user_id": 1359163, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/063e1984ad8cb19353c311ba3a9290b9?s=128&d=identicon&r=PG", "display_name": "KBN", "link": "https://stackoverflow.com/users/1359163/kbn"}, "edited": false, "score": 0, "creation_date": 1474878782, "post_id": 39697851, "comment_id": 66694574, "body": "Your keys in the map are going to be <code>string</code> right? Use <code>map[string]interface{}</code>. Or if you&#39;re certain of the data type (i.e. your value is always string, just use <code>map[string]string</code>)"}], "answers": [{"tags": [], "owner": {"reputation": 3587, "user_id": 580709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/04b8519613c122e8f395187d27eb5bef?s=128&d=identicon&r=PG&f=1", "display_name": "CrazyCrow", "link": "https://stackoverflow.com/users/580709/crazycrow"}, "is_accepted": true, "score": 3, "last_activity_date": 1474886697, "last_edit_date": 1474886697, "creation_date": 1474886222, "answer_id": 39700613, "question_id": 39697851, "link": "https://stackoverflow.com/questions/39697851/need-help-to-storing-an-map-of-type-interface-in-my-mongodb-database-using-golan/39700613#39700613", "title": "Need help to storing an map of type interface in my mongodb database using golang", "body": "<p>You can use nothing but <code>string</code> as key in MongoDB documents. Even if you would define your <code>Data</code> structure as <code>map[int]interface{}</code> Mongo (don't know if <code>mgo</code> will convert types) wouldn't allow you to insert this object into the database. Actually, you can use nothing but <code>string</code> as JSON key at all as this wouldn't be JSON (try in your browser console the next code <code>JSON.parse('{2:\"number\"}')</code>).</p>\n\n<p>So define your <code>Data</code> as <code>bson.M</code> (shortcut for <code>map[string]interface{}</code>) and use <code>strconv</code> package to convert your numbers into strings.</p>\n\n<p>But I guess you must look at arrays/slices, as only one reason why someone may need to have numbers as keys in JSON is iterations through these fields in future. And for iterations we use arrays.</p>\n\n<p><em>Update: just checked how <code>mgo</code> deals with <code>map[int]interface{}</code>. It inserts into DB entry like <code>{\"&lt;int Value&gt;\" : \"hello\"}</code>. Where <code>&lt;int Value&gt;</code> is not number but actually <a href=\"http://i.imgur.com/BgSsnSe.png\" rel=\"nofollow\">string <code>&lt;int Value&gt;</code></a></em></p>\n"}], "owner": {"reputation": 157, "user_id": 5024301, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/836491216400010/picture?type=large", "display_name": "Rajesh Kumar", "link": "https://stackoverflow.com/users/5024301/rajesh-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2689, "favorite_count": 0, "accepted_answer_id": 39700613, "answer_count": 1, "score": 1, "last_activity_date": 1474886697, "creation_date": 1474878018, "question_id": 39697851, "link": "https://stackoverflow.com/questions/39697851/need-help-to-storing-an-map-of-type-interface-in-my-mongodb-database-using-golan", "title": "Need help to storing an map of type interface in my mongodb database using golang", "body": "<p>I m in the process of creating application where my back end is in go lang and database is mongoDB. My problem is that  i have a map in my struct declared like </p>\n\n<pre><code>Data struct {\n        data   map[interface{}]interface{}\n}\n</code></pre>\n\n<p>after adding values in to this like</p>\n\n<pre><code>var data Data\n    data[\"us\"]=\"country\"\n    data[2]=\"number\"\n    data[\"mother\"]=\"son\"\n</code></pre>\n\n<p>I m inserting it like</p>\n\n<pre><code>c.Insert(&amp;data)\n</code></pre>\n\n<p>When i insert this i m losing my key  and can only see the values...</p>\n\n<pre><code>{\n    \"_id\" : Object Id(\"57e8d9048c1c6f751ccfaf50\"),\n    \"data\" : {\n        \"&lt;interface {} Value&gt;\" : \"country\",\n        \"&lt;interface {} Value&gt;\" : \"number\",\n        \"&lt;interface {} Value&gt;\" : \"son\"\n    },\n\n}\n</code></pre>\n\n<p>May i know any way possible to use interface and get both  key and values in my mongoDB. Thanks....</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "edited": false, "score": 0, "creation_date": 1474982908, "post_id": 39697386, "comment_id": 66749335, "body": "This can be used for getting VM information. We cannot get xenserver information. Thanks for your response."}], "tags": [], "owner": {"reputation": 19574, "user_id": 350294, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/uPBSX.jpg?s=128&g=1", "display_name": "Alex Pliutau", "link": "https://stackoverflow.com/users/350294/alex-pliutau"}, "is_accepted": false, "score": 0, "last_activity_date": 1474876356, "creation_date": 1474876356, "answer_id": 39697386, "question_id": 39696418, "link": "https://stackoverflow.com/questions/39696418/how-to-get-xen-server-memory-disk-network-and-cpu-information-using-golang/39697386#39697386", "title": "How to get xen server memory, disk, network and CPU information using golang?", "body": "<p>Is it different from other servers? If not - there a a bunch of Go packages to do it, I am using this one - <a href=\"https://github.com/c9s/goprocinfo\" rel=\"nofollow\">https://github.com/c9s/goprocinfo</a></p>\n"}], "owner": {"reputation": 593, "user_id": 4273375, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/394947ca0e4bf377dacf12d32a424671?s=128&d=identicon&r=PG&f=1", "display_name": "Test admin", "link": "https://stackoverflow.com/users/4273375/test-admin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1474876356, "creation_date": 1474872795, "question_id": 39696418, "link": "https://stackoverflow.com/questions/39696418/how-to-get-xen-server-memory-disk-network-and-cpu-information-using-golang", "title": "How to get xen server memory, disk, network and CPU information using golang?", "body": "<p>how to get xen server memory, disk, network and cpu informations using golang?</p>\n\n<p>Is there any packages available for this?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 4, "creation_date": 1474872674, "post_id": 39696318, "comment_id": 66691264, "body": "Check <code>err</code> after calling <code>Query</code>."}, {"owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "reply_to_user": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1474872925, "post_id": 39696318, "comment_id": 66691406, "body": "Thanks, it helps me"}], "answers": [{"tags": [], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "is_accepted": false, "score": 0, "last_activity_date": 1475178802, "creation_date": 1475178802, "answer_id": 39778869, "question_id": 39696318, "link": "https://stackoverflow.com/questions/39696318/panic-when-i-am-trying-to-connect-to-postgresql/39778869#39778869", "title": "Panic when I am trying to connect to Postgresql", "body": "<p>As hobbs said, you're not checking the error on your db.Query.</p>\n\n<p>Also, defer a db.Close() after you check errors there. Make sure to check an error before you preform any action on rows. If it returns an error, you're not going to also get a 'rows' back. So rows is nil. </p>\n"}], "owner": {"reputation": 40088, "user_id": 205270, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/Q5hW8.jpg?s=128&g=1", "display_name": "demas", "link": "https://stackoverflow.com/users/205270/demas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 85, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1475178802, "creation_date": 1474872455, "last_edit_date": 1474885838, "question_id": 39696318, "link": "https://stackoverflow.com/questions/39696318/panic-when-i-am-trying-to-connect-to-postgresql", "title": "Panic when I am trying to connect to Postgresql", "body": "<p>I have a simple program:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"log\"\n\n    _ \"github.com/lib/pq\"\n)\n\nfunc main() {\n    db, err := sql.Open(\"postgres\", \"user=demas password=pass host=192.168.99.100 port=32768 dbname=mydb sslmode=disabled\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    var name string\n    rows, err := db.Query(\"select name from films\")\n    for rows.Next() {\n        err = rows.Scan(&amp;name)\n        if err != nil {\n            log.Fatal(err)\n        }\n        log.Printf(\"Subject is %s\", name)\n    }\n}\n</code></pre>\n\n<p>When I try to run it I get the error:</p>\n\n<pre><code>\u03bb go run main.go\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xc0000005 code=0x0 addr=0x20 pc=0x460b2d]\n\ngoroutine 1 [running]:\npanic(0x5d02a0, 0xc0420040c0)\n        G:/scoop/apps/go/1.7.1/src/runtime/panic.go:500 +0x1af\ndatabase/sql.(*Rows).Next(0x0, 0x607fa6)\n        G:/scoop/apps/go/1.7.1/src/database/sql/sql.go:1752 +0x2d\nmain.main()\n        D:/dev_experiments/go-db1/main.go:18 +0x116\nexit status 2\n</code></pre>\n\n<p>How can I fix it ?</p>\n"}, {"tags": ["go", "google-cloud-storage"], "comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1474878334, "post_id": 39695802, "comment_id": 66694321, "body": "Its not go related  issue ,  try this <a href=\"https://cloud.google.com/storage/docs/gsutil/commands/versioning\" rel=\"nofollow noreferrer\">cloud.google.com/storage/docs/gsutil/commands/versioning</a>"}, {"owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1474878642, "post_id": 39695802, "comment_id": 66694492, "body": "@MIkCode : So, Are you proposing me to do that manually ? I am creating the buckets at the time of User Registration so I need to do that in code itself and looking for a solution in Golang only."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1474878733, "post_id": 39695802, "comment_id": 66694550, "body": "Are you going to create a bucket per user ?"}, {"owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1474878939, "post_id": 39695802, "comment_id": 66694660, "body": "@MIkCode : Yes, I am planning to do that."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1474879356, "post_id": 39695802, "comment_id": 66694934, "body": "dont do that , there   is a rate limit for creating buckets . you need to create Main bucket and for each user a folder . BUCKET/User1/file3 ,BUCKET/User2/... ,BUCKET/User3/.. check this best practices  <a href=\"https://cloud.google.com/storage/docs/best-practices\" rel=\"nofollow noreferrer\">cloud.google.com/storage/docs/best-practices</a>"}], "answers": [{"tags": [], "owner": {"reputation": 555, "user_id": 7139558, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b141dea1cc0deb6ac5bb52d2541cc8f4?s=128&d=identicon&r=PG&f=1", "display_name": "tevanraj", "link": "https://stackoverflow.com/users/7139558/tevanraj"}, "is_accepted": false, "score": 0, "last_activity_date": 1580814472, "creation_date": 1580814472, "answer_id": 60056041, "question_id": 39695802, "link": "https://stackoverflow.com/questions/39695802/how-to-enable-bucket-versioning-on-google-cloud-storage-bucket-using-golang/60056041#60056041", "title": "How to enable bucket versioning on Google Cloud Storage bucket using Golang?", "body": "<p>You can try this to GET where it tells you whether versioning is enabled.</p>\n\n<pre><code>gsutil versioning get gs://bucket_name\n</code></pre>\n\n<p>Can try this SET on or off the versioning of the bucket.</p>\n\n<pre><code>gsutil versioning set on gs://bucket_name\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 12879566, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/0cad7f3f60daa73428d5bf8e68491392?s=128&d=identicon&r=PG", "display_name": "user12879566", "link": "https://stackoverflow.com/users/12879566/user12879566"}, "is_accepted": false, "score": 0, "last_activity_date": 1581432028, "creation_date": 1581432028, "answer_id": 60171369, "question_id": 39695802, "link": "https://stackoverflow.com/questions/39695802/how-to-enable-bucket-versioning-on-google-cloud-storage-bucket-using-golang/60171369#60171369", "title": "How to enable bucket versioning on Google Cloud Storage bucket using Golang?", "body": "<p>this seems to work:</p>\n\n<pre><code>client.Bucket(\"bucket\").Update(ctx, storage.BucketAttrsToUpdate{VersioningEnabled: true})\n</code></pre>\n"}], "owner": {"reputation": 2022, "user_id": 2752896, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/6HtSo.jpg?s=128&g=1", "display_name": "Nikhil Maheshwari", "link": "https://stackoverflow.com/users/2752896/nikhil-maheshwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 655, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1581432028, "creation_date": 1474870398, "question_id": 39695802, "link": "https://stackoverflow.com/questions/39695802/how-to-enable-bucket-versioning-on-google-cloud-storage-bucket-using-golang", "title": "How to enable bucket versioning on Google Cloud Storage bucket using Golang?", "body": "<p>I am working on a project where I need to enable versioning of bucket on Google Cloud Storage using Golang. To be more specific :</p>\n\n<ol>\n<li>How to enable versioning on Already created bucket ?</li>\n<li>How to enable versioning on new buckets ?</li>\n</ol>\n\n<p><strong>Note :</strong> I have already googled and gone through the documentation of Google Cloud Platform and found the code example of versioning in Java only. Even I have explored the package \"cloud.google.com/go/storage\" to understand the code but no help.</p>\n\n<p>I am using below library and functions in my code to update buckets :</p>\n\n<pre><code>    import \"cloud.google.com/go/storage\"\n\n    func configureStorage(bucketID string) (*storage.BucketHandle, error) {\n        ctx := context.Background()\n        client, err := storage.NewClient(ctx)\n        if err != nil {\n            log.Printf(\"An error happened: %v\", err)\n            return nil, err\n        }\n        return client.Bucket(bucketID), nil\n    }\n\n    func saveFileToStorage(bucketID string, fileName string, contentType string, file multipart.File) {\n        StorageBucket, err := configureStorage(bucketID)\n\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        if StorageBucket == nil {\n            log.Printf(\"Storage Bucket is nil\")\n            return\n        }\n\n        ctx := context.Background()\n\n        wr := StorageBucket.Object(fileName).NewWriter(ctx)\n        wr.ACL = []storage.ACLRule{{Entity: storage.AllUsers, Role: storage.RoleReader}}\n        wr.ContentType = contentType\n\n        // Entries are immutable, be aggressive about caching (1 day).\n        wr.CacheControl = \"public, max-age=86400\"\n\n        if _, err := io.Copy(wr, file); err != nil {\n            log.Fatal(err)\n        }\n        if err := wr.Close(); err != nil {\n            log.Fatal(err)\n        }\n    }\n</code></pre>\n"}, {"tags": ["postgresql", "go"], "answers": [{"tags": [], "owner": {"reputation": 17562, "user_id": 568635, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/25f0758867b3f251cfdf101b9611b9b5?s=128&d=identicon&r=PG", "display_name": "Eelke", "link": "https://stackoverflow.com/users/568635/eelke"}, "is_accepted": true, "score": 3, "last_activity_date": 1474868235, "creation_date": 1474868235, "answer_id": 39695359, "question_id": 39695169, "link": "https://stackoverflow.com/questions/39695169/is-there-any-way-to-make-out-if-row-is-already-updated-postgresgolang/39695359#39695359", "title": "Is there any way to make out if row is already updated postgres:golang", "body": "<p>Yes just check in the where if the row needs updating.</p>\n\n<pre><code>UPDATE account SET status='deleted' \n  WHERE id= $1 AND status &lt;&gt; 'deleted'\n</code></pre>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25, "favorite_count": 0, "accepted_answer_id": 39695359, "answer_count": 1, "score": 0, "last_activity_date": 1474868235, "creation_date": 1474867288, "question_id": 39695169, "link": "https://stackoverflow.com/questions/39695169/is-there-any-way-to-make-out-if-row-is-already-updated-postgresgolang", "title": "Is there any way to make out if row is already updated postgres:golang", "body": "<p>I am using postgres as my database and <a href=\"https://github.com/lib/pq\" rel=\"nofollow\">https://github.com/lib/pq</a> as library.\nI am updating a record using prepared statement</p>\n\n<pre><code>stmt, _:= db.Prepare(\"UPDATE account set status='deleted' where id= $1\")   \ndefer stmt.Close()\nresult, _:= stmt.Exec(accountId)\nsuccess, _:= result.RowsAffected()\n</code></pre>\n\n<p>And I noticed that the even if the row is already updated with the status=deleted update query always returns success=1. Is there any way we can differentiate between already updated row and not yet updated row?</p>\n"}, {"tags": ["go", "beego", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 3409, "user_id": 2310989, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/034bf2e2ba137b4b6db19cea989150d1?s=128&d=identicon&r=PG", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/2310989/gaurav-pant"}, "edited": false, "score": 0, "creation_date": 1474912609, "post_id": 39705797, "comment_id": 66716526, "body": "@Diablojoe- Thanks for the response. But structure is bit different than you assumed. Please refer the json structure again."}, {"owner": {"reputation": 3409, "user_id": 2310989, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/034bf2e2ba137b4b6db19cea989150d1?s=128&d=identicon&r=PG", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/2310989/gaurav-pant"}, "edited": false, "score": 0, "creation_date": 1474940688, "post_id": 39705797, "comment_id": 66727524, "body": "@Diablojoe- I have added Try1 as new try after your guidance. Please have a look to it. It seems me that I should use struct rather than interface{} while converting jsone data to golang structure."}, {"owner": {"reputation": 3409, "user_id": 2310989, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/034bf2e2ba137b4b6db19cea989150d1?s=128&d=identicon&r=PG", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/2310989/gaurav-pant"}, "edited": false, "score": 0, "creation_date": 1474998613, "post_id": 39705797, "comment_id": 66760045, "body": "@Diablojoe- no problem.. I have tried with struct already .. that time as well I got the error. By the way whenever you have time please come up with the solution. It will be helpful."}], "tags": [], "owner": {"reputation": 191, "user_id": 4074586, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/30b8eaeb188788da55f046402d6e9277?s=128&d=identicon&r=PG&f=1", "display_name": "Diablojoe", "link": "https://stackoverflow.com/users/4074586/diablojoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1474995225, "last_edit_date": 1495541212, "creation_date": 1474900919, "answer_id": 39705797, "question_id": 39694331, "link": "https://stackoverflow.com/questions/39694331/beego-template-using-key-or-value-of-a-map-as-key-of-other-map-or-pass-it-to-t/39705797#39705797", "title": "beego template - using key or value of a map as key of other map or pass it to template function", "body": "<p>It looks like you are trying to access the internals of a map using a dot operator. Not knowing what the final result should look like makes this a little more difficult.</p>\n\n<p>I think this example will get you where you want to go for both questions: </p>\n\n<pre><code>{{ range $eachCategory, $subCategoriesList := .CategoryGroup }}\n&lt;li class=\"bold\"&gt;&lt;a class=\"collapsible-header  waves-effect waves-teal\"&gt;{{ $eachCategory }}&lt;/a&gt;\n      &lt;div class=\"collapsible-body\" style=\"\"&gt;\n        &lt;ul&gt;\n        {{ range $key, $val := index .CatAttributeMapping $eachCategory }}\n            &lt;li&gt;&lt;a id=\"{{ $key}}\" class='doc_cvt' href=\"#\"&gt;{{ $val.title }}&lt;/a&gt;&lt;/li&gt;\n        {{ end }}\n        &lt;/ul&gt;\n      &lt;/div&gt;\n&lt;/li&gt;\n{{ end }}\n</code></pre>\n\n<p>For more details on the index command check out:  <a href=\"http://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">http://golang.org/pkg/text/template/</a></p>\n\n<p>The key part being </p>\n\n<blockquote>\n  <p>index     Returns the result of indexing its first argument by the\n    following arguments. Thus \"index x 1 2 3\" is, in Go syntax,\n    x<a href=\"https://stackoverflow.com/questions/13593519/how-do-i-parse-an-inner-field-in-a-nested-json-object-in-golang\">1</a>[2][3]. Each indexed item must be a map, slice, or array.</p>\n</blockquote>\n\n<p>Beego is just using the golang base template system in most cases.</p>\n\n<p>Edit 1: You are asking a compound question so things get a little tricky. The first thing to figure out is if you are parsing the data correctly into a struct. If you are not doing that go will pass it into an interface for you to figure out how to deal with. From your code it looks like you are dealing with that sort of situation. </p>\n\n<p>So take it one problem at a time. <a href=\"https://stackoverflow.com/questions/13593519/how-do-i-parse-an-inner-field-in-a-nested-json-object-in-golang\">this is a great Q&amp;A that covers parsing nested structures in go</a></p>\n\n<p>I would encourage you to resubmit your question with different tags if you are still having problems. Submit one to golang json trying to get the parse correct and one to golang templates once you have verified the structs are properly set up.<br>\nFirst get your data into a struct then make it work with a template. I am sorry I do not have a copy paste solution for you but I am a little busy now. </p>\n\n<p>I will do what I can to come back to this question because I don't think that you are alone. Dealing with nested structs with the JSON parser and dealing with the templating engine can be difficult. We need to create more examples of how to do things!</p>\n"}], "owner": {"reputation": 3409, "user_id": 2310989, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/034bf2e2ba137b4b6db19cea989150d1?s=128&d=identicon&r=PG", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/2310989/gaurav-pant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 842, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474998360, "creation_date": 1474860993, "last_edit_date": 1474998360, "question_id": 39694331, "link": "https://stackoverflow.com/questions/39694331/beego-template-using-key-or-value-of-a-map-as-key-of-other-map-or-pass-it-to-t", "title": "beego template - using key or value of a map as key of other map or pass it to template function", "body": "<p>I am having below JSON structure.</p>\n\n<pre><code>func getJsonMappings() *string {\n    data := `{\n        \"CategoryGroup\": {\n            \"Category subgrp1\": [\"type1\", \"type2\"],\n\n        },\n        \"CategoryGroupDetail\" : {\n            \"type1\":{\n                \"extension\":\"abc\",\n                \"title\" : \"this is description\",\n                \"other\": \"i have some other details apart from above in this map\"\n                },\n            \"type2\" :{\n                \"extension\":\"abc\",\n                \"title\" : \"this is description\",\n                \"other\": \"i have some other details apart from above in this map\"\n                }\n        }\n\n        }`\nreturn &amp;data\n}\n</code></pre>\n\n<p>I am Unmarshalling above JSON to golang data-structure like below in controller function definition</p>\n\n<pre><code>func (this *MainPageController) Get() {\n      jsonData := getJsonMappings()\n\nvar catMapObj map[string]interface{}\n\nerr := json.Unmarshal([]byte(*jsonData), &amp;catMapObj)\nif err != nil {\n    panic(err.Error())\n}\n    this.Data[\"CategoryGroup\"] = catMapObj[\"CategoryGroup\"]\n    this.Data[\"CatAttributeMapping\"] = catMapObj[\"CatAttributeMapping\"]\n    this.TplName = \"index.tpl\"\n}\n</code></pre>\n\n<p>and trying to render below template.</p>\n\n<pre><code>&lt;ul class=\"collapsible collapsible-accordion\"&gt;\n    {{ range $eachCategory, $subCategoriesList := .CategoryGroup }}\n    &lt;li class=\"bold\"&gt;&lt;a class=\"collapsible-header  waves-effect waves-teal\"&gt;{{ $eachCategory }}&lt;/a&gt;\n          &lt;div class=\"collapsible-body\" style=\"\"&gt;\n            &lt;ul&gt;\n            {{ range $_, $subConvertorCategoryId := $subCategoriesList }}\n                &lt;li&gt;&lt;a id=\"{{ $subConvertorCategoryId }}\" class='doc_cvt' href=\"#\"&gt;{{ $subConvertorCategoryId|getCategoryTitle }}&lt;/a&gt;&lt;/li&gt;\n            {{ end }}\n            &lt;/ul&gt;\n          &lt;/div&gt;\n    &lt;/li&gt;\n    {{ end }}\n    &lt;/ul&gt;\n</code></pre>\n\n<p>where getCategoryTitle is template function. But I am not getting any value  for type variable as function parameter. My template function definition looks like</p>\n\n<pre><code>func GetCategoryTitle(type string) (title string) {\n.....\n}\n</code></pre>\n\n<p>if I hardcode the value  of \"type\" to \"type1\" inside the function then all looks good. But I want to sent the value from template at run time. At the same moment of time I am able to pass the value of \".CategoryGroup\" to template function.</p>\n\n<p>Hence my question is :</p>\n\n<p>1- How to pass key or value of map received while parsing template to golang template function?</p>\n\n<p>2- If you will look above structure closely then you will find that I need not to write the template function. I should get the value like \n{{ .CategoryGroupDetail.$subConvertorCategoryId.title }}. But I am not able to do so. I have did the same with django (python framework). There must be way to do the same in golang/beego as well.</p>\n\n<p>I am new to golang and Beego. Please guide me how to proceed further. </p>\n\n<p>Try1:</p>\n\n<pre><code>&lt;ul class=\"collapsible collapsible-accordion\"&gt;\n{{ range $eachCategory, $subCategoriesList := .CategoryGroup }}\n&lt;li class=\"bold\"&gt;&lt;a class=\"collapsible-header  waves-effect waves-teal\"&gt;{{ $eachCategory }}&lt;/a&gt;\n      &lt;div class=\"collapsible-body\" style=\"\"&gt;\n        &lt;ul&gt;\n        {{ range $_, $subConvertorCategoryId := $subCategoriesList }}\n        {{ $categoryDetail := index .CatAttributeMapping $subConvertorCategoryId}}\n            &lt;li&gt;&lt;a id=\"{{ $subConvertorCategoryId }}\" class='doc_cvt' href=\"#\"&gt;{{ $categoryDetail.title }}&lt;/a&gt;&lt;/li&gt;\n        {{ end }}\n        &lt;/ul&gt;\n      &lt;/div&gt;\n&lt;/li&gt;\n{{ end }}\n</code></pre>\n\n<p>I am getting below error at run time -</p>\n\n<pre><code>template: index.tpl:38:32: executing \"index.tpl\" at &lt;.CatAttributeMapping&gt;: can't evaluate field CatAttributeMapping in type interface {}\n</code></pre>\n"}, {"tags": ["go", "google-sheets", "google-oauth"], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "edited": false, "score": 0, "creation_date": 1474890227, "post_id": 39696517, "comment_id": 66701916, "body": "Actually, the sheet is public available, no registration need... Still same result."}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "reply_to_user": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "edited": false, "score": 0, "creation_date": 1474890528, "post_id": 39696517, "comment_id": 66702137, "body": "I just checked the documentation you need to authenticate public isn&#39;t gong to work."}, {"owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "edited": false, "score": 0, "creation_date": 1474891592, "post_id": 39696517, "comment_id": 66702878, "body": "I think I will use Go API for this because managing all of this stuff like refresh tokens etc, would be rather complicated for me.  I would love the simplicity of Put request.."}, {"owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "reply_to_user": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "edited": false, "score": 1, "creation_date": 1474892785, "post_id": 39696517, "comment_id": 66703758, "body": "I think you should be using the Go Client library for this.  Reinventing the wheel is never fun.  Although I can say from experience you learn a lot. <a href=\"https://github.com/google/google-api-go-client\" rel=\"nofollow noreferrer\">github.com/google/google-api-go-client</a>"}], "tags": [], "owner": {"reputation": 70965, "user_id": 1841839, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/ZyKjr.png?s=128&g=1", "display_name": "DaImTo", "link": "https://stackoverflow.com/users/1841839/daimto"}, "is_accepted": false, "score": 0, "last_activity_date": 1474890505, "last_edit_date": 1474890505, "creation_date": 1474873143, "answer_id": 39696517, "question_id": 39692148, "link": "https://stackoverflow.com/questions/39692148/auth-with-google-sheets-api-v4-rest-go/39696517#39696517", "title": "Auth with google sheets API V4 / REST / Go", "body": "<p>Key is used for accessing Public data, Oauth2 requires that you authenticate and grant the application permission to access private data.  </p>\n\n<p>Worked in V3: If you want to use a key you can set the google sheet you are trying to access public and it will work.</p>\n\n<p>Otherwise you are going to have to implement Oauth2. I cant help with go but a quick search on google turned up a bunch of Oauth2 tutorials for it. </p>\n\n<p><strong>Update:</strong>\nI just did a quick check in the documentation. <a href=\"https://developers.google.com/sheets/reference/rest/v4/spreadsheets.values/update\" rel=\"nofollow\">Method: spreadsheets.values.update</a></p>\n\n<pre><code>Authorization\n\nRequires one of the following OAuth scopes:\n\n* https://www.googleapis.com/auth/drive\n* https://www.googleapis.com/auth/spreadsheets\n</code></pre>\n\n<p>which leads me to think that they removed the public trick from the v4 of the api.  Looks like you are going to have to implement oauth2 or service accounts</p>\n"}], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1043, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474890505, "creation_date": 1474840000, "question_id": 39692148, "link": "https://stackoverflow.com/questions/39692148/auth-with-google-sheets-api-v4-rest-go", "title": "Auth with google sheets API V4 / REST / Go", "body": "<p>I have read example <a href=\"https://developers.google.com/sheets/reference/rest/v4/spreadsheets.values/update\" rel=\"nofollow\">https://developers.google.com/sheets/reference/rest/v4/spreadsheets.values/update</a> from Google</p>\n\n<p>Everything is great until I coming to authentication. \nI would like to send this Put request to update a spreadsheet from my application from Golang:</p>\n\n<pre><code>key := \"my key\"\n// I think I do not need key, because it have to be OAuth... \nspreadsheetId := \"myspreadsheetID\"\nlink := fmt.Sprintf(\"https://sheets.googleapis.com/v4/spreadsheets/%s/values/A1?valueInputOption=RAW&amp;fields=updatedCells&amp;key=%s\",\nspreadsheetId, key)\n\nrequest := gorequest.New()\nresp, body, errs := request.Put(link).\n    Send(`{\"values\": [ [\"hello\",\"my\", \"friends\" ] ]}`).\n    End()\n\nif errs != nil {\n    fmt.Println(errs)\n}\n\nif resp.StatusCode != 200 {\n    fmt.Println(resp.Status)\n\n}\n\nfmt.Println(body)\n</code></pre>\n\n<p>The response is </p>\n\n<pre><code>401 Unauthorized\n{\n \"error\": {\n \"code\": 401,\n \"message\": \"The request does not have valid authentication credentials.\",\n \"status\": \"UNAUTHENTICATED\"\n }\n}\n</code></pre>\n\n<p>I tried to grasp the <a href=\"https://developers.google.com/identity/protocols/OAuth2\" rel=\"nofollow\">Auth Guide</a> but honestly I am not sure I figured out how can auth the request... \nAny help would be appreciated very much. </p>\n"}, {"tags": ["go", "google-sheets"], "comments": [{"owner": {"reputation": 7884, "user_id": 543873, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/55576366e4295fb7840a319399d53f57?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/543873/michael"}, "edited": false, "score": 2, "creation_date": 1538168978, "post_id": 39691100, "comment_id": 92063854, "body": "Upvoted for admitting that some things are too complicated for your brain to figure out.  Some people seem to think the existence of code you can read is justification for not creating good documentation - I am not one of those people."}], "answers": [{"tags": [], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "is_accepted": true, "score": 19, "last_activity_date": 1474892883, "creation_date": 1474892883, "answer_id": 39702834, "question_id": 39691100, "link": "https://stackoverflow.com/questions/39691100/golang-google-sheets-api-v4-write-update-example/39702834#39702834", "title": "Golang google sheets API V4 - Write/Update example?", "body": "<p>Well after some tryouts, there is an answer. Everything is same as in <a href=\"https://developers.google.com/sheets/quickstart/go\" rel=\"noreferrer\">https://developers.google.com/sheets/quickstart/go</a> Just changes in the main function </p>\n\n<pre><code>func write() {\n    ctx := context.Background()\n    b, err := ioutil.ReadFile(\"./Google_Sheets_API_Quickstart/client_secret.json\")\n    if err != nil {\n       log.Fatalf(\"Unable to read client secret file: %v\", err)\n    }\n\n// If modifying these scopes, delete your previously saved credentials\n// at ~/.credentials/sheets.googleapis.com-go-quickstart.json\n    config, err := google.ConfigFromJSON(b, \"https://www.googleapis.com/auth/spreadsheets\")\n    if err != nil {\n        log.Fatalf(\"Unable to parse client secret file to config: %v\", err)\n    }\n    client := getClient(ctx, config)\n\n    srv, err := sheets.New(client)\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve Sheets Client %v\", err)\n    }\n\n    spreadsheetId := \"YOUR SPREADSHEET ID\"\n\n    writeRange := \"A1\"\n\n    var vr sheets.ValueRange\n\n    myval := []interface{}{\"One\", \"Two\", \"Three\"}\n    vr.Values = append(vr.Values, myval)\n\n    _, err = srv.Spreadsheets.Values.Update(spreadsheetId, writeRange, &amp;vr).ValueInputOption(\"RAW\").Do()\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve data from sheet. %v\", err)\n    }\n\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 9074909, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NAK71.jpg?s=128&g=1", "display_name": "Denis Zubkov", "link": "https://stackoverflow.com/users/9074909/denis-zubkov"}, "edited": false, "score": 1, "creation_date": 1579070247, "post_id": 58797998, "comment_id": 105639601, "body": "Excellent approach for those who don&#39;t want to deal with interactive OAuth2 permission process, ie you want it to be server-side. Get the key and you&#39;re done. The only gotcha here is that the Service Account must be nominated as project owner, and then you share your required sheet with the account&#39;s email. The process is described here <a href=\"https://stackoverflow.com/questions/38949318/google-sheets-api-returns-the-caller-does-not-have-permission-when-using-serve\" title=\"google sheets api returns the caller does not have permission when using serve\">stackoverflow.com/questions/38949318/&hellip;</a>"}], "tags": [], "owner": {"reputation": 85, "user_id": 7653043, "user_type": "registered", "profile_image": "https://graph.facebook.com/1280564775360110/picture?type=large", "display_name": "Sahil Garg", "link": "https://stackoverflow.com/users/7653043/sahil-garg"}, "is_accepted": false, "score": 6, "last_activity_date": 1573461607, "creation_date": 1573461607, "answer_id": 58797998, "question_id": 39691100, "link": "https://stackoverflow.com/questions/39691100/golang-google-sheets-api-v4-write-update-example/58797998#58797998", "title": "Golang google sheets API V4 - Write/Update example?", "body": "<p>Well if you are looking for <strong>Service Account based authentication</strong>, then the following worked for me.</p>\n\n<p>Download the client secret file for service account from <a href=\"https://console.developers.google.com\" rel=\"noreferrer\">https://console.developers.google.com</a></p>\n\n<pre><code>import (\n        \"fmt\"\n        \"golang.org/x/net/context\"\n        \"google.golang.org/api/option\"\n        \"google.golang.org/api/sheets/v4\"\n        \"log\"\n    )\n\n\nconst (\n    client_secret_path = \"./credentials/client_secret.json\"\n)\n\n\nfunc NewSpreadsheetService() (*SpreadsheetService, error) {\n    // Service account based oauth2 two legged integration\n    ctx := context.Background()\n    srv, err := sheets.NewService(ctx, option.WithCredentialsFile(client_secret_path), option.WithScopes(sheets.SpreadsheetsScope))\n\n    if err != nil {\n        log.Fatalf(\"Unable to retrieve Sheets Client %v\", err)\n    }\n\n    c := &amp;SpreadsheetService{\n        service: srv,\n    }\n\n    return c, nil\n}\n\n\nfunc (s *SpreadsheetService) WriteToSpreadsheet(object *SpreadsheetPushRequest) error {\n\n    var vr sheets.ValueRange\n    vr.Values = append(vr.Values, object.Values)\n\n    res, err := s.service.Spreadsheets.Values.Append(object.SpreadsheetId, object.Range, &amp;vr).ValueInputOption(\"RAW\").Do()\n\n    fmt.Println(\"spreadsheet push \", res)\n\n    if err != nil {\n        fmt.Println(\"Unable to update data to sheet  \", err)\n    }\n\n    return err\n}   \n\ntype SpreadsheetPushRequest struct {\n    SpreadsheetId string        `json:\"spreadsheet_id\"`\n    Range         string        `json:\"range\"`\n    Values        []interface{} `json:\"values\"`\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 35, "user_id": 1727474, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4nN6i.png?s=128&g=1", "display_name": "balu", "link": "https://stackoverflow.com/users/1727474/balu"}, "is_accepted": false, "score": 0, "last_activity_date": 1602036989, "creation_date": 1602036989, "answer_id": 64236270, "question_id": 39691100, "link": "https://stackoverflow.com/questions/39691100/golang-google-sheets-api-v4-write-update-example/64236270#64236270", "title": "Golang google sheets API V4 - Write/Update example?", "body": "<ol>\n<li>change the scope in the quickstart example from <code>spreadsheets.readonly</code> to <code>spreadsheets</code> for r/w access</li>\n<li>here is the write snippet:</li>\n</ol>\n<pre><code>    writeRange := &quot;A1&quot; // or &quot;sheet1:A1&quot; if you have a different sheet\n    values := []interface{}{&quot;It worked!&quot;}\n    var vr sheets.ValueRange\n    vr.Values = append(vr.Values,values\n    _, err = srv.Spreadsheets.Values.Update(spreadsheetId,writeRange,&amp;vr).ValueInputOption(&quot;RAW&quot;).Do()\n</code></pre>\n<p>and that should work:</p>\n"}], "owner": {"reputation": 717, "user_id": 1754290, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/WG1Wc.jpg?s=128&g=1", "display_name": "MikeKlemin", "link": "https://stackoverflow.com/users/1754290/mikeklemin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9059, "favorite_count": 3, "accepted_answer_id": 39702834, "answer_count": 3, "score": 11, "last_activity_date": 1602036989, "creation_date": 1474832628, "last_edit_date": 1495540486, "question_id": 39691100, "link": "https://stackoverflow.com/questions/39691100/golang-google-sheets-api-v4-write-update-example", "title": "Golang google sheets API V4 - Write/Update example?", "body": "<p>Trying to write a simple three column table (<code>[][]string</code>) with Go, but can't. \nThe <a href=\"https://developers.google.com/sheets/quickstart/go\" rel=\"noreferrer\">quick start</a> guide is very nice, I now can read sheets, but there no any example of how to write data to a sheet, maybe it is trivial, but not for me it seems. \nThe <a href=\"https://github.com/google/google-api-go-client/tree/master/sheets/v4\" rel=\"noreferrer\">Golang library</a> for my brains is just too complicated to figure out.\nAnd there not a single example I could google... </p>\n\n<p>This <a href=\"https://stackoverflow.com/questions/37462887/google-sheets-api-v4-c-sharp-update-a-cell\">C# example</a> very looks close, but I am not sure I clearly understand C#</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 1, "creation_date": 1474836648, "post_id": 39690846, "comment_id": 66682679, "body": "Have you looked at the Codec implementation in the <code>securecookie</code> library used by Gorilla session? <a href=\"https://github.com/gorilla/securecookie/blob/master/securecookie.go\" rel=\"nofollow noreferrer\">github.com/gorilla/securecookie/blob/master/securecookie.go</a>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2672288"}, "reply_to_user": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1474868835, "post_id": 39690846, "comment_id": 66689598, "body": "thanks, I had but initially dismissed it as the hint on the challenge told me to look at Gorilla Sessions as opposed to SecureCookie. It makes sense to use that package though, so thanks for sharing!"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2672288"}, "edited": false, "score": 0, "creation_date": 1474868884, "post_id": 39691896, "comment_id": 66689616, "body": "Thanks Syllabix, appreciate the detailed answer. I believe this is exactly what I need, therefore marking the answer as correct, with thanks."}], "tags": [], "owner": {"reputation": 1890, "user_id": 1694885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1T2T.png?s=128&g=1", "display_name": "syllabix", "link": "https://stackoverflow.com/users/1694885/syllabix"}, "is_accepted": true, "score": 2, "last_activity_date": 1474837917, "creation_date": 1474837917, "answer_id": 39691896, "question_id": 39690846, "link": "https://stackoverflow.com/questions/39690846/decrypting-gorilla-sessions-cookie-data/39691896#39691896", "title": "Decrypting Gorilla Sessions Cookie Data", "body": "<p>Looking at the docs - gorilla provides a <a href=\"http://www.gorillatoolkit.org/pkg/securecookie\" rel=\"nofollow\" title=\"Gorilla secure cookie pkg\">secure cookie package</a>. \nDepending on your apps architecture - a basic implementation could work as follows:</p>\n\n<p>Create a session management package to be used by your app. For the sake of example - lets call it <code>sessionmngr</code></p>\n\n<p>Inside of <code>sessionmngr</code>,  import <code>\"github.com/gorilla/securecookie\"</code>. </p>\n\n<p>In the <code>sessionmngr</code> package, use a lower case <code>init()</code> function to set up a private instance of <code>securecookie</code>. Once a package is imported, lowercase init() functions are called in the order they are declared. (Check out the language <a href=\"https://golang.org/ref/spec#Package_initialization\" rel=\"nofollow\" title=\"The Go Programming Language Specification\">spec</a> for more info). You will use this instance to encode and decode cookies from the standard library's <code>http.Request</code>. </p>\n\n<pre><code>import (\n    \"github.com/gorilla/securecookie\"      \n\n    //you will need this later\n    \"http\" \n)\n\n//declare private secure cookie \nvar s *securecookie.SecureCookie\n\n//initialize it here (taken from the gorilla docs example)\nfunc init() {\n    var hashKey = []byte(\"very-secret\")\n    var blockKey = []byte(\"a-lot-secret\")\n    s = securecookie.New(hashKey, blockKey)\n}\n</code></pre>\n\n<p>You will then use <code>s</code> throughout the package in functions that need to encode and decode the a cookie's value. The <a href=\"http://www.gorillatoolkit.org/pkg/securecookie\" rel=\"nofollow\">securecookie package documentation</a> provides a boilerplate example. </p>\n\n<p>To meet the requirements of reading and modifying an already encrypted cookie - use the <code>Decode</code> and <code>Encode</code> methods on the instance of <code>securecookie</code> that was setup in the example above.</p>\n\n<p>Something Like --- </p>\n\n<pre><code>func DecodeAndModify(w http.ResponseWriter, r *http.Request) {\n    //get reference to cookie if set\n    if cookie, err := r.Cookie(\"cookie-name\"); err == nil {\n\n        value := make(map[string]string)\n        //use Decode to get the value from the cookie\n        if err = s.Decode(\"cookie-name\", cookie.Value, &amp;value); err == nil {\n            //modify the value in some way\n            value[\"newKey\"] = \"newValue\"\n            //re-encode it\n            if encoded, err := s.Encode(\"cookie-name\", value); err == nil {\n                cookie := &amp;http.Cookie{\n                    Name:  \"cookie-name\",\n                    Value: encoded,\n                    Path:  \"/\",\n                }\n                http.SetCookie(w, cookie)\n            }\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2672288"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1734, "favorite_count": 1, "accepted_answer_id": 39691896, "answer_count": 1, "score": 2, "last_activity_date": 1474837917, "creation_date": 1474831131, "question_id": 39690846, "link": "https://stackoverflow.com/questions/39690846/decrypting-gorilla-sessions-cookie-data", "title": "Decrypting Gorilla Sessions Cookie Data", "body": "<p>Firstly, let me preface by saying I'm taking part in a Capture the Flag contest and I'm having some difficulty with a question related to Go Gorilla Sessions. I've never coded in Go, so this is fun, and frustrating :)</p>\n\n<p>I have a secret key. I have an encoded Cookie. I need to decode the cookie, using the secret key I have, edit whatever data is in there, and re-encrypt with my altered data to progress in the challenge.</p>\n\n<p>I've read the Gorilla Sessions Package documentation and not really getting any help.</p>\n\n<p>Can anyone assist, where do I start?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1474834532, "post_id": 39690509, "comment_id": 66682020, "body": "May I ask what the intended purpose or benefit of reaching 100% and all green is? What is not good if one line is not colored green? If this is for non-technical management: Just color the offending line green by postprocessing the cover report."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1475153868, "post_id": 39690509, "comment_id": 66836292, "body": "@Volker It&#39;s not fatal to have one line not green. I just don&#39;t want to cut corners. Post processing sounds good if no other alternative exists."}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "edited": false, "score": 0, "creation_date": 1475231255, "post_id": 39690509, "comment_id": 66871801, "body": "Run you test a few time and i get different results every time. this coverage report is on a specific run not over the whole thing. first time i get 70+/- % then 80% etc."}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "reply_to_user": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "edited": false, "score": 0, "creation_date": 1475231737, "post_id": 39690509, "comment_id": 66872057, "body": "@dmportella because the app uses random numbers; if you remove random numbers, the result should be the same every time you run it"}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "edited": false, "score": 0, "creation_date": 1475232468, "post_id": 39690509, "comment_id": 66872525, "body": "erm your tests shouldnt have to cover everything, I wouldnt do any post processing that sounds like cheating. what are you gaining or trying to do with this setup?"}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 1, "creation_date": 1475233047, "post_id": 39690509, "comment_id": 66872868, "body": "the point of my question was: how to show in coverage results that line <code>os.Exit(code)</code> is covered. But I realized that doing that without postprocessing is not possible. Imagine <code>os.Exit(code)</code> becomes green, it means app executed it, but it means it exits immediately without building coverage profile. So we will never see this line green in coverage results even if my functional tests cover this line."}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "edited": false, "score": 0, "creation_date": 1475239583, "post_id": 39690509, "comment_id": 66876663, "body": "@MaximYefremov yes that is correct. with your current tests it will never be run and never go green"}, {"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1475520527, "post_id": 39690509, "comment_id": 66966378, "body": "@MaximYefremov I agree that the reason the line is not covered is because the progra exist. Did you try to add a time delay before exiting? Maybe so the coverage have the time to complete."}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1475591139, "post_id": 39690509, "comment_id": 66997441, "body": "@MarioAlexandroSantini nah the coverage will never hit that line, because it is random everytime."}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "edited": false, "score": 0, "creation_date": 1475689938, "post_id": 39690509, "comment_id": 67048021, "body": "@MaximYefremovI resolved this issue ... i will post it soon"}], "answers": [{"comments": [{"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1476082977, "post_id": 39891957, "comment_id": 67185533, "body": "I am using exactly your code but have <code>coverage: 93.3% of statements in .</code> anyway. Looks like <code>&#47;&#47;+build !test</code> and <code>-tags test</code> are not working. I tried with <code>go 1.7.1</code> and <code>go 1.6.2</code>. What version of <code>go</code> do you have?"}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1476089880, "post_id": 39891957, "comment_id": 67188983, "body": "@MaximYefremov here is the result of <code>go version</code> <code>go version go1.7 linux&#47;amd64</code>"}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1476090297, "post_id": 39891957, "comment_id": 67189200, "body": "@MaximYefremov for more information look up: <a href=\"http://dave.cheney.net/2013/10/12/how-to-use-conditional-compilation-with-the-go-build-tool\" rel=\"nofollow noreferrer\">dave.cheney.net/2013/10/12/&hellip;</a>"}, {"owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 1, "creation_date": 1476098648, "post_id": 39891957, "comment_id": 67193693, "body": "thanks for the link. To make it work I have to add empty line between lines <code>&#47;&#47; +build !test</code> and <code>package main</code>"}, {"owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "reply_to_user": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "edited": false, "score": 0, "creation_date": 1476098821, "post_id": 39891957, "comment_id": 67193808, "body": "ah yeah i forgot about that when i pasted it in. I have added the empty line to the example now"}], "tags": [], "owner": {"reputation": 4366, "user_id": 176478, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/a10b460f85d3d8b9702782bf6dd72307?s=128&d=identicon&r=PG", "display_name": "dmportella", "link": "https://stackoverflow.com/users/176478/dmportella"}, "is_accepted": true, "score": 3, "last_activity_date": 1476098797, "last_edit_date": 1476098797, "creation_date": 1475744888, "answer_id": 39891957, "question_id": 39690509, "link": "https://stackoverflow.com/questions/39690509/showing-coverage-of-functional-tests-without-blind-spots/39891957#39891957", "title": "showing coverage of functional tests without blind spots", "body": "<p>As per our conversation in the comments our coverage profile will never include that line of code because it will never be executed.</p>\n\n<p>With out seeing your full code it is hard to come up with a proper solutions however there a few things you can do to increase the coverage with out sacrificing too much.</p>\n\n<h1>func Main and TestMain</h1>\n\n<p>Standard practice for <code>GOLANG</code> is to avoid testing the main application entry point so most professionals extract as much functionality into other classes so they can be easily tested.</p>\n\n<p><code>GOLANG</code> testing framework allows you to test your application with out the main function but in it place you can use the TestMain func which can be used to test where the code needs to be run on the main thread. Below is a small exert from <a href=\"https://golang.org/pkg/testing\" rel=\"nofollow noreferrer\">GOLANG Testing</a>.</p>\n\n<blockquote>\n  <p>It is sometimes necessary for a test program to do extra setup or teardown before or after testing. It is also sometimes necessary for a test to control which code runs on the <code>main</code> thread. To support these and other cases, if a test file contains a function: <code>func TestMain(m *testing.M)</code></p>\n</blockquote>\n\n<p>Check <a href=\"https://golang.org/pkg/testing\" rel=\"nofollow noreferrer\">GOLANG Testing</a> for more information.</p>\n\n<h2>Working example</h2>\n\n<p>Below is an example (with 93.3% coverage that we will make it 100%) that tests all the functionality of your code. I made a few changes to your design because it did not lend itself very well for testing but the functionality still the same.</p>\n\n<p>package main</p>\n\n<blockquote>\n  <p>dofunc.go</p>\n</blockquote>\n\n<pre><code>import (\n    \"fmt\"\n    \"math/rand\"\n    \"time\"\n)\n\nvar seed int64 = time.Now().UTC().UnixNano()\n\nfunc doFunc() int {\n    rand.Seed(seed)\n    var code int\n    for {\n        i := rand.Int()\n        fmt.Println(i)\n        if i%3 == 0 {\n            code = 0\n            break\n        }\n        if i%2 == 0 {\n            fmt.Println(\"status 1\")\n            code = 1\n            break\n        }\n        time.Sleep(time.Second)\n    }\n    return code\n}\n</code></pre>\n\n<blockquote>\n  <p>dofunc_test.go</p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n    \"flag\"\n    \"os\"\n)\n\nvar exitCode int\n\nfunc TestMain(m *testing.M) {\n    flag.Parse()\n    code := m.Run()\n    os.Exit(code)\n}\n\nfunc TestDoFuncErrorCodeZero(t *testing.T) {\n    seed = 2\n\n    if code:= doFunc(); code != 0 {\n        t.Fail()\n    }\n}\n\nfunc TestDoFuncErrorCodeOne(t *testing.T) {\n    seed = 3\n\n    if code:= doFunc(); code != 1 {\n        t.Fail()\n    }\n}\n</code></pre>\n\n<blockquote>\n  <p>main.go</p>\n</blockquote>\n\n<pre><code>package main\n\nimport \"os\"\n\nfunc main() {\n    os.Exit(doFunc());\n}\n</code></pre>\n\n<h2>Running the tests</h2>\n\n<p>If we build our application with the cover profile.</p>\n\n<blockquote>\n  <p><code>$ go test -c -coverpkg=. -o example</code></p>\n</blockquote>\n\n<p>And run it.</p>\n\n<blockquote>\n  <p><code>$ ./example -test.coverprofile=/tmp/profile</code></p>\n</blockquote>\n\n<p>Running the tests</p>\n\n<pre><code>1543039099823358511\n2444694468985893231\n6640668014774057861\n6019456696934794384\nstatus 1\nPASS\ncoverage: 93.3% of statements in .\n</code></pre>\n\n<p>So we see that we got 93% coverage we know that is because we don't have any test coverage for <code>main</code> to fix this we could write some tests for it (not a very good idea) since the code has <code>os.Exit</code> or we can refactor it so it is super simple with very little functionality we can exclude it from our tests.</p>\n\n<p>To exclude the <code>main.go</code> file from the coverage reports we can use build <code>tags</code> by placing tag comment at the first line of the <code>main.go</code> file.</p>\n\n<blockquote>\n  <p><code>//+build !test</code></p>\n</blockquote>\n\n<p>For more information about build flags check this link: <a href=\"http://dave.cheney.net/2013/10/12/how-to-use-conditional-compilation-with-the-go-build-tool\" rel=\"nofollow noreferrer\">http://dave.cheney.net/2013/10/12/how-to-use-conditional-compilation-with-the-go-build-tool</a></p>\n\n<p>This will tell <code>GOLANG</code> that the file should be included in the build process where the tag build is present but<code>NOT</code> where the tag test is present.</p>\n\n<p>See full code.</p>\n\n<pre><code>//+build !test\n\npackage main\n\nimport \"os\"\n\nfunc main() {\n    os.Exit(doFunc());\n}\n</code></pre>\n\n<p>We need need to build the the coverage application slightly different.</p>\n\n<blockquote>\n  <p><code>$ go test -c -coverpkg=. -o example -tags test</code></p>\n</blockquote>\n\n<p>Running it would be the same.</p>\n\n<blockquote>\n  <p><code>$ ./example -test.coverprofile=/tmp/profile</code></p>\n</blockquote>\n\n<p>We get the report below.</p>\n\n<pre><code>1543039099823358511\n2444694468985893231\n6640668014774057861\n6019456696934794384\nstatus 1\nPASS\ncoverage: 100.0% of statements in .\n</code></pre>\n\n<p>We can now build the coverage html out.</p>\n\n<blockquote>\n  <p><code>$ go tool cover -html /tmp/profile -o /tmp/profile.html</code></p>\n</blockquote>\n\n<p><a href=\"https://i.stack.imgur.com/1ACuO.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ACuO.png\" alt=\"Coverage HTML Report\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "is_accepted": false, "score": 0, "last_activity_date": 1563834495, "last_edit_date": 1563834495, "creation_date": 1563834063, "answer_id": 57154454, "question_id": 39690509, "link": "https://stackoverflow.com/questions/39690509/showing-coverage-of-functional-tests-without-blind-spots/57154454#57154454", "title": "showing coverage of functional tests without blind spots", "body": "<p>In my <a href=\"https://github.com/rillig/pkglint/tree/v5.7.16/cmd/pkglint\" rel=\"nofollow noreferrer\">pkglint project</a> I have declared a package-visible variable:</p>\n\n<pre><code>var exit = os.Exit\n</code></pre>\n\n<p>In the code that sets up the test, I overwrite it with a test-specific function, and when tearing down a test, I reset it back to os.Exit.</p>\n\n<p>This is a simple and pragmatic solution that works well for me, for at least a year of extensive testing. I get 100% branch coverage because there is no branch involved at all.</p>\n"}], "owner": {"reputation": 11529, "user_id": 1024794, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8237daabaa73dc7fc573fc224d0f1b54?s=128&d=identicon&r=PG", "display_name": "Maxim Yefremov", "link": "https://stackoverflow.com/users/1024794/maxim-yefremov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1203, "favorite_count": 0, "accepted_answer_id": 39891957, "answer_count": 2, "score": 4, "last_activity_date": 1563834495, "creation_date": 1474829098, "last_edit_date": 1592644375, "question_id": 39690509, "link": "https://stackoverflow.com/questions/39690509/showing-coverage-of-functional-tests-without-blind-spots", "title": "showing coverage of functional tests without blind spots", "body": "<p>I have a production golang code and functional tests for it written not in golang. Functional tests run compiled binary. Very simplified version of my production code is here: <code>main.go</code>:</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;math/rand&quot;\n    &quot;os&quot;\n    &quot;time&quot;\n)\n\nfunc main() {\n    rand.Seed(time.Now().UTC().UnixNano())\n    for {\n        i := rand.Int()\n        fmt.Println(i)\n        if i%3 == 0 {\n            os.Exit(0)\n        }\n        if i%2 == 0 {\n            os.Exit(1)\n        }\n        time.Sleep(time.Second)\n    }\n}\n</code></pre>\n<p>I want to build coverage profile for my functional tests. In order to do it I add <code>main_test.go</code> file with content:</p>\n<pre><code>package main\n\nimport (\n    &quot;os&quot;\n    &quot;testing&quot;\n)\n\nvar exitCode int\n\nfunc Test_main(t *testing.T) {\n    go main()\n    exitCode = &lt;-exitCh\n}\n\nfunc TestMain(m *testing.M) {\n    m.Run()\n    // can exit because cover profile is already written\n    os.Exit(exitCode)\n}\n</code></pre>\n<p>And modify <code>main.go</code>:</p>\n<pre><code>package main\n\nimport (\n    &quot;flag&quot;\n    &quot;fmt&quot;\n    &quot;math/rand&quot;\n    &quot;os&quot;\n    &quot;runtime&quot;\n    &quot;time&quot;\n)\n\nvar exitCh chan int = make(chan int)\n\nfunc main() {\n    rand.Seed(time.Now().UTC().UnixNano())\n    for {\n        i := rand.Int()\n        fmt.Println(i)\n        if i%3 == 0 {\n            exit(0)\n        }\n        if i%2 == 0 {\n            fmt.Println(&quot;status 1&quot;)\n            exit(1)\n        }\n        time.Sleep(time.Second)\n    }\n}\n\nfunc exit(code int) {\n    if flag.Lookup(&quot;test.coverprofile&quot;) != nil {\n        exitCh &lt;- code\n        runtime.Goexit()\n    } else {\n        os.Exit(code)\n    }\n}\n</code></pre>\n<p>Then I build coverage binary:</p>\n<pre><code>go test -c -coverpkg=.  -o myProgram\n</code></pre>\n<p>Then my functional tests run this coverage binary, like this:</p>\n<pre><code>./myProgram -test.coverprofile=/tmp/profile\n6507374435908599516\nPASS\ncoverage: 64.3% of statements in .\n</code></pre>\n<p>And I build HTML output showing coverage:</p>\n<pre><code>$ go tool cover -html /tmp/profile -o /tmp/profile.html\n$ open /tmp/profile.html\n</code></pre>\n<p><a href=\"https://i.stack.imgur.com/AzUkg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/AzUkg.png\" alt=\"html coverage profile\" /></a></p>\n<h2>Problem</h2>\n<p>Method <code>exit</code> will never show 100% coverage because of condition <code>if flag.Lookup(&quot;test.coverprofile&quot;) != nil</code>.  So line <code>os.Exit(code)</code> is kinda blind spot for my coverage results, although, in fact, functional tests go on this line and this line should be shown as green.</p>\n<p>On the other hand, if I remove condition <code>if flag.Lookup(&quot;test.coverprofile&quot;) != nil</code>, the line <code>os.Exit(code)</code> will terminate my binary without building coverage profile.</p>\n<p><strong>How</strong> to rewrite <code>exit()</code> and maybe <code>main_test.go</code> to show coverage <strong>without blind spots</strong>?</p>\n<p>The first solution that comes into mind is <code>time.Sleep()</code>:</p>\n<pre><code>func exit(code int) {\n        exitCh &lt;- code\n        time.Sleep(time.Second) // wait some time to let coverprofile be written\n        os.Exit(code)\n    }\n}\n</code></pre>\n<p>But it's not very good because will cause production code slow down before exit.</p>\n"}, {"tags": ["go", "architecture", "dao"], "answers": [{"comments": [{"owner": {"reputation": 2055, "user_id": 617941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8add04b20f02dcc48c0ab032062158d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Roosing", "link": "https://stackoverflow.com/users/617941/joey-roosing"}, "edited": false, "score": 0, "creation_date": 1474872184, "post_id": 39693841, "comment_id": 66691021, "body": "Thanks alot for your answer. With request/response cycle, do you mean instantiate a service for every single request? If so, why not just instantiate in the handler, rather then passing it along? That wasn&#39;t completely clear for me. Sorry for my confusion."}, {"owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "reply_to_user": {"reputation": 2055, "user_id": 617941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8add04b20f02dcc48c0ab032062158d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Roosing", "link": "https://stackoverflow.com/users/617941/joey-roosing"}, "edited": false, "score": 0, "creation_date": 1474877793, "post_id": 39693841, "comment_id": 66694023, "body": "What if you want to pile up middlewares and share informations between then ?"}, {"owner": {"reputation": 2055, "user_id": 617941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8add04b20f02dcc48c0ab032062158d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Roosing", "link": "https://stackoverflow.com/users/617941/joey-roosing"}, "edited": false, "score": 0, "creation_date": 1474879961, "post_id": 39693841, "comment_id": 66695272, "body": "Good point. To make sure I understand correctly; make a non-nil empty context using the Background function of the context package, initialize and load services in a container struct, put that container struct in the context, and use that in the handlers?"}], "tags": [], "owner": {"reputation": 19424, "user_id": 750852, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ezMNd.png?s=128&g=1", "display_name": "mpm", "link": "https://stackoverflow.com/users/750852/mpm"}, "is_accepted": true, "score": 2, "last_activity_date": 1474856466, "creation_date": 1474856466, "answer_id": 39693841, "question_id": 39689881, "link": "https://stackoverflow.com/questions/39689881/golang-service-daos-implementation/39693841#39693841", "title": "Golang service/daos implementation", "body": "<p>You can use <code>context.Context</code> to pass request scoped values into your handlers (available in Go 1.7) , if you build all your required dependencies during the request/response cycle (which you should to avoid race conditions, except for dependencies that manage concurrency on their own like <code>sql.DB</code>). Put all your services into a single container for instance, then query the context for that value :</p>\n\n<pre><code>container := request.Context.Value(\"container\").(*Container)\nblogs,err := container.GetBlogService().ListBlogs()\n</code></pre>\n\n<p>read the following material :</p>\n\n<p><a href=\"https://golang.org/pkg/context/\" rel=\"nofollow\">https://golang.org/pkg/context/</a></p>\n\n<p><a href=\"https://golang.org/pkg/net/http/#Request.Context\" rel=\"nofollow\">https://golang.org/pkg/net/http/#Request.Context</a></p>\n"}], "owner": {"reputation": 2055, "user_id": 617941, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8add04b20f02dcc48c0ab032062158d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joey Roosing", "link": "https://stackoverflow.com/users/617941/joey-roosing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1705, "favorite_count": 2, "accepted_answer_id": 39693841, "answer_count": 1, "score": 3, "last_activity_date": 1474856466, "creation_date": 1474825513, "question_id": 39689881, "link": "https://stackoverflow.com/questions/39689881/golang-service-daos-implementation", "title": "Golang service/daos implementation", "body": "<p>Coming from a Java background, I have some questions on how things are typically done in Golang. I am specifically talking about services and dao's/repositories.</p>\n\n<p>In java, I would use dependency injection (probably as singleton/application-scoped), and have a Service injected into my rest endpoint / resource.</p>\n\n<p>To give a bit more context. Imagine the following Golang code:</p>\n\n<pre><code>func main() {\n    http.ListenAndServe(\"localhost:8080\", nil)\n}\n\nfunc init() {\n    r := httptreemux.New()\n    api := r.NewGroup(\"/api/v1\")\n    api.GET(\"/blogs\", GetAllBlogs)\n    http.Handle(\"/\", r)\n}\n</code></pre>\n\n<p><strong>Copied this directly from my code, main and init are split because google app engine.</strong></p>\n\n<p>So for now I have one handler. In that handler, I expect to interact with a BlogService.</p>\n\n<p><strong>The question is, where, and in what scope should I instantiate a BlogService struct and a dao like datastructure?</strong></p>\n\n<p>Should I do it everytime the handler is triggered, or make it constant/global?</p>\n\n<p>For completeness, here is the handler and blogService:</p>\n\n<pre><code>// GetAllBlogs Retrieves all blogs from GCloud datastore\nfunc GetAllBlogs(w http.ResponseWriter, req *http.Request, params map[string]string) {\n    c := appengine.NewContext(req)\n   // need a reference to Blog Service at this point, where to instantiate?\n}\n\ntype blogService struct{}\n\n// Blog contains the content and meta data for a blog post.\ntype Blog struct {...}\n\n// newBlogService constructs a new service to operate on Blogs.\nfunc newBlogService() *blogService {\n    return &amp;blogService{}\n}\n\nfunc (s *blogService) ListBlogs(ctx context.Context) ([]*Blog, error)    {\n    // Do some dao-ey / repository things, where to instantiate BlogDao?\n}\n</code></pre>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 1, "creation_date": 1474828279, "post_id": 39688883, "comment_id": 66679956, "body": "Seems like it still needs to be fixed, as per <a href=\"https://github.com/golang/go/issues/11496\" rel=\"nofollow noreferrer\">github issue</a>"}], "answers": [{"tags": [], "owner": {"reputation": 17627, "user_id": 15061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/55fd56dfef815d7aa543be09ad3ed3e9?s=128&d=identicon&r=PG", "display_name": "Kamil Kisiel", "link": "https://stackoverflow.com/users/15061/kamil-kisiel"}, "is_accepted": false, "score": 0, "last_activity_date": 1474904041, "creation_date": 1474904041, "answer_id": 39706878, "question_id": 39688883, "link": "https://stackoverflow.com/questions/39688883/golang-xml-marshal-with-namespaces/39706878#39706878", "title": "Golang XML Marshal with namespaces", "body": "<p>The last project I worked on which used XML heavily ran into the same problem. As @algrebe mentioned, it seems to be an outstanding issue in the Go standard library's XML implementation. There are other XML libraries out there which you can use that do support namespaces. I've had pretty good success with <a href=\"https://github.com/beevik/etree\" rel=\"nofollow\">https://github.com/beevik/etree</a>.</p>\n"}], "owner": {"reputation": 1288, "user_id": 5938227, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/O9cUT.png?s=128&g=1", "display_name": "dieuhd", "link": "https://stackoverflow.com/users/5938227/dieuhd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1123, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1474904041, "creation_date": 1474819072, "question_id": 39688883, "link": "https://stackoverflow.com/questions/39688883/golang-xml-marshal-with-namespaces", "title": "Golang XML Marshal with namespaces", "body": "<p>I am using golang xml to Marshal/Unmarshal it. I want to input and output after Marshal same. </p>\n\n<p>Here is my example :</p>\n\n<p><a href=\"https://play.golang.org/p/KH6mFXLVdH\" rel=\"nofollow\">https://play.golang.org/p/KH6mFXLVdH</a></p>\n\n<p>xml input has tag name with namespace, ex: <code>x14:dataValidation</code></p>\n\n<p>after Marshal data that Unmarshal from input xml, i want tag name same it.</p>\n\n<p>Have any solutions?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["image", "go"], "comments": [{"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 2, "creation_date": 1474811981, "post_id": 39687545, "comment_id": 66674629, "body": "Use <code>draw.Over</code> rather than <code>draw.Src</code>?"}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "reply_to_user": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "edited": false, "score": 0, "creation_date": 1474812027, "post_id": 39687545, "comment_id": 66674649, "body": "Forgot about that. That solved it!"}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 1, "creation_date": 1474929162, "post_id": 39687545, "comment_id": 66724834, "body": "Fyi, you&#39;re deferring a close as your second to last line in the function. Defer it after you check the error of the function that returns that. So in your example, defer the close just before the line that has the variable, profileImage."}], "answers": [{"tags": [], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "is_accepted": true, "score": 4, "last_activity_date": 1474812077, "creation_date": 1474812077, "answer_id": 39687669, "question_id": 39687545, "link": "https://stackoverflow.com/questions/39687545/golang-png-draw-transparent/39687669#39687669", "title": "Golang png draw transparent", "body": "<p>As mentioned in the comments.</p>\n\n<pre><code>draw.Draw(profileImage, profileImage.Bounds(), itemImage, image.Point{0, 0}, draw.Over)\n</code></pre>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2018, "favorite_count": 0, "accepted_answer_id": 39687669, "answer_count": 1, "score": 3, "last_activity_date": 1474812077, "creation_date": 1474811314, "question_id": 39687545, "link": "https://stackoverflow.com/questions/39687545/golang-png-draw-transparent", "title": "Golang png draw transparent", "body": "<p>I am trying to draw multiple transparent images to form a big one and save it as PNG</p>\n\n<pre><code>func generateUserImage(username string, items []models.Item) error {\n    imageFile, err := os.Create(\"public/items/users/\" + username + \".png\")\n    if err != nil {\n        return err\n    }\n    profileImage := image.NewRGBA(image.Rect(0, 0, 261, 336))\n    for _, item := range items {\n        revel.INFO.Println(item)\n        itemFile, err := os.Open(\"public/items/universe/\" + item.Type + \"/\" + item.Name + \".png\")\n        if err != nil {\n            return err\n        }\n        itemImage, err := png.Decode(itemFile)\n        if err != nil {\n            return err\n        }\n        draw.Draw(profileImage, profileImage.Bounds(), itemImage, image.Point{0, 0}, draw.Src)\n        itemFile.Close()\n    }\n    err = png.Encode(imageFile, profileImage)\n    if err != nil {\n        return err\n    }\n    defer imageFile.Close()\n    return nil\n}\n</code></pre>\n\n<p>Everything seems to be working fine except that the final image will only contain the LAST image of the range loop (even tho the range loops 5 times). All images are .png and with transparent background. Here is a demo on how images look</p>\n\n<p><a href=\"https://i.stack.imgur.com/tCGZT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tCGZT.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can try to save the image and see that the background is transparent... So I have no idea why the final image only contains 1 image and not all</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "build", "stack-trace"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474818912, "post_id": 39686900, "comment_id": 66676898, "body": "A release binary should be built in a consistent, reproducible environment with no personal information to begin with. Once you&#39;re doing that, the text of GOPATH isn&#39;t consequential."}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474820904, "post_id": 39686900, "comment_id": 66677494, "body": "@JimB I need it for developers&#39; builds too. There&#39;s no point in creating 99.99% similar artifacts 50+ times just so the developers would see their user name in stack traces."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474825403, "post_id": 39686900, "comment_id": 66678961, "body": "Regardless, once you have a method for creating a consistent build, this becomes a moot point. There currently is no way to strip the GOPATH value from the filenames (there&#39;s an open issue <a href=\"https://golang.org/issue/3467\" rel=\"nofollow noreferrer\">golang.org/issue/3467</a>, but it hasn&#39;t been a priority for anyone to take it on)."}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474829998, "post_id": 39686900, "comment_id": 66680532, "body": "@JimB seriously, I&#39;m not asking you how to run my builds... You don&#39;t know the reasons and the circumstances, no need to second-guess me. I&#39;ve asked a very specific question. You know that&#39;s not possible: please post that as an answer and I&#39;ll accept it."}], "answers": [{"comments": [{"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "edited": false, "score": 1, "creation_date": 1475009278, "post_id": 39729839, "comment_id": 66765916, "body": "No, this is neither an answer to a very simple question, nor a real solution. Docker is a can of worms of it&#39;s own (at where I work we build a patched version of this... ahem, very nice program, but that&#39;s beside the point). This is not a real solution for people who want to build on Windows or Mac (too slow, impossible to debug, total messup with file ownership etc.) This doesn&#39;t play well with any build system in existence. And, unfortunately, I know this, because this is what I do today, and I hate doing this."}], "tags": [], "owner": {"reputation": 665, "user_id": 6312602, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-J2fMlfN4Ghc/AAAAAAAAAAI/AAAAAAAAACc/IIPzG0rPYuA/photo.jpg?sz=128", "display_name": "Jesse Amano", "link": "https://stackoverflow.com/users/6312602/jesse-amano"}, "is_accepted": false, "score": 1, "last_activity_date": 1474993657, "creation_date": 1474993657, "answer_id": 39729839, "question_id": 39686900, "link": "https://stackoverflow.com/questions/39686900/consistent-builds-remove-personal-information-from-binaries/39729839#39729839", "title": "Consistent builds / remove personal information from binaries", "body": "<p>I know it doesn't <em>directly</em> address what you asked, but @JimB's suggestion does indicate a class of solutions to the problem you seem to be having.</p>\n\n<p>One of the easier ones (I think) would be to have your developers install <a href=\"https://www.docker.com/products/overview\" rel=\"nofollow\">Docker</a> and create an alias so that the <code>go</code> command runs:</p>\n\n<pre><code>docker run --rm --tty --volume $GOPATH:/go golang:1.7.1(-$YOUR_PLATFORM) go\n</code></pre>\n\n<p>Then, every build (and test and run) thinks it's using a GOPATH of <code>/go</code> and your developers' checksums won't disagree based on that.</p>\n\n<p>See <a href=\"https://hub.docker.com/_/golang/\" rel=\"nofollow\">here</a> for more info.</p>\n"}], "owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 178, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474993657, "creation_date": 1474807053, "question_id": 39686900, "link": "https://stackoverflow.com/questions/39686900/consistent-builds-remove-personal-information-from-binaries", "title": "Consistent builds / remove personal information from binaries", "body": "<p>I've now realized that Go saves absolute paths to source code in binaries for the purpose of printing stack-traces and the likes.  I don't want to completely remove this information, however, this also means that every developer building the same program will produce an executable with a different checksum.  Before I try to reimplement the build using <code>chroot</code> or something like that: isn't there any way to tell Go not to use absolute paths for this purpose?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 1229, "user_id": 6336858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ebcd58007a9088efe7c1605069558559?s=128&d=identicon&r=PG&f=1", "display_name": "omgj", "link": "https://stackoverflow.com/users/6336858/omgj"}, "reply_to_user": {"reputation": 1191, "user_id": 2627137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rb5FY.jpg?s=128&g=1", "display_name": "kkaosninja", "link": "https://stackoverflow.com/users/2627137/kkaosninja"}, "edited": false, "score": 0, "creation_date": 1474805381, "post_id": 39686405, "comment_id": 66672702, "body": "exactly, well I would just range through and increment a counter, but this loads the whole slice into memory, very inefficient"}], "answers": [{"tags": [], "owner": {"reputation": 12093, "user_id": 1495902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ac9501373b09691e9867ea7bfc1de7a0?s=128&d=identicon&r=PG", "display_name": "Amiram Korach", "link": "https://stackoverflow.com/users/1495902/amiram-korach"}, "is_accepted": true, "score": 1, "last_activity_date": 1474811823, "creation_date": 1474811823, "answer_id": 39687629, "question_id": 39686405, "link": "https://stackoverflow.com/questions/39686405/mongodb-golang-can-i-count-an-slice-map-without-loading-data-into-memory/39687629#39687629", "title": "Mongodb, golang. Can i count an slice/map without loading data into memory?", "body": "<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>db.labs.aggregate([\r\n  {$match: {\"_id\" : ObjectId(\"57e602ada35ea4db6e4eee27\")}},\r\n  {$project: {\r\n      areasCount: {\"$size\": \"$areas\"}\r\n    }\r\n  }\r\n])</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}], "owner": {"reputation": 1229, "user_id": 6336858, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/ebcd58007a9088efe7c1605069558559?s=128&d=identicon&r=PG&f=1", "display_name": "omgj", "link": "https://stackoverflow.com/users/6336858/omgj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 292, "favorite_count": 0, "accepted_answer_id": 39687629, "answer_count": 1, "score": 0, "last_activity_date": 1474848779, "creation_date": 1474803721, "last_edit_date": 1474848779, "question_id": 39686405, "link": "https://stackoverflow.com/questions/39686405/mongodb-golang-can-i-count-an-slice-map-without-loading-data-into-memory", "title": "Mongodb, golang. Can i count an slice/map without loading data into memory?", "body": "<p>In my collection labs I have:</p>\n\n<pre><code>{\n    \"_id\" : ObjectId(\"57e602ada35ea4db6e4eee27\"),\n    \"areas\" : [\n        \"nanotech\",\n        \"robotics\"\n    ]\n}\n</code></pre>\n\n<p>My query is:\n<code>db.labs.find({\"_id\" : ObjectId(\"57e602ada35ea4db6e4eee27\")},{areas:1})</code></p>\n\n<p>What I want is to count the elements in the slice but not retrieve the whole slice, anyone know? I'm using the mgo package, which has a great correspondence with golang. Thanks</p>\n"}, {"tags": ["multithreading", "go", "pthreads", "coroutine", "goroutine"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 3, "creation_date": 1474798734, "post_id": 39685437, "comment_id": 66670942, "body": "Number of threads is not limited, see related questions: <a href=\"http://stackoverflow.com/questions/39245660/number-of-threads-used-by-go-runtime\">Number of threads used by Go runtime</a> and <a href=\"http://stackoverflow.com/questions/28186361/why-does-it-not-create-many-threads-when-many-goroutines-are-blocked-in-writing\">Why does it not create many threads when many goroutines are blocked in writing file in golang?</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474818203, "post_id": 39685437, "comment_id": 66676645, "body": "Remember that blocking operations are very uncommon in most programs. File IO would be the most common, maybe cgo calls next, but in the scheme of things this is very infrequent."}], "answers": [{"comments": [{"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "edited": false, "score": 0, "creation_date": 1474873767, "post_id": 39686935, "comment_id": 66691897, "body": "Thank you @kkaosninja. So how can this logical processers different from OS threads? Why is the concept of logical processors required at all, if the underlying system is userspace threads to OS threads mapping? If a program has to create this concept of logical processor from a userspace, how is it done? Is there a possible C implementation which can be used for understanding?"}, {"owner": {"reputation": 1191, "user_id": 2627137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rb5FY.jpg?s=128&g=1", "display_name": "kkaosninja", "link": "https://stackoverflow.com/users/2627137/kkaosninja"}, "reply_to_user": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "edited": false, "score": 1, "creation_date": 1474902801, "post_id": 39686935, "comment_id": 66710810, "body": "The best answer here explains logical processors quite nicely =&gt; <a href=\"http://www.tomshardware.com/answers/id-1850932/difference-physical-core-logical-core.html\" rel=\"nofollow noreferrer\">tomshardware.com/answers/id-1850932/&hellip;</a>. Also, from Go 1.5, the compiler and runtime were completely written in Go. So if you want the C source code, you will have to look at the sources for Go 1.4 and below."}], "tags": [], "owner": {"reputation": 1191, "user_id": 2627137, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rb5FY.jpg?s=128&g=1", "display_name": "kkaosninja", "link": "https://stackoverflow.com/users/2627137/kkaosninja"}, "is_accepted": true, "score": 3, "last_activity_date": 1474816412, "last_edit_date": 1474816412, "creation_date": 1474807315, "answer_id": 39686935, "question_id": 39685437, "link": "https://stackoverflow.com/questions/39685437/if-goroutines-involve-userspace-threads-can-a-blocking-operation-leads-to-conte/39686935#39686935", "title": "If goroutines involve userspace threads, can a blocking operation leads to context switch of the entire thread?", "body": "<p>Below is what I understood after reading <a href=\"https://www.manning.com/books/go-in-action\" rel=\"nofollow\">Go in Action</a></p>\n\n<p>Goroutines run within what are called \"logical processors\"(NOT physical processors). Each of these logical processors are bound to a single OS thread.</p>\n\n<p>After Go 1.5, the number of logical processors equals the number of available physical processors.</p>\n\n<p>The Go scheduler intelligently schedules the running of multiple goroutines on each of these logical processors</p>\n\n<p>Crude diagram follows :-</p>\n\n<p>OS Thread ------ Logical Processor ------ Goroutine 1, Goroutine 2..... Goroutine n</p>\n\n<p>Now, it is very likely that one of the Goroutines makes a blocking system call. When this happens, </p>\n\n<ol>\n<li><p>The OS thread and the Goroutine that made the blocking call are\ndetached from the logical processor</p>\n\n<p>This logical processor now has no OS thread.</p></li>\n<li><p>The Go scheduler creates a new OS thread, and attaches it to the logical processor. The remaining goroutines that were attached to the logical processor, now continue to run.</p></li>\n<li><p>The detached goroutine and the OS thread it is associated with continue to block, waiting for the syscall to return.</p></li>\n<li><p>When the system call returns, the goroutine is re-attached to one of the logical processors, and is placed in its run queue.</p></li>\n<li><p>The OS thread is \"put aside for future use\". I am guessing it is added to some sort of thread pool.</p></li>\n</ol>\n\n<p>If the goroutine makes a Network I/O call, it is handled in slightly different way.</p>\n\n<p>The goroutine is detached from the logical processor, and is moved to the integrated network poller. Once the poller says the I/O operation is ready, the goroutine is re-attached to the logical processor to handle it.</p>\n\n<p>--\nNow, to answer your question :-)</p>\n\n<p>I'm not an expert, but this is what I think will happen, based on what was stated above.</p>\n\n<p>Since one goroutine on each of the 4 OS threads have made a blocking syscall, all 4 threads will be detached from their logical processors, and will continue to block until the syscall(s) return. The 4 OS threads will be associated with the respective goroutines that made the blocking syscall.</p>\n\n<p>Now, this results in 4 logical processors(and the non-blocking goroutines attached to them) without any OS threads.</p>\n\n<p>So, the GO scheduler creates 4 new OS threads, and assigns the logical processors to these threads.</p>\n\n<p>--</p>\n\n<p>From the OS's point of view, the 4 OS threads that made blocking calls obviously cannot be allowed to take CPU time, since they aren't doing anything.</p>\n\n<p>So it will switch their contexts with some other non-blocking thread of its choosing.</p>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 586, "favorite_count": 1, "accepted_answer_id": 39686935, "answer_count": 1, "score": 6, "last_activity_date": 1474816412, "creation_date": 1474796405, "question_id": 39685437, "link": "https://stackoverflow.com/questions/39685437/if-goroutines-involve-userspace-threads-can-a-blocking-operation-leads-to-conte", "title": "If goroutines involve userspace threads, can a blocking operation leads to context switch of the entire thread?", "body": "<p>Apologies if this question is too stupid. I was reading through the details of goroutines <a href=\"http://tleyden.github.io/blog/2014/10/30/goroutines-vs-threads/\">Here</a>. According to that page, it says <code>Goroutines are multiplexed onto a small number of OS threads, rather than a 1:1 mapping</code> by which, all I could think of with my limited knowledge was, there are a limited number of OS threads spawned, inside which, it may be using userspace threads or coroutines. Is this correct? And if so, if I may take an example, if a program clones 4 OS threads inside which there are multiple userspace threads, and there happen to be a single blocking operation inside all these 4 threads along with non-blocking operations, will the OS scheduler context-switch all these threads, as the userspace threads are not transparent to the OS threads? </p>\n\n<p>Out of curiosity, is there a possible C implementation of goroutines, which could help understand the internals?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1474795324, "post_id": 39685036, "comment_id": 66670126, "body": "Have you try <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">sqlx</a> ?"}, {"owner": {"reputation": 2878, "user_id": 3087441, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/zIs67.jpg?s=128&g=1", "display_name": "kopiczko", "link": "https://stackoverflow.com/users/3087441/kopiczko"}, "edited": false, "score": 0, "creation_date": 1474896430, "post_id": 39685036, "comment_id": 66706376, "body": "Converting rows to <code>[]map[string]interface{}</code> seems to be quite simple. I guess you try to achieve more than that. Why do you try to convert <code>v</code> to string?"}, {"owner": {"reputation": 8100, "user_id": 1649129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7d8650915f957acc8c1c01a36161a08?s=128&d=identicon&r=PG", "display_name": "Kiba", "link": "https://stackoverflow.com/users/1649129/kiba"}, "edited": false, "score": 0, "creation_date": 1474907524, "post_id": 39685036, "comment_id": 66713778, "body": "Yeah I removed that, thanks btw"}, {"owner": {"reputation": 8100, "user_id": 1649129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7d8650915f957acc8c1c01a36161a08?s=128&d=identicon&r=PG", "display_name": "Kiba", "link": "https://stackoverflow.com/users/1649129/kiba"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1474907542, "post_id": 39685036, "comment_id": 66713783, "body": "@putu I did not try that, will give that a show"}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1475019192, "post_id": 39685036, "comment_id": 66769543, "body": "I think you should be able to move your <code>valuePtrs[i] = &amp;values[i]</code> loop out of the <code>for rows.Next() { ... </code> loop. That said, I have been drinking..."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1475021104, "post_id": 39685036, "comment_id": 66770024, "body": "The ideal solution would be to define an iterator that wraps the sql.Rows() and produces JSON as it goes."}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1475021934, "post_id": 39685036, "comment_id": 66770239, "body": "This should be significantly more performant, especially for larger tables (O(1) allocs instead of O(N))."}, {"owner": {"reputation": 21, "user_id": 5761434, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LIPKBXYePIY/AAAAAAAAAAI/AAAAAAAAAFI/MKsQEoGdf34/photo.jpg?sz=128", "display_name": "\u866b\u5b50\u6a31\u6843", "link": "https://stackoverflow.com/users/5761434/%e8%99%ab%e5%ad%90%e6%a8%b1%e6%a1%83"}, "edited": false, "score": 0, "creation_date": 1560869013, "post_id": 39685036, "comment_id": 99874174, "body": "here are two Pakage will do <a href=\"https://github.com/elgs/gosqljson\" rel=\"nofollow noreferrer\">gosqljson</a> <a href=\"https://github.com/bdwilliams/go-jsonify\" rel=\"nofollow noreferrer\">go-jsonify</a>"}], "answers": [{"tags": [], "owner": {"reputation": 216, "user_id": 1926373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5o8s.jpg?s=128&g=1", "display_name": "Eddy K", "link": "https://stackoverflow.com/users/1926373/eddy-k"}, "is_accepted": true, "score": 7, "last_activity_date": 1474816625, "last_edit_date": 1474816625, "creation_date": 1474797599, "answer_id": 39685584, "question_id": 39685036, "link": "https://stackoverflow.com/questions/39685036/is-there-a-simple-way-to-convert-data-base-rows-to-json-in-golang/39685584#39685584", "title": "Is there a simple way to convert data base rows to JSON in Golang", "body": "<p>I'm dealing with the same issue, as far as my investigation goes it looks that there is <strong>no other way</strong>.</p>\n\n<p>All the packages that I have seen use basically the same method </p>\n\n<p>Few things you should know, hopefully will <strong>save you time</strong>: </p>\n\n<ul>\n<li>database/sql package converts all the data to the appropriate types</li>\n<li>if you are using the mysql driver(<strong>go-sql-driver/mysql</strong>) you need to add\nparams to your db string for it to return type time instead of a string\n(use ?parseTime=true, default is false)</li>\n</ul>\n\n<p>You can use tools that were written by the community, to offload the overhead:</p>\n\n<ul>\n<li><p>A minimalistic wrapper around database/sql, <a href=\"https://github.com/jmoiron/sqlx\" rel=\"noreferrer\">sqlx</a>, uses similar way internally   with reflection.</p></li>\n<li><p>If you need more functionality, try using an \"orm\": <a href=\"https://github.com/go-gorp/gorp\" rel=\"noreferrer\">gorp</a>, <a href=\"https://github.com/jinzhu/gorm\" rel=\"noreferrer\">gorm</a>.</p></li>\n</ul>\n\n<p>If you interested in diving deeper check out: </p>\n\n<ul>\n<li>Using reflection in sqlx package, <a href=\"https://github.com/jmoiron/sqlx/blob/master/sqlx.go\" rel=\"noreferrer\">sqlx.go</a> line 560</li>\n<li>Data type conversion in database/sql package, <a href=\"https://github.com/golang/go/blob/master/src/database/sql/convert.go\" rel=\"noreferrer\">convert.go</a> line 86</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "edited": false, "score": 0, "creation_date": 1474880203, "post_id": 39698021, "comment_id": 66695405, "body": "I recommend considering a better storage format.  If GO application is the only one working with data, GOB file format will work well.  If other languages are involved a formal XSD approach will work.  If you have a case of Department contains a user and user is of type Teacher or a Student, then the easy way to deal with it is to store it in 2 parts.  Add UserType (of type string) to department and store Department with user type.  Then use UserType to load known type of user.  Department - User example is a perfect demo of JSON limits."}], "tags": [], "owner": {"reputation": 1201, "user_id": 651028, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d5887835c21dace586b98180544c74e?s=128&d=identicon&r=PG", "display_name": "Sergei G", "link": "https://stackoverflow.com/users/651028/sergei-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1474879209, "last_edit_date": 1474879209, "creation_date": 1474878673, "answer_id": 39698021, "question_id": 39685036, "link": "https://stackoverflow.com/questions/39685036/is-there-a-simple-way-to-convert-data-base-rows-to-json-in-golang/39698021#39698021", "title": "Is there a simple way to convert data base rows to JSON in Golang", "body": "<p>If you know the data type that you are reading, then you can read into the data type without using generic interface.</p>\n\n<p>Otherwise, there is no solution regardless of the language used due to nature of JSON itself.  </p>\n\n<p>JSON does not have description of composite data structures.  In other words, JSON is a generic key-value structure.  When parser encounters what is supposed to be a specific structure there is no identification of that structure in JSON itself.  For example, if you have a structure User the parser would not know how a set of key-value pairs maps to your structure User.</p>\n\n<p>The problem of type recognition is usually addressed with document schema (a.k.a. XSD in XML world) or explicitly through passed expected data type.</p>\n"}, {"comments": [{"owner": {"reputation": 1973, "user_id": 2056426, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/Ge8I5.png?s=128&g=1", "display_name": "delos", "link": "https://stackoverflow.com/users/2056426/delos"}, "edited": false, "score": 0, "creation_date": 1490950251, "post_id": 43127413, "comment_id": 73349987, "body": "This is my preferred method as well, it&#39;s very easy to package in a project."}], "tags": [], "owner": {"reputation": 619, "user_id": 3681937, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1fd95ce98a95cde6007c850bbc0c5c3b?s=128&d=identicon&r=PG&f=1", "display_name": "DevShadow", "link": "https://stackoverflow.com/users/3681937/devshadow"}, "is_accepted": false, "score": 1, "last_activity_date": 1490904419, "creation_date": 1490904419, "answer_id": 43127413, "question_id": 39685036, "link": "https://stackoverflow.com/questions/39685036/is-there-a-simple-way-to-convert-data-base-rows-to-json-in-golang/43127413#43127413", "title": "Is there a simple way to convert data base rows to JSON in Golang", "body": "<p>One thing you could do is create a struct that models your data.</p>\n\n<p>**Note: I am using MS SQLServer</p>\n\n<p>So lets say you want to get a user</p>\n\n<pre><code>type User struct {\n    ID int `json:\"id,omitempty\"`\n    UserName string `json:\"user_name,omitempty\"`\n    ...\n}\n</code></pre>\n\n<p>then you can do this</p>\n\n<pre><code>func GetUser(w http.ResponseWriter, req *http.Request) {\n    var r Role\n    params := mux.Vars(req)\n\n    db, err := sql.Open(\"mssql\", \"server=ServerName\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err1 := db.QueryRow(\"select Id, UserName from [Your Datavse].dbo.Users where Id = ?\", params[\"id\"]).Scan(&amp;r.ID, &amp;r.Name)\n    if err1 != nil {\n        log.Fatal(err1)\n    }\n    json.NewEncoder(w).Encode(&amp;r)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n}\n</code></pre>\n\n<p>Here are the imports I used</p>\n\n<pre><code>import (\n    \"database/sql\"\n    \"net/http\"\n\n    \"log\"\n\n    \"encoding/json\"\n\n    _ \"github.com/denisenkom/go-mssqldb\"\n    \"github.com/gorilla/mux\"\n)\n</code></pre>\n\n<p>This allowed me to get data from the database and get it into JSON. </p>\n\n<p>This takes a while to code, but it works really well.</p>\n"}, {"tags": [], "owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "is_accepted": false, "score": 1, "last_activity_date": 1496364431, "creation_date": 1496364431, "answer_id": 44319200, "question_id": 39685036, "link": "https://stackoverflow.com/questions/39685036/is-there-a-simple-way-to-convert-data-base-rows-to-json-in-golang/44319200#44319200", "title": "Is there a simple way to convert data base rows to JSON in Golang", "body": "<p>Not in the Go distribution itself, but there is the wonderful <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">jmoiron/sqlx</a>:</p>\n\n<p><code>import \"github.com/jmoiron/sqlx\"</code></p>\n\n<pre><code>tableData := make([]map[string]interface{}, 0)\n\nfor rows.Next() {\n  entry := make(map[string]interface{})\n\n  err := rows.MapScan(entry)\n\n  if err != nil {\n    log.Fatal(\"SQL error: \" + err.Error())\n  }\n\n  tableData = append(tableData, entry)\n}\n</code></pre>\n"}], "owner": {"reputation": 8100, "user_id": 1649129, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e7d8650915f957acc8c1c01a36161a08?s=128&d=identicon&r=PG", "display_name": "Kiba", "link": "https://stackoverflow.com/users/1649129/kiba"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5391, "favorite_count": 3, "accepted_answer_id": 39685584, "answer_count": 4, "score": 8, "last_activity_date": 1560869013, "creation_date": 1474793533, "last_edit_date": 1494086081, "question_id": 39685036, "link": "https://stackoverflow.com/questions/39685036/is-there-a-simple-way-to-convert-data-base-rows-to-json-in-golang", "title": "Is there a simple way to convert data base rows to JSON in Golang", "body": "<p>Currently on what I've seen so far is that, converting database rows to JSON or to <code>[]map[string]interface{}</code> is not simple. I have to create two slices and then loop through columns and create keys every time. </p>\n\n<p>...Some code </p>\n\n<pre><code>tableData := make([]map[string]interface{}, 0)\n  values := make([]interface{}, count)\n  valuePtrs := make([]interface{}, count)\n  for rows.Next() {\n      for i := 0; i &lt; count; i++ {\n          valuePtrs[i] = &amp;values[i]\n      }\n      rows.Scan(valuePtrs...)\n      entry := make(map[string]interface{})\n      for i, col := range columns {\n          var v interface{}\n          val := values[i]\n          b, ok := val.([]byte)\n          if ok {\n              v = string(b)\n          } else {\n              v = val\n          }\n          entry[col] = v\n      }\n      tableData = append(tableData, entry)\n  }\n</code></pre>\n\n<p>Is there any package for this ? Or I am missing some basics here </p>\n"}, {"tags": ["intellij-idea", "go"], "answers": [{"tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": true, "score": 2, "last_activity_date": 1474832619, "last_edit_date": 1592644375, "creation_date": 1474832619, "answer_id": 39691098, "question_id": 39684417, "link": "https://stackoverflow.com/questions/39684417/how-to-use-wildcard-in-intellij-idea-arguments/39691098#39691098", "title": "how to use Wildcard in Intellij IDEA arguments", "body": "<p>The string <code>pg-*.txt</code> is referred to as a <a href=\"http://man7.org/linux/man-pages/man7/glob.7.html\" rel=\"nofollow noreferrer\">glob</a> pattern. In the latter example you are asking your shell to execute a given command which includes your glob pattern. The shell evaluates the glob pattern as a pre-processing step. The Go program then receives a list of files that have been matched by the pattern.</p>\n<p>You will have to update your IntelliJ settings to run the program within a shell as described in <a href=\"https://stackoverflow.com/questions/35120549/in-jetbrains-ides-e-g-clion-intellij-external-tools-cannot-use-globbing-pat\"><strong>In JetBrains IDEs (e.g. CLion, IntelliJ), external tools cannot use globbing patterns</strong></a> Stack Overflow question. By evaluating the initial go run command within a shell process your program will receive the arguments as expected.</p>\n<p>An alternative solution is to treat all your arguments as glob patterns and utilize the <a href=\"https://golang.org/pkg/path/filepath/#Glob\" rel=\"nofollow noreferrer\"><code>filepath.Glob(pattern string) (matches []string, err error)</code></a> function to manually expand on the provided argument. This strategy requires a little more preprocessing from your program but is more tolerant to the runtime environment. You can see an example of this kind of expansion in this <a href=\"https://play.golang.org/p/A-I1ohtgie\" rel=\"nofollow noreferrer\"><strong>Go Playground Example</strong></a>.</p>\n"}], "owner": {"reputation": 63, "user_id": 6405783, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh6.googleusercontent.com/-0_ctQVASWoo/AAAAAAAAAAI/AAAAAAAAACk/GeG9Ev2E5HY/photo.jpg?sz=128", "display_name": "Fanny ZMN", "link": "https://stackoverflow.com/users/6405783/fanny-zmn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1104, "favorite_count": 2, "accepted_answer_id": 39691098, "answer_count": 1, "score": 2, "last_activity_date": 1474832619, "creation_date": 1474788262, "question_id": 39684417, "link": "https://stackoverflow.com/questions/39684417/how-to-use-wildcard-in-intellij-idea-arguments", "title": "how to use Wildcard in Intellij IDEA arguments", "body": "<p>I use try add arguments in run configuration.</p>\n\n<p>I add <code>master sequential pg-*.txt</code>. But when I start running. the error come out.</p>\n\n<pre><code>/usr/local/go/bin/go run /home/asus/dev/6.824/src/main/wc.go master sequential pg-*.txt\nmaster: Starting Map/Reduce task wcseq\npanic: open pg-*.txt: no such file or directory\n</code></pre>\n\n<p>But I use the command in terminal is OK.</p>\n\n<pre><code>~/dev/6.824/src/main$ /usr/local/go/bin/go run /home/asus/dev/6.824/src/main/wc.go master sequential pg-*.txt\nmaster: Starting Map/Reduce task wcseq\nMerge: read mrtmp.wcseq-res-0\nMerge: read mrtmp.wcseq-res-1\nMerge: read mrtmp.wcseq-res-2\nmaster: Map/Reduce task completed\n</code></pre>\n\n<p>I think the problem is the Wildcard.So how to use Wildcard in Intellij IDEA arguments?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1474768754, "post_id": 39682392, "comment_id": 66665369, "body": "use the pointer of <code>config</code> instead of <code>config</code> itself"}, {"owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "reply_to_user": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1474799772, "post_id": 39682392, "comment_id": 66671242, "body": "Still the same error @simon_xia"}], "answers": [{"comments": [{"owner": {"reputation": 741, "user_id": 5490086, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-tlPFlZTHiCU/AAAAAAAAAAI/AAAAAAAAC24/mV9CKJQLXws/photo.jpg?sz=128", "display_name": "Alex Yan", "link": "https://stackoverflow.com/users/5490086/alex-yan"}, "edited": false, "score": 0, "creation_date": 1544043984, "post_id": 39689163, "comment_id": 94140958, "body": "That&#39;s a workaround, not a solution. if you were to use .Apply you should pass an interface.  say you have    <code>type config struct {...}</code>  you should do    <b>.Apply(change, &amp;config{})</b>"}], "tags": [], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "is_accepted": false, "score": 0, "last_activity_date": 1474820832, "creation_date": 1474820832, "answer_id": 39689163, "question_id": 39682392, "link": "https://stackoverflow.com/questions/39682392/error-when-attempting-to-set-a-map-in-mongodb-mgo/39689163#39689163", "title": "Error when attempting to set a map in Mongodb / mgo", "body": "<p>I fixed this by using <code>Update</code> instead of <code>FindId(id).Apply(change, nil)</code>. </p>\n"}], "owner": {"reputation": 3113, "user_id": 1541609, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/b489568449345d3e18dbf7aa4fa44f22?s=128&d=identicon&r=PG", "display_name": "Ewan Valentine", "link": "https://stackoverflow.com/users/1541609/ewan-valentine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474820832, "creation_date": 1474764655, "question_id": 39682392, "link": "https://stackoverflow.com/questions/39682392/error-when-attempting-to-set-a-map-in-mongodb-mgo", "title": "Error when attempting to set a map in Mongodb / mgo", "body": "<p>I have something like... </p>\n\n<pre><code>type Item struct {\n  Name string `json:\"name\" bson:\"name\"`\n  Config map[string]interface{} `json:\"config\" bson:\"config,inline\"`\n}\n\nfunc (repository *ItemRepository) UpdateConfig(id string, config map[string]interface{}) {\n  change := mgo.Change{\n    Update: bson.M{\"$set\": bson.M{\n      \"config\": config,\n    }},\n  },\n}\n</code></pre>\n\n<p>But I get an error <code>Raw Unmarshal can't deal with struct values. Use a pointer.</code>. I'm not entirely sure what this means, or what's expected. Is it possible to just store 'loose' data as a sub-document? </p>\n"}, {"tags": ["testing", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474758086, "post_id": 39681678, "comment_id": 66663665, "body": "Every directory is a package, and the tests need to run independent of each other."}], "answers": [{"tags": [], "owner": {"reputation": 17627, "user_id": 15061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/55fd56dfef815d7aa543be09ad3ed3e9?s=128&d=identicon&r=PG", "display_name": "Kamil Kisiel", "link": "https://stackoverflow.com/users/15061/kamil-kisiel"}, "is_accepted": false, "score": 4, "last_activity_date": 1474826308, "creation_date": 1474826308, "answer_id": 39690012, "question_id": 39681678, "link": "https://stackoverflow.com/questions/39681678/run-a-single-golang-httptest-server-for-all-tests-on-different-packages/39690012#39690012", "title": "Run a single Golang httptest server for all tests on different packages", "body": "<p>Each package's tests run as a separate binary, so there is no way to share setup and teardown state between packages. If you have a complex setup or teardown that you need to share across packages then you can create a testing package in your project which defines the test scaffold and call it from each test's <code>setup</code> and <code>teardown</code>.</p>\n"}], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 744, "favorite_count": 2, "answer_count": 1, "score": 2, "last_activity_date": 1474826308, "creation_date": 1474757529, "last_edit_date": 1474760017, "question_id": 39681678, "link": "https://stackoverflow.com/questions/39681678/run-a-single-golang-httptest-server-for-all-tests-on-different-packages", "title": "Run a single Golang httptest server for all tests on different packages", "body": "<p>My project folder is something like this. It a large API, I separate the files for organization pourposes only.</p>\n\n<p>$ tree src/backend/</p>\n\n<pre><code>src/backend/\n\u251c\u2500\u2500 cats\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 cat_test.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 handler.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 routes.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 tools.go\n\u251c\u2500\u2500 cmd\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 populate.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 root.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 runserver.go\n\u251c\u2500\u2500 iot\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 device\n\u2502\u00a0\u00a0 \u00a0\u00a0 \u251c\u2500\u2500 all.go\n\u2502\u00a0\u00a0 \u00a0\u00a0 \u251c\u2500\u2500 all_test.go\n\u2502\u00a0\u00a0  \u00a0\u00a0\u251c\u2500\u2500 router.go\n\u2502\u00a0\u00a0  \u00a0\u00a0\u251c\u2500\u2500 types.go\n\u2502\u00a0\u00a0  \u00a0\u00a0\u2514\u2500\u2500 update.go\n\u251c\u2500\u2500 main.go\n\u251c\u2500\u2500 main_test.go\n\u2514\u2500\u2500 root_test.go\n</code></pre>\n\n<p>On main_test.go I start the httptest server</p>\n\n<pre><code>func TestMain(m *testing.M) {\n    setup()\n    exitVal := m.Run()\n    teardown()\n    os.Exit(exitVal)\n}\n\nfunc setup() {\n    flag.StringVar(&amp;util.ServerFlag, \"server\", \"s\", \"server to set request for\")\n    flag.Parse()\n    viper.SetDefault(\"testing\", true)\n    util.BasicStart()\n    iot.RunDependencies()\n    cats.SyncS3()\n    router := cmd.InitRootRouter()\n    util.SetTestServer(httptest.NewServer(router))\n}\n\nfunc teardown() {\n    log.Println(\"[TESTS] - Teardown completed\")\n\n}\n</code></pre>\n\n<p>All the tests on <code>root_test.go</code>work perfctly when I run <code>go test -v ./src/backend/...</code>. But the test at <code>src/backend/cat_test.go</code> fail due to the fact that the teardown method has already been called by the time they run. How can I make the server wait for all test to be run before shutting down?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1474758903, "post_id": 39681086, "comment_id": 66663816, "body": "Some programming maybe? Stuff like ifs and fors?"}], "answers": [{"comments": [{"owner": {"reputation": 116, "user_id": 5530061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9ff44f733a61d535af5ea99b1fc656?s=128&d=identicon&r=PG&f=1", "display_name": "A Laurent", "link": "https://stackoverflow.com/users/5530061/a-laurent"}, "edited": false, "score": 0, "creation_date": 1474800726, "post_id": 39685362, "comment_id": 66671489, "body": "Thank you it works well, I did not know the package Reflect."}], "tags": [], "owner": {"reputation": 216, "user_id": 1926373, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/M5o8s.jpg?s=128&g=1", "display_name": "Eddy K", "link": "https://stackoverflow.com/users/1926373/eddy-k"}, "is_accepted": true, "score": 2, "last_activity_date": 1474796278, "last_edit_date": 1474796278, "creation_date": 1474795925, "answer_id": 39685362, "question_id": 39681086, "link": "https://stackoverflow.com/questions/39681086/filter-structure-with-several-parameters/39685362#39685362", "title": "Filter structure with several parameters", "body": "<p>Using golang package <strong>reflect</strong> in this particular case will be the best.</p>\n\n<p><strong>reflect</strong> will get you the fields of the struct and you can iterate\nover them comparing the values with the corresponding filter value.</p>\n\n<p>The example is <strong>specific</strong> to the struct that you provided, but you can easily modify it to <strong>apply to all</strong> structs, again using reflection.  </p>\n\n<p>Example: <a href=\"https://play.golang.org/p/Qfs6NdogEG\" rel=\"nofollow\">Go Playground</a></p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"reflect\"\n)\n\ntype cnts []cnt\n\ntype cnt struct {\n        ID    int    `json:\"Id\"`\n        Area  string `json:\"Area\"`\n        State string `json:\"State\"`\n        City  string `json:\"City\"`\n}\n// Filtering function\nfunc filterItem(val *cnt, filter map[string]string) bool {\n        item := reflect.ValueOf(val).Elem()\n        itemType := item.Type()\n        isValid := true\n        // Iterate over the struct fileds\n        for i := 0; i &lt; item.NumField(); i++ {\n                field := item.Field(i)\n                filterValue, ok := filter[itemType.Field(i).Name]\n                if ok {\n                        // filter out  \n                        if filterValue != field.Interface() {\n                                isValid = false\n                                break\n                        }\n                } \n\n        }\n\n        return isValid\n}\n\nfunc main() {\n        mycnts := cnts{\n                cnt{124, \"Here\", \"South\", \"Home\"},\n                cnt{125, \"Here\", \"West\", \"Home\"},\n                cnt{126, \"\", \"South\", \"Home\"},\n                cnt{127, \"Here\", \"West\", \"NY\"}}\n\n        // my maps with filter\n        mapFilter := map[string]string{\"Area\": \"Here\", \"City\": \"Home\"}\n        fmt.Println(mapFilter)\n\n        mycntsFilter := make(cnts, 0)\n        for _, val := range mycnts {\n               if filterItem(&amp;val, mapFilter) {\n                      mycntsFilter = append(mycntsFilter, val)\n               }\n        }\n        fmt.Println(mycntsFilter)\n}\n</code></pre>\n"}], "owner": {"reputation": 116, "user_id": 5530061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9ff44f733a61d535af5ea99b1fc656?s=128&d=identicon&r=PG&f=1", "display_name": "A Laurent", "link": "https://stackoverflow.com/users/5530061/a-laurent"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 85, "favorite_count": 1, "accepted_answer_id": 39685362, "answer_count": 1, "score": 0, "last_activity_date": 1474796278, "creation_date": 1474752177, "question_id": 39681086, "link": "https://stackoverflow.com/questions/39681086/filter-structure-with-several-parameters", "title": "Filter structure with several parameters", "body": "<p>I have an array of a struct and a maps with variable name and some filter values.\nI want to filter my array with my maps.</p>\n\n<p>Example <a href=\"https://play.golang.org/p/ECvxU0S8Lj\" rel=\"nofollow\">Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype cnts []cnt\n\ntype cnt struct {\n    ID    int    `json:\"Id\"`\n    Area  string `json:\"Area\"`\n    State string `json:\"State\"`\n    City  string `json:\"City\"`\n}\n\nfunc main() {\n    mycnts := cnts{\n        cnt{124, \"Here\", \"South\", \"Home\"},\n        cnt{125, \"Here\", \"West\", \"Home\"},\n        cnt{126, \"\", \"South\", \"Home\"},\n        cnt{127, \"Here\", \"West\", \"NY\"}}\n    // my maps with filter\n    mapFilter := map[string]string{\"Area\": \"Here\", \"City\": \"Home\"}\n    fmt.Println(mapFilter)\n\n    mycntsFilter := make(cnts, 0)\n    for _, val := range mycnts {\n        // I want to select only row where the map filter it's ok\n        mycntsFilter = append(mycntsFilter, val)\n        fmt.Println(val, mycntsFilter)\n   }\n}\n</code></pre>\n\n<p>What is the best way to filter my data with dynamic filter (Represente here by a map of string)?</p>\n"}, {"tags": ["go", "yaml"], "comments": [{"owner": {"reputation": 2753, "user_id": 2009612, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/VGBK2.jpg?s=128&g=1", "display_name": "FilBot3", "link": "https://stackoverflow.com/users/2009612/filbot3"}, "edited": false, "score": 0, "creation_date": 1474837081, "post_id": 39680445, "comment_id": 66682800, "body": "Almost, @putu answer solved my issue."}], "answers": [{"comments": [{"owner": {"reputation": 2753, "user_id": 2009612, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/VGBK2.jpg?s=128&g=1", "display_name": "FilBot3", "link": "https://stackoverflow.com/users/2009612/filbot3"}, "edited": false, "score": 0, "creation_date": 1474836879, "post_id": 39682970, "comment_id": 66682743, "body": "I can&#39;t believe that changing my time format was what was keeping me from getting this to work. Thank you. I wasn&#39;t aware of the RFC3339 Document. Thank you putu"}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 3, "last_activity_date": 1474772571, "creation_date": 1474772571, "answer_id": 39682970, "question_id": 39680445, "link": "https://stackoverflow.com/questions/39680445/go-reading-yaml-file-and-mapping-to-slice-of-structs/39682970#39682970", "title": "GO reading YAML file and mapping to slice of structs", "body": "<p>First, by adding <code>checkerr(err)</code> after </p>\n\n<pre><code>err = yaml.Unmarshal(gtt_config, &amp;td)\n</code></pre>\n\n<p>you will get the corresponding error which is <code>time parsing error</code>. The <code>yaml</code> decoder expect time in <a href=\"https://golang.org/pkg/time/#pkg-constants\" rel=\"nofollow\">RFC3339</a> format. There are several ways to fix this:</p>\n\n<ol>\n<li>Change time data in your YAML file to RFC3339 format, e.g. <code>\"2012-10-31T15:50:13.793654Z\"</code></li>\n<li>If you can not modify the YAML file you need to implement custom decoder.</li>\n</ol>\n\n<p>For (2), two solutions come to my mind:</p>\n\n<ol>\n<li>Implement <code>yaml.Unmarshaler</code> interface, or</li>\n<li>Wrap <code>time.Time</code> to a custom type then implement <code>encoding.TextUnmarshaler</code> interface</li>\n</ol>\n\n<p>Solution (1): You need to implement custom Unmarshaler for <code>Date_File</code> and <code>Time_Data</code> types. Add the following to your source code.</p>\n\n<pre><code>func (df *Date_File) UnmarshalYAML(unmarshal func(interface{}) error) error {\n    //Unmarshal time to string then convert to time.Time manually\n    var tmp struct {\n        Owner    string      `yaml:\"owner\"`\n        Init     string      `yaml:\"initialized\"`\n        TimeData []Time_Data `yaml:\"time_data\"`\n    }\n    if err := unmarshal(&amp;tmp); err != nil {\n        return err;\n    }\n\n    const layout = \"2006-01-02 15:04:05.999999999 -0700 MST\"\n    tm, err := time.Parse(layout, tmp.Init)\n    if err != nil {\n        return err\n    }\n\n    df.Owner    = tmp.Owner\n    df.Init     = tm\n    df.TimeData = tmp.TimeData\n\n    return nil\n}\n\nfunc (td *Time_Data) UnmarshalYAML(unmarshal func(interface{}) error) error {\n    //Unmarshal time to string then convert to time.Time manually\n    var tmp struct {\n        Action string `yaml:\"action\"`\n        Time   string `yaml:\"time\"`\n    }\n    if err := unmarshal(&amp;tmp); err != nil {\n        return err;\n    }\n\n    const layout = \"2006-01-02 15:04:05.999999999 -0700 MST\"\n    tm, err := time.Parse(layout, tmp.Time)\n    if err != nil {\n        return err\n    }\n\n    td.Action = tmp.Action\n    td.Time   = tm\n\n    return nil\n}\n</code></pre>\n\n<p>If you have many <code>types</code> having <code>time.Time</code> field, solution (1) maybe impractical.</p>\n\n<p>Solution (2): If you look at source code of <a href=\"https://github.com/go-yaml/yaml/search?utf8=%E2%9C%93&amp;q=UnmarshalText\" rel=\"nofollow\">yaml decoder</a>, it rely on <code>TextUnmarshaler</code> to convert string to corresponding type. Here you need to:</p>\n\n<ol>\n<li>Define custom time type (e.g. <code>CustomTime</code>)</li>\n<li>Replace each <code>time.Time</code> field in your struct with <code>CustomTime</code></li>\n<li>Implement <code>UnmarshalText</code></li>\n</ol>\n\n<p>The snippet for (3):</p>\n\n<pre><code>type CustomTime struct {\n    time.Time\n}\nfunc (tm *CustomTime) UnmarshalText(text []byte) error {\n    const layout = \"2006-01-02 15:04:05.999999999 -0700 MST\"\n    tmValue, err := time.Parse(layout, string(text))\n    if err != nil {\n        return err\n    }\n\n    tm.Time = tmValue\n    return nil    \n}\n//Not directly related, for print function etc.\nfunc (tm CustomTime) String() string {\n    return tm.Time.String()\n}\n</code></pre>\n"}], "owner": {"reputation": 2753, "user_id": 2009612, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/VGBK2.jpg?s=128&g=1", "display_name": "FilBot3", "link": "https://stackoverflow.com/users/2009612/filbot3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3754, "favorite_count": 0, "accepted_answer_id": 39682970, "answer_count": 1, "score": 0, "last_activity_date": 1474772571, "creation_date": 1474747321, "question_id": 39680445, "link": "https://stackoverflow.com/questions/39680445/go-reading-yaml-file-and-mapping-to-slice-of-structs", "title": "GO reading YAML file and mapping to slice of structs", "body": "<p>I'm attempting to read a YAML file using GO and mapping it to a structure that I've defined. <a href=\"https://gist.github.com/predatorian3/3c89d50bbbb0a20eecd61e56111f7985#file-go_time_tracker-yml\" rel=\"nofollow\">The YAML is below</a>: </p>\n\n<pre><code>--- # go_time_tracker.yml\nowner: \"Phillip Dudley\"\ninitialized: \"2012-10-31 15:50:13.793654 +0000 UTC\"\ntime_data:\n  - action: \"start\"\n    time: \"2012-10-31 15:50:13.793654 +0000 UTC\"\n  - action: \"stop\"\ntime: \"2012-10-31 16:00:00.000000 +0000 UTC\"\n</code></pre>\n\n<p>I used <a href=\"https://gist.github.com/predatorian3/3c89d50bbbb0a20eecd61e56111f7985#file-go_yaml_practice-go\" rel=\"nofollow\">the following code</a> to read in the file, Unmarshal the data, and then print some of the data. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"gopkg.in/yaml.v2\"\n    \"io/ioutil\"\n    \"log\"\n    \"time\"\n)\n\ntype Date_File struct {\n    Owner    string      `yaml:\"owner\"`\n    Init     time.Time   `yaml:\"initialized\"`\n    TimeData []Time_Data `yaml:\"time_data\"`\n}\n\ntype Time_Data struct {\n    //\n    Action string    `yaml:\"action\"`\n    Time   time.Time `yaml:\"time\"`\n}\n\nfunc checkerr(err error) {\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc read() (td *Date_File) {\n    //td := &amp;Date_File{}\n    gtt_config, err := ioutil.ReadFile(\"go_time_tracker.yml\")\n    checkerr(err)\n    err = yaml.Unmarshal(gtt_config, &amp;td)\n    return td\n}\n\nfunc main() {\n    //\n    time_data := read()\n    fmt.Println(time_data)\n    fmt.Println(time_data.TimeData[0])\n    fmt.Println(time_data.Owner)\n}\n</code></pre>\n\n<p>When I run this, the first <code>fmt.Println(time_data)</code> works, showing the reference and its data. The next line though fails saying that the index is out of range. <a href=\"https://gist.github.com/predatorian3/3c89d50bbbb0a20eecd61e56111f7985#file-go_yaml_practice_error_output-sh\" rel=\"nofollow\">This is the error</a>: </p>\n\n<pre><code>$ go run yaml_practice_2.go \n&amp;{Phillip Dudley 0001-01-01 00:00:00 +0000 UTC []}\npanic: runtime error: index out of range\n\ngoroutine 1 [running]:\npanic(0x559840, 0xc82000a0e0)\n    /usr/lib/go-1.6/src/runtime/panic.go:481 +0x3e6\nmain.main()\n    /home/predatorian/Documents/go/src/predatorian/yaml/yaml_practice_2.go:41 +0x2aa\nexit status 2\n</code></pre>\n\n<p>I then thought maybe my YAML wasn't formatted properly, so I loaded the YAML file into Ruby's IRB, and <a href=\"https://gist.github.com/predatorian3/3c89d50bbbb0a20eecd61e56111f7985#file-irb_reading_go_time_tracker-rb\" rel=\"nofollow\">this is what I got</a>. </p>\n\n<pre><code>irb(main):004:0&gt; data2 = YAML.load(File.read(\"go_time_tracker.yml\"))\n=&gt; {\"owner\"=&gt;\"Phillip Dudley\", \"initialized\"=&gt;\"2012-10-31 15:50:13.793654 +0000 UTC\", \"time_data\"=&gt;[{\"action\"=&gt;\"start\", \"time\"=&gt;\"2012-10-31 15:50:13.793654 +0000 UTC\"}, {\"action\"=&gt;\"stop\", \"time\"=&gt;\"2012-10-31 16:00:00.000000 +0000 UTC\"}]}\n</code></pre>\n\n<p>The IRB output shows that my YAML is formatted properly, however, I don't think I'm Unmarshalling it properly then. However, I'm not sure what I would need to do to get this to work. I'm sure I'm not thinking of how to do this properly since Ruby hides a lot of it. </p>\n"}, {"tags": ["go", "cross-compiling", "freebsd", "coredump"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1474773743, "post_id": 39678131, "comment_id": 66666014, "body": "How if you add <code>GOARM=6</code> or even lower arm version (v5) when cross compiling?"}], "answers": [{"tags": [], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "is_accepted": true, "score": 2, "last_activity_date": 1474826039, "creation_date": 1474826039, "answer_id": 39689964, "question_id": 39678131, "link": "https://stackoverflow.com/questions/39678131/how-to-cross-compile-go-application-for-freebsd-within-a-raspberry-pi-1-model-b/39689964#39689964", "title": "How to cross compile go application for FreeBSD within a Raspberry pi 1 model B", "body": "<p>Thanks to @putu comment, I was available to cross-compile using <code>GOARM=6</code></p>\n\n<pre><code>env GOOS=freebsd GOARCH=arm GOARM=6 go build\n</code></pre>\n"}], "owner": {"reputation": 20521, "user_id": 1135424, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/rvwBS.jpg?s=128&g=1", "display_name": "nbari", "link": "https://stackoverflow.com/users/1135424/nbari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1819, "favorite_count": 0, "accepted_answer_id": 39689964, "answer_count": 1, "score": 1, "last_activity_date": 1548226475, "creation_date": 1474731799, "last_edit_date": 1548226475, "question_id": 39678131, "link": "https://stackoverflow.com/questions/39678131/how-to-cross-compile-go-application-for-freebsd-within-a-raspberry-pi-1-model-b", "title": "How to cross compile go application for FreeBSD within a Raspberry pi 1 model B", "body": "<p>On a <a href=\"https://www.raspberrypi.org/products/model-b/\" rel=\"nofollow noreferrer\">Raspberry Pi 1 model B</a> I installed <a href=\"https://www.freebsd.org/where.html\" rel=\"nofollow noreferrer\">FreeBSD 10.3</a> using the SD Card Images <a href=\"ftp://ftp.freebsd.org/pub/FreeBSD/releases/arm/armv6/ISO-IMAGES/10.3/FreeBSD-10.3-RELEASE-arm-armv6-RPI-B.img.xz\" rel=\"nofollow noreferrer\">RPI-B</a>.</p>\n\n<p>I can boot, get network, ssh into it, etc, all seems to be ok and functional. This is part of the dmesg output:</p>\n\n<pre><code>FreeBSD 10.3-RELEASE #0 r297264: Fri Mar 25 08:01:14 UTC 2016\n    root@releng1.nyi.freebsd.org:/usr/obj/arm.armv6/usr/src/sys/RPI-B arm\nFreeBSD clang version 3.4.1 (tags/RELEASE_34/dot1-final 208032) 20140512\nVT: init without driver.\nCPU: ARM1176JZ-S rev 7 (ARM11J core)\n Supported features: ARM_ISA THUMB2 JAZELLE ARMv4 Security_Ext\n WB enabled LABT branch prediction enabled\n  16KB/32B 4-way instruction cache\n  16KB/32B 4-way write-back-locking-C data cache\nreal memory  = 503312384 (479 MB)\navail memory = 483127296 (460 MB)\n</code></pre>\n\n<p>On a mac os X (10.11.6) with go 1.7.1:</p>\n\n<pre><code>go version go1.7.1 darwin/amd64\n</code></pre>\n\n<p>I am cross compile this code:</p>\n\n<p></p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"time\"\n)\n\nfunc main() {\n        t := time.Now().UTC()\n        fmt.Println(\"Location:\", t.Location(), \":Time:\", t.Format(time.RFC3339Nano))\n}\n</code></pre>\n\n<p>With:</p>\n\n<pre><code>env GOOS=freebsd GOARCH=arm go build\n</code></pre>\n\n<p>Running the generated binary on the raspberry-pi generates a coredump:</p>\n\n<pre><code>freebsd@rpi-b:~ % ./time \nIllegal instruction (core dumped)\n</code></pre>\n\n<p>On the <code>time.core</code> after typing:</p>\n\n<pre><code>$ strings time.core\n</code></pre>\n\n<p>besides many characters I see this:</p>\n\n<pre><code>fatal error: cgo callback before cgo call\n</code></pre>\n\n<p>Any idea how what flags to use or how to properly cross-compile for FreeBSD within a Raspberry pi ?</p>\n"}, {"tags": ["logging", "go", "openshift"], "comments": [{"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1474740588, "post_id": 39677779, "comment_id": 66659225, "body": "Are you using the standard go <code>log</code> package?"}, {"owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "reply_to_user": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1474740750, "post_id": 39677779, "comment_id": 66659270, "body": "@BenCampbell yes."}, {"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1474741748, "post_id": 39677779, "comment_id": 66659560, "body": "If you&#39;re properly removing write permissions from the <code>go.log</code> there&#39;s no way it&#39;s writing unless it&#39;s smart enough to <code>chmod</code> the file. Could you try <code>chmod 544</code> on it and check if writes still occur?"}, {"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 1, "creation_date": 1474744166, "post_id": 39677779, "comment_id": 66660293, "body": "After looking at the Openshift documentation for a few minutes, I discovered you can leverage their log rotation by redirecting your output as described here: <a href=\"https://access.redhat.com/documentation/en-US/OpenShift_Enterprise/2/html/Cartridge_Specification_Guide/chap-Enabling_Logshifter.html\" rel=\"nofollow noreferrer\">access.redhat.com/documentation/en-US/OpenShift_Enterprise/2&zwnj;&#8203;/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "edited": false, "score": 0, "creation_date": 1474743443, "post_id": 39679835, "comment_id": 66660065, "body": "There are other strategies that could be utilized with the <code>SetOutput</code> function. You could create an n size ring buffer that the logger could writer to that is flushed to disk periodically. This would allow you to have the last n bytes the logger has written."}, {"owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "edited": false, "score": 0, "creation_date": 1474746097, "post_id": 39679835, "comment_id": 66660840, "body": "thankyou for the detailed answer. Yes, I probably should turn towards a more verbose logging library. Until I do so, I will be happy to use the SetOutput workaround in order to address my situation at hand. Thanks again!"}], "tags": [], "owner": {"reputation": 3488, "user_id": 328504, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c066fa1944f2b8cd2bf31c5ac1b54abd?s=128&d=identicon&r=PG", "display_name": "Ben Campbell", "link": "https://stackoverflow.com/users/328504/ben-campbell"}, "is_accepted": true, "score": 2, "last_activity_date": 1474743059, "last_edit_date": 1592644375, "creation_date": 1474743059, "answer_id": 39679835, "question_id": 39677779, "link": "https://stackoverflow.com/questions/39677779/stop-appending-logs-into-go-log-file/39679835#39679835", "title": "Stop appending logs into go.log file", "body": "<p>Ideally, you would want to use a logger that facilitates log levels. This would allow you to adjust the verbosity of logs based on the current runtime context. You can look at the <a href=\"https://stackoverflow.com/questions/16895651/how-to-implement-level-based-logging-in-golang\"><strong>How to implement level based logging in golang</strong></a> question for a wealth of information and packages to facilitate log levels. As a developer, you can include INFO and DEBUG logging statements which, when deployed with a lower log level, will not be included in your logging output.</p>\n<p>If your in a pinch and need to disable the logging in your current implementation you can configure the native go <a href=\"https://golang.org/pkg/log/#Logger\" rel=\"nofollow noreferrer\"><code>Logger</code></a> output writer using the <a href=\"https://golang.org/pkg/log/#SetOutput\" rel=\"nofollow noreferrer\">SetOutput(output io.Writer)</a> function. The default <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow noreferrer\">Writer</a> used by the <code>log</code> package is <em>STDERR</em>. The <code>ioutil</code> package provides a top level <a href=\"https://golang.org/pkg/io/ioutil/#pkg-variables\" rel=\"nofollow noreferrer\"><code>Discard</code></a> Writer that you can use to prevent the logger from writing anything. You would have to update your application initialization to set the output of the logger based on the environment.</p>\n<pre><code>package main\n\nimport (\n    &quot;fmt&quot;\n    &quot;io/ioutil&quot;\n    &quot;log&quot;\n)\n\nfunc main() {\n    var shouldEnableLogging bool = false\n\n    if !shouldEnableLogging {\n        fmt.Println(&quot;Disabled logging&quot;)\n        log.SetOutput(ioutil.Discard)\n    }\n\n    for i := 0; i &lt; 5; i++ {\n        log.Printf(&quot;I logging statement %d&quot;, i)\n    }\n}\n</code></pre>\n<p>You can adjust the bool flag in this snippet to see this in action at this code in the <a href=\"https://play.golang.org/p/t7fZv4ejP-\" rel=\"nofollow noreferrer\"><strong>Go Playground</strong></a>. This will prevent your file space from filling up with logs, but you will loose all logs all together which is not advisable for any application.</p>\n"}], "owner": {"reputation": 711, "user_id": 6178021, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/vhabx.jpg?s=128&g=1", "display_name": "Tanmay Garg", "link": "https://stackoverflow.com/users/6178021/tanmay-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 314, "favorite_count": 1, "accepted_answer_id": 39679835, "answer_count": 1, "score": 2, "last_activity_date": 1474768989, "creation_date": 1474729407, "last_edit_date": 1474768989, "question_id": 39677779, "link": "https://stackoverflow.com/questions/39677779/stop-appending-logs-into-go-log-file", "title": "Stop appending logs into go.log file", "body": "<p>I have deployed my Go application on Openshift using the Go 1.5.2 cartridge. As a good practice, I have made it a habit to generate logs about anything that goes down with the application. But this habit is proving to be costly in the Openshift environment because of the limited storage (1 GB) provided to me. The logs are easily exceeding the 10 MB mark within a few second of usage, and I fear my application will run out of space if I leave the log file unadministered. Currently, I am clearing the log file manually after regular intervals.</p>\n\n<p>Is there any way I could stop the appending of logs onto the file, or maybe stop the generation of logs altogether (without affecting my original application code)? I have tried by revoking write privileges from the file, but the logs keep appearing anyways.</p>\n"}, {"tags": ["go", "abstract-syntax-tree"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474721314, "post_id": 39676075, "comment_id": 66653255, "body": "It&#39;s generally much easier to insert the text in the source directly, rather than manipulate the AST"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1474731149, "post_id": 39676075, "comment_id": 66656281, "body": "After modifying the source directly, use <a href=\"https://godoc.org/go/format#Source\" rel=\"nofollow noreferrer\">format.Source</a> to gofmt the code."}, {"owner": {"reputation": 2892, "user_id": 685395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/85df783760deaebcd9050a5d49da0b65?s=128&d=identicon&r=PG", "display_name": "microo8", "link": "https://stackoverflow.com/users/685395/microo8"}, "edited": false, "score": 0, "creation_date": 1474743305, "post_id": 39676075, "comment_id": 66660020, "body": "But this is just one thing im doing with the source code. I&#39;m also changing the input parameters of exported functions based by the types etc. so the I want the import &quot;C&quot; make with the ast package"}], "owner": {"reputation": 2892, "user_id": 685395, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/85df783760deaebcd9050a5d49da0b65?s=128&d=identicon&r=PG", "display_name": "microo8", "link": "https://stackoverflow.com/users/685395/microo8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 312, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1474718269, "creation_date": 1474718269, "question_id": 39676075, "link": "https://stackoverflow.com/questions/39676075/golang-ast-add-import-c", "title": "Golang AST - add import &quot;C&quot;", "body": "<p>I'm trying to add an <code>import \"C\"</code> to the AST at the begining. I want to add also some doc comment to the import node. want to look like this:</p>\n\n<pre><code>package main\n\n/*\n#include \"postgres.h\"\n#include \"fmgr.h\"\n*/\nimport \"C\"\n\nfunc main() {}\n</code></pre>\n\n<p>Doing this:</p>\n\n<pre><code>//parse the file\nfset := token.NewFileSet()\nf, err := parser.ParseDir(fset, dir, nil, parser.ParseComments)\nif err != nil {\n    panic(err)\n}\n//get the package main\npackageAst, ok := f[\"main\"]\nif !ok {\n    fmt.Println(\"No package main in\", dir)\n    return\n}\n//add the import \"C\" with the comment\nfor _, file := range packageAst.Files {\n    comment := &amp;ast.CommentGroup{\n        List: []*ast.Comment{\n            &amp;ast.Comment{\n                Slash: file.Package,\n                Text:  \"/*\\n#include \\\"postgres.h\\\"\\n#include \\\"fmgr.h\\\"\\n*/\",\n            },\n        },\n    }\n    importC := &amp;ast.GenDecl{\n        TokPos: file.Package,\n        Tok:    token.IMPORT,\n        Specs:  []ast.Spec{&amp;ast.ImportSpec{Doc: comment, Path: &amp;ast.BasicLit{Kind: token.STRING, Value: \"\\\"C\\\"\"}}},\n    }\n    file.Decls = append([]ast.Decl{importC}, file.Decls...)\n    break\n}\n</code></pre>\n\n<p>And the output is this:</p>\n\n<pre><code>package main\n\nimport \"C\"\n\nfunc main() {}\n</code></pre>\n\n<p>The comment is not there. What I'm doing wrong?</p>\n"}, {"tags": ["go", "freebsd"], "answers": [{"comments": [{"owner": {"reputation": 23850, "user_id": 196679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fXUzE.jpg?s=128&g=1", "display_name": "Bazzz", "link": "https://stackoverflow.com/users/196679/bazzz"}, "edited": false, "score": 0, "creation_date": 1475254290, "post_id": 39690338, "comment_id": 66885588, "body": "That&#39;s very contra intuitive. I tried using <code>os&#47;exec</code> first but it gave me <code>error code 1</code> every time, which I assumed means &quot;arguments error&quot;. Then I went to the source code to find out what it might mean and ended up at <code>os.StartProcess</code>. Perhaps <code>os&#47;exec</code> also expects the name and again the same name as the first argument?"}], "tags": [], "owner": {"reputation": 17627, "user_id": 15061, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/55fd56dfef815d7aa543be09ad3ed3e9?s=128&d=identicon&r=PG", "display_name": "Kamil Kisiel", "link": "https://stackoverflow.com/users/15061/kamil-kisiel"}, "is_accepted": true, "score": 0, "last_activity_date": 1474828234, "creation_date": 1474828234, "answer_id": 39690338, "question_id": 39675111, "link": "https://stackoverflow.com/questions/39675111/how-to-add-arguments-to-os-startprocess-on-freebsd/39690338#39690338", "title": "How to add arguments to os.StartProcess on FreeBSD?", "body": "<p>The first element of args is the process name. <code>args[1]</code> is the actual first argument. This is just like the <code>os.Args</code> (and <code>argv</code> in C) lists work. To avoid dealing with these low level details you should just use the <code>os/exec</code> package to launch external processes.</p>\n"}], "owner": {"reputation": 23850, "user_id": 196679, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fXUzE.jpg?s=128&g=1", "display_name": "Bazzz", "link": "https://stackoverflow.com/users/196679/bazzz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 139, "favorite_count": 0, "accepted_answer_id": 39690338, "answer_count": 1, "score": 3, "last_activity_date": 1474828234, "creation_date": 1474711569, "question_id": 39675111, "link": "https://stackoverflow.com/questions/39675111/how-to-add-arguments-to-os-startprocess-on-freebsd", "title": "How to add arguments to os.StartProcess on FreeBSD?", "body": "<p>I'm trying to use <code>os.StartProcess</code> to start a process with arguments on a FreeBSD machine. After trying several different ways of adding the correct arguments and always getting errors I have set up this simple proof of concept. </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    command := \"/usr/local/sbin/pkg\"\n    args := []string{\"install\"}\n\n    procAttr := new(os.ProcAttr)\n    procAttr.Files = []*os.File{os.Stdin, os.Stdout, os.Stderr}\n    if process, err := os.StartProcess(command, args, procAttr); err != nil {\n        log.Println(err.Error())\n    } else {\n        log.Printf(\"%d\", process.Pid)\n    }\n}\n</code></pre>\n\n<p>The idea here is that if the system starts just <code>pkg</code> it will complain about missing arguments, but if it starts <code>pkg install</code> it will suggest the help for the <code>install</code> command. See below:</p>\n\n<pre><code>pkg: not enough arguments\nUsage: pkg [-v] [-d] [-l] [-N] [-j &lt;jail name or id&gt;|-c &lt;chroot path&gt;|-r &lt;rootdir&gt;] [-C &lt;configuration file&gt;] [-R &lt;repo config dir&gt;] [-o var=value] [-4|-6] &lt;command&gt; [&lt;args&gt;]\n\nFor more information on available commands and options see 'pkg help'.\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>Usage: pkg install [-AfInFMqRUy] [-r reponame] [-Cgix] &lt;pkg-name&gt; ...\n\nFor more information see 'pkg help install'.\n</code></pre>\n\n<p>When I use the go code above it will complaint about missing arguments, so why is my argument 'install' not added to the command, and how to correct my code?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 99, "user_id": 524060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89b01fb690d62919432f902117b7fcb?s=128&d=identicon&r=PG", "display_name": "abiosoft", "link": "https://stackoverflow.com/users/524060/abiosoft"}, "edited": false, "score": 0, "creation_date": 1474708358, "post_id": 39674575, "comment_id": 66649724, "body": "Does <code>go build</code> work ? What argument(s) do you pass to <code>go run</code> both in your terminal and VS Code&#39;s."}, {"owner": {"reputation": 1531, "user_id": 976035, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/913e70d8b28f4ea2bd30a735e23d25b2?s=128&d=identicon&r=PG", "display_name": "Finks", "link": "https://stackoverflow.com/users/976035/finks"}, "reply_to_user": {"reputation": 99, "user_id": 524060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89b01fb690d62919432f902117b7fcb?s=128&d=identicon&r=PG", "display_name": "abiosoft", "link": "https://stackoverflow.com/users/524060/abiosoft"}, "edited": false, "score": 0, "creation_date": 1474709033, "post_id": 39674575, "comment_id": 66649905, "body": "I run <code>go run main.go</code> on both terminal. I will edit my question"}, {"owner": {"reputation": 99, "user_id": 524060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89b01fb690d62919432f902117b7fcb?s=128&d=identicon&r=PG", "display_name": "abiosoft", "link": "https://stackoverflow.com/users/524060/abiosoft"}, "edited": false, "score": 0, "creation_date": 1474711399, "post_id": 39674575, "comment_id": 66650536, "body": "What is value of <code>GO15VENDOREXPERIMENT</code> in both terminal ?"}, {"owner": {"reputation": 1531, "user_id": 976035, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/913e70d8b28f4ea2bd30a735e23d25b2?s=128&d=identicon&r=PG", "display_name": "Finks", "link": "https://stackoverflow.com/users/976035/finks"}, "reply_to_user": {"reputation": 99, "user_id": 524060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c89b01fb690d62919432f902117b7fcb?s=128&d=identicon&r=PG", "display_name": "abiosoft", "link": "https://stackoverflow.com/users/524060/abiosoft"}, "edited": false, "score": 0, "creation_date": 1474712353, "post_id": 39674575, "comment_id": 66650857, "body": "They&#39;re both 1. I will post the value of <code>go env</code>"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1474721754, "post_id": 39674575, "comment_id": 66653383, "body": "For me this has always been a result of packages missing from vendor/, try downloading all unvendored packages with <code>go get -u github.com&#47;kardianos&#47;govendor; cd geodude; govendor fetch +external</code> or similar"}], "answers": [{"tags": [], "owner": {"reputation": 1531, "user_id": 976035, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/913e70d8b28f4ea2bd30a735e23d25b2?s=128&d=identicon&r=PG", "display_name": "Finks", "link": "https://stackoverflow.com/users/976035/finks"}, "is_accepted": true, "score": 1, "last_activity_date": 1474865253, "last_edit_date": 1474865253, "creation_date": 1474809441, "answer_id": 39687252, "question_id": 39674575, "link": "https://stackoverflow.com/questions/39674575/cannot-use-context-as-type-handlerfunc-gin-gonic/39687252#39687252", "title": "cannot use Context as type &quot;handlerfunc&quot; gin-gonic", "body": "<p>OK, sorry about all this mess but what worked for me is to uninstall <code>Go</code> and reinstall it again. Previously, <code>Go</code> was installed on my machine using Homebrew. When I reinstalled it, I used google's mac installer. Now all was fine again.</p>\n\n<p>Thanks for helping.</p>\n"}, {"tags": [], "owner": {"reputation": 1053, "user_id": 1061664, "user_type": "registered", "accept_rate": 36, "profile_image": "https://i.stack.imgur.com/zGsvQ.jpg?s=128&g=1", "display_name": "Girish Gupta", "link": "https://stackoverflow.com/users/1061664/girish-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1563456311, "creation_date": 1563456311, "answer_id": 57095587, "question_id": 39674575, "link": "https://stackoverflow.com/questions/39674575/cannot-use-context-as-type-handlerfunc-gin-gonic/57095587#57095587", "title": "cannot use Context as type &quot;handlerfunc&quot; gin-gonic", "body": "<pre><code>go get -u github.com/gin-gonic/gin\ngovendor add +e\n</code></pre>\n"}], "owner": {"reputation": 1531, "user_id": 976035, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/913e70d8b28f4ea2bd30a735e23d25b2?s=128&d=identicon&r=PG", "display_name": "Finks", "link": "https://stackoverflow.com/users/976035/finks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1785, "favorite_count": 1, "accepted_answer_id": 39687252, "answer_count": 2, "score": 1, "last_activity_date": 1563456311, "creation_date": 1474707992, "last_edit_date": 1474712899, "question_id": 39674575, "link": "https://stackoverflow.com/questions/39674575/cannot-use-context-as-type-handlerfunc-gin-gonic", "title": "cannot use Context as type &quot;handlerfunc&quot; gin-gonic", "body": "<p>This has been bugging me for a long time. I'm using gin-gonic and everytime I try and use <code>go run main.go</code>, this compile error always appears: </p>\n\n<blockquote>\n  <p>cannot use properties.Pong (type\n  func(*\"github.com/carlqt/geodude/vendor/github.com/gin-gonic/gin\".Context)) as type \"github.com/gin-gonic/gin\".HandlerFunc in argument to\n  router.RouterGroup.GET</p>\n</blockquote>\n\n<p>But when I use Visual Studio Code terminal and run the <code>go run</code>, it works.</p>\n\n<p>here's the main.go file <a href=\"https://gist.github.com/carlqt/c5f6b0d127c1ca124cf2fe8d620976a1\" rel=\"nofollow noreferrer\">https://gist.github.com/carlqt/c5f6b0d127c1ca124cf2fe8d620976a1</a></p>\n\n<p>And here's the property.go file: <a href=\"https://gist.github.com/carlqt/6edadf1dedc63b4b4e231891cae8e9a5\" rel=\"nofollow noreferrer\">https://gist.github.com/carlqt/6edadf1dedc63b4b4e231891cae8e9a5</a></p>\n\n<p>My project structure looks like this</p>\n\n<p><a href=\"https://i.stack.imgur.com/iasen.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/iasen.png\" alt=\"enter image description here\"></a></p>\n\n<p><em>Edit</em>\nAdding <code>go env</code> for the terminal in VS Code and my terminal. I will put them on screenshot as to avoid human error</p>\n\n<p>VS Code terminal:\n<a href=\"https://i.stack.imgur.com/WvcxF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/WvcxF.png\" alt=\"enter image description here\"></a></p>\n\n<p>iterm2 Terminal:\n<a href=\"https://i.stack.imgur.com/sci6R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/sci6R.png\" alt=\"enter image description here\"></a></p>\n\n<p><strong>Note</strong>\nThe issue can be avoided, as well, if I put the HandlerFunc functions from the properties folder to main.go file.</p>\n"}, {"tags": ["go", "godoc"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 1, "creation_date": 1474716426, "post_id": 39673649, "comment_id": 66651969, "body": "Easiest examples is to look at Go&#39;s actual documentation on <a href=\"https://golang.org/pkg/\" rel=\"nofollow noreferrer\">golang.org/pkg</a> and browse around until you find it.  Then click on the source file and look at the actual comments."}], "answers": [{"tags": [], "owner": {"reputation": 795, "user_id": 3479043, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xGd30.png?s=128&g=1", "display_name": "xh3b4sd", "link": "https://stackoverflow.com/users/3479043/xh3b4sd"}, "is_accepted": true, "score": 4, "last_activity_date": 1474726977, "creation_date": 1474726977, "answer_id": 39677391, "question_id": 39673649, "link": "https://stackoverflow.com/questions/39673649/refer-a-different-package-from-the-godoc-of-a-package/39677391#39677391", "title": "Refer a different package from the godoc of a package", "body": "<p>I am not aware that this is currently possible. E.g. <a href=\"https://golang.org/pkg/io/ioutil/#TempFile\" rel=\"nofollow\">https://golang.org/pkg/io/ioutil/#TempFile</a> refers to the <code>os</code> package simply using <code>*os.File</code>. See the source code comments at <a href=\"https://golang.org/src/io/ioutil/tempfile.go#L40\" rel=\"nofollow\">https://golang.org/src/io/ioutil/tempfile.go#L40</a>.</p>\n\n<blockquote>\n  <p>and writing, and returns the resulting *os.File.</p>\n</blockquote>\n"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 1, "accepted_answer_id": 39677391, "answer_count": 1, "score": 5, "last_activity_date": 1474726977, "creation_date": 1474701287, "last_edit_date": 1474701912, "question_id": 39673649, "link": "https://stackoverflow.com/questions/39673649/refer-a-different-package-from-the-godoc-of-a-package", "title": "Refer a different package from the godoc of a package", "body": "<p>Can someone let me know if it is possible to refer a different package from <code>godoc</code> of a package? For example let's say I have a package <code>src/logger/</code>. In <code>src/logger/doc.go</code> I need to refer <code>src/config/</code>. Something like <code>@see</code> in javadoc. </p>\n\n<p>Is there a recommended way?</p>\n\n<p>I am on Go 1.7.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 4, "last_activity_date": 1475037173, "last_edit_date": 1475037173, "creation_date": 1474705564, "answer_id": 39674210, "question_id": 39673184, "link": "https://stackoverflow.com/questions/39673184/dealing-with-tons-of-queries-and-avoiding-duplicates/39674210#39674210", "title": "Dealing with tons of queries and avoiding duplicates", "body": "<p>Applying Optimistic Concurrency using transactions and a version field/column (could be a time-stamp or a time-stamp plus an actual version number that just increases or other mechanism for version number) is a must here.</p>\n\n<p>But since you are doing this on different machines, it's possible that a substantial amount of repetitive <em>failed</em> transactions occur.</p>\n\n<p>To prevent this, you could use a queuing mechanism. A dispatcher program reads the non-processed records from database and dispatch them to workers - using a queue or a job dispatcher. Then each worker will take the id from that queue and process it in a transaction.</p>\n\n<p>This way:</p>\n\n<ol>\n<li>if a transaction fails, dispatcher would queue it again</li>\n<li>if a worker goes down, other workers would continue (noticing the going down is a matter of monitoring)</li>\n<li>workers can easily scale-out and new workers can be added at any time (as long as your database is not your bottleneck)</li>\n</ol>\n\n<p>A request/reply schema would do best in this case to prevent queue congestion. I've used <a href=\"https://nats.io/\" rel=\"nofollow\">NATS</a> successfully (and happily) for similar cases. Of-course you could use another tool of your choice but remember that you have to take care of request/reply part. Just throwing things at queues does not solve all problems and the amount of queued work should be controlled!</p>\n"}], "owner": {"reputation": 59, "user_id": 5131266, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-eZozSH4mJZ4/AAAAAAAAAAI/AAAAAAAAAFk/fej0JjXTCsI/photo.jpg?sz=128", "display_name": "Danny", "link": "https://stackoverflow.com/users/5131266/danny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "closed_date": 1475138438, "answer_count": 1, "score": 0, "last_activity_date": 1475037173, "creation_date": 1474697780, "question_id": 39673184, "link": "https://stackoverflow.com/questions/39673184/dealing-with-tons-of-queries-and-avoiding-duplicates", "closed_reason": "Needs more focus", "title": "Dealing with tons of queries and avoiding duplicates", "body": "<p>My project involves concurrency and database management. Meaning that I have to be editing a database simultaneously between all threads. To be more specific I am reading a line from the database then inserting a line to mark that I grabbed that line. This could work with transactions but due to the fact I will be running this program on multiple machines, I will be having different database connections on each one. Is their a better way for me to accomplish my above task? </p>\n"}, {"tags": ["google-app-engine", "go", "data-modeling", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1474688492, "post_id": 39671772, "comment_id": 66645647, "body": "Word of advice - Make sure you test on GAE. You may need to re-consider using ancestry for such tree. I had a similar tree (but with different entity kinds at different levels). I found that doing just many <code>get_by_id()</code> with just a few writes in concurrent requests was causing lots of data contention exceptions on the entity root (and poor performance) when running on GAE - everything appeared fine on the local devserver. Right now I&#39;m refactoring my app to drop the ancestry between levels, one by one, I see great perf improvements but still get contention exceptions - I&#39;ll drop all of them."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1474689279, "post_id": 39671772, "comment_id": 66645743, "body": "&quot;contention exceptions&quot; meaning an irreconcilable consistency problem at the GAE level? Why would you assume that this was a curse of the use-case rather than a bug in your implementation? The problem is that, at this time, I preload/sync the tree at the first request. None of it is dynamic though I&#39;ve left room for it to be at some point in the future (presupposing a theoretical change in the preference of the userbase). In order to establish whether the stored information matches the representation within the configuration tree I need it to be consistent. Thoughts?"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1474690268, "post_id": 39671772, "comment_id": 66645889, "body": "Disregard the second part. It&#39;s not worth it. This data will always be more static than not (low rate of change). Thanks for bringing it up."}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1474719882, "post_id": 39671772, "comment_id": 66652908, "body": "I don&#39;t mean the irreconcilable ones - those occur on write ops and are caught by the devserver. I&#39;m talking about randomly occuring <code>TransactionFailedError: too much contention on these datastore entities. please try again. entity group key:</code> where the key points to the root of the entity group and the stack trace indicates <code>get_by_id()</code> calls for items 3 or 4 levels down from that root entity. The occurence rate depends on the overall rate of requests doing writes on that entity group. Might not be an issue for your app, if you&#39;re doing just reads."}], "answers": [{"tags": [], "owner": {"reputation": 37598, "user_id": 153407, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zoFYE.png?s=128&g=1", "display_name": "Dan McGrath", "link": "https://stackoverflow.com/users/153407/dan-mcgrath"}, "is_accepted": true, "score": 4, "last_activity_date": 1474688471, "creation_date": 1474688471, "answer_id": 39672234, "question_id": 39671772, "link": "https://stackoverflow.com/questions/39671772/appengine-datastore-best-way-to-retrieve-since-ancestor-query-returns-everythin/39672234#39672234", "title": "AppEngine/Datastore: Best way to retrieve since ancestor query returns everything recursively", "body": "<p>Just <code>filter()</code> is eventually consistent, whereas <code>ancestor().filter()</code> is strongly consistent.</p>\n\n<p>As you mentioned, you'll need to filter by an indexed a property to just get a particular level of the tree back.</p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 175, "favorite_count": 0, "accepted_answer_id": 39672234, "answer_count": 1, "score": 4, "last_activity_date": 1474689771, "creation_date": 1474682313, "last_edit_date": 1474689771, "question_id": 39671772, "link": "https://stackoverflow.com/questions/39671772/appengine-datastore-best-way-to-retrieve-since-ancestor-query-returns-everythin", "title": "AppEngine/Datastore: Best way to retrieve since ancestor query returns everything recursively", "body": "<p>When I do a <code>get()</code> with an ancestor constraint, it seems like I get all entities for that ancestor key and all ancestors that it is parent to.</p>\n\n<p>In this case, I am using ancestral relationships to represent a homogenous tree (all nodes represented by the same kind; every level is immediately consistent). All of the IDs I am using are globally unique and I have the parent-ID written on each entity (in addition to it being in the ancestor path).</p>\n\n<p>Since the by-ancestor retrieval returns too much data (all levels at and below rather than just the immediate level; The documentation doesn't mention this and a couple of others eccentricities), I'll need to add a filter to make sure I just get back the current level. </p>\n\n<p>So, the question is whether there's a difference in efficiency to do a <code>ancestor().filter()</code> versus just <code>filter()</code> since these both produce the same results for me.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["google-app-engine", "go", "key"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1474700748, "post_id": 39669949, "comment_id": 66647936, "body": "Is storing in and reading keys from the Datastore an option? If so, that would solve your problem."}, {"owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1474827772, "post_id": 39669949, "comment_id": 66679791, "body": "@icza The datastore is readable (via the datastore viewer) by a number of people that shouldn&#39;t have access to the private keys, so that&#39;s not an option."}], "answers": [{"comments": [{"owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "edited": false, "score": 0, "creation_date": 1474961368, "post_id": 39692710, "comment_id": 66734698, "body": "How do you look for a folder in AppEngine since there is no file system.  I&#39;ve tried your exact solution, but I get an error when calling go code that would typically check for a file or folder."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "edited": false, "score": 0, "creation_date": 1474961969, "post_id": 39692710, "comment_id": 66735123, "body": "@JohnGB There is filesystem, you can&#39;t write it and you can&#39;t read everything, but you can read the <i>application</i> files of your app. You have to use relative paths, see related questions for details: <a href=\"http://stackoverflow.com/questions/36717098/correct-way-to-read-file-in-go-appengine\">Correct way to read file in Go AppEngine</a> and <a href=\"http://stackoverflow.com/questions/34629056/how-do-i-store-the-private-key-of-my-server-in-google-app-engine\">How do I store the private key of my server in google app engine?</a>"}, {"owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "edited": false, "score": 0, "creation_date": 1474965770, "post_id": 39692710, "comment_id": 66737563, "body": "The relative file paths explain a lot, thanks.  That solves the question for me."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1474962494, "last_edit_date": 1474962494, "creation_date": 1474845256, "answer_id": 39692710, "question_id": 39669949, "link": "https://stackoverflow.com/questions/39669949/how-to-keep-keys-out-of-repo-when-using-appengine-with-go/39692710#39692710", "title": "How to keep keys out of repo when using AppEngine with Go?", "body": "<p>Since you want default (test) keys in the repo so others can test your code, but you want to keep your private keys secret (out of the repo), I'd go with the solution to have 2 separate folders, one for the test keys, one for the private keys.</p>\n\n<p>Obviously the private keys folder could go to <code>.gitignore</code> (and so will be kept out of repo), and you can decide the keys folder at runtime by a logic.</p>\n\n<p>The easiest logic would be to look for the private keys folder first (which will only exist in your computer), and if it doesn't exist, proceed with the test keys folder.</p>\n\n<p>You can spice up this logic e.g. with allowing with a cmd flag or env variable to bypass the private keys folder even if it exists. It would also be reasonable to only look for the private keys folder in production environment.</p>\n\n<p>But beware of / be aware that production code can be downloaded e.g. with the following command:</p>\n\n<pre><code>appcfg.py download_app -A &lt;your_app_id&gt; -V &lt;your_app_version&gt; &lt;output-dir&gt;\n</code></pre>\n\n<blockquote>\n  <p>Only the developer who uploaded the code and the application owner(s) can download it.</p>\n</blockquote>\n\n<p>See more info about this here: <a href=\"https://cloud.google.com/appengine/docs/go/tools/downloading-source-code\" rel=\"nofollow\">Downloading Your Source Code</a></p>\n"}], "owner": {"reputation": 1634, "user_id": 340334, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/61441c6f0027ee4f4b25b6dcf756f9a3?s=128&d=identicon&r=PG", "display_name": "JohnGB", "link": "https://stackoverflow.com/users/340334/johngb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 1, "accepted_answer_id": 39692710, "answer_count": 1, "score": 2, "last_activity_date": 1474962494, "creation_date": 1474666854, "question_id": 39669949, "link": "https://stackoverflow.com/questions/39669949/how-to-keep-keys-out-of-repo-when-using-appengine-with-go", "title": "How to keep keys out of repo when using AppEngine with Go?", "body": "<p>I have an AppEngine Classic application written in Go, and as part of this, I have a number of keys which I would like to not have in the code repo.</p>\n\n<p>I would like to have default keys in the repo for testing purposes, but keep the production keys secret.  I know I can specify which files not to upload to the repo with my .gitignore file.  However, I'm not sure what the best way to do this is so that other developers can build and tests the code without access to the file file.</p>\n\n<p>What is the most practical way to keep keys out of the repo, while still having the code compile and test when the file with the keys is not present?</p>\n"}, {"tags": ["postgresql", "go", "revel", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 1162, "user_id": 1890328, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/11d715ddc533970983f63e27f30edf53?s=128&d=identicon&r=PG", "display_name": "user1890328", "link": "https://stackoverflow.com/users/1890328/user1890328"}, "is_accepted": false, "score": 0, "last_activity_date": 1533163611, "creation_date": 1533163611, "answer_id": 51643241, "question_id": 39669673, "link": "https://stackoverflow.com/questions/39669673/using-gorm-in-revel-to-query-table/51643241#51643241", "title": "Using Gorm in Revel to query table", "body": "<p>To start you can use this in your app.go file</p>\n\n<pre><code>result := c.DB.Find(books)\nreturn c.RenderJSON(result)\n</code></pre>\n\n<p>the first line queries the database for all books (same as select * from books;)\nThe 2nd returns JSON allowing you to verify you're getting the data you expect.</p>\n\n<p>Next step is to take result and apply it to a template.</p>\n"}], "owner": {"reputation": 77, "user_id": 2897821, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/f528a7b7e8e544cbc6c21e0377bc5fa9?s=128&d=identicon&r=PG&f=1", "display_name": "user2897821", "link": "https://stackoverflow.com/users/2897821/user2897821"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 502, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1533163611, "creation_date": 1474665365, "last_edit_date": 1479762366, "question_id": 39669673, "link": "https://stackoverflow.com/questions/39669673/using-gorm-in-revel-to-query-table", "title": "Using Gorm in Revel to query table", "body": "<p>I am giving Revel a try to build a small web app. I'm Having trouble though understanding how to Query a DB and display the result in the HTML View.</p>\n\n<p>I Already have a PostgreSQL DB named \"shop\" with a table called \"books\". This Table contains the fields \"id\", \"booknum\", \"bookname\", \"author\" and \"category\".</p>\n\n<p>I have managed to get a db connection and created the model struct. Now im lost as to how to create the function for a query ie*(\"SELECT * FROM books;\") and display the result in the index view file.</p>\n\n<p>With a clean revel build i have added the following code.</p>\n\n<p>app/controller/app.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/revel/revel\"\n    \"github.com/test/testapp/app/models\"\n)\n\ntype App struct {\n    *revel.Controller\n    GormController\n}\n\nfunc (c App) Index() revel.Result {\n    books := models.Books{}\n    return c.Render(books)\n}\n</code></pre>\n\n<p>app/controller/gorm.go</p>\n\n<pre><code>package controllers\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/lib/pq\" \n    r \"github.com/revel/revel\"\n    \"github.com/test/testapp/app/models\"\n)\n\nvar Gdb *gorm.DB\n\nfunc initDB() {\n  Gdb, err := gorm.Open(\"postgres\", \"host=localhost user=username dbname=shop sslmode=disable password=password\")\n  if err != nil {\n   panic(\"failed to connect database\")\n }\n Gdb.AutoMigrate(&amp;models.Books{})\n }\n\n type GormController struct {\n    *r.Controller\n    Txn *gorm.DB\n }\n</code></pre>\n\n<p>app/controller/init.go</p>\n\n<pre><code>package controllers\n\nimport \"github.com/revel/revel\"\n\nfunc init() {\n    revel.OnAppStart(initDB) // invoke InitDB function before\n }\n</code></pre>\n\n<p>app/models/books.go</p>\n\n<pre><code>package models\n\ntype Sched struct {          // example user fields\n    Id                   int64\n    Booknum              string `sql:\"type:VARCHAR(255)\"`\n    Bookname             string `sql:\"type:VARCHAR(255)\"`\n    Author               string `sql:\"type:VARCHAR(255)\"`\n    Category             string `sql:\"type:VARCHAR(255)\"`\n}\n</code></pre>\n\n<p>Any feedbcak or help would be appreciated greatly.. Thanks</p>\n"}, {"tags": ["go", "godoc"], "answers": [{"tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 4, "last_activity_date": 1474666427, "creation_date": 1474666427, "answer_id": 39669865, "question_id": 39669660, "link": "https://stackoverflow.com/questions/39669660/adding-a-title-in-godoc/39669865#39669865", "title": "Adding a title in godoc", "body": "<p>The list seems to cause the problem. You may want to create an issue for that.</p>\n\n<p>If you add any line before listing prerequisites, it will work as expected:</p>\n\n<pre><code>// Package hello-world provides a helloworld example\n//\n// Pre-requisites\n//\n// You need to have the following:\n//  * Go 1.5+\n//  * Linux or MacOS\n//  * https://onsi.github.io/ginkgo/ for executing the tests\n//\n//\npackage hello_world\n</code></pre>\n"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 115, "favorite_count": 0, "accepted_answer_id": 39669865, "answer_count": 1, "score": 1, "last_activity_date": 1474666427, "creation_date": 1474665279, "question_id": 39669660, "link": "https://stackoverflow.com/questions/39669660/adding-a-title-in-godoc", "title": "Adding a title in godoc", "body": "<p>I am trying to add a title in my godoc. I have referred <a href=\"https://godoc.org/github.com/fluhus/godoc-tricks#Titles\" rel=\"nofollow noreferrer\">godoctricks</a>. My godoc looks like below:-</p>\n\n<pre><code>// Package hello-world provides a helloworld example\n//\n// Pre-requisites\n//\n//  * Go 1.5+\n//  * Linux or MacOS\n//  * https://onsi.github.io/ginkgo/ for executing the tests\n//\n//\npackage hello_world\n</code></pre>\n\n<p>But the godoc is showing up as below with Pre-requisites not as title:-</p>\n\n<p><a href=\"https://i.stack.imgur.com/2iwBi.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/2iwBi.png\" alt=\"enter image description here\"></a></p>\n\n<p>Can someone let me know what is going wrong?</p>\n\n<p>Environment:-</p>\n\n<ul>\n<li>Go 1.7 </li>\n<li>Mac OSX El Capitan</li>\n</ul>\n"}, {"tags": ["arrays", "json", "go"], "comments": [{"owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "edited": false, "score": 0, "creation_date": 1474663174, "post_id": 39669009, "comment_id": 66639931, "body": "Do you mean &quot;convert this into array of structs&quot;? Because struct you provided can hold only one line of output."}, {"owner": {"reputation": 385, "user_id": 5252581, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7c5172b819057de36d2db9636712d2c5?s=128&d=identicon&r=PG&f=1", "display_name": "jojo", "link": "https://stackoverflow.com/users/5252581/jojo"}, "reply_to_user": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "edited": false, "score": 0, "creation_date": 1474663291, "post_id": 39669009, "comment_id": 66639971, "body": "@divan Yeah you are right.I meant array of ProcessInfo structs."}], "answers": [{"comments": [{"owner": {"reputation": 385, "user_id": 5252581, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7c5172b819057de36d2db9636712d2c5?s=128&d=identicon&r=PG&f=1", "display_name": "jojo", "link": "https://stackoverflow.com/users/5252581/jojo"}, "edited": false, "score": 0, "creation_date": 1474927465, "post_id": 39669490, "comment_id": 66724243, "body": "The following code will suffice for any command we execute like &quot;ps&quot; , &quot;ps -e&quot; or &quot;ps -f&quot;                                                                                                             <a href=\"https://play.golang.org/p/G8tDIoZkf9\" rel=\"nofollow noreferrer\">play.golang.org/p/G8tDIoZkf9</a>"}], "tags": [], "owner": {"reputation": 1966, "user_id": 2739942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fbb10b8c7115b8c44459363fb6476cf?s=128&d=identicon&r=PG", "display_name": "divan", "link": "https://stackoverflow.com/users/2739942/divan"}, "is_accepted": true, "score": 3, "last_activity_date": 1474664467, "creation_date": 1474664467, "answer_id": 39669490, "question_id": 39669009, "link": "https://stackoverflow.com/questions/39669009/array-of-strings-to-go-struct/39669490#39669490", "title": "array of strings to go struct", "body": "<p>There is a handy <a href=\"https://golang.org/pkg/strings/#Fields\" rel=\"nofollow\">strings.Fields</a> function in <a href=\"https://golang.org/pkg/strings/\" rel=\"nofollow\">strings</a> package that helps to parse this kind of output. Go likes pragmatic approaches, so the naive implementation would be:</p>\n\n<ul>\n<li>iterate over your array and split each line into fields with whitespace as separator</li>\n<li>construct new ProcessInfo object from these fields</li>\n<li>add this object to the array</li>\n</ul>\n\n<p>Assuming your array is named <code>lines</code>, just do something like this:</p>\n\n<pre><code>var pinfos []ProcessInfo\nfor _, line := range lines {\n    fields := strings.Fields(line)\n\n    pi := ProcessInfo{\n        PID:     fields[0],\n        PPID:    fields[1],\n        PGID:    fields[2],\n        WINPID:  fields[3],\n        TTY:     fields[4],\n        UID:     fields[5],\n        STIME:   fields[6],\n        COMMAND: fields[7],\n    }\n\n    pinfos = append(pinfos, pi)\n}\n</code></pre>\n\n<p>See the whole code here:\n<a href=\"https://play.golang.org/p/wo8FFiYabA\" rel=\"nofollow\">https://play.golang.org/p/wo8FFiYabA</a></p>\n"}], "owner": {"reputation": 385, "user_id": 5252581, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/7c5172b819057de36d2db9636712d2c5?s=128&d=identicon&r=PG&f=1", "display_name": "jojo", "link": "https://stackoverflow.com/users/5252581/jojo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 39669490, "answer_count": 1, "score": 1, "last_activity_date": 1474664467, "creation_date": 1474662416, "last_edit_date": 1474664204, "question_id": 39669009, "link": "https://stackoverflow.com/questions/39669009/array-of-strings-to-go-struct", "title": "array of strings to go struct", "body": "<p>This is the command that i execute </p>\n\n<pre><code>$ ps -e\n  PID    PPID    PGID     WINPID   TTY         UID    STIME COMMAND\n 4372       1    4372       4372  ?         197608 03:44:57 /usr/bin/mintty\n 6476    4372    6476       6208  pty0      197608 03:44:58 /usr/bin/bash\n14484    6476   14484      12888  pty0      197608 13:23:48 /usr/bin/ps\n</code></pre>\n\n<p>I get 1d array of strings using <code>bufio</code> scanner.scanLines. I need to convert this into array of structs:</p>\n\n<pre><code>type ProcessInfo struct {\n    PID string `json:\"PID\"`\n    PPID string `json:\"PPID\"`\n    PGID string `json:\"PGID\"`\n    WINPID string    `json:\"WINPID\"`\n    TTY   string `json:\"TTY\"`\n    UID string `json:\"UID\"`\n    STIME string `json:\"STIME\"`\n    COMMAND string `json:\"COMMAND\"`\n}\n</code></pre>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-sql"], "answers": [{"comments": [{"owner": {"reputation": 571, "user_id": 1691455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478c1e02777864acbcfe0955348de695?s=128&d=identicon&r=PG", "display_name": "Igor Afanasyev", "link": "https://stackoverflow.com/users/1691455/igor-afanasyev"}, "edited": false, "score": 0, "creation_date": 1503989644, "post_id": 39693092, "comment_id": 78823165, "body": "I&#39;m having exactly the same problem, and switching to first-gen DB resolves the issue. Did you have any progress in figuring out the cause of the issue with the second-gen DBs?"}, {"owner": {"reputation": 924, "user_id": 4199833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9tBnh.png?s=128&g=1", "display_name": "rudolph1024", "link": "https://stackoverflow.com/users/4199833/rudolph1024"}, "reply_to_user": {"reputation": 571, "user_id": 1691455, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/478c1e02777864acbcfe0955348de695?s=128&d=identicon&r=PG", "display_name": "Igor Afanasyev", "link": "https://stackoverflow.com/users/1691455/igor-afanasyev"}, "edited": false, "score": 1, "creation_date": 1504031542, "post_id": 39693092, "comment_id": 78850535, "body": "We were never able to connect to a second generation Google Cloud SQL Server from our deployed GAE app running on the standard environment, so we continued to use the first generation server. I did some testing and created a simple GAE app which runs on the flexible appengine environment and I was able to connect to a second generation SQL server from that. The issue must be related to the app engine environment."}], "tags": [], "owner": {"reputation": 924, "user_id": 4199833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9tBnh.png?s=128&g=1", "display_name": "rudolph1024", "link": "https://stackoverflow.com/users/4199833/rudolph1024"}, "is_accepted": true, "score": 2, "last_activity_date": 1475171595, "last_edit_date": 1475171595, "creation_date": 1474848948, "answer_id": 39693092, "question_id": 39668672, "link": "https://stackoverflow.com/questions/39668672/trouble-connecting-to-google-cloud-sql-server-from-deployed-app/39693092#39693092", "title": "Trouble connecting to Google Cloud SQL server from deployed app", "body": "<p>It looks like there could be <a href=\"https://github.com/go-sql-driver/mysql/issues/484#issuecomment-249448573\" rel=\"nofollow\">an issue</a> with <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow\">the Go MySQL driver</a> when a deployed Google App Engine application tries to connect to a <strong><em>second generation</em></strong> Google Cloud SQL Server.</p>\n\n<p>I created a <strong><em>first generation</em></strong> Cloud SQL instance and I was able to successfully connect to the server using a deployed Google App Engine application with this connection string:</p>\n\n<p><code>user@cloudsql(project-id:instance-name)/dbname</code></p>\n\n<p>No region name was required.</p>\n"}, {"comments": [{"owner": {"reputation": 4591, "user_id": 3887945, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/7Nb72.jpg?s=128&g=1", "display_name": "Theyouthis", "link": "https://stackoverflow.com/users/3887945/theyouthis"}, "edited": false, "score": 1, "creation_date": 1475591073, "post_id": 39738378, "comment_id": 66997388, "body": "I don&#39;t think he mentions TLS or SSL here."}], "tags": [], "owner": {"reputation": 4173, "user_id": 963901, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/ef089712a38be13b7190e8d52b1a9fa3?s=128&d=identicon&r=PG", "display_name": "Ben Guild", "link": "https://stackoverflow.com/users/963901/ben-guild"}, "is_accepted": false, "score": 0, "last_activity_date": 1475038714, "last_edit_date": 1495541708, "creation_date": 1475038714, "answer_id": 39738378, "question_id": 39668672, "link": "https://stackoverflow.com/questions/39668672/trouble-connecting-to-google-cloud-sql-server-from-deployed-app/39738378#39738378", "title": "Trouble connecting to Google Cloud SQL server from deployed app", "body": "<p>Guys the Google provided solution to connecting to 2nd generation is here:\n<a href=\"https://stackoverflow.com/questions/38890022/tls-requested-but-server-does-not-support-tls-error-with-google-cloud-sql-2nd\">&quot;TLS requested but server does not support TLS&quot; error with Google Cloud SQL (2nd generation) from Google App Engine?</a></p>\n\n<p>Google's posted documentation was (and perhaps still is) <strong>wrong</strong>, but the correct solution is posted there. <strong>We're using 2nd generation Cloud SQL in production without issue.</strong></p>\n"}], "owner": {"reputation": 924, "user_id": 4199833, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/9tBnh.png?s=128&g=1", "display_name": "rudolph1024", "link": "https://stackoverflow.com/users/4199833/rudolph1024"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1486, "favorite_count": 0, "accepted_answer_id": 39693092, "answer_count": 2, "score": 2, "last_activity_date": 1475171595, "creation_date": 1474660843, "last_edit_date": 1495541215, "question_id": 39668672, "link": "https://stackoverflow.com/questions/39668672/trouble-connecting-to-google-cloud-sql-server-from-deployed-app", "title": "Trouble connecting to Google Cloud SQL server from deployed app", "body": "<p>I am using a Google Cloud SQL instance (second generation) and I can successfully connect to it locally after authorizing my own IP. I have Go code that successfully retrieves rows from tables and I have code that successfully adds rows to tables. However, when I deploy my app, the app is unable to connect to the server. Any time an SQL function is called, the server returns a 500 response. My app is authorized to connect to this sql instance:</p>\n\n<p><a href=\"https://i.stack.imgur.com/FZXWw.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/FZXWw.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am using the following Go connection code:</p>\n\n<pre><code>func dialSQL() (*sql.DB, error) {\n    if appengine.IsDevAppServer() {\n        return sql.Open(\"mysql\", \"root:password@tcp(xxx.xxx.xxx.xxx:3306)/Dbname\")\n    } else {\n        return sql.Open(\"mysql\", \"root@cloudsql(projectid:regionname:instancename)/Dbname\")\n    }\n}\n</code></pre>\n\n<p>The deployed version and the local version are using the same codebase, but the deployed version uses the second connection string in the <code>dialSQL()</code> function.</p>\n\n<p>I am using this Go MySQL driver: <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql</a></p>\n\n<p>The documentation for this driver mentions the following connection string for connecting to a Google Cloud SQL server via Google App Engine: <code>user@cloudsql(project-id:instance-name)/dbname</code></p>\n\n<p>I am using projectid:regionname:instancename rather than projectid:instancename because this post mentions the need to include the <code>regionname</code>: <a href=\"https://stackoverflow.com/questions/38956385/google-app-engine-golang-driver-bad-connection/38970202#38970202\">google app engine golang, driver: bad connection</a></p>\n\n<p>Confusingly, Google's documentation also omits the <code>regionname</code>: <a href=\"https://cloud.google.com/appengine/docs/go/cloud-sql/reference\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/go/cloud-sql/reference</a></p>\n\n<p>I have tried both variants of the connection string.</p>\n\n<p>According to <a href=\"https://stackoverflow.com/a/19760311/4199833\">this post</a>, the deployed app will attempt to connect to the server using host = localhost, and according to <a href=\"https://stackoverflow.com/a/22551220/4199833\">this post</a>, the password for 'root'@'localhost' must be null. </p>\n\n<p>I made the following query in my mysql console to verify that the user 'root'@'localhost' indeed has a null password: <code>select User, Host, HEX(authentication_string) from mysql.user</code>. The 'root'@'%' user still has the password I specified in the Google Cloud SQL instance console.</p>\n\n<p>I looked into a <a href=\"https://stackoverflow.com/questions/26480959/authorized-gae-applications-must-be-in-the-same-region-as-the-database-instance?noredirect=1&amp;lq=1\">possible issue</a> regarding the region of the GAE app and the Cloud SQL server, but they are in the same region. I also learned that for second generation Google Cloud SQL servers the region of the app and the server are allowed to differ.</p>\n\n<p>I also created a new user and tried to connect to the instance with the new user's username in the connection string. This didn't fix the error.</p>\n\n<p>I also tried adding a firewall rule, but this didn't fix the problem either:</p>\n\n<p><a href=\"https://i.stack.imgur.com/pQgFT.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/pQgFT.png\" alt=\"enter image description here\"></a></p>\n\n<p>Finally, I went to the Compute Engine section of the Google Cloud Console and SSHed into the VM which is serving the latest instance of my app. I successfully pinged the Cloud SQL server's IP, but <code>telnet xxx.xxx.xxx.xxx 3306</code> timed out. I also ran <code>lsof -i TCP:3306</code> and <code>lsof -i | grep 3306</code> but no processes appeared. I also installed mysql on this box and tried to connect to the server from there, but the connection failed.</p>\n\n<p>Does anyone know what might be causing this issue?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474660811, "post_id": 39668514, "comment_id": 66638924, "body": "Do you want somehow unmarshal a json string into an <code>http.Response</code> object? You can read a saved response via <a href=\"https://golang.org/pkg/net/http/#ReadResponse\" rel=\"nofollow noreferrer\">http.ReadResponse</a>"}], "answers": [{"comments": [{"owner": {"reputation": 27, "user_id": 6586806, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8c510235133135d68628fb13d8581ad?s=128&d=identicon&r=PG&f=1", "display_name": "user6586806", "link": "https://stackoverflow.com/users/6586806/user6586806"}, "edited": false, "score": 0, "creation_date": 1474663601, "post_id": 39668629, "comment_id": 66640125, "body": "Is the json in this case a string, and if so, how do I hard code json as a string (since it will have multiple quotes in the json"}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "reply_to_user": {"reputation": 27, "user_id": 6586806, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8c510235133135d68628fb13d8581ad?s=128&d=identicon&r=PG&f=1", "display_name": "user6586806", "link": "https://stackoverflow.com/users/6586806/user6586806"}, "edited": false, "score": 0, "creation_date": 1474671695, "post_id": 39668629, "comment_id": 66642923, "body": "@user6586806 your question implied you already had a JSON string. Anyway, you can use the raw string (<code>`like this`</code>) quotes."}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 2, "last_activity_date": 1474660612, "creation_date": 1474660612, "answer_id": 39668629, "question_id": 39668514, "link": "https://stackoverflow.com/questions/39668514/how-can-i-hard-code-a-json-string-into-an-http-response-for-testing-purposes-in/39668629#39668629", "title": "How can I hard code a json string into an *http.Response for testing purposes in Go", "body": "<p>You want to use a <code>bytes.Buffer</code> to turn the data you have into an <code>io.Reader</code>, and <code>NopCloser</code> (from <code>io/ioutil</code>) to make it an <code>io.ReadCloser</code></p>\n\n<pre><code>r := &amp;http.Response{\n    Status: \"200 OK\",\n    StatusCode: 200,\n    // etc., lots more fields needed here.\n    Body: ioutil.NopCloser(bytes.NewBufferString(json))\n}\n</code></pre>\n\n<p>If you have your json in a <code>[]byte</code>, then use <code>NewBuffer</code> instead of <code>NewBufferString</code>.</p>\n"}], "owner": {"reputation": 27, "user_id": 6586806, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f8c510235133135d68628fb13d8581ad?s=128&d=identicon&r=PG&f=1", "display_name": "user6586806", "link": "https://stackoverflow.com/users/6586806/user6586806"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 343, "favorite_count": 0, "accepted_answer_id": 39668629, "answer_count": 1, "score": 1, "last_activity_date": 1474660612, "creation_date": 1474660158, "question_id": 39668514, "link": "https://stackoverflow.com/questions/39668514/how-can-i-hard-code-a-json-string-into-an-http-response-for-testing-purposes-in", "title": "How can I hard code a json string into an *http.Response for testing purposes in Go", "body": "<p>I have some code that makes get requests to a dynamic website, which I want to test. Obviously the tests need to be run by anyone at any time, so rather than actually use the REST API, is it possible to put a json string into an *http.Response for testing purposes.</p>\n\n<p>example code:</p>\n\n<pre><code>func get (c *http.Response, err error) (string, error) {\n    //code\n}\n</code></pre>\n\n<p>test file:</p>\n\n<pre><code>func TestGet(t *testing.T) {\n    //code to have put json string for test *http.Response\n    get(???, nil)\n\n}\n</code></pre>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 1, "creation_date": 1474656775, "post_id": 39667627, "comment_id": 66636978, "body": "see: <a href=\"http://stackoverflow.com/a/39121749/6169399\">stackoverflow.com/a/39121749/6169399</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1474656995, "creation_date": 1474656995, "answer_id": 39667759, "question_id": 39667627, "link": "https://stackoverflow.com/questions/39667627/i-cannot-access-err-err-from-strconv-package/39667759#39667759", "title": "I cannot access err.Err from strconv package", "body": "<p>Use a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a> to get the <code>*strconv.NumError</code> value:</p>\n\n<pre><code>if e, ok := err.(*strconv.NumError); ok {\n    fmt.Println(\"e.Err\", e.Err)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/iWcT61GY6y\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 241, "favorite_count": 0, "accepted_answer_id": 39667759, "answer_count": 1, "score": -1, "last_activity_date": 1474656995, "creation_date": 1474656407, "question_id": 39667627, "link": "https://stackoverflow.com/questions/39667627/i-cannot-access-err-err-from-strconv-package", "title": "I cannot access err.Err from strconv package", "body": "<p>I am probably missing something really simple here:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n    \"reflect\"\n)\n\nfunc main() {\n    s := \"abd\"\n    fmt.Println(s)\n    _, err := strconv.Atoi(s)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    fmt.Println(reflect.TypeOf(err))\n\n    fmt.Println(err.Err)\n\n}\n</code></pre>\n\n<p>I am trying to extract the error itself e.g. <code>ErrSyntax</code> or <code>ErrRange</code>, but I am not able to do so.</p>\n\n<p>After looking at:</p>\n\n<p><a href=\"https://golang.org/src/strconv/atoi.go?s=3604:3671#L16\" rel=\"nofollow\">https://golang.org/src/strconv/atoi.go?s=3604:3671#L16</a></p>\n\n<p>I see that <code>err</code> is a pointer to <code>strconv.NumError</code></p>\n\n<pre><code>    15  // A NumError records a failed conversion.\n    16  type NumError struct {\n    17      Func string // the failing function (ParseBool, ParseInt, ParseUint, ParseFloat)\n    18      Num  string // the input\n    19      Err  error  // the reason the conversion failed (ErrRange, ErrSyntax)\n    20  }\n</code></pre>\n\n<p>And <code>Err</code> is the field that holds either <code>ErrRange</code> of <code>ErrSyntax</code>. Therefore, I thought that <code>err.Err</code> would work, but I get:</p>\n\n<pre><code>err.Err undefined (type error has no field or method Err\n</code></pre>\n\n<p><code>Err</code> is public, am I missing something with visibility rules?</p>\n\n<p>What am I missing?</p>\n"}, {"tags": ["http", "go", "jwt", "middleware"], "comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 3, "creation_date": 1474652604, "post_id": 39666275, "comment_id": 66634827, "body": "Maybe don&#39;t ignore the second value from the type conversion <code>jwtToken, _ :=</code>."}, {"owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1474682340, "post_id": 39666275, "comment_id": 66644871, "body": "It&#39;s possible the types do not match - if you set the value with a <code>type key string</code> ala the context package example, then &quot;jwt&quot; won&#39;t match.  Cannot tell from your code...  If you have indeed made a new type, then simply create a package accessor - <a href=\"https://github.com/golang/net/blob/master/context/context.go#L129\" rel=\"nofollow noreferrer\">github.com/golang/net/blob/master/context/context.go#L129</a>"}], "answers": [{"comments": [{"owner": {"reputation": 16378, "user_id": 487855, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9e8dd06976ead4082d2181f3807117e1?s=128&d=identicon&r=PG", "display_name": "Ali", "link": "https://stackoverflow.com/users/487855/ali"}, "edited": false, "score": 0, "creation_date": 1545403297, "post_id": 39684992, "comment_id": 94619711, "body": "You are a hero and should get a badge for it. To come back and update the few people who may run into this unexpected clash."}], "tags": [], "owner": {"reputation": 148, "user_id": 553615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a891fc6dea97a9a9c13c5e087f2574c?s=128&d=identicon&r=PG", "display_name": "Alex Barlow", "link": "https://stackoverflow.com/users/553615/alex-barlow"}, "is_accepted": false, "score": 3, "last_activity_date": 1474793292, "creation_date": 1474793292, "answer_id": 39684992, "question_id": 39666275, "link": "https://stackoverflow.com/questions/39666275/golang-1-7-context-value-nil/39684992#39684992", "title": "Golang 1.7 context value nil", "body": "<p>I eventually found the issues.</p>\n\n<p>The two types were the same <code>jwt.Token</code> however one type was from a vendored package in the imported library and one was from the package in my GOPATH. Although the same package and the type, Go had an issue casting and comparing these types!</p>\n\n<p>To fix, I use a vendoring tool <code>govendor</code> and ran <code>govendor add +external</code> which mean that both packages now used the same import</p>\n"}, {"tags": [], "owner": {"reputation": 16378, "user_id": 487855, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/9e8dd06976ead4082d2181f3807117e1?s=128&d=identicon&r=PG", "display_name": "Ali", "link": "https://stackoverflow.com/users/487855/ali"}, "is_accepted": false, "score": 0, "last_activity_date": 1545403244, "creation_date": 1545403244, "answer_id": 53886621, "question_id": 39666275, "link": "https://stackoverflow.com/questions/39666275/golang-1-7-context-value-nil/53886621#53886621", "title": "Golang 1.7 context value nil", "body": "<p>My problem was that the library the wrote to the context has a vendored copy of the shared library (that had keys in the context) and the main library also needed to vendor the same shared library to be able to look the values associated with thoee keys up, </p>\n\n<p>As an alternative to using <code>govendor</code> or if you are using other vendoring methods ( I use <code>gvt</code>), you can just manually delete the copy that the vondored library has vendored inside of itself, </p>\n"}], "owner": {"reputation": 148, "user_id": 553615, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a891fc6dea97a9a9c13c5e087f2574c?s=128&d=identicon&r=PG", "display_name": "Alex Barlow", "link": "https://stackoverflow.com/users/553615/alex-barlow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1747, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1545403244, "creation_date": 1474651031, "question_id": 39666275, "link": "https://stackoverflow.com/questions/39666275/golang-1-7-context-value-nil", "title": "Golang 1.7 context value nil", "body": "<p>I'm trying to implement a JWT (JSON web token) middleware using Go's 1.7 context package, but I'm running into a strange bug retrieving an earlier set context value..</p>\n\n<p>Given the code..</p>\n\n<pre><code>func JWTAuthenticator(next http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        ctx := r.Context()\n        jwtToken, _ := ctx.Value(\"jwt\").(*jwt.Token)\n\n        fmt.Printf(\"ctx = %+v\\n\", ctx)\n        fmt.Printf(\"ctx = %+v\\n\", jwtToken)\n\n        // Token is authenticated, pass it through\n        next.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>This returns ..</p>\n\n<pre><code>context.Background.WithValue(&amp;http.contextKey{name:\"http-server\"}, &amp;http.Server{Addr:\":8080\", Handler:(*chi.Mux)(0xc4201ec180), ReadTimeout:0, WriteTimeout:0, TLSConfig:(*tls.Config)(0xc420210000), MaxHeaderBytes:0, TLSNextProto:map[string]func(*http.Server, *tls.Conn, http.Handler){\"h2-14\":(func(*http.Server, *tls.Conn, http.Handler))(0xb8410), \"h2\":(func(*http.Server, *tls.Conn, http.Handler))(0xb8410)}, ConnState:(func(net.Conn, http.ConnState))(nil), ErrorLog:(*log.Logger)(nil), disableKeepAlives:0, nextProtoOnce:sync.Once{m:sync.Mutex{state:0, sema:0x0}, done:0x1}, nextProtoErr:error(nil)}).WithValue(&amp;http.contextKey{name:\"local-addr\"}, &amp;net.TCPAddr{IP:net.IP{0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0}, Port:8080, Zone:\"\"}).WithCancel.WithCancel.WithValue(&amp;chi.contextKey{name:\"RouteContext\"}, &amp;chi.Context{URLParams:chi.params(nil), RoutePath:\"\", RoutePattern:\"/store\", RoutePatterns:[]string{\"/store\"}}).WithValue(0, \"us2-ldn-barlow/XJoT7aahzI-000001\").WithValue(\"jwt\", &amp;jwt.Token{Raw:\"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdG9yZV9pZCI6NzA4MDJ9.eT70KOJbS4JJrsMC76KH4IPRozPt-ipjMDUSuAUhB4k\", Method:(*jwt.SigningMethodHMAC)(0xc420133d80), Header:map[string]interface {}{\"alg\":\"HS256\", \"typ\":\"JWT\"}, Claims:map[string]interface {}{\"store_id\":70802}, Signature:\"eT70KOJbS4JJrsMC76KH4IPRozPt-ipjMDUSuAUhB4k\", Valid:true}).WithValue(\"jwt.err\", &lt;nil&gt;)\n\nctx = &lt;nil&gt;\n</code></pre>\n\n<p>Which as you can does include a value .WithValue(\"jwt\") but is returning nil!</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["go", "import", "swagger", "swagger-codegen"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474648225, "post_id": 39665379, "comment_id": 66632604, "body": "Never try to use relative imports paths (except maybe for throwaway examples). Imports are very simple, it&#39;s just the path to the module from <code>$GOPATH&#47;src&#47;</code>"}, {"owner": {"reputation": 106259, "user_id": 51197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QG9pG.jpg?s=128&g=1", "display_name": "Adam Matan", "link": "https://stackoverflow.com/users/51197/adam-matan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474656013, "post_id": 39665379, "comment_id": 66636584, "body": "So what should I do? Copy the folder the <code>$GOPATH&#47;src&#47;</code>?"}, {"owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "edited": false, "score": 0, "creation_date": 1474656359, "post_id": 39665379, "comment_id": 66636763, "body": "The error looks like you have a file in the go directory named default.go that has syntax error(s)."}, {"owner": {"reputation": 106259, "user_id": 51197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QG9pG.jpg?s=128&g=1", "display_name": "Adam Matan", "link": "https://stackoverflow.com/users/51197/adam-matan"}, "reply_to_user": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "edited": false, "score": 0, "creation_date": 1474656802, "post_id": 39665379, "comment_id": 66636996, "body": "@reedobrien Thanks, added the content of the file. Is it a missing package name problem? Is it related to the directory name? <a href=\"https://golang.org/doc/code.html#PackageNames\" rel=\"nofollow noreferrer\">golang.org/doc/code.html#PackageNames</a>"}, {"owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "edited": false, "score": 0, "creation_date": 1474657118, "post_id": 39665379, "comment_id": 66637167, "body": "It is common to use the name of the directory a file is in as the name of the package. However using <code>package go</code> seems very confusing. <code>main</code> is a special package name used to indicate there is a main function in the package that is compiled to an executable  binary."}, {"owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "edited": false, "score": 0, "creation_date": 1474657153, "post_id": 39665379, "comment_id": 66637184, "body": "there is no name for the package in the code you posted. that is a syntax error.  <code>package go import &quot;net&#47;http&quot; ... </code> would be correct but I personally would avoid using go as the package name or the directory name."}], "answers": [{"tags": [], "owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "is_accepted": false, "score": 1, "last_activity_date": 1474656878, "creation_date": 1474656878, "answer_id": 39667739, "question_id": 39665379, "link": "https://stackoverflow.com/questions/39665379/fully-qualified-import-path-in-auto-generated-code/39667739#39667739", "title": "Fully-qualified import path in auto-generated code", "body": "<p>You need to export some path as the <code>GOPATH</code>, say <code>$HOME/go</code>. \n<code>export GOPATH=$HOME/go</code>. </p>\n\n<p>Then you can put your project in <code>$GOPATH/src/go-server-server</code> (<code>$HOME/go/src/go-server-server</code>) and your fully qualified path would be <code>go-server-server/go</code> if I am reading everything correctly.</p>\n"}, {"comments": [{"owner": {"reputation": 1493, "user_id": 993882, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/kAf2h.jpg?s=128&g=1", "display_name": "JHowIX", "link": "https://stackoverflow.com/users/993882/jhowix"}, "edited": false, "score": 1, "creation_date": 1485987229, "post_id": 39668181, "comment_id": 71158784, "body": "can you elaborate on what &quot;adding a package name&quot; means?"}, {"owner": {"reputation": 10904, "user_id": 3499115, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c593739208b1ddfe3eaae322ceecf5ce?s=128&d=identicon&r=PG", "display_name": "JBaczuk", "link": "https://stackoverflow.com/users/3499115/jbaczuk"}, "reply_to_user": {"reputation": 1493, "user_id": 993882, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/kAf2h.jpg?s=128&g=1", "display_name": "JHowIX", "link": "https://stackoverflow.com/users/993882/jhowix"}, "edited": false, "score": 0, "creation_date": 1495818040, "post_id": 39668181, "comment_id": 75425903, "body": "@JHowIX I edited the answer to show what worked for me.  I think he means Adding a package name to all the .go files in the go folder."}, {"owner": {"reputation": 10904, "user_id": 3499115, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/c593739208b1ddfe3eaae322ceecf5ce?s=128&d=identicon&r=PG", "display_name": "JBaczuk", "link": "https://stackoverflow.com/users/3499115/jbaczuk"}, "edited": false, "score": 0, "creation_date": 1503949965, "post_id": 39668181, "comment_id": 78811460, "body": "i.e. routers.go, logger.go, and default.go"}], "tags": [], "owner": {"reputation": 106259, "user_id": 51197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QG9pG.jpg?s=128&g=1", "display_name": "Adam Matan", "link": "https://stackoverflow.com/users/51197/adam-matan"}, "is_accepted": false, "score": 2, "last_activity_date": 1503949933, "last_edit_date": 1503949933, "creation_date": 1474658686, "answer_id": 39668181, "question_id": 39665379, "link": "https://stackoverflow.com/questions/39665379/fully-qualified-import-path-in-auto-generated-code/39668181#39668181", "title": "Fully-qualified import path in auto-generated code", "body": "<p>The following did the trick:</p>\n\n<ul>\n<li>Adding a package name to all .go files in the go folder (I used <code>blah</code>)</li>\n</ul>\n\n<p>eg. in go/routers.go</p>\n\n<pre><code>package blah\n\nimport (\n    \"log\"\n    \"net/http\"\n    \"time\"\n)\n\nfunc Logger(inner http.Handler, name string) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        start := time.Now()\n\n        inner.ServeHTTP(w, r)\n\n        log.Printf(\n            \"%s %s %s %s\",\n            r.Method,\n            r.RequestURI,\n            name,\n            time.Since(start),\n        )\n    })\n}\n</code></pre>\n\n<p>Do the same for <code>go/logger.go</code> and, in your case, <code>default.go</code></p>\n\n<ul>\n<li>Following an <code>go/routers.go:7:2: cannot find package \"github.com/gorilla/mux\"</code> error, <code>go get 'github.com/gorilla/mux'</code></li>\n</ul>\n"}], "owner": {"reputation": 106259, "user_id": 51197, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/QG9pG.jpg?s=128&g=1", "display_name": "Adam Matan", "link": "https://stackoverflow.com/users/51197/adam-matan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2430, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1512227432, "creation_date": 1474647641, "last_edit_date": 1512227432, "question_id": 39665379, "link": "https://stackoverflow.com/questions/39665379/fully-qualified-import-path-in-auto-generated-code", "title": "Fully-qualified import path in auto-generated code", "body": "<h1>My problem</h1>\n\n<p>My apologies if the problem is trivial - I'm fairly new to golang, and want to understand the imports mechanism. I use OSX and simple go programs compile and work well.</p>\n\n<p>I've generated a golang server using <a href=\"https://github.com/swagger-api/swagger-codegen\" rel=\"nofollow\">automatic code generator</a> in the <a href=\"http://editor.swagger.io/#/\" rel=\"nofollow\">swagger editor</a>. I've unzipped the code into some directory in <code>/tmp/</code>, and the resulting server contains the following <code>main.go</code> file:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n        // WARNING!\n        // Change this to a fully-qualified import path\n        // once you place this file into your project.\n        // For example,\n        //\n        //    sw \"github.com/myname/myrepo/go\"\n        //\n        sw \"./go\"\n        \"log\"\n        \"net/http\"\n)\n\nfunc main() {\n        log.Printf(\"Server started\")\n\n        router := sw.NewRouter()\n\n        log.Fatal(http.ListenAndServe(\":8080\", router))\n}\n</code></pre>\n\n<p>As expected from the comments, <code>go build main.go</code> Fails with the following error:</p>\n\n<pre><code>main.go:11:2:\ngo/default.go:3:1: expected 'IDENT', found 'import'\n</code></pre>\n\n<h1>Forensics</h1>\n\n<h2>The directory tree of the project</h2>\n\n<pre><code>/tmp/goserver/go-server-server\n\u251c\u2500\u2500 LICENSE\n\u251c\u2500\u2500 api\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 swagger.yaml\n\u251c\u2500\u2500 go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 README.md\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 app.yaml\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 default.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 logger.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 routers.go\n\u2514\u2500\u2500 main.go\n</code></pre>\n\n<h2><code>go/default.go</code></h2>\n\n<pre><code>package\n\nimport (\n    \"net/http\"\n)\n\ntype Default struct {\n\n}\n\nfunc QuestionimagePost(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"application/json; charset=UTF-8\")\n        w.WriteHeader(http.StatusOK)\n}\n</code></pre>\n\n<h1>What have I tried</h1>\n\n<ul>\n<li>Read about <a href=\"https://godoc.org/golang.org/x/tools/imports\" rel=\"nofollow\">go packages</a></li>\n<li>Tried to understand the package / import relationship in some github projects</li>\n<li>Moved the directory tree to <code>$GOPATH/src</code>, and changed the import to <code>sw \"sw/go-server-server/go\"</code>, which still gives <code>main.go:13:2:\ngo/default.go:3:1: expected 'IDENT', found 'import'</code></li>\n</ul>\n\n<p><strong>What should be the fully-qualified import path of the <code>sw</code> import, and what does it mean?</strong></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474646723, "post_id": 39665034, "comment_id": 66631826, "body": "Where does the race detector show you have a race? Please show a full example of what you&#39;re doing."}, {"owner": {"reputation": 174, "user_id": 3854221, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ffd71576ff4174464bd3055481cf7409?s=128&d=identicon&r=PG&f=1", "display_name": "Ewan Walker", "link": "https://stackoverflow.com/users/3854221/ewan-walker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474647209, "post_id": 39665034, "comment_id": 66632077, "body": "@JimB I have added a comment in the code to identify where the detector says there is a race - really what I am trying to get to the bottom of is why in one scenario of passing the values through the goroutine works and in another scenario it does not."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474647761, "post_id": 39665034, "comment_id": 66632368, "body": "A race requires 2 or more points in the code, where is the competing write?"}, {"owner": {"reputation": 174, "user_id": 3854221, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ffd71576ff4174464bd3055481cf7409?s=128&d=identicon&r=PG&f=1", "display_name": "Ewan Walker", "link": "https://stackoverflow.com/users/3854221/ewan-walker"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474647907, "post_id": 39665034, "comment_id": 66632448, "body": "@JimB you sparked me to look in another place, it seems like rather than a call to the routine itself it was a call to a counter in a function in &quot;do some other task&quot; which is missing a locking mechanism - thank you for your replies!"}], "owner": {"reputation": 174, "user_id": 3854221, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ffd71576ff4174464bd3055481cf7409?s=128&d=identicon&r=PG&f=1", "display_name": "Ewan Walker", "link": "https://stackoverflow.com/users/3854221/ewan-walker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474647066, "creation_date": 1474646367, "last_edit_date": 1592644375, "question_id": 39665034, "link": "https://stackoverflow.com/questions/39665034/how-to-properly-prevent-a-data-race", "title": "How to properly prevent a data race?", "body": "<p>According to the <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow noreferrer\">docs</a> doing the following prevents a data race:</p>\n<pre><code>    var wg sync.WaitGroup\n    wg.Add(5)\n    for i := 0; i &lt; 5; i++ {\n        go func(j int) {\n            fmt.Println(j) // Good. Read local copy of the loop counter.\n            wg.Done()\n        }(i)\n    }\n    wg.Wait()\n</code></pre>\n<p>however if I have code such as:</p>\n<pre><code>type Job struct {\n    Work []string\n}\n\nvar Queue chan Job\n\n\nfunc work(id string, type int32) {\n    \n    job := Job{Work: []string{&quot;A&quot;,&quot;B&quot;,&quot;C&quot;}}\n    \n    go func(j Job, ty int32) {\n        if ty == 1 {\n        // do some other task\n        }\n        Queue &lt;- j\n    } (job, type) // RACE ON THIS LINE\n\n    if type == 1 {\n        // do something\n    }\n\n    return\n}\n</code></pre>\n<p><em>work</em> is being called via. gRPC.</p>\n<p>the data race detector tells me that the go routine is producing a data race. I am thinking that there is something I am missing here but can't quite seem to find what that is.</p>\n"}, {"tags": ["rest", "go", "websocket", "gorilla"], "comments": [{"owner": {"reputation": 181, "user_id": 6844374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/302c0c25c74e62b201ab4582cd55098e?s=128&d=identicon&r=PG&f=1", "display_name": "alanfran", "link": "https://stackoverflow.com/users/6844374/alanfran"}, "edited": false, "score": 0, "creation_date": 1474658250, "post_id": 39664887, "comment_id": 66637750, "body": "We need to see more of the code. It sounds like your websocket handler is blocking."}, {"owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "reply_to_user": {"reputation": 181, "user_id": 6844374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/302c0c25c74e62b201ab4582cd55098e?s=128&d=identicon&r=PG&f=1", "display_name": "alanfran", "link": "https://stackoverflow.com/users/6844374/alanfran"}, "edited": false, "score": 0, "creation_date": 1474662495, "post_id": 39664887, "comment_id": 66639623, "body": "thats edited @Qxcl"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 593, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474662470, "creation_date": 1474645875, "last_edit_date": 1474662470, "question_id": 39664887, "link": "https://stackoverflow.com/questions/39664887/how-to-do-work-rest-api-and-websocket-on-same-server", "title": "How to do work rest api and websocket on same server?", "body": "<p>I have a restful api. I integrate a route to opening a websocket when the user receives a new notification or message.\nOnce socket is open, API doesn't work, it no longer receives any request.</p>\n\n<p>this is my main func</p>\n\n<pre><code>func initWebSocket(){\n    http.HandleFunc(\"/websocket\", websocketHandler)\n}\nfunc main() {\n\n    // init api's routes\n    initRoutes()\n\n    //init rethinkDB\n    api.InitRethinkDB()\n\n    //init opening websocket's route.\n    initWebSocket()\n\n    config := swagger.Config{\n        WebServices:    restful.RegisteredWebServices(), // you control what services are visible\n        WebServicesUrl: \"http://localhost:9000\",\n        ApiPath:        \"/apidocs.json\",\n\n        // Optionally, specifiy where the UI is located\n        SwaggerPath:     \"/apidocs/\",\n        SwaggerFilePath: \"swagger-ui/dist\"}\n\n    swagger.InstallSwaggerService(config)\n\n    http.ListenAndServe(\":9000\", nil)\n\n}\n</code></pre>\n\n<p>websocker handler : </p>\n\n<pre><code>func handleChangeNotification(socket *websocket.Conn, userID string, err chan string){\n    res, errr := r.Table(\"Notifications\").\n              Filter(r.Row.Field(\"UserId\").\n              Eq(userID)).\n              Changes().\n              Run(api.Sess)\n\n    var value HandleChange\n    if errr != nil {\n        err &lt;- errr.Error()\n    }\n    for res.Next(&amp;value){\n        var notif Notification\n        mapstructure.Decode(value.NewVal, &amp;notif)\n        errr := socket.WriteJSON(notif)\n        if errr != nil {\n            err &lt;- errr.Error()\n        }\n    }\n}\n\nfunc websocketHandler(w http.ResponseWriter, r *http.Request){\n    socket, _ := upgrader.Upgrade(w, r, nil)\n    err := make(chan string)\n    run := false\n\n    go func(){\n        for {\n            if run == false {\n                go handleChangeNotification(socket, id, err)\n                run = true        \n            }\n            if len(err) &gt; 0 {\n                break\n            }\n        }\n        socket.Close()\n    }()\n}\n</code></pre>\n\n<p>How can I do to run the websocket and API on the same server?</p>\n"}, {"tags": ["go", "goquery"], "answers": [{"comments": [{"owner": {"reputation": 84, "user_id": 5689685, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b3ad51791d7762e3c6fa17cba2145393?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/5689685/bill"}, "edited": false, "score": 0, "creation_date": 1474675728, "post_id": 39665587, "comment_id": 66643822, "body": "actually I&#39;m trying to write the web spider, this html page is copied from the real web page and I simplify that page for test, so I want to find the way to extract the text from the page like the test html page"}, {"owner": {"reputation": 552, "user_id": 2627768, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363681401/picture?type=large", "display_name": "foecum", "link": "https://stackoverflow.com/users/2627768/foecum"}, "reply_to_user": {"reputation": 84, "user_id": 5689685, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b3ad51791d7762e3c6fa17cba2145393?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/5689685/bill"}, "edited": false, "score": 0, "creation_date": 1474676113, "post_id": 39665587, "comment_id": 66643886, "body": "A textarea can only contain text, not HTML elements. You can&#39;t display an HTML list inside a textarea. It will always be treated as text/string. That is why it&#39;s returned as part of the .Text()&#39;s return content"}], "tags": [], "owner": {"reputation": 552, "user_id": 2627768, "user_type": "registered", "profile_image": "https://graph.facebook.com/1363681401/picture?type=large", "display_name": "foecum", "link": "https://stackoverflow.com/users/2627768/foecum"}, "is_accepted": false, "score": 1, "last_activity_date": 1474648391, "creation_date": 1474648391, "answer_id": 39665587, "question_id": 39664594, "link": "https://stackoverflow.com/questions/39664594/use-goquery-to-extract-text-from-html-but-the-result-still-contains-html-tag/39665587#39665587", "title": "Use goquery to extract text from html, but the result still contains html tag", "body": "<p>Take the ul element out of the text area. it's being treated as text it's self.\n<a href=\"https://i.stack.imgur.com/QXwR1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/QXwR1.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 84, "user_id": 5689685, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b3ad51791d7762e3c6fa17cba2145393?s=128&d=identicon&r=PG&f=1", "display_name": "Bill", "link": "https://stackoverflow.com/users/5689685/bill"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 929, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1474648391, "creation_date": 1474644846, "question_id": 39664594, "link": "https://stackoverflow.com/questions/39664594/use-goquery-to-extract-text-from-html-but-the-result-still-contains-html-tag", "title": "Use goquery to extract text from html, but the result still contains html tag", "body": "<p>I'm trying to use golang to extract the text from html, and I use the goquery library to do this. \nThe code like below:</p>\n\n<pre><code>document, err := goquery.NewDocumentFromReader(r)\nif err != nil {\n    log.Fatalln(err)\n}\ndocument.Find(\"script\").Remove()\ndocument.Find(\"style\").Remove()\ntext := document.Find(\"body\").Text()\n</code></pre>\n\n<p>The test html page:\n<a href=\"https://i.stack.imgur.com/qc9IC.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/qc9IC.png\" alt=\"enter image description here\"></a></p>\n\n<p>but the result:\n<a href=\"https://i.stack.imgur.com/u1E79.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u1E79.png\" alt=\"enter image description here\"></a></p>\n\n<p>you can find the result still contains the html tag, how could I remove the html tags and only keep the text?</p>\n"}, {"tags": ["ubuntu", "go", "environment-variables", "ubuntu-16.04"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474642464, "post_id": 39663709, "comment_id": 66629300, "body": "from the <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow noreferrer\">GOPATH documentation</a>: &quot;Go searches each directory listed in GOPATH to find source code, but new packages are always downloaded into the first directory in the list&quot;. Don&#39;t use multiple paths, just change your GOPATH when you want to change &quot;workspaces&quot;"}, {"owner": {"reputation": 327, "user_id": 6871023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHRuu.jpg?s=128&g=1", "display_name": "Gautam Vashisht", "link": "https://stackoverflow.com/users/6871023/gautam-vashisht"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474642682, "post_id": 39663709, "comment_id": 66629441, "body": "But making multiple workspaces is possible and there must be any way to resolve this issue. I just want a way to get rid of this problem. Any kind of help from you and Stack Overflow community would be appreciated."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474642783, "post_id": 39663709, "comment_id": 66629516, "body": "What do you mean &quot;making multiple workspaces is possible&quot;? What you&#39;re seeing is the expected behavior for the <code>go</code> tools."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1474643006, "post_id": 39663709, "comment_id": 66629662, "body": "Honestly I would just use separate user accounts if you must maintain separate folders"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1474643375, "post_id": 39663709, "comment_id": 66629897, "body": "A workspace is defined by the value of GOPATH.  To use multiple workspaces, one uses different values for GOPATH."}, {"owner": {"reputation": 327, "user_id": 6871023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHRuu.jpg?s=128&g=1", "display_name": "Gautam Vashisht", "link": "https://stackoverflow.com/users/6871023/gautam-vashisht"}, "edited": false, "score": 0, "creation_date": 1474644558, "post_id": 39663709, "comment_id": 66630584, "body": "I have given two values for GOPATH. Still I am not able to use multiple workspaces correctlly. Then what is wrong? Is it possible that when I change workspace, GOPATH also changes?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1474644722, "post_id": 39663709, "comment_id": 66630679, "body": "You have shown one value for GOPATH, <code>&#47;home&#47;gkv&#47;Desktop&#47;goWorkspace:&#47;home&#47;gkv&#47;Desktop&#47;Business&#47;Bac&zwnj;&#8203;kend</code>.  What&#39;s the other value that you use?  I suggest starting with single directory workspaces (example: <code>GOPATH=&#47;home&#47;gkv&#47;Desktop&#47;goWorkspace</code>).  Using multiple directories in a workspace is an advanced feature."}, {"owner": {"reputation": 327, "user_id": 6871023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHRuu.jpg?s=128&g=1", "display_name": "Gautam Vashisht", "link": "https://stackoverflow.com/users/6871023/gautam-vashisht"}, "edited": false, "score": 0, "creation_date": 1474644859, "post_id": 39663709, "comment_id": 66630773, "body": "&#39;:&#39; is separating the locations of the two workspaces or the two values of GOPATH"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1474647719, "post_id": 39663709, "comment_id": 66632345, "body": "The value <code>&#47;home&#47;gkv&#47;Desktop&#47;goWorkspace:&#47;home&#47;gkv&#47;Desktop&#47;Business&#47;Bac&zwnj;&#8203;\u200c\u200bkend</code> specifies a single workspace that uses two directories.  It does not specify two workspaces."}, {"owner": {"reputation": 327, "user_id": 6871023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHRuu.jpg?s=128&g=1", "display_name": "Gautam Vashisht", "link": "https://stackoverflow.com/users/6871023/gautam-vashisht"}, "edited": false, "score": 0, "creation_date": 1474705034, "post_id": 39663709, "comment_id": 66648914, "body": "Ok! Then how can I give two values to GOPATH and specify two workspaces?"}], "answers": [{"comments": [{"owner": {"reputation": 327, "user_id": 6871023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHRuu.jpg?s=128&g=1", "display_name": "Gautam Vashisht", "link": "https://stackoverflow.com/users/6871023/gautam-vashisht"}, "edited": false, "score": 0, "creation_date": 1474642781, "post_id": 39663843, "comment_id": 66629515, "body": "Then how can I get rid of this problem? Is it a bug in GO?"}, {"owner": {"reputation": 61, "user_id": 6825133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316b598d068aadded30a212bb8394b06?s=128&d=identicon&r=PG&f=1", "display_name": "Zero King", "link": "https://stackoverflow.com/users/6825133/zero-king"}, "reply_to_user": {"reputation": 327, "user_id": 6871023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHRuu.jpg?s=128&g=1", "display_name": "Gautam Vashisht", "link": "https://stackoverflow.com/users/6871023/gautam-vashisht"}, "edited": false, "score": 0, "creation_date": 1474643605, "post_id": 39663843, "comment_id": 66630011, "body": "You cannot use multiple workspaces correctly without changing GOPATH. As the second quote says, there is no need for two workspaces. Use the vendor folder if you need to customize dependencies."}], "tags": [], "owner": {"reputation": 61, "user_id": 6825133, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/316b598d068aadded30a212bb8394b06?s=128&d=identicon&r=PG&f=1", "display_name": "Zero King", "link": "https://stackoverflow.com/users/6825133/zero-king"}, "is_accepted": false, "score": 0, "last_activity_date": 1474642835, "last_edit_date": 1474642835, "creation_date": 1474642616, "answer_id": 39663843, "question_id": 39663709, "link": "https://stackoverflow.com/questions/39663709/how-to-use-multiple-workspaces-correctly-in-golang-in-ubuntu-16-04-lts/39663843#39663843", "title": "How to use multiple workspaces correctly in golang in Ubuntu 16.04 LTS?", "body": "<p>You are using Atom, which makes it harder to change GOPATH.</p>\n\n<blockquote>\n  <p>Go searches each directory listed in GOPATH to find source code, but new packages are always downloaded into the first directory in the list.</p>\n</blockquote>\n\n<p>From <a href=\"https://golang.org/cmd/go/#hdr-GOPATH_environment_variable\" rel=\"nofollow\">https://golang.org/cmd/go/#hdr-GOPATH_environment_variable</a></p>\n\n<blockquote>\n  <p>Even though the GOPATH may be a list of directories, it is generally correct and sufficient to use a single GOPATH for all Go code on your machine. Since all packages retrieved with \"go get\" have a unique URL (and thus a unique path on disk), having more than one GOPATH is almost never necessary when building with the Go tool.</p>\n</blockquote>\n\n<p>From <a href=\"https://github.com/golang/go/wiki/GOPATH#use-a-single-gopath\" rel=\"nofollow\">https://github.com/golang/go/wiki/GOPATH#use-a-single-gopath</a></p>\n"}, {"tags": [], "owner": {"reputation": 796, "user_id": 1286423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/69924a17cad0b5bfc37e4d83dd848ee1?s=128&d=identicon&r=PG", "display_name": "Dolanor", "link": "https://stackoverflow.com/users/1286423/dolanor"}, "is_accepted": false, "score": 0, "last_activity_date": 1474669667, "creation_date": 1474669667, "answer_id": 39670408, "question_id": 39663709, "link": "https://stackoverflow.com/questions/39663709/how-to-use-multiple-workspaces-correctly-in-golang-in-ubuntu-16-04-lts/39670408#39670408", "title": "How to use multiple workspaces correctly in golang in Ubuntu 16.04 LTS?", "body": "<p>I use go for a client with specific packages and personally on lighter project. It's on the same computer.\nI mostly use go get for both of them.</p>\n\n<p>By default I have an <code>export GOPATH=~/path/to/pro</code> in my <code>~/.bashrc</code>.\nAnd when I want to work on my personal project, I <code>export GOPATH=~/path/to/perso</code>.</p>\n\n<p>As I use multiple desktops view (workspace) in unity, I let 1 workspace with a terminal with the right GOPATH in it and tinker in it</p>\n"}], "owner": {"reputation": 327, "user_id": 6871023, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LHRuu.jpg?s=128&g=1", "display_name": "Gautam Vashisht", "link": "https://stackoverflow.com/users/6871023/gautam-vashisht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 931, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1474669667, "creation_date": 1474642147, "question_id": 39663709, "link": "https://stackoverflow.com/questions/39663709/how-to-use-multiple-workspaces-correctly-in-golang-in-ubuntu-16-04-lts", "title": "How to use multiple workspaces correctly in golang in Ubuntu 16.04 LTS?", "body": "<p>I had installed go-1.6 in Ubuntu 16.04 LTS. I also had set up two different workspaces and the $GOPATH by specifying the location of both the workspaces in it.</p>\n\n<p>But one of the workspaces(primary or main workspace) is working correctly while the other one(secondary workspace) is not working. I wish to use the secondary workspace for practising web app development in golang and the primary one for my projects. Both these workspaces have different packages in them as I am using them for different purposes. While working with the secondary workspace, I am getting errors like 'package not found' when I import packages in my programs . The 'go build' tool is looking for those packages in the primary workspace but they are present in secondary workspace. I am using Atom editor by GitHub. </p>\n\n<p>Even when I install packages using 'go get', the packages are installed in the primary workspace.</p>\n\n<p>The 'go environment variables' are as follows :-</p>\n\n<pre><code>gkv@GKVInnovations:~$ go env\nGOARCH=\"amd64\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"amd64\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/gkv/Desktop/goWorkspace:/home/gkv/Desktop/Business/Backend\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go-1.6\"\nGOTOOLDIR=\"/usr/lib/go-1.6/pkg/tool/linux_amd64\"\nGO15VENDOREXPERIMENT=\"1\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -m64 -pthread -fmessage-length=0\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Location of the primary workspace :- /home/gkv/Desktop/goWorkspace</p>\n\n<p>Location of the secondary workspace :- /home/gkv/Desktop/Business/Backend</p>\n\n<p>Please help me to resolve this issue and improve my workflow! </p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"comments": [{"owner": {"reputation": 2013, "user_id": 219912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/edb8a30b7125b23b5ddae9047019f1e0?s=128&d=identicon&r=PG", "display_name": "Steven Lu", "link": "https://stackoverflow.com/users/219912/steven-lu"}, "edited": false, "score": 0, "creation_date": 1474643593, "post_id": 39663798, "comment_id": 66630001, "body": "So if I&#39;m using the App Engine standard environment, I should be using the appengine one?"}, {"owner": {"reputation": 5895, "user_id": 1279005, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c64c420648367c4731d652862fb53d0d?s=128&d=identicon&r=PG", "display_name": "Dmytro Sadovnychyi", "link": "https://stackoverflow.com/users/1279005/dmytro-sadovnychyi"}, "edited": false, "score": 0, "creation_date": 1474721696, "post_id": 39663798, "comment_id": 66653363, "body": "Yes, it&#39;s should be faster. But you could use the first one as well."}, {"owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1474742052, "post_id": 39663798, "comment_id": 66659640, "body": "I would also add that, if you want freedom to move your app in the future to GCE, other cloud provider, to your own server, etc. then avoiding using any App Engine API would be a good idea. Otherwise, I would stay with the native one."}, {"owner": {"reputation": 2013, "user_id": 219912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/edb8a30b7125b23b5ddae9047019f1e0?s=128&d=identicon&r=PG", "display_name": "Steven Lu", "link": "https://stackoverflow.com/users/219912/steven-lu"}, "edited": false, "score": 0, "creation_date": 1474858780, "post_id": 39663798, "comment_id": 66687188, "body": "IMO, I started using app engine stuff for app engine and memory leaks started going away (from some client context leak)."}], "tags": [], "owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "is_accepted": true, "score": 2, "last_activity_date": 1474642478, "creation_date": 1474642478, "answer_id": 39663798, "question_id": 39663617, "link": "https://stackoverflow.com/questions/39663617/what-are-the-differences-between-these-gae-libraries/39663798#39663798", "title": "What are the differences between these GAE libraries?", "body": "<p>cloud.google.com/go/datastore is a client library for the Cloud Datastore rest API (available from anywhere).</p>\n\n<p>google.golang.org/appengine/datastore is part from App Engine API (available only from App Engine).</p>\n"}], "owner": {"reputation": 2013, "user_id": 219912, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/edb8a30b7125b23b5ddae9047019f1e0?s=128&d=identicon&r=PG", "display_name": "Steven Lu", "link": "https://stackoverflow.com/users/219912/steven-lu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "accepted_answer_id": 39663798, "answer_count": 1, "score": 5, "last_activity_date": 1474642478, "creation_date": 1474641913, "question_id": 39663617, "link": "https://stackoverflow.com/questions/39663617/what-are-the-differences-between-these-gae-libraries", "title": "What are the differences between these GAE libraries?", "body": "<p>Throughout the Google App Engine documentation for Go, they use libraries interchangeably. Here's an example:</p>\n\n<pre><code>import \"cloud.google.com/go/datastore\"\nimport \"google.golang.org/appengine/datastore\"\n</code></pre>\n\n<p>Which of these libraries should I use and what are the key differences?</p>\n"}]