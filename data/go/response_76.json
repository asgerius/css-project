[{"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "edited": false, "score": 0, "creation_date": 1466656833, "post_id": 37980124, "comment_id": 63409995, "body": "thanks. i needed to provide the first parameter to http.Handle, the following value: &quot;/node_modules/&quot; (an ending / to the directory). now it works"}], "tags": [], "owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "is_accepted": true, "score": 1, "last_activity_date": 1466662697, "last_edit_date": 1495535644, "creation_date": 1466639969, "answer_id": 37980124, "question_id": 37979883, "link": "https://stackoverflow.com/questions/37979883/serving-static-files-in-different-locations/37980124#37980124", "title": "serving static files in different locations", "body": "<p>The FileServer is trying to route paths such as /node_modules/... to the file \"client/node_modules/node_modules/...\"</p>\n\n<p>So use <a href=\"https://golang.org/pkg/net/http/#example_FileServer_stripPrefix\" rel=\"nofollow noreferrer\">StripPrefix</a>, eg:</p>\n\n<pre><code>http.Handle(\"/node_modules\", http.StripPrefix(\"/node_modules\", http.FileServer(http.Dir((\"client/node_modules\")))))\n</code></pre>\n\n<p>See another <a href=\"https://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files\">answer</a> here.</p>\n"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 37980124, "answer_count": 1, "score": 1, "last_activity_date": 1466662697, "creation_date": 1466638281, "question_id": 37979883, "link": "https://stackoverflow.com/questions/37979883/serving-static-files-in-different-locations", "title": "serving static files in different locations", "body": "<p>I'm writing a Go Application that serves files in two different directories.</p>\n\n<p>My project structure:</p>\n\n<pre><code>PROJECT_DIR\nPROJECT_DIR/config\nPROJECT_DIR/src\nPROJECT_DIR/client\nPROJECT_DIR/client/node_modules\nPROJECT_DIR/client/www\n</code></pre>\n\n<p>in my main go file i start the file server using the following code:</p>\n\n<pre><code>func main() {\nlog.Print(\"started web server...\");\nhttpsPortStr := \":\" + strconv.FormatUint(config.CfgIni.HttpsPort, 10)\nlog.Printf(\"starting https web server at port %v\", config.CfgIni.HttpsPort)\nhttp.Handle(\"/\", http.FileServer(http.Dir(\"client/www\")))\nhttp.Handle(\"/node_modules\",http.FileServer(http.Dir((\"client/node_modules\"))))\nerr := http.ListenAndServeTLS(httpsPortStr, config.CfgIni.CertificateFile, config.CfgIni.PrivateKeyFile, nil)\nif err != nil {\n    log.Fatalf(\"https server stopped with the following error: %v\", err)\n} else {\n    log.Print(\"https server stopped with no error\")\n}\n}\n</code></pre>\n\n<p>as you can see I mapped <code>/</code> to client/www and <code>/node_modules</code> to client/node_modules.</p>\n\n<p>when I try to access files on client/www for example <a href=\"https://host:port/test.html\" rel=\"nofollow\">https://host:port/test.html</a>, it works great!</p>\n\n<p>when I try to access files on client/node_modules for example: <a href=\"https://host:port/node_modules/test.html\" rel=\"nofollow\">https://host:port/node_modules/test.html</a>, I get 404 page not found.</p>\n\n<p>test.html file exists in both location and is readable (no permission problems).</p>\n\n<p>I'm probably configuring the routing wrong somehow.</p>\n\n<p>any ideas?</p>\n\n<p>thanks!</p>\n"}, {"tags": ["http", "go", "request"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1466640953, "post_id": 37979630, "comment_id": 63406116, "body": "Interesting! User agent of just &quot;Chrome&quot; gives 403. User agent of &quot;chrome&quot; gives 200. Perhaps nike thinks you&#39;re trying to impersonate a browser?"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1466641006, "post_id": 37980196, "comment_id": 63406126, "body": "I tried switching the order w/ no luck. I&#39;ve been playing around a bit and if I set ALL the other headers that Chrome sends then it works. Wondering why Nike does that..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466641080, "post_id": 37980196, "comment_id": 63406148, "body": "@kristen: the site is attempting to prevent malicious activity. If it knows you&#39;re not a chrome browser, but gets a chrome user agent, it will deny the request."}, {"owner": {"reputation": 905, "user_id": 411577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d780669bdc605a954cda738d1de743?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/411577/adrien"}, "edited": false, "score": 1, "creation_date": 1466641115, "post_id": 37980196, "comment_id": 63406158, "body": "that was my next suggestion - to review all other headers.  There must be some kind of fingerprinting going on.  It&#39;s quite common for the UA string to look very similar between different clients."}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466641338, "post_id": 37980196, "comment_id": 63406223, "body": "@JimB: that makes sense. I was going crazy trying to see if it was some sort of bug in Go or what not. Doesn&#39;t seem like a good way to prevent anything, since even an amateur like myself could (eventually) figure out that setting the rest of the headers lets me spoof a real browser."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466643240, "post_id": 37980196, "comment_id": 63406669, "body": "@kristen: I didn&#39;t say it was very good at doing that ;) It&#39;s most likely an application firewall that applies various heuristics to each request based on previous patterns (it is going through an akamai edge server). If you were to  cause &quot;problems&quot; with a different particular pattern of headers, you may find that blocked too.  Regardless the behavior is entirely up to the remote server."}], "tags": [], "owner": {"reputation": 905, "user_id": 411577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3d780669bdc605a954cda738d1de743?s=128&d=identicon&r=PG", "display_name": "Adrien", "link": "https://stackoverflow.com/users/411577/adrien"}, "is_accepted": true, "score": -1, "last_activity_date": 1466668999, "last_edit_date": 1466668999, "creation_date": 1466640458, "answer_id": 37980196, "question_id": 37979630, "link": "https://stackoverflow.com/questions/37979630/why-am-i-being-denied-when-i-change-my-user-agent/37980196#37980196", "title": "Why am I being denied when I change my user agent?", "body": "<p>Your test code uses the same HTTP client object to send both requests, which presumably both go over the same connection.</p>\n\n<p>Did you try sending the requests on different connections?  Try setting your flags to true then false and see if it's always just the second one that fails.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 709, "favorite_count": 0, "accepted_answer_id": 37980196, "answer_count": 1, "score": 2, "last_activity_date": 1466668999, "creation_date": 1466636652, "last_edit_date": 1466641140, "question_id": 37979630, "link": "https://stackoverflow.com/questions/37979630/why-am-i-being-denied-when-i-change-my-user-agent", "title": "Why am I being denied when I change my user agent?", "body": "<p>I have a simple request to get the robots.txt file from nike.com. A normal GET request in Go returns the file as expected. In my current browser (Chrome) I can access the file fine. However, when I try to change my UA in Go to the same as that of my browser, I get a 403 error. </p>\n\n<p>In other words, I can access the page using the default settings in Go, proving that my code is correct, but once I change the UA I get a 403 (even though that same UA in my browser works).</p>\n\n<p>If I change the UA to something random (e.g. \"Not me\") then I get a 200. Why can't I use my browser's UA?</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n\n    \"github.com/davecgh/go-spew/spew\"\n)\n\nfunc main() {\n    var resp *http.Response\n    var err error\n    u := \"http://www.nike.com/robots.txt\"\n\n    for _, ua := range []bool{false, true} {\n        client := &amp;http.Client{}\n        req, _ := http.NewRequest(\"GET\", u, nil)\n        if ua == true {\n            req.Header.Set(\"User-Agent\", \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36\")\n        }\n        resp, err = client.Do(req)\n        if err != nil {\n            log.Fatalln(err)\n        }\n        log.Println(\"StatusCode\", resp.StatusCode)\n        spew.Dump(resp.Request)\n        log.Println(\"----------------------------\")\n    }\n\n}\n</code></pre>\n\n<p>The response:</p>\n\n<pre><code>2016/06/22 16:56:57 StatusCode 200\n(*http.Request)(0xc8200d02a0)({\n Method: (string) (len=3) \"GET\",\n URL: (*url.URL)(0xc820076280)(http://www.nike.com/robots.txt),\n Proto: (string) (len=8) \"HTTP/1.1\",\n ProtoMajor: (int) 1,\n ProtoMinor: (int) 1,\n Header: (http.Header) {\n },\n Body: (io.ReadCloser) &lt;nil&gt;,\n ContentLength: (int64) 0,\n TransferEncoding: ([]string) &lt;nil&gt;,\n Close: (bool) false,\n Host: (string) (len=12) \"www.nike.com\",\n Form: (url.Values) &lt;nil&gt;,\n PostForm: (url.Values) &lt;nil&gt;,\n MultipartForm: (*multipart.Form)(&lt;nil&gt;),\n Trailer: (http.Header) &lt;nil&gt;,\n RemoteAddr: (string) \"\",\n RequestURI: (string) \"\",\n TLS: (*tls.ConnectionState)(&lt;nil&gt;),\n Cancel: (&lt;-chan struct {}) &lt;nil&gt;\n})\n2016/06/22 16:56:57 ----------------------------\n2016/06/22 16:56:57 StatusCode 403\n(*http.Request)(0xc820110000)({\n Method: (string) (len=3) \"GET\",\n URL: (*url.URL)(0xc8200ea180)(http://www.nike.com/robots.txt),\n Proto: (string) (len=8) \"HTTP/1.1\",\n ProtoMajor: (int) 1,\n ProtoMinor: (int) 1,\n Header: (http.Header) (len=1) {\n  (string) (len=10) \"User-Agent\": ([]string) (len=1 cap=1) {\n   (string) (len=104) \"Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/50.0.2661.94 Safari/537.36\"\n  }\n },\n Body: (io.ReadCloser) &lt;nil&gt;,\n ContentLength: (int64) 0,\n TransferEncoding: ([]string) &lt;nil&gt;,\n Close: (bool) false,\n Host: (string) (len=12) \"www.nike.com\",\n Form: (url.Values) &lt;nil&gt;,\n PostForm: (url.Values) &lt;nil&gt;,\n MultipartForm: (*multipart.Form)(&lt;nil&gt;),\n Trailer: (http.Header) &lt;nil&gt;,\n RemoteAddr: (string) \"\",\n RequestURI: (string) \"\",\n TLS: (*tls.ConnectionState)(&lt;nil&gt;),\n Cancel: (&lt;-chan struct {}) &lt;nil&gt;\n})\n2016/06/22 16:56:57 ----------------------------\n</code></pre>\n\n<p>EDIT: \nI've been playing around a bit and if I set ALL the other headers that Chrome sends then it works.</p>\n"}, {"tags": ["linux", "macos", "sockets", "go"], "answers": [{"comments": [{"owner": {"reputation": 299, "user_id": 477166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb89664a802ee41cf89ab7bed6392fcd?s=128&d=identicon&r=PG", "display_name": "Kevin Postal", "link": "https://stackoverflow.com/users/477166/kevin-postal"}, "edited": false, "score": 0, "creation_date": 1466651117, "post_id": 37980397, "comment_id": 63408479, "body": "Would wrapping the handler with a TimeoutHandler help at all? (<a href=\"https://golang.org/pkg/net/http/#TimeoutHandler\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/#TimeoutHandler</a>)"}, {"owner": {"reputation": 299, "user_id": 477166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb89664a802ee41cf89ab7bed6392fcd?s=128&d=identicon&r=PG", "display_name": "Kevin Postal", "link": "https://stackoverflow.com/users/477166/kevin-postal"}, "edited": false, "score": 0, "creation_date": 1466700659, "post_id": 37980397, "comment_id": 63438654, "body": "I followed your recommendation of using ConnState. Works perfectly! Thanks!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1466641984, "creation_date": 1466641984, "answer_id": 37980397, "question_id": 37979111, "link": "https://stackoverflow.com/questions/37979111/golang-keeps-file-serve-socket-open-after-close/37980397#37980397", "title": "Golang Keeps File Serve Socket Open After Close", "body": "<p>There's no way to shut down idle HTTP/1.1 or HTTP2 connections. There is a an open issue at <a href=\"https://golang.org/issue/9478\" rel=\"nofollow\">https://golang.org/issue/9478</a>, but no immediate plans for it. Note that once you close your listener, your server will not accept new connections; you're reusing the same connection.</p>\n\n<p>If you want to forcefully close all connections, you would need to do the bookkeeping yourself using the <a href=\"https://godoc.org/net/http#Server\" rel=\"nofollow\"><code>http.Server</code></a> <code>ConnState</code> to track the TCP connections that are active.</p>\n\n<p>You could also have your handlers set <code>Connection: close</code> on each response, but that would make your http server much less efficient if clients ever need to make more than 1 request. </p>\n"}], "owner": {"reputation": 299, "user_id": 477166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb89664a802ee41cf89ab7bed6392fcd?s=128&d=identicon&r=PG", "display_name": "Kevin Postal", "link": "https://stackoverflow.com/users/477166/kevin-postal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 943, "favorite_count": 0, "accepted_answer_id": 37980397, "answer_count": 1, "score": 1, "last_activity_date": 1466641984, "creation_date": 1466633514, "question_id": 37979111, "link": "https://stackoverflow.com/questions/37979111/golang-keeps-file-serve-socket-open-after-close", "title": "Golang Keeps File Serve Socket Open After Close", "body": "<p>I created a file server in golang and call the Close() method on the Listener.</p>\n\n<p>When I try to access the Port on a new Web connection it appears the Socket is closed and I am unable to access the website. </p>\n\n<p>How ever if I referesh the page with a connection that has already been established.... the page reloads fine as if the socket was never closed? I am even able to still browse around the file system.</p>\n\n<p>I noticed after 30 or so minutes the socket seems to force close.</p>\n\n<p>Is there something I am missing to force the socket to drop all existing connections to prevent people from accessing the file server?</p>\n\n<pre><code>var fileListener net.Listener\nhost_string = \"127.0.0.1:8080\"\nfileListener, _ = net.Listen(\"tcp\", host_string)\nserver := &amp;http.Server{Addr: host_string, Handler:     \nhttp.FileServer(http.Dir(\"/\"))}\ngo func() { server.Serve(fileListener) }()\nfileListener.Close()\n</code></pre>\n"}, {"tags": ["c++", "file", "go"], "comments": [{"owner": {"reputation": 18435, "user_id": 845568, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c4f2f13bd99d95ae2ee2249e9b1b8731?s=128&d=identicon&r=PG", "display_name": "Captain Obvlious", "link": "https://stackoverflow.com/users/845568/captain-obvlious"}, "edited": false, "score": 1, "creation_date": 1466627749, "post_id": 37977714, "comment_id": 63401615, "body": "If you&#39;re using buffered IO there may be an additional write to flush any remaining data."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1466628075, "post_id": 37977714, "comment_id": 63401749, "body": "And flushing the buffer could result in filling the disk."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 5910058, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/87e1ce21ce04eb150f59eaec245d4ff8?s=128&d=identicon&r=PG&f=1", "display_name": "Jesper Juhl", "link": "https://stackoverflow.com/users/5910058/jesper-juhl"}, "is_accepted": true, "score": 8, "last_activity_date": 1466628391, "last_edit_date": 1466628391, "creation_date": 1466628011, "answer_id": 37977877, "question_id": 37977714, "link": "https://stackoverflow.com/questions/37977714/can-i-get-an-error-when-closing-a-file/37977877#37977877", "title": "Can I get an error when closing a file?", "body": "<p>Yes. Closing a file can cause an error/fail. See for example the errors that <code>close(3)</code> can return -  <a href=\"http://linux.die.net/man/3/close\" rel=\"noreferrer\">http://linux.die.net/man/3/close</a> - stuff like filesystem corruption is one probable cause.</p>\n\n<p>Often you can't really do much about it though other than log an error and know that your data is probably screwed (depending on the error) - you can rarely \"fix it\" except for maybe re-writing the data somewhere else if you still have it etc.</p>\n\n<p>The language you are using (Go, C++, <em>whatever</em>) is irrelevant. If the filesystem is full, corrupt or someone has physically ripped out the harddrive, then your programming language just can't save you and close will fail and it is anybodys guess whether your data are safely stored somewhere or not.</p>\n"}, {"tags": [], "owner": {"reputation": 54044, "user_id": 3723423, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/a2c916310a1261b53773de75fc83e5ad?s=128&d=identicon&r=PG&f=1", "display_name": "Christophe", "link": "https://stackoverflow.com/users/3723423/christophe"}, "is_accepted": false, "score": 4, "last_activity_date": 1591383739, "last_edit_date": 1591383739, "creation_date": 1466628113, "answer_id": 37977893, "question_id": 37977714, "link": "https://stackoverflow.com/questions/37977714/can-i-get-an-error-when-closing-a-file/37977893#37977893", "title": "Can I get an error when closing a file?", "body": "<p>At OS level, things can also go wrong when closing files, especially if you have written to them (i.e. buffering issues, out of disk space, media removed, etc...).  </p>\n\n<p>The C++ <code>fstream</code> has a <a href=\"http://www.cplusplus.com/reference/fstream/ofstream/close/\" rel=\"nofollow noreferrer\"><code>void close()</code></a> function which doesn't return anything. The principle is that once you called close you can no longer use the stream whether there was an error or not.  However when a closing error occurs, the fail bit is set, so that it can be detected, and the error code can be retrieved the usual way.  </p>\n\n<p>The C <a href=\"http://www.cplusplus.com/reference/cstdio/fclose/\" rel=\"nofollow noreferrer\"><code>fclose()</code></a> returns an <code>int</code> which shows if there was an error or not.  If you want to know why it failed you have to get and analyze the <a href=\"http://www.cplusplus.com/reference/cerrno/errno/\" rel=\"nofollow noreferrer\"><code>errno</code></a> error code.  It's not as self-explaining as a void function, but here also, you can't use the FILE* anymore after the closing call, whether there was an error or not.  </p>\n"}], "owner": {"reputation": 105, "user_id": 4201010, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/UBzJY.jpg?s=128&g=1", "display_name": "Jean", "link": "https://stackoverflow.com/users/4201010/jean"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2663, "favorite_count": 1, "accepted_answer_id": 37977877, "answer_count": 2, "score": 4, "last_activity_date": 1591383739, "creation_date": 1466627396, "question_id": 37977714, "link": "https://stackoverflow.com/questions/37977714/can-i-get-an-error-when-closing-a-file", "title": "Can I get an error when closing a file?", "body": "<p>When programming I often open and close files. I understand that when opening a file, it's important to check for errors to see if it did in fact open. I don't know of an instance though when closing a file would be an issue (except for maybe if opening the file did give an error and it went unchecked).</p>\n\n<p>I'm currently programming in go, and under the <code>os</code> package the <code>.Close()</code> function <em>can</em> return an error if it needs to. I know in C++ this is possible as well.</p>\n\n<p>So finally, my question is what circumstances would cause an error when trying to close a file?</p>\n"}, {"tags": ["go", "typescript", "angular"], "comments": [{"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 1, "creation_date": 1466622190, "post_id": 37976265, "comment_id": 63398788, "body": "I&#39;ve looked into this in the past, and I find it&#39;s just easier to combine a <code>http.FileServer</code> with <code>tsc -w</code> that will automatically compile the files and dump them to the static folder. That way the Go code doesn&#39;t have to worry about compile errors, new versions, etc."}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "reply_to_user": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1466623799, "post_id": 37976265, "comment_id": 63399615, "body": "@robbrit I&#39;ll look into it. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 7554, "user_id": 700471, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/ebb4cc58c1fce4f22abc59a1226ee8e2?s=128&d=identicon&r=PG", "display_name": "Matt Mc", "link": "https://stackoverflow.com/users/700471/matt-mc"}, "edited": false, "score": 0, "creation_date": 1598508668, "post_id": 37976427, "comment_id": 112482556, "body": "You could also now <a href=\"https://github.com/evanw/esbuild\" rel=\"nofollow noreferrer\">build a handler</a> to compile TS on the fly."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 3, "last_activity_date": 1466622658, "creation_date": 1466622658, "answer_id": 37976427, "question_id": 37976265, "link": "https://stackoverflow.com/questions/37976265/can-gos-http-server-compile-typescript/37976427#37976427", "title": "can Go&#39;s http server compile typescript?", "body": "<p>You have a couple of options here:</p>\n\n<ol>\n<li><p>Do the translation client side by including the typescript library in your html and loading <code>&lt;script type='text/typescript' src=\"/myscript.ts\"&gt;&lt;/script&gt;</code></p></li>\n<li><p>Run <code>tsc -w</code> in the background and just serve the compiled javascript. You could launch it when your app starts so it dies with your app as well. I only run tsc in \"dev\" mode, and check in the js files for production use.</p></li>\n<li><p>Run tsc on demand when you receive requests, and cache results. Probably pretty tricky to detect changes but there are <a href=\"https://github.com/howeyc/fsnotify\" rel=\"nofollow\">packages</a> to help with that.</p></li>\n</ol>\n"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 37976427, "answer_count": 1, "score": 1, "last_activity_date": 1466622658, "creation_date": 1466622014, "question_id": 37976265, "link": "https://stackoverflow.com/questions/37976265/can-gos-http-server-compile-typescript", "title": "can Go&#39;s http server compile typescript?", "body": "<p>Currently I have a NodeJS Application that starts an http server with client side code that is written in TypeScript and using Angular 2.</p>\n\n<p>is it possible to do the same in Go ?</p>\n\n<p>I tried googling for TypeScript and Go and didn't find anything relevant.</p>\n\n<p>should I have nodeJS installed, install typescript compiler with <code>npm install -g typescript</code>, compile the typescripts whenever I change them and provide the javascript files on my Go Server ?  </p>\n\n<p>any information regarding the issue would be greatly appreciated.</p>\n\n<p>thanks!</p>\n"}, {"tags": ["regex", "go"], "answers": [{"tags": [], "owner": {"reputation": 80721, "user_id": 797049, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/5f4f7a23e3d0134123a66015bdc4edd1?s=128&d=identicon&r=PG", "display_name": "Mark Reed", "link": "https://stackoverflow.com/users/797049/mark-reed"}, "is_accepted": false, "score": 4, "last_activity_date": 1466660819, "last_edit_date": 1466660819, "creation_date": 1466621508, "answer_id": 37976103, "question_id": 37976076, "link": "https://stackoverflow.com/questions/37976076/regex-is-not-a-constant-compilation-error/37976103#37976103", "title": "Regex &quot;is not a constant&quot; compilation error", "body": "<p>In Go declaration context, assignment with a simple <code>=</code> creates a constant, not a variable. (Outside of a declaration, it's an assignment to a variable that must already exist.)</p>\n\n<p>But a constant initialization has to include only constants - not calls like <code>regexp.MustCompile()</code> - so <code>pattern</code> <em>can't</em> be a constant in this case, even if you don't plan on changing its value later. (In fact, even if you could somehow initialize it without calling anything, a <code>Regexp</code> can't be a constant in Go; only basic types can be.)</p>\n\n<p>That means you need to make it a variable by either putting it inside a <code>var</code> statement or declaring it inside a function with <code>:=</code> instead of <code>=</code>:</p>\n\n<pre><code>var (\n   pattern = ...\n)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var pattern = ...\n</code></pre>\n\n<p>or</p>\n\n<pre><code>func something() {\n   pattern := ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 9, "last_activity_date": 1525351038, "last_edit_date": 1525351038, "creation_date": 1466621584, "answer_id": 37976127, "question_id": 37976076, "link": "https://stackoverflow.com/questions/37976076/regex-is-not-a-constant-compilation-error/37976127#37976127", "title": "Regex &quot;is not a constant&quot; compilation error", "body": "<p>The error is pretty clear. If you are trying to do this globally...</p>\n\n<p>Don't do:</p>\n\n<pre><code>const pattern = regexp.MustCompile(`^[A-Za-z0-9_\\.]+`)\n</code></pre>\n\n<p>Instead do:</p>\n\n<pre><code>var pattern = regexp.MustCompile(`^[A-Za-z0-9_\\.]+`)\n</code></pre>\n\n<p>Or if you really want the pattern in a constant:</p>\n\n<pre><code>const pattern = `^[A-Za-z0-9_\\.]+`\nvar alphaNum = regexp.MustCompile(pattern)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "is_accepted": true, "score": 22, "last_activity_date": 1611157898, "last_edit_date": 1611157898, "creation_date": 1466621620, "answer_id": 37976143, "question_id": 37976076, "link": "https://stackoverflow.com/questions/37976076/regex-is-not-a-constant-compilation-error/37976143#37976143", "title": "Regex &quot;is not a constant&quot; compilation error", "body": "<p>This happens when you're trying to assign to a constant that has a type that can't be constant (like for example, <code>Regexp</code>). Only basic types likes <code>int</code>, <code>string</code>, etc. can be constant. See <a href=\"https://blog.golang.org/constants\" rel=\"nofollow noreferrer\" title=\"here\">here</a> for more details.</p>\n<p>Example:</p>\n<pre><code>pattern = regexp.MustCompile(`^[A-Za-z0-9_\\.]+`)\n// which translates to:\nconst pattern = regexp.MustCompile(`^[A-Za-z0-9_\\.]+`)\n</code></pre>\n<p>You have to declare it as a <code>var</code> for it to work:</p>\n<pre><code>var pattern = regexp.MustCompile(`^[A-Za-z0-9_\\.]+`)\n</code></pre>\n<p>In addition, I usually put a note to say that the variable is treated as a constant:</p>\n<pre><code>var /* const */ pattern = regexp.MustCompile(`^[A-Za-z0-9_\\.]+`)\n</code></pre>\n"}], "owner": {"reputation": 552, "user_id": 610599, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/29e46d35f3ab3c9b123076ec422d2771?s=128&d=identicon&r=PG", "display_name": "joulesm", "link": "https://stackoverflow.com/users/610599/joulesm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7037, "favorite_count": 2, "accepted_answer_id": 37976143, "answer_count": 3, "score": 14, "last_activity_date": 1611157942, "creation_date": 1466621414, "last_edit_date": 1611157942, "question_id": 37976076, "link": "https://stackoverflow.com/questions/37976076/regex-is-not-a-constant-compilation-error", "title": "Regex &quot;is not a constant&quot; compilation error", "body": "<p>I'm trying to write a regex in Go to verify that a string only has alphanumerics, periods, and underscores. However, I'm running into an error that I haven't seen before and have been unsuccessful at Googling.</p>\n<p>Here's the regex:</p>\n<pre><code>pattern = regexp.MustCompile(`^[A-Za-z0-9_\\.]+`)\n</code></pre>\n<p>Here is the error:</p>\n<pre><code>const initializer regexp.MustCompile(&quot;^[A-Za-z0-9_\\\\.]+&quot;) is not a constant\n</code></pre>\n<p>What does &quot;not a constant&quot; mean and how do I fix this?<br></p>\n"}, {"tags": ["ios", "json", "swift", "go", "nsdata"], "answers": [{"tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": false, "score": 0, "last_activity_date": 1466630224, "creation_date": 1466630224, "answer_id": 37978393, "question_id": 37975992, "link": "https://stackoverflow.com/questions/37975992/how-do-i-read-json-on-my-golang-server-that-ive-posted-from-ios-using-nsdata/37978393#37978393", "title": "How do I read JSON on my Golang server that I&#39;ve posted from iOS using NSData?", "body": "<p>That would be something like :</p>\n\n<pre><code>type Foo strut {\n  Bar string `json:\"bar\"`\n}\n\n// extract\ndata, err := ioutil.ReadAll(request.Body)\nif err != nil {\n  return err\n}\ndefer request.Body.Close()\n\nv := &amp;Foo{}\njson.Unmarshal(data, v)    \n</code></pre>\n\n<p>The <code>json:\"bar\"</code> in <code>Foo</code> binds the JSON struct with the Go struct</p>\n"}, {"tags": [], "owner": {"reputation": 6480, "user_id": 1152182, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/Sp4wK.jpg?s=128&g=1", "display_name": "Melih Mucuk", "link": "https://stackoverflow.com/users/1152182/melih-mucuk"}, "is_accepted": false, "score": 0, "last_activity_date": 1466694756, "last_edit_date": 1466694756, "creation_date": 1466694237, "answer_id": 37995376, "question_id": 37975992, "link": "https://stackoverflow.com/questions/37975992/how-do-i-read-json-on-my-golang-server-that-ive-posted-from-ios-using-nsdata/37995376#37995376", "title": "How do I read JSON on my Golang server that I&#39;ve posted from iOS using NSData?", "body": "<p>You should create struct like below:</p>\n\n<pre><code>type MyRequest struct {\n    Receipt string `json:\"receipt\"`\n    ProdID string `json:\"prod_id\"`\n}\n</code></pre>\n\n<p>then decode request body:</p>\n\n<pre><code>func handleMyRequest(rw http.ResponseWriter, req *http.Request) {\n    decoder := json.NewDecoder(req.Body)\n    var myReq MyRequest\n    err := decoder.Decode(&amp;myReq)\n    if err != nil {\n        panic()\n    }\n    log.Println(myReq)\n}\n</code></pre>\n"}], "owner": {"reputation": 27533, "user_id": 998117, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/bfe07f542ce4f5d75e4262e188691fd5?s=128&d=identicon&r=PG&f=1", "display_name": "Doug Smith", "link": "https://stackoverflow.com/users/998117/doug-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 123, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1466694756, "creation_date": 1466621059, "question_id": 37975992, "link": "https://stackoverflow.com/questions/37975992/how-do-i-read-json-on-my-golang-server-that-ive-posted-from-ios-using-nsdata", "title": "How do I read JSON on my Golang server that I&#39;ve posted from iOS using NSData?", "body": "<p>I'm trying to validate a receipt by sending it to my custom server from iOS. </p>\n\n<p>I have my <code>NSMutableURLRequest</code> and set it up as so:</p>\n\n<pre><code>    let body: [String: AnyObject] = [\"receipt\": receipt, \"prod_id\": productID]\n\n    let optionalJson: NSData?\n\n    do {\n        optionalJson = try NSJSONSerialization.dataWithJSONObject(body, options: [])\n    } catch _ {\n        optionalJson = nil\n    }\n\n    guard let json = optionalJson else { return }\n\n    request.HTTPBody = json\n</code></pre>\n\n<p>Then I send it off to my server which is written in Go, but I don't know how to then read the data.</p>\n\n<p>Previously I sent only the data (in raw form, not a JSON structure), and then turned into a base 64 encoded string as so before shipping it off:</p>\n\n<pre><code>data, _ := ioutil.ReadAll(request.Body)\nencodedString := base64.StdEncoding.EncodeToString(data)\n</code></pre>\n\n<p>But now I the JSON structure that links a <code>prod_id</code> with is a <code>string</code>, as well as the receipt data, which I assume is <code>bytes</code>. How do I extract that into readable JSON then turn it into a base 64 encoded string as above?</p>\n\n<p>I guess I'm not sure what structure the JSON would take.</p>\n"}, {"tags": ["go", "static-files"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466616459, "post_id": 37974617, "comment_id": 63395524, "body": "Your files need to be relative to the working directory of your server process. The location in the source has nothing to do with where you run the server."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1466616549, "post_id": 37974617, "comment_id": 63395585, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/28293452/404-page-not-found-go-rendering-css-file\">404 page not found - Go rendering css file</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1466616710, "post_id": 37974617, "comment_id": 63395677, "body": "Also related / possible duplicate of <a href=\"http://stackoverflow.com/questions/27945310/why-do-i-need-to-use-http-stripprefix-to-access-my-static-files\">Why do I need to use http.StripPrefix to access my static files?</a>"}, {"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466684931, "post_id": 37974617, "comment_id": 63426968, "body": "Guys this has nothing to do with the problem that I can not read a file correctly from the FileSystem"}], "answers": [{"comments": [{"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466685280, "post_id": 37991656, "comment_id": 63427202, "body": "Hey, man. Thank you for the answer. I just tried it and it did not work. I get &quot; The localhost page isn\u2019t working localhost didn\u2019t send any data. ERR_EMPTY_RESPONSE &quot; again. What i did was to copy your source, paste it in a new file main2.go, and run &quot; go run BasicWebServer/main2.go &quot;. The index.html file is in the same dir as main2.go ...."}, {"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466685387, "post_id": 37991656, "comment_id": 63427286, "body": "Index functoin22222 open index.html: no such file or directory ....  This is the output in the console"}, {"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466685753, "post_id": 37991656, "comment_id": 63427536, "body": "If i supply the full path I get the correct file though. However I do not want to have to supply the full path since this means all static imports will be bound to my set-up. What can we do about this ?"}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "reply_to_user": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466686551, "post_id": 37991656, "comment_id": 63428107, "body": "There&#39;s <code>http.StripPrefix</code> for that. You shouldn&#39;t have such problems with relative paths. Let me give it a try and I&#39;ll link you an example."}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "reply_to_user": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466686629, "post_id": 37991656, "comment_id": 63428176, "body": "Also, I see you run the application using <code>go run BasicWebServer&#47;main2.go</code> this means your current working directory is different to the one you are using in your application. That&#39;s something we can work with too."}, {"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466686748, "post_id": 37991656, "comment_id": 63428273, "body": "I have no idea man. I literally started this week so everything is new to me :D THanks for the help"}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "reply_to_user": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 1, "creation_date": 1466686799, "post_id": 37991656, "comment_id": 63428317, "body": "Go inside <code>BasicWebServer</code> directory, then <code>go run main2.go</code>, your relative path will work just fine."}, {"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 1, "creation_date": 1466686921, "post_id": 37991656, "comment_id": 63428413, "body": "Yes it does. Thank you. Any comment on what is going on. It feels kind of strange to run the app from within its inner folders ... Also my static files are still not showing up :X I can make a separate question for this if needed"}, {"owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466686971, "post_id": 37991656, "comment_id": 63428457, "body": "I will make another question for the static files after I give it another try :D sorry to bother you."}, {"owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "reply_to_user": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "edited": false, "score": 0, "creation_date": 1466687074, "post_id": 37991656, "comment_id": 63428543, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/115409/discussion-between-toqueteos-and-mp3por\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 681, "user_id": 322221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c041d8d4b3b0b857c54c7906acb79b12?s=128&d=identicon&r=PG", "display_name": "toqueteos", "link": "https://stackoverflow.com/users/322221/toqueteos"}, "is_accepted": true, "score": 3, "last_activity_date": 1466684970, "creation_date": 1466684970, "answer_id": 37991656, "question_id": 37974617, "link": "https://stackoverflow.com/questions/37974617/cant-read-file-in-golang/37991656#37991656", "title": "Can&#39;t read file in GoLang", "body": "<p>If you want <code>BasicWebServer/main.go</code> to show <code>BasicWebServer/index.html</code>, not the one inside the <code>static</code> folder, then it seems you didn't properly configure the HTTP server.</p>\n\n<p>Here's your code, with package declaration, imports and a <code>main</code> function working as you expected.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\nfunc check(e error) {\n    if e != nil {\n        fmt.Println(e)\n        panic(e)\n    }\n}\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"Index functoin\")\n    indexHTML, err := ioutil.ReadFile(\"index.html\")\n    check(err)\n    fmt.Println(indexHTML)\n    w.Write(indexHTML)\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", Index)\n\n    err := http.ListenAndServe(\":8080\", nil)\n    check(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 1724, "user_id": 3379839, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/a5b0dd369de32b1db9a545c6845ffcd1?s=128&d=identicon&r=PG&f=1", "display_name": "mp3por", "link": "https://stackoverflow.com/users/3379839/mp3por"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3204, "favorite_count": 0, "accepted_answer_id": 37991656, "answer_count": 1, "score": 0, "last_activity_date": 1466684970, "creation_date": 1466616254, "question_id": 37974617, "link": "https://stackoverflow.com/questions/37974617/cant-read-file-in-golang", "title": "Can&#39;t read file in GoLang", "body": "<p>I am new to GoLang dev and am trying to make a simple web-app. I have been following this tutorial <a href=\"https://www.youtube.com/watch?v=AiRhWG-2nGU\" rel=\"nofollow\">https://www.youtube.com/watch?v=AiRhWG-2nGU</a>. </p>\n\n<p>However I can not even serve the index.html file.</p>\n\n<p>This is my code</p>\n\n<pre><code>func check(e error) {\n    if e != nil {\n        fmt.Println(e)\n        panic(e)\n    }\n}\n\nfunc Index(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"Index functoin\")\n    indexHTML, err := ioutil.ReadFile(\"index.html\")\n    check(err)\n    fmt.Println(indexHTML)\n    w.Write(indexHTML)\n}\n</code></pre>\n\n<p>and this is the error produced</p>\n\n<pre><code>Index functoin\nopen index.html: no such file or directory\n</code></pre>\n\n<p>My tree structure is like so</p>\n\n<pre><code>BasicWebServer/\nBasicWebServer/main.go\nBasicWebServer/index.html\nBasicWebServer/static/\nBasicWebServer/static/index.html\n</code></pre>\n\n<p>All I want is to be able to serve the index.html since it is a AngularJS app which is already running smoothly. I tried with static files like so </p>\n\n<pre><code>router := NewRouter()\ns := http.StripPrefix(\"/static/\", http.FileServer(http.Dir(\"./static/\")))\n</code></pre>\n\n<p>but it did not work so I am now trying the most basic approach I could think of. </p>\n\n<p>Please help.</p>\n\n<p>Thank you</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466613872, "post_id": 37973633, "comment_id": 63393977, "body": "What do you mean by &quot;pretty format&quot;? What do you want to accomplish? (also, this will panic on an error -- don&#39;t ignore errors)"}, {"owner": {"reputation": 73, "user_id": 2737672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b522db345a126210394fbb3105e89e04?s=128&d=identicon&r=PG", "display_name": "Biswajit Pain", "link": "https://stackoverflow.com/users/2737672/biswajit-pain"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466617198, "post_id": 37973633, "comment_id": 63395967, "body": "pretty json format"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466617676, "post_id": 37973633, "comment_id": 63396277, "body": "That is json format. Do you just want to rewrite it with newlines and indentation?"}], "owner": {"reputation": 73, "user_id": 2737672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b522db345a126210394fbb3105e89e04?s=128&d=identicon&r=PG", "display_name": "Biswajit Pain", "link": "https://stackoverflow.com/users/2737672/biswajit-pain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "closed_date": 1466749573, "answer_count": 0, "score": 0, "last_activity_date": 1466613465, "creation_date": 1466612832, "last_edit_date": 1466613465, "question_id": 37973633, "link": "https://stackoverflow.com/questions/37973633/getting-a-response-from-rest-api-like-server1ip-server2ip-how-can-i", "closed_reason": "Duplicate", "title": "Getting a response from rest API like {&#39;server1&#39;:&#39;ip&#39;,&#39;server2&#39;:&#39;ip&#39;}. How can it be converted in pretty format in go(net/http)", "body": "<p>Getting a response from rest API like {'server1':'ip','server2':'ip'}. How can it be converted in pretty format in go(net/http)</p>\n\n<pre><code>package main\n\nimport(\n    \"os\"\n    \"fmt\"\n    \"flag\"\n    \"net/http\"\n    \"io/ioutil\"\n)\n\nfunc main(){\n\n    stackPtr:=flag.String(\"stack\",\"\",\"Stack Name For Getting Instance\")\n    flag.Parse()\n    if  *stackPtr == \"\" {\n        fmt.Println(\"Argument Is not Provided\")\n        os.Exit(1)\n}\n    uri:=\"http://&lt;ip&gt;:5000/instance/\" + *stackPtr\n    val, _ := http.Get(uri)\n    defer val.Body.Close()\n    data, _ := ioutil.ReadAll(val.Body)\n    fmt.Printf(\"%s\\n\",data)\n}\n</code></pre>\n"}, {"tags": ["database", "postgresql", "go", "schema"], "comments": [{"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1466611261, "post_id": 37973092, "comment_id": 63392351, "body": "I dont know what is Goland, but creating a database for each user is the crazy thing I hear in a while. Just add a field <code>user_id</code> to each relevant table"}, {"owner": {"reputation": 97819, "user_id": 131874, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/b3600796ab1d9e78c7545c91468c2e51?s=128&d=identicon&r=PG", "display_name": "Clodoaldo Neto", "link": "https://stackoverflow.com/users/131874/clodoaldo-neto"}, "edited": false, "score": 0, "creation_date": 1466611459, "post_id": 37973092, "comment_id": 63392509, "body": "Looks like you have a serious design problem."}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1466611851, "post_id": 37973092, "comment_id": 63392754, "body": "Just in case wasnt clear, create one schema for user also bad idea. So the answer is neither."}, {"owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "edited": false, "score": 0, "creation_date": 1466613363, "post_id": 37973092, "comment_id": 63393691, "body": "<a href=\"http://scn.sap.com/community/cloud/blog/2015/07/12/multi-tenant-vs-single-tenant-architecture-saas\" rel=\"nofollow noreferrer\">scn.sap.com/community/cloud/blog/2015/07/12/&hellip;</a>"}, {"owner": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "edited": false, "score": 0, "creation_date": 1466614241, "post_id": 37973092, "comment_id": 63394191, "body": "Have to maintain each user details, that why creating separate database for customer. Database contains more than 50 tables. So i need unique database for each customer."}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 1, "creation_date": 1466617840, "post_id": 37973092, "comment_id": 63396363, "body": "Yes, that is why you add <code>user_id</code> field  to each of those 50 table instead of create 50 tables for each user"}], "answers": [{"tags": [], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1466800460, "creation_date": 1466800460, "answer_id": 38021687, "question_id": 37973092, "link": "https://stackoverflow.com/questions/37973092/postgres-golang-schema-vs-database/38021687#38021687", "title": "Postgres- Golang- Schema vs Database ?", "body": "<p>If the schema for each customer is different then you should use Event Based data storage, in which instead of creating columns for every field create rows. </p>\n\n<p>Each row in this case consists of 4 fixed columns:\n<strong>id</strong> (unique for each entry), <strong>res_id</strong>(points to its parent <strong>id</strong> field if present), <strong>key</strong> (ex-\"user_id\"), <strong>value</strong> (ex-\"1\").</p>\n"}], "owner": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 888, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466800460, "creation_date": 1466611205, "question_id": 37973092, "link": "https://stackoverflow.com/questions/37973092/postgres-golang-schema-vs-database", "title": "Postgres- Golang- Schema vs Database ?", "body": "<p>I am using golang and Postgres for my application. In my application, For new user am creating new database and tables for that user.So for Each and every new customer, am creating new database. while processing in my application, am going to make too many connection to connect particular user database..This is now currently am doing. My Question is , Whether i have to create schema for new user instead of databases in postgres, to reduce connection. In this case, Only one database is created under the database,too many schema will created. This is best way or not.  </p>\n"}, {"tags": ["go", "couchbase"], "answers": [{"tags": [], "owner": {"reputation": 3111, "user_id": 479941, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebad9df474aa1949c09ef5136e55fd33?s=128&d=identicon&r=PG", "display_name": "Mark Nunberg", "link": "https://stackoverflow.com/users/479941/mark-nunberg"}, "is_accepted": false, "score": 0, "last_activity_date": 1467921859, "creation_date": 1467921859, "answer_id": 38254335, "question_id": 37972709, "link": "https://stackoverflow.com/questions/37972709/using-golang-couchbase-community-sdk-with-mutatein/38254335#38254335", "title": "Using golang couchbase community sdk with MutateIn", "body": "<p>The <code>MutateIn</code> functionality will only work on Couchbase Server 4.5 or later. Some pre-release builds of 4.5 may also contain such functionality (aka \"subdoc\")</p>\n"}], "owner": {"reputation": 305, "user_id": 2326568, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/d99b4ef71942683e22ac49b6f56a278d?s=128&d=identicon&r=PG", "display_name": "user2326568", "link": "https://stackoverflow.com/users/2326568/user2326568"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1467921859, "creation_date": 1466610078, "question_id": 37972709, "link": "https://stackoverflow.com/questions/37972709/using-golang-couchbase-community-sdk-with-mutatein", "title": "Using golang couchbase community sdk with MutateIn", "body": "<p>When I'm using MutateIn function I always get \"No access.\" error</p>\n\n<pre><code>func (s *service) UserUpdateAvatar(avatarLink string) error {\n    key := \"profile::1\"\n    var user User\n    _, _ = s.profileBucket.Get(key, &amp;user)\n    logrus.Println(user) // printing the user as expected\n    logrus.Println(avatarLink) // printing the avatarLink as expected\n    mtinb := s.profileBucket.MutateIn(key, 0, 0).Upsert(\"avatarUrl\", avatarLink, true)\n    _, err := mtinb.Execute() // throughs \"No access.\" error\n    if err != nil {\n        logrus.Println(err)\n    }\n    return nil\n}\n</code></pre>\n\n<p>I'm using go version 1.6, couchbase community 4.0.0</p>\n"}, {"tags": ["go", "binary"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1466615757, "post_id": 37970673, "comment_id": 63395117, "body": "What is the format of the least significant 15 bits? Can they be negative, or is it unsigned?"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1466615941, "post_id": 37970673, "comment_id": 63395222, "body": "Yeah, reads to me like you probably want <code>uint16</code>. I guess you might be separating the steps for example code, but I&#39;d also just <a href=\"https://golang.org/pkg/encoding/binary/#Read\" rel=\"nofollow noreferrer\"><code>encoding.Read</code></a> right into the <code>uint16</code> instead of reading and converting separately."}], "answers": [{"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 3, "last_activity_date": 1466605268, "creation_date": 1466605268, "answer_id": 37970863, "question_id": 37970673, "link": "https://stackoverflow.com/questions/37970673/clearing-the-most-significant-bit/37970863#37970863", "title": "Clearing the most significant bit", "body": "<p>for <code>n &amp;= mask</code> to work, <code>n</code> and <code>mask</code> have to be matching types. So you should write</p>\n\n<pre><code>mask := int16(^(1 &lt;&lt; pos))\n</code></pre>\n\n<p>then, <code>value = clearBit(value, 15)</code> works fine.</p>\n\n<p>Or, since constants are untyped, you can eliminate <code>mask</code>, and also eliminate the assignment to <code>n</code> since it's just returned on the following line, and shorten <code>clearBit</code> to</p>\n\n<pre><code>func clearBit(n int16, pos uint) int16 {\n    return n &amp; ^(1 &lt;&lt; pos)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 845, "user_id": 2231168, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/oaRc5.jpg?s=128&g=1", "display_name": "Nergal", "link": "https://stackoverflow.com/users/2231168/nergal"}, "is_accepted": false, "score": 0, "last_activity_date": 1611324600, "last_edit_date": 1611324600, "creation_date": 1611308203, "answer_id": 65842616, "question_id": 37970673, "link": "https://stackoverflow.com/questions/37970673/clearing-the-most-significant-bit/65842616#65842616", "title": "Clearing the most significant bit", "body": "<p>I recently needed something similar. The difference in my case I had to do it for one <code>byte</code>/<code>uint8</code>. All of my solutions can be altered easily to work with <code>int16</code>.</p>\n<p>I found the follow 4 ways to flip the most significant bit:</p>\n<ol>\n<li>Shift, negate, and use bitwise and. (The same what you did. There is an explanation for the <code>else</code>.)</li>\n</ol>\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    &quot;math/bits&quot;\n)\n\nfunc bShift(x uint8) uint8 {\n    l := bits.Len8(x)\n    if l &gt; 0 {\n        l -= 1\n    } else {\n        return 0\n    }\n    return x &amp; ^(1 &lt;&lt; l)\n}\n</code></pre>\n<ol start=\"2\">\n<li>Simple subtraction. (Negation and bitwise operation is not needed.)</li>\n</ol>\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    &quot;math/bits&quot;\n)\n\nfunc bSub(x uint8) uint8 {\n    l := bits.Len8(x)\n    if l &gt; 0 {\n        l -= 1\n    } else {\n        return 0\n    }\n    return x - (1 &lt;&lt; l)\n}\n</code></pre>\n<ol start=\"3\">\n<li>A predefined switch case. (Can be generated.)</li>\n</ol>\n<pre class=\"lang-golang prettyprint-override\"><code>func bSwitch(x uint8) uint8 {\n    switch {\n    case x &gt;= 128:\n        return x &amp; 0b1111111\n    case x &gt;= 64:\n        return x &amp; 0b111111\n    case x &gt;= 32:\n        return x &amp; 0b11111\n    case x &gt;= 16:\n        return x &amp; 0b1111\n    case x &gt;= 8:\n        return x &amp; 0b111\n    case x &gt;= 4:\n        return x &amp; 0b11\n    case x &gt;= 2:\n        return x &amp; 0b1\n    default:\n        return 0\n    }\n}\n</code></pre>\n<ol start=\"4\">\n<li>Similarly to <code>Len8</code> in <code>math/bits</code> use a lookup table. (Can be generated.)</li>\n</ol>\n<pre class=\"lang-golang prettyprint-override\"><code>var tab = [256]uint8{\n    0x00, 0x00, 0x00, 0x01, 0x00, 0x01, 0x02, 0x03, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07,\n    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,\n    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,\n    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,\n    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,\n    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,\n    0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2a, 0x2b, 0x2c, 0x2d, 0x2e, 0x2f,\n    0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3a, 0x3b, 0x3c, 0x3d, 0x3e, 0x3f,\n    0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0a, 0x0b, 0x0c, 0x0d, 0x0e, 0x0f,\n    0x10, 0x11, 0x12, 0x13, 0x14, 0x15, 0x16, 0x17, 0x18, 0x19, 0x1a, 0x1b, 0x1c, 0x1d, 0x1e, 0x1f,\n    0x20, 0x21, 0x22, 0x23, 0x24, 0x25, 0x26, 0x27, 0x28, 0x29, 0x2a, 0x2b, 0x2c, 0x2d, 0x2e, 0x2f,\n    0x30, 0x31, 0x32, 0x33, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3a, 0x3b, 0x3c, 0x3d, 0x3e, 0x3f,\n    0x40, 0x41, 0x42, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x49, 0x4a, 0x4b, 0x4c, 0x4d, 0x4e, 0x4f,\n    0x50, 0x51, 0x52, 0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5a, 0x5b, 0x5c, 0x5d, 0x5e, 0x5f,\n    0x60, 0x61, 0x62, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6a, 0x6b, 0x6c, 0x6d, 0x6e, 0x6f,\n    0x70, 0x71, 0x72, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7a, 0x7b, 0x7c, 0x7d, 0x7e, 0x7f,\n}\n\n\nfunc bTab(x uint8) uint8 {\n    return tab[x]\n}\n</code></pre>\n<p>Go benchmark gives me the following result:</p>\n<pre><code>goos: darwin\ngoarch: amd64\nBenchmarkShift\nBenchmarkShift-8        1000000000           0.298 ns/op\nBenchmarkSub\nBenchmarkSub-8          1000000000           0.295 ns/op\nBenchmarkSwitch\nBenchmarkSwitch-8       1000000000           0.298 ns/op\nBenchmarkTab\nBenchmarkTab-8          1000000000           0.297 ns/op\nPASS\n</code></pre>\n<p>Only <code>bShift</code> without else:</p>\n<pre><code>goos: darwin\ngoarch: amd64\nBenchmarkShift\nBenchmarkShift-8        835758768            1.35 ns/op\n</code></pre>\n<p>As you can see all implementation produces almost the performance. Benchmark source code: <a href=\"https://gist.github.com/nerg4l/714dc822892e378b0d712927227efa6b\" rel=\"nofollow noreferrer\">https://gist.github.com/nerg4l/714dc822892e378b0d712927227efa6b</a></p>\n"}], "owner": {"reputation": 1784, "user_id": 5479258, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9013d6bb5ccbdd8ef0cac115267fa2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user99999", "link": "https://stackoverflow.com/users/5479258/user99999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 992, "favorite_count": 1, "answer_count": 2, "score": 0, "last_activity_date": 1611324600, "creation_date": 1466604832, "last_edit_date": 1466615646, "question_id": 37970673, "link": "https://stackoverflow.com/questions/37970673/clearing-the-most-significant-bit", "title": "Clearing the most significant bit", "body": "<p>I have a file containing two bytes, in Big Endian order, <code>hexdump</code> gives me:</p>\n\n<p><code>81 50</code></p>\n\n<p>which is <code>1000 0001 0101 0000</code> in binary. However, I want the most significant bit to be a flag, so in golang I have to load the file content, clear the most significant bit, and only then read the value.</p>\n\n<p>So:</p>\n\n<pre><code>valueBuf := make([]byte, 2)\n_, err := f.Read(valueBuf) // now printing valueBuf gives me [129 80] in decimal\nvalue := int16(binary.BigEndian.Uint16(valueBuf[0:2])) // now value is -32432\n</code></pre>\n\n<p>Ok, I have tried to use something like:</p>\n\n<pre><code>func clearBit(n int16, pos uint) int16 {\n    mask := ^(1 &lt;&lt; pos)\n    n &amp;= mask\n    return n\n}\n</code></pre>\n\n<p>But it apparently doesn't work as expected. The output value should be <code>336</code> in decimal, as normal int, and I cannot get it. How should I do this?</p>\n"}, {"tags": ["windows", "http", "go", "freeze"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466604760, "post_id": 37970501, "comment_id": 63387338, "body": "Does it work running on another platform? Does it work with the current version of Go?"}, {"owner": {"reputation": 9, "user_id": 6499530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zWTzxCBBhFU/AAAAAAAAAAI/AAAAAAAAApA/x7G4o0EE7ZI/photo.jpg?sz=128", "display_name": "albert ma", "link": "https://stackoverflow.com/users/6499530/albert-ma"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466605458, "post_id": 37970501, "comment_id": 63387962, "body": "No, I change it to the 1.6.1, it still stuck."}, {"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 2, "creation_date": 1466619559, "post_id": 37970501, "comment_id": 63397334, "body": "Are you closing your connections when you&#39;re done with them? Sounds like the OS might be running out of network handles. Some code would help diagnose the issue."}, {"owner": {"reputation": 9, "user_id": 6499530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zWTzxCBBhFU/AAAAAAAAAAI/AAAAAAAAApA/x7G4o0EE7ZI/photo.jpg?sz=128", "display_name": "albert ma", "link": "https://stackoverflow.com/users/6499530/albert-ma"}, "edited": false, "score": 0, "creation_date": 1466675503, "post_id": 37970501, "comment_id": 63420294, "body": "How do I know if  I ran out the handler or connection, is there any way to find out what is going on?"}, {"owner": {"reputation": 9, "user_id": 6499530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zWTzxCBBhFU/AAAAAAAAAAI/AAAAAAAAApA/x7G4o0EE7ZI/photo.jpg?sz=128", "display_name": "albert ma", "link": "https://stackoverflow.com/users/6499530/albert-ma"}, "edited": false, "score": 0, "creation_date": 1466676305, "post_id": 37970501, "comment_id": 63420837, "body": "Find a way to reproduce the bug. Use a tool to send 1000 request Go web server, and"}, {"owner": {"reputation": 9, "user_id": 6499530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zWTzxCBBhFU/AAAAAAAAAAI/AAAAAAAAApA/x7G4o0EE7ZI/photo.jpg?sz=128", "display_name": "albert ma", "link": "https://stackoverflow.com/users/6499530/albert-ma"}, "edited": false, "score": 0, "creation_date": 1466685551, "post_id": 37970501, "comment_id": 63427396, "body": "the way reproducing http server hang issue is still not very clear. I doubt it maybe go http library bug."}, {"owner": {"reputation": 9, "user_id": 6499530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zWTzxCBBhFU/AAAAAAAAAAI/AAAAAAAAApA/x7G4o0EE7ZI/photo.jpg?sz=128", "display_name": "albert ma", "link": "https://stackoverflow.com/users/6499530/albert-ma"}, "edited": false, "score": 0, "creation_date": 1467071385, "post_id": 37970501, "comment_id": 63568666, "body": "Now i used a nginx in front of the goweb server to handle the connection, it seems ok,but still need to test."}], "owner": {"reputation": 9, "user_id": 6499530, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-zWTzxCBBhFU/AAAAAAAAAAI/AAAAAAAAApA/x7G4o0EE7ZI/photo.jpg?sz=128", "display_name": "albert ma", "link": "https://stackoverflow.com/users/6499530/albert-ma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 197, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466604439, "creation_date": 1466604439, "last_edit_date": 1592644375, "question_id": 37970501, "link": "https://stackoverflow.com/questions/37970501/golang-webserver-on-windows-xp-can-not-handle-http-request-any-more-after-runnin", "title": "Golang WebServer on windows xp can not handle http request any more after running for a while", "body": "<p>I recently used go language to develop a web server on windows xp.\n<strong>After running for a while, the go web can not handle any request from client</strong>.\nI checked the go routine scheduler, it works because I have a timer task and it runs well.And no log tells me there is deadlock. I am confused, why go web can not receive any request.</p>\n<h3>The stuck goroutine trace as follow</h3>\n<pre><code>&lt;code&gt;\ngoroutine 1495590 [running]:\nruntime/pprof.writeGoroutineStacks(0x324e0100, 0x11ad6060, 0x0, 0x0)\n    c:/go/src/runtime/pprof/pprof.go:516 +0x84\nruntime/pprof.writeGoroutine(0x324e0100, 0x11ad6060, 0x2, 0x0, 0x0)\n    c:/go/src/runtime/pprof/pprof.go:505 +0x3c\nruntime/pprof.(*Profile).WriteTo(0xc71770, 0x324e0100, 0x11ad6060, 0x2, 0x0, 0x0)\n    c:/go/src/runtime/pprof/pprof.go:236 +0xb4\ngithub.com/astaxie/beego/toolbox.ProcessInput(0x11b3a110, 0x10, 0x324e0100, 0x11ad6060)\n    D:/goproject/src/github.com/astaxie/beego/toolbox/profile.go:42 +0x2fd\ngithub.com/astaxie/beego.profIndex(0x324e0068, 0x11838080, 0x117de000)\n    D:/goproject/src/github.com/astaxie/beego/admin.go:275 +0x147\nnet/http.HandlerFunc.ServeHTTP(0xa3e7f4, 0x324e0068, 0x11838080, 0x117de000)\n    c:/go/src/net/http/server.go:1422 +0x34\nnet/http.(*ServeMux).ServeHTTP(0x11683cc0, 0x324e0068, 0x11838080, 0x117de000)\n    c:/go/src/net/http/server.go:1699 +0x133\nnet/http.serverHandler.ServeHTTP(0x1189c080, 0x324e0068, 0x11838080, 0x117de000)\n    c:/go/src/net/http/server.go:1862 +0x156\nnet/http.(*conn).serve(0x11ad6000)\n    c:/go/src/net/http/server.go:1361 +0xc05\ncreated by net/http.(*Server).Serve\n    c:/go/src/net/http/server.go:1910 +0x343\n\ngoroutine 1 [chan receive, 127 minutes]:\ngithub.com/astaxie/beego.(*App).Run(0x1169e550)\n    D:/goproject/src/github.com/astaxie/beego/app.go:182 +0x85a\ngithub.com/astaxie/beego.Run(0x0, 0x0, 0x0)\n    D:/goproject/src/github.com/astaxie/beego/beego.go:66 +0x130\nmain.main()\n    D:/goproject/src/github.com/rayingtech/restaurant/main.go:53 +0x27\n\ngoroutine 17 [syscall, 127 minutes, locked to thread]:\nruntime.goexit()\n    c:/go/src/runtime/asm_386.s:1662 +0x1\n\ngoroutine 5 [syscall, 127 minutes]:\nos/signal.loop()\n    c:/go/src/os/signal/signal_unix.go:22 +0x1a\ncreated by os/signal.init.1\n    c:/go/src/os/signal/signal_unix.go:28 +0x36\n\ngoroutine 6 [chan receive, 127 minutes]:\ndatabase/sql.(*DB).connectionOpener(0x116deb40)\n    c:/go/src/database/sql/sql.go:634 +0x3c\ncreated by database/sql.Open\n    c:/go/src/database/sql/sql.go:481 +0x276\n\ngoroutine 7 [IO wait]:\nnet.runtime_pollWait(0x31995d40, 0x72, 0x11b3a070)\n    c:/go/src/runtime/netpoll.go:157 +0x55\nnet.(*pollDesc).Wait(0x118aa0d0, 0x72, 0x0, 0x0)\n    c:/go/src/net/fd_poll_runtime.go:73 +0x35\nnet.(*ioSrv).ExecIO(0x11862998, 0x118aa038, 0x962b48, 0x8, 0x11b3a060, 0x11b822a0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:182 +0x122\nnet.(*netFD).acceptOne(0x118aa000, 0x11b82000, 0x2, 0x2, 0x118aa038, 0x31690000, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:564 +0x1d4\nnet.(*netFD).accept(0x118aa000, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:594 +0x11f\nnet.(*TCPListener).AcceptTCP(0x11890018, 0x118c2e3c, 0x0, 0x0)\n    c:/go/src/net/tcpsock_posix.go:254 +0x47\nnet/http.tcpKeepAliveListener.Accept(0x11890018, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:2135 +0x3d\nnet/http.(*Server).Serve(0x1189c080, 0x31995e30, 0x11890018, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1887 +0x98\nnet/http.(*Server).ListenAndServe(0x1189c080, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1877 +0xe4\nnet/http.ListenAndServe(0x11892020, 0x5, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1967 +0x7a\ngithub.com/astaxie/beego.(*adminApp).Run(0x1169e548)\n    D:/goproject/src/github.com/astaxie/beego/admin.go:419 +0x581\ncreated by github.com/astaxie/beego.registerAdmin\n    D:/goproject/src/github.com/astaxie/beego/hooks.go:90 +0x4d\n\ngoroutine 8 [IO wait, 3 minutes]:\nnet.runtime_pollWait(0x31995db8, 0x72, 0x1184d840)\n    c:/go/src/runtime/netpoll.go:157 +0x55\nnet.(*pollDesc).Wait(0x11833870, 0x72, 0x0, 0x0)\n    c:/go/src/net/fd_poll_runtime.go:73 +0x35\nnet.(*ioSrv).ExecIO(0x11862998, 0x118337d8, 0x962b48, 0x8, 0x1184d830, 0x119e8540, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:182 +0x122\nnet.(*netFD).acceptOne(0x118337a0, 0x119e8460, 0x2, 0x2, 0x118337d8, 0x316904a8, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:564 +0x1d4\nnet.(*netFD).accept(0x118337a0, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:594 +0x11f\nnet.(*TCPListener).AcceptTCP(0x118629a8, 0x118c5ea8, 0x0, 0x0)\n    c:/go/src/net/tcpsock_posix.go:254 +0x47\nnet/http.tcpKeepAliveListener.Accept(0x118629a8, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:2135 +0x3d\nnet/http.(*Server).Serve(0x11688f80, 0x31995e30, 0x118629a8, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1887 +0x98\nnet/http.(*Server).ListenAndServe(0x11688f80, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1877 +0xe4\ngithub.com/astaxie/beego.(*App).Run.func4(0x1169e550, 0x11854c00, 0x5, 0x118841c0)\n    D:/goproject/src/github.com/astaxie/beego/app.go:174 +0x35c\ncreated by github.com/astaxie/beego.(*App).Run\n    D:/goproject/src/github.com/astaxie/beego/app.go:180 +0x83e\n\ngoroutine 9 [chan receive, locked to thread]:\nnet.(*ioSrv).ProcessRemoteIO(0x11862998)\n    c:/go/src/net/fd_windows.go:138 +0xcc\ncreated by net.startServer\n    c:/go/src/net/fd_windows.go:238 +0xc9\n\ngoroutine 10 [chan receive, 3 minutes, locked to thread]:\nnet.(*ioSrv).ProcessRemoteIO(0x118629a0)\n    c:/go/src/net/fd_windows.go:138 +0xcc\ncreated by net.startServer\n    c:/go/src/net/fd_windows.go:240 +0x11e\n\ngoroutine 353800 [IO wait, 114 minutes]:\nnet.runtime_pollWait(0x31995ae8, 0x72, 0x11b480e0)\n    c:/go/src/runtime/netpoll.go:157 +0x55\nnet.(*pollDesc).Wait(0x1190b170, 0x72, 0x0, 0x0)\n    c:/go/src/net/fd_poll_runtime.go:73 +0x35\nnet.(*ioSrv).ExecIO(0x11862998, 0x1190b0d8, 0x93ce80, 0x7, 0xa3ea10, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:182 +0x122\nnet.(*netFD).Read(0x1190b0a0, 0x1196e000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:463 +0x129\nnet.(*conn).Read(0x117c3648, 0x1196e000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/net.go:172 +0xb9\nnet/http.(*liveSwitchReader).Read(0x11ad6684, 0x1196e000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:219 +0x84\nio.(*LimitedReader).Read(0x11b480b0, 0x1196e000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/io/io.go:427 +0xcb\nbufio.(*Reader).fill(0x11685b90)\n    c:/go/src/bufio/bufio.go:97 +0x172\nbufio.(*Reader).ReadSlice(0x11685b90, 0x1163380a, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/bufio/bufio.go:328 +0x1b4\nbufio.(*Reader).ReadLine(0x11685b90, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/bufio/bufio.go:357 +0x4b\nnet/textproto.(*Reader).readLineSlice(0x11951a40, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/textproto/reader.go:55 +0x59\nnet/textproto.(*Reader).ReadLine(0x11951a40, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/textproto/reader.go:36 +0x39\nnet/http.ReadRequest(0x11685b90, 0x11b47340, 0x0, 0x0)\n    c:/go/src/net/http/request.go:653 +0x9a\nnet/http.(*conn).readRequest(0x11ad6660, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:633 +0x368\nnet/http.(*conn).serve(0x11ad6660)\n    c:/go/src/net/http/server.go:1319 +0x7a9\ncreated by net/http.(*Server).Serve\n    c:/go/src/net/http/server.go:1910 +0x343\n\ngoroutine 1421744 [IO wait, 7 minutes]:\nnet.runtime_pollWait(0x31995b60, 0x72, 0x11841650)\n    c:/go/src/runtime/netpoll.go:157 +0x55\nnet.(*pollDesc).Wait(0x119f0fb0, 0x72, 0x0, 0x0)\n    c:/go/src/net/fd_poll_runtime.go:73 +0x35\nnet.(*ioSrv).ExecIO(0x11862998, 0x119f0f18, 0x93ce80, 0x7, 0xa3ea10, 0x4c201b, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:182 +0x122\nnet.(*netFD).Read(0x119f0ee0, 0x11aac000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:463 +0x129\nnet.(*conn).Read(0x11863570, 0x11aac000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/net.go:172 +0xb9\nnet/http.(*liveSwitchReader).Read(0x1193d764, 0x11aac000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:219 +0x84\nio.(*LimitedReader).Read(0x11893310, 0x11aac000, 0x1000, 0x1000, 0x27, 0x0, 0x0)\n    c:/go/src/io/io.go:427 +0xcb\nbufio.(*Reader).fill(0x11b0a060)\n    c:/go/src/bufio/bufio.go:97 +0x172\nbufio.(*Reader).Peek(0x11b0a060, 0x4, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/bufio/bufio.go:132 +0xad\nnet/http.(*conn).readRequest(0x1193d740, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:629 +0x30e\nnet/http.(*conn).serve(0x1193d740)\n    c:/go/src/net/http/server.go:1319 +0x7a9\ncreated by net/http.(*Server).Serve\n    c:/go/src/net/http/server.go:1910 +0x343\n\ngoroutine 1495604 [IO wait, 3 minutes]:\nnet.runtime_pollWait(0x31995908, 0x72, 0x11855690)\n    c:/go/src/runtime/netpoll.go:157 +0x55\nnet.(*pollDesc).Wait(0x119fda30, 0x72, 0x0, 0x0)\n    c:/go/src/net/fd_poll_runtime.go:73 +0x35\nnet.(*ioSrv).ExecIO(0x11862998, 0x119fd998, 0x93ce80, 0x7, 0xa3ea10, 0x4027a5, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:182 +0x122\nnet.(*netFD).Read(0x119fd960, 0x11968000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:463 +0x129\nnet.(*conn).Read(0x117c2fd0, 0x11968000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/net.go:172 +0xb9\nnet/http.(*liveSwitchReader).Read(0x117077c4, 0x11968000, 0x1000, 0x1000, 0x449a00, 0x0, 0x0)\n    c:/go/src/net/http/server.go:219 +0x84\nio.(*LimitedReader).Read(0x1184d220, 0x11968000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/io/io.go:427 +0xcb\nbufio.(*Reader).fill(0x11b6a120)\n    c:/go/src/bufio/bufio.go:97 +0x172\nbufio.(*Reader).Read(0x11b6a120, 0x11b68400, 0x21, 0x200, 0x1000, 0x0, 0x0)\n    c:/go/src/bufio/bufio.go:207 +0x1b9\nio.(*LimitedReader).Read(0x11840ee0, 0x11b68400, 0x21, 0x200, 0x11b17994, 0x0, 0x0)\n    c:/go/src/io/io.go:427 +0xcb\nnet/http.(*body).readLocked(0x11a212f0, 0x11b68400, 0x200, 0x200, 0x1000, 0x0, 0x0)\n    c:/go/src/net/http/transfer.go:632 +0x7f\nnet/http.(*body).Read(0x11a212f0, 0x11b68400, 0x200, 0x200, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/transfer.go:624 +0xe8\nnet/http.(*expectContinueReader).Read(0x11840ef0, 0x11b68400, 0x200, 0x200, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:569 +0x100\nio.(*LimitedReader).Read(0x1184d510, 0x11b68400, 0x200, 0x200, 0x200, 0x0, 0x0)\n    c:/go/src/io/io.go:427 +0xcb\nbytes.(*Buffer).ReadFrom(0x11b17ab4, 0x32520080, 0x1184d510, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/bytes/buffer.go:173 +0x1c3\nio/ioutil.readAll(0x32520080, 0x1184d510, 0x200, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/io/ioutil/ioutil.go:33 +0x136\nio/ioutil.ReadAll(0x32520080, 0x1184d510, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/io/ioutil/ioutil.go:42 +0x51\ngithub.com/astaxie/beego/context.(*BeegoInput).CopyBody(0x11b38340, 0x4000000, 0x0, 0x0, 0x0, 0x0)\n    D:/goproject/src/github.com/astaxie/beego/context/input.go:337 +0xd4\ngithub.com/astaxie/beego.(*ControllerRegister).ServeHTTP(0x116edd60, 0x324e0068, 0x11ab1980, 0x11ae7b20)\n    D:/goproject/src/github.com/astaxie/beego/router.go:652 +0x2cc0\nnet/http.serverHandler.ServeHTTP(0x11688f80, 0x324e0068, 0x11ab1980, 0x11ae7b20)\n    c:/go/src/net/http/server.go:1862 +0x156\nnet/http.(*conn).serve(0x117077a0)\n    c:/go/src/net/http/server.go:1361 +0xc05\ncreated by net/http.(*Server).Serve\n    c:/go/src/net/http/server.go:1910 +0x343\n</code></pre>\n<p>==============================================================</p>\n<h3>The normal goroutine trace as follows:</h3>\n<pre><code>goroutine 1359760 [running]:\nruntime/pprof.writeGoroutineStacks(0x324e0100, 0x117a3f80, 0x0, 0x0)\n    c:/go/src/runtime/pprof/pprof.go:516 +0x84\nruntime/pprof.writeGoroutine(0x324e0100, 0x117a3f80, 0x2, 0x0, 0x0)\n    c:/go/src/runtime/pprof/pprof.go:505 +0x3c\nruntime/pprof.(*Profile).WriteTo(0xc71770, 0x324e0100, 0x117a3f80, 0x2, 0x0, 0x0)\n    c:/go/src/runtime/pprof/pprof.go:236 +0xb4\ngithub.com/astaxie/beego/toolbox.ProcessInput(0x1194bc80, 0x10, 0x324e0100, 0x117a3f80)\n    D:/goproject/src/github.com/astaxie/beego/toolbox/profile.go:42 +0x2fd\ngithub.com/astaxie/beego.profIndex(0x324e0068, 0x117e4080, 0x11a19340)\n    D:/goproject/src/github.com/astaxie/beego/admin.go:275 +0x147\nnet/http.HandlerFunc.ServeHTTP(0xa3e7f4, 0x324e0068, 0x117e4080, 0x11a19340)\n    c:/go/src/net/http/server.go:1422 +0x34\nnet/http.(*ServeMux).ServeHTTP(0x11683cc0, 0x324e0068, 0x117e4080, 0x11a19340)\n    c:/go/src/net/http/server.go:1699 +0x133\nnet/http.serverHandler.ServeHTTP(0x1189c080, 0x324e0068, 0x117e4080, 0x11a19340)\n    c:/go/src/net/http/server.go:1862 +0x156\nnet/http.(*conn).serve(0x1197eea0)\n    c:/go/src/net/http/server.go:1361 +0xc05\ncreated by net/http.(*Server).Serve\n    c:/go/src/net/http/server.go:1910 +0x343\n\ngoroutine 1 [chan receive, 98 minutes]:\ngithub.com/astaxie/beego.(*App).Run(0x1169e550)\n    D:/goproject/src/github.com/astaxie/beego/app.go:182 +0x85a\ngithub.com/astaxie/beego.Run(0x0, 0x0, 0x0)\n    D:/goproject/src/github.com/astaxie/beego/beego.go:66 +0x130\nmain.main()\n    D:/goproject/src/github.com/rayingtech/restaurant/main.go:53 +0x27\n\ngoroutine 17 [syscall, 98 minutes, locked to thread]:\nruntime.goexit()\n    c:/go/src/runtime/asm_386.s:1662 +0x1\n\ngoroutine 5 [syscall, 98 minutes]:\nos/signal.loop()\n    c:/go/src/os/signal/signal_unix.go:22 +0x1a\ncreated by os/signal.init.1\n    c:/go/src/os/signal/signal_unix.go:28 +0x36\n\ngoroutine 6 [chan receive, 98 minutes]:\ndatabase/sql.(*DB).connectionOpener(0x116deb40)\n    c:/go/src/database/sql/sql.go:634 +0x3c\ncreated by database/sql.Open\n    c:/go/src/database/sql/sql.go:481 +0x276\n\ngoroutine 7 [IO wait]:\nnet.runtime_pollWait(0x31995d40, 0x72, 0x11b3b510)\n    c:/go/src/runtime/netpoll.go:157 +0x55\nnet.(*pollDesc).Wait(0x118aa0d0, 0x72, 0x0, 0x0)\n    c:/go/src/net/fd_poll_runtime.go:73 +0x35\nnet.(*ioSrv).ExecIO(0x11862998, 0x118aa038, 0x962b48, 0x8, 0x11b3b500, 0x11abee00, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:182 +0x122\nnet.(*netFD).acceptOne(0x118aa000, 0x11abed20, 0x2, 0x2, 0x118aa038, 0x31690254, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:564 +0x1d4\nnet.(*netFD).accept(0x118aa000, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:594 +0x11f\nnet.(*TCPListener).AcceptTCP(0x11890018, 0x118c2e3c, 0x0, 0x0)\n    c:/go/src/net/tcpsock_posix.go:254 +0x47\nnet/http.tcpKeepAliveListener.Accept(0x11890018, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:2135 +0x3d\nnet/http.(*Server).Serve(0x1189c080, 0x31995e30, 0x11890018, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1887 +0x98\nnet/http.(*Server).ListenAndServe(0x1189c080, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1877 +0xe4\nnet/http.ListenAndServe(0x11892020, 0x5, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1967 +0x7a\ngithub.com/astaxie/beego.(*adminApp).Run(0x1169e548)\n    D:/goproject/src/github.com/astaxie/beego/admin.go:419 +0x581\ncreated by github.com/astaxie/beego.registerAdmin\n    D:/goproject/src/github.com/astaxie/beego/hooks.go:90 +0x4d\n\ngoroutine 8 [IO wait]:\nnet.runtime_pollWait(0x31995db8, 0x72, 0x118e7640)\n    c:/go/src/runtime/netpoll.go:157 +0x55\nnet.(*pollDesc).Wait(0x11833870, 0x72, 0x0, 0x0)\n    c:/go/src/net/fd_poll_runtime.go:73 +0x35\nnet.(*ioSrv).ExecIO(0x11862998, 0x118337d8, 0x962b48, 0x8, 0x118e7630, 0x118afce0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:182 +0x122\nnet.(*netFD).acceptOne(0x118337a0, 0x118afc00, 0x2, 0x2, 0x118337d8, 0x31690000, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:564 +0x1d4\nnet.(*netFD).accept(0x118337a0, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:594 +0x11f\nnet.(*TCPListener).AcceptTCP(0x118629a8, 0x11960ea8, 0x0, 0x0)\n    c:/go/src/net/tcpsock_posix.go:254 +0x47\nnet/http.tcpKeepAliveListener.Accept(0x118629a8, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:2135 +0x3d\nnet/http.(*Server).Serve(0x11688f80, 0x31995e30, 0x118629a8, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1887 +0x98\nnet/http.(*Server).ListenAndServe(0x11688f80, 0x0, 0x0)\n    c:/go/src/net/http/server.go:1877 +0xe4\ngithub.com/astaxie/beego.(*App).Run.func4(0x1169e550, 0x11854c00, 0x5, 0x118841c0)\n    D:/goproject/src/github.com/astaxie/beego/app.go:174 +0x35c\ncreated by github.com/astaxie/beego.(*App).Run\n    D:/goproject/src/github.com/astaxie/beego/app.go:180 +0x83e\n\ngoroutine 9 [chan receive, locked to thread]:\nnet.(*ioSrv).ProcessRemoteIO(0x11862998)\n    c:/go/src/net/fd_windows.go:138 +0xcc\ncreated by net.startServer\n    c:/go/src/net/fd_windows.go:238 +0xc9\n\ngoroutine 10 [chan receive, locked to thread]:\nnet.(*ioSrv).ProcessRemoteIO(0x118629a0)\n    c:/go/src/net/fd_windows.go:138 +0xcc\ncreated by net.startServer\n    c:/go/src/net/fd_windows.go:240 +0x11e\n\ngoroutine 353800 [IO wait, 85 minutes]:\nnet.runtime_pollWait(0x31995ae8, 0x72, 0x11b480e0)\n    c:/go/src/runtime/netpoll.go:157 +0x55\nnet.(*pollDesc).Wait(0x1190b170, 0x72, 0x0, 0x0)\n    c:/go/src/net/fd_poll_runtime.go:73 +0x35\nnet.(*ioSrv).ExecIO(0x11862998, 0x1190b0d8, 0x93ce80, 0x7, 0xa3ea10, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:182 +0x122\nnet.(*netFD).Read(0x1190b0a0, 0x1196e000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/fd_windows.go:463 +0x129\nnet.(*conn).Read(0x117c3648, 0x1196e000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/net.go:172 +0xb9\nnet/http.(*liveSwitchReader).Read(0x11ad6684, 0x1196e000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:219 +0x84\nio.(*LimitedReader).Read(0x11b480b0, 0x1196e000, 0x1000, 0x1000, 0x0, 0x0, 0x0)\n    c:/go/src/io/io.go:427 +0xcb\nbufio.(*Reader).fill(0x11685b90)\n    c:/go/src/bufio/bufio.go:97 +0x172\nbufio.(*Reader).ReadSlice(0x11685b90, 0x1163380a, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/bufio/bufio.go:328 +0x1b4\nbufio.(*Reader).ReadLine(0x11685b90, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/bufio/bufio.go:357 +0x4b\nnet/textproto.(*Reader).readLineSlice(0x11951a40, 0x0, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/textproto/reader.go:55 +0x59\nnet/textproto.(*Reader).ReadLine(0x11951a40, 0x0, 0x0, 0x0, 0x0)\n    c:/go/src/net/textproto/reader.go:36 +0x39\nnet/http.ReadRequest(0x11685b90, 0x11b47340, 0x0, 0x0)\n    c:/go/src/net/http/request.go:653 +0x9a\nnet/http.(*conn).readRequest(0x11ad6660, 0x0, 0x0, 0x0)\n    c:/go/src/net/http/server.go:633 +0x368\nnet/http.(*conn).serve(0x11ad6660)\n    c:/go/src/net/http/server.go:1319 +0x7a9\ncreated by net/http.(*Server).Serve\n    c:/go/src/net/http/server.go:1910 +0x343\n</code></pre>\n\n<ul>\n<li>Go sdk:1.5</li>\n<li>compile platform : windows 8</li>\n<li>target platform: windows xp</li>\n<li>third party framework: beego</li>\n</ul>\n"}, {"tags": ["git", "go", "ssh"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1466598521, "post_id": 37967606, "comment_id": 63381758, "body": "You want to remove the <code>.git</code> as well"}, {"owner": {"reputation": 845, "user_id": 3338098, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1cdbe21867078e904afd9ba61ae177ac?s=128&d=identicon&r=PG&f=1", "display_name": "user3338098", "link": "https://stackoverflow.com/users/3338098/user3338098"}, "edited": false, "score": 0, "creation_date": 1533153146, "post_id": 37967606, "comment_id": 90247025, "body": "WARNING: if using this command before go version 1.5 <a href=\"https://github.com/golang/go/issues/9637\" rel=\"nofollow noreferrer\">your system was compromised</a>"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": true, "score": 14, "last_activity_date": 1466614241, "last_edit_date": 1466614241, "creation_date": 1466597344, "answer_id": 37967606, "question_id": 37967450, "link": "https://stackoverflow.com/questions/37967450/not-able-to-download-and-install-go-project/37967606#37967606", "title": "Not able to download and install go project", "body": "<p>Install the package without to include the protocol (http/https).</p>\n\n<pre><code>go get github.com/goadesign/goa-cellar\n</code></pre>\n\n<p>Please be aware that you need to set the <code>GOPATH</code> environment variable. If you are not sure how to do that here is an article: <a href=\"https://golang.org/doc/code.html#GOPATH\" rel=\"noreferrer\">https://golang.org/doc/code.html#GOPATH</a>.</p>\n"}], "owner": {"reputation": 3959, "user_id": 1381266, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/7ac54c032c1dd24a5e6c737d06b83a03?s=128&d=identicon&r=PG", "display_name": "Galet", "link": "https://stackoverflow.com/users/1381266/galet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3342, "favorite_count": 1, "accepted_answer_id": 37967606, "answer_count": 1, "score": 4, "last_activity_date": 1466614241, "creation_date": 1466596903, "question_id": 37967450, "link": "https://stackoverflow.com/questions/37967450/not-able-to-download-and-install-go-project", "title": "Not able to download and install go project", "body": "<p>I am a beginner to go languague and trying to download and install goa-cellar project. But I am not able to install using ssh or https github link</p>\n\n<p>1.<strong>go get git@github.com:goadesign/goa-cellar.git</strong></p>\n\n<pre><code>package git@github.com:goadesign/goa-cellar.git: unrecognized import    path \"git@github.com:goadesign/goa-cellar.git\" (https fetch: Get    https://git@github.com:goadesign/goa-cellar.git?go-get=1: dial tcp:    unknown port tcp/goadesign)\n</code></pre>\n\n<p>2.<strong>go get <a href=\"https://github.com/goadesign/goa-cellar.git\" rel=\"nofollow\">https://github.com/goadesign/goa-cellar.git</a></strong></p>\n\n<pre><code>package https:/github.com/goadesign/goa-cellar.git: \"https://\" not allowed in import path\n</code></pre>\n\n<p>Kindly help me how to solve this ?</p>\n"}, {"tags": ["go", "rabbitmq", "distributed-computing", "task-queue", "messagebroker"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "edited": false, "score": 0, "creation_date": 1466591274, "post_id": 37964888, "comment_id": 63376846, "body": "but if some worker will fall it will cause loosing tasks"}, {"owner": {"reputation": 8053, "user_id": 4094678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f9cbde609375e8b2ee26a0b6602c81b?s=128&d=identicon&r=PG", "display_name": "cantSleepNow", "link": "https://stackoverflow.com/users/4094678/cantsleepnow"}, "reply_to_user": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "edited": false, "score": 0, "creation_date": 1466592470, "post_id": 37964888, "comment_id": 63377628, "body": "@NikitaLapkov it won&#39;t if you don&#39;t ACK until the job is actually done."}, {"owner": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "edited": false, "score": 0, "creation_date": 1466592596, "post_id": 37964888, "comment_id": 63377719, "body": "I mean if server &quot;mike&quot; will fall and I send task tagged as for server &quot;mike&quot; nobody will take it"}, {"owner": {"reputation": 8053, "user_id": 4094678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f9cbde609375e8b2ee26a0b6602c81b?s=128&d=identicon&r=PG", "display_name": "cantSleepNow", "link": "https://stackoverflow.com/users/4094678/cantsleepnow"}, "reply_to_user": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "edited": false, "score": 0, "creation_date": 1466597159, "post_id": 37964888, "comment_id": 63380786, "body": "Yes, you&#39;d have to have multiple instances. RabbitMQ would keep the message until someone takes is (if you configure it that way)."}, {"owner": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "edited": false, "score": 0, "creation_date": 1466597483, "post_id": 37964888, "comment_id": 63381007, "body": "and message will travel through all workers maybe even visiting some of them multiple times. I have thought about this scheme but isn&#39;t it too long in time?"}, {"owner": {"reputation": 8053, "user_id": 4094678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f9cbde609375e8b2ee26a0b6602c81b?s=128&d=identicon&r=PG", "display_name": "cantSleepNow", "link": "https://stackoverflow.com/users/4094678/cantsleepnow"}, "reply_to_user": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "edited": false, "score": 0, "creation_date": 1466597550, "post_id": 37964888, "comment_id": 63381064, "body": "I dont&#39; understan what you mean with <code>message will travel through all workers maybe even visiting some of them multiple times.</code> Please update you question.."}, {"owner": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "edited": false, "score": 0, "creation_date": 1466597670, "post_id": 37964888, "comment_id": 63381165, "body": "I mean if I worker have rejected task, RabbitMQ will resend it to another random worker. This one can reject it too and this can be a loop"}, {"owner": {"reputation": 8053, "user_id": 4094678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f9cbde609375e8b2ee26a0b6602c81b?s=128&d=identicon&r=PG", "display_name": "cantSleepNow", "link": "https://stackoverflow.com/users/4094678/cantsleepnow"}, "reply_to_user": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "edited": false, "score": 0, "creation_date": 1466597740, "post_id": 37964888, "comment_id": 63381202, "body": "Yes, that&#39;s how it works. Please read up a bit on RMQ docs. There is also message TTL."}], "tags": [], "owner": {"reputation": 8053, "user_id": 4094678, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f9cbde609375e8b2ee26a0b6602c81b?s=128&d=identicon&r=PG", "display_name": "cantSleepNow", "link": "https://stackoverflow.com/users/4094678/cantsleepnow"}, "is_accepted": false, "score": 0, "last_activity_date": 1466590105, "creation_date": 1466590105, "answer_id": 37964888, "question_id": 37963248, "link": "https://stackoverflow.com/questions/37963248/distributed-computing-on-non-equal-servers/37964888#37964888", "title": "Distributed computing on non-equal servers", "body": "<p>RabbitMQ doesn't explicitly know such things about it's clients. It knows how many clients are there, how many subscribers to the queue etc. </p>\n\n<p>You could however set up the exchanges in the way that would distribute the tasks as desired. However, you would have to know before the publishing of the task to which (type of) subscriber should it go to.</p>\n"}], "owner": {"reputation": 21, "user_id": 4878284, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-8k1qovUzufc/AAAAAAAAAAI/AAAAAAAAAB8/R4gPqbNHVN0/photo.jpg?sz=128", "display_name": "Nikita Lapkov", "link": "https://stackoverflow.com/users/4878284/nikita-lapkov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466590105, "creation_date": 1466586024, "question_id": 37963248, "link": "https://stackoverflow.com/questions/37963248/distributed-computing-on-non-equal-servers", "title": "Distributed computing on non-equal servers", "body": "<p>I have set of tasks and each of them requires some certain condition to be satisfied. For example task needs 100 Mb of RAM to be executed. Also I have multiple servers where workers are placed. Each worker has some configuration that describes how many resources it has. For example some worker is available to use 1 Gb of RAM for execution of task.<br>\nIs there any system for distribution tasks between workers so that each worker satisfies requirements of task passed to it? Or maybe I can somehow do it with message broker (RabbitMQ for example)?<br>\nI am aware writing my own application for this because I don't want to reinvent the wheel.<br>\nWorkers are written in Go.</p>\n"}, {"tags": ["go", "ticker"], "comments": [{"owner": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "edited": false, "score": 0, "creation_date": 1466584953, "post_id": 37962666, "comment_id": 63372463, "body": "Where are you running this? It seems to work fine for me: <a href=\"https://play.golang.org/p/3uVTJq9AfN\" rel=\"nofollow noreferrer\">play.golang.org/p/3uVTJq9AfN</a>"}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 1351, "user_id": 879047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ee933b5bf986de605ee48c1ae3e3f7ee?s=128&d=identicon&r=PG", "display_name": "Duru Can Celasun", "link": "https://stackoverflow.com/users/879047/duru-can-celasun"}, "edited": false, "score": 0, "creation_date": 1466587239, "post_id": 37962666, "comment_id": 63374058, "body": "@DuruCanCelasun You&#39;re only waiting for 1 second, which is less than the ticker duration. Wait &gt; tick duration is the problem here."}], "answers": [{"tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": true, "score": 9, "last_activity_date": 1518606044, "last_edit_date": 1518606044, "creation_date": 1466586326, "answer_id": 37963349, "question_id": 37962666, "link": "https://stackoverflow.com/questions/37962666/how-does-golang-ticker-work/37963349#37963349", "title": "How does golang ticker work?", "body": "<p>This is the Ticker source (pardon the line numbers, I copied this off the documentation source page):</p>\n\n<pre><code>    func NewTicker(d Duration) *Ticker {\n            if d &lt;= 0 {\n                panic(errors.New(\"non-positive interval for NewTicker\"))\n            }\n            // Give the channel a 1-element time buffer.\n            // If the client falls behind while reading, we drop ticks\n            // on the floor until the client catches up.\n            c := make(chan Time, 1)\n            t := &amp;Ticker{\n                C: c,\n                r: runtimeTimer{\n                    when:   when(d),\n                    period: int64(d),\n                    f:      sendTime,\n                    arg:    c,\n                },\n            }\n            startTimer(&amp;t.r)\n            return t\n        }\n</code></pre>\n\n<p>Note the comment</p>\n\n<pre><code>// Give the channel a 1-element time buffer.\n// If the client falls behind while reading, we drop ticks\n// on the floor until the client catches up.\n</code></pre>\n\n<p>What's happening:</p>\n\n<ol>\n<li>You create the timer</li>\n<li>The timer produces its first tick and buffers it.</li>\n<li>Now it waits, wakes up, and blocks, waiting for you to consume so it can produce tick 2.</li>\n<li>Eventually, your goroutine wakes up and immediately consumes the first two ticks it produced, and it starts producing ticks again.</li>\n</ol>\n\n<p>Edit: In addition, the documention for <code>NewTicker</code> (which <code>Tick</code> is a convenience function for) says:</p>\n\n<blockquote>\n  <p>NewTicker returns a new Ticker containing a channel that will send the\n  time with a period specified by the duration argument. It adjusts the\n  intervals or drops ticks to make up for slow receivers. The duration d\n  must be greater than zero; if not, NewTicker will panic. Stop the\n  ticker to release associated resources.</p>\n</blockquote>\n\n<p>Though it doesn't explicitly mention it's a channel with a buffer of one.</p>\n"}], "owner": {"reputation": 1011, "user_id": 1881641, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d8c2466a4bf038dc5617545698a97d5f?s=128&d=identicon&r=PG", "display_name": "what is what", "link": "https://stackoverflow.com/users/1881641/what-is-what"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5040, "favorite_count": 2, "accepted_answer_id": 37963349, "answer_count": 1, "score": 2, "last_activity_date": 1518606044, "creation_date": 1466584476, "last_edit_date": 1466584768, "question_id": 37962666, "link": "https://stackoverflow.com/questions/37962666/how-does-golang-ticker-work", "title": "How does golang ticker work?", "body": "<pre><code>func Tick() {                                                                                                                                         \n    fmt.Println(\"startTime\", time.Now().Format(\"2006-01-02 15:04:05\"))                                                                                \n    t := time.NewTicker(time.Second * 3)                                                                                                              \n    time.Sleep(time.Second * 12)                                                                                                                      \n    for {                                                                                                                                             \n        stamp := &lt;-t.C                                                                                                                                \n        fmt.Println(\"tickTime\", stamp.Format(\"2006-01-02 15:04:05\"))                                                                                  \n    }                                                                                                                                                 \n}          \n</code></pre>\n\n<p>Otput from above snippet is:</p>\n\n<p>startTime 2016-06-22 16:22:20</p>\n\n<p>tickTime 2016-06-22 16:22:23</p>\n\n<p>tickTime 2016-06-22 16:22:35</p>\n\n<p>tickTime 2016-06-22 16:22:38</p>\n\n<p>tickTime 2016-06-22 16:22:41</p>\n\n<p>tickTime 2016-06-22 16:22:44</p>\n\n<hr>\n\n<p>Why has this happend with no timestamp  16:22:26, 16:22:29 when I delay the ticker?</p>\n"}, {"tags": ["pointers", "go", "null", "gob"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1466592512, "last_edit_date": 1466592512, "creation_date": 1466592198, "answer_id": 37965684, "question_id": 37962021, "link": "https://stackoverflow.com/questions/37962021/gob-attempting-to-decode-nil-value-results-in-eof-error/37965684#37965684", "title": "gob attempting to decode nil value results in EOF error", "body": "<p>You are swallowing an <code>error</code> returned by <a href=\"https://golang.org/pkg/encoding/gob/#Encoder.Encode\" rel=\"noreferrer\"><code>Encoder.Encode()</code></a>:</p>\n\n<pre><code>err := gob.NewEncoder(bys).Encode(map[string]interface{}{\n    \"v\": (*T)(nil),\n})\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>gob: gob: cannot encode nil pointer of type *main.T inside interface\n</code></pre>\n\n<p>This is generated by unexported method <code>Encoder.encodeInterface()</code>. Quoting from <a href=\"https://golang.org/src/encoding/gob/encode.go\" rel=\"noreferrer\"><code>encode.go</code></a>, unexported method <code>Encoder.encodeInterface()</code>:</p>\n\n<pre><code>// Gobs can encode nil interface values but not typed interface\n// values holding nil pointers, since nil pointers point to no value.\nelem := iv.Elem()\nif elem.Kind() == reflect.Ptr &amp;&amp; elem.IsNil() {\n    errorf(\"gob: cannot encode nil pointer of type %s inside interface\", iv.Elem().Type())\n}\n</code></pre>\n\n<p>So your <code>Encoder.Encode()</code> fails, it writes nothing to its output (which is the <code>bys</code> buffer), so attempting to read (decode) anything from it results in EOF.</p>\n\n<p>But why can't you encode an <code>interface{}</code> value holding a <code>nil</code> pointer? Quoting from the package doc of <a href=\"https://golang.org/pkg/encoding/gob/\" rel=\"noreferrer\"><code>encoding/gob</code></a>:</p>\n\n<blockquote>\n  <p>Pointers are not transmitted, but the things they point to are transmitted; that is, the values are flattened.</p>\n</blockquote>\n\n<p>Your <code>interface{}</code> contains a value of pointer type, but that pointer is <code>nil</code>, it points to nothing, it cannot be flattened.</p>\n\n<hr>\n\n<p>Here is a related issue on github: <a href=\"https://github.com/golang/go/issues/3704\" rel=\"noreferrer\">encoding/gob: panic on encoding nil pointer #3704</a></p>\n\n<p>Russ:</p>\n\n<blockquote>\n  <p>gob doesn't know what a pointer is: everything gets flattened. Putting a nil pointer in an interface{} value creates a non-zero value (it's not the nil interface) that gob cannot send (it can't express 'nil pointer').</p>\n</blockquote>\n\n<p>Rob Pike:</p>\n\n<blockquote>\n  <p>Correct. An interface value can be transmitted only if the concrete value itself is transmittable. At least for now, that's equivalent to saying that interfaces holding typed nil pointers cannot be sent.</p>\n</blockquote>\n"}], "owner": {"reputation": 240, "user_id": 2625452, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb7f5e8e70a3b22e31f598d92491495d?s=128&d=identicon&r=PG", "display_name": "llx", "link": "https://stackoverflow.com/users/2625452/llx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1919, "favorite_count": 1, "accepted_answer_id": 37965684, "answer_count": 1, "score": 1, "last_activity_date": 1466593472, "creation_date": 1466582560, "last_edit_date": 1466593472, "question_id": 37962021, "link": "https://stackoverflow.com/questions/37962021/gob-attempting-to-decode-nil-value-results-in-eof-error", "title": "gob attempting to decode nil value results in EOF error", "body": "<p>I need to use the <code>gob</code> to encode some data, however, I find that \"type nil\" can not be processed correctly (go 1.6.2)</p>\n\n<p><a href=\"https://play.golang.org/p/faypK8uobF\" rel=\"nofollow\">https://play.golang.org/p/faypK8uobF</a></p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/gob\"\n    \"log\"\n)\n\ntype T struct {\n    A int\n}\n\nfunc init() {\n    gob.Register(map[string]interface{}{})\n    gob.Register(new(T))\n}\nfunc main() {\n    bys := bytes.NewBuffer(nil)\n    gob.NewEncoder(bys).Encode(map[string]interface{}{\n        \"v\": (*T)(nil),\n    })\n    out := map[string]interface{}{}\n    if err := gob.NewDecoder(bys).Decode(&amp;out); err != nil {\n        log.Panic(err)\n    }\n    return\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>panic: EOF\n</code></pre>\n"}, {"tags": ["c++", "c", "go", "gccgo"], "comments": [{"owner": {"reputation": 10492, "user_id": 603688, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1058344e1b119c4d9dd3aedc5456277b?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/603688/dan"}, "edited": false, "score": 1, "creation_date": 1466578311, "post_id": 37960425, "comment_id": 63368324, "body": "Most likely just for reusability. Almost every major library (not to mention OS) has a C binding, so having the ability to call C from your language is a big win for the language&#39;s adoption."}], "answers": [{"tags": [], "owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "is_accepted": false, "score": 1, "last_activity_date": 1466580768, "creation_date": 1466580768, "answer_id": 37961395, "question_id": 37960425, "link": "https://stackoverflow.com/questions/37960425/using-c-in-a-go-application-for-performance/37961395#37961395", "title": "Using C(++) in a Go application for performance", "body": "<p>Unless a C library does a lot of work in one call I wouldn't write C code just for performance. I consider cgo to only be for interfacing with old code.</p>\n\n<p>The reason is the cgo overhead. Currently function calls into cgo functions are <a href=\"https://github.com/art4711/cgo_overhead\" rel=\"nofollow\">between 50 and 100 times slower than function calls to Go code</a>. The overhead of cgo function calls is shocking.</p>\n"}, {"comments": [{"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 0, "creation_date": 1466584272, "post_id": 37961486, "comment_id": 63372056, "body": "&quot;Go has to suspend its runtime in certain ways to call C functions&quot; -- is it documented/discussed somewhere? See also <a href=\"http://stackoverflow.com/a/37962500/3169754\">my answer</a> and <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/RTtMsgZi88Q\" rel=\"nofollow noreferrer\">this thread</a>."}, {"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 0, "creation_date": 1466584493, "post_id": 37961486, "comment_id": 63372194, "body": "I can&#39;t find any evidence that runtime is suspended. I&#39;m probably missing something."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 1, "creation_date": 1466584665, "post_id": 37961486, "comment_id": 63372293, "body": "@g-v It&#39;s one of those things that constantly in flux with new Go versions. I think Go used to have to outright pause the garbage collector and other things. It looks like nowadays it mostly has to record a ton of metadata to accommodate the different calling convention:  <a href=\"http://dave.cheney.net/2016/01/18/cgo-is-not-go\" rel=\"nofollow noreferrer\">dave.cheney.net/2016/01/18/cgo-is-not-go</a>  Also, it can&#39;t interrupt and reschedule the goroutine on another thread while it&#39;s in C code, which is absolute can and does do, often for performance reasons, in GO code."}, {"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 0, "creation_date": 1466585187, "post_id": 37961486, "comment_id": 63372604, "body": "Thanks for the link. So there is a stack switch and inefficient data exchange, not a runtime suspension. Looks sensible."}, {"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 0, "creation_date": 1466585274, "post_id": 37961486, "comment_id": 63372675, "body": "&quot;Also, it can&#39;t interrupt and reschedule the goroutine on another thread while it&#39;s in C code, which is absolute can and does do, often for performance reasons, in GO code&quot; - Yes, this is quite obvious."}, {"owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "edited": false, "score": 1, "creation_date": 1466585897, "post_id": 37961486, "comment_id": 63373090, "body": "&quot;because you can write assembly that Go can use without suspending its runtime&quot; -- you probably would like to fix wording here too"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466618563, "post_id": 37961486, "comment_id": 63396757, "body": "@jsor: a cgo call takes an OS thread, which does not count against GOMAXPROCS, therefore doesn&#39;t block execution of any other goroutines. Besides the initial overhead of the stack switch in the cgo call, there is no performance penalty for executing C code."}], "tags": [], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "is_accepted": true, "score": 11, "last_activity_date": 1466591417, "last_edit_date": 1466591417, "creation_date": 1466581036, "answer_id": 37961486, "question_id": 37960425, "link": "https://stackoverflow.com/questions/37960425/using-c-in-a-go-application-for-performance/37961486#37961486", "title": "Using C(++) in a Go application for performance", "body": "<p>Cgo is fairly slow, because Go has to <a href=\"http://dave.cheney.net/2016/01/18/cgo-is-not-go\" rel=\"noreferrer\">mess with its runtime and calling conventions</a> in certain ways to call C functions. The only place it's really worth it is cases where the compute time significantly dwarfs <a href=\"https://github.com/art4711/cgo_overhead\" rel=\"noreferrer\">this cost</a>. It's similar to parallel, distributed, GPU and so on programming, albeit with slightly lower startup costs.</p>\n\n<p>Assembly is much better, because you can write assembly that uses Go's calling convention, and is otherwise treated like native Go code, but assembly is far less portable, harder to read, and more maintenance heavy. In fact, the Go standard library writes some of the <code>math</code> and <code>big</code> packages in Plan 9-style assembly.</p>\n\n<p><a href=\"https://github.com/gonum\" rel=\"noreferrer\">Gonum</a> is an example of both of these. It uses common assembly for some functions that can be done more quickly that way, but it also leverages blas and lapack engines. It does provide a <code>Go-blas</code> implementation, but C-blas (which is usually ultimately Fortran-blas) is faster, and for large matrix computations almost always dwarfs the cost of leaving Go.</p>\n\n<p>Generally, you want to avoid cgo when possible. Only use it when significant computation time is needed, <em>or</em> you need to interact with things that would be non-trivial to interact with in pure Go, such as graphics or audio drivers, or accessing common libraries like OpenCV. Even then, if you really care about performance, where possible it may be worth it to implement some sort of \"call pooling\" where you can schedule multiple calls from the Go side and execute them all at once with a single context switch to C.</p>\n\n<p>Edit: As for C++, there are some significant issues. It can be difficult to wrap certain libraries without several layers of abstraction (since cgo cannot handle included C++ headers properly). In addition, C++ classes with destructors can't really be returned by value and have to be allocated on the heap. Since Go doesn't allow for deterministic finalization of resources, you <strong>must</strong> provide a function to explicitly free memory, and the Go user must remember to free the resource. (There is a function you may read about in the documentation called <code>runtime.SetFinalizer</code> but I can't say I've ever seen anyone use it, and the documentation itself comes with a bunch of caveats)</p>\n\n<p>Functionality such as <code>defer</code> makes this more manageable, but it ruins a lot of things like RAII which make modern C++ practices safer.</p>\n"}], "owner": {"reputation": 3339, "user_id": 1374987, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/jmuPH.png?s=128&g=1", "display_name": "PentaKon", "link": "https://stackoverflow.com/users/1374987/pentakon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3215, "favorite_count": 3, "accepted_answer_id": 37961486, "answer_count": 2, "score": 9, "last_activity_date": 1575815692, "creation_date": 1466577850, "last_edit_date": 1575815692, "question_id": 37960425, "link": "https://stackoverflow.com/questions/37960425/using-c-in-a-go-application-for-performance", "title": "Using C(++) in a Go application for performance", "body": "<p>I've started studying Go a couple of days ago and came by its CGO thing and the gccgo compiler. From my understanding this allows a Go program to compile using the Go compiler and compile C libraries using a C compiler and reference those libraries from inside a Go program. This is really interesting to me because this allows us to leverage C's performance (if needed) from our main program with little overhead.</p>\n\n<p>However I'm not sure how little that is, so I'm asking here: </p>\n\n<p>Are there cases where you would create a C library just to use it from inside your Go application? Or is this feature only to facilitate re-usability of existing C code?</p>\n\n<p>P.S: I think at the moment CGO doesn't support C++ but there was a post here of someone that was able to wrap C++ code using C functions and call them successfully.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "is_accepted": true, "score": 3, "last_activity_date": 1466564989, "creation_date": 1466564989, "answer_id": 37957873, "question_id": 37957807, "link": "https://stackoverflow.com/questions/37957807/overhead-of-go-routines-in-golang/37957873#37957873", "title": "Overhead of go routines in golang", "body": "<p>The built-in <code>http</code> package uses a goroutine for each connection and there are numerous benchmarks showing it being able to handle thousands of concurrent users. So unless you have many connections with many messages each, I'd say it's reasonable to create a new goroutine for each message. And in any case, go has a nice <a href=\"https://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"nofollow\">benchmarking feature</a> you can use to verify your assumptions.</p>\n\n<p><a href=\"https://golang.org/src/net/http/server.go#L2137\" rel=\"nofollow\">https://golang.org/src/net/http/server.go#L2137</a></p>\n"}, {"tags": [], "owner": {"reputation": 1337, "user_id": 3755196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0aJ9G.jpg?s=128&g=1", "display_name": "Raj Kumar", "link": "https://stackoverflow.com/users/3755196/raj-kumar"}, "is_accepted": false, "score": 4, "last_activity_date": 1466573505, "creation_date": 1466573505, "answer_id": 37959296, "question_id": 37957807, "link": "https://stackoverflow.com/questions/37957807/overhead-of-go-routines-in-golang/37959296#37959296", "title": "Overhead of go routines in golang", "body": "<p>We were actually doing stress testing with a similar approach. We spawned new threads for every http request. The concurrency was so good than within 10 seconds we had reached something like 100,000 requests. The only bottle neck you might face is memory because if all the processing isn't fast enough then you might run out of memory for that process.</p>\n\n<p>I'm quite sure there is a work around for it, but that is one reason why you would want to throttle and nor spawn unlimited go routines. The problem we faced is we were trying to get data from another API which was just not able to keep up with this level of concurrency. Hence the throttling suggestion earlier.</p>\n"}], "owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2169, "favorite_count": 0, "accepted_answer_id": 37957873, "answer_count": 2, "score": 1, "last_activity_date": 1466573505, "creation_date": 1466564606, "question_id": 37957807, "link": "https://stackoverflow.com/questions/37957807/overhead-of-go-routines-in-golang", "title": "Overhead of go routines in golang", "body": "<p>So I understand go routines have low overhead, but I'm wondering just how good they are. If I have a server that handles incoming messages how does creating a new go routine to process each incoming message compare to using the standard producer/consumer model with channels?</p>\n\n<p>Like is it reasonable to have a high performance go server that spawns new go routines for ever incoming request.</p>\n"}, {"tags": ["go", "beego"], "answers": [{"tags": [], "owner": {"reputation": 1948, "user_id": 1924657, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/gumlg.jpg?s=128&g=1", "display_name": "Bryce", "link": "https://stackoverflow.com/users/1924657/bryce"}, "is_accepted": false, "score": 0, "last_activity_date": 1470278250, "creation_date": 1470278250, "answer_id": 38757638, "question_id": 37956512, "link": "https://stackoverflow.com/questions/37956512/how-to-create-a-custom-recover-in-beego/38757638#38757638", "title": "How to create a custom recover in Beego?", "body": "<p>You should add <code>recoverPanic</code> at the beginning of every goroutine. You add the <code>recover</code> in the <code>main</code> function and it won't cache the <code>panic</code> of request.</p>\n\n<p>Try this in Beego:</p>\n\n<pre><code>func (c *MainController) Get() {\n    defer recoverPanic()\n\n    ... Your Code ...\n}\n</code></pre>\n"}], "owner": {"reputation": 1242, "user_id": 1819549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ae42e926dea320c7e66ae30096adf56?s=128&d=identicon&r=PG", "display_name": "windyzboy", "link": "https://stackoverflow.com/users/1819549/windyzboy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 365, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1470278250, "creation_date": 1466553856, "question_id": 37956512, "link": "https://stackoverflow.com/questions/37956512/how-to-create-a-custom-recover-in-beego", "title": "How to create a custom recover in Beego?", "body": "<p>How to override Beego's recoverPanic? I have set the flag <code>recoverpanic = false</code> and write my own recover but have no luck, it just print the panic message to the console instead jumping to my recover function.</p>\n\n<pre><code>func main() {\n    defer recoverPanic()\n    beego.Run()\n}\n\nfunc recoverPanic() {\n    if err := recover(); err != nil {\n        fmt.Println(\"Panic should go there\")\n    }\n}\n</code></pre>\n\n<p>I want to catch all unexpect errors, e.g <code>nil pointer</code>, write some log and send email to our maintainers.</p>\n"}, {"tags": ["google-app-engine", "go", "blobstore"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 1, "creation_date": 1466576840, "post_id": 37956387, "comment_id": 63367488, "body": "Shouldn&#39;t <a href=\"http://stackoverflow.com/a/20147721/5125201\">this</a> answer solve your question?"}, {"owner": {"reputation": 299, "user_id": 477166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb89664a802ee41cf89ab7bed6392fcd?s=128&d=identicon&r=PG", "display_name": "Kevin Postal", "link": "https://stackoverflow.com/users/477166/kevin-postal"}, "reply_to_user": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1466615698, "post_id": 37956387, "comment_id": 63395089, "body": "That answer must be using a very old API.   <a href=\"https://cloud.google.com/appengine/docs/go/blobstore/reference\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/go/blobstore/reference</a>  There is no Create Method currently."}], "owner": {"reputation": 299, "user_id": 477166, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/fb89664a802ee41cf89ab7bed6392fcd?s=128&d=identicon&r=PG", "display_name": "Kevin Postal", "link": "https://stackoverflow.com/users/477166/kevin-postal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 117, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466553065, "creation_date": 1466553065, "last_edit_date": 1495540727, "question_id": 37956387, "link": "https://stackoverflow.com/questions/37956387/setting-mime-content-type-with-golang-and-google-blobstore", "title": "Setting MIME Content Type With Golang and Google Blobstore", "body": "<p>I followed this post and got the example code uploading a Blobstore object.</p>\n\n<p><a href=\"https://stackoverflow.com/questions/20144066/is-it-possible-to-store-arbitrary-data-in-gae-golang-blobstore/20396827#20396827\">Is it possible to store arbitrary data in GAE Golang Blobstore?</a></p>\n\n<p>However the content-type is set to application/octet-stream</p>\n\n<p>Does anyone have any idea how I would go about modifying that code to send a image/jpg content-type? </p>\n"}, {"tags": ["go", "types", "yaml"], "comments": [{"owner": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "edited": false, "score": 0, "creation_date": 1466542102, "post_id": 37953659, "comment_id": 63357021, "body": "I bet <code>yaml.Marshal</code> can&#39;t figure out the correct type because of <code>interface{}</code> type in your map and throw out everything as <code>strings</code>. I had a similar problem when trying to unmarshal data from a JSON with an array of <code>interface{}</code>. Can&#39;t you marshal it to a <code>struct</code>?"}, {"owner": {"reputation": 55, "user_id": 2997962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/29f425d7afd3a7a8b8679b531440cc86?s=128&d=identicon&r=PG&f=1", "display_name": "user2997962", "link": "https://stackoverflow.com/users/2997962/user2997962"}, "reply_to_user": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "edited": false, "score": 0, "creation_date": 1466542331, "post_id": 37953659, "comment_id": 63357147, "body": "The map interface is not always going to have the same structure so a struct is not an option for this case."}], "owner": {"reputation": 55, "user_id": 2997962, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/29f425d7afd3a7a8b8679b531440cc86?s=128&d=identicon&r=PG&f=1", "display_name": "user2997962", "link": "https://stackoverflow.com/users/2997962/user2997962"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 604, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466539623, "creation_date": 1466539623, "question_id": 37953659, "link": "https://stackoverflow.com/questions/37953659/golang-enforce-type-for-yaml-marshal", "title": "Golang enforce type for yaml.marshal", "body": "<p>I'm running into this case where I have to marshal a map[string]interface{} and print it out. What happens is that when I print it out, the yaml lib (gopkg.in/yaml.v2) converts the ints into strings and surrounds them by quotes while the strings are printed as strings without quotes. Example:</p>\n\n<pre><code>prop1: \"1\"\nprop2: test\nprop3: test2\n</code></pre>\n\n<p>I need other systems to read these values but could not find a way on enforcing the numeric types when I do yaml.Marshal().</p>\n\n<p>My code for the above output looks something like this:</p>\n\n<pre><code>// receive output from somewhere else\npad := \"%-16s%s\"\nraw, err := yaml.Marshal(output)\nsArr := strings.Split(raw, \"\\n\")\nfor _, s := range sArr {\n    fmt.Fprintln(c.StdOut, fmt.Sprintf(pad, s, \"\"))\n} \n</code></pre>\n\n<p>Any suggestions how to overcome this?</p>\n\n<p>Thanks in advance! \nJC</p>\n"}, {"tags": ["ssl", "go", "docker", "https"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466539213, "post_id": 37953480, "comment_id": 63355582, "body": "Are you asking what the the golang image sets  for WORKDIR? You can see it in the <a href=\"https://github.com/docker-library/golang/blob/0ce80411b9f41e9c3a21fc0a1bffba6ae761825a/1.6/Dockerfile\" rel=\"nofollow noreferrer\">DOCKERFILE</a>"}, {"owner": {"reputation": 2122, "user_id": 433253, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8661e1fc24e3041a462484721277c2d1?s=128&d=identicon&r=PG", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/433253/johndoe"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466539445, "post_id": 37953480, "comment_id": 63355698, "body": "But this is the WORKDIR for the build, not where the executable will finally be stored and called, or? Depends of it&#39;s a go build or go install. I barely understand the semantics of Dockerfile s"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466539656, "post_id": 37953480, "comment_id": 63355797, "body": "&quot;The <a href=\"https://docs.docker.com/engine/reference/builder/#workdir\" rel=\"nofollow noreferrer\">WORKDIR</a> instruction sets the working directory for any RUN, CMD, ENTRYPOINT, COPY and ADD instructions that follow it in the Dockerfile&quot; You can also set WORKDIR yourself in your DOCKERFILE, or use an absolute path to locate the files."}], "answers": [{"comments": [{"owner": {"reputation": 2122, "user_id": 433253, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8661e1fc24e3041a462484721277c2d1?s=128&d=identicon&r=PG", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/433253/johndoe"}, "edited": false, "score": 0, "creation_date": 1466590132, "post_id": 37957128, "comment_id": 63376120, "body": "When I run docker run ... -v /home/local/cert.pem:/go/cert,pem   and try to open cert.pem in the program it complains about &quot;file not found&quot;. So, as it seems, /go/ is not the PWD the application is executing in?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2122, "user_id": 433253, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8661e1fc24e3041a462484721277c2d1?s=128&d=identicon&r=PG", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/433253/johndoe"}, "edited": false, "score": 2, "creation_date": 1466601578, "post_id": 37957128, "comment_id": 63384289, "body": "@JohnDoe: execute a <code>pwd</code> or <code>ls</code> and see where you are and what&#39;s in the directory."}], "tags": [], "owner": {"reputation": 192, "user_id": 298501, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3391414ab061aec0823a7626b8f3afea?s=128&d=identicon&r=PG", "display_name": "Botz", "link": "https://stackoverflow.com/users/298501/botz"}, "is_accepted": false, "score": 2, "last_activity_date": 1466559047, "creation_date": 1466559047, "answer_id": 37957128, "question_id": 37953480, "link": "https://stackoverflow.com/questions/37953480/what-is-the-working-directory-of-a-docker-golang-application/37957128#37957128", "title": "What is the working directory of a Docker Golang application?", "body": "<p>If you are using the golang:1.X-onbuild image from DockerHub will be copied into(<a href=\"https://hub.docker.com/_/golang/\" rel=\"nofollow\">https://hub.docker.com/_/golang/</a>)</p>\n\n<pre><code>/go/src/app\n</code></pre>\n\n<p>this means all files and directories from the directory where you run the</p>\n\n<pre><code>docker build \n</code></pre>\n\n<p>command will be copied into the container.</p>\n\n<p>And the workdir of all images is</p>\n\n<pre><code>/go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2122, "user_id": 433253, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8661e1fc24e3041a462484721277c2d1?s=128&d=identicon&r=PG", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/433253/johndoe"}, "is_accepted": false, "score": 0, "last_activity_date": 1466667676, "creation_date": 1466667676, "answer_id": 37985158, "question_id": 37953480, "link": "https://stackoverflow.com/questions/37953480/what-is-the-working-directory-of-a-docker-golang-application/37985158#37985158", "title": "What is the working directory of a Docker Golang application?", "body": "<p>Go will return the current working directory using </p>\n\n<pre><code>currdir, _ = filepath.Abs(filepath.Dir(os.Args[0]))\n</code></pre>\n\n<p>Executed within a golang container and right after startup, the pwd is set to</p>\n\n<pre><code>/go/src/app\n</code></pre>\n\n<p>The current working directory of a golang application starting up within a Docker container is thus <code>/go/src/app</code>. In order to map a file/directory into a container you will habe to use the <code>-v</code>-switch as described in the <a href=\"https://docs.docker.com/engine/reference/commandline/run/#mount-volume-v-read-only\" rel=\"nofollow\">Documentation for run</a>:</p>\n\n<pre><code>-v /local/file.pem:/go/src/app/file.pem\n</code></pre>\n\n<p>Will map a local file into the pwd of the dockerized golang app.</p>\n"}], "owner": {"reputation": 2122, "user_id": 433253, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8661e1fc24e3041a462484721277c2d1?s=128&d=identicon&r=PG", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/433253/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1398, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1466667676, "creation_date": 1466538991, "question_id": 37953480, "link": "https://stackoverflow.com/questions/37953480/what-is-the-working-directory-of-a-docker-golang-application", "title": "What is the working directory of a Docker Golang application?", "body": "<p>When I serve a Golang Application from within the official Docker Hub Repository I wonder what will be the default working directory the application starts up?</p>\n\n<p>Background: I will have to map local Certificate Authority and server keys into the container to serve TLS https and I wonder where to map them to the application will be able to grab them in current working directory of the application from within the container?</p>\n"}, {"tags": ["html", "image", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466537587, "post_id": 37953016, "comment_id": 63354756, "body": "Where you put the images has nothing to do with the template. The handler that serves those files has to be able to find them."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466539386, "post_id": 37953016, "comment_id": 63355668, "body": "you should make a folder named <code>public</code> or <code>html</code> or <code>web</code>, put your static resources there, then host that folder with e.g. <a href=\"https://github.com/gin-gonic/contrib/blob/master/static/static_test.go#L62\" rel=\"nofollow noreferrer\">gin-gonic/contrib/static</a>"}, {"owner": {"reputation": 5779, "user_id": 876686, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/0dc9f06a29ef13328a46d31db59634ea?s=128&d=identicon&r=PG", "display_name": "tier1", "link": "https://stackoverflow.com/users/876686/tier1"}, "edited": false, "score": 0, "creation_date": 1466540540, "post_id": 37953016, "comment_id": 63356225, "body": "Use your browser debugging tools and verify that your server is sending the correct path."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1466602960, "post_id": 37953016, "comment_id": 63385607, "body": "Some related questions: <a href=\"http://stackoverflow.com/questions/32580043\">one</a>; <a href=\"http://stackoverflow.com/questions/28293452\">two</a>; <a href=\"http://stackoverflow.com/questions/27945310\">three</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1466610185, "post_id": 37953016, "comment_id": 63391624, "body": "Also you might find this useful: <a href=\"http://stackoverflow.com/questions/31059023/how-to-reference-a-relative-file-from-code-and-tests\">how to reference a relative file from code and tests</a>"}], "answers": [{"tags": [], "owner": {"reputation": 85, "user_id": 902737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6a95ca1900a66f9142531b7685891eb7?s=128&d=identicon&r=PG", "display_name": "JFXNerd", "link": "https://stackoverflow.com/users/902737/jfxnerd"}, "is_accepted": false, "score": 0, "last_activity_date": 1470860995, "creation_date": 1470860995, "answer_id": 38882971, "question_id": 37953016, "link": "https://stackoverflow.com/questions/37953016/go-lang-where-in-directory-structure-to-place-images-for-use-in-html-template/38882971#38882971", "title": "Go Lang - Where in directory structure to place images for use in HTML template?", "body": "<p>Okay, so if found a couple different ways to do this.  First, my actual solution was to port my app to a CGI rather than a Go Web Server.  This took away the need to serve up assets separately.</p>\n\n<p>However, for those who have a Go web server and need to get this figured out, here's how I did it.  I placed all of my resources (i.e., images, stylesheets, etc) in a \"resources\" directory at the root of where the app was being run, then added a <code>HandleFunc</code> for this URL in the main as shown here:</p>\n\n<pre><code>router := http.NewServeMux()\nrouter.HandleFunc(getURL(\"/view/\"), viewHandler)\nrouter.HandleFunc(getURL(\"/resources/\"), serveAssets)\n</code></pre>\n\n<p>Then, the <code>serveAssets</code> function attempts to open each resource, and if successful calls <code>ServeContent</code> as shown:</p>\n\n<pre><code>func serveAssets(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()\n\n    file, err := os.Open(docRoot + r.URL.String())\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusNotFound)\n        return\n    }\n\n    modeTime := time.Now()\n    http.ServeContent(w, r, docRoon+r.URL.String(), modeTime, file)\n}\n</code></pre>\n\n<p>That should do it!</p>\n"}], "owner": {"reputation": 85, "user_id": 902737, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6a95ca1900a66f9142531b7685891eb7?s=128&d=identicon&r=PG", "display_name": "JFXNerd", "link": "https://stackoverflow.com/users/902737/jfxnerd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 598, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1470860995, "creation_date": 1466537282, "question_id": 37953016, "link": "https://stackoverflow.com/questions/37953016/go-lang-where-in-directory-structure-to-place-images-for-use-in-html-template", "title": "Go Lang - Where in directory structure to place images for use in HTML template?", "body": "<p>I've just started working with GO and am creating a simple web interface.  I have a working GO server, an HTML template called \"survey.gtpl\" which is served up by the server as expected, and a logo I would like displayed on the web page.  No matter where I place the image within the workspace directory structure or what I put as the  src path, the image will not load.</p>\n\n<p>Here is the current directory structure:</p>\n\n<pre><code>+ workspace\n    + bin\n        server.exe\n    + src\n        + github.com\n            + cwrighta70\n                + web\n                    server.go\n    LogoColor.jpg\n    survey.gtpl\n</code></pre>\n\n<p>And here is the path within the \"survey.gtpl\" template\"</p>\n\n<pre><code>&lt;img src = \"LogoColor.jpg\" alt=\"Logo\" width=\"789px\" height=\"182px\"&gt;\n</code></pre>\n\n<p>I've tried putting the image in it's own directory within the workspace, like <code>workspace/img/LogoColor.jpg</code>.  I've also tried putting it in with the web server executable in <code>workspace/bin/LogoColor.jpg</code>.  All I get in the browser is the Alt text.</p>\n\n<p>Any help is greatly appreciated!</p>\n\n<ul>\n<li>Chris</li>\n</ul>\n"}, {"tags": ["java", "exception", "go", "exception-handling", "throws"], "comments": [{"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 1, "creation_date": 1466536078, "post_id": 37952646, "comment_id": 63353891, "body": "That&#39;s the philosophy of Go: If the developer sees that the function returns an error, it&#39;s then his responsibility to check it. The programming language won&#39;t force you to do it."}, {"owner": {"reputation": 185247, "user_id": 135589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbd98f264c64096af168747c3ae71a7d?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/135589/jesper"}, "edited": false, "score": 4, "creation_date": 1466536172, "post_id": 37952646, "comment_id": 63353946, "body": "Checked exceptions are a feature unique to Java, no other programming language has them. In other words: there is no equivalent to a <code>throws</code> clause in Go or in any other programming language than Java."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466536175, "post_id": 37952646, "comment_id": 63353949, "body": "Also read: <a href=\"https://blog.golang.org/errors-are-values\" rel=\"nofollow noreferrer\">blog.golang.org/errors-are-values</a>. It isn&#39;t your problem if a client doesn&#39;t handle an error you return. If the client <i>must</i> handle it, then you document that."}, {"owner": {"reputation": 8011, "user_id": 3830694, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6TotP.jpg?s=128&g=1", "display_name": "Krupal Shah", "link": "https://stackoverflow.com/users/3830694/krupal-shah"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466536541, "post_id": 37952646, "comment_id": 63354143, "body": "@jimB I found many cases where I want to use throws clause to let client know - &quot;hey there can be a error. you must have to handle it.&quot; That&#39;s also beneficial for the client. Only by documenting it; you can&#39;t put it on right way. This may be subjective by the way."}, {"owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "edited": false, "score": 3, "creation_date": 1466536861, "post_id": 37952646, "comment_id": 63354320, "body": "@KrupalShah: In Go, the fact that one of the return values is an error communicates that this function is not guaranteed to succeed. I can understand that this feels weird and overly-optimistic, especially for a Java developer but you&#39;ll get used to it. For me, I&#39;ve always hated exceptions because they have to be handled at every nested level."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1466536868, "post_id": 37952646, "comment_id": 63354326, "body": "@KrupalShah: it is subjective, so the only real advice I can offer is &quot;don&#39;t write Java in Go&quot;"}, {"owner": {"reputation": 8011, "user_id": 3830694, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6TotP.jpg?s=128&g=1", "display_name": "Krupal Shah", "link": "https://stackoverflow.com/users/3830694/krupal-shah"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466536955, "post_id": 37952646, "comment_id": 63354377, "body": "@JimB No I am just exploring a language. Not trying to mix java&#39;s thinking with Go and respect everyone&#39;s philosophy of doing it. I just asked because I wanted to know if there is any keyword because I haven&#39;t learnt Go very well yet."}], "answers": [{"tags": [], "owner": {"reputation": 8775, "user_id": 821110, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/fa6fca5f613944238a91d2daeba67b9d?s=128&d=identicon&r=PG", "display_name": "W.K.S", "link": "https://stackoverflow.com/users/821110/w-k-s"}, "is_accepted": false, "score": 7, "last_activity_date": 1466537196, "last_edit_date": 1466537196, "creation_date": 1466536431, "answer_id": 37952767, "question_id": 37952646, "link": "https://stackoverflow.com/questions/37952646/what-is-gos-equivalent-to-throws-clause/37952767#37952767", "title": "What is Go&#39;s equivalent to &#39;throws&#39; clause?", "body": "<p>That's the philosophy of Go: If the developer sees that a function returns an error, it's then his responsibility to check the error. The programming language won't force you to do it.</p>\n\n<p>Rob Pike's reasoning behind this is that errors are not special and therefore, there is no need for a specialized language construct (i.e. <code>try/catch</code>) to handle them.</p>\n"}, {"tags": [], "owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "is_accepted": true, "score": 7, "last_activity_date": 1466536550, "creation_date": 1466536550, "answer_id": 37952802, "question_id": 37952646, "link": "https://stackoverflow.com/questions/37952646/what-is-gos-equivalent-to-throws-clause/37952802#37952802", "title": "What is Go&#39;s equivalent to &#39;throws&#39; clause?", "body": "<p>Your library should also pass the err back through its exposed functions. You'll notice that many of the methods in the std library have a return value and an error so people should be used to having to handle errors.</p>\n\n<p>If you really want to have behavior that appears similar to java you can use panic(), but note in golang panic should only be used for unrecoverable errors, or programmer errors (not runtime errors that can be recovered from)</p>\n\n<p>Either way you can't force a client to handle it. It is their responsibility.</p>\n"}], "owner": {"reputation": 8011, "user_id": 3830694, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/6TotP.jpg?s=128&g=1", "display_name": "Krupal Shah", "link": "https://stackoverflow.com/users/3830694/krupal-shah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 195, "favorite_count": 0, "accepted_answer_id": 37952802, "answer_count": 2, "score": 3, "last_activity_date": 1474202029, "creation_date": 1466535960, "last_edit_date": 1474202029, "question_id": 37952646, "link": "https://stackoverflow.com/questions/37952646/what-is-gos-equivalent-to-throws-clause", "title": "What is Go&#39;s equivalent to &#39;throws&#39; clause?", "body": "<p>I am just learning <a href=\"https://golang.org/\" rel=\"nofollow\">Go programming language</a>. I just read about the way of <a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"nofollow\">error handling in Go</a>. There is a nice explanation but I have some confusion about it.\nThe typical way of handing error in Go is just returning error as a second value of function:</p>\n\n<pre><code>f, err := Sqrt(-1)\nif err != nil {\n    fmt.Println(err)\n}\n</code></pre>\n\n<p>Very simple. But let say I am a library developer and I might want to know the client that my function can throw some error nad client must handle it.</p>\n\n<p>In Java, I have <code>throws</code> clause. So, client must have to put it in those <code>try...catch</code> blocks</p>\n\n<p>In Go, I can return error from a function; but let say if client of library avoid to handle it then how do I gracefully tell him to handle it?</p>\n\n<p><strong>Edit:</strong>\n I am just exploring a language. Not trying to mix java's thinking with Go and respect everyone's philosophy of doing it. I just asked because I wanted to know if there is any keyword because I haven't learnt Go very well yet.</p>\n"}, {"tags": ["go", "encapsulation"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466536748, "post_id": 37952725, "comment_id": 63354265, "body": "It&#39;s very common in Go to return a private implementation of a public interface. That pattern is used throughout the stdlib."}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": false, "score": 1, "last_activity_date": 1466536256, "creation_date": 1466536256, "answer_id": 37952725, "question_id": 37952354, "link": "https://stackoverflow.com/questions/37952354/golang-public-method-to-private-struct-is-this-have-any-use-case/37952725#37952725", "title": "golang public method to private struct - is this have any use case", "body": "<p>This is the commit that unexports it: <a href=\"https://github.com/btcsuite/btcd/commit/7411e65b1e8d4e4c6da198590ad627bfe253173c\" rel=\"nofollow\">https://github.com/btcsuite/btcd/commit/7411e65b1e8d4e4c6da198590ad627bfe253173c</a>. From the commit message:</p>\n\n<blockquote>\n  <p>This commit unexports the Stack type since it is only intended to be\n  used internally during script execution.  Further, the engine exposes\n  the {G,S}etStack and {G,S}etAltStack functions which return the items\n  as a slice of byte slices ([][]byte) for caller access while stepping.</p>\n</blockquote>\n\n<p>I believe you're correct that you (outside the package) cannot make use of this struct. It's used purely inside the package implementation.</p>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 22, "last_activity_date": 1466611548, "last_edit_date": 1466611548, "creation_date": 1466536522, "answer_id": 37952786, "question_id": 37952354, "link": "https://stackoverflow.com/questions/37952354/golang-public-method-to-private-struct-is-this-have-any-use-case/37952786#37952786", "title": "golang public method to private struct - is this have any use case", "body": "<p>So, the major use case for this is that you can return an unexported type from a package function.  Any exported methods can then be used on this type, even though other packages can't actually create the type in the first place (except for receiving it as a return value from your package).</p>\n\n<pre><code>package foobar\n\ntype foo struct {}\nfunc (f foo) Bar() {}\nfunc Newfoo() foo {\n    return foo{}\n}\n----\npackage main\nfunc main() {\n    f := foobar.Newfoo()\n    f.Bar()\n\n    foobar.NewFoo().Bar()\n}\n</code></pre>\n\n<p>The other major use case is in package-level interfaces.  I tend to use a fairly standard pattern wherein a package defines an exported interface, like this:</p>\n\n<pre><code>type Doer interface {\n    Do()\n}\n</code></pre>\n\n<p>And then defines some private type(s) that fulfills that interface:</p>\n\n<pre><code>type stringDoer struct {}\n\nfunc (s *stringDoer) Do() {}\n\nfunc NewStringDoer() Doer {\n    return &amp;stringDoer{}\n}\n</code></pre>\n\n<p>That way external packages can use my types as interfaces without having to mess around with concrete types, and since the exposed data types of my package are entirely interfaces, it makes mocking or stubbing calls to my package (example, for testing) incredibly easy.</p>\n\n<p>For this type of system to work, the methods on the struct (in this case, <code>stringDoer</code>) must be exported, even if the struct itself isn't.</p>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8988, "favorite_count": 3, "accepted_answer_id": 37952786, "answer_count": 2, "score": 7, "last_activity_date": 1567043244, "creation_date": 1466535016, "last_edit_date": 1567043244, "question_id": 37952354, "link": "https://stackoverflow.com/questions/37952354/golang-public-method-to-private-struct-is-this-have-any-use-case", "title": "golang public method to private struct - is this have any use case", "body": "<p>I am new to go. I noticed in some libraries there are public methods to a private struct. See for example <a href=\"https://github.com/btcsuite/btcd/blob/master/txscript/stack.go\" rel=\"noreferrer\">https://github.com/btcsuite/btcd/blob/master/txscript/stack.go</a></p>\n\n<p>Does this have a real use case? I cannot picture how I will be able to use public methods, if I cannot access the structure they belong too.</p>\n\n<p>As the following question - is there any way to overcome the private declaration of a struct? For example, I would like to use the structure stack from the pointed file in my package.</p>\n"}, {"tags": ["database", "postgresql", "go", "schema", "updates"], "comments": [{"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1466534797, "post_id": 37952239, "comment_id": 63353079, "body": "I guess you mean update like insert/update rows .... So you can use a trigger and dblink, to connect to a log database, and Insert DatabaseName and Time`. That way you only have to chek log db to see who was the last to update. Now if you mean alter tables that may be different."}, {"owner": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "reply_to_user": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1466542253, "post_id": 37952239, "comment_id": 63357103, "body": "this can be done using golang?"}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1466542617, "post_id": 37952239, "comment_id": 63357283, "body": "This can be done in postgresql. Golang shouldnt be relevant"}, {"owner": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "reply_to_user": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1466545032, "post_id": 37952239, "comment_id": 63358342, "body": "My entire thing is done in golang only.. So i want to do in golang"}, {"owner": {"reputation": 44067, "user_id": 3470178, "user_type": "registered", "accept_rate": 63, "profile_image": "https://graph.facebook.com/655943089/picture?type=large", "display_name": "Juan Carlos Oropeza", "link": "https://stackoverflow.com/users/3470178/juan-carlos-oropeza"}, "edited": false, "score": 0, "creation_date": 1466545300, "post_id": 37952239, "comment_id": 63358454, "body": "So why you use postgresql in your title and tags?"}, {"owner": {"reputation": 4751, "user_id": 4491066, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-42QbCgAf1fE/AAAAAAAAAAI/AAAAAAAAACo/OfrkBcjQpbQ/photo.jpg?sz=128", "display_name": "Adam", "link": "https://stackoverflow.com/users/4491066/adam"}, "edited": false, "score": 0, "creation_date": 1466547478, "post_id": 37952239, "comment_id": 63359251, "body": "You can try <code>SELECT datlastsysoid FROM pg_database;</code> to get the last system OID in each database. That would be OK for <code>INSERT</code>s but I think not for <code>UPDATE</code>s and <code>DELETE</code>s."}], "owner": {"reputation": 526, "user_id": 5397795, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/898232106936756/picture?type=large", "display_name": "Dharani Dharan", "link": "https://stackoverflow.com/users/5397795/dharani-dharan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 61, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466534966, "creation_date": 1466534623, "last_edit_date": 1466534966, "question_id": 37952239, "link": "https://stackoverflow.com/questions/37952239/postgres-go-how-to-find-last-updated-database-in-postgres", "title": "Postgres - go - how to find last updated database in Postgres?", "body": "<p>I am having more than 100 database. Each database contains some tables. After performing some operation tables in database got updated. Currently am running a thread which will connect each database and check whether any updation is done or not. Its working fine now. But my need is if am having approximately 300 database and last update will occur in some database only. In this case i dont want connect all database and check. How can i done this. I want some efficient way to do this???</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1954, "user_id": 4746361, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365515b57884ad8e8ad13e1050981839?s=128&d=identicon&r=PG&f=1", "display_name": "william.taylor.09", "link": "https://stackoverflow.com/users/4746361/william-taylor-09"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466530625, "post_id": 37950951, "comment_id": 63350681, "body": "@JimB you always beat me to it :)"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1466530819, "post_id": 37950951, "comment_id": 63350779, "body": "I don&#39;t think this is actually a duplicate, because the answers differ.  The linked question is about accepting two types with the same method (answer: use an interface).  This OP seems to be asking how to take a single implementation and have it apply to multiple structures, which would require embedding."}, {"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466530894, "post_id": 37950951, "comment_id": 63350821, "body": "@JimB I just looked into that answer. The issue here is, I want to keep the code common and access the variable within the structure. For e.g. &quot;t.ID&quot;. I don&#39;t see how that can be done with interfaces!"}, {"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1466530975, "post_id": 37950951, "comment_id": 63350876, "body": "@Hugo you need a BaseT struct that has an ID string and a GetID() string method.  Look for embedding."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1466531102, "post_id": 37950951, "comment_id": 63350951, "body": "Example of that embedding: <a href=\"https://play.golang.org/p/SHayk46PVP\" rel=\"nofollow noreferrer\">play.golang.org/p/SHayk46PVP</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466531145, "post_id": 37950951, "comment_id": 63350975, "body": "@Hugo: that&#39;s why I didn&#39;t mark it right away until you agreed ;) Are you just trying to factor out the <code>GetID()</code> method and the <code>ID</code> field?"}, {"owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466533774, "post_id": 37950951, "comment_id": 63352411, "body": "@JimB yea, my bad :). I was too fast to first think I got the answer. I have quite a few functions which are very similar between these two structures. I will play with embedded structs and see, before I confirm. One issue is, the location of the ID field are different in these two structures. Let me check."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1466535796, "post_id": 37950951, "comment_id": 63353733, "body": "In the embedded version, the location is the same for both.  It can be accessed as <code>t1.ID</code> and <code>t2.ID</code>, or if you want to be explicit, <code>t1.Common.ID</code> and <code>t2.Common.ID</code> (this is only necessary if you need to disambiguate the field from another in the structure).  In the printf, is shows it as a substructure (which is what it actually is), but embedding &quot;promotes&quot; all fields and methods of the embedded structure to available on the parent structure.  Some references: <a href=\"http://www.hydrogen18.com/blog/golang-embedding.html\" rel=\"nofollow noreferrer\">hydrogen18.com/blog/golang-embedding.html</a>, <a href=\"https://www.goinggo.net/2014/05/methods-interfaces-and-embedded-types.html\" rel=\"nofollow noreferrer\">goinggo.net/2014/05/methods-interfaces-and-embedded-types.ht&zwnj;&#8203;ml</a>"}], "owner": {"reputation": 244, "user_id": 6134918, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4dd3c3e4c2313fe66cc45a8b1e5c8e96?s=128&d=identicon&r=PG&f=1", "display_name": "Hugo", "link": "https://stackoverflow.com/users/6134918/hugo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1466531199, "creation_date": 1466530401, "last_edit_date": 1466531006, "question_id": 37950951, "link": "https://stackoverflow.com/questions/37950951/same-functions-different-structures", "title": "Same functions different structures", "body": "<p>I have two separate packages, in which the struct implements the same functions. In fact, most of the function's code are also identical For e.g.</p>\n\n<pre><code>package #1\n\ntype T1 struct {\n  Message string\n  ID string\n}\n\nfunc (t *T1) GetID() {\n   return t.ID\n}\n\nfunc (t *T1) GetRedisID() {\n   return \"t1\" // hardcoded\n}\n\npackage #2\n\ntype T2 struct {\n  ClassName   string\n  ID string\n}\n\nfunc (t *T2) GetID() {\n   return t.ID\n}\n\nfunc (t *T2) GetRedisID() {\n   return \"t2\" // hardcoded\n}\n</code></pre>\n\n<p>I would like to keep the functions common between these two packages. What would be the options to do this in Go.</p>\n\n<p>I cannot use interfaces here, because I want to access the variables also within the structure and keep the function common. I do not want to reimplement the function in both the files.</p>\n"}, {"tags": ["go", "concurrency", "delve"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466523081, "post_id": 37948574, "comment_id": 63346156, "body": "For starters, always put the <code>wg.Add(1)</code> right before the <code>go </code> call, and <code>defer wg.Done()</code>. This way each add is local to the function so you don&#39;t need to keep an accurate count, and the defer ensures Done is always called correctly."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466523355, "post_id": 37948574, "comment_id": 63346345, "body": "When I do that, the moment one is done, it hits the wg.Wait which is now 0, then closes the channel, then I get a panic for sending on a closed channel. Code:      <code>go func() { \t\t\twg.Add(1) \t\t\tdefer wg.Done() \t\t\titems := &lt;-itemsChan \t\t\tfor _, val := range items { \t\t\t\te := dB.CheckIfItemPurchased(val.ItemID) \t\t\t\tif e != nil { \t\t\t\t\tlogCtx.WithFields(log.Fields{ \t\t\t\t\t\t&quot;itemID&quot;:     val.ItemID, \t\t\t\t\t\t&quot;_timestamp&quot;: time.Now(), \t\t\t\t\t}).Error(e.Error()) \t\t\t\t\terrsChan &lt;- errItemsPurchased \t\t\t\t\titemsChan &lt;- items \t\t\t\t\treturn \t\t\t\t} \t\t\t} \t\t\terrsChan &lt;- nil \t\t\titemsChan &lt;- items \t\t}()</code>"}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466523496, "post_id": 37948574, "comment_id": 63346443, "body": "I see I misread your comment and put it right after instead of right before. Testing it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466523593, "post_id": 37948574, "comment_id": 63346523, "body": "(not saying that&#39;s the solution, but using good style makes avoiding bugs easier)"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1466523633, "post_id": 37948574, "comment_id": 63346554, "body": "If it&#39;s stopping after one a single one finishes, you&#39;re not adding enough <code>wg.Add(1)</code> calls.   You want to have one immediately preceding <i>each</i> <code>go func()</code> call (so, in this case, 6 total).  Oh, and it needs to be before the <code>go func()</code>, not within the enclosure, as there&#39;s no guarantee that the <code>wg.Add(1)</code> in the goroutine will run before <code>wg.Wait()</code> gets unblocked by another <code>wg.Done()</code>.  If you add it in the main routine, before the <code>go func()</code>, it&#39;s guaranteed to run first."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1466523701, "post_id": 37948574, "comment_id": 63346609, "body": "Also, is the <code>wg.Wait()</code> blocking indefinitely?  If it isn&#39;t, the <code>wg.Done()</code> calls are being run.  Your debugger may just not be indicating those lines as being run properly."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1466523717, "post_id": 37948574, "comment_id": 63346619, "body": "Right, I had one AFTER the start of each one - misread your comment, so it was jumbled. I&#39;ve now placed a wg.Wait(1) before each go call and then deferred a wg.close. It&#39;s not working yet - it just hangs. Debugging to find out where."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1466523769, "post_id": 37948574, "comment_id": 63346658, "body": "I think wg.Wait() blocks until the waitgroup is zero. Correct? So if all the deferred wg.Done() calls are done after I add the wg.Wait(1)&#39;s, it should unblock, close the channel, and check errors."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1466523781, "post_id": 37948574, "comment_id": 63346671, "body": "Did you add <code>wg.Add(1)</code> or <code>wg.Wait()</code>?  <code>wg.Wait()</code> will just block, which is bad in this case."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1466523840, "post_id": 37948574, "comment_id": 63346702, "body": "I have a wg.Wait() after all of the go functions just before closing the channel and checking errors. Currently: <a href=\"http://pastebin.com/WbuKmPTd\" rel=\"nofollow noreferrer\">pastebin.com/WbuKmPTd</a>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1466523841, "post_id": 37948574, "comment_id": 63346703, "body": "Yes, that&#39;s correct, <code>wg.Wait()</code> blocks until a number of <code>wg.Done()</code> calls are made to equal to the sum of your <code>wg.Add()</code> calls."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1466523892, "post_id": 37948574, "comment_id": 63346742, "body": "Ok, you should only have <code>wg.Wait()</code> in the main function.  Should have <code>wg.Add(1)</code> <i>before</i> each <code>go func()</code> line, and <code>defer wg.Done()</code> as the first line in each enclosure."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1466523951, "post_id": 37948574, "comment_id": 63346781, "body": "And you should only have <i>one</i> <code>wg.Wait()</code>, after all the go routines are started, as in the program in your OP.  It&#39;s rarely useful to have more than one."}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1466524000, "post_id": 37948574, "comment_id": 63346803, "body": "I only have one in the main (encompassing) function. I linked to a pastebin - it&#39;s as you say so far."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1466524229, "post_id": 37948574, "comment_id": 63346966, "body": "Yep, that pastebin looks correct.  I think your hangup is the for loop, which can put <code>len(items)</code> values onto <code>errsChan</code>, which the main routine won&#39;t read until <code>wg.Done()</code> is called enough times, causing a deadlock.  A closer routine might be in order: <a href=\"https://play.golang.org/p/VjYi6rxov5\" rel=\"nofollow noreferrer\">play.golang.org/p/VjYi6rxov5</a>"}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1466524361, "post_id": 37948574, "comment_id": 63347066, "body": "You&#39;re right - it&#39;s the for loop. Trying to fix it with your example. You can probably close the issue since you spotted it as well. Thanks for the help making this ugly code a little more idiomatic!"}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 4, "last_activity_date": 1466524582, "creation_date": 1466524582, "answer_id": 37949217, "question_id": 37948574, "link": "https://stackoverflow.com/questions/37948574/golang-waitgroup-done-being-skipped/37949217#37949217", "title": "Golang WaitGroup.Done() being skipped", "body": "<p>For the sake of posterity (and google searches):</p>\n\n<p>Put <code>wg.Add(1)</code> before each <code>go func()</code> line, instead of doing it in a single go with <code>wg.Add(gorutineCt)</code></p>\n\n<p>Put <code>defer wg.Done()</code> at the start of each goroutine enclosure, instead of calling <code>wg.Done()</code> in every exit case.  This ensures <code>wg.Done()</code> gets run regardless.</p>\n\n<p>Use a closer routine instead of trying to buffer a channel sufficiently:</p>\n\n<pre><code>// start other goroutines\n\ngo func () {\n    wg.Wait()\n    close(errschan)\n}\n\nfor _, err := range errsChan { // automatically terminates once chan is closed\n    if err != nil {\n         // handle err\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 695, "favorite_count": 0, "accepted_answer_id": 37949217, "answer_count": 1, "score": 0, "last_activity_date": 1466524582, "creation_date": 1466522817, "question_id": 37948574, "link": "https://stackoverflow.com/questions/37948574/golang-waitgroup-done-being-skipped", "title": "Golang WaitGroup.Done() being skipped", "body": "<p>I've got a function that relies on checking some errors concurrently and I'm trying to use waitgroups to wait until all processes that return possible errors are done before I check all the errors. </p>\n\n<p>It seems to be skipping some of the wg.Done() cals. Here's a youtube video of the debug (it loops through the 'for' loop 3 times, sorry):\n<a href=\"https://youtu.be/yRAWHGhDp-8\" rel=\"nofollow\">Golang Delve Debug for WaitGroups</a></p>\n\n<p>Any idea why it'd be skipping some of the waitgroup.Done() calls?</p>\n\n<p>Here's the code:</p>\n\n<pre><code>package controllers\n\nimport (\n    \"errors\"\n    \"mobilebid/billable\"\n    db \"mobilebid/database\"\n    \"mobilebid/stripe\"\n    \"net/http\"\n    \"os\"\n    \"strconv\"\n    \"sync\"\n    \"time\"\n\n    log \"github.com/Sirupsen/logrus\"\n    \"github.com/gorilla/mux\"\n)\n\nvar (\n    errBillableID     = errors.New(\"It looks like there was an error while getting your billable ID. Do you have a credit card set up?\")\n    errWinningItems   = errors.New(\"It looks like there was an error while gathering your winning items. Please contact an event rep.\")\n    errAcctInfo       = errors.New(\"We had some trouble getting the account information for the event. Please contact an event rep.\")\n    errLoggingTrans   = errors.New(\"It looks like we had some sort of issue while logging your transaction. Please contact an event rep.\")\n    errParsingURL     = errors.New(\"We had some issue looking at the URL.\")\n    errStripeIssue    = errors.New(\"It looks like there was some kind of issue while talking with Stripe. If you were in the middle of a transaction, this doesn't mean the transaction was cancelled. Take a look at your transactions and/or contact an event rep.\")\n    errItemsPurchased = errors.New(\"One or more of the items you're trying to purchase have already been purchased. If this doesn't sound right, please contact an event rep.\")\n)\n\nfunc createLogCtx(bidderID, eventID int) *log.Entry {\n    return log.WithFields(log.Fields{\n        \"bidderID\": bidderID,\n        \"eventID\":  eventID,\n    })\n}\n\nvar wg sync.WaitGroup\n\nconst gorutineCt = 6\n\n//PurchaseItems purchases items from the event for the bidder and sends the funds to the customer\n//  In order for PurchaseItems to work:\n//      1. Bidder must have a customer account set up in Stripe\n//      2. Event owner needs to have their Stripe registered with the apps Stripe account\n//      3. Item must not have been purchased before (ever)\nfunc PurchaseItems(dB db.AppDB) http.HandlerFunc {\n    return http.HandlerFunc(func(res http.ResponseWriter, req *http.Request) {\n\n        ps := mux.Vars(req)\n\n        eventID, err := strconv.Atoi(ps[\"eventID\"])\n        if err != nil {\n            log.Error(err.Error())\n            res.Write(ResErr(errParsingURL.Error()))\n            return\n        }\n\n        bidderID, err := strconv.Atoi(ps[\"bidderID\"])\n        if err != nil {\n            log.Error(err.Error())\n            res.Write(ResErr(errParsingURL.Error()))\n            return\n        }\n\n        itemsChan := make(chan []db.ItemWon)\n        billableBidderIDChan := make(chan string)\n        creditableAcctChan := make(chan string)\n        errsChan := make(chan error, gorutineCt)\n        wg.Add(gorutineCt)\n\n        logCtx := createLogCtx(bidderID, eventID)\n\n        acct := stripe.New(os.Getenv(\"SECRET_KEY\"), os.Getenv(\"PUBLISHABLE_KEY\"))\n\n        go func() {\n            id, e := dB.GetBidderBillableID(bidderID)\n            if e != nil {\n                logCtx.Error(e.Error())\n                errsChan &lt;- errBillableID\n                billableBidderIDChan &lt;- id\n            } else {\n                errsChan &lt;- nil\n                billableBidderIDChan &lt;- id\n            }\n            wg.Done()\n        }()\n\n        go func() {\n            i, e := dB.GetWinningItemsForBidder(bidderID, eventID)\n            if e != nil {\n                logCtx.Error(e.Error())\n                errsChan &lt;- errWinningItems\n                itemsChan &lt;- i\n            } else {\n                errsChan &lt;- nil\n                itemsChan &lt;- i\n            }\n            wg.Done()\n        }()\n\n        go func() {\n            a, e := dB.GetCreditableAccountFromEvent(eventID)\n            if e != nil {\n                logCtx.Error(e.Error())\n                errsChan &lt;- errAcctInfo\n                creditableAcctChan &lt;- a\n            } else {\n                errsChan &lt;- nil\n                creditableAcctChan &lt;- a\n            }\n            wg.Done()\n        }()\n\n        go func() {\n            items := &lt;-itemsChan\n            for _, val := range items {\n                e := dB.CheckIfItemPurchased(val.ItemID)\n                if e != nil {\n                    logCtx.WithFields(log.Fields{\n                        \"itemID\":     val.ItemID,\n                        \"_timestamp\": time.Now(),\n                    }).Error(e.Error())\n                    errsChan &lt;- errItemsPurchased\n                    itemsChan &lt;- items\n                    wg.Done()\n                    return\n                }\n            }\n            errsChan &lt;- nil\n            itemsChan &lt;- items\n            wg.Done() //SKIPPED\n        }()\n\n        go func() {\n            billableBidderID := &lt;-billableBidderIDChan\n            e := acct.BuyerIsBillable(billableBidderID)\n            if e != nil {\n                logCtx.Error(e.Error())\n                errsChan &lt;- errStripeIssue\n                billableBidderIDChan &lt;- billableBidderID\n            } else {\n                errsChan &lt;- nil\n                billableBidderIDChan &lt;- billableBidderID\n            }\n            wg.Done()\n        }()\n\n        go func() {\n            creditableAcct := &lt;-creditableAcctChan\n            e := acct.CanReceiveFunds(creditableAcct)\n            if e != nil {\n                logCtx.Error(e.Error())\n                errsChan &lt;- errStripeIssue\n                creditableAcctChan &lt;- creditableAcct\n            } else {\n                errsChan &lt;- nil\n                creditableAcctChan &lt;- creditableAcct\n            }\n            wg.Done()\n        }()\n\n        wg.Wait()\n        close(errsChan)\n\n        if err = checkConcurrentErrs(errsChan); err != nil {\n            logCtx.Error(err.Error())\n            res.Write(ResErr(err.Error()))\n            return\n        }\n\n        items := &lt;-itemsChan\n        amount := addItems(items)\n        appFee := calculateFee(amount, .03) //TODO: Store this somewhere where it can be edited without having to restart the app.\n\n        invoice := billable.BillObject{\n            Desc:     \"Test Charge\", //TODO: Generate this description from the event, items and bidder somehow.\n            Amount:   amount,\n            Currency: \"usd\",\n            Dest:     &lt;-creditableAcctChan,\n            Fee:      appFee,\n            Meta:     createItemsList(items),\n            Customer: &lt;-billableBidderIDChan,\n        }\n\n        trans, err := acct.ChargeBidder(invoice)\n        if err != nil {\n            logCtx.Error(err.Error())\n            res.Write(ResErr(errStripeIssue.Error()))\n            return\n        }\n\n        logCtx.WithFields(log.Fields{\n            \"stripeTransID\": trans.TransID,\n            \"itemcCount\":    len(items),\n        }).Info(\"Transferred funds from bidder to client\")\n\n        dbTrans := db.Transaction{\n            TransID:  trans.TransID,\n            UserID:   5,\n            BidderID: bidderID,\n            EventID:  eventID,\n            Amount:   int64(amount),\n            AppFee:   int64(appFee),\n            Desc:     \"Some test order\",\n            Status:   \"completed\",\n        }\n\n        orderID, err := dB.InsertTransaction(dbTrans)\n        if err != nil {\n            logCtx.WithFields(log.Fields{\n                \"stripeTransID\": dbTrans.TransID,\n                \"_timestamp\":    time.Now(),\n            }).Error(err.Error())\n            res.Write(ResErr(errLoggingTrans.Error()))\n            return\n        }\n\n        for it, val := range items {\n            i := db.TransactionLine{\n                OrderID: orderID,\n                ItemID:  val.ItemID,\n                Amount:  uint64(val.Bid * 100), //Must do this since the bid is in dollars but the amount is pennies\n                Line:    it,\n            }\n\n            err := dB.InsertTransactionLine(i)\n            if err != nil {\n                logCtx.WithFields(log.Fields{\n                    \"stripeTransID\": dbTrans.TransID,\n                    \"lineNumber\":    i,\n                    \"_timestamp\":    time.Now(),\n                }).Error(err.Error())\n                res.Write(ResErr(errLoggingTrans.Error()))\n                return\n            }\n        }\n\n        logCtx.WithField(\"orderID\", orderID).Info(\"Order created\")\n\n        //TODO: Send receipt to buyer.\n        res.Write(ResOK(trans.TransID))\n\n    })\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1466521211, "post_id": 37947934, "comment_id": 63344691, "body": "Have you walked through the <a href=\"https://tour.golang.org/welcome/1\" rel=\"nofollow noreferrer\">Tour Of Go</a>?"}, {"owner": {"reputation": 5715, "user_id": 1607051, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ef0c4b01b5f2b7c1f742d734140b26ea?s=128&d=identicon&r=PG", "display_name": "lulyon", "link": "https://stackoverflow.com/users/1607051/lulyon"}, "edited": false, "score": 0, "creation_date": 1466521767, "post_id": 37947934, "comment_id": 63345161, "body": "What are the input/output values? i and j?"}, {"owner": {"reputation": 43, "user_id": 4208576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12a6195f71817b4add6fb0208772c188?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe", "link": "https://stackoverflow.com/users/4208576/chloe"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466524300, "post_id": 37947934, "comment_id": 63347027, "body": "Thanks @JimB, found the answer in Tour of Go."}], "answers": [{"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 3, "last_activity_date": 1466525075, "creation_date": 1466525075, "answer_id": 37949392, "question_id": 37947934, "link": "https://stackoverflow.com/questions/37947934/what-are-the-components-of-this-golang-function-declaration/37949392#37949392", "title": "What are the components of this Golang Function Declaration?", "body": "<p>In the declaration <code>func (r Thing) Name(variable aType) otherType</code>, the various things are (in order):</p>\n\n<ul>\n<li><code>func</code> is the \"this is a function\" keyword</li>\n<li><code>(r Thing)</code> indicates \"this is a method on the type <code>Thing</code>, the value the method is invoked on will be in the variable <code>r</code>\" (normal functions do not have a receiver; methods always have exactly one receiver).</li>\n<li><code>Name</code> is the name of the method</li>\n<li><code>(variable aType)</code> is an argument list, in this case a single argument, of the type <code>aType</code>. It is perfectly valid to have zero arguments to a method.</li>\n<li><code>otherType</code> is the return type, this can be omitted, if no useful return value exists.</li>\n</ul>\n"}], "owner": {"reputation": 43, "user_id": 4208576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/12a6195f71817b4add6fb0208772c188?s=128&d=identicon&r=PG&f=1", "display_name": "Chloe", "link": "https://stackoverflow.com/users/4208576/chloe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 136, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1466525075, "creation_date": 1466521131, "question_id": 37947934, "link": "https://stackoverflow.com/questions/37947934/what-are-the-components-of-this-golang-function-declaration", "title": "What are the components of this Golang Function Declaration?", "body": "<p>I'm confused by the structure of the following Golang code:</p>\n\n<pre><code>type Team []*athlete\n\nfunc (s Team) Len() int {\n    //some code here\n}\n\nfunc (s Team) Swap(i, j int) {\n    s[i], s[j] = s[j], s[i]\n}\n</code></pre>\n\n<p>I'm new to go and not familiar with this function declaration structure. What are the input/output values? Apologies for what I'm sure is a naive question. Tried to google, referenced my Go book, and still confused.</p>\n"}, {"tags": ["go", "github-api"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 1, "creation_date": 1466516736, "post_id": 37946004, "comment_id": 63340975, "body": "The comment for the method youre linking to (List user repositories) says: &quot;List <b>public</b> repositories for the specified user&quot; (my emphasis). So the &quot;some repositories are not fetched&quot; is probably because those arent public."}, {"owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1466516941, "post_id": 37946004, "comment_id": 63341166, "body": "Hi I&#39;ve updated the link, I am using &quot;(*RepositoriesService).List(user string, opt *RepositoryListOptions) ([]Repository, *Response, error) &quot; method to get the repos."}, {"owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1466517109, "post_id": 37946004, "comment_id": 63341306, "body": "and also please note that I&#39;m able to get private repos, the only problem is it is not returning complete list."}, {"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1466519466, "post_id": 37946004, "comment_id": 63343258, "body": "Have you tried setting the <code>PerPage</code> attribute of the <code>ListOptions</code> value?"}, {"owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "reply_to_user": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1466527961, "post_id": 37946004, "comment_id": 63349220, "body": "@robbrit thanks a lot man it worked...thanx again :)"}], "answers": [{"tags": [], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1466578170, "creation_date": 1466578170, "answer_id": 37960515, "question_id": 37946004, "link": "https://stackoverflow.com/questions/37946004/not-able-to-get-all-repositories-through-github-api/37960515#37960515", "title": "Not able to get all repositories through github API", "body": "<p>As pointed out by robbrit to get all repos we have to use PerPage option, because by default only 30 repos are returned. That solved my problem.</p>\n"}, {"tags": [], "owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "is_accepted": true, "score": 1, "last_activity_date": 1466619339, "creation_date": 1466619339, "answer_id": 37975485, "question_id": 37946004, "link": "https://stackoverflow.com/questions/37946004/not-able-to-get-all-repositories-through-github-api/37975485#37975485", "title": "Not able to get all repositories through github API", "body": "<p>By default all the commands that accept a <code>ListOptions</code> argument have a <code>PerPage</code> attribute. In order to get all the data, you'll have to iterate through the pages using the <code>Page</code> attribute until the number of results you get is less than <code>PerPage</code>.</p>\n\n<p>In Go-ish pseudo-code, it'd look like this:</p>\n\n<pre><code>totalResults := []Result{}\nfor page := 0; ; page++ {\n  results := fetch current page\n  totalResults = append(totalResults, results)\n  if len(results) &lt; per page {\n    break\n  }\n} \n</code></pre>\n\n<p>You can see the <code>ListOptions</code> struct defined <a href=\"https://github.com/google/go-github/blob/5c1b3a05b41ae630de925007cd8f3e52909d1dbb/github/github.go#L130\" rel=\"nofollow\">here</a>.</p>\n"}], "owner": {"reputation": 632, "user_id": 5791180, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/C6dJs.jpg?s=128&g=1", "display_name": "Yash Srivastava", "link": "https://stackoverflow.com/users/5791180/yash-srivastava"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 125, "favorite_count": 0, "accepted_answer_id": 37975485, "answer_count": 2, "score": 0, "last_activity_date": 1466619339, "creation_date": 1466516180, "last_edit_date": 1466516867, "question_id": 37946004, "link": "https://stackoverflow.com/questions/37946004/not-able-to-get-all-repositories-through-github-api", "title": "Not able to get all repositories through github API", "body": "<p>I want to allow the users to signup using github account, and display all his/her private and public repositories. I am able to get the token from github and get the repositories (both public and private), but the only problem is that it is not returning all repositories (i.e. some repositories are not fetched).</p>\n\n<p>I am using golang for server side implementation.\nUsing <a href=\"https://sourcegraph.com/github.com/google/go-github/-/info/GoPackage/github.com/google/go-github/github/-/RepositoriesService/List\" rel=\"nofollow\">this</a> method to get repositories.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1466511848, "post_id": 37943592, "comment_id": 63337137, "body": "Basically I want a function that returns a channel which reads from multiple processes (represented above by the two for loops). I want to wait for both of them to finish before closing the communication channel (<code>ch</code>). Taking your advice I added a big enough buffer to the channel and now it appears the issue is that even though wg.Wait() is in defer, it&#39;s preventing function from return back to main&#39;s execution. I&#39;ll update the question with these comments."}], "tags": [], "owner": {"reputation": 704, "user_id": 3536948, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/50341f59bb4c3c845eb159056357aaf0?s=128&d=identicon&r=PG&f=1", "display_name": "poopoothegorilla", "link": "https://stackoverflow.com/users/3536948/poopoothegorilla"}, "is_accepted": false, "score": 1, "last_activity_date": 1466509711, "creation_date": 1466509711, "answer_id": 37943592, "question_id": 37943036, "link": "https://stackoverflow.com/questions/37943036/waiting-on-sync-waitgroup-in-defer/37943592#37943592", "title": "Waiting on sync.Waitgroup in defer", "body": "<p>It looks like your channels are blocking since you are not using any buffered channels. check out this quick example <a href=\"https://play.golang.org/p/zMnfA33qZk\" rel=\"nofollow\">https://play.golang.org/p/zMnfA33qZk</a></p>\n\n<p><code>ch := make(chan int, n)</code></p>\n\n<p>Remember that channels block when they are filled. I am not sure what your goal is with your code, but it looks like you were aiming for using a buffered channel. This is a good piece from effective go <a href=\"https://golang.org/doc/effective_go.html#channels\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#channels</a></p>\n\n<blockquote>\n  <p>Receivers always block until there is data to receive. If the channel is unbuffered, the sender blocks until the receiver has received the value. If the channel has a buffer, the sender blocks only until the value has been copied to the buffer; if the buffer is full, this means waiting until some receiver has retrieved a value.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1466512182, "post_id": 37944279, "comment_id": 63337389, "body": "Perfect. Thanks a lot."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1466522756, "post_id": 37944279, "comment_id": 63345900, "body": "An alternative that I use heavily myself: <a href=\"https://play.golang.org/p/RjsB3-EOQI\" rel=\"nofollow noreferrer\">play.golang.org/p/RjsB3-EOQI</a>.  That uses a &quot;closer&quot; routine that blocks and closes, rather like you expect your deferred function to work, but is a separate goroutine."}], "tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 7, "last_activity_date": 1466511632, "creation_date": 1466511632, "answer_id": 37944279, "question_id": 37943036, "link": "https://stackoverflow.com/questions/37943036/waiting-on-sync-waitgroup-in-defer/37944279#37944279", "title": "Waiting on sync.Waitgroup in defer", "body": "<p>I think the mistake you're making is that you think that the <code>deferred</code> function will run asynchronously too. But that is not the case, so the <code>getCh()</code> will block in its deferred part, waiting for the WaitGroup. But as there is no one reading from the channel, the goroutines which write into it can't return and thus the WaitGroup causes deadlock. Try something like this:</p>\n\n<pre><code>func getCh(n int) &lt;-chan int {\n    ch := make(chan int)\n    go func() {\n        var wg sync.WaitGroup\n        wg.Add(1)\n        go func(n int) {\n            defer wg.Done()\n            for i := 0; i &lt; n; i++ {\n                ch &lt;- i\n            }\n        }(n)\n        wg.Add(1)\n        go func(n int) {\n            defer wg.Done()\n            for i := n; i &gt; 0; i-- {\n                ch &lt;- i\n            }\n        }(n)\n        wg.Wait()\n        fmt.Println(\"closing\")\n        close(ch)\n    }()\n\n    return ch\n}\n</code></pre>\n"}], "owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2801, "favorite_count": 1, "accepted_answer_id": 37944279, "answer_count": 2, "score": 3, "last_activity_date": 1466512444, "creation_date": 1466508083, "last_edit_date": 1466509004, "question_id": 37943036, "link": "https://stackoverflow.com/questions/37943036/waiting-on-sync-waitgroup-in-defer", "title": "Waiting on sync.Waitgroup in defer", "body": "<p>I have the following code that goes into deadlock when sending on channel from a goroutine below:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc main() {\n    for a := range getCh(10) {\n        fmt.Println(\"Got:\", a)\n    }\n}\n\nfunc getCh(n int) &lt;-chan int {\n    var wg sync.WaitGroup\n    ch := make(chan int)\n    defer func() {\n        fmt.Println(\"closing\")\n        wg.Wait()\n        close(ch)\n    }()\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        for i := 0; i &lt; n; i++ {\n            ch &lt;- i\n        }\n    }()\n    wg.Add(1)\n    go func() {\n        defer wg.Done()\n        for i := n; i &lt; 0; i-- {\n            ch &lt;- i\n        }\n    }()\n\n    return ch\n}\n</code></pre>\n\n<p>I know that it is legal to use <code>wg.Wait()</code> in <code>defer</code>. But I haven't been able to find a use in a function with channel as a return value.</p>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 1, "creation_date": 1466506588, "post_id": 37942285, "comment_id": 63333662, "body": "Pretty hard to know what&#39;s wrong since the repository is not publicly readable, so any attempt to debug would be a guess at best."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "reply_to_user": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1466507639, "post_id": 37942285, "comment_id": 63334363, "body": "What it is trying to do <code>open &#47;var&#47;folders&#47;lp&#47;3q9_2mn51hd9s4yj_jcf3jxm0000gp&#47;T&#47;go-build823&zwnj;&#8203;644730&#47;github.com&#47;ja&zwnj;&#8203;bong&#47;florest&#47;src&#47;com&zwnj;&#8203;mon&#47;config.a</code>? I have not specified this folder structure neither in <code>GOROOT</code> or <code>GOPATH</code>"}, {"owner": {"reputation": 18509, "user_id": 939410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb161e6bf2e1dded07d3fd921f487334?s=128&d=identicon&r=PG", "display_name": "Art", "link": "https://stackoverflow.com/users/939410/art"}, "edited": false, "score": 0, "creation_date": 1466512613, "post_id": 37942285, "comment_id": 63337710, "body": "It&#39;s a temporary file."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466514138, "post_id": 37942285, "comment_id": 63338827, "body": "Use the <code>-x</code> flag and see if any of the intermediate commands have any useful output."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1466522074, "post_id": 37942285, "comment_id": 63345386, "body": "I have updated the question with the output of <code>-x</code> flag."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466525114, "post_id": 37942285, "comment_id": 63347540, "body": "It looks like it&#39;s working and created <code>&#47;Users&#47;debraj&#47;golang&#47;bin&#47;florest</code>."}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1466527119, "post_id": 37942285, "comment_id": 63348770, "body": "All <code>go install</code> is failing <code>go install github.com&#47;jabong&#47;florest&#47;src&#47;service: open &#47;var&#47;folders&#47;lp&#47;3q9_2mn51hd9s4yj_jcf3jxm0000gp&#47;T&#47;go-build665&zwnj;&#8203;863426&#47;github.com&#47;ja&zwnj;&#8203;bong&#47;florest&#47;src&#47;ser&zwnj;&#8203;vice.a: no such file or directory</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466528356, "post_id": 37942285, "comment_id": 63349455, "body": "The compiled artifacts are missing for some reason. Are you out of disk space? Do you have some security software interfering with compilation? You can try using the <code>-work</code> option to leave the temp directory and inspect the permissions (though I assume that would error on file creation, rather than just leave them missing)"}, {"owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "edited": false, "score": 0, "creation_date": 1466529066, "post_id": 37942285, "comment_id": 63349844, "body": "I don;t see any folder with name <code>go-build*</code> inside <code>&#47;var&#47;folders&#47;lp&#47;3q9_2mn51hd9s4yj_jcf3jxm0000gp&#47;T</code>."}], "answers": [{"tags": [], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "is_accepted": true, "score": 0, "last_activity_date": 1466580732, "creation_date": 1466580732, "answer_id": 37961379, "question_id": 37942285, "link": "https://stackoverflow.com/questions/37942285/go-get-failing-in-mac-os-x-while-trying-to-do-go-install/37961379#37961379", "title": "go get failing in Mac OS X while trying to do go install", "body": "<p>The issue was found after discussing in <a href=\"https://groups.google.com/forum/#!searchin/golang-nuts/go$20get$20failing$20on$20mac/golang-nuts/EH1975DJMz8/VD45mbVWAQAJ\" rel=\"nofollow\">golang-nuts</a>. Just quoting it below again:-</p>\n\n<blockquote>\n  <p>My guess is that's because Mac filesystem is case preserving but not\n  case-sensitive, meaning that in mac os \"floRest\" and \"florest\" is the\n  same file/directory while on linux those are 2 distinct files. (you\n  can configure mac filesystem to be case-sensitive as well, but that's\n  not the default).</p>\n  \n  <p>As you can see in the logs:</p>\n  \n  <p>mv $WORK/github.com/jabong/floRest/src/examples.a\n  /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/floRest/src/examples.a</p>\n  \n  <p>mkdir -p\n  /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/</p>\n  \n  <p>cp $WORK/github.com/jabong/florest/src/examples.a\n  /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/examples.a</p>\n  \n  <p>go install github.com/jabong/florest/src/examples: open\n  /var/folders/lp/3q9_2mn51hd9s4yj_jcf3jxm0000gp/T/go-build665863426/github.com/jabong/florest/src/examples.a:\n  no such file or directory</p>\n  \n  <p>a file \"floRest/src/examples.a\" is moved and then there's an attempt\n  to copy \"florest/src/examples.a\", which is the same file on mac os,\n  and it's no longer there.</p>\n</blockquote>\n\n<p>For cloning the repo I used:-</p>\n\n<pre><code>git clone https://github.com/jabong/florest/\n</code></pre>\n\n<p>So in mac my code checked out in a directory <code>florest</code>. But the actual repo name was <code>https://github.com/jabong/floRest/</code> and in code it was referenced as <code>floRest</code> which was causing the issue.</p>\n"}], "owner": {"reputation": 4123, "user_id": 785523, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/b51864374e248ee87686628bc8528677?s=128&d=identicon&r=PG", "display_name": "tuk", "link": "https://stackoverflow.com/users/785523/tuk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 37961379, "answer_count": 1, "score": 0, "last_activity_date": 1466580732, "creation_date": 1466505887, "last_edit_date": 1466522042, "question_id": 37942285, "link": "https://stackoverflow.com/questions/37942285/go-get-failing-in-mac-os-x-while-trying-to-do-go-install", "title": "go get failing in Mac OS X while trying to do go install", "body": "<p>On Mac OS X while trying to do do <code>go get</code> by executing the command below. It is failing with the below error:-</p>\n\n<pre><code>jabongs-MacBook-Pro-4:florest debraj$ go get ./...\ngo install github.com/jabong/florest/src/common/config: open /var/folders/lp/3q9_2mn51hd9s4yj_jcf3jxm0000gp/T/go-build823644730/github.com/jabong/florest/src/common/config.a: no such file or directory\ngo install github.com/jabong/florest/src/common/utils/responseheaders: open /var/folders/lp/3q9_2mn51hd9s4yj_jcf3jxm0000gp/T/go-build823644730/github.com/jabong/florest/src/common/utils/responseheaders.a: no such file or directory\ngo install github.com/jabong/florest/src/service: open /var/folders/lp/3q9_2mn51hd9s4yj_jcf3jxm0000gp/T/go-build823644730/github.com/jabong/florest/src/service.a: no such file or directory\n</code></pre>\n\n<p>Below is the output using <code>-x</code> flag:-</p>\n\n<pre><code>jabongs-MacBook-Pro-4:florest debraj$ go get -x ./...\nWORK=/var/folders/lp/3q9_2mn51hd9s4yj_jcf3jxm0000gp/T/go-build665863426\nmkdir -p $WORK/github.com/jabong/floRest/src/examples/_obj/\nmkdir -p $WORK/github.com/jabong/floRest/src/\ncd /Users/debraj/golang/src/github.com/jabong/floRest/src/examples\n/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/jabong/floRest/src/examples.a -trimpath $WORK -p github.com/jabong/floRest/src/examples -complete -buildid febe48d3c570d8539844891977fbdc206dc458b4 -D _/Users/debraj/golang/src/github.com/jabong/floRest/src/examples -I $WORK -I /Users/debraj/golang/pkg/darwin_amd64 -pack ./api_definition.go ./data_structures.go ./hello_world.go ./hello_world_health_checker.go ./hello_world_multipe_errors.go ./swagger.go\nmkdir -p $WORK/github.com/jabong/floRest/src/service/_obj/\nmkdir -p $WORK/github.com/jabong/florest/src/examples/_obj/\nmkdir -p $WORK/github.com/jabong/florest/src/\ncd /Users/debraj/golang/src/github.com/jabong/floRest/src/service\n/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/jabong/floRest/src/service.a -trimpath $WORK -p github.com/jabong/floRest/src/service -complete -buildid f55b565340e2d0d690f5de8bd424fffb8895a331 -D _/Users/debraj/golang/src/github.com/jabong/floRest/src/service -I $WORK -I /Users/debraj/golang/pkg/darwin_amd64 -pack ./api_interface.go ./business_logic_executor.go ./config_manager.go ./constants.go ./dynamic_config_manager.go ./health_checker.go ./http_response_creator.go ./init_manager.go ./monitor_helper.go ./service_register.go ./service_version_helper.go ./service_workflow_data.go ./uri_interpreter.go ./web_server.go\ncd /Users/debraj/golang/src/github.com/jabong/florest/src/examples\n/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/jabong/florest/src/examples.a -trimpath $WORK -p github.com/jabong/florest/src/examples -complete -buildid febe48d3c570d8539844891977fbdc206dc458b4 -D _/Users/debraj/golang/src/github.com/jabong/florest/src/examples -I $WORK -I /Users/debraj/golang/pkg/darwin_amd64 -pack ./api_definition.go ./data_structures.go ./hello_world.go ./hello_world_health_checker.go ./hello_world_multipe_errors.go ./swagger.go\nmkdir -p $WORK/github.com/jabong/florest/src/examples/cachestrategy/_obj/\nmkdir -p $WORK/github.com/jabong/florest/src/examples/\ncd /Users/debraj/golang/src/github.com/jabong/florest/src/examples/cachestrategy\n/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/jabong/florest/src/examples/cachestrategy.a -trimpath $WORK -p github.com/jabong/florest/src/examples/cachestrategy -complete -buildid c16efba4536c81f8b5b9f0090f909c0b3c71383c -D _/Users/debraj/golang/src/github.com/jabong/florest/src/examples/cachestrategy -I $WORK -I /Users/debraj/golang/pkg/darwin_amd64 -pack ./api_definition.go ./cache_strategy_user.go ./sample_db_adapter.go\nmkdir -p $WORK/github.com/jabong/florest/src/service/_obj/\ncd /Users/debraj/golang/src/github.com/jabong/florest/src/service\n/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/jabong/florest/src/service.a -trimpath $WORK -p github.com/jabong/florest/src/service -complete -buildid f55b565340e2d0d690f5de8bd424fffb8895a331 -D _/Users/debraj/golang/src/github.com/jabong/florest/src/service -I $WORK -I /Users/debraj/golang/pkg/darwin_amd64 -pack ./api_interface.go ./business_logic_executor.go ./config_manager.go ./constants.go ./dynamic_config_manager.go ./health_checker.go ./http_response_creator.go ./init_manager.go ./monitor_helper.go ./service_register.go ./service_version_helper.go ./service_workflow_data.go ./uri_interpreter.go ./web_server.go\nmkdir -p /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/floRest/src/\nmv $WORK/github.com/jabong/floRest/src/examples.a /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/floRest/src/examples.a\nmkdir -p /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/\ncp $WORK/github.com/jabong/florest/src/examples.a /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/examples.a\ngo install github.com/jabong/florest/src/examples: open /var/folders/lp/3q9_2mn51hd9s4yj_jcf3jxm0000gp/T/go-build665863426/github.com/jabong/florest/src/examples.a: no such file or directory\nmkdir -p /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/examples/\nmv $WORK/github.com/jabong/florest/src/examples/cachestrategy.a /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/examples/cachestrategy.a\nmv $WORK/github.com/jabong/floRest/src/service.a /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/floRest/src/service.a\nmkdir -p $WORK/github.com/jabong/florest/_obj/\nmkdir -p $WORK/github.com/jabong/florest/_obj/exe/\ncd /Users/debraj/golang/src/github.com/jabong/florest\n/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/jabong/florest.a -trimpath $WORK -p main -complete -buildid fb73c44c8d0536fc3134f24ae052fdb67036f537 -D _/Users/debraj/golang/src/github.com/jabong/florest -I $WORK -I /Users/debraj/golang/pkg/darwin_amd64 -pack ./main.go\nmkdir -p $WORK/github.com/jabong/florest/src/test/servicetest/_obj/\nmkdir -p $WORK/github.com/jabong/florest/src/test/\ncd /Users/debraj/golang/src/github.com/jabong/florest/src/test/servicetest\n/usr/local/go/pkg/tool/darwin_amd64/compile -o $WORK/github.com/jabong/florest/src/test/servicetest.a -trimpath $WORK -p github.com/jabong/florest/src/test/servicetest -complete -buildid 9936e7e44a8331913a166a228aa8e088d0b05adf -D _/Users/debraj/golang/src/github.com/jabong/florest/src/test/servicetest -I $WORK -I /Users/debraj/golang/pkg/darwin_amd64 -pack ./config_initialize.go ./logger_initialize.go ./service_initialize.go ./service_test_helper.go ./test_web_server.go\ncp $WORK/github.com/jabong/florest/src/service.a /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/service.a\ngo install github.com/jabong/florest/src/service: open /var/folders/lp/3q9_2mn51hd9s4yj_jcf3jxm0000gp/T/go-build665863426/github.com/jabong/florest/src/service.a: no such file or directory\ncd .\n/usr/local/go/pkg/tool/darwin_amd64/link -o $WORK/github.com/jabong/florest/_obj/exe/a.out -L $WORK -L /Users/debraj/golang/pkg/darwin_amd64 -extld=clang -buildmode=exe -buildid=fb73c44c8d0536fc3134f24ae052fdb67036f537 $WORK/github.com/jabong/florest.a\nmkdir -p /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/test/\nmv $WORK/github.com/jabong/florest/src/test/servicetest.a /Users/debraj/golang/pkg/darwin_amd64/github.com/jabong/florest/src/test/servicetest.a\nmkdir -p /Users/debraj/golang/bin/\nmv $WORK/github.com/jabong/florest/_obj/exe/a.out /Users/debraj/golang/bin/florest\n</code></pre>\n\n<p>Can someone let me know why this error is coming? This is working perfectly fine on Ubuntu.</p>\n\n<p>Version</p>\n\n<ul>\n<li>MacOS X - 10.11.4 </li>\n<li>GoLang - 1.6.1</li>\n</ul>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1466509078, "post_id": 37941843, "comment_id": 63335258, "body": "are you using something in front of revel app (like nginx) or is it running on 80 or 443 port?"}, {"owner": {"reputation": 376, "user_id": 480307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f5f40f777b401da8cda1573946822e4?s=128&d=identicon&r=PG", "display_name": "Stormherz", "link": "https://stackoverflow.com/users/480307/stormherz"}, "reply_to_user": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1466510342, "post_id": 37941843, "comment_id": 63336080, "body": "@pregmatch, nothing at the moment, for now it&#39;s in development state, didn&#39;t consider deployment so far"}], "owner": {"reputation": 376, "user_id": 480307, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/2f5f40f777b401da8cda1573946822e4?s=128&d=identicon&r=PG", "display_name": "Stormherz", "link": "https://stackoverflow.com/users/480307/stormherz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 93, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1466504660, "creation_date": 1466504660, "question_id": 37941843, "link": "https://stackoverflow.com/questions/37941843/how-to-implement-subdomain-based-module-in-revel", "title": "How to implement subdomain-based module in revel", "body": "<p>I was wondering is there any example or good practice in Revel of making application module, related to subdomain.</p>\n\n<p>For example, we have <code>site.com</code>, which is default application module and want to add an additional <code>admin</code> module for <code>admin.site.com</code> subdomain. The main problem I can see at this point is that we need to </p>\n\n<ol>\n<li>dynamically determine what module should be used (using an interceptor before request)</li>\n<li>switch routing in order to avoid collisions (since there may be overlapping routes, such as <code>/</code> for default module and <code>/</code> for admin module)</li>\n</ol>\n\n<p>Does anyone implemented such application architecture in revel? Any related advice would be very helpful.</p>\n"}, {"tags": ["go", "command-line-arguments"], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 2645736, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tHPui.png?s=128&g=1", "display_name": "cpanato", "link": "https://stackoverflow.com/users/2645736/cpanato"}, "is_accepted": false, "score": 0, "last_activity_date": 1466504757, "creation_date": 1466504757, "answer_id": 37941877, "question_id": 37941622, "link": "https://stackoverflow.com/questions/37941622/hide-option-in-flag/37941877#37941877", "title": "Hide option in flag", "body": "<p>I think the standard pkg does not support this thing you are trying to achieve. Maybe you can use: <a href=\"https://godoc.org/github.com/jessevdk/go-flags\" rel=\"nofollow\">https://godoc.org/github.com/jessevdk/go-flags</a> </p>\n"}, {"tags": [], "owner": {"reputation": 2023, "user_id": 1698398, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/90a6b9d6a6d9f099bc6ad6158e096b2c?s=128&d=identicon&r=PG&f=1", "display_name": "user937284", "link": "https://stackoverflow.com/users/1698398/user937284"}, "is_accepted": false, "score": 0, "last_activity_date": 1466512564, "creation_date": 1466512564, "answer_id": 37944622, "question_id": 37941622, "link": "https://stackoverflow.com/questions/37941622/hide-option-in-flag/37944622#37944622", "title": "Hide option in flag", "body": "<p>You could use the <a href=\"https://github.com/urfave/cli\" rel=\"nofollow\">cli</a> package instead.</p>\n"}], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 445, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1466512564, "creation_date": 1466504006, "last_edit_date": 1466504509, "question_id": 37941622, "link": "https://stackoverflow.com/questions/37941622/hide-option-in-flag", "title": "Hide option in flag", "body": "<p>Can I somehow hide any option using standard library flag? This means flag would work, but --help would not print this option.</p>\n\n<p>And it would be more nice to print --option instead of -option in help. Is it possible?</p>\n"}, {"tags": ["unit-testing", "go", "mocking", "testify"], "owner": {"reputation": 526, "user_id": 1058828, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62ba3621b81e0602aa32b5312c74b98d?s=128&d=identicon&r=PG", "display_name": "barrucadu", "link": "https://stackoverflow.com/users/1058828/barrucadu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 857, "favorite_count": 0, "answer_count": 0, "score": 7, "last_activity_date": 1466500436, "creation_date": 1466500436, "question_id": 37940180, "link": "https://stackoverflow.com/questions/37940180/how-to-assert-that-mocked-method-calls-happen-in-order-with-testify", "title": "How to assert that mocked method calls happen in-order with testify?", "body": "<p>The documentation for <code>AssertExpectations</code> says \"AssertExpectations asserts that everything specified with On and Return was in fact called as expected. Calls may have occurred in any order.\"  What if I want to assert that some calls happen in-order?</p>\n\n<p>gomock has <code>*Call.After(*Call)</code> for this, but I can't see anything similar in testify. Is there a way, or should I just use gomock?</p>\n"}, {"tags": ["arrays", "go", "insert", "append"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466528668, "post_id": 37939388, "comment_id": 63349645, "body": "Possible duplicates: <a href=\"http://stackoverflow.com/questions/34600817/pointer-to-interface-with-saving-type/34600906\" title=\"pointer to interface with saving type\">stackoverflow.com/questions/34600817/&hellip;</a> and <a href=\"http://stackoverflow.com/questions/37713749/unmarshal-into-array-of-structs-determined-at-runtime-in-go/37713982\" title=\"unmarshal into array of structs determined at runtime in go\">stackoverflow.com/questions/37713749/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1466503454, "post_id": 37941312, "comment_id": 63331541, "body": "but the point is i dont want to return a new object i want to work on a reference, as many packages do like json encode/decode or sql scan etc etc"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1466528494, "post_id": 37941312, "comment_id": 63349534, "body": "@Vardius: you&#39;re not starting with a pointer, so you have to make new one somewhere. Passing a pointer to an interface doesn&#39;t get you a pointer to your value."}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466581005, "post_id": 37941312, "comment_id": 63370081, "body": "@JimB I have updated my question with my progress so far"}, {"owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "edited": false, "score": 0, "creation_date": 1466594193, "post_id": 37941312, "comment_id": 63378792, "body": "if you are curious i added solution link to playground i managed to do"}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": false, "score": 0, "last_activity_date": 1466503282, "creation_date": 1466503282, "answer_id": 37941312, "question_id": 37939388, "link": "https://stackoverflow.com/questions/37939388/how-can-i-add-elements-to-slice-reflection/37941312#37941312", "title": "How can I add elements to slice reflection?", "body": "<p>Does this do what you want? (<a href=\"https://play.golang.org/p/sc7iBknOAd\" rel=\"nofollow\">playground link</a>)</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype A struct{ Name string }\n\nfunc main() {\n    bbb(A{})\n}\n\nfunc aaa(v interface{}) interface{} {\n    sl := reflect.Indirect(reflect.ValueOf(v))\n    typeOfT := sl.Type().Elem()\n\n    ptr := reflect.New(typeOfT).Interface()\n    s := reflect.ValueOf(ptr).Elem()\n    return reflect.Append(sl, s)\n}\n\nfunc bbb(v interface{}) {\n    myType := reflect.TypeOf(v)\n    models := reflect.MakeSlice(reflect.SliceOf(myType), 0, 1).Interface()\n    fmt.Println(aaa(models))\n}\n</code></pre>\n\n<p>Note that I'm returning the new slice. I think you'd need another layer of indirection (pointer to a pointer) to do this without a return value, but this was my first time doing reflection in Go, so I may be going about things all wrong.</p>\n"}, {"tags": [], "owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "is_accepted": true, "score": 2, "last_activity_date": 1532980012, "last_edit_date": 1532980012, "creation_date": 1466596212, "answer_id": 37967221, "question_id": 37939388, "link": "https://stackoverflow.com/questions/37939388/how-can-i-add-elements-to-slice-reflection/37967221#37967221", "title": "How can I add elements to slice reflection?", "body": "<p>The problem was with <code>reflect.Zero</code> when i created slie with <code>reflect.New</code> it worked. Here you have full working example.</p>\n\n<p><a href=\"https://play.golang.org/p/3mIEFqMxk-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/3mIEFqMxk-</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"reflect\"\n)\n\ntype A struct {\n    Name string `column:\"email\"`\n}\n\nfunc main() {\n    bbb(&amp;A{})\n}\n\nfunc aaa(v interface{}) {\n    t := reflect.TypeOf(v)\n    if t.Kind() == reflect.Ptr {\n        t = t.Elem()\n    }\n\n    if t.Kind() == reflect.Slice {\n        t = t.Elem()\n    } else {\n        panic(\"Input param is not a slice\")\n    }\n\n    sl := reflect.ValueOf(v)\n\n    if t.Kind() == reflect.Ptr {\n        sl = sl.Elem()\n    }\n\n    st := sl.Type()\n    fmt.Printf(\"Slice Type %s:\\n\", st)\n\n    sliceType := st.Elem()\n    if sliceType.Kind() == reflect.Ptr {\n        sliceType = sliceType.Elem()\n    }\n    fmt.Printf(\"Slice Elem Type %v:\\n\", sliceType)\n\n    for i := 0; i &lt; 5; i++ {\n        newitem := reflect.New(sliceType)\n        newitem.Elem().FieldByName(\"Name\").SetString(fmt.Sprintf(\"Grzes %d\", i))\n\n        s := newitem.Elem()\n        for i := 0; i &lt; s.NumField(); i++ {\n            col := s.Type().Field(i).Tag.Get(\"column\")\n            fmt.Println(col, s.Field(i).Addr().Interface())\n        }\n\n        sl.Set(reflect.Append(sl, newitem))\n    }\n}\n\nfunc bbb(v interface{}) {\n    t := reflect.TypeOf(v)\n    if t.Kind() == reflect.Ptr {\n        t = t.Elem()\n    }\n    if t.Kind() != reflect.Struct {\n        panic(\"Input param is not a struct\")\n    }\n\n    models := reflect.New(reflect.SliceOf(reflect.TypeOf(v))).Interface()\n\n    aaa(models)\n\n    fmt.Println(models)\n\n    b, err := json.Marshal(models)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(string(b))\n}\n</code></pre>\n"}], "owner": {"reputation": 5499, "user_id": 2160958, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/945c998bee33562c7f4c877a11c950c9?s=128&d=identicon&r=PG", "display_name": "vardius", "link": "https://stackoverflow.com/users/2160958/vardius"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2944, "favorite_count": 0, "accepted_answer_id": 37967221, "answer_count": 2, "score": 7, "last_activity_date": 1532980012, "creation_date": 1466498180, "last_edit_date": 1466598641, "question_id": 37939388, "link": "https://stackoverflow.com/questions/37939388/how-can-i-add-elements-to-slice-reflection", "title": "How can I add elements to slice reflection?", "body": "<p>Hi i am learning <code>Go</code> and i was doing some reflection. I got stuck in a case like this:</p>\n\n<ol>\n<li>I want to create a <code>slice</code> of <code>struct</code> passed to function as <code>interface{}</code></li>\n<li>Then I want to append new elements to this slice</li>\n</ol>\n\n<p>Here is a <a href=\"https://play.golang.org/p/Kmbw5_Oine\" rel=\"nofollow\">playground</a> with the code example.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype A struct{ Name string }\n\nfunc main() {\n    bbb(A{})\n}\n\nfunc aaa(v interface{}) {\n    sl := reflect.ValueOf(v).Elem()\n    typeOfT := sl.Type()\n\n    ptr := reflect.New(typeOfT).Interface()\n    s := reflect.ValueOf(ptr).Elem()\n    sl.Set(reflect.Append(sl, s))\n\n    ptr = reflect.New(typeOfT).Interface()\n    s = reflect.ValueOf(ptr).Elem()\n    sl.Set(reflect.Append(sl, s))\n}\n\nfunc bbb(v interface{}) {\n    myType := reflect.TypeOf(v)\n    models := reflect.Zero(reflect.SliceOf(myType)).Interface()\n    aaa(&amp;models)\n\n    fmt.Println(models)\n}\n</code></pre>\n\n<p><strong>Error:</strong> <code>panic: reflect: call of reflect.Append on interface Value</code></p>\n\n<p>Is there a way to make it work ? \nNote: that i want to work on a reference.</p>\n\n<p><strong>Solution:</strong></p>\n\n<p>Here is what i manage to do: <a href=\"https://play.golang.org/p/3mIEFqMxk-\" rel=\"nofollow\">playground</a>.</p>\n"}, {"tags": ["date", "go"], "comments": [{"owner": {"reputation": 834, "user_id": 309268, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/180894362fb22f5403461fee0fb5ec35?s=128&d=identicon&r=PG", "display_name": "gondo", "link": "https://stackoverflow.com/users/309268/gondo"}, "edited": false, "score": 0, "creation_date": 1547377472, "post_id": 37937794, "comment_id": 95165467, "body": "the last example works, but you made an error in <code>2016</code> should be <code>2006</code>, and <code>20</code> should be <code>02</code> instead. so: <code>t, err := time.Parse(&quot;2006-01-02&quot;, &quot;2011-01-19&quot;)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "is_accepted": true, "score": 31, "last_activity_date": 1466493621, "last_edit_date": 1592644375, "creation_date": 1466493621, "answer_id": 37937929, "question_id": 37937794, "link": "https://stackoverflow.com/questions/37937794/string-date-to-date/37937929#37937929", "title": "String date to date", "body": "<p>Please read the documentation of the <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"noreferrer\">time.Parse</a>:</p>\n<blockquote>\n<p>The layout defines the format by showing how the reference time, defined to be</p>\n<p>Mon Jan 2 15:04:05 -0700 MST 2006</p>\n<p>would be interpreted if it were the value; it serves as an example of the input format. The same interpretation will then be made to the input string.</p>\n</blockquote>\n<p>So the correct format is</p>\n<pre><code>t, err := time.Parse(&quot;2006-01-02&quot;, &quot;2011-01-19&quot;)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "is_accepted": false, "score": 4, "last_activity_date": 1543510107, "last_edit_date": 1543510107, "creation_date": 1527470136, "answer_id": 50557983, "question_id": 37937794, "link": "https://stackoverflow.com/questions/37937794/string-date-to-date/50557983#50557983", "title": "String date to date", "body": "<p>In addition to using a literal <code>2006-01-02</code> time format, you reduce errors by creating a constant similar to how Go does it in the <code>time</code> package.</p>\n\n<p>The <code>YYYY-MM-DD</code> format is defined as <code>full-date</code> in <a href=\"https://tools.ietf.org/html/rfc3339#section-5\" rel=\"nofollow noreferrer\">RFC-3339</a> as follows (order adjusted):</p>\n\n<pre><code>full-date       = date-fullyear \"-\" date-month \"-\" date-mday\ndate-fullyear   = 4DIGIT\ndate-month      = 2DIGIT  ; 01-12\ndate-mday       = 2DIGIT  ; 01-28, 01-29, 01-30, 01-31 based on\n                          ; month/year\n</code></pre>\n\n<p>So you can create a constant like the following to go along with the built-in <code>time.RFC3339</code> and <code>time.RFC3339Nano</code> constants.</p>\n\n<pre><code>const RFC3339FullDate = \"2006-01-02\"\n</code></pre>\n\n<p>Then you can write the following:</p>\n\n<pre><code>t, err := time.Parse(RFC3339FullDate, \"2011-01-19\")\n</code></pre>\n\n<p>This is in the <a href=\"https://github.com/grokify/gotilla/blob/master/time/timeutil/format.go\" rel=\"nofollow noreferrer\"><code>gotilla/time/timeutil</code></a> package, so you can write:</p>\n\n<pre><code>t, err := time.Parse(timeutil.RFC3339FullDate, \"2011-01-19\")\n</code></pre>\n\n<p>For reference, <a href=\"https://github.com/golang/go/blob/8da180f6cac51f6cb8a316b962f797dbaf7ee96f/src/time/format.go\" rel=\"nofollow noreferrer\"><code>time/format.go</code></a> contains the following constants:</p>\n\n<pre><code>const (\n    ANSIC       = \"Mon Jan _2 15:04:05 2006\"\n    UnixDate    = \"Mon Jan _2 15:04:05 MST 2006\"\n    RubyDate    = \"Mon Jan 02 15:04:05 -0700 2006\"\n    RFC822      = \"02 Jan 06 15:04 MST\"\n    RFC822Z     = \"02 Jan 06 15:04 -0700\" // RFC822 with numeric zone\n    RFC850      = \"Monday, 02-Jan-06 15:04:05 MST\"\n    RFC1123     = \"Mon, 02 Jan 2006 15:04:05 MST\"\n    RFC1123Z    = \"Mon, 02 Jan 2006 15:04:05 -0700\" // RFC1123 with numeric zone\n    RFC3339     = \"2006-01-02T15:04:05Z07:00\"\n    RFC3339Nano = \"2006-01-02T15:04:05.999999999Z07:00\"\n    Kitchen     = \"3:04PM\"\n    // Handy time stamps.\n    Stamp      = \"Jan _2 15:04:05\"\n    StampMilli = \"Jan _2 15:04:05.000\"\n    StampMicro = \"Jan _2 15:04:05.000000\"\n    StampNano  = \"Jan _2 15:04:05.000000000\"\n)\n</code></pre>\n"}], "owner": {"reputation": 2792, "user_id": 140029, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/1eed6228fb31fa03d86809e7794b8ef3?s=128&d=identicon&r=PG", "display_name": "Pankaj Khairnar", "link": "https://stackoverflow.com/users/140029/pankaj-khairnar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28987, "favorite_count": 4, "closed_date": 1558470209, "accepted_answer_id": 37937929, "answer_count": 2, "score": 14, "last_activity_date": 1558470193, "creation_date": 1466493251, "last_edit_date": 1558470193, "question_id": 37937794, "link": "https://stackoverflow.com/questions/37937794/string-date-to-date", "closed_reason": "Duplicate", "title": "String date to date", "body": "<p>How to convert string date format to date, I have date string in format of</p>\n\n<pre><code>YYYY-MM-DD \n</code></pre>\n\n<p>Following I tried with no luck. </p>\n\n<pre><code>t, err := time.Parse(\"%Y-%m-%d\", \"2011-01-19\")\nt, err := time.Parse(\"YYYY-MM-DD\", \"2011-01-19\")\nt, err := time.Parse(\"2016-01-20\", \"2011-01-19\")\n</code></pre>\n\n<p>all above statements are giving parse errors. </p>\n"}, {"tags": ["api", "http", "go", "get"], "answers": [{"comments": [{"owner": {"reputation": 1582, "user_id": 4604899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WyuD9.jpg?s=128&g=1", "display_name": "Julien Chien", "link": "https://stackoverflow.com/users/4604899/julien-chien"}, "edited": false, "score": 0, "creation_date": 1466543886, "post_id": 37937754, "comment_id": 63357881, "body": "Thanks. I will try these two things."}, {"owner": {"reputation": 1582, "user_id": 4604899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WyuD9.jpg?s=128&g=1", "display_name": "Julien Chien", "link": "https://stackoverflow.com/users/4604899/julien-chien"}, "edited": false, "score": 0, "creation_date": 1466543948, "post_id": 37937754, "comment_id": 63357912, "body": "Why does <a href=\"http://stackoverflow.com/a/31129967\">stackoverflow.com/a/31129967</a> suggest skipping <code>ioutil.ReadAll</code> and using <code>Decode</code> straight away?"}, {"owner": {"reputation": 1582, "user_id": 4604899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WyuD9.jpg?s=128&g=1", "display_name": "Julien Chien", "link": "https://stackoverflow.com/users/4604899/julien-chien"}, "edited": false, "score": 0, "creation_date": 1466544579, "post_id": 37937754, "comment_id": 63358168, "body": "Ok, it worked after I modified the struct to have uppercase fields. I did not have to read the body before parsing it. I kept that as is. Now it works! Thanks!"}], "tags": [], "owner": {"reputation": 6335, "user_id": 1517816, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3457efc989748b02b032a8c7b502bfc5?s=128&d=identicon&r=PG", "display_name": "poussma", "link": "https://stackoverflow.com/users/1517816/poussma"}, "is_accepted": true, "score": 2, "last_activity_date": 1466493576, "last_edit_date": 1466493576, "creation_date": 1466493090, "answer_id": 37937754, "question_id": 37937407, "link": "https://stackoverflow.com/questions/37937407/trying-to-query-an-api-but-the-api-response-is-blank/37937754#37937754", "title": "trying to query an API, but the api response is blank", "body": "<p>First of all, you must read the body and then parse it: </p>\n\n<pre><code>body, err := ioutil.ReadAll(resp.Body)\nerr = json.NewDecoder(body).Decode(&amp;ip_response)\nif err != nil {\n    return Ip_response_success{}, err\n}\n</code></pre>\n\n<p>Plus, in go, the json decoder must be able to access to the fields of a struct. That means they must be exposed outside of your package.</p>\n\n<p>That implies you use the json annotation to specify the mapping: </p>\n\n<pre><code>type Ip_response_success struct {\n    As          string `json: \"as\"`\n    City        string `json: \"city\"`\n    Country     string `json: \"country\"`\n    CountryCode string `json: \"countryCode\"`\n    Isp         string `json: \"isp\"`\n    Lat         float64 `json: \"lat\"`\n    Lon         float64 `json: \"lon\"`\n    Org         string `json: \"org\"`\n    Query       string `json: \"query\"`\n    Region      string `json: \"region\"`\n    RegionName  string `json: \"regionName\"`\n    Status      string `json: \"status\"`\n    Timezone    string `json: \"timezone\"`\n    Zip         string `json: \"zip\"`\n}\n</code></pre>\n\n<p>Note also that I changed the Lon / Lat type to float64 according to the data sent by the server</p>\n"}], "owner": {"reputation": 1582, "user_id": 4604899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WyuD9.jpg?s=128&g=1", "display_name": "Julien Chien", "link": "https://stackoverflow.com/users/4604899/julien-chien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1740, "favorite_count": 0, "accepted_answer_id": 37937754, "answer_count": 1, "score": 0, "last_activity_date": 1466493576, "creation_date": 1466492038, "question_id": 37937407, "link": "https://stackoverflow.com/questions/37937407/trying-to-query-an-api-but-the-api-response-is-blank", "title": "trying to query an API, but the api response is blank", "body": "<p>I am trying to use the <a href=\"http://ip-api.com/\" rel=\"nofollow\">http://ip-api.com/</a> api to get longitude and latitude through my ip address. When I access <a href=\"http://ip-api.com/json\" rel=\"nofollow\">http://ip-api.com/json</a> from my browser or with <code>curl</code>, it returns correct information in json. But when I try to use the API from my program, the API response has an empty body (or so it seems).</p>\n\n<p>I'm trying to do it in this app. The Ip_response_success struct is made according to the api docs here <a href=\"http://ip-api.com/docs/api:json\" rel=\"nofollow\">http://ip-api.com/docs/api:json</a></p>\n\n<pre><code>type Ip_response_success struct {\n    as          string\n    city        string\n    country     string\n    countryCode string\n    isp         string\n    lat         string\n    lon         string\n    org         string\n    query       string\n    region      string\n    regionName  string\n    status      string  \n    timezone    string\n    zip         string\n}\n\nfunc Query(url string) (Ip_response_success, error) {\n    resp, err := http.Get(url)\n    if err != nil {\n        return Ip_response_success{}, err\n    }\n    fmt.Printf(\"%#v\\n\", resp)\n\n    var ip_response Ip_response_success\n    defer resp.Body.Close()\n    err = json.NewDecoder(resp.Body).Decode(&amp;ip_response)\n    if err != nil {\n        return Ip_response_success{}, err\n    }\n    body, err := ioutil.ReadAll(resp.Body)\n    fmt.Printf(\"%#v\\n\", string(body))\n    return ip_response, nil\n}\n\nfunc main() {\n    ip, err := Query(\"http://ip-api.com/json\")\n    if err != nil {\n        fmt.Printf(\"%#v\\n\", err)\n    }\n}\n</code></pre>\n\n<p>But the weirdest thing is the body of the response is blank. It gives a 200 status code in the response, so I assume there is no error on the API call. The API does not mention any auth requirements or user-agent requirements, and indeed it doesn't appear to need anything special when I curl it or access it through the browser. Is there any thing I'm doing wrong in my program or am I using the API wrong? </p>\n\n<p>I try to print the response within the code, but <code>resp.body</code> just comes out as blank. Sample response from printing the <code>http.Response</code> struct :</p>\n\n<pre><code>&amp;http.Response{Status:\"200 OK\", StatusCode:200, Proto:\"HTTP/1.1\", ProtoMajor:1, \nProtoMinor:1, Header:http.Header{\"Access-Control-Allow-Origin\":[]string{\"*\"}, \n\"Content-Type\":[]string{\"application/json; charset=utf-8\"}, \"Date\":\n[]string{\"Tue, 21 Jun 2016 06:46:57 GMT\"}, \"Content-Length\":[]string{\"340\"}}, \nBody:(*http.bodyEOFSignal)(0xc820010640), ContentLength:340, TransferEncoding:\n[]string(nil), Close:false, Trailer:http.Header(nil), Request:(*http.Request)\n(0xc8200c6000), TLS:(*tls.ConnectionState)(nil)}\n</code></pre>\n\n<p>Any help would be appreciated!</p>\n"}, {"tags": ["go", "godeps"], "comments": [{"owner": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "edited": false, "score": 1, "creation_date": 1466495416, "post_id": 37936663, "comment_id": 63326197, "body": "Besides that &quot;using <code>go get</code>&quot; won&#39;t update your deps (before you explicitly did it through <code>godep update</code> or similar, just ditch Godep and use govendor - saved me a lot of headache ;-)"}, {"owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "reply_to_user": {"reputation": 6480, "user_id": 1267140, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UOHte.jpg?s=128&g=1", "display_name": "Havelock", "link": "https://stackoverflow.com/users/1267140/havelock"}, "edited": false, "score": 0, "creation_date": 1466499742, "post_id": 37936663, "comment_id": 63328900, "body": "@Havelock Very good advice."}], "answers": [{"tags": [], "owner": {"reputation": 1337, "user_id": 3755196, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/0aJ9G.jpg?s=128&g=1", "display_name": "Raj Kumar", "link": "https://stackoverflow.com/users/3755196/raj-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1466572903, "creation_date": 1466572903, "answer_id": 37959158, "question_id": 37936663, "link": "https://stackoverflow.com/questions/37936663/golang-godeps-adding-new-dependency-override-godeps-json-file/37959158#37959158", "title": "golang + Godeps: Adding new dependency override Godeps.json file", "body": "<p>If you do not run <code>godeps save</code> then the new dependency will not be saved in your Godeps.json. It's hard to imagine why you would want two version of the same library though, but if you really want to do it, then during deployment of your project, first do <code>godep restore</code> and then install your dependency as <code>go get \"github.com/robfig/cron\"</code>.This will then prevent a replacement</p>\n"}], "owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 162, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466572903, "creation_date": 1466488989, "question_id": 37936663, "link": "https://stackoverflow.com/questions/37936663/golang-godeps-adding-new-dependency-override-godeps-json-file", "title": "golang + Godeps: Adding new dependency override Godeps.json file", "body": "<p>I'm using <code>Godeps</code> to save my dependencies with my go project. </p>\n\n<p>For now my <code>Godeps.json</code> file looks like this:</p>\n\n<pre><code>{\n    \"ImportPath\": \"github.com/some/repo\",\n    \"GoVersion\": \"go1.6\",\n    \"GodepVersion\": \"v74\",\n    \"Packages\": [\n        \"gopkg.in/mgo.v2\",\n        \"github.com/sendgrid/sendgrid-go\",\n        \"gopkg.in/olivere/elastic.v3\"\n    ],\n    \"Deps\": [\n        {\n            \"ImportPath\": \"github.com/sendgrid/sendgrid-go\",\n            \"Comment\": \"v2.0.0-22-g6ea8b2b\",\n            \"Rev\": \"6ea8b2b2d54b2e54efcf8668867289a1838d96fd\"\n        },\n        {\n            \"ImportPath\": \"github.com/sendgrid/smtpapi-go\",\n            \"Comment\": \"v0.4.0-7-gb88787c\",\n            \"Rev\": \"b88787cc8801ef961d7daef0bcb79ae3f50bfd52\"\n        },\n        {\n            \"ImportPath\": \"gopkg.in/check.v1\",\n            \"Rev\": \"4f90aeace3a26ad7021961c297b22c42160c7b25\"\n        },\n        {\n            \"ImportPath\": \"gopkg.in/mgo.v2\",\n            \"Comment\": \"r2016.02.04-1-gb6e2fa3\",\n            \"Rev\": \"b6e2fa371e64216a45e61072a96d4e3859f169da\"\n        },\n        {\n            \"ImportPath\": \"gopkg.in/mgo.v2/bson\",\n            \"Comment\": \"r2016.02.04-1-gb6e2fa3\",\n            \"Rev\": \"b6e2fa371e64216a45e61072a96d4e3859f169da\"\n        },\n        {\n            \"ImportPath\": \"gopkg.in/mgo.v2/internal/sasl\",\n            \"Comment\": \"r2016.02.04-1-gb6e2fa3\",\n            \"Rev\": \"b6e2fa371e64216a45e61072a96d4e3859f169da\"\n        },\n        {\n            \"ImportPath\": \"gopkg.in/mgo.v2/internal/scram\",\n            \"Comment\": \"r2016.02.04-1-gb6e2fa3\",\n            \"Rev\": \"b6e2fa371e64216a45e61072a96d4e3859f169da\"\n        },\n        {\n            \"ImportPath\": \"gopkg.in/olivere/elastic.v3\",\n            \"Comment\": \"v3.0.40\",\n            \"Rev\": \"7a92d18eaf7a9f95d603e70970fb5adcd4dc62f1\"\n        },\n        {\n            \"ImportPath\": \"gopkg.in/olivere/elastic.v3/backoff\",\n            \"Comment\": \"v3.0.40\",\n            \"Rev\": \"7a92d18eaf7a9f95d603e70970fb5adcd4dc62f1\"\n        },\n        {\n            \"ImportPath\": \"gopkg.in/olivere/elastic.v3/uritemplates\",\n            \"Comment\": \"v3.0.40\",\n            \"Rev\": \"7a92d18eaf7a9f95d603e70970fb5adcd4dc62f1\"\n        }\n    ]\n}\n</code></pre>\n\n<p>If I want to install a new dependency using go get:</p>\n\n<p><code>go get \"github.com/robfig/cron\"</code></p>\n\n<p>This will override my <code>Godeps.json</code> file and it will store only the latest package I have installed, and further more It will delete the packages from my <code>vendor</code> folder.</p>\n\n<p>How can I add this dependency instead of replace it?</p>\n"}, {"tags": ["rest", "go", "gzip"], "answers": [{"comments": [{"owner": {"reputation": 1261, "user_id": 3056745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/263633e6298c912b98a43bf1ca7de267?s=128&d=identicon&r=PG&f=1", "display_name": "Lital Kolog", "link": "https://stackoverflow.com/users/3056745/lital-kolog"}, "edited": false, "score": 0, "creation_date": 1466492382, "post_id": 37937311, "comment_id": 63324514, "body": "So, what Content-Type do you recommend for me to define? <code>application&#47;tar</code>? since I find it useless to define <code>application&#47;gzip</code>"}, {"owner": {"reputation": 6335, "user_id": 1517816, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3457efc989748b02b032a8c7b502bfc5?s=128&d=identicon&r=PG", "display_name": "poussma", "link": "https://stackoverflow.com/users/1517816/poussma"}, "reply_to_user": {"reputation": 1261, "user_id": 3056745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/263633e6298c912b98a43bf1ca7de267?s=128&d=identicon&r=PG&f=1", "display_name": "Lital Kolog", "link": "https://stackoverflow.com/users/3056745/lital-kolog"}, "edited": false, "score": 0, "creation_date": 1466494793, "post_id": 37937311, "comment_id": 63325867, "body": "application/gzip but it is not that important. Could also be application/octect-stream (this is a generic mime type for binary data)"}], "tags": [], "owner": {"reputation": 6335, "user_id": 1517816, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/3457efc989748b02b032a8c7b502bfc5?s=128&d=identicon&r=PG", "display_name": "poussma", "link": "https://stackoverflow.com/users/1517816/poussma"}, "is_accepted": false, "score": 0, "last_activity_date": 1466491659, "creation_date": 1466491659, "answer_id": 37937311, "question_id": 37936266, "link": "https://stackoverflow.com/questions/37936266/go-web-service-post-tar-gz-file-as-request-body/37937311#37937311", "title": "Go web service - POST tar.gz file as request body", "body": "<p>Claerly not, but maybe...</p>\n\n<p>Golang provides a very good support for the http client (and server). This is one of the first language to support http2 and the design of the API clearly shows their concern on having a fast http.</p>\n\n<p>This is why they add <code>Accept-Econding: gzip</code> automatically. That will dramatically reduce the size of the server response and then optimize the transfer.</p>\n\n<p>But the gzip remains an option in http 1 and not all of the client will push this header to your server.</p>\n\n<p>Note that the <code>Content-Type</code> describes the type of data you are sending (here a tar.gz but could be <code>application/json</code>, <code>test/javascript</code>, ...), when the <code>Accept-Encoding</code> describes the way the data has been encoded for the transport</p>\n\n<p>Go will take care of transparently handling the <code>Accept-Encoding</code> for you because it is responsible of the transport of the data. Then it will be up to you to handle the <code>Content-Type</code> because only you know how to give a sense to the content you received</p>\n"}, {"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 1, "last_activity_date": 1466494348, "creation_date": 1466494348, "answer_id": 37938167, "question_id": 37936266, "link": "https://stackoverflow.com/questions/37936266/go-web-service-post-tar-gz-file-as-request-body/37938167#37938167", "title": "Go web service - POST tar.gz file as request body", "body": "<p>The code you've written for the client is just sending the tarfile directly because of this code:</p>\n\n<pre><code>reader, err := gzip.NewReader(f)\n...\nrequest, err := http.NewRequest(\"POST\", \"http://localhost:8080/results\", reader)\n</code></pre>\n\n<p>If you sent the <code>.tar.gz</code> file content directly, then you <em>would</em> need to gunzip it on the server. E.g.:</p>\n\n<pre><code>request, err := http.NewRequest(..., f)\n</code></pre>\n\n<p>I think that's closer to the behavior you should expect third-party clients to exhibit.</p>\n"}], "owner": {"reputation": 1261, "user_id": 3056745, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/263633e6298c912b98a43bf1ca7de267?s=128&d=identicon&r=PG&f=1", "display_name": "Lital Kolog", "link": "https://stackoverflow.com/users/3056745/lital-kolog"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2047, "favorite_count": 0, "accepted_answer_id": 37938167, "answer_count": 2, "score": 1, "last_activity_date": 1491476282, "creation_date": 1466487033, "last_edit_date": 1491476282, "question_id": 37936266, "link": "https://stackoverflow.com/questions/37936266/go-web-service-post-tar-gz-file-as-request-body", "title": "Go web service - POST tar.gz file as request body", "body": "<p>I need to implement web service in go that processes tar.gz files and I wonder what is the correct way, what content type I need to define, etc. </p>\n\n<p>plus, I found that a lot of things are handled automatically - on the client side I just post a gzip reader as request body and <code>Accept-Encoding: gzip</code> header is added automatically, and on the server side - I do not need to gunzip the request body, it is already extracted to tar. does that make sense? </p>\n\n<p>Can I rely that it would be like this with any client?</p>\n\n<p><strong>Server:</strong></p>\n\n<pre><code>func main() {\n\n    router := mux.NewRouter().StrictSlash(true)\n    router.Handle(\"/results\", dataupload.NewUploadHandler()).Methods(\"POST\")\n    log.Fatal(http.ListenAndServe(*address, router))\n}\n</code></pre>\n\n<p><strong>Uploader:</strong></p>\n\n<pre><code>package dataupload\n\nimport (\n    \"errors\"\n    log \"github.com/Sirupsen/logrus\"\n    \"io\"\n    \"net/http\"\n)\n\n// UploadHandler responds to /results http request, which is the result-service rest API for uploading results\ntype UploadHandler struct {\n    uploader Uploader\n}\n\n// NewUploadHandler creates UploadHandler instance\nfunc NewUploadHandler() *UploadHandler {\n\n    return &amp;UploadHandler{\n        uploader: TarUploader{},\n    }\n}\n\nfunc (uh UploadHandler) ServeHTTP(writer http.ResponseWriter, request *http.Request) {\n\n    retStatus := http.StatusOK\n    body, err := getBody(request)\n    if err != nil {\n        retStatus = http.StatusBadRequest\n        log.Error(\"Error fetching request body. \", err)\n    } else {\n        _, err := uh.uploader.Upload(body)\n    }\n    writer.WriteHeader(retStatus)\n}\n\nfunc getBody(request *http.Request) (io.ReadCloser, error) {\n\n    requestBody := request.Body\n    if requestBody == nil {\n        return nil, errors.New(\"Empty request body\")\n    }\n    var err error\n    // this part is commented out since somehow the body is already gunzipped - no need to extract it.\n    /*if strings.Contains(request.Header.Get(\"Accept-Encoding\"), \"gzip\") {\n        requestBody, err = gzip.NewReader(requestBody)\n    }*/\n\n    return requestBody, err\n}\n</code></pre>\n\n<p><strong>Client</strong></p>\n\n<pre><code>func main() {\n\n    f, err := os.Open(\"test.tar.gz\")\n    if err != nil {\n        log.Fatalf(\"error openning file %s\", err)\n    }\n    defer f.Close()\n    client := new(http.Client)\n    reader, err := gzip.NewReader(f)\n    if err != nil {\n        log.Fatalf(\"error gzip file %s\", err)\n    }\n    request, err := http.NewRequest(\"POST\", \"http://localhost:8080/results\", reader)\n    _, err = client.Do(request)\n    if err != nil {\n        log.Fatalf(\"error uploading file %s\", err)\n    }\n}\n</code></pre>\n"}, {"tags": ["string", "go", "encoding", "uuid"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466477665, "post_id": 37934162, "comment_id": 63319640, "body": "maybe base32 if you want to avoid non-alpha characters?  You can only encode 128 bit of info so small."}, {"owner": {"reputation": 1894, "user_id": 2269979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22a1e835980e29baccf08a62e7ff71?s=128&d=identicon&r=PG", "display_name": "molivier", "link": "https://stackoverflow.com/users/2269979/molivier"}, "edited": false, "score": 0, "creation_date": 1466511056, "post_id": 37934162, "comment_id": 63336617, "body": "Found this package: <a href=\"https://github.com/taskcluster/slugid-go\" rel=\"nofollow noreferrer\">github.com/taskcluster/slugid-go</a>"}, {"owner": {"reputation": 21289, "user_id": 532430, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/uAwnB.png?s=128&g=1", "display_name": "thwd", "link": "https://stackoverflow.com/users/532430/thwd"}, "edited": false, "score": 0, "creation_date": 1466511984, "post_id": 37934162, "comment_id": 63337229, "body": "Use <a href=\"https://golang.org/pkg/encoding/base64/#NewEncoding\" rel=\"nofollow noreferrer\"><code>encoding&#47;base64.NewEncoding</code></a> and disable padding."}, {"owner": {"reputation": 353, "user_id": 4491253, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-T0Hvr5oyBPA/AAAAAAAAAAI/AAAAAAAAABY/1pOTmMzEs1o/photo.jpg?sz=128", "display_name": "Travis", "link": "https://stackoverflow.com/users/4491253/travis"}, "edited": false, "score": 1, "creation_date": 1466782789, "post_id": 37934162, "comment_id": 63476334, "body": "I have used this package in the past: <a href=\"https://github.com/renstrom/shortuuid/\" rel=\"nofollow noreferrer\">github.com/renstrom/shortuuid</a>"}], "answers": [{"comments": [{"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "edited": false, "score": 2, "creation_date": 1466566633, "post_id": 37944520, "comment_id": 63363876, "body": "That is beautiful. I was not aware of <code>base64.RawURLEncoding</code> and that final one-liner for replacing dash and underscore may definitely be useful for some people. Thanks for your detailed answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 32, "last_activity_date": 1471849544, "last_edit_date": 1471849544, "creation_date": 1466512293, "answer_id": 37944520, "question_id": 37934162, "link": "https://stackoverflow.com/questions/37934162/output-uuid-in-go-as-a-short-string/37944520#37944520", "title": "Output UUID in Go as a short string", "body": "<p>A <a href=\"https://en.wikipedia.org/wiki/Universally_unique_identifier\" rel=\"noreferrer\">universally unique identifier (UUID)</a> is a 128-bit value, which is 16 bytes. For human-readable display, many systems use a canonical format using hexadecimal text with inserted hyphen characters, for example:</p>\n\n<pre><code>123e4567-e89b-12d3-a456-426655440000\n</code></pre>\n\n<p>This has length <code>16*2 + 4 = 36</code>. You may choose to omit the hypens which gives you:</p>\n\n<pre><code>fmt.Printf(\"%x\\n\", uuid)\nfmt.Println(hex.EncodeToString(uuid))\n\n// Output: 32 chars\n123e4567e89b12d3a456426655440000\n123e4567e89b12d3a456426655440000\n</code></pre>\n\n<p>You may choose to use base32 encoding (which encodes 5 bits with 1 symbol in contrast to hex encoding which encodes 4 bits with 1 symbol):</p>\n\n<pre><code>fmt.Println(base32.StdEncoding.EncodeToString(uuid))\n\n// Output: 26 chars\nCI7EKZ7ITMJNHJCWIJTFKRAAAA======\n</code></pre>\n\n<p>Trim the trailing <code>=</code> signs when transmitting, so this will always be 26 chars. Note that you have to append <code>\"======\"</code> prior to decode the string using <code>base32.StdEncoding.DecodeString()</code>.</p>\n\n<p>If this is still too long for you, you may use base64 encoding (which encodes 6 bits with 1 symbol):</p>\n\n<pre><code>fmt.Println(base64.RawURLEncoding.EncodeToString(uuid))\n\n// Output: 22 chars\nEj5FZ-ibEtOkVkJmVUQAAA\n</code></pre>\n\n<p>Note that <code>base64.RawURLEncoding</code> produces a base64 string (without padding) which is safe for URL inclusion, because the 2 extra chars in the symbol table (beyond <code>[0-9a-zA-Z]</code>) are <code>-</code> and <code>_</code>, both which are safe to be included in URLs.</p>\n\n<p>Unfortunately for you, the base64 string may contain 2 extra chars beyond <code>[0-9a-zA-Z]</code>. So read on.</p>\n\n<h3>Interpreted, escaped string</h3>\n\n<p>If you are alien to these 2 extra characters, you may choose to turn your base64 string into an <em>interpreted, escaped string</em> similar to the interpreted string literals in Go. For example if you want to insert a backslash in an interpreted string literal, you have to double it because backslash is a special character indicating a sequence, e.g.:</p>\n\n<pre><code>fmt.Println(\"One backspace: \\\\\") // Output: \"One backspace: \\\"\n</code></pre>\n\n<p>We may choose to do something similar to this. We have to designate a special character: be it <code>9</code>.</p>\n\n<p><sup><strong>Reasoning:</strong> <code>base64.RawURLEncoding</code> uses the charset: <code>A..Za..z0..9-_</code>, so <code>9</code> represents the highest code with alphanumeric character (61 decimal = 111101b). See advantage below.</sup><br>\nSo whenever the base64 string contains a <code>9</code>, replace it with <code>99</code>. And whenever the base64 string contains the extra characters, use a <em>sequence</em> instead of them:</p>\n\n<pre><code>9  =&gt;  99\n-  =&gt;  90\n_  =&gt;  91\n</code></pre>\n\n<p>This is a simple replacement table which can be captured by a value of <a href=\"https://golang.org/pkg/strings/#Replacer\" rel=\"noreferrer\"><code>strings.Replacer</code></a>:</p>\n\n<pre><code>var escaper = strings.NewReplacer(\"9\", \"99\", \"-\", \"90\", \"_\", \"91\")\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>fmt.Println(escaper.Replace(base64.RawURLEncoding.EncodeToString(uuid)))\n\n// Output:\nEj5FZ90ibEtOkVkJmVUQAAA\n</code></pre>\n\n<p>This will slightly increase the length as sometimes a sequence of 2 chars will be used instead of 1 char, but the gain will be that only <code>[0-9a-zA-Z]</code> chars will be used, as you wanted. The <em>average</em> length will be less than 1 additional character: <code>23</code> chars. <em>Fair trade.</em></p>\n\n<p><sup><strong>Logic:</strong> For simplicity let's assume all possible uuids have equal probability (uuid is not completely random, so this is not the case, but let's set this aside as this is just an estimation). Last base64 symbol will never be a replaceable char (that's why we chose the special char to be <code>9</code> instead of like <code>A</code>), 21 chars may turn into a replaceable sequence. The chance for one being replaceable: 3 / 64 = 0.047, so on average this means 21*3/64 = 0.98 sequences which turn 1 char into a 2-char sequence, so this is equal to the number of extra characters.</sup></p>\n\n<p>To decode, use an inverse decoding table captured by the following <code>strings.Replacer</code>:</p>\n\n<pre><code>var unescaper = strings.NewReplacer(\"99\", \"9\", \"90\", \"-\", \"91\", \"_\")\n</code></pre>\n\n<p>Example code to decode an escaped base64 string:</p>\n\n<pre><code>fmt.Println(\"Verify decoding:\")\ns := escaper.Replace(base64.RawURLEncoding.EncodeToString(uuid))\ndec, err := base64.RawURLEncoding.DecodeString(unescaper.Replace(s))\nfmt.Printf(\"%x, %v\\n\", dec, err)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>123e4567e89b12d3a456426655440000, &lt;nil&gt;\n</code></pre>\n\n<p>Try all the examples on the <a href=\"https://play.golang.org/p/hcKURudLpZ\" rel=\"noreferrer\">Go Playground</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "edited": false, "score": 3, "creation_date": 1513221966, "post_id": 47677306, "comment_id": 82572354, "body": "Thanks for sharing, this may be useful for some people. This question, however, is asking specifically about rendering a UUID."}], "tags": [], "owner": {"reputation": 8661, "user_id": 5774375, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/83e8847058c0655871c7022baf9ff89e?s=128&d=identicon&r=PG&f=1", "display_name": "Karlom", "link": "https://stackoverflow.com/users/5774375/karlom"}, "is_accepted": false, "score": 8, "last_activity_date": 1614133396, "last_edit_date": 1614133396, "creation_date": 1512572393, "answer_id": 47677306, "question_id": 37934162, "link": "https://stackoverflow.com/questions/37934162/output-uuid-in-go-as-a-short-string/47677306#47677306", "title": "Output UUID in Go as a short string", "body": "<p>As suggested <a href=\"https://stackoverflow.com/a/47676287/5774375\">here</a>, If you want just a fairly random string to use as slug, better to not bother with UUID at all.</p>\n<p>You can simply use go's native math/rand library to make random strings of desired length:</p>\n<pre><code>import (\n&quot;math/rand&quot;\n&quot;encoding/hex&quot;\n)\n\n\nb := make([]byte, 4) //equals 8 characters\nrand.Read(b) \ns := hex.EncodeToString(b)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "edited": false, "score": 0, "creation_date": 1618985376, "post_id": 67184912, "comment_id": 118764327, "body": "What a great suggestion. Thanks for sharing!"}], "tags": [], "owner": {"reputation": 80955, "user_id": 1002260, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/5ec9c21c8d54825b04def7a41998d18d?s=128&d=identicon&r=PG", "display_name": "Steven Penny", "link": "https://stackoverflow.com/users/1002260/steven-penny"}, "is_accepted": false, "score": 1, "last_activity_date": 1618945621, "creation_date": 1618945621, "answer_id": 67184912, "question_id": 37934162, "link": "https://stackoverflow.com/questions/37934162/output-uuid-in-go-as-a-short-string/67184912#67184912", "title": "Output UUID in Go as a short string", "body": "<p>Another option is <code>math/big</code>. While <code>base64</code> has a constant output of 22\ncharacters, <code>math/big</code> can get down to 2 characters, depending on the input:</p>\n<pre><code>package main\n\nimport (\n   &quot;encoding/base64&quot;\n   &quot;fmt&quot;\n   &quot;math/big&quot;\n)\n\ntype uuid [16]byte\n\nfunc (id uuid) encode() string {\n   return new(big.Int).SetBytes(id[:]).Text(62)\n}\n\nfunc main() {\n   var id uuid\n   for n := len(id); n &gt; 0; n-- {\n      id[n - 1] = 0xFF\n      s := base64.RawURLEncoding.EncodeToString(id[:])\n      t := id.encode()\n      fmt.Printf(&quot;%v %v\\n&quot;, s, t)\n   }\n}\n</code></pre>\n<p>Result:</p>\n<pre class=\"lang-none prettyprint-override\"><code>AAAAAAAAAAAAAAAAAAAA_w 47\nAAAAAAAAAAAAAAAAAAD__w h31\nAAAAAAAAAAAAAAAAAP___w 18owf\nAAAAAAAAAAAAAAAA_____w 4GFfc3\nAAAAAAAAAAAAAAD______w jmaiJOv\nAAAAAAAAAAAAAP_______w 1hVwxnaA7\nAAAAAAAAAAAA_________w 5k1wlNFHb1\nAAAAAAAAAAD__________w lYGhA16ahyf\nAAAAAAAAAP___________w 1sKyAAIxssts3\nAAAAAAAA_____________w 62IeP5BU9vzBSv\nAAAAAAD______________w oXcFcXavRgn2p67\nAAAAAP_______________w 1F2si9ujpxVB7VDj1\nAAAA_________________w 6Rs8OXba9u5PiJYiAf\nAAD__________________w skIcqom5Vag3PnOYJI3\nAP___________________w 1SZwviYzes2mjOamuMJWv\n_____________________w 7N42dgm5tFLK9N8MT7fHC7\n</code></pre>\n<p><a href=\"https://golang.org/pkg/math/big\" rel=\"nofollow noreferrer\">https://golang.org/pkg/math/big</a></p>\n"}], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18305, "favorite_count": 10, "accepted_answer_id": 37944520, "answer_count": 3, "score": 9, "last_activity_date": 1618945621, "creation_date": 1466471908, "last_edit_date": 1466514298, "question_id": 37934162, "link": "https://stackoverflow.com/questions/37934162/output-uuid-in-go-as-a-short-string", "title": "Output UUID in Go as a short string", "body": "<p>Is there a built in way, or reasonably standard package that allows you to convert a standard UUID into a short string that would enable shorter URL's?</p>\n\n<p>I.e. taking advantage of using a larger range of characters such as <code>[A-Za-z0-9]</code> to output a shorter string.</p>\n\n<p>I know we can use base64 to encode the bytes, as follows, but I'm after something that creates a string that looks like a \"word\", i.e. no <code>+</code> and <code>/</code>:</p>\n\n<pre><code>id = base64.StdEncoding.EncodeToString(myUuid.Bytes())\n</code></pre>\n"}, {"tags": ["go", "directory", "path", "filepath", "mkdir"], "answers": [{"comments": [{"owner": {"reputation": 431, "user_id": 205682, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5be533abe1a390499370b05f2e379fa6?s=128&d=identicon&r=PG", "display_name": "Paddie", "link": "https://stackoverflow.com/users/205682/paddie"}, "edited": false, "score": 8, "creation_date": 1475506596, "post_id": 37932672, "comment_id": 66958601, "body": "This is the best answer, and is using the stdlib. This is especially useful when used alongside os.Create, where you  might need to create sub-dirs as well (using <code>filepath.Dir(&quot;path&#47;to&#47;file&quot;)</code> on the complete path to the file is a nice approach in my eyes."}, {"owner": {"reputation": 235, "user_id": 4783884, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fac84df6f081961c434a45b71a098222?s=128&d=identicon&r=PG&f=1", "display_name": "Paul A. Fortin", "link": "https://stackoverflow.com/users/4783884/paul-a-fortin"}, "edited": false, "score": 6, "creation_date": 1496575054, "post_id": 37932672, "comment_id": 75708853, "body": "You might want to check for any error response on the MkdirAll call like: ` if err := os.MkdirAll(&quot;/somepath/&quot;, os.ModeDir); err != nil {      fmt.Println(&quot;Cannot create hidden directory.&quot;) } `"}], "tags": [], "owner": {"reputation": 56051, "user_id": 11926, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7303815e1d6234ef3551611b22de6fdf?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/11926/alfred"}, "is_accepted": false, "score": 156, "last_activity_date": 1564167891, "last_edit_date": 1564167891, "creation_date": 1466460819, "answer_id": 37932672, "question_id": 37932551, "link": "https://stackoverflow.com/questions/37932551/mkdir-if-not-exists-using-golang/37932672#37932672", "title": "mkdir if not exists using golang", "body": "<p>Okay I figured it out thanks to this <a href=\"https://stackoverflow.com/a/34451620/11926\">question/answer</a></p>\n\n<pre><code>import(\n    \"os\"\n    \"path/filepath\"\n)\n\nnewpath := filepath.Join(\".\", \"public\")\nos.MkdirAll(newpath, os.ModePerm)\n</code></pre>\n\n<blockquote>\n  <p><strong>MkdirAll</strong> creates a directory named path, along with any necessary parents, and returns <code>nil</code>, or else returns an <code>error</code>.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2757, "user_id": 1577649, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/b133aaa4a889b1301c2a23960b0ccdb2?s=128&d=identicon&r=PG&f=1", "display_name": "The Unknown Dev", "link": "https://stackoverflow.com/users/1577649/the-unknown-dev"}, "edited": false, "score": 41, "creation_date": 1559579258, "post_id": 37932674, "comment_id": 99456947, "body": "For anyone wondering what the variable <code>mode</code> is, see: <a href=\"https://golang.org/pkg/os/#FileMode\" rel=\"nofollow noreferrer\">golang.org/pkg/os/#FileMode</a>.  You probably want to use <code>os.ModeDir</code> as its value."}, {"owner": {"reputation": 2301, "user_id": 3448879, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/y7XPi.png?s=128&g=1", "display_name": "Jairo Lozano", "link": "https://stackoverflow.com/users/3448879/jairo-lozano"}, "edited": false, "score": 7, "creation_date": 1576887171, "post_id": 37932674, "comment_id": 105050882, "body": "Also for those wondering about the <code>mode</code>, you could use <code>os.Mkdir(&quot;dirname&quot;, 0700)</code> if you want to be able to write into that directory from the same program, see <a href=\"https://stackoverflow.com/questions/14249467/os-mkdir-and-os-mkdirall-permission-value/31151508\">this</a> for more details."}, {"owner": {"reputation": 200, "user_id": 8353105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8b0b904b9645ebcb5355328c2c8e107?s=128&d=identicon&r=PG&f=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8353105/giannis"}, "edited": false, "score": 4, "creation_date": 1592825259, "post_id": 37932674, "comment_id": 110553690, "body": "Why do we ignore any issues when we do os.Mkdir() ?"}, {"owner": {"reputation": 17105, "user_id": 472084, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/539bf5ecaec0ac24e133243ba77a7a7d?s=128&d=identicon&r=PG", "display_name": "472084", "link": "https://stackoverflow.com/users/472084/472084"}, "reply_to_user": {"reputation": 200, "user_id": 8353105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e8b0b904b9645ebcb5355328c2c8e107?s=128&d=identicon&r=PG&f=1", "display_name": "Giannis", "link": "https://stackoverflow.com/users/8353105/giannis"}, "edited": false, "score": 0, "creation_date": 1598446784, "post_id": 37932674, "comment_id": 112461452, "body": "@Giannis It will error if it already exists, which is okay. Probably not recommended though."}, {"owner": {"reputation": 2891, "user_id": 874249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/fOtzh.jpg?s=128&g=1", "display_name": "Justin", "link": "https://stackoverflow.com/users/874249/justin"}, "edited": false, "score": 2, "creation_date": 1603349811, "post_id": 37932674, "comment_id": 114010318, "body": "When creating a directory to store files in the mode <code>os.ModeDir</code>. The new directory does not have enough permissions. I found only <code>os.ModePerm</code> worked for me. Which is equivalent to <code>0777</code> or <code>drwxr-xr-x</code>. I think the permissions can be a bit lower but <code>0666</code> did not do the trick."}, {"owner": {"reputation": 485, "user_id": 7776992, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a371cfc5d23ee8d5edc92b06f3e4c75b?s=128&d=identicon&r=PG&f=1", "display_name": "sgonzalez", "link": "https://stackoverflow.com/users/7776992/sgonzalez"}, "edited": false, "score": 0, "creation_date": 1607030820, "post_id": 37932674, "comment_id": 115152442, "body": "Wouldn&#39;t option 1 be susceptible to a race condition if someone else creates the directory in between you checking if exists and then creating it?"}], "tags": [], "owner": {"reputation": 20276, "user_id": 110762, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/595e261e4a13c3e484d3bd21bb5faa90?s=128&d=identicon&r=PG", "display_name": "Austin Hanson", "link": "https://stackoverflow.com/users/110762/austin-hanson"}, "is_accepted": true, "score": 158, "last_activity_date": 1466460928, "last_edit_date": 1466460928, "creation_date": 1466460821, "answer_id": 37932674, "question_id": 37932551, "link": "https://stackoverflow.com/questions/37932551/mkdir-if-not-exists-using-golang/37932674#37932674", "title": "mkdir if not exists using golang", "body": "<p>I've ran across two ways:</p>\n\n<ol>\n<li><p>Check for the directory's existence and create it if it doesn't exist:</p>\n\n<pre><code>if _, err := os.Stat(path); os.IsNotExist(err) {\n    os.Mkdir(path, mode)\n}\n</code></pre></li>\n<li><p>Attempt to create the directory and ignore any issues:</p>\n\n<pre><code>_ = os.Mkdir(path, mode)\n</code></pre></li>\n</ol>\n"}, {"tags": [], "owner": {"reputation": 18466, "user_id": 477563, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/07a89fb7b2fd8ece1e9e39e95e004a36?s=128&d=identicon&r=PG", "display_name": "Mr. Llama", "link": "https://stackoverflow.com/users/477563/mr-llama"}, "is_accepted": false, "score": 8, "last_activity_date": 1466460846, "creation_date": 1466460846, "answer_id": 37932678, "question_id": 37932551, "link": "https://stackoverflow.com/questions/37932551/mkdir-if-not-exists-using-golang/37932678#37932678", "title": "mkdir if not exists using golang", "body": "<p>You can use <a href=\"https://golang.org/pkg/os/#File.Stat\" rel=\"noreferrer\"><code>os.Stat</code></a> to check if a given path exists.<br>\nIf it doesn't, you can use <a href=\"https://golang.org/pkg/os/#Mkdir\" rel=\"noreferrer\"><code>os.Mkdir</code></a> to create it.</p>\n"}, {"comments": [{"owner": {"reputation": 33825, "user_id": 9898643, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3c9f303fda4c69e9c9ce6b84a6268402?s=128&d=identicon&r=PG&f=1", "display_name": "Theo", "link": "https://stackoverflow.com/users/9898643/theo"}, "edited": false, "score": 0, "creation_date": 1560537955, "post_id": 56600630, "comment_id": 99783385, "body": "While your code may provide the answer to the question, please add context around it so others will have some idea what it does and why it is there."}], "tags": [], "owner": {"reputation": 1746, "user_id": 5785743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21a09b5b4639c7459d79f565db0d63da?s=128&d=identicon&r=PG&f=1", "display_name": "pr-pal", "link": "https://stackoverflow.com/users/5785743/pr-pal"}, "is_accepted": false, "score": 4, "last_activity_date": 1560572872, "last_edit_date": 1560572872, "creation_date": 1560524050, "answer_id": 56600630, "question_id": 37932551, "link": "https://stackoverflow.com/questions/37932551/mkdir-if-not-exists-using-golang/56600630#56600630", "title": "mkdir if not exists using golang", "body": "<p>This is one alternative for achieving the same but it avoids race condition caused by having two distinct \"check ..and.. create\" operations.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main()  {\n    if err := ensureDir(\"/test-dir\"); err != nil {\n        fmt.Println(\"Directory creation failed with error: \" + err.Error())\n        os.Exit(1)\n    }\n    // Proceed forward\n}\n\nfunc ensureDir(dirName string) error {\n\n    err := os.Mkdir(dirName, os.ModeDir)\n\n    if err == nil || os.IsExist(err) {\n        return nil\n    } else {\n        return err\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 205, "user_id": 3199223, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/341f372683f28fdd9e1297b830a4f6cb?s=128&d=identicon&r=PG&f=1", "display_name": "just_myles", "link": "https://stackoverflow.com/users/3199223/just-myles"}, "is_accepted": false, "score": 2, "last_activity_date": 1594774431, "last_edit_date": 1594774431, "creation_date": 1594773256, "answer_id": 62905888, "question_id": 37932551, "link": "https://stackoverflow.com/questions/37932551/mkdir-if-not-exists-using-golang/62905888#62905888", "title": "mkdir if not exists using golang", "body": "<p>So what I have found to work for me is:</p>\n<pre><code>//Get the base file dir\npath, err := os.Getwd()\nif err != nil {\n    log.Println(&quot;error msg&quot;, err)\n}\n\n//Create output path\noutPath:= filepath.Join(path, &quot;output&quot;)\n\n//Create dir output using above code\nif _, err := os.Stat(outPath); os.IsNotExist(err) {\n    os.Mkdir(outPath, 0755)\n}\n</code></pre>\n<p>I like the portability of this.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 6363310, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qeexr.jpg?s=128&g=1", "display_name": "hyper_debugger", "link": "https://stackoverflow.com/users/6363310/hyper-debugger"}, "is_accepted": false, "score": 2, "last_activity_date": 1607761944, "creation_date": 1607761944, "answer_id": 65263008, "question_id": 37932551, "link": "https://stackoverflow.com/questions/37932551/mkdir-if-not-exists-using-golang/65263008#65263008", "title": "mkdir if not exists using golang", "body": "<p>Or you could attempt creating the file and check that the error returned isn't a &quot;file exists&quot; error</p>\n<pre><code>if err := os.Mkdir(path, mode); err != nil &amp;&amp; !os.IsExist(err) {\n    log.Fatal(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 56051, "user_id": 11926, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/7303815e1d6234ef3551611b22de6fdf?s=128&d=identicon&r=PG&f=1", "display_name": "Alfred", "link": "https://stackoverflow.com/users/11926/alfred"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83046, "favorite_count": 10, "accepted_answer_id": 37932674, "answer_count": 6, "score": 90, "last_activity_date": 1607761944, "creation_date": 1466460215, "last_edit_date": 1587685498, "question_id": 37932551, "link": "https://stackoverflow.com/questions/37932551/mkdir-if-not-exists-using-golang", "title": "mkdir if not exists using golang", "body": "<p>I am learning golang(beginner) and I have been searching on both google and stackoverflow but I could not find an answer so excuse me if already asked, but how can I mkdir if not exists in golang.</p>\n\n<p>For example in node I would use fs-extra with the function <a href=\"https://github.com/jprichardson/node-fs-extra#ensuredirdir-callback\" rel=\"noreferrer\">ensureDirSync</a> (if blocking is of no concern of course)</p>\n\n<pre><code>fs.ensureDir(\"./public\");\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "owner": {"reputation": 109, "user_id": 2991504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f912c2fc3d3b24ec37201a9ed743c0ee?s=128&d=identicon&r=PG&f=1", "display_name": "Rohit", "link": "https://stackoverflow.com/users/2991504/rohit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1466450763, "creation_date": 1466450763, "question_id": 37930312, "link": "https://stackoverflow.com/questions/37930312/how-to-group-based-on-result-of-condition-in-mgo", "title": "How to group based on result of condition in mgo", "body": "<p>I want to get the result of mgo query performed by grouping certain fields based on result of some condition.</p>\n\n<p>Let say an imaginary document contains three fields fromproductid, toproductid and price</p>\n\n<p>I have the query </p>\n\n<pre><code>bson.M{\n        \"$group\": bson.M{\n            \"_id\": bson.M{\n                \"productid1\": \"$fromproductid\",\n                \"productid2\": \"$toproductid\",\n            },\n            \"info\": bson.M{\n                \"$push\": \"$$ROOT\",\n            },\n        },\n</code></pre>\n\n<p>Here the grouping is based on first column fromproductid and second column toproductid.</p>\n\n<p>I want to group based on condition like if fromproductid is equal to some productId then productid1 should be fromproductid and productid2 should be toproductid else productid1 should be toproductid and productid2 should be fromproductid</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 288, "user_id": 6472660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DR13T.jpg?s=128&g=1", "display_name": "Jonathan Jeffrey", "link": "https://stackoverflow.com/users/6472660/jonathan-jeffrey"}, "edited": false, "score": 0, "creation_date": 1466446450, "post_id": 37928704, "comment_id": 63308956, "body": "My answer is (currently) wrong, but I looked through the playground: the problem isn&#39;t exclusive to <code>p.callback</code>, as if you try to change <code>p.test</code> in <code>SetCallback()</code> it prints the default value later."}], "answers": [{"comments": [{"owner": {"reputation": 9113, "user_id": 146003, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/272ed3d9a5c9813ed1fad7ab8f512576?s=128&d=identicon&r=PG", "display_name": "Atmocreations", "link": "https://stackoverflow.com/users/146003/atmocreations"}, "edited": false, "score": 0, "creation_date": 1466447121, "post_id": 37929122, "comment_id": 63309318, "body": "By &quot;The original <code>Parser</code> instance created inside <code>CreateDialog</code> becomes lost when the <code>Dialog</code> instance is returned by value.&quot;, do you mean that <code>Parser</code> in the dialog object becomes replaced by a new default-valued Parser object?"}, {"owner": {"reputation": 3657, "user_id": 785259, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zkWdu.jpg?s=128&g=1", "display_name": "kbirk", "link": "https://stackoverflow.com/users/785259/kbirk"}, "reply_to_user": {"reputation": 9113, "user_id": 146003, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/272ed3d9a5c9813ed1fad7ab8f512576?s=128&d=identicon&r=PG", "display_name": "Atmocreations", "link": "https://stackoverflow.com/users/146003/atmocreations"}, "edited": false, "score": 0, "creation_date": 1466447919, "post_id": 37929122, "comment_id": 63309757, "body": "The <code>Parser</code> in the dialog and all of it&#39;s properties are copied over by value. Therefore the <code>test</code> value of 100 is copied, the <code>callback</code> value of nil is copied, and the <code>callbackSet</code> channel (an implicit reference type) is copied. You can see this for yourself by putting <code>log.Println</code> statements in <code>CreateDialog</code> and <code>main</code>."}], "tags": [], "owner": {"reputation": 3657, "user_id": 785259, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zkWdu.jpg?s=128&g=1", "display_name": "kbirk", "link": "https://stackoverflow.com/users/785259/kbirk"}, "is_accepted": true, "score": 7, "last_activity_date": 1466447000, "last_edit_date": 1466447000, "creation_date": 1466446304, "answer_id": 37929122, "question_id": 37928704, "link": "https://stackoverflow.com/questions/37928704/golang-strange-behaviour-with-function-type/37929122#37929122", "title": "Golang: Strange behaviour with function type", "body": "<p>This is because you are storing the <code>Parser</code> object by value and returning a <code>Dialog</code> by value from <code>CreateDialog</code>. </p>\n\n<p>The original <code>Parser</code> instance created inside <code>CreateDialog</code> becomes lost when the <code>Dialog</code> instance is returned by value.</p>\n\n<p>It is the original <code>Parser</code> that is parsing, and receives the callback as logged. </p>\n\n<pre><code>func CreateDialog() (Dialog, error) {\n    d := Dialog{}\n    d.Parser = NewParser()\n    d.Parser.StartParsing() // &lt;-- this instance is parsing\n    return d, nil\n}\n\nfunc main() {\n   dialog, _ := CreateDialog()\n   // dialog.Parser &lt;-- this is now a new instance which is NOT parsing\n   dialog.OnMessage(func(m Message){\n       log.Println(\"Message: \", m)\n   })\n}\n</code></pre>\n\n<p>Therefore to fix it you can do one of three:</p>\n\n<p>1) Call <code>StartParsing</code> in <code>main</code>. </p>\n\n<pre><code>func main() {\n    dialog, _ := CreateDialog()\n    dialog.Parser.StartParsing();\n    dialog.OnMessage(func(m Message){\n        log.Println(\"Message: \", m)\n    })\n }\n</code></pre>\n\n<p>2) Store <code>Parser</code> as a pointer in Dialog:</p>\n\n<pre><code>func NewParser() *Parser {\n    p := &amp;Parser{}\n    p.test = 100\n    p.callbackSet = make(chan bool)\n    return p\n}\n\ntype Dialog struct {\n    Parser  *Parser\n}\n</code></pre>\n\n<p>3) Return <code>Dialog</code> as a pointer in from <code>CreateDialog</code>:</p>\n\n<pre><code>func CreateDialog() (*Dialog, error) {\n    d := &amp;Dialog{}\n    d.Parser = NewParser()\n    d.Parser.StartParsing()\n    return d, nil\n}\n</code></pre>\n\n<p>That should fix it.</p>\n"}], "owner": {"reputation": 9113, "user_id": 146003, "user_type": "registered", "accept_rate": 99, "profile_image": "https://www.gravatar.com/avatar/272ed3d9a5c9813ed1fad7ab8f512576?s=128&d=identicon&r=PG", "display_name": "Atmocreations", "link": "https://stackoverflow.com/users/146003/atmocreations"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 120, "favorite_count": 0, "accepted_answer_id": 37929122, "answer_count": 1, "score": 4, "last_activity_date": 1466447000, "creation_date": 1466444679, "last_edit_date": 1466444985, "question_id": 37928704, "link": "https://stackoverflow.com/questions/37928704/golang-strange-behaviour-with-function-type", "title": "Golang: Strange behaviour with function type", "body": "<p>Obviously, I have a race condition in my go code. But I cannot find it as I'm pretty sure to be synchronizing correctly. After hours of debugging, you probably can help me find it.</p>\n\n<p>First of all, here's my (very simplified) code:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"time\"\n)\n\ntype Parser struct {\n    callback    Callback\n    callbackSet chan bool\n    test        int\n}\n\nfunc NewParser() Parser {\n    p := Parser{}\n    p.test = 100\n    p.callbackSet = make(chan bool)\n    return p\n}\n\nfunc (p *Parser) SetCallback(newCallback Callback) {\n    log.Println(\"=&gt; SET CALLBACK: \", newCallback)\n    p.test = 100\n    p.callback = newCallback\n    log.Println(\"=&gt; SETTING CALLBACK DONE\")\n    p.callbackSet &lt;- true\n}\n\nfunc (p *Parser) StartParsing() {\n    go p.parse()\n}\n\n\n\nfunc (p *Parser) parse() {\n    cb := &lt;-p.callbackSet\n    _ = cb\n    log.Println(\"Verify Callback: \", p.callback)\n    log.Println(\"Verify Test Variable: \", p.test)\n\n    funcDone := make(chan bool)\n    go func() {\n        time.Sleep(3 * time.Second) // Some io-Operation here\n        funcDone &lt;- true\n    }()\n\n    _ = &lt;-funcDone\n}\n\ntype Callback func(Message)\ntype Message int\n\ntype Dialog struct {\n    Parser  Parser\n}\nfunc CreateDialog() (Dialog, error) {\n    d := Dialog{}\n    d.Parser = NewParser()\n    d.Parser.StartParsing()\n    return d, nil\n}\n\nfunc (d *Dialog) OnMessage(callback Callback) {\n    log.Println(\"dialog.OnMessage: \", callback)\n    time.Sleep(3 * time.Second) // This sleep is just to prove the synchronization. It could be removed.\n    d.Parser.SetCallback(callback)\n}\n\nfunc main() {\n\n    dialog, _ := CreateDialog()\n    dialog.OnMessage(func(m Message){\n        log.Println(\"Message: \", m)\n    })\n\n    time.Sleep(5 * time.Second) // Not clean but just to await all of the output\n}\n</code></pre>\n\n<p>The big question now is: Why is <code>p.callback</code> <code>&lt;nil&gt;</code> in <code>p.parse</code> whereas <code>p.test</code> isn't, although these two are set at the very same time?</p>\n\n<p>And the stuff should be synchronized using the channel <code>p.callbackSet</code>?!</p>\n\n<p>Fully runnable example at <a href=\"https://play.golang.org/p/14vn5Tie5Y\" rel=\"nofollow\">https://play.golang.org/p/14vn5Tie5Y</a></p>\n\n<p>I tried replacing the main function by a simpler one. I suspect the bug to be somewhere in the <code>Dialog</code> struct. When I circumvent its usage I'm unable to reproduce the issue:</p>\n\n<pre><code>func main() {\n    p := NewParser()\n    p.StartParsing()\n    p.SetCallback(func (m Message) {\n        log.Println(\"Message: \", m)\n    })\n\n    time.Sleep(5 * time.Second) // Not clean but just to await all of the output\n}\n</code></pre>\n\n<p>The rest of the code remains the same. Another playable example of the modified (working) version here: <a href=\"https://play.golang.org/p/0Y0nKbfcrv\" rel=\"nofollow\">https://play.golang.org/p/0Y0nKbfcrv</a></p>\n"}, {"tags": ["parsing", "go", "time", "unix-timestamp", "rfc3339"], "comments": [{"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "edited": false, "score": 0, "creation_date": 1466444150, "post_id": 37928492, "comment_id": 63307749, "body": "Give an example of the dbtime you&#39;re parsing."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466444229, "post_id": 37928492, "comment_id": 63307791, "body": "The timezone isn&#39;t missing, the time <code>2016-06-20T12:41:45.14Z</code> is UTC."}, {"owner": {"reputation": 31, "user_id": 6490387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c3867d0477ca9fde7f47a9ef319f58?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn Rose", "link": "https://stackoverflow.com/users/6490387/shawn-rose"}, "edited": false, "score": 0, "creation_date": 1466444443, "post_id": 37928492, "comment_id": 63307890, "body": "Sorry the original timestamp. is 2016-06-20T12:41:45.14Z but its actually in EDT."}, {"owner": {"reputation": 16322, "user_id": 215969, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/4a50a54d4d142661b7b2ac1e6dce80da?s=128&d=identicon&r=PG", "display_name": "Ilia Choly", "link": "https://stackoverflow.com/users/215969/ilia-choly"}, "edited": false, "score": 0, "creation_date": 1466444541, "post_id": 37928492, "comment_id": 63307945, "body": "So you want to change the timezone?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466444689, "post_id": 37928492, "comment_id": 63308035, "body": "<code>2016-06-20T12:41:45.14Z</code> can&#39;t be EDT, because the trailing <code>Z</code> specifies UTC, so you need to fix the times yourself."}, {"owner": {"reputation": 31, "user_id": 6490387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c3867d0477ca9fde7f47a9ef319f58?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn Rose", "link": "https://stackoverflow.com/users/6490387/shawn-rose"}, "edited": false, "score": 0, "creation_date": 1466444708, "post_id": 37928492, "comment_id": 63308046, "body": "If dbtime is correct for a UTC timestamp. Then the timestamp in the database is incorrect. I do not want to convert the time to UTC, I want the time to remain the same and only switch the timezone."}, {"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 0, "creation_date": 1524593445, "post_id": 37928492, "comment_id": 87033028, "body": "in your <code>find Query </code> what is the output format of your time Hope it will be in ISO || UTC"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1466529503, "last_edit_date": 1466529503, "creation_date": 1466446879, "answer_id": 37929255, "question_id": 37928492, "link": "https://stackoverflow.com/questions/37928492/rfc3339-time-parsing-in-golang/37929255#37929255", "title": "RFC3339 time parsing in golang", "body": "<p>You could parse the timestamps using the defined <code>time.RFC3339</code> like you've shown, and adjust them after the fact by adding the UTC offset so that they are correct in UTC. </p>\n\n<pre><code>udbtime = udbtime.Add(4*time.Hour)\n</code></pre>\n\n<p>This however requires that you check whether each time falls in EST or EDT to add the correct offset, unless you can assume they are all EDT.</p>\n\n<p>A better way would be to use your own time format without a specific TZ offset (the Z isn't part of the time specification for parsing), and parse it with <a href=\"https://golang.org/pkg/time/#ParseInLocation\" rel=\"nofollow\"><code>time.ParseInLocation</code></a>. </p>\n\n<p>This way you can account for the correct offset depending on whether the time would have been in EST or EDT.</p>\n\n<p><a href=\"https://play.golang.org/p/IrUnTwvlkk\" rel=\"nofollow\">https://play.golang.org/p/IrUnTwvlkk</a></p>\n\n<pre><code>RFC3339local := \"2006-01-02T15:04:05Z\"\n\nloc, err := time.LoadLocation(\"America/New_York\")\nif err != nil {\n    log.Fatal(err)\n}\n\nts1 := \"2016-06-20T12:41:45.14Z\"\nt1, _ := time.ParseInLocation(RFC3339local, ts1, loc)\nfmt.Println(t1)\n// prints: 2016-06-20 12:41:45.14 -0400 EDT\n\nts2 := \"2016-01-20T12:41:45.14Z\"\nt2, _ = time.ParseInLocation(RFC3339local, ts2, loc)\nfmt.Println(t2)\n// prints: 2016-01-20 12:41:45.14 -0500 EST\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 15173183, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NO2Jg.jpg?s=128&g=1", "display_name": "gouguoyin", "link": "https://stackoverflow.com/users/15173183/gouguoyin"}, "is_accepted": false, "score": 0, "last_activity_date": 1612850772, "creation_date": 1612850772, "answer_id": 66113810, "question_id": 37928492, "link": "https://stackoverflow.com/questions/37928492/rfc3339-time-parsing-in-golang/66113810#66113810", "title": "RFC3339 time parsing in golang", "body": "<p>you can try go-carbon\uff0ca simple\uff0csemantic and developer-fridendly golang package for datetime</p>\n<pre class=\"lang-golang prettyprint-override\"><code>carbon.Parse(&quot;2020-12-31&quot;).ToRfc3339String() \n//  output\n2020-12-31T00:00:00+08:00\n</code></pre>\n<p><a href=\"https://github.com/golang-module/carbon\" rel=\"nofollow noreferrer\">https://github.com/golang-module/carbon</a></p>\n"}], "owner": {"reputation": 31, "user_id": 6490387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1c3867d0477ca9fde7f47a9ef319f58?s=128&d=identicon&r=PG&f=1", "display_name": "Shawn Rose", "link": "https://stackoverflow.com/users/6490387/shawn-rose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16606, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1612850772, "creation_date": 1466443898, "question_id": 37928492, "link": "https://stackoverflow.com/questions/37928492/rfc3339-time-parsing-in-golang", "title": "RFC3339 time parsing in golang", "body": "<p>I'm pulling a timestamp from a datebase, it is using RFC3339 format but the timezone is missing. So when I try to compare the timestamps it will be off. How do I change dbtime to be Eastern time?</p>\n\n<pre><code>// time format\nconst\n(\n    RFC3339     = \"2006-01-02T15:04:05Z07:00\"\n)\n\n//now time\nnow := time.Now()\nnowtime := now.Unix()\n\nfmt.Println(\"Nowtime:\", nowtime)\nfmt.Println(\"Now:\", now)\n\n//time in db\nfmt.Println(\"Dbtime string:\", dbtime)\nudbtime, err := time.Parse.EST(RFC3339,dbtime)\nfmt.Println(\"RFC3339: \" + RFC3339)\nfmt.Println(\"dbtime parsed\", udbtime)\nfmt.Println(\"dbtime parsed unixtime\", udbtime.Unix())\n</code></pre>\n\n<p>My output is </p>\n\n<pre><code>Nowtime: 1466443640\nNow: 2016-06-20 13:27:20.963232824 -0400 EDT\nDbtime string: 2016-06-20T12:41:45.14Z\nRFC3339: 2006-01-02T15:04:05Z07:00\ndbtime parsed 2016-06-20 12:41:45.14 +0000 UTC\ndbtime parsed unixtime 1466426505\n</code></pre>\n"}, {"tags": ["ssl", "go", "lets-encrypt"], "comments": [{"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1466509241, "post_id": 37926878, "comment_id": 63335371, "body": "why don&#39;t you use nginx or similar in front of go web server?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1466515011, "post_id": 37926878, "comment_id": 63339528, "body": "@pregmatch: there&#39;s no reason to add another proxy layer if it&#39;s not needed."}, {"owner": {"reputation": 2195, "user_id": 1108279, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8ceab1df9b9083d662c34efd1b7c7868?s=128&d=identicon&r=PG", "display_name": "pregmatch", "link": "https://stackoverflow.com/users/1108279/pregmatch"}, "edited": false, "score": 0, "creation_date": 1466516741, "post_id": 37926878, "comment_id": 63340983, "body": "i am asking that because of ssl and keys and stuff. so you do not have to worry about that things. i did like many 10 aps in go web server and all of them are using nginx in front. it is much easier for me to do continuous integration and stuff like that and i do not have to worry about ssl and stuff."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1466438604, "creation_date": 1466438604, "answer_id": 37927023, "question_id": 37926878, "link": "https://stackoverflow.com/questions/37926878/letsencrypt-certificate-output-for-golang-listenandservetls/37927023#37927023", "title": "Letsencrypt certificate output for golang ListenAndServeTLS", "body": "<p>As with most http servers, the Go tls server implementation only accepts a single file for the certificate. From the <code>net/http</code> documentation:</p>\n\n<blockquote>\n  <p>If the certificate is signed by a certificate authority, the certFile should be the concatenation of the server's certificate, any intermediates, and the CA's certificate.</p>\n</blockquote>\n\n<p>All you need to do is concatenate the files together. </p>\n"}], "owner": {"reputation": 2122, "user_id": 433253, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/8661e1fc24e3041a462484721277c2d1?s=128&d=identicon&r=PG", "display_name": "JohnDoe", "link": "https://stackoverflow.com/users/433253/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 741, "favorite_count": 0, "accepted_answer_id": 37927023, "answer_count": 1, "score": 4, "last_activity_date": 1466438604, "creation_date": 1466438221, "question_id": 37926878, "link": "https://stackoverflow.com/questions/37926878/letsencrypt-certificate-output-for-golang-listenandservetls", "title": "Letsencrypt certificate output for golang ListenAndServeTLS", "body": "<p>Lets'Encrypt provided me with a \"Signed Certificate\" and an \"Intermediate Certificate\". I had to create a private key domain.key for the domain before.</p>\n\n<p>Now <a href=\"https://golang.org/pkg/net/http/#ListenAndServeTLS\" rel=\"nofollow\">ListenAndServeTLS</a> expects a certificate and a key file.</p>\n\n<p>I guess the \"keyfile\" is the locally generated domain.key file but what do I do with a \"Signed Certificate\" and an \"Intermediate Certificate\" if ListenAndServeTLS expects two files?</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "edited": false, "score": 2, "creation_date": 1466433822, "post_id": 37925309, "comment_id": 63301251, "body": "Are you decoding your XML with <code>encoding&#47;xml</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1466440550, "creation_date": 1466440550, "answer_id": 37927601, "question_id": 37925309, "link": "https://stackoverflow.com/questions/37925309/comments-in-xml-lists-in-go/37927601#37927601", "title": "comments in xml lists in go", "body": "<p>You can do it in two ways. Firstly, you can make comment a part of a larger struct that embeds members and make it marshal a comment every time a member is marshalled:</p>\n\n<pre><code>type Members struct {\n    XMLName xml.Name `xml:\"members\"`\n    Members []CommentedMember\n}\n\ntype CommentedMember struct {\n    Member\n    comment xml.Comment\n}\n\nfunc (cm CommentedMember) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n    if cm.comment != nil {\n        err := e.EncodeToken(cm.comment)\n        if err != nil {\n            return err\n        }\n    }\n    return e.Encode(cm.Member)\n}\n\ntype Member struct {\n    XMLName xml.Name `xml:\"member\"`\n}\n</code></pre>\n\n<p>The second way is to create a separate <code>Comment</code> type and make your <code>Members</code> struct contain different types:</p>\n\n<pre><code>type Members2 struct {\n    XMLName xml.Name `xml:\"members\"`\n    Members []interface{}\n}\n\ntype Comment string\n\nfunc (cm Comment) MarshalXML(e *xml.Encoder, start xml.StartElement) error {\n    if cm != \"\" {\n        return e.EncodeToken(xml.Comment(cm))\n    }\n    return nil\n}\n\ntype Member struct {\n    XMLName xml.Name `xml:\"member\"`\n}\n</code></pre>\n\n<p>Here are both on the playground: <a href=\"https://play.golang.org/p/3n-xH1Zc-n\" rel=\"nofollow\">https://play.golang.org/p/3n-xH1Zc-n</a>.</p>\n"}], "owner": {"reputation": 217, "user_id": 2381111, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c7862740d4344e2320296afedac6b876?s=128&d=identicon&r=PG", "display_name": "vporoshok", "link": "https://stackoverflow.com/users/2381111/vporoshok"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 37927601, "answer_count": 1, "score": 3, "last_activity_date": 1466440550, "creation_date": 1466433573, "question_id": 37925309, "link": "https://stackoverflow.com/questions/37925309/comments-in-xml-lists-in-go", "title": "comments in xml lists in go", "body": "<p>I would like to do something like:</p>\n\n<pre><code>    &lt;members&gt;\n        &lt;!-- It's a first group --&gt;\n        &lt;member&gt;Whatever&lt;/member&gt;\n        ...\n        &lt;member&gt;whatever&lt;/member&gt;\n        &lt;!-- It's a second group --&gt;\n        &lt;member&gt;Whatever&lt;/member&gt;\n        ...\n        &lt;member&gt;whatever&lt;/member&gt;\n    &lt;/members&gt;\n</code></pre>\n\n<p>Is there any way to do this with golang?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6489314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/95uvD.png?s=128&g=1", "display_name": "PlayDave", "link": "https://stackoverflow.com/users/6489314/playdave"}, "edited": false, "score": 0, "creation_date": 1466492030, "post_id": 37925339, "comment_id": 63324306, "body": "JimB  Thanks for correcting me on this line <code>strings.Index(s[6:], &quot;&#47;&quot;</code> Thanks"}, {"owner": {"reputation": 21, "user_id": 6489314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/95uvD.png?s=128&g=1", "display_name": "PlayDave", "link": "https://stackoverflow.com/users/6489314/playdave"}, "edited": false, "score": 0, "creation_date": 1466492468, "post_id": 37925339, "comment_id": 63324562, "body": "<code>strings.Index(s[6:], &quot;-&quot;</code> I used this method `parts = append(parts[:4], strings.Split(parts[4], &quot;-&quot;)...)&#39; and it did everything I wanted, was avoiding to use Strings.Replace because it will replace a string with a string meanwhile the fields are separated by delimiter | in the schema which is not a string.    Thanks JimB"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 7, "last_activity_date": 1466454986, "last_edit_date": 1466454986, "creation_date": 1466433631, "answer_id": 37925339, "question_id": 37924371, "link": "https://stackoverflow.com/questions/37924371/strings-split-and-join/37925339#37925339", "title": "Strings Split and Join", "body": "<p>I'm not sure why you are using <code>strings.Index(s[6:], \"/\")</code> when there is no <code>/</code> character in your original string, but you can replace the <code></code> and <code>-</code> characters in a few ways:</p>\n\n<p>With your original attempt of split and join twice:</p>\n\n<pre><code>msg := \"Time Server Type Class Method-Message\"\nmsg = strings.Join(strings.Split(msg, \" \"), \"|\")\nmsg = strings.Join(strings.Split(msg, \"-\"), \"|\")\n</code></pre>\n\n<p>Or slightly more efficiently, by only joining once:</p>\n\n<pre><code>msg := \"Time Server Type Class Method-Message\"\nparts := strings.Split(msg, \" \")\nparts = append(parts[:4], strings.Split(parts[4], \"-\")...)\nnewMsg := strings.Join(parts, \"|\")\n</code></pre>\n\n<p>Or with multiple calls to <code>strings.Replace</code>:</p>\n\n<pre><code>newMsg := strings.Replace(strings.Replace(msg, \" \", \"|\", -1), \"-\", \"|\", -1)\n</code></pre>\n\n<p>Or with a single regular expression:</p>\n\n<pre><code>newMsg := regexp.MustCompile(`[ -]`).ReplaceAllString(msg, \"|\")\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 6489314, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/95uvD.png?s=128&g=1", "display_name": "PlayDave", "link": "https://stackoverflow.com/users/6489314/playdave"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2702, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466454986, "creation_date": 1466430902, "question_id": 37924371, "link": "https://stackoverflow.com/questions/37924371/strings-split-and-join", "title": "Strings Split and Join", "body": "<p>I'm a <code>go</code> novice, I have data as follows <code>Time Server Type Class Method-Message</code>. with the help of json field delimiter \"|\" manage to have the following data <code>Time|Server|Type|Class|Method-Message</code> I want to split by - in the forth index which is <code>|Method-Message</code> then append a field delimiter \"|\" then join to end up with the following <code>Time|Server|Type|Class|Method|Message</code>.have tried to split the data with <code>n = s[6 : 6+strings.Index(s[6:], \"/\")]</code> what it did was to remove <code>-Message</code> then ended up with <code>Time|Server|Type|Class|Method</code> then i append a field delimiter then ended up with <code>Time|Server|Type|Class|Method|Message|</code> but couldn't append the<code>-Message</code> it was removed from the data. </p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 3, "creation_date": 1466428660, "post_id": 37923529, "comment_id": 63297415, "body": "How can you possibly know if that address is even valid?  What do you plan to do with the data?"}, {"owner": {"reputation": 624, "user_id": 5388039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2bc12577db77f610cec33fbf996a19?s=128&d=identicon&r=PG", "display_name": "Joost", "link": "https://stackoverflow.com/users/5388039/joost"}, "reply_to_user": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 0, "creation_date": 1466428744, "post_id": 37923529, "comment_id": 63297484, "body": "@zmb Another application calls this application (not go) with the memory address."}, {"owner": {"reputation": 6647, "user_id": 914991, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/639555fcf960b5e80617a10f479ea476?s=128&d=identicon&r=PG", "display_name": "zmb", "link": "https://stackoverflow.com/users/914991/zmb"}, "edited": false, "score": 2, "creation_date": 1466428804, "post_id": 37923529, "comment_id": 63297536, "body": "But most operating systems use virtual memory these days, so that other application won&#39;t share a virtual address space with the Go app."}, {"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1466428893, "post_id": 37923529, "comment_id": 63297593, "body": "You can try your luck with the unsafe package, converting from str to int and then casting to an unsafe pointer."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1466428950, "post_id": 37923529, "comment_id": 63297651, "body": "&quot;How can I use that pointer and get the value that is stored on that location?&quot; By writing your own OS. Seriously: You can&#39;t and you shouldn&#39;t."}, {"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1466429399, "post_id": 37923529, "comment_id": 63298002, "body": "Why don&#39;t you just pass the data over to the go app with STDIN/STDOUT pipes, rather than calling with the pointer and hoping that it works?"}], "answers": [{"tags": [], "owner": {"reputation": 16549, "user_id": 836390, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/tNl4E.jpg?s=128&g=1", "display_name": "joshlf", "link": "https://stackoverflow.com/users/836390/joshlf"}, "is_accepted": true, "score": 7, "last_activity_date": 1466428955, "creation_date": 1466428955, "answer_id": 37923728, "question_id": 37923529, "link": "https://stackoverflow.com/questions/37923529/pointers-golang-from-string/37923728#37923728", "title": "Pointers golang from string", "body": "<p>Disclaimer: As you are probably aware, this is dangerous and if you're going to do this in a production application, you'd better have a really good reason. That being said...</p>\n\n<p>You need to do a few things. Here's the code, and then we'll walk through it.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"strconv\"\n    \"unsafe\"\n)\n\nfunc main() {\n    str := \"7ffc47e43200\" // strconv.ParseUint doesn't like a \"0x\" prefix\n    u, err := strconv.ParseUint(str, 16, 64)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, \"could not parse pointer:\", err)\n        os.Exit(1)\n    }\n\n    ptr := unsafe.Pointer(uintptr(u)) // generic pointer (like void* in C)\n    intptr := (*int)(ptr)             // typed pointer to int\n    fmt.Println(*intptr)\n}\n</code></pre>\n\n<p>You can run this on the <a href=\"https://play.golang.org/p/rsEQXX44eU\">Go Playground</a>.</p>\n\n<p>First, we need to parse the string as a numerical value. In your example, you gave a hexadecimal number, so we'll parse in base 16 (that's the \"16\" argument to <code>strconv.ParseUint</code>). Note that <code>strconv.ParseUint</code> doesn't like the \"0x\" prefix, so I removed it.</p>\n\n<p>Then, we need to convert the number into a pointer type. For this, we will use the <code>unsafe.Pointer</code> type, which is special to the Go compiler. Normally, the compiler won't let you convert between pointer types. The exception is that, according to the <a href=\"https://golang.org/pkg/unsafe/#Pointer\"><code>unsafe.Pointer</code> documentation</a>:</p>\n\n<blockquote>\n  <ul>\n  <li>A pointer value of any type can be converted to a Pointer.</li>\n  <li>A Pointer can be converted to a pointer value of any type.</li>\n  <li>A uintptr can be converted to a Pointer.</li>\n  <li>A Pointer can be converted to a uintptr.</li>\n  </ul>\n</blockquote>\n\n<p>Thus, in order to convert to a pointer, we'll need to first convert to a <code>uintptr</code> and then to an <code>unsafe.Pointer</code>. From here, we can convert to any pointer type we want. In this example, we will convert to an int pointer, but we could choose any other pointer type as well. We then dereference the pointer (which panics in this case).</p>\n"}], "owner": {"reputation": 624, "user_id": 5388039, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/db2bc12577db77f610cec33fbf996a19?s=128&d=identicon&r=PG", "display_name": "Joost", "link": "https://stackoverflow.com/users/5388039/joost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 939, "favorite_count": 1, "accepted_answer_id": 37923728, "answer_count": 1, "score": 2, "last_activity_date": 1466428955, "creation_date": 1466428358, "question_id": 37923529, "link": "https://stackoverflow.com/questions/37923529/pointers-golang-from-string", "title": "Pointers golang from string", "body": "<p>My application accepts a pointer from <code>os.Args</code>.</p>\n\n<p>For example</p>\n\n<pre><code>pointer := os.Args[1] //\"0x7ffc47e43200\"\n</code></pre>\n\n<p>How can I use that pointer and get the value that is stored on that location?</p>\n"}, {"tags": ["multithreading", "networking", "go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1466426851, "creation_date": 1466426851, "answer_id": 37922991, "question_id": 37922775, "link": "https://stackoverflow.com/questions/37922775/do-multiple-goroutine-will-invoke-a-method-on-a-conn-simultaneously/37922991#37922991", "title": "Do multiple goroutine will invoke a method on a Conn simultaneously?", "body": "<p>The documentation states:</p>\n\n<blockquote>\n  <p>Multiple goroutines may invoke methods on a Conn simultaneously.</p>\n</blockquote>\n\n<p>There is no mention of whether each individual write is atomic. While the current implementation may ensure that each call to <code>Write</code> happens completely before the next call can begin, there is no guarantee in the language specification. </p>\n"}], "owner": {"reputation": 277, "user_id": 4112599, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh3.googleusercontent.com/-mSx5V2Y2Z8Q/AAAAAAAAAAI/AAAAAAAAABE/z94Y3QQ8KYA/photo.jpg?sz=128", "display_name": "adairjun", "link": "https://stackoverflow.com/users/4112599/adairjun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 217, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1466474040, "creation_date": 1466426238, "last_edit_date": 1466474040, "question_id": 37922775, "link": "https://stackoverflow.com/questions/37922775/do-multiple-goroutine-will-invoke-a-method-on-a-conn-simultaneously", "title": "Do multiple goroutine will invoke a method on a Conn simultaneously?", "body": "<p>My program like this:</p>\n\n<pre><code>func handle(conn net.Conn) {\n    msg := \"hello, world!\"\n    for i:= 0; i&lt; 100000; i++ {\n        go func() {\n            err := write(conn, msg)\n        }\n    }\n\n}\nfunc write(conn net.Conn, msg string) error {\n    mlen := fmt.Sprintf(\"%04d\", len(msg))\n\n    _, err := conn.Write([]byte(mlen + msg))\n    return err\n}\n</code></pre>\n\n<p>The program will run 100000 goroutines at same time, and all goroutines will send message to the same connection\u3002\nI am doubt that server will receive error message like \"hellohelloworldworld\", but there is no problem when the program run in my Ubuntu 14.04LTS.</p>\n\n<p>So, Do multiple goroutine will invoke a method on a Conn simultaneously?</p>\n\n<p>=========================================================================</p>\n\n<p>How can I keep the <code>Write</code> method atomic?</p>\n"}, {"tags": ["regex", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1466417577, "post_id": 37919683, "comment_id": 63290360, "body": "No, you don&#39;t want to process HTML with regexps."}, {"owner": {"reputation": 2182, "user_id": 991076, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1a0377f4f9912163fc86713519db487f?s=128&d=identicon&r=PG", "display_name": "seaguest", "link": "https://stackoverflow.com/users/991076/seaguest"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1466421367, "post_id": 37919683, "comment_id": 63292569, "body": "@Volker, uhmm, the text is not an entire html, it is a news article&#39;s content, what would be the best solution in your opinion? I think  strings.Replace can&#39;t easily match a pattern."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 2, "creation_date": 1466422149, "post_id": 37919683, "comment_id": 63293037, "body": "Use a proper HTML parser. <a href=\"https://godoc.org/golang.org/x/net/html\" rel=\"nofollow noreferrer\"><code>golang.org&#47;x&#47;net&#47;html</code></a> is one option, and you might find <a href=\"https://godoc.org/github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\"><code>github.com&#47;PuerkitoBio&#47;goquery</code></a> useful. Do <a href=\"https://godoc.org/?q=html\" rel=\"nofollow noreferrer\">this search</a> to get an overview of what&#39;s there."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1466422195, "post_id": 37919683, "comment_id": 63293067, "body": "Parsing it as html5 works in a lot of cases, maybe just add a doctype and a &lt;html&gt; manually. Or parse as xml."}, {"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 0, "creation_date": 1466438434, "post_id": 37919683, "comment_id": 63304493, "body": "Of course it supports an argument. Your question is very unclear."}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1466455860, "post_id": 37926804, "comment_id": 63313842, "body": "&gt;bad things will happen <a href=\"http://stackoverflow.com/questions/1732348/regex-match-open-tags-except-xhtml-self-contained-tags/1732454#1732454\" title=\"regex match open tags except xhtml self contained tags\">stackoverflow.com/questions/1732348/&hellip;</a>"}], "tags": [], "owner": {"reputation": 1855, "user_id": 1558705, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e1563795271fe55bf0beab2d12cd69b0?s=128&d=identicon&r=PG", "display_name": "Dean Elbaz", "link": "https://stackoverflow.com/users/1558705/dean-elbaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1466438012, "creation_date": 1466438012, "answer_id": 37926804, "question_id": 37919683, "link": "https://stackoverflow.com/questions/37919683/how-can-i-replace-all-with-argument-in-golang-regex/37926804#37926804", "title": "How can I replace all with argument in Golang regex?", "body": "<p>I agree with the comments, you probably don't want to parse HTML with regular expressions (bad things will happen).</p>\n\n<p>However, let's pretend it's not HTML, and you want to only replace submatches. You could do this</p>\n\n<pre><code>func UpdateText(input string) (string, error) {\n    re, err := regexp.Compile(`img.*?src=\\\"(.*?)\\.(.*?)\\\"`)\n    if err != nil {\n        return \"\", err\n    }\n    indexes := re.FindAllStringSubmatchIndex(input, -1)\n\n    output := input\n    for _, match := range indexes {\n        imgStart := match[2]\n        imgEnd := match[3]\n        newImgName := strings.Replace(input[imgStart:imgEnd], \"m\", \"a\", -1)\n        output = output[:imgStart] + newImgName + input[imgEnd:]\n    }\n    return output, nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/gtU4HjbYoZ\" rel=\"nofollow\">see on playground</a></p>\n\n<p>(note that I've slightly changed your regular expression to match the file extension separately)</p>\n"}, {"tags": [], "owner": {"reputation": 2182, "user_id": 991076, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1a0377f4f9912163fc86713519db487f?s=128&d=identicon&r=PG", "display_name": "seaguest", "link": "https://stackoverflow.com/users/991076/seaguest"}, "is_accepted": false, "score": 1, "last_activity_date": 1466489931, "creation_date": 1466489931, "answer_id": 37936880, "question_id": 37919683, "link": "https://stackoverflow.com/questions/37919683/how-can-i-replace-all-with-argument-in-golang-regex/37936880#37936880", "title": "How can I replace all with argument in Golang regex?", "body": "<p>thanks for kostix's advice, here is my solution using html parser.</p>\n\n<pre><code>func UpdateAllResourcePath(text, prefix string) (string, error) {\n    doc, err := goquery.NewDocumentFromReader(strings.NewReader(text))\n    if err != nil {\n        return \"\", err\n    }\n\n    sel := doc.Find(\"img\")\n    length := len(sel.Nodes)\n    for index := 0; index &lt; length; index++ {\n        imgSrc, ok := sel.Eq(index).Attr(\"src\")\n        if !ok {\n            continue\n        }\n\n        newImgSrc, err := UpdateResourcePath(imgSrc, prefix)    // change the imgsrc here\n        if err != nil {\n            return \"\", err\n        }\n\n        sel.Eq(index).SetAttr(\"src\", newImgSrc)\n    }\n\n    newtext, err := doc.Find(\"body\").Html()\n    if err != nil {\n        return \"\", err\n    }\n\n    return newtext, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 2182, "user_id": 991076, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/1a0377f4f9912163fc86713519db487f?s=128&d=identicon&r=PG", "display_name": "seaguest", "link": "https://stackoverflow.com/users/991076/seaguest"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1081, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1466489931, "creation_date": 1466417054, "last_edit_date": 1466472932, "question_id": 37919683, "link": "https://stackoverflow.com/questions/37919683/how-can-i-replace-all-with-argument-in-golang-regex", "title": "How can I replace all with argument in Golang regex?", "body": "<p>I am using Golang regex package, I want to use regex ReplaceAllStringFunc with argument, not only with the source string.</p>\n\n<p>For example, I want to update this text</p>\n\n<pre><code>\"&lt;img src=\\\"/m/1.jpg\\\" /&gt;  &lt;img src=\\\"/m/2.jpg\\\" /&gt;  &lt;img src=\\\"/m/3.jpg\\\" /&gt;\"\n</code></pre>\n\n<p>To (change \"m\" to \"a\" or anything else):</p>\n\n<pre><code>\"&lt;img src=\\\"/a/1.jpg\\\" /&gt;  &lt;img src=\\\"/a/2.jpg\\\" /&gt;  &lt;img src=\\\"/a/3.jpg\\\" /&gt;\"\n</code></pre>\n\n<p>I would like to have something like:</p>\n\n<pre><code>func UpdateText(text string) string {\n    re, _ := regexp.Compile(`&lt;img.*?src=\\\"(.*?)\\\"`)\n    text = re.ReplaceAllStringFunc(text, updateImgSrc) \n    return text\n}\n\n// update \"/m/1.jpg\" to \"/a/1.jpg\" \nfunc updateImgSrc(imgSrcText, prefix string) string {\n    // replace \"m\" by prefix\n    return \"&lt;img src=\\\"\" + newImgSrc + \"\\\"\"\n}\n</code></pre>\n\n<p>I checked the doc, ReplaceAllStringFunc doesn't support argument, but what would be the best way to achieve my goal?</p>\n\n<p>More generally, I would like to find all occurrences of one pattern then update each with a new string which is composed by source string + a new parameter, could anyone give any idea?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1315, "user_id": 4069345, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/27a9f29823840e2542fd1796e6f5b1ea?s=128&d=identicon&r=PG", "display_name": "joelnb", "link": "https://stackoverflow.com/users/4069345/joelnb"}, "edited": false, "score": 2, "creation_date": 1466420890, "post_id": 37919668, "comment_id": 63292270, "body": "Is the folder you&#39;re trying to build in outside your $GOPATH? If so then go will not look in the vendor folder <a href=\"https://github.com/golang/go/issues/12511\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/12511</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "is_accepted": true, "score": 6, "last_activity_date": 1466425794, "creation_date": 1466425794, "answer_id": 37922637, "question_id": 37919668, "link": "https://stackoverflow.com/questions/37919668/golang-1-6-cannot-find-packages-in-vendor-folder/37922637#37922637", "title": "Golang 1.6 Cannot find packages in vendor folder", "body": "<p>Looking at your example, the folder structure is wrong.\nThe package <code>github.com/docker/libcompose</code> should be in <code>vendor/github.com/docker/libcompose</code> not in <code>vendor/docker/libcompose</code>.</p>\n\n<p>See more <a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder/\" rel=\"noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 13218, "user_id": 446835, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e289c5f2495d3c4a66cc23ffd755d878?s=128&d=identicon&r=PG", "display_name": "Hedge", "link": "https://stackoverflow.com/users/446835/hedge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5985, "favorite_count": 0, "accepted_answer_id": 37922637, "answer_count": 1, "score": 4, "last_activity_date": 1555360857, "creation_date": 1466417005, "last_edit_date": 1555360857, "question_id": 37919668, "link": "https://stackoverflow.com/questions/37919668/golang-1-6-cannot-find-packages-in-vendor-folder", "title": "Golang 1.6 Cannot find packages in vendor folder", "body": "<p>I'm on go version 1.6.2 and am trying to <code>go build</code> an application.\nSeveral dependencies are located inside the <code>vendor</code> folder (e.g <code>vendor/docker/libcompose/</code>) but I get a <code>cannot find package</code> when trying to load them.</p>\n\n<p>Here's an error message:</p>\n\n<pre><code>main.go:10:2: cannot find package \"github.com/docker/libcompose/cli/command\" in any of:\n    /usr/local/opt/go/libexec/src/github.com/docker/libcompose/cli/command (from $GOROOT)\n    /Users/ali/golang/src/github.com/docker/libcompose/cli/command (from $GOPATH)\n</code></pre>\n\n<p>What am I doing do wrong?</p>\n\n<p>The doc says that packages put in the <code>vendor</code> folder are loaded automatically.</p>\n"}, {"tags": ["go", "docker"], "comments": [{"owner": {"reputation": 1254, "user_id": 5035236, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/334edb2698f4c9829c026a69f659a54d?s=128&d=identicon&r=PG&f=1", "display_name": "hawarden_", "link": "https://stackoverflow.com/users/5035236/hawarden"}, "edited": false, "score": 0, "creation_date": 1466431395, "post_id": 37917730, "comment_id": 63299481, "body": "Who downvoted my question, that&#39;s not kind"}], "answers": [{"tags": [], "owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "is_accepted": false, "score": 3, "last_activity_date": 1466411803, "last_edit_date": 1495540727, "creation_date": 1466411803, "answer_id": 37917904, "question_id": 37917730, "link": "https://stackoverflow.com/questions/37917730/run-go-program-without-go-environment/37917904#37917904", "title": "Run go program without Go environment", "body": "<p>You don't need docker or a go SDK environment to run go executables. \nSimply cross compile <a href=\"https://stackoverflow.com/questions/12168873/cross-compile-go-on-osx\">stackoverflow Q: 12168873</a> the go program on the pc you wrote it and copy the binary to the computer with CentOS, given that computer has a supported hardware. </p>\n"}], "owner": {"reputation": 1254, "user_id": 5035236, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/334edb2698f4c9829c026a69f659a54d?s=128&d=identicon&r=PG&f=1", "display_name": "hawarden_", "link": "https://stackoverflow.com/users/5035236/hawarden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 329, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466411803, "creation_date": 1466411236, "question_id": 37917730, "link": "https://stackoverflow.com/questions/37917730/run-go-program-without-go-environment", "title": "Run go program without Go environment", "body": "<p>I wrote a program in Go and I want to launch it in a Docker container, but my company does not have a golang Docker image and refuses to download one. </p>\n\n<p>I only have an image with Java (CentOS). How can I achieve this? Is it possible to run some kind of binary thing which does not need Go environment?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1466409069, "post_id": 37917109, "comment_id": 63285307, "body": "<code>myReq.Request</code>.  Take the Tour of Go, read Effective Go and the language spec."}], "answers": [{"tags": [], "owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "is_accepted": true, "score": 3, "last_activity_date": 1466409399, "creation_date": 1466409399, "answer_id": 37917228, "question_id": 37917109, "link": "https://stackoverflow.com/questions/37917109/how-to-read-an-embedded-field-in-go/37917228#37917228", "title": "How to read an embedded field in Go?", "body": "<p>Let's see what <a href=\"https://golang.org/ref/spec#Struct_types\" rel=\"nofollow\">the language specification</a> says:</p>\n\n<blockquote>\n  <p>The unqualified type name acts as the field name.</p>\n\n<pre><code>// A struct with four anonymous fields of type T1, *T2, P.T3 and *P.T4\nstruct {\n  T1        // field name is T1\n  *T2       // field name is T2\n  P.T3      // field name is T3\n  *P.T4     // field name is T4\n  x, y int  // field names are x and y\n}\n</code></pre>\n</blockquote>\n\n<p>i.e. <code>myReq.Request</code></p>\n"}], "owner": {"reputation": 534, "user_id": 6112213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N48wo.jpg?s=128&g=1", "display_name": "HeadwindFly", "link": "https://stackoverflow.com/users/6112213/headwindfly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "accepted_answer_id": 37917228, "answer_count": 1, "score": 0, "last_activity_date": 1466409479, "creation_date": 1466408973, "last_edit_date": 1466409479, "question_id": 37917109, "link": "https://stackoverflow.com/questions/37917109/how-to-read-an-embedded-field-in-go", "title": "How to read an embedded field in Go?", "body": "<p>I design a new Request structure, but in some scenarios(http.Redirect), I need to get the origin <code>http.Request</code>.</p>\n\n<p>My Request struct:</p>\n\n<pre><code>type Request struct {\n    *http.Request\n}\n\nfunc (r *Request) IsGet() bool {\n    return strings.EqualFold(\"GET\", r.Method)\n}\n</code></pre>\n\n<p>Main function:</p>\n\n<pre><code>    req := http.Request{\n        Method:\"POST\",\n    }\n\n    myReq := &amp;Request{&amp;req}\n\n    // How to get original request.\n    originalReq, ok := (interface{}(*myReq)).(http.Request);\n    if ok {\n        fmt.Printf(\"Method: %s\\n\", originalReq.Method)\n    } else {\n        fmt.Println(\"Failure\")\n    }\n</code></pre>\n"}, {"tags": ["dictionary", "go", "struct", "key", "unique"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1493910970, "post_id": 37916647, "comment_id": 74614004, "body": "I have edited <a href=\"http://stackoverflow.com/a/37916798/6309\">my answer below</a>: you actually can add a kind of <code>preventUseAsKey</code> in your struct."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 4, "last_activity_date": 1493910234, "last_edit_date": 1495540030, "creation_date": 1466407846, "answer_id": 37916798, "question_id": 37916647, "link": "https://stackoverflow.com/questions/37916647/how-can-i-prevent-a-type-being-used-as-a-map-key/37916798#37916798", "title": "How can I prevent a type being used as a map key?", "body": "<p>Your type should <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">not be comparable</a> in order to be unfit as a map key.</p>\n\n<blockquote>\n  <p>Slice, map, and function values are not comparable</p>\n</blockquote>\n\n<p>See <a href=\"https://blog.golang.org/go-maps-in-action#TOC_5.\" rel=\"nofollow noreferrer\">Key Type</a>:</p>\n\n<blockquote>\n  <p>Notably absent from the list are slices, maps, and functions; these types cannot be compared using <code>==</code>, and may not be used as map keys.  </p>\n</blockquote>\n\n<p>So if your type is a slice, map or function, you should get what you need.<br>\nIt could be an \"alias\" (defining a new <a href=\"https://stackoverflow.com/a/19334952/6309\">named type</a>):</p>\n\n<pre><code>type StringSliceWrap []string\ntype MyFunc func(i int)\n</code></pre>\n\n<p>That alias would not be used as a map key.</p>\n\n<hr>\n\n<p>Update 2017: <a href=\"https://twitter.com/bradfitz/status/860145039573385216\" rel=\"nofollow noreferrer\">Brad Fitzpatrick give this tip</a> (adding a slice in your <code>struct</code>) to make sure your type <code>struct</code> is <em>not</em> comparable: See <a href=\"https://play.golang.org/p/tkE2lH6AlQ\" rel=\"nofollow noreferrer\">play.golang.org</a>:</p>\n\n<pre><code>package main\n\n// disallowEqual is an uncomparable type.\n// If you place it first in your struct, you prevent == from\n// working on your struct without growing its size. (Don't put it\n// at the end; that grows the size of the struct)\ntype disallowEqual [0]func()\n\ntype T struct {\n    _ disallowEqual\n    Foo string\n    Bar int\n}\n\nfunc main() {\n    var t1 T\n    var t2 T\n    println(t1 == t2)\n}\n</code></pre>\n\n<p><code>T</code> cannot be used as amp key now!</p>\n"}, {"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 2, "creation_date": 1466427885, "post_id": 37919268, "comment_id": 63296807, "body": "More complete than my answer, and instructive as usual. +1"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1466450456, "last_edit_date": 1466450456, "creation_date": 1466415886, "answer_id": 37919268, "question_id": 37916647, "link": "https://stackoverflow.com/questions/37916647/how-can-i-prevent-a-type-being-used-as-a-map-key/37919268#37919268", "title": "How can I prevent a type being used as a map key?", "body": "<p>I don't see any benefit of disallowing a type being used as a key. It is just an option which may or may not be used, the type will not be any better or smaller or faster just because you forbid to use it as a map key.</p>\n\n<p>But if you want to do it: <a href=\"https://golang.org/ref/spec#Map_types\" rel=\"noreferrer\">Spec: Map types:</a></p>\n\n<blockquote>\n  <p>The <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">comparison operators</a> == and != must be fully defined for operands of the key type; thus the key type must not be a function, map, or slice.</p>\n</blockquote>\n\n<p>So if you can violate the terms of the <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">comparison operators</a>, you implicitly get what you want. You have a <code>struct</code>, terms for the <code>struct</code> types:</p>\n\n<blockquote>\n  <p>Struct values are comparable if all their fields are comparable. Two struct values are equal if their corresponding non-<a href=\"https://golang.org/ref/spec#Blank_identifier\" rel=\"noreferrer\">blank</a> fields are equal.</p>\n</blockquote>\n\n<p>So <code>struct</code> values are only comparable (and thus can only be used as keys in maps) if all their fields are comparable. <strong>Simply add a field whose type is not comparable.</strong></p>\n\n<blockquote>\n  <p>Slice, map, and function values are not comparable.</p>\n</blockquote>\n\n<p>So for example add a field whose type is a slice, and you're done:</p>\n\n<pre><code>type MyType struct {\n    S             string\n    i             int\n    notComparable []int\n}\n</code></pre>\n\n<p>Attempting to use the above <code>MyType</code> as a key:</p>\n\n<pre><code>m := map[MyType]int{}\n</code></pre>\n\n<p>You get a compile-time error:</p>\n\n<pre><code>invalid map key type MyType\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>I wrote about not having any benefit of forbidding the type being a key. It's more than that: from now on you won't be able to use comparison operators on values of your type anymore (because of the extra, non-comparable field), so e.g. you lose the option to compare those values:</p>\n\n<pre><code>p1, p2 := MyType{}, MyType{}\nfmt.Println(p1 == p2)\n</code></pre>\n\n<p>Compile-time error:</p>\n\n<pre><code>invalid operation: p1 == p2 (struct containing []int cannot be compared)\n</code></pre>\n\n<p>Note that with a little trick you could still preserve the comparable nature of your type, e.g. by not exporting your type but a wrapper type which embeds the original one; and add the extra, non-comparable type to the wrapper type, e.g.:</p>\n\n<pre><code>type myType struct {\n    S string\n    i int\n}\n\ntype MyType struct {\n    myType\n    notComparable []int\n}\n\nfunc main() {\n    p1, p2 := MyType{}, MyType{}\n    fmt.Println(p1.myType == p2.myType)\n}\n</code></pre>\n\n<p>This way your <code>myType</code> can remain comparable but still prevent the exported, wrapper <code>MyType</code> type to be used as key type.</p>\n"}], "owner": {"reputation": 99684, "user_id": 149482, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cb6a2b464b7190c48e4f148a0e51d13a?s=128&d=identicon&r=PG", "display_name": "Matt Joiner", "link": "https://stackoverflow.com/users/149482/matt-joiner"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 905, "favorite_count": 1, "accepted_answer_id": 37919268, "answer_count": 2, "score": 5, "last_activity_date": 1493910234, "creation_date": 1466407243, "last_edit_date": 1466439142, "question_id": 37916647, "link": "https://stackoverflow.com/questions/37916647/how-can-i-prevent-a-type-being-used-as-a-map-key", "title": "How can I prevent a type being used as a map key?", "body": "<p>I have a type that can be used as a map key, but I want to prevent this from occurring. I assumed that if the type contained a private member it wouldn't be possible from other packages, but this appears to work anyway. What's the best way to make the type unusable as a map key?</p>\n\n<pre><code>type MyType struct {\n    A *A\n    b b\n\n    preventUseAsKey ?\n}\n</code></pre>\n"}, {"tags": ["go", "floating-point", "rounding", "standards"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1466426250, "post_id": 37915981, "comment_id": 63295617, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/36052922/golang-converting-float64-to-int-error\">Golang converting float64 to int error</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1466405447, "post_id": 37916098, "comment_id": 63283357, "body": "I am dealing with currency in that case your point makes sense i should deal with lowest denominators but still i will  have cases were internally we have to store even the lowest denominators as floating point values   ie , one rate plan could be 0.2 cents per <code>unit</code> service where unit could be a second and i may store 7 seconds usage as 3.5 cents .Once we bill the customer only all these get added and rounded of to lowest denominator.  I did not saw any Round function in golang math package so just wanted to know if there is any best practises used with general usecases"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 1, "creation_date": 1466405717, "post_id": 37916098, "comment_id": 63283481, "body": "WIth currency I would just avoid floats altogether.  If that means you have to store rate as <code>uint64 hundredthsOfACent</code> and then the price they pay as <code>uint64 cents</code> that&#39;s fine. With money it&#39;s just better to completely avoid rounding errors."}, {"owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "edited": false, "score": 0, "creation_date": 1466413053, "post_id": 37916098, "comment_id": 63287561, "body": "For currency calculation you might look for a &#39;decimal&#39; package like <a href=\"https://github.com/EricLagergren/decimal\" rel=\"nofollow noreferrer\">github.com/EricLagergren/decimal</a>"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1482971956, "post_id": 37916098, "comment_id": 69945138, "body": "@dave great thanks , not using <code>float</code> was a great point to note ."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 0, "last_activity_date": 1466405061, "creation_date": 1466405061, "answer_id": 37916098, "question_id": 37915981, "link": "https://stackoverflow.com/questions/37915981/what-is-the-right-way-for-rouding-of-high-precision-error-on-golang-float64-mu/37916098#37916098", "title": "What is the right way for rouding of high precision error on `golang` float64 multiplication", "body": "<p>It depends what the use case is and how many digits you want to show.  You could do:</p>\n\n<pre><code>func main() {\n    var l float64 = 0.2\n    fmt.Printf(\"Hello, playground %.8f\",l*6)\n}\n</code></pre>\n\n<p>and only show 8 units after the decimal.  But if you are dealing with currency, for example, you are better off not using floats at all, and saving everything as cents (in the US) or number of (lowest denomination of currency).</p>\n"}], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1925, "favorite_count": 0, "accepted_answer_id": 37916098, "answer_count": 1, "score": 2, "last_activity_date": 1466405061, "creation_date": 1466404640, "question_id": 37915981, "link": "https://stackoverflow.com/questions/37915981/what-is-the-right-way-for-rouding-of-high-precision-error-on-golang-float64-mu", "title": "What is the right way for rouding of high precision error on `golang` float64 multiplication", "body": "<p>When multiplying golang float64  values  with integers the result contains high precison error values due to the way floating point numbers are stored.\nHere is a code snippet that shows the problem I am referring to </p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n)\n\nfunc main() {\n        var l float64 = 0.2\n    fmt.Println(\"Hello, playground\",l*6)\n}\n</code></pre>\n\n<p>The result is </p>\n\n<pre><code>Hello, playground 1.2000000000000002\n</code></pre>\n\n<p>Here is the play link for the same<a href=\"https://play.golang.org/p/GAFgVy-LBC\" rel=\"nofollow\"> playground</a></p>\n\n<p>Is there a standard/best practise to round of the error ?</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1466403194, "post_id": 37915514, "comment_id": 63282462, "body": "That is golang printing your <code>DB</code> instance. Just what you asked it to do in <code>log.Println(&quot;DB: &quot;, db)</code>. What did you expected to see? Everything seem to be working fine."}, {"owner": {"reputation": 55, "user_id": 6487537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22417856f9f2b8c55c7516e415197f18?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Srinivasan", "link": "https://stackoverflow.com/users/6487537/sai-srinivasan"}, "reply_to_user": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1466404048, "post_id": 37915514, "comment_id": 63282761, "body": "hmm I thought I&#39;d see some form of my database.. Its my first time using golang and mysql. I copied my error as well as the code snippet that was causing it."}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1466404788, "post_id": 37915514, "comment_id": 63283072, "body": "Thanks for including the error. But still I can&#39;t figure out much. Maybe others could help if you include a <a href=\"http://stackoverflow.com/help/mcve\">mcve</a>."}, {"owner": {"reputation": 55, "user_id": 6487537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22417856f9f2b8c55c7516e415197f18?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Srinivasan", "link": "https://stackoverflow.com/users/6487537/sai-srinivasan"}, "reply_to_user": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1466405437, "post_id": 37915514, "comment_id": 63283352, "body": "Thanks for the clarification. I realize that I was looking at a DB instance but the &lt;nil&gt; value at the end began to confuse me. I was expecting something there to represent my database."}, {"owner": {"reputation": 55, "user_id": 6487537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22417856f9f2b8c55c7516e415197f18?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Srinivasan", "link": "https://stackoverflow.com/users/6487537/sai-srinivasan"}, "reply_to_user": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1466406138, "post_id": 37915514, "comment_id": 63283716, "body": "Ive included my code sample that I used for this as well"}], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 6487537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22417856f9f2b8c55c7516e415197f18?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Srinivasan", "link": "https://stackoverflow.com/users/6487537/sai-srinivasan"}, "edited": false, "score": 0, "creation_date": 1466413015, "post_id": 37917249, "comment_id": 63287535, "body": "I made these changes:   database, err = sql.Open(&quot;mysql&quot;, &quot;root:abc@/abc&quot;) db = database   and it throws no error  although inside my addlisthandlerfunction() this query doesnt insert into my database: log.Println(&quot;adding list: &quot;, r.Form[&quot;item&quot;][0]) &lt;-- prints out the text box value db.Exec(&quot;INSERT INTO ListItems(items) Values($1)&quot; , r.Form[&quot;item&quot;][0])"}, {"owner": {"reputation": 55, "user_id": 6487537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22417856f9f2b8c55c7516e415197f18?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Srinivasan", "link": "https://stackoverflow.com/users/6487537/sai-srinivasan"}, "edited": false, "score": 0, "creation_date": 1466414526, "post_id": 37917249, "comment_id": 63288430, "body": "i guess my question would be how would i get my addlisthandler function to be able to access that instance provided by sql.Open(&quot;mysql&quot;, &quot;root:abc@/abc&quot;)?"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 55, "user_id": 6487537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22417856f9f2b8c55c7516e415197f18?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Srinivasan", "link": "https://stackoverflow.com/users/6487537/sai-srinivasan"}, "edited": false, "score": 0, "creation_date": 1466414973, "post_id": 37917249, "comment_id": 63288695, "body": "<a href=\"https://golang.org/pkg/database/sql/#DB.Exec\" rel=\"nofollow noreferrer\">DB.Exec</a> returns a result and an error. Check those."}, {"owner": {"reputation": 55, "user_id": 6487537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22417856f9f2b8c55c7516e415197f18?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Srinivasan", "link": "https://stackoverflow.com/users/6487537/sai-srinivasan"}, "edited": false, "score": 1, "creation_date": 1466494213, "post_id": 37917249, "comment_id": 63325530, "body": "Fixed the error and now the application works :D Thanks for the help."}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 0, "last_activity_date": 1466409458, "creation_date": 1466409458, "answer_id": 37917249, "question_id": 37915514, "link": "https://stackoverflow.com/questions/37915514/error-getting-mysql-connection-using-golang/37917249#37917249", "title": "Error getting mysql connection using golang", "body": "<p>The problem is the global <code>db</code> variable you declare by <code>var db *sql.DB</code> is never assigned a value. So it keeps its default value which is <code>nil</code>. And trying to dereference a nil pointer gives you the error.</p>\n\n<p>You probably think that in the <code>init</code> function you are assigning this variable the newly created <code>DB</code> instance. But <code>:=</code> creates a new local variable to hold the new <code>DB</code> instance. The global <code>db</code> variable is left untouched. See <a href=\"https://play.golang.org/p/JsCOAynUbN\" rel=\"nofollow\">example</a>.</p>\n\n<p>So instead do,</p>\n\n<pre><code>var err error\ndb, err = sql.Open(\"mysql\", \"root:abc@/abc\")\n</code></pre>\n\n<p>Also from my experience using a global variable when you can avoid it leads to errors hard to debug. (like this one.) I think you can avoid it by making <code>connectDb</code> return a <code>DB</code> instance.</p>\n"}], "owner": {"reputation": 55, "user_id": 6487537, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22417856f9f2b8c55c7516e415197f18?s=128&d=identicon&r=PG&f=1", "display_name": "Sai Srinivasan", "link": "https://stackoverflow.com/users/6487537/sai-srinivasan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2665, "favorite_count": 0, "accepted_answer_id": 37917249, "answer_count": 1, "score": 1, "last_activity_date": 1485101937, "creation_date": 1466402658, "last_edit_date": 1485101937, "question_id": 37915514, "link": "https://stackoverflow.com/questions/37915514/error-getting-mysql-connection-using-golang", "title": "Error getting mysql connection using golang", "body": "<p>I'm new to golang and MySQL and I am using a dev box to create a simple web page using golang (code from the 2 files are way down below) to take input, store input into a database and display input on a webpage. Currently using MySQL locally as my database with my username as root and my password as abc, my database is also named abc. </p>\n\n<p>At the top I have imported :</p>\n\n<pre><code>  import (\n      _\"github.com/go-sql-driver/mysql\" \n\n      \"database/sql\"\n  )\n</code></pre>\n\n<p>When I serve my web page I call my connectDB function: </p>\n\n<pre><code> func init(){\n    INDEX_HTML , _ = ioutil.ReadFile(\"./templates/index.html\")\n    connectDb()\n }\n\n func connectDb(){\n    //socket : var/run/mysqld/mysqld.sock\n /* connection string examples : \n  db, err := sql.Open(\"mysql\", \"user:password@/dbname\")\n  user:password@tcp(localhost:5555)/dbname?tls=skip-verify&amp;autocommit=true  \n\n  TCP using default port (3306) on localhost: \n    user:password@tcp/dbname?charset=utf8mb4,utf8&amp;sys_var=esc%40ped\n\n  Use the default protocol (tcp) and host (localhost:3306):\n    user:password@/dbname\n\n  No Database preselected:\n    user:password@/\n*/\n\n   db, err := sql.Open(\"mysql\", \"root:abc@/abc\")\n\n    log.Println(\"DB: \", db)\n\n    checkErr(err)\n\n    // Open doesn't open a connection. Validate DSN data:\n    checkErr(err)\n }\n</code></pre>\n\n<p>My understanding and according to <a href=\"https://github.com/go-sql-driver/mysql\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql</a>\nSQL.open returns a * sql.DB, and when the program hits following code above: </p>\n\n<pre><code>/* At the top of my code i have var db = *sql.DB */\nlog.Println(\"DB: \", db)\n</code></pre>\n\n<p>I get the following in the command prompt with all types of example connection strings noted in the code comments above: </p>\n\n<p><strong>DB:  &amp;{0x99c410 root:abc@/abc 0 {0 0} [] [] 0 0xc820072180 false map[] map[] 0 0 0 &lt; nil >}</strong></p>\n\n<p>My MySQL database is running fine locally through the command line with the given username and password and I can get a few items with the following queries inserted manually. </p>\n\n<pre><code>mysql&gt;\nmysql&gt; select * from ListItems\n     -&gt; ;\n+-------+\n| items |\n+-------+\n| item1 |\n| item2 |\n+-------+\n</code></pre>\n\n<p>I'm trying to understand what the message is and how I can go about connecting to the mysql database to run queries and insert into the database.</p>\n\n<p>Maybe there is something wrong with my connection string? An example of my error while trying to insert into the database: </p>\n\n<pre><code>016/06/20 02:22:36 http: panic serving 10.1.0.5:41861: \nruntime error: invalid    \nmemory address or nil pointer dereference\ngoroutine 7 [running]:\n\nnet/http.(*conn).serve.func1(0xc82006c380)\n    /usr/local/go/src/net/http/server.go:1389 +0xc1\npanic(0x74ef00, 0xc82000a0c0)\n    /usr/local/go/src/runtime/panic.go:443 +0x4e9\ndatabase/sql.(*DB).conn(0x0, 0x1, 0x0, 0x0, 0x0)\n    /usr/local/go/src/database/sql/sql.go:778 +0xac9\ndatabase/sql.(*DB).exec(0x0, 0x812b60, 0x26, 0xc82003fa70, 0x1, 0x1, 0xc82000b201, 0x0, 0x0, 0x0, ...)\n    /usr/local/go/src/database/sql/sql.go:1021 +0x87\ndatabase/sql.(*DB).Exec(0x0, 0x812b60, 0x26, 0xc82003fa70, 0x1, 0x1, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/database/sql/sql.go:1009 +0xbe\nmain.AddListHandler(0x7f56da7ac9b0, 0xc82006f6c0, 0xc8200f21c0)\n    /home/cabox/workspace/src/github.com/user/hello/main.go:26 +0x36c **&lt;---**\nnet/http.HandlerFunc.ServeHTTP(0x859f70, 0x7f56da7ac9b0, 0xc82006f6c0, 0xc8200f21c0)\n    /usr/local/go/src/net/http/server.go:1618 +0x3a\nnet/http.(*ServeMux).ServeHTTP(0xc820010b10, 0x7f56da7ac9b0, 0xc82006f6c0, 0xc8200f21c0)\n    /usr/local/go/src/net/http/server.go:1910 +0x17d\nnet/http.serverHandler.ServeHTTP(0xc82006c180, 0x7f56da7ac9b0, 0xc82006f6c0, 0xc8200f21c0)\n    /usr/local/go/src/net/http/server.go:2081 +0x19e\nnet/http.(*conn).serve(0xc82006c380)\n    /usr/local/go/src/net/http/server.go:1472 +0xf2e\ncreated by net/http.(*Server).Serve\n    /usr/local/go/src/net/http/server.go:2137 +0x44e\n</code></pre>\n\n<p>As I look at line 26 in main.go I have: </p>\n\n<pre><code>  db.Exec(\"INSERT INTO ListItems(items) Values(?)\" , (r.Form[\"item\"][0]))\n</code></pre>\n\n<p><strong>Here is the minimal code sample:</strong></p>\n\n<p><strong>project/templates/index.html:</strong> </p>\n\n<pre><code>&lt;!doctype html&gt;\n\n&lt;h1&gt;Enter item to add to list:&lt;/h1&gt;&lt;br&gt;\n&lt;form action=\"/addlist\" method=\"post\"&gt;\n&lt;input type=\"text\" name=\"item\" placeholder=\"Enter Item to add to list\"&gt;&lt;br&gt;\n&lt;input type =\"submit\" class=\"add\" value=\"Add To List\"&gt;&lt;br&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p><strong>projects/main.go ..  using go build main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n \"net/http\"\n \"fmt\"\n \"io/ioutil\"\n \"log\"\n_\"github.com/go-sql-driver/mysql\"\n \"database/sql\"\n)\n\nvar  INDEX_HTML []byte // holds the raw html of index.html inside /templates\nvar db *sql.DB // pointer to sql.open which returns a sql.db \n\n\nfunc main(){\n   fmt.Println(\"starting server on port 8080\")\n   http.HandleFunc(\"/\", IndexHandler)\n   http.HandleFunc(\"/addlist\", AddListHandler)\n   http.ListenAndServe(\":8080\", nil)\n\n}\n\nfunc AddListHandler(w http.ResponseWriter, r *http.Request){\n  r.ParseForm()\n  log.Println(\"adding list: \", r.Form[\"item\"][0])\n  db.Exec(\"INSERT INTO ListItems(items) Values(?)\" , (r.Form[\"item\"][0])) /*error*/\n  if(db == nil){log.Println(\"DB is nill\")}\n\n  http.Redirect(w,r,\"/\", http.StatusTemporaryRedirect)\n}\n\nfunc IndexHandler(w http.ResponseWriter, r *http.Request){\n  log.Println(\"GET /\")\n  w.Write(INDEX_HTML)\n}\n\nfunc init(){\n  INDEX_HTML , _ = ioutil.ReadFile(\"./templates/index.html\")\n  connectDb()\n}\n\nfunc connectDb(){\n  //socket : var/run/mysqld/mysqld.sock\n  /* connection string examples : \n   db, err := sql.Open(\"mysql\", \"user:password@/dbname\")\n   user:password@tcp(localhost:5555)/dbname?tls=skip-verify&amp;autocommit=true   \n   TCP using default port (3306) on localhost: \n     user:password@tcp/dbname?charset=utf8mb4,utf8&amp;sys_var=esc%40ped\n  Use the default protocol (tcp) and host (localhost:3306):\n    user:password@/dbname\n  No Database preselected:\n    user:password@/\n  */\n\n    db, err := sql.Open(\"mysql\", \"root:abc@/abc\")\n    log.Println(\"DB: \", db)\n    checkErr(err)\n\n   // Open doesn't open a connection. Validate DSN data:\n    checkErr(err)\n }\n\n func checkErr(err error) {\n    if err != nil {\n      log.Println(err)\n    }else{\n      log.Println(err)\n    }\n }\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 4943865, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4YKShyXTt18/AAAAAAAAAAI/AAAAAAAAOH8/c-OPBCXp9gQ/photo.jpg?sz=128", "display_name": "Sivaram Kannan", "link": "https://stackoverflow.com/users/4943865/sivaram-kannan"}, "edited": false, "score": 0, "creation_date": 1466388242, "post_id": 37913626, "comment_id": 63279094, "body": "I am familiar with json parsing in golang. This specific format is what I am not able to parse <code>{  &quot;top1&#47;dir1&quot;: &quot;10, &quot;top1&#47;dir2&quot;: &quot;20&quot; }</code>"}, {"owner": {"reputation": 288, "user_id": 6472660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DR13T.jpg?s=128&g=1", "display_name": "Jonathan Jeffrey", "link": "https://stackoverflow.com/users/6472660/jonathan-jeffrey"}, "reply_to_user": {"reputation": 21, "user_id": 4943865, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4YKShyXTt18/AAAAAAAAAAI/AAAAAAAAOH8/c-OPBCXp9gQ/photo.jpg?sz=128", "display_name": "Sivaram Kannan", "link": "https://stackoverflow.com/users/4943865/sivaram-kannan"}, "edited": false, "score": 1, "creation_date": 1466388378, "post_id": 37913626, "comment_id": 63279116, "body": "@SivaramKannan You should probably specify what you want the end result of the parsing to be to help us find an answer, right now your question is pretty vague, hence the downvotes."}, {"owner": {"reputation": 21, "user_id": 4943865, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4YKShyXTt18/AAAAAAAAAAI/AAAAAAAAOH8/c-OPBCXp9gQ/photo.jpg?sz=128", "display_name": "Sivaram Kannan", "link": "https://stackoverflow.com/users/4943865/sivaram-kannan"}, "edited": false, "score": 0, "creation_date": 1466391375, "post_id": 37913626, "comment_id": 63279559, "body": "Sorry about the vague question. I have updated my original post with the formatted json and the go code I am using to parse."}], "tags": [], "owner": {"reputation": 288, "user_id": 6472660, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DR13T.jpg?s=128&g=1", "display_name": "Jonathan Jeffrey", "link": "https://stackoverflow.com/users/6472660/jonathan-jeffrey"}, "is_accepted": true, "score": 7, "last_activity_date": 1466392699, "last_edit_date": 1466392699, "creation_date": 1466387068, "answer_id": 37913626, "question_id": 37913601, "link": "https://stackoverflow.com/questions/37913601/json-parsing-in-golang/37913626#37913626", "title": "Json Parsing in Golang", "body": "<p>There is a Go package with methods for decoding JSON strings.</p>\n\n<p><a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\">https://golang.org/pkg/encoding/json/#Unmarshal</a></p>\n\n<p>Here is an example of usage:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\nfunc main() {\n    var jsonBlob = []byte(`[\n        {\"Name\": \"Platypus\", \"Order\": \"Monotremata\"},\n        {\"Name\": \"Quoll\",    \"Order\": \"Dasyuromorphia\"}\n    ]`)\n    type Animal struct {\n        Name  string\n        Order string\n    }\n    var animals []Animal\n    err := json.Unmarshal(jsonBlob, &amp;animals)\n    if err != nil {\n        fmt.Println(\"error:\", err)\n    }\n    fmt.Printf(\"%+v\", animals)\n}\n</code></pre>\n\n<p>EDIT: As pointed out by Malik, the type of the value whose pointer you pass is wrong. In this case, your type should be <code>map[string]interface{}</code> (preferably, because a JSON field might not store a string) or <code>map[string]string</code> instead of <code>[]map[string]string</code>. The brackets at the beginning are wrong: such would be an array of JSON objects.</p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 5708888, "user_type": "registered", "profile_image": "https://graph.facebook.com/563820343771636/picture?type=large", "display_name": "Malek Katabi", "link": "https://stackoverflow.com/users/5708888/malek-katabi"}, "is_accepted": false, "score": 0, "last_activity_date": 1466389229, "creation_date": 1466389229, "answer_id": 37913827, "question_id": 37913601, "link": "https://stackoverflow.com/questions/37913601/json-parsing-in-golang/37913827#37913827", "title": "Json Parsing in Golang", "body": "<p>Jonathan's answer provides a good example of decoding JSON, and links the relevant package. You don't provide much detail on what exactly is going wrong with your parsing, but if I had to take a guess I would say you're probably not creating an appropriate struct to contain the JSON once it is unmarshalled. Because Go is statically typed, it expects data to adhere to explicitly defined formats.</p>\n\n<p>If you don't want to go to the trouble of defining structs, you could just use an empty interface object, which is sort of a catch all in Go. Simply declare a variable with the type []interface{}, and then pass it into the JSON unmarshal function. Hope this helps!</p>\n"}, {"tags": [], "owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "is_accepted": false, "score": 1, "last_activity_date": 1466400967, "creation_date": 1466400967, "answer_id": 37915206, "question_id": 37913601, "link": "https://stackoverflow.com/questions/37913601/json-parsing-in-golang/37915206#37915206", "title": "Json Parsing in Golang", "body": "<p>It's just that you have a small typo in your program. You've declared <code>mytype</code> as a slice of maps, rather than just a map.</p>\n\n<p>Just change:</p>\n\n<pre><code>type mytype []map[string]string\n</code></pre>\n\n<p>To:</p>\n\n<pre><code>type mytype map[string]string\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/pZQl8jV5TC\" rel=\"nofollow\">https://play.golang.org/p/pZQl8jV5TC</a> for an example.</p>\n"}], "owner": {"reputation": 21, "user_id": 4943865, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4YKShyXTt18/AAAAAAAAAAI/AAAAAAAAOH8/c-OPBCXp9gQ/photo.jpg?sz=128", "display_name": "Sivaram Kannan", "link": "https://stackoverflow.com/users/4943865/sivaram-kannan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3206, "favorite_count": 0, "accepted_answer_id": 37913626, "answer_count": 3, "score": -5, "last_activity_date": 1466400967, "creation_date": 1466386775, "last_edit_date": 1466391317, "question_id": 37913601, "link": "https://stackoverflow.com/questions/37913601/json-parsing-in-golang", "title": "Json Parsing in Golang", "body": "<p>I am trying to parse a json from a third party software. It returns a json like this</p>\n\n<pre><code>{ \n   \"top1/dir1\": \"10\",\n   \"top1/dir2\": \"20\",\n   \"top1/dir3\": \"30\",\n   \"top2/diff_val1\": \"40\"\n}\n</code></pre>\n\n<p>JSONLint says this is a valid json. But I could not figure how I can parse this with golang. </p>\n\n<p>The code I used to parse the json file above (to be clear I took the code from another stackoverflow post). </p>\n\n<pre><code>package main\n\nimport (\n        \"encoding/json\"\n        \"fmt\"\n        \"io/ioutil\"\n        \"log\"\n)\n\ntype mytype []map[string]string\n\nfunc main() {\n        var data mytype\n        file, err := ioutil.ReadFile(\"t1.json\")\n        if err != nil {\n                log.Fatal(err)\n        }\n        err = json.Unmarshal(file, &amp;data)\n        if err != nil {\n                log.Fatal(err)\n        }\n        fmt.Println(data)\n}\n</code></pre>\n\n<p>When I do a go run main.go, I get the below error </p>\n\n<p>$ go run main.go\n2016/06/19 22:53:57 json: cannot unmarshal object into Go value of type main.mytype\nexit status 1</p>\n\n<p>I did try to parse this format with another library - \"github.com/Jeffail/gabs\", but was unsuccessful. Since this is a valid json, I am pretty sure this can be parsed, but I am not sure how.</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "is_accepted": true, "score": 1, "last_activity_date": 1466365012, "creation_date": 1466365012, "answer_id": 37911095, "question_id": 37910994, "link": "https://stackoverflow.com/questions/37910994/correct-appengine-golang-package-for-oauth2-provider/37911095#37911095", "title": "Correct AppEngine Golang package for OAuth2 provider", "body": "<p>Solution:</p>\n\n<ol>\n<li>Change all <code>\"appengine</code> imports to <code>\"google.golang.org/appengine</code></li>\n<li>Keep use <code>context.Context</code> (from <code>golang.org/x/net/context</code>) instead of <code>appengine.Context</code></li>\n</ol>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 179, "favorite_count": 0, "accepted_answer_id": 37911095, "answer_count": 1, "score": 1, "last_activity_date": 1466365012, "creation_date": 1466364319, "question_id": 37910994, "link": "https://stackoverflow.com/questions/37910994/correct-appengine-golang-package-for-oauth2-provider", "title": "Correct AppEngine Golang package for OAuth2 provider", "body": "<p>What's the correct way to use OAuth with </p>\n\n<p>If I use <code>context.Context</code> from <code>golang.org/x/net/context</code>, the error is:</p>\n\n<pre><code>\"golang.org/x/net/context\".Context does not implement \"appengine\".Context (missing Call method)\n</code></pre>\n\n<p>But if I use <code>appengine.Context</code> from <code>appengine</code> (SDK), the error is:</p>\n\n<pre><code>cannot use oauth2.NewClient(c) (type *http.Client) as type \"golang.org/x/net/context\".Context in argument to provider.Client:\n*http.Client does not implement \"golang.org/x/net/context\".Context (missing Deadline method)\n</code></pre>\n\n<p>if I use <code>oauth2.NoContext</code>, the runtime error is</p>\n\n<pre><code>Post https://accounts.google.com/o/oauth2/token: not an App Engine context\n</code></pre>\n\n<p>both tested using Go 1.4 and 1.7b3</p>\n\n<p>using this piece of code:</p>\n\n<pre><code>func Public_YoutubeOauth(w http.ResponseWriter, r *http.Request) {\n    c := appengine.NewContext(r)\n    provider, csrf := getOAuth(r)\n    gets, err := url.ParseQuery(r.URL.RawQuery)\n    if RenderHtmlIfError(w,err) {\n        return\n    }\n    if csrf != gets.Get(`state`) {\n        RenderHtmlError(w,`incorrect CSRF state`)\n        return\n    }\n    code := gets.Get(`code`)\n    token, err := provider.Exchange(c, code) // error here\n    if RenderHtmlIfError(w,err) {\n        return\n    }\n    RenderHtml(w,`page`,map[string]interface{`token`:token})\n}\n</code></pre>\n\n<p>the <code>provider</code> was:</p>\n\n<pre><code>&amp;oauth2.Config{\n        ClientID:     `aaa`,\n        ClientSecret: `bbb`,\n        RedirectURL:  url + `/foo/youtube_oauth`,\n        Scopes: []string{\n            `openid`,\n            `email`,\n            `profile`,\n            `https://www.googleapis.com/auth/youtube`,\n        },\n        Endpoint: google.Endpoint,\n    }\n</code></pre>\n\n<p>What's the correct way to solve this?</p>\n"}, {"tags": ["email", "ssl", "go"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 1, "creation_date": 1466367582, "post_id": 37910175, "comment_id": 63274785, "body": "Have you tried <a href=\"https://golang.org/pkg/net/smtp/#Client.StartTLS\" rel=\"nofollow noreferrer\">StartTLS</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 5800226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a483dc8d5e2c2e9e0afe2006085bb6?s=128&d=identicon&r=PG&f=1", "display_name": "user5800226", "link": "https://stackoverflow.com/users/5800226/user5800226"}, "edited": false, "score": 0, "creation_date": 1466474137, "post_id": 37922241, "comment_id": 63318934, "body": "Yes I figured out that adding the tls port number works, but SendMail has a function &quot;StartTLS&quot; which I&#39;m guessing it calls on its own (switches to TLS if possible)?"}], "tags": [], "owner": {"reputation": 54647, "user_id": 45786, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/a7207f83a52e35e43e886c49f6a893a2?s=128&d=identicon&r=PG", "display_name": "TheHippo", "link": "https://stackoverflow.com/users/45786/thehippo"}, "is_accepted": false, "score": 0, "last_activity_date": 1466424556, "creation_date": 1466424556, "answer_id": 37922241, "question_id": 37910175, "link": "https://stackoverflow.com/questions/37910175/golang-net-smtp-send-email-over-tls/37922241#37922241", "title": "Golang net/smtp send email over tls", "body": "<p>The easiest way is to use the <a href=\"https://golang.org/pkg/net/smtp/#SendMail\" rel=\"nofollow\"><code>SendMail</code></a> function. From the docs:</p>\n\n<blockquote>\n  <p>SendMail connects to the server at addr, switches to TLS if possible, authenticates with the optional mechanism a if possible, and then sends an email from address from, to addresses to, with message msg. The addr must include a port, as in \"mail.example.com:smtp\".     </p>\n</blockquote>\n"}], "owner": {"reputation": 107, "user_id": 5800226, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f5a483dc8d5e2c2e9e0afe2006085bb6?s=128&d=identicon&r=PG&f=1", "display_name": "user5800226", "link": "https://stackoverflow.com/users/5800226/user5800226"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3917, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466424556, "creation_date": 1466358929, "question_id": 37910175, "link": "https://stackoverflow.com/questions/37910175/golang-net-smtp-send-email-over-tls", "title": "Golang net/smtp send email over tls", "body": "<p>The <a href=\"https://github.com/golang/go/wiki/SendingMail\" rel=\"nofollow\">wiki example</a> shows an example of sending mail on port 25, but Google SMTP Server requires tls over port 465. Can someone show an example using tls?</p>\n"}, {"tags": ["c++", "go", "cgo"], "comments": [{"owner": {"reputation": 2113, "user_id": 1927176, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d4YlH.jpg?s=128&g=1", "display_name": "fnc12", "link": "https://stackoverflow.com/users/1927176/fnc12"}, "edited": false, "score": 1, "creation_date": 1466359442, "post_id": 37909324, "comment_id": 63272486, "body": "Show your code please"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466432571, "post_id": 37909324, "comment_id": 63300375, "body": "cgo can&#39;t talk directly with C++, you need to call it through a C function. Unless you provide it, there is no type information passed into the C/C++ code, which may have been compiled ahead of time, and linked via a shared library."}], "owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 156, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1466360564, "creation_date": 1466353243, "last_edit_date": 1466360564, "question_id": 37909324, "link": "https://stackoverflow.com/questions/37909324/cgo-go-struct-reflection-in-c", "title": "cgo: Go struct reflection in C++?", "body": "<p>I need to pass unknown Go struct to C++ code and iterate over struct fields in C++. Is it possible to reflect Go struct in C++ code (called from go via cgo)?</p>\n\n<p>Lets assume I have a struct</p>\n\n<pre><code>type Zuzu struct {\n    name string\n    age float32\n    arr []int\n}\n</code></pre>\n\n<p>I create an instance of this struct and pass it to C++ code:</p>\n\n<pre><code>var x = &amp;Zuzu{}\nfunction_cpp( x ) // call C++ code\n</code></pre>\n\n<p>The <code>function_cpp()</code> must be able to \"traverse\" the x and get access to each type and each member of the <code>Zuzu</code> instance pointed by <code>x</code> without the prior knowledge of the <code>Zuzu</code> type.</p>\n"}, {"tags": ["json", "web-services", "http", "reactjs", "go"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 2, "creation_date": 1466358122, "post_id": 37909321, "comment_id": 63272087, "body": "I think you might have better luck with WebSockets"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 1, "creation_date": 1466413676, "post_id": 37909321, "comment_id": 63287960, "body": "As @AmmarBandukwala mentioned, <a href=\"http://www.gorillatoolkit.org/pkg/websocket\" rel=\"nofollow noreferrer\">websockets</a> is the way to go."}, {"owner": {"reputation": 14998, "user_id": 212378, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/185aae2d842026d2eefa7528b00b394b?s=128&d=identicon&r=PG", "display_name": "Alexis Wilke", "link": "https://stackoverflow.com/users/212378/alexis-wilke"}, "edited": false, "score": 0, "creation_date": 1570637372, "post_id": 37909321, "comment_id": 102978052, "body": "You could also consider HTTP/2 which is similar to websockets. All browsers do not implement it but most do today."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 3423564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fb70c3bf423a4c03516f0dd02e560538?s=128&d=identicon&r=PG&f=1", "display_name": "Silentmoose", "link": "https://stackoverflow.com/users/3423564/silentmoose"}, "is_accepted": false, "score": 0, "last_activity_date": 1466355134, "creation_date": 1466355134, "answer_id": 37909610, "question_id": 37909321, "link": "https://stackoverflow.com/questions/37909321/sending-continuous-data-over-http-with-go/37909610#37909610", "title": "Sending continuous data over HTTP with Go", "body": "<p>Go does have a keep alive ability net.TCPConn's SetKeepAlive</p>\n\n<pre><code>kaConn, _ := tcpkeepalive.EnableKeepAlive(conn)\nkaConn.SetKeepAliveIdle(30*time.Second)\nkaConn.SetKeepAliveCount(4)\nkaConn.SetKeepAliveInterval(5*time.Second)\n</code></pre>\n\n<p>Code from <a href=\"http://felixge.de/2014/08/26/tcp-keepalive-with-golang.html\" rel=\"nofollow\">felixqe</a></p>\n"}, {"tags": [], "owner": {"reputation": 437, "user_id": 5703088, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/42401107371e220d139a8116e5b3abcc?s=128&d=identicon&r=PG&f=1", "display_name": "ALEENA JOHN", "link": "https://stackoverflow.com/users/5703088/aleena-john"}, "is_accepted": false, "score": -1, "last_activity_date": 1466355384, "creation_date": 1466355384, "answer_id": 37909648, "question_id": 37909321, "link": "https://stackoverflow.com/questions/37909321/sending-continuous-data-over-http-with-go/37909648#37909648", "title": "Sending continuous data over HTTP with Go", "body": "<p>You can use restapi as webservice and can sent data as a json.SO you can continously sent data over a communication channel. </p>\n"}, {"tags": [], "owner": {"reputation": 570, "user_id": 2804068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bba54618c0b0ddabd4b666cf96002f4a?s=128&d=identicon&r=PG&f=1", "display_name": "ABri", "link": "https://stackoverflow.com/users/2804068/abri"}, "is_accepted": true, "score": 2, "last_activity_date": 1466413839, "creation_date": 1466413839, "answer_id": 37918591, "question_id": 37909321, "link": "https://stackoverflow.com/questions/37909321/sending-continuous-data-over-http-with-go/37918591#37918591", "title": "Sending continuous data over HTTP with Go", "body": "<p>i would use https websockets to achieve this effect rather than a long persisting tcp.con or even in addition to this. see the golang.org/x/net/websocket package from the go developers or the excellent <a href=\"http://www.gorillatoolkit.org/pkg/websocket\" rel=\"nofollow\">http://www.gorillatoolkit.org/pkg/websocket</a> from gorilla web toolkit for use details. You might use padding and smaller subunits to allow interruption and restart of submission // or a kind of diff protocol to rewrite previously submitted JSON. i found websocket pretty stable even with small connection breakdowns.   </p>\n"}], "owner": {"reputation": 320, "user_id": 3529271, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/NmPnP.jpg?s=128&g=1", "display_name": "Mr. Foots", "link": "https://stackoverflow.com/users/3529271/mr-foots"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 249, "favorite_count": 1, "accepted_answer_id": 37918591, "answer_count": 3, "score": 0, "last_activity_date": 1570637307, "creation_date": 1466353231, "last_edit_date": 1570637307, "question_id": 37909321, "link": "https://stackoverflow.com/questions/37909321/sending-continuous-data-over-http-with-go", "title": "Sending continuous data over HTTP with Go", "body": "<p>I am currently working on a web service in Go that essentially takes a request and sends back JSON, rather typical. However, this particular JSON takes 10+ seconds to actually complete and return. Because I am also making a website that depends on the JSON, and the JSON contents are subject to change, I implemented a route that quickly generates and returns (potentially updated or new) names as placeholders that would get replaced later by real values that correspond to the names. The whole idea behind that is the website would connect to the service, get back JSON almost immediately to populate a table, then wait until the actual data to fill in came back from the service.</p>\n\n<p>This is where I encounter an issue, potentially because I am newish to Go and don't understand its vast libraries completely. The previous method that I used to send JSON back through the HTTP requests was ResponseWriter.Write(theJSON). However, Write() terminates the response, so the website would have to continually ping the service which could now and will be disastrous in the future</p>\n\n<p>So, I am seeking some industry knowledge into my issue. Can HTTP connections be continuous like that, where data is sent piecewise through the same http request? Is that even a computationally or security smart feature, or are there better ways to do what I am proposing? Finally, does Go even support a feature like that, and how would I asynchronously handle it for performance optimization?</p>\n\n<p>For the record, my website is using React.js.</p>\n"}, {"tags": ["macos", "go", "containers", "sandbox"], "owner": {"reputation": 101, "user_id": 887116, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16a204338b100e0ed0f9c05b58eafefe?s=128&d=identicon&r=PG", "display_name": "liudanking", "link": "https://stackoverflow.com/users/887116/liudanking"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 253, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1466350291, "creation_date": 1466350291, "question_id": 37908876, "link": "https://stackoverflow.com/questions/37908876/how-to-access-resource-files-of-an-os-x-sandbox-app-written-in-golang", "title": "How to access resource files of an OS X sandbox app written in Golang?", "body": "<p>I packaged a <strong>Golang</strong> application into a OSX pkg file:</p>\n\n<p><code>productbuild --component  foo.app /Applications --sign \"test\" foo.pkg</code></p>\n\n<p>I can install the pkg file successfully, but can NOT launch it. </p>\n\n<p>Because it can NOT read any files in the <code>/Application/foo.app/Content/Resources</code>.</p>\n\n<p>I know that the app is running in a sandbox, and it can only read/write <code>~/Library/Containers/foo</code> folder.</p>\n\n<p>Basically, there are two ways may let access files int resources folder:</p>\n\n<ol>\n<li><p>Is there any APIs(Golang) available to visite files in <code>~/Library/Containers/foo</code>?</p></li>\n<li><p>Can I make <code>/Application/foo.app/Content/Resources</code> be installed to <code>~/Library/Containers/foo</code>? If so, how to package the app?</p></li>\n</ol>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466345739, "post_id": 37907679, "comment_id": 63268319, "body": "100% coverage isn&#39;t a useful metric."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466347499, "post_id": 37907679, "comment_id": 63268865, "body": "you may find <a href=\"https://github.com/smartystreets/assertions\" rel=\"nofollow noreferrer\">github.com/smartystreets/assertions</a> helpful"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1466348658, "post_id": 37907679, "comment_id": 63269208, "body": "<code>readConfig</code> looks like a very important method,  It could be powerful to test its logic independent of the filesystem."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 1, "creation_date": 1466349256, "post_id": 37907679, "comment_id": 63269373, "body": "100% coverage is to be avoided at all cost. Also, it does not ensure the rightfulness of you program."}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 5, "last_activity_date": 1466346087, "creation_date": 1466346087, "answer_id": 37908222, "question_id": 37907679, "link": "https://stackoverflow.com/questions/37907679/go-unit-testing-fatals-and-testing-main/37908222#37908222", "title": "Go Unit-Testing fatals and testing main()", "body": "<p>it's not a Go thing per-se, it depends on your preference, but: </p>\n\n<p>a. don't test <code>main</code>. main should only invoke tested code, preferably in other packages. Provide as much code coverage as you can to those packages, and leave main as trivial as possibly. That's a good practice regardless of coverage. So that's not really a problem. </p>\n\n<p>b. Don't use <code>log.Fatal</code> for testable code, just return errors. You can keep <code>log.Fatal</code> in application init code, i.e. - in <code>main</code> :). So if main calls <code>readConfig</code> and it fails, it just returns an error (very testable!). The added application behavior of <code>log.Fatal</code> is main's job - the configuration reader shouldn't handle things like deciding if we should quit the application, right? It just reads configurations and tells you if it succeeded. The application decides what to do with it.</p>\n\n<p>So your code might look like:</p>\n\n<pre><code>func readConfig(path string) (Config, error) {\n    var cfg Config\n    file, err := ioutil.ReadFile(path)\n    if err != nil {\n        return cfg, err\n    }\n    err = json.Unmarshal(file, &amp;cfg)\n    if err != nil {\n        return cfg, err\n    }\n    return cfg, nil\n}\n\nfunc main() {\n    config, err := readConfig(\"config.json\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n}\n</code></pre>\n\n<p>And now you've separated logic from application behavior, and <code>readConfig</code> is perfectly testable. </p>\n"}], "owner": {"reputation": 1282, "user_id": 3648229, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6b730f6984c01d9409a83abacb234580?s=128&d=identicon&r=PG", "display_name": "gempir", "link": "https://stackoverflow.com/users/3648229/gempir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "accepted_answer_id": 37908222, "answer_count": 1, "score": 2, "last_activity_date": 1466346087, "creation_date": 1466342371, "question_id": 37907679, "link": "https://stackoverflow.com/questions/37907679/go-unit-testing-fatals-and-testing-main", "title": "Go Unit-Testing fatals and testing main()", "body": "<p>I'm pretty new to go testing coming from a background of PHP with PHPUnit tests.</p>\n\n<p>In PHP it's pretty much reliously preached that you need 100% coverage. \nIn Go most stuff i've read about tests seem to minimal, without stuff like provoking errors.</p>\n\n<p>For example my small program:</p>\n\n<pre><code>func main() {\n    config = readConfig(\"config.json\")\n}\n\nfunc readConfig(path string) Config {\n    var cfg Config\n    file, err := ioutil.ReadFile(path)\n    if err != nil {\n        log.Fatal(err)\n    }\n    err = json.Unmarshal(file, &amp;cfg)\n    if err != nil {\n        log.Fatal(err)\n    }\n    return cfg\n}\n\nfunc TestCanReadConfig(t *testing.T) {\n    cfg := readConfig(\"test_data/config.json\")\n    if cfg.Broker_pass != \"test\" || cfg.Broker_port != \"3333\" {\n        t.Error(\"invalid config\")\n    }\n}\n</code></pre>\n\n<p>now in my example I would have issues with coverage because main() isn't covered at all in Unit tests (How should it?)</p>\n\n<p>And the 2 log.Fatal()'s are not covered at all.</p>\n\n<p>My question is how do I write my tests exactly in go? Do I do it in a less strict style not testing every possible scenario or can I do annotation like in php with \n<code>@expectedException \\InvalidArgumentException</code> \nCan I or should I test the main function? If not can I ignore it from the coverage tool somehow? Should I consider a testing framework?\nMost testing tutorial are nice but very short and only introducing simple tests.</p>\n"}, {"tags": ["mysql", "json", "go"], "answers": [{"comments": [{"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 0, "creation_date": 1466347773, "post_id": 37908283, "comment_id": 63268967, "body": "High quality answer"}, {"owner": {"reputation": 690, "user_id": 2642983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iewWA.png?s=128&g=1", "display_name": "Roberto Milani", "link": "https://stackoverflow.com/users/2642983/roberto-milani"}, "edited": false, "score": 0, "creation_date": 1466713707, "post_id": 37908283, "comment_id": 63446596, "body": "Thanks for your answer but I didn&#39;t understand some things: 1) when you define the var v struct, what name I have to assign to the Customer array inside the struct? I&#39;ve written &quot;Data&quot; but I got an &quot;unresolved reference &#39;Data&#39;. :( 2) when I write if rows.Err() != nil it says: Unresolved type &#39;nil&#39;, how can I fix this? Have I to import something more? 3) I&#39;ve defined a variable as: \tvar p[] byte, then I&#39;ve written p, errorsMarsh := json.Marshal(v) but it says &quot;unused variable p&quot; but it is not true, am I missing something? thanks in advance"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1466726633, "post_id": 37908283, "comment_id": 63451360, "body": "1) I fixed typo re: data.  2) nil is a <a href=\"https://golang.org/ref/spec#Predeclared_identifiers\" rel=\"nofollow noreferrer\">predeclared identifier</a>. No need to import anything to use it. 3) my example code uses a short variable declaration, you don&#39;t need to declare <code>p</code>."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 9, "last_activity_date": 1466726463, "last_edit_date": 1466726463, "creation_date": 1466346469, "answer_id": 37908283, "question_id": 37907401, "link": "https://stackoverflow.com/questions/37907401/iterate-mysql-records-and-create-a-json-in-golang/37908283#37908283", "title": "Iterate MySQL records and create a JSON in GoLang", "body": "<p><a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"noreferrer\">Export</a> fields so they can be used on JSON:</p>\n\n<pre><code>type Customer struct {\n   ID      int         `json:\"id\"`\n   Name    string      `json:\"name\"`\n   Surname string      `json:\"surname\"`\n}\n</code></pre>\n\n<p>Declare a value to be marshaled to JSON:</p>\n\n<pre><code>var v struct {\n    Data []Customer `json:\"data\"`\n}\n</code></pre>\n\n<p>Query for the specific fields:</p>\n\n<pre><code>var queryStr string = \"SELECT id, name, surname FROM Customers\"\nrows, err := db.Query(queryStr)\n</code></pre>\n\n<p>Loop through rows adding to value.</p>\n\n<pre><code>defer rows.Close()\nfor rows.Next() {\n    // Scan one customer record\n    var c Customer\n    if err := rows.Scan(&amp;c.ID, &amp;c.Name, &amp;c.Surnmae); err != nil {\n        // handle error\n    }\n    v.Data = append(v.Data, c)\n}\nif rows.Err() != nil {\n    // handle error\n}\n</code></pre>\n\n<p>Marshal the value to JSON</p>\n\n<pre><code>p, err := json.Marshal(v)\nif err != nil {\n    // handle error\n}\n</code></pre>\n\n<p>The value <code>p</code> is a []byte containing the JSON.</p>\n"}], "owner": {"reputation": 690, "user_id": 2642983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/iewWA.png?s=128&g=1", "display_name": "Roberto Milani", "link": "https://stackoverflow.com/users/2642983/roberto-milani"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2508, "favorite_count": 1, "accepted_answer_id": 37908283, "answer_count": 1, "score": 2, "last_activity_date": 1466726463, "creation_date": 1466340513, "question_id": 37907401, "link": "https://stackoverflow.com/questions/37907401/iterate-mysql-records-and-create-a-json-in-golang", "title": "Iterate MySQL records and create a JSON in GoLang", "body": "<p>I'm trying to read data from a MySQL database from my Go app.</p>\n\n<pre><code>var queryStr string = \"SELECT * FROM Customers\"\nrows, err := db.Query(queryStr)\n\ndefer rows.Close()\nfor rows.Next() {\n    // do stuffs\n}\n</code></pre>\n\n<p>The query it's ok and it works; now I'd like to easily map each record of the MySQL query to a Customer object that I've previuosly defined as showed below:</p>\n\n<pre><code>type Customer struct {\n    id              IntegerType     `json:\"id\"`\n    name            string          `json:\"name\"`\n    surname         string          `json:\"surname\"`\n}\n</code></pre>\n\n<p>How can I do that?</p>\n\n<p>Second question: once I get an array of Customer object how can I easily put it into a new JSON object under a specific key called \"data\"?</p>\n\n<p>thanks for your support :)</p>\n"}, {"tags": ["go", "gopath"], "comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1466314886, "post_id": 37904258, "comment_id": 63261224, "body": "You can put your projects in same directory. There shall be no problem."}, {"owner": {"reputation": 3391, "user_id": 4470201, "user_type": "registered", "accept_rate": 66, "profile_image": "https://graph.facebook.com/558270100/picture?type=large", "display_name": "Shikloshi", "link": "https://stackoverflow.com/users/4470201/shikloshi"}, "edited": false, "score": 1, "creation_date": 1466314967, "post_id": 37904258, "comment_id": 63261237, "body": "This will clarify a lot of things - <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a> Note that the $GOPATH is considered as a &quot;go workspace&quot; which all go projects should be placed under the &quot;src&quot; sub dir.  There are a lot of resources clarifying the use of $GOPATH."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1466344670, "post_id": 37904258, "comment_id": 63267967, "body": "Basically <code>GOPATH</code> refers to a &quot;Go workspace&quot; as Shikloshi stated, so you might find <a href=\"https://stackoverflow.com/q/20722502/539810\">Whats a good best practice with Go workspaces?</a> to be an interesting read. It has different answers with different reasons for those answers. Personally I use the one-workspace scheme, but obviously that could vary based on project requirements."}], "answers": [{"comments": [{"owner": {"reputation": 4514, "user_id": 362754, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4f94dacdb4bdf32a0a48f4a50233dd95?s=128&d=identicon&r=PG", "display_name": "minghua", "link": "https://stackoverflow.com/users/362754/minghua"}, "edited": false, "score": 0, "creation_date": 1539067127, "post_id": 37905102, "comment_id": 92354970, "body": "Awesome! That symbol link <code>myproject -&gt; ..&#47;..</code> is exactly what I&#39;ve been puzzled to figure out how to deal your own code that you do not want to put under the common directory that should contain only the third-party code. I&#39;ve been thinking using two parts in the GOPATH for your own and the third-party but it runs into lots of trouble. One question though, how do you do that on MS-Windows?"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 4514, "user_id": 362754, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/4f94dacdb4bdf32a0a48f4a50233dd95?s=128&d=identicon&r=PG", "display_name": "minghua", "link": "https://stackoverflow.com/users/362754/minghua"}, "edited": false, "score": 1, "creation_date": 1539069305, "post_id": 37905102, "comment_id": 92355980, "body": "@minghua But all that is obolete with Go modules now (1.11+): <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/Modules</a>"}, {"owner": {"reputation": 2803, "user_id": 921082, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0770877b86732beed2e809a6f7797f65?s=128&d=identicon&r=PG", "display_name": "tomriddle_1234", "link": "https://stackoverflow.com/users/921082/tomriddle-1234"}, "edited": false, "score": 0, "creation_date": 1544626802, "post_id": 37905102, "comment_id": 94343907, "body": "gopath is a mess, especially if you &#39;re from a country that golang.org and github.com is sometimes blocked, every time after you use 3rd party tool bypass the network, like gopm, to checkout a go lib, the git versioning scheme will break since paths are changed by those tools, this means you will never get the lib updated properly, the only option is to reinstall every lib gets updated. With the new mod tool, no more path changing, just like happy npm."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 2803, "user_id": 921082, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/0770877b86732beed2e809a6f7797f65?s=128&d=identicon&r=PG", "display_name": "tomriddle_1234", "link": "https://stackoverflow.com/users/921082/tomriddle-1234"}, "edited": false, "score": 0, "creation_date": 1544627495, "post_id": 37905102, "comment_id": 94344307, "body": "@tomriddle_1234 I agree. And you can combine that with your own module URL repository: <a href=\"https://thumbai.app/\" rel=\"nofollow noreferrer\">thumbai.app</a> and <a href=\"https://github.com/thumbai/thumbai\" rel=\"nofollow noreferrer\">github.com/thumbai/thumbai</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1539242474, "last_edit_date": 1539242474, "creation_date": 1466322777, "answer_id": 37905102, "question_id": 37904258, "link": "https://stackoverflow.com/questions/37904258/some-questions-regarding-gopath/37905102#37905102", "title": "some questions regarding $GOPATH", "body": "<p>(Q2 2018:<br>\nNote that with the <strong><a href=\"https://stackoverflow.com/a/48914523/6309\">vgo project</a></strong>, <code>GOPATH</code> might end up being deprecated in favor of a project-based workflow. That would avoid the manual project-based <code>GOPATH</code> I was proposing below, two years ago)</p>\n\n<p>With Go 1.11 (August 2018), <strong><a href=\"https://golang.org/doc/go1.11#modules\" rel=\"nofollow noreferrer\"><code>GOPATH</code> can be optional, with modules</a></strong>.</p>\n\n<p>It is more and more supported with VSCode:</p>\n\n<ul>\n<li><a href=\"https://github.com/Microsoft/vscode-go/issues/1532#issuecomment-424906159\" rel=\"nofollow noreferrer\">vscode-go/issue 1532</a></li>\n<li>\"<a href=\"https://github.com/Microsoft/vscode-go/wiki/Go-modules-support-in-Visual-Studio-Code\" rel=\"nofollow noreferrer\">Go modules support in Visual Studio Code</a>\"</li>\n</ul>\n\n<hr>\n\n<p>June 2016: You don't have to rely on <em>only</em> one <code>GOPATH</code> (ie <a href=\"https://golang.org/doc/code.html#Workspaces\" rel=\"nofollow noreferrer\">one workspace</a>).</p>\n\n<p>My full <code>GOPATH</code> includes:</p>\n\n<ul>\n<li>a global path (for all utilities like <code>goimports</code>), <a href=\"https://github.com/smartystreets/goconvey\" rel=\"nofollow noreferrer\"><code>github.com/smartystreets/goconvey</code></a>, ...), in <code>$HOME/go</code> for instance,</li>\n<li>a local path (for my current project), where my local <code>src</code>, <code>pkg</code> and <code>bin</code> will be.</li>\n</ul>\n\n<p>That is two paths:</p>\n\n<pre><code>export GOPATH=/path/to/myproject:$HOME/go\n</code></pre>\n\n<blockquote>\n  <p>Isn't it safe to have one $GOPATH directory for all my projects, so all the required 3rd party libraries are installed in the same lib directory, and whenever I compile on of the projects it just uses the libs it requires.</p>\n  \n  <p>Is this bad in practice? Why?</p>\n</blockquote>\n\n<p>I don't like that practice, as different projects could require different <em>version</em> of the same library.<br>\nThat is why I have one <code>GOPATH</code> per project, that my build script (versioned with the project) sets for me.</p>\n\n<p>When I clone a go project of mine, I:</p>\n\n<ul>\n<li>set my <code>GOPATH</code> to that go project (local path, where the third-party libraries I need for that project will be installed, and moved to a <code>vendor</code> folder),</li>\n<li>make a symlink to that path <code>&lt;myproject&gt;/src/&lt;myproject&gt; -&gt; ../..</code>, since <code>GOPATH</code> means go expects to find the sources of <code>myproject</code> in <code>src/&lt;apackage&gt;</code>.</li>\n</ul>\n\n<p>That organization:</p>\n\n<ul>\n<li>remains compatible with <code>go get</code>,</li>\n<li>ensure any specific dependencies I need are installed by default in my project folder instead of being lost within the mass of global libraries/utilities present in the global <code>GOPATH</code>.</li>\n</ul>\n\n<p>I have:</p>\n\n<pre><code>myproject\n   mysource.go\n   apackage\n     othersource.go\n   src\n     myproject -&gt; ../..\n     vendor\n        third-party packages\n</code></pre>\n\n<p>On Windows, a typical build script would be:</p>\n\n<pre><code>\u03bb more b.bat\n@echo off\nsetlocal EnableDelayedExpansion\nif not defined GOROOT (\n        echo Environment variable GOROOT must be defined, with %%GOROOT%%\\bin\\go.exe\n        exit /b 1\n)\n\nset PATH=C:\\WINDOWS\\system32;C:\\WINDOWS;C:\\WINDOWS\\System32\\Wbem\nset PATH=%PATH%;%GOROOT%/bin\nset GOPATH=%~dp0;%HOME%/go\n\nset prjname=%GOPATH:~0,-1%\nfor %%i in (\"%prjname%\") do set \"prjname=%%~ni\"\nrem echo prjname='%prjname%'\n\nif not exist src (\n        mkdir src\n)\nif not exist src\\%prjname% (\n        mklink /J src\\%prjname% %GOPATH%\n)\n\npushd %~dp0\ncd src\\%prjname%\nrem cd\ngo install\npopd\nendlocal\n</code></pre>\n\n<p>Anyone cloning my go project would simply type '<code>b</code>'.</p>\n"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 779, "favorite_count": 3, "accepted_answer_id": 37905102, "answer_count": 1, "score": 5, "last_activity_date": 1539242474, "creation_date": 1466314540, "last_edit_date": 1466337975, "question_id": 37904258, "link": "https://stackoverflow.com/questions/37904258/some-questions-regarding-gopath", "title": "some questions regarding $GOPATH", "body": "<p>I'm a new golang developer and I wonder why <code>$GOPATH</code> environment variable is needed to be set at the root of my project.</p>\n\n<p>If I'm working on several projects at the same time, I need to each time re-set the <code>$GOPATH</code> environment variable to point to a different location.</p>\n\n<p>In my setup, I have <code>$GOPATH</code> set to <code>/Users/Projects/go/lib</code>. which is a generic directory for all of my golang projects.</p>\n\n<p>Just to clarify: the projects data is placed in <code>/Users/Projects/go/&lt;Project Name&gt;</code></p>\n\n<p>If anyhow all <code>$GOPATH</code> is used for (as far as I know) is to install 3rd party libraries, isn't it safe to have one <code>$GOPATH</code> directory for all my projects, so all the required 3rd party libraries are installed in the same lib directory, and whenever I compile on of the projects it just uses the libs it requires.</p>\n\n<p>Is this bad in practice? Why?</p>\n"}, {"tags": ["recursion", "go", "slice", "panic"], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6481982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f_AzPZk93k0/AAAAAAAAAAI/AAAAAAAAAGk/8oE3EQ-3SeI/photo.jpg?sz=128", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6481982/ruzaik"}, "edited": false, "score": 0, "creation_date": 1466321346, "post_id": 37904662, "comment_id": 63262344, "body": "Yes, however, the output I&#39;m looking for is all the possible paths from 1 to 7. The expected output is  [[1 2 3 4 6 7] [1 2 3 6 7] [1 2 5 6 7] [1 3 2 5 6 7] [1 3 4 6 7] [1 3 6 7] [1 6 7]]"}], "tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 0, "last_activity_date": 1466318801, "creation_date": 1466318801, "answer_id": 37904662, "question_id": 37903874, "link": "https://stackoverflow.com/questions/37903874/slice-bounds-out-of-range-when-trying-to-pass-slices-as-arguments-to-a-recursive/37904662#37904662", "title": "Slice bounds out of range when trying to pass slices as arguments to a recursive function (Go)", "body": "<p>The error message is telling exactly what is the issue:</p>\n\n<blockquote>\n  <p>panic: runtime error: slice bounds out of range</p>\n</blockquote>\n\n<p>Since you are calling the same function iteratively and re-slicing the slice you need to check each time if you reached the slice capacity range, in other terms if the slice pointer is pointing to a valid address (index), otherwise you get the <code>out of range error</code> message. </p>\n\n<p>And since you are making a recursive iteration, by decreasing the path length each time, you have to check if the slice index is within a valid range.</p>\n\n<pre><code>//re-slice the slice - get rid of the current node\nif len(path) &gt; 0 {\n       path = path[:len(path)-1]\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/pX2TlAP-bp\" rel=\"nofollow\">https://play.golang.org/p/pX2TlAP-bp</a></p>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 6481982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f_AzPZk93k0/AAAAAAAAAAI/AAAAAAAAAGk/8oE3EQ-3SeI/photo.jpg?sz=128", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6481982/ruzaik"}, "is_accepted": false, "score": 0, "last_activity_date": 1466325862, "creation_date": 1466325862, "answer_id": 37905425, "question_id": 37903874, "link": "https://stackoverflow.com/questions/37903874/slice-bounds-out-of-range-when-trying-to-pass-slices-as-arguments-to-a-recursive/37905425#37905425", "title": "Slice bounds out of range when trying to pass slices as arguments to a recursive function (Go)", "body": "<p>I solved it by using a pointer to my slice 'path' as an argument to the recursive function. It works now! Thanks anyway.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc allPossiblePaths(arrGraph [8][8]bool, src int, dest int) [][]int {\n    var visited []bool //a slice that marks if visited\n    var path []int     //a slice to store a possible path\n    var paths [][]int  //a slice to store all paths\n\n    visited = make([]bool, 8) //set all nodes to unvisited\n\n    dfs(arrGraph, src, dest, visited, &amp;path, paths)\n\n    return paths\n\n}\n\nfunc dfs(myGraph [8][8]bool, src int, dest int, visited []bool, path *[]int, paths [][]int) {\n    //add current node to path\n    *path = append(*path, src)\n\n    //mark current node as visited\n    visited[src] = true\n\n    //if the current node is the destination\n    //print the path and return\n    if src == dest {\n\n        //make a copy of path slice\n        buffer := make([]int, len(*path))\n        copy(buffer, *path)\n\n        //append the copy of path slice into the slice of paths\n        paths = append(paths, buffer)\n\n        fmt.Println(*path) //Just for debugging purpose\n        return\n    }\n\n    for i := 1; i &lt;= 7; i++ { //loop through all nodes\n\n        //if ith node is a neighbour of the current node and it is not visited\n        if myGraph[src][i] &amp;&amp; visited[i] == false {\n\n            // call dfs on the current node\n            dfs(myGraph, i, dest, visited, path, paths)\n\n            //mark the current node as unvisited\n            //so that we can other paths to the final destination\n            visited[i] = false\n\n            //re-slice the slice - get rid of the current node\n\n            *path = (*path)[:len(*path)-1]\n\n            //fmt.Println(path)\n\n        }\n\n    }\n\n}\n\nfunc main() {\n    var myGraph [8][8]bool //the graph\n\n    //creating the graph\n    myGraph[1] = [...]bool{false, false, true, true, false, false, true, false}\n    myGraph[2] = [...]bool{false, true, false, true, false, true, false, false}\n    myGraph[3] = [...]bool{false, true, true, false, true, false, true, false}\n    myGraph[4] = [...]bool{false, false, false, true, false, false, true, false}\n    myGraph[5] = [...]bool{false, false, true, false, false, false, true, false}\n    myGraph[6] = [...]bool{false, true, false, true, true, false, false, true}\n    myGraph[7] = [...]bool{false, false, false, false, false, false, true, false}\n\n    fmt.Println(allPossiblePaths(myGraph, 1, 7))\n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6481982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f_AzPZk93k0/AAAAAAAAAAI/AAAAAAAAAGk/8oE3EQ-3SeI/photo.jpg?sz=128", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6481982/ruzaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 666, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1466325862, "creation_date": 1466309609, "last_edit_date": 1466321416, "question_id": 37903874, "link": "https://stackoverflow.com/questions/37903874/slice-bounds-out-of-range-when-trying-to-pass-slices-as-arguments-to-a-recursive", "title": "Slice bounds out of range when trying to pass slices as arguments to a recursive function (Go)", "body": "<p>I'm trying to pass slices as arguments to a recursive function. Since slices are passed as reference, I believe that the recursive function that I'm passing it to should be able to perform the manipulations without any problem. I'm only using append() and therefore shouldn't have a problem with slices having inadequate capacity right?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc allPossiblePaths(arrGraph [8][8]bool, src int, dest int) [][]int {\n    var visited []bool //a slice that marks if visited\n    var path []int     //a slice to store a possible path\n    var paths [][]int  //a slice to store all paths\n\n    visited = make([]bool, 8) //set all nodes to unvisited\n\n    dfs(arrGraph, src, dest, visited, path, paths)\n\n    return paths\n\n}\n\nfunc dfs(myGraph [8][8]bool, src int, dest int, visited []bool, path []int, paths [][]int) {\n    //add current node to path\n    path = append(path, src)\n\n    //mark current node as visited\n    visited[src] = true\n\n    //if the current node is the destination\n    //print the path and return\n    if src == dest {\n\n        //make a copy of path slice\n        buffer := make([]int, len(path))\n        copy(buffer, path)\n\n        //append the copy of path slice into the slice of paths\n        paths = append(paths, buffer)\n\n        fmt.Println(path) //Just for debugging purpose\n        return\n    }\n\n    for i := 1; i &lt;= 7; i++ { //loop through all nodes\n\n        //if ith node is a neighbour of the current node and it is not visited\n        if myGraph[src][i] &amp;&amp; visited[i] == false {\n\n            // call dfs on the current node\n            dfs(myGraph, i, dest, visited, path, paths)\n\n            //mark the current node as unvisited\n            //so that we can other paths to the final destination\n            visited[i] = false\n\n            //re-slice the slice - get rid of the current node\n            path = path[:len(path)-1]\n        }\n\n    }\n\n}\n\nfunc main() {\n    var myGraph [8][8]bool //the graph\n\n    //creating the graph\n    myGraph[1] = [...]bool{false, false, true, true, false, false, true, false}\n    myGraph[2] = [...]bool{false, true, false, true, false, true, false, false}\n    myGraph[3] = [...]bool{false, true, true, false, true, false, true, false}\n    myGraph[4] = [...]bool{false, false, false, true, false, false, true, false}\n    myGraph[5] = [...]bool{false, false, true, false, false, false, true, false}\n    myGraph[6] = [...]bool{false, true, false, true, true, false, false, true}\n    myGraph[7] = [...]bool{false, false, false, false, false, false, true, false}\n\n    fmt.Println(allPossiblePaths(myGraph, 1, 7))\n}\n\nOUTPUT:\n[1 2 3 4 6 7]\n[1 2 7]\n[1 7]\n[3 2 5 7]\n[4 6 7]\npanic: runtime error: slice bounds out of range\ngoroutine 1 [running]:\npanic(0x4dc300, 0xc82000a0b0)\n        /usr/local/opt/go/src/runtime/panic.go:481 +0x3e6\nmain.dfs(0x0, 0x1000001010000, 0x10001000100, 0x1000100010100, 0x1000001000000, 0x1000000010000, 0x100000101000100, 0x1000000000000, 0x3, 0x7, ...)\n        /home/nitrous/src/test2b/main.go:52 +0x480\nmain.dfs(0x0, 0x1000001010000, 0x10001000100, 0x1000100010100, 0x1000001000000, 0x1000000010000, 0x100000101000100, 0x1000000000000, 0x1, 0x7, ...)\n        /home/nitrous/src/test2b/main.go:45 +0x41f\nmain.allPossiblePaths(0x0, 0x1000001010000, 0x10001000100, 0x1000100010100, 0x1000001000000, 0x1000000010000, 0x100000101000100, 0x1000000000000, 0x1, 0x7, ...)\n        /home/nitrous/src/test2b/main.go:12 +0x150\nmain.main()\n        /home/nitrous/src/test2b/main.go:71 +0x423\n</code></pre>\n\n<p>Expected output: (achieved when using global variables instead of passing variables to a function)</p>\n\n<p>[[1 2 3 4 6 7] [1 2 3 6 7] [1 2 5 6 7] [1 3 2 5 6 7] [1 3 4 6 7] [1 3 6 7] [1 6 7]]</p>\n\n<p>Any idea what I'm doing wrong?</p>\n"}, {"tags": ["java", "go", "ant", "build-tools"], "comments": [{"owner": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 0, "creation_date": 1466304028, "post_id": 37903470, "comment_id": 63259853, "body": "Use <a href=\"https://stackoverflow.com/questions/tagged/maven\">maven</a>, <a href=\"https://stackoverflow.com/questions/tagged/ant\">ant</a>, <a href=\"https://stackoverflow.com/questions/tagged/sbt\">sbt</a> <b>or</b> <a href=\"https://stackoverflow.com/questions/tagged/gradle\">gradle</a>."}, {"owner": {"reputation": 136042, "user_id": 5221149, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s4qlq.png?s=128&g=1", "display_name": "Andreas", "link": "https://stackoverflow.com/users/5221149/andreas"}, "reply_to_user": {"reputation": 182833, "user_id": 2970947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HAq55.png?s=128&g=1", "display_name": "Elliott Frisch", "link": "https://stackoverflow.com/users/2970947/elliott-frisch"}, "edited": false, "score": 1, "creation_date": 1466307333, "post_id": 37903470, "comment_id": 63260212, "body": "@ElliottFrisch You forgot <code>javac</code>. It&#39;s perfectly fine for something this simple."}, {"owner": {"reputation": 321, "user_id": 1644665, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f26182fa5536d9e6dff2a8baf86e6c5?s=128&d=identicon&r=PG", "display_name": "Yev", "link": "https://stackoverflow.com/users/1644665/yev"}, "edited": false, "score": 0, "creation_date": 1466307740, "post_id": 37903470, "comment_id": 63260251, "body": "If I understood you right, you are looking for something like <code>javac project&#47;*.java</code>"}, {"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1466314807, "post_id": 37903470, "comment_id": 63261218, "body": "I strongly suggest you make the investment in learning how to use an IDE.  You can get started and use it for basic compilation without having to invest in a &quot;full fledged project environment&quot;.  Going from command line to IDE requires some adjustment but the productivity difference on anything more complex than simple toy projects is like the difference between a Yugo and a Ferrari.  Learn how to use the debugger and you can substitute a Boeing 787 for the Ferrari."}], "answers": [{"tags": [], "owner": {"reputation": 435, "user_id": 4547192, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/565fd8364bef2dabeeedcae3bbd978a0?s=128&d=identicon&r=PG&f=1", "display_name": "Bradley Ross", "link": "https://stackoverflow.com/users/4547192/bradley-ross"}, "is_accepted": false, "score": 0, "last_activity_date": 1466304768, "creation_date": 1466304768, "answer_id": 37903533, "question_id": 37903470, "link": "https://stackoverflow.com/questions/37903470/simplest-way-to-compile-java-source-from-terminal/37903533#37903533", "title": "Simplest way to compile java source from terminal?", "body": "<p>The javac and jar commands will compile Java code and create jar files.  Your source code has to be in a directory structure that matches the structure of the packages.  This means that the directory java/awt would contain the java.awt package source files.  Many years ago, I used a set of UNIX script files to compile and package my Java code, but this was before I had worked with Eclipse.</p>\n"}], "owner": {"reputation": 1479, "user_id": 1164937, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/70d5a73393d4d374e50da45db2df7646?s=128&d=identicon&r=PG", "display_name": "user1164937", "link": "https://stackoverflow.com/users/1164937/user1164937"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 97, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466310538, "creation_date": 1466303877, "question_id": 37903470, "link": "https://stackoverflow.com/questions/37903470/simplest-way-to-compile-java-source-from-terminal", "title": "Simplest way to compile java source from terminal?", "body": "<p>What's the simplest way to compile java source files without an IDE?</p>\n\n<p>I'm mainly using Java for algorithms, and these questions don't really need full fledged project environments. Although being able to import some reusable classes would be nice. </p>\n\n<p>In Go, I'm able to structure my project like so: </p>\n\n<pre><code>$HOME/src/&lt;dir&gt;/&lt;dir&gt;\n</code></pre>\n\n<p>And compiling it ends up in <code>$HOME/bin/*</code> (apps) or <code>$HOME/pkg/&lt;dir&gt;/&lt;dir&gt;</code> (libraries). </p>\n\n<p>Is there some way to do something like this, but for java?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": true, "score": 5, "last_activity_date": 1564705608, "last_edit_date": 1564705608, "creation_date": 1466285789, "answer_id": 37901864, "question_id": 37901811, "link": "https://stackoverflow.com/questions/37901811/converting-array-to-csv/37901864#37901864", "title": "Converting array to csv", "body": "<p>Use <a href=\"https://golang.org/pkg/os/#pkg-variables\" rel=\"nofollow noreferrer\">os.Stdout</a> as your <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow noreferrer\">io.Writer</a>.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 9, "last_activity_date": 1466287672, "last_edit_date": 1495542809, "creation_date": 1466286112, "answer_id": 37901897, "question_id": 37901811, "link": "https://stackoverflow.com/questions/37901811/converting-array-to-csv/37901897#37901897", "title": "Converting array to csv", "body": "<p>yes:<br>\nfor string slice:  </p>\n\n<pre><code>package main\n\nimport \"encoding/csv\"\nimport \"os\"\n\nfunc main() {\n    wr := csv.NewWriter(os.Stdout)\n    wr.Write([]string{\"test1\", \"test2\", \"test3\"})\n    wr.Flush()\n}\n</code></pre>\n\n<p>for int (or any slice):</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"fmt\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    A := []int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9} // []string{\"test1\", \"test2\", \"test3\"}\n    st := strings.Fields(strings.Trim(fmt.Sprint(A), \"[]\"))\n    wr := csv.NewWriter(os.Stdout)\n    wr.Write(st)\n    wr.Flush() // 0,1,2,3,4,5,6,7,8,9\n}\n</code></pre>\n\n<p>another way:  </p>\n\n<pre><code>package main\n\nimport (\n    //\"encoding/csv\"\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    A := []int{0, 1, 2, 3, 4, 5, 6, 7, 8, 9}\n    st := strings.Trim(strings.Join(strings.Fields(fmt.Sprint(A)), \", \"), \"[]\")\n    fmt.Println(st) // 0, 1, 2, 3, 4, 5, 6, 7, 8, 9\n}\n</code></pre>\n\n<p>if your data is not int convert it to slice of string, then use strings.Join function.  </p>\n\n<p>and see:<br>\n<a href=\"https://stackoverflow.com/questions/37532255/go-golang-one-liner-to-transform-int-into-string/37533144#37533144\">go / golang: one-liner to transform []int into string</a></p>\n"}], "owner": {"reputation": 1784, "user_id": 5479258, "user_type": "registered", "accept_rate": 27, "profile_image": "https://www.gravatar.com/avatar/9013d6bb5ccbdd8ef0cac115267fa2f1?s=128&d=identicon&r=PG&f=1", "display_name": "user99999", "link": "https://stackoverflow.com/users/5479258/user99999"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5540, "favorite_count": 2, "accepted_answer_id": 37901864, "answer_count": 2, "score": 3, "last_activity_date": 1564705608, "creation_date": 1466285410, "question_id": 37901811, "link": "https://stackoverflow.com/questions/37901811/converting-array-to-csv", "title": "Converting array to csv", "body": "<p>I have an array of different values - is there a way to convert it to csv string and output it via <code>fmt.Print</code> to stdout, without writing the csv to some file?</p>\n\n<p>As far as I know, if I create a csv writer, I have to pass io file as a parameter, is there a way to just output it?</p>\n"}, {"tags": ["arrays", "dictionary", "go", "slice"], "comments": [{"owner": {"reputation": 6642, "user_id": 434233, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/y6HxN.png?s=128&g=1", "display_name": "Arunmu", "link": "https://stackoverflow.com/users/434233/arunmu"}, "edited": false, "score": 2, "creation_date": 1466279298, "post_id": 37900696, "comment_id": 63255001, "body": "Can the slices be compared for equality ? If no, then it cannot be used or rather any type with no equality comparison cannot be used as key in a map."}], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 4, "last_activity_date": 1466281449, "creation_date": 1466281449, "answer_id": 37901317, "question_id": 37900696, "link": "https://stackoverflow.com/questions/37900696/why-cant-go-slice-be-used-as-keys-in-go-maps-pretty-much-the-same-way-arrays-ca/37901317#37901317", "title": "Why can&#39;t Go slice be used as keys in Go maps pretty much the same way arrays can be used as keys?", "body": "<p>Here's Nigel Tao's answer from <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/zYlx6sR4F8Y\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/golang-nuts/zYlx6sR4F8Y</a>:</p>\n\n<blockquote>\n  <p>One reason is that arrays are value types. If <code>a0</code> is an <code>[N]int</code> (an\n  array) then doing</p>\n\n<pre><code>a1 := a0\na1[0] = 0\n</code></pre>\n  \n  <p>will not affect <code>a0[0]</code> at all.</p>\n  \n  <p>In comparison, slices refer to an underlying array. Copying a slice\n  value is O(1) instead of O(length). If <code>s0</code> is an <code>[]int</code> (a slice)\n  then doing</p>\n\n<pre><code>s1 := s0\ns1[0] = 0\n</code></pre>\n  \n  <p>will affect what <code>s0[0]</code> is.</p>\n  \n  <p><a href=\"http://play.golang.org/p/TVkntIsLo8\" rel=\"nofollow\">http://play.golang.org/p/TVkntIsLo8</a></p>\n  \n  <p>Map keys need some notion of equality. For arrays, this is simply\n  element-wise equality. For slices, there is more than one way to\n  define equality: one is element-wise equality, another is referring to\n  the same array backing store. Furthermore, does map insertion need to\n  make an (expensive) copy of the entire backing array? Copying would\n  probably be less surprising, but it is inconsistent with what\n  assignment does.</p>\n  \n  <p>What should this code snippet print?</p>\n\n<pre><code>m := make(map[[]int]bool)\ns0 := []int{6, 7, 8}\ns1 := []int{6, 7, 8}\ns2 := s0\nm[s0] = true\ns2[0] = 9\nprintln(m[s0])\nprintln(m[s1])\nprintln(m[s2])\n</code></pre>\n  \n  <p>Different programmers can have different expectations. To avoid\n  confusion, we have simply decided not to allow slices as map keys for\n  now.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1466290693, "last_edit_date": 1466290693, "creation_date": 1466285732, "answer_id": 37901853, "question_id": 37900696, "link": "https://stackoverflow.com/questions/37900696/why-cant-go-slice-be-used-as-keys-in-go-maps-pretty-much-the-same-way-arrays-ca/37901853#37901853", "title": "Why can&#39;t Go slice be used as keys in Go maps pretty much the same way arrays can be used as keys?", "body": "<p>To answer the exact \"why cant?\":</p>\n\n<p><a href=\"https://golang.org/ref/spec#Map_types\" rel=\"nofollow\">Spec: Map types:</a></p>\n\n<blockquote>\n  <p>The <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow\">comparison operators</a> == and != must be fully defined for operands of the key type; thus the <strong>key type must not be</strong> a function, map, or <strong>slice</strong>.</p>\n</blockquote>\n\n<p>The spec does not allow key types where comparison is not defined. <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow\">Spec: Comparison operators</a> also confirms this:</p>\n\n<blockquote>\n  <p><strong>Slice</strong>, map, and function values are <strong>not comparable</strong>.</p>\n</blockquote>\n\n<p>For reasoning, see smarx's answer (which quotes <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/zYlx6sR4F8Y\" rel=\"nofollow\">Nigel Tao's answer</a>). And read on.</p>\n\n<p>Go's map uses a <a href=\"https://en.wikipedia.org/wiki/Hash_table\" rel=\"nofollow\">hashmap</a> implementation. In general (regardless of the programming language) mutating a value that is used as a key in a hashmap might result in undefined (or unexpected the least) behavior. Usually the hashcode of the key is used to designate the bucket in which the value (key-value pair) is placed. If the key changes and you ask for the associated value for that key, the implementation might look in the wrong bucket (and therefore report that it can't find it) because a changed key value most likely gives a different hashcode which might designate a different bucket.</p>\n\n<p>In Go slices are just descriptors to a contiguous part of an underlying array, and assigning slice values only copies these descriptors. So using a slice as key you would expect that the map implementation only copies this slice header (which is the pointer to the first referenced element in the underlying array, the length and the capacity). It would only work if hash comptation and equality would use these 3 elements and nothing else, but to us (humans, programmers) a slice means the elements that can be accessed through the slice header - which can also be modified (causing problems described above).</p>\n\n<p>If a map would allow a slice as keys, to function properly, it would have to update its internal state and data structure whenever a slice element of any slice (that is used as a key) is modified which is not to be expected.</p>\n\n<p>Arrays are cool in this regard: an array means all its elements; copying an array copies all the elements, and comparison is defined like:</p>\n\n<blockquote>\n  <p>Array values are comparable if values of the array element type are comparable. Two array values are equal if their corresponding elements are equal.</p>\n</blockquote>\n\n<p>And if you modify an element of an array that you used as a key before: not a problem as the new array (with that modified element) is not equal to the original which is stored and used in the map, so querying the associated value with the modified array will justifiably yield no results, and querying with the unmodified, original array will properly give you back the previously stored value.</p>\n"}], "owner": {"reputation": 671, "user_id": 2018737, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/453fda6b3b865167d280762b783ce96e?s=128&d=identicon&r=PG&f=1", "display_name": "theyCallMeJun", "link": "https://stackoverflow.com/users/2018737/theycallmejun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1077, "favorite_count": 1, "accepted_answer_id": 37901317, "answer_count": 2, "score": 2, "last_activity_date": 1466290693, "creation_date": 1466277038, "question_id": 37900696, "link": "https://stackoverflow.com/questions/37900696/why-cant-go-slice-be-used-as-keys-in-go-maps-pretty-much-the-same-way-arrays-ca", "title": "Why can&#39;t Go slice be used as keys in Go maps pretty much the same way arrays can be used as keys?", "body": "<p>Why can't Go slice (which is an implementation of Go arrays) be used as keys in Go maps pretty much the same way arrays can be used as keys?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1466273622, "post_id": 37900153, "comment_id": 63253387, "body": "I tried that but it just gives an error as the value undefined ."}], "tags": [], "owner": {"reputation": 911, "user_id": 4728636, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yQ2Rl.jpg?s=128&g=1", "display_name": "anonrose", "link": "https://stackoverflow.com/users/4728636/anonrose"}, "is_accepted": false, "score": -1, "last_activity_date": 1466273475, "creation_date": 1466273475, "answer_id": 37900153, "question_id": 37900096, "link": "https://stackoverflow.com/questions/37900096/not-able-to-access-fields-of-structs/37900153#37900153", "title": "Not able to access fields of structs", "body": "<p>You are getting access to the structure through e.Value, but you are not getting access to the structures value. You will need to do e.Value.B</p>\n"}, {"comments": [{"owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "edited": false, "score": 0, "creation_date": 1466274663, "post_id": 37900267, "comment_id": 63253665, "body": "It was great help for beginner like me."}], "tags": [], "owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "is_accepted": true, "score": 1, "last_activity_date": 1466274216, "creation_date": 1466274216, "answer_id": 37900267, "question_id": 37900096, "link": "https://stackoverflow.com/questions/37900096/not-able-to-access-fields-of-structs/37900267#37900267", "title": "Not able to access fields of structs", "body": "<p>You have to cast the list item back to <code>A</code>. You can see it running <a href=\"https://play.golang.org/p/QENzCBButP\" rel=\"nofollow\">here</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"container/list\"\n    \"fmt\"\n)\n\ntype A struct {\n    B int\n}\n\nfunc main() {\n    l := list.New()\n    for i := 0; i &lt; 5; i++ {\n        c := A{i}\n        l.PushFront(c)\n    }\n\n    for e := l.Front(); e != nil; e = e.Next() {\n        v := e.Value.(A)\n        fmt.Println(v.B)\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 15946, "user_id": 4606734, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/858769040849894/picture?type=large", "display_name": "ameyCU", "link": "https://stackoverflow.com/users/4606734/ameycu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 128, "favorite_count": 0, "accepted_answer_id": 37900267, "answer_count": 2, "score": 1, "last_activity_date": 1466274216, "creation_date": 1466273030, "question_id": 37900096, "link": "https://stackoverflow.com/questions/37900096/not-able-to-access-fields-of-structs", "title": "Not able to access fields of structs", "body": "<p>I am trying to implement linked list of struct in Go using list package available. This is the sample code below - </p>\n\n<pre><code>package main\n\nimport (\n    \"container/list\"\n    \"fmt\"\n)\n\ntype A struct{\n    B int \n}\n\nfunc main() {\n    l := list.New()\n    for i:=0;i&lt;5;i++ {\n        c := A{i}\n        l.PushFront(c)\n    }\n\n    for e := l.Front(); e != nil; e = e.Next() {\n        fmt.Println(e.Value)\n    }\n\n}\n</code></pre>\n\n<p>Output I get is in form <code>{0}</code> and same for other iterations. How can I access the field to get the integer value ?</p>\n"}, {"tags": ["go", "append", "slice"], "comments": [{"owner": {"reputation": 1289, "user_id": 87370, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/DpN6f.jpg?s=128&g=1", "display_name": "Paulb", "link": "https://stackoverflow.com/users/87370/paulb"}, "edited": false, "score": 0, "creation_date": 1466274093, "post_id": 37899640, "comment_id": 63253507, "body": "The title made me hungry for pizza."}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6481982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f_AzPZk93k0/AAAAAAAAAAI/AAAAAAAAAGk/8oE3EQ-3SeI/photo.jpg?sz=128", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6481982/ruzaik"}, "edited": false, "score": 0, "creation_date": 1466303476, "post_id": 37900186, "comment_id": 63259791, "body": "Thank you. And I&#39;m guessing fmt.Println was giving me expected results because that is also a kind of &quot;snapshot&quot;."}, {"owner": {"reputation": 31, "user_id": 6481982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f_AzPZk93k0/AAAAAAAAAAI/AAAAAAAAAGk/8oE3EQ-3SeI/photo.jpg?sz=128", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6481982/ruzaik"}, "edited": false, "score": 0, "creation_date": 1466303939, "post_id": 37900186, "comment_id": 63259842, "body": "I&#39;m new to Go and I was wondering if it was possible to enhance this project. I&#39;m trying to write a function that would take in a Graph, src and dest and spit out a slice of paths. However, right now I&#39;m making use of global variables. I was trying to do it using nested functions but seems like Go does not allow that. Any advice?"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 31, "user_id": 6481982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f_AzPZk93k0/AAAAAAAAAAI/AAAAAAAAAGk/8oE3EQ-3SeI/photo.jpg?sz=128", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6481982/ruzaik"}, "edited": false, "score": 0, "creation_date": 1466321690, "post_id": 37900186, "comment_id": 63262414, "body": "1 - Underling; fmt.Println sends it&#39;s arguments to a channel. At the time of actually evaluating the arguments, they are changed - in this case; because they are reference type."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 31, "user_id": 6481982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f_AzPZk93k0/AAAAAAAAAAI/AAAAAAAAAGk/8oE3EQ-3SeI/photo.jpg?sz=128", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6481982/ruzaik"}, "edited": false, "score": 0, "creation_date": 1466322043, "post_id": 37900186, "comment_id": 63262492, "body": "2 - Honestly I have not a clear understanding of what are you trying to achieve here. But there are good libraries for handling graphs in Go. Personally I would start with a node struct and the like; using slices and arrays may make it more efficient to some extend. But it&#39;s hard to make it concurrent past that limit."}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 1, "last_activity_date": 1466273732, "creation_date": 1466273732, "answer_id": 37900186, "question_id": 37899640, "link": "https://stackoverflow.com/questions/37899640/appending-an-integer-slice-to-a-slice-of-integer-slices-modifies-the-slice-that/37900186#37900186", "title": "Appending an integer slice to a slice of integer slices modifies the slice that gets appended", "body": "<p>Let's change this code a bit:</p>\n\n<pre><code>var myGraph [8][8]bool //the graph\n\nvar visited [8]bool //an array that marks if visited\n\nvar path []int //a slice to store a possible path\n\nvar paths [][]int\n\nfunc dfs(src int, dest int) {\n    //add current node to path\n    path = append(path, src)\n\n    //mark current node as visited\n    visited[src] = true\n\n    //if the current node is the destination\n    //print the path and return\n    if src == dest {\n        // (A)\n        buffer := make([]int, len(path))\n        copy(buffer, path)\n\n        fmt.Println(buffer)\n        paths = append(paths, buffer) //I'm trying to push the path slice into the paths slice\n\n        // fmt.Println(path)\n        // paths = append(paths, path) //I'm trying to push the path slice into the paths slice\n        return\n    }\n\n    for i := 1; i &lt;= 7; i++ { //loop through all nodes\n\n        //if ith node is a neighbour of the current node and it is not visited\n        if myGraph[src][i] &amp;&amp; visited[i] == false {\n\n            // call dfs on the current node\n            dfs(i, dest)\n\n            //mark the current node as unvisited\n            //so that we can other paths to the final destination\n            visited[i] = false\n\n            //re-slice the slice - get rid of the current node\n            path = path[:len(path)-1]\n        }\n\n    }\n\n}\n\nfunc main1() {\n    // path = make([]int, 0, 8)\n    // paths = make([][]int, 0, 10)\n\n    //creating the graph\n    myGraph[1] = [...]bool{false, false, true, true, false, false, true, false}\n    myGraph[2] = [...]bool{false, true, false, true, false, true, false, false}\n    myGraph[3] = [...]bool{false, true, true, false, true, false, true, false}\n    myGraph[4] = [...]bool{false, false, false, true, false, false, true, false}\n    myGraph[5] = [...]bool{false, false, true, false, false, false, true, false}\n    myGraph[6] = [...]bool{false, true, false, true, true, false, false, true}\n    myGraph[7] = [...]bool{false, false, false, false, false, false, true, false}\n\n    //call dfs by feeding in the source and the destination\n    dfs(1, 7)\n    fmt.Println(paths)\n}\n</code></pre>\n\n<p>And now it works as expected! Why? Because slices are reference types, not value types; means when you change <code>path</code> later, you will see that new value unless you take a snapshot of it like what is done at <code>// (A)</code>.</p>\n"}], "owner": {"reputation": 31, "user_id": 6481982, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-f_AzPZk93k0/AAAAAAAAAAI/AAAAAAAAAGk/8oE3EQ-3SeI/photo.jpg?sz=128", "display_name": "Ruzaik", "link": "https://stackoverflow.com/users/6481982/ruzaik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 203, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1466273732, "creation_date": 1466270097, "question_id": 37899640, "link": "https://stackoverflow.com/questions/37899640/appending-an-integer-slice-to-a-slice-of-integer-slices-modifies-the-slice-that", "title": "Appending an integer slice to a slice of integer slices modifies the slice that gets appended", "body": "<p>I'm trying to append a slice of integers to a slice that is made up of integer slices. When I print the slice, it shows up as expected. However, when I append the slice to a slice of slices, the content changes.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar myGraph [8][8]bool //the graph\n\nvar visited [8]bool //an array that marks if visited\n\nvar path []int //a slice to store a possible path\n\nvar paths [][]int\n\nfunc dfs(src int, dest int) {\n    //add current node to path\n    path = append(path, src)\n\n    //mark current node as visited\n    visited[src] = true\n\n    //if the current node is the destination\n    //print the path and return\n    if src == dest {\n        fmt.Println(path)\n        paths = append(paths, path) //I'm trying to push the path slice into the paths slice\n        return\n    }\n\n    for i := 1; i &lt;= 7; i++ { //loop through all nodes\n\n        //if ith node is a neighbour of the current node and it is not visited\n        if myGraph[src][i] &amp;&amp; visited[i] == false {\n\n            // call dfs on the current node\n            dfs(i, dest)\n\n            //mark the current node as unvisited\n            //so that we can other paths to the final destination\n            visited[i] = false\n\n            //re-slice the slice - get rid of the current node\n            path = path[:len(path)-1]\n        }\n\n    }\n\n}\n\nfunc main() {\n    path = make([]int, 0, 8)\n    paths = make([][]int, 0, 10)\n\n    //creating the graph\n    myGraph[1] = [...]bool{false, false, true, true, false, false, true, false}\n    myGraph[2] = [...]bool{false, true, false, true, false, true, false, false}\n    myGraph[3] = [...]bool{false, true, true, false, true, false, true, false}\n    myGraph[4] = [...]bool{false, false, false, true, false, false, true, false}\n    myGraph[5] = [...]bool{false, false, true, false, false, false, true, false}\n    myGraph[6] = [...]bool{false, true, false, true, true, false, false, true}\n    myGraph[7] = [...]bool{false, false, false, false, false, false, true, false}\n\n    //call dfs by feeding in the source and the destination\n    dfs(1, 7)\n    fmt.Println(paths)\n}\n\nOutput:\n[1 2 5 6 7]\n[1 3 2 5 6 7]\n[1 3 4 6 7]\n[1 3 6 7]\n[1 6 7]\n[[1 6 7 3 2 5] [1 6 7 3 2] [1 6 7 3 2] [1 6 7 3 2 5] [1 6 7 3 2] [1 6 7 3] [1 6 7]]\n</code></pre>\n\n<p>As you can see, the slice of slices is printed at the end by the main function. However, its contents are different to the individual slices that are printed by dfs().</p>\n"}, {"tags": ["http", "go", "httprequest", "eof"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466271830, "post_id": 37899240, "comment_id": 63252824, "body": "EOF means you read the entire stream. If you received what you expected, why are you returning that EOF as an error?  (You should also note that it&#39;s possible here to be getting chunked responses, which won&#39;t have a ContentLength)"}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466272694, "post_id": 37899240, "comment_id": 63253093, "body": "Thank you @JimB. I am not returning EOF. It is returned by the webserver from where I am pulling the content. What is the best way to do it then? Can I ignore only EOF, and handle it?"}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466275777, "post_id": 37899240, "comment_id": 63253993, "body": "@JimB: Could it be that the actual content, and the content length are different? I did an <code>unsafe.Sizeof(buff)</code>, which gives a size less than the <code>ContentLength</code> size."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466275933, "post_id": 37899240, "comment_id": 63254040, "body": "Have you looked at any examples of how to use an io.Reader? Yes, you need to handle EOF."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466276065, "post_id": 37899240, "comment_id": 63254087, "body": "unsafe.SizeOf returns the size of the slice structure, which isn&#39;t relevant at all. You know what the length and capacity are, because you just allocated it."}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466276205, "post_id": 37899240, "comment_id": 63254131, "body": "Nice, I will handle EOF then. If you can write the comment as an answer, I will accept it as the solution. Thanks @JimB"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1466276515, "creation_date": 1466276515, "answer_id": 37900615, "question_id": 37899240, "link": "https://stackoverflow.com/questions/37899240/eof-error-causing-termination-when-handled-in-using-http-client-get-method-and-b/37900615#37900615", "title": "EOF error causing termination when handled in using http.Client.Get method and Body.Read() method", "body": "<p>Handing <code>io.EOF</code> is part of the contract of using an <code>io.Reader</code>, and it indicates that there's nothing more to read. If you have read what you expected to read, there is no error. If you look at functions like <code>ioutil.ReadAll</code>, you'll see that it handles the EOF, and returns no error at the end of the stream. </p>\n\n<p>You may also consider not checking for ContentLength, as it precludes you from handing chunked responses. </p>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1920, "favorite_count": 0, "accepted_answer_id": 37900615, "answer_count": 1, "score": 2, "last_activity_date": 1576423159, "creation_date": 1466267588, "last_edit_date": 1576423159, "question_id": 37899240, "link": "https://stackoverflow.com/questions/37899240/eof-error-causing-termination-when-handled-in-using-http-client-get-method-and-b", "title": "EOF error causing termination when handled in using http.Client.Get method and Body.Read() method", "body": "<p>I am using an http client to get a json body, and read it to a byte array like</p>\n\n<pre><code>client := new(http.Client)\nclient.Timeout = time.Second * 10\nGetJobJson, err := client.Get(joblocation.String()) //where joblocation is of type *url.Url\nif err != nil {\n    errorlog.Err.Println(\"Error getting job from\", joblocation.String(), err)\n    return false, http.StatusBadRequest, nil\n}\nbuff := make([]byte, GetJobJson.ContentLength)\nlength, err := GetJobJson.Body.Read(buff) //This returns an EOF error\nif err != nil {\n    errorlog.Err.Println(\"Error reading request body of length\", length, \"vs contentlength\", GetJobJson.ContentLength, err)\n    return false, http.StatusBadRequest, nil\n}\n</code></pre>\n\n<p>In the above code, <code>GetJobJson.Body</code> is of type <code>io.ReadCloser</code>, which implements <code>Reader</code>, having <code>Read</code> method, which I am using here as </p>\n\n<pre><code>length, err := GetJobJson.Body.Read(buff) \n</code></pre>\n\n<p>But since I am handling error here, it is returning an error which says EOF. </p>\n\n<p>The http endpoint to where I am sending the request is running an apache server, mentioning it here since I am not sure if it matters.</p>\n\n<p>If I am not handling the error, I get the complete json body, which is there in the remote server, and the program continues to work as expected. </p>\n\n<p>What is the best way to handle this? Is the <code>Read</code> method that I use, is bad for this situation?</p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1466254184, "post_id": 37896931, "comment_id": 63247554, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/22625367/how-to-limit-the-connection-count-of-an-http-server-implemented-in-go\">How to limit the connection count of an HTTP Server implemented in go?</a>"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1466255283, "post_id": 37896931, "comment_id": 63247868, "body": "@Tinwor not really a duplicate of that"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1466260147, "post_id": 37896931, "comment_id": 63249272, "body": "Similar question: <a href=\"http://stackoverflow.com/questions/28070923/golang-net-http-and-gorilla-run-code-before-handler\" title=\"golang net http and gorilla run code before handler\">stackoverflow.com/questions/28070923/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1492933150, "post_id": 37897238, "comment_id": 74187242, "body": "Why do you use the last forward instead of the first?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1493210229, "post_id": 37897238, "comment_id": 74316721, "body": "@lf215 the first one might be an internal LAN address or alike. The last one should be the address seen by your reverse proxy or LB, and is usually what you want for things like country filtering, i.e. the client&#39;s ISP-given address."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 1769, "user_id": 1168364, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/9194e00c831d0004fe49a84879ecea95?s=128&d=identicon&r=PG&f=1", "display_name": "lf215", "link": "https://stackoverflow.com/users/1168364/lf215"}, "edited": false, "score": 0, "creation_date": 1493210307, "post_id": 37897238, "comment_id": 74316785, "body": "Quoting Wikipedia on that subject: <code>The last IP address is always the IP address that connects to the last proxy, which means it is the most reliable source of information</code>. <a href=\"https://en.wikipedia.org/wiki/X-Forwarded-For#Format\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/X-Forwarded-For#Format</a>"}, {"owner": {"reputation": 824, "user_id": 4580653, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/MVlIV.jpg?s=128&g=1", "display_name": "pulse0ne", "link": "https://stackoverflow.com/users/4580653/pulse0ne"}, "edited": false, "score": 3, "creation_date": 1517416031, "post_id": 37897238, "comment_id": 84089475, "body": "one thing to note is that if the machine that this code is running on has ipv6 enabled, the address may be in the <code>[::]:&lt;port&gt;</code> form. For example, when I serve and request locally, r.RemoteAddr returns <code>[::1]:32445</code> (port will likely differ)"}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 8, "last_activity_date": 1466254761, "creation_date": 1466254761, "answer_id": 37897238, "question_id": 37896931, "link": "https://stackoverflow.com/questions/37896931/how-to-limit-client-ip-address-when-using-golang-http-package/37897238#37897238", "title": "How to limit client IP address when using golang http package", "body": "<p>You need to do two things: one is to wrap your mux with a middleware handler that pre-processes your requests and validates the IP. The other is get the real IP of the user, which is important if you are behind a firewall or load balancer (resulting in the address being always that of the LB), or if your user is behind a proxy. </p>\n\n<p>As for wrapping your mux, it's pretty simple:</p>\n\n<pre><code>apiServer := &amp;http.Server{\n    Addr:    \"0.0.0.0:8080\",\n    Handler: http.HandlerFunc( func(w http.ResponseWriter, req *http.Request) {\n        // get the real IP of the user, see below\n        addr := getRealAddr(req)\n\n       // the actual vaildation - replace with whatever you want\n       if (addr != \"1.2.3.4\") {\n            http.Error(w, \"Blocked\", 401)\n            return\n        }\n        // pass the request to the mux\n        apiMux.ServeHTTP(w,req)\n    }),\n}\n</code></pre>\n\n<p>And I'm attaching the <code>getRealAddr</code> function which is from an actual project in which I did something like this:</p>\n\n<pre><code>func getRealAddr(r *http.Request)  string {\n\n    remoteIP := \"\"\n    // the default is the originating ip. but we try to find better options because this is almost\n    // never the right IP\n    if parts := strings.Split(r.RemoteAddr, \":\"); len(parts) == 2 {\n        remoteIP = parts[0]\n    }\n    // If we have a forwarded-for header, take the address from there\n    if xff := strings.Trim(r.Header.Get(\"X-Forwarded-For\"), \",\"); len(xff) &gt; 0 {\n        addrs := strings.Split(xff, \",\")\n        lastFwd := addrs[len(addrs)-1]\n        if ip := net.ParseIP(lastFwd); ip != nil {\n            remoteIP = ip.String()\n        }\n    // parse X-Real-Ip header\n    } else if xri := r.Header.Get(\"X-Real-Ip\"); len(xri) &gt; 0 {\n        if ip := net.ParseIP(xri); ip != nil {\n            remoteIP = ip.String()\n        }\n    }\n\n    return remoteIP\n\n}\n</code></pre>\n\n<p>As for the filtering, it can be based on a set of ips, or CIDR ranges, it's up to you of course.</p>\n\n<p>If you're interested, the above code is from an API building toolkit I wrote and used called Vertex, which has this built in: <a href=\"https://github.com/EverythingMe/vertex\" rel=\"noreferrer\">https://github.com/EverythingMe/vertex</a></p>\n"}], "owner": {"reputation": 71, "user_id": 6482832, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8034d6bd1022a72130487b79dcdefe32?s=128&d=identicon&r=PG&f=1", "display_name": "Will Lee", "link": "https://stackoverflow.com/users/6482832/will-lee"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6196, "favorite_count": 3, "answer_count": 1, "score": 5, "last_activity_date": 1466261316, "creation_date": 1466252809, "last_edit_date": 1466261316, "question_id": 37896931, "link": "https://stackoverflow.com/questions/37896931/how-to-limit-client-ip-address-when-using-golang-http-package", "title": "How to limit client IP address when using golang http package", "body": "<p>I'm using golang <code>http</code> package. How could the server limit client IP address?</p>\n\n<pre><code>func (s *Worker) Run(c chan error) {\n    apiMux := http.NewServeMux()\n    apiMux.HandleFunc(\"/test\", s.test)\n    apiMux.HandleFunc(\"/block/create\", s.CreateBlock)\n    apiMux.HandleFunc(\"/block/delete\", s.DeleteBlock)\n\n    apiServer := &amp;http.Server{\n        Addr:    \"0.0.0.0:\" + strconv.Itoa(s.ListenPort),\n        Handler: apiMux,\n    }\n\n    go func() {\n        log.Println(\"Worker listening on \" + apiServer.Addr)\n        c &lt;- apiServer.ListenAndServe()\n    }()\n}\n</code></pre>\n"}, {"tags": ["go", "grafana"], "comments": [{"owner": {"reputation": 6023, "user_id": 4236078, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9959d878feda9f2bab4b43b554e09847?s=128&d=identicon&r=PG&f=1", "display_name": "ale64bit", "link": "https://stackoverflow.com/users/4236078/ale64bit"}, "edited": false, "score": 1, "creation_date": 1466252913, "post_id": 37896923, "comment_id": 63247202, "body": "<a href=\"https://github.com/grafana/grafana#run-from-master\" rel=\"nofollow noreferrer\">github.com/grafana/grafana#run-from-master</a>"}, {"owner": {"reputation": 11, "user_id": 6469426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-apY3NZQJ3T8/AAAAAAAAAAI/AAAAAAAABg0/dIpayyn5E5A/photo.jpg?sz=128", "display_name": "Yuva Raj", "link": "https://stackoverflow.com/users/6469426/yuva-raj"}, "reply_to_user": {"reputation": 6023, "user_id": 4236078, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9959d878feda9f2bab4b43b554e09847?s=128&d=identicon&r=PG&f=1", "display_name": "ale64bit", "link": "https://stackoverflow.com/users/4236078/ale64bit"}, "edited": false, "score": 0, "creation_date": 1466418078, "post_id": 37896923, "comment_id": 63290652, "body": "while doing grafana config, i got an error like &quot;No command &#39;bra&#39; found&quot;. how to rectify that!!!"}], "owner": {"reputation": 11, "user_id": 6469426, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-apY3NZQJ3T8/AAAAAAAAAAI/AAAAAAAABg0/dIpayyn5E5A/photo.jpg?sz=128", "display_name": "Yuva Raj", "link": "https://stackoverflow.com/users/6469426/yuva-raj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466252752, "creation_date": 1466252752, "question_id": 37896923, "link": "https://stackoverflow.com/questions/37896923/how-to-config-the-grafana-to-dev-enviornment", "title": "How to config the grafana to dev enviornment", "body": "<p>As am searching for graph UI, I came across grafana, the features are pretty good.Now i'd like to use grafana and contribute to grafana.I am a newbie to go language,can any body help me pointing me in any direction in setting up grafana to my dev env. I've seen documentation of grafana too.can any body help me out!!!</p>\n"}, {"tags": ["c", "go", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 5006324, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02ca4c4c19bea25296dcaabe367d2b7?s=128&d=identicon&r=PG", "display_name": "Buqian Zheng", "link": "https://stackoverflow.com/users/5006324/buqian-zheng"}, "edited": false, "score": 0, "creation_date": 1466311450, "post_id": 37896205, "comment_id": 63260755, "body": "Many thanks. I tried <code>#include &quot;..&#47;..&#47;test.m&quot;</code> and then I can call these C functions. But why <code>#include</code> header not working?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 181, "user_id": 5006324, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02ca4c4c19bea25296dcaabe367d2b7?s=128&d=identicon&r=PG", "display_name": "Buqian Zheng", "link": "https://stackoverflow.com/users/5006324/buqian-zheng"}, "edited": false, "score": 0, "creation_date": 1466330343, "post_id": 37896205, "comment_id": 63264301, "body": "it is Source file inclusion: When the preprocessor finds an #include directive it replaces it by the entire content of the specified file."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 3, "last_activity_date": 1466253639, "last_edit_date": 1466253639, "creation_date": 1466247566, "answer_id": 37896205, "question_id": 37895799, "link": "https://stackoverflow.com/questions/37895799/can-cgo-call-c-function-declared-in-another-directory/37896205#37896205", "title": "Can Cgo call C function declared in another directory?", "body": "<p>according to <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">https://golang.org/cmd/cgo/</a><br>\nAll the cgo CPPFLAGS and CFLAGS directives in a package are concatenated and used to <strong>compile C files in that package</strong>. All the CPPFLAGS and CXXFLAGS directives in a package are concatenated and used to compile C++ files in that package. All the LDFLAGS directives in any package in the program are concatenated and used at link time. All the pkg-config directives are concatenated and sent to pkg-config simultaneously to add to each appropriate set of command-line flags.</p>\n\n<p>Go package boundary is src folder so you may put all c files in same folder/ or use <strong>include C file</strong>(not  h file)  workaround like this:  </p>\n\n<pre><code>// main.go\npackage main\n\n//#include \"../ctest/test.c\"\nimport \"C\"\nimport \"fmt\"\n\nfunc main() {\n    r := C.Add(10, 20)\n    fmt.Println(r)\n}\n</code></pre>\n\n<p>and c file in ctest dir:</p>\n\n<pre><code>//test.c\n\nint Add(int a, int b){\n    return a+b;\n}\n</code></pre>\n\n<p>this works fine.  </p>\n"}], "owner": {"reputation": 181, "user_id": 5006324, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b02ca4c4c19bea25296dcaabe367d2b7?s=128&d=identicon&r=PG", "display_name": "Buqian Zheng", "link": "https://stackoverflow.com/users/5006324/buqian-zheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1890, "favorite_count": 2, "accepted_answer_id": 37896205, "answer_count": 1, "score": 2, "last_activity_date": 1466310375, "creation_date": 1466244643, "last_edit_date": 1466310375, "question_id": 37895799, "link": "https://stackoverflow.com/questions/37895799/can-cgo-call-c-function-declared-in-another-directory", "title": "Can Cgo call C function declared in another directory?", "body": "<p>It seems that I can't use Cgo to call a C function declared in another directory rather than current Go package. </p>\n\n<p>Codes of all files :</p>\n\n<pre><code>// TestGoCallOC.go\npackage main\n/*\n#include \"test.h\"\n#cgo CFLAGS: -x objective-c\n#cgo LDFLAGS: -framework Foundation\n*/\nimport \"C\"\nimport (\n    \"fmt\"\n)\nfunc main()  {\n    fmt.Println(C.fortytwo())\n}\n\n// test.h\n#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\nint fortytwo();\n\n// test.m\n#include \"test.h\"\nint fortytwo() {\n    return 42;\n}\n</code></pre>\n\n<p>If I put all the files in one directory:</p>\n\n<pre><code>|--src\n   |--TestGoCallOC\n      |--TestGoCallOC.go\n      |--test.h\n      |--test.m\n</code></pre>\n\n<p>and run the Go main function, these two C functions could be called.</p>\n\n<p>But if I put C files (actually they are Objective-C files) in another direcory:</p>\n\n<pre><code>|--src\n   |--TestGoCallOC\n      |--TestGoCallOC.go\n   |--SomeOCCodes\n      |--test.h\n      |--test.m\n</code></pre>\n\n<p>, change the file path of <code>#include \"test.h\"</code> in preamble to it absolute path, and run the Go main function, these two C functions could not be called.</p>\n\n<p>Error message is </p>\n\n<p>Undefined symbols for architecture x86_64:\n  \"_fortytwo\", referenced from:\n      __cgo_b3674ecbf56b_Cfunc_fortytwo in TestGoCallOC.cgo2.o\n     (maybe you meant: __cgo_b3674ecbf56b_Cfunc_fortytwo)\nld: symbol(s) not found for architecture x86_64\nclang: error: linker command failed with exit code 1 (use -v to see invocation)\nexit status 2</p>\n\n<p>Did I do something wrong? Or is Cgo not capable of doing this?</p>\n"}, {"tags": ["go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 372, "user_id": 3639962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CYUdt.jpg?s=128&g=1", "display_name": "pca", "link": "https://stackoverflow.com/users/3639962/pca"}, "edited": false, "score": 0, "creation_date": 1466453014, "post_id": 37896593, "comment_id": 63312539, "body": "That break issue was a real rookie mistake. How embarrassing. However, my question was not so much how to solve the exercise. I had done that already. I was just trying to play around with selects and defaults. Using the label as you suggested I could go a step further and with additional output I could see that the default was no longer present. Why is that if the channels for the case clauses were already closed?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "reply_to_user": {"reputation": 372, "user_id": 3639962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CYUdt.jpg?s=128&g=1", "display_name": "pca", "link": "https://stackoverflow.com/users/3639962/pca"}, "edited": false, "score": 0, "creation_date": 1466478913, "post_id": 37896593, "comment_id": 63319948, "body": "No it is not embarrassing, this is happen in any programming task every day and about default you do not need default here it is for non-blocking select, and you have infinite for loop here so you are just waiting for channels to do something, if channels closed that else statement will handle it , no problem. By using default you need to check twice for closed channels one in case and one in default statement so I optimized it a little."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 3, "last_activity_date": 1466284796, "last_edit_date": 1495539952, "creation_date": 1466250598, "answer_id": 37896593, "question_id": 37895441, "link": "https://stackoverflow.com/questions/37895441/golang-channels-using-select-doesnt-stop/37896593#37896593", "title": "Golang channels using select doesn&#39;t stop", "body": "<p><strong>A \"break\" statement terminates execution of the innermost \"for\", \"switch\" or \"select\" statement.</strong><br>\nsee: <a href=\"http://golang.org/ref/spec#Break_statements\" rel=\"nofollow noreferrer\">http://golang.org/ref/spec#Break_statements</a><br>\nthe break statement in your example terminates the select statement, the \"innermost\" statement.<br>\nso <strong>add label</strong>: ForLoop before for loop  and add <strong>break ForLoop</strong>   </p>\n\n<pre><code>ForLoop:\n    for {\n        select {\n        case tree1val, tree1open = &lt;-ch1:\n            if tree1open {\n                out1 = append(out1, tree1val)\n            } else if !tree2open {\n                break ForLoop\n            }\n        case tree2val, tree2open = &lt;-ch2:\n            if tree2open {\n                out2 = append(out2, tree2val)\n            } else if !tree1open {\n                break ForLoop\n            }\n        }\n    }\n</code></pre>\n\n<p>don't read the rest if you want to solve that problem yourself, and come back when you are done:\nsolution 1 (similar to yours):  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"golang.org/x/tour/tree\"\n\n// Walk walks the tree t sending all values\n// from the tree to the channel ch.\nfunc Walk(t *tree.Tree, ch chan int) {\n    _walk(t, ch)\n    close(ch)\n}\n\nfunc _walk(t *tree.Tree, ch chan int) {\n    if t.Left != nil {\n        _walk(t.Left, ch)\n    }\n    ch &lt;- t.Value\n    if t.Right != nil {\n        _walk(t.Right, ch)\n    }\n}\n\n// Same determines whether the trees\n// t1 and t2 contain the same values.\nfunc Same(t1, t2 *tree.Tree) bool {\n    ch1, ch2 := make(chan int), make(chan int)\n    go Walk(t1, ch1)\n    go Walk(t2, ch2)\n\n    tree1open, tree2open := false, false\n    tree1val, tree2val := 0, 0\n    out1, out2 := make([]int, 0, 10), make([]int, 0, 10)\nForLoop:\n    for {\n        select {\n        case tree1val, tree1open = &lt;-ch1:\n            if tree1open {\n                out1 = append(out1, tree1val)\n            } else if !tree2open {\n                break ForLoop\n            }\n        case tree2val, tree2open = &lt;-ch2:\n            if tree2open {\n                out2 = append(out2, tree2val)\n            } else if !tree1open {\n                break ForLoop\n            }\n        }\n    }\n    if len(out1) != len(out2) {\n        return false\n    }\n    for i, v := range out1 {\n        if v != out2[i] {\n            return false\n        }\n    }\n    return true\n}\n\nfunc main() {\n    ch := make(chan int)\n    go Walk(tree.New(1), ch)\n    for i := range ch {\n        fmt.Println(i)\n    }\n    fmt.Println(Same(tree.New(1), tree.New(1)))\n    fmt.Println(Same(tree.New(1), tree.New(2)))\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\ntrue\nfalse    \n</code></pre>\n\n<p>another way:  </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"golang.org/x/tour/tree\"\n\n// Walk walks the tree t sending all values\n// from the tree to the channel ch.\nfunc Walk(t *tree.Tree, ch chan int) {\n    _walk(t, ch)\n    close(ch)\n}\n\nfunc _walk(t *tree.Tree, ch chan int) {\n    if t != nil {\n        _walk(t.Left, ch)\n        ch &lt;- t.Value\n        _walk(t.Right, ch)\n    }\n}\n\n// Same determines whether the trees\n// t1 and t2 contain the same values.\nfunc Same(t1, t2 *tree.Tree) bool {\n    ch1, ch2 := make(chan int), make(chan int)\n    go Walk(t1, ch1)\n    go Walk(t2, ch2)\n    for v := range ch1 {\n        if v != &lt;-ch2 {\n            return false\n        }\n    }\n    return true\n}\n\nfunc main() {\n    ch := make(chan int)\n    go Walk(tree.New(1), ch)\n    for v := range ch {\n        fmt.Println(v)\n    }\n    fmt.Println(Same(tree.New(1), tree.New(1)))\n    fmt.Println(Same(tree.New(1), tree.New(2)))\n}\n</code></pre>\n\n<p>output:  </p>\n\n<pre><code>1\n2\n3\n4\n5\n6\n7\n8\n9\n10\ntrue\nfalse    \n</code></pre>\n\n<p>and see:<br>\n<a href=\"https://stackoverflow.com/questions/12224042/go-tour-exercise-equivalent-binary-trees\">Go Tour Exercise: Equivalent Binary Trees</a></p>\n"}, {"comments": [{"owner": {"reputation": 372, "user_id": 3639962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CYUdt.jpg?s=128&g=1", "display_name": "pca", "link": "https://stackoverflow.com/users/3639962/pca"}, "edited": false, "score": 0, "creation_date": 1466453191, "post_id": 37900905, "comment_id": 63312619, "body": "Thanks for the tip. What I am curious now is why do we have to check if the channels are closed in both case clauses. Why doesn&#39;t it work in the default clause?"}, {"owner": {"reputation": 21, "user_id": 6483557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda8a98b359eaa3887166d5a6e7b2541?s=128&d=identicon&r=PG&f=1", "display_name": "tipra", "link": "https://stackoverflow.com/users/6483557/tipra"}, "reply_to_user": {"reputation": 372, "user_id": 3639962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CYUdt.jpg?s=128&g=1", "display_name": "pca", "link": "https://stackoverflow.com/users/3639962/pca"}, "edited": false, "score": 0, "creation_date": 1466785596, "post_id": 37900905, "comment_id": 63477936, "body": "Hi pca, since the default values for tree1open and tree2open are both false, if you put it in the default case of switch, it would simply break from the forloop. If you do initialize tree1open and tree2open as true, it would run into an infinite loop, because when a channel is closed, the following does not block, it returns every time: val, closed := &lt;- ch"}], "tags": [], "owner": {"reputation": 21, "user_id": 6483557, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bda8a98b359eaa3887166d5a6e7b2541?s=128&d=identicon&r=PG&f=1", "display_name": "tipra", "link": "https://stackoverflow.com/users/6483557/tipra"}, "is_accepted": false, "score": 1, "last_activity_date": 1466278445, "creation_date": 1466278445, "answer_id": 37900905, "question_id": 37895441, "link": "https://stackoverflow.com/questions/37895441/golang-channels-using-select-doesnt-stop/37900905#37900905", "title": "Golang channels using select doesn&#39;t stop", "body": "<p>The suggestion by Amd is a valid one in the previous answer. However, looking at the problem you're trying to solve, it still does not solve the it. (If you run the program, it will output true for both the cases)</p>\n\n<p>Here's the problem:</p>\n\n<pre><code>for {\n    select {\n    case tree1val, tree1open = &lt;-ch1:\n        out1 = append(out1, tree1val)\n    case tree2val, tree2open = &lt;-ch2:\n        out2 = append(out2, tree2val)\n    default:\n        //runtime.Gosched()\n        if !tree1open &amp;&amp; !tree2open {\n            break ForLoop\n        } else {\n            fmt.Println(\"Channel open?\", tree1open, tree2open)\n        }\n    }\n}\n</code></pre>\n\n<p>In this case, since the default values of tree1open and tree2open are false (according to golang specification), it goes to the 'default' case, because select is non-blocking, and simply breaks from the ForLoop, without even filling the out1 and out2 slices (possibly, since these are goroutines). Hence the lengths of out1 and out2 remain zero, due to which it outputs true in most cases.</p>\n\n<p>Here is the correction:</p>\n\n<pre><code>ForLoop:\nfor {\n    select {\n    case tree1val, tree1open = &lt;-ch1:\n        if tree1open {\n            out1 = append(out1, tree1val)\n        }\n        if !tree1open &amp;&amp; !tree2open {\n            break ForLoop\n        }\n    case tree2val, tree2open = &lt;-ch2:\n        if tree2open {\n            out2 = append(out2, tree2val)\n        }\n        if !tree1open &amp;&amp; !tree2open {\n            break ForLoop\n        }\n    default:\n\n    }\n}\n</code></pre>\n\n<p>The key thing to note is that we have to check whether the channels have been closed in both cases (equivalent to saying whether tree1open and tree2open are both false). Here, it will correctly fill up out1 and out2 slices and then further compare their respective values.</p>\n\n<p>The check for tree1open (or tree2open) being true has been added before append simply to avoid appending zero values to out1 (or out2). </p>\n\n<p>Thanks,</p>\n"}], "owner": {"reputation": 372, "user_id": 3639962, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/CYUdt.jpg?s=128&g=1", "display_name": "pca", "link": "https://stackoverflow.com/users/3639962/pca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2368, "favorite_count": 1, "accepted_answer_id": 37896593, "answer_count": 2, "score": 2, "last_activity_date": 1466284796, "creation_date": 1466242367, "question_id": 37895441, "link": "https://stackoverflow.com/questions/37895441/golang-channels-using-select-doesnt-stop", "title": "Golang channels using select doesn&#39;t stop", "body": "<p>Go-lang newbie here. I am trying out Go's Tour of Go, and came across an exercise about channels (<a href=\"https://tour.golang.org/concurrency/7\" rel=\"nofollow\">https://tour.golang.org/concurrency/7</a>).\nThe idea is to walk two trees and then evaluate if the trees are equivalent.</p>\n\n<p>I wanted to solve this exercise using a select waiting for results from both channels. When both would finish I evaluate the resulting slice. Unfortunately the method goes on an infinite loop. I added some output to see what was happening and noticed that only one of the channels was being closed, and then opened again.</p>\n\n<p>I am clearly doing something wrong, but I can't see what.\nMy question is what am I doing wrong? What assumption am I making regarding the closing of channels that makes the code below go into an infinite loop?</p>\n\n<pre><code>package main\n\nimport (\n    \"golang.org/x/tour/tree\"\n    \"fmt\"\n)\n\n// Walk walks the tree t sending all values\n// from the tree to the channel ch.\nfunc Walk(t *tree.Tree, ch chan int) {\n    _walk(t, ch)\n    close(ch)\n}\n\nfunc _walk(t *tree.Tree, ch chan int) {\n    if (t.Left != nil) {\n        _walk(t.Left, ch)\n    }\n    ch &lt;- t.Value\n    if (t.Right != nil) {\n        _walk(t.Right, ch)\n    }\n}\n\n// Same determines whether the trees\n// t1 and t2 contain the same values.\nfunc Same(t1, t2 *tree.Tree) bool {\n    ch1 := make(chan int)\n    ch2 := make(chan int)\n    go Walk(t1, ch1)\n    go Walk(t2, ch2)\n\n    var out1 []int\n    var out2 []int\n\n    var tree1open, tree2open bool\n    var tree1val, tree2val int\n    for {\n        select {\n        case tree1val, tree1open = &lt;- ch1:\n            out1 = append(out1, tree1val)\n        case tree2val, tree2open = &lt;- ch2:\n            out2 = append(out2, tree2val)\n        default:\n            if (!tree1open &amp;&amp; !tree2open) {\n                break\n            } else {\n                fmt.Println(\"Channel open?\", tree1open, tree2open)\n            }\n        }\n    }\n\n    if (len(out1) != len(out2)) {\n        return false\n    }\n\n    for i := 0 ; i &lt; len(out1) ; i++ {\n        if (out1[i] != out2[i]) {\n            return false\n        }\n    }\n\n    return true\n}\n\nfunc main() {\n    ch := make(chan int)\n    go Walk(tree.New(1), ch)\n\n    for i := range ch {\n        fmt.Println(i)\n    }\n\n    fmt.Println(Same(tree.New(1), tree.New(1)))\n    fmt.Println(Same(tree.New(1), tree.New(2)))\n}\n</code></pre>\n"}, {"tags": ["javascript", "go", "request"], "comments": [{"owner": {"reputation": 755, "user_id": 1567340, "user_type": "registered", "accept_rate": 29, "profile_image": "https://i.stack.imgur.com/amsaC.png?s=128&g=1", "display_name": "Huy Tran", "link": "https://stackoverflow.com/users/1567340/huy-tran"}, "edited": false, "score": 0, "creation_date": 1466224132, "post_id": 37892769, "comment_id": 63240667, "body": "How about static serving the <code>tmp</code> folder?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1466238893, "post_id": 37892769, "comment_id": 63243585, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/24116147/golang-how-to-download-file-in-browser-from-golang-server\">golang - how to download file in browser from golang server?</a>"}], "owner": {"reputation": 1871, "user_id": 4178182, "user_type": "registered", "accept_rate": 59, "profile_image": "https://lh6.googleusercontent.com/-nwJYccYDwvs/AAAAAAAAAAI/AAAAAAAAOUg/A4Wnjm7UsLM/photo.jpg?sz=128", "display_name": "jrkt", "link": "https://stackoverflow.com/users/4178182/jrkt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 560, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466217934, "creation_date": 1466217934, "question_id": 37892769, "link": "https://stackoverflow.com/questions/37892769/force-browser-download-from-golang-return-data", "title": "Force Browser Download from Golang return data", "body": "<p>I have a Go server that serves endpoints of an api. One of the endpoints creates an mp3 file and returns either the path of the converted file or all the bytes of the file. I am looking for one of two solutions.</p>\n\n<p>The first solution would be to allow local file access for the 'href'. I have the output file string \"/tmp/audio-hash123.mp3\" returned from the Go server after it has done it's thing. The problem is that whenever I pass that to the 'href' to trigger the file download, it treats it as an absolute path such as \"www.example.com/tmp/audio-hash123.mp3\" instead of just allowing local access to the file. I have the converted audio file available locally but my tmp directory is obviously not externally accessible so this fails every time. Is this even possible?</p>\n\n<p>The second solution would be for the client to allow for a triggered download based on the actual audio file returned from the server, not just the file path. I can't think of any way this is possible based on the fact that the html 'download' attribute is based on the path to the file to be downloaded. Is there a way to force a file download based on returning from the server the actual audio file?</p>\n\n<p>Below is a small portion of the Go server that sends back either the file path or the actual audio file (in a byte array):</p>\n\n<pre><code>if ReturnFilePath == true {\n    //return the filepath for webpage to download\n    request.Send(outputFile)\n} else {\n    //return the audio file\n    //get mime type\n    mimeType := GetMime(filepath)\n    if mimeType != \"\" {\n        req.Ctx.Response.Header.Set(\"Content-Type\", mimeType)\n    }\n\n    //open image\n    file, err := os.Open(filepath)\n    if err != nil {\n        req.Send(err.Error())\n        return\n    }\n\n    //get bytes of image\n    bytes, err := ioutil.ReadAll(file)\n    if err != nil {\n        req.Send(err.Error())\n        return\n    }\n\n    req.Send(bytes)\n}\n</code></pre>\n\n<p>With the data returned, I will facilitate the download in JavaScript. But, I need help in figuring out how to accomplish this. Any help is appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "edited": false, "score": 0, "creation_date": 1466426251, "post_id": 37891389, "comment_id": 63295619, "body": "I never saw anyone download packages this way. I&#39;m seeing a problem here. When one of your deps update a version your project can break because version incompatibility. Did you take a look at vendoring?"}, {"owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "reply_to_user": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "edited": false, "score": 0, "creation_date": 1466436858, "post_id": 37891389, "comment_id": 63303383, "body": "Yeah I did take a look, but I didn&#39;t use it yet. It feels overwhelming because there are so many different applications for vendoring and I was used to just use <code>go get</code>. Which one of the many vendoring apps do you recommend?"}, {"owner": {"reputation": 1435, "user_id": 1185166, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/b6e8dfe1641b4a326e6b2e6a5767e6f3?s=128&d=identicon&r=PG", "display_name": "Luiz de Pr&#225;", "link": "https://stackoverflow.com/users/1185166/luiz-de-pr%c3%a1"}, "edited": false, "score": 0, "creation_date": 1466440797, "post_id": 37891389, "comment_id": 63305914, "body": "I&#39;m using <a href=\"https://github.com/kardianos/govendor\" rel=\"nofollow noreferrer\">govendor</a>."}], "answers": [{"comments": [{"owner": {"reputation": 538, "user_id": 989227, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1e564869f8fdf3ef2c3920cc113423b?s=128&d=identicon&r=PG", "display_name": "santiaago", "link": "https://stackoverflow.com/users/989227/santiaago"}, "edited": false, "score": 0, "creation_date": 1559554763, "post_id": 40163651, "comment_id": 99444150, "body": "this answer help me find the solution, in my case a build inside Docker was failing, I updated my golang version from <code>FROM golang:1.10-alpine3.8 as builder</code> to <code>FROM golang:1.12.5-alpine3.9 as builder</code>"}], "tags": [], "owner": {"reputation": 1067, "user_id": 435478, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/Fj0sO.jpg?s=128&g=1", "display_name": "Hamza", "link": "https://stackoverflow.com/users/435478/hamza"}, "is_accepted": false, "score": 2, "last_activity_date": 1476994214, "creation_date": 1476994214, "answer_id": 40163651, "question_id": 37891389, "link": "https://stackoverflow.com/questions/37891389/go-get-refuses-to-download-gopkg-in-yaml-v2/40163651#40163651", "title": "go get ./... refuses to download gopkg.in/yaml.v2", "body": "<p>Apparently you have issues with get, try <code>go get -v gopkg.in/yaml.v2</code> and you'll face an error if you have git &lt;=1.7.1</p>\n\n<p>Just upgrade your git client, and problem fixed</p>\n\n<p>You can also solve this by cloning the yaml.v2 repo into :\n<code>/home/ci/.jenkins/jobs/BlenderRender-Client/workspace/src/gopkg.in/yaml.v2</code></p>\n\n<p>run a <code>git clone https://github.com/go-yaml/yaml.git /home/ci/.jenkins/jobs/BlenderRender-Client/workspace/src/gopkg.in/yaml.v2</code></p>\n"}], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2360, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1476994214, "creation_date": 1466203571, "question_id": 37891389, "link": "https://stackoverflow.com/questions/37891389/go-get-refuses-to-download-gopkg-in-yaml-v2", "title": "go get ./... refuses to download gopkg.in/yaml.v2", "body": "<p>I'm just \"getting\" all required libraries by using <code>go get ./...</code> and go-get happily downloads all libs which are imported directly from github.com, however I get the error:</p>\n\n<pre><code>src/github.com/urfave/cli/altsrc/yaml_file_loader.go:17:2: cannot find package \"gopkg.in/yaml.v2\" in any of:\n    /home/ci/.jenkins/tools/org.jenkinsci.plugins.golang.GolangInstallation/Go_1.6/src/gopkg.in/yaml.v2 (from $GOROOT)\n    /home/ci/.jenkins/jobs/BlenderRender-Client/workspace/src/gopkg.in/yaml.v2 (from $GOPATH)\n</code></pre>\n\n<p>Sure, I could <code>go get gopkg.in/yaml.v2</code> and it would work, however I'm setting up a CI server to automatically compile my project and I'd rather have <code>go get ./...</code> just download <em>everything</em> and not complain about gopkg.in-packets since I don't want to reconfigure my CI server every time some requirement changes.</p>\n\n<p>Is there a way to tell <code>go get ./...</code> that it's fine to download <code>gopkg.in</code> packets?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 24, "last_activity_date": 1466206335, "last_edit_date": 1466206335, "creation_date": 1466205795, "answer_id": 37891660, "question_id": 37891280, "link": "https://stackoverflow.com/questions/37891280/goroutine-time-sleep-or-time-after/37891660#37891660", "title": "Goroutine: time.Sleep or time.After", "body": "<p>I don't think it matters much for the majority of programs. There has been a <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/9BL6v7Nqj_I\" rel=\"noreferrer\">question on golang-nuts about this</a> but I don't think one can draw any conclusion.</p>\n\n<p>In practice <code>After</code> is useful in contexts where one already needs to <code>select</code> on a number of channels but would also like a timeout:</p>\n\n<pre><code>select {\ncase c := &lt;-someChan:\n  ..\ncase c := &lt;-otherChan:\n  ..\ncase &lt;-time.After(time.Second * 42):\n}\n</code></pre>\n\n<p>By superficially looking at the code <code>Sleep</code> seems simpler while <code>After</code> builds a new timer, with a period, a closure to send the time when it finishes etc.</p>\n\n<p>Again, I don't think it matters in practice but <code>time.Sleep</code> seems pretty readable so I would go with that.</p>\n\n<hr>\n\n<p>On my implementation both of them perform the exact same system calls and end up waiting: </p>\n\n<pre><code>futex(??, FUTEX_WAIT, 0, {41, 999892351}\n                          ^^ 41 seconds and change\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 33451, "user_id": 3011380, "user_type": "registered", "accept_rate": 48, "profile_image": "https://i.stack.imgur.com/oN76M.jpg?s=128&g=1", "display_name": "zangw", "link": "https://stackoverflow.com/users/3011380/zangw"}, "is_accepted": false, "score": 2, "last_activity_date": 1603456528, "creation_date": 1603456528, "answer_id": 64500114, "question_id": 37891280, "link": "https://stackoverflow.com/questions/37891280/goroutine-time-sleep-or-time-after/64500114#64500114", "title": "Goroutine: time.Sleep or time.After", "body": "<p>Per <a href=\"https://go101.org/article/unofficial-faq.html#time-sleep-after\" rel=\"nofollow noreferrer\">go101</a></p>\n<blockquote>\n<p>The two will both pause the current goroutine execution for a certain duration. The difference is the function call time.Sleep(d) will let the current goroutine enter sleeping sub-state, but still stay in running state, whereas, the channel receive operation &lt;-time.After(d) will let the current goroutine enter blocking state.</p>\n</blockquote>\n"}], "owner": {"reputation": 2966, "user_id": 2190546, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6451296ba1e76dc99cace352b93b5488?s=128&d=identicon&r=PG", "display_name": "J Freebird", "link": "https://stackoverflow.com/users/2190546/j-freebird"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6667, "favorite_count": 4, "accepted_answer_id": 37891660, "answer_count": 2, "score": 18, "last_activity_date": 1603456528, "creation_date": 1466202745, "question_id": 37891280, "link": "https://stackoverflow.com/questions/37891280/goroutine-time-sleep-or-time-after", "title": "Goroutine: time.Sleep or time.After", "body": "<p>I wonder what is the better way to do a wait in a goroutine, <code>time.Sleep()</code> or <code>&lt;-time.After()</code>?  What's the difference between the two and how to make choices? Thanks.</p>\n"}, {"tags": ["multithreading", "recursion", "go", "parallel-processing", "tree"], "comments": [{"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 2, "creation_date": 1466205255, "post_id": 37890633, "comment_id": 63237658, "body": "It would help answer the question if you show the definition of your tree. I&#39;m not sure what you mean by the leaves being slower."}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "reply_to_user": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 0, "creation_date": 1466206802, "post_id": 37890633, "comment_id": 63237998, "body": "@Logiraptor It is not my case, but image file system and you doing operation over a file - say compute a hash. Going over the directories is way cheaper that working on the leaves. Else my tree is abstract - I do not preserve it. I just use level, index to identify the item."}, {"owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 0, "creation_date": 1466373787, "post_id": 37890633, "comment_id": 63276544, "body": "Can you please accept my answer or comment on why it doesn&#39;t solve your problem? :)"}, {"owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "reply_to_user": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 0, "creation_date": 1466374732, "post_id": 37890633, "comment_id": 63276729, "body": "@Logiraptor - I am sorry, but there is probably an obvious line from what you provided as an answer and my question, but I do not see it. I cannot simply queue leafs. Consider the sum example I give, how it fits in your solution?"}, {"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "reply_to_user": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "edited": false, "score": 0, "creation_date": 1573243338, "post_id": 37890633, "comment_id": 103832078, "body": "You&#39;re right, the hard part is traversing the tree, and @Logiraptor&#39;s answer completely punts on that."}], "answers": [{"comments": [{"owner": {"reputation": 6345, "user_id": 483347, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/c2d980bc16657b17b4869229796fcd9d?s=128&d=identicon&r=PG", "display_name": "weberc2", "link": "https://stackoverflow.com/users/483347/weberc2"}, "edited": false, "score": 0, "creation_date": 1573243106, "post_id": 37892007, "comment_id": 103831986, "body": "The problem isn&#39;t super clear, but I think the children need to be processed before the parent (as evidenced by the <code>Sum</code> example in his question), then this approach has an implicit race condition in which a child node might be in-process by one goroutine while another goroutine pulls its parent off of the channel and begins processing it (especially likely given the problem stipulates that leaf nodes are cheap compared to parent nodes)."}], "tags": [], "owner": {"reputation": 1458, "user_id": 1394885, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/1bd0f98dad76d9b2f7efc49a984f69aa?s=128&d=identicon&r=PG", "display_name": "Logiraptor", "link": "https://stackoverflow.com/users/1394885/logiraptor"}, "is_accepted": false, "score": 1, "last_activity_date": 1466208531, "creation_date": 1466208531, "answer_id": 37892007, "question_id": 37890633, "link": "https://stackoverflow.com/questions/37890633/recursively-scan-tree-in-parallel-in-golang/37892007#37892007", "title": "recursively scan tree in parallel in golang", "body": "<p>It sounds like you need a worker pool. Here's an example I just wrote: <a href=\"https://play.golang.org/p/NRM0yyQi8X\" rel=\"nofollow\">https://play.golang.org/p/NRM0yyQi8X</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\ntype Leaf struct {\n    // Whatever\n}\n\nfunc worker(i int, wg *sync.WaitGroup, in &lt;-chan Leaf) {\n    for leaf := range in {\n        time.Sleep(time.Millisecond * 500)\n        fmt.Printf(\"worker %d finished work: %#v\\n\", i, leaf)\n    }\n    fmt.Printf(\"worker %d exiting\\n\", i)\n    wg.Done()\n}\n\nfunc main() {\n    var jobQueue = make(chan Leaf)\n    var numWorkers = 10\n    // the waitgroup will allow us to wait for all the goroutines to finish at the end\n    var wg = new(sync.WaitGroup)\n    for i := 0; i &lt; numWorkers; i++ {\n        wg.Add(1)\n        go worker(i, wg, jobQueue)\n    }\n\n    // enqueue work (this goes inside your tree traversal.)\n    for i := 0; i &lt; 100; i++ {\n        jobQueue &lt;- Leaf{}\n    }\n\n    // closing jobQueue will cause all goroutines to exit the loop on the channel.\n    close(jobQueue)\n    // Wait for all the goroutines to finish\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "is_accepted": false, "score": 0, "last_activity_date": 1510091964, "creation_date": 1510091964, "answer_id": 47168143, "question_id": 37890633, "link": "https://stackoverflow.com/questions/37890633/recursively-scan-tree-in-parallel-in-golang/47168143#47168143", "title": "recursively scan tree in parallel in golang", "body": "<p>I strongly suggest reading this excellent blog post from top to bottom:</p>\n\n<p><a href=\"https://blog.golang.org/pipelines\" rel=\"nofollow noreferrer\">https://blog.golang.org/pipelines</a></p>\n\n<p>It covers not only an example of <strong><em>exactly</em></strong> what you need (i.e. <a href=\"https://blog.golang.org/pipelines/parallel.go\" rel=\"nofollow noreferrer\">parallelized file-tree walk calculating MD5 file checksums</a>), but <strong><em>much much</em></strong> more:</p>\n\n<blockquote>\n  <ul>\n  <li>fan-in/fan-out channel techniques</li>\n  <li>parallelism</li>\n  <li>pipeline cancellations via <em>done</em> channels</li>\n  <li>pipeline error chaining via <em>error</em> channels</li>\n  <li>bounded parallelism</li>\n  </ul>\n</blockquote>\n\n<p>The last topic, <strong>bounded parallelism</strong>, is used to ensure 'walking' large-node directory-trees do not create excessive go-routines: <a href=\"https://blog.golang.org/pipelines/bounded.go\" rel=\"nofollow noreferrer\">bounded.go</a></p>\n"}], "owner": {"reputation": 5088, "user_id": 1870790, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/74516aa9ada5685130de646902051d8c?s=128&d=identicon&r=PG", "display_name": "gsf", "link": "https://stackoverflow.com/users/1870790/gsf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1597, "favorite_count": 0, "answer_count": 2, "score": 4, "last_activity_date": 1510091964, "creation_date": 1466198956, "last_edit_date": 1466207323, "question_id": 37890633, "link": "https://stackoverflow.com/questions/37890633/recursively-scan-tree-in-parallel-in-golang", "title": "recursively scan tree in parallel in golang", "body": "<p>I have a binary tree that accessing a node is relatively fast, with the exception of the leaves - they might be 100-1000 times slower. I have a recursive algorithm that I would like to implement in go (I am new to it).</p>\n\n<p>Because I have to get to the leaves to get benefits from the parallelism I need to parallelize the execution higher in the tree. This though might result in millions of goroutines. Limiting this with semaphore does not seem the 'go' way- there is no such sync primitive. Another concern I have is how expensive is, in fact, a channel, should I use wait group instead.</p>\n\n<p>My tree is abstract and the algorithm runs over it identifying the items by level and index. </p>\n\n<pre><code>// l3               0\n//               /    \\\n// l2          0        1\n//           /  \\     /   \\\n// l1       0    1   2     3\n//         / \\  / \\ / \\   / \\\n// l0     0  1 2  3 4 5  6  7\n</code></pre>\n\n<p>For example, I can use such to compute sum of all items in a vector with the function:</p>\n\n<pre><code>func Sum(level, index int, items []int) int {\n    if level == 0 {return items[index]}\n    return Sum(level-1, index*2, items) + Sum(level-1, index*2+1, items)\n}\n</code></pre>\n\n<p>What should be my approach? Can someone point me to a recursive tree multithreaded algorithm implemented in go?</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 846, "user_id": 3332282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802cbc0369003c129ade6a040394320c?s=128&d=identicon&r=PG", "display_name": "Brian Stengaard - Podio", "link": "https://stackoverflow.com/users/3332282/brian-stengaard-podio"}, "edited": false, "score": 0, "creation_date": 1466194688, "post_id": 37889726, "comment_id": 63233970, "body": "What is a Point value? A coordinate set, like <code>type Point struct{ X, Y int }</code>? Also: why? What have you tried? Why was the other solutions not satisfying? You need to add more detail to your problem description."}, {"owner": {"reputation": 39, "user_id": 1336369, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9dcc7d9b579b2a5a641c55543fb99a19?s=128&d=identicon&r=PG", "display_name": "Eddi3", "link": "https://stackoverflow.com/users/1336369/eddi3"}, "reply_to_user": {"reputation": 846, "user_id": 3332282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802cbc0369003c129ade6a040394320c?s=128&d=identicon&r=PG", "display_name": "Brian Stengaard - Podio", "link": "https://stackoverflow.com/users/3332282/brian-stengaard-podio"}, "edited": false, "score": 0, "creation_date": 1466194941, "post_id": 37889726, "comment_id": 63234081, "body": "In postgres SQL I can make a column that holds a Type Point, it should be an X and Y yes but it will store lat and lng so it might not be an int type unless that&#39;s the only type that can be stored in a point in postgres sql. I looked at similar posts about this on stack overflow: <a href=\"http://stackoverflow.com/questions/1727137/sql-query-for-performing-radius-search-based-on-latitude-longitude\" title=\"sql query for performing radius search based on latitude longitude\">stackoverflow.com/questions/1727137/&hellip;</a>             I took a look at the 2nd answer that names making a spatial column using a point"}, {"owner": {"reputation": 39, "user_id": 1336369, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9dcc7d9b579b2a5a641c55543fb99a19?s=128&d=identicon&r=PG", "display_name": "Eddi3", "link": "https://stackoverflow.com/users/1336369/eddi3"}, "reply_to_user": {"reputation": 846, "user_id": 3332282, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/802cbc0369003c129ade6a040394320c?s=128&d=identicon&r=PG", "display_name": "Brian Stengaard - Podio", "link": "https://stackoverflow.com/users/3332282/brian-stengaard-podio"}, "edited": false, "score": 0, "creation_date": 1466195092, "post_id": 37889726, "comment_id": 63234151, "body": "Basically I want to do what was mentioned in the 2nd post using a GORM struct as mentioned in this site: <a href=\"http://jinzhu.me/gorm/models.html\" rel=\"nofollow noreferrer\">jinzhu.me/gorm/models.html</a>"}], "owner": {"reputation": 39, "user_id": 1336369, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9dcc7d9b579b2a5a641c55543fb99a19?s=128&d=identicon&r=PG", "display_name": "Eddi3", "link": "https://stackoverflow.com/users/1336369/eddi3"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 425, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466194525, "creation_date": 1466194525, "question_id": 37889726, "link": "https://stackoverflow.com/questions/37889726/how-to-store-a-point-in-postgres-sql-database-using-gorm", "title": "How to store a point in postgres SQL database using gorm", "body": "<p>I'm trying to store a Point variable in an SQL database using GORM on a go server, I tried looking everywhere but I haven't seen an answer that satisfies me yet</p>\n"}, {"tags": ["go", "orm", "revel", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 249, "user_id": 1644033, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/25a28669256c08e8b495ced8e69507a4?s=128&d=identicon&r=PG&f=1", "display_name": "user1644033", "link": "https://stackoverflow.com/users/1644033/user1644033"}, "is_accepted": true, "score": 0, "last_activity_date": 1466251949, "creation_date": 1466251949, "answer_id": 37896784, "question_id": 37888262, "link": "https://stackoverflow.com/questions/37888262/gorm-load-related-data/37896784#37896784", "title": "Gorm load related Data", "body": "<p>After the gorm Update yesterday eve. All (code in question) works like the docs. :)</p>\n"}], "owner": {"reputation": 249, "user_id": 1644033, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/25a28669256c08e8b495ced8e69507a4?s=128&d=identicon&r=PG&f=1", "display_name": "user1644033", "link": "https://stackoverflow.com/users/1644033/user1644033"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1391, "favorite_count": 0, "accepted_answer_id": 37896784, "answer_count": 1, "score": 0, "last_activity_date": 1467148639, "creation_date": 1466188768, "last_edit_date": 1467148639, "question_id": 37888262, "link": "https://stackoverflow.com/questions/37888262/gorm-load-related-data", "title": "Gorm load related Data", "body": "<p>playing around with the golang gorm orm, I have the following problem of comprehension:</p>\n\n<p>My model looks like:</p>\n\n<pre><code>package models\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/sqlite\"\n)\n\ntype Book struct {\n    gorm.Model\n    Title       string `gorm:\"size:255;not null;\"`\n    Desctiption string\n    Tags        []Tag `gorm:\"many2many:book_tags;\"`\n}\n\ntype Tag struct {\n    ID   int\n    Name string\n}\n</code></pre>\n\n<p>I use this in my revel controller, like this:</p>\n\n<pre><code>import (\n    \"github.com/foobar/myrevel/app/models\"\n    \"github.com/revel/revel\"\n)\n\ntype Book struct {\n    GormController\n}\n\nfunc (c Book) Books() revel.Result {\n    books := &amp;[]models.Book{}\n    // don't loads tags\n    //Gdb.Order(\"id desc\").Find(&amp;books)\n    // don't loads tags\n    Gdb.Preload(\"Tags\").Order(\"id desc\").Find(&amp;books).Related(\"Tags\")\n\n    return c.Render(books)\n}\n</code></pre>\n\n<p>The db tables are there: books, tags and book_tags\nCreate with code first, inserting works fine.</p>\n\n<pre><code>func (c Book) InsertTestData() revel.Result {\n    book := &amp;models.Book{\n        Title:       \"Hello Go lang\",\n        Desctiption: \"The bueaty of golang\",\n        Tags:        []models.Tag{{Name: \"Golang\"}, {Name: \"Go\"}},\n    }\n\n    Gdb.NewRecord(&amp;book)\n    Gdb.Create(&amp;book)\n}\n</code></pre>\n\n<p>Ah and the view code:</p>\n\n<pre><code>&lt;tbody&gt;\n  {{range .books}}\n    &lt;tr&gt;\n      &lt;td&gt;{{.Title}}&lt;/td&gt;\n      &lt;td&gt;\n        {{.Desctiption}}&lt;br /&gt;\n        {{range .Tags}}\n          {{.Name}}\n        {{end}}\n      &lt;/td&gt;\n    &lt;/tr&gt;\n  {{end}}\n&lt;/tbody&gt;\n</code></pre>\n\n<p>In the gorm docs it says:</p>\n\n<pre><code>db.Model(&amp;user).Related(&amp;emails)\n//// SELECT * FROM emails WHERE user_id = 111; // 111 is user's primary key\n</code></pre>\n\n<p><a href=\"http://jinzhu.me/gorm/associations.html#many-to-many\" rel=\"nofollow\">http://jinzhu.me/gorm/associations.html#many-to-many</a></p>\n\n<p>Tags are always empty iteration over books works fine. To it (invalid association []) but works for books.</p>\n\n<p>Where is the mistake and how to do it right?</p>\n\n<p>Thanks for your time and help.</p>\n\n<p>Cheers</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 4, "creation_date": 1466193634, "post_id": 37887756, "comment_id": 63233489, "body": "Stop whatever u are doing, read <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">Effective Go</a>, and then go back to work.  Else the linters are going to eat you alive!"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 14, "last_activity_date": 1466186960, "creation_date": 1466186960, "answer_id": 37887798, "question_id": 37887756, "link": "https://stackoverflow.com/questions/37887756/exported-const-should-have-a-comment/37887798#37887798", "title": "Exported const should have a comment", "body": "<p>Comments for documentation always immediately preceded what they are documenting.</p>\n\n<pre><code>const (\n    // FATAL represents fatal errors\n    FATAL = iota\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 345, "user_id": 7100172, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ji_ffAXbA68/AAAAAAAAAAI/AAAAAAAAAFo/TXVy1OnHETE/photo.jpg?sz=128", "display_name": "Daniel Vega", "link": "https://stackoverflow.com/users/7100172/daniel-vega"}, "edited": false, "score": 0, "creation_date": 1538080771, "post_id": 37889195, "comment_id": 92029453, "body": "Hey, I got a brief question here. let&#39;s say I have a group of constants related, and one that is used totally apart. Let me do a quick example:   // headers const( Someheader=&quot;header1&quot; AnotherOne=&quot;header2&quot; ExtraOne=&quot;header3&quot; ) //important number not related const magicNumber=2   should that number go inside the const() with an individual comment or it&#39;s better to keep it separate?"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 345, "user_id": 7100172, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Ji_ffAXbA68/AAAAAAAAAAI/AAAAAAAAAFo/TXVy1OnHETE/photo.jpg?sz=128", "display_name": "Daniel Vega", "link": "https://stackoverflow.com/users/7100172/daniel-vega"}, "edited": false, "score": 2, "creation_date": 1538083019, "post_id": 37889195, "comment_id": 92030393, "body": "(IMHO) Personally I put related constants inside separate const statements. That way using <code>iota</code> is meaningful and comments can be managed more precisely."}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 14, "last_activity_date": 1466192335, "creation_date": 1466192335, "answer_id": 37889195, "question_id": 37887756, "link": "https://stackoverflow.com/questions/37887756/exported-const-should-have-a-comment/37889195#37889195", "title": "Exported const should have a comment", "body": "<p>Also you can provide a comment for a set of constants:</p>\n\n<pre><code>// Comment\nconst (\n    FATAL = iota\n    ERROR\n    DEBUG\n)\n</code></pre>\n"}], "owner": {"reputation": 808, "user_id": 2460610, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c3e8b037262cd812f7f97973a98d1f6f?s=128&d=identicon&r=PG", "display_name": "Luman75", "link": "https://stackoverflow.com/users/2460610/luman75"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12256, "favorite_count": 0, "accepted_answer_id": 37887798, "answer_count": 2, "score": 10, "last_activity_date": 1466192335, "creation_date": 1466186788, "question_id": 37887756, "link": "https://stackoverflow.com/questions/37887756/exported-const-should-have-a-comment", "title": "Exported const should have a comment", "body": "<p>I'm trying to export a constant from a go like this:</p>\n\n<pre><code>package log\n\nconst (\n    FATAL = iota // fatal errors\n    ERROR = iota // errors might happend\n    DEBUG = iota // debug mode\n) // const for logging levels\n</code></pre>\n\n<p>But I'm getting golint error : </p>\n\n<pre><code>exported const FATAL should have comment  (or a comment on this block) or be unexported (golint)\n</code></pre>\n\n<p>And it's right I'm getting later error in getting access to log.FATAL etc. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466179175, "post_id": 37885698, "comment_id": 63226258, "body": "That error isn&#39;t coming from your code, what is the server you&#39;re sending this to?"}, {"owner": {"reputation": 137, "user_id": 2132924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c87fb357586a72d52e6dfa8b5ec789e4?s=128&d=identicon&r=PG", "display_name": "noahtkeller", "link": "https://stackoverflow.com/users/2132924/noahtkeller"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466179440, "post_id": 37885698, "comment_id": 63226403, "body": "It&#39;s using AWS SES."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466186095, "post_id": 37885698, "comment_id": 63229904, "body": "This isn&#39;t a likely problem with Go. Can you make sure your headers are all formatted correctly in the email message?"}, {"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1466257978, "post_id": 37885698, "comment_id": 63248620, "body": "Wanted to say thank you for taking the time to support the <code>+</code> symbol as it is valid. too many email regex in other languages wrongly discriminate against the <code>+</code> symbol."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1466301613, "post_id": 37885698, "comment_id": 63259561, "body": "I can&#39;t reproduce this. I tried sending email via SMTP through SES with code pretty much identical to yours. (I used a different email address and defined the other variables as you&#39;d expect.) My guess is that in your real code, you have a semi-colon somewhere (maybe <code>to</code> or <code>from_email</code> or maybe even one of the headers in <code>buff</code>)? If you can make up a dummy email and reproduce with that, perhaps you can share the full details of what input you&#39;re using."}], "answers": [{"comments": [{"owner": {"reputation": 137, "user_id": 2132924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c87fb357586a72d52e6dfa8b5ec789e4?s=128&d=identicon&r=PG", "display_name": "noahtkeller", "link": "https://stackoverflow.com/users/2132924/noahtkeller"}, "edited": false, "score": 0, "creation_date": 1468336569, "post_id": 37903293, "comment_id": 64080184, "body": "Sorry it took me a while to respond, my attention was pulled away from this until now. This was the correct answer.  I was rendering the email template with the html/template package, instead of the text/template package. This was converting the + sign in the e-mail to \tunicode &amp;#043; which was resulting in the error. Using the text/template package has corrected this issue. Thanks!"}], "tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 1, "last_activity_date": 1466301733, "creation_date": 1466301733, "answer_id": 37903293, "question_id": 37885698, "link": "https://stackoverflow.com/questions/37885698/golang-net-smtp-sendmail-to-recipient-with-plus-signs/37903293#37903293", "title": "GoLang net/smtp sendMail to recipient with plus signs", "body": "<p>I was able to reproduce this error if and only if I had a semi-colon in the <code>To</code> header within the message body. E.g.:</p>\n\n<pre><code>msg := []byte(\"To: email1@example.com;email2@example.com\\r\\nSubject: foo\\r\\n\\r\\nbody\\r\\n\")\n</code></pre>\n\n<p>Double-check the <code>To</code> header you're sending and make sure it uses commas instead of semi-colons to separate multiple recipients.</p>\n"}], "owner": {"reputation": 137, "user_id": 2132924, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c87fb357586a72d52e6dfa8b5ec789e4?s=128&d=identicon&r=PG", "display_name": "noahtkeller", "link": "https://stackoverflow.com/users/2132924/noahtkeller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 659, "favorite_count": 0, "accepted_answer_id": 37903293, "answer_count": 1, "score": 1, "last_activity_date": 1466301733, "creation_date": 1466178704, "last_edit_date": 1466179518, "question_id": 37885698, "link": "https://stackoverflow.com/questions/37885698/golang-net-smtp-sendmail-to-recipient-with-plus-signs", "title": "GoLang net/smtp sendMail to recipient with plus signs", "body": "<p>I am writing a registration form using GoLang 1.5. I have it all working, but I've noticed if I attempt to sign up using an e-mail with a plus sign in it (someemail+theirlabel@theirdomain.com) I receive the following error:</p>\n\n<p>Transaction failed: Illegal semicolon, not in group</p>\n\n<p>Googling for this hasn't yielded much results, and it seems like Go should handle the plus sign just fine.</p>\n\n<pre><code>import (\n  \"net/smtp\"\n  \"net/mail\"\n)\n\nfunc sendEmail(t *Email) bool {\n    to := []string{\"johndoe+test@gmail.com\"}\n    err = smtp.SendMail(smtp_url, auth, from_email, to, buff.Bytes())\n    if err != nil {\n        log.Fatal(err)\n        // outputs: Transaction failed: Illegal semicolon, not in group\n    }\n}\n</code></pre>\n\n<p>I appreciate any advice I get on this.</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1786, "user_id": 4099287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OMz777BPLQI/AAAAAAAAAAI/AAAAAAAAFcM/tV8IW2TybOw/photo.jpg?sz=128", "display_name": "Kevin M Granger", "link": "https://stackoverflow.com/users/4099287/kevin-m-granger"}, "is_accepted": true, "score": 3, "last_activity_date": 1466179268, "creation_date": 1466179268, "answer_id": 37885852, "question_id": 37885590, "link": "https://stackoverflow.com/questions/37885590/unmarshalling-data-into-any-struct/37885852#37885852", "title": "Unmarshalling data into any struct", "body": "<p>If you do not know the composition of a JSON object in advance, <a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow\">you can unmarshal into a <code>map[string]interface{}</code>.</a></p>\n\n<pre><code>var myMap map[string]interface{}\njson.Unmarshal(data, &amp;myMap)\n</code></pre>\n\n<p>See an example <a href=\"https://play.golang.org/p/zSDbnYq_gv\" rel=\"nofollow\">here.</a></p>\n"}, {"tags": [], "owner": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "is_accepted": false, "score": 1, "last_activity_date": 1466179373, "creation_date": 1466179373, "answer_id": 37885884, "question_id": 37885590, "link": "https://stackoverflow.com/questions/37885590/unmarshalling-data-into-any-struct/37885884#37885884", "title": "Unmarshalling data into any struct", "body": "<p>If you don't know how to define your struct, then maybe you should <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow\">use a map.</a>  It's a pretty good fit for unmarshalling JSON.  Here is an example of how to do it without knowing exactly what data you are receiving:  </p>\n\n<pre><code>func parseJSON(r *http.Request) (map[string]interface{}, error) {\n    var postData interface{}\n    decoder := json.NewDecoder(r.Body)\n    err := decoder.Decode(&amp;postData)\n    if err != nil {\n        return nil, err\n    }\n\n    return postData.(map[string]interface{}), nil\n}\n</code></pre>\n\n<p>Now you at least have a string name of each piece of data, which should give your application some idea of how to handle it.</p>\n"}], "owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 37885852, "answer_count": 2, "score": 0, "last_activity_date": 1466179373, "creation_date": 1466178373, "question_id": 37885590, "link": "https://stackoverflow.com/questions/37885590/unmarshalling-data-into-any-struct", "title": "Unmarshalling data into any struct", "body": "<p>When Unmarshalling data from an endpoint, I almost always have a struct with the data that I am want to get from my request that I unmarshal into. Well there are times where I want to see everything that is returning back to me but I am not sure what some of that data is so I don't know how to define it in my struct. Is there a way to have a struct that can just grab all data being unmarshalled without me having to specify it?</p>\n\n<p>This is what I thought would work but that is not the case</p>\n\n<pre><code>resp, err := httpClient.Get(\"/api/stuff\")\ndata, _ := ioutil.ReadAll(resp.Body)\n\nvar myStruct struct{}\njson.Unmarshal(data, myStruct)\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 29, "last_activity_date": 1466175422, "last_edit_date": 1466175422, "creation_date": 1466174817, "answer_id": 37884510, "question_id": 37884361, "link": "https://stackoverflow.com/questions/37884361/concat-multiple-slices-in-golang/37884510#37884510", "title": "Concat multiple slices in golang", "body": "<p><code>append</code> operates on individual elements, not on entire slices. Append each slice in a loop</p>\n\n<pre><code>routes := []Routes{\n    WifiUserRoutes,\n    WifiUsageRoutes,\n    WifiLocationRoutes,\n    DashboardUserRoutes,\n    DashoardAppRoutes,\n    RadiusRoutes,\n    AuthenticationRoutes,\n}\n\nvar ApplicationRoutes []Route\nfor _, r := range routes {\n    ApplicationRoutes = append(ApplicationRoutes, r...)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 168, "user_id": 2875450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e13e4755263993222fd78038098f25c5?s=128&d=identicon&r=PG&f=1", "display_name": "jawang35", "link": "https://stackoverflow.com/users/2875450/jawang35"}, "edited": false, "score": 1, "creation_date": 1566502561, "post_id": 40678026, "comment_id": 101686985, "body": "<a href=\"https://blog.golang.org/slices\" rel=\"nofollow noreferrer\">blog.golang.org/slices</a> also seems to support this being the more efficient solution."}], "tags": [], "owner": {"reputation": 3466, "user_id": 1426673, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/a4lMw.jpg?s=128&g=1", "display_name": "Cameron Sparr", "link": "https://stackoverflow.com/users/1426673/cameron-sparr"}, "is_accepted": false, "score": 33, "last_activity_date": 1485956643, "last_edit_date": 1485956643, "creation_date": 1479474768, "answer_id": 40678026, "question_id": 37884361, "link": "https://stackoverflow.com/questions/37884361/concat-multiple-slices-in-golang/40678026#40678026", "title": "Concat multiple slices in golang", "body": "<p>This question has been answered already, but I wanted to post this here because the accepted answer is not the most efficient.</p>\n\n<p>The reason is that creating an empty slice and then appending can lead to many unnecessary allocations.</p>\n\n<p>The most efficient way would be to pre-allocate a slice and copy the elements into it. Below is a package which implements the concatenation both ways. If you benchmark you can see that pre-allocating is ~2x faster and allocates much less memory.</p>\n\n<p>Benchmark Results:</p>\n\n<pre><code>go test . -bench=. -benchmem\ntesting: warning: no tests to run\nBenchmarkConcatCopyPreAllocate-8    30000000            47.9 ns/op        64 B/op          1 allocs/op\nBenchmarkConcatAppend-8             20000000           107 ns/op         112 B/op          3 allocs/op\n</code></pre>\n\n<p>Package concat:</p>\n\n<pre><code>package concat\n\nfunc concatCopyPreAllocate(slices [][]byte) []byte {\n    var totalLen int\n    for _, s := range slices {\n        totalLen += len(s)\n    }\n    tmp := make([]byte, totalLen)\n    var i int\n    for _, s := range slices {\n        i += copy(tmp[i:], s)\n    }\n    return tmp\n}\n\nfunc concatAppend(slices [][]byte) []byte {\n    var tmp []byte\n    for _, s := range slices {\n        tmp = append(tmp, s...)\n    }\n    return tmp\n}\n</code></pre>\n\n<p>Benchmark tests:</p>\n\n<pre><code>package concat\n\nimport \"testing\"\n\nvar slices = [][]byte{\n    []byte(\"my first slice\"),\n    []byte(\"second slice\"),\n    []byte(\"third slice\"),\n    []byte(\"fourth slice\"),\n    []byte(\"fifth slice\"),\n}\n\nvar B []byte\n\nfunc BenchmarkConcatCopyPreAllocate(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        B = concatCopyPreAllocate(slices)\n    }\n}\n\nfunc BenchmarkConcatAppend(b *testing.B) {\n    for n := 0; n &lt; b.N; n++ {\n        B = concatAppend(slices)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 34185, "favorite_count": 1, "accepted_answer_id": 37884510, "answer_count": 2, "score": 27, "last_activity_date": 1485956643, "creation_date": 1466174396, "question_id": 37884361, "link": "https://stackoverflow.com/questions/37884361/concat-multiple-slices-in-golang", "title": "Concat multiple slices in golang", "body": "<p>I'm trying to merge multiple slices as follows,</p>\n\n<pre><code>package routes\n\nimport (\n    \"net/http\"\n)\n\ntype Route struct {\n    Name        string\n    Method      string\n    Pattern     string\n    Secured     bool\n    HandlerFunc http.HandlerFunc\n}\n\ntype Routes []Route\n\nvar ApplicationRoutes Routes\n\nfunc init() {\n    ApplicationRoutes = append(\n        WifiUserRoutes,\n        WifiUsageRoutes,\n        WifiLocationRoutes,\n        DashboardUserRoutes,\n        DashoardAppRoutes,\n        RadiusRoutes,\n        AuthenticationRoutes...\n    )\n}\n</code></pre>\n\n<p>However the builtin append() is capable of appending two slices, hence it throws <strong>too many arguments to append</strong> at compile time. Is there an alternative function to achieve the task? or is there a better way to merge the slices?</p>\n"}, {"tags": ["go", "syntax", "equality", "readability", "convention"], "comments": [{"owner": {"reputation": 1230, "user_id": 4488318, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6eb0e9296a94c70973340799a7a951d1?s=128&d=identicon&r=PG&f=1", "display_name": "Joseph Evans", "link": "https://stackoverflow.com/users/4488318/joseph-evans"}, "edited": false, "score": 0, "creation_date": 1466174046, "post_id": 37884152, "comment_id": 63223121, "body": "You could make a static class that accepts var args and returns a boolean."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 6, "creation_date": 1466174448, "post_id": 37884152, "comment_id": 63223402, "body": "Whats confusing about the last example? It&#39;s explicitly what&#39;s going on, and you still can elide the transitive comparison of <code>b == c</code>."}], "answers": [{"comments": [{"owner": {"reputation": 2304, "user_id": 2126889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZLkKF.jpg?s=128&g=1", "display_name": "timthelion", "link": "https://stackoverflow.com/users/2126889/timthelion"}, "edited": false, "score": 3, "creation_date": 1466205624, "post_id": 37889261, "comment_id": 63237741, "body": "Thanks for the answer. I&#39;ll be sticking with a == b &amp;&amp; b == c. However, your tricky map is pretty cleaver ;)"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 26, "last_activity_date": 1500479381, "last_edit_date": 1500479381, "creation_date": 1466192645, "answer_id": 37889261, "question_id": 37884152, "link": "https://stackoverflow.com/questions/37884152/how-do-i-check-the-equality-of-three-values-elegantly/37889261#37889261", "title": "How do I check the equality of three values elegantly?", "body": "<p><strong>A note beforehand:</strong></p>\n\n<p>Your last proposed solution <em>is</em> the shortest, clearest and most efficient way to compare if 3 values are equal:</p>\n\n<pre><code>if a == b &amp;&amp; a == c {\n    fmt.Println(\"Clearest: all 3 are equal\")\n}\n</code></pre>\n\n<p>or alternatively (to your liking):</p>\n\n<pre><code>if a == b &amp;&amp; b == c {\n    fmt.Println(\"Clearest: all 3 are equal\")\n}\n</code></pre>\n\n<p>The rest of this answer (what follows) is just toying with the language specification and the language's capabilities, presenting what I find fun and creative. They do not attempt to provide a superior solution.</p>\n\n<hr>\n\n<p>Try all the examples below on the <a href=\"https://play.golang.org/p/nzJFJ5Yfon\" rel=\"noreferrer\">Go Playground</a>. The examples build on the terms and the result of the comparisons which are defined in <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">Spec: Comparison operators</a>.</p>\n\n<p>General note: in the examples below I used the type <code>interface{}</code> which will work whatever type your values have (<code>a</code>, <code>b</code> and <code>c</code>), but if you know they are of type <code>int</code> for example, you can use that specific type too (which would improve efficiency and shorten the length of the examples).</p>\n\n<h3>With a <code>map</code> as a set</h3>\n\n<pre><code>if len(map[interface{}]int{a: 0, b: 0, c: 0}) == 1 {\n    fmt.Println(\"Map set: all 3 are equal\")\n}\n</code></pre>\n\n<p>Effectively we put all comparable values into a <code>map</code> as keys, and if all are equal, there will be only 1 pair in the map, so the \"length\" of the map will be 1. The value type of the map doesn't play any role here, it could be anything. I used <code>int</code> because this results in the shortest <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"noreferrer\">composite literal</a> (that defines the <code>map</code> value).</p>\n\n<p>This solution is flexible as you can use any number of values to test if all are equal, not just 3.</p>\n\n<h3>With arrays</h3>\n\n<p>Arrays are comparable (unlike slices):</p>\n\n<pre><code>if [2]interface{}{a, b} == [2]interface{}{b, c} {\n    fmt.Println(\"Arrays: all 3 are equal\")\n}\n</code></pre>\n\n<p>The result of the array comparison will be <code>true</code> if <code>a == b</code> and <code>b == c</code> (if the corresponding elements are equal).</p>\n\n<p>Note that you can apply this method on any number of values as well. It would look like this for 5 values:</p>\n\n<pre><code>if [4]interface{}{a, b, c, d} == [4]interface{}{b, c, d, e} {\n    fmt.Println(\"Arrays: all 5 are equal\")\n}\n</code></pre>\n\n<h3>With a tricky <code>map</code></h3>\n\n<pre><code>if map[interface{}]bool{a: b == c}[b] {\n    fmt.Println(\"Tricky map: all 3 are equal\")\n}\n</code></pre>\n\n<p>This composite literal will assign the comparision result of <code>b == c</code> to the key <code>a</code>. And we ask the value associated with the key <code>b</code>. If <code>a == b</code>, the result of the indexing expression will be the result of <code>b == c</code>, that is, whether all 3 values are equal. If <code>a != b</code>, then the zero value of the value type will be the result, which is <code>false</code> in case of <code>bool</code>, properly telling that all 3 values are not equal.</p>\n\n<h3>With anonymous <code>struct</code>s</h3>\n\n<p><code>struct</code> values are also comparable, so:</p>\n\n<pre><code>if struct{ a, b interface{} }{a, b} == struct{ a, b interface{} }{b, c} {\n    fmt.Println(\"Anon structs: all 3 are equal\")\n}\n</code></pre>\n\n<h3>With (named) <code>struct</code>s</h3>\n\n<p>If we define a simple <code>struct</code> beforehand:</p>\n\n<pre><code>type P struct{ a, b interface{} }\n</code></pre>\n\n<p>Comparison will be much more compact:</p>\n\n<pre><code>if (P{a, b} == P{b, c}) {\n    fmt.Println(\"Structs: all 3 are equal\")\n}\n</code></pre>\n\n<p>(Note that the expression of the <code>if</code> statement must be put in parenthesis to avoid <a href=\"https://stackoverflow.com/questions/35120724/struct-in-for-loop-initializer\">parsing ambiguity</a> - else it's a compile time error!)</p>\n\n<h3>With slices</h3>\n\n<p>Slices are not comparable, so we will need to borrow some help from <a href=\"https://golang.org/pkg/reflect/#DeepEqual\" rel=\"noreferrer\"><code>reflect.DeepEqual()</code></a>:</p>\n\n<pre><code>if reflect.DeepEqual([]interface{}{a, b}, []interface{}{b, c}) {\n    fmt.Println(\"Slices: all 3 are equal\")\n}\n</code></pre>\n\n<h3>With a helper function</h3>\n\n<pre><code>func AllEquals(v ...interface{}) bool {\n    if len(v) &gt; 1 {\n        a := v[0]\n        for _, s := range v {\n            if a != s {\n                return false\n            }\n        }\n    }\n    return true\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>if AllEquals(a, b, c) {\n    fmt.Println(\"Helper function: all 3 are equal\")\n}\n</code></pre>\n\n<p>This solution is also flexible, you can call <code>AllEquals()</code> with any number of values.</p>\n\n<p>Note that we can make the <code>AllEquals()</code> function more compact if we're also willing to call <code>reflect.DeepEqual()</code> here:</p>\n\n<pre><code>func AllEquals2(v ...interface{}) bool {\n    if len(v) &lt; 2 {\n        return true\n    }\n    return reflect.DeepEqual(v[:len(v)-1], v[1:])\n}\n</code></pre>\n"}], "owner": {"reputation": 2304, "user_id": 2126889, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/ZLkKF.jpg?s=128&g=1", "display_name": "timthelion", "link": "https://stackoverflow.com/users/2126889/timthelion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8610, "favorite_count": 2, "accepted_answer_id": 37889261, "answer_count": 1, "score": 9, "last_activity_date": 1517563554, "creation_date": 1466173762, "last_edit_date": 1517563554, "question_id": 37884152, "link": "https://stackoverflow.com/questions/37884152/how-do-i-check-the-equality-of-three-values-elegantly", "title": "How do I check the equality of three values elegantly?", "body": "<p>Say I have values <code>a</code>, <code>b</code> and <code>c</code>. I want to find out if they are equal. If I do</p>\n\n<pre><code>if a == b == c{...}\n</code></pre>\n\n<p>Then I get a compile error</p>\n\n<pre><code>invalid operation: a == b == c (mismatched types bool and TypeOfABandC)\n</code></pre>\n\n<p>This is pretty obvious, because this parses to:</p>\n\n<pre><code>(a == b) == c\n</code></pre>\n\n<p>And <code>(a == b)</code> is a bool.</p>\n\n<p>Of course I can do:</p>\n\n<pre><code>if a == b &amp;&amp; a == c {...}\n</code></pre>\n\n<p>However, this isn't very nice looking and feels confusing. Is there another way?</p>\n"}, {"tags": ["go", "docker"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1466171400, "post_id": 37883050, "comment_id": 63221303, "body": "You&#39;re adding everything to <code>&#47;home&#47;core&#47;app&#47;app-name</code>, but your WORKDIR is <code>&#47;app&#47;app-name</code>. You also don&#39;t set GOPATH, and don&#39;t specify an package to build. If you&#39;re building the app in the container, you still need to have a proper environment setup as described in <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466171488, "post_id": 37883050, "comment_id": 63221368, "body": "i think you put the files in <code>&#47;home&#47;core&#47;app&#47;app-name</code> instead of <code>&#47;app&#47;app-name</code>. try making the dirs consistent, maybe <code>RUN go build -o main &#47;app&#47;app-name</code> and <code>CMD [&quot;&#47;app&#47;app-name&#47;main&quot;]</code>"}, {"owner": {"reputation": 313, "user_id": 1090051, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/30f15f7f269cf0395a0b464876a51f91?s=128&d=identicon&r=PG", "display_name": "Christopher Stephenson", "link": "https://stackoverflow.com/users/1090051/christopher-stephenson"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466176754, "post_id": 37883050, "comment_id": 63224846, "body": "@Plato, I have tried that but I still got the same output."}], "answers": [{"comments": [{"owner": {"reputation": 313, "user_id": 1090051, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/30f15f7f269cf0395a0b464876a51f91?s=128&d=identicon&r=PG", "display_name": "Christopher Stephenson", "link": "https://stackoverflow.com/users/1090051/christopher-stephenson"}, "edited": false, "score": 0, "creation_date": 1466187063, "post_id": 37886064, "comment_id": 63230410, "body": "When I ran it I got: Sending build context to Docker daemon 100.9 kB Step 1 : FROM golang:latest  ---&gt; 5850add7ecc2 Step 2 : ADD ./app /go/src/app lstat app: no such file or directory"}, {"owner": {"reputation": 181, "user_id": 5758778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a176924c74b761180420c448469be131?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/5758778/abc"}, "reply_to_user": {"reputation": 313, "user_id": 1090051, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/30f15f7f269cf0395a0b464876a51f91?s=128&d=identicon&r=PG", "display_name": "Christopher Stephenson", "link": "https://stackoverflow.com/users/1090051/christopher-stephenson"}, "edited": false, "score": 0, "creation_date": 1466188783, "post_id": 37886064, "comment_id": 63231249, "body": "@ChristopherStephenson locally in the directory where the Dockerfile is located I have a folder named &quot;app&quot; containing a subfolder named &quot;app-name&quot; containing a single file &quot;main.go&quot; ..was trying to mimick your app structure based on the information provided. <a href=\"https://gist.github.com/anonymous/62bd07425ac0dc62304a28501dc4c456\" rel=\"nofollow noreferrer\">gist</a>"}, {"owner": {"reputation": 313, "user_id": 1090051, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/30f15f7f269cf0395a0b464876a51f91?s=128&d=identicon&r=PG", "display_name": "Christopher Stephenson", "link": "https://stackoverflow.com/users/1090051/christopher-stephenson"}, "edited": false, "score": 0, "creation_date": 1466277853, "post_id": 37886064, "comment_id": 63254621, "body": "@gist, I was able to get it working, and build the image, but I am still having problems running it. See my edit for the updated info"}], "tags": [], "owner": {"reputation": 181, "user_id": 5758778, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a176924c74b761180420c448469be131?s=128&d=identicon&r=PG&f=1", "display_name": "ABC", "link": "https://stackoverflow.com/users/5758778/abc"}, "is_accepted": false, "score": 0, "last_activity_date": 1466180018, "creation_date": 1466180018, "answer_id": 37886064, "question_id": 37883050, "link": "https://stackoverflow.com/questions/37883050/having-problems-deploying-an-go-app-to-docker/37886064#37886064", "title": "Having problems deploying an go app to docker", "body": "<p>This might work for you...</p>\n\n<ul>\n<li>The GOPATH for the image is set to /go </li>\n<li>install your source(s) under /go/src</li>\n<li>given the gopath is set and sources are within the GOPATH</li>\n<li>setting the working directory to /app</li>\n<li>execute the build and the output should be present in the working\ndirectory</li>\n</ul>\n\n<p><strong>Dockerfile</strong></p>\n\n<pre><code>FROM golang:latest\nADD ./app /go/src/app\nRUN mkdir /app\nWORKDIR /app\nRUN go build -o main app/app-name\nCMD [\"/app/main\"]\nEXPOSE 8080\n</code></pre>\n\n<hr>\n\n<p><strong>app/app-name/main.go</strong></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Printf(\"hello, world\\n\")\n}\n</code></pre>\n\n<hr>\n\n<pre><code>docker build -t app-image .\ndocker run app-image\n</code></pre>\n\n<hr>\n\n<p><strong>output</strong> </p>\n\n<pre><code>hello, world\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 470, "user_id": 10864272, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-oNmodANDehA/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwca4_4c_E5YED93aQWAA1l1k8S9JBQ/mo/photo.jpg?sz=128", "display_name": "Dev Yego", "link": "https://stackoverflow.com/users/10864272/dev-yego"}, "is_accepted": false, "score": 0, "last_activity_date": 1593493578, "creation_date": 1593493578, "answer_id": 62650623, "question_id": 37883050, "link": "https://stackoverflow.com/questions/37883050/having-problems-deploying-an-go-app-to-docker/62650623#62650623", "title": "Having problems deploying an go app to docker", "body": "<p>I had problems with this too but somehow based on this <a href=\"https://hub.docker.com/_/golang\" rel=\"nofollow noreferrer\">guide</a>, this worked for me.</p>\n<pre><code># ...AS builder ...\n\nFROM golang:1.14\nWORKDIR /go/src/app\n# In your case, ./main.go or just .\nCOPY ./server.go .\nCOPY --from=builder ./app/build .\n\nRUN go get -d -v ./...\nRUN go install -v ./...\n\nCMD [&quot;app&quot;]\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 1090051, "user_type": "registered", "accept_rate": 32, "profile_image": "https://www.gravatar.com/avatar/30f15f7f269cf0395a0b464876a51f91?s=128&d=identicon&r=PG", "display_name": "Christopher Stephenson", "link": "https://stackoverflow.com/users/1090051/christopher-stephenson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1601, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1593493578, "creation_date": 1466170612, "last_edit_date": 1466279115, "question_id": 37883050, "link": "https://stackoverflow.com/questions/37883050/having-problems-deploying-an-go-app-to-docker", "title": "Having problems deploying an go app to docker", "body": "<p>Hi I am pretty new to go, and this is my first time working with docker to package an app into a container. I am working on a linux VM where the app is located under dir: /home/core/app/app-name In the dir app-name there is the main.go program and the Dockerfile. The Dockerfile contains this:</p>\n\n<pre><code>FROM golang:latest\nRUN mkdir /app\nADD . /home/core/app/app-name\nWORKDIR /app/app-name\nRUN go build -o main .\nCMD [\"/app/main\"]\nEXPOSE 8080\n</code></pre>\n\n<p>I have tried running from dir /home/core/app/app-name: </p>\n\n<pre><code>docker build -t app-image .\n</code></pre>\n\n<p>But I got this error:</p>\n\n<p>can't load package: package .: no buildable Go source files in /app/stars-app\nThe command '/bin/sh -c go build -o main .' returned a non-zero code: 1</p>\n\n<p>What am I doing wrong?</p>\n\n<p><strong>Edit:</strong>\nI got was able to build the image on my windows machine with the Dockfile:</p>\n\n<pre><code>FROM golang:latest\nAdd . /app/app-name\nEXPOSE 8080\nCMD [\"/app/app-name/main\"]\n</code></pre>\n\n<p>And by running: </p>\n\n<pre><code>docker build -t star-image .\n</code></pre>\n\n<p>I can see the image when I run \"docker images\", but when I try to run it using:</p>\n\n<pre><code>docker run -p 3000:8080 --name goapp --rm app-name\n</code></pre>\n\n<p>I get this error:</p>\n\n<pre><code>docker: Error response from daemon: Container command '/app/app-name/main' not found or does not exist..\n</code></pre>\n"}, {"tags": ["ssl", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466170726, "post_id": 37878460, "comment_id": 63220894, "body": "How is your app binding to port 443? Have you set the proper capabilities, or are you running as root? Are you checking the error returned to know if your app is even successfully binding to the port, or are you communicating with another process? What does the verbose output of <code>curl</code> say about the connection?"}, {"owner": {"reputation": 1356, "user_id": 5688488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14b0072c03a45630ffe30f8a9e1a3f00?s=128&d=identicon&r=PG&f=1", "display_name": "Benjamin Kadish", "link": "https://stackoverflow.com/users/5688488/benjamin-kadish"}, "edited": false, "score": 0, "creation_date": 1466170765, "post_id": 37878460, "comment_id": 63220919, "body": "Shot in the dark, but did you try going to https://.. ?"}], "answers": [{"tags": [], "owner": {"reputation": 3766, "user_id": 967100, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/lJq6z.jpg?s=128&g=1", "display_name": "Bruno Vieira", "link": "https://stackoverflow.com/users/967100/bruno-vieira"}, "is_accepted": true, "score": 2, "last_activity_date": 1466173049, "last_edit_date": 1495535638, "creation_date": 1466173049, "answer_id": 37883904, "question_id": 37878460, "link": "https://stackoverflow.com/questions/37878460/go-listenandservetls-handshake/37883904#37883904", "title": "Go ListenAndServeTLS handshake", "body": "<p>I can think of two reasons why this is happening</p>\n\n<ul>\n<li>Your server application doesn't have access to port 443</li>\n<li>Your browser is trying to reach your server on port 80</li>\n</ul>\n\n<p>Since the first issue can't be solved by the marked tags, this answer will cover the second case.  </p>\n\n<p>This problem happens because by default, when you type an address like www.domain.com, your browser tries to contact the url domain using the http protocol on port 80 and it's a known behavior that <a href=\"https://stackoverflow.com/questions/23494082/golang-listenandservetls-returns-data-when-not-using-https-in-the-browser?rq=1\">Golang ListenAndServeTLS returns data when not using https in the browser</a></p>\n\n<p>Now, if you type in your browser the full URL with the proper scheme like <code>https://www.domain.com</code> the browser will approach the server by the port 443 and start the TLS handshake with your server, thus rendering the correct data.</p>\n\n<p>Now, you know this, but not your users. It would be really frustrating to your users to be notified by a SSL handshake error every time they try to access your web application using only your domain as URL. </p>\n\n<p>In order to avoid this problem you could start a go routine with a server on port :80 (or 8080) that redirects all requests to port 443 with this simple piece of code:</p>\n\n<pre><code>// redir is a net.Http handler which redirects incoming requests to the \n// proper scheme, in this case being https\nfunc redir(w http.ResponseWriter, req *http.Request) {\n    hostParts := strings.Split(req.Host, \":\")\n    http.Redirect(w, req, \"https://\"+hostParts[0]+req.RequestURI,  http.StatusMovedPermanently)\n}\n\n\nfunc main() {\n\n    // this go subroutine creates a server on :8080 and uses the redir handler\n    go func() {\n        err := http.ListenAndServe(\":8080\", http.HandlerFunc(redir))\n        if err != nil {\n            panic(\"Error: \" + err.Error())\n        }\n    }()\n\n    http.ListenAndServeTLS(\":\"+Config.String(\"port\"), Config.Key(\"https\").String(\"cert\"), Config.Key(\"https\").String(\"key\"), router)\n}\n</code></pre>\n\n<p>I hope it helped\nCheers,</p>\n"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1503, "favorite_count": 0, "accepted_answer_id": 37883904, "answer_count": 1, "score": 0, "last_activity_date": 1466173049, "creation_date": 1466157094, "question_id": 37878460, "link": "https://stackoverflow.com/questions/37878460/go-listenandservetls-handshake", "title": "Go ListenAndServeTLS handshake", "body": "<p>Currently. I have this following line (works pretty good)</p>\n\n<pre><code>http.ListenAndServeTLS(\":\"+Config.String(\"port\"), Config.Key(\"https\").String(\"cert\"), Config.Key(\"https\").String(\"key\"), router)\n</code></pre>\n\n<p>The problem comes when I try to set the port to 443 instead of for example 8080. I get on my browser the following error (Chrome)</p>\n\n<blockquote>\n  <p>This site can\u2019t provide a secure connection. </p>\n  \n  <p>www.example.com sent an</p>\n  \n  <p>invalid response. ERR_SSL_PROTOCOL_ERROR</p>\n</blockquote>\n\n<p>I am not sure what I am doing wrong or if I am not supposed to run the server on the port 443?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 671, "user_id": 1142154, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96b9d5e6f06a19bafbe3be141278c333?s=128&d=identicon&r=PG", "display_name": "Peter89", "link": "https://stackoverflow.com/users/1142154/peter89"}, "edited": false, "score": 0, "creation_date": 1466155137, "post_id": 37877378, "comment_id": 63210575, "body": "You rock! Thanks a ton!"}], "tags": [], "owner": {"reputation": 13954, "user_id": 3422652, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/sQ3DW.jpg?s=128&g=1", "display_name": "Chris Drew", "link": "https://stackoverflow.com/users/3422652/chris-drew"}, "is_accepted": true, "score": 5, "last_activity_date": 1466154185, "creation_date": 1466154185, "answer_id": 37877378, "question_id": 37877114, "link": "https://stackoverflow.com/questions/37877114/golang-combine-2-method-have-same-content/37877378#37877378", "title": "golang, combine 2 method have same content", "body": "<p>You could create an interface for structs with this method:</p>\n\n<pre><code>type ABCer interface {\n    abc() error\n}\n</code></pre>\n\n<p>Then your <code>TestGo</code> function can accept this interface:</p>\n\n<pre><code>func TestGo(t ABCer) error {\n    return t.abc()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/WqeSEdOIUI\">Live demo</a>.</p>\n"}], "owner": {"reputation": 671, "user_id": 1142154, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/96b9d5e6f06a19bafbe3be141278c333?s=128&d=identicon&r=PG", "display_name": "Peter89", "link": "https://stackoverflow.com/users/1142154/peter89"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 37877378, "answer_count": 1, "score": 3, "last_activity_date": 1466154185, "creation_date": 1466153487, "question_id": 37877114, "link": "https://stackoverflow.com/questions/37877114/golang-combine-2-method-have-same-content", "title": "golang, combine 2 method have same content", "body": "<p>I have 2 method of 2 struct A and B.\nThe content of 2 Method is the same.</p>\n\n<pre><code>func (t *A) TestGo() error {\n  ...\n  return t.abc(); // call method of struct\n}\n</code></pre>\n\n<p>Could I write a func able to input 2 type. Like this</p>\n\n<pre><code>fun TestGo(t .?.) error {\n  ...\n  return t.abc();\n}\n</code></pre>\n\n<p>It will easier to maintain in later. Thanks! </p>\n"}, {"tags": ["html", "go"], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 3, "last_activity_date": 1466151232, "creation_date": 1466151232, "answer_id": 37876428, "question_id": 37875834, "link": "https://stackoverflow.com/questions/37875834/golang-html-repeater/37876428#37876428", "title": "Golang HTML repeater", "body": "<p>I think you're just looking for <code>{{range}}</code>, right? E.g.</p>\n\n<pre><code>package main\n\nimport \"log\"\nimport \"os\"\nimport \"html/template\"\n\ntype Highscore struct {\n    Name  string\n    Score int\n}\n\nfunc main() {\n    const tpl = `&lt;ol&gt;\n{{range .}}\n    &lt;li&gt;{{.Name}} - {{.Score}}&lt;/li&gt;\n{{end}}\n&lt;/ol&gt;\n`\n    scores := []Highscore{\n        Highscore{\"Steve\", 50},\n        Highscore{\"Jim\", 40},\n    }\n\n    scoreTemplate, err := template.New(\"scores\").Parse(tpl)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    err = scoreTemplate.Execute(os.Stdout, scores)\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1525, "user_id": 181218, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6d51a82e095a90c92dee70dc85ea0340?s=128&d=identicon&r=PG", "display_name": "user181218", "link": "https://stackoverflow.com/users/181218/user181218"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 160, "favorite_count": 0, "accepted_answer_id": 37876428, "answer_count": 1, "score": -4, "last_activity_date": 1466151232, "creation_date": 1466149310, "last_edit_date": 1495542162, "question_id": 37875834, "link": "https://stackoverflow.com/questions/37875834/golang-html-repeater", "title": "Golang HTML repeater", "body": "<p>I am trying to create an HTML template that includes a table.\nEach row in the table should represent a struct I have and include values from that struct.</p>\n\n<p>The only relevant reference I found is this: <a href=\"https://stackoverflow.com/questions/19546896/golang-template-how-to-render-templates\">golang template - how to render templates?</a></p>\n\n<p>The difference is that I don't know in advance the number of rows in the table, so I need to be able to loop through a dyanmic list of structs I have, and for each such struct populate its values into a template representing a row and add that row to the parent template representing the table.</p>\n\n<p>Can anyone show me how this can be done? Any other approach is also welcome.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1466144929, "post_id": 37874186, "comment_id": 63204769, "body": "YOu only need to import a package if you want to use it. If you do not want to use it (either directly or through its init side effects): Don&#39;t import it. There are no &quot;subpackages&quot; in Go."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1466147663, "post_id": 37874186, "comment_id": 63206162, "body": "The easiest way to test your question would be to remove the import and see if the program compiles. If not you need it."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1466144600, "last_edit_date": 1466144600, "creation_date": 1466143686, "answer_id": 37874263, "question_id": 37874186, "link": "https://stackoverflow.com/questions/37874186/is-it-possible-a-golang-package-in-subdir-not-included-by-default/37874263#37874263", "title": "Is it possible a Golang package in subdir not included by default?", "body": "<p>Go packages are constructed from one or more source files, which are organized into folders in the file system. Source files of the same package must be in the same folder.</p>\n\n<p>But in Go there is no \"package hierarchy\", the \"subpackage\" term simply refers to the folder of a package being a <em>subfolder</em> of another. We often organize packages to be in folders being subfolders of others because there is some connection between those packages (e.g. a package is used only by another being in the parent folder; or a package in a subfolder is a specific or more special implementation of the package in the parent folder; or simply just a logical grouping - see the end of the answer).</p>\n\n<p>So whenever you do </p>\n\n<pre><code>import \"github.com/usera/pkgfoo\"\n</code></pre>\n\n<p>It only imports <code>pkgfoo</code> and no other packages sharing the same path as prefix. If you need <code>github.com/usera/pkgfoo/subpkg</code> too, you also need to explicitly import it:</p>\n\n<pre><code>import (\n    \"github.com/usera/pkgfoo\"\n    \"github.com/usera/pkgfoo/subpkg\"\n}\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://blog.golang.org/package-names\" rel=\"nofollow\">The Go Blog: Package names</a> on directories used in the standard library:</p>\n\n<blockquote>\n  <p><strong>Directories.</strong> The standard library uses like directories <code>crypto</code>, <code>container</code>, <code>encoding</code>, and <code>image</code> to group packages for related protocols and algorithms. There is no actual relationship among the packages in one of these directories; a directory just provides a way to arrange the files. Any package can import any other package provided the import does not create a cycle.</p>\n</blockquote>\n"}], "owner": {"reputation": 3768, "user_id": 152859, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/9ec5798d9b903a32983bfa98b82ab907?s=128&d=identicon&r=PG", "display_name": "chen", "link": "https://stackoverflow.com/users/152859/chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 834, "favorite_count": 0, "accepted_answer_id": 37874263, "answer_count": 1, "score": 0, "last_activity_date": 1466144600, "creation_date": 1466143273, "question_id": 37874186, "link": "https://stackoverflow.com/questions/37874186/is-it-possible-a-golang-package-in-subdir-not-included-by-default", "title": "Is it possible a Golang package in subdir not included by default?", "body": "<p>I am using a golang package, say name <code>pkgfoo</code>; and the author explicitly said if we want to use a package <code>subpkg</code> under <code>pkgfoo</code>, I need to explicitly import subpkg. I don't understand the reason behind it. Isn't the subpkg automatically imported if I import the top pkg in Golang?</p>\n\n<pre><code>package main\n\nimport (\n    \"myownpackage\"\n\n    \"github.com/usera/pkgfoo\"\n    \"github.com/usera/pkgfoo/subpkg\"\n)\n\nfunc main() {\n    // Use functions in pkgfoo, and use functions in pkgfoo/subpkg\n    // ......\n    http.HandleFunc(\"/login\", login)\n    err := http.ListenAndServe(\":9090\", nil) // setting listening port\n    if err != nil {\n        log.Fatal(\"ListenAndServe: \", err)\n    }\n}\n</code></pre>\n\n<p>My question is whether I really need <code>import \"github.com/usera/pkgfoo/subpkg\"</code> statement.</p>\n"}, {"tags": ["go", "http2"], "comments": [{"owner": {"reputation": 534, "user_id": 6112213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N48wo.jpg?s=128&g=1", "display_name": "HeadwindFly", "link": "https://stackoverflow.com/users/6112213/headwindfly"}, "edited": false, "score": 0, "creation_date": 1482311064, "post_id": 37872924, "comment_id": 69717885, "body": "Just for reminding: HTTP/2 server push was already supported by go1.8."}, {"owner": {"reputation": 9712, "user_id": 66907, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/f45da391d77044534895e4dd3770ffd2?s=128&d=identicon&r=PG", "display_name": "Sascha", "link": "https://stackoverflow.com/users/66907/sascha"}, "reply_to_user": {"reputation": 534, "user_id": 6112213, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/N48wo.jpg?s=128&g=1", "display_name": "HeadwindFly", "link": "https://stackoverflow.com/users/6112213/headwindfly"}, "edited": false, "score": 0, "creation_date": 1482393126, "post_id": 37872924, "comment_id": 69757857, "body": "@HeadwindFly Go 1.8 is due on 31.01.2017, so this is in beta ( though fairly stable ). See <a href=\"https://github.com/golang/go/milestone/38\" rel=\"nofollow noreferrer\">github.com/golang/go/milestone/38</a>"}, {"owner": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "edited": false, "score": 0, "creation_date": 1483029534, "post_id": 37872924, "comment_id": 69969475, "body": "shameless self promotion : <a href=\"https://github.com/romainmenke/pusher\" rel=\"nofollow noreferrer\">github.com/romainmenke/pusher</a>. It is a middleware handler to generate push promises"}, {"owner": {"reputation": 237, "user_id": 4756623, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/RHAFC.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4756623/alex"}, "reply_to_user": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "edited": false, "score": 0, "creation_date": 1483164818, "post_id": 37872924, "comment_id": 70014906, "body": "@RMenke thanks for you promote, is golang 1.8 public yet?"}, {"owner": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "edited": false, "score": 0, "creation_date": 1483187828, "post_id": 37872924, "comment_id": 70019566, "body": "It will be released 31/01. So not long until then. You can go through the pkg and run the example with the beta release of go. (as with all beta&#39;s you should be careful not to mess up your dev environment) The idea is pretty simply. When a certain resource is requested you also <code>push</code> the urls of dependencies. These urls will then be handled by your server. A bit like a redirect."}], "answers": [{"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1466136567, "creation_date": 1466136567, "answer_id": 37872984, "question_id": 37872924, "link": "https://stackoverflow.com/questions/37872924/high-level-client-for-golang-http2-server-push/37872984#37872984", "title": "High level client for golang http2 server push", "body": "<p>The http2 implementation in the std library doesn't expose http2-specific interfaces, however you can use <a href=\"https://github.com/golang/net/tree/master/http2\" rel=\"nofollow\">golang.org/x/net/http2</a> directly.</p>\n\n<p><a href=\"https://godoc.org/golang.org/x/net/http2#Framer.WritePushPromise\" rel=\"nofollow\">https://godoc.org/golang.org/x/net/http2#Framer.WritePushPromise</a></p>\n"}], "owner": {"reputation": 237, "user_id": 4756623, "user_type": "registered", "accept_rate": 17, "profile_image": "https://i.stack.imgur.com/RHAFC.jpg?s=128&g=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/4756623/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2172, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1466137557, "creation_date": 1466136082, "last_edit_date": 1466137557, "question_id": 37872924, "link": "https://stackoverflow.com/questions/37872924/high-level-client-for-golang-http2-server-push", "title": "High level client for golang http2 server push", "body": "<p>golang 1.6 was released with Http2 support. I googled online but couldn't find any examples of how to do Http2 server push using Go. Is there any high level client implemented for that? Is there any examples that people have already done? </p>\n"}, {"tags": ["opengl", "go", "opengl-4"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4647979, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-bzRsVL8RBVA/AAAAAAAAAAI/AAAAAAAAAA4/0lWz8nj_QdQ/photo.jpg?sz=128", "display_name": "Alandroid", "link": "https://stackoverflow.com/users/4647979/alandroid"}, "is_accepted": false, "score": 0, "last_activity_date": 1475026101, "creation_date": 1475026101, "answer_id": 39736635, "question_id": 37872562, "link": "https://stackoverflow.com/questions/37872562/go-go-gl-opengl-rendering-issues/39736635#39736635", "title": "Go go-gl OpenGL Rendering Issues", "body": "<p>Your code gives me:</p>\n\n<pre><code>./gl.go:76: undefined: gl.Strs\n./gl.go:81: undefined: gl.Strs\n</code></pre>\n\n<p>Consider using my code for loading and compiling your shaders:</p>\n\n<pre><code>func NewProgram(vertexShaderSource, fragmentShaderSource string) (uint32, error) {\n    vertexShader, err := CompileShader(vertexShaderSource, gl.VERTEX_SHADER)\n    if err != nil {\n        return 0, err\n    }\n\n    fragmentShader, err := CompileShader(fragmentShaderSource, gl.FRAGMENT_SHADER)\n    if err != nil {\n        return 0, err\n    }\n\n    program := gl.CreateProgram()\n\n    gl.AttachShader(program, vertexShader)\n    gl.AttachShader(program, fragmentShader)\n    gl.LinkProgram(program)\n\n    var status int32\n    gl.GetProgramiv(program, gl.LINK_STATUS, &amp;status)\n    if status == gl.FALSE {\n        var logLength int32\n        gl.GetProgramiv(program, gl.INFO_LOG_LENGTH, &amp;logLength)\n\n        log := strings.Repeat(\"\\x00\", int(logLength+1))\n        gl.GetProgramInfoLog(program, logLength, nil, gl.Str(log))\n\n        return 0, errors.New(fmt.Sprintf(\"failed to link program: %v\", log))\n    }\n\n    gl.DeleteShader(vertexShader)\n    gl.DeleteShader(fragmentShader)\n\n    return program, nil\n}\n\nfunc CompileShader(source string, shaderType uint32) (uint32, error) {\n    shader := gl.CreateShader(shaderType)\n\n    csource := gl.Str(source)\n    gl.ShaderSource(shader, 1, &amp;csource, nil)\n    gl.CompileShader(shader)\n\n    var status int32\n    gl.GetShaderiv(shader, gl.COMPILE_STATUS, &amp;status)\n    if status == gl.FALSE {\n        var logLength int32\n        gl.GetShaderiv(shader, gl.INFO_LOG_LENGTH, &amp;logLength)\n\n        log := strings.Repeat(\"\\x00\", int(logLength+1))\n        gl.GetShaderInfoLog(shader, logLength, nil, gl.Str(log))\n\n        return 0, fmt.Errorf(\"failed to compile %v: %v\", source, log)\n    }\n\n    return shader, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 5443055, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KMA4r6LhPmQ/AAAAAAAAAAI/AAAAAAAAAB4/V3W9Pb_GF-k/photo.jpg?sz=128", "display_name": "rucuriousyet", "link": "https://stackoverflow.com/users/5443055/rucuriousyet"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 270, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1475026101, "creation_date": 1466133608, "question_id": 37872562, "link": "https://stackoverflow.com/questions/37872562/go-go-gl-opengl-rendering-issues", "title": "Go go-gl OpenGL Rendering Issues", "body": "<p>I have a program that was originally working completely fine that would draw a triangle using the go-gl OpenGL wrapper for Go. In the process of playing with the code things started to get weird. Sometimes the shape would be rendered, and then it just wouldn't. Sometimes saving the file then running the code again would work, sometimes that also failed. In this process there were no changes to made to the file from working to broken. The glfw window still shows up with a background color and the vertices array I use is populated. I am not sure whether this is a simple error in my code or if its something hardware related.</p>\n\n<p>Not sure if this helps, but I am using the latest Atom editor with the Go-Plus plugin. Thanks in advance for the help!</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"runtime\"\n\n    \"github.com/go-gl/gl/v4.1-core/gl\"\n    \"github.com/go-gl/glfw/v3.1/glfw\"\n)\n\nconst vertexSource = `\n#version 330\nin vec2 position;\nvoid main() {\n    gl_Position = vec4(position,0.0, 1.0);\n}\n` + \"\\x00\"\n\nconst fragmentSource = `\n#version 330\nuniform vec3 triangleColor;\nout vec4 outputColor;\nvoid main() {\n    outputColor = vec4(triangleColor,1.0);\n}\n` + \"\\x00\"\n\nvar vao, vbo uint32\nvar vertices = []float32{\n    0.0, 0.5,\n    0.5, -0.5,\n    -0.5, -0.5,\n}\n\nfunc init() {\n    runtime.LockOSThread()\n}\n\nfunc main() {\n    if err := glfw.Init(); err != nil {\n        log.Fatalln(\"failed to initalize GL window:\", err)\n    }\n    defer glfw.Terminate()\n\n    glfw.WindowHint(glfw.Resizable, glfw.True)\n    glfw.WindowHint(glfw.ContextVersionMajor, 4)\n    glfw.WindowHint(glfw.ContextVersionMinor, 1)\n    glfw.WindowHint(glfw.OpenGLProfile, glfw.OpenGLCoreProfile)\n    glfw.WindowHint(glfw.OpenGLForwardCompatible, glfw.True)\n\n    windowHeight := 800\n    windowWidth := 800\n\n    window, err := glfw.CreateWindow(windowWidth, windowHeight, \"HelloGL2.0\", nil, nil)\n    if err != nil {\n        panic(err)\n    }\n    window.MakeContextCurrent()\n\n    if err := gl.Init(); err != nil {\n        panic(err)\n    } else {\n        fmt.Println(\"OpenGL Version:\", gl.GoStr(gl.GetString(gl.VERSION)))\n    }\n\n    gl.GenVertexArrays(1, &amp;vao)\n    gl.BindVertexArray(vao)\n\n    gl.GenBuffers(1, &amp;vbo)\n\n    gl.BindBuffer(gl.ARRAY_BUFFER, vbo)\n    gl.BufferData(gl.ARRAY_BUFFER, len(vertices), gl.Ptr(vertices), gl.STREAM_DRAW)\n\n    vertexShader := gl.CreateShader(gl.VERTEX_SHADER)\n    vcsources, free := gl.Strs(vertexSource)\n    gl.ShaderSource(vertexShader, 1, vcsources, nil)\n    free()\n    gl.CompileShader(vertexShader)\n    fragmentShader := gl.CreateShader(gl.FRAGMENT_SHADER)\n    fcsources, free := gl.Strs(fragmentSource)\n    gl.ShaderSource(fragmentShader, 1, fcsources, nil)\n    gl.CompileShader(fragmentShader)\n\n    shaderProgram := gl.CreateProgram()\n    gl.AttachShader(shaderProgram, vertexShader)\n    gl.AttachShader(shaderProgram, fragmentShader)\n    gl.BindFragDataLocation(shaderProgram, 0, gl.Str(\"outputColor\\x00\"))\n    gl.LinkProgram(shaderProgram)\n    gl.UseProgram(shaderProgram)\n\n    posAttrib := uint32(gl.GetAttribLocation(shaderProgram, gl.Str(\"position\\x00\")))\n    gl.EnableVertexAttribArray(posAttrib)\n    gl.VertexAttribPointer(posAttrib, 2.0, gl.FLOAT, false, 0.0, gl.PtrOffset(0))\n\n    gl.GetUniformLocation(shaderProgram, gl.Str(\"triangleColor\\x00\"))\n\n    //GL_STATIC_DRAW: The vertex data will be uploaded once and drawn many times (e.g. the world).\n    //GL_DYNAMIC_DRAW: The vertex data will be changed from time to time, but drawn many times more than that.\n    //GL_STREAM_DRAW: The vertex data will change almost every time it's drawn (e.g. user interface).\n\n    for !window.ShouldClose() {\n        //gl.Uniform3f(uniColor, 2.0, 0.0, 1.0)\n\n        gl.ClearColor(0.9, 1.0, 0.3, 1.0)\n        gl.Clear(gl.COLOR_BUFFER_BIT)\n\n        gl.DrawArrays(gl.TRIANGLES, 0, 3)\n\n        window.SwapBuffers()\n        glfw.PollEvents()\n    }\n\n    gl.DeleteProgram(shaderProgram)\n    gl.DeleteShader(fragmentShader)\n    gl.DeleteShader(vertexShader)\n    gl.DeleteBuffers(1, &amp;vbo)\n    gl.DeleteVertexArrays(1, &amp;vao)\n\n    fmt.Println(\"Exiting!\")\n\n    window.Destroy()\n\n}\n</code></pre>\n"}, {"tags": ["java", "android", "cordova", "go", "gomobile"], "answers": [{"tags": [], "owner": {"reputation": 251717, "user_id": 895245, "user_type": "registered", "accept_rate": 49, "profile_image": "https://i.stack.imgur.com/jhDFt.png?s=128&g=1", "display_name": "Ciro Santilli\u65b0\u7586\u68c9\u82b1TRUMP BAN BAD", "link": "https://stackoverflow.com/users/895245/ciro-santilli%e6%96%b0%e7%96%86%e6%a3%89%e8%8a%b1trump-ban-bad"}, "is_accepted": false, "score": 0, "last_activity_date": 1555311540, "creation_date": 1555311540, "answer_id": 55683937, "question_id": 37871582, "link": "https://stackoverflow.com/questions/37871582/unsupported-flags-dt-flags-1-0x9-error-on-android-gomobile/55683937#55683937", "title": "&quot;Unsupported flags DT_FLAGS_1=0x9&quot; error on android gomobile", "body": "<p>This is not an actual full answer, but as a hint, DT_FLAGS_1 is a Binutils custom dynamic section entry (see the <a href=\"http://www.sco.com/developers/devspecs/gabi41.pdf\" rel=\"nofollow noreferrer\">ELF standard</a>).</p>\n\n<p>These are produce by Binutils ld during link.</p>\n\n<p>The 0x8 bit in particular is defined as:</p>\n\n<pre><code>#define DF_1_NODELETE 0x00000008\n</code></pre>\n\n<p>inside include/elf/common.h in Binutils 2.29.1.</p>\n\n<p>I would then try to determine from Binutils source / docs what <code>DF_1_NODELETE</code> does to understand what is happening.</p>\n\n<p>That flag is also mentioned at: <a href=\"https://stackoverflow.com/questions/31826309/glibc-test-if-lib-as-df-1-nodelete-flag-or-if-lib-has-unique-symbol\">glibc : Test if lib as DF_1_NODELETE flag or if lib has unique symbol</a></p>\n"}], "owner": {"reputation": 95, "user_id": 1094578, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a240cc6d32408ef14f407db9c69be46d?s=128&d=identicon&r=PG", "display_name": "Roger Large", "link": "https://stackoverflow.com/users/1094578/roger-large"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1386, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1555311540, "creation_date": 1466125526, "last_edit_date": 1466140655, "question_id": 37871582, "link": "https://stackoverflow.com/questions/37871582/unsupported-flags-dt-flags-1-0x9-error-on-android-gomobile", "title": "&quot;Unsupported flags DT_FLAGS_1=0x9&quot; error on android gomobile", "body": "<p>What I got going on in the project is a Cordova project that uses gradle to build. I created an android plugin that calls the Go script in the form of an <code>.aar</code>. All works with the simple <code>hello world.go</code> <code>.aar</code>. So I know that everything works. But adding in the <code>selphyprint.aar</code> it crashes with <code>\"Unsupported flags DT_FLAGS_1=0x9\"</code>  error in adb logcat.</p>\n\n<p>It's up at <a href=\"https://github.com/pbdesign/selphy\" rel=\"nofollow\">https://github.com/pbdesign/selphy</a>. The full project is at <a href=\"https://github.com/pbdesign/printproject\" rel=\"nofollow\">https://github.com/pbdesign/printproject</a> with an installable apk in the android folder of the <code>com.photobooth</code> project directory.</p>\n\n<p>If you have any ideas, I found some similar error messages that are connected to android linker but don't know if they are related. Also any ideas on how to debug such an error would be appreciated.</p>\n"}, {"tags": ["ssl", "go"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466118140, "post_id": 37870601, "comment_id": 63198112, "body": "share the code you load and parse with"}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 3, "creation_date": 1466118719, "post_id": 37870601, "comment_id": 63198281, "body": "I believe the issue is that your private key is encrypted with a password. I think you&#39;ll need to use an unencrypted PEM."}, {"owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "edited": false, "score": 2, "creation_date": 1466119334, "post_id": 37870601, "comment_id": 63198454, "body": "^This fixed the error. But now my browser wont recognize the cert at all? ERR_SSL_PROTOCOL_ERROR maybe this belongs to a different question tho."}, {"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 1, "creation_date": 1466119408, "post_id": 37870601, "comment_id": 63198489, "body": "Yeah, I&#39;d say open a new question for that."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1466141424, "post_id": 37870601, "comment_id": 63203488, "body": "@AlvaroCarvajalNakosmai SSL_PROTOCOL_ERROR typically means there&#39;s an issue with the handshake, or your certificate has an error. Can you share the certificate? (it&#39;s OK to share the cert; just not the key)"}], "owner": {"reputation": 2694, "user_id": 2452442, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/4a9391ca25cfccbc8ec92536da744257?s=128&d=identicon&r=PG", "display_name": "Raggaer", "link": "https://stackoverflow.com/users/2452442/raggaer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 792, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1466118301, "creation_date": 1466117328, "last_edit_date": 1466118301, "question_id": 37870601, "link": "https://stackoverflow.com/questions/37870601/go-listenandservetls", "title": "Go ListenAndServeTLS", "body": "<p>Im currently trying to use this function for my http server. I already have the cert.pem and the private.key but I am getting this error</p>\n\n<blockquote>\n  <p>crypto/tls: failed to parse private key</p>\n</blockquote>\n\n<p>No idea what is wrong. This is the correct key because any other key will just throw </p>\n\n<blockquote>\n  <p>private key does not match public key</p>\n</blockquote>\n\n<p>They are both on the same folder</p>\n\n<p>Since I am not sure how risky is to expose the key. It starts with this</p>\n\n<pre><code>-----BEGIN RSA PRIVATE KEY-----\nProc-Type: 4,ENCRYPTED\nDEK-Info: DES-EDE3-CBC,D353D2D8ACDA5320\n....\n---END RSA PRIVATE KEY-----\n</code></pre>\n\n<p>The code I am using</p>\n\n<pre><code>err := http.ListenAndServeTLS(\":80\", \"mycert.pem\", \"private.key\", router)\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}, {"tags": ["go", "zip"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 4, "creation_date": 1466113986, "post_id": 37869793, "comment_id": 63196711, "body": "The example for writer goes to show most of what is required; <a href=\"https://golang.org/pkg/archive/zip/#example_Writer\" rel=\"nofollow noreferrer\">golang.org/pkg/archive/zip/#example_Writer</a> beyond that you just need to recurse from the top level directory adding everything to the writer."}], "answers": [{"tags": [], "owner": {"reputation": 370, "user_id": 1856759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oyhcq.jpg?s=128&g=1", "display_name": "LeTigre", "link": "https://stackoverflow.com/users/1856759/letigre"}, "is_accepted": false, "score": 14, "last_activity_date": 1565896307, "last_edit_date": 1565896307, "creation_date": 1520851670, "answer_id": 49233329, "question_id": 37869793, "link": "https://stackoverflow.com/questions/37869793/how-do-i-zip-a-directory-containing-sub-directories-or-files-in-golang/49233329#49233329", "title": "How do I zip a directory containing sub directories or files in Golang?", "body": "<p>To do it manually, you could modify the code linked above:</p>\n\n<p><a href=\"https://golang.org/pkg/archive/zip/#example_Writer\" rel=\"noreferrer\">ExampleZipWriter</a></p>\n\n<p>To give you a simple example, that has many flaws, but might be easily understood:</p>\n\n<pre><code>func ZipWriter() {\n    baseFolder := \"/Users/tom/Desktop/testing/\"\n\n    // Get a Buffer to Write To\n    outFile, err := os.Create(`/Users/tom/Desktop/zip.zip`)\n    if err != nil {\n        fmt.Println(err)\n    }\n    defer outFile.Close()\n\n    // Create a new zip archive.\n    w := zip.NewWriter(outFile)\n\n    // Add some files to the archive.\n    addFiles(w, baseFolder, \"\")\n\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    // Make sure to check the error on Close.\n    err = w.Close()\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n</code></pre>\n\n<p>We use this to iterate on files recursively to generate folders too:</p>\n\n<pre><code>func addFiles(w *zip.Writer, basePath, baseInZip string) {\n    // Open the Directory\n    files, err := ioutil.ReadDir(basePath)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    for _, file := range files {\n        fmt.Println(basePath + file.Name())\n        if !file.IsDir() {\n            dat, err := ioutil.ReadFile(basePath + file.Name())\n            if err != nil {\n                fmt.Println(err)\n            }\n\n            // Add some files to the archive.\n            f, err := w.Create(baseInZip + file.Name())\n            if err != nil {\n                fmt.Println(err)\n            }\n            _, err = f.Write(dat)\n            if err != nil {\n                fmt.Println(err)\n            }\n        } else if file.IsDir() {\n\n            // Recurse\n            newBase := basePath + file.Name() + \"/\"\n            fmt.Println(\"Recursing and Adding SubDir: \" + file.Name())\n            fmt.Println(\"Recursing and Adding SubDir: \" + newBase)\n\n            addFiles(w, newBase, baseInZip  + file.Name() + \"/\")\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 37, "user_id": 9116208, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-2z8lF-uaEUg/AAAAAAAAAAI/AAAAAAAAAAc/N-OKJ_t7N7Y/photo.jpg?sz=128", "display_name": "Kratos.vn", "link": "https://stackoverflow.com/users/9116208/kratos-vn"}, "is_accepted": false, "score": -2, "last_activity_date": 1557655776, "creation_date": 1557655776, "answer_id": 56098166, "question_id": 37869793, "link": "https://stackoverflow.com/questions/37869793/how-do-i-zip-a-directory-containing-sub-directories-or-files-in-golang/56098166#56098166", "title": "How do I zip a directory containing sub directories or files in Golang?", "body": "<p>an ez way to zip directory, you can run command of server:</p>\n\n<pre><code>out, err := exec.Command(\"zip\", \"-r\", \"-D\", \"ideaz.zip\", \".idea/*\").Output()\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Mn-HmUjm5q2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Mn-HmUjm5q2</a></p>\n"}, {"comments": [{"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 1, "creation_date": 1596476598, "post_id": 63233911, "comment_id": 111817332, "body": "no need to readall then write. just do io.Copy(dst, src) so currently io.Copy(f, file) Also you are closing w twice, it is not a bug perse but zip.Close does not close the underlying resource AND the destination file opened at the beginning of the program is not being closed. So currently something might go wrong. Also the program is incomplete (no package spec, no import spec etc)"}, {"owner": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1596476741, "post_id": 63233911, "comment_id": 111817392, "body": "could be the perfect answer if this was fixed."}, {"owner": {"reputation": 8718, "user_id": 511200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c42635853936e509f76ece9d8187c4aa?s=128&d=identicon&r=PG", "display_name": "danneu", "link": "https://stackoverflow.com/users/511200/danneu"}, "reply_to_user": {"reputation": 5151, "user_id": 4466350, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd5606b873067472e30c5ef5bc2ac5bf?s=128&d=identicon&r=PG&f=1", "display_name": "mh-cbon", "link": "https://stackoverflow.com/users/4466350/mh-cbon"}, "edited": false, "score": 0, "creation_date": 1607611125, "post_id": 63233911, "comment_id": 115331720, "body": "(For the record, my answer does include all of @mh-cbon&#39;s suggestions, iirc. Thanks.)"}], "tags": [], "owner": {"reputation": 8718, "user_id": 511200, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c42635853936e509f76ece9d8187c4aa?s=128&d=identicon&r=PG", "display_name": "danneu", "link": "https://stackoverflow.com/users/511200/danneu"}, "is_accepted": false, "score": 6, "last_activity_date": 1597291299, "last_edit_date": 1597291299, "creation_date": 1596474473, "answer_id": 63233911, "question_id": 37869793, "link": "https://stackoverflow.com/questions/37869793/how-do-i-zip-a-directory-containing-sub-directories-or-files-in-golang/63233911#63233911", "title": "How do I zip a directory containing sub directories or files in Golang?", "body": "<p>Here's solution that uses Go's built-in recursive file-walker since the top answer so far has implemented their own file-walker:</p>\n<hr />\n<p>Aside, some findings I've found while generating zip files today that might save someone else a headache:</p>\n<ul>\n<li>The argument to <code>w.Create(zippath)</code> should not start with a &quot;/&quot;, and should be relative to the zip root (aka the folder that would be created if you unzipped the archive). So a top-level &quot;manifest.xml&quot; file should be <code>w.Create(&quot;manifest.xml&quot;)</code>. Nested files should be <code>w.Create(&quot;a/b/c.css)</code>. If you are generating bad/surprising archives, check first to ensure you aren't breaking this rule. My code does not try to enforce this.</li>\n<li>Some specs (like epub) want files in a certain order, but Go's <code>filepath.Walk</code> will crawl in lexical order. (For that matter, I've found all epub parsers to be lenient here so far from Calibre to Books.app on macOS). If you need a specific order, then @LeTigre's solution with <code>ReadDir</code> will let you sort the files at each level of descent.</li>\n</ul>\n<hr />\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    &quot;archive/zip&quot;\n    &quot;fmt&quot;\n    &quot;io&quot;\n    &quot;os&quot;\n    &quot;path/filepath&quot;\n)\n\n// Zips &quot;./input&quot; into &quot;./output.zip&quot;\nfunc main() {\n    file, err := os.Create(&quot;output.zip&quot;)\n    if err != nil {\n        panic(err)\n    }\n    defer file.Close()\n\n    w := zip.NewWriter(file)\n    defer w.Close()\n\n    walker := func(path string, info os.FileInfo, err error) error {\n        fmt.Printf(&quot;Crawling: %#v\\n&quot;, path)\n        if err != nil {\n            return err\n        }\n        if info.IsDir() {\n            return nil\n        }\n        file, err := os.Open(path)\n        if err != nil {\n            return err\n        }\n        defer file.Close()\n\n        // Ensure that `path` is not absolute; it should not start with &quot;/&quot;.\n        // This snippet happens to work because I don't use \n        // absolute paths, but ensure your real-world code \n        // transforms path into a zip-root relative path.\n        f, err := w.Create(path)\n        if err != nil {\n            return err\n        }\n\n        _, err = io.Copy(f, file)\n        if err != nil {\n            return err\n        }\n\n        return nil\n    }\n    err = filepath.Walk(&quot;input&quot;, walker)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 911, "user_id": 4728636, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yQ2Rl.jpg?s=128&g=1", "display_name": "anonrose", "link": "https://stackoverflow.com/users/4728636/anonrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14579, "favorite_count": 4, "answer_count": 3, "score": 8, "last_activity_date": 1600354027, "creation_date": 1466113232, "question_id": 37869793, "link": "https://stackoverflow.com/questions/37869793/how-do-i-zip-a-directory-containing-sub-directories-or-files-in-golang", "title": "How do I zip a directory containing sub directories or files in Golang?", "body": "<p>I know it will have to do with the <a href=\"https://golang.org/pkg/archive/zip/\" rel=\"noreferrer\">zip package</a> I just have no idea how I would implement such a thing. </p>\n"}, {"tags": ["xml", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1466113655, "post_id": 37869600, "comment_id": 63196586, "body": "I believe you want <code>const shortForm = &quot;2006-01-02 15:04:05&quot;</code>."}, {"owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "reply_to_user": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "edited": false, "score": 0, "creation_date": 1466114045, "post_id": 37869600, "comment_id": 63196732, "body": "@smarx - Perfect Thanks. I don&#39;t understand why your <code>shortForm</code> works and mine doesn&#39;t. If you write answer with some explanation - I will mark as correct."}], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 1, "last_activity_date": 1466114439, "creation_date": 1466114439, "answer_id": 37870059, "question_id": 37869600, "link": "https://stackoverflow.com/questions/37869600/golang-unmarshall-mysql-format-time-to-time-time/37870059#37870059", "title": "Golang unmarshall mysql format time to time.Time", "body": "<p>You want <code>const shortForm = \"2006-01-02 15:04:05\"</code>. This is a little weird, but the way <code>time.Parse</code> understands formats is that you have to give <em>this specific time</em> as an example. See the comment at <a href=\"https://golang.org/src/time/format.go\" rel=\"nofollow\">https://golang.org/src/time/format.go</a>:</p>\n\n<blockquote>\n<pre><code>// These are predefined layouts for use in Time.Format and Time.Parse.\n// The reference time used in the layouts is the specific time:\n//    Mon Jan 2 15:04:05 MST 2006\n// which is Unix time 1136239445. Since MST is GMT-0700,\n// the reference time can be thought of as\n//    01/02 03:04:05PM '06 -0700\n// To define your own format, write down what the reference time would look\n// like formatted your way; see the values of constants like ANSIC,\n// StampMicro or Kitchen for examples.\n</code></pre>\n</blockquote>\n\n<p>You can probably imagine why it's important to use a predefined date here... e.g. the library needs to know whether you meant 01/02 as in January 2nd or February 1st. Having a predefined date (cleverly constructed to avoid repeated values) disambiguates.</p>\n"}], "owner": {"reputation": 11294, "user_id": 1239122, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/8cf239e31df87733c835e53851283548?s=128&d=identicon&r=PG", "display_name": "Gravy", "link": "https://stackoverflow.com/users/1239122/gravy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 584, "favorite_count": 0, "accepted_answer_id": 37870059, "answer_count": 1, "score": 0, "last_activity_date": 1466114439, "creation_date": 1466112396, "last_edit_date": 1466113342, "question_id": 37869600, "link": "https://stackoverflow.com/questions/37869600/golang-unmarshall-mysql-format-time-to-time-time", "title": "Golang unmarshall mysql format time to time.Time", "body": "<p>I have a time of the format <code>2016-06-16 22:21:00</code> within an XML document.</p>\n\n<p>I wish to parse that time with Golang.</p>\n\n<pre><code>type Price struct {\n    Instrument string `xml:\"Instrument\"`\n    Bid float32 `xml:\"Bid\"`\n    Ask float32 `xml:\"Ask\"`\n    Updated time.Time  `xml:\"Updated\"`\n}\n\ntype Prices []Price\n\nvar p Prices\nerr := xml.Unmarshal(body, &amp;p)\nif err != nil {\n    log.Panicln(err)\n}\n</code></pre>\n\n<p>My output error is as follows:</p>\n\n<pre><code>panic: parsing time \"2016-06-16 20:59:57\" as \"2006-01-02T15:04:05Z07:00\": cannot parse \" 20:59:57\" as \"T\"\n</code></pre>\n\n<p>How can I unmarshal a mysql formatted datetime string as a <code>time.Time</code>?</p>\n\n<p>I have read that I need to create a new custom time which implements <code>time.Time</code>.</p>\n\n<pre><code>type customTime struct {\n    time.Time\n}\n\nfunc (c *customTime) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    const shortForm = \"2016-12-10 01:00:00\" // yyyy-mm-dd hh:ii:ss date format\n    var v string\n    d.DecodeElement(&amp;v, &amp;start)\n    parse, err := time.Parse(shortForm, v)\n    if err != nil {\n        return err\n    }\n    *c = customTime{parse}\n    return nil\n}\n</code></pre>\n\n<p>But when I do that, I get the following error.</p>\n\n<pre><code>panic: parsing time \"2016-06-16 20:59:57\": month out of range\n</code></pre>\n"}]