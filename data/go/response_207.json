[{"tags": ["go", "github", "visual-studio-code"], "comments": [{"owner": {"reputation": 6462, "user_id": 3784008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/55ou4.jpg?s=128&g=1", "display_name": "anothermh", "link": "https://stackoverflow.com/users/3784008/anothermh"}, "edited": false, "score": 1, "creation_date": 1545861516, "post_id": 53937546, "comment_id": 94715245, "body": "Please include a <a href=\"https://stackoverflow.com/help/mcve\">minimal, complete, verifiable example</a>. As it stands, this question is essentially &quot;How do I use git repos?&quot; which is not an appropriate question for Stack Overflow."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1545862947, "post_id": 53937546, "comment_id": 94715589, "body": "Quick question. Do these &quot;projects&quot; really need to be separate github repositories? Do they have different enough functionality to constitute the separation? I&#39;m thinking not (but may very well be wrong), given that you say if A is modified it implies that B must also be modified. Context: When I began breaking out a maturing product into more manageable pieces, I considered multiple repos, but as it turned out, what was really necessary was just multiple folders and packages in a single repo. This repo has a bare base directory and <b>two</b> related buildable apps relying on the same code."}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 0, "last_activity_date": 1545941313, "last_edit_date": 1545941313, "creation_date": 1545863914, "answer_id": 53937887, "question_id": 53937546, "link": "https://stackoverflow.com/questions/53937546/how-to-modify-multiple-go-golang-projects-at-same-time-on-visual-studio-code-vs/53937887#53937887", "title": "How to modify multiple go/golang projects at same time on Visual Studio Code VS?", "body": "<p>Clone your repositories <strong>TO</strong> the correct <code>go/src/github.com/...</code> path in your $GOPATH and change your imports to such. Point whatever VCS software you are using to these folders and maintain the repos inside your $GOPATH where they are supposed to be. Then there isn't two copies being maintained, just one. Your IDE will know exactly where to go because it's all in one place.</p>\n\n<p>This is the way $GOPATH is <em>supposed</em> to work. In Go, you don't keep your project folder outside of the $GOPATH, you put it where it's supposed to go <em>inside</em> it. It's a different sort of project foldering system, but Go was designed this way, so it's best to just follow the paradigm even though it's a little confusing at first.</p>\n"}], "owner": {"reputation": 1, "user_id": 8473769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e6cabfe53414f9ced27ba1746c8d19b5?s=128&d=identicon&r=PG", "display_name": "Diego", "link": "https://stackoverflow.com/users/8473769/diego"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1545941313, "creation_date": 1545861035, "last_edit_date": 1545862131, "question_id": 53937546, "link": "https://stackoverflow.com/questions/53937546/how-to-modify-multiple-go-golang-projects-at-same-time-on-visual-studio-code-vs", "title": "How to modify multiple go/golang projects at same time on Visual Studio Code VS?", "body": "<p>I'm working in multiple go/golang project at same time all of them versioned on github. I'm using Visual Studio Code as IDE. For this, I've clone the projects on the same folder and I've opened it on Visual Studio Code. I have to do a modification, for example, in the project A that depends of the project B (both from the same organization), however this modification implies to modify project B too. Then from any go source file on project A I access to code on B but Visual Studio Code shows the code on A stored in go folder from home folder (i.e. /go/pkg/mod/github.com/organization/goproject/core/...). Is there any form to refer to the source code that I've cloned instead of the source code in go folder?</p>\n"}, {"tags": ["database", "go", "nosql", "in-memory-database", "griddb"], "answers": [{"tags": [], "owner": {"reputation": 140, "user_id": 10328430, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/HUQfJ.jpg?s=128&g=1", "display_name": "Codelicious", "link": "https://stackoverflow.com/users/10328430/codelicious"}, "is_accepted": false, "score": 0, "last_activity_date": 1571100633, "creation_date": 1571100633, "answer_id": 58385761, "question_id": 53937202, "link": "https://stackoverflow.com/questions/53937202/cant-put-griddb-containers-using-the-go-client/58385761#58385761", "title": "Can&#39;t PUT GridDB Containers using the go_client", "body": "<p>Can you try initializing your container by using the CreateContainerInfo instead? It will create container if it doesn't exist, but if it does exist, it's a more robust method of calling your container.</p>\n\n<pre><code>conInfo, _ := griddb_go.CreateContainerInfo(\"Users\",\n            [][]interface{}{\n                {\"email\", griddb_go.TYPE_STRING},\n                {\"password\", griddb_go.TYPE_BLOB}},\n            griddb_go.CONTAINER_COLLECTION,\n            true)\n        col, _ := gridstore.PutContainer(conInfo, false)\n</code></pre>\n"}], "owner": {"reputation": 50, "user_id": 10565600, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52f8ba065fdcf16cb1405d565bef78c?s=128&d=identicon&r=PG&f=1", "display_name": "Gopheritis", "link": "https://stackoverflow.com/users/10565600/gopheritis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1580740792, "creation_date": 1545858731, "last_edit_date": 1580740792, "question_id": 53937202, "link": "https://stackoverflow.com/questions/53937202/cant-put-griddb-containers-using-the-go-client", "title": "Can&#39;t PUT GridDB Containers using the go_client", "body": "<p>I'm trying to PUT my GridDB container (a simple container for users on my website) but it's having issues.</p>\n\n<p>I've confirmed that the sample code for the go_client works so it's not an issue of improper build or anything of that sort. </p>\n\n<pre><code>func getAdminUsers(c echo.Context) error {\n    var tmp []interface{}\n\n    col, err1 := gridstore.GetContainer(\"users\")\n    if err1 != nil {\n        fmt.Println(\"get container failed\")\n    }\n\ncol.SetAutoCommit(true)\n\n// Create normal query\n    query, err := col.Query(\"SELECT *\")\n    if err != nil {\n        fmt.Println(\"create query failed\")\n    }\n    //Execute query\n    rs, err := query.Fetch(true)\n    if err != nil {\n        fmt.Println(\"create rs from query failed\")\n    }\n    for rs.HasNext() {\n        // Update row\n        rrow, err := rs.NextRow()\n        if err != nil {\n            fmt.Println(\"NextRow from rs failed\")\n        }\n        tmp = rrow\n        fmt.Println(\"Person: name=\", rrow[0], \" status=\", rrow[1], \" count=\", rrow[2], \" lob=\", rrow[3])\n    }\n\n    col.Commit()\n    fmt.Println(tmp)\n    return c.Render(http.StatusOK, \"admin\", \"admin\")\n}\n</code></pre>\n\n<p>My container is properly being written but for some reason the querying isn't working. This is rather basic code so I expect there's some minor detail I'm missing somewhere.</p>\n\n<p>As of now, I'm getting errors here: \"get container failed\". My error could either be from writing or querying, though I suspect it's from querying. </p>\n"}, {"tags": ["sockets", "go", "unix-socket"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1545853265, "post_id": 53936191, "comment_id": 94712873, "body": "It seems like you are asking if the application can be notified, not the connection.  In any case, read the connection in a for loop.  The sleep is not required."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545857630, "post_id": 53936191, "comment_id": 94714094, "body": "The question doesn&#39;t really make any sense from a Go perspective. If you want those semantics, you can run a goroutine which reads from the <code>net.Conn</code> in a loop and dumps the received packets into a channel, but to &quot;have the net.conn get notified&quot; doesn&#39;t really mean anything in Go."}], "answers": [{"tags": [], "owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "is_accepted": false, "score": 4, "last_activity_date": 1545854291, "creation_date": 1545854291, "answer_id": 53936542, "question_id": 53936191, "link": "https://stackoverflow.com/questions/53936191/can-golang-net-conn-get-notified-when-there-is-a-new-message/53936542#53936542", "title": "Can golang net.Conn get notified when there is a new message?", "body": "<p><code>net.conn.Read</code> automatically blocks until data is available on the connection.  You don't have to loop to wait for data to arise.  </p>\n\n<p>Having a simple socket server (in python3 just to make the language barrier clear)</p>\n\n<pre><code>import socket, os, sys\n\naddr='/tmp/a_unix_socket'\n\nif os.path.exists(addr):\n  os.unlink(addr)\nsock = socket.socket(socket.AF_UNIX, socket.SOCK_STREAM)\n\nsock.bind(addr)\nsock.listen(1)\n\nwhile True:\n  print(\"Waiting for connection\", file=sys.stderr)\n  conn, client_addr = sock.accept()\n  data =conn.recv(128)\n  print(\"Recived {}\".format(data))\n  conn.sendall(b'thank you')\n  conn.close()\n</code></pre>\n\n<p>I can make a golang client as such:</p>\n\n<pre><code>package main\n\nimport (\n  \"net\"\n  \"fmt\"\n)\n\nfunc main() {\n  conn, err := net.Dial(\"unix\", \"/tmp/a_unix_socket\")\n  if err != nil {\n    panic(err)\n  }\n  conn.Write([]byte(\"here is data\"))\n  result := make([]byte, 128)\n  _, err = conn.Read(result)\n  if err != nil {\n    panic(err)\n  }\n  fmt.Println(\"Response: \", string(result))\n  conn.Close()\n}\n</code></pre>\n\n<p>Server side says:</p>\n\n<pre><code>$ python3 ./t.py\nWaiting for connection\nRecived b'here is data'\nWaiting for connection\n</code></pre>\n\n<p>Client side says:</p>\n\n<pre><code>$ go run t.go\nResponse:  thank you\n</code></pre>\n\n<p><code>net.Conn</code> isn't configured with a read timeout here so it's willing to wait for as long as it takes.  </p>\n\n<p>Let me also mention this:</p>\n\n<pre><code>if err != nil {\n    return false\n}\n</code></pre>\n\n<p>This hides errors behind undistinguished 'false' responses.  In the case of an unrecoverable error (server closed connection, let's say) your client will loop indefinitely (chewing up a lot of CPU in the process).  If you need to expose errors, return them.  If you want to be lazy for proof of concept, <code>panic()</code> them if you must, but don't return the same result for all of them or you won't be able to handle individual error cases properly.  In your case it's kind of a moot point as you don't need a <code>for</code> loop anyway.  </p>\n"}, {"tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": true, "score": 3, "last_activity_date": 1545880293, "creation_date": 1545880293, "answer_id": 53939333, "question_id": 53936191, "link": "https://stackoverflow.com/questions/53936191/can-golang-net-conn-get-notified-when-there-is-a-new-message/53939333#53939333", "title": "Can golang net.Conn get notified when there is a new message?", "body": "<blockquote>\n  <p>Is there a method to have the net.conn get notified when a new message arriving net.conn instead of using a for loop?</p>\n</blockquote>\n\n<p>No, not in the standard packages.</p>\n\n<p>Read()ing from net.Conn in a loop is the usual way to detect message arrival. If you need to perform multiple concurrent tasks, you can encapsulate the loop in a goroutine writing to a channel and wrap a for-loop plus select around reading from that channel.</p>\n\n<p>Outside of standard packages, you can explore event-driven IO with projects like <a href=\"https://github.com/tidwall/evio\" rel=\"nofollow noreferrer\">https://github.com/tidwall/evio</a> </p>\n"}], "owner": {"reputation": 435, "user_id": 10061533, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-Fv61VUShbCs/AAAAAAAAAAI/AAAAAAAAAAA/AAnnY7rTOnJlSCJr_asOOUez6u2WFiAdCQ/mo/photo.jpg?sz=128", "display_name": "Cubey Mew", "link": "https://stackoverflow.com/users/10061533/cubey-mew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2105, "favorite_count": 1, "accepted_answer_id": 53939333, "answer_count": 2, "score": 3, "last_activity_date": 1571679938, "creation_date": 1545851703, "last_edit_date": 1571679938, "question_id": 53936191, "link": "https://stackoverflow.com/questions/53936191/can-golang-net-conn-get-notified-when-there-is-a-new-message", "title": "Can golang net.Conn get notified when there is a new message?", "body": "<h2><strong>What I try to implement</strong></h2>\n\n<p>I'm implementing a client sending and receiving unixpackets and interacting with a server which was already implemented in C++.<br>\nSo far, the client can receive and send packet to server successfully. But I used a for loop to keep calling <strong>Recv</strong> to see if there is a new message.</p>\n\n<h2><strong>What I did</strong></h2>\n\n<p>I implemented a Packet class so that the client and server can follow the same rules to encode and decode the message. Transport is a struct wrapping a <code>net.Conn</code>. Client is consisted of Transport, receiving Packet and sending Packet.<br>\nI used a <strong>for loop</strong> to keep calling <strong>Recv</strong> to see if there's a new message arriving at <code>net.Conn</code>.</p>\n\n<pre><code>type Packet struct {\n    Length      uint32\n    Data        []byte\n    ReadOffset  uint32\n    WriteOffset uint32\n}\n\ntype Transport struct {\n    url   string\n    conn  net.Conn\n}\n\n// connect to url\nfunc (transport *Transport) Dial(url string) error {\n    c, err := net.Dial(\"unixpacket\", url)\n    if err != nil {\n        return err\n    }\n    transport.url = url\n    transport.conn = c\n    return nil\n}\n\n// sending Packet\nfunc (transport *Transport) Send(p *Packet) bool {\n    readBuffer := (p.Data)[p.ReadOffset : p.WriteOffset]\n    _, err := transport.conn.Write(readBuffer)\n    if err != nil {\n        return false\n    }\n    return true\n}\n\n// receiving Packet\nfunc (transport *Transport) Recv(p *Packet) bool {\n    writeBuffer := (p.Data)[p.WriteOffset :]\n    _, err := transport.conn.Read(writeBuffer)\n    if err != nil {\n        return false\n    }\n    return true\n}\n\ntype Client struct {\n    Transport  *Transport\n    RecvPacket *Packet\n    SendPacket *Packet\n}\n\n// keep checking transport\nfunc (c *Client) ReadFromTransport() {\n    for {\n        time.Sleep(20 * time.Millisecond)\n        if c.Transport.Recv(c.RecvPacket) == false {\n            continue\n        }\n    }\n}\n</code></pre>\n\n<h2><strong>Question</strong></h2>\n\n<p>Is there a method to have the <code>net.Conn</code> get notified when a new message arriving instead of using a for loop?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 87, "user_id": 10765021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced873201945cfa92e484c00e0459f4?s=128&d=identicon&r=PG&f=1", "display_name": "toti toto", "link": "https://stackoverflow.com/users/10765021/toti-toto"}, "edited": false, "score": 0, "creation_date": 1545853922, "post_id": 53936368, "comment_id": 94713066, "body": "Thank you blobdon."}], "tags": [], "owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "is_accepted": true, "score": 2, "last_activity_date": 1545853006, "creation_date": 1545853006, "answer_id": 53936368, "question_id": 53936182, "link": "https://stackoverflow.com/questions/53936182/how-to-modify-struct-boolean-from-a-nested-function/53936368#53936368", "title": "How to modify struct boolean from a nested function?", "body": "<p>You're running SetName on f, then printing the value from flag. f and flag are two different values of type ChangeMe.</p>\n\n<pre><code>f.SetName(true)\nlog.Println(f.abrakadabra)\n</code></pre>\n\n<p>or</p>\n\n<pre><code>flag.SetName(true)\nlog.Println(flag.abrakadabra)\n</code></pre>\n"}], "owner": {"reputation": 87, "user_id": 10765021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced873201945cfa92e484c00e0459f4?s=128&d=identicon&r=PG&f=1", "display_name": "toti toto", "link": "https://stackoverflow.com/users/10765021/toti-toto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 53936368, "answer_count": 1, "score": -2, "last_activity_date": 1545853006, "creation_date": 1545851655, "question_id": 53936182, "link": "https://stackoverflow.com/questions/53936182/how-to-modify-struct-boolean-from-a-nested-function", "title": "How to modify struct boolean from a nested function?", "body": "<p>Setting a struct from inside a nested func doesn't work.</p>\n\n<p>I've already tried the examples from the documentation: <a href=\"https://play.golang.org/p/Pw9f20zwja\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Pw9f20zwja</a></p>\n\n<pre><code>type myStruct struct {\n    abrakadabra bool \n}\n\nfunc (f *ChangeMe) SetName(abrakadabra bool) {\n    f.abrakadabra = true\n}\n\nfunc something() {\n    var flag ChangeMe\n    f := new(ChangeMe)\n\n    copy := func(r io.ReadCloser, w io.WriteCloser) {\n        //...some code..\n\n        if err != nil { \n            f.SetName(true)\n            log.Println(flag.abrakadabra)\n        }\n    } \n</code></pre>\n\n<p>in the log print - the abrakadabra boolean remains false (starter value), why doesn't it change to true?</p>\n"}, {"tags": ["go", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 778, "user_id": 9843090, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fHp_z8JYfDo/AAAAAAAAAAI/AAAAAAAAPn0/JPzmXrpGuhA/photo.jpg?sz=128", "display_name": "Spencer Stolworthy", "link": "https://stackoverflow.com/users/9843090/spencer-stolworthy"}, "edited": false, "score": 1, "creation_date": 1545855543, "post_id": 53936253, "comment_id": 94713543, "body": "Okay, so basically this is just an arbitrary code block placed after the declaration of variable v1. It&#39;s not that the Group method is &quot;ingesting&quot; or taking in the code block, it is just setting it apart to avoid side effects with defer, or something like that?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545857448, "post_id": 53936253, "comment_id": 94714041, "body": "It can be used for some scoping magic, but it&#39;s not here. The code shown would operate exactly identically without the braces. It makes no difference for <code>defer</code> which is always function-scoped, not block-scoped."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545857513, "post_id": 53936253, "comment_id": 94714057, "body": "Basically the examples from the docs are really terrible and the braces are totally unnecessary decoration."}, {"owner": {"reputation": 778, "user_id": 9843090, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fHp_z8JYfDo/AAAAAAAAAAI/AAAAAAAAPn0/JPzmXrpGuhA/photo.jpg?sz=128", "display_name": "Spencer Stolworthy", "link": "https://stackoverflow.com/users/9843090/spencer-stolworthy"}, "edited": false, "score": 0, "creation_date": 1545924737, "post_id": 53936253, "comment_id": 94733089, "body": "Thanks so much for your quick response. I was so perplexed."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1545853360, "last_edit_date": 1545853360, "creation_date": 1545852192, "answer_id": 53936253, "question_id": 53936092, "link": "https://stackoverflow.com/questions/53936092/syntax-question-from-gin-gonic-documentation/53936253#53936253", "title": "Syntax question from `gin-gonic` documentation", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Blocks\" rel=\"nofollow noreferrer\">Blocks</a></p>\n  \n  <p>A block is a possibly empty sequence of declarations and statements\n  within matching brace brackets.</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow noreferrer\">Declarations and scope</a></p>\n  \n  <p>Go is lexically scoped using blocks.</p>\n</blockquote>\n\n<hr>\n\n<p>For example, the <code>v1.POST</code> method call statements form a block:</p>\n\n<pre><code>// Simple group: v1\nv1 := router.Group(\"/v1\")\n{\n    v1.POST(\"/login\", loginEndpoint)\n    v1.POST(\"/submit\", submitEndpoint)\n    v1.POST(\"/read\", readEndpoint)\n}\n</code></pre>\n\n<p>This is an unusual use of blocks.</p>\n"}], "owner": {"reputation": 778, "user_id": 9843090, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-fHp_z8JYfDo/AAAAAAAAAAI/AAAAAAAAPn0/JPzmXrpGuhA/photo.jpg?sz=128", "display_name": "Spencer Stolworthy", "link": "https://stackoverflow.com/users/9843090/spencer-stolworthy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 275, "favorite_count": 1, "accepted_answer_id": 53936253, "answer_count": 1, "score": 2, "last_activity_date": 1545853360, "creation_date": 1545851134, "last_edit_date": 1545851341, "question_id": 53936092, "link": "https://stackoverflow.com/questions/53936092/syntax-question-from-gin-gonic-documentation", "title": "Syntax question from `gin-gonic` documentation", "body": "<p>I have been developing in Node/Python for years, and over the holiday I have been trying to expand my knowledge of Go. I have a pet project that I've been working on to learn it. </p>\n\n<p>As I have been reading the <a href=\"https://github.com/gin-gonic/gin#grouping-routes\" rel=\"nofollow noreferrer\">gin-gonic documentation</a>, I found syntax that I can't wrap my head around.</p>\n\n<pre><code>func main() {\n    router := gin.Default()\n\n    // Simple group: v1\n    v1 := router.Group(\"/v1\")\n    {\n        v1.POST(\"/login\", loginEndpoint)\n        v1.POST(\"/submit\", submitEndpoint)\n        v1.POST(\"/read\", readEndpoint)\n    }\n\n    // Simple group: v2\n    v2 := router.Group(\"/v2\")\n    {\n        v2.POST(\"/login\", loginEndpoint)\n        v2.POST(\"/submit\", submitEndpoint)\n        v2.POST(\"/read\", readEndpoint)\n    }\n\n    router.Run(\":8080\")\n}\n</code></pre>\n\n<p>Basically, it looks like the <code>router.Group()</code> method takes in a struct, but I am not quite sure what the mechanics are here... It's not wrapped in parentheses. How is this object being passed in/handled by the <code>Group</code> method?</p>\n"}, {"tags": ["go", "ticker"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 3, "last_activity_date": 1545847493, "creation_date": 1545847493, "answer_id": 53935498, "question_id": 53935464, "link": "https://stackoverflow.com/questions/53935464/ticker-still-live-in-memory/53935498#53935498", "title": "ticker still live in memory", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">Package time</a></p>\n\n<pre><code>import \"time\"\n</code></pre>\n  \n  <p><a href=\"https://golang.org/pkg/time/#NewTicker\" rel=\"nofollow noreferrer\">func NewTicker</a></p>\n  \n  <p>func NewTicker(d Duration) *Ticker</p>\n  \n  <p>NewTicker returns a new Ticker containing a channel that will send the\n  time with a period specified by the duration argument. It adjusts the\n  intervals or drops ticks to make up for slow receivers. The duration d\n  must be greater than zero; if not, NewTicker will panic. Stop the\n  ticker to release associated resources.</p>\n</blockquote>\n\n<hr>\n\n<p>Follow the instructions: Stop the ticker to release associated resources.</p>\n"}, {"tags": [], "owner": {"reputation": 8699, "user_id": 1726083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/757452f7cd7ba2347c667ef9298ceadb?s=128&d=identicon&r=PG", "display_name": "Daniel Farrell", "link": "https://stackoverflow.com/users/1726083/daniel-farrell"}, "is_accepted": true, "score": 2, "last_activity_date": 1545847710, "creation_date": 1545847710, "answer_id": 53935528, "question_id": 53935464, "link": "https://stackoverflow.com/questions/53935464/ticker-still-live-in-memory/53935528#53935528", "title": "ticker still live in memory", "body": "<pre><code>for {\n    ticker = time.NewTicker(time.Duration(timeOut) * time.Second)\n}\n</code></pre>\n\n<p>That's going to create ticker instances as fast as possible, and because of the nature of ticker objects they won't be able to clean up ( they're referenced by the implementation of ticket which, due to its async nature, happens in a different goroutine).  Go can do this very quickly, resulting in OOM ( out of memory) error very rapidly.  </p>\n\n<p>But this pattern doesn't make any sense.  There's no good reason to create new tickers like this in a <code>for</code> loop.  You can create multiple tickers, even very many of them, but you can't create infinite tickers, nor does it make much sense to do so.  </p>\n\n<p>Further, notice you're not actually <em>using</em> your tickers anywhere.  Consider the example here: <a href=\"https://gobyexample.com/tickers\" rel=\"nofollow noreferrer\">https://gobyexample.com/tickers</a> . You'll see how they interact with the ticker to make code run with each tick.  Note the ticker there is created <em>once</em>, not in a loop.  </p>\n"}], "owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "accepted_answer_id": 53935528, "answer_count": 2, "score": 0, "last_activity_date": 1545847710, "creation_date": 1545847295, "question_id": 53935464, "link": "https://stackoverflow.com/questions/53935464/ticker-still-live-in-memory", "title": "ticker still live in memory", "body": "<p>Why when I initialize ticker and then update it, original ticker still live in memory and if I make for loop it will kill my RAM very soon</p>\n\n<pre><code>timeOut := 10\nticker := time.NewTicker(time.Duration(timeOut) * time.Second)\nfor {\n    ticker = time.NewTicker(time.Duration(timeOut) * time.Second)\n}\n</code></pre>\n"}, {"tags": ["go", "linker", "cgo"], "comments": [{"owner": {"reputation": 10507, "user_id": 56686, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/9nKtX.jpg?s=128&g=1", "display_name": "Mattias Wadman", "link": "https://stackoverflow.com/users/56686/mattias-wadman"}, "edited": false, "score": 0, "creation_date": 1545843472, "post_id": 53934241, "comment_id": 94709832, "body": "Looking at <a href=\"https://github.com/golang/go/blob/master/src/runtime/cgo/gcc_libinit.c#L29\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/runtime/cgo/&hellip;</a> it seems not easy to skip. Can you add some verbose/debug flag when linking to see if libc is actually included when linking? library order issue?"}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1545848348, "creation_date": 1545848348, "answer_id": 53935616, "question_id": 53934241, "link": "https://stackoverflow.com/questions/53934241/golang-c-archive-with-libc-instead-of-glibc/53935616#53935616", "title": "Golang c-archive with libc instead of glibc", "body": "<p>From <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\">the docs</a>:</p>\n\n<blockquote>\n  <p>The default C and C++ compilers may be changed by the <code>CC</code> and <code>CXX</code> environment variables, respectively; those environment variables may include command line options.</p>\n</blockquote>\n\n<p>So I'd try something like</p>\n\n<pre><code>$ CC=clang go build -buildmode=c-archive -o test.a main.go\n</code></pre>\n\n<p>and see what happens.</p>\n"}, {"tags": [], "owner": {"reputation": 136, "user_id": 8451486, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3WNzH.jpg?s=128&g=1", "display_name": "Deepak Kumar", "link": "https://stackoverflow.com/users/8451486/deepak-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1545882713, "creation_date": 1545882713, "answer_id": 53939543, "question_id": 53934241, "link": "https://stackoverflow.com/questions/53934241/golang-c-archive-with-libc-instead-of-glibc/53939543#53939543", "title": "Golang c-archive with libc instead of glibc", "body": "<p>Run <code>go env</code> and see the list of env parameters set to go. You can change certain parameters based on what you need.</p>\n\n<p>Following are some of the samples that I have used to build a shared dll from go program.</p>\n\n<pre><code>GOARCH=386 GOOS=windows CGO_ENABLED=1 GOPATH=`pwd` CC=i686-w64-mingw32-gcc  go build -o go-shared-lib.dll -buildmode=c-shared go-shared-libs\nGOARCH=amd64 GOOS=windows CGO_ENABLED=1 GOPATH=`pwd` CC=x86_64-w64-mingw32-gcc  go build -o go-shared-lib.dll -buildmode=c-shared go-shared-libs\n</code></pre>\n"}], "owner": {"reputation": 715, "user_id": 1698165, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/73302a7d59a09423727a435ea3766b8b?s=128&d=identicon&r=PG", "display_name": "Ruenzuo", "link": "https://stackoverflow.com/users/1698165/ruenzuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 610, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1545882713, "creation_date": 1545839790, "question_id": 53934241, "link": "https://stackoverflow.com/questions/53934241/golang-c-archive-with-libc-instead-of-glibc", "title": "Golang c-archive with libc instead of glibc", "body": "<p>Is it possible?</p>\n\n<p>I have the following Go function I'd like to call from a C program: </p>\n\n<pre><code>// package name: test\npackage main\n\nimport \"C\"\n\n//export Start\nfunc Start() {\n    println(\"Hello world\")\n}\n\nfunc main() {\n}\n</code></pre>\n\n<p>I'm using the following command to build the archive</p>\n\n<p><code>go build -buildmode=c-archive -o test.a main.go</code></p>\n\n<p>Using gcc I can get this C program working:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include \"test.h\"\n\nint main() {\n  Start();\n  return 0;\n}\n</code></pre>\n\n<p>I'm using the following command to build the executable:</p>\n\n<p><code>gcc main.c sdlgotest.a -o main -lpthread</code></p>\n\n<p>This all works fine for amd64, but I'd like to use this archive in a aarch64 targed development environment (using <a href=\"https://github.com/reswitched/libtransistor\" rel=\"nofollow noreferrer\">libtransistor</a>)</p>\n\n<p>libtransistor build system uses LLVM but it has it's own set of standard includes (libc, etc.) and it doesn't use glibc.</p>\n\n<p>So when I'm trying to get libtransistor to link my archive I get the following errors:</p>\n\n<pre><code>/usr/lib/llvm-5.0/bin/ld.lld: error: undefined symbol: stderr\n&gt;&gt;&gt; referenced by gcc_libinit.c:29\n&gt;&gt;&gt;               000006.o:(x_cgo_sys_thread_create) in archive ./sdlgotest.a\n\n/usr/lib/llvm-5.0/bin/ld.lld: error: undefined symbol: stderr\n&gt;&gt;&gt; referenced by gcc_libinit.c:29\n&gt;&gt;&gt;               000006.o:(x_cgo_sys_thread_create) in archive ./sdlgotest.a\n</code></pre>\n\n<p>libtransistor by the way is compiling the code with flags like this:</p>\n\n<p><code>-nostdlib -nostdlibinc -isystem /opt/libtransistor/include/</code> </p>\n\n<p>So I guess the problem is that the linker can't resolve those glibc symbols.</p>\n\n<p>Is there a way to compile the Go runtime without those glibc symbols so I can use the archive like I intend to? (without relying on GCC toolchain or glibc)</p>\n"}, {"tags": ["go", "protocol-buffers", "marshalling", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "edited": false, "score": 0, "creation_date": 1545852520, "post_id": 53936281, "comment_id": 94712697, "body": "Unpacking into native data structures is what I&#39;m doing right now. I don&#39;t use the proto.Struct anymore, but I&#39;m sending bytes. This works, still I&#39;m wondering if I can use the protobuf implementation instead of marshalling. <code>map[string]interface{}</code> is just my template for data structures, it&#39;s not what grpc is returning. It&#39;s what I should pass as a grpc field."}], "tags": [], "owner": {"reputation": 36, "user_id": 3477206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d434863359909b34ef9e202eb318395f?s=128&d=identicon&r=PG&f=1", "display_name": "lyuxuan", "link": "https://stackoverflow.com/users/3477206/lyuxuan"}, "is_accepted": false, "score": 0, "last_activity_date": 1545852427, "creation_date": 1545852427, "answer_id": 53936281, "question_id": 53932182, "link": "https://stackoverflow.com/questions/53932182/protocol-buffers-send-arbitrary-structure-over-grpc/53936281#53936281", "title": "Protocol Buffers: Send arbitrary structure over GRPC", "body": "<p>grpc server should unpack the bytes into a go struct as defined <a href=\"https://github.com/golang/protobuf/blob/master/ptypes/struct/struct.pb.go#L60\" rel=\"nofollow noreferrer\">here</a>. Can you provide more info about why you are seeing <code>map[string]interface{}</code>?</p>\n"}], "owner": {"reputation": 605, "user_id": 1833375, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh4.googleusercontent.com/-fDVU1oE52OQ/AAAAAAAAAAI/AAAAAAAAAB0/vttX9bxzSiM/photo.jpg?sz=128", "display_name": "John White", "link": "https://stackoverflow.com/users/1833375/john-white"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 858, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545852427, "creation_date": 1545827600, "last_edit_date": 1545831939, "question_id": 53932182, "link": "https://stackoverflow.com/questions/53932182/protocol-buffers-send-arbitrary-structure-over-grpc", "title": "Protocol Buffers: Send arbitrary structure over GRPC", "body": "<p>I'm aiming at creating an API that receives JSON objects (nested and of arbitrary nature), packs them into <code>google/protobuf/struct.proto</code> structures and sends them with GRPC. It's all fine, the good <code>jsonpb</code> library covers the unmarshalling process.</p>\n\n<p>The problem arises in the GRPC server, the receiver, it unpacks the struct.proto object into a normal golang data structure for convenience of use, so it becomes a <code>map[string]interface{}</code>, with other nested objects of various kinds. </p>\n\n<p>So when I try to convert the object back to a struct.proto for sending it back to the client, there are few options. I found a converter that uses reflection, which has a bug I can't quite catch (has to do with not being able to distinguish data types, it treats nested stuff as interface{}), <a href=\"https://gist.github.com/jsmouret/2bc876e8def6c63410556350eca3e43d\" rel=\"nofollow noreferrer\">this one</a>.</p>\n\n<p>After banging my head on it for quite a few hours, I'm starting to wonder if this is even the best approach. I need to convert the struct.proto objects into something convenient and convert them back, is there a better way for doing the conversion as fast as possible while maintaining the nesting capability?</p>\n\n<p>It's strange that the struct.proto is easy to convert one way and very hard to do the opposite. Must be because the only way to extract object metadata is through reflection. And the lack of generics make it even harder.</p>\n\n<p>Using JSON is quite bad for performance, and gob is not an option as the protocol must be as universal as possible. The last chance I could think of is to find another marshaller and send the data as raw bytes through the protobuf, and then unmarshal it in the server.</p>\n\n<p>Any help is welcome, thanks.</p>\n\n<p>EDIT 1:</p>\n\n<p>I think in the end I will have to implement the possibility to have multiple marshalling protocols and a byte array in the protobuf definition, so the server and client negotiate on the fastest they can support... and that would allow me to implement it with gob and jbson as a fallback. Comments?</p>\n"}, {"tags": ["go", "azure-functions", "azure-sdk"], "comments": [{"owner": {"reputation": 6417, "user_id": 3234163, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/d3413ce2f05119b9133f6afb00e25dea?s=128&d=identicon&r=PG", "display_name": "ahmelsayed", "link": "https://stackoverflow.com/users/3234163/ahmelsayed"}, "edited": false, "score": 0, "creation_date": 1545944025, "post_id": 53932047, "comment_id": 94740028, "body": "It&#39;s not in the SDK."}], "answers": [{"tags": [], "owner": {"reputation": 473, "user_id": 1561019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c60957296670307e033be0f9172fcefe?s=128&d=identicon&r=PG", "display_name": "Alon Rolnik", "link": "https://stackoverflow.com/users/1561019/alon-rolnik"}, "is_accepted": false, "score": 0, "last_activity_date": 1546522347, "creation_date": 1546522347, "answer_id": 54023305, "question_id": 53932047, "link": "https://stackoverflow.com/questions/53932047/download-azure-function-files-through-azure-sdk-for-go/54023305#54023305", "title": "Download Azure function files through azure-sdk-for-go", "body": "<p>The way to do it is to use Azure <a href=\"https://github.com/projectkudu/kudu/wiki]\" rel=\"nofollow noreferrer\">Kudu API</a>.\nEach Azure function App have a publish profile which can be fetched from the SDK or the site itself.\nFrom the publish profile we get a (key, secret) pair to use in the <a href=\"https://github.com/projectkudu/kudu/wiki/REST-API#zip\" rel=\"nofollow noreferrer\">Kudu zip api</a></p>\n"}], "owner": {"reputation": 473, "user_id": 1561019, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c60957296670307e033be0f9172fcefe?s=128&d=identicon&r=PG", "display_name": "Alon Rolnik", "link": "https://stackoverflow.com/users/1561019/alon-rolnik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1546522347, "creation_date": 1545826852, "question_id": 53932047, "link": "https://stackoverflow.com/questions/53932047/download-azure-function-files-through-azure-sdk-for-go", "title": "Download Azure function files through azure-sdk-for-go", "body": "<p>I'm trying to find a way to download Azure function files through azure-sdk-for-go.\nBasically something similar to theirs portal.\nWill appreciate any help.\n<a href=\"https://i.stack.imgur.com/XuwNQ.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XuwNQ.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["go", "swagger", "swagger-2.0"], "comments": [{"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1545831967, "post_id": 53931726, "comment_id": 94706125, "body": "Your spec is correct, so the issue is probably with the code generator. How did you generate the server?"}, {"owner": {"reputation": 33, "user_id": 10132765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74516adada96074df5984ba41a074f3?s=128&d=identicon&r=PG&f=1", "display_name": "Nirmal Agrawal", "link": "https://stackoverflow.com/users/10132765/nirmal-agrawal"}, "reply_to_user": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1545833183, "post_id": 53931726, "comment_id": 94706570, "body": "<code>swagger generate server</code>"}, {"owner": {"reputation": 57048, "user_id": 113116, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/e0v1H.png?s=128&g=1", "display_name": "Helen", "link": "https://stackoverflow.com/users/113116/helen"}, "edited": false, "score": 0, "creation_date": 1545837121, "post_id": 53931726, "comment_id": 94707791, "body": "Open an issue in the <a href=\"https://github.com/go-swagger/go-swagger/\" rel=\"nofollow noreferrer\">go-swagger repository</a> on GitHub."}], "owner": {"reputation": 33, "user_id": 10132765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e74516adada96074df5984ba41a074f3?s=128&d=identicon&r=PG&f=1", "display_name": "Nirmal Agrawal", "link": "https://stackoverflow.com/users/10132765/nirmal-agrawal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545825118, "creation_date": 1545825118, "question_id": 53931726, "link": "https://stackoverflow.com/questions/53931726/how-to-ref-for-a-property-and-make-it-required-as-well-in-swagger-2-0", "title": "How to $ref for a property and make it &#39;required&#39; as well in swagger 2.0?", "body": "<p>Using go-swagger. I used the petstore example and edited the <code>NewPet</code> definition to this - </p>\n\n<pre><code>\"NewPet\": {\n        \"type\": \"object\",\n        \"required\": [\n          \"name\"\n        ],\n        \"properties\": {\n          \"name\": {\n            \"$ref\":\"#/definitions/name\"\n          },\n          \"tag\": {\n            \"type\": \"string\"\n          }\n        }\n      }\n</code></pre>\n\n<p>The definition of <code>name</code> being - </p>\n\n<pre><code>\"name\":{\n            \"type\": \"string\"\n    }\n</code></pre>\n\n<p>Generating the server removes the <code>required</code> validation from name. Is there something wrong here? Or is there another way to reuse the property definition?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 414, "user_id": 6331353, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd7f6cc42c46c3a65c58ff594d962597?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6331353/sam"}, "edited": false, "score": 0, "creation_date": 1545824005, "post_id": 53931173, "comment_id": 94703454, "body": "I receive the error <code>prog.go:12:13: undefined: lists</code> if I Change <code>var rooms list</code> to <code>var rooms = list.New()</code>"}, {"owner": {"reputation": 2886, "user_id": 2081835, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/4741683a91497af9910946e555ebfe0e?s=128&d=identicon&r=PG", "display_name": "TheHerk", "link": "https://stackoverflow.com/users/2081835/theherk"}, "reply_to_user": {"reputation": 414, "user_id": 6331353, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd7f6cc42c46c3a65c58ff594d962597?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6331353/sam"}, "edited": false, "score": 1, "creation_date": 1545877803, "post_id": 53931173, "comment_id": 94717918, "body": "@Jacob, I believe your issue is clear in the error. It said <i>lists</i>, with an &quot;s&quot;."}], "tags": [], "owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "is_accepted": false, "score": 2, "last_activity_date": 1545822187, "creation_date": 1545822187, "answer_id": 53931173, "question_id": 53931002, "link": "https://stackoverflow.com/questions/53931002/using-a-global-list-variable-in-golang-receiving-use-of-package-list-without-s/53931173#53931173", "title": "Using a global list variable in Golang. Receiving &quot;Use of package list without selector&quot;", "body": "<p>Play here <a href=\"https://play.golang.org/p/ORa6MI-2Pbn\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ORa6MI-2Pbn</a></p>\n\n<p>Change <code>var rooms list</code> to <code>var rooms = list.New()</code></p>\n\n<p>Error because <code>var rooms list</code> is wrong: <code>list</code> is pkg name, you should write like this <code>*list.List</code></p>\n"}, {"comments": [{"owner": {"reputation": 414, "user_id": 6331353, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd7f6cc42c46c3a65c58ff594d962597?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6331353/sam"}, "edited": false, "score": 0, "creation_date": 1545824093, "post_id": 53931180, "comment_id": 94703476, "body": "Also, do you know how to make conn a global variable?"}, {"owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "reply_to_user": {"reputation": 414, "user_id": 6331353, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd7f6cc42c46c3a65c58ff594d962597?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6331353/sam"}, "edited": false, "score": 0, "creation_date": 1545824626, "post_id": 53931180, "comment_id": 94703647, "body": "Don&#39;t use the comments for new questions - ask a new question. But make sure you do some research first. : )"}, {"owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "reply_to_user": {"reputation": 414, "user_id": 6331353, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd7f6cc42c46c3a65c58ff594d962597?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6331353/sam"}, "edited": false, "score": 0, "creation_date": 1545836002, "post_id": 53931180, "comment_id": 94707395, "body": "@Jacob - I hope my comment didn&#39;t come off as dismissive. Looking at it now, it seems like it could have. If we hash out your new question here, it won&#39;t be available for others who may have the same question in the future, and won&#39;t attract the attention of people best suited to answer it. I hope you&#39;ve figured it out, though!"}, {"owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "reply_to_user": {"reputation": 414, "user_id": 6331353, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd7f6cc42c46c3a65c58ff594d962597?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6331353/sam"}, "edited": false, "score": 1, "creation_date": 1545846953, "post_id": 53931180, "comment_id": 94710924, "body": "<code>var conn net.Conn</code> in the global scope (before/after <code>var rooms *list.List</code>)"}], "tags": [], "owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "is_accepted": true, "score": 3, "last_activity_date": 1545866903, "last_edit_date": 1545866903, "creation_date": 1545822233, "answer_id": 53931180, "question_id": 53931002, "link": "https://stackoverflow.com/questions/53931002/using-a-global-list-variable-in-golang-receiving-use-of-package-list-without-s/53931180#53931180", "title": "Using a global list variable in Golang. Receiving &quot;Use of package list without selector&quot;", "body": "<p>The type for rooms should be <code>*list.List</code>, a pointer to <code>List</code> type from package <code>list</code>. </p>\n\n<p>Change <code>var rooms list</code> to <code>var rooms *list.List</code></p>\n"}], "owner": {"reputation": 414, "user_id": 6331353, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cd7f6cc42c46c3a65c58ff594d962597?s=128&d=identicon&r=PG&f=1", "display_name": "Sam", "link": "https://stackoverflow.com/users/6331353/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1533, "favorite_count": 0, "accepted_answer_id": 53931180, "answer_count": 2, "score": -1, "last_activity_date": 1545866903, "creation_date": 1545821390, "question_id": 53931002, "link": "https://stackoverflow.com/questions/53931002/using-a-global-list-variable-in-golang-receiving-use-of-package-list-without-s", "title": "Using a global list variable in Golang. Receiving &quot;Use of package list without selector&quot;", "body": "<p>I have a global linked list named rooms. It is going to store the names of all the rooms this user enters in. In my function create I am trying to reference this list named rooms. I instantiate the list in my main function. When I try to add an item to the list \"rooms\" I receive the error \"Use of package list without selector\". </p>\n\n<p>I would like to be able to add a string to my list named rooms from within my create function.</p>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n    \"net\"\n    \"fmt\"\n    \"bufio\"\n    \"os\"\n    \"container/list\"\n)\n\nvar rooms list\n\nfunc create() string{\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Name the Chatroom\");\n    input, _ := reader.ReadString('\\n');\n    _ = rooms.PushFront(input);\n    return \"Joined room \" + input;\n}   \n\nfunc main() {\n\n    rooms := list.New()\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter a name\")\n    name, _ := reader.ReadString('\\n')\n\n    // connect to this socket\n    conn, _ := net.Dial(\"tcp\", \"127.0.0.1:8081\")\n    for { \n        // read in input from stdin\n        reader := bufio.NewReader(os.Stdin)\n        fmt.Print(\"Text to send: \")\n        text, _ := reader.ReadString('\\n')\n        // send to socket\n        fmt.Fprintf(conn, text + \"\\n\")\n        // listen for reply\n        message, _ := bufio.NewReader(conn).ReadString('\\n')\n        fmt.Print(\"Message from server: \"+message)\n    }\n}  \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 23625, "user_id": 2868801, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ec5567811049b7ce8192be0bc0246d1?s=128&d=identicon&r=PG&f=1", "display_name": "dave_thompson_085", "link": "https://stackoverflow.com/users/2868801/dave-thompson-085"}, "edited": false, "score": 2, "creation_date": 1545821863, "post_id": 53930168, "comment_id": 94702698, "body": "Selfsigned certs you created are <b>not issued by <i>any</i> CA</b>. A selfsigned cert&#39;s issuer is the same as the subject; that&#39;s what selfsigned means. If you created the certs with different values in subject&amp;issuer the different values are different and you can tell them apart; if you created the certs with the same value the same value is the same and two same values are not different."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 1, "last_activity_date": 1545839882, "creation_date": 1545839882, "answer_id": 53934262, "question_id": 53930168, "link": "https://stackoverflow.com/questions/53930168/how-to-tell-two-certificate-pairs-are-issued-by-different-ca-in-golang/53934262#53934262", "title": "How to tell two certificate pairs are issued by different CA in Golang?", "body": "<p>The <a href=\"https://golang.org/pkg/crypto/x509/#Certificate\" rel=\"nofollow noreferrer\"><code>SubjectKeyId</code> fields</a> will be different for two distinct certificates.</p>\n\n<p>This field is a hash of the public key:</p>\n\n<blockquote>\n  <p>The keyIdentifier is composed of the 160-bit SHA-1 hash of the\n        value of the BIT STRING subjectPublicKey (excluding the tag,\n        length, and number of unused bits).</p>\n</blockquote>\n\n<p><a href=\"https://tools.ietf.org/html/rfc3280#section-4.2.1.2\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc3280#section-4.2.1.2</a></p>\n\n<p>For certificates that are not self-signed one would follow the <code>AuthorityKeyId</code> fields all the way to the root certificate(s) and then check the certificate chains for common members, again using the subject keys.</p>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545839882, "creation_date": 1545817177, "question_id": 53930168, "link": "https://stackoverflow.com/questions/53930168/how-to-tell-two-certificate-pairs-are-issued-by-different-ca-in-golang", "title": "How to tell two certificate pairs are issued by different CA in Golang?", "body": "<p>I have a GOlang http server which uses self-signed tls certificate. I have one such pair of certificate and key. Now, say I have a similar certificate and key pair. I would like to detect whether these two pairs were issued by two different CA? I don't have access to the CA certificates in this case. I can assume that the chain length = 1.</p>\n\n<p>I tried to check the Certificate.Issuer structure. But I see no difference there. How can I do this?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["loops", "go", "background-process", "scheduling"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1545836487, "post_id": 53929591, "comment_id": 94707577, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/39642189/goroutines-blocked-by-for-loop\" title=\"goroutines blocked by for loop\">stackoverflow.com/questions/39642189/&hellip;</a>,"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1545828914, "last_edit_date": 1545828914, "creation_date": 1545816034, "answer_id": 53929956, "question_id": 53929591, "link": "https://stackoverflow.com/questions/53929591/what-causes-empty-go-for-loops-to-lock-the-program/53929956#53929956", "title": "What causes empty Go for loops to lock the program?", "body": "<p>For example, Issue #10958: <a href=\"https://github.com/golang/go/issues/10958\" rel=\"nofollow noreferrer\">runtime: tight loops should be preemptible #10958</a></p>\n\n<blockquote>\n  <p>Currently goroutines are only preemptible at function call points.\n  Hence, it's possible to write a tight loop (e.g., a numerical kernel\n  or a spin on an atomic) with no calls or allocation that arbitrarily\n  delays preemption. This can result in arbitrarily long pause times as\n  the GC waits for all goroutines to stop.</p>\n  \n  <p>In unusual situations, this can even lead to deadlock when trying to\n  stop the world. For example, the runtime's TestGoroutineParallelism\n  tries to prevent GC during the test to avoid deadlock. It runs several\n  goroutines in tight loops that communicate through a shared atomic\n  variable. If the coordinator that starts these is paused part way\n  through, it will deadlock.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 188, "user_id": 3073088, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19964f037cbd3d693151fdfcd57f8ced?s=128&d=identicon&r=PG", "display_name": "deef0000dragon1", "link": "https://stackoverflow.com/users/3073088/deef0000dragon1"}, "edited": false, "score": 0, "creation_date": 1545962155, "post_id": 53929974, "comment_id": 94744255, "body": "I asked this more for an understanding of the backed mechanisms of go rather than &quot;don&#39;t use an empty for loop&quot;. I learn from the <i>why</i> as much as the <i>what</i>."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": false, "score": 5, "last_activity_date": 1545816125, "creation_date": 1545816125, "answer_id": 53929974, "question_id": 53929591, "link": "https://stackoverflow.com/questions/53929591/what-causes-empty-go-for-loops-to-lock-the-program/53929974#53929974", "title": "What causes empty Go for loops to lock the program?", "body": "<p>An empty for loop doesn't <em>block</em>. It keeps the CPU busy with executing the same JMP instruction over and over again. You should have heard your CPU fan spin up fairly quickly too.</p>\n\n<p>The simplest way to block indefinitely is an empty select statement:</p>\n\n<pre><code>select {}\n</code></pre>\n"}], "owner": {"reputation": 188, "user_id": 3073088, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/19964f037cbd3d693151fdfcd57f8ced?s=128&d=identicon&r=PG", "display_name": "deef0000dragon1", "link": "https://stackoverflow.com/users/3073088/deef0000dragon1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 398, "favorite_count": 1, "accepted_answer_id": 53929956, "answer_count": 2, "score": -1, "last_activity_date": 1545828914, "creation_date": 1545813968, "question_id": 53929591, "link": "https://stackoverflow.com/questions/53929591/what-causes-empty-go-for-loops-to-lock-the-program", "title": "What causes empty Go for loops to lock the program?", "body": "<p>As I was learning Go I initially wrote my short programs using an empty for loop to block the program from exiting as I ran my test functions with the go keyword. As my test/learning programs grew in size however, the entire program would sometimes freeze at random places and the debugger would disconnect, making debugging really hard. </p>\n\n<p>I eventually learned that the cause was the empty for loop from a bit of discussion on the IRC, and replaced it with a blocking channel, but I never learned WHY other than it was something to do with how Go handles scheduling. </p>\n\n<p>What mechanism in the background causes independent go-routines to lock entire programs, even when there are plenty of cores allocated to the program, if there is an empty infinite for loop?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 9542, "user_id": 8068625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4spqa.png?s=128&g=1", "display_name": "Henry Woody", "link": "https://stackoverflow.com/users/8068625/henry-woody"}, "edited": false, "score": 3, "creation_date": 1545811728, "post_id": 53929168, "comment_id": 94699303, "body": "The point regarding <code>make</code> is an interesting one, it seems <code>make</code> is a special language construct (rather than a normal function) so the rules don&#39;t apply the same to it. See <a href=\"https://stackoverflow.com/questions/18512781/built-in-source-code-location\" title=\"built in source code location\">stackoverflow.com/questions/18512781/&hellip;</a>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1545816956, "post_id": 53929168, "comment_id": 94700959, "body": "&quot;if Go team doesn&#39;t like optional parameter then why they had supported a function which is so frequently used with this anti-pattern?&quot; That&#39;s a matter of opinion and is off-topic on Stack Overflow:. &quot;primarily opinion-based : Many good questions generate some degree of opinion based on expert experience, but answers to this question will tend to be almost entirely based on opinions, rather than facts, references, or specific expertise.&quot;"}, {"owner": {"reputation": 502, "user_id": 6546827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OowZ1.png?s=128&g=1", "display_name": "Aziz", "link": "https://stackoverflow.com/users/6546827/aziz"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545831047, "post_id": 53929168, "comment_id": 94705804, "body": "@peterSO Yes, that is certainly an opinionated question but my main question isn&#39;t that. I agree it can be considered a duplication of <a href=\"https://stackoverflow.com/questions/18512781/built-in-source-code-location\">Built-In source code location</a>."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1545815384, "creation_date": 1545815384, "answer_id": 53929833, "question_id": 53929168, "link": "https://stackoverflow.com/questions/53929168/how-make-function-in-go-handle-optional-parameter/53929833#53929833", "title": "How make function in Go handle optional parameter?", "body": "<p><code>make</code> is not a normal function. Neither is <code>new</code>, <code>len</code>, <code>cap</code>, <code>close</code>,  <code>append</code>, and a few more. Those are <a href=\"https://golang.org/ref/spec#Built-in_functions\" rel=\"nofollow noreferrer\">built-in functions</a>. </p>\n\n<p>Most built-in functions and operators are rewritten by the compiler to call normal functions in the runtime package.</p>\n\n<p>For channels, the compiler rewrites the <code>make</code> call to a call to <a href=\"https://golang.org/pkg/runtime/?m=all#makechan\" rel=\"nofollow noreferrer\">runtime.makechan</a> or one of the related variants.</p>\n\n<p>Normal functions cannot have optional parameters.</p>\n"}], "owner": {"reputation": 502, "user_id": 6546827, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/OowZ1.png?s=128&g=1", "display_name": "Aziz", "link": "https://stackoverflow.com/users/6546827/aziz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 105, "favorite_count": 0, "closed_date": 1545816623, "accepted_answer_id": 53929833, "answer_count": 1, "score": 0, "last_activity_date": 1545831393, "creation_date": 1545811246, "last_edit_date": 1545831393, "question_id": 53929168, "link": "https://stackoverflow.com/questions/53929168/how-make-function-in-go-handle-optional-parameter", "closed_reason": "Duplicate", "title": "How make function in Go handle optional parameter?", "body": "<p>As we know that Go doesn't support optional parameters, but, while working with channels and more specifically buffered channels I come to the realisation that <code>make</code> function do accept an optional parameter for buffer size. I'm little bit of confused if Go team doesn't like optional parameter then why they had supported a function which is so frequently used with this anti-pattern?</p>\n\n<p>Well, to not deviate from the original question much, can anyone help explaining how, under the hood, this works?</p>\n"}, {"tags": ["go", "amazon-s3", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1545816779, "post_id": 53928386, "comment_id": 94700873, "body": "Ask the profiler: <a href=\"https://golang.org/pkg/net/http/pprof/#pkg-overview\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/pprof/#pkg-overview</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1545837310, "post_id": 53928386, "comment_id": 94707852, "body": "There no reason to start 70 concurrent streams from S3. Even if it\u2019s not the root problem, it\u2019s making your performance far worse than it could be."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1545837734, "post_id": 53928386, "comment_id": 94707984, "body": "If you want to see why it\u2019s blocked, start by looking at the stack trace while it\u2019s blocked."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2896821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ffac1362add2b7f4f14c4f110942af?s=128&d=identicon&r=PG&f=1", "display_name": "user2896821", "link": "https://stackoverflow.com/users/2896821/user2896821"}, "edited": false, "score": 0, "creation_date": 1545818278, "post_id": 53928590, "comment_id": 94701423, "body": "Thanks for your info. I tried but unfortunately, the program is still stucked. This time when it paused, max utilization of 1 cpu is only 75%, the other 3 cpu is low, around 50%, all less then 100%...I&#39;m still confused what is wrong with it =.="}, {"owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "reply_to_user": {"reputation": 107, "user_id": 2896821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ffac1362add2b7f4f14c4f110942af?s=128&d=identicon&r=PG&f=1", "display_name": "user2896821", "link": "https://stackoverflow.com/users/2896821/user2896821"}, "edited": false, "score": 0, "creation_date": 1545822822, "post_id": 53928590, "comment_id": 94703059, "body": "There is some parameters to play with. Block size etc."}], "tags": [], "owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "is_accepted": false, "score": 0, "last_activity_date": 1545807931, "creation_date": 1545807931, "answer_id": 53928590, "question_id": 53928386, "link": "https://stackoverflow.com/questions/53928386/why-goroutine-pause-for-several-minutes/53928590#53928590", "title": "Why goroutine pause for several minutes", "body": "<p>Golang gzip library read file in one goroutine, </p>\n\n<p>So big file occupy the cpu for long time on 100%. Use <a href=\"https://github.com/klauspost/pgzip\" rel=\"nofollow noreferrer\">pzip</a> instead.  </p>\n\n<p>Use as a replacement for gzip, exchange</p>\n\n<pre><code>  import \"compress/gzip\" \n</code></pre>\n\n<p>with </p>\n\n<pre><code> import gzip \"github.com/klauspost/pgzip\".\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2896821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7ffac1362add2b7f4f14c4f110942af?s=128&d=identicon&r=PG&f=1", "display_name": "user2896821", "link": "https://stackoverflow.com/users/2896821/user2896821"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 290, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545807931, "creation_date": 1545806751, "last_edit_date": 1545807260, "question_id": 53928386, "link": "https://stackoverflow.com/questions/53928386/why-goroutine-pause-for-several-minutes", "title": "Why goroutine pause for several minutes", "body": "<p>I have a task written in GO to read .gz files from AWS S3, size of each .gz file will be <strong>20M</strong>.</p>\n\n<p>Each goroutine will download a .gz file from s3 to local disk, then read its content line by line via gzip.NewReader.</p>\n\n<p>When task(goroutine) count exceeds 70, 67 goroutine will finish their operations successfully. But the remain goroutine then will be <strong><em>paused</em></strong> for several minutes. </p>\n\n<p>At the moment it paused, I saw CPU is 100%, and then, CPU will low down to 0.2%(4CPU, 16G Memory) to stay for several minutes.</p>\n\n<p><strong><em>Question</em></strong>: I'm confused that, why goroutines doing nothing at that time with CPU quite low? What may cause this?</p>\n\n<pre><code>Test results:\n60 goroutines, it will finish successfully in 27 seconds;\n70 goroutines, it will finish successfully in 30s;\n80 goroutines, 77 of them will finish successfully in 30s, but the remaining 3 will **pause 4 minutes**, then restart and finish in 10s\n</code></pre>\n\n<p>Code as below:</p>\n\n<p>Main goroutine:</p>\n\n<pre><code>    func main() {\n      runtime.GOMAXPROCS(runtime.NumCPU()*2)\n      chs := make([]chan string, 70)\n      for i:=min; i&lt;max; i++ {\n          chs[i] = make(chan string, 1)\n          go readobj.Reads3obj(i, chs[i])\n      }\n      for _, ch := range chs {\n        fmt.Println(&lt;-ch)\n      }\n    }\n</code></pre>\n\n<p>ReadObject:</p>\n\n<pre><code>func Reads3obj(s3KeyName, ch chan string) {\n    sess, err := session.NewSession(&amp;aws.Config{\n              Region: aws.String(\"x\"),\n              Credentials: credentials.NewStaticCredentials(\"x\", \"x\", \"\")},)\n\n    downloader := s3manager.NewDownloader(sess)\n\n    //create a zipFile to download from S3 to local\n    zipFile, err := os.Create(zipname)\n\n    //download .gz file from S3\n    n, err := downloader.Download(zipFile, &amp;s3.GetObjectInput{\n        Bucket: aws.String(bucket),\n        Key:    aws.String(s3KeyName),\n    })\n    //create a file reader\n    fileReader, err := os.Open(zipFile)\n\n    //create a gzip reader      \n    gzipReader, err := gzip.NewReader(fileReader)\n\n    //create a buffered reader\n    buf := bufio.NewReader(gzipReader)\n\n    //read zip file line by line\n    for line, isPrefix, err := []byte{0}, false, error(nil); len(line) &gt; 0 &amp;&amp; err == nil; {\n        line, isPrefix, err = buf.ReadLine()\n       //insert line to ES\n    }\n  }\n</code></pre>\n\n<p>EDITED:\nWhen it paused, opened file count is quite small, so I think the opened files didn't exceeds most and it won't matters. Because:</p>\n\n<p>The output of <code>ll /proc/PID/fd</code> is</p>\n\n<pre><code>zc@ip-xxx:/proc/18059/fd$ ll\ntotal 0\ndr-x------ 2 zc zc  0 Dec 26 06:50 ./\ndr-xr-xr-x 9 zc zc  0 Dec 26 06:50 ../\nlrwx------ 1 zc zc 64 Dec 26 06:50 0 -&gt; /dev/pts/0\nlrwx------ 1 zc zc 64 Dec 26 06:50 1 -&gt; /dev/pts/0\nlrwx------ 1 zc zc 64 Dec 26 06:50 12 -&gt; \n/home/zc/75.gz\nlrwx------ 1 zc zc 64 Dec 26 06:50 2 -&gt; /dev/pts/0\nlrwx------ 1 zc zc 64 Dec 26 06:50 21 -&gt; \n/home/zc/78.gz\nlrwx------ 1 zc zc 64 Dec 26 06:50 253 -&gt; socket:[76054]\nlrwx------ 1 zc zc 64 Dec 26 06:50 280 -&gt; socket:[77064]\nlrwx------ 1 zc zc 64 Dec 26 06:50 47 -&gt; \n/home/zc/58.gz\nlrwx------ 1 zc zc 64 Dec 26 06:50 65 -&gt; anon_inode:[eventpoll]\nlrwx------ 1 zc zc 64 Dec 26 06:50 93 -&gt; socket:[75984]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545832118, "post_id": 53928259, "comment_id": 94706195, "body": "<i>Questions asking us to recommend or find a book, tool, software library, tutorial or other off-site resource are off-topic for Stack Overflow as they tend to attract opinionated answers and spam.</i>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1545815090, "last_edit_date": 1545815090, "creation_date": 1545814625, "answer_id": 53929700, "question_id": 53928259, "link": "https://stackoverflow.com/questions/53928259/alternative-or-github-com-gogo-protobuf-parser-package/53929700#53929700", "title": "Alternative or github.com/gogo/protobuf/parser package", "body": "<p>You are using unofficial and old documentation from Libraries.io. </p>\n\n<p>Use official, up-to-date documentation, and follow the installation intructions.</p>\n\n<p>Protocol Buffers for Go with Gadgets: \n<a href=\"https://github.com/gogo/protobuf\" rel=\"nofollow noreferrer\">https://github.com/gogo/protobuf</a></p>\n\n<p><a href=\"https://github.com/gogo/protobuf#getting-started\" rel=\"nofollow noreferrer\">Getting Started</a></p>\n\n<p><a href=\"https://github.com/gogo/protobuf#installation\" rel=\"nofollow noreferrer\">Installation</a></p>\n"}, {"tags": [], "owner": {"reputation": 1650, "user_id": 4399634, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001746244457/picture?type=large", "display_name": "frankegoesdown", "link": "https://stackoverflow.com/users/4399634/frankegoesdown"}, "is_accepted": false, "score": 0, "last_activity_date": 1545815266, "creation_date": 1545815266, "answer_id": 53929816, "question_id": 53928259, "link": "https://stackoverflow.com/questions/53928259/alternative-or-github-com-gogo-protobuf-parser-package/53929816#53929816", "title": "Alternative or github.com/gogo/protobuf/parser package", "body": "<p>you can use default protobuf - <a href=\"https://github.com/golang/protobuf\" rel=\"nofollow noreferrer\">https://github.com/golang/protobuf</a> if you have errors in your protobuffers it says you after generating </p>\n\n<p>all you need about usage and installation you can read in readme <a href=\"https://github.com/golang/protobuf/blob/master/README.md\" rel=\"nofollow noreferrer\">https://github.com/golang/protobuf/blob/master/README.md</a></p>\n"}], "owner": {"reputation": 1151, "user_id": 4334376, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4f5bfa3ae70f64e9bdf5912aced4621c?s=128&d=identicon&r=PG&f=1", "display_name": "irvifa", "link": "https://stackoverflow.com/users/4334376/irvifa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1545815266, "creation_date": 1545805854, "question_id": 53928259, "link": "https://stackoverflow.com/questions/53928259/alternative-or-github-com-gogo-protobuf-parser-package", "title": "Alternative or github.com/gogo/protobuf/parser package", "body": "<p>I'm searching for a package to parse a protobuf file and then found this [1]:</p>\n\n<pre><code>github.com/gogo/protobuf/parser\n</code></pre>\n\n<p>However, when I tried to do <em>go get github.com/gogo/protobuf/parser</em> there was no such package. Anyone knows another alternative of this package?</p>\n\n<p>[1] <a href=\"https://libraries.io/go/github.com%2Fgogo%2Fprotobuf%2Fparser\" rel=\"nofollow noreferrer\">https://libraries.io/go/github.com%2Fgogo%2Fprotobuf%2Fparser</a></p>\n"}, {"tags": ["multithreading", "go"], "comments": [{"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 1, "creation_date": 1545806523, "post_id": 53928228, "comment_id": 94697853, "body": "Check this out <a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">gobyexample.com/worker-pools</a>"}, {"owner": {"reputation": 170, "user_id": 6800210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SzwJ5.jpg?s=128&g=1", "display_name": "mos", "link": "https://stackoverflow.com/users/6800210/mos"}, "reply_to_user": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 0, "creation_date": 1545807280, "post_id": 53928228, "comment_id": 94698060, "body": "I have already checked this example, but still is not clear for me, would you apply my case to this example ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1545811378, "post_id": 53928228, "comment_id": 94699211, "body": "See <a href=\"https://stackoverflow.com/questions/38170852/is-this-an-idiomatic-worker-thread-pool-in-go/38172204#38172204\">Is this an idiomatic worker thread pool in Go?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 170, "user_id": 6800210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SzwJ5.jpg?s=128&g=1", "display_name": "mos", "link": "https://stackoverflow.com/users/6800210/mos"}, "edited": false, "score": 0, "creation_date": 1545823252, "post_id": 53931326, "comment_id": 94703190, "body": "I have tried the gobyexample.com example, but still not reach more than ~14MBit/s , here is my program:  <a href=\"https://play.golang.org/p/mmT9gzz08Y0\" rel=\"nofollow noreferrer\">play.golang.org/p/mmT9gzz08Y0</a>"}, {"owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "reply_to_user": {"reputation": 170, "user_id": 6800210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SzwJ5.jpg?s=128&g=1", "display_name": "mos", "link": "https://stackoverflow.com/users/6800210/mos"}, "edited": false, "score": 0, "creation_date": 1545824215, "post_id": 53931326, "comment_id": 94703522, "body": "ow, you need use something for load testing such as jMeter or Yandex Tank"}, {"owner": {"reputation": 170, "user_id": 6800210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SzwJ5.jpg?s=128&g=1", "display_name": "mos", "link": "https://stackoverflow.com/users/6800210/mos"}, "edited": false, "score": 0, "creation_date": 1545824485, "post_id": 53931326, "comment_id": 94703594, "body": "yes, you are right, I want to test the performance for both the generator and receiver , and this code is about generator, I wanna generate huge traffic toward the receiver , I have used different ways, still not reached more than 14MBit/s on the receiver side, I wanna reach 700MBit/s"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545832753, "post_id": 53931326, "comment_id": 94706414, "body": "Relevant detail should be in the body of an answer, not at an external link: <a href=\"https://stackoverflow.com/help/how-to-answer\">stackoverflow.com/help/how-to-answer</a>"}], "tags": [], "owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "is_accepted": false, "score": 0, "last_activity_date": 1545832990, "last_edit_date": 1545832990, "creation_date": 1545823007, "answer_id": 53931326, "question_id": 53928228, "link": "https://stackoverflow.com/questions/53928228/multi-worker-go-program/53931326#53931326", "title": "multi worker Go program", "body": "<p>If i am understood your wish right then try to play here <a href=\"https://play.golang.org/p/q_r8PATh6_U\" rel=\"nofollow noreferrer\">https://play.golang.org/p/q_r8PATh6_U</a> </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\nfunc genFakeData(wg *sync.WaitGroup, i int) {\n  fmt.Println(\"A =\",i + 1)\n  wg.Done()\n}\n\nfunc main() {\n   var wg sync.WaitGroup\n   for i:=0 ; i&lt;50 ; i++ {\n    wg.Add(1)\n    go genFakeData(&amp;wg, i)\n   }\n   wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 170, "user_id": 6800210, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SzwJ5.jpg?s=128&g=1", "display_name": "mos", "link": "https://stackoverflow.com/users/6800210/mos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 49, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545832990, "creation_date": 1545805645, "question_id": 53928228, "link": "https://stackoverflow.com/questions/53928228/multi-worker-go-program", "title": "multi worker Go program", "body": "<p>I have a simple program that will generate random string and numbers and put it in specific format:</p>\n\n<p>output:\n<code>A=SKEK673KJK B=67235 C=PDCNE39JSWL</code></p>\n\n<p>I have 4 func including main:</p>\n\n<pre><code>func genRandInt() string {\n  //return string(randInt)\n}\n\nfunc genRandStr() string {\n  //return (randStr)\n}\n\nfunc genFakeData() string {\n  fmt.Println(\"A=\" + genRanStr() + genRandInt().....etc)\n}\n\nfunc main() {\n  genFackeData()\n}\n</code></pre>\n\n<p>so far the program working fine, and I am executing it via bash loop in order to run it many time in order to generate huge traffic on the server, but I couldn't reach the generated data as I was expected, what I need to run <code>genFackeData()</code> in many worker (e.g 50 worker) how I can achieve that in GO ? </p>\n\n<blockquote>\n  <p>(by the way this is very simple version of my program, to not make\n  complicated I have written the simple sample of what I need)</p>\n</blockquote>\n"}, {"tags": ["go", "data-structures", "binary-tree"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545797128, "post_id": 53927050, "comment_id": 94696018, "body": "<a href=\"https://en.wikipedia.org/wiki/Algorithms_%2B_Data_Structures_%3D_Programs\" rel=\"nofollow noreferrer\">Algorithms + Data Structures = Programs, Niklaus Wirth.</a> You provided your algorithms. Where are your data structures?"}], "answers": [{"tags": [], "owner": {"reputation": 4669, "user_id": 63814, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/607eab54ab44ecd7ebefa443e1925596?s=128&d=identicon&r=PG", "display_name": "MahlerFive", "link": "https://stackoverflow.com/users/63814/mahlerfive"}, "is_accepted": false, "score": 0, "last_activity_date": 1545802361, "creation_date": 1545802361, "answer_id": 53927809, "question_id": 53927050, "link": "https://stackoverflow.com/questions/53927050/golang-binarytree-preorder-return-value-not-right/53927809#53927809", "title": "golang binaryTree Preorder return value not right", "body": "<p>The problem stems from you passing the <code>result</code> slice to the recursive calls. Because of this, each recursive call is going to append the results from the node above. You expect <code>1 2 4 3</code>, but you get <code>1</code> from the first call, then <code>1 2</code> (instead of just <code>2</code>) from the second call, then <code>1 2 4</code> (instead of just <code>4</code>) from the third call.</p>\n\n<p>To fix this you can just remove passing the result slice to the recursive function. The function should only be creating a result slice for the node it's on plus it's descendant trees, it should not need to know what the results from the parent are.</p>\n"}, {"tags": [], "owner": {"reputation": 201, "user_id": 10814080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IHSUhxzo9Fs/AAAAAAAAAAI/AAAAAAAAAA8/RCIP5dhhB4A/photo.jpg?sz=128", "display_name": "Bob Fred", "link": "https://stackoverflow.com/users/10814080/bob-fred"}, "is_accepted": true, "score": 0, "last_activity_date": 1545818210, "last_edit_date": 1545818210, "creation_date": 1545817530, "answer_id": 53930247, "question_id": 53927050, "link": "https://stackoverflow.com/questions/53927050/golang-binarytree-preorder-return-value-not-right/53930247#53930247", "title": "golang binaryTree Preorder return value not right", "body": "<blockquote>\n  <p>Slices hold references to an underlying array, and if you assign one\n  slice to another, both refer to the same array. If a function takes a\n  slice argument, changes it makes to the elements of the slice will be\n  visible to the caller</p>\n</blockquote>\n\n<p>see slices in Effective Go <a href=\"https://golang.org/doc/effective_go.html#slices\" rel=\"nofollow noreferrer\">Slices</a></p>\n\n<p><strong>PreorderRecursion</strong> shouldn't take in a slice and change it. Here's an approach. </p>\n\n<pre><code>func PreorderRecursion(root *TreeNode) []int {\n    if root == nil {\n        return nil\n    }\n    result := append([]int{}, root.Val)\n    res1 := PreorderRecursion(root.Left)\n    res2 := PreorderRecursion(root.Right)\n    result = append(result, res1...)\n    result = append(result, res2...)\n    return result\n}\n</code></pre>\n"}], "owner": {"reputation": 151, "user_id": 10527936, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10faded8ee52ba8dcdf52cd40204f52c?s=128&d=identicon&r=PG&f=1", "display_name": "faker", "link": "https://stackoverflow.com/users/10527936/faker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 0, "accepted_answer_id": 53930247, "answer_count": 2, "score": 1, "last_activity_date": 1545818210, "creation_date": 1545793682, "last_edit_date": 1545801201, "question_id": 53927050, "link": "https://stackoverflow.com/questions/53927050/golang-binarytree-preorder-return-value-not-right", "title": "golang binaryTree Preorder return value not right", "body": "<p>I want to return the values of all nodes as an array, but the return value is wrong.</p>\n\n<pre><code>type TreeNode struct {\n    Left  *TreeNode\n    Right *TreeNode\n    Val   int\n}\n\ntype BinaryTree struct {\n    Root *TreeNode\n}\n    func PreorderRecursion(root *TreeNode, result []int) []int {\n    if root == nil {\n        return nil\n    }\n    result = append(result, root.Val)\n    res1 :=PreorderRecursion(root.Left,result)\n    res2 :=PreorderRecursion(root.Right,result)\n    result = append(result,res1...)\n    result = append(result,res2...)\n    return result\n}\n\nfunc TestBinaryTree_PreOrder(t *testing.T) {\n    tree := BinaryTree{}\n    tree.Root = &amp;TreeNode{Val: 1}\n    tree.Root.Left = &amp;TreeNode{Val: 2}\n    tree.Root.Right = &amp;TreeNode{Val: 3}\n\n    tree.Root.Left.Left = &amp;TreeNode{Val: 4}\n    var result []int\n    result =PreorderRecursion(tree.Root,result)\n    fmt.Println(result,\"----\")\n}\n</code></pre>\n\n<p>right result should be : 1 2 4 3 </p>\n\n<p>but i get this:[1 1 2 1 2 4 1 3] </p>\n"}, {"tags": ["http", "pointers", "go"], "comments": [{"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1545790914, "post_id": 53926818, "comment_id": 94695253, "body": "can you copy the SitemapIndex to check ?"}, {"owner": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "reply_to_user": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1545791026, "post_id": 53926818, "comment_id": 94695264, "body": "Thanks, I just edited the post"}, {"owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "edited": false, "score": 7, "creation_date": 1545791389, "post_id": 53926818, "comment_id": 94695322, "body": "You ignored errors this way nobody can findout the problem. Instead of discarding the errors handle them. like this. resp,er := http.Get(&quot;your address&quot;);if err!= nil { log.Fataln(err) }"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1545932293, "post_id": 53926818, "comment_id": 94736079, "body": "Cross posted: <a href=\"https://forum.golangbridge.org/t/im-a-beginner-i-get-errors-parsing-a-url-with-http-get/11948/1\" rel=\"nofollow noreferrer\">forum.golangbridge.org/t/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "edited": false, "score": 0, "creation_date": 1545829691, "post_id": 53927083, "comment_id": 94705362, "body": "Thanks for the answer. So I printed the error as I was told to do, and it said <code>first path segment in URL cannot contain colon</code>. The response is <code>&lt;nil&gt;</code> btw. Do you have an idea why ?"}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "reply_to_user": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "edited": false, "score": 0, "creation_date": 1545829793, "post_id": 53927083, "comment_id": 94705391, "body": "I made test code with goroutine but you may have to try it without goroutine . debug each charater in print to see if any additional char is added with location url."}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "reply_to_user": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "edited": false, "score": 0, "creation_date": 1545830209, "post_id": 53927083, "comment_id": 94705525, "body": "The error says that something wrong with URL that needs to be look into .  How we are wrting to buffer or stiring , needed to make sure it does not have any other chars than the url itself"}, {"owner": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "edited": false, "score": 0, "creation_date": 1545830234, "post_id": 53927083, "comment_id": 94705532, "body": "I tried it, added <code>runtime.Gosched()</code> in the end, but it didn&#39;t solve the problem. What does this line do btw ?"}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "reply_to_user": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "edited": false, "score": 0, "creation_date": 1545830395, "post_id": 53927083, "comment_id": 94705576, "body": "ok , what i am suggesting is , look at the URL (location url ) in range loop and check if it is added with any additional quotes or something else . The runtime.Goshed() call make sure the main program dont quit until all goroutine finishes off"}, {"owner": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "edited": false, "score": 0, "creation_date": 1545830424, "post_id": 53927083, "comment_id": 94705586, "body": "As for the url, the err shows me the url that Golang is using. Here&#39;s the error : <code>https:&#47;&#47;www.washingtonpost.com&#47;news-sitemaps&#47;politics.xml : first path segment in URL cannot contain colon</code>. So the url seems ok..."}, {"owner": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "reply_to_user": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1545830494, "post_id": 53927083, "comment_id": 94705605, "body": "Let us <a href=\"https://chat.stackoverflow.com/rooms/185788/discussion-between-tomfl-and-cslrnr\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 1, "last_activity_date": 1545794515, "last_edit_date": 1545794515, "creation_date": 1545794107, "answer_id": 53927083, "question_id": 53926818, "link": "https://stackoverflow.com/questions/53926818/invalid-memory-address-in-golang-using-ioutil-readall/53927083#53927083", "title": "&quot;Invalid memory address&quot; in Golang using ioutil.ReadAll()", "body": "<p>As Mostafa mentioned , you have to handle the errors properly. There is no try catch in golang. \nSomething like this i have tired. \natleast it catpures url error is in liteIde </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n    \"runtime\"\n)\n\ntype SitemapIndex struct {\n    Locations []string `xml:\"sitemap&gt;loc\"`\n}\n\nfunc main() {\n    var s SitemapIndex\n\n    resp, err := http.Get(\"https://www.washingtonpost.com/news-sitemaps/index.xml\")\n    if err != nil {\n        fmt.Println(\"Unable to get the url \")\n        os.Exit(1)\n    }\n    bytes, _ := ioutil.ReadAll(resp.Body)\n    defer resp.Body.Close()\n    //fmt.Println(string(bytes))\n    xml.Unmarshal(bytes, &amp;s)\n    //fmt.Println(len(s.Locations))\n\n    for _, Location := range s.Locations {\n        //fmt.Println(Location)\n        go func() {\n            r, err := http.Get(Location)\n            if err != nil {\n                fmt.Println(\"Error occured \", err)\n                return\n            }\n            bytes, err := ioutil.ReadAll(resp.Body)\n            if err != nil {\n                fmt.Printf(\"Error in reading :\", err)\n            }\n            fmt.Println(string(bytes))\n            r.Body.Close()\n        }()\n    }\n    runtime.Gosched()\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1545851471, "last_edit_date": 1545851471, "creation_date": 1545795533, "answer_id": 53927193, "question_id": 53926818, "link": "https://stackoverflow.com/questions/53926818/invalid-memory-address-in-golang-using-ioutil-readall/53927193#53927193", "title": "&quot;Invalid memory address&quot; in Golang using ioutil.ReadAll()", "body": "<p><strong>The First Rule of Go: Check for errors.</strong></p>\n\n<hr>\n\n<blockquote>\n  <p>When a function call returns an error, it\u2019s the caller\u2019s\n  responsibility to check it and take appropriate action.</p>\n  \n  <p>Usually when a function returns a non-nil error, its other results are\n  undefined and should be ignored.</p>\n  \n  <p><a href=\"https://www.gopl.io/\" rel=\"nofollow noreferrer\">The Go Programming Language, Alan A. A. Donovan and  Brian W.\n  Kernighan</a></p>\n</blockquote>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>if err != nil {\n    fmt.Printf(\"%q\\n\", Location) // debug error\n    fmt.Println(resp)            // debug error\n    fmt.Println(err)\n    return\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>\"\\nhttps://www.washingtonpost.com/news-sitemaps/politics.xml\\n\"\n&lt;nil&gt;\nparse \nhttps://www.washingtonpost.com/news-sitemaps/politics.xml\n: first path segment in URL cannot contain colon\n</code></pre>\n\n<p>If you don't catch this error and keep going with <code>resp == nil</code> then</p>\n\n<pre><code>bytes, err := ioutil.ReadAll(resp.Body)\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n</code></pre>\n\n<hr>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"strings\"\n)\n\ntype SitemapIndex struct {\n    Locations []string `xml:\"sitemap&gt;loc\"`\n}\n\nfunc main() {\n    var s SitemapIndex\n\n    resp, err := http.Get(\"https://www.washingtonpost.com/news-sitemaps/index.xml\")\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    bytes, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    err = resp.Body.Close()\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    err = xml.Unmarshal(bytes, &amp;s)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n\n    for _, Location := range s.Locations {\n        resp, err := http.Get(Location)\n        if err != nil {\n            fmt.Printf(\"%q\\n\", Location) // debug error\n            fmt.Println(resp)            // debug error\n            fmt.Println(err)\n            return\n        }\n        bytes, err := ioutil.ReadAll(resp.Body)\n        if err != nil {\n            fmt.Println(err)\n            return\n        }\n        fmt.Println(len(bytes))\n        err = resp.Body.Close()\n        if err != nil {\n            fmt.Println(err)\n            return\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "is_accepted": true, "score": 2, "last_activity_date": 1545847221, "creation_date": 1545847221, "answer_id": 53935449, "question_id": 53926818, "link": "https://stackoverflow.com/questions/53926818/invalid-memory-address-in-golang-using-ioutil-readall/53935449#53935449", "title": "&quot;Invalid memory address&quot; in Golang using ioutil.ReadAll()", "body": "<p>Okay, so I've found the reason for my problem and how to solve it. The problem was that the url had some newlines I didn't see.</p>\n\n<p>So instead of doing this :</p>\n\n<pre><code>resp, err := http.Get(Location)\n</code></pre>\n\n<p>I did this :</p>\n\n<pre><code>resp, err := http.Get(strings.TrimSpace(Location))\n</code></pre>\n\n<p>That solved it.</p>\n"}], "owner": {"reputation": 540, "user_id": 4266924, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/gdlAn.png?s=128&g=1", "display_name": "tomfl", "link": "https://stackoverflow.com/users/4266924/tomfl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 1, "accepted_answer_id": 53935449, "answer_count": 3, "score": 0, "last_activity_date": 1545851471, "creation_date": 1545790095, "last_edit_date": 1545791006, "question_id": 53926818, "link": "https://stackoverflow.com/questions/53926818/invalid-memory-address-in-golang-using-ioutil-readall", "title": "&quot;Invalid memory address&quot; in Golang using ioutil.ReadAll()", "body": "<p>I'm currently learning Golang (and so far I love it). But unfortunately, I've been stuck for a couple hours and I don't seem to find any solution to my problem on Google.</p>\n\n<p>So here's my problem. I have this piece of code (from a tutorial) :</p>\n\n<pre><code>func main() {\n    var s SitemapIndex\n\n    resp, _ := http.Get(\"https://www.washingtonpost.com/news-sitemaps/index.xml\")\n    bytes, _ := ioutil.ReadAll(resp.Body)\n    resp.Body.Close()\n\n    xml.Unmarshal(bytes, &amp;s)\n\n    for _, Location := range s.Locations {\n        resp, _ := http.Get(Location)\n        ioutil.ReadAll(resp.Body)\n\n    }\n\n}\n</code></pre>\n\n<p>I know, my code is incomplete but that's because I deleted the parts that were not causing the problem to make it more readable on Stackoverflow.</p>\n\n<p>So when I get the content of <code>Location</code> and try to process the data with <code>ioutil.ReadAll()</code> I get this error mentioning a pointer :</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x40 pc=0x1210a69]\n\ngoroutine 1 [running]:\nmain.main()\n    /Users/tom/Developer/Go/src/news/index.go:23 +0x159\nexit status 2\n</code></pre>\n\n<p>I really don't understand this error, no matter how much I look into it. I tried to pull the error from <code>ioutil.ReadAll(resp.Body)</code> by doing <code>_, e := ioutil.ReadAll(resp.Body)</code> and then printing <code>e</code>, but doing that throws <em>another</em> error...</p>\n\n<p>I read somewhere that it can be because the body returned to me has errors, but it's working fine in the tutorial.</p>\n\n<p>Hopefully you guys will have a solution for me. Thanks.</p>\n\n<p>EDIT : Here are the structs I have defined :</p>\n\n<pre><code>type SitemapIndex struct {\n    Locations []string `xml:\"sitemap&gt;loc\"`\n}\n\ntype News struct {\n    Titles []string `xml:\"url&gt;news&gt;title\"`\n    Keywords []string `xml:\"url&gt;news&gt;keywords\"`\n    Locations []string `xml:\"url&gt;loc\"`\n}\n\ntype NewsMap struct {\n    Keyword string\n    Location string\n}\n</code></pre>\n"}, {"tags": ["go", "visual-studio-code"], "comments": [{"owner": {"reputation": 169, "user_id": 1945707, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rsSXz.jpg?s=128&g=1", "display_name": "Tom&#225;s Gonzalez Dowling", "link": "https://stackoverflow.com/users/1945707/tom%c3%a1s-gonzalez-dowling"}, "edited": false, "score": 0, "creation_date": 1545780566, "post_id": 53925903, "comment_id": 94694076, "body": "Do you have delve installed? this is the official docs: <a href=\"https://github.com/Microsoft/vscode-go/wiki/Debugging-Go-code-using-VS-Code\" rel=\"nofollow noreferrer\">github.com/Microsoft/vscode-go/wiki/&hellip;</a>"}, {"owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "edited": false, "score": 0, "creation_date": 1545797502, "post_id": 53925903, "comment_id": 94696059, "body": "I use liteIDE which is golang specific , F5 works very well. I think you have configure either delve or gdb with vscode"}], "owner": {"reputation": 108, "user_id": 9068531, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/21d3f8ac5b6fee2f933c60be6a3ee9e4?s=128&d=identicon&r=PG&f=1", "display_name": "R.K", "link": "https://stackoverflow.com/users/9068531/r-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 356, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1545775435, "creation_date": 1545775435, "question_id": 53925903, "link": "https://stackoverflow.com/questions/53925903/vscode-golang-run-script-with-2-files", "title": "vsCode golang run script with 2 files", "body": "<p>im pretty new to vsCode and golang.\nim trying to run using vsCode a script \"Main.go\" and the script calls for a function in \"function.go\" that returns an integer</p>\n\n<p>when i run go using command console (go run main.go function.go) there isnt any problem but when i try to run it using vsCode debugger (F5 or ctrl+F5) it wont work.</p>\n\n<p>wanted to know if there's any way to fix it using the launch.json file or settings?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1545773032, "post_id": 53925271, "comment_id": 94692920, "body": "The interface is named <code>Conn</code>, which is distinct from the type <code>conn</code> (lowercase)."}], "answers": [{"tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": false, "score": 2, "last_activity_date": 1545768336, "creation_date": 1545768336, "answer_id": 53925313, "question_id": 53925271, "link": "https://stackoverflow.com/questions/53925271/why-cant-i-use-conn-ok-from-net-go/53925313#53925313", "title": "Why can&#39;t I use conn.ok() from net.go?", "body": "<p>From Go document :  </p>\n\n<blockquote>\n  <p>An identifier may be exported to permit access to it from another\n  package. <strong>An identifier is exported if the first character of the\n  identifier's name is a Unicode upper case letter</strong></p>\n</blockquote>\n\n<p>So , ok function is not exported and you can't access it outside of net package.</p>\n"}, {"tags": [], "owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "is_accepted": false, "score": 2, "last_activity_date": 1545769316, "creation_date": 1545769316, "answer_id": 53925398, "question_id": 53925271, "link": "https://stackoverflow.com/questions/53925271/why-cant-i-use-conn-ok-from-net-go/53925398#53925398", "title": "Why can&#39;t I use conn.ok() from net.go?", "body": "<p>Go does not use public/private keywords for visibility of an identifier. If the initial character is an upper case letter, the identifier is exported(public); otherwise it is not:</p>\n\n<ul>\n<li>upper case initial letter: Name is visible to clients of package</li>\n<li>otherwise: name (or _Name) is not visible to clients of package</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 550, "user_id": 3518621, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/bf3b0c525ec4ad5c29864f230486dea2?s=128&d=identicon&r=PG&f=1", "display_name": "cslrnr", "link": "https://stackoverflow.com/users/3518621/cslrnr"}, "is_accepted": false, "score": 0, "last_activity_date": 1545795253, "creation_date": 1545795253, "answer_id": 53927169, "question_id": 53925271, "link": "https://stackoverflow.com/questions/53925271/why-cant-i-use-conn-ok-from-net-go/53927169#53927169", "title": "Why can&#39;t I use conn.ok() from net.go?", "body": "<p>There is no field or method like ok in net.Conn that what the error says and that is correct. \nwhen you try to read and write into the conn , you would get err and number of bytes read or write it into the connection.</p>\n"}], "owner": {"reputation": 1, "user_id": 10832877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6a6dfc43a3318871709c85d922b391df?s=128&d=identicon&r=PG&f=1", "display_name": "idiocache", "link": "https://stackoverflow.com/users/10832877/idiocache"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "answer_count": 3, "score": -3, "last_activity_date": 1545795253, "creation_date": 1545767866, "question_id": 53925271, "link": "https://stackoverflow.com/questions/53925271/why-cant-i-use-conn-ok-from-net-go", "title": "Why can&#39;t I use conn.ok() from net.go?", "body": "<p>I'm coming at Golang from a Python background and I am trying to wrap my head around various new concepts.</p>\n\n<p>One thing I have come across is this function in net.go:</p>\n\n<pre><code>func (c *conn) ok() bool { return c != nil &amp;&amp; c.fd != nil }\n</code></pre>\n\n<p>This function is called by multiple net.go methods, e.g. conn.Read:</p>\n\n<pre><code>// Read implements the Conn Read method.\nfunc (c *conn) Read(b []byte) (int, error) {     \nif !c.ok() {        \n    return 0, syscall.EINVAL\n}\n</code></pre>\n\n<p>I am trying to understand how the <code>ok()</code> method can be called on conn, despite the fact that <code>ok()</code> does <strong>not</strong> appear to be an interface of conn.</p>\n\n<p>Certainly I do not seem to be able to call <code>ok()</code> from my client code:</p>\n\n<pre><code>func main() {\nconn, err := net.Dial(\"tcp\", \"www.reddit.com:80\")\nif err != nil {\n    os.Exit(-1)\n}\nfmt.Println(&amp;conn.ok())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>./server.go:14:22: conn.ok undefined (type net.Conn has no field or method ok)\n</code></pre>\n\n<p>Any pointers appreciated...</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545765911, "post_id": 53924984, "comment_id": 94691637, "body": "Something like this <a href=\"https://play.golang.org/p/0og46FV230U\" rel=\"nofollow noreferrer\">play.golang.org/p/0og46FV230U</a> ?"}, {"owner": {"reputation": 1198, "user_id": 1406177, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9d9dd48e5fd672255278b435bd63b661?s=128&d=identicon&r=PG", "display_name": "user1406177", "link": "https://stackoverflow.com/users/1406177/user1406177"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545767172, "post_id": 53924984, "comment_id": 94691909, "body": "I added a playground giving more details"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1545781216, "last_edit_date": 1545781216, "creation_date": 1545769666, "answer_id": 53925429, "question_id": 53924984, "link": "https://stackoverflow.com/questions/53924984/bool-array-to-byte-array/53925429#53925429", "title": "Bool array to byte array", "body": "<p>For example, <code>boolsToBytes</code>, the inverse (exactly the opposite) of <code>bytesToBools</code>,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc boolsToBytes(t []bool) []byte {\n    b := make([]byte, (len(t)+7)/8)\n    for i, x := range t {\n        if x {\n            b[i/8] |= 0x80 &gt;&gt; uint(i%8)\n        }\n    }\n    return b\n}\n\nfunc bytesToBools(b []byte) []bool {\n    t := make([]bool, 8*len(b))\n    for i, x := range b {\n        for j := 0; j &lt; 8; j++ {\n            if (x&lt;&lt;uint(j))&amp;0x80 == 0x80 {\n                t[8*i+j] = true\n            }\n        }\n    }\n    return t\n}\n\nfunc main() {\n    b := []byte{123, 255}\n    fmt.Println(b)\n    t := bytesToBools(b)\n    fmt.Printf(\"%t\\n\", t)\n    b = boolsToBytes(t)\n    fmt.Println(b)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/IguJ_4cZKtA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/IguJ_4cZKtA</a></p>\n\n<p>Output:</p>\n\n<pre><code>[123 255]\n[false true true true true false true true true true true true true true true true]\n[123 255]\n</code></pre>\n\n<hr>\n\n<p>The question provides a function and asks for an inverse (does exactly the opposite) function.</p>\n\n<p>The question function algorithm is flawed, several inputs map to the same function value. Therefore, there is no unique inverse.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strconv\"\n)\n\nfunc byteArrayToBoolArray(ba []byte) []bool {\n    var s []bool\n    for _, b := range ba {\n        for _, c := range strconv.FormatUint(uint64(b), 2) {\n            s = append(s, c == []rune(\"1\")[0])\n        }\n    }\n    return s\n}\n\nfunc main() {\n    ba1 := []byte{0xF}\n    fmt.Println(byteArrayToBoolArray(ba1))\n    ba2 := []byte{0x3, 0x3}\n    fmt.Println(byteArrayToBoolArray(ba2))\n    ba3 := []byte{0x1, 0x1, 0x1, 0x1}\n    fmt.Println(byteArrayToBoolArray(ba3))\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/L9VsTtbkQZW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/L9VsTtbkQZW</a></p>\n\n<p>Output:</p>\n\n<pre><code>[true true true true]\n[true true true true]\n[true true true true]\n</code></pre>\n"}], "owner": {"reputation": 1198, "user_id": 1406177, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/9d9dd48e5fd672255278b435bd63b661?s=128&d=identicon&r=PG", "display_name": "user1406177", "link": "https://stackoverflow.com/users/1406177/user1406177"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 893, "favorite_count": 1, "accepted_answer_id": 53925429, "answer_count": 1, "score": 0, "last_activity_date": 1545820319, "creation_date": 1545765079, "last_edit_date": 1545771839, "question_id": 53924984, "link": "https://stackoverflow.com/questions/53924984/bool-array-to-byte-array", "title": "Bool array to byte array", "body": "<p>I have function to convert a byte array to a bool array representing 0s and 1s:</p>\n\n<pre><code>func byteArrayToBoolArray(ba []byte) []bool {\n    var s []bool\n\n    for _, b := range ba {\n        for _, c := range strconv.FormatUint(uint64(by), 2) {\n            s = append(s, c == []rune(\"1\")[0])\n        }\n    }\n\n    return s\n}\n</code></pre>\n\n<p>How does a function look like that does exactly the opposite, meaning converting a bool array into a byte array?</p>\n\n<p>Edit: This playground give more details how my byte array may look like: <a href=\"https://play.golang.org/p/tEDcZv-t_0Q\" rel=\"nofollow noreferrer\">https://play.golang.org/p/tEDcZv-t_0Q</a></p>\n\n<pre><code>ba := []byte{123, 255}\n</code></pre>\n"}, {"tags": ["for-loop", "go"], "answers": [{"comments": [{"owner": {"reputation": 29, "user_id": 10832596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3160a9c55023ca4d41dbd6b7f50bf5e?s=128&d=identicon&r=PG&f=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/10832596/igor"}, "edited": false, "score": 0, "creation_date": 1545760113, "post_id": 53924449, "comment_id": 94690536, "body": "aaaaah. of course. Too long behind the computer today. Thanks"}], "tags": [], "owner": {"reputation": 45031, "user_id": 213136, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/0b84a36c241e04175fcec402dac43018?s=128&d=identicon&r=PG", "display_name": "Bob Jarvis - Reinstate Monica", "link": "https://stackoverflow.com/users/213136/bob-jarvis-reinstate-monica"}, "is_accepted": true, "score": 2, "last_activity_date": 1545759928, "creation_date": 1545759928, "answer_id": 53924449, "question_id": 53924417, "link": "https://stackoverflow.com/questions/53924417/for-loop-using-uint64-wont-stop/53924449#53924449", "title": "for loop using uint64 won&#39;t stop", "body": "<p>Your loop continues while <code>i &gt;= 0</code>, but an unsigned integer is <strong>always</strong> greater than or equal to zero. Unsigned integers cannot be negative so your loop never terminates.</p>\n\n<p>Try changing <code>i</code> to <code>int64</code> and see if it behaves differently. :-)</p>\n\n<p>Best of luck.</p>\n"}], "owner": {"reputation": 29, "user_id": 10832596, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f3160a9c55023ca4d41dbd6b7f50bf5e?s=128&d=identicon&r=PG&f=1", "display_name": "Igor", "link": "https://stackoverflow.com/users/10832596/igor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 53924449, "answer_count": 1, "score": 0, "last_activity_date": 1545759928, "creation_date": 1545759681, "question_id": 53924417, "link": "https://stackoverflow.com/questions/53924417/for-loop-using-uint64-wont-stop", "title": "for loop using uint64 won&#39;t stop", "body": "<p>Is there an explanation why for loop using uint64 wouldn't stop at 0?</p>\n\n<p>I've tried the same for loop with int and it works as expected.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n  i := uint64(5)\n  for ; i&gt;=uint64(0); i-- {\n  fmt.Printf(\"step %d\\n\", i)\n  }\n}\n</code></pre>\n\n<p>I would expect this function to stop at output <code>step 0</code> but it overflows the int and continues forever with <code>step 18446744073709551615</code> and so on</p>\n"}, {"tags": ["unit-testing", "go", "dependency-injection"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545766543, "post_id": 53924183, "comment_id": 94691805, "body": "To be able to mock <code>parseJson</code> you either have to add a <code>parser</code> field to <code>ServiceInfo</code> and have <code>wrapperFN</code> call <code>s.parser.parseJson</code> instead of <code>s.parseJson</code>, or alternatively you have to turn <code>parseJson</code> into a function field that is set at runtime. Basically in Go you cannot mock methods on concrete types like <code>func (s ServiceInfo) parseJson() (string, string) {</code>, you have to use interfaces or function fields."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545766908, "post_id": 53924183, "comment_id": 94691865, "body": "@mkopriva - I&#39;ll appreciate if you could add an example how would you do it as answer."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545767290, "post_id": 53924183, "comment_id": 94691935, "body": "Before I do that can you please first provide the code where you are <b>using</b> the interfaces? In the question you state that <i>&quot;I&#39;ve changed the code to use interface , which works&quot;</i> but the example code in the question only defines the <code>requester</code> and <code>parser</code> interfaces, it does not use them."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545767707, "post_id": 53924183, "comment_id": 94692020, "body": "@mkopriva - I wanted to use the requester as part of the <code>serviceInfo</code> struct , is that OK . what I miss here how <code>wire</code> everthing right ."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545767944, "post_id": 53924183, "comment_id": 94692077, "body": "@mkopriva - think that I have function <code>wrapperFN</code> that should call inside for two other functions , how would you suggest to do it  with interface (DI) , Im searching here for a best practice, my real scenario is more complicated but this example is showing the logic and the flow that I need to run in <code>prod</code>..."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545768241, "post_id": 53924183, "comment_id": 94692125, "body": "@mkopriva - I&#39;ve update the question as you requested :)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545769866, "post_id": 53924183, "comment_id": 94692445, "body": "Something like this: <a href=\"https://play.golang.org/p/v5T2vaLb2e5\" rel=\"nofollow noreferrer\">play.golang.org/p/v5T2vaLb2e5</a>"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545770294, "post_id": 53924183, "comment_id": 94692531, "body": "@mkopriva - this is close :) , what I miss is how would you call it on main. and also in the test . I mean how would you suggest to mock the two functions <code>HTTPRequest</code> &amp;  <code>parseJson</code> . it will be great if you could add it and provide it as answer. Thanks for the support!"}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 1, "creation_date": 1545955591, "post_id": 53924183, "comment_id": 94743067, "body": "I would also maybe use a DI system like <a href=\"https://github.com/jwells131313/dargo\" rel=\"nofollow noreferrer\">github.com/jwells131313/dargo</a> as a DI system and <a href=\"https://github.com/golang/mock\" rel=\"nofollow noreferrer\">github.com/golang/mock</a> to mock the interfaces you want mocked"}], "owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 75, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1545822814, "creation_date": 1545757454, "last_edit_date": 1545822814, "question_id": 53924183, "link": "https://stackoverflow.com/questions/53924183/using-interface-for-testing-like-dependency-injection", "title": "Using interface for testing like dependency injection", "body": "<p>I use the following code which works ok.</p>\n\n<p><strong>This is working example</strong></p>\n\n<p><a href=\"https://play.golang.org/p/wjvJtDNvJAQ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/wjvJtDNvJAQ</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n)\n\ntype requester interface {\n    HTTPRequest(c string, i string, mtd string, url string) (p []byte, e error)\n}\ntype impl struct {\n    client *http.Client\n}\n\n// ----This is the function which I need to mock\nfunc (s *ServiceInfo) wrapperFN() {\n    // Function 1 - get the values\n    v1, v2 := s.json.parseJson()\n    // call to http function\n    s.req.HTTPRequest(v1, v2, \"POST\", \"http://www.mocky.io/v2/5c20eccc2e00005c001e0c84\")\n}\n\nfunc (i impl) HTTPRequest(c string, ci string, mtd string, url string) (p []byte, e error) {\n    req, err := http.NewRequest(mtd, url, nil)\n    if err != nil {\n        return nil, err\n    }\n    req.SetBasicAuth(c, ci)\n    res, err := i.client.Do(req)\n    if err != nil {\n        return nil, err\n    }\n    token, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        return nil, err\n    }\n    defer res.Body.Close()\n    fmt.Println(\"success\")\n    return token, nil\n}\n\ntype parser interface {\n    parseJson() (string, string)\n}\n\ntype jsonP struct {\n    data string\n}\n\nfunc (s jsonP) parseJson() (string, string) {\n    var result map[string]interface{}\n    json.Unmarshal([]byte(s.data), &amp;result)\n    b := result[\"person\"].(map[string]interface{})\n    for key, value := range b {\n        return key, value.(string)\n    }\n    return \"\", \"\"\n}\n\ntype ServiceInfo struct {\n    req  requester\n    json parser\n}\n\n// When in production pass in concrete implementations.\nfunc NewServiceInfo(http requester, json parser) *ServiceInfo {\n    return &amp;ServiceInfo{\n        req:  http,\n        json: json,\n    }\n}\n\nfunc main() {\n    httpClient := http.Client{}\n    js := `{\"person\":{\"p1\":\"username\",\"p2\":\"password\"},\"customers\":\"10\"}`\n    j := jsonP{data: js}\n    s := NewServiceInfo(impl{client: &amp;httpClient}, j)\n    s.wrapperFN()\n}\n</code></pre>\n\n<p>Now i want to test it <code>wrapperFN</code> , what I try I've changed the code to use interface , which works.</p>\n\n<p>This is just example to give a point ( the real code much more complicated) </p>\n\n<p>The problem that I dont understand how to mock function inside <code>wrapperFN</code> like <code>parseJson()</code> , in the real world <code>warpperFN</code> contains several function which I need to mock ,because just calling them in the test will provide error.</p>\n\n<p>How it's best to mock function like <code>parseJson()</code> &amp; <code>HTTPRequest</code>?  and assume that inside <code>wrapperFN</code> there is additional functions which is not related...</p>\n\n<p>I need to know if this is the best practice for testing function.</p>\n\n<p>This is the test (which im not sure how to make it right)</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"net/http/httptest\"\n    \"testing\"\n)\n\nfunc TestServiceInfo_wrapperFN(t *testing.T) {\n    tests := []struct {\n        name string\n        s    *ServiceInfo\n    }{\n        {\n            name: \"wrapper test\",\n            s:    &amp;ServiceInfo{},\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n\n            var testHandler http.Handler\n            srv := httptest.NewServer(testHandler)\n            defer srv.Close()\n            iReq := &amp;impl{\n                client: srv.Client(),\n            }\n            v := &amp;ServiceInfo{http: *iReq}\n            v.wrapperFN()\n        })\n    }\n}\n</code></pre>\n"}, {"tags": ["rest", "go", "protocol-buffers", "grpc"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1545745581, "post_id": 53922769, "comment_id": 94687568, "body": "There&#39;s nothing preventing you from implementing a partial update capability over gRPC. You have to do the same implementation yourself over HTTP, as well."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1545745649, "post_id": 53922769, "comment_id": 94687592, "body": "@Flimzy His question is about a best practice similar to HTTP&#39;s PATCH. I personally don&#39;t know a best practice. RPC isn&#39;t that opinionated :p"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1545746332, "post_id": 53922769, "comment_id": 94687741, "body": "Here are Google&#39;s guidelines: <a href=\"https://cloud.google.com/apis/design/standard_methods#update\" rel=\"nofollow noreferrer\">cloud.google.com/apis/design/standard_methods#update</a> nNote in particular the FieldMask field in the request."}, {"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545748937, "post_id": 53922769, "comment_id": 94688295, "body": "@Peter it looks like transcoding <a href=\"https://cloud.google.com/endpoints/docs/grpc/transcoding\" rel=\"nofollow noreferrer\">cloud.google.com/endpoints/docs/grpc/transcoding</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 0, "creation_date": 1545765072, "post_id": 53922769, "comment_id": 94691473, "body": "@Seaskyways: I understand the question. The answer is that there is no defined answer, either for HTTP or gRPC. There&#39;s only a very loose framework, within which you can implement your own partial update functionality."}, {"owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "edited": false, "score": 0, "creation_date": 1545767805, "post_id": 53922769, "comment_id": 94692040, "body": "Also Google provide Field Mask for this purpose:  <a href=\"https://developers.google.com/protocol-buffers/docs/reference/csharp/class/google/protobuf/well-known-types/field-mask\" rel=\"nofollow noreferrer\">developers.google.com/protocol-buffers/docs/reference/csharp&zwnj;&#8203;/&hellip;</a>"}, {"owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "edited": false, "score": 0, "creation_date": 1545928833, "post_id": 53922769, "comment_id": 94734774, "body": "still doesn&#39;t understand how to apply field mask. I define <code>FieldMask update_mask</code> path. But it doesn&#39;t filter the request."}, {"owner": {"reputation": 815, "user_id": 2814365, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/494b61d6331885ec1e9d33f58d00ff69?s=128&d=identicon&r=PG", "display_name": "fengsp", "link": "https://stackoverflow.com/users/2814365/fengsp"}, "edited": false, "score": 0, "creation_date": 1590461971, "post_id": 53922769, "comment_id": 109681288, "body": "Here is one example to handle  partial update: <a href=\"https://djangogrpcframework.readthedocs.io/en/latest/patterns/partial_update.html\" rel=\"nofollow noreferrer\">djangogrpcframework.readthedocs.io/en/latest/patterns/&hellip;</a>"}], "owner": {"reputation": 2886, "user_id": 2219213, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/BW004.jpg?s=128&g=1", "display_name": "Sergii Getman", "link": "https://stackoverflow.com/users/2219213/sergii-getman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 658, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545752884, "creation_date": 1545744157, "last_edit_date": 1545745398, "question_id": 53922769, "link": "https://stackoverflow.com/questions/53922769/grpc-partial-resource-update", "title": "gRPC partial resource update", "body": "<p>I am writing a gRPC service. Sometimes I have to update a resource partially.\nIs there something similar to <a href=\"https://www.infoworld.com/article/3206264/application-development/how-to-perform-partial-updates-to-rest-web-api-resources.html\" rel=\"nofollow noreferrer\">HTTP PATCH partial update</a>?</p>\n\n<p>I usually just add just another updateXxx method to proto. So I am wondering is there some best practice?</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 23, "user_id": 10831385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cc7c24cc0d3ea48426326107326e83?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Septem", "link": "https://stackoverflow.com/users/10831385/felix-septem"}, "edited": false, "score": 0, "creation_date": 1545728976, "post_id": 53920886, "comment_id": 94683910, "body": "or I can use something similar to recive the return: <code>go s := make([]interface{}, 0) s... = Foo() &#47;&#47; it&#39;s invalid now </code>"}, {"owner": {"reputation": 23, "user_id": 10831385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cc7c24cc0d3ea48426326107326e83?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Septem", "link": "https://stackoverflow.com/users/10831385/felix-septem"}, "edited": false, "score": 0, "creation_date": 1545729236, "post_id": 53920886, "comment_id": 94683959, "body": "or in another word,how to pack function&#39;s return values into a array or slice?"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 1, "creation_date": 1545745787, "post_id": 53920886, "comment_id": 94687616, "body": "reflection can do this, but the real question is: why would you need this?"}, {"owner": {"reputation": 23, "user_id": 10831385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cc7c24cc0d3ea48426326107326e83?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Septem", "link": "https://stackoverflow.com/users/10831385/felix-septem"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1545793866, "post_id": 53920886, "comment_id": 94695647, "body": "I wanna to use this way to write a regular err check method, rather than check err in every function call,maybe more graceful way I don&#39;t know."}], "answers": [{"tags": [], "owner": {"reputation": 2280, "user_id": 1918890, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/018e4722f070586f7a475e3942b9aa32?s=128&d=identicon&r=PG", "display_name": "Praveen", "link": "https://stackoverflow.com/users/1918890/praveen"}, "is_accepted": true, "score": 10, "last_activity_date": 1545729482, "creation_date": 1545729482, "answer_id": 53920973, "question_id": 53920886, "link": "https://stackoverflow.com/questions/53920886/how-to-determine-number-of-values-returned-by-a-function/53920973#53920973", "title": "How to determine number of values returned by a function", "body": "<p>You can achieve it using the reflect package. </p>\n\n<pre><code>reflect.TypeOf(Foo).NumOut()\n</code></pre>\n\n<p>You can learn about reflect package here <a href=\"https://golang.org/pkg/reflect/#Type\" rel=\"noreferrer\">https://golang.org/pkg/reflect/#Type</a></p>\n"}, {"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": -2, "last_activity_date": 1545738280, "creation_date": 1545738280, "answer_id": 53922065, "question_id": 53920886, "link": "https://stackoverflow.com/questions/53920886/how-to-determine-number-of-values-returned-by-a-function/53922065#53922065", "title": "How to determine number of values returned by a function", "body": "<p>You should not use reflection for putting the return values of a function into a slice. Rather, you should return a slice iterate over the result range</p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n)\n\nfunc foo(num int) []int {\n\n    s := make([]int, num)\n\n    for i := 1; i &lt;= num; i++ {\n        s[i-1] = i\n    }\n\n    return s\n}\n\nfunc main() {\n    r := foo(5)\n\n       // Will run 0 times if len(r) == 0\n       // Obviously, if you need 1+\n       // results, you need to guard this\n      // with something like \n      //   if len(r) &lt; 1...\n    for i := range r {\n        fmt.Printf(\"Hello, %d!\\n\", r[i])\n    }\n\n    // Or, simpler\n    for i, v := range foo(5) {\n        fmt.Printf(\"Index %d =&gt; Value %d\\n\", i, v)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10831385, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69cc7c24cc0d3ea48426326107326e83?s=128&d=identicon&r=PG&f=1", "display_name": "Felix Septem", "link": "https://stackoverflow.com/users/10831385/felix-septem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 2, "accepted_answer_id": 53920973, "answer_count": 2, "score": 0, "last_activity_date": 1545738280, "creation_date": 1545728793, "last_edit_date": 1545730330, "question_id": 53920886, "link": "https://stackoverflow.com/questions/53920886/how-to-determine-number-of-values-returned-by-a-function", "title": "How to determine number of values returned by a function", "body": "<p>How can I get a function's return value length, the effect will be similar to below:</p>\n\n<pre><code>func Foo() (int, int){\n    ...\n}\nfunc Bar() (int, float, bool, string, error){\n    ...\n}\nn1 := getReturnLength(Foo) // shall be 2\nn2 := getReturnLength(Bar) // shall be 5\n</code></pre>\n\n<p>How shall I do to implement the <code>getReturnLength</code> function or something equal?</p>\n"}, {"tags": ["python", "go", "encryption", "aes", "pycryptodome"], "answers": [{"tags": [], "owner": {"reputation": 727, "user_id": 1632336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36c3da5db491a299163393cecdfeed16?s=128&d=identicon&r=PG", "display_name": "Wizmann", "link": "https://stackoverflow.com/users/1632336/wizmann"}, "is_accepted": false, "score": 2, "last_activity_date": 1545730693, "creation_date": 1545730693, "answer_id": 53921101, "question_id": 53920790, "link": "https://stackoverflow.com/questions/53920790/python-aes-ctr-is-not-compatible-with-golang/53921101#53921101", "title": "Python AES-CTR is not compatible with Golang", "body": "<p>Problem solved.</p>\n\n<p>Accroding to <a href=\"https://stackoverflow.com/a/26875149/1632336\">this answer</a>, the default implementation of pycryptodome is not correct. We can change the <code>Counter</code> to make it work as expected.</p>\n\n<pre><code>ctr = Counter.new(128, initial_value=bytes_to_long(iv))\n</code></pre>\n\n<p>Now it works perfectly.</p>\n"}, {"tags": [], "owner": {"reputation": 7205, "user_id": 482262, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gu30Y.jpg?s=128&g=1", "display_name": "SquareRootOfTwentyThree", "link": "https://stackoverflow.com/users/482262/squarerootoftwentythree"}, "is_accepted": false, "score": 1, "last_activity_date": 1546025829, "creation_date": 1546025829, "answer_id": 53963513, "question_id": 53920790, "link": "https://stackoverflow.com/questions/53920790/python-aes-ctr-is-not-compatible-with-golang/53963513#53963513", "title": "Python AES-CTR is not compatible with Golang", "body": "<p>You can simplify your code, by not using the <code>Counter</code> class at all, a <a href=\"https://www.pycryptodome.org/en/latest/src/cipher/classic.html#ctr-mode\" rel=\"nofollow noreferrer\">documented here</a>:</p>\n\n<pre><code>self.aes = AES.new(key, AES.MODE_CTR, initial_value=iv)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 560, "user_id": 12056821, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/643ad055c6e7b13c10a70661dafb8056?s=128&d=identicon&r=PG&f=1", "display_name": "JenilDave", "link": "https://stackoverflow.com/users/12056821/jenildave"}, "is_accepted": false, "score": 0, "last_activity_date": 1585788364, "last_edit_date": 1585788364, "creation_date": 1585788014, "answer_id": 60982542, "question_id": 53920790, "link": "https://stackoverflow.com/questions/53920790/python-aes-ctr-is-not-compatible-with-golang/60982542#60982542", "title": "Python AES-CTR is not compatible with Golang", "body": "<p>Try this out:</p>\n\n<pre><code>ctr = Counter.new(128, initial_value= int.frombytes(iv.encode(),'little'))\n</code></pre>\n\n<p>IV is always to be passed as an integer value and Key in bytes format.\nCheck Documentation from above mentioned links</p>\n"}], "owner": {"reputation": 727, "user_id": 1632336, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/36c3da5db491a299163393cecdfeed16?s=128&d=identicon&r=PG", "display_name": "Wizmann", "link": "https://stackoverflow.com/users/1632336/wizmann"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 427, "favorite_count": 0, "answer_count": 3, "score": 2, "last_activity_date": 1586028117, "creation_date": 1545727981, "last_edit_date": 1545730540, "question_id": 53920790, "link": "https://stackoverflow.com/questions/53920790/python-aes-ctr-is-not-compatible-with-golang", "title": "Python AES-CTR is not compatible with Golang", "body": "<p>I'm using Python2.7 with pycryptodome 3.6.6 and Golang1.10.4 on Ubuntu 16.04. </p>\n\n<p>The encrypt algorithm I choose is AES-CTR-128. But the data encrypted by Python and Golang have different result. So there's a problem to communicate between the apps written by these two languages.</p>\n\n<p>Here is my implement:</p>\n\n<p>Python:</p>\n\n<pre><code>#coding=utf-8\n\nfrom __future__ import absolute_import\nimport binascii\nfrom Crypto.Cipher import AES\nfrom Crypto.Util import Counter\n\ndef hexlify(binary):\n    return binascii.hexlify(binary)\n\nclass AES_CTR(object):\n    def __init__(self, key, iv):\n        assert len(key) == 16\n        assert len(iv) == 16\n        ctr = Counter.new(128)\n        self.aes = AES.new(key, AES.MODE_CTR, counter=ctr)\n\n    def encrypt(self, plain_data):\n        return self.aes.encrypt(plain_data)\n\n    def decrypt(self, encrypted_data):\n        return self.aes.decrypt(encrypted_data)\n\nif __name__ == '__main__':\n    aes = AES_CTR('abcdef0123456789', '0123456789abcdef')\n    print hexlify(aes.encrypt(\"hello\")) #print '9b1a038478'\n    print hexlify(aes.encrypt(\"hello\")) #print '8751ea0448'\n    print hexlify(aes.encrypt(\"world\")) #print 'b6aa7c286b'\n</code></pre>\n\n<p>Golang</p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/aes\"\n    \"crypto/cipher\"\n    \"encoding/hex\"\n    \"fmt\"\n)\n\n\ntype AESCipher struct {\n    iv []byte\n    stream cipher.Stream\n}\n\nfunc NewAESCipher(key []byte, iv []byte) *AESCipher {\n    if (len(iv) != 16 || len(key) != 16) {\n        panic(\"iv length or key length error\")\n    }\n    block, err := aes.NewCipher(key)\n    if (err != nil) {\n        panic(err)\n    }\n    return &amp;AESCipher {\n        iv: iv,\n        stream: cipher.NewCTR(block, iv),\n    }\n}\n\nfunc (cipher *AESCipher) Encrypt(buffer []byte) []byte {\n    encrypted := make([]byte, len(buffer))\n    cipher.stream.XORKeyStream(encrypted, buffer)\n    return encrypted\n}\n\nfunc (cipher *AESCipher) Decrypt(buffer []byte) []byte {\n    decrypted := make([]byte, len(buffer))\n    cipher.stream.XORKeyStream(decrypted, buffer)\n    return decrypted\n}\n\nfunc main() {\n    iv := []byte(\"0123456789abcdef\")\n    key := []byte(\"abcdef0123456789\")\n    cipher := NewAESCipher(key, iv)\n\n    encrypted1 := cipher.Encrypt([]byte(\"hello\"))\n    fmt.Println(hex.EncodeToString(encrypted1)) // print '94ee8ac46a'\n    encrypted2 := cipher.Encrypt([]byte(\"hello\"))\n    fmt.Println(hex.EncodeToString(encrypted2)) // print 'b36d48ad7e'\n    encrypted3 := cipher.Encrypt([]byte(\"world\"))\n    fmt.Println(hex.EncodeToString(encrypted3)) // print '7302071a9c'\n}\n</code></pre>\n"}, {"tags": ["angular", "go", "unexpected-token", "go-echo"], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 2, "last_activity_date": 1545743162, "creation_date": 1545743162, "answer_id": 53922653, "question_id": 53920568, "link": "https://stackoverflow.com/questions/53920568/how-to-fix-refreshing-error-with-echo-and-angular/53922653#53922653", "title": "How to fix refreshing error with Echo and Angular", "body": "<p>The problem isn't strictly related to Echo. The way Angular does routing is that it does NOT request the page from the server. It changes the URL without actually requesting another page from the server. </p>\n\n<p>Thus when you go to \"/home\", then refresh, your browser will try to reach the server and ask it for \"/home\" (in contrast to the first time, the browser requests \"/\" which is mapped to \"dist/index.html\"). \"/home\" is not found or defined in Echo routing. Hence you get a Not Found message.</p>\n\n<p>What I recommend that you do is to do the following regarding routing</p>\n\n<pre><code>e.Static(\"/dist\", \"dist\")\ne.File(\"/*\", \"dist/index.html\")\ne.Start(\":3000\")\n</code></pre>\n\n<p>And inside your <code>index.html</code> add \"/dist\" before the URLs of the requested resources.</p>\n"}, {"comments": [{"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 1, "creation_date": 1545805063, "post_id": 53927443, "comment_id": 94697463, "body": "This forces Echo to look check all the options before going to <code>NotFoundHandler</code>. This may hinder performance."}], "tags": [], "owner": {"reputation": 53, "user_id": 8632181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1zohslIwDLM/AAAAAAAAAAI/AAAAAAAAAA4/oQo8yERna_4/photo.jpg?sz=128", "display_name": "Tuan Nguyen", "link": "https://stackoverflow.com/users/8632181/tuan-nguyen"}, "is_accepted": false, "score": 0, "last_activity_date": 1545798806, "creation_date": 1545798806, "answer_id": 53927443, "question_id": 53920568, "link": "https://stackoverflow.com/questions/53920568/how-to-fix-refreshing-error-with-echo-and-angular/53927443#53927443", "title": "How to fix refreshing error with Echo and Angular", "body": "<p>@Seaskyways answer works great for me, but I also managed to find another solution after looking more into Echo. Echo has a NotFoundHandler which handles all the unknown routes, so what I do is just make it returns the 'index.html' everytime an undefined routes is requested. Here's my code:</p>\n\n<pre><code>echo.NotFoundHandler = func(c echo.Context) \n    return c.File(\"dist/index.html\")\n}\ne := echo.New()\ne.Static(\"/\", \"dist\")\ne.Start(\":3000\")\n</code></pre>\n\n<p>I'm not sure if this is a good way to do it but it's another option for anyone having the same problem like me</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 12095551, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/a-/AAuE7mAQoUKZ_yPFshzoVNJSw1XIqCddZAlGda4dlYFZOe0=k-s128", "display_name": "Abhey Shah", "link": "https://stackoverflow.com/users/12095551/abhey-shah"}, "is_accepted": false, "score": 1, "last_activity_date": 1568987795, "last_edit_date": 1568987795, "creation_date": 1568986768, "answer_id": 58029531, "question_id": 53920568, "link": "https://stackoverflow.com/questions/53920568/how-to-fix-refreshing-error-with-echo-and-angular/58029531#58029531", "title": "How to fix refreshing error with Echo and Angular", "body": "<p>There's also an <code>HTML5</code> option in static middleware in echo:\ne.g.</p>\n\n<pre><code>e.Use(middleware.StaticWithConfig(middleware.StaticConfig{\n        Root:   \"dist\",\n        Index: \"index.html\",\n        Browse: true,\n        HTML5:  true,\n    }))\n</code></pre>\n\n<p>which seems to handle SPA webpages.</p>\n"}], "owner": {"reputation": 53, "user_id": 8632181, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-1zohslIwDLM/AAAAAAAAAAI/AAAAAAAAAA4/oQo8yERna_4/photo.jpg?sz=128", "display_name": "Tuan Nguyen", "link": "https://stackoverflow.com/users/8632181/tuan-nguyen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 1, "accepted_answer_id": 53922653, "answer_count": 3, "score": 5, "last_activity_date": 1568987795, "creation_date": 1545725914, "last_edit_date": 1553996004, "question_id": 53920568, "link": "https://stackoverflow.com/questions/53920568/how-to-fix-refreshing-error-with-echo-and-angular", "title": "How to fix refreshing error with Echo and Angular", "body": "<p>I'm setting up a web server with Go (using Echo) as the backend and Angular 6 as the frontend.\nWhat I do is make a simple app using Angular-cli 'ng new my-app', add a helloworld component and a '/helloworld' route and then build it into production with 'ng build --prod' which output as 'dist' folder.\nFolder structure:</p>\n\n<pre><code>dist\n\u251c\u2500\u2500 assets\n\u2502   \u251c\u2500\u2500 icons\n\u2502   \u2514\u2500\u2500 logo.png\n\u251c\u2500\u2500 favicon.ico\n\u251c\u2500\u2500 index.html\n\u251c\u2500\u2500 main.js\n\u251c\u2500\u2500 polyfills.js\n\u251c\u2500\u2500 runtime.js\n\u2514\u2500\u2500 styles.css\n</code></pre>\n\n<p>I then have Go serve the static files in that 'dist' folder with following code\nmain.go</p>\n\n<pre><code>func main() {\n    e := echo.New()\n    e.Static(\"/\", \"dist\")\n    e.File(\"/\", \"dist/index.html\")\n    e.Start(\":3000\")\n}\n</code></pre>\n\n<p>Now when I use the browser and go to 'localhost:3000/' then the page will be serve correctly, I can navigate around using href thanks to Angular routing ,for example to: 'localhost:3000/home' the page will show correctly but if I try refreshing it then Echo will return a page content that shows:</p>\n\n<p>{\"message\":\"Not Found\"}</p>\n\n<p>I know I can setup the route manually like this:</p>\n\n<pre><code>e.File(\"/home\",\"dist/index.html\")\n</code></pre>\n\n<p>However if I have a lot more routes then its quite a hassle to do all that.</p>\n\n<p>What I need is that any route that's not defined for Echo will be map to 'index.html'. I did try with: </p>\n\n<pre><code>e.File(\"/*\", \"dist/index.html\")\n</code></pre>\n\n<p>and </p>\n\n<pre><code>e.GET(\"/*\", func(c echo.Context) \n    return c.File(\"dist/index.html\")\n})\n</code></pre>\n\n<p>but then I get a blank page with error </p>\n\n<pre><code>\"Uncaught SyntaxError: Unexpected token &lt;  \" \n</code></pre>\n\n<p>with all 3 files main.js, polyfill.js and runtime.js</p>\n\n<p>I'm new to Echo so I don't know how to do this.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545833038, "post_id": 53918738, "comment_id": 94706521, "body": "The given answer is correct, but the real lesson to be learned here is <i>don&#39;t modify returned values from within a <code>defer</code></i>. It makes code very difficult to reason about and troubleshoot."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545834516, "post_id": 53918738, "comment_id": 94706968, "body": "@Adrian: That is not the lesson to be learned. For example, read the Go experts: <a href=\"https://www.gopl.io/\" rel=\"nofollow noreferrer\">gopl.io</a>"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 5, "last_activity_date": 1545706293, "last_edit_date": 1545706293, "creation_date": 1545703197, "answer_id": 53918831, "question_id": 53918738, "link": "https://stackoverflow.com/questions/53918738/return-value-in-function-when-using-defer/53918831#53918831", "title": "return value in function when using defer", "body": "<blockquote>\n  <p>what's the difference between the two functions?</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Defer_statements\" rel=\"nofollow noreferrer\">Defer statements</a></p>\n  \n  <p>A \"defer\" statement invokes a function whose execution is deferred to\n  the moment the surrounding function returns.</p>\n  \n  <p>Each time a \"defer\" statement executes, the function value and\n  parameters to the call are evaluated as usual and saved anew but the\n  actual function is not invoked. Instead, deferred functions are\n  invoked immediately before the surrounding function returns, in the\n  reverse order they were deferred.</p>\n  \n  <p>if the deferred function is a function literal and the surrounding\n  function has named result parameters that are in scope within the\n  literal, the deferred function may access and modify the result\n  parameters before they are returned. If the deferred function has any\n  return values, they are discarded when the function completes.</p>\n</blockquote>\n\n<hr>\n\n<p>The difference is a surrounding function with a named result parameter</p>\n\n<pre><code>func a() (i int)\n</code></pre>\n\n<p>versus a surrounding function with an unnamed result parameter</p>\n\n<pre><code>func a() int\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 9254378, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/0eiV6.png?s=128&g=1", "display_name": "\u6768\u5bd2\u51ac", "link": "https://stackoverflow.com/users/9254378/%e6%9d%a8%e5%af%92%e5%86%ac"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 428, "favorite_count": 2, "accepted_answer_id": 53918831, "answer_count": 1, "score": 4, "last_activity_date": 1545738340, "creation_date": 1545701534, "last_edit_date": 1545738340, "question_id": 53918738, "link": "https://stackoverflow.com/questions/53918738/return-value-in-function-when-using-defer", "title": "return value in function when using defer", "body": "<p>I have some problem with using 'defer' about the return value. I tried to run one test function in different way (only the definition of i is different), but the result is different. So, I'm confused about the different return value. Here is the problem:</p>\n\n<p>function 1:</p>\n\n<pre><code>package main\nimport \"fmt\"\nfunc main() {\n    fmt.Println(\"a return:\", a()) // return value: 0\n}\n\nfunc a() int {\n    var i int\n    defer func() {\n        i++\n        fmt.Println(\"a defer1:\", i) // print \" a defer1: 1\"\n    }()\n    return i\n}\n</code></pre>\n\n<p>return value:</p>\n\n<pre><code>a defer1: 1\na return: 0\n</code></pre>\n\n<p>function 2:</p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(\"a return:\", a()) // return value: 1\n}\n\nfunc a() (i int) {\n    defer func() {\n        i++\n        fmt.Println(\"a defer1:\", i) // print \" a defer1: 1\"\n    }()\n    return i\n}\n</code></pre>\n\n<p>return value:</p>\n\n<pre><code>a defer1: 1\na return: 1\n</code></pre>\n\n<p>One of the return values is 0, the other is 1. So, the question is what's the difference between the two function.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1545743944, "post_id": 53918356, "comment_id": 94687219, "body": "That would be some very confusing syntax. I&#39;m glad it&#39;s not supported."}], "answers": [{"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1545695441, "creation_date": 1545695441, "answer_id": 53918416, "question_id": 53918356, "link": "https://stackoverflow.com/questions/53918356/why-cant-a-tuple-assignment-be-made-with-an-add-operator-in-go/53918416#53918416", "title": "Why can&#39;t a tuple assignment be made with an add operator in Go?", "body": "<p><code>+=</code> is an assignment operation, not a simple assignment. The spec says explicitly:</p>\n\n<blockquote>\n  <p>An <em>assignment operation</em> x op= y where <em>op</em> is a binary arithmetic operator is equivalent to x = x <em>op</em> (y) [...] In assignment operations, both the left- and right-hand expression lists must contain exactly one single-valued expression.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Assignments</a></p>\n"}], "owner": {"reputation": 1159, "user_id": 3614233, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/892f0b9940b5cfb06c4e4edd107bc08d?s=128&d=identicon&r=PG&f=1", "display_name": "MrAlias", "link": "https://stackoverflow.com/users/3614233/mralias"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "closed_date": 1545789746, "accepted_answer_id": 53918416, "answer_count": 1, "score": -3, "last_activity_date": 1545695441, "creation_date": 1545694458, "question_id": 53918356, "link": "https://stackoverflow.com/questions/53918356/why-cant-a-tuple-assignment-be-made-with-an-add-operator-in-go", "closed_reason": "Not suitable for this site", "title": "Why can&#39;t a tuple assignment be made with an add operator in Go?", "body": "<p>According to <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">the Golang language syntax specification</a>:</p>\n\n<blockquote>\n  <p><a href=\"https://golang.org/ref/spec#Assignments\" rel=\"nofollow noreferrer\">Assignment</a> = <a href=\"https://golang.org/ref/spec#ExpressionList\" rel=\"nofollow noreferrer\">ExpressionList</a> <a href=\"https://golang.org/ref/spec#assign_op\" rel=\"nofollow noreferrer\">assign_op</a> <a href=\"https://golang.org/ref/spec#assign_op\" rel=\"nofollow noreferrer\">ExpressionList</a> .</p>\n  \n  <p><a href=\"https://golang.org/ref/spec#assign_op\" rel=\"nofollow noreferrer\">assign_op</a> = [ <a href=\"https://golang.org/ref/spec#add_op\" rel=\"nofollow noreferrer\">add_op</a> | <a href=\"https://golang.org/ref/spec#mul_op\" rel=\"nofollow noreferrer\">mul_op</a> ] \"=\" .</p>\n</blockquote>\n\n<p>furthermore:</p>\n\n<blockquote>\n  <p>A tuple assignment assigns the individual elements of a multi-valued operation to a list of variables.</p>\n</blockquote>\n\n<p>However, when trying to compile <a href=\"https://play.golang.org/p/9xZC5LBmWgk\" rel=\"nofollow noreferrer\">the following code</a>:</p>\n\n<pre><code>package main\n\nfunc addOne(a, b int) (int, int) {\n    return a+1, b+1\n}\n\nfunc main() {\n    var a, b int\n    a, b += addOne(a, b)\n}\n</code></pre>\n\n<p>the compiler complains with:</p>\n\n<pre><code>syntax error: unexpected +=, expecting := or = or comma\n</code></pre>\n\n<p>I'm aware temporary variables can work around this. E.g.</p>\n\n<pre><code>aTemp, bTemp := addOne(a, b)\na += aTemp\nb += bTemp\n</code></pre>\n\n<p>However, it seems like something the language says it supports.</p>\n\n<p>Is this a bug in the compiler?  Have I missed something in the language?</p>\n"}, {"tags": ["string", "go", "slice"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1545680560, "post_id": 53917127, "comment_id": 94677183, "body": "With the addition of <code>import &quot;fmt&quot;</code>, the program compiles without error."}, {"owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1545681113, "post_id": 53917127, "comment_id": 94677291, "body": "@ThunderCat yes, but it doesn&#39;t add the 10 to the strings of ss ."}], "answers": [{"comments": [{"owner": {"reputation": 2654, "user_id": 3450755, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5356a5c4305b6c53407fc97b19c2149d?s=128&d=identicon&r=PG", "display_name": "stt106", "link": "https://stackoverflow.com/users/3450755/stt106"}, "edited": false, "score": 0, "creation_date": 1545721240, "post_id": 53917330, "comment_id": 94682488, "body": "can you explain why passing a slice instead of a pointer is more idiomatic?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2654, "user_id": 3450755, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5356a5c4305b6c53407fc97b19c2149d?s=128&d=identicon&r=PG", "display_name": "stt106", "link": "https://stackoverflow.com/users/3450755/stt106"}, "edited": false, "score": 0, "creation_date": 1545748985, "post_id": 53917330, "comment_id": 94688308, "body": "It&#39;s not necessary to pass a pointer in this situation, nor is there a performance benefit to passing a pointer.  The idiomatic approach is to pass by value."}, {"owner": {"reputation": 2654, "user_id": 3450755, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5356a5c4305b6c53407fc97b19c2149d?s=128&d=identicon&r=PG", "display_name": "stt106", "link": "https://stackoverflow.com/users/3450755/stt106"}, "edited": false, "score": 0, "creation_date": 1545749223, "post_id": 53917330, "comment_id": 94688375, "body": "What if the slice is big, is there no performance gain to pass by reference/pointer?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2654, "user_id": 3450755, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5356a5c4305b6c53407fc97b19c2149d?s=128&d=identicon&r=PG", "display_name": "stt106", "link": "https://stackoverflow.com/users/3450755/stt106"}, "edited": false, "score": 0, "creation_date": 1545749554, "post_id": 53917330, "comment_id": 94688435, "body": "A slice value contains a pointer to the backing array, length and capacity. The size of a slice value is always three machine words."}, {"owner": {"reputation": 2654, "user_id": 3450755, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5356a5c4305b6c53407fc97b19c2149d?s=128&d=identicon&r=PG", "display_name": "stt106", "link": "https://stackoverflow.com/users/3450755/stt106"}, "edited": false, "score": 0, "creation_date": 1545749878, "post_id": 53917330, "comment_id": 94688515, "body": "when, if ever, would you pass in a slice by reference?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2654, "user_id": 3450755, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5356a5c4305b6c53407fc97b19c2149d?s=128&d=identicon&r=PG", "display_name": "stt106", "link": "https://stackoverflow.com/users/3450755/stt106"}, "edited": false, "score": 0, "creation_date": 1545756540, "post_id": 53917330, "comment_id": 94689853, "body": "Use a pointer argument when the function modifies the caller&#39;s slice value. That said, it&#39;s typical to return a slice from the function instead of taking a pointer argument.  See <a href=\"https://godoc.org/builtin#append\" rel=\"nofollow noreferrer\">bullt-in append</a>, <a href=\"https://godoc.org/strconv#AppendBool\" rel=\"nofollow noreferrer\">strconv.AppendXXXX</a> for examples."}, {"owner": {"reputation": 2654, "user_id": 3450755, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5356a5c4305b6c53407fc97b19c2149d?s=128&d=identicon&r=PG", "display_name": "stt106", "link": "https://stackoverflow.com/users/3450755/stt106"}, "edited": false, "score": 0, "creation_date": 1545757493, "post_id": 53917330, "comment_id": 94690012, "body": "But addTen modifies caller\u2019s slice so why not pass in a pointer?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 2654, "user_id": 3450755, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/5356a5c4305b6c53407fc97b19c2149d?s=128&d=identicon&r=PG", "display_name": "stt106", "link": "https://stackoverflow.com/users/3450755/stt106"}, "edited": false, "score": 1, "creation_date": 1545770286, "post_id": 53917330, "comment_id": 94692529, "body": "It modifies the backing array, not the slice value (pointer,length, capacity)."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1545748930, "last_edit_date": 1545748930, "creation_date": 1545681987, "answer_id": 53917330, "question_id": 53917127, "link": "https://stackoverflow.com/questions/53917127/iterate-over-slice-of-strings-and-add-10-to-each-string/53917330#53917330", "title": "Iterate over slice of strings and add 10 to each string", "body": "<p>Use this code to append \"10\" to each slice element:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc addTen(ss []string) {\n    for i, s := range ss {\n        ss[i] = fmt.Sprintf(\"%s10\", s)\n    }\n}\n\nfunc main() {\n    ss := []string{\"a\", \"b\", \"c\"}\n    addTen(ss)\n    fmt.Println(ss)\n}\n</code></pre>\n\n<p>Key points:</p>\n\n<ul>\n<li>Assign the string to the slice element.  The code <code>s = fmt.Sprintf(\"%s10\", s)</code> assigns to local variable <code>s</code>, which is discarded.</li>\n<li>The code in this answer passes a slice value instead of passing a pointer to a slice.  It's not necessary to pass a pointer in this situation, nor is there a performance benefit to passing a pointer. It's simpler to just pass the value.</li>\n</ul>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 121, "favorite_count": 0, "accepted_answer_id": 53917330, "answer_count": 1, "score": 0, "last_activity_date": 1545748930, "creation_date": 1545679973, "last_edit_date": 1545681093, "question_id": 53917127, "link": "https://stackoverflow.com/questions/53917127/iterate-over-slice-of-strings-and-add-10-to-each-string", "title": "Iterate over slice of strings and add 10 to each string", "body": "<p>I'm trying to iterate over a slice of strings and add 10 to each string, e.g:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc addTen(ss *[]string) {\n    for _, s := range *ss {\n        s = fmt.Sprintf(\"%s10\", s)\n    }\n}\n\nfunc main() {\n    ss := []string{\"a\", \"b\", \"c\"}\n    addTen(&amp;ss)\n    fmt.Println(ss)\n}\n</code></pre>\n\n<p>The compiler is complaining that <code>s</code> is not defined.</p>\n"}, {"tags": ["go", "graphql"], "comments": [{"owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "edited": false, "score": 0, "creation_date": 1545678194, "post_id": 53916845, "comment_id": 94676650, "body": "<code>Unknown type \\&quot;String\\&quot;</code> sounds like a bug; also compare very similar <a href=\"https://github.com/graphql-go/graphql/issues/331\" rel=\"nofollow noreferrer\">github.com/graphql-go/graphql/issues/331</a>, and browsing around the issues there seems to be a broader issue that the library doesn&#39;t believe in the built-in scalars at this particular point."}], "answers": [{"comments": [{"owner": {"reputation": 179, "user_id": 7418764, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-ANqF7SABuyY/AAAAAAAAAAI/AAAAAAAAINY/Rq8c1SQ4_wM/photo.jpg?sz=128", "display_name": "electro7912", "link": "https://stackoverflow.com/users/7418764/electro7912"}, "edited": false, "score": 0, "creation_date": 1545678486, "post_id": 53916936, "comment_id": 94676719, "body": "Yep, you were right. That seemed to solve the problem! Thank you soo much for your help"}], "tags": [], "owner": {"reputation": 56993, "user_id": 6024220, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-6s3nUiQ9-fI/AAAAAAAAAAI/AAAAAAAAA0E/3zpg3zXHu4I/photo.jpg?sz=128", "display_name": "Daniel Rearden", "link": "https://stackoverflow.com/users/6024220/daniel-rearden"}, "is_accepted": true, "score": 1, "last_activity_date": 1545678223, "creation_date": 1545678223, "answer_id": 53916936, "question_id": 53916845, "link": "https://stackoverflow.com/questions/53916845/getting-variable-address-cannot-be-non-input-type-string-in-go-graphql/53916936#53916936", "title": "Getting Variable \\&quot;$address\\&quot; cannot be non-input type \\&quot;String!\\ in go-graphql", "body": "<p>It's not clear from the error message you're seeing, but it could be due to the duplicate names in your schema, as outlined in <a href=\"https://github.com/graphql-go/graphql/issues/317\" rel=\"nofollow noreferrer\">this Github issue</a>. You have two types called <code>Email</code> -- <code>emailType</code> and <code>deleteEmailType</code>. Try renaming one of them.</p>\n"}], "owner": {"reputation": 179, "user_id": 7418764, "user_type": "registered", "accept_rate": 50, "profile_image": "https://lh3.googleusercontent.com/-ANqF7SABuyY/AAAAAAAAAAI/AAAAAAAAINY/Rq8c1SQ4_wM/photo.jpg?sz=128", "display_name": "electro7912", "link": "https://stackoverflow.com/users/7418764/electro7912"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 909, "favorite_count": 0, "accepted_answer_id": 53916936, "answer_count": 1, "score": 0, "last_activity_date": 1545678223, "creation_date": 1545677224, "question_id": 53916845, "link": "https://stackoverflow.com/questions/53916845/getting-variable-address-cannot-be-non-input-type-string-in-go-graphql", "title": "Getting Variable \\&quot;$address\\&quot; cannot be non-input type \\&quot;String!\\ in go-graphql", "body": "<p>I've successfully set up a GraphQL server in go using the graphql-go library. However, I seem to be getting an error when I pass query parameters when making a query. So I have a query named <code>emails</code> that takes <code>address</code> as an argument and queries a database to return results regarding all the emails associated with the given <code>address</code>. When I pass the <code>address</code> parameter directly, everything seems to work perfectly, as you can see from this image:</p>\n\n<p><a href=\"https://i.stack.imgur.com/tM6hv.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/tM6hv.png\" alt=\"enter image description here\"></a></p>\n\n<p>However, it doesn't seem to work when I pass it query parameters, like this:</p>\n\n<p><a href=\"https://i.stack.imgur.com/yyggl.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yyggl.png\" alt=\"enter image description here\"></a></p>\n\n<p>I was off the idea that these two statements should give the same results. However, this doesn't seem to be the case. Could somebody help me understand why I'm getting these errors? This is my go code </p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n\n    \"github.com/graphql-go/graphql\"\n    \"github.com/graphql-go/handler\"\n\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/credentials\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/dynamodb\"\n    \"github.com/aws/aws-sdk-go/service/dynamodb/dynamodbattribute\"\n)\n\nvar sess, _ = session.NewSession()\n\n// Email - Used to represent a single email object stored in\n// dynamodb. Fields 'attachments', 'body-html', 'stripped-html' and\n// 'stripped-text' may be empty.\ntype Email struct {\n    To           string   `json:\"to\"`\n    Recipients   []string `json:\"recipients\"`\n    Token        string   `json:\"token\"`\n    Sender       string   `json:\"sender\"`\n    Subject      string   `json:\"subject\"`\n    Timestamp    string   `json:\"timestamp\"`\n    Attachments  []string `json:\"attachments\"`\n    Mime         string   `json:\"mime\"`\n    BodyPlain    string   `json:\"body_plain\"`\n    BodyHTML     string   `json:\"body_html\"`\n    StrippedText string   `json:\"stripped_text\"`\n    StrippedHTML string   `json:\"stripped_html\"`\n}\n\n// emailType - a new graphql object representing a single email\nvar emailType = graphql.NewObject(graphql.ObjectConfig{\n    Name: \"Email\",\n    Fields: graphql.Fields{\n        \"to\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"recipients\": &amp;graphql.Field{\n            Type: graphql.NewList(graphql.String),\n        },\n        \"token\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"sender\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"subject\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"attachments\": &amp;graphql.Field{\n            Type: graphql.NewList(graphql.String),\n        },\n        \"timestamp\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"mime\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"body_plain\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"body_html\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"stripped_text\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"stripped_html\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n    },\n})\n\n// emailType - a new graphql object representing a deleted email.\nvar deleteEmailType = graphql.NewObject(graphql.ObjectConfig{\n    Name: \"Email\",\n    Fields: graphql.Fields{\n        \"to\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n        \"token\": &amp;graphql.Field{\n            Type: graphql.String,\n        },\n    },\n})\n\nfunc disableCors(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\n        w.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS, PUT, DELETE\")\n        w.Header().Set(\"Access-Control-Allow-Headers\", \"Accept, Authorization, Content-Type, Content-Length, Accept-Encoding\")\n\n        // I added this for another handler of mine,\n        // but I do not think this is necessary for GraphQL's handler\n        if r.Method == \"OPTIONS\" {\n            w.Header().Set(\"Access-Control-Max-Age\", \"86400\")\n            w.WriteHeader(http.StatusOK)\n            return\n        }\n\n        h.ServeHTTP(w, r)\n    })\n}\n\nfunc main() {\n    // configures the rootQuery for the graphQL API\n    rootQuery := graphql.NewObject(graphql.ObjectConfig{\n        Name: \"Query\",\n        Fields: graphql.Fields{\n            \"emails\": &amp;graphql.Field{\n                Type: graphql.NewList(emailType),\n                Args: graphql.FieldConfigArgument{\n                    \"address\": &amp;graphql.ArgumentConfig{\n                        Type: graphql.String,\n                    },\n                },\n                Resolve: func(params graphql.ResolveParams) (interface{}, error) {\n                    address := params.Args[\"address\"].(string)\n                    svc := dynamodb.New(sess)\n                    result, err := svc.Query(&amp;dynamodb.QueryInput{\n                        TableName: aws.String(\"emails_db\"),\n                        KeyConditions: map[string]*dynamodb.Condition{\n                            \"to\": {\n                                ComparisonOperator: aws.String(\"EQ\"),\n                                AttributeValueList: []*dynamodb.AttributeValue{\n                                    {\n                                        S: aws.String(address),\n                                    },\n                                },\n                            },\n                        },\n                    })\n                    if err != nil {\n                        return nil, nil\n                    }\n\n                    // unmarshalls all the emails to recs\n                    recs := []Email{}\n                    err = dynamodbattribute.UnmarshalListOfMaps(result.Items, &amp;recs)\n                    if err != nil {\n                        return nil, nil\n                    }\n                    return recs, nil\n                },\n            },\n        },\n    })\n\n    // configures the rootMutation for the graphQL API\n    rootMutation := graphql.NewObject(graphql.ObjectConfig{\n        Name: \"Mutation\",\n        Fields: graphql.Fields{\n            \"email\": &amp;graphql.Field{\n                Type: deleteEmailType,\n                Args: graphql.FieldConfigArgument{\n                    \"address\": &amp;graphql.ArgumentConfig{\n                        Type: graphql.NewNonNull(graphql.String),\n                    },\n                    \"token\": &amp;graphql.ArgumentConfig{\n                        Type: graphql.NewNonNull(graphql.String),\n                    },\n                },\n                Resolve: func(params graphql.ResolveParams) (interface{}, error) {\n                    address := params.Args[\"address\"].(string)\n                    token := params.Args[\"token\"].(string)\n                    svc := dynamodb.New(sess)\n                    _, err := svc.DeleteItem(&amp;dynamodb.DeleteItemInput{\n                        TableName: aws.String(\"emails_db\"),\n                        Key: map[string]*dynamodb.AttributeValue{\n                            \"to\": {\n                                S: aws.String(address),\n                            },\n                            \"token\": {\n                                S: aws.String(token),\n                            },\n                        },\n                    })\n                    if err != nil {\n                        return nil, err\n                    }\n\n                    // unmarshalls all the emails to recs\n                    rec := Email{To: address, Token: token}\n                    return rec, nil\n                },\n            },\n        },\n    })\n\n    // configures routes\n    schema, _ := graphql.NewSchema(graphql.SchemaConfig{\n        Mutation: rootMutation,\n        Query:    rootQuery,\n    })\n    h := handler.New(&amp;handler.Config{\n        Schema:   &amp;schema,\n        Pretty:   true,\n        GraphiQL: true,\n    })\n    http.Handle(\"/graphql\", disableCors(h))\n    log.Fatal(http.ListenAndServe(\":80\", nil))\n}\n</code></pre>\n"}, {"tags": ["go", "buffer"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1545670257, "post_id": 53915604, "comment_id": 94674747, "body": "It sounds like <code>ioutil.ReadAll</code> might be a better fit for your scenario than <code>io.Copy</code>."}, {"owner": {"reputation": 6154, "user_id": 372172, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e3e64f71bb0a748cffdf0baec8b95cb?s=128&d=identicon&r=PG", "display_name": "Koala Yeung", "link": "https://stackoverflow.com/users/372172/koala-yeung"}, "edited": false, "score": 0, "creation_date": 1545675823, "post_id": 53915604, "comment_id": 94676077, "body": "Why do you run the copy statement with a go routine?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545742499, "post_id": 53915604, "comment_id": 94686908, "body": "Let me get that straight: We are talking of a text based protocol, presumably via a network connection and you are optimizing the way to deal with a byte buffer with a length of 1k to shave away a few &#181;s?"}, {"owner": {"reputation": 87, "user_id": 10765021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced873201945cfa92e484c00e0459f4?s=128&d=identicon&r=PG&f=1", "display_name": "toti toto", "link": "https://stackoverflow.com/users/10765021/toti-toto"}, "edited": false, "score": 0, "creation_date": 1545813780, "post_id": 53915604, "comment_id": 94699902, "body": "I run the copy statement with a go routine because I&#39;m trying to modify an existing github code (gonc - go implementation of netcat). I didn&#39;t understand the latter question - My program listens for TCP connections and starts a reverse bash shell (the interaction code is written in first post) - My issue is that i&#39;m trying to read a string from within this connection that won&#39;t be interpreted as a system command like now (since the terminal becomes a bash shell on the target host after the interaction)"}], "owner": {"reputation": 87, "user_id": 10765021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ced873201945cfa92e484c00e0459f4?s=128&d=identicon&r=PG&f=1", "display_name": "toti toto", "link": "https://stackoverflow.com/users/10765021/toti-toto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 283, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545679146, "creation_date": 1545668040, "last_edit_date": 1545679146, "question_id": 53915604, "link": "https://stackoverflow.com/questions/53915604/copying-stdin-to-a-buffer", "title": "Copying stdin to a buffer", "body": "<p>I want to copy a <code>os.Stdin</code> string to a buffer, to check for a user inputted text (e.g. \"hibye\") and put an if statement against it.</p>\n\n<p>My current code just handles simple stdin stdiout copy operations (no buffer):</p>\n\n<pre><code>func interact(c net.Conn) {\n    // Read from Reader and write to Writer until EOF()\n    copy := func(r io.ReadCloser, w io.WriteCloser) {\n        defer func() {\n            r.Close()\n            w.Close()\n        }()\n        n, err := io.Copy(w, r)\n        if err != nil {\n            log.Printf(\"[%s]: ERROR: %s\\n\", c.RemoteAddr(), err)\n            log.Println(n)\n        }\n    }\n\n    go copy(c, os.Stdout)\n    go copy(os.Stdin, c)\n}\n</code></pre>\n\n<p><strong>Question:</strong> What is the most efficient way to implement a use of a buffer to have control over the passed strings?</p>\n\n<p>bad example (failed attempt):</p>\n\n<pre><code>buf := make([]byte, 1024)\ngo copy (os.Stdin, []byte(buf))\nif buf == \"hibye\" {\ndo stuff\n}\n</code></pre>\n"}, {"tags": ["go", "toml"], "answers": [{"tags": [], "owner": {"reputation": 36, "user_id": 10613538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/82c00359c4cf0b09d90c7c0842adbad8?s=128&d=identicon&r=PG&f=1", "display_name": "zwirec", "link": "https://stackoverflow.com/users/10613538/zwirec"}, "is_accepted": true, "score": 2, "last_activity_date": 1545736783, "creation_date": 1545736783, "answer_id": 53921872, "question_id": 53915596, "link": "https://stackoverflow.com/questions/53915596/parsing-a-key-value-pair-within-a-table-for-toml-file-and-golang/53921872#53921872", "title": "Parsing a key value pair within a table for TOML file and golang", "body": "<p>You say:</p>\n\n<blockquote>\n  <p>I want to set measurement key in gps table and imutable only once and not redundantly within msgpack and json and for 1 and 2</p>\n</blockquote>\n\n<p>You don't make this because creator of TOML format said:</p>\n\n<blockquote>\n  <p>Because we need a decent human-readable format that unambiguously maps to a hash table and the YAML spec is like 80 pages long and gives me rage. No, JSON doesn't count. You know why.</p>\n</blockquote>\n\n<p>If you need to have the same value to one key, for you example, <code>measurement</code>, you must specify it in every subtable what you want</p>\n\n<p>Your correct TOML file:</p>\n\n<pre><code>[database]\nhost = \"localhost\"\nport = 8086\nhttps = true\nusername = \"root\"\npassword = \"root\"\ndb = \"test\"\n\n[cloud]\ndeviceType = \"2be386e9bbae\"\ndeviceId = \"119a705fa3b1\"\npassword = \"test\"\ntoken = \"dqpx5vNLLTR34\"\nendpoint = \"mqtts://mqtt1.endpoint.com\"\n\n[gps]\n[gps.msgpack]\ntopic = \"/evt/gps/msgpack\"\nmeasurement = \"gps\"\n\n[gps.json]\ntopic = \"/evt/gps/json\"\nmeasurement = \"gps\"\n\n[imu]\n[imu.1]\nmeasurement = \"imu\"\ntag = \"NODE1\"\ntopic = \"/evt/imu1/msgpack\"\n[imu.2]\nmeasurement = \"imu\"\ntag = \"NODE2\"\ntopic = \"/evt/imu2/msgpack\"\n</code></pre>\n"}], "owner": {"reputation": 2299, "user_id": 4851126, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/02d0041271b0178482aee8a36237e09e?s=128&d=identicon&r=PG", "display_name": "Shan-Desai", "link": "https://stackoverflow.com/users/4851126/shan-desai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1518, "favorite_count": 0, "accepted_answer_id": 53921872, "answer_count": 1, "score": 0, "last_activity_date": 1545736783, "creation_date": 1545667956, "last_edit_date": 1545668122, "question_id": 53915596, "link": "https://stackoverflow.com/questions/53915596/parsing-a-key-value-pair-within-a-table-for-toml-file-and-golang", "title": "Parsing a key value pair within a table for TOML file and golang", "body": "<p>I have the following structure for a TOML file:</p>\n\n<pre><code>[database]\nhost = \"localhost\"\nport = 8086\nhttps = true\nusername = \"root\"\npassword = \"root\"\ndb = \"test\"\n\n[cloud]\ndeviceType = \"2be386e9bbae\"\ndeviceId = \"119a705fa3b1\"\npassword = \"test\"\ntoken = \"dqpx5vNLLTR34\"\nendpoint = \"mqtts://mqtt1.endpoint.com\"\n\n[gps]\n#measurement = \"gps\"\n  [gps.msgpack]\n  topic = \"/evt/gps/msgpack\"\n\n  [gps.json]\n  topic = \"/evt/gps/json\"\n\n[imu]\n#measurement = \"imu\"\n  [imu.1]\n    tag = \"NODE1\"\n    topic = \"/evt/imu1/msgpack\"\n  [imu.2]\n    tag = \"NODE2\"\n    topic = \"/evt/imu2/msgpack\"\n</code></pre>\n\n<p>I want to set <code>measurement</code> key in <code>gps</code> table and <code>imu</code>table only once and not redundantly within <code>msgpack</code> and <code>json</code> and for <code>1</code> and <code>2</code></p>\n\n<p>With the commented out keys The following code works</p>\n\n<h2>Code</h2>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"github.com/BurntSushi/toml\"\n)\n\ntype imu struct {\n  Topic string\n  Measurement string\n  Tag string\n}\n\ntype gps struct {\n  // Measurement string\n  Measurement string\n  ETopic string `toml:\"topic\"`\n}\n\ntype database struct {\n  Host  string\n  Port  int\n  Https bool\n  Username  string\n  Password  string\n  Dbname  string\n}\n\ntype cloud struct {\n  Devicetype  string\n  DeviceId  string\n  Password  string\n  Token   string\n  Endpoint  string\n}\n\ntype tomlConfig struct {\n  DB database `toml:\"database\"`\n  Cloud cloud `toml:\"cloud\"`\n  Gps map[string]gps `toml:\"gps\"`\n  Imu map[string]imu  `toml:\"imu\"`\n}\n\n\nfunc main()  {\n\n  var config tomlConfig\n\n  if _, err := toml.DecodeFile(\"cloud.toml\", &amp;config); err != nil {\n    fmt.Println(err)\n    return\n  }\n  // fmt.Printf(\"%#v\\n\", config)\n  for sensorName, sensor := range config.Imu {\n    fmt.Printf(\"Topic: %s %s %s %s\\n\", sensorName, sensor.Topic, sensor.Tag, sensor.Measurement)\n  }\n\n  for types, gps := range config.Gps {\n    fmt.Printf(\"%s\\n\", types)\n    fmt.Printf(\"%s\\n\", gps.ETopic)\n  }\n}\n</code></pre>\n\n<p>However on uncommenting out the key value pair I get the following:</p>\n\n<pre><code> toml: type mismatch for main.gps: expected table but found string\n</code></pre>\n\n<p>(It should still be a valid TOML, as I translated it to JSON and checked the structure)</p>\n\n<p>I understand that I have not mentioned within the <code>struct</code> that I need to add a string for it. However I am getting confused as to how the struct should now look like.</p>\n"}, {"tags": ["go", "reflection"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545666993, "post_id": 53915203, "comment_id": 94673920, "body": "If you know the exact type of the slice field you can use <code>slice := elem.FieldByName(&quot;SysVars&quot;).Interface().([]string)</code>, ie type assertion. The just loop over the <code>slice</code> with plain for/range loop, no need to reflect anymore."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545667170, "post_id": 53915203, "comment_id": 94673985, "body": "If you know that it&#39;s only a slice but you don&#39;t know the type of it&#39;s elements, then use reflect <code>sysVarsValue := elem.FieldByName(&quot;SysVars&quot;)</code> (no need to call Interface()). And then to loop over that do <code>for i := 0; i &lt; sysVarsValue.Len(); i++ { ...</code> and then to index the slice inside the loop use <code>sysVarsValue.Index(i)</code>."}], "answers": [{"comments": [{"owner": {"reputation": 175, "user_id": 5477548, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-u_GWgGl3A68/AAAAAAAAAAI/AAAAAAAAAF4/GqN9bcsoapY/photo.jpg?sz=128", "display_name": "yoad w", "link": "https://stackoverflow.com/users/5477548/yoad-w"}, "edited": false, "score": 0, "creation_date": 1545679586, "post_id": 53915505, "comment_id": 94676962, "body": "perfetct! also, if this doesn&#39;t exceed the scope of the post, would you mind explain why my solution was not correct, and yours is?"}, {"owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "reply_to_user": {"reputation": 175, "user_id": 5477548, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-u_GWgGl3A68/AAAAAAAAAAI/AAAAAAAAAF4/GqN9bcsoapY/photo.jpg?sz=128", "display_name": "yoad w", "link": "https://stackoverflow.com/users/5477548/yoad-w"}, "edited": false, "score": 1, "creation_date": 1545722424, "post_id": 53915505, "comment_id": 94682713, "body": "@yoadw An interface holds two pair, a value and a type when you start reflection on a variable you are extracting underneath data from an interface no need to assert to interface again. It&#39;s like you parse an string to int then convert int to string again. You can learn lot about reflection in this page , laws of reflection : <a href=\"https://blog.golang.org/laws-of-reflection\" rel=\"nofollow noreferrer\">blog.golang.org/laws-of-reflection</a>"}], "tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": true, "score": 3, "last_activity_date": 1545667245, "creation_date": 1545667245, "answer_id": 53915505, "question_id": 53915203, "link": "https://stackoverflow.com/questions/53915203/reflecting-array-inside-interface/53915505#53915505", "title": "reflecting array inside interface", "body": "<p>No need to double reflection , you can iterate SysVars like this :</p>\n\n<pre><code>p := &amp;Configuration{\nSysVars :[]string{\"a\",\"b\",\"c\"},\n}\n\ns:= reflect.ValueOf(p).Elem().FieldByName(\"SysVars\")\nfor i:=0 ; i&lt; s.Len() ; i++ {\n   fmt.Println(s.Index(i).String())\n}\n</code></pre>\n"}], "owner": {"reputation": 175, "user_id": 5477548, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh3.googleusercontent.com/-u_GWgGl3A68/AAAAAAAAAAI/AAAAAAAAAF4/GqN9bcsoapY/photo.jpg?sz=128", "display_name": "yoad w", "link": "https://stackoverflow.com/users/5477548/yoad-w"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 53915505, "answer_count": 1, "score": 0, "last_activity_date": 1545667245, "creation_date": 1545665215, "question_id": 53915203, "link": "https://stackoverflow.com/questions/53915203/reflecting-array-inside-interface", "title": "reflecting array inside interface", "body": "<p>I'm trying to access via reflection an array within an interface.</p>\n\n<p>Among other fields, I also have an array of strings:<br></p>\n\n<pre><code>type Configuration struct {\n    ...\n    SysVars []string\n}\n</code></pre>\n\n<p>I can access the field <em>SysVars</em> like this:<br></p>\n\n<pre><code>elem := reflect.ValueOf(conf).Elem()\nsysVarsInterface := elem.FieldByName(\"SysVars\").Interface()\n</code></pre>\n\n<p>By this point, when using the GoLand's debugger I can see that <em>sysVarsInterface</em> is an interface with the two values I'm expecting. Since it's an array, I assume I need to treat it as interface and reflect it again? so it looks like this: <br></p>\n\n<pre><code>sysVarsValue := reflect.ValueOf(&amp;sysVarsInterface)\nsysVarsElem := sysVarsValue.Elem()\n</code></pre>\n\n<p>but iterating over it fails:</p>\n\n<pre><code>for i:=0; i&lt; sysVarsElem.NumField(); i++ {\n    vname := sysVarsElem.Type().Field(i).Name\n    fmt.Println(vname)\n}\n</code></pre>\n\n<p>saying:</p>\n\n<pre><code>panic: reflect: call of reflect.Value.NumField on interface Value\n</code></pre>\n\n<p>any ideas what am I doing wrong? <br> I was using <a href=\"http://www.golangprograms.com/how-to-get-struct-variable-information-using-reflect-package.html\" rel=\"nofollow noreferrer\">this</a> as a reference</p>\n"}, {"tags": ["go", "struct", "types"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545659364, "post_id": 53914258, "comment_id": 94671757, "body": "something like <code>if field is bool then field.Set(fakeVariable != &quot;&quot;)</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545659455, "post_id": 53914258, "comment_id": 94671787, "body": "I&#39;m trying to avoid conditionals, something like `field.Set(fakeVariable.(field.Kind()) - a dynamic type casting."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545659510, "post_id": 53914258, "comment_id": 94671804, "body": "no dynamic type casting in go, use conditionals. Btw if you want to be precise in your language then there is no &quot;type casting&quot; in go, only <i>type assertions</i> <code>someValue.(someType)</code> and <i>conversions</i> <code>someType(someValue)</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545659834, "post_id": 53914258, "comment_id": 94671905, "body": "... and to clarify my <i>&quot;no dynamic type casting in go&quot;</i> comment, when you&#39;re doing type assertions, ie <code>v.(T)</code>, the <code>T</code> in that expression must be a valid go type, not a variable holding some value, not an expression that results in some value, etc. That is, you can do <code>v.(int)</code> or <code>v.(string)</code>, but you cannot do <code>v.(getIntType())</code> nor <code>v.(stringValue)</code>."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "edited": false, "score": 0, "creation_date": 1545663848, "post_id": 53914977, "comment_id": 94673100, "body": "That&#39;s weird, is there a reason behind this decision? Because forcing the language users to read a giant switch statement seems much more cumbersome (for the users at least)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1545664264, "post_id": 53914977, "comment_id": 94673208, "body": "@celoxxx The reason is the desire to provide type safety. Many developers prefer to have type safety rather then not know what the type of a variable is."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": false, "score": 4, "last_activity_date": 1545663628, "creation_date": 1545663628, "answer_id": 53914977, "question_id": 53914258, "link": "https://stackoverflow.com/questions/53914258/how-to-change-type-of-variable-in-runtime/53914977#53914977", "title": "How to change type of variable in runtime", "body": "<blockquote>\n  <p>How to change type of variable in runtime</p>\n</blockquote>\n\n<p>You cannot.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 270, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1545663628, "creation_date": 1545659183, "last_edit_date": 1545659373, "question_id": 53914258, "link": "https://stackoverflow.com/questions/53914258/how-to-change-type-of-variable-in-runtime", "title": "How to change type of variable in runtime", "body": "<p>I would like to know if it's possible to change the type of variable in run time, for example:</p>\n\n<pre><code>package main\n\nimport \"github.com/fatih/structs\"\n\ntype T struct {\n  MyField bool\n}\n\nfunc main() {\n  fakeVariable := \"\"\n\n  s := structs.New(T{})\n  for _, field := range s.Fields() {\n    field.Set(fakeVariable) \n  }\n}\n</code></pre>\n\n<p>Since MyField is a boolean, I would like to change fakeVariable to a boolean, and the expected result would be that <code>MyField</code> is false (because empty strings are false). But the MyField type could be anything, so I would like to know how to cast it to the type of MyField. I know that I can get the field type using <code>field.Kind()</code>, and this:</p>\n\n<pre><code>field.Set(fakeVariable.(field.Kind())\n</code></pre>\n\n<p>Won't work.</p>\n\n<p>The <code>fakeVariable</code> will be always a string, but it could hold the value \"10.0\", and if the type of MyField is <code>float</code>, it should cast to float, but if its string, it should only assign it. Make sense?</p>\n\n<p>Any ideas if what I'm trying is possible?</p>\n"}, {"tags": ["html", "go"], "answers": [{"tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": true, "score": 1, "last_activity_date": 1545658310, "last_edit_date": 1545658310, "creation_date": 1545657827, "answer_id": 53914059, "question_id": 53913981, "link": "https://stackoverflow.com/questions/53913981/how-to-get-a-selected-item-in-drop-down-list/53914059#53914059", "title": "How to get a selected item in drop-down list?", "body": "<p>First thing first you have to have a form and submit button in your html to send data to a route . There is no form in your html.  </p>\n\n<pre><code>&lt;form method=\"post\" action\"/upload\"&gt;\n&lt;select name=\"action\" size=\"1\" id=\"action-choice\"&gt;\n    &lt;option value=\"test\"&gt;Test&lt;/option&gt;\n    &lt;option value=\"run\"&gt;Run&lt;/option&gt;\n&lt;/select&gt;\n&lt;button type=\"submit\"&gt;Submit&lt;/button&gt;\n&lt;/form&gt;\n</code></pre>\n\n<p>Second: in your upload function you can do this :</p>\n\n<pre><code>r.ParseForm()\nfmt.Println(r.Form[\"action\"])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 10294914, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/080d697323b3fb03965191dee1b5a6ef?s=128&d=identicon&r=PG&f=1", "display_name": "J. doe", "link": "https://stackoverflow.com/users/10294914/j-doe"}, "is_accepted": false, "score": 1, "last_activity_date": 1545659370, "last_edit_date": 1545659370, "creation_date": 1545658867, "answer_id": 53914207, "question_id": 53913981, "link": "https://stackoverflow.com/questions/53913981/how-to-get-a-selected-item-in-drop-down-list/53914207#53914207", "title": "How to get a selected item in drop-down list?", "body": "<p>The Go code is acting as the server and since the HTML file is running from the user's browser, you can't access it without sending it to the server. In this example I will be using HTTP GET.</p>\n\n<p>Assuming that your html file is under \"/\"</p>\n\n<p>First, change the html file to use a GET form:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>&lt;!DOCTYPE html&gt;\r\n&lt;html&gt;\r\n&lt;body&gt;\r\n&lt;form action=\"/upload\" method=\"get\"&gt;\r\n&lt;select name=\"action\" size=\"1\" id=\"action-choice\"&gt;\r\n    &lt;option value=\"test\"&gt;Test&lt;/option&gt;\r\n    &lt;option value=\"run\"&gt;Run&lt;/option&gt;\r\n&lt;/select&gt;\r\n&lt;input type=\"submit\" value=\"Submit\"&gt;\r\n&lt;/form&gt;</code></pre>\r\n</div>\r\n</div>\r\n</p>\n\n<p>Now, we need to catch this GET request under /upload (since the form is redirecting to /upload)</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>func upload(w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"GET\" {\n        r.ParseForm()\n        w.Write([]byte(r.Form[\"action\"][0]))\n    }\n}\n</code></pre>\n\n<p>so we can sum it all up to the following GO code</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"net/http\"\n    \"log\"\n)\n\n\nvar page = `&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n&lt;form action=\"/upload\" method=\"get\"&gt;\n&lt;select name=\"action\" size=\"1\" id=\"action-choice\"&gt;\n    &lt;option value=\"test\"&gt;Test&lt;/option&gt;\n    &lt;option value=\"run\"&gt;Run&lt;/option&gt;\n&lt;/select&gt;\n&lt;input type=\"submit\" value=\"Submit\"&gt;\n&lt;/form&gt;`\nfunc m(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(page))\n}\n\nfunc upload(w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"GET\" {\n        r.ParseForm()\n        w.Write([]byte(r.Form[\"action\"][0]))\n    }\n}\nfunc main() {\n    log.Println(\"started\")\n    http.HandleFunc(\"/\", m)\n    http.HandleFunc(\"/upload\", upload)\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n</code></pre>\n"}], "owner": {"reputation": 192, "user_id": 6266336, "user_type": "registered", "accept_rate": 38, "profile_image": "https://graph.facebook.com/1191156864229842/picture?type=large", "display_name": "Diana", "link": "https://stackoverflow.com/users/6266336/diana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1102, "favorite_count": 0, "accepted_answer_id": 53914059, "answer_count": 2, "score": 1, "last_activity_date": 1545730782, "creation_date": 1545657307, "last_edit_date": 1545730782, "question_id": 53913981, "link": "https://stackoverflow.com/questions/53913981/how-to-get-a-selected-item-in-drop-down-list", "title": "How to get a selected item in drop-down list?", "body": "<p>I have the following html file:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;body&gt;\n\n&lt;select name=\"action\" size=\"1\" id=\"action-choice\"&gt;\n    &lt;option value=\"test\"&gt;Test&lt;/option&gt;\n    &lt;option value=\"run\"&gt;Run&lt;/option&gt;\n&lt;/select&gt;\n</code></pre>\n\n<p>how to get the value of the selected option using Go? </p>\n\n<pre><code>func main() {\n    log.Println(\"started\")\n    http.HandleFunc(\"/upload\", upload)\n    log.Fatal(http.ListenAndServe(\":8080\", nil))\n}\n\n\nfunc upload(w http.ResponseWriter, r *http.Request) {\n    if r.Method == \"GET\" {\n        t, _ := template.ParseFiles(\"upload.html\")\n        t.Execute(w, nil)\n    }\n</code></pre>\n"}, {"tags": ["arrays", "for-loop", "go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545657365, "post_id": 53913959, "comment_id": 94671157, "body": "I made some changes, In my code kindly check and let me know."}, {"owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "reply_to_user": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545657542, "post_id": 53913959, "comment_id": 94671216, "body": "Where do you concat slices now ??"}], "tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": false, "score": 0, "last_activity_date": 1545657204, "creation_date": 1545657204, "answer_id": 53913959, "question_id": 53913785, "link": "https://stackoverflow.com/questions/53913785/golang-byte-insert-into-byte/53913959#53913959", "title": "Golang : Byte insert into [ ] byte", "body": "<p>You are  appending to Sample but printing req.Content<br>\nThere is nothing wrong with merging slices. if just have to print Sample to see merged result.</p>\n"}, {"comments": [{"owner": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545909260, "post_id": 53943710, "comment_id": 94726897, "body": "[]bytes or []byte..?, If []bytes mean it&#39;s showing undefined, If I used []byte it append method take more time and virtual machine is hang."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "reply_to_user": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545912523, "post_id": 53943710, "comment_id": 94728268, "body": "its []byte. Thanks for pointing it out. Is virtual machine hanging or Is it waiting for the response ?"}, {"owner": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545913990, "post_id": 53943710, "comment_id": 94728851, "body": "Append process is not completed, It take more time, Then vm is hang."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "reply_to_user": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545915731, "post_id": 53943710, "comment_id": 94729572, "body": "what is the size of the response being returned from the grpc service and how much memory have you allocated to the VM ?"}, {"owner": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545916533, "post_id": 53943710, "comment_id": 94729906, "body": "Vm memory is 6GB, Result total size is 6000 and something, So every iteration result will be append so it will be take maximum time."}, {"owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "reply_to_user": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545929655, "post_id": 53943710, "comment_id": 94735123, "body": "What are you doing with result, how is it being used?"}, {"owner": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "edited": false, "score": 0, "creation_date": 1545975191, "post_id": 53943710, "comment_id": 94746381, "body": "The stream will be return (resp) multiple [ ]byte (Ex: [1 2 3 4 5] [6 7 8 9 10]...), The second for loop return byte (Ex: 1 2 3 4...), I need only one [ ] byte. Ex: [1 2 3 4 5 6 7 8 9 10...]"}], "tags": [], "owner": {"reputation": 2907, "user_id": 3968921, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/9d5c954a2cee47c08a8ead21e79e24ab?s=128&d=identicon&r=PG&f=1", "display_name": "Ankit Deshpande", "link": "https://stackoverflow.com/users/3968921/ankit-deshpande"}, "is_accepted": false, "score": 0, "last_activity_date": 1545912394, "last_edit_date": 1545912394, "creation_date": 1545907446, "answer_id": 53943710, "question_id": 53913785, "link": "https://stackoverflow.com/questions/53913785/golang-byte-insert-into-byte/53943710#53943710", "title": "Golang : Byte insert into [ ] byte", "body": "<pre><code>func (s *ServerGRPC) Upload(stream pb.GuploadService_UploadServer) (err error) {\n\nvar respBytes []byte\nfor {\n        resp, err := stream.Recv()\n\n        if err != nil {\n            if err == io.EOF {\n                goto END // you can use break here\n            }\n\n            err = errors.Wrapf(err,\n                \"failed unexpectadely while reading chunks from stream\")\n            return err\n        }\n\n        for _, result := range resp.Content {\n\n            fmt.Println(\"result ====&gt;&gt;&gt;\", result)\n            respBytes = append(respBytes, result)\n\n        }\n    }\n        s.logger.Info().Msg(\"upload received\")\n        // print respBytes here\n    END:\n        err = stream.SendAndClose(&amp;pb.UploadStatus{\n            Message: \"Upload received with success\",\n            Code:    pb.UploadStatusCode_Ok,\n        })\n        if err != nil {\n            err = errors.Wrapf(err,\n                \"failed to send status code\")\n            return\n        }\n\n        return\n    }\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 6192650, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/d68aad69c2e02a58ab010098c88009b3?s=128&d=identicon&r=PG&f=1", "display_name": "Udayakumar", "link": "https://stackoverflow.com/users/6192650/udayakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 506, "favorite_count": 1, "answer_count": 2, "score": -1, "last_activity_date": 1545912394, "creation_date": 1545656289, "last_edit_date": 1545906574, "question_id": 53913785, "link": "https://stackoverflow.com/questions/53913785/golang-byte-insert-into-byte", "title": "Golang : Byte insert into [ ] byte", "body": "<p>I'm working on GRPC stream, In server side, I receive the multiple byte inside the for loop, I want to merge in a single array of byte (I tried append method but not use), Here I have attached my sample code. Any one guide me.</p>\n\n<p><strong>Example code</strong></p>\n\n<pre><code>func (s *ServerGRPC) Upload(stream pb.GuploadService_UploadServer) (err error) {\n\nfor {\n        resp, err := stream.Recv()\n\n        if err != nil {\n            if err == io.EOF {\n                goto END\n            }\n\n            err = errors.Wrapf(err,\n                \"failed unexpectadely while reading chunks from stream\")\n            return err\n        }\n\n        for _, result := range resp.Content {\n\n            fmt.Println(\"result ====&gt;&gt;&gt;\", result)\n\n          //Actual Output\n          //result ====&gt;&gt;&gt; 136\n          //result ====&gt;&gt;&gt; 84\n          //result ====&gt;&gt;&gt; 232\n          //result ====&gt;&gt;&gt; 12\n\n          //Expectation\n          //result ===&gt; [136 84 232 12] \n\n        }\n\n    }\n        s.logger.Info().Msg(\"upload received\")\n\n    END:\n        err = stream.SendAndClose(&amp;pb.UploadStatus{\n            Message: \"Upload received with success\",\n            Code:    pb.UploadStatusCode_Ok,\n        })\n        if err != nil {\n            err = errors.Wrapf(err,\n                \"failed to send status code\")\n            return\n        }\n\n        return\n    }\n</code></pre>\n"}, {"tags": ["go", "struct", "types"], "answers": [{"tags": [], "owner": {"reputation": 1548, "user_id": 2841607, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjWu8.jpg?s=128&g=1", "display_name": "minitauros", "link": "https://stackoverflow.com/users/2841607/minitauros"}, "is_accepted": true, "score": 1, "last_activity_date": 1545655737, "creation_date": 1545655737, "answer_id": 53913682, "question_id": 53913629, "link": "https://stackoverflow.com/questions/53913629/how-to-type-assert-with-switch-using-reflect-type/53913682#53913682", "title": "How to type assert with switch using reflect.Type", "body": "<p>You'll see that the <code>Kind()</code> method returns a <code>reflect.Kind</code>, which is one of the following:</p>\n\n<pre><code>type Kind uint\n\nconst (\n    Invalid Kind = iota\n    Bool\n    Int\n    Int8\n    Int16\n    Int32\n    Int64\n    Uint\n    Uint8\n    Uint16\n    Uint32\n    Uint64\n    Uintptr\n    Float32\n    Float64\n    Complex64\n    Complex128\n    Array\n    Chan\n    Func\n    Interface\n    Map\n    Ptr\n    Slice\n    String\n    Struct\n    UnsafePointer\n)\n</code></pre>\n\n<p>So you'll need the cases to be like <code>reflect.Bool</code> instead of simply <code>bool</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 10498, "user_id": 547242, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/kJift.jpg?s=128&g=1", "display_name": "Larry Cinnabar", "link": "https://stackoverflow.com/users/547242/larry-cinnabar"}, "is_accepted": false, "score": 1, "last_activity_date": 1545656130, "creation_date": 1545656130, "answer_id": 53913754, "question_id": 53913629, "link": "https://stackoverflow.com/questions/53913629/how-to-type-assert-with-switch-using-reflect-type/53913754#53913754", "title": "How to type assert with switch using reflect.Type", "body": "<p>Use predefined reflect kind constants:</p>\n\n<pre><code>for _, field := range s.Fields() {\n    switch field.Kind() {\n    case reflect.Bool:\n      // do something\n    case reflect.String:\n      // do something\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 339, "favorite_count": 0, "accepted_answer_id": 53913682, "answer_count": 2, "score": 0, "last_activity_date": 1545656130, "creation_date": 1545655406, "last_edit_date": 1592644375, "question_id": 53913629, "link": "https://stackoverflow.com/questions/53913629/how-to-type-assert-with-switch-using-reflect-type", "title": "How to type assert with switch using reflect.Type", "body": "<p>I'm using the <a href=\"https://godoc.org/github.com/fatih/structs#Field.Kind\" rel=\"nofollow noreferrer\">structs</a> library to iterate easily over the fields of a struct, e.g:</p>\n<pre><code>package main\n\nimport &quot;github.com/fatih/structs&quot;\n\ntype T struct {\n}\n\nfunc main() {\n  s := structs.New(T{})\n  for _, field := range s.Fields() {\n    switch field.Kind() {\n    case bool:\n      // do something\n    case string:\n      // do something\n    }\n  }\n}\n</code></pre>\n<p>Current the code above doesn't work because of field.Kind is a reflect.Type. Is it possible to make it work somehow?</p>\n<p>Thank you.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 64542, "user_id": 10008173, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e3ea5d6d5d63e054acb8cfa95a39240d?s=128&d=identicon&r=PG&f=1", "display_name": "David Maze", "link": "https://stackoverflow.com/users/10008173/david-maze"}, "is_accepted": false, "score": 1, "last_activity_date": 1545654825, "creation_date": 1545654825, "answer_id": 53913536, "question_id": 53913324, "link": "https://stackoverflow.com/questions/53913324/setting-variable-from-file-content-in-dockerize-golang-template/53913536#53913536", "title": "Setting variable from file content in dockerize golang template", "body": "<p>Go's <a href=\"https://godoc.org/text/template\" rel=\"nofollow noreferrer\"><code>text/template</code></a> doesn't natively support that.  It <a href=\"https://github.com/jwilder/dockerize#using-templates\" rel=\"nofollow noreferrer\">looks like</a> the dockerize tool <a href=\"https://github.com/jwilder/dockerize/blob/master/template.go#L118\" rel=\"nofollow noreferrer\">provides a couple of extension functions</a> but none of them allow this either.</p>\n\n<p>(The nearest thing I can think of is that <a href=\"/questions/tagged/kubernetes-helm\" class=\"post-tag\" title=\"show questions tagged &#39;kubernetes-helm&#39;\" rel=\"tag\">kubernetes-helm</a> supports <a href=\"https://docs.helm.sh/chart_template_guide/#accessing-files-inside-templates\" rel=\"nofollow noreferrer\">reading a file from a Helm chart</a>, but that's implemented at the Go level by injecting a special accessor object that can provides the file-access API to template code, and it's intentionally limited to files physically located within the Helm chart directory.)</p>\n"}, {"comments": [{"owner": {"reputation": 801, "user_id": 289057, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/dxijz.jpg?s=128&g=1", "display_name": "Rob Shepherd", "link": "https://stackoverflow.com/users/289057/rob-shepherd"}, "edited": false, "score": 0, "creation_date": 1546005068, "post_id": 53936163, "comment_id": 94756678, "body": "Thanks @blobdon, this was my supposition, but i&#39;m grateful for somebody more experienced in golang confirming it for me, and for the incredibly helpful pointers on implementation options."}, {"owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "reply_to_user": {"reputation": 801, "user_id": 289057, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/dxijz.jpg?s=128&g=1", "display_name": "Rob Shepherd", "link": "https://stackoverflow.com/users/289057/rob-shepherd"}, "edited": false, "score": 0, "creation_date": 1546005532, "post_id": 53936163, "comment_id": 94756880, "body": "It doesn&#39;t look like dockerize is being actively maintained anymore. Which approach do you think you&#39;ll go with?"}, {"owner": {"reputation": 801, "user_id": 289057, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/dxijz.jpg?s=128&g=1", "display_name": "Rob Shepherd", "link": "https://stackoverflow.com/users/289057/rob-shepherd"}, "edited": false, "score": 0, "creation_date": 1546013107, "post_id": 53936163, "comment_id": 94759933, "body": "For the time being, I&#39;ll probably just use <code>jq</code> to extract cert properties from <code>acme.json</code> into crt/key/bundles and them mount them into the container. if the service moves towards production, i&#39;ll work on option #1 from your ideas above. Cheers!"}], "tags": [], "owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "is_accepted": true, "score": 0, "last_activity_date": 1545851563, "creation_date": 1545851563, "answer_id": 53936163, "question_id": 53913324, "link": "https://stackoverflow.com/questions/53913324/setting-variable-from-file-content-in-dockerize-golang-template/53936163#53936163", "title": "Setting variable from file content in dockerize golang template", "body": "<p>I can't see any way to add a function to the template, as dockerize doesn't expose the addition of functions to the template prior to parsing. So you'll either have to (1) get the contents of acme.json into an environment variable, or  (2) modify dockerize to include a jsonFileQuery function in the templates.</p>\n\n<ol>\n<li><p>Add the contents of acme.json to the environment variables before running dockerize - then access as in the example. This could be done with a small go program, added to the container and run via CMD prior to the CMD dockerize</p></li>\n<li><p><em>Fork dockerize and change jsonQuery</em>: Fork dockerize and change <a href=\"https://github.com/jwilder/dockerize/blob/137d5c85b34312f136721a75a08d20eba86b194a/template.go#L83\" rel=\"nofollow noreferrer\">line 83 of template.go</a>:<br>\nfrom: <code>parser, err := gojq.NewStringQuery(jsonObj)</code><br>\nto:   <code>parser, err := gojq.NewFileQuery(jsonObj)</code><br>\nThen use:  </p>\n\n<pre><code>{{with $myJsonContent := jsonQuery \"/opt/traefik/acme.json\" \"toplevelobject\"  }}\n    # extract key to file \n{{end}}\n</code></pre>\n\n<p><a href=\"https://github.com/jwilder/gojq/blob/c550732d4a5279d37cf0064bf7f0283c2fcc44cf/gojq.go#L34\" rel=\"nofollow noreferrer\">gojq.NewStringQuery()</a> is a function behind the jsonQuery template function. The <a href=\"https://github.com/jwilder/gojq/blob/c550732d4a5279d37cf0064bf7f0283c2fcc44cf/gojq.go#L20\" rel=\"nofollow noreferrer\">gojq.NewFileQuery()</a> version has the same signature as the StringQuery but reads the file at the path in the input string instead of using the input string as json.  </p>\n\n<p>OR</p>\n\n<p><em>Merge new jsonFileQuery template function into dockerize</em>: submit an issue to dockerize to add jsonFileQuery to the template functions. Seems like it could be set up the same as jsonQuery but with the small difference above. In <a href=\"https://github.com/jwilder/dockerize/blob/137d5c85b34312f136721a75a08d20eba86b194a/template.go#L83\" rel=\"nofollow noreferrer\">template.go</a>, add the jsonFileQuery function and assign it to jsonFileQuery in the template.FuncMap{} within generateFile().</p></li>\n</ol>\n"}], "owner": {"reputation": 801, "user_id": 289057, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/dxijz.jpg?s=128&g=1", "display_name": "Rob Shepherd", "link": "https://stackoverflow.com/users/289057/rob-shepherd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 53936163, "answer_count": 2, "score": 0, "last_activity_date": 1545896917, "creation_date": 1545653675, "last_edit_date": 1545896917, "question_id": 53913324, "link": "https://stackoverflow.com/questions/53913324/setting-variable-from-file-content-in-dockerize-golang-template", "title": "Setting variable from file content in dockerize golang template", "body": "<p>I want to use the <code>jsonQuery</code> syntax in <a href=\"https://github.com/jwilder/dockerize\" rel=\"nofollow noreferrer\">dockerize</a> to parse traefik's acme.json and emit cert/key files for TLS settings in another service. </p>\n\n<p>jsonQuery accepts a string, which the example gives as an environment variable <code>{{ .Env.myJson }}</code></p>\n\n<p>How might I get the string contents of a file: </p>\n\n<pre><code>{{with $myJsonContent := &lt;insert magic here&gt; }}\n    # extract key to file \n{{end}}\n</code></pre>\n"}, {"tags": ["performance", "go", "types", "casting"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 2, "creation_date": 1545659257, "post_id": 53913098, "comment_id": 94671716, "body": "it&#39;s impossible to see what it is that you might want to change when there is no source code.  For example, it might be that the &quot;casting&quot; (actually Go doesn&#39;t have this) should happen once at the top of your function and that you are applying it to every operation.  But that&#39;s speculation!   We don&#39;t know and can&#39;t know.  If you want a proper answer then devise a simple case that shows the problem you are having"}, {"owner": {"reputation": 208, "user_id": 3143562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y9Op3.jpg?s=128&g=1", "display_name": "mkmayank", "link": "https://stackoverflow.com/users/3143562/mkmayank"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1545670093, "post_id": 53913098, "comment_id": 94674715, "body": "I have added my benchmark code in go playground, and also shared a link for it, <a href=\"https://play.golang.org/p/A52-wBo3Z34\" rel=\"nofollow noreferrer\">play.golang.org/p/A52-wBo3Z34</a>"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1545748590, "post_id": 53913098, "comment_id": 94688209, "body": "From my perspective, you should first <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">do some profiling</a> before you even start to begin benchmarking. It does not make sense to benchmark the faster parts of your program, but the choking points."}, {"owner": {"reputation": 208, "user_id": 3143562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y9Op3.jpg?s=128&g=1", "display_name": "mkmayank", "link": "https://stackoverflow.com/users/3143562/mkmayank"}, "edited": false, "score": 0, "creation_date": 1545804773, "post_id": 53913098, "comment_id": 94697384, "body": "thanks for the profiling suggestion , I will look into it"}], "answers": [{"comments": [{"owner": {"reputation": 208, "user_id": 3143562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y9Op3.jpg?s=128&g=1", "display_name": "mkmayank", "link": "https://stackoverflow.com/users/3143562/mkmayank"}, "edited": false, "score": 0, "creation_date": 1545804646, "post_id": 53923174, "comment_id": 94697359, "body": "Thanks for the time you took to write the beautiful explanation. Which leaves the question why you do not import the values as float64 the first place? As I said, my values will never be be above float32, using float64 is doubling my memory , 2GB to 4GB . And also 1 million casting not gonna happen in my real problem, but I just did bench-marking to see if casting really takes time. WIll I be correct to assume that I should go with float32 and cast to float64 whenever I need, as it not gonna affect much, until I am hungry for milliseconds?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 208, "user_id": 3143562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y9Op3.jpg?s=128&g=1", "display_name": "mkmayank", "link": "https://stackoverflow.com/users/3143562/mkmayank"}, "edited": false, "score": 1, "creation_date": 1545821002, "post_id": 53923174, "comment_id": 94702407, "body": "@mkmayank It doubles the RAM from 2 to 4 GB? So what? And even if you do not have the RAM locally: An instance with 16GB on AWS is 20 cents / h. Just my two cents (pun intended)."}, {"owner": {"reputation": 208, "user_id": 3143562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y9Op3.jpg?s=128&g=1", "display_name": "mkmayank", "link": "https://stackoverflow.com/users/3143562/mkmayank"}, "edited": false, "score": 0, "creation_date": 1545821400, "post_id": 53923174, "comment_id": 94702535, "body": "yeah, it is 2018, not 90s and memory is too cheap than CPU time, thanks anyway"}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1545748145, "last_edit_date": 1545748145, "creation_date": 1545747614, "answer_id": 53923174, "question_id": 53913098, "link": "https://stackoverflow.com/questions/53913098/how-type-casting-in-golang-works/53923174#53923174", "title": "How type casting in golang works?", "body": "<p>You have several mistakes in your logic, your benchmark and your assumptions.</p>\n\n<p>As for the casting, your results show that your for loop is run 1000 times. Since you loop 1M times, that actually makes 1 billion casting operations... not too shabby.</p>\n\n<p>Actually, I have reworked your code a bit:</p>\n\n<pre><code>const (\n    min = float64(math.SmallestNonzeroFloat32)\n    max = float64(math.MaxFloat32)\n)\n\nfunc cast(in float64) (out float32, err error) {\n\n    // We need to guard here, as casting from float64 to float32 looses precision\n    // Therefor, we might get out of scope.\n    if in &lt; min {\n        return 0.00, fmt.Errorf(\"%f is smaller than smallest float32 (%f)\", in, min)\n    } else if in &gt; max {\n        return 0.00, fmt.Errorf(\"%f is bigger than biggest float32 (%f)\", in, max)\n    }\n\n    return float32(in), nil\n}\n\n// multi64 uses a variadic in parameter, in order to be able\n// to use the multiplication with arbitrary length.\nfunc multi64(in ...float64) (result float32, err error) {\n\n    // Necessary to set it to 1.00, since float64's null value is 0.00...\n    im := float64(1.00)\n\n    for _, v := range in {\n        im = im * v\n    }\n\n    // We only need to cast once.\n    // You DO want to make the calculation with the original precision and only\n    // want to do the casting ONCE. However, this should not be done here - but in the\n    // caller, as the caller knows on how to deal with special cases.\n    return cast(im)\n}\n\n// multi32 is a rather non-sensical wrapper, since the for loop\n// could easily be done in the caller.\n// It is only here for comparison purposes.\nfunc multi32(in ...float32) (result float32) {\n    result = 1.00\n    for _, v := range in {\n        result = result * v\n    }\n    return result\n}\n\n// openFile is here for comparison to show that you can do\n// a... fantastic metric ton of castings in comparison to IO ops.\nfunc openFile() error {\n    f, err := os.Open(\"cast.go\")\n    if err != nil {\n        return fmt.Errorf(\"Error opening file\")\n    }\n    defer f.Close()\n\n    br := bufio.NewReader(f)\n    if _, _, err := br.ReadLine(); err != nil {\n        return fmt.Errorf(\"Error reading line: %s\", err)\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>With the following testcode</p>\n\n<pre><code>func init() {\n    rand.Seed(time.Now().UTC().UnixNano())\n}\nfunc BenchmarkCast(b *testing.B) {\n    b.StopTimer()\n\n    v := rand.Float64()\n    var err error\n\n    b.ResetTimer()\n    b.StartTimer()\n\n    for i := 0; i &lt; b.N; i++ {\n        if _, err = cast(v); err != nil {\n            b.Fail()\n        }\n    }\n}\n\nfunc BenchmarkMulti32(b *testing.B) {\n    b.StopTimer()\n\n    vals := make([]float32, 10)\n\n    for i := 0; i &lt; 10; i++ {\n        vals[i] = rand.Float32() * float32(i+1)\n    }\n\n    b.ResetTimer()\n    b.StartTimer()\n\n    for i := 0; i &lt; b.N; i++ {\n        multi32(vals...)\n    }\n}\nfunc BenchmarkMulti64(b *testing.B) {\n\n    b.StopTimer()\n\n    vals := make([]float64, 10)\n    for i := 0; i &lt; 10; i++ {\n        vals[i] = rand.Float64() * float64(i+1)\n    }\n\n    var err error\n    b.ResetTimer()\n    b.StartTimer()\n\n    for i := 0; i &lt; b.N; i++ {\n        if _, err = multi64(vals...); err != nil {\n            b.Log(err)\n            b.Fail()\n        }\n    }\n}\n\nfunc BenchmarkOpenFile(b *testing.B) {\n    var err error\n    for i := 0; i &lt; b.N; i++ {\n        if err = openFile(); err != nil {\n            b.Log(err)\n            b.Fail()\n        }\n    }\n}\n</code></pre>\n\n<p>You get something like this</p>\n\n<pre><code>BenchmarkCast-4         1000000000           2.42 ns/op\nBenchmarkMulti32-4       300000000           5.04 ns/op\nBenchmarkMulti64-4       200000000           8.19 ns/op\nBenchmarkOpenFile-4         100000          19591 ns/op\n</code></pre>\n\n<p>So, even with this relatively stupid and non optimized code, the perpetrator is the openFile benchmark.</p>\n\n<p>Now, let us put this into perspective. 19,562ns equals to 0,019562 milliseconds. The average human can perceive latencies of about 20 milliseconds. So even those 100,000 (<em>\"one hundred thousand\"</em>) file openings, line reads and file closes are about 1000 times faster than a human can perceive.</p>\n\n<p>Casting, compared to this is several <strong><em>orders of magnitude</em></strong> faster - so cast all you like, your bottleneck will be I/O.</p>\n\n<h2>Edit</h2>\n\n<p>Which leaves the question why you do not import the values as float64 the first place?</p>\n"}], "owner": {"reputation": 208, "user_id": 3143562, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/y9Op3.jpg?s=128&g=1", "display_name": "mkmayank", "link": "https://stackoverflow.com/users/3143562/mkmayank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 805, "favorite_count": 0, "accepted_answer_id": 53923174, "answer_count": 1, "score": 0, "last_activity_date": 1545748145, "creation_date": 1545652505, "question_id": 53913098, "link": "https://stackoverflow.com/questions/53913098/how-type-casting-in-golang-works", "title": "How type casting in golang works?", "body": "<p>My problem statement is to load and save binary files with numbers and these numbers can be easily stored in <code>uint32/float32</code>. This gonna be around more than 2GB on disk and all need to be on memory too.</p>\n\n<p>My program will require a lot of mathematical operations and golang standard libraries functions/methods require <code>int/float64</code> parameters, and I have to cast my numbers to <code>int/float64</code></p>\n\n<p>A simple benchmark ( <a href=\"https://play.golang.org/p/A52-wBo3Z34\" rel=\"nofollow noreferrer\">https://play.golang.org/p/A52-wBo3Z34</a> ) test gave the following output :</p>\n\n<pre><code>$: go test -bench=. \ngoos: linux\ngoarch: amd64\npkg: gotrade\nBenchmarkCast-4             1000       1519964 ns/op\nBenchmarkNoCast-4           3000        373340 ns/op\nPASS\nok      gotrade 2.843s\n</code></pre>\n\n<p>This clearly show that type casting is quite expensive.</p>\n\n<p>Demerits of int and float64 :</p>\n\n<ul>\n<li>it requires almost the double memory</li>\n</ul>\n\n<p>Merits of int and float64 :</p>\n\n<ul>\n<li>avoids lot of type casting operations</li>\n</ul>\n\n<p>Please suggest me a way to deal with this situation, am I missing something here ?</p>\n\n<p>Should we always opt for <code>int</code> and <code>float64</code>, if we require external computations via standard libraries ?</p>\n"}, {"tags": ["go", "beego"], "answers": [{"tags": [], "owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "is_accepted": false, "score": 0, "last_activity_date": 1545777074, "last_edit_date": 1545777074, "creation_date": 1545776153, "answer_id": 53925959, "question_id": 53912855, "link": "https://stackoverflow.com/questions/53912855/how-to-apply-bootstrap-styling-to-auto-generated-form/53925959#53925959", "title": "How to apply bootstrap styling to auto-generated form", "body": "<p>Try adding class tags to the struct fields:</p>\n\n<pre><code>type User struct {\n    Id    int         `form:\"-\"`\n    Name  interface{} `form:\"username\" class:\"form-control\"`\n    Age   int         `form:\"age,text,age:\" class:\"form-control\"`\n    Sex   string\n    Intro string      `form:\",textarea\" class:\"form-control\"`\n}\n\n&lt;form action=\"\" method=\"post\"&gt;\n    {{.Form | renderform}}\n&lt;/form&gt;\n</code></pre>\n\n<p>The exported func <code>RenderForm</code> calls <code>parseFormTag</code> for each field of the struct and gets variable <code>class</code> in the return (<a href=\"https://github.com/astaxie/beego/blob/ad0d166d46c8a2dfa3775abf1eae8931a287efeb/templatefunc.go#L449\" rel=\"nofollow noreferrer\">source code</a>). </p>\n\n<p><code>parseFormTag</code> gets <code>class</code> from the class tag within the struct field tag (<a href=\"https://github.com/astaxie/beego/blob/ad0d166d46c8a2dfa3775abf1eae8931a287efeb/templatefunc.go#L501\" rel=\"nofollow noreferrer\">source code</a>).</p>\n\n<p><code>RenderForm</code> then calls <code>renderFormField</code> for that field, passing in <code>class</code>. <code>renderFormField</code> adds <code>class</code> to the string that will eventually be used by <code>RenderForm</code> to create the HTML for the form (<a href=\"https://github.com/astaxie/beego/blob/ad0d166d46c8a2dfa3775abf1eae8931a287efeb/templatefunc.go#L475\" rel=\"nofollow noreferrer\">source code</a>).</p>\n"}], "owner": {"reputation": 886, "user_id": 1619524, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/b4c576b8a343b40cd00f38be1513a92d?s=128&d=identicon&r=PG", "display_name": "user1619524", "link": "https://stackoverflow.com/users/1619524/user1619524"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1545777074, "creation_date": 1545650940, "last_edit_date": 1545651328, "question_id": 53912855, "link": "https://stackoverflow.com/questions/53912855/how-to-apply-bootstrap-styling-to-auto-generated-form", "title": "How to apply bootstrap styling to auto-generated form", "body": "<p>Using beego render form to build html form\n<a href=\"https://beego.me/docs/mvc/view/view.md#renderform\" rel=\"nofollow noreferrer\">https://beego.me/docs/mvc/view/view.md#renderform</a></p>\n\n<pre><code>type User struct {\nId    int         `form:\"-\"`\nName  interface{} `form:\"username\"`\nAge   int         `form:\"age,text,age:\"`\nSex   string\nIntro string `form:\",textarea\"`\n}\n\n&lt;form action=\"\" method=\"post\"&gt;\n{{.Form | renderform}}\n&lt;/form&gt;\n</code></pre>\n\n<p>This renders the form correctly but with poor html formatting\n<a href=\"https://i.stack.imgur.com/KK9jk.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/KK9jk.png\" alt=\"enter image description here\"></a></p>\n\n<p>What can I do to add bootstrap 4 stlying</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": true, "score": 1, "last_activity_date": 1545650803, "creation_date": 1545650803, "answer_id": 53912831, "question_id": 53912778, "link": "https://stackoverflow.com/questions/53912778/unmarshal-json-with-an-array/53912831#53912831", "title": "Unmarshal JSON with an array", "body": "<p>You have to call :</p>\n\n<pre><code>fmt.Println(s.Rows[0].ID)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "is_accepted": false, "score": 1, "last_activity_date": 1545653681, "creation_date": 1545653681, "answer_id": 53913326, "question_id": 53912778, "link": "https://stackoverflow.com/questions/53912778/unmarshal-json-with-an-array/53913326#53913326", "title": "Unmarshal JSON with an array", "body": "<p>You define  <code>Rows</code> as slice of struct that means you should iterate Rows with <a href=\"https://gobyexample.com/range\" rel=\"nofollow noreferrer\">for</a> for execution of values. </p>\n\n<pre><code>for _, item := range s.Rows {\n        fmt.Println(item.ID)\n} \n</code></pre>\n"}], "owner": {"reputation": 775, "user_id": 5686966, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/vnRou.jpg?s=128&g=1", "display_name": "mapmalith", "link": "https://stackoverflow.com/users/5686966/mapmalith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 445, "favorite_count": 0, "accepted_answer_id": 53912831, "answer_count": 2, "score": 1, "last_activity_date": 1545679166, "creation_date": 1545650519, "last_edit_date": 1545679166, "question_id": 53912778, "link": "https://stackoverflow.com/questions/53912778/unmarshal-json-with-an-array", "title": "Unmarshal JSON with an array", "body": "<p>I am trying to Unmarshal the following JSON object which is generated by couchDB and returns for a cURL request in Go, the cURL request code is not mentioned here as it is out of scope of this question and I have assigned it to the variable called <code>mail</code> in the code section.</p>\n\n<p>the JSON data structure:</p>\n\n<pre><code>{\n\"total_rows\": 4,\n\"offset\": 0,\n\"rows\": [{\n              \"id\": \"36587e5d091a0d49f739c25c0b000c05\",\n              \"key\": \"36587e5d091a0d49f739c25c0b000c05\",\n              \"value\": {\n                          \"rev\": \"1-92471472a3de492b8657d3103f5f6e0d\"\n                       }\n        }]\n}\n</code></pre>\n\n<p>and here is my code to unmarshel the above JSON object,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype Couchdb struct {\n    TotalRows int `json:\"total_rows\"`\n    Offset    int `json:\"offset\"`\n    Rows      []struct {\n        ID    string `json:\"id\"`\n        Key   string `json:\"key\"`\n        Value struct {\n             Rev string `json:\"rev\"`\n        } `json:\"value\"`\n    } `json:\"rows\"`\n}\n\nfunc main() {\n     mail := []byte(`{\"total_rows\":4,\"offset\":0,\"rows\":[{\"id\":\"36587e5d091a0d49f739c25c0b000c05\",\"key\":\"36587e5d091a0d49f739c25c0b000c05\",\"value\":{\"rev\":\"1-92471472a3de492b8657d3103f5f6e0d\"}}]}`)\n\n     var s Couchdb\n     err := json.Unmarshal(mail, &amp;s)\n     if err != nil {\n         panic(err)\n     }\n\n\n     //fmt.Printf(\"%v\", s.TotalRows)\n     fmt.Printf(\"%v\", s.Rows)\n}\n</code></pre>\n\n<p>and the above code is working fine and you can access the working code here <a href=\"https://play.golang.org/p/fwU6jQiTn-x\" rel=\"nofollow noreferrer\">with this link</a> in the Go Play Ground.</p>\n\n<p>I need to get the <code>36587e5d091a0d49f739c25c0b000c05</code> value which is the <code>id</code> of <code>rows</code> so I am trying to do it like this</p>\n\n<p><code>fmt.Printf(\"%v\", s.Rows.ID)</code></p>\n\n<p>and it returns this error\n<code>prog.go:33:25: s.Rows.ID undefined (type []struct { ID string \"json:\\\"id\\\"\"; Key string \"json:\\\"key\\\"\"; Value struct { Rev string \"json:\\\"rev\\\"\" } \"json:\\\"value\\\"\" } has no field or method ID)</code></p>\n\n<p>but it works for <code>fmt.Printf(\"%v\", s.Rows)</code> and it returns</p>\n\n<p><code>[{36587e5d091a0d49f739c25c0b000c05 36587e5d091a0d49f739c25c0b000c05 {1-92471472a3de492b8657d3103f5f6e0d}}]</code></p>\n\n<p>My ultimate goal is to get <code>36587e5d091a0d49f739c25c0b000c05</code> and assign it to GO variable but stuck getting that value using GO.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545650683, "post_id": 53912597, "comment_id": 94669165, "body": "How are you running it locally? I mean what command and args are you using to run the local instance? And what are the <code>package</code> declarations in those multiple files? Are you using <code>package main</code> in both? Or something else?"}, {"owner": {"reputation": 1188, "user_id": 601129, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79302abb012690ffb17af0329d28a2df?s=128&d=identicon&r=PG&f=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/601129/aap"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545651157, "post_id": 53912597, "comment_id": 94669302, "body": "yes, both files have &#39;package main&#39;. I run it locally using &#39;go run main.go datastore.go&#39;"}, {"owner": {"reputation": 1188, "user_id": 601129, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79302abb012690ffb17af0329d28a2df?s=128&d=identicon&r=PG&f=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/601129/aap"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545651271, "post_id": 53912597, "comment_id": 94669340, "body": "and running &#39;go build&#39; generates the binary as well"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545651377, "post_id": 53912597, "comment_id": 94669372, "body": "Have you got any other go files in the project&#39;s directory?"}, {"owner": {"reputation": 1188, "user_id": 601129, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79302abb012690ffb17af0329d28a2df?s=128&d=identicon&r=PG&f=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/601129/aap"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545651570, "post_id": 53912597, "comment_id": 94669435, "body": "ah I forgot to mention that I also have a proto/myfile.pb.go file in that folder which is being referenced by main.go and works fine locally"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545652084, "post_id": 53912597, "comment_id": 94669579, "body": "What&#39;s the package declaration of that pb.go file?"}, {"owner": {"reputation": 1188, "user_id": 601129, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79302abb012690ffb17af0329d28a2df?s=128&d=identicon&r=PG&f=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/601129/aap"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545652175, "post_id": 53912597, "comment_id": 94669616, "body": "package name is: com_plotter"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545652884, "post_id": 53912597, "comment_id": 94669812, "body": "What about your yaml file, how does that look?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545653237, "post_id": 53912597, "comment_id": 94669916, "body": "Just to clarify, the problem stems from, I believe, the fact that appengine is attempting to build your app using <code>go build</code> with <code>-o</code> and with <code>.&#47;...</code>. If you read the section on <code>-o</code> <a href=\"https://golang.org/cmd/go/#hdr-Compile_packages_and_dependencies\" rel=\"nofollow noreferrer\">here</a> and if you know that <code>.&#47;...</code> will attempt to build subpackages as well you&#39;ll understand what the error <code>go build: cannot use -o with multiple packages</code> indicates..."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545653242, "post_id": 53912597, "comment_id": 94669917, "body": "...  and that appengine probably shouldn&#39;t use <code>.&#47;...</code> in its build command. I haven&#39;t used appengine for ages now and I do not have it installed but if you can configure it so that it doesn&#39;t use <code>.&#47;...</code> you may be able to fix the problem."}, {"owner": {"reputation": 1188, "user_id": 601129, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79302abb012690ffb17af0329d28a2df?s=128&d=identicon&r=PG&f=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/601129/aap"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545654331, "post_id": 53912597, "comment_id": 94670225, "body": "thanks. yaml is plain boring: &#39;runtime: go111&#39;"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545654518, "post_id": 53912597, "comment_id": 94670279, "body": "... and if you&#39;re unable to configure appengine to not use <code>.&#47;...</code> you may be able to work around the issue by putting the com_plotter package into an adjacent directory as opposed to a subdirectory. Alternatively you should also be able to vendor the dependency, ie putting it under the <code>&lt;my_project&gt;&#47;vendor</code> because I believe <code>go build</code> with <code>.&#47;...</code> skips over files that live under the vendor directory."}], "owner": {"reputation": 1188, "user_id": 601129, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/79302abb012690ffb17af0329d28a2df?s=128&d=identicon&r=PG&f=1", "display_name": "AAP", "link": "https://stackoverflow.com/users/601129/aap"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 178, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545656500, "creation_date": 1545649505, "last_edit_date": 1545656500, "question_id": 53912597, "link": "https://stackoverflow.com/questions/53912597/appengine-go1-11-beta-deployment-failure", "title": "Appengine Go1.11 beta deployment failure", "body": "<p>I am trying my hands on Go, and started with the go1.11 beta.\nThe first Hello world example worked fine and I was able to view it via the browser.</p>\n\n<p>In my second attempt, I created multiple .go files (main.go, datastore.go).\nI am able to run it locally and it works fine.</p>\n\n<p>However when I attempt to deploy, I get the following error (deployment in first example worked just fine):</p>\n\n<pre><code>gcloud app deploy\n...\nFile upload done.\nUpdating service [default]...failed.\nERROR: (gcloud.app.deploy) Error Response: [9] Cloud build 67d67177-13cd-4e80-980a-ea36a0760678 status: FAILURE.\nBuild error details: go build: cannot use -o with multiple packages\n</code></pre>\n\n<p>On the server, the build logs show:</p>\n\n<pre><code>Step #1 - \"builder\": building app with command '[go build -o /tmp/staging735225713/usr/local/bin/start ./...]', env '[PATH=/go/bin:/usr/local/go/bin:/builder/google-cloud-sdk/bin/:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin HOSTNAME=d0f271c7f5b8 HOME=/builder/home BUILDER_OUTPUT=/builder/outputs DEBIAN_FRONTEND=noninteractive GOROOT=/usr/local/go/ GOPATH=/go GOPATH=/tmp/staging735225713/srv/gopath]': err=exit status 1, out=go build: cannot use -o with multiple packages\nFinished Step #1 - \"builder\"\nERROR\nERROR: build step 1 \"gcr.io/gae-runtimes/go111_app_builder:go111_20181212_RC00\" failed: exit status 1\n</code></pre>\n\n<p>What am I doing wrong?</p>\n\n<p>UPDATE:\nTried various things, including subfolder or a 'vendor' folder as suggested, but no avail.</p>\n\n<pre><code>Updating service [default]...failed.                                                                                                                                                                       \nERROR: (gcloud.app.deploy) Error Response: [9] Cloud build 79c39e82-3185-4ae1-a7ff-6afa1be448e7 status: FAILURE.\nBuild error details: srv/proto/myfile.pb.go:8:2: cannot find package \"github.com/golang/protobuf/proto\" in any of:\n    /usr/local/go/src/github.com/golang/protobuf/proto (from $GOROOT)\n    /tmp/staging770905501/srv/gopath/src/github.com/golang/protobuf/proto (from $GOPATH)\n</code></pre>\n"}, {"tags": ["go", "aws-lambda", "config", "serverless"], "answers": [{"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 0, "last_activity_date": 1545651719, "creation_date": 1545651719, "answer_id": 53912981, "question_id": 53912339, "link": "https://stackoverflow.com/questions/53912339/how-to-provide-config-values-for-lambda-functions-using-golang/53912981#53912981", "title": "How to provide config values for lambda functions using golang", "body": "<p>Add the config files to the zip containing the Go binary</p>\n\n<p>For example, assuming you have a Handler.go with a configs directory containing configs.json then</p>\n\n<pre><code>go build -o Handler Handler.go &amp;&amp; chmod +x Handler &amp;&amp; zip -r handler.zip Handler configs\n</code></pre>\n\n<p>should make a zip containing the configs directory and the Handler binary which can be uploaded to Lambda</p>\n\n<p>There are alternatives to using files such as AWS Parameter Store that you may wish to consider</p>\n"}], "owner": {"reputation": 81, "user_id": 3431651, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/195ed056c5b7d23737a49f1a79b6eb9a?s=128&d=identicon&r=PG&f=1", "display_name": "user3431651", "link": "https://stackoverflow.com/users/3431651/user3431651"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 0, "accepted_answer_id": 53912981, "answer_count": 1, "score": 0, "last_activity_date": 1545651719, "creation_date": 1545648321, "question_id": 53912339, "link": "https://stackoverflow.com/questions/53912339/how-to-provide-config-values-for-lambda-functions-using-golang", "title": "How to provide config values for lambda functions using golang", "body": "<p>How to provide config files along with the lambda function written in golang. I created a folder named config inside the project root and provided the config.But unfortunately that doesn't worked after the project got build.And I know this is because of we are building it as a binary file.So, What was the best way or approach to provide config files along with the lambda function for golang?</p>\n\n<pre><code>var config map[string]string\nvar filename string\n\n//Checks the stage and loads the Configuration file\nif len(event.Stage) &gt; 0 {\n    filename = \"configs/config.json\"\n}\n\nconfigFile, err := os.Open(filename)\ndefer configFile.Close()\nif err != nil {\n    log.Printf(err.Error())\n    return config, err\n}\njsonParser := json.NewDecoder(configFile)\nerr = jsonParser.Decode(&amp;config)\nreturn config, err\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1545644215, "post_id": 53911502, "comment_id": 94667150, "body": "You&#39;ll have to ask the library authors."}], "answers": [{"comments": [{"owner": {"reputation": 11210, "user_id": 725937, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/32cba7500e49d4c491289f9e101c693b?s=128&d=identicon&r=PG", "display_name": "abergmeier", "link": "https://stackoverflow.com/users/725937/abergmeier"}, "edited": false, "score": 0, "creation_date": 1561036428, "post_id": 53911946, "comment_id": 99939107, "body": "This is an implementation detail and in no way enforced by the JSON spec. The reason @Vorsprung gives is probably one factor in order to unmarshal with Javascript."}, {"owner": {"reputation": 347, "user_id": 3839186, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d48a13cfa5e9e411f5493819eb03d81?s=128&d=identicon&r=PG", "display_name": "cherrot", "link": "https://stackoverflow.com/users/3839186/cherrot"}, "edited": false, "score": 0, "creation_date": 1612247455, "post_id": 53911946, "comment_id": 116699829, "body": "<a href=\"https://github.com/grpc-ecosystem/grpc-gateway/issues/438#issuecomment-330739676\" rel=\"nofollow noreferrer\">github.com/grpc-ecosystem/grpc-gateway/issues/&hellip;</a>"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 2, "last_activity_date": 1545646015, "creation_date": 1545646015, "answer_id": 53911946, "question_id": 53911502, "link": "https://stackoverflow.com/questions/53911502/jsonpb-why-decode-int64-to-json-the-result-is-string-like-int64-str-10-str/53911946#53911946", "title": "jsonpb, why decode int64 to json,the result is string. like int64 str=10 --&gt;str:&quot;10&quot;", "body": "<p>Because way that integers are represented in javascript means that the maximum integer is (2 to the power of 53)-1 (see <a href=\"https://stackoverflow.com/a/307200/1153938\">https://stackoverflow.com/a/307200/1153938</a>)</p>\n\n<p>The biggest int from an <code>int64</code> is larger than that, so in order to protect from the case of large ints, the library does a string of digits instead</p>\n\n<p>As javascript numbers are signed the same goes for large negative numbers</p>\n"}], "owner": {"reputation": 17, "user_id": 4443625, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7331F.jpg?s=128&g=1", "display_name": "zzhongcy", "link": "https://stackoverflow.com/users/4443625/zzhongcy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 934, "favorite_count": 1, "answer_count": 1, "score": -2, "last_activity_date": 1545666582, "creation_date": 1545643489, "last_edit_date": 1545666582, "question_id": 53911502, "link": "https://stackoverflow.com/questions/53911502/jsonpb-why-decode-int64-to-json-the-result-is-string-like-int64-str-10-str", "title": "jsonpb, why decode int64 to json,the result is string. like int64 str=10 --&gt;str:&quot;10&quot;", "body": "<pre><code>//code:630\n\n//jsonpb, why int64 -&gt; json is string. like 10--&gt;\"10\"\n\n//https://github.com/golang/protobuf/blob/master/jsonpb/jsonpb.go\n\n// Default handling defers to the encoding/json library.\nb, err := json.Marshal(v.Interface())\nif err != nil {\n    return err\n}\nneedToQuote := string(b[0]) != `\"` &amp;&amp; (v.Kind() == reflect.Int64 || v.Kind() == reflect.Uint64)\nif needToQuote {\n    out.write(`\"`)\n}\nout.write(string(b))\nif needToQuote {\n    out.write(`\"`)\n}\n</code></pre>\n\n<p><strong>Question:</strong></p>\n\n<p>Why append \"\\'\" around the value?</p>\n"}, {"tags": ["java", "performance", "go", "io"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1545641427, "post_id": 53911155, "comment_id": 94666308, "body": "Yes there&#39;s a problem. The problem is that the main thing you&#39;re testing is the startup overhead for each runtime."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1545641657, "post_id": 53911155, "comment_id": 94666388, "body": "Microbenchmark. Waste of time."}, {"owner": {"reputation": 187, "user_id": 8525899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etri8.jpg?s=128&g=1", "display_name": "Lau Real", "link": "https://stackoverflow.com/users/8525899/lau-real"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1545644609, "post_id": 53911155, "comment_id": 94667278, "body": "@Flimzy So the result shows golang runtime&#39;s start up for goroutine is faster than java?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 3, "creation_date": 1545644696, "post_id": 53911155, "comment_id": 94667312, "body": "Well, what a surprise... Native code vs byte code... Guess who wins <b><i>always</i></b> on the first 10 yards..."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1545644880, "post_id": 53911155, "comment_id": 94667378, "body": "&quot;start up for goroutine&quot;?  What does that mean? All I&#39;m saying is what is already obvious: Go has lower startup overhead than Java, and this is what your benchmark shows."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1545645008, "post_id": 53911155, "comment_id": 94667411, "body": "<a href=\"https://stackoverflow.com/questions/504103/how-do-i-write-a-correct-micro-benchmark-in-java\" title=\"how do i write a correct micro benchmark in java\">stackoverflow.com/questions/504103/&hellip;</a> .   look at that for the java.  For the Go, use the testing package, see <a href=\"https://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go</a>"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 1, "creation_date": 1545645061, "post_id": 53911155, "comment_id": 94667428, "body": "basically (sorry) your approach is so flawed it&#39;s difficult to list all the problems"}, {"owner": {"reputation": 187, "user_id": 8525899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etri8.jpg?s=128&g=1", "display_name": "Lau Real", "link": "https://stackoverflow.com/users/8525899/lau-real"}, "reply_to_user": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1545702576, "post_id": 53911155, "comment_id": 94680267, "body": "@Vorsprung Thanks very much for ur sharing, I&#39;ll do a further research with ur links."}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 8525899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etri8.jpg?s=128&g=1", "display_name": "Lau Real", "link": "https://stackoverflow.com/users/8525899/lau-real"}, "edited": false, "score": 0, "creation_date": 1545702394, "post_id": 53912037, "comment_id": 94680258, "body": "Thanks very much for the very detail answer! Now I have a better understanding on performance scenario."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 187, "user_id": 8525899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etri8.jpg?s=128&g=1", "display_name": "Lau Real", "link": "https://stackoverflow.com/users/8525899/lau-real"}, "edited": false, "score": 0, "creation_date": 1545753683, "post_id": 53912037, "comment_id": 94689290, "body": "@LauReal, &#171;To actually measure IO performance, you would need very large IO operations.&#187;\u2014and this mostly measures the speed at which the page cache\u2192filesystem\u2192io scheduler\u2192drive perform <i>sequential</i> (on different levels) I/O. Conversely, processing lots of small files\u2014especially if they are located in different directories\u2014would tilt this picture quite noticeably as you&#39;d then measure different aspects of the various blocks in the chain above."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 187, "user_id": 8525899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etri8.jpg?s=128&g=1", "display_name": "Lau Real", "link": "https://stackoverflow.com/users/8525899/lau-real"}, "edited": false, "score": 0, "creation_date": 1545753807, "post_id": 53912037, "comment_id": 94689312, "body": "@LauReal,  All in all, I&#39;d recommend reading a good background book on how a (typical) OS is implemented and then proceed with learning more low-level details about the OS you&#39;re targeting. And it worth reiterating that benchmarks like yours\u2014unless you manage to build some gross bloopers in them, like woefully ineffective memory management,\u2014are going to be dominated by the time spent in the system calls into the OS, which actually performs the I/O in the commodity OSes of the present day."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1545753994, "post_id": 53912037, "comment_id": 94689351, "body": "@kostix I kind of disagree. That would be based on the assumption that files are actually written sequentially. On a different level, one might actually want to know how a certain program behanves on different file- and/or operating systems. So while in fact one measures a lot of OS implementation details using benchmarks, this might well be the actual idea."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 2, "last_activity_date": 1545646459, "creation_date": 1545646459, "answer_id": 53912037, "question_id": 53911155, "link": "https://stackoverflow.com/questions/53911155/io-performance-between-go-and-java/53912037#53912037", "title": "IO Performance between Go and Java", "body": "<p>I see several problems with that, both from a conceptual point of view as well as a technical.</p>\n\n<p>You use a channel to return your result set (good, kind of), but then, you simply throw the result away. Furthermore, you are using an unbuffered channel, so you have a choking point there. Note that this is not a problem per s\u00e9, since pipelines are a great way of structuring your program - you simply used it in a wrong way here, imho. Something in the line of</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nfunc main() {\n    le := 1000\n\n    // We want to wait until the operations finish\n    var wg sync.WaitGroup\n\n    // We \"prealloc\" err, since we do not want le * allocations\n    var err error\n\n\n    start := time.Now()\n    for i := 0; i &lt; le; i++ {\n\n        // Add an operation to wait for to the group\n        wg.Add(1)\n        go func() {\n            // Ensure the WaitGroup is notified we are done (bar a panic)\n            defer wg.Done()\n\n            // Short notation, since we are not interested in the result set\n            if _,err = ioutil.ReadFile(fileName);err!=nil{\n             fmt.Println(\"read file error\")\n            }\n\n        }()\n\n    }\n\n    // Wait until all operations are finished.\n    wg.Wait()\n    fmt.Printf(\"%d iterations took %s\", le, time.Since(start))\n}\n</code></pre>\n\n<p>would be my solution. If I had the idea to do something like this.</p>\n\n<p>But if we have a deep look into the code, basically the only working component here is <code>ioutil.ReadFile</code>. Using this for program parts which are worth benchmarking is a Very Bad Idea\u2122 in the first place. It should be used for rather small files (like config files, for example) - which in itself is rather not a part of your program you want to benchmark.</p>\n\n<p>What you <em>do</em> want to benchmark is the processing logic of the files you just read. Let me give you an example: Say you want to read in a bunch of small JSON files, unmarshal them, modify them, marshal them again and send them to a REST API. So, what part of your program would you want to benchmark in this case? My bet goes onto the logic processing the files. Because that is the part of the program you <em>can</em> actually optimize. You can neither optimize <code>ioutil.ReadFile</code> nor the server. Unless you happen to write this one, too. In which case you would want to benchmark the server logic from within the server package.</p>\n\n<p>Last, but not least, your question is titled \"IO Performance between Go and Java\". To actually measure IO performance, you would need very large IO operations. I tend to use ISO images for this - real world data I tend to have laying around. </p>\n"}], "owner": {"reputation": 187, "user_id": 8525899, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etri8.jpg?s=128&g=1", "display_name": "Lau Real", "link": "https://stackoverflow.com/users/8525899/lau-real"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 609, "favorite_count": 0, "accepted_answer_id": 53912037, "answer_count": 1, "score": -5, "last_activity_date": 1545646459, "creation_date": 1545641273, "question_id": 53911155, "link": "https://stackoverflow.com/questions/53911155/io-performance-between-go-and-java", "title": "IO Performance between Go and Java", "body": "<p>I had a simple performance test between go(1.11) and java(1.8) on my Mac(version Majave) with 4Cpus/i5 and 16G memory, I found that, reading a small file, golang is 6~7 times faster than java. Below is my test code, I want to confirm whether my test code wrong or I missed something?</p>\n\n<ol>\n<li>Java</li>\n</ol>\n\n<p>with <strong>concurrent.ExecutorService</strong></p>\n\n<pre><code>import java.io.*;\nimport java.text.SimpleDateFormat;\nimport java.util.ArrayList;\nimport java.util.Date;\nimport java.util.List;\nimport java.util.concurrent.Callable;\nimport java.util.concurrent.ExecutorService;\nimport java.util.concurrent.Executors;\nimport java.util.concurrent.Future;\n\n\n\nclass TaskWithResult implements Callable&lt;String&gt; {\n        private static String readToString() {\n        String fileName = \"/Users/pis/IdeaProjects/Test/src/data/test.txt\";\n        File file = new File(fileName);\n        Long filelength = file.length();\n        byte[] filecontent = new byte[filelength.intValue()];\n        try {\n            FileInputStream in = new FileInputStream(file);\n            in.read(filecontent);\n            in.close();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n        SimpleDateFormat myFmt=new SimpleDateFormat(\"yyyy-MM-dd HH: mm: ss: SSS: \");\n        Date d1 = new Date();\n        return myFmt.format(d1);\n    }\n\n    /**\n     * \u4efb\u52a1\u7684\u5177\u4f53\u8fc7\u7a0b\uff0c\u4e00\u65e6\u4efb\u52a1\u4f20\u7ed9ExecutorService\u7684submit\u65b9\u6cd5\uff0c\n     * \u5219\u8be5\u65b9\u6cd5\u81ea\u52a8\u5728\u4e00\u4e2a\u7ebf\u7a0b\u4e0a\u6267\u884c\n     */\n    public String call() throws Exception {\n        String result = readToString();\n        System.out.println(result);\n        //\u8be5\u8fd4\u56de\u7ed3\u679c\u5c06\u88abFuture\u7684get\u65b9\u6cd5\u5f97\u5230\n        return result;\n    }\n}\n\n\npublic class readFile{\n    public static void main(String args[]){\n        ExecutorService es = Executors.newFixedThreadPool(5);\n        List&lt;Future&lt;String&gt;&gt; resultList = new ArrayList&lt;Future&lt;String&gt;&gt;();\n        SimpleDateFormat myFmt=new SimpleDateFormat(\"yyyy-MM-dd HH: mm: ss: SSS\");\n        Date d1 = new Date();\n        System.out.println(\"Start Time:\"+myFmt.format(d1));\n        for (int i = 0; i &lt; 1000; i++){\n            //\u4f7f\u7528ExecutorService\u6267\u884cCallable\u7c7b\u578b\u7684\u4efb\u52a1\uff0c\u5e76\u5c06\u7ed3\u679c\u4fdd\u5b58\u5728future\u53d8\u91cf\u4e2d\n            Future&lt;String&gt; future = es.submit(new TaskWithResult());\n            //\u5c06\u4efb\u52a1\u6267\u884c\u7ed3\u679c\u5b58\u50a8\u5230List\u4e2d\n            resultList.add(future);\n        }\n    }\n\n}\n</code></pre>\n\n<ol start=\"2\">\n<li>Go</li>\n</ol>\n\n<p>with <strong>channel</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"time\"\n)\n\nfunc readFile(fileName string, p chan string)chan string {\n    f, err := ioutil.ReadFile(fileName)\n    if err!=nil{\n        fmt.Println(\"read file error\")\n    }\n    p&lt;-string(f)\n    return p\n}\n\nfunc main() {\n    le := 1000\n    p := make(chan string, le)\n    start := time.Now()\n    for i:=0;i&lt;le;i++{\n        go readFile(\"test.txt\", p)\n    }\n    fmt.Println(fmt.Sprintf(\"Start Time: %s\", start))\n    for i:=0;i&lt;le;i++{\n        &lt;-p\n        fmt.Println(fmt.Sprintf(\"End Time: %s, duration: %f\", time.Now(), time.Since(start).Seconds()))\n    }\n\n}\n</code></pre>\n\n<ul>\n<li><p>Result</p>\n\n<ul>\n<li><p>Go\uff1a<strong>complete all task in about 0.0197s</strong></p>\n\n<p>Start Time: 2018-12-24 15:30:50.333694 +0800 CST m=+0.000325519</p>\n\n<p>...</p>\n\n<p>End Time</p>\n\n<p>...</p>\n\n<p>End Time: 2018-12-24 15:30:50.353409 +0800 CST m=+0.020040254, duration: 0.019715</p></li>\n<li><p>Java: <strong>complete all task in about 122ms</strong></p>\n\n<p>Start Time:2018-12-24 15: 30: 31: 301</p>\n\n<p>...</p>\n\n<p>2018-12-24 15: 30: 31: 422</p></li>\n</ul></li>\n</ul>\n\n<p>My test data file is a very simple txt in several lines(about 362B). Is there something wrong with my test code in test reading a small file between go and java? Somebody pls help me out. Thanks in advance:)</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 762, "user_id": 3052074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619c2a3b094423dd741dc8eb161836f0?s=128&d=identicon&r=PG", "display_name": "Andrey Dyatlov", "link": "https://stackoverflow.com/users/3052074/andrey-dyatlov"}, "is_accepted": true, "score": 4, "last_activity_date": 1545648995, "last_edit_date": 1545648995, "creation_date": 1545635006, "answer_id": 53910233, "question_id": 53909835, "link": "https://stackoverflow.com/questions/53909835/initialize-struct-from-func-that-returns-tuple/53910233#53910233", "title": "Initialize struct from func that returns tuple", "body": "<p>There is no construction in Go which would help to make this one-liner. I think, what you have now is OK, except the <a href=\"https://golang.org/doc/effective_go.html#mixed-caps\" rel=\"nofollow noreferrer\">underscores in the variable names</a>.</p>\n\n<p>Personally, I would add even more lines for the sake of readability:</p>\n\n<pre><code>var personInj routes.PersonInjection\npersonInj.PeopleById, personInj.PeopleByHandle = models.PersonInit()\nhandler.Mount(subRouter, personInj)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1223975, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5Oh7r.jpg?s=128&g=1", "display_name": "Alexander Mills", "link": "https://stackoverflow.com/users/1223975/alexander-mills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 1, "accepted_answer_id": 53910233, "answer_count": 1, "score": 0, "last_activity_date": 1545648995, "creation_date": 1545632087, "question_id": 53909835, "link": "https://stackoverflow.com/questions/53909835/initialize-struct-from-func-that-returns-tuple", "title": "Initialize struct from func that returns tuple", "body": "<p>Ok so I have this:</p>\n\n<pre><code>handler.Mount(subRouter, routes.PersonInjection{PeopleById: models.PersonInit()})\n</code></pre>\n\n<p>PersonInit looks like:</p>\n\n<pre><code>func PersonInit() (Map,Map) {\n\n    peopleById[\"1\"] = Model{ID: 1, Handle: \"alex\", Firstname: \"Alex\", Lastname: \"Chaz\", Email: \"alex@example.com\", Password:\"foo\"}\n    peopleById[\"2\"] = Model{ID: 2, Handle: \"jason\",Firstname: \"Jason\", Lastname: \"Statham\", Email: \"jason@example.com\", Password:\"foo\"}\n    peopleByHandle[\"alex\"] = peopleById[\"1\"]\n    peopleByHandle[\"jason\"] = peopleById[\"2\"]\n\n    return peopleById, peopleByHandle\n}\n</code></pre>\n\n<p>the Map type is just <code>Map[string]someStruct{}</code></p>\n\n<p>and <code>PersonInjection{}</code> looks like:</p>\n\n<pre><code>type PersonInjection struct {\n    PeopleById, PeopleByHandle person.Map\n}\n</code></pre>\n\n<p>so I am looking to do something like:</p>\n\n<pre><code>handler.Mount(subRouter, routes.PersonInjection{PeopleById,PersonByHandle: models.PersonInit()...})\n</code></pre>\n\n<p>ummm anyone know how to do something like that?</p>\n\n<p>for now I just have:</p>\n\n<pre><code>    by_id, by_handle := models.PersonInit()\n    handler.Mount(subRouter, routes.PersonInjection{PeopleById: by_id, PeopleByHandle:by_handle})\n</code></pre>\n"}, {"tags": ["go", "encoding", "jpeg"], "comments": [{"owner": {"reputation": 9291, "user_id": 13189, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/tKLRf.jpg?s=128&g=1", "display_name": "eckes", "link": "https://stackoverflow.com/users/13189/eckes"}, "edited": false, "score": 1, "creation_date": 1545629283, "post_id": 53909445, "comment_id": 94663401, "body": "Do you mean run OCR on the image?"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1545630217, "post_id": 53909445, "comment_id": 94663570, "body": "Exactly what do you want to convert to ISO-8859-1? It doesn&#39;t make sense to convert the URL, because that must be in UTF-8. If you converted it, it would either be identical, or the web server would just give you a 404 if you tried to use the result to fetch the image. If you try to convert the binary data, you&#39;ll just end up with a garbage file that is no longer a valid image."}, {"owner": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1545630492, "post_id": 53909445, "comment_id": 94663622, "body": "@MichaelHampton Should&#39;ve specified more in the description, haha. I meant that I wanted to use the URL to get an image and convert that image to ISO-8859-1."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545630754, "post_id": 53909445, "comment_id": 94663683, "body": "@DominicSparrow: You are still not making sense. ISO 8859-1 is a character encoding, not an image encoding. <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-1\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/ISO/IEC_8859-1</a>"}, {"owner": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545630842, "post_id": 53909445, "comment_id": 94663706, "body": "@peterSO I&#39;m trying to make an image URL uploader for profile pictures for spotify. When viewing the post request, the image uploaded from the computer to the desktop app is in ISO-8859-1 encryption. It&#39;s strange."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1545631050, "post_id": 53909445, "comment_id": 94663761, "body": "Again, what are you talking about? ISO-8859-1 is not encryption. This looks like an XY problem. You should instead describe the problem you&#39;re having, not what you think the solution might be."}, {"owner": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545633452, "post_id": 53909445, "comment_id": 94664275, "body": "@peterSO If it&#39;s encoded in Base64, why is my post request in ISO-8859-1?"}], "answers": [{"comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "edited": false, "score": 0, "creation_date": 1545636509, "post_id": 53909931, "comment_id": 94665019, "body": "@DominicSparrow:  I have added a simple example to my answer. Follow the link to the package base64 documentation in my answer. There are some useful examples. If you get stuck, post your code in your question."}, {"owner": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "edited": false, "score": 0, "creation_date": 1545639036, "post_id": 53909931, "comment_id": 94665668, "body": "I noticed the `` instead of normal &quot;&quot;, what&#39;s the significance? I am a beginner :)"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "edited": false, "score": 0, "creation_date": 1545639180, "post_id": 53909931, "comment_id": 94665706, "body": "@DominicSparrow: raw string literals and interpreted string literals: <a href=\"https://golang.org/ref/spec#String_literals\" rel=\"nofollow noreferrer\">golang.org/ref/spec#String_literals</a>"}, {"owner": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "edited": false, "score": 0, "creation_date": 1545639589, "post_id": 53909931, "comment_id": 94665828, "body": "How would I incorporate it into the getRandomImage function i just edited into the question?"}, {"owner": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "edited": false, "score": 0, "creation_date": 1545641087, "post_id": 53909931, "comment_id": 94666217, "body": "by &quot;it&quot; I am referring to the `` @peterSO"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 2, "last_activity_date": 1545636942, "last_edit_date": 1545636942, "creation_date": 1545632974, "answer_id": 53909931, "question_id": 53909445, "link": "https://stackoverflow.com/questions/53909445/how-do-i-convert-an-image-to-upload-a-spotify-profile-picture/53909931#53909931", "title": "How do I convert an image to upload a Spotify profile picture?", "body": "<p>Your claim that the Spotify profile picture image is <a href=\"https://en.wikipedia.org/wiki/ISO/IEC_8859-1\" rel=\"nofollow noreferrer\">ISO 8850-1</a> encoded/encrypted makes no sense.</p>\n\n<p>What would make more sense is that it is Base64 encoded.</p>\n\n<p>For example,  </p>\n\n<blockquote>\n  <p><a href=\"https://developer.spotify.com/documentation/web-api/reference/playlists/upload-custom-playlist-cover/\" rel=\"nofollow noreferrer\">Spotify for Developers: Web API: Upload a Custom Playlist Cover Image</a>.</p>\n  \n  <p>Base64 encoded JPEG image data, maximum payload size is 256 KB</p>\n</blockquote>\n\n<hr>\n\n<p>In Go,</p>\n\n<blockquote>\n  <p><a href=\"https://golang.org/pkg/encoding/base64/\" rel=\"nofollow noreferrer\">Package base64</a></p>\n  \n  <p><code>import \"encoding/base64\"</code> </p>\n  \n  <p>Package base64 implements base64 encoding as specified by RFC 4648.</p>\n</blockquote>\n\n<hr>\n\n<p>Another piece of evidence: \"HTTPS requests in UTF-8 format\"</p>\n\n<blockquote>\n  <p><a href=\"https://developer.spotify.com/documentation/web-api/\" rel=\"nofollow noreferrer\">Spotify for Developers: Web API</a></p>\n  \n  <p>Requests</p>\n  \n  <p>The Spotify Web API is based on REST principles. Data resources are\n  accessed via standard HTTPS requests in UTF-8 format to an API\n  endpoint.</p>\n</blockquote>\n\n<hr>\n\n<p>For example. using your Stack Overflow profile picture:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"net/http\"\n    \"os\"\n)\n\nfunc grabImageBytes(imageURL string) ([]byte, error) {\n    req, err := http.NewRequest(\"GET\", imageURL, nil)\n    if err != nil {\n        return nil, err\n    }\n    res, err := http.DefaultClient.Do(req)\n    if err != nil {\n        return nil, err\n    }\n    defer res.Body.Close()\n    body, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        return nil, err\n    }\n    enc := base64.StdEncoding\n    img := make([]byte, enc.EncodedLen(len(body)))\n    enc.Encode(img, body)\n    return img, nil\n}\n\nfunc main() {\n    imageURL := `https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=328`\n    img, err := grabImageBytes(imageURL)\n    if err != nil {\n        fmt.Fprintln(os.Stderr, err)\n        return\n    }\n    fmt.Println(string(img))\n}\n</code></pre>\n"}], "owner": {"reputation": 13, "user_id": 10827871, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-P8ICR-LXoBs/AAAAAAAAAAI/AAAAAAAAE04/fVAeB6_nMeg/photo.jpg?sz=128", "display_name": "Dominic Sparrow", "link": "https://stackoverflow.com/users/10827871/dominic-sparrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 1, "accepted_answer_id": 53909931, "answer_count": 1, "score": 0, "last_activity_date": 1545671547, "creation_date": 1545629027, "last_edit_date": 1545639988, "question_id": 53909445, "link": "https://stackoverflow.com/questions/53909445/how-do-i-convert-an-image-to-upload-a-spotify-profile-picture", "title": "How do I convert an image to upload a Spotify profile picture?", "body": "<p>I'm setting up an image encoder function where you input an image URL and it returns the ISO-8859-1 version of it. How would I write a function that sends an HTTP GET request to the URL and converts those bytes to ISO-8859-1? The code below is everything I have so far.</p>\n\n<pre><code>func grabImageBytes(imageURL string) ([]byte, error) {\n    req, _ := http.NewRequest(\"GET\", imageURL, nil)\n    res, _ := http.DefaultClient.Do(req)\n    defer res.Body.Close()\n    body, err := ioutil.ReadAll(res.Body)\n    if err != nil {\n        return nil, err\n    } else {\n        return body, nil\n    }\n}\n</code></pre>\n\n<p>other func:</p>\n\n<pre><code>func getRandomImage(keyword string) (string, error) {\n    req, _ := http.NewRequest(\"GET\", \"https://www.google.com/search?tbm=isch&amp;q=\"+keyword, nil)\n    req.Header.Add(\"authority\", \"www.google.com\")\n    req.Header.Add(\"upgrade-insecure-requests\", \"1\")\n    req.Header.Add(\"referer\", \"https://images.google.com/\")\n    req.Header.Add(\"accept-language\", \"en-US,en;q=0.9\")\n\n    res, _ := http.DefaultClient.Do(req)\n\n    defer res.Body.Close()\n    body, _ := ioutil.ReadAll(res.Body)\n\n    var imageURL string\n\n    if strings.Contains(string(body), \",\\\"ou\\\":\\\"\") {\n        imageURL = strings.Split(strings.Split(string(body), \",\\\"ou\\\":\\\"\")[1], \"\\\",\\\"ow\\\":\")[0]\n    } else {\n        return \"\", errors.New(\"Image not found.\")\n    }\n    req2, _ := http.NewRequest(\"GET\", imageURL, nil)\n\n    res2, _ := http.DefaultClient.Do(req2)\n\n    defer res2.Body.Close()\n    if res2.StatusCode == 404 {\n        return \"\", errors.New(\"Image not found.\")\n    } else {\n        return imageURL, nil\n    }\n\n}\n</code></pre>\n"}, {"tags": ["http", "go", "go-graceful"], "comments": [{"owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "edited": false, "score": 0, "creation_date": 1545647900, "post_id": 53907970, "comment_id": 94668301, "body": "More examles of  graceful shutdown here <a href=\"https://gist.github.com/peterhellberg/38117e546c217960747aacf689af3dc2\" rel=\"nofollow noreferrer\">gist.github.com/peterhellberg/38117e546c217960747aacf689af3d&zwnj;&#8203;c2</a>"}, {"owner": {"reputation": 999, "user_id": 1584308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YAV1v.png?s=128&g=1", "display_name": "hewiefreeman", "link": "https://stackoverflow.com/users/1584308/hewiefreeman"}, "reply_to_user": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "edited": false, "score": 0, "creation_date": 1545687021, "post_id": 53907970, "comment_id": 94678457, "body": "I took a look at that, but still had all these unanswered questions about what exactly was going on. I&#39;ve got it all working perfectly now :)"}], "answers": [{"tags": [], "owner": {"reputation": 201, "user_id": 10814080, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IHSUhxzo9Fs/AAAAAAAAAAI/AAAAAAAAAA8/RCIP5dhhB4A/photo.jpg?sz=128", "display_name": "Bob Fred", "link": "https://stackoverflow.com/users/10814080/bob-fred"}, "is_accepted": true, "score": 2, "last_activity_date": 1545610770, "creation_date": 1545610770, "answer_id": 53908161, "question_id": 53907970, "link": "https://stackoverflow.com/questions/53907970/golang-graceful-http-server-shutdown-with-error-handling/53908161#53908161", "title": "Golang graceful HTTP server shutdown with error handling", "body": "<p><code>main</code> function should somehow wait for all go routines which you want completely done. </p>\n\n<p>So, the 1) question: you should block on the main routine to make sure <code>serverError</code> can be executed.</p>\n\n<p>And the 3) question: absolutely you should block on <code>start()</code> or outside <code>start()</code> by yourself, or the program will exit immediately.</p>\n\n<p>As for 2). the doc points out:</p>\n\n<blockquote>\n  <p>ListenAndServe always returns a non-nil error.</p>\n</blockquote>\n\n<p>so <code>err != http.ErrServerClosed</code> just works for situation <code>Server.ShutDown()</code>. Yet there's other errors may occur.</p>\n\n<p>4) Nothing to do to shut down the <code>http.HandleFunc()</code> because <code>Server.ShutDown()</code> will wait for requests which is processing done.</p>\n"}], "owner": {"reputation": 999, "user_id": 1584308, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/YAV1v.png?s=128&g=1", "display_name": "hewiefreeman", "link": "https://stackoverflow.com/users/1584308/hewiefreeman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1397, "favorite_count": 0, "accepted_answer_id": 53908161, "answer_count": 1, "score": 1, "last_activity_date": 1545815526, "creation_date": 1545608101, "last_edit_date": 1545815526, "question_id": 53907970, "link": "https://stackoverflow.com/questions/53907970/golang-graceful-http-server-shutdown-with-error-handling", "title": "Golang graceful HTTP server shutdown with error handling", "body": "<p>I'm in the process of getting my HTTP server to gracefully shut down. I've taken tips from the post <a href=\"https://stackoverflow.com/questions/39320025/how-to-stop-http-listenandserve\">here</a>, and have set up my code like this so far:</p>\n\n<pre><code>func start() {\n\n    //......\n\n    //START HTTP/SOCKET LISTENER\n    if settings.TLS {\n        httpServer = makeServer(\"/wss\", settings.TLS);\n    } else {\n        httpServer = makeServer(\"/ws\", settings.TLS);\n    }\n\n    //...\n}\n\nfunc makeServer(handleDir string, tls bool) (*http.Server) {\n    server := &amp;http.Server{Addr: settings.IP+\":\"+strconv.Itoa(settings.Port)}\n    http.HandleFunc(handleDir, socketInitializer)\n    if tls {\n        go func() {\n            err := server.ListenAndServeTLS(settings.CertFile, settings.PrivKeyFile)\n            if err != nil {\n                serverError(err)\n            }\n        }()\n    }else{\n        go func() {\n            err := server.ListenAndServe()\n            if err != nil {\n                serverError(err)\n            }\n        }()\n    }\n\n    //\n    return server\n}\n</code></pre>\n\n<p>So, I have some questions about how this all works now:</p>\n\n<p>1) The answer I linked above states \"NOTE: there is a chance that next line won't have time to run...\" for the <code>ListenAndServe()</code> error handling inside the goroutine. How can I make sure that <code>serverError()</code> will guarantee completion? Do I need to do some sort of blocking on that thread or do I make a channel on the main thread that it can call?</p>\n\n<p>2) As of right now, I'm not sure if I have a way of telling if I've <code>Server.ShutDown()</code> the <code>http.Server</code>, or if it threw an error and shut itself down. Does the <code>ListenAndServe()</code> error get thrown even if I used the <code>Server.ShutDown()</code> method? Is that why the accepted answer in the link uses <code>err != http.ErrServerClosed</code> when checking the <code>ListenAndServe()</code> error?</p>\n\n<p>3) The <code>start()</code> function is (of course) ran on the main thread. Don't I need to block that thread somehow so the program doesn't return and exit, or does <code>ListenAndServe()</code> take care of that for me?</p>\n\n<p>4) After I call <code>Server.ShutDown()</code> do I need to do anything to shut down the <code>http.HandleFunc()</code> listeners?</p>\n\n<p>Any amount of help on any of these topics would be greatly appreciated, so don't worry if you can't touch on everything at once :)</p>\n\n<p>EDIT: If anyone wants to see how I ended up getting this all to work right, you can look at <a href=\"https://github.com/hewiefreeman/GopherGameServer/blob/master/server.go\" rel=\"nofollow noreferrer\">this file</a>, line 225 and on.</p>\n"}, {"tags": ["algorithm", "go"], "comments": [{"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 1, "creation_date": 1545607505, "post_id": 53907891, "comment_id": 94660416, "body": "Please share some code, and try to be specific about the problem you have."}, {"owner": {"reputation": 1624, "user_id": 3577360, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62ed0f4309cffd5b9ce23f7d8afb34d1?s=128&d=identicon&r=PG&f=1", "display_name": "Zander17", "link": "https://stackoverflow.com/users/3577360/zander17"}, "reply_to_user": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 1, "creation_date": 1545607872, "post_id": 53907891, "comment_id": 94660475, "body": "@oren updated original post. The algo needs to move left and right depending on the value so that I end up with the correct combo at the end. Just having a hard time coming up with a solution."}, {"owner": {"reputation": 568, "user_id": 9611958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5b1e352ee137da725e261d42524f27?s=128&d=identicon&r=PG&f=1", "display_name": "Countingstuff", "link": "https://stackoverflow.com/users/9611958/countingstuff"}, "edited": false, "score": 1, "creation_date": 1545609587, "post_id": 53907891, "comment_id": 94660734, "body": "Does it need to be super efficient? If not I think the conceptually easiest thing is to write a recursive function f(n) which looks at the array from f(n-1) and for each string in the array generates three new strings by appending 0, 1 or 2 to the end, then returns the array formed by all of these new strings. Of course this can be made non recursive."}, {"owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "reply_to_user": {"reputation": 568, "user_id": 9611958, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6f5b1e352ee137da725e261d42524f27?s=128&d=identicon&r=PG&f=1", "display_name": "Countingstuff", "link": "https://stackoverflow.com/users/9611958/countingstuff"}, "edited": false, "score": 2, "creation_date": 1545621798, "post_id": 53907891, "comment_id": 94662324, "body": "@countingstuff: I have to say that I found that comment ironic given that nick, since the answer is simply to count."}], "answers": [{"tags": [], "owner": {"reputation": 199706, "user_id": 1566221, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ce3ea4ffd1023d4382f397312352726d?s=128&d=identicon&r=PG", "display_name": "rici", "link": "https://stackoverflow.com/users/1566221/rici"}, "is_accepted": false, "score": 3, "last_activity_date": 1545610301, "last_edit_date": 1545610301, "creation_date": 1545609935, "answer_id": 53908101, "question_id": 53907891, "link": "https://stackoverflow.com/questions/53907891/number-of-k-combinations-for-all-n/53908101#53908101", "title": "Number of k-combinations for all N", "body": "<p>This is just counting (in base <em>k</em>). You could do just that --convert consecutive integers to base <em>k</em> -- but that's a lot of divides and remainders, so you might as well use a simpler approach.</p>\n\n<ol>\n<li>Start with <em>n</em> 0s, and then repeat as many times as you can:</li>\n<li>Change all the trailing <em>k</em>-1 to 0, then add 1 to the previous element. If there is no previous element, you're done.</li>\n</ol>\n\n<p>If it helps to understand, you could try this with <em>k</em>=10, which is ordinary decimal counting. Eg:</p>\n\n<ul>\n<li>3919 &rarr; change trailing 9 to 0, add one to 1, result 3920</li>\n<li>3920 &rarr; no nines at end, add one to 0, result 3921</li>\n<li>...</li>\n<li>3999 &rarr; change three trailing 9s to 0, add one to 3, result 4000</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 6217890, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-FpVYOc_sQWA/AAAAAAAAAAI/AAAAAAAACE8/BtJylgMHJWY/photo.jpg?sz=128", "display_name": "John LaRocque", "link": "https://stackoverflow.com/users/6217890/john-larocque"}, "is_accepted": false, "score": 0, "last_activity_date": 1545628878, "creation_date": 1545628878, "answer_id": 53909426, "question_id": 53907891, "link": "https://stackoverflow.com/questions/53907891/number-of-k-combinations-for-all-n/53909426#53909426", "title": "Number of k-combinations for all N", "body": "<p>Here is an implementation of rici's solution (counting).  (Output is in the form of a 2D slice, each slice a combination.)</p>\n\n<p>To produce your example output, <code>getCombinations(3, 2)</code>.</p>\n\n<pre><code>func getCombinations(base, length int) [][]int {\n    // list of combinations always includes the zero slice\n    combinations := [][]int{make([]int, length)}\n    current := make([]int, length)\n    for {\n        incrementIndex := length - 1\n        // zero trailing &lt;base - 1&gt;'s\n        for current[incrementIndex] == base-1 {\n            current[incrementIndex] = 0\n            incrementIndex--\n            // stop when the next digit to be incremented is \"larger\"\n            // than the specified (slice) length\n            if incrementIndex &lt; 0 {\n                return combinations\n            }\n        }\n        // increment the least significant non-&lt;base - 1&gt; digit\n        current[incrementIndex]++\n        // copy current into list of all combinations\n        combinations = append(combinations, append([]int{}, current...))\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 11349, "user_id": 6487675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe04c577bacde4d7dd2cdd8f495df696?s=128&d=identicon&r=PG&f=1", "display_name": "dWinder", "link": "https://stackoverflow.com/users/6487675/dwinder"}, "edited": false, "score": 0, "creation_date": 1545656472, "post_id": 53913384, "comment_id": 94670872, "body": "I dont think that what the OP intended to have - <code>n</code> should be the number of char in every string where <code>k</code> is the range where the possible char are from. Your double for-loop allow n=2 only..."}], "tags": [], "owner": {"reputation": 2005, "user_id": 9180179, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IHVRQ.jpg?s=128&g=1", "display_name": "Usman", "link": "https://stackoverflow.com/users/9180179/usman"}, "is_accepted": false, "score": 0, "last_activity_date": 1545654027, "creation_date": 1545654027, "answer_id": 53913384, "question_id": 53907891, "link": "https://stackoverflow.com/questions/53907891/number-of-k-combinations-for-all-n/53913384#53913384", "title": "Number of k-combinations for all N", "body": "<p>Try this code !</p>\n\n<p><strong>Code :</strong></p>\n\n<pre><code>n = int(input(\"Enter value of n :\"))\nresult=[]\nfor num1 in range(0,n+1):\n    for num2 in range(0,n+1):\n        result.append(str(num1)+str(num2))\nprint(result)\n</code></pre>\n\n<p><strong>Output :</strong></p>\n\n<pre><code>Enter value of n :3                                                                                                    \n['00', '01', '02', '03', '10', '11', '12', '13', '20', '21', '22', '23', '30', '31', '32', '33']\n</code></pre>\n"}], "owner": {"reputation": 1624, "user_id": 3577360, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/62ed0f4309cffd5b9ce23f7d8afb34d1?s=128&d=identicon&r=PG&f=1", "display_name": "Zander17", "link": "https://stackoverflow.com/users/3577360/zander17"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 253, "favorite_count": 0, "answer_count": 3, "score": 3, "last_activity_date": 1545654027, "creation_date": 1545607068, "last_edit_date": 1545648372, "question_id": 53907891, "link": "https://stackoverflow.com/questions/53907891/number-of-k-combinations-for-all-n", "title": "Number of k-combinations for all N", "body": "<p>I'm attempting to write an algo that returns an array of all possible combinations for values 0, 1, and 2 for length n.</p>\n\n<p>For example where n = 2:</p>\n\n<pre><code>00\n\n01\n\n02\n\n10\n\n11\n\n12\n\n20\n\n21\n\n22\n</code></pre>\n\n<p>Code that I have started but far from right or finished:</p>\n\n<pre><code>func main() {\n    var results []string\n    matches := rangeSlice(2)\n\n    for a := 0; a &lt; len(matches); a++ {\n        for b := 0; b &lt; 3; b++ {\n            matches[(len(matches) - a) - 1] = b\n            results = append(results, strings.Join(convertValuesToString(matches), \"\"))\n        } \n    }\n\n    printResults(results)\n}\n</code></pre>\n\n<p>Your help would be much appreciated!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "edited": false, "score": 0, "creation_date": 1545601992, "post_id": 53907399, "comment_id": 94659329, "body": "It has two return values, and you are assigning them to one variable <code>input</code> <a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">golang.org/pkg/bufio/#Reader.ReadString</a>"}], "answers": [{"comments": [{"owner": {"reputation": 42796, "user_id": 929902, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/7ORhC.jpg?s=128&g=1", "display_name": "Teoman shipahi", "link": "https://stackoverflow.com/users/929902/teoman-shipahi"}, "edited": false, "score": 1, "creation_date": 1545614674, "post_id": 53907423, "comment_id": 94661418, "body": "Thanks, that example helped in a good way. Go documentation seems poor, in terms of giving usage examples, compared to Java and Python."}], "tags": [], "owner": {"reputation": 649, "user_id": 554480, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/m1Kjt.png?s=128&g=1", "display_name": "Mikhail", "link": "https://stackoverflow.com/users/554480/mikhail"}, "is_accepted": true, "score": 2, "last_activity_date": 1545602048, "creation_date": 1545602048, "answer_id": 53907423, "question_id": 53907399, "link": "https://stackoverflow.com/questions/53907399/multiple-value-reader-readstring-in-single-value-context/53907423#53907423", "title": "multiple-value reader.ReadString() in single-value context", "body": "<p>Check the documentation for ReadString, especially the part that describes return values (Tip: it is in the title of the section).</p>\n\n<p><a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">https://golang.org/pkg/bufio/#Reader.ReadString</a></p>\n\n<p>Also, it worse check this reading also\n<a href=\"https://gobyexample.com/multiple-return-values\" rel=\"nofollow noreferrer\">https://gobyexample.com/multiple-return-values</a></p>\n"}], "owner": {"reputation": 42796, "user_id": 929902, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/7ORhC.jpg?s=128&g=1", "display_name": "Teoman shipahi", "link": "https://stackoverflow.com/users/929902/teoman-shipahi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 372, "favorite_count": 0, "closed_date": 1545603879, "accepted_answer_id": 53907423, "answer_count": 1, "score": 0, "last_activity_date": 1545602048, "creation_date": 1545601778, "question_id": 53907399, "link": "https://stackoverflow.com/questions/53907399/multiple-value-reader-readstring-in-single-value-context", "closed_reason": "Duplicate", "title": "multiple-value reader.ReadString() in single-value context", "body": "<p>Go newbie here.</p>\n\n<p>I am trying to run very simple example on <code>go1.11.4 windows/amd64</code></p>\n\n<p>Here is my code below;<br>\nsandbox: <a href=\"https://play.golang.org/p/GoALi4HYx3L\" rel=\"nofollow noreferrer\">https://play.golang.org/p/GoALi4HYx3L</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    fmt.Print(\"Enter a grade: \")\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter text: \")\n    input := reader.ReadString('\\n')\n    fmt.Println(input)\n}\n</code></pre>\n\n<p>And I am getting following error: </p>\n\n<blockquote>\n  <p>prog.go:13:28: multiple-value\n  reader.ReadString() in single-value context</p>\n</blockquote>\n\n<p>Am I missing something here?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 27690, "user_id": 362589, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/125a471032cdef6e8de28ff6d54c7324?s=128&d=identicon&r=PG", "display_name": "Dani", "link": "https://stackoverflow.com/users/362589/dani"}, "edited": false, "score": 4, "creation_date": 1545598510, "post_id": 53907048, "comment_id": 94658645, "body": "Check the errors, is anything failing?"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 7, "creation_date": 1545598826, "post_id": 53907048, "comment_id": 94658697, "body": "(1) Stop ignoring error returns. (2) <code>&#39;schema&#39;</code> is a string literal in SQL, you&#39;d want to say <code>&quot;schema&quot;</code> if you need to quote the schema name."}, {"owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "reply_to_user": {"reputation": 27690, "user_id": 362589, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/125a471032cdef6e8de28ff6d54c7324?s=128&d=identicon&r=PG", "display_name": "Dani", "link": "https://stackoverflow.com/users/362589/dani"}, "edited": false, "score": 1, "creation_date": 1545604536, "post_id": 53907048, "comment_id": 94659807, "body": "@Dani Hi. Yes, the error is what i put, invalid mem address."}, {"owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1545604613, "post_id": 53907048, "comment_id": 94659823, "body": "@muistooshort ignored them in code but when writing the test function i put them verbose. Will change the &quot;schema&quot; to someschema so it wont bring confusion. Thanks."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545604704, "post_id": 53907048, "comment_id": 94659854, "body": "What statement in your code causes that panic? Also please put error handling nevertheless."}, {"owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545606601, "post_id": 53907048, "comment_id": 94660205, "body": "@zerkms r, err := q.Exec()"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545606704, "post_id": 53907048, "comment_id": 94660230, "body": "Please check your errors first then and update your code correspondingly"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 2, "creation_date": 1545607071, "post_id": 53907048, "comment_id": 94660308, "body": "Looks like your <code>Prepare</code> call erred and gave you a nil <code>q</code>. What error does it return?"}, {"owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "reply_to_user": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 0, "creation_date": 1545607587, "post_id": 53907048, "comment_id": 94660432, "body": "@RickyA thanks Rick, i was having an issue with string(tid). Integers cant be converted to string like that! (strconv.Iota must be used)."}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1545607627, "post_id": 53907048, "comment_id": 94660442, "body": "(hopefully) lessons learned: <b>always</b> to check errors"}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 2, "creation_date": 1545607665, "post_id": 53907048, "comment_id": 94660450, "body": "ok, so the lesson learned is: always, always test every error and never ever ignore then silently."}], "answers": [{"comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 4, "creation_date": 1545607645, "post_id": 53907930, "comment_id": 94660444, "body": "Not that, you were not checking errors in the very first place"}], "tags": [], "owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "is_accepted": false, "score": 1, "last_activity_date": 1545607622, "creation_date": 1545607622, "answer_id": 53907930, "question_id": 53907048, "link": "https://stackoverflow.com/questions/53907048/runtime-error-invalid-memory-address-or-nil-pointer-dereference-creating-tabl/53907930#53907930", "title": "&quot;runtime error: invalid memory address or nil pointer dereference&quot; creating table", "body": "<p>I was wronly converting an integer to string with \"string\". I must use strconv.Iota.</p>\n"}], "owner": {"reputation": 4322, "user_id": 162414, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/d7fd5d3b2926236f63384ba2ca7f1eb0?s=128&d=identicon&r=PG", "display_name": "Gabriel A. Zorrilla", "link": "https://stackoverflow.com/users/162414/gabriel-a-zorrilla"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 276, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1545640527, "creation_date": 1545598006, "last_edit_date": 1545640527, "question_id": 53907048, "link": "https://stackoverflow.com/questions/53907048/runtime-error-invalid-memory-address-or-nil-pointer-dereference-creating-tabl", "title": "&quot;runtime error: invalid memory address or nil pointer dereference&quot; creating table", "body": "<p>I'm getting my feet wet with Go 1.11 and postgres.</p>\n\n<pre><code>package db\n\nimport (\n    \"database/sql\"\n    _ \"github.com/lib/pq\" //database connector\n    g \"app/globalvariables\"\n)\n\nfunc CreateTable(tid int) {\ns := \"CREATE TABLE someschema.sometable\" + string(tid) + \"(id serial PRIMARY KEY,...);\"\n    db, _ := sql.Open(\"postgres\", \"user=\"+g.DB_USER+\" dbname=\"+g.DB_NAME+\" sslmode=disable\")\n    defer db.Close()\n    q, _ := db.Prepare(s)\n    q.Exec()\n}\n</code></pre>\n\n<p>When testing the function I get:</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference [recovered]\n    panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x0 pc=0x51d46a]\n</code></pre>\n\n<p>What can it be?</p>\n"}, {"tags": ["go", "time", "timezone"], "answers": [{"comments": [{"owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "edited": false, "score": 1, "creation_date": 1545596876, "post_id": 53906537, "comment_id": 94658359, "body": "Wow, I never realised the difference between the wall clock and the monotonic clock. And for the program which I&#39;m writing (a self learning auto pilot for an rc-plane) measuring time is way more important than telling time. One more question: does <code>time.Since()</code> use the monotonic clock or the wall clock? And if <code>time.Since()</code> uses the wall clock, how can tell the difference in monotonic time between two time objects?"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "reply_to_user": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "edited": false, "score": 1, "creation_date": 1545598051, "post_id": 53906537, "comment_id": 94658559, "body": "@kramer65 As the docs say, &quot;<i>Other idioms, such as time.Since(start), time.Until(deadline), and time.Now().Before(deadline), are similarly robust against wall clock resets.</i>&quot; and Since() &quot;<i>is shorthand for time.Now().Sub(t)</i>&quot;. You can subtract two Times and get a <code>Duration</code> which is just a count of nanoseconds."}], "tags": [], "owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "is_accepted": true, "score": 7, "last_activity_date": 1545592951, "creation_date": 1545592951, "answer_id": 53906537, "question_id": 53906412, "link": "https://stackoverflow.com/questions/53906412/whats-the-difference-between-time-now-and-time-now-local/53906537#53906537", "title": "What&#39;s the difference between time.Now() and time.Now().Local()?", "body": "<p><code>time.Now().Local()</code> sets the time's <a href=\"https://golang.org/pkg/time/#Location\" rel=\"noreferrer\">Location</a> to local time. <code>time.Now()</code> is already set to local time, so there's no net effect except that <code>m</code> bit.</p>\n\n<p>The <code>m</code> portion is the <a href=\"https://golang.org/pkg/time/#hdr-Monotonic_Clocks\" rel=\"noreferrer\">Monotonic Clock</a>.</p>\n\n<blockquote>\n  <p>Operating systems provide both a \u201cwall clock,\u201d which is subject to changes for clock synchronization, and a \u201cmonotonic clock,\u201d which is not. The general rule is that the wall clock is for telling time and the monotonic clock is for measuring time.</p>\n</blockquote>\n\n<p>A monotonic clock is basically a simple count since the program started. <code>m=+0.000583834</code> says that time is <code>0.000583834</code> seconds after the program started.</p>\n\n<p><code>time.Now().Local()</code> <a href=\"https://github.com/golang/go/blob/master/src/time/time.go#L201\" rel=\"noreferrer\">explicitly strips the monotonic clock</a>...</p>\n\n<blockquote>\n  <p>Because t.In, t.Local, and t.UTC are used for their effect on the interpretation of the wall time, they also strip any monotonic clock reading from their results. The canonical way to strip a monotonic clock reading is to use t = t.Round(0). </p>\n</blockquote>\n"}], "owner": {"reputation": 38454, "user_id": 1650012, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a21bc05bb7df4e5c3cb4933e4f3072eb?s=128&d=identicon&r=PG", "display_name": "kramer65", "link": "https://stackoverflow.com/users/1650012/kramer65"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 53906537, "answer_count": 1, "score": 3, "last_activity_date": 1545640441, "creation_date": 1545591972, "last_edit_date": 1545640441, "question_id": 53906412, "link": "https://stackoverflow.com/questions/53906412/whats-the-difference-between-time-now-and-time-now-local", "title": "What&#39;s the difference between time.Now() and time.Now().Local()?", "body": "<p>I'm trying to understand what the difference is between <code>time.Now()</code> and <code>time.Now().Local()</code>. I started by printing them out on my laptop (running Ubuntu 18.04):</p>\n\n<pre><code>fmt.Println(time.Now())\nfmt.Println(time.Now().Local())\n</code></pre>\n\n<p>which gives me</p>\n\n<pre><code>2018-12-23 19:57:08.606595466 +0100 CET m=+0.000583834\n2018-12-23 19:57:08.606667843 +0100 CET\n</code></pre>\n\n<p>I'm not sure what the <code>m=+0.000583834</code> is. Maybe the difference between my machine and the NTP servers? </p>\n\n<p>I then checked out the docs on <a href=\"https://golang.org/pkg/time/#Now\" rel=\"nofollow noreferrer\"><code>.Now()</code></a> and <a href=\"https://golang.org/pkg/time/#Time.Local\" rel=\"nofollow noreferrer\"><code>.Local()</code></a>, which read:</p>\n\n<blockquote>\n  <p>Now returns the current local time.</p>\n</blockquote>\n\n<p>and</p>\n\n<blockquote>\n  <p>Local returns t with the location set to local time.</p>\n</blockquote>\n\n<p>Both of them return local time, so I'm still unsure what the difference is. I tried searching around, but I couldn't really find definite answers.</p>\n\n<p>Could anyone shed some light on this?</p>\n"}, {"tags": ["c++", "linux", "sockets", "go", "network-programming"], "comments": [{"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 2, "creation_date": 1545591745, "post_id": 53906281, "comment_id": 94657172, "body": "My results: <code>go version devel +90dca98d33 Thu Dec 20 22:11:45 2018 +0000 linux&#47;amd64</code>  <code>time .&#47;client</code>  <code>real  0m7.653s  user  0m1.803s  sys  0m5.150s</code>"}, {"owner": {"reputation": 10828, "user_id": 1394729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9Ri8.jpg?s=128&g=1", "display_name": "tink", "link": "https://stackoverflow.com/users/1394729/tink"}, "edited": false, "score": 2, "creation_date": 1545592100, "post_id": 53906281, "comment_id": 94657257, "body": "<code>go version go1.10.4 linux&#47;amd64; time go client real    0m7.242s</code>, <code>clang version 3.8.0-2ubuntu4; time c++ client   real    0m4.942s</code> ... nowhere near as drastic discrepancy."}, {"owner": {"reputation": 1250, "user_id": 9314540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867477659dda7aded0a1b28a6a5ac1e7?s=128&d=identicon&r=PG&f=1", "display_name": "rampatowl", "link": "https://stackoverflow.com/users/9314540/rampatowl"}, "edited": false, "score": 1, "creation_date": 1545592322, "post_id": 53906281, "comment_id": 94657311, "body": "My large linux discrepancy may be related to that particular machine then. I am also seeing 30% slower on Mac which is similar to your results tink. I\u2019ll change the wording of the question to ask about this discrepancy"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 1, "creation_date": 1545593242, "post_id": 53906281, "comment_id": 94657538, "body": "My results: <code>g++ (Ubuntu 8.2.0-7ubuntu1) 8.2.0</code>  <code>time .&#47;a.out  real 0m6.013s  user 0m0.253s  sys  0m4.564s</code>"}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545593423, "post_id": 53906281, "comment_id": 94657586, "body": "@rampatowl: Your results are not reproducible."}, {"owner": {"reputation": 1250, "user_id": 9314540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867477659dda7aded0a1b28a6a5ac1e7?s=128&d=identicon&r=PG&f=1", "display_name": "rampatowl", "link": "https://stackoverflow.com/users/9314540/rampatowl"}, "reply_to_user": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "edited": false, "score": 0, "creation_date": 1545601154, "post_id": 53906281, "comment_id": 94659159, "body": "@peterSO Hey Peter, it does look my linux results were wonky. But it seems we\u2019re all getting 20-30% slower results for the Go program now. I edited my question so that it addresses this discrepancy rather than the original 3x difference. Still curious about why there is a discrepancy is here at all when normally Go is competitive with C++."}, {"owner": {"reputation": 13257, "user_id": 248922, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/b55c30cff18b13e2176c1359654ebf1c?s=128&d=identicon&r=PG&f=1", "display_name": "RickyA", "link": "https://stackoverflow.com/users/248922/rickya"}, "edited": false, "score": 4, "creation_date": 1545607532, "post_id": 53906281, "comment_id": 94660421, "body": "Comparing two languages like this is virtually meaningless. The functionality may be the same, but implementation differences will skewer the results.  This is in the same ballpark as <code>my db is x times faster than the competitor x,y and z</code>, which may be true for certain workloads, but tells you nothing about real life performance, stability, maintainability and ease of use."}, {"owner": {"reputation": 1250, "user_id": 9314540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867477659dda7aded0a1b28a6a5ac1e7?s=128&d=identicon&r=PG&f=1", "display_name": "rampatowl", "link": "https://stackoverflow.com/users/9314540/rampatowl"}, "reply_to_user": {"reputation": 10828, "user_id": 1394729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9Ri8.jpg?s=128&g=1", "display_name": "tink", "link": "https://stackoverflow.com/users/1394729/tink"}, "edited": false, "score": 0, "creation_date": 1545695010, "post_id": 53906281, "comment_id": 94679510, "body": "@tink out of curiosity, what are the specs of the machine you&#39;re using? I can only get to 11s on a 3GHz AWS linux box."}, {"owner": {"reputation": 10828, "user_id": 1394729, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B9Ri8.jpg?s=128&g=1", "display_name": "tink", "link": "https://stackoverflow.com/users/1394729/tink"}, "edited": false, "score": 1, "creation_date": 1545872549, "post_id": 53906281, "comment_id": 94717213, "body": "It&#39;s my workstation, a Dell optiplex, i7-6700 @ 3.4GHz, 16GB. @rampatowl"}], "answers": [{"tags": [], "owner": {"reputation": 762, "user_id": 3052074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619c2a3b094423dd741dc8eb161836f0?s=128&d=identicon&r=PG", "display_name": "Andrey Dyatlov", "link": "https://stackoverflow.com/users/3052074/andrey-dyatlov"}, "is_accepted": true, "score": 5, "last_activity_date": 1545866657, "last_edit_date": 1545866657, "creation_date": 1545866355, "answer_id": 53938155, "question_id": 53906281, "link": "https://stackoverflow.com/questions/53906281/why-are-go-sockets-slower-than-c-sockets/53938155#53938155", "title": "Why are Go sockets slower than C++ sockets?", "body": "<p>First of all, I confirm that the Go programs from this question do run noticeably slower than the C++ ones. I think that it's indeed interesting to know why.</p>\n\n<p>I profiled the Go client and server with the <code>pprof</code> and found out that <code>syscall.Syscall</code> takes 70% of the total execution time. According to <a href=\"https://github.com/golang/go/issues/19563\" rel=\"noreferrer\">this</a> ticket, in Go syscalls are approximately 1.4 times slower than in C.</p>\n\n<pre><code>(pprof) top -cum\nShowing nodes accounting for 18.78s, 67.97% of 27.63s total\nDropped 44 nodes (cum &lt;= 0.14s)\nShowing top 10 nodes out of 44\n  flat  flat%   sum%        cum   cum%\n 0.11s   0.4%   0.4%     22.65s 81.98%  main.main\n     0     0%   0.4%     22.65s 81.98%  runtime.main\n18.14s 65.65% 66.05%     19.91s 72.06%  syscall.Syscall\n 0.03s  0.11% 66.16%     12.91s 46.72%  net.(*conn).Read\n 0.10s  0.36% 66.52%     12.88s 46.62%  net.(*netFD).Read\n 0.16s  0.58% 67.10%     12.78s 46.25%  internal/poll.(*FD).Read\n 0.06s  0.22% 67.32%     11.87s 42.96%  syscall.Read\n 0.11s   0.4% 67.72%     11.81s 42.74%  syscall.read\n 0.02s 0.072% 67.79%      9.30s 33.66%  net.(*conn).Write\n 0.05s  0.18% 67.97%      9.28s 33.59%  net.(*netFD).Write\n</code></pre>\n\n<p>I gradually decreased the number of <code>Conn.Write</code> and <code>Conn.Read</code> calls and increased the size of the buffer accordingly, so that the number of transferred bytes stayed the same. The result is that the fewer these calls the program makes, the closer its performance to the C++ version.</p>\n"}], "owner": {"reputation": 1250, "user_id": 9314540, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/867477659dda7aded0a1b28a6a5ac1e7?s=128&d=identicon&r=PG&f=1", "display_name": "rampatowl", "link": "https://stackoverflow.com/users/9314540/rampatowl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 267, "favorite_count": 1, "closed_date": 1545861015, "accepted_answer_id": 53938155, "answer_count": 1, "score": 2, "last_activity_date": 1545866657, "creation_date": 1545591032, "last_edit_date": 1545592452, "question_id": 53906281, "link": "https://stackoverflow.com/questions/53906281/why-are-go-sockets-slower-than-c-sockets", "closed_reason": "Not suitable for this site", "title": "Why are Go sockets slower than C++ sockets?", "body": "<p>I benchmarked a simple socket ping pong test in Go and C++. The client begins by sending 0 to the server. The server increments whatever number it gets and sends it back to the client. The client echos the number back to the server, and stops once the number is 1,000,000.</p>\n\n<p>Both the client and the server are on the same computer, so I use a Unix socket in both cases. (I also tried same-host TCP sockets, which showed a similar result).</p>\n\n<p>The Go test takes 14 seconds, whereas the C++ test takes 8 seconds. This is surprising to me because I have run a fair number of Go vs. C++ benchmarks, and generally Go is as performant as C++ as long as I don't trigger the garbage collector.</p>\n\n<p>I am on a Mac, though commenters have also reported that the Go version is slower on Linux.</p>\n\n<p>Wondering if I am missing a way to optimize the Go program or if there are just inefficiencies under the hood.</p>\n\n<p>Below are the commands I run to carry out the test, along with the test results. All code files are pasted at the bottom of this question.</p>\n\n<p>Run Go server:</p>\n\n<pre><code>$ rm /tmp/go.sock\n$ go run socketUnixServer.go\n</code></pre>\n\n<p>Run Go client:</p>\n\n<pre><code>$ go build socketUnixClient.go; time ./socketUnixClient\n\nreal    0m14.101s\nuser    0m5.242s\nsys     0m7.883s\n</code></pre>\n\n<p>Run C++ server:</p>\n\n<pre><code>$ rm /tmp/cpp.sock\n$ clang++ -std=c++11 tcpServerIncUnix.cpp -O3; ./a.out\n</code></pre>\n\n<p>Run C++ client:</p>\n\n<pre><code>$ clang++ -std=c++11 tcpClientIncUnix.cpp -O3; time ./a.out\n\nreal    0m8.690s\nuser    0m0.835s\nsys     0m3.800s\n</code></pre>\n\n<p>Code files</p>\n\n<p>Go server:</p>\n\n<pre><code>// socketUnixServer.go\n\npackage main\n\nimport (\n    \"log\"\n    \"net\"\n    \"encoding/binary\"\n)\n\nfunc main() {\n    ln, err := net.Listen(\"unix\", \"/tmp/go.sock\")\n    if err != nil {\n        log.Fatal(\"Listen error: \", err)\n    }\n\n    c, err := ln.Accept()\n    if err != nil {\n        panic(err)\n    }\n    log.Println(\"Connected with client!\")\n\n    readbuf := make([]byte, 4)\n    writebuf := make([]byte, 4)\n    for {\n        c.Read(readbuf)\n        clientNum := binary.BigEndian.Uint32(readbuf)\n        binary.BigEndian.PutUint32(writebuf, clientNum+1)\n\n        c.Write(writebuf)\n    }\n}\n</code></pre>\n\n<p>Go client:</p>\n\n<pre><code>// socketUnixClient.go\n\npackage main\n\nimport (\n    \"log\"\n    \"net\"\n    \"encoding/binary\"\n)\n\nconst N = 1000000\n\nfunc main() {\n    c, err := net.Dial(\"unix\", \"/tmp/go.sock\")\n    if err != nil {\n        log.Fatal(\"Dial error\", err)\n    }\n    defer c.Close()\n\n    readbuf := make([]byte, 4)\n    writebuf := make([]byte, 4)\n\n    var currNumber uint32 = 0\n    for currNumber &lt; N {\n        binary.BigEndian.PutUint32(writebuf, currNumber)\n        c.Write(writebuf)\n\n        // Read the incremented number from server\n        c.Read(readbuf[:])\n        currNumber = binary.BigEndian.Uint32(readbuf)\n    }\n}\n</code></pre>\n\n<p>C++ server:</p>\n\n<pre><code>// tcpServerIncUnix.cpp\n\n// Server side C/C++ program to demonstrate Socket programming\n// #include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/un.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/tcp.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\n// Big Endian (network order)\nunsigned int fromBytes(unsigned char b[4]) {\n    return b[3] | b[2]&lt;&lt;8 | b[1]&lt;&lt;16 | b[0]&lt;&lt;24;\n}\n\nvoid toBytes(unsigned int x, unsigned char (&amp;b)[4]) {\n    b[3] = x;\n    b[2] = x&gt;&gt;8;\n    b[1] = x&gt;&gt;16;\n    b[0] = x&gt;&gt;24;\n}\n\nint main(int argc, char const *argv[])\n{\n    int server_fd, new_socket, valread;\n    struct sockaddr_un saddr;\n    int saddrlen = sizeof(saddr);\n    unsigned char recv_buffer[4] = {0};\n    unsigned char send_buffer[4] = {0};\n\n    server_fd = socket(AF_UNIX, SOCK_STREAM, 0);\n\n    saddr.sun_family = AF_UNIX;\n    strncpy(saddr.sun_path, \"/tmp/cpp.sock\", sizeof(saddr.sun_path));\n    saddr.sun_path[sizeof(saddr.sun_path)-1] = '\\0';\n    bind(server_fd, (struct sockaddr *)&amp;saddr, sizeof(saddr));\n\n    listen(server_fd, 3);\n\n    // Accept one client connection\n    new_socket = accept(server_fd, (struct sockaddr *)&amp;saddr, (socklen_t*)&amp;saddrlen);\n    printf(\"Connected with client!\\n\");\n\n    // Note: if /tmp/cpp.sock already exists, you'll get the Connected with client!\n    // message before running the client. Delete this file first.\n\n    unsigned int x = 0;\n\n    while (true) {\n        valread = read(new_socket, recv_buffer, 4);\n        x = fromBytes(recv_buffer);\n        toBytes(x+1, send_buffer);\n\n        write(new_socket, send_buffer, 4);\n    }\n}\n</code></pre>\n\n<p>C++ client:</p>\n\n<pre><code>// tcpClientIncUnix.cpp\n\n// Server side C/C++ program to demonstrate Socket programming\n// #include &lt;iostream&gt;\n#include &lt;unistd.h&gt;\n#include &lt;stdio.h&gt;\n#include &lt;sys/socket.h&gt;\n#include &lt;sys/un.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;netinet/in.h&gt;\n#include &lt;netinet/tcp.h&gt;\n#include &lt;string.h&gt;\n#include &lt;unistd.h&gt;\n\n// Big Endian (network order)\nunsigned int fromBytes(unsigned char b[4]) {\n    return b[3] | b[2]&lt;&lt;8 | b[1]&lt;&lt;16 | b[0]&lt;&lt;24;\n}\n\nvoid toBytes(unsigned int x, unsigned char (&amp;b)[4]) {\n    b[3] = x;\n    b[2] = x&gt;&gt;8;\n    b[1] = x&gt;&gt;16;\n    b[0] = x&gt;&gt;24;\n}\n\nint main(int argc, char const *argv[])\n{\n    int sock, valread;\n    struct sockaddr_un saddr;\n    int opt = 1;\n    int saddrlen = sizeof(saddr);\n\n    // We'll be passing uint32's back and forth\n    unsigned char recv_buffer[4] = {0};\n    unsigned char send_buffer[4] = {0};\n\n    sock = socket(AF_UNIX, SOCK_STREAM, 0);\n\n    saddr.sun_family = AF_UNIX;\n    strncpy(saddr.sun_path, \"/tmp/cpp.sock\", sizeof(saddr.sun_path));\n    saddr.sun_path[sizeof(saddr.sun_path)-1] = '\\0';\n\n    // Accept one client connection\n    if (connect(sock, (struct sockaddr *)&amp;saddr, sizeof(saddr)) != 0) {\n        throw(\"connect failed\");\n    }\n\n    int n = 1000000;\n\n    unsigned int currNumber = 0;\n    while (currNumber &lt; n) {\n        toBytes(currNumber, send_buffer);\n        write(sock, send_buffer, 4);\n\n        // Read the incremented number from server\n        valread = read(sock, recv_buffer, 4);\n        currNumber = fromBytes(recv_buffer);\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "plugins"], "answers": [{"comments": [{"owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "edited": false, "score": 0, "creation_date": 1545583968, "post_id": 53905229, "comment_id": 94655410, "body": "I didn&#39;t assert it was <code>Sayer</code> - I asserted <code>GetSayer</code> - the factory type. The interface you defined as <code>Factory</code> is identical to the interface I defined, only I called it <code>GetSayer</code>.  Also, putting another interface in the plugin code, means that the interface conversion results in pointer to interface problems."}, {"owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "reply_to_user": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "edited": false, "score": 1, "creation_date": 1545584891, "post_id": 53905229, "comment_id": 94655640, "body": "@domoarigato the signature of GetSayer and plugin&#39;s Make method are different. Change Plugin method to return Sayer"}, {"owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "edited": false, "score": 0, "creation_date": 1545585045, "post_id": 53905229, "comment_id": 94655668, "body": "That&#39;s the thing, they actually aren&#39;t different.  <code>thingFactory</code> has a <code>Make</code> method, which returns a <code>thing</code>, which the compiler recognizes is a <code>Sayer</code>, therefore <code>thingFactory</code> implements <code>GetSayer</code>.  The <code>Sayer</code> interface is in the host code, not the plugin Code, and putting a different interface, which also happens to be called <code>Sayer</code> in the plugin code, and returning it doesn&#39;t change anything about the situation (I did try it) except that it does cause issues with *interface in the type conversion."}, {"owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "edited": false, "score": 0, "creation_date": 1545586726, "post_id": 53905229, "comment_id": 94656073, "body": "Tried it, sorry, but it doesn&#39;t work. It still doesn&#39;t recognize that plugin.thingFactory is host.GetSayer: missing method Make - same problem."}], "tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": false, "score": 1, "last_activity_date": 1545585586, "last_edit_date": 1545585586, "creation_date": 1545582464, "answer_id": 53905229, "question_id": 53904995, "link": "https://stackoverflow.com/questions/53904995/can-golang-plugins-be-used-for-factory-functions/53905229#53905229", "title": "Can golang plugins be used for factory functions?", "body": "<p>Your plugin Make method should return a Sayer object not thing</p>\n\n<pre><code>type Sayer interface {\n    Say() string\n}\nfunc (t *thingFactory) Make(s string) Sayer {\n    return New(s)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "edited": false, "score": 0, "creation_date": 1545599474, "post_id": 53906730, "comment_id": 94658824, "body": "thanks - I was sure it <i>should</i> be possible, but the third package &quot;outsourcing&quot; was non obvious.  I did some searching, but unfortunately there still isn&#39;t a ton of plugin use in the wild."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1545594816, "creation_date": 1545594816, "answer_id": 53906730, "question_id": 53904995, "link": "https://stackoverflow.com/questions/53904995/can-golang-plugins-be-used-for-factory-functions/53906730#53906730", "title": "Can golang plugins be used for factory functions?", "body": "<p>The first problem is that in your plugin <code>thingFactory</code> (more precicely <code>*thingfactory</code>) does not have a method described in your main app's <code>GetSayer</code> interface:</p>\n\n<pre><code>Make(string) Sayer\n</code></pre>\n\n<p>You have:</p>\n\n<pre><code>Make(string) thing\n</code></pre>\n\n<p>So (first) you have to change <code>thingFactory.Make()</code> to this:</p>\n\n<pre><code>type Sayer interface {\n    Say() string\n}\n\nfunc (t thingFactory) Make(s string) Sayer {\n    th := New(s)\n    return &amp;th\n}\n</code></pre>\n\n<p>After this it still won't work. And the reason for this is because the plugin's <code>Sayer</code> type is not identical to your main app's <code>Sayer</code> type. But they must be the same in order to implement your main app's <code>GetSayer</code> interface.</p>\n\n<p>One solution is to \"outsource\" the <code>Sayer</code> interface to its own package, and use this common, shared package both in the plugin and in the main app.</p>\n\n<p>Let's create a new package, call it <code>subplay</code>:</p>\n\n<pre><code>package subplay\n\ntype Sayer interface {\n    Say() string\n}\n</code></pre>\n\n<p>Import this package and use it in the plugin:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"path/to/subplay\"\n)\n\nvar (\n    Thing        = New(\"first thing\")\n    ThingFactory = thingFactory{}\n)\n\ntype thing struct {\n    i int\n    s string\n}\n\nfunc New(s string) thing {\n    return thing{s: s}\n}\n\nfunc (t *thing) Say() string {\n    t.i++\n    return fmt.Sprintf(\"%s - %d\", t.s, t.i)\n}\n\ntype thingFactory struct{}\n\nfunc (t thingFactory) Make(s string) subplay.Sayer {\n    th := New(s)\n    return &amp;th\n}\n</code></pre>\n\n<p>And also import and use it in the main app:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"path/to/subplay\"\n    \"plugin\"\n)\n\nfunc main() {\n    p, err := plugin.Open(\"../plug/plug.so\")\n    if err != nil {\n        panic(err)\n    }\n    symbol, err := p.Lookup(\"Thing\")\n    if err != nil {\n        panic(err)\n    }\n    thing := symbol.(subplay.Sayer)\n    fmt.Println(thing.Say())\n\n    symbol, err = p.Lookup(\"ThingFactory\")\n    if err != nil {\n        panic(err)\n    }\n    factory := symbol.(GetSayer)\n\n    madeThing := factory.Make(\"how about me?\")\n    fmt.Println(madeThing.Say())\n    fmt.Println(madeThing.Say())\n}\n\ntype GetSayer interface {\n    Make(string) subplay.Sayer\n}\n</code></pre>\n\n<p>Now it will work, and output will be:</p>\n\n<pre><code>first thing - 1\nhow about me? - 1\nhow about me? - 2\n</code></pre>\n\n<p>See related questions:</p>\n\n<p><a href=\"https://stackoverflow.com/questions/42388090/go-1-8-plugin-use-custom-interface/42389345#42389345\">go 1.8 plugin use custom interface</a></p>\n\n<p><a href=\"https://stackoverflow.com/questions/42218472/how-do-go-plugin-dependencies-work/42220856#42220856\">How do Go plugin dependencies work?</a></p>\n"}], "owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 347, "favorite_count": 0, "accepted_answer_id": 53906730, "answer_count": 2, "score": 4, "last_activity_date": 1545594816, "creation_date": 1545580195, "question_id": 53904995, "link": "https://stackoverflow.com/questions/53904995/can-golang-plugins-be-used-for-factory-functions", "title": "Can golang plugins be used for factory functions?", "body": "<p>I have the following code in a golang plugin module:</p>\n\n<p>plug.go</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar (\n    Thing        = New(\"first thing\")\n    ThingFactory = thingFactory{}\n)\n\ntype thing struct {\n    i int\n    s string\n}\n\nfunc New(s string) thing {\n    return thing{s: s}\n}\n\nfunc (t *thing) Say() string {\n    t.i++\n    return fmt.Sprintf(\"%s - %d\", t.s, t.i)\n}\n\ntype thingFactory struct{}\n\nfunc (t thingFactory) Make(s string) thing {\n    return New(s)\n}\n</code></pre>\n\n<p>it is compiled as a .so object and used in another program:</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"plugin\"\n)\n\nfunc main() {\n    p, err := plugin.Open(\"../plug/plug.so\")\n    if err != nil {\n        panic(err)\n    }\n    symbol, err := p.Lookup(\"Thing\")\n    if err != nil {\n        panic(err)\n    }\n    thing := symbol.(Sayer)\n    fmt.Println(thing.Say())\n\n    symbol, err = p.Lookup(\"ThingFactory\") // &lt;-problems start here\n    if err != nil {\n        panic(err)\n    }\n    factory := symbol.(GetSayer)\n\n    madeThing := factory.Make(\"how about me?\")\n    fmt.Println(madeThing.Say())\n    fmt.Println(madeThing.Say())\n}\n\ntype Sayer interface {\n    Say() string\n}\n\ntype GetSayer interface {\n    Make(string) Sayer\n}\n</code></pre>\n\n<p>I'm able to lookup the <code>Thing</code>, and call <code>Say()</code> on it, but the second interface conversion panics:</p>\n\n<p><code>first thing - 1\npanic: interface conversion: *main.thingFactory is not main.GetSayer: missing method Make</code></p>\n\n<p>even though the runtime recognizes the first symbol as a <code>Sayer</code> it doesn't recognize that <code>thingFactory</code> obviously has a Make() method, which should return something that is also a Sayer.</p>\n\n<p>Am I missing something obvious here?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "edited": false, "score": 1, "creation_date": 1545578132, "post_id": 53904692, "comment_id": 94654043, "body": "What&#39;s the output you currently received, and what&#39;s the expected?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10826273"}, "reply_to_user": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "edited": false, "score": 1, "creation_date": 1545580064, "post_id": 53904692, "comment_id": 94654491, "body": "output: <code>[ [0 3 6 7], [0 3 4 5], [0 3 4 6 7], [0 3 4 5 6 7], [0 1 4 5], [0 1 4 6 7], [0 1 4 5 6 7], [0 1 6 7], [0 1 7], [0 1 2 4 7], [0 1 2 4 6 7], [0 1 2 4 5 6 7], [0 1 2 6 7], [0 1 2 3 6 7], [0 1 2 3 4 5], [0 1 2 3 4 5 6], [0 1 2 3 4 5 6 7], [0 1 5 6 7], ] </code> what I excepted is: <code>[ [0 3 6 7], [0 3 4 7], [0 3 4 6 7], [0 3 4 5 6 7], [0 1 4 7], [0 1 4 6 7], [0 1 4 5 6 7], [0 1 6 7], [0 1 7], [0 1 2 4 7], [0 1 2 4 6 7], [0 1 2 4 5 6 7], [0 1 2 6 7], [0 1 2 3 6 7], [0 1 2 3 4 7], [0 1 2 3 4 6 7], [0 1 2 3 4 5 6 7], [0 1 5 6 7], ]</code>"}, {"owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "edited": false, "score": 1, "creation_date": 1545580998, "post_id": 53904692, "comment_id": 94654679, "body": "Sorry, but I don&#39;t&#39; understand what you are trying to do. What each ints list in the graph represents?"}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 2, "creation_date": 1545581388, "post_id": 53904692, "comment_id": 94654770, "body": "the problem is probably something to do with slice and append, trying to figure it out"}, {"owner": {"user_type": "does_not_exist", "display_name": "user10826273"}, "edited": false, "score": 2, "creation_date": 1545581694, "post_id": 53904692, "comment_id": 94654847, "body": "Thanks for your reply. This is a leetcode problem solution(but wrong), you can see it <a href=\"https://leetcode.com/problems/all-paths-from-source-to-target/\" rel=\"nofollow noreferrer\">here</a>. Slice <code>graph[i]</code>  represents all nodes where node <code>i</code> can reach."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10826273"}, "edited": false, "score": 1, "creation_date": 1545582325, "post_id": 53905151, "comment_id": 94654993, "body": "Indeed it is! Thank you for your answer!"}], "tags": [], "owner": {"reputation": 17097, "user_id": 672689, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IPnRU.png?s=128&g=1", "display_name": "Roee Gavirel", "link": "https://stackoverflow.com/users/672689/roee-gavirel"}, "is_accepted": true, "score": 2, "last_activity_date": 1545581725, "creation_date": 1545581725, "answer_id": 53905151, "question_id": 53904692, "link": "https://stackoverflow.com/questions/53904692/when-is-the-slice-element-covered-in-this-code/53905151#53905151", "title": "When is the slice element covered in this code?", "body": "<p>You issue is with this line:</p>\n\n<pre><code>pathRecord(graph[v], append(path, v))\n</code></pre>\n\n<p>Go is so \"smart\" so he's trying to reuse the same slice allocated memory and you actually change the path you already added to result. ):</p>\n\n<p>try this instead:</p>\n\n<pre><code>newPath = make([]int, len(path))\ncopy(newPath, path)\npathRecord(graph[v], append(newPath, v))\n</code></pre>\n"}, {"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user10826273"}, "edited": false, "score": 1, "creation_date": 1545582581, "post_id": 53905207, "comment_id": 94655055, "body": "The problem really happened on append, this is a good solution. Thanks!"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 2, "last_activity_date": 1545582611, "last_edit_date": 1545582611, "creation_date": 1545582239, "answer_id": 53905207, "question_id": 53904692, "link": "https://stackoverflow.com/questions/53904692/when-is-the-slice-element-covered-in-this-code/53905207#53905207", "title": "When is the slice element covered in this code?", "body": "<p>This works for me.  I assume it's weirdness with append and slices</p>\n\n<p>I assume that the memory backing \"this append\" is passed into the recursive function as the slice is acting something like a pointer</p>\n\n<p>Then the next time it's the same memory so it gets overwritten</p>\n\n<p>So you need to take a copy at each recursion to stop it overwriting  </p>\n\n<pre><code>pathRecord = func(target, path []int) {\n    if (len(target) == 0) &amp;&amp; (path[len(path)-1] == n) {\n        var c []int = make([]int, len(path))\n        copy(c, path)\n        //fmt.Println(\"insert into\", payload) // should end with 7\n        result = append(result, c)\n    }\n\n    for _, v := range target {\n        pathRecord(graph[v], append(path, v)) //this append\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10826273"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 53905151, "answer_count": 2, "score": 1, "last_activity_date": 1545582611, "creation_date": 1545577669, "question_id": 53904692, "link": "https://stackoverflow.com/questions/53904692/when-is-the-slice-element-covered-in-this-code", "title": "When is the slice element covered in this code?", "body": "<p>I logged every element before I appending it. But the result looks like that some element is covered.</p>\n\n<p>I do not know when it is covered.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    graph := [][]int{\n        []int{3, 1},\n        []int{4, 6, 7, 2, 5},\n        []int{4, 6, 3},\n        []int{6, 4},\n        []int{7, 6, 5},\n        []int{6},\n        []int{7},\n        []int{},\n    }\n\n    fmt.Println(allPathsSourceTarget(graph))\n}\n\nfunc allPathsSourceTarget(graph [][]int) [][]int {\n    n := len(graph) - 1\n    result := make([][]int, 0, 200)\n\n    var pathRecord func(target, path []int)\n    pathRecord = func(target, path []int) {\n        if (len(target) == 0) &amp;&amp; (path[len(path)-1] == n) {\n            fmt.Println(\"insert into\", path) // should end with 7\n            result = append(result, path)\n        }\n\n        for _, v := range target {\n            pathRecord(graph[v], append(path, v))\n        }\n    }\n\n    for _, v := range graph[0] {\n        pathRecord(graph[v], []int{0, v})\n    }\n\n    return result\n}\n</code></pre>\n\n<p>Every element in the result should end with 7.</p>\n"}, {"tags": ["ruby-on-rails", "go", "actioncable"], "answers": [{"tags": [], "owner": {"reputation": 171, "user_id": 3875827, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52cc8a838bf44a589d2572833b2dd1b9?s=128&d=identicon&r=PG", "display_name": "palkan", "link": "https://stackoverflow.com/users/3875827/palkan"}, "is_accepted": false, "score": 0, "last_activity_date": 1563979568, "creation_date": 1563979568, "answer_id": 57185647, "question_id": 53904013, "link": "https://stackoverflow.com/questions/53904013/anycable-in-a-separate-server/57185647#57185647", "title": "anycable in a separate server", "body": "<p>You need to add <code>anycable-rails</code> gem to your app and run AnyCable RPC server (<code>bundle exec anycable</code>) along with the Rails server. See <a href=\"https://docs.anycable.io/#/using_with_rails\" rel=\"nofollow noreferrer\">https://docs.anycable.io/#/using_with_rails</a></p>\n"}], "owner": {"reputation": 6273, "user_id": 2392106, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/iXOIu.jpg?s=128&g=1", "display_name": "medBouzid", "link": "https://stackoverflow.com/users/2392106/medbouzid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 338, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1614926210, "creation_date": 1545571742, "question_id": 53904013, "link": "https://stackoverflow.com/questions/53904013/anycable-in-a-separate-server", "title": "anycable in a separate server", "body": "<p>I have my rails in a server A and I created a separate server where Go-lang is installed</p>\n\n<p>My Goal is to use Anycable-Go with Rails but being in separated server.</p>\n\n<p>I can't really find any clear explanation in google how to do that, but from the <a href=\"https://docs.anycable.io/#/go_getting_started\" rel=\"nofollow noreferrer\">doc</a> I tried the following in my \"Go\" server :</p>\n\n<pre><code>go get -u -f github.com/anycable/anycable-go/cmd/anycable-go\n</code></pre>\n\n<p>then </p>\n\n<pre><code>anycable-go --rpc_host=0.0.0.0:50051 --headers=cookie,x-api-token \\\n              --redis_url=redis://{my_redis_username}:{my_redis_password}@{my_redis_machine_url} --redis_channel=anycable \\\n              --host=0.0.0.0 --port=8084\n</code></pre>\n\n<p>The output looks like this :</p>\n\n<p><a href=\"https://i.stack.imgur.com/mQ4yt.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/mQ4yt.png\" alt=\"enter image description here\"></a></p>\n\n<p>Am really not that sure am on the right track so far... but if so, how am supposed to make my rails app connect/using this \"anycable-go\" server ?</p>\n"}, {"tags": ["go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 1763, "user_id": 4010835, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrAii.jpg?s=128&g=1", "display_name": "KibGzr", "link": "https://stackoverflow.com/users/4010835/kibgzr"}, "is_accepted": false, "score": 1, "last_activity_date": 1545570069, "creation_date": 1545570069, "answer_id": 53903819, "question_id": 53903739, "link": "https://stackoverflow.com/questions/53903739/how-can-i-know-if-a-parameter-that-has-the-type-interface-is-actually-a-struct/53903819#53903819", "title": "How can I know if a parameter that has the type interface is actually a struct?", "body": "<p>May be <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">Type assertions</a> can help you</p>\n\n<pre><code>func MyFunk(itf interface{}) {\n    s, ok := itf.(MyStruct)\n    fmt.Println(s, ok)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1545570294, "creation_date": 1545570294, "answer_id": 53903845, "question_id": 53903739, "link": "https://stackoverflow.com/questions/53903739/how-can-i-know-if-a-parameter-that-has-the-type-interface-is-actually-a-struct/53903845#53903845", "title": "How can I know if a parameter that has the type interface is actually a struct?", "body": "<p>Use the following to detect if the argument is a struct:</p>\n\n<pre><code>func MyFunk(itf interface{}) {\n    v := reflect.ValueOf(itf)\n    if v.Kind() == reflect.Struct {\n        // it's a struct\n    }\n}\n</code></pre>\n\n<p>If you also want to check for pointers to structs, then use this code:</p>\n\n<pre><code>func MyFunk(itf interface{}) {\n    v := reflect.Indirect(reflect.ValueOf(itf))\n    if v.Kind() == reflect.Struct {\n        // it's a struct\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28286, "user_id": 1995300, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/GR7Be.jpg?s=128&g=1", "display_name": "helmbert", "link": "https://stackoverflow.com/users/1995300/helmbert"}, "is_accepted": false, "score": 4, "last_activity_date": 1545570954, "creation_date": 1545570954, "answer_id": 53903923, "question_id": 53903739, "link": "https://stackoverflow.com/questions/53903739/how-can-i-know-if-a-parameter-that-has-the-type-interface-is-actually-a-struct/53903923#53903923", "title": "How can I know if a parameter that has the type interface is actually a struct?", "body": "<p>Using the <a href=\"https://golang.org/pkg/reflect\" rel=\"nofollow noreferrer\"><code>reflect</code></a> package, you can check for both struct types and pointers to structs:</p>\n\n<pre><code>func MyFunk(itf interface{}) {\n    t := reflect.TypeOf(itf)\n\n    if t.Kind() == reflect.Struct {\n        // itf is a struct\n    } else if t.Kind() == reflect.Ptr {\n        pt := t.Elem()\n        if pt.Kind() == reflect.Struct {\n            // itf is a pointer to a struct\n        } else {\n            // itf is a pointer to something else\n        }\n    } else {\n        // itf is something else entirely\n    }\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user10312705"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "accepted_answer_id": 53903845, "answer_count": 3, "score": 1, "last_activity_date": 1545571108, "creation_date": 1545569380, "question_id": 53903739, "link": "https://stackoverflow.com/questions/53903739/how-can-i-know-if-a-parameter-that-has-the-type-interface-is-actually-a-struct", "title": "How can I know if a parameter that has the type interface is actually a struct?", "body": "<p>I have this function that accepts an interface{}</p>\n\n<pre><code>func MyFunk(itf interface{}) {\n}\n</code></pre>\n\n<p>And I would like to know if the itf passed is a struct, is that possible? I've tried several combinations of reflect, and the closes that I could get was <code>ptr</code> (pointer).</p>\n"}, {"tags": ["string", "algorithm", "sorting", "go"], "comments": [{"owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "edited": false, "score": 0, "creation_date": 1545562048, "post_id": 53902528, "comment_id": 94650752, "body": "Have you ever checked sort package ?"}, {"owner": {"reputation": 1310, "user_id": 8620945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNs64.jpg?s=128&g=1", "display_name": "Adam D", "link": "https://stackoverflow.com/users/8620945/adam-d"}, "edited": false, "score": 0, "creation_date": 1545562212, "post_id": 53902528, "comment_id": 94650785, "body": "Yes, I have checked the sort package, but I can&#39;t see an option to use a custom alphabet for sorting strings."}, {"owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "edited": false, "score": 0, "creation_date": 1545562707, "post_id": 53902528, "comment_id": 94650870, "body": "Use sort.StringSlice struct and check if sort works for your alphabet or not"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1545571896, "post_id": 53902528, "comment_id": 94652686, "body": "&quot;How can I define a custom alphabet order for comparing and sorting strings in go?&quot; Why not implement Reorder and help Marcel finish golang.org/x/text/collate ?"}], "answers": [{"comments": [{"owner": {"reputation": 1310, "user_id": 8620945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNs64.jpg?s=128&g=1", "display_name": "Adam D", "link": "https://stackoverflow.com/users/8620945/adam-d"}, "edited": false, "score": 1, "creation_date": 1545674452, "post_id": 53906922, "comment_id": 94675734, "body": "This is fantastic, thank you so much. Go and the community are truly a cut above."}, {"owner": {"reputation": 1310, "user_id": 8620945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNs64.jpg?s=128&g=1", "display_name": "Adam D", "link": "https://stackoverflow.com/users/8620945/adam-d"}, "edited": false, "score": 0, "creation_date": 1545679890, "post_id": 53906922, "comment_id": 94677038, "body": "Also do you mind briefly adding how this would be done with an <b>array/slice of structs with a string field</b>? Using slice.Sort() similar to <a href=\"https://stackoverflow.com/a/29000001/8620945\">this answer</a> ? Thank you so much for your help, and I&#39;m sure this will be a useful question to others."}, {"owner": {"reputation": 1310, "user_id": 8620945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNs64.jpg?s=128&g=1", "display_name": "Adam D", "link": "https://stackoverflow.com/users/8620945/adam-d"}, "edited": false, "score": 0, "creation_date": 1545736285, "post_id": 53906922, "comment_id": 94685463, "body": "Thank you very much! This is perfect, it would be nice if this could all be wrapped in a concise function in the <code>sort</code> package (where all someone had to do was define a custom alphabet and sort, but maybe that&#39;s a little too edge case. :-))"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1310, "user_id": 8620945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNs64.jpg?s=128&g=1", "display_name": "Adam D", "link": "https://stackoverflow.com/users/8620945/adam-d"}, "edited": false, "score": 1, "creation_date": 1545773539, "post_id": 53906922, "comment_id": 94693009, "body": "@AdamD This custom sorting can be wrapped in a utility lib, which I have just published at <a href=\"https://github.com/icza/abcsort\" rel=\"nofollow noreferrer\"><code>github.com&#47;icza&#47;abcsort</code></a>. See edited answer for a simple usage example."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1545773462, "last_edit_date": 1545773462, "creation_date": 1545596706, "answer_id": 53906922, "question_id": 53902528, "link": "https://stackoverflow.com/questions/53902528/how-can-i-define-a-custom-alphabet-order-for-comparing-and-sorting-strings-in-go/53906922#53906922", "title": "How can I define a custom alphabet order for comparing and sorting strings in go?", "body": "<p><strong>Note beforehand:</strong></p>\n\n<p>The following solution has been cleaned up and optimized, and published as a reusable library here: <a href=\"https://github.com/icza/abcsort\" rel=\"nofollow noreferrer\"><code>github.com/icza/abcsort</code></a>.</p>\n\n<p>Using <code>abcsort</code>, custom-sorting a string slice (using a custom alphabet) is as simple as:</p>\n\n<pre><code>sorter := abcsort.New(\"bac\")\n\nss := []string{\"abc\", \"bac\", \"cba\", \"CCC\"}\nsorter.Strings(ss)\nfmt.Println(ss)\n\n// Output: [CCC bac abc cba]\n</code></pre>\n\n<p>Custom-sorting a slice of structs by one of the struct field is like:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Age  int\n}\n\nps := []Person{{Name: \"alice\", Age: 21}, {Name: \"bob\", Age: 12}}\nsorter.Slice(ps, func(i int) string { return ps[i].Name })\nfmt.Println(ps)\n\n// Output: [{bob 12} {alice 21}]\n</code></pre>\n\n<p>Original answer follows:</p>\n\n<hr>\n\n<p>We can implement custom sorting that uses a custom alphabet. We just need to create the appropriate <code>less(i, j int) bool</code> function, and the <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\"><code>sort</code></a> package will do the rest.</p>\n\n<p>Question is how to create such a <code>less()</code> function?</p>\n\n<p>Let's start by defining the custom alphabet. Convenient way is to create a <code>string</code> that contains the letters of the custom alphabet, enumerated (ordered) from smallest to highest. For example:</p>\n\n<pre><code>const alphabet = \"bca\"\n</code></pre>\n\n<p>Let's create a map from this alphabet, which will tell the weight or order of each letter of our custom alphabet:</p>\n\n<pre><code>var weights = map[rune]int{}\n\nfunc init() {\n    for i, r := range alphabet {\n        weights[r] = i\n    }\n}\n</code></pre>\n\n<p><sup>(Note: <code>i</code> in the above loop is the byte index, not the <code>rune</code> index, but since both are monotone increasing, both will do just fine for rune weight.)</sup></p>\n\n<p>Now we can create our <code>less()</code> function. To have \"acceptable\" performance, we should avoid converting the input <code>string</code> values to byte or rune slices. To do that, we can call aid from the <a href=\"https://golang.org/pkg/unicode/utf8/#DecodeRuneInString\" rel=\"nofollow noreferrer\"><code>utf8.DecodeRuneInString()</code></a> function which decodes the first <code>rune</code> of a <code>string</code>.</p>\n\n<p>So we do the comparison rune-by-rune. If both runes are letters of the custom alphabet, we may use their weights to tell how they compare to each other. If at least one of the runes are not from our custom alphabet, we will fallback to simple numeric rune comparisons.</p>\n\n<p>If 2 runes at the beginning of the 2 input strings are equal, we proceed to the next runes in each input string. We may do this my slicing the input strings: slicing them does not make a copy, it just returns a new string header that points to the data of the original strings.</p>\n\n<p>All right, now let's see the implementation of this <code>less()</code> function:</p>\n\n<pre><code>func less(s1, s2 string) bool {\n    for {\n        switch e1, e2 := len(s1) == 0, len(s2) == 0; {\n        case e1 &amp;&amp; e2:\n            return false // Both empty, they are equal (not less)\n        case !e1 &amp;&amp; e2:\n            return false // s1 not empty but s2 is: s1 is greater (not less)\n        case e1 &amp;&amp; !e2:\n            return true // s1 empty but s2 is not: s1 is less\n        }\n\n        r1, size1 := utf8.DecodeRuneInString(s1)\n        r2, size2 := utf8.DecodeRuneInString(s2)\n\n        // Check if both are custom, in which case we use custom order:\n        custom := false\n        if w1, ok1 := weights[r1]; ok1 {\n            if w2, ok2 := weights[r2]; ok2 {\n                custom = true\n                if w1 != w2 {\n                    return w1 &lt; w2\n                }\n            }\n        }\n        if !custom {\n            // Fallback to numeric rune comparison:\n            if r1 != r2 {\n                return r1 &lt; r2\n            }\n        }\n\n        s1, s2 = s1[size1:], s2[size2:]\n    }\n}\n</code></pre>\n\n<p>Let's see some trivial tests of this <code>less()</code> function:</p>\n\n<pre><code>pairs := [][2]string{\n    {\"b\", \"c\"},\n    {\"c\", \"a\"},\n    {\"b\", \"a\"},\n    {\"a\", \"b\"},\n    {\"bca\", \"bac\"},\n}\nfor _, pair := range pairs {\n    fmt.Printf(\"\\\"%s\\\" &lt; \\\"%s\\\" ? %t\\n\", pair[0], pair[1], less(pair[0], pair[1]))\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Zs9rmH_PIcX\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>\"b\" &lt; \"c\" ? true\n\"c\" &lt; \"a\" ? true\n\"b\" &lt; \"a\" ? true\n\"a\" &lt; \"b\" ? false\n\"bca\" &lt; \"bac\" ? true\n</code></pre>\n\n<p>And now let's test this <code>less()</code> function in an actual sorting:</p>\n\n<pre><code>ss := []string{\n    \"abc\",\n    \"abca\",\n    \"abcb\",\n    \"abcc\",\n    \"bca\",\n    \"cba\",\n    \"bac\",\n}\nsort.Slice(ss, func(i int, j int) bool {\n    return less(ss[i], ss[j])\n})\nfmt.Println(ss)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/DASHfWGkuDS\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[bca bac cba abc abcb abcc abca]\n</code></pre>\n\n<p>Again, if performance is important to you, you should not use <a href=\"https://golang.org/pkg/sort/#Slice\" rel=\"nofollow noreferrer\"><code>sort.Slice()</code></a> as that has to use reflection under the hood, but rather create your own slice type that implements <a href=\"https://golang.org/pkg/sort/#Interface\" rel=\"nofollow noreferrer\"><code>sort.Interface</code></a>, and in your implementation you can tell how to do it without using reflection.</p>\n\n<p>This is how it could look like:</p>\n\n<pre><code>type CustStrSlice []string\n\nfunc (c CustStrSlice) Len() int           { return len(c) }\nfunc (c CustStrSlice) Less(i, j int) bool { return less(c[i], c[j]) }\nfunc (c CustStrSlice) Swap(i, j int)      { c[i], c[j] = c[j], c[i] }\n</code></pre>\n\n<p>When you want to sort a string slice using the custom alphabet, simply convert your slice to <code>CustStrSlice</code>, so it can be passed directly to <a href=\"https://golang.org/pkg/sort/#Sort\" rel=\"nofollow noreferrer\"><code>sort.Sort()</code></a> (this type conversion does not make a copy of the slice or its elements, it just changes the type information):</p>\n\n<pre><code>ss := []string{\n    \"abc\",\n    \"abca\",\n    \"abcb\",\n    \"abcc\",\n    \"bca\",\n    \"cba\",\n    \"bac\",\n}\nsort.Sort(CustStrSlice(ss))\nfmt.Println(ss)\n</code></pre>\n\n<p>Output of the above is again (try it on the <a href=\"https://play.golang.org/p/HGHny7ASYsh\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[bca bac cba abc abcb abcc abca]\n</code></pre>\n\n<p><strong>Some things to note:</strong></p>\n\n<p>The default string comparison compares strings byte-wise. That is, if the input strings contain invalid UTF-8 sequences, the actual bytes will still be used.</p>\n\n<p>Our solution is different in this regard, as we decode runes (we have to because we use a custom alphabet in which we allow runes that are not necessarily mapped to bytes 1-to-1 in UTF-8 encoding). This means if the input is not a valid UTF-8 sequence, the behavior might not be consistent with the default ordering. But if your inputs are valid UTF-8 sequences, this will do what you expect it to do.</p>\n\n<p><strong>One last note:</strong></p>\n\n<p>We've seen how a string slice could be custom-sorted. If we have a slice of structs (or a slice of pointers of structs), the sorting algorithm (the <code>less()</code> function) may be the same, but when comparing elements of the slice, we have to compare fields of the elements, not the struct elements themselves.</p>\n\n<p>So let's say we have the following struct:</p>\n\n<pre><code>type Person struct {\n    Name string\n    Age  int\n}\n\nfunc (p *Person) String() string { return fmt.Sprint(*p) }\n</code></pre>\n\n<p><sup>(The <code>String()</code> method is added so we'll see the actual contents of the structs, not just their addresses...)</sup></p>\n\n<p>And let's say we want to apply our custom sorting on a slice of type <code>[]*Person</code>, using the <code>Name</code> field of the <code>Person</code> elements. So we simply define this custom type:</p>\n\n<pre><code>type PersonSlice []*Person\n\nfunc (p PersonSlice) Len() int           { return len(p) }\nfunc (p PersonSlice) Less(i, j int) bool { return less(p[i].Name, p[j].Name) }\nfunc (p PersonSlice) Swap(i, j int)      { p[i], p[j] = p[j], p[i] }\n</code></pre>\n\n<p>And that's all. The rest is the same, for example:</p>\n\n<pre><code>ps := []*Person{\n    {Name: \"abc\"},\n    {Name: \"abca\"},\n    {Name: \"abcb\"},\n    {Name: \"abcc\"},\n    {Name: \"bca\"},\n    {Name: \"cba\"},\n    {Name: \"bac\"},\n}\nsort.Sort(PersonSlice(ps))\nfmt.Println(ps)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/uMrBdOgyge3\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[{bca 0} {bac 0} {cba 0} {abc 0} {abcb 0} {abcc 0} {abca 0}]\n</code></pre>\n"}], "owner": {"reputation": 1310, "user_id": 8620945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oNs64.jpg?s=128&g=1", "display_name": "Adam D", "link": "https://stackoverflow.com/users/8620945/adam-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1470, "favorite_count": 0, "accepted_answer_id": 53906922, "answer_count": 1, "score": 8, "last_activity_date": 1545773462, "creation_date": 1545557545, "last_edit_date": 1545598165, "question_id": 53902528, "link": "https://stackoverflow.com/questions/53902528/how-can-i-define-a-custom-alphabet-order-for-comparing-and-sorting-strings-in-go", "title": "How can I define a custom alphabet order for comparing and sorting strings in go?", "body": "<p><strong>Please read to the bottom before marking this as duplicate</strong></p>\n\n<p>I would like to be able to sort an array of strings (or a slice of structs based on one string value) alphabetically, but <em>based on a custom alphabet or unicode letters</em>.</p>\n\n<p>Most times people advise using a collator that supports different pre-defined locales/alphabets. (See <a href=\"https://stackoverflow.com/questions/41215852/how-to-sort-non-english-strings\">this answer for Java</a>), but what can be done for rare languages/alphabets that are not available in these locale bundles?</p>\n\n<p>The language I would like to use <strong>is not available</strong> <a href=\"https://godoc.org/golang.org/x/text/language#Tag\" rel=\"nofollow noreferrer\">in the list of languages</a> supported and usable by Golangs's <a href=\"https://godoc.org/golang.org/x/text/collate\" rel=\"nofollow noreferrer\">collate</a>, so <em>I need to be able to define a custom alphabet, or order of Unicode characters/runes for sorting.</em>  </p>\n\n<p>Others suggest translate the strings into an english/ASCII sortable alphabet first, and then sort that. That's what's been suggested by a similar question in <a href=\"https://stackoverflow.com/a/28718597/8620945\">this solution done in Javascript</a> or <a href=\"https://stackoverflow.com/questions/35778202/how-can-i-sort-an-array-of-strings-based-on-a-non-standard-alphabet\">this solution in Ruby</a>. <strong>But surely there must be a more efficient way to do this with Go.</strong></p>\n\n<p>Is it possible to create a <a href=\"https://godoc.org/golang.org/x/text/collate#Collator\" rel=\"nofollow noreferrer\">Collator</a> in Go that uses a custom alphabet/character set? Is that what <a href=\"https://godoc.org/golang.org/x/text/collate#NewFromTable\" rel=\"nofollow noreferrer\">func NewFromTable</a> is for?</p>\n\n<p>It seems that I should be able to use the <a href=\"https://godoc.org/golang.org/x/text/collate#Reorder\" rel=\"nofollow noreferrer\">Reorder</a> function but it looks like this is <em>not yet implemented in the language?</em> The <a href=\"https://github.com/golang/text/blob/master/collate/option.go#L208\" rel=\"nofollow noreferrer\">source code</a> shows this:</p>\n\n<pre><code>func Reorder(s ...string) Option {\n    // TODO: need fractional weights to implement this.\n    panic(\"TODO: implement\")\n}\n</code></pre>\n\n<p>How can I <strong>define a custom alphabet order for comparing and sorting strings</strong> in go?</p>\n"}, {"tags": ["go", "optional-parameters", "optional-arguments"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545556011, "post_id": 53902172, "comment_id": 94649751, "body": "The idiomatic and short solution (which you rejected outright) is to pass zero values for absent parameters. Embrace the zero value. Nil is much more useful in Go than in other languages. You can also make two functions that then call a third, unexported function (again, passing zero values for unused parameters)."}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545556187, "post_id": 53902172, "comment_id": 94649778, "body": "@Peter, can you please post a proper answer demonstrating additional power of nil in Go?"}, {"owner": {"reputation": 392, "user_id": 5767484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/063da3e00ffcf4d3a001a1329c4e51b8?s=128&d=identicon&r=PG&f=1", "display_name": "NotX", "link": "https://stackoverflow.com/users/5767484/notx"}, "edited": false, "score": 0, "creation_date": 1616795532, "post_id": 53902172, "comment_id": 118124625, "body": "Be aware of <code>nil</code> for interfaces and slices, you never now for sure what the <code>== nil</code> check actually results in. And keep in mind that you can neither create a pointer of a return value on the fly, nor for a <code>string</code>, an  <code>int</code> or any other simple type literal, making the work with <code>nilable</code> arguments somewhat clumsy."}], "answers": [{"tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": true, "score": 1, "last_activity_date": 1545554301, "creation_date": 1545554301, "answer_id": 53902284, "question_id": 53902172, "link": "https://stackoverflow.com/questions/53902172/optional-params-in-go/53902284#53902284", "title": "Optional params in Go?", "body": "<blockquote>\n  <p>But I am new to Go and still feel like there might be a better way. Is\n  there?</p>\n</blockquote>\n\n<p>I'm affraid to say not.There isn't another way.</p>\n"}], "owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 456, "favorite_count": 0, "accepted_answer_id": 53902284, "answer_count": 1, "score": -1, "last_activity_date": 1545554508, "creation_date": 1545552973, "question_id": 53902172, "link": "https://stackoverflow.com/questions/53902172/optional-params-in-go", "title": "Optional params in Go?", "body": "<p>I know that there aren't any optional params in the latest version of <code>Go</code>. But there are quite a lot cases when they are really helpful. </p>\n\n<p>Consider oversimplified example:</p>\n\n<pre><code>func getFullName(firstName string, lastName string, maybeMiddleName func() (bool, string)) string {\n    if ok, middleName:= maybeMiddleName(); ok {\n        return firstName + \" \" + middleName + \" \" + lastName\n    }\n\n    return firstName + \" \" + lastName\n}\n</code></pre>\n\n<p>That looks fine enough, thought requires a lot verbosity on a client side: whenever <code>middleName</code> is absent or present, one has to pass <code>func() (bool, string) { return false, nil }</code> inside. It could be just <code>(false, nil)</code> if <code>Go</code> would support tuples as input parameters, but it doesn't: you can return <code>(pairs, or, even, more)</code>, but not take them as expected input. </p>\n\n<p>One could argue that the <code>nil</code> might be taken as an indication of absence. I disagree: no <code>nil</code>'s allowed to overflood any reliable codebase.</p>\n\n<p>The other option I see even more verbouse: anon structs like <code>func(maybeMiddleName struct{ ok bool; middleName string; }) ...</code>, which forces a caller of this method to write even more redundant code each and every time.</p>\n\n<p>But I am new to <code>Go</code> and still feel like there might be a better way. Is there?</p>\n"}, {"tags": ["python", "go", "boltdb"], "answers": [{"comments": [{"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545630759, "post_id": 53903772, "comment_id": 94663686, "body": "Thanks for the response, this is a good idea +1. But is there another way to read straight from BoltDB using Python?"}], "tags": [], "owner": {"reputation": 3446, "user_id": 2061590, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nSoY0.jpg?s=128&g=1", "display_name": "Dmitri Goldring", "link": "https://stackoverflow.com/users/2061590/dmitri-goldring"}, "is_accepted": false, "score": 1, "last_activity_date": 1545574378, "last_edit_date": 1545574378, "creation_date": 1545569731, "answer_id": 53903772, "question_id": 53902061, "link": "https://stackoverflow.com/questions/53902061/how-to-read-from-a-boltdb-using-python/53903772#53903772", "title": "How to read from a BoltDB using Python?", "body": "<p>Create a small handler in your Go application that responds with a database dump.\nCheck out the <a href=\"https://github.com/boltdb/bolt#database-backups\" rel=\"nofollow noreferrer\">database backups</a> section of the BoltDB documentation for an example.</p>\n"}, {"comments": [{"owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 0, "creation_date": 1545631009, "post_id": 53904409, "comment_id": 94663751, "body": "Thanks for the response. +1 . But is there another way to read straight from BoltDB using Python?"}, {"owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "reply_to_user": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "edited": false, "score": 1, "creation_date": 1545644734, "post_id": 53904409, "comment_id": 94667330, "body": "I think you can compile go programs to static or shared object binary files (.a, .so) which could then be used in python, but I have no experience there. Keep in mind that only one process can use the Bolted file at once, so if your web app will be running, a second app won\u2019t be able to connect to the db itself. You\u2019d need to copy the db or open both in read-only mode."}], "tags": [], "owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "is_accepted": false, "score": 1, "last_activity_date": 1545575312, "creation_date": 1545575312, "answer_id": 53904409, "question_id": 53902061, "link": "https://stackoverflow.com/questions/53902061/how-to-read-from-a-boltdb-using-python/53904409#53904409", "title": "How to read from a BoltDB using Python?", "body": "<p>Because you've already built the web app, you could just create http endpoints (or any other protocol) for each DB operation you need. Then call those endpoints from your python app.</p>\n"}], "owner": {"reputation": 15076, "user_id": 3702377, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ac4wz.jpg?s=128&g=1", "display_name": "Benyamin Jafari", "link": "https://stackoverflow.com/users/3702377/benyamin-jafari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 756, "favorite_count": 0, "answer_count": 2, "score": -2, "last_activity_date": 1545575312, "creation_date": 1545551535, "last_edit_date": 1545572353, "question_id": 53902061, "link": "https://stackoverflow.com/questions/53902061/how-to-read-from-a-boltdb-using-python", "title": "How to read from a BoltDB using Python?", "body": "<p>I have a Go web app which stores some data in a built-in <code>BoltDB</code>.</p>\n\n<p>Is there any way to read the content of it using Python?</p>\n"}, {"tags": ["git", "go", "libgit2"], "answers": [{"tags": [], "owner": {"reputation": 453, "user_id": 4169253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/w1wo5.jpg?s=128&g=1", "display_name": "\u0141ukasz Hryniuk", "link": "https://stackoverflow.com/users/4169253/%c5%81ukasz-hryniuk"}, "is_accepted": true, "score": 0, "last_activity_date": 1548372319, "creation_date": 1548372319, "answer_id": 54356876, "question_id": 53901670, "link": "https://stackoverflow.com/questions/53901670/how-to-make-git2go-tree-walk-non-recursive-and-show-folders-and-begin-at-targe/54356876#54356876", "title": "How to make git2go tree.Walk() non-recursive and show folders and begin at target folder?", "body": "<p>To avoid entering a given directory, it's enough to return <code>1</code> from a function passed to <code>Walk</code>.</p>\n\n<p>You can save seen directories in an array or a channel.</p>\n\n<p>Example:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>func echoFilesCollectDirs(repo *git.Repository, tree *git.Tree, ch chan *git.Tree) {\n    tree.Walk(func(td string, te *git.TreeEntry) int {\n        fmt.Println(te.Name)\n        if te.Type == git.ObjectTree {\n            t, _ := repo.LookupTree(te.Id)\n            go func() { ch &lt;- t }() // send tree into channel to process it later\n            return 1\n        }\n        return 0\n    })\n}\n\nfunc main() {\n    gR, tree := getRepoAndTree() // returns (*git.Repository, *git.Tree)\n    ch := make(chan *git.Tree)\n    echoFilesCollectDirs(gR, tree, ch)\n    // process next directory in a channel\n    // t := &lt;-ch\n    // echoFilesCollectDirs(gR, t, ch)\n}\n</code></pre>\n\n<p><strong>Note</strong>: to make the code shorter, I've removed error handling and a boilerplate part that gets <code>*git.Repository</code> and root <code>*git.Tree</code> (function <code>getRepoAndTree()</code>).</p>\n"}], "owner": {"reputation": 641, "user_id": 6461389, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/076e73542aee89c4f29beca9b3595d5b?s=128&d=identicon&r=PG&f=1", "display_name": "SSS", "link": "https://stackoverflow.com/users/6461389/sss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 112, "favorite_count": 0, "accepted_answer_id": 54356876, "answer_count": 1, "score": 2, "last_activity_date": 1548372319, "creation_date": 1545546412, "question_id": 53901670, "link": "https://stackoverflow.com/questions/53901670/how-to-make-git2go-tree-walk-non-recursive-and-show-folders-and-begin-at-targe", "title": "How to make git2go tree.Walk() non-recursive and show folders and begin at target folder?", "body": "<p>I have the following code:</p>\n\n<pre><code>branch, err := gR.LookupBranch(branchName, git.BranchLocal)\nif err != nil {\n    return err\n}\ndefer branch.Free()\n\ncommit, err := gR.LookupCommit(branch.Target())\nif err != nil {\n    return err\n}\ndefer commit.Free()\n\ntree, err := gR.LookupTree(commit.TreeId())\nif err != nil {\n    return err\n}\ndefer tree.Free()\n\nerr = tree.Walk(func(td string, te *git.TreeEntry) int {\n    if te.Type == git.ObjectBlob {\n        fmt.Println(te.Name)\n    }\n    return 0\n})\n</code></pre>\n\n<p>This recursively prints out all the files in the repository. For example, if we had the following files in our repo:</p>\n\n<pre><code>test_file.txt\ntest_file_2.txt\ntest_folder/test_subfile_1.txt\ntest_folder/test_subfolder/test_subfile_2.txt\n</code></pre>\n\n<p>Then it would print:</p>\n\n<pre><code>test_file.txt\ntest_file2.txt\ntest_subfile_1.txt\ntest_subfile_2.txt\n</code></pre>\n\n<p>Instead, my aim is to print:</p>\n\n<pre><code>test_file.txt\ntest_file_2.txt\ntest_folder\n</code></pre>\n\n<p>But then also be able to choose to start the walk from inside the folder, so be able to print:</p>\n\n<pre><code>test_subfile_1.txt\ntest_subfolder\n</code></pre>\n\n<p>How can I achieve this? (The aim is to lazy load a directory structure into a web client i.e. to allow the web client to load contents of folders when the user opens them - also note this is a bare repo)</p>\n"}, {"tags": ["go", "oauth-2.0", "square"], "answers": [{"tags": [], "owner": {"reputation": 127, "user_id": 6452632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-4Fw7DAFDuxk/AAAAAAAAAAI/AAAAAAAAA_o/D8lXJ3x6YUw/photo.jpg?sz=128", "display_name": "Yasin Shuman", "link": "https://stackoverflow.com/users/6452632/yasin-shuman"}, "is_accepted": true, "score": 0, "last_activity_date": 1546587631, "creation_date": 1546587631, "answer_id": 54034836, "question_id": 53901254, "link": "https://stackoverflow.com/questions/53901254/oauth-token-request-errors-with-missing-required-parameter-client-id/54034836#54034836", "title": "oauth token request errors with &quot;missing required parameter &#39;client_id&#39;&quot;,", "body": "<p>i ended up solving this by replacing the .Exchange method used to obtain a token with a simple http.POST request to obtain it. </p>\n"}], "owner": {"reputation": 127, "user_id": 6452632, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh5.googleusercontent.com/-4Fw7DAFDuxk/AAAAAAAAAAI/AAAAAAAAA_o/D8lXJ3x6YUw/photo.jpg?sz=128", "display_name": "Yasin Shuman", "link": "https://stackoverflow.com/users/6452632/yasin-shuman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 54034836, "answer_count": 1, "score": 1, "last_activity_date": 1546587631, "creation_date": 1545540221, "last_edit_date": 1545709119, "question_id": 53901254, "link": "https://stackoverflow.com/questions/53901254/oauth-token-request-errors-with-missing-required-parameter-client-id", "title": "oauth token request errors with &quot;missing required parameter &#39;client_id&#39;&quot;,", "body": "<p>I'm trying to get a token from squares oauth. I can successfuly get the code but when i try to get the token i receive the error \"missing required parameter 'client_id'\".</p>\n\n<p>I can successfully get a token from postman but not sure why oauth2.Exchange is not passing all info to the oauth server when I try to do it programmatically. </p>\n\n<p>here is a gist of my oauth2.Config object: <a href=\"https://gist.github.com/yshuman1/dedaead8568e695df7a06f86cd986c2d\" rel=\"nofollow noreferrer\">https://gist.github.com/yshuman1/dedaead8568e695df7a06f86cd986c2d</a></p>\n\n<p>here is a gist of my failing callback function:\n<a href=\"https://gist.github.com/yshuman1/2b496e0fe698a5a0df087c60f4583677\" rel=\"nofollow noreferrer\">https://gist.github.com/yshuman1/2b496e0fe698a5a0df087c60f4583677</a></p>\n\n<p>Here is a gist of the redirect &amp; callback functions as well as the oauth2.Config object: <a href=\"https://gist.github.com/yshuman1/b3c472978a4b1b73d6668dfe583f440f\" rel=\"nofollow noreferrer\">https://gist.github.com/yshuman1/b3c472978a4b1b73d6668dfe583f440f</a></p>\n\n<p>In the callback gist, i also attempted passing in context.TODO() instead of context.Background().</p>\n\n<p>any advice would be appreciated!</p>\n\n<p>I've tried passing the missing items in but not sure what to do to get it done correctly.</p>\n\n<p>I expect to receive a oath token back but dont. I'm getting the error\n<code>\n{\n\"message\": \"missing required parameter 'client_id'\",\n\"type\": \"bad_request.missing_parameter\"\n}\n</code></p>\n"}, {"tags": ["string", "go"], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 6, "last_activity_date": 1545541092, "last_edit_date": 1545541092, "creation_date": 1545532641, "answer_id": 53900811, "question_id": 53900765, "link": "https://stackoverflow.com/questions/53900765/type-inconsistency-occurs-when-using-range-on-string/53900811#53900811", "title": "Type inconsistency occurs when using range on string", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#For_statements\" rel=\"nofollow noreferrer\">For statements</a></p>\n  \n  <p>For statements with range clause</p>\n  \n  <p>For a string value, the \"range\" clause iterates over the Unicode code\n  points in the string starting at byte index 0. On successive\n  iterations, the index value will be the index of the first byte of\n  successive UTF-8-encoded code points in the string, and the second\n  value, of type rune, will be the value of the corresponding code\n  point. If the iteration encounters an invalid UTF-8 sequence, the\n  second value will be 0xFFFD, the Unicode replacement character, and\n  the next iteration will advance a single byte in the string.</p>\n</blockquote>\n\n<hr>\n\n<p>There is no inconsistency.</p>\n\n<p>In Go, <code>rune</code>, a Unicode code point, is an alias for <code>int32</code>.</p>\n\n<p>Go is not an old language that is limited to the ASCII character set. Like most [all?] modern languages, Go uses Unicode. </p>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    helloworld := \"Hello, \u4e16\u754c\"\n    fmt.Println(helloworld)\n    for i, r := range helloworld {\n        fmt.Println(i, r, string(r))\n    }\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/Q_iEzdlGxLu\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Q_iEzdlGxLu</a></p>\n\n<p>Output:</p>\n\n<pre><code>Hello, \u4e16\u754c\n0 72 H\n1 101 e\n2 108 l\n3 108 l\n4 111 o\n5 44 ,\n6 32  \n7 19990 \u4e16\n10 30028 \u754c\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://blog.golang.org/strings\" rel=\"nofollow noreferrer\">The Go Blog: Strings, bytes, runes and characters in Go</a></p>\n\n<p><a href=\"http://unicode.org/\" rel=\"nofollow noreferrer\">The Unicode Consortium</a></p>\n"}], "owner": {"reputation": 162, "user_id": 10398228, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/02a6741d5fb16914f1dcb233ad0ca60a?s=128&d=identicon&r=PG&f=1", "display_name": "Einiemand", "link": "https://stackoverflow.com/users/10398228/einiemand"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "accepted_answer_id": 53900811, "answer_count": 1, "score": 1, "last_activity_date": 1545541092, "creation_date": 1545532129, "question_id": 53900765, "link": "https://stackoverflow.com/questions/53900765/type-inconsistency-occurs-when-using-range-on-string", "title": "Type inconsistency occurs when using range on string", "body": "<p>The following code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    str := \"s\"\n    for i, v := range str {\n        fmt.Printf(\"type of s[%v]: %T\\n\", i, str[i])\n        fmt.Printf(\"type of v: %T\\n\", v)\n    }\n}\n</code></pre>\n\n<p>yields:</p>\n\n<pre><code>type of s[0]: uint8\ntype of v: int32\n</code></pre>\n\n<p>In most languages, strings consist of signed or unsigned 8-bit characters. Why is <code>v</code> <code>int32</code> instead of <code>uint8</code>?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 1, "creation_date": 1545528634, "post_id": 53900497, "comment_id": 94646594, "body": "From the code you provided I don&#39;t see any reads from <code>resourceChannel</code>. Your goroutine tries to write to it and blocks until someone reads from it. That might be the reason for both of your problems."}, {"owner": {"reputation": 3527, "user_id": 938183, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fac9d3b66484d9b1ff446a5e64fd57bc?s=128&d=identicon&r=PG", "display_name": "0xbadc0de", "link": "https://stackoverflow.com/users/938183/0xbadc0de"}, "reply_to_user": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 1, "creation_date": 1545529642, "post_id": 53900497, "comment_id": 94646700, "body": "@creker does it mean I can&#180;t just update the variable every X seconds because someone needs to read it to unblock the goroutine? My idea was: I run the goroutine forever and as soon as some request is going in i have the value to use without waiting for ad-hoc request from the resource manager to external API? I create the NewHttpHandler instance on every request."}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 2, "creation_date": 1545530229, "post_id": 53900497, "comment_id": 94646756, "body": "I suggest you read about how the channels work"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545552824, "post_id": 53900497, "comment_id": 94649287, "body": "Why don&#39;t you just write <code>worker.ServiceCanAccept = worker.AcceptRequest(&amp;ampqApiConfig)</code>? What&#39;s the point of the channel? Also, build with the -race flag. There are several issues here."}, {"owner": {"reputation": 3527, "user_id": 938183, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fac9d3b66484d9b1ff446a5e64fd57bc?s=128&d=identicon&r=PG", "display_name": "0xbadc0de", "link": "https://stackoverflow.com/users/938183/0xbadc0de"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545590084, "post_id": 53900497, "comment_id": 94656812, "body": "thanks for pointing it out @Peter. It works without of channel. Can you lead to direction to other issues here? I did build the binaries with -race. In a 10 Hour Tests I could not find issues wich race conditions. Thanks!"}], "owner": {"reputation": 3527, "user_id": 938183, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/fac9d3b66484d9b1ff446a5e64fd57bc?s=128&d=identicon&r=PG", "display_name": "0xbadc0de", "link": "https://stackoverflow.com/users/938183/0xbadc0de"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545528267, "creation_date": 1545527794, "last_edit_date": 1545528267, "question_id": 53900497, "link": "https://stackoverflow.com/questions/53900497/execute-a-goroutine-in-a-loop-and-pass-the-value-to-a-variable-in-another-packag", "title": "Execute a goroutine in a loop and pass the value to a variable in another package", "body": "<p>I have trouble to pass the variable from a main package into another one.</p>\n\n<p>What I'm trying to do:</p>\n\n<p>I have a simple http daemon which recievs incomming POST requests and pushes them to a rabbitMQ instance where the messages will be handled by some worker. Since the messages can be very big, I  try to imlement a simple resource manager. It should accept or denie the request.</p>\n\n<p>This is how it looks like:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"fmt\"\n    \"github.com/couchbaselabs/logg\"\n    \"net/http\"\n    _ \"net/http/pprof\"\n)\n\nvar resourceChannel = make(chan bool)\nvar ampqApiConfig = worker.DefaultResManagerConfig()\nvar ServiceCanAccept bool\n\nfunc main() {\n    var http_port int\n    flagFunc := func() {\n        flag.IntVar(\n            &amp;http_port,\n            \"http_port\",\n            8080,\n            \"The http port to listen on, eg, 8081\",\n        )\n    }\n\n    rabbitConfig := worker.DefaultConfigFlagsOverride(flagFunc)\n\n    // any requests to root, just redirect to main page\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        text := `&lt;h1&gt;We are running!&lt;h1&gt;`\n        fmt.Fprintf(w, text)\n    })\n\n    http.Handle(\"/req\", worker.NewHttpHandler(rabbitConfig))\n    http.Handle(\"/status\", worker.NewHttpStatusHandler())\n    listenAddr := fmt.Sprintf(\":%d\", http_port)\n\n    logg.LogTo(\"HTTP\", \"Starting listener on %v\", listenAddr)\n    // start a goroutine which will decide if we have resources for future requests\n    go func() {\n        for {\n            resourceChannel &lt;- worker.AcceptRequest(&amp;ampqApiConfig)\n            ServiceCanAccept = &lt;-resourceChannel\n            worker.ServiceCanAccept = ServiceCanAccept\n            time.Sleep(10 * time.Second)\n        }\n    }()\n    logg.LogError(http.ListenAndServe(listenAddr, nil))\n}\n</code></pre>\n\n<p>I'm defining above a channel and a global variable. Then, I try to run a boolean function(AcceptRequest) every 10 seconds and pass the variable to woker.ServiceCanAccept variable in package \"worker\". But unfortunately it doesn't work. The goroutine gets executed only once(at least I see the Logs from resource manager only once) and the value of worker.ServiceCanAccept in the target package doesn't change. This is problem number one.</p>\n\n<p>For each request the <code>http.Handle(\"/req\", worker.NewHttpHandler(rabbitConfig))</code> will be called and ServeHTTP below gets executed. However <code>var ServiceCanAccept bool</code> never changes. Do I need to create a channel this same name as in package main and read the value from it?</p>\n\n<pre><code>package worker\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"github.com/couchbaselabs/logg\"\n    \"net/http\"\n)\n\ntype HttpHandler struct {\n    RabbitConfig RabbitConfig\n}\n\nfunc NewHttpHandler(r RabbitConfig) *HttpHandler {\n    return &amp;HttpHandler{\n        RabbitConfig: r,\n    }\n}\n\nvar ServiceCanAccept bool\n\nfunc (s *HttpHandler) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n\n    logg.LogTo(\"HTTP\", \"serveHttp called\")\n    defer req.Body.Close()\n\n    Request := Request{}\n    decoder := json.NewDecoder(req.Body)\n    err := decoder.Decode(&amp;Request)\n    if err != nil {\n        logg.LogError(err)\n        http.Error(w, \"Unable to unmarshal json\", 500)\n        return\n    }\n\n    Result, err := HandleRequest(Request, s.RabbitConfig)\n\n    if err != nil {\n        msg := \"Unable to perform decode.  Error: %v\"\n        errMsg := fmt.Sprintf(msg, err)\n        logg.LogError(fmt.Errorf(errMsg))\n        http.Error(w, errMsg, 500)\n        return\n    }\n    w.Header().Set(\"Content-Type\", \"application/json\")\n    js, err := json.Marshal(Result)\n    if err != nil {\n        http.Error(w, err.Error(), http.StatusInternalServerError)\n        return\n    }\n    w.Write(js)\n\n}\n\nfunc HandleRequest(Request Request, rabbitConfig RabbitConfig) (Result, error) {\n\n    defaultResManagerConfig := DefaultResManagerConfig()\n    if !ServiceCanAccept {\n        err := fmt.Errorf(\"no ressources available to proced the request\")\n        return Result{}, err\n    }\n\n    switch Request.InplaceDecode {\n    case true:\n        Engine := NewEngine(Request.EngineType)\n\n        Result, err := Engine.ProcessRequest(Request)\n\n        if err != nil {\n            msg := \"Error processing request.  Error: %v\"\n            errMsg := fmt.Sprintf(msg, err)\n            logg.LogError(fmt.Errorf(errMsg))\n            return Result{}, err\n        }\n\n        return Result, nil\n    default:\n        Client, err := NewRpcClient(rabbitConfig)\n        if err != nil {\n            logg.LogError(err)\n            return Result{}, err\n        }\n        Result, err := Client.DecodeImage(Request)\n        if err != nil {\n            logg.LogError(err)\n            return Result{}, err\n        }\n        return Result, nil\n    }\n}\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1545535755, "post_id": 53900264, "comment_id": 94647353, "body": "What is the protocol for a \u201creply\u201d?"}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 7107421, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153985063466845/picture?type=large", "display_name": "Col \u1d38\u1d2c\u1d22\u1d2c\u1d3f\u1d41\u1d24 Smith", "link": "https://stackoverflow.com/users/7107421/col-%e1%b4%b8%e1%b4%ac%e1%b4%a2%e1%b4%ac%e1%b4%bf%e1%b5%81%e1%b4%a4-smith"}, "edited": false, "score": 0, "creation_date": 1545567033, "post_id": 53900951, "comment_id": 94651683, "body": "Thanks for your reply. The first reply is always the same size in bytes. Both replies are xml."}], "tags": [], "owner": {"reputation": 1017, "user_id": 2691759, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/iAkAI.png?s=128&g=1", "display_name": "pigeonhands", "link": "https://stackoverflow.com/users/2691759/pigeonhands"}, "is_accepted": false, "score": 1, "last_activity_date": 1545534934, "creation_date": 1545534934, "answer_id": 53900951, "question_id": 53900264, "link": "https://stackoverflow.com/questions/53900264/go-golang-net-dial-send-1-request-but-read-the-second-response/53900951#53900951", "title": "Go Golang net.Dial Send 1 request but read the second response", "body": "<pre><code>io.CopyN(ioutil.Discard, conn, 5000)\n</code></pre>\n\n<p>it will read the first 5000 bytes and discard them. This is assuming each reply is exactly 5000 bytes though.</p>\n\n<p>If the reply's are strings separated by new lines (such as http or irc), you could use buffio</p>\n\n<pre><code>reader := bufio.NewReader(os.Stdin)\nreader.ReadString('\\n')\nsecondline := reader.ReadString('\\n')\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 7107421, "user_type": "registered", "profile_image": "https://graph.facebook.com/10153985063466845/picture?type=large", "display_name": "Col \u1d38\u1d2c\u1d22\u1d2c\u1d3f\u1d41\u1d24 Smith", "link": "https://stackoverflow.com/users/7107421/col-%e1%b4%b8%e1%b4%ac%e1%b4%a2%e1%b4%ac%e1%b4%bf%e1%b5%81%e1%b4%a4-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 137, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1545534934, "creation_date": 1545524178, "question_id": 53900264, "link": "https://stackoverflow.com/questions/53900264/go-golang-net-dial-send-1-request-but-read-the-second-response", "title": "Go Golang net.Dial Send 1 request but read the second response", "body": "<p>I am using Go to read a reply from a sever using net.Dial. The code below works but the server sends back 2 replys. To read the second reply I would have to read the reply again. Is there an easier way to discard the first reply and grab the second reply? Regards</p>\n\n<pre><code>_, err = conn.Write([]byte(login))\nreply := make([]byte, 5000)\n\n_, err = conn.Read(reply)\nfmt.Print(string(reply))\n</code></pre>\n"}, {"tags": ["go", "overloading"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 3, "creation_date": 1545513322, "post_id": 53899307, "comment_id": 94644129, "body": "Have you considered interfaces?"}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545513391, "post_id": 53899307, "comment_id": 94644139, "body": "@mkopriva, you mean, having a number of <code>StateABehavior</code>, <code>StateBBehavior</code>, ... - all impelmenting the same <code>IState</code> interface, which in case of <code>Go</code> - just exposing the same number of methods of the same signature and name?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545513522, "post_id": 53899307, "comment_id": 94644166, "body": "Correct, although if you want to do this &quot;overloading&quot; for only one method you can embed the interface into State and then set the implementation according to the &quot;whatever factor&quot;."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545513714, "post_id": 53899307, "comment_id": 94644209, "body": "<a href=\"https://play.golang.com/p/64QjEICmI4q\" rel=\"nofollow noreferrer\">play.golang.com/p/64QjEICmI4q</a>"}, {"owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545513750, "post_id": 53899307, "comment_id": 94644221, "body": "@mkopriva, wouldn&#39;t it require a named instace per each behavior? AFAIS, the way I did it allowes to build an object on the fly - no named instances are required and yet I can keep other code bound to the <code>IState</code> interface."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545514043, "post_id": 53899307, "comment_id": 94644282, "body": "Yes it would require named types since you cannot put methods on unnamed types, if avoiding the declaration of new types is part of the requirement maybe add that to the question. In that case you can stick to your solution with the function field, they are pretty common and present even in the std lib."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545514284, "post_id": 53899307, "comment_id": 94644328, "body": "... basically to change the behavior of the State type based on the &quot;whatever factor&quot; you have two options, using function fields or interfaces. Well, there&#39;s a third option, which is using conditional statements inside the method you would like to behave differently based on the factor but I guess that isn&#39;t what you&#39;re looking for."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545523625, "post_id": 53899307, "comment_id": 94645988, "body": "Something like this? <a href=\"https://play.golang.org/p/DKn_4KitBHb\" rel=\"nofollow noreferrer\">play.golang.org/p/DKn_4KitBHb</a>"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1545524087, "post_id": 53899307, "comment_id": 94646055, "body": "Or rather this (a bit more refined) <a href=\"https://play.golang.org/p/mqDGjW21zMd\" rel=\"nofollow noreferrer\">play.golang.org/p/mqDGjW21zMd</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1017, "user_id": 2691759, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/iAkAI.png?s=128&g=1", "display_name": "pigeonhands", "link": "https://stackoverflow.com/users/2691759/pigeonhands"}, "is_accepted": true, "score": 3, "last_activity_date": 1545531380, "creation_date": 1545531380, "answer_id": 53900712, "question_id": 53899307, "link": "https://stackoverflow.com/questions/53899307/kinda-method-overloading-in-go/53900712#53900712", "title": "Kinda &quot;method overloading&quot; in Go?", "body": "<p>An interface should work here.</p>\n\n<p>creating an interface like</p>\n\n<pre><code>type Stateful interface  {\n    State() string\n}\n</code></pre>\n\n<p>and a base state type</p>\n\n<pre><code>type BaseState struct{\n}\nfunc (s BaseState) State() string{\n    return \"Base state\"\n} \n</code></pre>\n\n<p>you can imbed the <code>BaseState</code> struct</p>\n\n<pre><code>type MyStruct struct{\n    BaseState\n}\n</code></pre>\n\n<p>so that <code>State</code> Will return <code>\"Base state\"</code>, but can also implement its own method.</p>\n\n<pre><code>func (s MyStruct) State() string{\n    return \"New State\"\n} \n</code></pre>\n\n<p>and now <code>State</code> will return <code>\"New State\"</code></p>\n\n<p><a href=\"https://play.golang.org/p/QOajW0O6gIz\" rel=\"nofollow noreferrer\">https://play.golang.org/p/QOajW0O6gIz</a></p>\n"}, {"tags": [], "owner": {"reputation": 16093, "user_id": 534298, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ba32c06ed067564a6c6512de5217657?s=128&d=identicon&r=PG", "display_name": "nos", "link": "https://stackoverflow.com/users/534298/nos"}, "is_accepted": false, "score": 0, "last_activity_date": 1545593677, "last_edit_date": 1545593677, "creation_date": 1545590300, "answer_id": 53906188, "question_id": 53899307, "link": "https://stackoverflow.com/questions/53899307/kinda-method-overloading-in-go/53906188#53906188", "title": "Kinda &quot;method overloading&quot; in Go?", "body": "<p>Instead of having <code>prettyName</code> as method on the <code>struct</code>, you can also define a member value of function type.</p>\n\n<pre><code>type State struct {\n    prettyName func() string\n}\n</code></pre>\n\n<p>Then you can set its value to any function at runtime</p>\n\n<pre><code>a := State{}\na.prettyName = func() string {\n    return \"I am a state!\"\n}\nfmt.Println(a.prettyName())\na.prettyName = func() string {\n    return \"another state\"\n}\nfmt.Println(a.prettyName())\n</code></pre>\n\n<p>This example is on <a href=\"https://play.golang.com/p/rLiKOpc3vRc\" rel=\"nofollow noreferrer\">playground</a></p>\n\n<p>Now you can define an interface type with <code>PrettyName</code> API and further algorithms/business logic will call <code>PrettyName</code>. </p>\n\n<pre><code>type StateAPI interface {\n    PrettyName () string\n}\n</code></pre>\n\n<p>To fit your <code>State</code> type into the <code>StateAPI</code> interface, you need to define a trivial <code>PrettyName</code> method around the private function member</p>\n\n<pre><code>func (s *State) PrettyName() string {\n    return s.prettyName()\n}\n</code></pre>\n\n<p>This is basically your original idea and it is totally legitimate. There is an example in the <a href=\"https://www.gopl.io/\" rel=\"nofollow noreferrer\">go programming language book by Alan A. A. Donovan and Brian W. Kernighan</a> with exactly this construct.\nThat example sorts music record by different fields, e.g., by year, by artist, etc. In order to use the <a href=\"https://golang.org/pkg/sort/\" rel=\"nofollow noreferrer\">sort.Sort</a> API, </p>\n\n<pre><code>func Sort(data Interface)\n</code></pre>\n\n<p>The input data needs to have three methods</p>\n\n<pre><code>type Interface interface {\n        // Len is the number of elements in the collection.\n        Len() int\n        // Less reports whether the element with\n        // index i should sort before the element with index j.\n        Less(i, j int) bool\n        // Swap swaps the elements with indexes i and j.\n        Swap(i, j int)\n}\n</code></pre>\n\n<p>One way to sort by different fields is to define one custom data type for each case, say <code>ByYear</code>, <code>ByArtist</code>, etc. And define all three API methods for each case. But <code>Len</code> and <code>Swap</code> methods are redundant for all cases. A better solution is to define only one custom data type with a function member,</p>\n\n<pre><code>//!+customcode\ntype customSort struct {\n    t    []*Track\n    less func(x, y *Track) bool\n}\nfunc (x customSort) Less(i, j int) bool { \n     return x.less(x.t[i], x.t[j]) }\nfunc (x customSort) Len() int           {\n     return len(x.t) }\nfunc (x customSort) Swap(i, j int)      {\n     x.t[i], x.t[j] = x.t[j], x.t[i] }\n</code></pre>\n\n<p>Then you can programmically control what <code>less</code> means.</p>\n\n<p>The source code is <a href=\"https://github.com/adonovan/gopl.io/blob/master/ch7/sorting/main.go\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2976, "user_id": 7493840, "user_type": "registered", "accept_rate": 79, "profile_image": "https://graph.facebook.com/227486944377608/picture?type=large", "display_name": "Sereja Bogolubov", "link": "https://stackoverflow.com/users/7493840/sereja-bogolubov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 938, "favorite_count": 0, "accepted_answer_id": 53900712, "answer_count": 2, "score": 0, "last_activity_date": 1545593677, "creation_date": 1545512946, "question_id": 53899307, "link": "https://stackoverflow.com/questions/53899307/kinda-method-overloading-in-go", "title": "Kinda &quot;method overloading&quot; in Go?", "body": "<p>Assuming I got a type named <code>State</code>:</p>\n\n<pre><code>type State struct {\n    // ... does not matter what is inside\n}\n</code></pre>\n\n<p>along with a method defined on it:</p>\n\n<pre><code>func (s *State) prettyName() string {\n    return \"I am a state!\"\n}\n</code></pre>\n\n<p>Currently there is no way I can alter <code>prettyName()</code>'s behavior. I known that <code>Go</code> intentionally escapes OOP-like inheritance and methods overloading and this would probably never change, but still: what if I need <code>prettyName()</code> to behave differently depending upon whatever factor? The only solution I see is:</p>\n\n<pre><code>type State struct {\n    _prettyName func() string\n}\nfunc (s *State) prettyName() string {\n    return s._prettyName()\n}\n</code></pre>\n\n<p>Is there a better <code>Go</code>-style way to achieve the same goal? </p>\n"}, {"tags": ["macos", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545508371, "post_id": 53898696, "comment_id": 94643166, "body": "What&#39;s the output of <code>go env</code>?"}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545508353, "post_id": 53898777, "comment_id": 94643158, "body": "It&#39;s <code>$GOPATH&#47;src&#47;package-name</code>, not <code>$GOPATH&#47;package-name</code>, and only if the <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">module feature</a> is disabled."}], "tags": [], "owner": {"reputation": 650, "user_id": 10556525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ccd7e7dd3b1906fd56323d918c77d3?s=128&d=identicon&r=PG&f=1", "display_name": "Joris", "link": "https://stackoverflow.com/users/10556525/joris"}, "is_accepted": true, "score": 3, "last_activity_date": 1545508431, "last_edit_date": 1545508431, "creation_date": 1545507542, "answer_id": 53898777, "question_id": 53898696, "link": "https://stackoverflow.com/questions/53898696/issues-installing-a-go-program/53898777#53898777", "title": "Issues installing a go program", "body": "<p>The code currently seems to be in <code>/usr/local/go/src/http-echo</code>. Packages should always reside in the directory <code>$GOPATH/src/package-name</code>, e.g.: <code>$GOPATH/src/github.com/hashicorp/http-echo</code>. (unless you're using <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"nofollow noreferrer\">go modules</a>).</p>\n\n<p>It should work if you move the source to the correct path (<code>/Users/jon/go/src/github.com/hashicorp/http-echo</code>). Then execute:</p>\n\n<pre><code>go install github.com/hashicorp/http-echo\n</code></pre>\n\n<p>Even easier would be to use <code>go get</code> to download the package in the first place. Simply run the following command from any directory:</p>\n\n<pre><code>go get github.com/hashicorp/http-echo\n</code></pre>\n\n<p>And <code>http-echo</code> is automagically installed.</p>\n\n<p>If you still get an error after this, make sure <code>$GOPATH/bin</code> is in your <code>$PATH</code>.</p>\n"}], "owner": {"reputation": 33, "user_id": 10824264, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-dKaV-JoMTs4/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcaG_JCjqj6dgH9OFl4qWepkebmqzA/mo/photo.jpg?sz=128", "display_name": "Jon", "link": "https://stackoverflow.com/users/10824264/jon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 53898777, "answer_count": 1, "score": 3, "last_activity_date": 1545508431, "creation_date": 1545506889, "question_id": 53898696, "link": "https://stackoverflow.com/questions/53898696/issues-installing-a-go-program", "title": "Issues installing a go program", "body": "<p>Im new to go and I have been unable to find any thing online for my issue. </p>\n\n<p>I have downloaded this code <a href=\"https://github.com/hashicorp/http-echo\" rel=\"nofollow noreferrer\">https://github.com/hashicorp/http-echo</a> and I would like to set it up so I can run this command.</p>\n\n<pre><code>$ http-echo -listen=:8080 -text=\"hello world\"\n</code></pre>\n\n<p>I have been getting quite a few different path issues.\nCurrently I have the code sitting in this directory.</p>\n\n<pre><code>/Users/jon/go/src/github.com/hashicorp\n</code></pre>\n\n<p>When I try and install it I get this error</p>\n\n<pre><code>$ go install http-echo\ncan't load package: /usr/local/go/src/http-echo/handlers.go:9:2: non-standard import \"github.com/hashicorp/http-echo/version\" in standard package \"http-echo\"\n</code></pre>\n\n<p>Where should I keep go projects on an OSX computer, and how do I get this to install or compile?</p>\n"}, {"tags": ["pointers", "go", "parallel-processing"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 3, "creation_date": 1545508175, "post_id": 53898588, "comment_id": 94643139, "body": "You are stopping a <i>copy</i> of your bot. You probably meant to make a list of pointer to bot, <code>[]*bot</code>. You are also mixing pointer receivers and non-pointer receivers in the methods. Don&#39;t do that; <a href=\"https://golang.org/doc/faq#methods_on_values_or_pointers\" rel=\"nofollow noreferrer\">it causes confusion</a>. Finally, you have to synchronize access to the <code>isEnabled</code> field. Reading and writing values concurrently is unsafe. <code>go build -race</code> can point out some concurrency bugs like this one."}, {"owner": {"reputation": 396, "user_id": 5271400, "user_type": "registered", "profile_image": "https://graph.facebook.com/842781095836945/picture?type=large", "display_name": "Wilson Tamarozzi", "link": "https://stackoverflow.com/users/5271400/wilson-tamarozzi"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545508896, "post_id": 53898588, "comment_id": 94643253, "body": "about mixing methods, the three method pointers used need to change the receiver. What&#39;s wrong with that? I did not understand."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1545509216, "post_id": 53898588, "comment_id": 94643310, "body": "<code>runCommandX</code> doesn&#39;t have a pointer receiver, but all the other methods do. That makes the method set complicated for no reason. It&#39;s in the FAQ I linked above: &quot;Next is consistency. If some of the methods of the type must have pointer receivers, the rest should too, so the method set is consistent regardless of how the type is used. See the section on method sets for details.&quot;"}, {"owner": {"reputation": 396, "user_id": 5271400, "user_type": "registered", "profile_image": "https://graph.facebook.com/842781095836945/picture?type=large", "display_name": "Wilson Tamarozzi", "link": "https://stackoverflow.com/users/5271400/wilson-tamarozzi"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545509709, "post_id": 53898588, "comment_id": 94643393, "body": "Thank you very much for your patience and explanation. I read the link you sent, but since my English is bad I did not understand correctly. Everything worked out now. Will you make a correct answer to the mark or can I mark that of Gal Ben-Haim"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545510366, "post_id": 53898588, "comment_id": 94643525, "body": "Gal&#39;s answer is fine."}], "answers": [{"tags": [], "owner": {"reputation": 16516, "user_id": 1133291, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/538bd3553b7540f411a84101e4cbf294?s=128&d=identicon&r=PG", "display_name": "Gal Ben-Haim", "link": "https://stackoverflow.com/users/1133291/gal-ben-haim"}, "is_accepted": true, "score": 1, "last_activity_date": 1545508160, "creation_date": 1545508160, "answer_id": 53898850, "question_id": 53898588, "link": "https://stackoverflow.com/questions/53898588/how-to-pass-reference-of-a-pointer-with-parallelism/53898850#53898850", "title": "how to pass reference of a pointer with parallelism?", "body": "<p>the range statement returns the value of a bot which is then changed so you're actually checking a different bot.. work with references -</p>\n\n<pre><code>for i := range myBots.List {\n    b := &amp;myBots.List[i]\n    b.startFunctionX()\n    go b.runAllCommands()\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/1V8tKx431QJ\" rel=\"nofollow noreferrer\">https://play.golang.org/p/1V8tKx431QJ</a></p>\n"}], "owner": {"reputation": 396, "user_id": 5271400, "user_type": "registered", "profile_image": "https://graph.facebook.com/842781095836945/picture?type=large", "display_name": "Wilson Tamarozzi", "link": "https://stackoverflow.com/users/5271400/wilson-tamarozzi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 39, "favorite_count": 0, "accepted_answer_id": 53898850, "answer_count": 1, "score": 0, "last_activity_date": 1545508233, "creation_date": 1545505803, "last_edit_date": 1545506248, "question_id": 53898588, "link": "https://stackoverflow.com/questions/53898588/how-to-pass-reference-of-a-pointer-with-parallelism", "title": "how to pass reference of a pointer with parallelism?", "body": "<p>I'm writing a bot to run some commands in parallel and at the same time run the bots in parallel, but I'm having trouble starting and pausing functions.</p>\n\n<p>Below I'll leave an example I set up. It was expected that one of the bots would continue to run and others would stop, but all would end up running.</p>\n\n<p>Could someone explain to me why, when using the <code>startbot()</code> command, it does not get bool?\n</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"time\"\n)\n\ntype botBase struct {\n    isEnabled bool\n}\n\nfunc (b *botBase) startFunctionX() {\n    b.isEnabled = true\n}\n\nfunc (b *botBase) pauseFunctionX() {\n    b.isEnabled = false\n}\n\nfunc (b botBase) runCommandX() {\n    for {\n        if b.isEnabled {\n            log.Print(\"running...\")\n        } else {\n            log.Print(\"paused...\")\n        }\n        time.Sleep(1 * time.Second)\n    }\n}\n\ntype bot struct {\n    botBase\n    //other stuffs\n}\n\nfunc (b bot) runAllCommands() {\n    go b.runCommandX()\n\n    //wait parallels commands\n    for{\n        time.Sleep(10 * time.Hour)\n    }\n}\n\ntype bots struct {\n    List []bot\n}\n\nfunc (b *bots) loadListDB() {\n    b1 := bot{}\n    b1.isEnabled = false\n    b2 := bot{}\n    b2.isEnabled = false\n    b.List = []bot{b1, b2}\n}\n\nvar myBots bots\n\nfunc main() {\n    myBots.loadListDB()\n    for _, b := range myBots.List {\n        b.startFunctionX()\n        go b.runAllCommands()\n    }\n\n    //control stop and start bots\n    log.Print(\"expected true = \", myBots.List[0].isEnabled)\n    myBots.List[0].pauseFunctionX()\n    log.Print(\"expected false = \", myBots.List[0].isEnabled)\n\n\n    //wait bots parallels\n    for {\n        time.Sleep(10 * time.Hour)\n    }\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 79534, "user_id": 3744182, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6ab1dca8193d1b5734ba07702e963b6e?s=128&d=identicon&r=PG&f=1", "display_name": "dbc", "link": "https://stackoverflow.com/users/3744182/dbc"}, "edited": false, "score": 1, "creation_date": 1545526201, "post_id": 53898190, "comment_id": 94646345, "body": "Welcome to Stack Overflow! I edited your question to standardize the English grammar slightly."}], "answers": [{"comments": [{"owner": {"reputation": 17, "user_id": 10796961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74a692a45cdb21c19dd917d9f2bcd88?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/10796961/dmitry"}, "edited": false, "score": 1, "creation_date": 1545505939, "post_id": 53898455, "comment_id": 94642634, "body": "Tnx!! you save my time!"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 1, "last_activity_date": 1545504861, "creation_date": 1545504861, "answer_id": 53898455, "question_id": 53898190, "link": "https://stackoverflow.com/questions/53898190/add-some-date-to-struct-then-put-this-into-go-template/53898455#53898455", "title": "Add some date to Struct then put this into go template", "body": "<p>What I normally pass in to my template is a <code>map[string]interface{}</code>:</p>\n\n<pre><code>data := make(map[string]interface{})\ndata[\"Categories\"] = categories\ndata[\"Title\"] = \"This is the title\"\nconfig.TPL.ExecuteTemplate(w, \"catalog.html\", data)\n\n&lt;title&gt;{{.Title}}&lt;/title&gt;\n&lt;body&gt;\n{{range .Categories}}\n    &lt;p&gt;&lt;a href=\"/show?getinfo={{ .Cat_id}}\"&gt;{{ .Cat_id}}&lt;/a&gt; - {{ .Parent_id}} - {{ .Cat_name}} &lt;a href=\"/show?getinfo={{ .Cat_id}}\"&gt;\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c&lt;/a&gt;\n{{end}}\n&lt;/body&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1105, "user_id": 1262319, "user_type": "registered", "accept_rate": 76, "profile_image": "https://i.stack.imgur.com/pIk9w.jpg?s=128&g=1", "display_name": "Mostafa Solati", "link": "https://stackoverflow.com/users/1262319/mostafa-solati"}, "is_accepted": true, "score": 0, "last_activity_date": 1545505382, "last_edit_date": 1545505382, "creation_date": 1545505057, "answer_id": 53898487, "question_id": 53898190, "link": "https://stackoverflow.com/questions/53898190/add-some-date-to-struct-then-put-this-into-go-template/53898487#53898487", "title": "Add some date to Struct then put this into go template", "body": "<p>You have to create another struct and put categories and page info in there.\nyou can use maps too, but struct is cleaner approach.</p>\n\n<pre><code>type Page struct {\nTitle string\nCategories []Cat_Tree\n}\n\nfunc Catalog(w http.ResponseWriter, r *http.Request) {\n    if r.Method != \"GET\" {\n        http.Error(w, http.StatusText(405), http.StatusMethodNotAllowed)\n        return\n    }\n\n    categories, err := models.GetCategories()\n    if err != nil {\n        http.Error(w, http.StatusText(500), http.StatusInternalServerError)\n        return\n    }\n    page := Page {Title:\"My Title\",Categories:categories}\n    config.TPL.ExecuteTemplate(w, \"catalog.html\", page)\n}\n</code></pre>\n\n<p>And in your template:  </p>\n\n<pre><code>&lt;h1&gt;{{ .Title }}&lt;/h1&gt;\n{{range .Categories}}\n    &lt;p&gt;&lt;a href=\"/show?getinfo={{ .Cat_id}}\"&gt;{{ .Cat_id}}&lt;/a&gt; - {{ .Parent_id}} - {{ .Cat_name}} &lt;a href=\"/show?getinfo={{ .Cat_id}}\"&gt;\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c&lt;/a&gt;\n    {{end}}\n</code></pre>\n"}], "owner": {"reputation": 17, "user_id": 10796961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b74a692a45cdb21c19dd917d9f2bcd88?s=128&d=identicon&r=PG&f=1", "display_name": "Dmitry", "link": "https://stackoverflow.com/users/10796961/dmitry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 30, "favorite_count": 0, "accepted_answer_id": 53898487, "answer_count": 2, "score": -2, "last_activity_date": 1545558939, "creation_date": 1545502512, "last_edit_date": 1545558939, "question_id": 53898190, "link": "https://stackoverflow.com/questions/53898190/add-some-date-to-struct-then-put-this-into-go-template", "title": "Add some date to Struct then put this into go template", "body": "<p>I have a file controllers/catalog.go it contains a HTTP handler:</p>\n\n<pre><code>func Catalog(w http.ResponseWriter, r *http.Request) {\n    if r.Method != \"GET\" {\n        http.Error(w, http.StatusText(405), http.StatusMethodNotAllowed)\n        return\n    }\n\n    categories, err := models.GetCategories()\n    if err != nil {\n        http.Error(w, http.StatusText(500), http.StatusInternalServerError)\n        return\n    }\n    fmt.Print(categories)\n    config.TPL.ExecuteTemplate(w, \"catalog.html\", categories)\n}\n</code></pre>\n\n<p>and  models/getcategories.go:</p>\n\n<pre><code>type Cat_tree struct {\n    Cat_id    int\n    Parent_id int\n    Cat_name  string\n}\n\nfunc GetCategories() ([]Cat_tree, error) {\n    rows, err := config.DB.Query(\"SELECT cat_id, parent_id, cat_name FROM categories WHERE active = true ORDER BY Parent_id ASC\")\n    if err != nil {\n        return nil, err\n    }\n    defer rows.Close()\n\n    categories := make([]Cat_tree, 0)\n\n    for rows.Next() {\n        cat := Cat_tree{}\n        err := rows.Scan(&amp;cat.Cat_id, &amp;cat.Parent_id, &amp;cat.Cat_name)\n        if err != nil {\n            return nil, err\n        }\n        categories = append(categories, cat)\n    }\n    if err = rows.Err(); err != nil {\n        return nil, err\n    }\n\n    return categories, nil\n}\n</code></pre>\n\n<p>How i can add some data to a <strong>categories</strong> page Title for example</p>\n\n<p>Now in template like this</p>\n\n<pre><code>   {{range .}}\n    &lt;p&gt;&lt;a href=\"/show?getinfo={{ .Cat_id}}\"&gt;{{ .Cat_id}}&lt;/a&gt; - {{ .Parent_id}} - {{ .Cat_name}} &lt;a href=\"/show?getinfo={{ .Cat_id}}\"&gt;\u041f\u043e\u043a\u0430\u0437\u0430\u0442\u044c&lt;/a&gt;\n    {{end}}\n</code></pre>\n\n<p>i'd like to add some  <code>{{Title}}</code> </p>\n"}, {"tags": ["go", "vim", "vi", "vim-plugin", "youcompleteme"], "owner": {"reputation": 47, "user_id": 6659577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/825bff787a1eded149e53ccb41315409?s=128&d=identicon&r=PG&f=1", "display_name": "Sanghai", "link": "https://stackoverflow.com/users/6659577/sanghai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 176, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545571348, "creation_date": 1545497017, "last_edit_date": 1545571348, "question_id": 53897503, "link": "https://stackoverflow.com/questions/53897503/youcompleteme-config-golang-to-auto-import-package-when-first-use-package", "title": "youcompleteme config golang to auto import package when first use package", "body": "<p>When using VIM with Youcompleteme to write the go language, when the current file first references a package file, how to configure ycm_extra.conf so that the first time can also automatically fill and import the corresponding header</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 23386, "user_id": 1811501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tj0qU.jpg?s=128&g=1", "display_name": "thaJeztah", "link": "https://stackoverflow.com/users/1811501/thajeztah"}, "edited": false, "score": 1, "creation_date": 1545499562, "post_id": 53897144, "comment_id": 94641150, "body": "Does <code>fmt.Printf(&quot;%50.49f&quot;, result)</code> satisfy your use-case? see <a href=\"https://play.golang.org/p/4wxpHcRUDCl\" rel=\"nofollow noreferrer\">play.golang.org/p/4wxpHcRUDCl</a>"}, {"owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "reply_to_user": {"reputation": 23386, "user_id": 1811501, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/tj0qU.jpg?s=128&g=1", "display_name": "thaJeztah", "link": "https://stackoverflow.com/users/1811501/thajeztah"}, "edited": false, "score": 1, "creation_date": 1545501148, "post_id": 53897144, "comment_id": 94641529, "body": "It helped to have more digits, but i kind of wanted the amount that i wanted, like 200 digits or more."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1545504406, "post_id": 53897144, "comment_id": 94642314, "body": "You cannot &quot;overlaod&quot; such stuff. Use math.big. Anything else is doomed to fail."}], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "edited": false, "score": 0, "creation_date": 1545502923, "post_id": 53897920, "comment_id": 94641961, "body": "when i try to do this the output turns into nothing, see the edit"}], "tags": [], "owner": {"reputation": 281, "user_id": 3055891, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ddd24952cfc90c5e89c05789caa75f4e?s=128&d=identicon&r=PG&f=1", "display_name": "vthallam", "link": "https://stackoverflow.com/users/3055891/vthallam"}, "is_accepted": false, "score": 1, "last_activity_date": 1545500096, "creation_date": 1545500096, "answer_id": 53897920, "question_id": 53897144, "link": "https://stackoverflow.com/questions/53897144/how-to-overwrite-overloaded-variable/53897920#53897920", "title": "How to overwrite overloaded variable", "body": "<p>Try using <code>MaxFloat32</code> or <code>MaxFloat64</code> in the <code>math</code> package. Like, check if <code>result &gt; math.MaxFloat64</code>?</p>\n"}], "owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1545502845, "creation_date": 1545494090, "last_edit_date": 1545502845, "question_id": 53897144, "link": "https://stackoverflow.com/questions/53897144/how-to-overwrite-overloaded-variable", "title": "How to overwrite overloaded variable", "body": "<p>i'm experimenting with go with pi calculating formulas, and made this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math\"\n)\n\nfunc bbpformula() {\n\n    var result float64\n\n    for k := 0.0; k &lt;= 100; k++ {\n\n            result += (1 / math.Pow(16.0, k) * ((4 / (8*k + 1)) - (2 / (8*k + 4)) - (1 / (8*k + 5)) - (1 / (8*k + 6))))\n\n    }\n\n    fmt.Println(result)\n\n}\n\nfunc main() {\n\n    bbpformula()\n\n}\n</code></pre>\n\n<p>and the output is:</p>\n\n<p>3.141592653589793</p>\n\n<p>However, i would like more digits, i tried using the math/big package to make the variables big.Float with simpler formulas, but the arithmetic operations were extremely confusing and slow.</p>\n\n<p>So my idea is overwriting the result variable when its overloaded (maximum capacity), but i have no ideia how to do that!</p>\n\n<p>Could someone please explain to me how that is done?</p>\n\n<p>edit: tried to use the if result > math.MaxFloat64 but the output turns into nothing</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"math\"\n)\n\nfunc bbpformula() {\n\n    var result float64\n    var resultb float64\n\n    for k := 0.0; k &lt;= 100; k++ {\n\n            result += (1 / math.Pow(16.0, k) * ((4 / (8*k + 1)) - (2 / (8*k + 4)) - (1 / (8*k + 5)) - (1 / (8*k + 6))))\n            if result &gt; math.MaxFloat64 {\n                    fmt.Println(result)\n                    resultb += (1 / math.Pow(16.0, k) * ((4 / (8*k + 1)) - (2 / (8*k + 4)) - (1 / (8*k + 5)) - (1 / (8*k + 6))))\n                    if resultb == math.MaxFloat64 {\n                            fmt.Println(resultb)\n                            result = 0\n                    }\n\n            }\n\n    }\n\n}\n\nfunc main() {\n\n    bbpformula()\n\n}\n</code></pre>\n\n<p>output:             </p>\n"}, {"tags": ["go", "gmail-api"], "owner": {"reputation": 376, "user_id": 6618366, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/IbooN.jpg?s=128&g=1", "display_name": "Alejandro", "link": "https://stackoverflow.com/users/6618366/alejandro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 63, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545493128, "creation_date": 1545493128, "question_id": 53897027, "link": "https://stackoverflow.com/questions/53897027/cant-download-attachment-from-multipart-signed-type-when-using-gmail-api-for-go", "title": "Can&#39;t download attachment from multipart/signed type when using gmail api for Go", "body": "<p>I'm trying to develop a simple utility for download a whole list of attachments by a specific label in Gmail.\nI'm using the official gmail api for Go and I just started with the sample written <a href=\"https://developers.google.com/gmail/api/quickstart/go\" rel=\"nofollow noreferrer\">here</a> then I wrote my own code to archive my goal:</p>\n\n<pre><code>fmt.Println(\"Labels:\")\nfor _, label := range labelList.Labels {\n\n    fmt.Printf(\"\\n- %s id: %s\\n\", label.Name, label.Id)\n\n    if label.Id == \"Label_N\" {\n\n        messageList, _ := srv.Users.Messages.List(user).LabelIds(label.Id).Do()\n        if err != nil {\n            log.Fatalf(\"Error: %v\", err)\n        }\n\n        for _, msg := range messageList.Messages {\n\n            // look for message\n            message, err := srv.Users.Messages.Get(user, msg.Id).Do()\n            if err != nil {\n                log.Fatalf(\"Unable to retrieve message: %v\", err)\n            }\n\n            mailReceivedDate := time.Unix(0, message.InternalDate*int64(time.Millisecond)).Format(time.RFC3339Nano)\n            fmt.Println(\"______________________________________________\")\n            fmt.Printf(\"Content-Type: %s\\n\", message.Payload.MimeType)\n            fmt.Printf(\"From: %s\\n\", message.Payload.Headers[7].Value)\n\n            if len(message.Payload.Parts) &gt; 0 {\n                for _, p := range message.Payload.Parts {\n                    fmt.Printf(\"Filename: %s\\n\", p.Filename)\n                    fmt.Printf(\"Attachment ID: %s\\n\", p.Body.AttachmentId)\n                    if isPdfAttachment(p.MimeType) {\n                        attach, err := srv.Users.Messages.Attachments.Get(user, message.Id, p.Body.AttachmentId).Do()\n                        decoded, _ := base64.URLEncoding.DecodeString(attach.Data)\n                        if err != nil {\n                            log.Fatalf(\"Unable to retrieve attachment: %v\", err)\n                        }\n                        p.Filename = mailReceivedDate + \"_\" + p.Filename\n                        fmt.Printf(\"File to write:   %s - Type: %s\\n\", p.Filename, p.MimeType)\n                        err = ioutil.WriteFile(p.Filename, decoded, 0644)\n                        if err != nil {\n                            log.Fatalf(\"Unable to save attachment: %v\", err)\n                        }\n                    }\n                }\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The problem is that I don't receive any AttachmentId when message MimeType is \"<strong>multipart/signed</strong>\" (the email contains 1 pdf file).</p>\n\n<p><a href=\"https://i.stack.imgur.com/Yi2I3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/Yi2I3.png\" alt=\"Logs\"></a></p>\n\n<p>What should I do to for download attachments from this kind of email?\nCan someone help me?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1726, "user_id": 4935554, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/xSuJ1.jpg?s=128&g=1", "display_name": "Ng Sharma", "link": "https://stackoverflow.com/users/4935554/ng-sharma"}, "edited": false, "score": 1, "creation_date": 1545487824, "post_id": 53896220, "comment_id": 94638334, "body": "<a href=\"https://blog.learngoprogramming.com/golang-const-type-enums-iota-bc4befd096d3\" rel=\"nofollow noreferrer\">blog.learngoprogramming.com/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3344, "user_id": 903998, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/pZCd4.jpg?s=128&g=1", "display_name": "Victor", "link": "https://stackoverflow.com/users/903998/victor"}, "edited": false, "score": 1, "creation_date": 1545492224, "post_id": 53896778, "comment_id": 94639334, "body": "allow me to provide some of language&#39;s author code regarding &quot;enums&quot;: <a href=\"https://golang.org/src/net/http/status.go\" rel=\"nofollow noreferrer\">golang.org/src/net/http/status.go</a>"}], "tags": [], "owner": {"reputation": 1733, "user_id": 10490857, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GA97O.jpg?s=128&g=1", "display_name": "Maxim", "link": "https://stackoverflow.com/users/10490857/maxim"}, "is_accepted": false, "score": 4, "last_activity_date": 1545491338, "creation_date": 1545491338, "answer_id": 53896778, "question_id": 53896220, "link": "https://stackoverflow.com/questions/53896220/how-to-use-enums-in-go/53896778#53896778", "title": "How to use enums in go?", "body": "<blockquote>\n  <p>Something like the following?</p>\n</blockquote>\n\n<p>Not yet</p>\n\n<p>Read here <a href=\"https://stackoverflow.com/questions/14426366/what-is-an-idiomatic-way-of-representing-enums-in-go\">What is an idiomatic way of representing enums in Go?</a></p>\n"}, {"tags": [], "owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "is_accepted": false, "score": 3, "last_activity_date": 1545502509, "last_edit_date": 1545502509, "creation_date": 1545501151, "answer_id": 53898050, "question_id": 53896220, "link": "https://stackoverflow.com/questions/53896220/how-to-use-enums-in-go/53898050#53898050", "title": "How to use enums in go?", "body": "<pre><code>const (\n    statusPending = \"PENDING\"\n    statusActive  = \"ACTIVE\"\n)\n</code></pre>\n\n<p>Or, application of the example at <a href=\"https://blog.learngoprogramming.com/golang-const-type-enums-iota-bc4befd096d3\" rel=\"nofollow noreferrer\">Ultimate Visual Guide to Go Enums</a> </p>\n\n<pre><code>// Declare a new type named status which will unify our enum values\n// It has an underlying type of unsigned integer (uint).\ntype status int\n\n// Declare typed constants each with type of status\nconst (\n    pending status = iota\n    active\n)\n\n// String returns the string value of the status\nfunc (s status) String() string {\n    strings := [...]string{\"PENDING\", \"ACTIVE\"}\n\n    // prevent panicking in case of status is out-of-range\n    if s &lt; pending || s &gt; active {\n        return \"Unknown\"\n    }\n\n    return strings[s]\n}\n</code></pre>\n"}], "owner": {"reputation": 3895, "user_id": 4040931, "user_type": "registered", "accept_rate": 25, "profile_image": "https://graph.facebook.com/705151302/picture?type=large", "display_name": "David Alsh", "link": "https://stackoverflow.com/users/4040931/david-alsh"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11404, "favorite_count": 0, "closed_date": 1545502412, "answer_count": 2, "score": 0, "last_activity_date": 1545502509, "creation_date": 1545486848, "question_id": 53896220, "link": "https://stackoverflow.com/questions/53896220/how-to-use-enums-in-go", "closed_reason": "Duplicate", "title": "How to use enums in go?", "body": "<p>is there a simple implementation of enums in golang?\nSomething like the following?</p>\n\n<pre><code>type status enum[string] {\n    pending = \"PENDING\"\n    active = \"ACTIVE\"\n}\n</code></pre>\n"}, {"tags": ["string", "go", "quotes"], "answers": [{"comments": [{"owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "edited": false, "score": 1, "creation_date": 1545486498, "post_id": 53896086, "comment_id": 94638086, "body": "oh, really?? Isn&#39;t there anything that I can do to handle it in a better way?"}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "reply_to_user": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "edited": false, "score": 2, "creation_date": 1545486574, "post_id": 53896086, "comment_id": 94638098, "body": "As I said, this is strictly dependent on the shell you are using."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "reply_to_user": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "edited": false, "score": 1, "creation_date": 1545486632, "post_id": 53896086, "comment_id": 94638105, "body": "You can add the quotes inside your program."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1545518042, "post_id": 53896086, "comment_id": 94645042, "body": "In bash, your program cannot tell the difference between <code>go run test.go status</code> and <code>go run test.go &quot;status&quot;</code>. The quotes are removed by the shell before your program can see them."}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": false, "score": 3, "last_activity_date": 1545485760, "creation_date": 1545485760, "answer_id": 53896086, "question_id": 53896081, "link": "https://stackoverflow.com/questions/53896081/how-to-keep-quotes-in-os-args/53896086#53896086", "title": "How to keep quotes in os.Args", "body": "<p>This strictly depends on the shell executing the program and not Go itself. If you are using bash for example, try executing the program while escaping the double quotes. Like so </p>\n\n<pre><code>go run test.go '\"status\"'\n# OR\ngo run test.go \\\"status\\\"\n</code></pre>\n"}], "owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 528, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1545514812, "creation_date": 1545485649, "last_edit_date": 1545514812, "question_id": 53896081, "link": "https://stackoverflow.com/questions/53896081/how-to-keep-quotes-in-os-args", "title": "How to keep quotes in os.Args", "body": "<p>I'm trying to print the command line arguments that I'm passing to my program, but the quotes (\") are disappearing.</p>\n\n<p>e.g:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n    fmt.Println(strings.join(os.Args[1:], \" \"))\n}\n</code></pre>\n\n<p>Then run using <code>go run test.go \"status\"</code> - This should print <code>\"status\"</code>, but it's printing <code>status</code>.</p>\n"}, {"tags": ["go", "io"], "comments": [{"owner": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "edited": false, "score": 2, "creation_date": 1545475417, "post_id": 53894883, "comment_id": 94635838, "body": "The <code>bufio.Scanner</code> uses an <code>io.Reader</code> underneath, but gives no way to access it from outside. Since <code>bufio.NewScanner</code> method requires an <code>io.Reader</code>, you&#39;d only need to use the <code>io.Reader</code> you&#39;ve created beforehand."}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545495833, "post_id": 53895901, "comment_id": 94640264, "body": "This eats the newlines though. fmt.Fprintln preserves them."}, {"owner": {"reputation": 43, "user_id": 7788947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOTNR.jpg?s=128&g=1", "display_name": "paulsc", "link": "https://stackoverflow.com/users/7788947/paulsc"}, "edited": false, "score": 0, "creation_date": 1545567986, "post_id": 53895901, "comment_id": 94651854, "body": "Thanks. One thing I still don&#39;t understand though. How can I apply this to a call to http.NewRequest(method, url string, body io.Reader) ? It seems like with NewRequest the code is &quot;Reader-driven&quot; as in, the http request will do the job of making Read() calls. If I use a pipe, my code becomes &quot;Writer-driven&quot; where something needs to trigger the write, in your example the go() function above.  If I understand correctly, if I call NewRequest() first it will block until there&#39;s something to read, or... wait I think the coin just dropped. Is that what the goroutine is for ? Not familar with it."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 0, "creation_date": 1545568297, "post_id": 53895901, "comment_id": 94651913, "body": "Yes the goroutine is to disallow it from blocking while converting"}, {"owner": {"reputation": 43, "user_id": 7788947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOTNR.jpg?s=128&g=1", "display_name": "paulsc", "link": "https://stackoverflow.com/users/7788947/paulsc"}, "edited": false, "score": 0, "creation_date": 1545571910, "post_id": 53895901, "comment_id": 94652691, "body": "Ok I just tried it out. I definitely learned something but I still have a problem.   Using this goroutine method, my http request writes data to the server in chunks, line-by-line. If I look at the network traffic using wireshark, I can see one packet going out per line instead of a big packet with all the data at once. This seems like it will affect performance.   Is there any workaround for this ?"}, {"owner": {"reputation": 43, "user_id": 7788947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOTNR.jpg?s=128&g=1", "display_name": "paulsc", "link": "https://stackoverflow.com/users/7788947/paulsc"}, "edited": false, "score": 0, "creation_date": 1545746141, "post_id": 53895901, "comment_id": 94687690, "body": "So I ended up taking your code, and wrapping it in <a href=\"https://gist.github.com/paulsc/ca9e5437cd784cf81b2b18c1f0321ea7\" rel=\"nofollow noreferrer\">another reader that forces full buffer reads</a>. This works, but again feels hacky. I thought the bufio.Reader would&#39;ve worked here, but it still passed on the reads line-by-line, instead of filling the 32k bytes buffer. Any pointers would be greatly appreciated!"}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "reply_to_user": {"reputation": 43, "user_id": 7788947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOTNR.jpg?s=128&g=1", "display_name": "paulsc", "link": "https://stackoverflow.com/users/7788947/paulsc"}, "edited": false, "score": 0, "creation_date": 1545752247, "post_id": 53895901, "comment_id": 94688995, "body": "@paulsc what I&#39;m still not understanding is what you want to achieve on a higher level"}, {"owner": {"reputation": 43, "user_id": 7788947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOTNR.jpg?s=128&g=1", "display_name": "paulsc", "link": "https://stackoverflow.com/users/7788947/paulsc"}, "edited": false, "score": 0, "creation_date": 1545859618, "post_id": 53895901, "comment_id": 94714647, "body": "Thanks for helping. I&#39;m reading a CSV of time-series data from disk, and posting to InfluxDB which has an HTTP api. So I&#39;m reformating the CSV on the fly for the API, and want to write chunks of 5k lines for best performance. I have a Scanner that outputs lines of DB-compatible stuff. I need to somehow hook that to my http Request, which wants an io.Reader. If I use your suggestion, the http request ends up reading one line at a time and sending one line per network packet. That&#39;s why I&#39;m trying to force full buffer reads so that multiple lines get sent at once. My solution seems hacky though."}, {"owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "edited": false, "score": 0, "creation_date": 1545859738, "post_id": 53895901, "comment_id": 94714691, "body": "Did you consider a streaming option on the network level ? Like HTTP/2 or sockets"}, {"owner": {"reputation": 43, "user_id": 7788947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOTNR.jpg?s=128&g=1", "display_name": "paulsc", "link": "https://stackoverflow.com/users/7788947/paulsc"}, "edited": false, "score": 0, "creation_date": 1546518069, "post_id": 53895901, "comment_id": 94880319, "body": "Well it&#39;s using chunked transfer encoding, which is streaming. Also I&#39;m depending on my DB, so can&#39;t change the network protocol. My question was more around if there&#39;s an idomatic way to force full-buffer reads. I was just curious. Anyhow the current solution is already miles better than before."}], "tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 1, "last_activity_date": 1545483987, "creation_date": 1545483987, "answer_id": 53895901, "question_id": 53894883, "link": "https://stackoverflow.com/questions/53894883/idiomatic-way-to-convert-from-a-scanner-to-a-io-reader/53895901#53895901", "title": "Idiomatic way to convert from a scanner to a io.Reader", "body": "<p>A simple method is using <code>io.Pipe</code>. </p>\n\n<pre><code>func ScannerToReader(scanner *bufio.Scanner) io.Reader {\n    reader, writer := io.Pipe()\n\n\n    go func() {\n        defer writer.Close()\n        for scanner.Scan() {\n            writer.Write(scanner.Bytes())\n        }\n    }()\n\n    return reader\n}\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 7788947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lOTNR.jpg?s=128&g=1", "display_name": "paulsc", "link": "https://stackoverflow.com/users/7788947/paulsc"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 473, "favorite_count": 0, "accepted_answer_id": 53895901, "answer_count": 1, "score": 3, "last_activity_date": 1545561215, "creation_date": 1545474809, "last_edit_date": 1545561215, "question_id": 53894883, "link": "https://stackoverflow.com/questions/53894883/idiomatic-way-to-convert-from-a-scanner-to-a-io-reader", "title": "Idiomatic way to convert from a scanner to a io.Reader", "body": "<p>I recently ran into this issue of how to read from a CSV file, apply some transformation to every line and write to a HTTP request. </p>\n\n<p>The problem I was faced with was how to convert from a line-by-line reader which returns an arbitrary number of bytes (like a Scanner) to a byte reader, which returns a fixed amount of bytes at every call to Read().</p>\n\n<p>The best solution I came up with is to build a custom io.Reader that would read from the Scanner and buffer bytes locally if they wouldn't fit. Then the buffered bytes would be returned on the next call to Read().</p>\n\n<p>This is what I came up with:\n<a href=\"https://gist.github.com/paulsc/6a0bf30a2a8d898f7a8086aedf6af1e1\" rel=\"nofollow noreferrer\">https://gist.github.com/paulsc/6a0bf30a2a8d898f7a8086aedf6af1e1</a></p>\n\n<p>Intuitively, this feels like the wrong solution, because the code seems like a fairly low-level solution that might already be in the standard library. </p>\n\n<p>Is there a better way, more idiomatic to do this with standard go components ? </p>\n"}, {"tags": ["go", "filesystems", "ntfs", "alternate-data-stream"], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 1, "last_activity_date": 1545484525, "creation_date": 1545484525, "answer_id": 53895954, "question_id": 53894669, "link": "https://stackoverflow.com/questions/53894669/how-to-access-and-modify-alternate-data-streams-ads-with-go/53895954#53895954", "title": "How to access and modify alternate data streams (ADS) with go", "body": "<p>Alternate data streams can be accessed using \":StreamName\" syntax when opening a file in NTFS. </p>\n\n<pre><code>ads, err := os.Open(\"C:\\Path\\To\\My\\File:MyHiddenStream\")\nif err != nil {\n    panic(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 10823002, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-O92iUl1z2SQ/AAAAAAAAAAI/AAAAAAAAAAA/AKxrwcYRowXOPkyzp7uFrZBYGJJsotzOaQ/mo/photo.jpg?sz=128", "display_name": "Christian Cavegn", "link": "https://stackoverflow.com/users/10823002/christian-cavegn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 371, "favorite_count": 0, "accepted_answer_id": 53895954, "answer_count": 1, "score": 2, "last_activity_date": 1545484525, "creation_date": 1545472673, "question_id": 53894669, "link": "https://stackoverflow.com/questions/53894669/how-to-access-and-modify-alternate-data-streams-ads-with-go", "title": "How to access and modify alternate data streams (ADS) with go", "body": "<p>How can I access and modify metadata stored in NTFS alternate data streams with golang?</p>\n\n<p>I already know about <a href=\"https://github.com/pkg/xattr\" rel=\"nofollow noreferrer\">https://github.com/pkg/xattr</a> for accessing metadata stored in extended attribures under linux. However, i need comparable functionality for NTFS.</p>\n"}, {"tags": ["python", "go", "multiprocessing", "python-multiprocessing", "channel"], "comments": [{"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 2, "creation_date": 1545460753, "post_id": 53893549, "comment_id": 94633464, "body": "<code>multiprocessing.Queue(maxsize=0)</code> - from reading the documentation this creates a queue with an infinite size: <i>&quot; If maxsize is less than or equal to zero, the queue size is infinite&quot;</i>. Blocking is only done when there is no place in the queue but with infinite size there is always place."}, {"owner": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 1, "creation_date": 1545460789, "post_id": 53893549, "comment_id": 94633472, "body": "it looks like <code>Queue.put()</code> only if there are no free slots available in the queue. Did you try with <code>Queue(maxsize=1)</code>?"}, {"owner": {"reputation": 458, "user_id": 724872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8ARkU.jpg?s=128&g=1", "display_name": "cxwangyi", "link": "https://stackoverflow.com/users/724872/cxwangyi"}, "reply_to_user": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 0, "creation_date": 1545461193, "post_id": 53893549, "comment_id": 94633523, "body": "Thank you @SteffenUllrich for pointing this out! I changed the program to be <code>q=multiprocessing.Queue(maxsize=1)</code> and the program prints only two &quot;Put&quot;s."}, {"owner": {"reputation": 458, "user_id": 724872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8ARkU.jpg?s=128&g=1", "display_name": "cxwangyi", "link": "https://stackoverflow.com/users/724872/cxwangyi"}, "reply_to_user": {"reputation": 9105, "user_id": 119861, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/O2tUa.png?s=128&g=1", "display_name": "hansaplast", "link": "https://stackoverflow.com/users/119861/hansaplast"}, "edited": false, "score": 0, "creation_date": 1545461233, "post_id": 53893549, "comment_id": 94633531, "body": "@hansaplast Yes, <code>maxsize=1</code> works! Thank you!"}, {"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 1, "creation_date": 1545461359, "post_id": 53893549, "comment_id": 94633549, "body": "Yeah, <code>maxsize=0</code> doesn&#39;t make an unbuffered channel like in Go."}], "answers": [{"comments": [{"owner": {"reputation": 458, "user_id": 724872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8ARkU.jpg?s=128&g=1", "display_name": "cxwangyi", "link": "https://stackoverflow.com/users/724872/cxwangyi"}, "edited": false, "score": 0, "creation_date": 1545461423, "post_id": 53893616, "comment_id": 94633555, "body": "Yes. Thank you! I realized that the default value of <code>maxsize=0</code> indicates a buffer size of infinity instead of 0 as the Go convention after I saw @Steffen Ullrich &#39;s comment <a href=\"https://stackoverflow.com/questions/53893549/why-pythons-multiprocessing-queue-doesnt-block#comment94633464_53893549\" title=\"why pythons multiprocessing queue doesnt block%23comment94633464_53893549\">stackoverflow.com/questions/53893549/&hellip;</a>"}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 2, "last_activity_date": 1545460965, "creation_date": 1545460965, "answer_id": 53893616, "question_id": 53893549, "link": "https://stackoverflow.com/questions/53893549/why-pythons-multiprocessing-queue-doesnt-block/53893616#53893616", "title": "Why Python&#39;s multiprocessing.Queue doesn&#39;t block", "body": "<p>Give a queue length of 1 and it will block as required </p>\n\n<pre><code>   Python 2.7.12 (default, Nov 12 2018, 14:36:49) \n    [GCC 5.4.0 20160609] on linux2\n    Type \"help\", \"copyright\", \"credits\" or \"license\" for more information.\n    &gt;&gt;&gt; import multiprocessing\n    &gt;&gt;&gt; import select\n    &gt;&gt;&gt; import time\n    &gt;&gt;&gt; \n    &gt;&gt;&gt; q = multiprocessing.Queue(maxsize=1)\n    &gt;&gt;&gt; q.put(9)\n    &gt;&gt;&gt; q.put(10)  // blocking here, have to ctrl-c to escape\n    ^CTraceback (most recent call last):\n      File \"&lt;stdin&gt;\", line 1, in &lt;module&gt;\n      File \"/usr/lib/python2.7/multiprocessing/queues.py\", line 101, in put\n        if not self._sem.acquire(block, timeout):\n    KeyboardInterrupt\n    &gt;&gt;&gt; \n</code></pre>\n"}], "owner": {"reputation": 458, "user_id": 724872, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/8ARkU.jpg?s=128&g=1", "display_name": "cxwangyi", "link": "https://stackoverflow.com/users/724872/cxwangyi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 820, "favorite_count": 0, "accepted_answer_id": 53893616, "answer_count": 1, "score": 1, "last_activity_date": 1545460965, "creation_date": 1545460208, "question_id": 53893549, "link": "https://stackoverflow.com/questions/53893549/why-pythons-multiprocessing-queue-doesnt-block", "title": "Why Python&#39;s multiprocessing.Queue doesn&#39;t block", "body": "<p>I am new to Python, but I want to write a multiproccesing program that uses <code>multiprocessing.Queue</code> as Go's channel.  However, it seems that <code>multiprocessing.Queue.put(, block=True)</code> doesn't block as <a href=\"https://docs.python.org/2/library/queue.html#Queue.Queue.put\" rel=\"nofollow noreferrer\">documented</a>.</p>\n\n<p>Here is my Python example program:</p>\n\n<pre><code>import multiprocessing\nimport select\nimport time\n\n\ndef f(q):\n    while True:\n        time.sleep(1)\n        print(\"Put\")\n        q.put(\"hello world\")\n\n\nif __name__ == \"__main__\":\n    q = multiprocessing.Queue(maxsize=0)\n    f(q)\n</code></pre>\n\n<p>I expect that it will print only one \"Put\" and blocks forever.  However, what I got is that it prints \"Put\" repeatedly.</p>\n\n<p>Here is the Go program I think almost equivalent, except that goroutine is a green thread but not a process.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    ch := make(chan int)\n    for {\n        time.Sleep(time.Second)\n        fmt.Println(\"Put\")\n        ch &lt;- 1\n    }\n}\n</code></pre>\n\n<p>When I type <code>go run csp.go</code>, it prints only one \"Put\" and the Go runtime prompts that the program is in deadlock.</p>\n\n<p>Why <code>multiprocessing.Queue.put()</code> doesn't block?</p>\n"}, {"tags": ["sockets", "go", "reactor"], "comments": [{"owner": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "edited": false, "score": 1, "creation_date": 1545474444, "post_id": 53892621, "comment_id": 94635626, "body": "The short answer is: <i>don&#39;t do that!</i> Some of the capabilities in programming languages are based on their design philosophy. The Golang&#39;s asynchrony and concurrency is built upon the, so called, channels. Doing so in Java-style will be unacceptable by the majority of Gophers."}, {"owner": {"reputation": 19, "user_id": 9625173, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "eric chan", "link": "https://stackoverflow.com/users/9625173/eric-chan"}, "reply_to_user": {"reputation": 413, "user_id": 4614306, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1vO71.jpg?s=128&g=1", "display_name": "Alirus", "link": "https://stackoverflow.com/users/4614306/alirus"}, "edited": false, "score": 0, "creation_date": 1545640027, "post_id": 53892621, "comment_id": 94665937, "body": "@Alirus thanks, do agree with you. The key point of the question is that I want to confirm that if there is any solution in Go, to implement the reactor io. I don&#39;t want to discuss the philosophy. Just learning a new language.."}, {"owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "edited": false, "score": 0, "creation_date": 1594272243, "post_id": 53892621, "comment_id": 111068894, "body": "try <a href=\"https://github.com/Allenxuxu/gev\" rel=\"nofollow noreferrer\">github.com/Allenxuxu/gev</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": false, "score": 3, "last_activity_date": 1545485478, "creation_date": 1545485478, "answer_id": 53896061, "question_id": 53892621, "link": "https://stackoverflow.com/questions/53892621/how-can-i-implement-the-reactor-mechanism-the-same-as-java-nio-aio-using-golang/53896061#53896061", "title": "How can I implement the reactor mechanism the same as Java NIO/AIO using Golang", "body": "<p>Golang uses channels, buffered channels, goroutines, and <code>select</code> statements to achieve IO in a similar way to Java's NIO. Perhaps take a look at each of the mentioned .</p>\n"}], "owner": {"reputation": 19, "user_id": 9625173, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "eric chan", "link": "https://stackoverflow.com/users/9625173/eric-chan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 272, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1545520120, "creation_date": 1545445837, "last_edit_date": 1545520120, "question_id": 53892621, "link": "https://stackoverflow.com/questions/53892621/how-can-i-implement-the-reactor-mechanism-the-same-as-java-nio-aio-using-golang", "title": "How can I implement the reactor mechanism the same as Java NIO/AIO using Golang", "body": "<p>I have read many blogs on Golang networking, but most of them use <code>select</code> and <em>channel</em> to handle the newly accepted connection, then read or write data directly. But how can I implement Java-like NIO in Go?</p>\n"}, {"tags": ["go", "error-handling"], "comments": [{"owner": {"reputation": 3392, "user_id": 4532996, "user_type": "registered", "accept_rate": 99, "profile_image": "https://i.stack.imgur.com/uXkl2.png?s=128&g=1", "display_name": "cat", "link": "https://stackoverflow.com/users/4532996/cat"}, "edited": false, "score": 1, "creation_date": 1545444492, "post_id": 53892508, "comment_id": 94631677, "body": "because Wrap gives a pointer to <code>nil</code> and not <code>nil</code> itself?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 6, "creation_date": 1545448003, "post_id": 53892508, "comment_id": 94632015, "body": "<a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">golang.org/doc/faq#nil_error</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1545497508, "post_id": 53892508, "comment_id": 94640661, "body": "See duplicate: <a href=\"https://stackoverflow.com/a/29138676/1705598\">Hiding nil values, understanding why golang fails here</a>"}], "answers": [{"comments": [{"owner": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "edited": false, "score": 1, "creation_date": 1545448965, "post_id": 53892601, "comment_id": 94632098, "body": "Then how could I rewrite the Wrap function to take the type into consideration?"}, {"owner": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "edited": false, "score": 1, "creation_date": 1545449298, "post_id": 53892601, "comment_id": 94632136, "body": "It took a while but now I understand. Basically for my case, Wrap will return error not my custom <code>Error</code>."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "edited": false, "score": 2, "creation_date": 1545451773, "post_id": 53892601, "comment_id": 94632385, "body": "@Ibu: No. <code>foo</code>, not <code>Wrap</code>, will return type <code>error</code>, not your custom type <code>*Error</code>. <code>error</code> is an interface type."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1545446734, "last_edit_date": 1545446734, "creation_date": 1545445574, "answer_id": 53892601, "question_id": 53892508, "link": "https://stackoverflow.com/questions/53892508/golang-returning-nil-does-not-return-nil/53892601#53892601", "title": "Golang returning nil does not return nil", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/builtin/#error\" rel=\"nofollow noreferrer\">type error</a></p>\n  \n  <p>The error built-in interface type is the conventional interface for\n  representing an error condition, with the nil value representing no\n  error.</p>\n\n<pre><code>type error interface {\n    Error() string \n}\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>The value of <code>err</code> of <code>interface</code> type <code>error</code> is not nil. It is the value <code>nil</code> of type <code>*main.Error</code>. In fact, <code>err != nil &amp;&amp; err.(*Error) == nil</code> is <code>true</code></p>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc error1() {\n    err := foo()\n    fmt.Printf(\"%T %v %v %v\\n\", err, err, err == nil, err.(*Error) == nil)\n    if err != nil {\n        fmt.Printf(\"Found error %v\\n\", err)\n        return\n    }\n    fmt.Println(\"No Errors\")\n}\n\nfunc error2() {\n    err := foo()\n    fmt.Printf(\"%T %v %v %v\\n\", err, err, err == nil, err.(*Error) == nil)\n    if err != nil &amp;&amp; err.(*Error) != nil {\n        fmt.Printf(\"Found error %v\\n\", err)\n        return\n    }\n    fmt.Println(\"No Errors\")\n}\n\ntype Error struct {\n    ErrString string\n}\n\nfunc (e *Error) Error() string {\n    return e.ErrString\n}\n\nfunc Wrap(err error, str string) *Error {\n    if err == nil {\n        return nil\n    }\n    e := &amp;Error{\n        ErrString: str + err.Error(),\n    }\n    return e\n}\n\nfunc foo() error {\n    err := bar()\n    return Wrap(err, \"bar called\")\n}\n\nfunc bar() error {\n    return nil\n}\n\nfunc main() {\n    error1()\n    fmt.Println()\n    error2()\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/nwNRa2sNwj0\" rel=\"nofollow noreferrer\">https://play.golang.org/p/nwNRa2sNwj0</a></p>\n\n<p>Output:</p>\n\n<pre><code>*main.Error &lt;nil&gt; false true\nFound error &lt;nil&gt;\n\n*main.Error &lt;nil&gt; false true\nNo Errors\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "edited": false, "score": 1, "creation_date": 1545449472, "post_id": 53892605, "comment_id": 94632155, "body": "Now it makes sense. my Wrap function was returning a <code>*Error</code> nil, not an <code>error</code> nil."}, {"owner": {"reputation": 82, "user_id": 8032076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0abea048d90afb6d3702d4127361fb07?s=128&d=identicon&r=PG&f=1", "display_name": "mehlichmeyer", "link": "https://stackoverflow.com/users/8032076/mehlichmeyer"}, "edited": false, "score": 0, "creation_date": 1599820814, "post_id": 53892605, "comment_id": 112899684, "body": "is it possible to change the custom error so that it will work with (if err != nil), instead of having to check against a declared nil pointer?"}], "tags": [], "owner": {"reputation": 1017, "user_id": 2691759, "user_type": "registered", "accept_rate": 14, "profile_image": "https://i.stack.imgur.com/iAkAI.png?s=128&g=1", "display_name": "pigeonhands", "link": "https://stackoverflow.com/users/2691759/pigeonhands"}, "is_accepted": true, "score": 5, "last_activity_date": 1545445605, "creation_date": 1545445605, "answer_id": 53892605, "question_id": 53892508, "link": "https://stackoverflow.com/questions/53892508/golang-returning-nil-does-not-return-nil/53892605#53892605", "title": "Golang returning nil does not return nil", "body": "<pre><code>if err != nil\n</code></pre>\n\n<p>Is comparing a the err variable to a nil <code>error</code> , but its actually a nil <code>*Error</code></p>\n\n<p>Changing the code to</p>\n\n<pre><code>err:=foo()\nvar  nilerror *Error = nil\nif err != nilerror {\n    fmt.Printf(\"Found error %v\\n\",err)\n    return\n}\nfmt.Println(\"No Errors\")\n</code></pre>\n\n<p>Yields the predicted result.</p>\n"}, {"tags": [], "owner": {"reputation": 650, "user_id": 10556525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ccd7e7dd3b1906fd56323d918c77d3?s=128&d=identicon&r=PG&f=1", "display_name": "Joris", "link": "https://stackoverflow.com/users/10556525/joris"}, "is_accepted": false, "score": 1, "last_activity_date": 1545477545, "creation_date": 1545477545, "answer_id": 53895173, "question_id": 53892508, "link": "https://stackoverflow.com/questions/53892508/golang-returning-nil-does-not-return-nil/53895173#53895173", "title": "Golang returning nil does not return nil", "body": "<p>Since your <code>Error</code> type implements the <code>error</code> interface, the easiest solution, is to return an <code>error</code> in <code>Wrap()</code>:</p>\n\n<pre><code>func Wrap(err error, str string) error {\n    if err == nil {\n        return nil\n    }\n    e := &amp;Error{\n        ErrString: str + err.Error(),\n    }\n    return e\n}\n</code></pre>\n"}], "owner": {"reputation": 39296, "user_id": 560299, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/c38fe465734e8428048585e0acf6174f?s=128&d=identicon&r=PG", "display_name": "Ibu", "link": "https://stackoverflow.com/users/560299/ibu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1694, "favorite_count": 1, "accepted_answer_id": 53892605, "answer_count": 3, "score": 0, "last_activity_date": 1545477545, "creation_date": 1545444215, "question_id": 53892508, "link": "https://stackoverflow.com/questions/53892508/golang-returning-nil-does-not-return-nil", "title": "Golang returning nil does not return nil", "body": "<p>I created a custom error type to wrap errors around for easier debugging in Golang. It works when there are errors to print, but now it is causing a panic. </p>\n\n<p><a href=\"https://play.golang.org/p/VOo5DOIg1zt\" rel=\"nofollow noreferrer\">Demo</a></p>\n\n<pre><code>type Error struct {\n    ErrString string\n}\n\nfunc (e *Error) Error() string {\n    return e.ErrString\n}\n\nfunc Wrap(err error, str string) *Error {\n    if err == nil {\n        return nil\n    }\n    e := &amp;Error{\n        ErrString: str + err.Error(),\n    }\n    return e\n}\n</code></pre>\n\n<p>When I call a function an it doesn't return an error, I should still be able to wrap the error. </p>\n\n<p>The expected behavior is that if the error is nil, it should simply ignore it, unfortunately it does the opposite.</p>\n\n<pre><code>func foo() error {\n    err := bar()\n    return Wrap(err, \"bar called\")\n}\n\nfunc bar() error {\n    return nil\n}\n\nfunc main() {\n    err := foo()\n    if err != nil {\n        fmt.Printf(\"Found error %v\\n\",err)\n        return\n    }\n    fmt.Println(\"No Errors\")\n}\n</code></pre>\n\n<p>I expect it to print <code>No errors</code>. Instead it prints <code>Found error &lt;nil&gt;</code> even though the error is nil. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545424781, "post_id": 53890537, "comment_id": 94628143, "body": "Why do you want to expose all of your functionality from one package? That pretty much defeats the purpose. I would strongly consider just exposing multiple clearly-defined packages and letting developers use them like packages. Go developers are used to the package-per-feature model."}, {"owner": {"reputation": 6086, "user_id": 943814, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e8b4b9fc52a3084be9a2de004e0bb6dc?s=128&d=identicon&r=PG", "display_name": "anderspitman", "link": "https://stackoverflow.com/users/943814/anderspitman"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545425218, "post_id": 53890537, "comment_id": 94628292, "body": "It wouldn&#39;t be the end of the world if it comes to that. I think the bigger problem is having to come up with short names (no underscores or camelCase) that are still meaningful for each package, even though semantically I don&#39;t see any problem with them sharing a single <code>mylib</code> name. I think it&#39;s confusing for users of the lib"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 3, "creation_date": 1545425222, "post_id": 53890537, "comment_id": 94628295, "body": "If the functionality belongs together from the importers point of view, then use one package."}, {"owner": {"reputation": 6086, "user_id": 943814, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e8b4b9fc52a3084be9a2de004e0bb6dc?s=128&d=identicon&r=PG", "display_name": "anderspitman", "link": "https://stackoverflow.com/users/943814/anderspitman"}, "edited": false, "score": 1, "creation_date": 1545425296, "post_id": 53890537, "comment_id": 94628316, "body": "But the packages represent distinct functionality which could be used on its on, and shouldn&#39;t require them to download and build everything else in order to use"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1545425535, "post_id": 53890537, "comment_id": 94628394, "body": "Then they absolutely should be separate packages with distinct names appropriate to the functionality they expose."}], "answers": [{"tags": [], "owner": {"reputation": 2892, "user_id": 1978013, "user_type": "registered", "accept_rate": 36, "profile_image": "https://www.gravatar.com/avatar/fd980993188a54d04e3cf1f1cbf34110?s=128&d=identicon&r=PG", "display_name": "Seaskyways", "link": "https://stackoverflow.com/users/1978013/seaskyways"}, "is_accepted": true, "score": 3, "last_activity_date": 1545428690, "creation_date": 1545428690, "answer_id": 53891109, "question_id": 53890537, "link": "https://stackoverflow.com/questions/53890537/is-there-a-standard-practice-for-splitting-packages-into-modular-components/53891109#53891109", "title": "Is there a standard practice for splitting packages into modular components?", "body": "<p>Answering your question, there is no <strong>idiomatic</strong> way of doing what you want. It is common in JavaScript to import a library and export its members without interference. This is not the case in Golang.</p>\n\n<p>I advise you to host your whole library under a single repo, and split the functionality to packages. The Go compiler will only compile and use the imported packages. </p>\n\n<p>And a tip for the future, Go is very different than almost any other language you previously know \ud83d\ude05</p>\n"}], "owner": {"reputation": 6086, "user_id": 943814, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/e8b4b9fc52a3084be9a2de004e0bb6dc?s=128&d=identicon&r=PG", "display_name": "anderspitman", "link": "https://stackoverflow.com/users/943814/anderspitman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 53891109, "answer_count": 1, "score": -1, "last_activity_date": 1545428690, "creation_date": 1545424619, "question_id": 53890537, "link": "https://stackoverflow.com/questions/53890537/is-there-a-standard-practice-for-splitting-packages-into-modular-components", "title": "Is there a standard practice for splitting packages into modular components?", "body": "<p>I'm working on a library with multiple layers of functionality. I want developers to be able to import only the parts they need, ie <code>mylib-core</code>, <code>mylib-feature1</code>, <code>mylib-feature2</code>, etc. Each lives in its own git repo. I'd also like to provide a simple <code>mylib</code> package which exposes a default set of functionality which is useful for developers new to the library. See <a href=\"https://github.com/d3\" rel=\"nofollow noreferrer\">d3.js</a> version 4+ for something very similar to what I'm trying to accomplish.</p>\n\n<p>The problems I've run into are</p>\n\n<ol>\n<li><p>Apparently you can't share a package name between packages. This is a problem because it would be nice to import all the desired repos and then simply have everything available under the <code>mylib</code> name.</p></li>\n<li><p>I don't see an obvious way to re-export functionality, in order to build the default <code>mylib</code> package.</p></li>\n</ol>\n\n<p>Are there good solutions or a more idomatic go way to accomplish what I'm shooting for?</p>\n"}, {"tags": ["go", "server", "load", "goroutine", "low-latency"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1545423060, "post_id": 53890318, "comment_id": 94627566, "body": "You can&#39;t. All goroutines have equal priority."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1545423153, "post_id": 53890318, "comment_id": 94627596, "body": "You can lock a goroutine to its underlying OS thread with <code>runtime.LockOSThread</code> (<a href=\"https://github.com/golang/go/wiki/LockOSThread\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/LockOSThread</a>) but that still doesn&#39;t get you <i>priority</i> and actually wastes an OS thread because it will spend the vast majority of its time blocked waiting for an incoming connection."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1545425150, "post_id": 53890318, "comment_id": 94628262, "body": "Even if you could, that&#39;s not generally a good architecture for a high throughput server, as large bursts would overwhelm the system. The OS syn backlog buffers the incoming connections, preventing you from having to service them immediately, so having the accept loop handle extra connections without workers to service them doesn&#39;t really buy you much."}, {"owner": {"reputation": 2138, "user_id": 1035789, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de156e629f4fde4fcf96cea8759abaf8?s=128&d=identicon&r=PG", "display_name": "viji", "link": "https://stackoverflow.com/users/1035789/viji"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1545523408, "post_id": 53890318, "comment_id": 94645952, "body": "@JimB I didn&#39;t say that workers won&#39;t run. All I&#39;m saying is that acceptor shouldn&#39;t get evicted. It should continuously run. The workers can maintain queue to process at their pace. We can have high number of workers. I don&#39;t understand how this is not a good architecture, when we&#39;ve nginx working on the same model."}, {"owner": {"reputation": 2138, "user_id": 1035789, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de156e629f4fde4fcf96cea8759abaf8?s=128&d=identicon&r=PG", "display_name": "viji", "link": "https://stackoverflow.com/users/1035789/viji"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545523632, "post_id": 53890318, "comment_id": 94645991, "body": "@Adrian Would locking to a thread, ensure that the goroutine won&#39;t get evicted? That&#39;s my concern. If multiple goroutines get scheduled to the same thread, then it&#39;s not helpful."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1545535608, "post_id": 53890318, "comment_id": 94647336, "body": "@viji, but what you\u2019re describing is what the OS already does for you. Until you have benchmarks that show the accept thread is a bottleneck (which is also separate from the poller itself), this seems like solution in search of a problem."}, {"owner": {"reputation": 2138, "user_id": 1035789, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de156e629f4fde4fcf96cea8759abaf8?s=128&d=identicon&r=PG", "display_name": "viji", "link": "https://stackoverflow.com/users/1035789/viji"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1546108723, "post_id": 53890318, "comment_id": 94782201, "body": "@Adrian I&#39;m talking about a system where we receive 40k+ connections every second. Acceptor definitely has a problem since we&#39;ve lots of syn flooding message, when acceptor backlog is low, and high latency when acceptor backlog is high. The workers are doing pretty which have latency &lt; 1 ms. But the overall latency is increased to more than 100ms, when the acceptor backlog is high."}, {"owner": {"reputation": 2138, "user_id": 1035789, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de156e629f4fde4fcf96cea8759abaf8?s=128&d=identicon&r=PG", "display_name": "viji", "link": "https://stackoverflow.com/users/1035789/viji"}, "edited": false, "score": 0, "creation_date": 1546108777, "post_id": 53890318, "comment_id": 94782212, "body": "Also, we dont&#39; see this problem when I run multiple processes accepting connections and workers processing them. However, the cache is not shared which is why this model is not very useful."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1546265617, "post_id": 53890318, "comment_id": 94814086, "body": "If you could do this in multiple processes, you could do it in a single process. Just run multiple listeners. It means each has to have a different port or interface, but the same is true of multiple processes so clearly that&#39;s not an issue for you."}, {"owner": {"reputation": 2138, "user_id": 1035789, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de156e629f4fde4fcf96cea8759abaf8?s=128&d=identicon&r=PG", "display_name": "viji", "link": "https://stackoverflow.com/users/1035789/viji"}, "edited": false, "score": 0, "creation_date": 1546287239, "post_id": 53890318, "comment_id": 94819902, "body": "That&#39;s true. In multiple processes, every process has an acceptor and workers (workers are in thousand). Whereas without this, multiple acceptor goroutines may end up in same thread as well, which is not the desired result."}], "answers": [{"comments": [{"owner": {"reputation": 2138, "user_id": 1035789, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de156e629f4fde4fcf96cea8759abaf8?s=128&d=identicon&r=PG", "display_name": "viji", "link": "https://stackoverflow.com/users/1035789/viji"}, "edited": false, "score": 2, "creation_date": 1545523515, "post_id": 53897623, "comment_id": 94645971, "body": "Actually, this is a rate limiting server. The case is for bursty workloads. When there&#39;s a burst of requests, I don&#39;t want to drop them, just because the workers were processing and they evicted the acceptor."}], "tags": [], "owner": {"reputation": 1539, "user_id": 423292, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/682568435d3372e1385b671da7f1f793?s=128&d=identicon&r=PG", "display_name": "David Jones", "link": "https://stackoverflow.com/users/423292/david-jones"}, "is_accepted": false, "score": 0, "last_activity_date": 1545497880, "creation_date": 1545497880, "answer_id": 53897623, "question_id": 53890318, "link": "https://stackoverflow.com/questions/53890318/prioritizing-goroutine-in-golang/53897623#53897623", "title": "Prioritizing goroutine in golang", "body": "<p>If you prioritize accepting connections over \"doing the work\", consider what happens over time.  You will create a backlog of work, while accepting more and more connections, bringing even more work to be done.  This just makes the load on your server higher.</p>\n\n<p>Instead, focus on writing your worker code to be very efficient, so that the work will be completed quickly, freeing up resources to handle new connections.</p>\n\n<p>If you are concerned about your server being unable to handle the workload, you should think about rate-limiting your clients.</p>\n"}, {"tags": [], "owner": {"reputation": 2138, "user_id": 1035789, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de156e629f4fde4fcf96cea8759abaf8?s=128&d=identicon&r=PG", "display_name": "viji", "link": "https://stackoverflow.com/users/1035789/viji"}, "is_accepted": true, "score": 1, "last_activity_date": 1546208999, "creation_date": 1546208999, "answer_id": 53981951, "question_id": 53890318, "link": "https://stackoverflow.com/questions/53890318/prioritizing-goroutine-in-golang/53981951#53981951", "title": "Prioritizing goroutine in golang", "body": "<p>I have created threadpools on golang. This should allow easily one to prioritize certain goroutines over others.</p>\n\n<p><a href=\"https://github.com/vijayviji/executor\" rel=\"nofollow noreferrer\">https://github.com/vijayviji/executor</a></p>\n"}], "owner": {"reputation": 2138, "user_id": 1035789, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/de156e629f4fde4fcf96cea8759abaf8?s=128&d=identicon&r=PG", "display_name": "viji", "link": "https://stackoverflow.com/users/1035789/viji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1755, "favorite_count": 0, "accepted_answer_id": 53981951, "answer_count": 2, "score": 1, "last_activity_date": 1546208999, "creation_date": 1545422963, "question_id": 53890318, "link": "https://stackoverflow.com/questions/53890318/prioritizing-goroutine-in-golang", "title": "Prioritizing goroutine in golang", "body": "<p>I'm writing a low latency network, high throughput server in golang. It has acceptor in the main goroutine (which accepts incoming connections). And it passes the incoming connections to 'n' number of worker goroutines.</p>\n\n<p>In this case, to not drop connections, I want the acceptor goroutine to be prioritized over other goroutines so that connections won't be dropped. Or atleast this acceptor goroutine should not get evicted by other worker goroutines.</p>\n\n<p>How can I ensure this?</p>\n"}, {"tags": ["java", "go", "prometheus", "mesos", "marathon"], "answers": [{"tags": [], "owner": {"reputation": 762, "user_id": 3052074, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/619c2a3b094423dd741dc8eb161836f0?s=128&d=identicon&r=PG", "display_name": "Andrey Dyatlov", "link": "https://stackoverflow.com/users/3052074/andrey-dyatlov"}, "is_accepted": true, "score": 1, "last_activity_date": 1545870731, "creation_date": 1545870731, "answer_id": 53938562, "question_id": 53890083, "link": "https://stackoverflow.com/questions/53890083/prometheus-dynamic-port-service-discovery-with-marathon-mesos/53938562#53938562", "title": "Prometheus dynamic port service discovery with Marathon/Mesos", "body": "<p>It is a <a href=\"https://github.com/prometheus/prometheus/issues/4855\" rel=\"nofollow noreferrer\">known bug in Prometheus</a>: it uses the <code>servicePort</code> Marathon app definition property instead of the <code>hostPort</code> one. It is <a href=\"https://github.com/prometheus/prometheus/releases/tag/v2.6.0\" rel=\"nofollow noreferrer\">fixed in the v2.6.0</a>.</p>\n"}], "owner": {"reputation": 841, "user_id": 4449954, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/07ee6cc057d651494c7374f18617760b?s=128&d=identicon&r=PG&f=1", "display_name": "stuart", "link": "https://stackoverflow.com/users/4449954/stuart"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 341, "favorite_count": 0, "accepted_answer_id": 53938562, "answer_count": 1, "score": 2, "last_activity_date": 1545870731, "creation_date": 1545421683, "question_id": 53890083, "link": "https://stackoverflow.com/questions/53890083/prometheus-dynamic-port-service-discovery-with-marathon-mesos", "title": "Prometheus dynamic port service discovery with Marathon/Mesos", "body": "<p>I've been unable to find an answer to this after days of Googling. I have a service running in Marathon/Mesos. I have a Prometheus cluster scraping metrics. My Marathon metrics port config looks like this:</p>\n\n<pre><code>{\n  \"containerPort\": 8081,\n  \"hostPort\": 0,\n  \"servicePort\": 31301,\n  \"protocol\": \"tcp\",\n  \"labels\": {\n    \"metrics\": \"/metrics\"\n  }\n}\n</code></pre>\n\n<p>Prometheus, configured with just a boilerplate marathon-sd config, successfully finds this target, but it then listens for metrics on: <code>__address__ = [NodeIP]:31301</code>; so it's listening on the host's IP with the service port, rather than the dynamically assigned host port, while the service port only matters for Marathon-LB. </p>\n\n<p>I know that Marathon defines the environment variable <code>$PORT0</code> in the container to be the host port, however I can't figure out how to access this from the Prometheus SD config, nor how to access other fields dynamically configured by Marathon like <code>Endpoints</code>. Does anyone have any suggestions? I can't/don't want to assign a static <code>hostPort</code> because I have more containers than there are physical nodes in the cluster, as is sort of the point with container orchestration. </p>\n"}, {"tags": ["go", "protocol-buffers"], "answers": [{"tags": [], "owner": {"reputation": 6958, "user_id": 22517, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/9d4871c8edb11d8d8e2fc4de4a99f2bc?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/22517/peter"}, "is_accepted": true, "score": 3, "last_activity_date": 1553268375, "last_edit_date": 1553268375, "creation_date": 1547216918, "answer_id": 54148488, "question_id": 53889888, "link": "https://stackoverflow.com/questions/53889888/how-to-access-proto-enumvalueoptions-extension-values/54148488#54148488", "title": "How to access proto.EnumValueOptions extension values", "body": "<p>Bit late but I've just run into the same; you can do it like this:</p>\n\n<pre><code>fd, _ := descriptor.ForMessage(&amp;pb.Details{})\nfor _, e := range fd.EnumType {\n    if e.GetName() == \"MyEnum\" {\n        for _, v := range e.Value {\n            ext, err := proto.GetExtension(v.Options, pb.E_Meta)\n            if err == nil {\n                details := ext.(*pb.Details)\n                // do stuff with details\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>There might be a more direct way of getting the enum descriptor, although I haven't managed after a bit of wrangling.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 14756555, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-MqS6CyoJeJo/AAAAAAAAAAI/AAAAAAAAAAA/AMZuucmr-AkwRHtSeUsnUrGnoLML2kvxlQ/s96-c/photo.jpg?sz=128", "display_name": "Robert Tiganetea", "link": "https://stackoverflow.com/users/14756555/robert-tiganetea"}, "is_accepted": false, "score": 0, "last_activity_date": 1607002495, "creation_date": 1607002495, "answer_id": 65127027, "question_id": 53889888, "link": "https://stackoverflow.com/questions/53889888/how-to-access-proto-enumvalueoptions-extension-values/65127027#65127027", "title": "How to access proto.EnumValueOptions extension values", "body": "<p>After many hours, I have found a method to access the description for the enum. Here is my implementation, I hope it helps.</p>\n<p>In a file called enum.go in the same package as the generated .pb file, I added this method to the enum type that retrieves the description.</p>\n<pre><code>func (t MyEnum) GetValue() (*Details, error) {\n    tt, err := proto.GetExtension(proto.MessageV1(t.Descriptor().Values().ByNumber(t.Number()).Options()), E_Details)\n    if err != nil {\n        return nil, err\n    }\n    return tt.(*Details), nil\n}\n</code></pre>\n<p>I am sure there is an easier way, but until somebody finds one, this should work.</p>\n"}], "owner": {"reputation": 152, "user_id": 4597608, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-5Y3wbHxY1d0/AAAAAAAAAAI/AAAAAAAAAUQ/ZCaxo0UhY-c/photo.jpg?sz=128", "display_name": "Brenno Costa", "link": "https://stackoverflow.com/users/4597608/brenno-costa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 977, "favorite_count": 1, "accepted_answer_id": 54148488, "answer_count": 2, "score": 3, "last_activity_date": 1607002495, "creation_date": 1545420664, "last_edit_date": 1573652396, "question_id": 53889888, "link": "https://stackoverflow.com/questions/53889888/how-to-access-proto-enumvalueoptions-extension-values", "title": "How to access proto.EnumValueOptions extension values", "body": "<p>I have similar setup as bellow, how can I access my extension values from <code>XYZ</code> enum using \"github.com/golang/protobuf/proto\"?</p>\n\n<pre><code>  extend google.protobuf.EnumValueOptions {\n    Details meta = 50001;\n  }\n\n  message Details {\n    string description = 1;\n  }\n\n  enum MyEnum {\n    MY_ENUM_UNSPECIFIED = 0;\n    XYZ = 1 [deprecated=true, (meta) = {description: \"lorem ipsum\"}];\n  }\n</code></pre>\n\n<p>I'm aware of <code>proto.GetExtension(proto.Message, proto.ExtensionDesc)</code>, however I wasn't able to figure out how it can be used for the enum...</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545415511, "post_id": 53889068, "comment_id": 94624885, "body": "It is pretty opinion-based but I would strongly advise the first as there&#39;s no real reason to do the second and it creates magic strings which are a code smell. If there&#39;s a lot of duplicate code you can always make an unexported method that the other three methods can call internally."}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 1, "creation_date": 1545415523, "post_id": 53889068, "comment_id": 94624889, "body": "Getters aren&#39;t often used in Go. Ideally, your methods are invoked to do something instead of inspecting."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1545415888, "post_id": 53889068, "comment_id": 94625008, "body": "Also, by convention these methods would just be called <code>Sections()</code>, <code>Values()</code> and <code>Keys()</code>"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1545416666, "post_id": 53889068, "comment_id": 94625285, "body": "As Go can have multiple return values: How about GetAll which returns all of them?"}], "answers": [{"tags": [], "owner": {"reputation": 650, "user_id": 10556525, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/38ccd7e7dd3b1906fd56323d918c77d3?s=128&d=identicon&r=PG&f=1", "display_name": "Joris", "link": "https://stackoverflow.com/users/10556525/joris"}, "is_accepted": false, "score": 3, "last_activity_date": 1545416834, "creation_date": 1545416834, "answer_id": 53889318, "question_id": 53889068, "link": "https://stackoverflow.com/questions/53889068/adding-3-methods-or-a-generic-one/53889318#53889318", "title": "Adding 3 methods or a generic one", "body": "<p>The only reason to use the second one would be if the property is only known at runtime. Then there is a legitimate reason to parse the name and select the value according to its name.</p>\n\n<p>However, since you suggest that the first one is an option, Go with that. It prevents you from having conditional logic at a place where it unnecessary. Otherwise, you'd strictly have to handle the cases where <code>propertyName</code> is not any of the valid options; introducing a possible error where there should not be any.</p>\n\n<p>And as suggested in the comments, the <a href=\"https://golang.org/doc/effective_go.html#Getters\" rel=\"nofollow noreferrer\">idiomatic</a> name for getters are without <code>Get</code>. So <code>Sections()</code> instead of <code>GetSections()</code>.</p>\n"}], "owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "closed_date": 1545417376, "answer_count": 1, "score": 0, "last_activity_date": 1545416834, "creation_date": 1545415297, "question_id": 53889068, "link": "https://stackoverflow.com/questions/53889068/adding-3-methods-or-a-generic-one", "closed_reason": "Opinion-based", "title": "Adding 3 methods or a generic one", "body": "<p>What is better, having 3 methods to get different properties:</p>\n\n<pre><code>func (s *Something) GetSections() {\n  var sections []Section\n  // code to get sections and append to sections\n}\n\nfunc (s *Something) GetValues() {\n  var values []Value\n  // code to get values and append to values\n}\n\nfunc (s *Something) GetKeys() {\n  var keys []Key\n  // code to get keys and append to keys\n}\n</code></pre>\n\n<p>Or one method that receives what should get:</p>\n\n<pre><code>func (s *Something) GetProperties(propertyName string) {\n  // code to get the desire property.\n}\n</code></pre>\n\n<p>I'm talking here about the best practice involving creating a method to access the internal data of a struct.</p>\n\n<p>I'm not sure if this is opinion based question, if it yes, I'm happy to delete it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1545414010, "post_id": 53888813, "comment_id": 94624351, "body": "Yes, wrap them into a single custom type (struct, slice, doesn&#39;t matter as long as it can reference the handlers you want to &quot;combine&quot;) and have that type implement the handler interface. And you should also be able to do this <code>http.ListenAndServe(&quot;:&quot;+port, handlers.LoggingHandler(os.Stdout, handlers.CORS()(r.router))</code>."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 1, "creation_date": 1545414112, "post_id": 53888813, "comment_id": 94624384, "body": "It only takes a single handler. So you need to wrap everything you want to do in a single handler function. Or alternatively you can use a router library like mux or chi that will make these things easier."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545414114, "post_id": 53888813, "comment_id": 94624387, "body": "Google &quot;http middleware&quot;."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1545415438, "post_id": 53888813, "comment_id": 94624856, "body": "justinas/alice does this. Middleware is also built into gorilla/mux now."}], "answers": [{"tags": [], "owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "is_accepted": true, "score": 1, "last_activity_date": 1545414728, "creation_date": 1545414728, "answer_id": 53888965, "question_id": 53888813, "link": "https://stackoverflow.com/questions/53888813/calling-multiple-handles-inside-listenandserve/53888965#53888965", "title": "Calling multiple handles inside ListenAndServe", "body": "<p><code>ListenAndServe</code> only takes a single <code>http.Handler</code>.</p>\n\n<p>The simplest way to do this without bringing in a library is to build a <code>http.Handler</code> that encompasses both:</p>\n\n<pre><code>func simpleChain(hs ...http.Handler) http.Handler {\n  return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request){\n    for _, h := range hs {\n      h.ServeHTTP(w, r)\n    }\n  })\n}\n</code></pre>\n\n<p>This has some problems though if any of the handlers want to do something to the <code>Request.Body</code> or write to the <code>ResponseWriter</code>. </p>\n\n<p>For example, you might want a handler to check if the request has permission and then prevent the other handlers from getting invoked. This implies that the <code>ResponseWriter</code>'s status code needs to be checked. I would say bring in a library at this point.</p>\n"}], "owner": {"reputation": 1197, "user_id": 7425957, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6uUDFuFxTk4/AAAAAAAAAAI/AAAAAAAAA1g/klwimxRbriA/photo.jpg?sz=128", "display_name": "Atishay Jain", "link": "https://stackoverflow.com/users/7425957/atishay-jain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 83, "favorite_count": 0, "accepted_answer_id": 53888965, "answer_count": 1, "score": 0, "last_activity_date": 1545420373, "creation_date": 1545413887, "last_edit_date": 1545420373, "question_id": 53888813, "link": "https://stackoverflow.com/questions/53888813/calling-multiple-handles-inside-listenandserve", "title": "Calling multiple handles inside ListenAndServe", "body": "<p>I want to use multiple handlers inside the <code>ListenAndServe</code> method from the <code>http</code> package. For example:</p>\n\n<pre><code>if err := http.ListenAndServe(\":\"+s.config.Port,\n    handlers.LoggingHandler(os.Stdout, s.router),\n    handlers.CORS()(r.router)\n); err != nil {\n</code></pre>\n\n<p><strong>Problem:</strong></p>\n\n<p>Everytime I'm getting the following error:</p>\n\n<blockquote>\n  <p>pkg/server/server.go:30:31: too many arguments in call to \n  http.ListenAndServe have (string, http.Handler, http.Handler) want\n  (string, http.Handler) pkg/server/server.go:30:113: undefined: r</p>\n</blockquote>\n\n<p><strong>Question:</strong></p>\n\n<p>Now it's not accepting more than 2 arguments, so is there any alternative of doing this?</p>\n"}, {"tags": ["mongodb", "docker", "go"], "comments": [{"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 2, "creation_date": 1545409333, "post_id": 53887738, "comment_id": 94622460, "body": "Can you post your docker-compose? If you are trying to run the service from docker as well you will need to connect to the mongo service name as in docker-compose and not to <code>localhost</code>"}, {"owner": {"reputation": 177, "user_id": 6613904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b4277bb8450e16bf6fc49a9cba40b9?s=128&d=identicon&r=PG&f=1", "display_name": "henleyhoudini", "link": "https://stackoverflow.com/users/6613904/henleyhoudini"}, "reply_to_user": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 1, "creation_date": 1545409535, "post_id": 53887738, "comment_id": 94622552, "body": "@oren added the docker-compose above. Thanks!"}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 1, "creation_date": 1545409613, "post_id": 53887738, "comment_id": 94622586, "body": "Is <code>jobservice</code> your go service?"}, {"owner": {"reputation": 177, "user_id": 6613904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b4277bb8450e16bf6fc49a9cba40b9?s=128&d=identicon&r=PG&f=1", "display_name": "henleyhoudini", "link": "https://stackoverflow.com/users/6613904/henleyhoudini"}, "reply_to_user": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 1, "creation_date": 1545409706, "post_id": 53887738, "comment_id": 94622632, "body": "Yes - using the image I built from the go code above that."}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 1, "creation_date": 1545409989, "post_id": 53887738, "comment_id": 94622757, "body": "So you need to connect with the service name for that mongodb container <code>datastore</code>, you can try my answer"}], "answers": [{"comments": [{"owner": {"reputation": 177, "user_id": 6613904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b4277bb8450e16bf6fc49a9cba40b9?s=128&d=identicon&r=PG&f=1", "display_name": "henleyhoudini", "link": "https://stackoverflow.com/users/6613904/henleyhoudini"}, "edited": false, "score": 1, "creation_date": 1545411041, "post_id": 53888071, "comment_id": 94623213, "body": "I modified my <code>client, err := mongo.Connect(&quot;mongodb:&#47;&#47;localhost:27017&quot;)</code> statement to be <code>client, err := mongo.Connect(&quot;mongodb:&#47;&#47;jobservice:27017&quot;)</code> but I&#39;m still getting the same timeout error."}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "reply_to_user": {"reputation": 177, "user_id": 6613904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b4277bb8450e16bf6fc49a9cba40b9?s=128&d=identicon&r=PG&f=1", "display_name": "henleyhoudini", "link": "https://stackoverflow.com/users/6613904/henleyhoudini"}, "edited": false, "score": 1, "creation_date": 1545411103, "post_id": 53888071, "comment_id": 94623245, "body": "@henleyhoudini  Not <code>jobservice</code>. use <code>datastore</code>, as this is the mongodb container service name"}, {"owner": {"reputation": 177, "user_id": 6613904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b4277bb8450e16bf6fc49a9cba40b9?s=128&d=identicon&r=PG&f=1", "display_name": "henleyhoudini", "link": "https://stackoverflow.com/users/6613904/henleyhoudini"}, "edited": false, "score": 1, "creation_date": 1545411250, "post_id": 53888071, "comment_id": 94623312, "body": "Just so I know I&#39;m understanding this correctly - I need to use the name of the Docker container I&#39;m using instead of the actual local host because the DB is stored in the localhost for the Docker Container and not technically my localhost?"}, {"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "reply_to_user": {"reputation": 177, "user_id": 6613904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b4277bb8450e16bf6fc49a9cba40b9?s=128&d=identicon&r=PG&f=1", "display_name": "henleyhoudini", "link": "https://stackoverflow.com/users/6613904/henleyhoudini"}, "edited": false, "score": 0, "creation_date": 1545412802, "post_id": 53888071, "comment_id": 94623869, "body": "@henleyhoudini Yep, you are basically correct. I edited my answer a bit to give some more details. Hope it make sense"}, {"owner": {"reputation": 884, "user_id": 10539792, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rUNhI.jpg?s=128&g=1", "display_name": "Ehsan sarshar", "link": "https://stackoverflow.com/users/10539792/ehsan-sarshar"}, "edited": false, "score": 0, "creation_date": 1603016314, "post_id": 53888071, "comment_id": 113897513, "body": "@oren in my case I have mongodb in docker but mongo.Connect is running outside a docker in my local computer. how can I solve this error"}], "tags": [], "owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "is_accepted": true, "score": 7, "last_activity_date": 1545412689, "last_edit_date": 1545412689, "creation_date": 1545409902, "answer_id": 53888071, "question_id": 53887738, "link": "https://stackoverflow.com/questions/53887738/server-selection-timeout-error-mongodb-go-driver-with-docker/53888071#53888071", "title": "&quot;Server Selection Timeout Error&quot; MongoDB Go Driver with Docker", "body": "<p>When you running the service and <code>mongodb</code> in docker you can't use  <code>localhost</code> since the service is in a different container than <code>mongodb</code>, and from docker point of view it's under a different ip address.</p>\n\n<p>You can connect with the service name you specify in docker-compose <code>datastore</code></p>\n\n<pre><code>mongo.Connect(\"mongodb://datastore:27017\")\n</code></pre>\n\n<p><strong>Edit:</strong></p>\n\n<p>from: <a href=\"https://docs.docker.com/compose/networking/\" rel=\"noreferrer\">https://docs.docker.com/compose/networking/</a></p>\n\n<blockquote>\n  <p>By default Compose sets up a single network for your app. Each\n  container for a service joins the default network and is both\n  reachable by other containers on that network, and discoverable by\n  them at a hostname identical to the container name</p>\n</blockquote>\n\n<p>Meaning that if you run multiple containers via compose, you can access one container from the other by the container name, </p>\n\n<p>Basically when <code>docker-compose</code> starts, it sets up the network, and each container in the compose joins the network under its container name. For a container's point if view, <code>localhost</code> is just the container itself, while he can search for other container's name and get back the container\u2019s IP address.</p>\n\n<p>Assuming that the docker is running on your localhost, you can set the name in <code>etc/hosts</code> file like this:</p>\n\n<pre><code>127.0.0.1 datastore\n</code></pre>\n\n<p>(if not just replace <code>127.0.0.1</code> with the docker ip)</p>\n\n<p>And in the app you will connect with <code>mongodb://datastore:27017</code></p>\n\n<p>So you will be able to run the service both in the docker and from outside, if you'll decide to run only the <code>db</code> in docker </p>\n\n<pre><code>docker-compose start datastore\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 6588, "user_id": 10524386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8a1950a1d7e1eccd4cff228c5420ea?s=128&d=identicon&r=PG", "display_name": "grapes", "link": "https://stackoverflow.com/users/10524386/grapes"}, "is_accepted": false, "score": 2, "last_activity_date": 1545409918, "creation_date": 1545409918, "answer_id": 53888075, "question_id": 53887738, "link": "https://stackoverflow.com/questions/53887738/server-selection-timeout-error-mongodb-go-driver-with-docker/53888075#53888075", "title": "&quot;Server Selection Timeout Error&quot; MongoDB Go Driver with Docker", "body": "<p>If you are connecting to one docker from another (like it is written in your <code>docker-compose</code> file, and using <code>bridge</code> network mode, you have to change your <code>localhost</code> to the hostname, like <code>datastore</code></p>\n\n<pre><code>client, err := mongo.Connect(\"mongodb://datastore:27017\")\n</code></pre>\n\n<p>When your <code>go</code> script uses <code>localhost</code>, it expects the database to located in the same docker</p>\n"}, {"tags": [], "owner": {"reputation": 154, "user_id": 8913763, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ICicn.jpg?s=128&g=1", "display_name": "VadimFilin", "link": "https://stackoverflow.com/users/8913763/vadimfilin"}, "is_accepted": false, "score": 0, "last_activity_date": 1555787607, "creation_date": 1555787607, "answer_id": 55776859, "question_id": 53887738, "link": "https://stackoverflow.com/questions/53887738/server-selection-timeout-error-mongodb-go-driver-with-docker/55776859#55776859", "title": "&quot;Server Selection Timeout Error&quot; MongoDB Go Driver with Docker", "body": "<p>Somehow i've fix this problem in a different way: by changing <code>ports</code> from <code>\"27018:27017\"</code> to <code>\"27017:27017\"</code>.\nIDK why this helps. Maybe if Mongo sees not default port it thinks there are cluster of Mongo's nodes.</p>\n"}, {"tags": [], "owner": {"reputation": 65, "user_id": 11056952, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4BZEP.png?s=128&g=1", "display_name": "Anurag S", "link": "https://stackoverflow.com/users/11056952/anurag-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1581245292, "creation_date": 1581245292, "answer_id": 60135807, "question_id": 53887738, "link": "https://stackoverflow.com/questions/53887738/server-selection-timeout-error-mongodb-go-driver-with-docker/60135807#60135807", "title": "&quot;Server Selection Timeout Error&quot; MongoDB Go Driver with Docker", "body": "<p>I think my answer might be unrelated but still, I was getting the same error and it was because my IP address was not listed in the IP whitelist tab in MongoDB atlas, so make sure you have your IP address there before trying to connect.</p>\n"}, {"tags": [], "owner": {"reputation": 45, "user_id": 7527302, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7bf8b9c28edb1c040929fdc392ffa63?s=128&d=identicon&r=PG&f=1", "display_name": "hyperloopfan", "link": "https://stackoverflow.com/users/7527302/hyperloopfan"}, "is_accepted": false, "score": 2, "last_activity_date": 1583210177, "creation_date": 1583210177, "answer_id": 60500128, "question_id": 53887738, "link": "https://stackoverflow.com/questions/53887738/server-selection-timeout-error-mongodb-go-driver-with-docker/60500128#60500128", "title": "&quot;Server Selection Timeout Error&quot; MongoDB Go Driver with Docker", "body": "<p>I had the same problem but found another way to address this issue. You can just pass network parameter while running docker image and this way docker points to correct localhost.</p>\n\n<p><code>docker run --network=\"host\" ....</code></p>\n\n<p><a href=\"https://stackoverflow.com/questions/24319662/from-inside-of-a-docker-container-how-do-i-connect-to-the-localhost-of-the-mach\">Source for this solution</a></p>\n"}], "owner": {"reputation": 177, "user_id": 6613904, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/20b4277bb8450e16bf6fc49a9cba40b9?s=128&d=identicon&r=PG&f=1", "display_name": "henleyhoudini", "link": "https://stackoverflow.com/users/6613904/henleyhoudini"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16349, "favorite_count": 0, "accepted_answer_id": 53888071, "answer_count": 5, "score": 8, "last_activity_date": 1583210177, "creation_date": 1545408247, "last_edit_date": 1545409503, "question_id": 53887738, "link": "https://stackoverflow.com/questions/53887738/server-selection-timeout-error-mongodb-go-driver-with-docker", "title": "&quot;Server Selection Timeout Error&quot; MongoDB Go Driver with Docker", "body": "<p>I'm working on a very basic (I thought) starter program in Go using MongoDB and Docker. Trying to get a handle on these before we start using them at work.\nI've got my MongoDB running in a docker container, just using my local host, using the official Docker image. This is running fine, I can connect to it through MongoDB Compass and modify the DB. </p>\n\n<p>My next task was to build a separate Docker container that is able to read and write to the DB. I'm using MongoDB-Go-Driver (<a href=\"https://godoc.org/github.com/mongodb/mongo-go-driver/mongo\" rel=\"noreferrer\">https://godoc.org/github.com/mongodb/mongo-go-driver/mongo</a>) for this as mgo is no longer kept up. </p>\n\n<p>This is my code, I'm just following the numerous tutorials online to make a simple connection and then ping the DB to ensure connectivity. </p>\n\n<pre><code>client, err := mongo.Connect(\"mongodb://localhost:27017\")\n\nif err != nil {\n    log.Fatal(\"error \", err)\n}\n\n// Check the connection\nerr = client.Ping(context.TODO(), nil)\n\nif err != nil {\n    log.Fatal(\"error2 \", err)\n}\n\nfmt.Println(\"Connected to MongoDB!\")\n</code></pre>\n\n<p>It always fails on doing any operation on the DB (Find, FindOne, Ping, etc.) with <code>error2 server selection timeout</code></p>\n\n<p>This is my docker-compose file I'm running. </p>\n\n<pre><code>version: \"3\"\n\nservices:\n  datastore:\n    image: mongo\n    ports: \n      - \"27017:27017\"\n    networks: \n      - maccaptionNet\n    volumes: \n      - .:/go/src/maccaption_microservice/dbdata\n  jobservice:\n    image: jobservicemaccaption:1.0\n    networks:\n      - maccaptionNet\n    depends_on:\n      - \"datastore\"\n\n\nnetworks: \n  maccaptionNet:\n    driver: bridge\n</code></pre>\n\n<p>I'm brand new to MongoDB and after hours of research haven't made any progress on this.\nI've read through <a href=\"https://docs.mongodb.com/manual/core/read-preference-mechanics/\" rel=\"noreferrer\">https://docs.mongodb.com/manual/core/read-preference-mechanics/</a>\n<a href=\"https://docs.mongodb.com/manual/replication/\" rel=\"noreferrer\">https://docs.mongodb.com/manual/replication/</a></p>\n\n<p>Can anyone point me in the right direction for this? I haven't been able to find a lot on this specific issue. </p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go", "go-templates", "consul-template"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 5, "creation_date": 1545406298, "post_id": 53887065, "comment_id": 94621184, "body": "You can <code>range</code> over a map to get <i>all</i> the keys and values, is that what you&#39;re looking for? There&#39;s no meaningful way to get a slice of the keys you can access by numeric index because slices are ordered and maps are not."}, {"owner": {"reputation": 1954, "user_id": 3678249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c6345749e7333cf9d29d7de58d421fe?s=128&d=identicon&r=PG", "display_name": "BartBiczBo\u017cy", "link": "https://stackoverflow.com/users/3678249/bartbiczbo%c5%bcy"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545406375, "post_id": 53887065, "comment_id": 94621211, "body": "@Adrian yes, sounds like what I need."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1545406593, "post_id": 53887065, "comment_id": 94621302, "body": "<code>range</code> is covered in the documentation under Actions: <a href=\"https://golang.org/pkg/text/template/#hdr-Actions\" rel=\"nofollow noreferrer\">golang.org/pkg/text/template/#hdr-Actions</a>"}, {"owner": {"reputation": 1954, "user_id": 3678249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c6345749e7333cf9d29d7de58d421fe?s=128&d=identicon&r=PG", "display_name": "BartBiczBo\u017cy", "link": "https://stackoverflow.com/users/3678249/bartbiczbo%c5%bcy"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545406773, "post_id": 53887065, "comment_id": 94621372, "body": "@Adrian Thanks, I can see it and it works indeed. Just don&#39;t want to put an answer when it is you who actually gave it."}], "answers": [{"tags": [], "owner": {"reputation": 1954, "user_id": 3678249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c6345749e7333cf9d29d7de58d421fe?s=128&d=identicon&r=PG", "display_name": "BartBiczBo\u017cy", "link": "https://stackoverflow.com/users/3678249/bartbiczbo%c5%bcy"}, "is_accepted": true, "score": 0, "last_activity_date": 1545413219, "creation_date": 1545413219, "answer_id": 53888705, "question_id": 53887065, "link": "https://stackoverflow.com/questions/53887065/how-to-get-key-from-map/53888705#53888705", "title": "How to get key from map", "body": "<p>As @Adrian commented:</p>\n\n<pre><code>{{ range $key, $val := . }}\nkey: {{ $key }}; value: {{ $val }}\n{{ end }}\n</code></pre>\n\n<p>But it was hard to figure it out just from <a href=\"https://golang.org/pkg/text/template/#hdr-Actions\" rel=\"nofollow noreferrer\">range documentation</a></p>\n"}], "owner": {"reputation": 1954, "user_id": 3678249, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1c6345749e7333cf9d29d7de58d421fe?s=128&d=identicon&r=PG", "display_name": "BartBiczBo\u017cy", "link": "https://stackoverflow.com/users/3678249/bartbiczbo%c5%bcy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "accepted_answer_id": 53888705, "answer_count": 1, "score": -4, "last_activity_date": 1545918889, "creation_date": 1545405222, "last_edit_date": 1545918889, "question_id": 53887065, "link": "https://stackoverflow.com/questions/53887065/how-to-get-key-from-map", "title": "How to get key from map", "body": "<p>I'm working on go template. Having some map in <code>.</code> I know how to get the value, as long as I know the key.</p>\n\n<pre><code>\"Map value: {{ printf \"%s\" .key1 }}\"\n</code></pre>\n\n<p>How to get key name from inside the template? I would expect maybe something like</p>\n\n<pre><code>\"Map key: {{ printf \"%s\" (keys .)[0] }}\"\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1545405008, "post_id": 53886960, "comment_id": 94620571, "body": "If <code>3.1415926435897683</code> is the output, what more are you looking for?"}, {"owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1545405309, "post_id": 53886960, "comment_id": 94620726, "body": "More digits of PI, like, 3,14159 26535 89793 23846 26433 83279 50288 41971 69399 37510 58209 74944 59230 78164 06286 20899"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1545405439, "post_id": 53886960, "comment_id": 94620801, "body": "You&#39;re only using a <code>float64</code>, so you only have 53 bits precision with an 11 bit exponent."}, {"owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1545405541, "post_id": 53886960, "comment_id": 94620845, "body": "If i use a big.Float from the math/big package can i get more digits?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 4, "creation_date": 1545405666, "post_id": 53886960, "comment_id": 94620902, "body": "You want to print all of pi?  You know pi has an infinite number of digits, right?"}, {"owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "edited": false, "score": 0, "creation_date": 1545405748, "post_id": 53886960, "comment_id": 94620933, "body": "I know, i mean more digits, like 100 digits of pi"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 7, "last_activity_date": 1545411956, "last_edit_date": 1545411956, "creation_date": 1545404964, "answer_id": 53887007, "question_id": 53886960, "link": "https://stackoverflow.com/questions/53886960/fmt-println-doesnt-print-the-whole-float-number/53887007#53887007", "title": "fmt.Println doesn&#39;t print the whole float number", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/fmt/#Sprint\" rel=\"nofollow noreferrer\">func Sprint</a></p>\n\n<pre><code>func Sprint(a ...interface{}) string\n</code></pre>\n  \n  <p>Sprint formats using the default formats for its operands and returns\n  the resulting string. Spaces are added between operands when neither\n  is a string.</p>\n</blockquote>\n\n<hr>\n\n<p><code>fmt.Sprint</code> returns a <code>string</code>. Don't throw it away; print it.</p>\n\n<p>For example,</p>\n\n<pre><code>func main() {\n    s := fmt.Sprint(gregorypi())\n    fmt.Println(s)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/zOVtJc5HfXT\" rel=\"nofollow noreferrer\">https://play.golang.org/p/zOVtJc5HfXT</a></p>\n\n<p>Output:</p>\n\n<pre><code>3.1415926435897683\n</code></pre>\n\n<hr>\n\n<p>If you want a more precise result than IEEE 754 64-bit floating-point, use the Go <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\"><code>math/big</code></a> package.</p>\n\n<hr>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"math/big\"\n)\n\nfunc gregorypi(iter int, prec uint) *big.Float {\n    one := big.NewFloat(1)\n    two := big.NewFloat(2)\n    four := big.NewFloat(4)\n    numerator := big.NewFloat(1).SetPrec(prec)\n    divisor := big.NewFloat(3).SetPrec(prec)\n    result := new(big.Float).SetPrec(prec)\n\n    for i := 0; i &lt;= iter; i++ {\n        if i%2 == 0 {\n            result.Add(result, new(big.Float).Quo(numerator, divisor))\n        } else {\n            result.Sub(result, new(big.Float).Quo(numerator, divisor))\n        }\n        divisor.Add(divisor, two)\n    }\n\n    return new(big.Float).Mul(four, (new(big.Float).Sub(one, result)))\n\n}\n\nfunc main() {\n    pi := gregorypi(1000000, 4096)\n\n    s := fmt.Sprint(pi)\n    for i, j := 0, 0; i &lt; len(s); i = j {\n        j = i + 60\n        if j &gt; len(s) {\n            j = len(s)\n        }\n        fmt.Println(s[i:j])\n    }\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>3.1415916535917932347126498832691903993221476025342620143148\n652250543253683419302770934570540444696092784515646197918416\n151531004207388567190381995115109764938931650751911723670828\n705935671760975424757204401786734958287682330276123443546400\n855990841037108771486255447137253791363986086026524209725177\n041621398938122502069099548344075841960714856836014332632487\n249750055949826053894250927777836988620276187954914335474236\n918693730264540456485214156731536507281567237095178205850787\n841887779856892311307656085287982909183503886914799719930651\n362811646060939082163336282527001630768619465916054216662233\n647867947277285894357821722722774052560440050583160360321106\n944441543917458948854721791262992799982426130041196627951982\n504267630916391384654303083557011574782570253034162966525670\n594481466474403221843818413155653700689258246423537757630787\n951957260253561222183715232613769610553278998905210089847178\n951692922815021787390361813556619177840043555176857090268624\n902791212304201317960964869615176784400855500998688041903616\n187746299057333789390884081442894661717258714989758581139759\n403617872623424695182488545758897457727485849932980050101014\n208290473579625783313281627594640164541223264510142763045401\n708614153731722941036904397534247\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 10808195, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YTwan.jpg?s=128&g=1", "display_name": "Oliver", "link": "https://stackoverflow.com/users/10808195/oliver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 94, "favorite_count": 0, "accepted_answer_id": 53887007, "answer_count": 1, "score": -1, "last_activity_date": 1545411956, "creation_date": 1545404759, "question_id": 53886960, "link": "https://stackoverflow.com/questions/53886960/fmt-println-doesnt-print-the-whole-float-number", "title": "fmt.Println doesn&#39;t print the whole float number", "body": "<p>i'm trying to make a program that calculates the value of pi and print it on the terminal, but only part of it shows on the screen</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc gregorypi() float64 {\n    numerator := 1.0\n    divisor := 3.0\n    var result float64\n\n    for i := 0; i &lt;= 100000000; i++ {\n            if i%2 == 0 {\n                    result += numerator / divisor\n                    divisor += 2\n            } else {\n                    result -= numerator / divisor\n                    divisor += 2\n\n            }\n\n    }\n\n    return (4 * (1 - result))\n\n}\n\nfunc main() {\n\n    fmt.Sprint(gregorypi())\n\n}\n</code></pre>\n\n<p>the output is: 3.1415926435897683</p>\n\n<p>How do i make so the entire value appears?</p>\n\n<p>If it helps answering the question: the formula that i'm using is the Gregory-Leibniz one</p>\n"}, {"tags": ["for-loop", "go", "struct"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1545403084, "post_id": 53886458, "comment_id": 94619607, "body": "you&#39;re not taking into account the extra element, because <code>len(headerLabels)</code> is past the last index of <code>valueFromCalculation</code>. You&#39;re for loop is also incorrect, you can&#39;t use <code>&lt;=</code> or you&#39;re going to get the length as the last index."}, {"owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1545403323, "post_id": 53886458, "comment_id": 94619729, "body": "But would saying that if the index is at the last place, set the valueFromCalculation to &quot;&quot; not solve this? Else use the index?"}, {"owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "edited": false, "score": 1, "creation_date": 1545403590, "post_id": 53886458, "comment_id": 94619862, "body": "You\u2019re not saying it\u2019s at the last place, you\u2019re saying it\u2019s one past the last place. The last index is len - 1,  not len."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1545403595, "post_id": 53886458, "comment_id": 94619863, "body": "@MassiveOwl, the last index is <code>len-1</code>, which is why a basic for loop is always written as <code>for i := 0; i &lt; len; i++</code>"}, {"owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "edited": false, "score": 0, "creation_date": 1545404323, "post_id": 53886458, "comment_id": 94620223, "body": "Thanks for your help, this was a stupid and fundermental error on my part"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1545404711, "post_id": 53886458, "comment_id": 94620432, "body": "&quot;There are 2 hard problems in computer science: cache invalidation, naming things, and off-by-1 errors.&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "reply_to_user": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "edited": false, "score": 0, "creation_date": 1545404345, "post_id": 53886774, "comment_id": 94620240, "body": "Those are the hardest mistakes to spot in one\u2019s own code."}], "tags": [], "owner": {"reputation": 740, "user_id": 2471524, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/345a080a421b053d124139a0bce7d62e?s=128&d=identicon&r=PG", "display_name": "blobdon", "link": "https://stackoverflow.com/users/2471524/blobdon"}, "is_accepted": true, "score": 2, "last_activity_date": 1545404304, "last_edit_date": 1545404304, "creation_date": 1545403890, "answer_id": 53886774, "question_id": 53886458, "link": "https://stackoverflow.com/questions/53886458/index-out-of-range-when-creating-new-combined-slice-of-structs-from-3-individual/53886774#53886774", "title": "Index out of range when creating new combined slice of structs from 3 individual slices (one slice for each struct property)", "body": "<p>It appears you are looping one index too long on headerLabels.</p>\n\n<p>Try changing\n<code>i &lt;= len(headerLabels)</code> to <code>i &lt; len(headerLabels)</code></p>\n\n<p>And</p>\n\n<p><code>if i == len(headerLabels)</code> to <code>if i == len(headerLabels) - 1</code></p>\n"}], "owner": {"reputation": 894, "user_id": 6129842, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/cbe4e0267ebd8487991053966942c1b9?s=128&d=identicon&r=PG&f=1", "display_name": "SuperSecretAndHiddenFromWork", "link": "https://stackoverflow.com/users/6129842/supersecretandhiddenfromwork"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27, "favorite_count": 0, "accepted_answer_id": 53886774, "answer_count": 1, "score": -1, "last_activity_date": 1545404304, "creation_date": 1545402656, "question_id": 53886458, "link": "https://stackoverflow.com/questions/53886458/index-out-of-range-when-creating-new-combined-slice-of-structs-from-3-individual", "title": "Index out of range when creating new combined slice of structs from 3 individual slices (one slice for each struct property)", "body": "<p>I have a struct like this:</p>\n\n<pre><code>type Headers struct {\n    header            string\n    valueFromCalculation    string\n    value            float64\n}\n</code></pre>\n\n<p>I need have three slices with the values for each of these:</p>\n\n<pre><code>var headerLabels []string\nvar values []float64\nvar valueFromCalculation []string\n\n\n[January February March April May June July August September TOTAL]\n[175 167 148 142 125 114 130 120 30 1151]\n[15% 15% 13% 12% 11% 10% 11% 10% 3%]\n</code></pre>\n\n<p>Now I want to create a new slice of Headers by combining these. There is one issue, that I believe i'm solving - <strong>the length of the valueFromCalcuation is 1 less than the rest of the slices</strong></p>\n\n<p>To create the new slice I want to do this:</p>\n\n<pre><code>sliceOfHeaders := []*Headers{}\n\nfor i := 0; i &lt;= len(headerLabels); i++ {\n\nheaderEntry := new(Headers)\n\nheaderEntry.header = headerLabels[i]\nheaderEntry.value = values[i]\n\nif i == len(headerLabels) {\n    headerEntry.valueFromCalculation = \"\"\n} else {\n    headerEntry.valueFromCalculation = valueFromCalculation[i]\n}\n\nsliceOfHeaders = append(sliceOfHeaders, headerEntry)\n}\n</code></pre>\n\n<p><strong>It is throwing the below error</strong>:</p>\n\n<p>\"panic: runtime error: index out of range\"</p>\n\n<p>How can this be?</p>\n\n<p>I'm accounting for the issue of the index with the valueFromCalculation length being one less than the other struct properties</p>\n\n<p>Here you can see output from before I want to start my loop:</p>\n\n<pre><code>header --&gt; [January February March April May June July August September TOTAL]\nvalue --&gt; [175 167 148 142 125 114 130 120 30 1151]\nvalueFromCalculation --&gt; [15% 15% 13% 12% 11% 10% 11% 10% 3%]\nheader length --&gt; 10\nvalue length --&gt; 10\nvalueFromCalculation length --&gt; 9\n</code></pre>\n\n<p><strong>Please can someone help me here? I can't see what i'm doing wrong</strong></p>\n\n<p>I'm accounting for the length of the 3rd property being 1 less than the rest</p>\n"}, {"tags": ["go", "http-post"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1545402359, "post_id": 53886345, "comment_id": 94619244, "body": "Errors happen. Is it possible that clients just got disconnected or cancelled a request?"}, {"owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1545629706, "post_id": 53886345, "comment_id": 94663466, "body": "Thanks @JimB. Possibly it could be the reason i just wanted to understand the reason behind it."}], "owner": {"reputation": 4133, "user_id": 2135526, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/75e764233b7968d0f9fb8e04f31230cf?s=128&d=identicon&r=PG", "display_name": "Naresh", "link": "https://stackoverflow.com/users/2135526/naresh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 513, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1545402134, "creation_date": 1545402134, "question_id": 53886345, "link": "https://stackoverflow.com/questions/53886345/troubleshoot-eof-in-post-request-in-go-lang", "title": "Troubleshoot EOF in POST request in go lang", "body": "<p>I have method written in GoLang which is responsible to handle the POST requests and it reads the request body using the following way :</p>\n\n<pre><code>body, err := ioutil.ReadAll(r.Body)\n</code></pre>\n\n<p>The code is working properly on Production, but in few cases i am getting <code>unexpected EOF</code>. I tried logging the request body using the <a href=\"https://golang.org/pkg/net/http/httputil/#DumpRequest\" rel=\"nofollow noreferrer\">DumpRequest</a> method</p>\n\n<p>But it is again giving me empty response. So, how do i troubleshoot this issue.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545400533, "post_id": 53885950, "comment_id": 94618373, "body": "<a href=\"https://golang.org/pkg/mime/#BEncoding\" rel=\"nofollow noreferrer\">golang.org/pkg/mime/#BEncoding</a>"}, {"owner": {"reputation": 15357, "user_id": 281014, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c001df5d31b9aa5ebea6d09351876556?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas", "link": "https://stackoverflow.com/users/281014/tomas"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545402413, "post_id": 53885950, "comment_id": 94619273, "body": "@Peter that link explain how to parse content disposition but I am looking how to build it."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545404323, "post_id": 53885950, "comment_id": 94620224, "body": "That package does both encoding and deciding. See the example for <a href=\"https://golang.org/pkg/mime/#WordEncoder.Encode\" rel=\"nofollow noreferrer\">WordEncoder.Encode</a>."}], "owner": {"reputation": 15357, "user_id": 281014, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c001df5d31b9aa5ebea6d09351876556?s=128&d=identicon&r=PG&f=1", "display_name": "Tomas", "link": "https://stackoverflow.com/users/281014/tomas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545400389, "creation_date": 1545400389, "question_id": 53885950, "link": "https://stackoverflow.com/questions/53885950/contentdisposition-class-to-build-file-content-disposition", "title": "ContentDisposition class to build file content disposition", "body": "<p>The <code>C#</code> has <code>ContentDispositionHeaderValue</code> class to build non unicode and unicode file content dispositions. Does Go has something similar?</p>\n\n<p>This is example from c#</p>\n\n<pre><code>void Main()\n{\n    var contentDisposition = new ContentDispositionHeaderValue(\"attachment\");\n    contentDisposition.FileName = \"\u4e0e\u81ea.pdf\";\n    contentDisposition.FileNameStar = \"\u4e0e\u81ea.pdf\";     \n    contentDisposition.ToString().Dump();\n}\n</code></pre>\n\n<p>and the result is </p>\n\n<pre><code>attachment; filename=\"=?utf-8?B?5LiO6IeqLnBkZg==?=\"; filename*=utf-8''%E4%B8%8E%E8%87%AA.pdf\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mongo-go"], "comments": [{"owner": {"reputation": 2812, "user_id": 3738542, "user_type": "registered", "profile_image": "https://graph.facebook.com/100002024985258/picture?type=large", "display_name": "oren", "link": "https://stackoverflow.com/users/3738542/oren"}, "edited": false, "score": 0, "creation_date": 1545430112, "post_id": 53885925, "comment_id": 94629446, "body": "Hi. Did you already try something, share some code. Do you have a specific issue?"}], "answers": [{"tags": [], "owner": {"reputation": 1374, "user_id": 10849350, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8t7Pj.png?s=128&g=1", "display_name": "simagix", "link": "https://stackoverflow.com/users/10849350/simagix"}, "is_accepted": true, "score": 2, "last_activity_date": 1546638765, "creation_date": 1546638765, "answer_id": 54046606, "question_id": 53885925, "link": "https://stackoverflow.com/questions/53885925/how-to-run-mongo-command-with-mongo-go-driver/54046606#54046606", "title": "How to run mongo command with mongo-go-driver?", "body": "<p><code>RunCommand</code> is to execute a mongo command.  What you intend to do are to find all documents of a collection, make changes, and then replace them.  You need <code>Find()</code>, cursor, and <code>ReplaceOne()</code>.  Here is a similar code snippet.</p>\n\n<pre><code>if cur, err = collection.Find(ctx, bson.M{\"hometown\": bson.M{\"$exists\": 1}}); err != nil {\n    t.Fatal(err)\n}\nvar doc bson.M\nfor cur.Next(ctx) {\n    cur.Decode(&amp;doc)\n    doc[\"updated\"] = time.Now()\n    if result, err = collection.ReplaceOne(ctx, bson.M{\"_id\": doc[\"_id\"]}, doc); err != nil {\n        t.Fatal(err)\n    }\n    if result.MatchedCount != 1 || result.ModifiedCount != 1 {\n        t.Fatal(\"replace failed, expected 1 but got\", result.MatchedCount)\n    }\n}\n</code></pre>\n\n<p>I have a full example <a href=\"https://github.com/simagix/mongo-go-examples/blob/master/examples/replace_test.go\" rel=\"nofollow noreferrer\">TestReplaceLoop()</a></p>\n"}], "owner": {"reputation": 404, "user_id": 8462259, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c2476bb86b12efeceac2ccbccc0581fd?s=128&d=identicon&r=PG&f=1", "display_name": "G.D", "link": "https://stackoverflow.com/users/8462259/g-d"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1265, "favorite_count": 0, "accepted_answer_id": 54046606, "answer_count": 1, "score": 2, "last_activity_date": 1546638765, "creation_date": 1545400290, "question_id": 53885925, "link": "https://stackoverflow.com/questions/53885925/how-to-run-mongo-command-with-mongo-go-driver", "title": "How to run mongo command with mongo-go-driver?", "body": "<p>Hi there :) I'm working on a golang app linked to mongo DB (I use the official driver: <code>mongo-go</code>) and here's my problem,I want to execute this function </p>\n\n<pre><code>db.rmTickets.find().forEach(function(doc) {\n    doc.created=new Date(doc.created)\n    doc.updated=new Date(doc.updated)\n    doc.deadline=new Date(doc.deadline)\n    doc.dateEstimationDelivery=new Date(doc.dateEstimationDelivery)\n    doc.dateTransmitDemand=new Date(doc.dateTransmitDemand)\n    doc.dateTransmitQuotation=new Date(doc.dateTransmitQuotation)\n    doc.dateValidationQuotation=new Date(doc.dateValidationQuotation)\n    doc.dateDeliveryCS=new Date(doc.dateDeliveryCS)\n    db.rmTickets.save(doc)\n})\n</code></pre>\n\n<p>I see on godoc that a <code>Database.RunCommand()</code> exists but I'm not sure about how to use it.\nIf someone can help :)\nThanks </p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1545402624, "post_id": 53885511, "comment_id": 94619385, "body": "Your <code>GetMessages</code> code looks fine to me. Where and how many times are you executing the connection code?"}, {"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545403297, "post_id": 53885511, "comment_id": 94619712, "body": "I am calling connection only once from another function. <code>db</code> is global variable of type <code>*sql.DB</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1545403308, "post_id": 53885511, "comment_id": 94619718, "body": "... although not related to the issue, the <code>WHERE id=1</code> suggests that you&#39;re selecting a single row and if that&#39;s the case i would recommend you use <code>db.QueryRow</code> instead of <code>db.Query</code>. (<a href=\"https://play.golang.com/p/pMsuG2alB1v\" rel=\"nofollow noreferrer\">play.golang.com/p/pMsuG2alB1v</a>)"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1545403921, "post_id": 53885511, "comment_id": 94620048, "body": "Check what the <code>max_connection</code> setting of your postgres server is. (<a href=\"https://stackoverflow.com/a/8288860/965900\">click here if you don&#39;t know how</a>) Also check the number of already existing connections by using <code>SELECT COUNT(*) from pg_stat_activity;</code> and/or try inspecting the connections with <code>SELECT * FROM pg_stat_activity;</code> during the execution of your go app."}, {"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1545405189, "post_id": 53885511, "comment_id": 94620660, "body": "Tried <code>db.QueryRow</code> but no luck. Will try <code>SELECT * FROM pg_stat_activity;</code> and let you know the output"}, {"owner": {"reputation": 9005, "user_id": 675637, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/8X97W.jpg?s=128&g=1", "display_name": "poy", "link": "https://stackoverflow.com/users/675637/poy"}, "edited": false, "score": 0, "creation_date": 1545409562, "post_id": 53885511, "comment_id": 94622559, "body": "How are you deploying this? Is it possible that there are MANY instances of your code running?"}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 1, "creation_date": 1545413382, "post_id": 53885511, "comment_id": 94624123, "body": "I wonder what the full function that makes the connection looks like. Because you have a deferred connection close in it, so if that function returned your connection would be closed, but if it does not return, I wonder if it might be opening more and more connections in a loop somewhere"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1545430684, "post_id": 53885511, "comment_id": 94629590, "body": "Are you calling <code>GetMessages</code> concurrently?"}, {"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "reply_to_user": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1545458265, "post_id": 53885511, "comment_id": 94633169, "body": "@MadWombat Please check the updated code. I am deferring the <code>db.Close</code> in <code>main</code>."}, {"owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1545458387, "post_id": 53885511, "comment_id": 94633186, "body": "@KavehShahbazian, No, I am not calling <code>GetMessages</code> concurrently"}], "owner": {"reputation": 834, "user_id": 4596814, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Q7evG.jpg?s=128&g=1", "display_name": "Bhavana", "link": "https://stackoverflow.com/users/4596814/bhavana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 7672, "favorite_count": 0, "answer_count": 0, "score": 9, "last_activity_date": 1545895569, "creation_date": 1545398490, "last_edit_date": 1545895569, "question_id": 53885511, "link": "https://stackoverflow.com/questions/53885511/pq-sorry-too-many-clients-already", "title": "pq: sorry, too many clients already", "body": "<p>I am getting <code>pq: sorry, too many clients already</code> error when I am calling the <code>GetMessages()</code> multiple times. </p>\n\n<p>Please find the updated code:</p>\n\n<p><code>main()</code> code</p>\n\n<pre><code>func main() {\n  dbConn, err := InitDB()\n  if err != nil {\n    Log.Error(\"Connection Error: \", err.Error())\n    return\n  }\n  defer dbConn.Close()\n  go run()\n  var input string\n  fmt.Scanln(&amp;input)\n}\n</code></pre>\n\n<p>Database connection code is:</p>\n\n<pre><code>func InitDB()(*sql.DB, error) {\n  connectionString := fmt.Sprintf(\"user=%v password='%v' dbname=%v sslmode=disable\", USER, PASSWORD, DATABASE)\n  db, err = sql.Open(DRIVER, connectionString)\n  return db, err\n}\n</code></pre>\n\n<p><code>run</code> goroutine:</p>\n\n<pre><code>func run() {\n  for {\n    messages, err := GetMessages()\n    if err != nil {\n      Log.Error(\"Connection Error: \", err.Error())\n      return\n    }\n    log.Info(messages)\n  }\n}\n</code></pre>\n\n<p><code>GetMessages()</code> function code: </p>\n\n<pre><code>func GetMessages() (messages []string, err error) {\n    rows, err := db.Query(`SELECT message1, message2, message3, message4, message5,\n            message6, message7, message8, message9, message10, message11, message12, message13, \n            message14, message15, message16, message17, message18, message19, message20, message21,\n            message22, message23, message24, message25, message26, message27, message28, message29,\n            message30, message31, message32, message33, message34, message35, message36, message37,\n            message38, message39, message40, message41, message42, message43, message44, message45,\n            message46, message47, message48 FROM table1 WHERE id=1`)\n\n    if err != nil {\n        Log.Error(\"Query error\", err)\n        return messages, err\n    }\n\n    var pointers []interface{}\n    defer rows.Close()\n\n    for rows.Next() {\n        pointers = make([]interface{}, 48)\n        messages = make([]string, 48)\n        for i, _ := range pointers {\n            pointers[i] = &amp;messages[i]\n        }\n        err = rows.Scan(pointers...)\n        if err != nil {\n            Log.Error(\"Failed to scan row\", err)\n            return messages, err\n        }\n    }\n\n    return messages, nil\n}\n</code></pre>\n\n<p>I checked <a href=\"https://stackoverflow.com/questions/47706147/how-to-reuse-a-single-postgres-db-connection-for-row-inserts-in-go/47711577#47711577\">this</a> answer and I have used <code>scan</code> but still it isn't working</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Issue was in another function. I was using <code>db.Query</code> without closing the returned <code>rows</code> object and was repeatedly calling that function. I've updated my code; used <code>db.Exec</code> instead of <code>db.Query</code> and it's working now. Thank you so much <a href=\"https://stackoverflow.com/users/965900/mkopriva\">@mkopriva</a> for <a href=\"https://stackoverflow.com/a/50666083/4596814\">this</a> answer. :)</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 5287, "user_id": 1813169, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/wTAkF.jpg?s=128&g=1", "display_name": "MTCoster", "link": "https://stackoverflow.com/users/1813169/mtcoster"}, "edited": false, "score": 3, "creation_date": 1545397956, "post_id": 53885361, "comment_id": 94617155, "body": "You could write your own recursive function so you only have to <i>write</i> one loop, but at the end of the day you still have to iterate over both levels of the tree, which means two loops."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545399501, "post_id": 53885361, "comment_id": 94617898, "body": "go-funk doesn&#39;t look unmaintained to me. There were PRs merged about 8 weeks ago. Development did quiet down, but it looks more like the package is simply done, not abandoned. It has no reason to change unless Go changes."}, {"owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545401564, "post_id": 53885361, "comment_id": 94618885, "body": "@Peter yes, but still, is not highly adopted by other packages, which means is not accepted by the community - right?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545404510, "post_id": 53885361, "comment_id": 94620323, "body": "It just means that not everyone finds it useful (I also prefer writing two loops over adding a dependency). If it&#39;s useful to you I don&#39;t see anything that speaks against it per se."}], "owner": {"reputation": 153, "user_id": 10542686, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-A-EjroLSsEo/AAAAAAAAAAI/AAAAAAAAAAA/ABtNlbAhns3lDS_jtO57Lpdlfk1kFTjhZA/mo/photo.jpg?sz=128", "display_name": "Evanusso", "link": "https://stackoverflow.com/users/10542686/evanusso"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 58, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1545398062, "creation_date": 1545397783, "last_edit_date": 1545398062, "question_id": 53885361, "link": "https://stackoverflow.com/questions/53885361/easy-way-to-get-data-inside-nested-struct", "title": "Easy way to get data inside nested struct", "body": "<p>I have a struct that looks like this:</p>\n\n<pre><code>&amp;main.INI{\n  Properties: []*main.Property{\n    &amp;main.Property{\n      Key: \"a\",\n      Value: &amp;main.Value{\n        String: &amp;\"a\",\n      },\n    },\n    &amp;main.Property{\n      Key: \"b\",\n      Value: &amp;main.Value{\n        Number: &amp;123,\n      },\n    },\n  },\n  Sections: []*main.Section{\n    &amp;main.Section{\n      Identifier: \"numbers\",\n      Properties: []*main.Property{\n        &amp;main.Property{\n          Key: \"a\",\n          Value: &amp;main.Value{\n            Number: &amp;10.3,\n          },\n        },\n        &amp;main.Property{\n          Key: \"b\",\n          Value: &amp;main.Value{\n            Number: &amp;20,\n          },\n        },\n      },\n    },\n    &amp;main.Section{\n      Identifier: \"strings\",\n      Properties: []*main.Property{\n        &amp;main.Property{\n          Key: \"a\",\n          Value: &amp;main.Value{\n            String: &amp;\"\\\"quoted\\\"\",\n          },\n        },\n        &amp;main.Property{\n          Key: \"b\",\n          Value: &amp;main.Value{\n            String: &amp;\"b\",\n          },\n        },\n      },\n    },\n  },\n}\n</code></pre>\n\n<p>Which is the AST of the following source code:</p>\n\n<pre><code>a = \"a\"\nb = 123\n\n# A comment\n[numbers]\na = 10.3\nb = 20\n\n; Another comment\n[strings]\na = \"\\\"quoted\\\"\"\n</code></pre>\n\n<p>And I would like to know if would be possible to get all keys inside <code>sections -&gt; properties -&gt; key</code></p>\n\n<p>Without having to create 2 loops:</p>\n\n<pre><code>var keys []string\nfor _, section := range ini.Sections {\n    for _, property := range section.Properties {\n        keys = append(keys, property.Key)\n    }\n}\n</code></pre>\n\n<p>I'm also working in another program that generates an AST that requires 3 nested loops to get a specific property. Is there a better way to do it? A package or something?</p>\n\n<p>I found <code>go-funk</code>, that provides a <code>.Get</code> method:</p>\n\n<pre><code>funk.Get(ini, \"Sections.Properties.Key\").([]string)\n</code></pre>\n\n<p>But it's not maintained.</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-sdk", "aws-iam", "aws-sdk-go"], "answers": [{"comments": [{"owner": {"reputation": 161, "user_id": 6621961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a18e9951bc4b8029ad74b924e61ea0?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Soni", "link": "https://stackoverflow.com/users/6621961/abhishek-soni"}, "edited": false, "score": 0, "creation_date": 1546939031, "post_id": 54063591, "comment_id": 95009526, "body": "It does not validate the json schema. For example: ` { &quot;Effect&quot;:&quot;Allow&quot;, &quot;Action&quot;:&quot;invalid:invalid&quot;, &quot;Resource&quot;:&quot;some valid ARN of resource&quot; }` is a valid policy as per simulator API. Custome simulator only tells what principal can perform what sort of action of what resource.  Custom simulator helps very less when it comes to validating the <code>Condition</code> element of policy."}], "tags": [], "owner": {"reputation": 174, "user_id": 10380523, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-DTUBSoeTIu4/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaObsDYrgcFddmnhrAovBFBmedfcyg/mo/photo.jpg?sz=128", "display_name": "Ian Jenkins", "link": "https://stackoverflow.com/users/10380523/ian-jenkins"}, "is_accepted": false, "score": 1, "last_activity_date": 1546891199, "last_edit_date": 1546891199, "creation_date": 1546792216, "answer_id": 54063591, "question_id": 53884922, "link": "https://stackoverflow.com/questions/53884922/aws-iam-policy-validation-through-dry-run-api-calls/54063591#54063591", "title": "AWS IAM Policy validation through dry-run API calls", "body": "<p>The AWS API exposes a policy simulator endpoint. You should will functions that make it easy to use the policy simulator at <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/iam/\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/iam/</a> and specifically <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/iam/#IAM.SimulateCustomPolicy\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/iam/#IAM.SimulateCustomPolicy</a>. </p>\n\n<p>The policy simulator will allow you to validate the json of your policy, and verify that your intent is expressed in the outcome of the permissions you grant in the policy. You can supply context keys such as <em>aws:SourceIp, aws:RequestedRegion</em> etc. </p>\n"}, {"tags": [], "owner": {"reputation": 4981, "user_id": 2056112, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/aXvru.jpg?s=128&g=1", "display_name": "Aram", "link": "https://stackoverflow.com/users/2056112/aram"}, "is_accepted": false, "score": 0, "last_activity_date": 1600464765, "creation_date": 1600464765, "answer_id": 63963089, "question_id": 53884922, "link": "https://stackoverflow.com/questions/53884922/aws-iam-policy-validation-through-dry-run-api-calls/63963089#63963089", "title": "AWS IAM Policy validation through dry-run API calls", "body": "<p>You can use JSON Schema to do some validations.\nIf you look online you can find some sample IAM Json Schemas on github.\nhere is an example of one:</p>\n<p><a href=\"https://gist.github.com/jstewmon/ee5d4b7ec0d8d60cbc303cb515272f8a\" rel=\"nofollow noreferrer\">https://gist.github.com/jstewmon/ee5d4b7ec0d8d60cbc303cb515272f8a</a></p>\n<p>And I guess using Go, you can use something like the following to validate the JSON against this Json Schema:</p>\n<p><a href=\"https://github.com/xeipuuv/gojsonschema\" rel=\"nofollow noreferrer\">https://github.com/xeipuuv/gojsonschema</a></p>\n<p>The problem using this might be, if IAM changes their stuff, you have to keep updating the schema on your side.</p>\n"}], "owner": {"reputation": 161, "user_id": 6621961, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/22a18e9951bc4b8029ad74b924e61ea0?s=128&d=identicon&r=PG&f=1", "display_name": "Abhishek Soni", "link": "https://stackoverflow.com/users/6621961/abhishek-soni"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1600464765, "creation_date": 1545395768, "last_edit_date": 1545816644, "question_id": 53884922, "link": "https://stackoverflow.com/questions/53884922/aws-iam-policy-validation-through-dry-run-api-calls", "title": "AWS IAM Policy validation through dry-run API calls", "body": "<p>I am working on a tool which takes IAM policy as JSON and creates the policy on aws. I am using aws-sdk-go for building the tool. I am looking for a way through which I can validate the policy before executing it on aws. Does AWS provide some sort of API to dry-run the policy creation or something like that? </p>\n\n<p>The things I have tried:\nI am validating the policy field by field.</p>\n\n<ul>\n<li>Effect field must be <code>Allow</code> or <code>Deny</code></li>\n<li>For Action field, I added a dictionary in my tool which map service to the valid actions. Problem with this approach is it requires a lot of maintenance. AWS keep releasing new services and action and I have to update the dictionary.</li>\n<li>For a resource, it should be valid ARN. </li>\n</ul>\n\n<p>A couple of other validations are added but its really tough to add all validation checks manually. I believe, aws must be providing some sort of dry-run facility for a policy.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1545396593, "post_id": 53884918, "comment_id": 94616538, "body": "There are plenty of counter examples in the standard library: <a href=\"https://golang.org/pkg/encoding/json/#Number\" rel=\"nofollow noreferrer\">json.Number</a> is a string type that implements fmt.Stringer, <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\">json.RawMessage</a> is a slice type that implements json.Marshaler, <a href=\"https://golang.org/pkg/net/http/#HandlerFunc\" rel=\"nofollow noreferrer\">http.HandlerFunc</a> is a function type that implements http.Handler. The list goes on and on."}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 7890683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BEgoT.png?s=128&g=1", "display_name": "snowball", "link": "https://stackoverflow.com/users/7890683/snowball"}, "edited": false, "score": 0, "creation_date": 1545396642, "post_id": 53884997, "comment_id": 94616573, "body": "Thanks @peterSO, did see that - but couldn&#39;t get to make it work with, say, a <code>string</code>. Any small example would be really beneficial. Thanks again."}, {"owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "reply_to_user": {"reputation": 49, "user_id": 7890683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BEgoT.png?s=128&g=1", "display_name": "snowball", "link": "https://stackoverflow.com/users/7890683/snowball"}, "edited": false, "score": 0, "creation_date": 1545397938, "post_id": 53884997, "comment_id": 94617148, "body": "@snowball: See my revised answer for a <code>string</code> example."}, {"owner": {"reputation": 49, "user_id": 7890683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BEgoT.png?s=128&g=1", "display_name": "snowball", "link": "https://stackoverflow.com/users/7890683/snowball"}, "edited": false, "score": 0, "creation_date": 1545399934, "post_id": 53884997, "comment_id": 94618092, "body": "Cheers @peterSO, much appreciated!"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1545398790, "last_edit_date": 1545398790, "creation_date": 1545396111, "answer_id": 53884997, "question_id": 53884918, "link": "https://stackoverflow.com/questions/53884918/are-interfaces-only-ever-implemented-by-struct-data-types-in-go/53884997#53884997", "title": "Are interfaces only ever implemented by struct data types in Go?", "body": "<blockquote>\n  <p><a href=\"https://golang.org/ref/spec\" rel=\"nofollow noreferrer\">The Go Programming Language Specification</a></p>\n  \n  <p><a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">Method declarations</a></p>\n  \n  <p>A method is a function with a receiver. A method declaration binds an\n  identifier, the method name, to a method, and associates the method\n  with the receiver's base type. </p>\n  \n  <p>The receiver is specified via an extra parameter section preceding the\n  method name. That parameter section must declare a single non-variadic\n  parameter, the receiver. Its type must be of the form T or *T\n  (possibly using parentheses) where T is a type name. The type denoted\n  by T is called the receiver base type; it must not be a pointer or\n  interface type and it must be defined in the same package as the\n  method. The method is said to be bound to the base type and the method\n  name is visible only within selectors for type T or *T.</p>\n</blockquote>\n\n<hr>\n\n<p>No. It can be any type other than a pointer or interface type.</p>\n\n<hr>\n\n<p>For example, using <code>string</code> as the underlying type,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\ntype Caser interface {\n    Upper() string\n    Lower() string\n}\n\ntype Str string\n\nfunc (s Str) Upper() string {\n    return strings.ToUpper(string(s))\n}\n\nfunc (s Str) Lower() string {\n    return strings.ToLower(string(s))\n}\n\nfunc main() {\n    str := Str(\"Forty-Two\")\n    fmt.Println(str)\n    up := str.Upper()\n    fmt.Println(up)\n    lo := str.Lower()\n    fmt.Println(lo)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/9RDRTftqWot\" rel=\"nofollow noreferrer\">https://play.golang.org/p/9RDRTftqWot</a></p>\n\n<p>Output:</p>\n\n<pre><code>Forty-Two\nFORTY-TWO\nforty-two\n</code></pre>\n\n<hr>\n"}], "owner": {"reputation": 49, "user_id": 7890683, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BEgoT.png?s=128&g=1", "display_name": "snowball", "link": "https://stackoverflow.com/users/7890683/snowball"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 1, "accepted_answer_id": 53884997, "answer_count": 1, "score": 1, "last_activity_date": 1545398790, "creation_date": 1545395746, "question_id": 53884918, "link": "https://stackoverflow.com/questions/53884918/are-interfaces-only-ever-implemented-by-struct-data-types-in-go", "title": "Are interfaces only ever implemented by struct data types in Go?", "body": "<p>I'm quite new to Go and was looking at Interfaces and their implementations.\nAll examples I have encountered use <code>struct{}</code> to implement any interface.\nIs it possible to use any basic type?</p>\n"}, {"tags": ["go", "mocking", "integration-testing", "grpc"], "comments": [{"owner": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1545386518, "post_id": 53882312, "comment_id": 94611953, "body": "You have a service you want to test. I would expect that you start the service in your test with a test configuration and then you make requests to the service with a client (your test client) then you compare that data you got with the expected data. The idea of an integration test is not to mock something, then it won&#39;t be an integration test anymore."}, {"owner": {"reputation": 341, "user_id": 834860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aacaff165e967e8b46bcd4711b874c66?s=128&d=identicon&r=PG", "display_name": "Maxim Schepelin", "link": "https://stackoverflow.com/users/834860/maxim-schepelin"}, "reply_to_user": {"reputation": 3441, "user_id": 5291427, "user_type": "registered", "accept_rate": 43, "profile_image": "https://lh4.googleusercontent.com/-lu_crIBX8Ow/AAAAAAAAAAI/AAAAAAAAAAA/G_Vb3EEC_3Q/photo.jpg?sz=128", "display_name": "apxp", "link": "https://stackoverflow.com/users/5291427/apxp"}, "edited": false, "score": 0, "creation_date": 1545388060, "post_id": 53882312, "comment_id": 94612696, "body": "Sorry for the wrong terminology. I need the black box tests for the business logic in my service. The problem is that my service has only a few dependencies, but the dependencies require a lot of infrastructures. Think it as a microservice which uses only one handler from a monolith"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1545391303, "post_id": 53882312, "comment_id": 94614246, "body": "Presumably you have access to the proto definitions, right? So generate the service stubs and implement them however you&#39;d like. If memory serves, protoc generates client and server code together anyway, so you should already have the server interfaces."}, {"owner": {"reputation": 1257, "user_id": 2822744, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6d83aa67565ba16ac934ade14bb1923d?s=128&d=identicon&r=PG&f=1", "display_name": "redwulf", "link": "https://stackoverflow.com/users/2822744/redwulf"}, "edited": false, "score": 0, "creation_date": 1584448470, "post_id": 53882312, "comment_id": 107434487, "body": "Did you ever solve this issue? Struggling to get this done with gripmock too, and suspecting some of the stuff I&#39;m trying to do might be unsupported"}, {"owner": {"reputation": 1404, "user_id": 1168315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78dfc692c7f5fd63c7e3407f8c610c45?s=128&d=identicon&r=PG", "display_name": "Dominik", "link": "https://stackoverflow.com/users/1168315/dominik"}, "edited": false, "score": 0, "creation_date": 1614158359, "post_id": 53882312, "comment_id": 117297391, "body": "Does this answer your question? <a href=\"https://stackoverflow.com/questions/42102496/testing-a-grpc-service\">Testing a gRPC service</a>"}, {"owner": {"reputation": 1404, "user_id": 1168315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78dfc692c7f5fd63c7e3407f8c610c45?s=128&d=identicon&r=PG", "display_name": "Dominik", "link": "https://stackoverflow.com/users/1168315/dominik"}, "edited": false, "score": 0, "creation_date": 1614158449, "post_id": 53882312, "comment_id": 117297436, "body": "I would say <a href=\"https://stackoverflow.com/questions/42102496/testing-a-grpc-service\">that&#39;s the same question</a> which has a <a href=\"https://stackoverflow.com/a/52080545/1168315\">very good answer</a> from @shiblon."}], "answers": [{"tags": [], "owner": {"reputation": 93, "user_id": 1957744, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/A0xwq.jpg?s=128&g=1", "display_name": "Sefa", "link": "https://stackoverflow.com/users/1957744/sefa"}, "is_accepted": false, "score": 2, "last_activity_date": 1545390769, "last_edit_date": 1545390769, "creation_date": 1545390310, "answer_id": 53883699, "question_id": 53882312, "link": "https://stackoverflow.com/questions/53882312/how-to-mock-grpc-api-for-integration-testing-with-golang/53883699#53883699", "title": "How to mock gRPC api for integration testing with golang", "body": "<p>You can spin up your environment by defining all of your services in a docker-compose file. You should add the service you want to test as well in the docker-compose file. After spinning it up you can run your integration tests in the service you want to test. </p>\n\n<p>Example docker-compose file:</p>\n\n<pre><code>version: '2.2'\n\nservices:\n  service-you-want-to-test:\n    build: .\n    image: service-you-want-to-test\n    container_name: service-you-want-to-test\n    environment:\n      - ENVIRONMENT=${ENVIRONMENT}\n      - REDIS_ADDRESSES=[redis:6379]\n      - SERVICE_YOU_DEPEND_ON_ENDPOINT=service-you-depend-on:8091\n      - DB_HOST=mysql\n      - DB_USER=root\n    links:\n      - redis\n      - mysql\n      - service-you-depend-on\n    depends_on:\n      mysql:\n        condition: service_healthy\n    ports:\n      - 8090:8090\n\n  service-you-depend-on:\n    image: service-you-depend-on:latest\n    container_name: service-you-depend-on\n    environment:\n      - DB_HOST=mysql\n      - DB_USER=root\n    links:\n      - redis\n      - mysql\n    depends_on:\n      mysql:\n        condition: service_healthy\n    ports:\n      - 8091:8091\n\n  mysql:\n    image: mysql:5.7\n    container_name: mysql\n    environment:\n      MYSQL_ALLOW_EMPTY_PASSWORD: \"true\"\n    volumes:\n    - ./.docker/mysql/init.sql:/docker-entrypoint-initdb.d/init.sql:ro\n    - ./.docker/mysql/healthcheck-5.7:/var/www/healthcheck\n    healthcheck:\n      test: \"/var/www/healthcheck\"\n      interval: 5s\n      timeout: 5s\n      retries: 5\n    ports:\n    - 3306:3306\n\n  redis:\n    image: redis:3.2\n    container_name: redis\n    ports:\n      - 6379:6379\n</code></pre>\n\n<p>To set up your integration environment you can use these commands:</p>\n\n<pre><code>CGO_ENABLED=0 GOOS=linux GOARCH=amd64 go build main.go\ndocker build -t service-you-want-to-test .\ndocker-compose up -d redis mysql\ndocker-compose up -d --build service-you-want-to-test\n</code></pre>\n\n<p>After running the above you can just execute your integration tests via the command line:</p>\n\n<pre><code>go test -v path/to/integration_tests/...\n</code></pre>\n\n<p>So you should add the services that you depend on to the docker-compose file as well so you can actually send a request to them in your integration tests. Be sure to add those service endpoints in your environment variables so you can override the endpoint you send your request to.</p>\n\n<p>For resetting your data in for example your database you can write fixtures. The fixtures are just helper functions to reset the data of your database, cache, etc.</p>\n"}, {"tags": [], "owner": {"reputation": 1008, "user_id": 747917, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/71129109baab1673748ad7e67724cf99?s=128&d=identicon&r=PG", "display_name": "Ahmad Muzakki", "link": "https://stackoverflow.com/users/747917/ahmad-muzakki"}, "is_accepted": false, "score": 0, "last_activity_date": 1546401665, "creation_date": 1546401665, "answer_id": 54001051, "question_id": 53882312, "link": "https://stackoverflow.com/questions/53882312/how-to-mock-grpc-api-for-integration-testing-with-golang/54001051#54001051", "title": "How to mock gRPC api for integration testing with golang", "body": "<p>I just merge some patch for covering most of protobuf declaration. I suggest you check on that. </p>\n\n<p>known issue: it still can't parse protobuf that has method body declaration</p>\n"}, {"tags": [], "owner": {"reputation": 556, "user_id": 1086679, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/b09ea7eb109e638784b24aaaf0f6224c?s=128&d=identicon&r=PG", "display_name": "Liam Williams", "link": "https://stackoverflow.com/users/1086679/liam-williams"}, "is_accepted": false, "score": 1, "last_activity_date": 1549980045, "creation_date": 1549980045, "answer_id": 54651763, "question_id": 53882312, "link": "https://stackoverflow.com/questions/53882312/how-to-mock-grpc-api-for-integration-testing-with-golang/54651763#54651763", "title": "How to mock gRPC api for integration testing with golang", "body": "<p>Another alternative tool that you can use in this situation is <a href=\"https://trafficparrot.com\" rel=\"nofollow noreferrer\">Traffic Parrot</a>.</p>\n\n<p>We recently added support for gRPC to our <a href=\"https://trafficparrot.com/download.html\" rel=\"nofollow noreferrer\">service virtualization tool</a> which includes a user interface that can be used to define the mock behaviour.</p>\n\n<p>There is a <a href=\"https://trafficparrot.com/tutorials/mocking-and-simulating-grpc.html\" rel=\"nofollow noreferrer\">tutorial</a> on how to mock gRPC responses over the wire given a proto file.</p>\n\n<p>You can also find information on how to record and replay over the wire in the <a href=\"https://trafficparrot.com/documentation/4.4.x/grpc.html\" rel=\"nofollow noreferrer\">documentation</a>.</p>\n\n<p><a href=\"https://i.stack.imgur.com/w7DSo.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/w7DSo.png\" alt=\"Traffic Parrot gRPC user interface\"></a>\n<a href=\"https://i.stack.imgur.com/0coa1.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/0coa1.png\" alt=\"Recording gRPC messages\"></a>\n<a href=\"https://i.stack.imgur.com/ZsEvx.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZsEvx.png\" alt=\"Replaying gRPC messages\"></a></p>\n"}], "owner": {"reputation": 341, "user_id": 834860, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aacaff165e967e8b46bcd4711b874c66?s=128&d=identicon&r=PG", "display_name": "Maxim Schepelin", "link": "https://stackoverflow.com/users/834860/maxim-schepelin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3074, "favorite_count": 0, "answer_count": 3, "score": 6, "last_activity_date": 1549980045, "creation_date": 1545384948, "question_id": 53882312, "link": "https://stackoverflow.com/questions/53882312/how-to-mock-grpc-api-for-integration-testing-with-golang", "title": "How to mock gRPC api for integration testing with golang", "body": "<p>all</p>\n\n<p>I have a service written in go which communicates with a couple of other services via gRPC protocol. I want to write integration tests for my service but, I have no possibility to use real dependencies.</p>\n\n<p>So, I need to mock the dependencies in some way.</p>\n\n<p>For me, a perfect scenario looks like:</p>\n\n<ul>\n<li>I can run a mock-server and pass its address instead of a real dependency to my application</li>\n<li>I can register expected response for a specific call to the dependant service</li>\n<li>I can reset the mock-server to tear down the data after a test case.</li>\n</ul>\n\n<p>I tried to use <a href=\"https://github.com/jekiapp/gripmock\" rel=\"noreferrer\">https://github.com/jekiapp/gripmock</a> but it doesn't support all the protobuff syntax.</p>\n\n<p>What can help with my problem? Maybe I'm completely wrong and there are best practices for integration testing of services communicating gRPC</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 7445, "user_id": 1564365, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/2ff53772b33c8b0c305481ecb7e67141?s=128&d=identicon&r=PG", "display_name": "Kyslik", "link": "https://stackoverflow.com/users/1564365/kyslik"}, "edited": false, "score": 0, "creation_date": 1545389807, "post_id": 53882297, "comment_id": 94613583, "body": "Try <a href=\"https://golang.org/pkg/net/http/pprof/\" rel=\"nofollow noreferrer\">golang.org/pkg/net/http/pprof</a>"}], "answers": [{"comments": [{"owner": {"reputation": 51, "user_id": 10819374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ef80e76f6f086b81a9961d126c6177?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfer", "link": "https://stackoverflow.com/users/10819374/wolfer"}, "edited": false, "score": 0, "creation_date": 1545446777, "post_id": 53884564, "comment_id": 94631908, "body": "Ouch, I didn&#39;t even notice that the timer costs so much memory.  And deeply appreciate the introduction of pprof, it helps a lot on monitoring program status."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "reply_to_user": {"reputation": 51, "user_id": 10819374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ef80e76f6f086b81a9961d126c6177?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfer", "link": "https://stackoverflow.com/users/10819374/wolfer"}, "edited": false, "score": 2, "creation_date": 1545495317, "post_id": 53884564, "comment_id": 94640134, "body": "Just to be clear: timers don&#39;t cost very much memory individually but if you create close to 8 million of them it adds up."}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 6, "last_activity_date": 1545395332, "last_edit_date": 1545395332, "creation_date": 1545394053, "answer_id": 53884564, "question_id": 53882297, "link": "https://stackoverflow.com/questions/53882297/is-golang-channel-memory-usage-dynamic/53884564#53884564", "title": "Is golang channel memory usage dynamic?", "body": "<p><a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"noreferrer\">pprof</a> can tell you where you spend memory. Simply add an import statement for the <a href=\"https://golang.org/pkg/net/http/pprof/\" rel=\"noreferrer\">net/http/pprof</a> package and start an HTTP server with the http.DefaultServeMux:</p>\n\n<pre><code>import _ \"net/http/pprof\"\n\nfunc main() {\n    go func() { log.Fatal(http.ListenAndServe(\":4000\", nil)) }()\n\n    //...\n}\n</code></pre>\n\n<p>While the program is running, run the pprof tool to look at various statistics about your program. Since you are concerned about memory usage, the heap profile (memory-in-use) is probably most relevant.</p>\n\n<pre><code>$ go tool pprof -top 10 http://localhost:4000/debug/pprof/heap\nFetching profile over HTTP from http://localhost:4000/debug/pprof/heap\nFile: foo\nBuild ID: 10\nType: inuse_space\nTime: Dec 21, 2018 at 12:52pm (CET)\nShowing nodes accounting for 827.57MB, 99.62% of 830.73MB total\nDropped 9 nodes (cum &lt;= 4.15MB)\n      flat  flat%   sum%        cum   cum%\n  778.56MB 93.72% 93.72%   796.31MB 95.86%  time.NewTimer\n   18.25MB  2.20% 95.92%    18.25MB  2.20%  time.Sleep\n   17.75MB  2.14% 98.05%    17.75MB  2.14%  time.startTimer\n      11MB  1.32% 99.38%       11MB  1.32%  runtime.malg\n       2MB  0.24% 99.62%   798.31MB 96.10%  main.(*Session).readLoop\n         0     0% 99.62%   798.31MB 96.10%  main.(*Session).Serve\n         0     0% 99.62%    18.25MB  2.20%  main.(*Session).sendLoop\n         0     0% 99.62%   800.81MB 96.40%  main.Loop\n         0     0% 99.62%    11.67MB  1.40%  runtime.mstart\n         0     0% 99.62%    11.67MB  1.40%  runtime.newproc.func1\n         0     0% 99.62%    11.67MB  1.40%  runtime.newproc1\n         0     0% 99.62%    11.67MB  1.40%  runtime.systemstack\n         0     0% 99.62%   796.31MB 95.86%  time.After\n</code></pre>\n\n<p>Unsurprisingly, the huge amount of <code>time.Timer</code>s you are creating with <a href=\"https://golang.org/pkg/time/#After\" rel=\"noreferrer\"><code>time.After</code></a> accounts for pretty much all of the memory in use.</p>\n\n<p>Think about it: With an interval of 250ms you are creating timers 4 times faster than with an interval of 1s. However, the lifetime of the timers is not proportional to the interval -- it is constant at 60 seconds. So at any given point you have 4*60=240 times more timers alive.</p>\n\n<p>From the docs of time.After:</p>\n\n<blockquote>\n  <p>After waits for the duration to elapse and then sends the current time on the returned channel. It is equivalent to NewTimer(d).C. The underlying Timer is not recovered by the garbage collector until the timer fires. If efficiency is a concern, use NewTimer instead and call Timer.Stop if the timer is no longer needed.</p>\n</blockquote>\n\n<p>So create a single timer per <code>readLoop</code> and re-use it. You can further reduce memory usage by using a channel of empty struct values instead of a channel of booleans:</p>\n\n<pre><code>type Session struct {\n    KeepAlive chan struct{}\n}\n\nfunc (s *Session) readLoop() {\n    fmt.Println(\"readLoop\")\n\n    d := 1 * time.Minute\n    t := time.NewTimer(d)\n\nloop:\n    for {\n        select {\n        case _, ok := &lt;-s.KeepAlive:\n            if !ok {\n                break loop\n            }\n\n            if !t.Stop() {\n                &lt;-t.C\n            }\n            t.Reset(d)\n\n        case &lt;-t.C:\n            fmt.Println(\"Timeout\")\n            break loop\n        }\n    }\n\n    fmt.Println(\"readLoop EXIT\")\n}\n\nfunc (s *Session) sendLoop() {\n    defer close(s.KeepAlive)\n\n    for {\n        s.KeepAlive &lt;- struct{}{}\n        time.Sleep(interval)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 51, "user_id": 10819374, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/61ef80e76f6f086b81a9961d126c6177?s=128&d=identicon&r=PG&f=1", "display_name": "Wolfer", "link": "https://stackoverflow.com/users/10819374/wolfer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1522, "favorite_count": 1, "accepted_answer_id": 53884564, "answer_count": 1, "score": 4, "last_activity_date": 1545395332, "creation_date": 1545384897, "question_id": 53882297, "link": "https://stackoverflow.com/questions/53882297/is-golang-channel-memory-usage-dynamic", "title": "Is golang channel memory usage dynamic?", "body": "<p>I have test go channel memory usage and found that it differs from channel input frequency while the amount of goroutines are the same.</p>\n\n<p>As the code below, I create thousands of goroutines, which produce data to its own channel and consume data from same channel.</p>\n\n<p>By changing only the variable \"interval\" of producer, I can see the virtual memory and resident memory varies too by monitoring with command \"top\".</p>\n\n<p>And the shorter is the interval, the usage of memory is larger.</p>\n\n<p>Does anyone know what happen?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"os/signal\"\n    \"syscall\"\n    \"time\"\n)\n\ntype Session struct {\n    KeepAlive chan bool\n}\n\nvar count = 1024 * 8 * 4\n\nvar interval = 250 * time.Millisecond //3718.0m 3.587g   1.2m S 224.0 23.1\n\n// var interval = 500 * time.Millisecond //2011.2m 1.923g   1.2m S 118.8 12.4\n\n// var interval = 1 * time.Second   //1124.0m 1.059g   1.1m S  73.0  6.8\n\nfunc main() {\n\n    var gracefulStop = make(chan os.Signal, 1)\n    signal.Notify(gracefulStop, syscall.SIGTERM, syscall.SIGINT, syscall.SIGKILL)\n\n    for i := 0; i &lt; count; i++ {\n        go Loop()\n    }\n\n    &lt;-gracefulStop\n    fmt.Println(\"gracefulStop\")\n}\n\nfunc Loop() (err error) {\n\n    var se *Session\n    se = NewSession()\n\n    se.Serve()\n\n    return\n}\n\nfunc NewSession() (s *Session) {\n\n    fmt.Println(\"NewSession\")\n\n    s = &amp;Session{\n\n        KeepAlive: make(chan bool, 1),\n    }\n\n    return\n}\n\nfunc (s *Session) Serve() {\n\n    fmt.Println(\"Serve\")\n\n    go s.sendLoop()\n\n    s.readLoop()\n\n    s.Close()\n\n    return\n}\n\nfunc (s *Session) Close() {\n\n    close(s.KeepAlive)\n    fmt.Println(\"Close\")\n}\n\n// local-------------------------------------------------------\n\nfunc (s *Session) readLoop() {\n    fmt.Println(\"readLoop\")\n\n    sec := time.Duration(1 * time.Minute)\n\nServerHandlerLoop:\n    for {\n        select {\n\n        case alive := &lt;-s.KeepAlive:\n            if alive == false {\n                break ServerHandlerLoop\n            }\n\n        case &lt;-time.After(sec):\n            fmt.Println(\"Timeout\")\n            break ServerHandlerLoop\n\n        }\n    }\n\n    fmt.Println(\"readLoop EXIT\")\n}\n\nfunc (s *Session) sendLoop() {\n\n    for {\n\n        s.KeepAlive &lt;- true\n\n        time.Sleep(interval)\n\n    }\n\n    s.KeepAlive &lt;- false\n\n    fmt.Println(\"ReadMessage EXIT\")\n}\n</code></pre>\n"}]