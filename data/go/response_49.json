[{"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1450309371, "post_id": 34324243, "comment_id": 56390249, "body": "Do I need to compare against the value to make it work properly? Because my Application struct cannot be compared to other things because it has slice fields in it and what not"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "edited": false, "score": 0, "creation_date": 1450309794, "post_id": 34324243, "comment_id": 56390381, "body": "@Datsik Nope, you can keep your switch statement. Just loop by index instead of <code>range</code> and decrement the index by one after you&#39;ve removed an element."}], "tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": false, "score": 2, "last_activity_date": 1450309609, "last_edit_date": 1450309609, "creation_date": 1450309246, "answer_id": 34324243, "question_id": 34324171, "link": "https://stackoverflow.com/questions/34324171/how-can-i-get-a-slices-new-index-after-a-goroutine-channel-has-mutated-the-slice/34324243#34324243", "title": "How can I get a slices new index after a goroutine channel has mutated the slice?", "body": "<p>Don't <code>range</code> over a slice if you want to remove elements from it.</p>\n\n<p>Instead, loop over the slice by index:</p>\n\n<pre><code>// Removes 2 from slice.\nslice := []int{1,2,3}\nfor i := 0; i &lt; len(slice); i++ {\n    if slice[i] == 2 {\n        slice = append(slice[:i], slice[i+1:]...)\n        i--\n    }\n}\nfmt.Println(slice) // [1 3]\n</code></pre>\n\n<p>The point is bringing the index cursor back by one (so it won't go forward) after you've removed the current element.</p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450309609, "creation_date": 1450308811, "question_id": 34324171, "link": "https://stackoverflow.com/questions/34324171/how-can-i-get-a-slices-new-index-after-a-goroutine-channel-has-mutated-the-slice", "title": "How can I get a slices new index after a goroutine channel has mutated the slice?", "body": "<p>I'm wondering how I can get an elements new index in a slice, I have a function that gets applications from a database, and queries for certain ones (for filtering) but when I query for ones and I get ones I don't need, I'm trying to remove them from the slice so that only the wanted ones make it to the view. It's working but I'm having a problem with the index's in the goroutines are the older index's so when it trys to remove the element from the slice it panics: Anyways here is my code:</p>\n\n<pre><code>// ListApplications will list the applications\nfunc ListApplications(w http.ResponseWriter, r *http.Request) {\n    session := common.Sesh(r)\n    urlParse, err := url.ParseRequestURI(r.RequestURI)\n    vals := urlParse.Query()\n\n    if err != nil {\n        log.Println(err)\n    }\n    if lvl, ok := session.Values[\"user_level\"]; !ok || lvl.(int) &lt; 3 {\n        http.Redirect(w, r, \"/\", 401)\n        return\n    }\n\n    db := common.Db()\n\n    type UserResp struct {\n        Action string\n        I      int\n        User   common.User\n    }\n    apps := []common.Application{}\n    resp := make(chan UserResp)\n    db.Order(\"accepted asc\").Order(\"created_at asc\").Find(&amp;apps)\n    var wg sync.WaitGroup\n    for i, app := range apps {\n        wg.Add(1)\n        go func(i int, app common.Application) {\n            user := common.User{}\n            if vals.Get(\"class\") != \"\" {\n                db.Preload(\"Characters\", \"character_class = ?\", vals.Get(\"class\")).Model(&amp;app).Related(&amp;user)\n                if len(user.Characters) == 0 {\n                    resp &lt;- UserResp{\"remove\", i, user}\n                } else {\n                    resp &lt;- UserResp{\"add\", i, user}\n                }\n                wg.Done()\n                return\n            }\n\n            db.Preload(\"Characters\").Model(&amp;app).Related(&amp;user)\n            log.Println(user)\n            resp &lt;- UserResp{\"add\", i, user}\n            wg.Done()\n        }(i, app)\n    }\n\n    go func() {\n        wg.Wait()\n        close(resp)\n    }()\n\n    for user := range resp {\n        switch user.Action {\n        case \"add\":\n            apps[user.I].User = user.User\n        case \"remove\":\n        log.Println(len(apps), user.I)\n            apps = append(apps[:user.I], apps[user.I+1:]...)\n        }\n    }\n\n    common.View(w, r, \"/application/list\", &amp;struct {\n        Title string\n        Apps  []common.Application\n    }{\"Viewing Applications\", apps})\n}\n</code></pre>\n\n<p>The <code>for user := range resp</code> is where I'm trying to delete under the <code>\"remove\"</code> action. But like I said, the index getting passed through on the channel is out dated sometimes so how can I maintain a persistent index in my goroutines</p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 3, "creation_date": 1450308282, "post_id": 34323986, "comment_id": 56389887, "body": "I think this one has to do with math and algorithms more than goroutines (hint: try <a href=\"http://math.stackexchange.com/\">math.stackexchange.com</a>). And if you must wait for neighbors to finish before calculating more cells, how would calculating concurrently help you?"}, {"owner": {"reputation": 1932, "user_id": 979255, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06ce4c0f7ee07cf79c81ac6602f5d502?s=128&d=identicon&r=PG", "display_name": "j6m8", "link": "https://stackoverflow.com/users/979255/j6m8"}, "reply_to_user": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 0, "creation_date": 1450309013, "post_id": 34323986, "comment_id": 56390142, "body": "It&#39;s a good question. So, for the first cell, it makes no sense to make it concurrent. But after you populate the <code>1</code>, you can now run <i>two</i> cells without any dependency on each other. Then 3, and so on. For a large matrix (n &gt; # of cores), this starts to make a lot more sense."}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 0, "creation_date": 1450310730, "post_id": 34323986, "comment_id": 56390636, "body": "That&#39;s interesting. I&#39;m still having a hard time figuring out how it would work concurrently as the matrix goes deeper to the bottom right :/"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 1, "creation_date": 1450311285, "post_id": 34323986, "comment_id": 56390827, "body": "I answered, if you need a more sophisticated waiting mechanic, just elaborate."}], "answers": [{"tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": false, "score": 1, "last_activity_date": 1450310956, "creation_date": 1450310956, "answer_id": 34324491, "question_id": 34323986, "link": "https://stackoverflow.com/questions/34323986/how-can-i-spawn-go-routines-that-depend-on-their-predecessors/34324491#34324491", "title": "How can I spawn go routines that depend on their predecessors?", "body": "<p>Use <a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow\">channels</a>.</p>\n\n<p>A goroutine waiting on another goroutine:</p>\n\n<pre><code>done := make(chan bool)\n\ngo func() {\n  // Work...\n  done &lt;- true // Signal we're done.\n}()\n\ngo func() {\n  &lt;- done // Wait for the previous goroutine to signal.\n  // Work...\n}()\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1932, "user_id": 979255, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06ce4c0f7ee07cf79c81ac6602f5d502?s=128&d=identicon&r=PG", "display_name": "j6m8", "link": "https://stackoverflow.com/users/979255/j6m8"}, "edited": false, "score": 0, "creation_date": 1450313441, "post_id": 34324545, "comment_id": 56391438, "body": "Using the number of outs from a channel as an unblocker -- I like that! Is this common practice? (Regardless, it&#39;s pretty clever.)"}, {"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "reply_to_user": {"reputation": 1932, "user_id": 979255, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06ce4c0f7ee07cf79c81ac6602f5d502?s=128&d=identicon&r=PG", "display_name": "j6m8", "link": "https://stackoverflow.com/users/979255/j6m8"}, "edited": false, "score": 0, "creation_date": 1450335859, "post_id": 34324545, "comment_id": 56398458, "body": "Yeah, I&#39;d say that&#39;s the canonical go way if it ever comes up. You could also do something pretty similar using sync/atomic."}], "tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": true, "score": 2, "last_activity_date": 1450313942, "last_edit_date": 1450313942, "creation_date": 1450311306, "answer_id": 34324545, "question_id": 34323986, "link": "https://stackoverflow.com/questions/34323986/how-can-i-spawn-go-routines-that-depend-on-their-predecessors/34324545#34324545", "title": "How can I spawn go routines that depend on their predecessors?", "body": "<p>Hopefully this is a contrived example, because this is definitely not the fastest solution, but maybe it's what you want.</p>\n\n<p>Each cell runs in its own goroutine and has its own channel, roughly representing its dependencies. A cell knows its dependencies have all resolved once it's read three values from its channel. When a cell completes, it passes some value to the channels of all of its dependents.</p>\n\n<pre><code>import \"sync\"\n\ntype empty struct{}\n\nfunc contrivedMathThing(i, j int) ([][]int) {\n\n    var wg sync.WaitGroup\n    wg.Add(i * j)\n\n    // Make two-dimensional slices for the channels that the goroutines will\n    // wait on, and for the results of each cell. Two dimensional slices are\n    // more annoying to make, but I think make the example a bit more clear.\n    chans := make([][]chan empty, i)\n    results := make([][]int, i)\n    for a := 0; a &lt; i; a++ {\n        chans[a] = make([]chan empty, j)\n        results[a] = make([]int, j)\n        for b := 0; b &lt; j; b++ {\n            chans[a][b] = make(chan empty, 3)\n        }\n    }\n\n    for a := 0; a &lt; i; a++ {\n        for b := 0; b &lt; j; b++ {\n            go func(a, b int, waitc &lt;-chan empty) {\n                defer wg.Done()\n\n                // Wait for all dependencies to complete\n                &lt;-waitc\n                &lt;-waitc\n                &lt;-waitc\n\n                // Compute the result\n                // Too lazy to write...\n\n                // Save the result to the results array\n                results[a][b] = result\n\n                // Signal all dependents that one of their dependencies has\n                // resolved\n                if a &lt; i - 1 {\n                    chans[a + 1][b] &lt;- empty{} \n                }\n                if b &lt; j - 1 {\n                    chans[a][b + 1] &lt;- empty{}\n                }\n                if a &lt; i - 1 &amp;&amp; b &lt; j - 1 {\n                    chans[a + 1][b + 1] &lt;- empty{}\n                }\n\n            }(a, b, chans[a][b])\n        }\n    }\n\n    // All cells in the first row and first column need to start out with two\n    // of their dependencies satisfied.\n    for a := 1; a &lt; i; a++ {\n        chans[a][0] &lt;- empty{}\n        chans[a][0] &lt;- empty{}\n    }\n    for b := 1; b &lt; j; b++ {\n        chans[0][b] &lt;- empty{}\n        chans[0][b] &lt;- empty{}\n    }\n\n    // Unblock the cell at [0][0] so this show can get started\n    close(chans[0][0])\n\n    wg.Wait()\n\n    return results\n}\n</code></pre>\n"}], "owner": {"reputation": 1932, "user_id": 979255, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/06ce4c0f7ee07cf79c81ac6602f5d502?s=128&d=identicon&r=PG", "display_name": "j6m8", "link": "https://stackoverflow.com/users/979255/j6m8"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 34324545, "answer_count": 2, "score": 1, "last_activity_date": 1450313942, "creation_date": 1450307840, "last_edit_date": 1450310012, "question_id": 34323986, "link": "https://stackoverflow.com/questions/34323986/how-can-i-spawn-go-routines-that-depend-on-their-predecessors", "title": "How can I spawn go routines that depend on their predecessors?", "body": "<p>Say for example that I want to populate this matrix:</p>\n\n<pre><code>| 0 | 0 | 0 | 0 |\n| 0 | 1 | 2 | 3 |\n| 0 | 2 | 3 | 4 |\n| 0 | 3 | 4 | 5 |\n</code></pre>\n\n<p>Specifically, I want to populate it so that each cell follows the rule,</p>\n\n<p><a href=\"https://i.stack.imgur.com/ksxi2.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ksxi2.gif\" alt=\"formula\"></a></p>\n\n<p>In english, a cell's value is one greater than the maximum of its <code>top</code>, <code>left</code>, and <code>topleft</code> neighbors' values.</p>\n\n<p>Because each cell only has three dependencies (its <code>top</code>, <code>left</code>, and <code>topleft</code> neighbors), I can populate the cell at <code>m[1][1]</code> (the <code>1</code>), and once that's populated, I can populate the cells marked <code>2</code> as all of their dependencies are already populated.</p>\n\n<pre><code>| 0 | 0 | 0 | 0 |          | 0 | 0 | 0 | 0 |\n| 0 | 1 | 0 | 0 |   ---\\   | 0 | 1 | 2 | 0 |\n| 0 | 0 | 0 | 0 |   ---/   | 0 | 2 | 0 | 0 |\n| 0 | 0 | 0 | 0 |          | 0 | 0 | 0 | 0 |\n</code></pre>\n\n<p>How can I spin up 1 go routine, then 2, then 3, then 4..., to populate each diagonal of this matrix? Perhaps more specifically, how can I wait on the neighbors to finish before beginning the dependent cell?</p>\n\n<p><strong>[EDIT]</strong>: Thanks for the comment, @Zippoxer! To clarify, I'm asking what the syntax is in Go to run a go-routine that depends on another finishing first. Because multiple new go-routines can start when just one go-routine finishes, it's not as simple as just calling things without concurrency!</p>\n"}, {"tags": ["unit-testing", "testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 721, "user_id": 992453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed971c25da6337939373a65fb1f192f0?s=128&d=identicon&r=PG", "display_name": "Gaston", "link": "https://stackoverflow.com/users/992453/gaston"}, "edited": false, "score": 0, "creation_date": 1450306021, "post_id": 34323441, "comment_id": 56388979, "body": "Edited the question with proper formatted suggestion."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 10, "last_activity_date": 1450305339, "creation_date": 1450305339, "answer_id": 34323441, "question_id": 34323408, "link": "https://stackoverflow.com/questions/34323408/table-tests-for-multi-return-value-function/34323441#34323441", "title": "Table tests for multi-return value function", "body": "<p>Just add another field to your struct that holds the second return value. Example:</p>\n\n<pre><code>var halfTests = []struct {\n    in   int\n    out1 int\n    out2 bool\n}{\n    {1, 0, false},\n    {3, 1, true},\n}\n</code></pre>\n\n<p>Your testing function would look like the following:</p>\n\n<pre><code>func TestHalf(t *testing.T) {\n    for _, tt := range halfTests {\n        s, t := half(tt.in)\n        if s != tt.out1 || t != tt.out2 {\n            t.Errorf(\"half(%d) =&gt; %d, %v, want %d, %v\", tt.in, s, t, tt.out1, tt.out2)\n        }\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 721, "user_id": 992453, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ed971c25da6337939373a65fb1f192f0?s=128&d=identicon&r=PG", "display_name": "Gaston", "link": "https://stackoverflow.com/users/992453/gaston"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2220, "favorite_count": 0, "accepted_answer_id": 34323441, "answer_count": 1, "score": 4, "last_activity_date": 1551361697, "creation_date": 1450305185, "last_edit_date": 1551361697, "question_id": 34323408, "link": "https://stackoverflow.com/questions/34323408/table-tests-for-multi-return-value-function", "title": "Table tests for multi-return value function", "body": "<p>I'm cutting my teeth on Go and after digging into <a href=\"https://github.com/golang/go/wiki/TableDrivenTests\" rel=\"nofollow noreferrer\">table driven tests</a> I ran into the following problem:</p>\n\n<p>I have a function that returns multiple values</p>\n\n<pre><code>// Halves an integer and and returns true if it was even or false if it was odd.\nfunc half(n int) (int, bool) {\n    h := n / 2\n    e := n%2 == 0\n    return h, e\n}\n</code></pre>\n\n<p>I know that for <code>half(1)</code> the return value should be <code>0, false</code> and for <code>half(2)</code> it should match <code>1, true</code>, but I can't seem to figure out how to put this on a table. </p>\n\n<p>How would one go to have something that resembles the following?</p>\n\n<pre><code>var halfTests = []struct {\n    in  int\n    out string\n}{\n    {1, &lt;0, false&gt;},\n    {3, &lt;1, true&gt;},\n}\n</code></pre>\n\n<p>Is there any other, more idiomatic way of doing this?</p>\n\n<p>For reference, here's a test for something that resembles a FizzBuzz function, using tables:</p>\n\n<pre><code>var fizzbuzzTests = []struct {\n    in  int\n    out string\n}{\n    {1, \"1\"},\n    {3, \"Fizz\"},\n    {5, \"Buzz\"},\n    {75, \"FizzBuzz\"},\n}\n\nfunc TestFizzBuzz(t *testing.T) {\n    for _, tt := range fizzbuzzTests {\n        s := FizzBuzz(tt.in)\n        if s != tt.out {\n            t.Errorf(\"Fizzbuzz(%d) =&gt; %s, want %s\", tt.in, s, tt.out)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["azure", "logging", "go", "azure-web-app-service"], "comments": [{"owner": {"reputation": 32100, "user_id": 1033581, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/e8891617e36b8d1254eb3ce1a5662da4?s=128&d=identicon&r=PG", "display_name": "C\u0153ur", "link": "https://stackoverflow.com/users/1033581/c%c5%93ur"}, "edited": false, "score": 0, "creation_date": 1582387057, "post_id": 34322855, "comment_id": 106763601, "body": "Hi Dominic, I&#39;ve removed the indirection by google, but I don&#39;t know if your question was specific to the old version of the article, or not. So I put two links. Feel free to <a href=\"https://stackoverflow.com/posts/34322855/edit\">edit</a> and keep only the most relevant one."}], "answers": [{"comments": [{"owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1450348385, "post_id": 34324141, "comment_id": 56406038, "body": "Thanks  I will. But from what I thought the fact of enabling Application Logging in the portal was equivalent to saying grab standard stdout output and saving it to File or Blob or display it when using log tail? Why is this related to Kudu? Aren&#39;t Kudu there to deploy app from a git push action?"}, {"owner": {"reputation": 3417, "user_id": 5463877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88da9f0b09bd7ddb86d1336e75980fd?s=128&d=identicon&r=PG", "display_name": "Xiaomin Wu", "link": "https://stackoverflow.com/users/5463877/xiaomin-wu"}, "reply_to_user": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "edited": false, "score": 0, "creation_date": 1450375953, "post_id": 34324141, "comment_id": 56424327, "body": "@DominicSt-Pierre Kudu is more than a deployment engine. and the logging is handling by our team as well (most of the code might not in Kudu)"}], "tags": [], "owner": {"reputation": 3417, "user_id": 5463877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e88da9f0b09bd7ddb86d1336e75980fd?s=128&d=identicon&r=PG", "display_name": "Xiaomin Wu", "link": "https://stackoverflow.com/users/5463877/xiaomin-wu"}, "is_accepted": true, "score": 2, "last_activity_date": 1450308662, "creation_date": 1450308662, "answer_id": 34324141, "question_id": 34322855, "link": "https://stackoverflow.com/questions/34322855/how-to-tail-log-from-go-app-on-azure-web-app/34324141#34324141", "title": "How to tail log from go app on Azure Web App", "body": "<p>We haven`t implement logging for Go application yet. Here is the pending work item in our repository <a href=\"https://github.com/projectkudu/kudu/issues/1535\" rel=\"nofollow\">https://github.com/projectkudu/kudu/issues/1535</a></p>\n\n<p>Feel free to raise your needs onto our Github issue, and we will triage and address it according to schedule.</p>\n\n<p>As of now, you will need to handle your own logging.</p>\n"}], "owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 988, "favorite_count": 0, "accepted_answer_id": 34324141, "answer_count": 1, "score": 0, "last_activity_date": 1582386491, "creation_date": 1450303064, "last_edit_date": 1582386491, "question_id": 34322855, "link": "https://stackoverflow.com/questions/34322855/how-to-tail-log-from-go-app-on-azure-web-app", "title": "How to tail log from go app on Azure Web App", "body": "<p>I'm trying to find how I can have my <code>fmt.Printf</code> or <code>log.Printf</code> from my go app being tail or logged like we are able to do for .NET or Node apps to the Application logs.</p>\n\n<p>Based on this <a href=\"https://docs.microsoft.com/en-us/azure/app-service/troubleshoot-diagnostic-logs\" rel=\"nofollow noreferrer\">article</a> (<a href=\"https://web.archive.org/web/20160308005037/https://azure.microsoft.com/en-us/documentation/articles/web-sites-enable-diagnostic-log/\" rel=\"nofollow noreferrer\">archive link</a>) by enabling the Application logging from the portal all stdout should be logged. But for some reasons my log output are not printed either when using the azure CLI or downloading the log. There's no Application directory in the LogFiles directory of the diagnostics.zip.</p>\n\n<p><code>azure site log tail sitename</code> or <code>azure site log download sitename</code></p>\n\n<p>In Node I use the <code>IISNode.yml</code> file to tell to log the <code>console.log</code> to the application log. Is there a similar way of doing this for go app?</p>\n\n<pre><code>loggingEnabled: true\ndevErrorsEnabled: true\n</code></pre>\n"}, {"tags": ["go", "google-compute-engine", "google-cloud-platform"], "answers": [{"tags": [], "owner": {"reputation": 361, "user_id": 1606672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edfb4650d39cdfbdaddd2a737ebe30c6?s=128&d=identicon&r=PG", "display_name": "Paulo Pires", "link": "https://stackoverflow.com/users/1606672/paulo-pires"}, "is_accepted": true, "score": 0, "last_activity_date": 1450301526, "creation_date": 1450301526, "answer_id": 34322505, "question_id": 34319039, "link": "https://stackoverflow.com/questions/34319039/cant-define-network-when-creating-instance-group-with-go-client-library/34322505#34322505", "title": "Can&#39;t define Network when creating Instance Group with Go client library?", "body": "<p>It's actually a documentation bug. The following will work:</p>\n\n<pre><code>op, err := gce.service.InstanceGroups.Insert(projectID, zone, &amp;compute.InstanceGroup{\n        Name:       name,\n        NamedPorts: namedPorts,\n        Network:    networkURL}).Do()\n</code></pre>\n"}], "owner": {"reputation": 361, "user_id": 1606672, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/edfb4650d39cdfbdaddd2a737ebe30c6?s=128&d=identicon&r=PG", "display_name": "Paulo Pires", "link": "https://stackoverflow.com/users/1606672/paulo-pires"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "accepted_answer_id": 34322505, "answer_count": 1, "score": 0, "last_activity_date": 1450301526, "creation_date": 1450288970, "question_id": 34319039, "link": "https://stackoverflow.com/questions/34319039/cant-define-network-when-creating-instance-group-with-go-client-library", "title": "Can&#39;t define Network when creating Instance Group with Go client library?", "body": "<p>When creating an unmanaged instance group through GCP Console, I can see the REST request as:</p>\n\n<pre><code>POST https://www.googleapis.com/compute/v1/projects/my-project/zones/us-east1-d/instanceGroups\n{\n  \"name\": \"ig-web\",\n  \"network\": \"https://www.googleapis.com/compute/v1/projects/my-project/global/networks/nomad-network\",\n  \"namedPorts\": [\n    {\n      \"name\": \"http\",\n      \"port\": 11080\n    }\n  ]\n}\n</code></pre>\n\n<p>However, <a href=\"https://cloud.google.com/compute/docs/reference/latest/instanceGroups\" rel=\"nofollow\">according to the API docs</a> and <a href=\"https://godoc.org/google.golang.org/api/compute/v1#InstanceGroup\" rel=\"nofollow\">client library generated code</a>, one has no way to set the <code>network</code> URL.</p>\n\n<p>Anyone care to clarify?</p>\n"}, {"tags": ["git", "go", "server", "revel"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 7, "creation_date": 1450281943, "post_id": 34316666, "comment_id": 56375193, "body": "Pretty much every new go dev tries to fight the gopath. It is always painful. Use a Gopath. Read <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">golang.org/doc/code.html</a>."}, {"owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "edited": false, "score": 4, "creation_date": 1450282004, "post_id": 34316666, "comment_id": 56375243, "body": "Another interesting blog post: <a href=\"http://blog.golang.org/organizing-go-code\" rel=\"nofollow noreferrer\">blog.golang.org/organizing-go-code</a>"}], "answers": [{"tags": [], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "is_accepted": true, "score": 1, "last_activity_date": 1450282836, "last_edit_date": 1450282836, "creation_date": 1450282327, "answer_id": 34316848, "question_id": 34316666, "link": "https://stackoverflow.com/questions/34316666/what-is-the-correct-way-to-code-in-go/34316848#34316848", "title": "What is the correct way to code in Go?", "body": "<p>You add directories (workspaces) to <code>GOPATH</code> which contain go source, and conform to the structure <code>src, pkg, bin</code>. You can have as many go workspaces as you want in your <code>GOPATH</code>. Define the variable accordingly on your systems. The <code>GOPATH</code> on your server will most likely be different than the one your local machine.</p>\n\n<p>You can use <code>git</code> to share your projects. Create an account on github or bitbucket, and synchronize.</p>\n\n<p>Your <code>GOPATH</code> points to go workspaces. The first one is used to store the <code>go get</code> packages.</p>\n"}, {"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 1, "last_activity_date": 1450371918, "creation_date": 1450371918, "answer_id": 34340310, "question_id": 34316666, "link": "https://stackoverflow.com/questions/34316666/what-is-the-correct-way-to-code-in-go/34340310#34340310", "title": "What is the correct way to code in Go?", "body": "<h2>Introduction</h2>\n\n<p>I feel that there are a few misconceptions. Let's work on that.</p>\n\n<p>There are a few fundamental differences between PHP and Go, one of the being that PHP is an interpreted language as opposed to Go, which is a compiled language.</p>\n\n<p>PHP was designed and for most applications is a so called interpreted language, meaning that the source code is translated to machine readable instructions each time the PHP file is called.</p>\n\n<p>Go on the other hand is a compiled language, meaning that the source code is compiled to an executable binary <strong>once</strong> and linked statically be default causing the resulting executable to have no dependencies (other than the OS it was compiled for), not even the Go runtime. So you can build a self-sufficient web application including a web server and (using special purpose Go packages) even resource files like images and stylesheets.</p>\n\n<p>While you can use <code>go run filename.go</code>it is merely a shortcut for <code>go build</code> and executing the resulting compiled binary, as the output of <code>go run --help</code> proves:</p>\n\n<blockquote>\n  <p>go run [build flags] [-exec xprog] gofiles... [arguments...]</p>\n  \n  <p>Run compiles and runs the main package comprising the named Go source files.\n  A Go source file is defined to be a file ending in a literal \".go\" suffix.</p>\n  \n  <p>By default, 'go run' runs the compiled binary directly: 'a.out arguments...'.</p>\n</blockquote>\n\n<h2>Example</h2>\n\n<p>I'll show you how $GOPATH and it's subdirectories are interconnected.</p>\n\n<p>Let's take the most simple web server example:</p>\n\n<pre><code>package main \n\nimport (\n    \"net/http\"\n    \"fmt\"\n)\n\n// Default Request Handler\nfunc defaultHandler(w http.ResponseWriter, r *http.Request) {\n      fmt.Fprintf(w, \"&lt;h1&gt;Hello %s!&lt;/h1&gt;\", r.URL.Path[1:])\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", defaultHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>I have put it into a directory structure like this, including permissions and file size. This is on an OS X system</p>\n\n<pre><code>$GOPATH/src/github.com/mwmahlberg/DemoServer/\n\u2514\u2500\u2500 [-rw-r--r--  178]  server_main.go\n</code></pre>\n\n<p>Now, when calling <code>GOOS=linux go build ./...</code> in the directory DemoServer, in my case cross compiling the binary to run on linux. The binary gets build and the directory looks like this:</p>\n\n<pre><code>$GOPATH/src/github.com/mwmahlberg/DemoServer/\n\u251c\u2500\u2500 [-rwxr-xr-x 6.2M]  DemoServer\n\u2514\u2500\u2500 [-rw-r--r--  178]  server_main.go\n</code></pre>\n\n<p>Note the executable <code>server</code>which has a rather large size of 6.3M. However, let's inspect it:</p>\n\n<pre><code>$ file DemoServer\nserver: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, not stripped\n</code></pre>\n\n<p>You can actually copy this executable to any 64-bit Linux and run it by calling</p>\n\n<pre><code>$ ./DemoServer\n</code></pre>\n\n<p>Now, call the according server with <a href=\"http://hostname:8080/Mark\" rel=\"nofollow\">http://hostname:8080/Mark</a> and you will see a website greeting you.</p>\n\n<p>Not that this makes deployment very easy. No dependencies you need to take care of, no additional web server to configure. You can literally just copy the binary over and run it. However, this does not prevent you from using a bit more sophisticated approach, like creating software packages like a <code>.deb</code> or <code>.rpm</code> or (as I prefer) a Docker image.</p>\n\n<p>As per the subdirectories below <code>$GOPATH/src</code>: Actually you are totally free on how to organize your packages there. However, the triplet</p>\n\n<blockquote>\n  <p>codehoster/username/packagename</p>\n</blockquote>\n\n<p>is there for a reason. The <code>go get</code> command actually can use git, Mercurial and bzr sites to automatically download the packages. See <a href=\"https://github.com/golang/go/wiki/PackagePublishing\" rel=\"nofollow\">Package Publishing</a> for details. Yes, those code hosting sites are contacted directly. The <code>go get</code> actually is dependent on git at least. The triplet simply reflects the globally reachable location of the code. Of course you could store the code in  <code>$GOPATH/src/foobar</code> and push it to <code>github.com/mark/foobar</code>, though this becomes rather intransparent, especially when doing it like me hosting open projects on github.com and all others at bitbucket.org.</p>\n\n<p>Now, let's do something halfway useful and show a date when calling the date url:</p>\n\n<pre><code>package main \n\nimport (\n    \"net/http\"\n    \"fmt\"\n    \"time\"\n)\n\n// Default Request Handler\nfunc defaultHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"&lt;h1&gt;Hello %s!&lt;/h1&gt;\", r.URL.Path[1:])\n}\n\nfunc dateHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w,\"&lt;h1&gt;%s&lt;/h1&gt;\",time.Now())\n}\n\nfunc main() {\n    http.HandleFunc(\"/date\",dateHandler)\n    http.HandleFunc(\"/\", defaultHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>However, we still have all handlers inside our main function. We will extract the defaultHandler and dateHandler:</p>\n\n<pre><code>$GOPATH/src/github.com/mwmahlberg/DemoServer/\n\u251c\u2500\u2500 [-rw-r--r--  214]  dateHandler.go\n\u251c\u2500\u2500 [-rw-r--r--  165]  defaultHandler.go\n\u2514\u2500\u2500 [-rw-r--r--  178]  server_main.go\n</code></pre>\n\n<p>Our <code>server_main.go</code> now looks like this:</p>\n\n<pre><code>package main \n\nimport (\n    \"net/http\"    \n)\n\nfunc main() {\n    http.HandleFunc(\"/date\",dateHandler)\n    http.HandleFunc(\"/\", defaultHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>The <code>defaultHandler.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"fmt\"\n)\n\nfunc defaultHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w, \"&lt;h1&gt;Hello %s!&lt;/h1&gt;\", r.URL.Path[1:])\n}\n</code></pre>\n\n<p>And our <code>dateHandler.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"fmt\"\n    \"time\"\n)\n\nfunc dateHandler(w http.ResponseWriter, r *http.Request) {\n    fmt.Fprintf(w,\"&lt;h1&gt;%s&lt;/h1&gt;\",time.Now())\n}\n</code></pre>\n\n<p>Let us assume we have an application specific reusable function we want to put into a package. For the sake of this example, we will have a Formatter for our dateHandler.</p>\n\n<pre><code>$GOPATH/src/github.com/mwmahlberg/DemoServer/\n\u251c\u2500\u2500 [-rw-r--r--  214]  dateHandler.go\n\u251c\u2500\u2500 [-rw-r--r--  165]  defaultHandler.go\n\u251c\u2500\u2500 [drwxr-xr-x  102]  formatter\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 [-rw-r--r--  110]  dateformatter.go\n\u2514\u2500\u2500 [-rw-r--r--  178]  server_main.go\n</code></pre>\n\n<p>The content of <code>dateformatter.go</code> is pretty simple:</p>\n\n<pre><code>package formatter\n\nimport (\n    \"time\"\n)\n\nfunc FormatDate(d time.Time) string {\n    return d.Format(time.RFC850)\n}\n</code></pre>\n\n<p>and we use it in our date handler:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/mwmahlberg/DemoServer/formatter\"\n)\n\nfunc dateHandler(w http.ResponseWriter, r *http.Request) {\n\n    fmt.Fprintf(w, formatter.FormatDate(time.Now()))\n\n}\n</code></pre>\n\n<p>So, I hope this helps.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 4635458, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8d91c63a4aa5941a1f27e4ae983207a7?s=128&d=identicon&r=PG&f=1", "display_name": "Harshit Gupta", "link": "https://stackoverflow.com/users/4635458/harshit-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1490630753, "creation_date": 1490630753, "answer_id": 43051307, "question_id": 34316666, "link": "https://stackoverflow.com/questions/34316666/what-is-the-correct-way-to-code-in-go/43051307#43051307", "title": "What is the correct way to code in Go?", "body": "<p>I will answer your questions one by one:</p>\n\n<p><strong>1) What should I do, if I want to keep all my Go/Revel projects in go folder along with php and ruby on local machine like that:</strong></p>\n\n<p>Actually you can't. Go proposes a way of structuring your Go code structure and ideally that is how it should be followed. One workspace is shared by Go projects unlike others where you have separate workspace for every project.</p>\n\n<p><strong>2) And how do I actually deploy them on my remote server the correct way?</strong></p>\n\n<p>One efficient way I could think of is to have a separate build server where all the packages are built along with fetching of remote packages(github.com). Tar the built project. Go to your remote server and simply run the executable from bin. This saves time at the production server of fetching and building remote packages.</p>\n\n<p><strong>3) If I still need to use GOPATH for that, how do I name the packages? Is it GOPATH/src/mygoapp, GOPATH/src/mark/mygoapp or GOPATH/src/bitbucket.org/mark/mygoapp (while this repo is private)?</strong></p>\n\n<p>I guess the third one would be the most appropriate way of naming your packages as imports should begin with a hostname and then the remaining things.</p>\n"}], "owner": {"reputation": 19, "user_id": 5687314, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/49181c826af6969a00558ca1a8ef742b?s=128&d=identicon&r=PG&f=1", "display_name": "Mark", "link": "https://stackoverflow.com/users/5687314/mark"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 1, "accepted_answer_id": 34316848, "answer_count": 3, "score": 0, "last_activity_date": 1490630753, "creation_date": 1450281791, "last_edit_date": 1592644375, "question_id": 34316666, "link": "https://stackoverflow.com/questions/34316666/what-is-the-correct-way-to-code-in-go", "title": "What is the correct way to code in Go?", "body": "<p>Recently I found that Revel is a really good MVC web framework, and I want to try it out.\nThe problem is that I'm new to Go and everything seems a little different.</p>\n<p>When using PHP, I just put files into <code>/var/www/</code> folder, or use some IDE, then I can open browser and test them live. It's even easier with RoR or Node.js, I just go to local project folder (doesn't matter where), run one command in terminal and already can see the result on <code>localhost:3000</code>.</p>\n<p>This way, I have the following structure on my local machine:</p>\n<pre><code>home\n\u2514\u2500\u2500 mark\n    \u2514\u2500\u2500 code\n        \u251c\u2500\u2500 php\n        \u2502\u00a0  \u2514\u2500\u2500 my_php_app\n        \u2514\u2500\u2500 ruby\n            \u2514\u2500\u2500 my_ruby_app\n</code></pre>\n<p>They all are synced via git. Then, when I want to deploy on my remote machine, I just pull them into <code>/var/www/</code> and set up Apache2/Nginx</p>\n<p><strong>But how do I do this with Go apps?</strong> I installed Go both on my Linux machine at home, and on my VPS. When I open <code>~/code/go/mygoapp</code> and try to run it with <code>revel run</code>, it says that it's not found in <code>GOPATH</code>. So, I assume, I need to keep all my Go projects separately from my other projects, in <code>GOPATH</code>, which could be <code>/usr/local/go/src/</code> or <code>~/gocode/src/</code>.</p>\n<h3>Questions are:</h3>\n<ol>\n<li><p>What should I do, if I want to keep all my Go/Revel projects in <code>go</code> folder along with <code>php</code> and <code>ruby</code> on local machine like that:</p>\n<pre><code>home\n\u2514\u2500\u2500 mark\n    \u2514\u2500\u2500 code\n        \u251c\u2500\u2500 go\n        \u2502   \u2514\u2500\u2500 my_revel_app\n        \u251c\u2500\u2500 php\n        \u2502   \u2514\u2500\u2500 my_php_app\n        \u2514\u2500\u2500 ruby\n            \u2514\u2500\u2500 my_ruby_app\n</code></pre>\n</li>\n<li><p>And how do I actually deploy them on my remote server the correct way?</p>\n</li>\n<li><p>If I still need to use GOPATH for that, how do I name the packages? Is it <code>GOPATH/src/mygoapp</code>, <code>GOPATH/src/mark/mygoapp</code> or <code>GOPATH/src/bitbucket.org/mark/mygoapp</code> (while this repo is private)?</p>\n</li>\n</ol>\n<p>I know, this could be a noob question, but I don't see a logic here. Even with simple Go programs, I don't need to put them to GOPATH in order to run.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 2571, "user_id": 2149974, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffb21c41d027acd90bb86547189a7da7?s=128&d=identicon&r=PG", "display_name": "marcadian", "link": "https://stackoverflow.com/users/2149974/marcadian"}, "edited": false, "score": 0, "creation_date": 1450308774, "post_id": 34316147, "comment_id": 56390061, "body": "I don&#39;t think it&#39;s possible since the socket that you instantiate will be runtime specific. Why do you want to do this?"}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": true, "score": 0, "last_activity_date": 1450319266, "creation_date": 1450319266, "answer_id": 34325617, "question_id": 34316147, "link": "https://stackoverflow.com/questions/34316147/how-can-i-pass-a-socket-between-instances-on-app-engine-using-the-go-runtime/34325617#34325617", "title": "How can I pass a socket between instances on App Engine using the Go runtime?", "body": "<p>The descriptor isn't exposed in the Go API: <a href=\"https://github.com/golang/appengine/blob/master/socket/socket_classic.go#L152\" rel=\"nofollow\">https://github.com/golang/appengine/blob/master/socket/socket_classic.go#L152</a></p>\n\n<pre><code>type Conn struct {\n    ctx    context.Context\n    desc   string\n    offset int64\n\n    prot          pb.CreateSocketRequest_SocketProtocol\n    local, remote *pb.AddressPort\n\n    readDeadline, writeDeadline time.Time // optional\n}\n</code></pre>\n\n<p><code>desc</code> is what you would need on the other side to reconstruct the socket. </p>\n\n<p>It should be possible fork this library on GitHub, change the conn struct to expose the needed <code>desc</code> property, and then change the import to <code>github.com/YOURUSERNAME/appengine/socket</code> instead of <code>appengine/socket</code>. </p>\n\n<p>It's a lot of work so if you can come up with a different way to solve this you're probably better off. Nevertheless it should be possible.</p>\n"}], "owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "accepted_answer_id": 34325617, "answer_count": 1, "score": 0, "last_activity_date": 1450319266, "creation_date": 1450280411, "question_id": 34316147, "link": "https://stackoverflow.com/questions/34316147/how-can-i-pass-a-socket-between-instances-on-app-engine-using-the-go-runtime", "title": "How can I pass a socket between instances on App Engine using the Go runtime?", "body": "<p>The Python runtime allows it by <a href=\"https://cloud.google.com/appengine/docs/python/sockets/\" rel=\"nofollow\">pickling the connection</a>. Is there a similar way to share sockets using the Go runtime on classic App Engine with <code>google.golang.org/appengine/socket</code>?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 39, "last_activity_date": 1450277730, "creation_date": 1450277730, "answer_id": 34315203, "question_id": 34314975, "link": "https://stackoverflow.com/questions/34314975/go-get-path-parameters-from-http-request/34315203#34315203", "title": "Go: Get path parameters from http.Request", "body": "<p>If you don't want to use any of the multitude of the available routing packages, then you need to parse the path yourself:</p>\n\n<p>Route the /provisions path to your handler</p>\n\n<pre><code>http.HandleFunc(\"/provisions/\", Provisions)\n</code></pre>\n\n<p>Then split up the path as needed in the handler</p>\n\n<pre><code>id := strings.TrimPrefix(req.URL.Path, \"/provisions/\")\n// or use strings.Split, or use regexp, etc.\n</code></pre>\n"}], "owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21935, "favorite_count": 5, "accepted_answer_id": 34315203, "answer_count": 1, "score": 27, "last_activity_date": 1608011051, "creation_date": 1450277119, "question_id": 34314975, "link": "https://stackoverflow.com/questions/34314975/go-get-path-parameters-from-http-request", "title": "Go: Get path parameters from http.Request", "body": "<p>I'm developing a REST API with Go, but I don't know how can I do the path mappings and retrieve the path parameters from them.</p>\n\n<p>I want something like this:</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/provisions/:id\", Provisions) //&lt;-- How can I map \"id\" parameter in the path?\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc Provisions(w http.ResponseWriter, r *http.Request) {\n    //I want to retrieve here \"id\" parameter from request\n}\n</code></pre>\n\n<p>I would like to use just <code>http</code> package instead of web frameworks, if it is possible.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1450279141, "post_id": 34314961, "comment_id": 56373025, "body": "I understand from that other question that the Java aerospike client tries to create a new thread and that is not allowed on appengine. I don&#39;t know if that is the case with the go client too, but have you tried connecting from a local go deployment to see if this is an app engine limitation? If that is the case, you can try using a go managed vm. Managed vms are similar to app engine but without its limitations."}, {"owner": {"reputation": 2613, "user_id": 1305989, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c6dc5f37a2bbdec9b9ff24dfdc6f0035?s=128&d=identicon&r=PG", "display_name": "user1305989", "link": "https://stackoverflow.com/users/1305989/user1305989"}, "reply_to_user": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1450279518, "post_id": 34314961, "comment_id": 56373296, "body": "I tried with aerospike on digital ocean and it worked on local deployment."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1450280036, "post_id": 34314961, "comment_id": 56373659, "body": "In GAE you can&#39;t do normal http action  you need to use. Urlfetch."}, {"owner": {"reputation": 2613, "user_id": 1305989, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c6dc5f37a2bbdec9b9ff24dfdc6f0035?s=128&d=identicon&r=PG", "display_name": "user1305989", "link": "https://stackoverflow.com/users/1305989/user1305989"}, "reply_to_user": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1450280524, "post_id": 34314961, "comment_id": 56374032, "body": "@MIkCode Are you saying that NewClient provided by aerospike-client-go doesnt work for GAE without modifications ? Because I dont know what aerospike-client-go( a library) is using behind NewClient. I will check it."}, {"owner": {"reputation": 2656, "user_id": 3512898, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/2fA9V.jpg?s=128&g=1", "display_name": "Manuel Arwed Schmidt", "link": "https://stackoverflow.com/users/3512898/manuel-arwed-schmidt"}, "edited": false, "score": 0, "creation_date": 1450282188, "post_id": 34314961, "comment_id": 56375382, "body": "You can&#39;t connect from GAE to an GCE Aerospike Server. What the answer on the other question says it that you create a small instace at GCE that takes HTTP requests from your GAE app, connects to AS (GCE to GCE) and then serve the response."}, {"owner": {"reputation": 152, "user_id": 5660064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q0D4N3-5iEE/AAAAAAAAAAI/AAAAAAAALB4/Lv6t4v1ANRg/photo.jpg?sz=128", "display_name": "Todd McLeod", "link": "https://stackoverflow.com/users/5660064/todd-mcleod"}, "edited": false, "score": 0, "creation_date": 1450285899, "post_id": 34314961, "comment_id": 56388852, "body": "We used Aerospike towards the end of my CSU Fresno adv. web programming class: Check out the last couple of videos in <a href=\"https://www.youtube.com/playlist?list=PLSak_q1UXfPp2VwUQ4ZdUVJdMO6pfi5v_\" rel=\"nofollow noreferrer\">this playlist</a>. Then check out the <a href=\"https://github.com/GoesToEleven/GolangTraining/\" rel=\"nofollow noreferrer\">code samples at this repo</a>."}], "owner": {"reputation": 2613, "user_id": 1305989, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c6dc5f37a2bbdec9b9ff24dfdc6f0035?s=128&d=identicon&r=PG", "display_name": "user1305989", "link": "https://stackoverflow.com/users/1305989/user1305989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 89, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1450285899, "creation_date": 1450277096, "last_edit_date": 1495541044, "question_id": 34314961, "link": "https://stackoverflow.com/questions/34314961/connecting-to-aerospike-dbfrom-google-cloud-using-golang-in-google-app-engine", "title": "Connecting to Aerospike DB(from google cloud) using Golang in Google App Engine", "body": "<p>I installed Aerospike using oneclick installer from google cloud.</p>\n\n<p>I am trying to connect to aerospike from Golang(gin gonic) using aerospike-client-go like this:</p>\n\n<pre><code>    client, err := NewClient(\"ip\", 3000) #I tried all three types of\n    #urls localhost, internal ip, external ip but nothing worked.\n</code></pre>\n\n<p>I read in another <a href=\"https://stackoverflow.com/questions/27465052/google-app-engine-fails-to-connect-aerospike-installed-on-google-compute-engine\">SO question</a> that we should connect to GCE rather than aerospike. I didnt understand. If that is the answer, can you please tell me how ?</p>\n"}, {"tags": ["function", "struct", "go"], "answers": [{"comments": [{"owner": {"reputation": 2337, "user_id": 1192134, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/425e8d7681582a05884d498eb9fec507?s=128&d=identicon&r=PG", "display_name": "Roy van Zanten", "link": "https://stackoverflow.com/users/1192134/roy-van-zanten"}, "edited": false, "score": 0, "creation_date": 1450276365, "post_id": 34314612, "comment_id": 56370966, "body": "I would like to fit the data directly from the db into the regarding struct. Thats where Structscan is for right? So, you say its not possible to fill a unknown struct?"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 2337, "user_id": 1192134, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/425e8d7681582a05884d498eb9fec507?s=128&d=identicon&r=PG", "display_name": "Roy van Zanten", "link": "https://stackoverflow.com/users/1192134/roy-van-zanten"}, "edited": false, "score": 0, "creation_date": 1450276578, "post_id": 34314612, "comment_id": 56371125, "body": "@RoyvanZanten How can sqlx figure what struct the query results match? A row from the query result looks like <code>name=bla</code> whether you inserted <code>A{Name: &quot;bla&quot;}</code> or <code>B{Name: &quot;bla&quot;}</code>"}, {"owner": {"reputation": 2337, "user_id": 1192134, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/425e8d7681582a05884d498eb9fec507?s=128&d=identicon&r=PG", "display_name": "Roy van Zanten", "link": "https://stackoverflow.com/users/1192134/roy-van-zanten"}, "edited": false, "score": 0, "creation_date": 1450277087, "post_id": 34314612, "comment_id": 56371542, "body": "No sqlx cant figure it out, but i can give the right struct to the test function."}], "tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": false, "score": 0, "last_activity_date": 1450276367, "last_edit_date": 1450276367, "creation_date": 1450276145, "answer_id": 34314612, "question_id": 34314429, "link": "https://stackoverflow.com/questions/34314429/structscan-unknown-struct-slice-go/34314612#34314612", "title": "StructScan unknown struct slice [GO]", "body": "<p>If you have no idea what the destination struct type is, use <code>sqlx.MapScan</code> or <code>sqlx.SliceScan</code>. They don't map to a struct, but both return all the columns from the query result.</p>\n\n<p>See <a href=\"http://jmoiron.github.io/sqlx/#altScanning\" rel=\"nofollow\">http://jmoiron.github.io/sqlx/#altScanning</a></p>\n"}, {"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": false, "score": 1, "last_activity_date": 1484686600, "creation_date": 1484686600, "answer_id": 41706841, "question_id": 34314429, "link": "https://stackoverflow.com/questions/34314429/structscan-unknown-struct-slice-go/41706841#41706841", "title": "StructScan unknown struct slice [GO]", "body": "<p>Super late to the party, but ran into this question while researching another issue.  For others that stumble upon it, the problem is that you're passing a pointer to <code>dataStruct</code> into <code>StructScan()</code>.  <code>dataStruct</code> is an interface, and pointers to interfaces are almost always an error in Go (in fact, they removed the automatic dereferencing of interface pointers a few versions back).  You're also passing in your destination by value.</p>\n\n<p>So, you are passing a pointer to an interface that holds a copy of your destination slice, when what you want instead is to pass the interface directly, and that interface to hold a pointer to your destination slice.</p>\n\n<p>Instead of:</p>\n\n<pre><code>test(testA, \"StructA\")\ntest(testB, \"StructB\")\n// ...\nerr := sqlx.StructScan(rows, &amp;dataStruct)\n</code></pre>\n\n<p>Use: </p>\n\n<pre><code>test(&amp;testA, \"StructA\")\ntest(&amp;testB, \"StructB\")\n// ...\nerr := sqlx.StructScan(rows, dataStruct)\n</code></pre>\n"}], "owner": {"reputation": 2337, "user_id": 1192134, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/425e8d7681582a05884d498eb9fec507?s=128&d=identicon&r=PG", "display_name": "Roy van Zanten", "link": "https://stackoverflow.com/users/1192134/roy-van-zanten"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3147, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1484686600, "creation_date": 1450275652, "last_edit_date": 1450278501, "question_id": 34314429, "link": "https://stackoverflow.com/questions/34314429/structscan-unknown-struct-slice-go", "title": "StructScan unknown struct slice [GO]", "body": "<p>So I would like to fill any struct via the <code>StructScan</code> method and so read any data I get from the db into the regarding struct I feed the test function.</p>\n\n<p>This script doesn't give any compile error (if you implement the other stuff like a db connection and so on) but still the <code>StructScan</code> method returns an error and tells me that it expects a slice of structs.</p>\n\n<p>How do I create a slice of structs that I don't know the type of?</p>\n\n<p>Thanks for any advice.</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n\n    \"github.com/jmoiron/sqlx\"\n)\n\nvar db *sql.DB\n\ntype A struct {\n    Name string `db:\"name\"`\n}\ntype B struct {\n    Name string `db:\"name\"\n}\n\nfunc main() {\n\n    testA := []A{}\n    testB := []B{}\n\n    test(testA, \"StructA\")\n    test(testB, \"StructB\")\n}\n\nfunc test(dataStruct interface{}, name string) {\n\n    rows, err := db.Query(\"SELECT * FROM table WHERE name =\", name)\n\n    if err != nil {\n        panic(err)\n    }\n\n    for rows.Next() {\n        err := sqlx.StructScan(rows, &amp;dataStruct)\n        if err != nil {\n            panic(err)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1450272644, "post_id": 34312615, "comment_id": 56368255, "body": "Related: <a href=\"http://stackoverflow.com/questions/32738188/go-how-can-i-start-the-browser-after-the-server-started-listening\">Go: How can I start the browser AFTER the server started listening?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": false, "score": 9, "last_activity_date": 1505305966, "last_edit_date": 1505305966, "creation_date": 1450271116, "answer_id": 34312873, "question_id": 34312615, "link": "https://stackoverflow.com/questions/34312615/log-when-server-is-started/34312873#34312873", "title": "Log when server is started", "body": "<p>You can't print a log message after <code>ListenAndServe</code> since it blocks and never returns, so basically you have two main options:</p>\n\n<ol>\n<li><p>Print \"Starting server on port....\" and that's it - BUT if <code>ListenAndServe</code> could not start it returns an error, so unless there's some error or panic printed because of that, you can assume the server started.</p></li>\n<li><p>Call <code>ListenAndServe</code> in a separate goroutine, and make sure there was no error returned and print \"Server started...\" etc. </p></li>\n</ol>\n\n<p>I personally prefer the first approach.</p>\n"}, {"tags": [], "owner": {"reputation": 9694, "user_id": 797538, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b50394e88b7b1ff30dbca04c06560e5a?s=128&d=identicon&r=PG", "display_name": "lnmx", "link": "https://stackoverflow.com/users/797538/lnmx"}, "is_accepted": true, "score": 16, "last_activity_date": 1450271183, "creation_date": 1450271183, "answer_id": 34312895, "question_id": 34312615, "link": "https://stackoverflow.com/questions/34312615/log-when-server-is-started/34312895#34312895", "title": "Log when server is started", "body": "<p>Use Go's <a href=\"https://golang.org/pkg/log/\" rel=\"noreferrer\">log</a> package:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"log\"\n)\n\nfunc main() {\n    addr := \":8080\"\n    http.HandleFunc(\"/\", MyHandler)\n    log.Println(\"listen on\", addr)\n    log.Fatal( http.ListenAndServe(addr, nil) )\n}\n</code></pre>\n\n<p><a href=\"https://golang.org/pkg/net/http/#ListenAndServe\" rel=\"noreferrer\"><code>http.ListenAndServe</code></a> opens the server port, and blocks forever waiting for clients.  If it fails to open the port, the <code>log.Fatal</code> call will report the problem and exit the program.</p>\n"}, {"tags": [], "owner": {"reputation": 11161, "user_id": 1908967, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/vPwiV.jpg?s=128&g=1", "display_name": "Grokify", "link": "https://stackoverflow.com/users/1908967/grokify"}, "is_accepted": false, "score": 7, "last_activity_date": 1515954492, "last_edit_date": 1515954492, "creation_date": 1515938691, "answer_id": 48250354, "question_id": 34312615, "link": "https://stackoverflow.com/questions/34312615/log-when-server-is-started/48250354#48250354", "title": "Log when server is started", "body": "<p>To run <code>ListenAndServe</code> in a goroutine as mentioned by Not_a_Golfer, you can use an unbuffered, blocking channel to run it in a goroutine and also keep the server alive.</p>\n\n<p>The following example creates a channel called <code>done</code> where <code>&lt;-done</code> will keep the server alive as it waits for the goroutine to finish, which it won't in this case. Typically, the goroutine will tell the main function it is finished by executing <code>done &lt;- true</code>.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net/http\"\n)\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Hello World\"))\n}\n\nfunc main() {\n    port := \"8080\"\n\n    http.HandleFunc(\"/\", MyHandler)\n\n    done := make(chan bool)\n    go http.ListenAndServe(\":\"+port, nil)\n    log.Printf(\"Server started at port %v\", port)\n    &lt;-done\n}\n</code></pre>\n\n<p>Here's a larger example that has the server verify it is operational, using <code>Listen</code> and <code>Serve</code> separately. The nice thing about doing it this way is you can capture an incorrect port easily.</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"net\"\n    \"net/http\"\n    \"os\"\n)\n\nfunc MyHandler(w http.ResponseWriter, r *http.Request) {\n    w.Write([]byte(\"Hello World\"))\n}\n\nfunc main() {\n    port := \"8080\"\n\n    http.HandleFunc(\"/\", MyHandler)\n\n    listener, err := net.Listen(\"tcp\", \":\"+port)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    done := make(chan bool)\n    go http.Serve(listener, nil)\n\n    // Log server started\n    log.Printf(\"Server started at port %v\", port)\n\n    // Attempt to connect\n    log.Printf(\"Fetching...\")\n    res, err := http.Get(\"http://\" + listener.Addr().String())\n    log.Printf(\"Received: %v, %v\", res, err)\n    if err != nil {\n        log.Fatal(err)\n    }\n    res.Write(os.Stdout)\n\n    &lt;-done\n}\n</code></pre>\n"}], "owner": {"reputation": 19583, "user_id": 3026283, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/SyT5b.png?s=128&g=1", "display_name": "H&#233;ctor", "link": "https://stackoverflow.com/users/3026283/h%c3%a9ctor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6544, "favorite_count": 2, "accepted_answer_id": 34312895, "answer_count": 3, "score": 13, "last_activity_date": 1554553193, "creation_date": 1450270348, "last_edit_date": 1554553193, "question_id": 34312615, "link": "https://stackoverflow.com/questions/34312615/log-when-server-is-started", "title": "Log when server is started", "body": "<p>Is there any way to print something when the http server starts? For instance <code>\"Server is started at port 8080\"</code></p>\n\n<p>In Node (using Express), it would be like:</p>\n\n<pre><code>app.listen(8080, function() { console.log('Server started at port 8080') });\n</code></pre>\n\n<p>This is my code:</p>\n\n<pre><code>func main() {\n    http.HandleFunc(\"/\", MyHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p>Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "edited": false, "score": 0, "creation_date": 1450271771, "post_id": 34312010, "comment_id": 56367666, "body": "I updated my answer to address your first question too :-)"}], "answers": [{"comments": [{"owner": {"reputation": 345, "user_id": 669718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308b5779b18d31b7b57a1c1e94af396c?s=128&d=identicon&r=PG", "display_name": "nilbot", "link": "https://stackoverflow.com/users/669718/nilbot"}, "edited": false, "score": 0, "creation_date": 1450272220, "post_id": 34312566, "comment_id": 56367976, "body": "Thank you so much. That clarifies plenty. Can you advice what would you do if you were to fulfill <code>nilslice.Equals(nilslice) -&gt; true</code>, not attempting to be somewhat generic and go for concrete implementation everytime?"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 345, "user_id": 669718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308b5779b18d31b7b57a1c1e94af396c?s=128&d=identicon&r=PG", "display_name": "nilbot", "link": "https://stackoverflow.com/users/669718/nilbot"}, "edited": false, "score": 1, "creation_date": 1450272345, "post_id": 34312566, "comment_id": 56368065, "body": "I&#39;d compare both slices by length first. If <code>len(a)==len(b)</code>, they would both be empty or nil slices. If you must know whether the interface argument is nil and not just empty, try casting it back to the slice that it is, then compare. For example, <code>other.(Nullable) == nil</code>."}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 345, "user_id": 669718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308b5779b18d31b7b57a1c1e94af396c?s=128&d=identicon&r=PG", "display_name": "nilbot", "link": "https://stackoverflow.com/users/669718/nilbot"}, "edited": false, "score": 0, "creation_date": 1450272555, "post_id": 34312566, "comment_id": 56368194, "body": "@nilbot You&#39;re digging deep into Go&#39;s type system. If I&#39;m to be honest, I never thought of these issues until you brought them up, so nice digging ;-)"}], "tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": true, "score": 4, "last_activity_date": 1450272229, "last_edit_date": 1495541748, "creation_date": 1450270223, "answer_id": 34312566, "question_id": 34312010, "link": "https://stackoverflow.com/questions/34312010/nil-slice-vs-empty-slice-and-nil-value-comparison/34312566#34312566", "title": "Nil slice vs empty slice and nil value comparison", "body": "<p>First, you don't need a pointer to an interface. An interface is already a pointer. \nSee <a href=\"https://stackoverflow.com/questions/23148812/go-whats-the-meaning-of-interface/23148998#23148998\">Go: What&#39;s the meaning of interface{}?</a></p>\n\n<p>Just change the Equals method to accept a <code>PointerComparable</code> instead of a <code>*PointerComparable</code>. Equals will accept an interface instead of a pointer to an interface, but you can still pass a pointer to a slice/whatever to it.\nSee <a href=\"https://play.golang.org/p/e_Gtq2oAFA\" rel=\"nofollow noreferrer\">https://play.golang.org/p/e_Gtq2oAFA</a></p>\n\n<p>Second, the receiver <code>Nullable</code> isn't an interface, while the argument you pass to Equals is an interface. That would explain why the <code>Nullable</code> receiver stays nil and the <code>Comparable</code> argument isn't nil although it's underlying slice is. The thing is, the <code>Comparable</code> argument is an interface that points to something, so whatever it points to, it won't be nil.</p>\n\n<p>This code explains the problem:</p>\n\n<pre><code>var a interface{}\nfmt.Println(a == nil) // true, the interface doesn't point to anything\nvar someNilSlice []int\nfmt.Println(someNilSlice == nil) // true, just some nil slice\na = someNilSlice\nfmt.Println(a == nil) // false, now the interface does point to something\n</code></pre>\n"}], "owner": {"reputation": 345, "user_id": 669718, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/308b5779b18d31b7b57a1c1e94af396c?s=128&d=identicon&r=PG", "display_name": "nilbot", "link": "https://stackoverflow.com/users/669718/nilbot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1318, "favorite_count": 0, "accepted_answer_id": 34312566, "answer_count": 1, "score": 1, "last_activity_date": 1450272939, "creation_date": 1450268712, "last_edit_date": 1450272939, "question_id": 34312010, "link": "https://stackoverflow.com/questions/34312010/nil-slice-vs-empty-slice-and-nil-value-comparison", "title": "Nil slice vs empty slice and nil value comparison", "body": "<p>I have read some text regarding nil slice vs empty slice. I believe I have some basic understanding of the differences between them.</p>\n\n<p>Summary of my understanding: <code>var instance []Type</code> is nil slice and <code>instance == nil</code> returns <code>true</code>; while <code>instance:=[]Type{}</code> is empty slice and <code>instance != nil</code></p>\n\n<p>However this particular instance still puzzles me.</p>\n\n<p>Please look at the link below for code. My question is the last 2 cases.\n<a href=\"https://play.golang.org/p/udyHoOlSeP\" rel=\"nofollow\">https://play.golang.org/p/udyHoOlSeP</a></p>\n\n<p>Suppose I want to compare two slices, renamed type and interface matching and all. The instance where a receiver can be <code>nil</code>, even though it's not defined as copy by value; while the argument is copied by value, seems to \nbe non-nil as long as the argument is not untyped.</p>\n\n<p>In the last 2 cases, receiver has been identified as <code>nil</code> while argument is being processed by <code>:=</code> so it becomes an empty slice. (But the <code>other == nil</code> also reports false...) How can I fix this to satisfy the following requirement? </p>\n\n<p><code>nilslice.Equals(nilslice) // -&gt; true\n</code></p>\n\n<hr>\n\n<p>Further, I tried to define another interface comparing to pointers of interface but failed. Compiler complains that </p>\n\n<p><code>cannot use p (type *AnotherNullable) as type *PointerComparable in argument to AnotherNullable(nil).Equals:\n    *PointerComparable is pointer to interface, not interface</code>\n<a href=\"https://play.golang.org/p/wYO1GKcBds\" rel=\"nofollow\">https://play.golang.org/p/wYO1GKcBds</a></p>\n\n<p>How can I fix that?</p>\n\n<p>EDIT: Thanks to @zippoxer for all the insights. I learned a lot. I hope new readers too, please don't forget to check out @zippoxer's comment in the answer too!</p>\n"}, {"tags": ["go", "toml"], "comments": [{"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 0, "creation_date": 1450256901, "post_id": 34307488, "comment_id": 56357239, "body": "did you try something ? Show us dome Code :)"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1450256904, "post_id": 34307488, "comment_id": 56357245, "body": "<a href=\"https://godoc.org/?q=toml\" rel=\"nofollow noreferrer\">godoc.org/?q=toml</a>"}, {"owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 0, "creation_date": 1450262231, "post_id": 34307488, "comment_id": 56360935, "body": "I&#39;m so sorry. There was a shortage of explanation."}], "answers": [{"comments": [{"owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 0, "creation_date": 1450262637, "post_id": 34308622, "comment_id": 56361222, "body": "Thanks for good advises! I&#39;ll try that and then feedback you!"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 1, "creation_date": 1450267660, "post_id": 34308622, "comment_id": 56364699, "body": "@Harry I fixed the example, it didn&#39;t run well, and as far as I can see, BurnSushi/toml doesn&#39;t support dots in the category, like your question shows. If you must have those dots, try another library like <a href=\"https://github.com/pelletier/go-toml\" rel=\"nofollow noreferrer\">github.com/pelletier/go-toml</a>"}, {"owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 1, "creation_date": 1450360011, "post_id": 34308622, "comment_id": 56413563, "body": "It was salved for your help!! I feedback my code when I&#39;m free.  Thanks a lot!"}, {"owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "reply_to_user": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "edited": false, "score": 0, "creation_date": 1450360349, "post_id": 34308622, "comment_id": 56413806, "body": "@Harry Glad I could help, and welcome to Stack Overflow :-). If this answer solved your issue, please mark it as accepted."}], "tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": true, "score": 10, "last_activity_date": 1450267541, "last_edit_date": 1450267541, "creation_date": 1450259205, "answer_id": 34308622, "question_id": 34307488, "link": "https://stackoverflow.com/questions/34307488/go-how-to-use-toml-files/34308622#34308622", "title": "(Go) How to use toml files?", "body": "<p>First get BurntSushi's toml parser:</p>\n\n<p><code>go get github.com/BurntSushi/toml</code></p>\n\n<p>BurntSushi parses toml and maps it to structs, which is what you want.</p>\n\n<p>Then execute the following example and learn from it:</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/BurntSushi/toml\"\n    \"log\"\n)\n\nvar tomlData = `title = \"config\"\n[feature1]\nenable = true\nuserids = [\n  \"12345\", \"67890\"\n]\n\n[feature2]\nenable = false`\n\ntype feature1 struct {\n    Enable  bool\n    Userids []string\n}\n\ntype feature2 struct {\n    Enable bool\n}\n\ntype tomlConfig struct {\n    Title string\n    F1    feature1 `toml:\"feature1\"`\n    F2    feature2 `toml:\"feature2\"`\n}\n\nfunc main() {\n    var conf tomlConfig\n    if _, err := toml.Decode(tomlData, &amp;conf); err != nil {\n        log.Fatal(err)\n    }\n    log.Printf(\"title: %s\", conf.Title)\n    log.Printf(\"Feature 1: %#v\", conf.F1)\n    log.Printf(\"Feature 2: %#v\", conf.F2)\n}\n</code></pre>\n\n<p>Notice the <code>tomlData</code> and how it maps to the <code>tomlConfig</code> struct.</p>\n\n<p>See more examples at <a href=\"https://github.com/BurntSushi/toml\" rel=\"noreferrer\">https://github.com/BurntSushi/toml</a></p>\n"}, {"tags": [], "owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "is_accepted": false, "score": 3, "last_activity_date": 1450441735, "last_edit_date": 1450441735, "creation_date": 1450410528, "answer_id": 34348257, "question_id": 34307488, "link": "https://stackoverflow.com/questions/34307488/go-how-to-use-toml-files/34348257#34348257", "title": "(Go) How to use toml files?", "body": "<p>This issue was solved using recommended pkg BurntSushi/toml!!\nI did as below and it's part of code.</p>\n\n<p>[toml example]</p>\n\n<pre><code>[title]\nenable = true\n[title.clientinfo.12345]\ndistance = 30\nsome_id = 6\n</code></pre>\n\n<p>[Golang example]</p>\n\n<pre><code>type TitleClientInfo struct {\n    Distance int    `toml:\"distance\"`\n    SomeId  int     `toml:\"some_id\"`\n}\n\ntype Config struct {\n    Enable     bool     `toml:\"enable\"`\n    ClientInfo map[string]TitleClientInfo `toml:\"clientinfo\"`\n}\n\nvar config Config\n_, err := toml.Decode(string(d), &amp;config)\n</code></pre>\n\n<p>And then, it can be used as I expected.</p>\n\n<pre><code>config.ClientInfo[12345].Distance\n</code></pre>\n\n<p>Thanks!</p>\n"}, {"comments": [{"owner": {"reputation": 159, "user_id": 13383986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3wXK1.png?s=128&g=1", "display_name": "GoForth", "link": "https://stackoverflow.com/users/13383986/goforth"}, "edited": false, "score": 1, "creation_date": 1618954109, "post_id": 58036346, "comment_id": 118758217, "body": "Actually Viper uses pelletier&#39;s library: <a href=\"https://github.com/spf13/viper/blob/master/viper.go#L43\" rel=\"nofollow noreferrer\">github.com/spf13/viper/blob/master/viper.go#L43</a>"}, {"owner": {"reputation": 5629, "user_id": 1032261, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/29efc71ad7d690db932d9cf707bed760?s=128&d=identicon&r=PG&f=1", "display_name": "Sevenate", "link": "https://stackoverflow.com/users/1032261/sevenate"}, "reply_to_user": {"reputation": 159, "user_id": 13383986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3wXK1.png?s=128&g=1", "display_name": "GoForth", "link": "https://stackoverflow.com/users/13383986/goforth"}, "edited": false, "score": 1, "creation_date": 1618960421, "post_id": 58036346, "comment_id": 118759750, "body": "@GoForth that is good to know, thanks! I guess then we can strike viper out from the question :)"}, {"owner": {"reputation": 159, "user_id": 13383986, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/3wXK1.png?s=128&g=1", "display_name": "GoForth", "link": "https://stackoverflow.com/users/13383986/goforth"}, "edited": false, "score": 1, "creation_date": 1618975087, "post_id": 58036346, "comment_id": 118762175, "body": "Sure, I was actually surprised myself when I looked into it.  I still think Viper is cool as it&#39;s an all-in-one solution I just wanted to point that out in case someone is looking only for TOML."}], "tags": [], "owner": {"reputation": 5629, "user_id": 1032261, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/29efc71ad7d690db932d9cf707bed760?s=128&d=identicon&r=PG&f=1", "display_name": "Sevenate", "link": "https://stackoverflow.com/users/1032261/sevenate"}, "is_accepted": false, "score": 4, "last_activity_date": 1618960805, "last_edit_date": 1618960805, "creation_date": 1569025472, "answer_id": 58036346, "question_id": 34307488, "link": "https://stackoverflow.com/questions/34307488/go-how-to-use-toml-files/58036346#58036346", "title": "(Go) How to use toml files?", "body": "<p>A small update for the year 2019 - there is now newer alternative to <a href=\"https://github.com/BurntSushi/toml\" rel=\"nofollow noreferrer\">BurntSushi/toml</a> with a bit richer API to work with <strong>.toml</strong> files:</p>\n<p><a href=\"https://github.com/pelletier/go-toml\" rel=\"nofollow noreferrer\">pelletier/go-toml</a> (and <a href=\"https://godoc.org/github.com/pelletier/go-toml\" rel=\"nofollow noreferrer\">documentation</a>)</p>\n<p>For example having <code>config.toml</code> file (or in memory):</p>\n<pre><code>[postgres]\nuser = &quot;pelletier&quot;\npassword = &quot;mypassword&quot;\n</code></pre>\n<p>apart from regular marshal and unmarshal of the entire thing into predefined structure (which you can see in the accepted answer) with <a href=\"https://github.com/pelletier/go-toml\" rel=\"nofollow noreferrer\">pelletier/go-toml</a> you can also query individual values like this:</p>\n<pre><code>config, err := toml.LoadFile(&quot;config.toml&quot;)\n\nif err != nil {\n    fmt.Println(&quot;Error &quot;, err.Error())\n} else {\n\n    // retrieve data directly\n\n    directUser := config.Get(&quot;postgres.user&quot;).(string)\n    directPassword := config.Get(&quot;postgres.password&quot;).(string)\n    fmt.Println(&quot;User is&quot;, directUser, &quot; and password is&quot;, directPassword)\n\n    // or using an intermediate object\n\n    configTree := config.Get(&quot;postgres&quot;).(*toml.Tree)\n    user := configTree.Get(&quot;user&quot;).(string)\n    password := configTree.Get(&quot;password&quot;).(string)\n    fmt.Println(&quot;User is&quot;, user, &quot; and password is&quot;, password)\n\n    // show where elements are in the file\n\n    fmt.Printf(&quot;User position: %v\\n&quot;, configTree.GetPosition(&quot;user&quot;))\n    fmt.Printf(&quot;Password position: %v\\n&quot;, configTree.GetPosition(&quot;password&quot;))\n\n    // use a query to gather elements without walking the tree\n\n    q, _ := query.Compile(&quot;$..[user,password]&quot;)\n    results := q.Execute(config)\n    for ii, item := range results.Values() {\n        fmt.Println(&quot;Query result %d: %v&quot;, ii, item)\n    }\n}\n</code></pre>\n<p><strong>UPDATE</strong></p>\n<p><s>There is also <a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\">spf13/viper</a> that works with .toml config files (among other supported formats), but it might be a bit overkill in many cases.</s></p>\n<p><strong>UPDATE 2</strong></p>\n<p>Viper is not really an <a href=\"https://github.com/spf13/viper/blob/master/viper.go#L43\" rel=\"nofollow noreferrer\">alternative</a> (credits to <a href=\"https://stackoverflow.com/users/13383986/goforth\">@GoForth</a>).</p>\n"}, {"tags": [], "owner": {"reputation": 1386, "user_id": 1661186, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/A1yBT.png?s=128&g=1", "display_name": "Darlan D.", "link": "https://stackoverflow.com/users/1661186/darlan-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1606479157, "last_edit_date": 1606479157, "creation_date": 1586871598, "answer_id": 61209118, "question_id": 34307488, "link": "https://stackoverflow.com/questions/34307488/go-how-to-use-toml-files/61209118#61209118", "title": "(Go) How to use toml files?", "body": "<p>With solution <em><strong>Viper</strong></em> you can use a configuration file in JSON, TOML, YAML, HCL, INI and others properties formats.</p>\n<p>Create file:</p>\n<pre><code>./config.toml\n</code></pre>\n<p>First import:</p>\n<pre><code>import (config &quot;github.com/spf13/viper&quot;)\n</code></pre>\n<p>Initialize:</p>\n<pre><code>config.SetConfigName(&quot;config&quot;)\nconfig.AddConfigPath(&quot;.&quot;)\nerr := config.ReadInConfig()\nif err != nil {             \n    log.Println(&quot;ERROR&quot;, err.Error())\n}\n</code></pre>\n<p>And get the value:</p>\n<pre><code>config.GetString(&quot;datatitle.12345.prop1&quot;)\nconfig.Get(&quot;datatitle.12345.prop1&quot;).(int32)\n</code></pre>\n<p>Doc.: <a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\">https://github.com/spf13/viper</a></p>\n<p>e.g.: <a href=\"https://repl.it/@DarlanD/Viper-Examples#main.go\" rel=\"nofollow noreferrer\">https://repl.it/@DarlanD/Viper-Examples#main.go</a></p>\n"}, {"tags": [], "owner": {"reputation": 1648, "user_id": 9935654, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-XdoefqMBYAQ/AAAAAAAAAAI/AAAAAAAAIfg/qFXt_RO4q5s/photo.jpg?sz=128", "display_name": "Carson", "link": "https://stackoverflow.com/users/9935654/carson"}, "is_accepted": false, "score": 0, "last_activity_date": 1612895585, "last_edit_date": 1612895585, "creation_date": 1612894076, "answer_id": 66124604, "question_id": 34307488, "link": "https://stackoverflow.com/questions/34307488/go-how-to-use-toml-files/66124604#66124604", "title": "(Go) How to use toml files?", "body": "<p>I am using <a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\">spf13/viper</a></p>\n<h2>3rd packages</h2>\n<div class=\"s-table-container\">\n<table class=\"s-table\">\n<thead>\n<tr>\n<th>Status</th>\n<th>Project</th>\n<th>Starts</th>\n<th>Forks</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Alive</td>\n<td><a href=\"https://github.com/spf13/viper\" rel=\"nofollow noreferrer\">spf13/viper</a></td>\n<td><img src=\"https://img.shields.io/github/stars/spf13/viper?style=social\" alt=\"stars\" /></td>\n<td><img src=\"https://img.shields.io/github/forks/spf13/viper?style=social\" alt=\"stars\" /></td>\n</tr>\n<tr>\n<td>Unmaintained</td>\n<td><a href=\"https://github.com/BurntSushi/toml#this-project-is-unmaintained\" rel=\"nofollow noreferrer\">BurntSushi/toml</a></td>\n<td><img src=\"https://img.shields.io/github/stars/BurntSushi/toml?style=social\" alt=\"stars\" /></td>\n<td><img src=\"https://img.shields.io/github/forks/BurntSushi/toml?style=social\" alt=\"stars\" /></td>\n</tr>\n</tbody>\n</table>\n</div>\n<p>so that is why I choose <code>viper</code></p>\n<h2>usage of viper</h2>\n<p>I tried to use a table to put the code and the contents of the configuration file together, but obviously, the editing did not match the final result, so I put the image up in the hope that it would make it easier for you to compare</p>\n<p><a href=\"https://i.stack.imgur.com/XeMWe.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/XeMWe.png\" alt=\"enter image description here\" /></a></p>\n<hr />\n<pre class=\"lang-golang prettyprint-override\"><code>package main\nimport (\n    &quot;github.com/spf13/viper&quot;\n    &quot;log&quot;\n    &quot;os&quot;\n)\nfunc main() {\n    check := func(err error) {\n        if err != nil {\n            panic(err)\n        }\n    }\n    myConfigPath := &quot;test_config.toml&quot;\n    fh, err := os.OpenFile(myConfigPath, os.O_RDWR, 0666)\n    check(err)\n    viper.SetConfigType(&quot;toml&quot;) // do not ignore\n    err = viper.ReadConfig(fh)\n    check(err)\n\n    // Read\n    log.Printf(&quot;%#v&quot;, viper.GetString(&quot;title&quot;))                 // &quot;my config&quot;\n    log.Printf(&quot;%#v&quot;, viper.GetString(&quot;DataTitle.12345.prop1&quot;)) // &quot;30&quot;\n    log.Printf(&quot;%#v&quot;, viper.GetString(&quot;dataTitle.12345.prop1&quot;)) // &quot;30&quot;  // case-insensitive\n    log.Printf(&quot;%#v&quot;, viper.GetInt(&quot;DataTitle.12345.prop1&quot;))    // 30\n    log.Printf(&quot;%#v&quot;, viper.GetIntSlice(&quot;feature1.userids&quot;))    // []int{456, 789}\n\n    // Write\n    viper.Set(&quot;database&quot;, &quot;newuser&quot;)\n    viper.Set(&quot;owner.name&quot;, &quot;Carson&quot;)\n    viper.Set(&quot;feature1.userids&quot;, []int{111, 222}) // overwrite\n    err = viper.WriteConfigAs(myConfigPath)\n    check(err)\n}\n</code></pre>\n<td>\n<pre><code>title = &quot;my config&quot;\n\n[datatitle]\n\n  [datatitle.12345]\n    prop1 = 30\n\n[feature1]\n  userids = [456,789]\n\n</code></pre>\n</td>\n<td>\n<pre><code>database = &quot;newuser&quot;  # New\ntitle = &quot;my config&quot;\n\n[datatitle]\n\n  [datatitle.12345]\n    prop1 = 30\n\n[feature1]\n  userids = [111,222]  # Update\n\n[owner]  # New\n  name = &quot;Carson&quot;\n\n</code></pre>\n</td>\n\n\n\n\n"}], "owner": {"reputation": 967, "user_id": 5105392, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1019878568022717/picture?type=large", "display_name": "Harry", "link": "https://stackoverflow.com/users/5105392/harry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11992, "favorite_count": 3, "accepted_answer_id": 34308622, "answer_count": 5, "score": 9, "last_activity_date": 1618960805, "creation_date": 1450255847, "last_edit_date": 1460991896, "question_id": 34307488, "link": "https://stackoverflow.com/questions/34307488/go-how-to-use-toml-files", "title": "(Go) How to use toml files?", "body": "<p>As title, I want to know how to use toml files from golang.</p>\n\n<p>Before that, I show my toml examples. Is it right?</p>\n\n<pre><code>[datatitle]\nenable = true\nuserids = [\n    \"12345\", \"67890\"\n]\n    [datatitle.12345]\n    prop1 = 30\n    prop2 = 10\n\n    [datatitle.67890]\n    prop1 = 30\n    prop2 = 10\n</code></pre>\n\n<p>And then, I want to set these data as type of struct.</p>\n\n<p>As a result I want to access child element as below.</p>\n\n<pre><code>datatitle[\"12345\"].prop1\ndatatitle[\"67890\"].prop2\n</code></pre>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1450251093, "post_id": 34303789, "comment_id": 56354067, "body": "check this issue: <a href=\"https://github.com/jinzhu/gorm/issues/658\" rel=\"nofollow noreferrer\">github.com/jinzhu/gorm/issues/658</a>"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 805, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1450252759, "creation_date": 1450239030, "last_edit_date": 1450252759, "question_id": 34303789, "link": "https://stackoverflow.com/questions/34303789/gorm-is-only-preloading-first-result-in-slice", "title": "Gorm is only preloading first result in slice", "body": "<p>Been using <code>gorm</code> and it's fantastic, the only problem is with the nested <code>preloading</code> it only seems to populate the first result, this is my code:</p>\n\n<pre><code>// Shoutbox msg is the db struct\ntype ShoutboxMsg struct {\n    gorm.Model\n    UserID  int `sql:\"index\"`\n    User    User\n    Message string\n}\n\n// User is the User table in the database\ntype User struct {\n    gorm.Model\n    Username     string `sql:\"not null;unique\"`\n    Email        string `sql:\"not null;unique\"`\n    PasswordHash string `sql:\"not null;unique\"`\n    UserLevel    int    `sql:\"not null;default:0\"`\n    Characters   []Characters\n    MainPosts    []ForumMainThreadsPosts\n    ReplyPosts   []ForumMainPostsReplies\n}\n\n// Characters is a table in the database\ntype Characters struct {\n    gorm.Model\n    UserID             int    `sql:\"index\"`\n    CharacterName      string `sql:\"not null;unique\"`\n    CharacterServer    string `sql:\"not null\"`\n    CharacterLevel     int    `sql:\"not null\"`\n    CharacterMain      bool   `sql:\"not null\"`\n    CharacterClass     string `sql:\"not null\"`\n    CharacterPic       string `sql:\"not null\"`\n    CharacterSpec      string `sql:\"not null\"`\n    CharacterCSSClass  string `sql:\"not null\"`\n    CharacterTalentImg string `sql:\"not null\"`\n}\n</code></pre>\n\n<p>then I load it like:</p>\n\n<pre><code>msgs := []ShoutboxMsg{}\ndb.Preload(\"User\").Preload(\"User.Characters\").Find(&amp;msgs)\n</code></pre>\n\n<p>But it only populates the first: </p>\n\n<p><code>msgs[0].User.Characters</code>  </p>\n\n<p>-</p>\n\n<p><code>msgs[1].User.Characters</code>  and up all don't have characters but if I do:</p>\n\n<pre><code>for i, msg := range msgs {\n    characters := []Characters{}\n    db.Model(msg.User).Related(&amp;characters)\n    *(&amp;msgs[i].User.Characters) = characters\n}\n</code></pre>\n\n<p>This seems to work fine but does <code>Preload</code> not populate beyond the first result?</p>\n\n<p>Any information would be great thanks.</p>\n"}, {"tags": ["php", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 7, "creation_date": 1450243092, "post_id": 34301929, "comment_id": 56350808, "body": "All this is explained very well in the Tout of Go <a href=\"http://tour.golang.org/\" rel=\"nofollow noreferrer\">tour.golang.org</a>, especially the &quot;Methods and Interfaces&quot;. Instead of copy-pasting the tour info here or badly rephrasing it, I&#39;d like to recommend you take the Tour."}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1450428927, "post_id": 34301929, "comment_id": 56445068, "body": "Very good link. Thank you."}], "answers": [{"comments": [{"owner": {"reputation": 1739, "user_id": 91449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/279929b6e31ee2eda28479f7829e6bb0?s=128&d=identicon&r=PG", "display_name": "Guildencrantz", "link": "https://stackoverflow.com/users/91449/guildencrantz"}, "edited": false, "score": 1, "creation_date": 1450239525, "post_id": 34302048, "comment_id": 56349740, "body": "Sure, this shows how to do it, but how about explaining what&#39;s going on?  In go you don&#39;t declare that a struct implements an interface, you just implement the interface: In this case the Namer interface applies to any struct which implements a Name() function which returns a string."}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1450242135, "post_id": 34302048, "comment_id": 56350512, "body": "witch is the difference between declaration with <code>var human humanPlayer</code> and <code>human := &amp;humanPlayer{}</code>?"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "reply_to_user": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 1, "creation_date": 1450261205, "post_id": 34302048, "comment_id": 56360181, "body": "@sensorario The former declares a variable of type <code>humanPlayer</code>. The latter declares one of type <code>*humanPlayer</code> and assigns to it <code>&amp;humanPlayer{}</code>."}, {"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1450429014, "post_id": 34302048, "comment_id": 56445125, "body": "Uh, so in <code>var</code> case we pass value, in <code>&amp;</code> case we pass reference? In PHP everything is a reference. Go looks like C: I am talking about pointers. I am falling in love with GO."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 1, "last_activity_date": 1450226090, "creation_date": 1450226090, "answer_id": 34302048, "question_id": 34301929, "link": "https://stackoverflow.com/questions/34301929/golang-create-a-function-that-accept-an-interface-i-came-from-php/34302048#34302048", "title": "GoLang: create a function that accept an interface (I came from PHP)", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Namer interface {\n    Name() string\n}\n\ntype humanPlayer struct {\n    name string\n}\n\nfunc (h *humanPlayer) Name() string {\n    return h.name\n}\n\ntype botPlayer struct {\n    name string\n}\n\nfunc (b *botPlayer) Name() string {\n    return b.name\n}\n\nfunc sayName(n Namer) {\n    fmt.Printf(\"Hello %s\\n\", n.Name())\n}\n\nfunc main() {\n    human := &amp;humanPlayer{\n        name: \"bob\",\n    }\n    bot := &amp;botPlayer{\n        name: \"tom\",\n    }\n    sayName(human)\n    sayName(bot)\n}\n</code></pre>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 34302048, "answer_count": 1, "score": -2, "last_activity_date": 1450226090, "creation_date": 1450225332, "question_id": 34301929, "link": "https://stackoverflow.com/questions/34301929/golang-create-a-function-that-accept-an-interface-i-came-from-php", "title": "GoLang: create a function that accept an interface (I came from PHP)", "body": "<p>In PHP I can create an interface</p>\n\n<pre><code>interface Hello {\n    public function bar();\n}\n</code></pre>\n\n<p>And some classes that implements it</p>\n\n<pre><code>final class Foo implements Hello {\n    public function bar() {\n        // do something\n    }\n}\n\nfinal class Bar implements Hello {\n    public function bar() {\n        // do something\n    }\n}\n</code></pre>\n\n<p>Then, I can also create a NewClass::bar() method that accept the interface.</p>\n\n<pre><code>final class NewClass {\n    public function bar(Hello $hello) {\n        // do something\n    }\n}\n</code></pre>\n\n<p>How can I do the same, in Golang?</p>\n\n<pre><code>type humanPlayer struct {\n    name string\n}\n\ntype botPlayer struct {\n    name string\n}\n</code></pre>\n\n<p>How can I realize same pattern in golang?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 2, "creation_date": 1450225866, "post_id": 34301784, "comment_id": 56346131, "body": "<i>is there a native min function for getting the min duration</i>: No."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1450243147, "post_id": 34301784, "comment_id": 56350829, "body": "math.Min is for floats and their weird NaNs and Infs."}], "answers": [{"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": true, "score": 8, "last_activity_date": 1450227201, "creation_date": 1450227201, "answer_id": 34302215, "question_id": 34301784, "link": "https://stackoverflow.com/questions/34301784/min-for-comparing-time-durations/34302215#34302215", "title": "min for comparing time.Durations?", "body": "<p>There's nothing in the standard library, but it's simple to write yourself.</p>\n\n<pre><code>func minDuration(a, b time.Duration) time.Duration {\n    if a &lt;= b { return a }\n    return b\n}\n</code></pre>\n"}], "owner": {"reputation": 15027, "user_id": 1276460, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a37bb44988e76c03e735ea8d2c13768b?s=128&d=identicon&r=PG", "display_name": "John Hoffman", "link": "https://stackoverflow.com/users/1276460/john-hoffman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1839, "favorite_count": 0, "accepted_answer_id": 34302215, "answer_count": 1, "score": 2, "last_activity_date": 1450227201, "creation_date": 1450224382, "question_id": 34301784, "link": "https://stackoverflow.com/questions/34301784/min-for-comparing-time-durations", "title": "min for comparing time.Durations?", "body": "<p>Comparing 2 time.Duration values in go with <code>math.Min</code> errs :</p>\n\n<pre><code>cannot use someTime (type time.Duration) as type float64 in argument to math.Min\n</code></pre>\n\n<p>I could use an if else statement to get the min duration, but is there a native min function for getting the min duration?</p>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450218252, "post_id": 34300397, "comment_id": 56343153, "body": "A switch is required if you don&#39;t know what type the thing is going to be and want to decide how to handle it at runtime. This is fundamentally unavoidable. That being said, your question confuses me because the thing you want to convert just can&#39;t. The only strings that you can convert to ints are numerical ones like <code>&quot;24&quot;</code> and the familiar methods from C are provided in the package JimB suggested using."}, {"owner": {"reputation": 397, "user_id": 2791236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUsEw.jpg?s=128&g=1", "display_name": "Sune", "link": "https://stackoverflow.com/users/2791236/sune"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450220267, "post_id": 34300397, "comment_id": 56344146, "body": "I updated the question, it is a numerical string, is it possible then?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450220508, "post_id": 34300397, "comment_id": 56344253, "body": "It is. I recommend using <code>strconv</code> rather than <code>reflect</code>. You probably just want to do <code>myInt, err := strconv.ParseInt(param, 10, 64)</code> and then check the error. If the string was not a numerical value, <code>err</code> will be non-nil, if it was then <code>myInt</code> will hold that value. At least if you&#39;re expecting the input to be a numerical string. This isn&#39;t a good approach for handling any input, that will still require a switch statement."}], "answers": [{"comments": [{"owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "edited": false, "score": 0, "creation_date": 1450218213, "post_id": 34300515, "comment_id": 56343135, "body": "This is the right answer. In addition if you want to see what conversions are available take a look at the <code>Convert()</code> function implementation: <code>https:&#47;&#47;golang.org&#47;src&#47;reflect&#47;value.go?s=63892:63928#L2164</code>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 3, "last_activity_date": 1450217941, "creation_date": 1450217941, "answer_id": 34300515, "question_id": 34300397, "link": "https://stackoverflow.com/questions/34300397/go-convert-reflect-value-from-string-to-int/34300515#34300515", "title": "Go convert reflect.Value from string to int", "body": "<p>There are specific rules for <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">type conversion</a>. Strings cannot be converted to numeric values.</p>\n\n<p>Use the <a href=\"https://golang.org/pkg/strconv/\" rel=\"nofollow\"><code>strconv</code></a> package to read a numeric value from a string.</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1511794306, "creation_date": 1511794306, "answer_id": 47513762, "question_id": 34300397, "link": "https://stackoverflow.com/questions/34300397/go-convert-reflect-value-from-string-to-int/47513762#47513762", "title": "Go convert reflect.Value from string to int", "body": "<p>You can use switch in loop through the reflect values which will return the reflect.Value kind() to return the exact type of that value     </p>\n\n<pre><code>v := reflect.ValueOf(s interface{})\nfor t := 0; i &lt; v.NumField(); i++ {\nfmt.Println(v.Field(i)) // it will prints the value at index in interface\nswitch t := v.Kind() {\n    case bool:\n        fmt.Printf(\"boolean %t\\n\", t) // t has type bool\n    case int:\n        fmt.Printf(\"integer %d\\n\", t) // t has type int\n    case *bool:\n        fmt.Printf(\"pointer to boolean %t\\n\", *t) // t has type *bool\n    case *int:\n        fmt.Printf(\"pointer to integer %d\\n\", *t) // t has type *int\n    default:\n        fmt.Printf(\"unexpected type %T\\n\", t) // %T prints whatever type t has\n    }\n}\n</code></pre>\n\n<p>To convert a type in interface to another type first fetch the value of it in a variable and then use type conversions to convert the value</p>\n"}], "owner": {"reputation": 397, "user_id": 2791236, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/NUsEw.jpg?s=128&g=1", "display_name": "Sune", "link": "https://stackoverflow.com/users/2791236/sune"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2144, "favorite_count": 0, "accepted_answer_id": 34300515, "answer_count": 2, "score": -1, "last_activity_date": 1511794306, "creation_date": 1450217526, "last_edit_date": 1450220207, "question_id": 34300397, "link": "https://stackoverflow.com/questions/34300397/go-convert-reflect-value-from-string-to-int", "title": "Go convert reflect.Value from string to int", "body": "<p>I am getting an error like this</p>\n\n<pre><code>reflect.Value.Convert: value of type string cannot be converted to type int\ngoroutine 6\n</code></pre>\n\n<p>When I am running this code</p>\n\n<pre><code>param := \"1\" // type string\nps := fn.In(i) // type int\n\nif !reflect.TypeOf(param).ConvertibleTo(ps) {\n    fmt.Print(\"Could not convert parameter.\\n\") // this is printed\n}\nconvertedParam := reflect.ValueOf(param).Convert(ps)\n</code></pre>\n\n<p>Can I do this in some way without creating a switch/case and multiple lines of code for converting to each type?\nI am just looking for the easiest/best way to do this.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450214425, "post_id": 34299556, "comment_id": 56341093, "body": "I&#39;d keep looking in your build system for rules around this, that&#39;s where it belongs. If you can&#39;t figure out how to do it, you either don&#39;t understand the system well enough or it&#39;s not worth using as a build system."}, {"owner": {"reputation": 1934, "user_id": 3117035, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EtZfm.jpg?s=128&g=1", "display_name": "JVMATL", "link": "https://stackoverflow.com/users/3117035/jvmatl"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450214801, "post_id": 34299556, "comment_id": 56341299, "body": "@evanmcdonnal -- The build system is supposed to use the &#39;right tool&#39; Agreed. The point of the go version build constraint is to make sure we don&#39;t build with the wrong major version. Why would this be any less legitimate a thing to do in the source code than requiring go1.5 vs go1.4 or linux vs darwin in a build tag? OR --  Suppose I want to release this on github and I know that it will crash if run on 1.5.1 - I can&#39;t control everybody else&#39;s build system, but I <i>can</i> make sure the code doesn&#39;t build on 1.5.1 by accident (and consequently nobody wastes my time with bug reports, etc.) :^)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450216287, "post_id": 34299556, "comment_id": 56342070, "body": "The build tags are compiled into the binary, so there no way to dump them out after the fact. You could have a test or <code>init</code> that panics on the wrong <code>runtime.Version()</code>, to make it obvious the binary is broken."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450216836, "post_id": 34299556, "comment_id": 56342377, "body": "sorry too late to edit, that should be &quot;build tags are not compiled into the binary&quot;"}, {"owner": {"reputation": 1934, "user_id": 3117035, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EtZfm.jpg?s=128&g=1", "display_name": "JVMATL", "link": "https://stackoverflow.com/users/3117035/jvmatl"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450217059, "post_id": 34299556, "comment_id": 56342522, "body": "@JimB -- good thought about runtime.Version(); not as good as stopping the compile, but at least automated tests will fail, halting CI from attempting to deploy. Tnx"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450217342, "post_id": 34299556, "comment_id": 56342672, "body": "True, I do see some value in being able to tag the source so that the compiler throws and error telling the user they need a newer version for this project. Particularly in the case of an open source project. Still, that can easily be documented and if you&#39;re cloning and building someone else&#39;s project you should be reading that anyway."}], "answers": [{"tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": true, "score": 1, "last_activity_date": 1450222933, "creation_date": 1450222933, "answer_id": 34301553, "question_id": 34299556, "link": "https://stackoverflow.com/questions/34299556/is-there-a-way-to-make-golang-compilation-fail-if-the-compiler-is-only-a-point-r/34301553#34301553", "title": "Is there a way to make Golang compilation fail if the compiler is only a point-release too old?", "body": "<p>You can use the <code>-ldflags</code> to pass the configured min golang build and check at init() time if the runtime matches the specified version. </p>\n\n<pre><code>package main\n\nimport \"runtime\"\n\n// go run -ldflags \"-X main.minGoVersion=go1.5.1\" main.go\n\n// from http://stackoverflow.com/questions/18409373/how-to-compare-two-version-number-strings-in-golang\nfunc VersionOrdinal(version string) string {\n    // ISO/IEC 14651:2011\n    const maxByte = 1&lt;&lt;8 - 1\n    vo := make([]byte, 0, len(version)+8)\n    j := -1\n    for i := 0; i &lt; len(version); i++ {\n        b := version[i]\n        if '0' &gt; b || b &gt; '9' {\n            vo = append(vo, b)\n            j = -1\n            continue\n        }\n        if j == -1 {\n            vo = append(vo, 0x00)\n            j = len(vo) - 1\n        }\n        if vo[j] == 1 &amp;&amp; vo[j+1] == '0' {\n            vo[j+1] = b\n            continue\n        }\n        if vo[j]+1 &gt; maxByte {\n            panic(\"VersionOrdinal: invalid version\")\n        }\n        vo = append(vo, b)\n        vo[j]++\n    }\n    return string(vo)\n}\n\nvar minGoVersion string\n\nfunc init() {\n    if minGoVersion == \"\" {\n        panic(\"please pass  -ldflags \\\"-X main.minGoVersion=&lt;version string&gt; flag\\\"\")\n    }\n\n    current := VersionOrdinal(runtime.Version())\n    desired := VersionOrdinal(minGoVersion)\n    if current &lt; desired {\n        panic(\"unsupported golang runtime \" + current + \" &lt; \" + desired)\n    }\n}\n\nfunc main() {\n\n}\n</code></pre>\n"}], "owner": {"reputation": 1934, "user_id": 3117035, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/EtZfm.jpg?s=128&g=1", "display_name": "JVMATL", "link": "https://stackoverflow.com/users/3117035/jvmatl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 169, "favorite_count": 0, "accepted_answer_id": 34301553, "answer_count": 1, "score": 2, "last_activity_date": 1450222933, "creation_date": 1450214227, "question_id": 34299556, "link": "https://stackoverflow.com/questions/34299556/is-there-a-way-to-make-golang-compilation-fail-if-the-compiler-is-only-a-point-r", "title": "Is there a way to make Golang compilation fail if the compiler is only a point-release too old?", "body": "<p>Specifically, for our next software release, I want to make sure to catch a bug fix that was released in go 1.5.2; is there a way to make the build fail if our build server tries to build my code using Go 1.5.1 or earlier?</p>\n\n<p>I know about Build Constraints, and I can see how I can add a build constraint of \"go1.5\" to make sure the \"1.5 or greater\" compiler is used, but \"go1.5.2\" doesn't work (it appears that build tags go1.5.1 and go1.5.2 are not defined.)</p>\n\n<p>On a related note, I also can't find a way to dump out the build tags that apply for a build, and yet this seems to be a pretty useful thing to do.</p>\n"}, {"tags": ["go", "tags", "yaml"], "answers": [{"comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1450212848, "post_id": 34299147, "comment_id": 56340192, "body": "Ugh.  Seriously?  Ugh.  Thanks.    That flag parsing is a Go rather than yaml thing, right?"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1450212903, "post_id": 34299147, "comment_id": 56340215, "body": "(the &quot;&quot; to me seem to imply by convention/intuition/whatever that whitespace should not matter there.   Weird that I wrote the maps-of-maps test case without it, and it worked!)"}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1450212974, "post_id": 34299147, "comment_id": 56340260, "body": "Also, the documentation also seems to imply that tags are optional and the default yaml name is the down-cased field name:  &quot;Struct fields are only unmarshalled if they are exported (have an upper case first letter), and are unmarshalled using the field name lowercased as the default key. Custom keys may be defined via the &quot;yaml&quot; name in the field tag: &quot;    Doc bug, perhaps?  Or I guess &quot;present and incorrect format&quot; is different than not-present."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1450213463, "post_id": 34299147, "comment_id": 56340535, "body": "@BadZen: struct tags do work by the convention of the reflect package: <a href=\"http://play.golang.org/p/oOAeeqlQqn\" rel=\"nofollow noreferrer\">play.golang.org/p/oOAeeqlQqn</a>. I&#39;m not sure if your case is supposed to work without tags, but that would be an issue to raise in github."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1450213615, "post_id": 34299147, "comment_id": 56340611, "body": "Yeah, makes sense.   After I thought about it for a moment, the fact that tags don&#39;t /have/ to be a:b (<code>reflect</code> convenience funcs just provide that convention) necessitates no white space.  Or syntactic ambiguity between &quot;a: b&quot; (two tags, not using convention) and &quot;a: b&quot; (one tag, using convention)!  So much for &quot;intuition&quot;."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1450212658, "creation_date": 1450212658, "answer_id": 34299147, "question_id": 34299049, "link": "https://stackoverflow.com/questions/34299049/go-yaml-parser-failing-silently/34299147#34299147", "title": "Go YAML parser failing silently", "body": "<p>You have spaces in your struct tags, so they're being ignored:</p>\n\n<pre><code>type YamlTypeA struct {\n    D string `yaml:\"d\"`\n    E string `yaml:\"e\"`\n}\n\ntype YamlTypeB struct {\n    F string `yaml:\"f\"`\n}\n\ntype YamlTypeC struct {\n    TypeA *YamlTypeA  `yaml:\"a\"`\n    TypeB []YamlTypeB `yaml:\"b\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 752, "favorite_count": 0, "accepted_answer_id": 34299147, "answer_count": 1, "score": 1, "last_activity_date": 1450213730, "creation_date": 1450212299, "last_edit_date": 1450213730, "question_id": 34299049, "link": "https://stackoverflow.com/questions/34299049/go-yaml-parser-failing-silently", "title": "Go YAML parser failing silently", "body": "<p>I'm trying to get simple YAML parsing in go working with <code>gopkg.in/yaml.v2</code>.</p>\n\n<p>From <a href=\"https://godoc.org/gopkg.in/yaml.v2\" rel=\"nofollow\">the documentation</a>:</p>\n\n<blockquote>\n  <p>Maps and pointers (to a struct, string, int, etc) are accepted as\n  out values. If an internal pointer within a struct is not \n        initialized, the yaml package will initialize it if necessary \n        for unmarshalling the provided data. The out parameter must not be nil.</p>\n  \n  <p>The type of the decoded values should be compatible with the \n        respective values in out. If one or more values cannot be decoded \n        due to a type mismatches, decoding continues partially until the \n        end of the YAML content, and a *yaml.TypeError is returned with \n        details for all missed values.</p>\n</blockquote>\n\n<p>Note the important bits here:  \"pointer within struct initialized if nec'y\", and \"yaml.TypeError returned if a value can't be decoded\".</p>\n\n<p>Now:</p>\n\n<p>package main </p>\n\n<pre><code>import (\n    \"fmt\"\n    \"gopkg.in/yaml.v2\"\n)\n\ntype YamlTypeA struct {\n    D string    `yaml: \"d\"`\n    E string    `yaml: \"e\"`\n}\n\ntype YamlTypeB struct {\n    F string    `yaml: \"f\"`\n}\n\ntype YamlTypeC struct {\n    TypeA   *YamlTypeA      `yaml: \"a\"`\n    TypeB   []YamlTypeB `yaml: \"b\"`\n}\n\nfunc main() {\n    var yamlObj YamlTypeC\n\n    text := []byte(`\n---\na:  \n   d: foo \n   e: bar\nb: [{f: \"fails\"},\n    {f: \"completely\"}]\n`)\n\n    err := yaml.Unmarshal(text,&amp;yamlObj)\n    if err != nil {\n        fmt.Println(err.Error())\n        return\n    }\n    fmt.Println(\"OK\")\n    fmt.Printf(\"TypeA.D: %s\\n\", yamlObj.TypeA.D)\n    fmt.Printf(\"I have %d TypeB\\n\", len(yamlObj.TypeB))\n}\n</code></pre>\n\n<p>yields </p>\n\n<pre><code> OK\n panic: runtime error: invalid memory address or nil pointer dereference\n [signal 0xb code=0x1 addr=0x0 pc=0x4014b3]\n</code></pre>\n\n<p>which appears to violate the promises made in the documentation jointly.  If I make the nested YamlTypeA immediate instead of a pointer, the result is that the output value is not touched, still no error:</p>\n\n<pre><code> OK\n TypeA.D: \n I have 0 TypeB\n</code></pre>\n\n<p>What gives here?   Is it just broken / poorly documented?  How can you get nested struct values to parse out of YAML?  (Using maps of maps is cumbersome and not at all a solution here.)</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1420, "user_id": 777604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be921b859fe5b09428539cfea07d8577?s=128&d=identicon&r=PG", "display_name": "dvd", "link": "https://stackoverflow.com/users/777604/dvd"}, "edited": false, "score": 0, "creation_date": 1450225160, "post_id": 34297159, "comment_id": 56345905, "body": "I&#39;m passing the <code>multipart.File</code> around with struct and by definition the GC will not clear at end of request, right?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1420, "user_id": 777604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be921b859fe5b09428539cfea07d8577?s=128&d=identicon&r=PG", "display_name": "dvd", "link": "https://stackoverflow.com/users/777604/dvd"}, "edited": false, "score": 0, "creation_date": 1450279430, "post_id": 34297159, "comment_id": 56373232, "body": "@dvd: If you have a reference to the multipart.File, then it can&#39;t be collected. Once there are no more references it&#39;s eligible for collection. That&#39;s the point of garbage collection"}, {"owner": {"reputation": 1420, "user_id": 777604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be921b859fe5b09428539cfea07d8577?s=128&d=identicon&r=PG", "display_name": "dvd", "link": "https://stackoverflow.com/users/777604/dvd"}, "edited": false, "score": 0, "creation_date": 1534877876, "post_id": 34297159, "comment_id": 90860648, "body": "Remember to <code>Close()</code> any file before calling <code>RemoveAll()</code> or files will keep floating at your temp directory."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1450206766, "last_edit_date": 1450206766, "creation_date": 1450205583, "answer_id": 34297159, "question_id": 34296996, "link": "https://stackoverflow.com/questions/34296996/how-to-release-memory-or-remove-temp-files-created-by-http-parsemultipartform/34297159#34297159", "title": "How to release memory or remove temp files created by http.ParseMultipartForm?", "body": "<p>Everything is freed after the request is complete. </p>\n\n<p>The memory buffers will be available for garbage collection, and any temporary files will be removed by the call to <code>MultipartForm.RemoveAll()</code> at the end of the request.</p>\n"}], "owner": {"reputation": 1420, "user_id": 777604, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be921b859fe5b09428539cfea07d8577?s=128&d=identicon&r=PG", "display_name": "dvd", "link": "https://stackoverflow.com/users/777604/dvd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1143, "favorite_count": 2, "accepted_answer_id": 34297159, "answer_count": 1, "score": 1, "last_activity_date": 1497748038, "creation_date": 1450204967, "question_id": 34296996, "link": "https://stackoverflow.com/questions/34296996/how-to-release-memory-or-remove-temp-files-created-by-http-parsemultipartform", "title": "How to release memory or remove temp files created by http.ParseMultipartForm?", "body": "<p>I'm using <code>http.ParseMultipartForm</code> to handle file uploads at my webapp.<br>\nDocumentation says:  </p>\n\n<blockquote>\n  <p>ParseMultipartForm parses a request body as multipart/form-data. The whole request body is parsed and up to a total of maxMemory bytes of its file parts are stored in memory, with the remainder stored on disk in temporary files. ParseMultipartForm calls ParseForm if necessary. After one call to ParseMultipartForm, subsequent calls have no effect.</p>\n</blockquote>\n\n<p>When the memory and/or temporary file will be deleted?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-endpoints"], "comments": [{"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "edited": false, "score": 0, "creation_date": 1450203663, "post_id": 34296456, "comment_id": 56334790, "body": "FWIW, I noticed the (python, linux) devserver occasionally goes nuts. Sometimes just stopping and restarting it solves the problem. Other times I have to reboot my machine (other apps act erratically as well, I suspect something on the KDE/X/OS trips, I didn&#39;t spend a lot of time trying to debug it)."}, {"owner": {"reputation": 897, "user_id": 1609153, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/7f27f99d230fd321eafead95ebbf566b?s=128&d=identicon&r=PG", "display_name": "Tom Russell", "link": "https://stackoverflow.com/users/1609153/tom-russell"}, "edited": false, "score": 0, "creation_date": 1496217202, "post_id": 34296456, "comment_id": 75564593, "body": "Scary-looking error. I have very little idea how one would go about tracking down its cause. I suppose there&#39;s a bit of a hint, there, about <code>rosyMethod</code>."}], "answers": [{"tags": [], "owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "is_accepted": true, "score": 1, "last_activity_date": 1450300097, "creation_date": 1450300097, "answer_id": 34322125, "question_id": 34296456, "link": "https://stackoverflow.com/questions/34296456/gae-cloud-endpoints-api-explorer-stopped-working/34322125#34322125", "title": "GAE Cloud Endpoints API Explorer stopped working", "body": "<p>I was passing a map in the response of a service, and it did not like that. Only slices and structs are allowed. </p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 5848359, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/720b3295cb451c555d30e728032c7f2b?s=128&d=identicon&r=PG&f=1", "display_name": "jay.cs", "link": "https://stackoverflow.com/users/5848359/jay-cs"}, "is_accepted": false, "score": 0, "last_activity_date": 1463128385, "creation_date": 1463128385, "answer_id": 37205109, "question_id": 34296456, "link": "https://stackoverflow.com/questions/34296456/gae-cloud-endpoints-api-explorer-stopped-working/37205109#37205109", "title": "GAE Cloud Endpoints API Explorer stopped working", "body": "<p>Name of the api endpoint cannot contain Upper Case letters. Changing the name should resolve the issue.</p>\n"}], "owner": {"reputation": 2178, "user_id": 104104, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e4c9652e58d33f02977db1ef0979e6d1?s=128&d=identicon&r=PG", "display_name": "chila", "link": "https://stackoverflow.com/users/104104/chila"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 421, "favorite_count": 0, "accepted_answer_id": 34322125, "answer_count": 2, "score": 2, "last_activity_date": 1463128385, "creation_date": 1450203089, "last_edit_date": 1450300150, "question_id": 34296456, "link": "https://stackoverflow.com/questions/34296456/gae-cloud-endpoints-api-explorer-stopped-working", "title": "GAE Cloud Endpoints API Explorer stopped working", "body": "<p>Out of the blue, the API explorer (localhost:8080/_ah/api/explorer) stopped working. This is the message 'goapp serve' gives:</p>\n\n<pre><code>WARNING  2015-12-15 17:54:24,744 dispatcher.py:762] Skipping dispatch.yaml rules because /_ah/spi/BackendService.getApiConfigs is not a dispatchable path.\n2015/12/15 17:54:24 DEBUG: SPI request body: {}\nINFO     2015-12-15 17:54:24,746 module.py:787] default: \"POST /_ah/spi/BackendService.getApiConfigs HTTP/1.1\" 200 2619\nERROR    2015-12-15 17:54:25,706 discovery_api_proxy.py:59] Discovery API proxy failed on /_ah/api/discovery/v1/apis/generate/directory with 400.\nRequest: {\"configs\": [\"{\\\"name\\\": \\\"test\\\", \\\"abstract\\\": false, \\\"methods\\\": {\\\"test.load_test_data\\\": {\\\"path\\\": \\\"testData\\\", \\\"response\\\": {\\\"body\\\": \\\"empty\\\"}, \\\"rosyMethod\\\": \\\"TestAPI.LoadTestData\\\", \\\"request\\\": {\\\"body\\\": \\\"empty\\\"}, \\\"httpMethod\\\": \\\"POST\\\"}, \\\"test.test\\\": {\\\"path\\\": \\\"test\\\", \\\"response\\\": {\\\"body\\\": \\\"autoTemplate(backendResponse)\\\", \\\"bodyName\\\": \\\"resource\\\"}, \\\"rosyMethod\\\": \\\"TestAPI.Test\\\", \\\"request\\\": {\\\"body\\\": \\\"empty\\\"}, \\\"httpMethod\\\": \\\"GET\\\"}, \\\"test.showdata4\\\": {\\\"path\\\": \\\"showdata4\\\", \\\"response\\\": {\\\"body\\\": \\\"autoTemplate(backendResponse)\\\", \\\"bodyName\\\": \\\"resource\\\"}, \\\"rosyMethod\\\": \\\"TestAPI.ShowData4\\\", \\\"request\\\": {\\\"body\\\": \\\"autoTemplate(backendRequest)\\\", \\\"bodyName\\\": \\\"resource\\\"}, \\\"httpMethod\\\": \\\"POST\\\"}, \\\"test.showdata\\\": {\\\"path\\\": \\\"showdata\\\", \\\"response\\\": {\\\"body\\\": \\\"autoTemplate(backendResponse)\\\", \\\"bodyName\\\": \\\"resource\\\"}, \\\"rosyMethod\\\": \\\"TestAPI.ShowData\\\", \\\"request\\\": {\\\"body\\\": \\\"empty\\\"}, \\\"httpMethod\\\": \\\"GET\\\"}, \\\"test.showdata3\\\": {\\\"path\\\": \\\"showdata3\\\", \\\"response\\\": {\\\"body\\\": \\\"autoTemplate(backendResponse)\\\", \\\"bodyName\\\": \\\"resource\\\"}, \\\"rosyMethod\\\": \\\"TestAPI.ShowData3\\\", \\\"request\\\": {\\\"body\\\": \\\"empty\\\"}, \\\"httpMethod\\\": \\\"GET\\\"}, \\\"test.showdata2\\\": {\\\"path\\\": \\\"showdata2\\\", \\\"response\\\": {\\\"body\\\": \\\"autoTemplate(backendResponse)\\\", \\\"bodyName\\\": \\\"resource\\\"}, \\\"rosyMethod\\\": \\\"TestAPI.ShowData2\\\", \\\"request\\\": {\\\"body\\\": \\\"empty\\\"}, \\\"httpMethod\\\": \\\"GET\\\"}}, \\\"descriptor\\\": {\\\"methods\\\": {\\\"TestAPI.ShowData2\\\": {\\\"response\\\": {\\\"$ref\\\": \\\"OutputResp\\\"}}, \\\"TestAPI.ShowData3\\\": {\\\"response\\\": {\\\"$ref\\\": \\\"OutputResp\\\"}}, \\\"TestAPI.ShowData4\\\": {\\\"request\\\": {\\\"$ref\\\": \\\"InputReq\\\"}, \\\"response\\\": {\\\"$ref\\\": \\\"OResp\\\"}}, \\\"TestAPI.Test\\\": {\\\"response\\\": {\\\"$ref\\\": \\\"OutputResp\\\"}}, \\\"TestAPI.LoadTestData\\\": {}, \\\"TestAPI.ShowData\\\": {\\\"response\\\": {\\\"$ref\\\": \\\"OutputResp\\\"}}}, \\\"schemas\\\": {\\\"ValueResp\\\": {\\\"type\\\": \\\"object\\\", \\\"id\\\": \\\"ValueResp\\\", \\\"properties\\\": {\\\"attrs\\\": {}, \\\"value\\\": {\\\"type\\\": \\\"string\\\"}}}, \\\"OResp\\\": {\\\"type\\\": \\\"object\\\", \\\"id\\\": \\\"OResp\\\", \\\"properties\\\": {\\\"entries\\\": {\\\"items\\\": {\\\"$ref\\\": \\\"ItemResp\\\"}, \\\"type\\\": \\\"array\\\"}}}, \\\"OutputResp\\\": {\\\"type\\\": \\\"object\\\", \\\"id\\\": \\\"OutputResp\\\", \\\"properties\\\": {\\\"text\\\": {\\\"type\\\": \\\"string\\\"}}}, \\\"InputReq\\\": {\\\"type\\\": \\\"object\\\", \\\"id\\\": \\\"InputReq\\\", \\\"properties\\\": {\\\"text\\\": {\\\"type\\\": \\\"string\\\"}}}, \\\"ItemResp\\\": {\\\"type\\\": \\\"object\\\", \\\"id\\\": \\\"ItemResp\\\", \\\"properties\\\": {\\\"values\\\": {\\\"items\\\": {\\\"$ref\\\": \\\"ValueResp\\\"}, \\\"type\\\": \\\"array\\\"}}}}}, \\\"version\\\": \\\"v1\\\", \\\"extends\\\": \\\"thirdParty.api\\\", \\\"defaultVersion\\\": true, \\\"root\\\": \\\"http://localhost:8082/_ah/api\\\", \\\"adapter\\\": {\\\"bns\\\": \\\"http://localhost:8082/_ah/spi\\\", \\\"type\\\": \\\"lily\\\"}, \\\"description\\\": \\\"test api\\\"}\"]}\nResponse: {\n \"error\": {\n  \"errors\": [\n   {\n    \"domain\": \"global\",\n    \"reason\": \"invalid\",\n    \"message\": \"Invalid Value\"\n   }\n  ],\n  \"code\": 400,\n  \"message\": \"Invalid Value\"\n }\n}\n\nERROR    2015-12-15 17:54:25,706 discovery_service.py:141] Failed to get API directory\nINFO     2015-12-15 17:54:25,706 module.py:787] default: \"GET /_ah/api/discovery/v1/apis HTTP/1.1\" 404 9\n</code></pre>\n\n<p>My app (localhost:8080) does not work either, with the same problem. </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 465, "user_id": 3752877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c009d605492feb57580caf8241b983?s=128&d=identicon&r=PG", "display_name": "femot", "link": "https://stackoverflow.com/users/3752877/femot"}, "edited": false, "score": 0, "creation_date": 1450257307, "post_id": 34295688, "comment_id": 56357514, "body": "Those may all be valid points, but my main problem still is that my PC becomes unresponsive while running."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 465, "user_id": 3752877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c009d605492feb57580caf8241b983?s=128&d=identicon&r=PG", "display_name": "femot", "link": "https://stackoverflow.com/users/3752877/femot"}, "edited": false, "score": 0, "creation_date": 1450276369, "post_id": 34295688, "comment_id": 56370969, "body": "@femot: If your PC becomes unresponsive, that&#39;s something you need to debug on your PC. Are you running the current version of Go? Are you running out of memory? If it&#39;s just your Go app that&#39;s locked up, can you get a stack trace for us?"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1450202219, "last_edit_date": 1450202219, "creation_date": 1450200506, "answer_id": 34295688, "question_id": 34294817, "link": "https://stackoverflow.com/questions/34294817/reading-from-net-udpconn-locks-up-pc/34295688#34295688", "title": "Reading from net.UDPConn locks up PC", "body": "<p>Your server is limited first by the delta channel with a buffer of 100. I'm sure at any significant packet rate that you will be overwhelming that loop. </p>\n\n<p>This isn't a very good benchmark, since your packet rate is going to be a limiting factor more so than bandwidth. You're specifically only trying to test how fast Go can send and receive 1024byte UDP datagrams. </p>\n\n<p>Regardless of how many goroutines you start, the IO is all going through the network poller in a single thread. If you can't saturate your link with a single core, you're going to need multiple process or you need to do this in another language. </p>\n"}], "owner": {"reputation": 465, "user_id": 3752877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64c009d605492feb57580caf8241b983?s=128&d=identicon&r=PG", "display_name": "femot", "link": "https://stackoverflow.com/users/3752877/femot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450202219, "creation_date": 1450197960, "question_id": 34294817, "link": "https://stackoverflow.com/questions/34294817/reading-from-net-udpconn-locks-up-pc", "title": "Reading from net.UDPConn locks up PC", "body": "<p>As a test I wrote  little tool to test the LAN connection between two PCs.\nIt is a client/server model that just sends as many UDP packets as it can and on the other side I read everything I can.<br>\nTo max out my resources, I start a goroutine for every core my machine has.<br>\nSending, receiving and measuring speed works, but when I get to high throughput (500+ Mb/s), the receiving end becomes completely unresponsive.<br>\nIf I throttle the connection, I don't have any problems.<br>\nAlso my CPU maxes out just one core (although i used <code>runtime.GOMAXPROCS(0)</code> and start to receive in <code>runtime.NumCPU</code> goroutines)  </p>\n\n<p><a href=\"https://i.stack.imgur.com/SHCkd.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/SHCkd.png\" alt=\"Maxed out CPU/Core\"></a></p>\n\n<p>I uploaded the code to GitHub over here: <a href=\"https://github.com/femot/lanbench\" rel=\"nofollow noreferrer\">https://github.com/femot/lanbench</a></p>\n\n<p>If I change the client to run locally, the problem does not occur. It only happens, if I start the client from another PC (although the measured speed also tops out at 650 Mb/s)</p>\n"}, {"tags": ["shell", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1450196509, "post_id": 34294151, "comment_id": 56330038, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/876239/how-can-i-redirect-and-append-both-stdout-and-stderr-to-a-file-with-bash\">How can I redirect and append both stdout and stderr to a file with Bash?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": true, "score": 6, "last_activity_date": 1450286546, "last_edit_date": 1450286546, "creation_date": 1450196967, "answer_id": 34294446, "question_id": 34294151, "link": "https://stackoverflow.com/questions/34294151/how-to-save-fmt-print-and-log-print-into-same-file-in-golang/34294446#34294446", "title": "how to save fmt.Print and log.Print into same file in Golang", "body": "<p>The logger writes to STDERR while fmt.PrintXXX functions write to STDOUT. </p>\n\n<p>You have two choices:</p>\n\n<p>1) Capture STDERR to the file.<br>\nBash like shells use:</p>\n\n<pre><code>go run file &gt; output 2&gt;&amp;1\n</code></pre>\n\n<p>2) Set the logger's <a href=\"https://golang.org/pkg/log/#SetOutput\" rel=\"nofollow\">Output</a> to <a href=\"https://golang.org/pkg/os/#pkg-variables\" rel=\"nofollow\">os.Stdout</a></p>\n\n<p>Then you run like normal <code>go run file &gt; output</code> and both the logger and fmt go to the same place.</p>\n\n<pre><code>log.SetOutput(os.StdOut)\n</code></pre>\n"}], "owner": {"reputation": 2446, "user_id": 5682933, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/29d72b97ce20902d21488878741621f3?s=128&d=identicon&r=PG&f=1", "display_name": "Haoyuan Ge", "link": "https://stackoverflow.com/users/5682933/haoyuan-ge"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 669, "favorite_count": 0, "accepted_answer_id": 34294446, "answer_count": 1, "score": 2, "last_activity_date": 1450286546, "creation_date": 1450196182, "last_edit_date": 1450249239, "question_id": 34294151, "link": "https://stackoverflow.com/questions/34294151/how-to-save-fmt-print-and-log-print-into-same-file-in-golang", "title": "how to save fmt.Print and log.Print into same file in Golang", "body": "<p>In shell, I use <code>go run file &gt; output</code>, but only fmt.Print are saved into output. All the log.Print still output to the screen! And after I searched on the Internet, I found I can set ouput directory for log, but how can I save both log and fmt in the same file?</p>\n"}, {"tags": ["file", "go", "transfer"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450195441, "post_id": 34293809, "comment_id": 56329200, "body": "Why not use an existing protocol to transfer the images? You have no way of delimiting the image data, you just copy away until the client closes the connection."}, {"owner": {"reputation": 77, "user_id": 3155635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7njto.jpg?s=128&g=1", "display_name": "Wirsiing", "link": "https://stackoverflow.com/users/3155635/wirsiing"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450195561, "post_id": 34293809, "comment_id": 56329278, "body": "When you say existing you mean protocols like ftp? The idea of the project is to have multiple clients who upload pictures to a webserver, the webserver then arranges these pictures in proper directories and a webpage should then display all of them under a specific url. I do not want these clients to have actual access to the server. They should just be able to use the client program and it uploads them automatically. Thanks for the fast answer btw!"}, {"owner": {"reputation": 1513, "user_id": 3316716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afbe3fa1baa8a749dd66449baeb9a837?s=128&d=identicon&r=PG", "display_name": "Sosdoc", "link": "https://stackoverflow.com/users/3316716/sosdoc"}, "edited": false, "score": 1, "creation_date": 1450195786, "post_id": 34293809, "comment_id": 56329464, "body": "If you send images serially, you also need to send the size of each one before, so you know how many bytes to read. <code>io.Copy</code> will read until EOF, so you should use <code>io.CopyN</code> instead."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1450195818, "post_id": 34293809, "comment_id": 56329486, "body": "Why ftp? HTTP is well understood and would allow to transfer all files in one go."}, {"owner": {"reputation": 77, "user_id": 3155635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7njto.jpg?s=128&g=1", "display_name": "Wirsiing", "link": "https://stackoverflow.com/users/3155635/wirsiing"}, "edited": false, "score": 0, "creation_date": 1450196077, "post_id": 34293809, "comment_id": 56329665, "body": "io.CopyN sounds like the perfect solutions. Could have found that myself I guess ... Will try it and if it works and you submit your solution I will mark it. Thanks guys"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450196434, "post_id": 34293809, "comment_id": 56329966, "body": "If you are running this on a webserver, then you already have a perfectly good wire protocol, with minimal overhead -- HTTP. Just use that."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450196886, "post_id": 34294274, "comment_id": 56330369, "body": "@Wirsiing: just note that this framing protocol that you&#39;ve come up with has no response from the server, so the client has no way to confirm that all the files actually arrived in full."}, {"owner": {"reputation": 1513, "user_id": 3316716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afbe3fa1baa8a749dd66449baeb9a837?s=128&d=identicon&r=PG", "display_name": "Sosdoc", "link": "https://stackoverflow.com/users/3316716/sosdoc"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450197087, "post_id": 34294274, "comment_id": 56330525, "body": "@JimB True, everything would have to be implemented from scratch in this case. Of course, HTTP would save all these headaches but, if nothing else, you have full control of how the data is sent, the overhead and you could optimize transfers differently..."}, {"owner": {"reputation": 77, "user_id": 3155635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7njto.jpg?s=128&g=1", "display_name": "Wirsiing", "link": "https://stackoverflow.com/users/3155635/wirsiing"}, "edited": false, "score": 0, "creation_date": 1450197551, "post_id": 34294274, "comment_id": 56330849, "body": "It is still only working for the first file though. Is copyN actually setting my read pointer  ?"}, {"owner": {"reputation": 1513, "user_id": 3316716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afbe3fa1baa8a749dd66449baeb9a837?s=128&d=identicon&r=PG", "display_name": "Sosdoc", "link": "https://stackoverflow.com/users/3316716/sosdoc"}, "reply_to_user": {"reputation": 77, "user_id": 3155635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7njto.jpg?s=128&g=1", "display_name": "Wirsiing", "link": "https://stackoverflow.com/users/3155635/wirsiing"}, "edited": false, "score": 0, "creation_date": 1450199170, "post_id": 34294274, "comment_id": 56331918, "body": "@Wirsiing it sets the read pointer correctly, you can check it from this <a href=\"https://play.golang.org/p/i5lBIlVYki\" rel=\"nofollow noreferrer\">playground</a>, are you sure you are sending the correct size and not skipping anything?"}, {"owner": {"reputation": 77, "user_id": 3155635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7njto.jpg?s=128&g=1", "display_name": "Wirsiing", "link": "https://stackoverflow.com/users/3155635/wirsiing"}, "edited": false, "score": 0, "creation_date": 1450210018, "post_id": 34294274, "comment_id": 56338605, "body": "I saw the playground but I do not think it is working in my case might because I use the bufio reader. The first transmission is working like a charm but for the second I only get gibberish for the filename and the size after that. I updated my OP with the new code. Any other idea?"}], "tags": [], "owner": {"reputation": 1513, "user_id": 3316716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afbe3fa1baa8a749dd66449baeb9a837?s=128&d=identicon&r=PG", "display_name": "Sosdoc", "link": "https://stackoverflow.com/users/3316716/sosdoc"}, "is_accepted": true, "score": 1, "last_activity_date": 1450196887, "last_edit_date": 1450196887, "creation_date": 1450196536, "answer_id": 34294274, "question_id": 34293809, "link": "https://stackoverflow.com/questions/34293809/how-to-transfer-multiple-files-using-go/34294274#34294274", "title": "How to transfer multiple files using go", "body": "<p>Keeping your implementation so far, the thing you're missing is that <a href=\"https://golang.org/pkg/io/#Copy\" rel=\"nofollow\"><code>io.Copy()</code></a> reads from source until it finds an EOF, so it will read all the remaining images in one go.</p>\n\n<p>Also, the client <strong>must send, for each image, its size in bytes</strong> (you could do that after sending the name).\nIn the server, just read the size and then use <a href=\"https://golang.org/pkg/io/#CopyN\" rel=\"nofollow\"><code>io.CopyN()</code></a> to read that exact number of bytes. </p>\n\n<p><strong>EDIT</strong>: as a matter of fact, you could also do things like you were doing and send images in parallel instead of serially, that would mean you open a new connection for each file transfer and then read all of the file withouth needing to send the amount of images or their size.</p>\n\n<p>In case you want an alternative, a good option would be using good 'ol HTTP and multipart requests. There's the built-in module <a href=\"https://golang.org/pkg/mime/multipart/\" rel=\"nofollow\">mime/multipart</a> that allows you to do file transfers over HTTP. Of course, that would mean you'd have to rewrite your program.</p>\n"}, {"comments": [{"owner": {"reputation": 77, "user_id": 3155635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7njto.jpg?s=128&g=1", "display_name": "Wirsiing", "link": "https://stackoverflow.com/users/3155635/wirsiing"}, "edited": false, "score": 0, "creation_date": 1450222009, "post_id": 34298501, "comment_id": 56344900, "body": "This is so simple and so good. But I will just use io.Copy with a single zip archive which is the easiest solution"}], "tags": [], "owner": {"reputation": 40934, "user_id": 121687, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/359b919642638c5b67555a1bc89dfd3e?s=128&d=identicon&r=PG", "display_name": "fabrizioM", "link": "https://stackoverflow.com/users/121687/fabriziom"}, "is_accepted": false, "score": 0, "last_activity_date": 1450210339, "creation_date": 1450210339, "answer_id": 34298501, "question_id": 34293809, "link": "https://stackoverflow.com/questions/34293809/how-to-transfer-multiple-files-using-go/34298501#34298501", "title": "How to transfer multiple files using go", "body": "<p>My suggestion is to zip all the images you want to transfer and then send them as a single multipart POST request. In that way you have a standard way of knowing all your Acceptance criteria.</p>\n\n<p>You can easily zip multiple files using <code>https://golang.org/pkg/archive/zip/</code></p>\n"}], "owner": {"reputation": 77, "user_id": 3155635, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/7njto.jpg?s=128&g=1", "display_name": "Wirsiing", "link": "https://stackoverflow.com/users/3155635/wirsiing"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1873, "favorite_count": 0, "accepted_answer_id": 34294274, "answer_count": 2, "score": 1, "last_activity_date": 1450269416, "creation_date": 1450195301, "last_edit_date": 1450269416, "question_id": 34293809, "link": "https://stackoverflow.com/questions/34293809/how-to-transfer-multiple-files-using-go", "title": "How to transfer multiple files using go", "body": "<p>I am trying to write a program in go which has two parts. One part is the client who tries to upload multiple pictures to the other part the server. </p>\n\n<p>The server side should do the following:</p>\n\n<ol>\n<li>Get the number of files which will be send</li>\n<li>Loop for every file</li>\n<li>Get filename</li>\n<li>Get the file and save it</li>\n<li>Go to 3</li>\n</ol>\n\n<p>So far the server side is doing the following:</p>\n\n<pre><code>func getFileFromClient(connection net.Conn) {\n    var numberOfPics int\n    var err error\n    var receivedBytes int64\n    var fileName string\n    r := bufio.NewReader(connection)\n    strNumberOfPics, err := r.ReadString('\\n')\n    if err != nil {\n        fmt.Printf(\"Error reading: %s\\n\", err)\n        return\n    }\n    fmt.Printf(\"Read: %s\\n\", strNumberOfPics)\n    strNumberOfPics = strings.Trim(strNumberOfPics, \"\\n\")\n    numberOfPics, err = strconv.Atoi(strNumberOfPics)\n    if err != nil {\n        fmt.Printf(\"Error Atoi: %s\\n\", err)\n        panic(\"Atoi\")\n    }\n    fmt.Printf(\"Receiving %d pics:\\n\", numberOfPics)\n    for i := 0; i &lt; numberOfPics; i++ {\n        // Getting the file name:\n        fileName, err = r.ReadString('\\n')\n        if err != nil {\n            fmt.Printf(\"Error receiving: %s\\n\", err)\n        }\n        fmt.Printf(\"Filename: %s\\n\", fileName)\n        fileName = strings.Trim(fileName, \"\\n\")\n        f, err := os.Create(fileName)\n        defer f.Close()\n        if err != nil {\n            fmt.Println(\"Error creating file\")\n        }\n        receivedBytes, err = io.Copy(f, connection)\n        if err != nil {\n            panic(\"Transmission error\")\n        }\n\n        fmt.Printf(\"Transmission finished. Received: %d \\n\", receivedBytes)\n    }\n}\n</code></pre>\n\n<p>io.Copy is working for just one file and nothing additional (because it does not empty the queue I think). I do not want to reconnect every time for every file if I do not have too. But I am not sure what I actually can do about that.</p>\n\n<p>Has anyone any suggestions of an existing package or method which could help? Or  example code? Or am I just plain wrong and it is a bad idea to even try this with go?</p>\n\n<p>I think it might be enough if the server is able to flush the connection buffer after every read so no additional info is read and/or copied.</p>\n\n<p>Really looking forward for help, thanks in advance</p>\n\n<p>EDIT: Updated Code still not working. I think it might be the bufio.reader</p>\n\n<pre><code>func getFileFromClient(connection net.Conn) {\n    var numberOfPics int\n    var err error\n    var receivedBytes int64\n    var fileName string\n    r := bufio.NewReader(connection)\n    strNumberOfPics, err := r.ReadString('\\n')\n    if err != nil {\n        fmt.Printf(\"Error reading: %s\\n\", err)\n        return\n    }\n    strNumberOfPics = strings.Trim(strNumberOfPics, \"\\n\")\n    numberOfPics, err = strconv.Atoi(strNumberOfPics)\n    if err != nil {\n        fmt.Printf(\"Error Atoi: %s\\n\", err)\n        panic(\"Atoi\")\n    }\n    fmt.Printf(\"Receiving %d pics:\\n\", numberOfPics)\n    for i := 0; i &lt; numberOfPics; i++ {\n        // Getting the file name:\n        fileName, err = r.ReadString('\\n')\n        if err != nil {\n            fmt.Printf(\"Error receiving: %s\\n\", err)\n        }\n        fileName = strings.Trim(fileName, \"\\n\")\n        fmt.Printf(\"Filename: %s\\n\", fileName)\n        f, err := os.Create(fileName)\n        defer f.Close()\n        if err != nil {\n            fmt.Println(\"Error creating file\")\n        }\n        // Get the file size\n        strFileSize, err := r.ReadString('\\n')\n        if err != nil {\n            fmt.Printf(\"Read size error %s\\n\", err)\n            panic(\"Read size\")\n        }\n        strFileSize = strings.Trim(strFileSize, \"\\n\")\n        fileSize, err := strconv.Atoi(strFileSize)\n        if err != nil {\n            fmt.Printf(\"Error size Atoi: %s\\n\", err)\n            panic(\"size Atoi\")\n        }\n        fmt.Printf(\"Size of pic: %d\\n\", fileSize)\n\n        receivedBytes, err = io.CopyN(f, connection, int64(fileSize))\n        if err != nil {\n            fmt.Printf(\"Transmission error: %s\\n\", err)\n            panic(\"Transmission error\")\n        }\n        fmt.Printf(\"Transmission finished. Received: %d \\n\", receivedBytes)\n    }\n}\n</code></pre>\n\n<p>EDIT 2: I did not get this solution to work. I am pretty sure it is because  I used bufio. I did however get it to work by transmitting a single zip file with io.copy. Another solution which worked was to transmit a zip file by using http. If you are stuck trying something similar and need help feel free to send me a message. Thanks to all of you for your help</p>\n"}, {"tags": ["arrays", "go", "slice", "prepend"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1450195186, "post_id": 34293572, "comment_id": 56329018, "body": "You should not have a method which takes <code>v ...interface{}</code> as an argument in the first place."}, {"owner": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 2, "creation_date": 1450250708, "post_id": 34293572, "comment_id": 56353865, "body": "This guide may be useful for you. <a href=\"https://github.com/golang/go/wiki/SliceTricks\" rel=\"nofollow noreferrer\">github.com/golang/go/wiki/SliceTricks</a>"}, {"owner": {"reputation": 4804, "user_id": 1269281, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ENmA7.jpg?s=128&g=1", "display_name": "bachr", "link": "https://stackoverflow.com/users/1269281/bachr"}, "reply_to_user": {"reputation": 1775, "user_id": 1241805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e69b9940a6d0998eabedda2452d8e7c?s=128&d=identicon&r=PG", "display_name": "Ezequiel Moreno", "link": "https://stackoverflow.com/users/1241805/ezequiel-moreno"}, "edited": false, "score": 0, "creation_date": 1450258960, "post_id": 34293572, "comment_id": 56358632, "body": "thanks for sharing @EzequielMoreno"}], "answers": [{"comments": [{"owner": {"reputation": 4804, "user_id": 1269281, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ENmA7.jpg?s=128&g=1", "display_name": "bachr", "link": "https://stackoverflow.com/users/1269281/bachr"}, "edited": false, "score": 0, "creation_date": 1450195378, "post_id": 34293641, "comment_id": 56329164, "body": "Ah thanks <code>append([]interface{}{s}, rest...)</code> worked for me"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 32, "last_activity_date": 1474294230, "last_edit_date": 1474294230, "creation_date": 1450194861, "answer_id": 34293641, "question_id": 34293572, "link": "https://stackoverflow.com/questions/34293572/golang-prepend-a-string-to-a-slice-interface/34293641#34293641", "title": "golang prepend a string to a slice ...interface{}", "body": "<p><a href=\"https://golang.org/pkg/builtin/#append\" rel=\"noreferrer\"><code>append()</code></a> can only append values of the type matching the element type of the slice:</p>\n\n<pre><code>func append(slice []Type, elems ...Type) []Type\n</code></pre>\n\n<p>So if you have the elements as <code>[]interface{}</code>, you have to wrap your initial <code>string</code> in a <code>[]interface{}</code> to be able to use <code>append()</code>:</p>\n\n<pre><code>s := \"first\"\nrest := []interface{}{\"second\", 3}\n\nall := append([]interface{}{s}, rest...)\nfmt.Println(all)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/aLFNvj9S-z\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[first second 3]\n</code></pre>\n"}], "owner": {"reputation": 4804, "user_id": 1269281, "user_type": "registered", "accept_rate": 59, "profile_image": "https://i.stack.imgur.com/ENmA7.jpg?s=128&g=1", "display_name": "bachr", "link": "https://stackoverflow.com/users/1269281/bachr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 25722, "favorite_count": 3, "accepted_answer_id": 34293641, "answer_count": 1, "score": 18, "last_activity_date": 1474294230, "creation_date": 1450194692, "last_edit_date": 1450195297, "question_id": 34293572, "link": "https://stackoverflow.com/questions/34293572/golang-prepend-a-string-to-a-slice-interface", "title": "golang prepend a string to a slice ...interface{}", "body": "<p>I've a method that has as an argument <code>v ...interface{}</code>, I need to prepend this slice with a <code>string</code>. Here is the method:</p>\n\n<pre><code>func (l Log) Error(v ...interface{}) {\n  l.Out.Println(append([]string{\" ERROR \"}, v...))\n}\n</code></pre>\n\n<p>When I try with <code>append()</code> it doesn't work:</p>\n\n<pre><code>&gt; append(\"some string\", v)\nfirst argument to append must be slice; have untyped string\n&gt; append([]string{\"some string\"}, v)\ncannot use v (type []interface {}) as type string in append\n</code></pre>\n\n<p>What's the proper way to prepend in this case?</p>\n"}, {"tags": ["heroku", "go", "gdb"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450281859, "post_id": 34292763, "comment_id": 56375117, "body": "What happens when you try to use gdb? How is it different than attaching to your normal process? (Have you used gdb with go, and are you familiar with gdb&#39;s shortcomings when working with go?)"}, {"owner": {"reputation": 4829, "user_id": 2754218, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6e87368666dbd25ad4288859d10fda55?s=128&d=identicon&r=PG", "display_name": "Jean Lebrument", "link": "https://stackoverflow.com/users/2754218/jean-lebrument"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450367186, "post_id": 34292763, "comment_id": 56418514, "body": "Finally I ended up by not using the Heroku local environment anymore. My local configuration shouldn&#39;t depend on this tool. Then, I switched to <code>delve</code> debugger through IntelliJ."}], "owner": {"reputation": 4829, "user_id": 2754218, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/6e87368666dbd25ad4288859d10fda55?s=128&d=identicon&r=PG", "display_name": "Jean Lebrument", "link": "https://stackoverflow.com/users/2754218/jean-lebrument"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 124, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1450192458, "creation_date": 1450192458, "question_id": 34292763, "link": "https://stackoverflow.com/questions/34292763/how-to-run-gdb-when-executing-go-project-using-heroku-local-environment", "title": "How to run GDB when executing go project using Heroku local environment", "body": "<p>I execute my Go program using the following command line: </p>\n\n<p><code>godep go install &amp;&amp; heroku local -e .env_local</code></p>\n\n<p>I wonder how can I use GDB to debug my program when I execute it through Heroku local environment. </p>\n\n<p>Any suggestions? \nThanks!</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450190789, "post_id": 34292012, "comment_id": 56325605, "body": "If the data is already json, and already in a string, what are you trying to marshal or unmarshal?"}, {"owner": {"reputation": 1179, "user_id": 3824957, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HOl0u.png?s=128&g=1", "display_name": "MayK", "link": "https://stackoverflow.com/users/3824957/mayk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450190948, "post_id": 34292012, "comment_id": 56325724, "body": "right now the frontend transforms the json into a string before i receive it in the backend. I want to change that so that the front always sends a json, and in the back i save it as a string in the datastore"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450191136, "post_id": 34292012, "comment_id": 56325865, "body": "Please provide an example of what you&#39;re trying to do. JSON is a string until you unmarshal it, so I don&#39;t understand what you mean by &quot;sends a json&quot;."}, {"owner": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "edited": false, "score": 0, "creation_date": 1450193662, "post_id": 34292012, "comment_id": 56327817, "body": "I don&#39;t think I understand what you are trying to do. But if you are looking for a way of passing native objects around, rather try RPC. It doesn&#39;t make sense to me that one would go through so much trouble transporting a payload that can easily be converted into a string a back effortlessly."}, {"owner": {"reputation": 1179, "user_id": 3824957, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HOl0u.png?s=128&g=1", "display_name": "MayK", "link": "https://stackoverflow.com/users/3824957/mayk"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450197082, "post_id": 34292012, "comment_id": 56330521, "body": "@JimB  I&#39;m not sure that what I&#39;m trying to do is worthless or correct, but i added more detail to my question"}, {"owner": {"reputation": 1179, "user_id": 3824957, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HOl0u.png?s=128&g=1", "display_name": "MayK", "link": "https://stackoverflow.com/users/3824957/mayk"}, "reply_to_user": {"reputation": 2368, "user_id": 789655, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/b7fac771a6c8fccc82fe34f951b7b3fd?s=128&d=identicon&r=PG", "display_name": "Sthe", "link": "https://stackoverflow.com/users/789655/sthe"}, "edited": false, "score": 0, "creation_date": 1450197488, "post_id": 34292012, "comment_id": 56330816, "body": "@Sthe, I&#39;m not sure how to easily convert this back from string to json, because i never know what keys  the user sends.."}], "answers": [{"comments": [{"owner": {"reputation": 1179, "user_id": 3824957, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HOl0u.png?s=128&g=1", "display_name": "MayK", "link": "https://stackoverflow.com/users/3824957/mayk"}, "edited": false, "score": 0, "creation_date": 1450197370, "post_id": 34293219, "comment_id": 56330727, "body": "Thanks @Mbded for your answer although I&#39;m not sure if this is exactly what I need. Because i never know what the received data looks like.."}], "tags": [], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "is_accepted": false, "score": 1, "last_activity_date": 1450193697, "creation_date": 1450193697, "answer_id": 34293219, "question_id": 34292012, "link": "https://stackoverflow.com/questions/34292012/convert-string-to-json-in-golang-and-vice-versa/34293219#34293219", "title": "convert string to json in golang and vice versa?", "body": "<p>I little also don't know what You want to do exacly, but in <strong>go</strong> I know two ways to convert some received data to json. This data should be as <code>[]byte</code> type</p>\n\n<p>first is allow to compiler choice interface and try parsed to JSON in this way:</p>\n\n<pre><code>[]byte(`{\"monster\":[{\"basic\":0,\"fun\":11,\"count\":262}],\"m\":\"18\"}`) \nbufferSingleMap   map[string]interface{}\njson.Unmarshal(buffer , &amp;bufferSingleMap)\n</code></pre>\n\n<p>socond if You know how exacly looks received data You can first define structure</p>\n\n<pre><code>type Datas struct{\n\n    Monster []struct {\n        Basic int     `json:\"basic\"`\n        Fun int       `json:\"fun\"`\n        Count int     `json:\"count\"`\n    }                 `json:\"Monster\"`\n    M int             `json:\"m\"`\n}\n\nDatas datas;\njson.Unmarshal(buffer , &amp;datas)\n</code></pre>\n\n<p>Imporant is name value. Should be writed with a capital letter (Fun, Count) This is a sign for Unmarshal that should be json.\nIf You still don't can parsed to JSON show us Your received data, may be they have a bad syntax</p>\n"}, {"tags": [], "owner": {"reputation": 1513, "user_id": 3316716, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afbe3fa1baa8a749dd66449baeb9a837?s=128&d=identicon&r=PG", "display_name": "Sosdoc", "link": "https://stackoverflow.com/users/3316716/sosdoc"}, "is_accepted": false, "score": 5, "last_activity_date": 1450198476, "creation_date": 1450198476, "answer_id": 34295001, "question_id": 34292012, "link": "https://stackoverflow.com/questions/34292012/convert-string-to-json-in-golang-and-vice-versa/34295001#34295001", "title": "convert string to json in golang and vice versa?", "body": "<p>If you have no structured data and you really need to send a full JSON, then you can read it like this:</p>\n\n<pre><code>// an arbitrary json string\njsonString := \"{\\\"foo\\\":{\\\"baz\\\": [1,2,3]}}\"\n\nvar jsonMap map[string]interface{}\njson.Unmarshal([]byte(jsonString ), &amp;jsonMap)\n\nfmt.Println(jsonMap)    \n// prints: map[foo:map[baz:[1 2 3]]]\n</code></pre>\n\n<p>Of course, this has a big disadvantage, in that you don't know what is the content of each item, so you need to cast each of the children of the object to its proper type before using it.</p>\n\n<pre><code>// inner items are of type interface{}\nfoo := jsonMap[\"foo\"]\n\n// convert foo to the proper type\nfooMap := foo.(map[string]interface{})\n\n// now we can use it, but its children are still interface{}\nfmt.Println(fooMap[\"baz\"])\n</code></pre>\n\n<p>You could simplify this if the JSON you send can be more structured, but if you want to accept <strong>any</strong> kind of JSON string then you have to check everything and cast to the correct type before using the data.</p>\n\n<p>You can find the code working in <a href=\"https://play.golang.org/p/JCXeEUIusq\" rel=\"noreferrer\">this playground</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": true, "score": 1, "last_activity_date": 1450200334, "creation_date": 1450200334, "answer_id": 34295630, "question_id": 34292012, "link": "https://stackoverflow.com/questions/34292012/convert-string-to-json-in-golang-and-vice-versa/34295630#34295630", "title": "convert string to json in golang and vice versa?", "body": "<p>If I understand your problem correctly, you want to use <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow\"><code>json.RawMessage</code></a> as <code>Context</code>. </p>\n\n<blockquote>\n  <p>RawMessage is a raw encoded JSON object. It implements Marshaler and Unmarshaler and can be used to delay JSON decoding or precompute a JSON encoding.</p>\n</blockquote>\n\n<p>RawMessage is just <code>[]byte</code>, so you can keep it in data store and then attach it for an outgoing messages as \"precomputed JSON\".</p>\n\n<pre><code>type Iot struct {\n    Id      int             `json:\"id\"`\n    Name    string          `json:\"name\"`\n    Context json.RawMessage `json:\"context\"` // RawMessage here! (not a string)\n}\n\nfunc main() {\n    in := []byte(`{\"id\":1,\"name\":\"test\",\"context\":{\"key1\":\"value1\",\"key2\":2}}`)\n\n    var iot Iot\n    err := json.Unmarshal(in, &amp;iot)\n    if err != nil {\n        panic(err)\n    }\n\n    // Context is []byte, so you can keep it as string in DB\n    fmt.Println(\"ctx:\", string(iot.Context))\n\n    // Marshal back to json (as original)\n    out, _ := json.Marshal(&amp;iot)\n    fmt.Println(string(out))\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/69n0B2PNRv\" rel=\"nofollow\">https://play.golang.org/p/69n0B2PNRv</a></p>\n"}], "owner": {"reputation": 1179, "user_id": 3824957, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HOl0u.png?s=128&g=1", "display_name": "MayK", "link": "https://stackoverflow.com/users/3824957/mayk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6929, "favorite_count": 3, "accepted_answer_id": 34295630, "answer_count": 3, "score": 0, "last_activity_date": 1475115613, "creation_date": 1450190442, "last_edit_date": 1475115613, "question_id": 34292012, "link": "https://stackoverflow.com/questions/34292012/convert-string-to-json-in-golang-and-vice-versa", "title": "convert string to json in golang and vice versa?", "body": "<p>In my app, I receive a json from the client. This json can be anything since the user defines the keys and the values. In the backend I store it as string in the datastore.</p>\n\n<p>Now i'm trying to override the MarshalJson / UnmarshalJson functions so that what I send / receive from the client is not a string but a json. </p>\n\n<p>I can't figure out how to convert a string to json in go.</p>\n\n<p>my structure</p>\n\n<pre><code>type ContextData string\ntype Iot struct {\nId              IotId       `json:\"id,string\" datastore:\"-\" goon:\"id\"`\nName            string   `json:\"name\"`\nContext         ContextData  `json:\"context\" datastore:\",noindex\"` }\n</code></pre>\n\n<p>example of received data</p>\n\n<pre><code>{ 'id' : '',\n  'name' '',\n  'context': {\n           'key1': value1,\n           'key2': value2 }}\n</code></pre>\n\n<p>how i want to store this Context field in the datastore as a noindex string <code>'{'key1':value1, 'key2':value2}'</code>\nexample of data i want to send</p>\n\n<pre><code>{ 'id' : '',\n  'name' '',\n  'context': {\n           'key1': value1,\n           'key2': value2 }}\n</code></pre>\n"}, {"tags": ["reflection", "go", "interface"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 5, "creation_date": 1450174485, "post_id": 34285661, "comment_id": 56314259, "body": "Can you please clarify what you want exactly?"}, {"owner": {"reputation": 36166, "user_id": 393701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/250889c646cd2a916920d9252f7c6f42?s=128&d=identicon&r=PG", "display_name": "SirDarius", "link": "https://stackoverflow.com/users/393701/sirdarius"}, "edited": false, "score": 0, "creation_date": 1450175862, "post_id": 34285661, "comment_id": 56315278, "body": "If I understand well, OP wants an implementation of Print to call fxyz passing the name of the interface as the name parameter... well, even then that does not seem much clearer... Using reflection for this would be an unacceptable tradeoff for simply using the &quot;Printer&quot; string constant, since Print will always be an implementation of the Printer interface anyways..."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1450190403, "post_id": 34285661, "comment_id": 56325324, "body": "I think icza was asking more about &#39;why&#39; - that is, people often ask how to solve a specific issue rather than whether that is even the right approach. Dynamically calling interfaces in Go like this is very likely to be the wrong approach."}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1450176722, "creation_date": 1450176722, "answer_id": 34287268, "question_id": 34285661, "link": "https://stackoverflow.com/questions/34285661/get-golang-interface-name-dynamically/34287268#34287268", "title": "get golang interface name dynamically", "body": "<p>If you want to get the name of the interface, you can do that using <code>reflect</code>:</p>\n\n<pre><code>name := reflect.TypeOf((*Printer)(nil)).Elem().Name()\nfxyz(name)\n</code></pre>\n\n<p>Playground: <a href=\"http://play.golang.org/p/Lv6-qqqQsH\" rel=\"nofollow\">http://play.golang.org/p/Lv6-qqqQsH</a>.</p>\n\n<p>Note, you cannot just take <code>reflect.TypeOf(Printer(nil)).Name()</code> because <code>TypeOf</code> will return <code>nil</code>.</p>\n"}], "owner": {"reputation": 37, "user_id": 1742648, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c28463ac84f50526a22d94e660bf9f35?s=128&d=identicon&r=PG", "display_name": "user1742648", "link": "https://stackoverflow.com/users/1742648/user1742648"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2511, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1450176925, "creation_date": 1450172373, "last_edit_date": 1450176925, "question_id": 34285661, "link": "https://stackoverflow.com/questions/34285661/get-golang-interface-name-dynamically", "title": "get golang interface name dynamically", "body": "<p>I have a interface:</p>\n\n<pre><code>type Printer interface {\n    Print(s string)\n}\n</code></pre>\n\n<p>and a func:</p>\n\n<pre><code>func fxyz(name string) {\n    ....\n}\n</code></pre>\n\n<p>I want to call fxyz with \"Printer\", but I don't want to hard code the string.</p>\n\n<p>How could I get the Interface Name using reflection or other approach?  </p>\n"}, {"tags": ["java", "sockets", "go", "network-programming", "time-series"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1450175255, "post_id": 34285503, "comment_id": 56314844, "body": "You asked: &quot;[W]hat possibilities are there to compress the data[?]&quot; with the obvious answer: lzh, zip, gzip, compress whatever, choose any. Probably your question is a different one?"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1450178446, "post_id": 34285503, "comment_id": 56317116, "body": "so you&#39;re basically reimplementing statsd and graphite? :)"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450182654, "post_id": 34285503, "comment_id": 56320050, "body": "Have a look at influxdb. It might be good fit for your usecase."}, {"owner": {"reputation": 2798, "user_id": 4478544, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/uPFEK.png?s=128&g=1", "display_name": "Zaboj Campula", "link": "https://stackoverflow.com/users/4478544/zaboj-campula"}, "edited": false, "score": 0, "creation_date": 1450183970, "post_id": 34285503, "comment_id": 56320890, "body": "I am not sure what exactly you are asking about. Is the server where all data is stored developed by you as well? Is your primary goal to compress data for transfer or data stored at the server? If both of these goals are valid then you should probably use different schema for transfer and different for storage. But it depends on the kind of values. Are the values changing rapidly?"}, {"owner": {"reputation": 3008, "user_id": 4636126, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4P1ZF.jpg?s=128&g=1", "display_name": "Sergei Rodionov", "link": "https://stackoverflow.com/users/4636126/sergei-rodionov"}, "edited": false, "score": 0, "creation_date": 1450210210, "post_id": 34285503, "comment_id": 56338710, "body": "@FlorinDiaconeasa How long does the <code>session</code> last? How does 32MB of raw data translates into time-series, in terms of time+float sample count per second/minute."}, {"owner": {"reputation": 76, "user_id": 912992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a12377af210fdef6d6a50619ad8569?s=128&d=identicon&r=PG", "display_name": "Florin Diaconeasa", "link": "https://stackoverflow.com/users/912992/florin-diaconeasa"}, "edited": false, "score": 0, "creation_date": 1450216255, "post_id": 34285503, "comment_id": 56342051, "body": "Basically, they are random numbers. My question is related mostly to what compression algorithm provides better ratio for this kind of data."}, {"owner": {"reputation": 76, "user_id": 912992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a12377af210fdef6d6a50619ad8569?s=128&d=identicon&r=PG", "display_name": "Florin Diaconeasa", "link": "https://stackoverflow.com/users/912992/florin-diaconeasa"}, "reply_to_user": {"reputation": 3008, "user_id": 4636126, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4P1ZF.jpg?s=128&g=1", "display_name": "Sergei Rodionov", "link": "https://stackoverflow.com/users/4636126/sergei-rodionov"}, "edited": false, "score": 0, "creation_date": 1450216311, "post_id": 34285503, "comment_id": 56342088, "body": "@Sergei : I would get something around ~50 incoming udp packets per second, each around 1500B"}, {"owner": {"reputation": 3008, "user_id": 4636126, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/4P1ZF.jpg?s=128&g=1", "display_name": "Sergei Rodionov", "link": "https://stackoverflow.com/users/4636126/sergei-rodionov"}, "edited": false, "score": 0, "creation_date": 1450249147, "post_id": 34285503, "comment_id": 56353102, "body": "Whatever algo you choose, you would get better compression ratio if you compress multiple packets at once, better the whole 35MB, regardless if this happens on the client (your app) or the server (tsdb). The load itself not that large, TSDBs are able to process 100K/s inserts easily."}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 912992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a12377af210fdef6d6a50619ad8569?s=128&d=identicon&r=PG", "display_name": "Florin Diaconeasa", "link": "https://stackoverflow.com/users/912992/florin-diaconeasa"}, "edited": false, "score": 0, "creation_date": 1450216470, "post_id": 34298608, "comment_id": 56342153, "body": "Unfortunately, i doesn&#39;t that distribution :) I&#39;ve updated the question with the following: &quot;We could say we are collecting time series data. However, it&#39;s not the kind of time series data that you get from supervising a service (mostly the same value for a period of time). These values constantly vary, true, not by very much. But they vary, nevertheless.&quot;"}], "tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 0, "last_activity_date": 1450210697, "creation_date": 1450210697, "answer_id": 34298608, "question_id": 34285503, "link": "https://stackoverflow.com/questions/34285503/time-series-data-storage/34298608#34298608", "title": "Time series data storage", "body": "<p>You can compress time series data using this library: <a href=\"https://github.com/dgryski/go-tsz\" rel=\"nofollow\">https://github.com/dgryski/go-tsz</a></p>\n\n<p>It's based on this paper from Facebook:\n<a href=\"http://www.vldb.org/pvldb/vol8/p1816-teller.pdf\" rel=\"nofollow\">http://www.vldb.org/pvldb/vol8/p1816-teller.pdf</a></p>\n\n<blockquote>\n  <p>We have found that about 96% of all time stamps\n  can be compressed to a single bit.</p>\n  \n  <p>[...]</p>\n  \n  <p>Roughly 51% of all values are compressed to a single bit since\n  the current and previous values are identical. About 30% of\n  the values are compressed with the control bits \u201810\u2019 (case b),\n  with an average compressed size of 26.6 bits. The remaining\n  19% are compressed with control bits \u201811\u2019, with an average\n  size of 36.9 bits, due to the extra 13 bits of overhead required\n  to encode the length of leading zero bits and meaningful bits.</p>\n</blockquote>\n\n<p>You can use a key-value store like bolt (or probably better: rocksdb which supports compression) and store multiple points for each key. For example you could store one key-value pair every 10 minutes, where the value would be all of the points that occurred during that 10 minute window.</p>\n\n<p>This should give you both good performance and high compression.</p>\n"}], "owner": {"reputation": 76, "user_id": 912992, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34a12377af210fdef6d6a50619ad8569?s=128&d=identicon&r=PG", "display_name": "Florin Diaconeasa", "link": "https://stackoverflow.com/users/912992/florin-diaconeasa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 671, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450216436, "creation_date": 1450171930, "last_edit_date": 1450216436, "question_id": 34285503, "link": "https://stackoverflow.com/questions/34285503/time-series-data-storage", "title": "Time series data storage", "body": "<p>I'm collecting a large number of UDP packets (time dependant) coming from a service on the same network. These packets are being deserialised into structures that contain numbers (float and int) in memory and processed. We could say we are collecting time series data. However, it's not the kind of time series data that you get from supervising a service (mostly the same value for a period of time). These values constantly vary, true, not by very much. But they vary, nevertheless.</p>\n\n<p>Besides this, I would like to send that data to a server in the cloud and on that server store the time series data.</p>\n\n<p>My question is: what possibilities are there to compress the data in order to send smaller packets over the wire to the server (we could send the incoming UDP packets in batches over TCP) and store them? I'm particularly interested in not using the whole storage I have attached to the server. The data for one session is close to 32MB and i would have multiple sessions at the same time. One session's data is not related to another session. They are totally independent.</p>\n"}, {"tags": ["linux", "go", "signals"], "comments": [{"owner": {"reputation": 1280, "user_id": 4932403, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uLzID.jpg?s=128&g=1", "display_name": "KeylorSanchez", "link": "https://stackoverflow.com/users/4932403/keylorsanchez"}, "edited": false, "score": 0, "creation_date": 1450173115, "post_id": 34285445, "comment_id": 56313249, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/9366550/go-inter-process-communication\" title=\"go inter process communication\">stackoverflow.com/questions/9366550/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 3063, "user_id": 450598, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/780c14039de44c48349f578fdcfa66e0?s=128&d=identicon&r=PG", "display_name": "soupdiver", "link": "https://stackoverflow.com/users/450598/soupdiver"}, "edited": false, "score": 0, "creation_date": 1450173546, "post_id": 34285912, "comment_id": 56313594, "body": "The other process is not started by my Go app. It&#39;s independently started"}, {"owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "reply_to_user": {"reputation": 3063, "user_id": 450598, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/780c14039de44c48349f578fdcfa66e0?s=128&d=identicon&r=PG", "display_name": "soupdiver", "link": "https://stackoverflow.com/users/450598/soupdiver"}, "edited": false, "score": 0, "creation_date": 1450174089, "post_id": 34285912, "comment_id": 56313989, "body": "Do you know processId ? You should find it prom from process list or in some ngnix.pid file - and make syscall.Signal(ngnixPid,SIG_HUP)"}, {"owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "reply_to_user": {"reputation": 3063, "user_id": 450598, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/780c14039de44c48349f578fdcfa66e0?s=128&d=identicon&r=PG", "display_name": "soupdiver", "link": "https://stackoverflow.com/users/450598/soupdiver"}, "edited": false, "score": 0, "creation_date": 1450174413, "post_id": 34285912, "comment_id": 56314207, "body": "misspelling: syscall.Kill (pid,syscall.SIGHUP) ofcourse"}, {"owner": {"reputation": 3063, "user_id": 450598, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/780c14039de44c48349f578fdcfa66e0?s=128&d=identicon&r=PG", "display_name": "soupdiver", "link": "https://stackoverflow.com/users/450598/soupdiver"}, "edited": false, "score": 0, "creation_date": 1450174771, "post_id": 34285912, "comment_id": 56314484, "body": "ah perfect :) That&#39;s what I was looking for I guess. Feel free to add is as an answer"}], "tags": [], "owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "is_accepted": true, "score": 6, "last_activity_date": 1450174974, "last_edit_date": 1450174974, "creation_date": 1450173120, "answer_id": 34285912, "question_id": 34285445, "link": "https://stackoverflow.com/questions/34285445/send-signal-to-other-process/34285912#34285912", "title": "Send signal to other process", "body": "<p>If you have created process with os.StartProcess or exec.Command you can use <a href=\"https://golang.org/pkg/os/#Process.Signal\" rel=\"noreferrer\">Process.Signal</a> method:</p>\n\n<pre><code>cmd := exec.Command(\"CmdPath\", \"-param1\", param1)\ncmd.Process.Signal(signal) \n</code></pre>\n\n<p>For external process You should know it's process id (PID) and then call for example:</p>\n\n<pre><code>syscall.Kill(pid,syscall.SIGHUP)\n</code></pre>\n\n<p>Signal is a standart UNIX \"kill\" syscall, if you know a pid of the process, you can simply make a syscall with \n<a href=\"https://golang.org/pkg/syscall/#Kill\" rel=\"noreferrer\">https://golang.org/pkg/syscall/#Kill</a></p>\n"}], "owner": {"reputation": 3063, "user_id": 450598, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/780c14039de44c48349f578fdcfa66e0?s=128&d=identicon&r=PG", "display_name": "soupdiver", "link": "https://stackoverflow.com/users/450598/soupdiver"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1903, "favorite_count": 0, "accepted_answer_id": 34285912, "answer_count": 1, "score": 2, "last_activity_date": 1450174974, "creation_date": 1450171761, "last_edit_date": 1450173718, "question_id": 34285445, "link": "https://stackoverflow.com/questions/34285445/send-signal-to-other-process", "title": "Send signal to other process", "body": "<p>since <code>os/signal</code> is only for handling of incoming signals I'm asking if there is a native way to send signals to other processes?</p>\n\n<p>Edit: The process I want to mange is nginx. My Go application should listen for some events and then send a <code>SIGHUP</code> to nginx to reload its configuration</p>\n"}, {"tags": ["go", "etcd"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1450192984, "creation_date": 1450192984, "answer_id": 34292955, "question_id": 34285119, "link": "https://stackoverflow.com/questions/34285119/etcd-outdated-index-how-to-read-x-etcd-index-from-client/34292955#34292955", "title": "Etcd - Outdated index. How to read &quot;X-Etcd-Index&quot; from client", "body": "<p>The <code>X-Etcd-Index</code> header corresponds to the <a href=\"https://godoc.org/github.com/coreos/etcd/client#Response\" rel=\"nofollow\"><code>Response.Index</code></a> field.</p>\n"}, {"tags": [], "owner": {"reputation": 381, "user_id": 2152602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2786cdedd6e0eaa34b64b17e1cea81b9?s=128&d=identicon&r=PG", "display_name": "Brandon Philips", "link": "https://stackoverflow.com/users/2152602/brandon-philips"}, "is_accepted": false, "score": 1, "last_activity_date": 1450232095, "creation_date": 1450232095, "answer_id": 34302879, "question_id": 34285119, "link": "https://stackoverflow.com/questions/34285119/etcd-outdated-index-how-to-read-x-etcd-index-from-client/34302879#34302879", "title": "Etcd - Outdated index. How to read &quot;X-Etcd-Index&quot; from client", "body": "<p>The index is available in the response field as the \"Index\" object. See the documentation here: <a href=\"https://godoc.org/github.com/coreos/etcd/client#Response\" rel=\"nofollow\">https://godoc.org/github.com/coreos/etcd/client#Response</a></p>\n"}], "owner": {"reputation": 2590, "user_id": 1209451, "user_type": "registered", "accept_rate": 73, "profile_image": "https://graph.facebook.com/1700220388/picture?type=large", "display_name": "Oleg", "link": "https://stackoverflow.com/users/1209451/oleg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 423, "favorite_count": 0, "accepted_answer_id": 34292955, "answer_count": 2, "score": 1, "last_activity_date": 1450232095, "creation_date": 1450170848, "last_edit_date": 1450172268, "question_id": 34285119, "link": "https://stackoverflow.com/questions/34285119/etcd-outdated-index-how-to-read-x-etcd-index-from-client", "title": "Etcd - Outdated index. How to read &quot;X-Etcd-Index&quot; from client", "body": "<p>I am using github.com/coreos/etcd/client for communicating with etcd cloud, sometimes i am receiving 401 error \"The event in requested index is outdated and cleared\" , on server page there is a explanation why it happened and how it can be solved. Actually I want to implement the following scenario.</p>\n\n<ol>\n<li>Get \"key\" and its modified index </li>\n<li>do some job  </li>\n<li>start watching on \"key\" from modified index</li>\n</ol>\n\n<p>this way I can be shure that all changes during 2 step will be also received. But Etcd saves only top N changes and sometimes I am receiving 401 error. Acording <a href=\"https://github.com/coreos/etcd/blob/master/Documentation/api.md\" rel=\"nofollow\">docu</a> I can use \"X-Etcd-Index\" + 1 header from Get key request as modified index to watch. </p>\n\n<pre><code>curl 'http://127.0.0.1:2379/v2/keys/foo' -vv\n&lt; HTTP/1.1 200 OK\n&lt; Content-Type: application/json\n&lt; X-Etcd-Cluster-Id: f63cd37d2ff4f650\n&lt; X-Etcd-Index: 17245\n&lt; X-Raft-Index: 2107637\n&lt; X-Raft-Term: 360\n&lt; Date: Tue, 15 Dec 2015 09:02:20 GMT\n&lt; Content-Length: 791\n&lt; ...\n</code></pre>\n\n<p>But I don't use direct http calls , only github.com/coreos/etcd/client. How can I get (and is it actually possible using api) a http header info on from get key request ? </p>\n"}, {"tags": ["oracle", "go", "oci8", "sqlx"], "comments": [{"owner": {"reputation": 216, "user_id": 3448985, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/62045c30b7a315ff58e327f9d057c6d5?s=128&d=identicon&r=PG&f=1", "display_name": "Krishnat Molawade", "link": "https://stackoverflow.com/users/3448985/krishnat-molawade"}, "edited": false, "score": 0, "creation_date": 1450170857, "post_id": 34285040, "comment_id": 56311666, "body": "either you have to use orm to get id of last inserted row(last saved object) or you can stop inserting id through trigger. Manually you can get seq.nextVal and work on it"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1450182770, "post_id": 34285040, "comment_id": 56320121, "body": "Maybe you can fix go-oci8 driver: <a href=\"https://github.com/mattn/go-oci8/blob/master/oci8.go\" rel=\"nofollow noreferrer\">github.com/mattn/go-oci8/blob/master/oci8.go</a>?"}], "answers": [{"comments": [{"owner": {"reputation": 109, "user_id": 1701871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/122ab28ed44cf0bf13176ae36984466c?s=128&d=identicon&r=PG", "display_name": "Sergey Melekhin", "link": "https://stackoverflow.com/users/1701871/sergey-melekhin"}, "edited": false, "score": 0, "creation_date": 1451351217, "post_id": 34494494, "comment_id": 56748043, "body": "I tried that too. Variable binded to :xx remains empty after a call. Looks like golang&#39;s &quot;database/sql&quot; package is unable to returnn values to binded variables. Only to pass them to query."}, {"owner": {"reputation": 1062, "user_id": 2125924, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZBGbZ.png?s=128&g=1", "display_name": "Chintan Gor", "link": "https://stackoverflow.com/users/2125924/chintan-gor"}, "reply_to_user": {"reputation": 109, "user_id": 1701871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/122ab28ed44cf0bf13176ae36984466c?s=128&d=identicon&r=PG", "display_name": "Sergey Melekhin", "link": "https://stackoverflow.com/users/1701871/sergey-melekhin"}, "edited": false, "score": 0, "creation_date": 1452064388, "post_id": 34494494, "comment_id": 57000449, "body": "can you send me the output of your return query v?"}, {"owner": {"reputation": 109, "user_id": 1701871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/122ab28ed44cf0bf13176ae36984466c?s=128&d=identicon&r=PG", "display_name": "Sergey Melekhin", "link": "https://stackoverflow.com/users/1701871/sergey-melekhin"}, "edited": false, "score": 0, "creation_date": 1452502196, "post_id": 34494494, "comment_id": 57180351, "body": "In go output is &quot;&quot;, as I said earlier. Binded variable remains empty."}], "tags": [], "owner": {"reputation": 1062, "user_id": 2125924, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/ZBGbZ.png?s=128&g=1", "display_name": "Chintan Gor", "link": "https://stackoverflow.com/users/2125924/chintan-gor"}, "is_accepted": false, "score": 0, "last_activity_date": 1451309509, "creation_date": 1451309509, "answer_id": 34494494, "question_id": 34285040, "link": "https://stackoverflow.com/questions/34285040/get-last-inserted-id-go-oracle/34494494#34494494", "title": "Get last inserted id (go + oracle)", "body": "<p>Hi I Don't know about go but I know about oracle return query </p>\n\n<p>Same problem I had with PHP and I solve it using this query </p>\n\n<pre><code>insert into table (field1,field2,field3)\nvalues (val1,val2,val3) return primaryfield_id into :xx\n</code></pre>\n\n<p>It will automatically return value in your Go variable (I guess )\nplease try this </p>\n"}], "owner": {"reputation": 109, "user_id": 1701871, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/122ab28ed44cf0bf13176ae36984466c?s=128&d=identicon&r=PG", "display_name": "Sergey Melekhin", "link": "https://stackoverflow.com/users/1701871/sergey-melekhin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1171, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1451309509, "creation_date": 1450170602, "question_id": 34285040, "link": "https://stackoverflow.com/questions/34285040/get-last-inserted-id-go-oracle", "title": "Get last inserted id (go + oracle)", "body": "<p>I need to insert two records in Oracle database from my go application using sqlx (<a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow\">https://github.com/jmoiron/sqlx</a>) with go-oci8 (<a href=\"https://github.com/mattn/go-oci8\" rel=\"nofollow\">https://github.com/mattn/go-oci8</a>) driver.\nSecond record references previous one by foreign key.\nSo I need to have primary key of first record (it is assigned from sequence with before insert trigger on first table) before I can insert second record.</p>\n\n<p>So I experimented to get last inserted id:</p>\n\n<pre><code>create table t(x int primary key);\ncreate sequence x_seq;\n</code></pre>\n\n<p>LastInsertId failed for me:</p>\n\n<pre><code>import(\n    \"fmt\"\n    \"github.com/jmoiron/sqlx\"\n    _ \"github.com/mattn/go-oci8\"\n)\n\nfunc main(){\n    db, err := sqlx.Connect(\"oci8\", \"integr/integr@localhost:49161/xe\")\n    if err != nil {\n       fmt.Println(err)\n    }\n    sql := \"insert into t values(x_seq.nextval)\"\n    r, err := db.Exec(sql)\n    if err != nil {\n       fmt.Println(err)\n    }\n    fmt.Println(r.RowsAffected())\n    fmt.Println(r.LastInsertId())\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>1 &lt;nil&gt;\n0 LastInsertId not supported\n</code></pre>\n\n<p>Then I tried to make stored function that inserts record and returns primary key.</p>\n\n<pre><code>create function f(x int) return int as\nv int;\nbegin\n    insert into t values(x)\n    returning x into v;\n    return v;\nend;\n</code></pre>\n\n<p>But I failed to find a way to get its result. PostgreSQL style select fails:</p>\n\n<pre><code>SQL&gt; select f(9) from dual;\nselect f(9) from dual\n       *\nERROR at line 1:\nORA-14551: cannot perform a DML operation inside a query\nORA-06512: at \"INTEGR.F\", line 1\n</code></pre>\n\n<p>And OCI8 style variable binding does not work:</p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"github.com/jmoiron/sqlx\"\n    _ \"github.com/mattn/go-oci8\"\n)\n\nfunc main(){\n    db, err := sqlx.Connect(\"oci8\", \"integr/integr@localhost:49161/xe\")\n    if err != nil {\n       fmt.Println(err)\n    }\n    sql := sqlx.Rebind(sqlx.NAMED,\"begin ? := f(?); end;\")\n    var a int\n    _, err = db.Exec(sql, a, 333)\n    if err != nil {\n       fmt.Println(err)\n    }\n    fmt.Println(sql)\n    fmt.Println(a)\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>begin :arg1 := f(:arg2); end;\n0\n</code></pre>\n\n<p>How to get last inserted ID, or how to get value from stored funcion in Go from Oracle?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1450168555, "post_id": 34284001, "comment_id": 56310212, "body": "Compression is not finished until the writer is closed or flushed. You do neither."}], "answers": [{"comments": [{"owner": {"reputation": 451, "user_id": 1082884, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/150055b45b9362a8b27b709c9938d8f1?s=128&d=identicon&r=PG", "display_name": "rino", "link": "https://stackoverflow.com/users/1082884/rino"}, "edited": false, "score": 0, "creation_date": 1450172703, "post_id": 34284354, "comment_id": 56312978, "body": "I&#39;d be very interested to see some kind of performance comparison between your buffer library and the standard library."}, {"owner": {"reputation": 4687, "user_id": 2176740, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c09c0ea83bcb343688502045304a0474?s=128&d=identicon&r=PG", "display_name": "joonas.fi", "link": "https://stackoverflow.com/users/2176740/joonas-fi"}, "edited": false, "score": 0, "creation_date": 1488204662, "post_id": 34284354, "comment_id": 72115225, "body": "Thanks for sharing this. It was super confusing because <code>$ gzip</code> binary decoded the file without <code>.Close()</code>, but Golang reader borked without it. I guess the close operation adds a footer of some sort: <a href=\"https://github.com/golang/go/blob/master/src/compress/gzip/gzip.go#L227\" rel=\"nofollow noreferrer\">github.com/golang/go/blob/master/src/compress/gzip/gzip.go#L&zwnj;&#8203;227</a>"}], "tags": [], "owner": {"reputation": 11711, "user_id": 1018582, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/d18789a2f20eee6dfe637fef8bd7ebf5?s=128&d=identicon&r=PG", "display_name": "Alasdair", "link": "https://stackoverflow.com/users/1018582/alasdair"}, "is_accepted": true, "score": 9, "last_activity_date": 1450168547, "creation_date": 1450168547, "answer_id": 34284354, "question_id": 34284001, "link": "https://stackoverflow.com/questions/34284001/having-trouble-with-gzip-reader-in-golang/34284354#34284354", "title": "Having trouble with gzip.Reader in Golang", "body": "<p>Probably it doesn't work because you didn't close the gzip writer and so the gzipped data was never flushed to the underlying writer (for which you are using a bytes.Buffer), or at least it wasn't finalized.</p>\n\n<p>You need to <code>w.Close()</code> the gzip writer after writing.</p>\n\n<p>Alternatively, it could be that the bytes.Buffer needs to be seeked to zero before attempting to read from it, as it might be that the reader is trying to read from the end of it.</p>\n\n<p>Also what you're doing is inefficient, I'd suggest you use: <a href=\"https://github.com/AlasdairF/Custom\" rel=\"noreferrer\">https://github.com/AlasdairF/Custom</a></p>\n"}], "owner": {"reputation": 451, "user_id": 1082884, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/150055b45b9362a8b27b709c9938d8f1?s=128&d=identicon&r=PG", "display_name": "rino", "link": "https://stackoverflow.com/users/1082884/rino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3262, "favorite_count": 0, "accepted_answer_id": 34284354, "answer_count": 1, "score": 4, "last_activity_date": 1450168547, "creation_date": 1450167350, "last_edit_date": 1450167894, "question_id": 34284001, "link": "https://stackoverflow.com/questions/34284001/having-trouble-with-gzip-reader-in-golang", "title": "Having trouble with gzip.Reader in Golang", "body": "<p>Why doesn't this work? (sorry for some reason I cannot get a share button on Go Playground).</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"compress/gzip\"\n    \"fmt\"\n    \"io\"\n)\n\nfunc main() {\n    // ENCODE\n    data := []byte{1, 2, 3, 4, 5, 6, 7}\n    bb0 := bytes.NewBuffer(data)\n    byts := bb0.Bytes()\n    fmt.Printf(\"data = % x\\n\", data)\n    fmt.Printf(\"byte buffer bb0 contains = % x\\n\", byts)\n    bb1 := new(bytes.Buffer)\n    w := gzip.NewWriter(bb1)\n    s1, err := w.Write(byts)\n    fmt.Printf(\"%d bytes written using gzip writer, err = %v\\n\", s1, err)\n    byts = bb1.Bytes()\n    fmt.Printf(\"byte buffer bb1 contains = % x\\n\", byts)\n    // DECODE\n    r, err := gzip.NewReader(bb1)\n    bb2 := new(bytes.Buffer)\n    s2, err := io.Copy(bb2, r)\n    r.Close()\n    fmt.Printf(\"%d bytes copied from gzip reader, err = %v\\n\", s2, err)\n    byts = bb2.Bytes()\n    fmt.Printf(\"byte buffer bb2 contains = % x\\n\", byts)\n}\n</code></pre>\n\n<p>The output I get</p>\n\n<pre><code>data = 01 02 03 04 05 06 07\nbyte buffer bb0 contains = 01 02 03 04 05 06 07\n7 bytes written using gzip writer, err = &lt;nil&gt;\nbyte buffer bb1 contains = 1f 8b 08 00 00 09 6e 88 00 ff\n0 bytes copied from gzip reader, err = unexpected EOF\nbyte buffer bb2 contains = \n</code></pre>\n\n<p>The reader doesn't seem to be doing anything, what am I doing wrong?</p>\n"}, {"tags": ["go", "concurrency", "channel"], "answers": [{"comments": [{"owner": {"reputation": 1042, "user_id": 374924, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08ef4cdbafc228a2a6052467e74f3c2e?s=128&d=identicon&r=PG", "display_name": "Jacek Wysocki", "link": "https://stackoverflow.com/users/374924/jacek-wysocki"}, "edited": false, "score": 1, "creation_date": 1450250145, "post_id": 34283635, "comment_id": 56353570, "body": "thanks for the answer I&#39;ve implemented my solution based on your idea."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 18, "last_activity_date": 1471849034, "last_edit_date": 1471849034, "creation_date": 1450165748, "answer_id": 34283635, "question_id": 34283255, "link": "https://stackoverflow.com/questions/34283255/closing-channel-of-unknown-length/34283635#34283635", "title": "Closing channel of unknown length", "body": "<p>Once a channel is closed, you can't send further values on it else it panics. This is what you experience.</p>\n\n<p>This is because you start multiple goroutines that use the same channel and they send values on it. And you close the channel in each of it. And since they are not synchronized, once the first goroutine reaches the point where it closes it, others may (and they will) still continue to send values on it: panic!</p>\n\n<p>You can close the channel only once (attempting to close an already closed channel also panics). And you should do it when all the goroutines that send values on it are done. In order to do this, you need to detect when all the sender goroutines are done. An idiomatic way to detect this is to use <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a>.</p>\n\n<p>For each started sender goroutine we add 1 to the <code>WaitGroup</code> using <a href=\"https://golang.org/pkg/sync/#WaitGroup.Add\" rel=\"noreferrer\"><code>WaitGroup.Add()</code></a>. And each goroutine that is done sending the values can signal this by calling <a href=\"https://golang.org/pkg/sync/#WaitGroup.Done\" rel=\"noreferrer\"><code>WaitGroup.Done()</code></a>. Best to do this as a deferred statement, so if your goroutine would terminate abruptly (e.g. panics), <code>WaitGroup.Done()</code> would still be called, and would not leave other goroutines hanging (waiting for an absolution - a \"missing\" <code>WaitGroup.Done()</code> call that would never come...).</p>\n\n<p>And <a href=\"https://golang.org/pkg/sync/#WaitGroup.Wait\" rel=\"noreferrer\"><code>WaitGroup.Wait()</code></a> will wait until all sender goroutines are done, and only after this and only once will it close the channel. We want to detect this \"global\" done event and close the channel while processing the values sent on it is in progress, so we have to do this in its own goroutine.</p>\n\n<p>The receiver goroutine will run until the channel is closed since we used the <code>for ... range</code> construct on the channel. And since it runs in the main goroutine, the program will not exit until all the values are properly received and processed from the channel. The <code>for ... range</code> construct loops until all the values are received that were sent before the channel was closed.</p>\n\n<p>Note that the solution below works with buffered and unbuffered channel too without modification (try using a buffered channel with <code>ch := make(chan int, 100)</code>).</p>\n\n<p>Correct solution (try it on the <a href=\"http://play.golang.org/p/02vOm1tvDe\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>func gen(ch chan int, wg *sync.WaitGroup) {\n    defer wg.Done()\n    var i int\n    for {\n        time.Sleep(time.Millisecond * 10)\n        ch &lt;- i\n        i++\n        // when no more data (e.g. from db, or event stream)\n        if i &gt; 100 {\n            break\n        }\n    }\n}\n\nfunc receiver(ch chan int) {\n    for i := range ch {\n        fmt.Println(\"received:\", i)\n    }\n}\n\nfunc main() {\n    ch := make(chan int)\n    wg := &amp;sync.WaitGroup{}\n\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go gen(ch, wg)\n    }\n\n    go func() {\n        wg.Wait()\n        close(ch)\n    }()\n\n    receiver(ch)\n}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<p>Note that it's important that <code>receiver(ch)</code> runs in the main goroutine, and the code what waits for the <code>WaitGroup</code> and closes the channel in its own (non-main) goroutine; and not the other way around. If you would switch these 2, it might cause an \"early exit\", that is not all values might be received and processed from the channel. The reason for this is because a Go program exits when the main goroutine finishes (spec: <a href=\"https://golang.org/ref/spec#Program_execution\" rel=\"noreferrer\">Program execution</a>). It does not wait for other (non-main) goroutines to finish. So if waiting and closing the channel would be in the main goroutine, after closing the channel the program could exit at any moment, not waiting for the other goroutine that in this case would loop to receive values from the channel.</p>\n"}, {"tags": [], "owner": {"reputation": 217, "user_id": 5713047, "user_type": "registered", "profile_image": "https://graph.facebook.com/511702685666241/picture?type=large", "display_name": "Abhishek Srivastava", "link": "https://stackoverflow.com/users/5713047/abhishek-srivastava"}, "is_accepted": false, "score": 0, "last_activity_date": 1586803143, "creation_date": 1586803143, "answer_id": 61194424, "question_id": 34283255, "link": "https://stackoverflow.com/questions/34283255/closing-channel-of-unknown-length/61194424#61194424", "title": "Closing channel of unknown length", "body": "<p>\"<strong>One general principle of using Go channels is don't close a channel from the receiver side and don't close a channel if the channel has multiple concurrent senders.</strong>\"</p>\n\n<p>Every channel will be GCed eventually once it is marked for cleanup, so it is okay to leave channel un-closed the only difference it will make is that that channel will be available for <code>gc</code> after a few cycles maybe if not closed explicitly.</p>\n\n<p>Nevertheless it is always good if you can close the channel off. Please go through the following links for detailed explaination.</p>\n\n<p>Articles <a href=\"https://go101.org/article/channel-closing.html\" rel=\"nofollow noreferrer\">this</a> and <a href=\"https://www.leolara.me/blog/closing_a_go_channel_written_by_several_goroutines/\" rel=\"nofollow noreferrer\">this</a> shows various ways to close a channel in case of 1:N, N:1 or M:N (senders:receivers)</p>\n"}], "owner": {"reputation": 1042, "user_id": 374924, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/08ef4cdbafc228a2a6052467e74f3c2e?s=128&d=identicon&r=PG", "display_name": "Jacek Wysocki", "link": "https://stackoverflow.com/users/374924/jacek-wysocki"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2741, "favorite_count": 4, "accepted_answer_id": 34283635, "answer_count": 2, "score": 2, "last_activity_date": 1586803143, "creation_date": 1450164280, "question_id": 34283255, "link": "https://stackoverflow.com/questions/34283255/closing-channel-of-unknown-length", "title": "Closing channel of unknown length", "body": "<p>I'm not able to close channel when there is no knowledge about its<br>\nlength</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc gen(ch chan int) {\n    var i int\n    for {\n        time.Sleep(time.Millisecond * 10)\n        ch &lt;- i\n        i++\n        // when no more data (e.g. from db, or event stream)\n        if i &gt; 100 {\n            break\n        }\n    }\n\n    // hot to close it properly?\n    close(ch)\n}\n\nfunc receiver(ch chan int) {\n    for i := range ch {\n        fmt.Println(\"received:\", i)\n    }\n}\n\nfunc main() {\n    ch := make(chan int)\n\n    for i := 0; i &lt; 10; i++ {\n        go gen(ch)\n    }\n\n    receiver(ch)\n}\n</code></pre>\n\n<p>It gives me error </p>\n\n<pre><code>panic: send on closed channel\n\ngoroutine 8 [running]:\nmain.gen(0xc82001a0c0)\n    /home/exu/src/github.com/exu/go-workshops/100-concurrency-channels/16-close-problem.go:12 +0x57\ncreated by main.main\n    /home/exu/src/github.com/exu/go-workshops/100-concurrency-channels/16-close-problem.go:35 +0xbd\n\ngoroutine 1 [panicwait]:\nruntime.gopark(0x0, 0x0, 0x50b8e0, 0x9, 0x10, 0x1)\n    /usr/lib/go/src/runtime/proc.go:185 +0x163\nruntime.main()\n    /usr/lib/go/src/runtime/proc.go:121 +0x2f4\nruntime.goexit()\n    /usr/lib/go/src/runtime/asm_amd64.s:1696 +0x1\n\ngoroutine 6 [sleep]:\ntime.Sleep(0x989680)\n    /usr/lib/go/src/runtime/time.go:59 +0xf9\nmain.gen(0xc82001a0c0)\n    /home/exu/src/github.com/exu/go-workshops/100-concurrency-channels/16-close-problem.go:11 +0x29\ncreated by main.main\n    /home/exu/src/github.com/exu/go-workshops/100-concurrency-channels/16-close-problem.go:33 +0x79\n\ngoroutine 7 [sleep]:\ntime.Sleep(0x989680)\n    /usr/lib/go/src/runtime/time.go:59 +0xf9\nmain.gen(0xc82001a0c0)\n    /home/exu/src/github.com/exu/go-workshops/100-concurrency-channels/16-close-problem.go:11 +0x29\ncreated by main.main\n    /home/exu/src/github.com/exu/go-workshops/100-concurrency-channels/16-close-problem.go:34 +0x9b\nexit status 2\n</code></pre>\n\n<p>It's logical - first goroutine closing channel when the second one tries to send to it. What will be the best approach to close channel in this situation? </p>\n"}, {"tags": ["file", "unix", "go", "libmagic"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1450161502, "post_id": 34280565, "comment_id": 56306775, "body": "In principle, you can: the source of <code>file</code> is <a href=\"https://github.com/file/file\" rel=\"nofollow noreferrer\">online</a>, and doesn&#39;t do anything you can&#39;t reimplement, and <code>man magic</code> describes what it&#39;s trying to do. The <a href=\"https://github.com/file/file/tree/master/magic/Magdir\" rel=\"nofollow noreferrer\">text source</a> used to generate <code>magic.mgc</code> is also online and may be easier to parse. This is a long way from really helping you do that, though."}, {"owner": {"reputation": 3117, "user_id": 4686743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1ca31a61cae3ec468b1c1bff333c3e1?s=128&d=identicon&r=PG", "display_name": "David Castillo", "link": "https://stackoverflow.com/users/4686743/david-castillo"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1450182677, "post_id": 34280565, "comment_id": 56320062, "body": "Thanks for your comment, @twotwotwo. Starting out, I&#39;d like to find a way to use the existing <code>.mgc</code> file, rather than compiling it myself. If it turns out to be impossible, though, I guess I&#39;d have to haha."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1450206893, "post_id": 34280565, "comment_id": 56336628, "body": "It looks like this is the actual .mgc compiler and parser, about 70kb and 3000 lines: <a href=\"https://github.com/file/file/blob/master/src/apprentice.c\" rel=\"nofollow noreferrer\">github.com/file/file/blob/master/src/apprentice.c</a> -- not totally impossible to reverse-engineer but it looks like a pain (like, <code>file</code> is really doing lots of match types internally). There is, incidentally, a very simple sniffer in <a href=\"https://golang.org/src/net/http/sniff.go\" rel=\"nofollow noreferrer\">golang.org/src/net/http/sniff.go</a>"}, {"owner": {"reputation": 3117, "user_id": 4686743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1ca31a61cae3ec468b1c1bff333c3e1?s=128&d=identicon&r=PG", "display_name": "David Castillo", "link": "https://stackoverflow.com/users/4686743/david-castillo"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1450210440, "post_id": 34280565, "comment_id": 56338823, "body": "I hadn&#39;t seen <code>sniff</code>! The <code>file</code> source code is complex indeed. See my answer, which I got from Christos Zoulas himself in the File mailing list. Thanks for the help!"}], "answers": [{"tags": [], "owner": {"reputation": 3117, "user_id": 4686743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1ca31a61cae3ec468b1c1bff333c3e1?s=128&d=identicon&r=PG", "display_name": "David Castillo", "link": "https://stackoverflow.com/users/4686743/david-castillo"}, "is_accepted": true, "score": 2, "last_activity_date": 1510607779, "last_edit_date": 1510607779, "creation_date": 1450210313, "answer_id": 34298493, "question_id": 34280565, "link": "https://stackoverflow.com/questions/34280565/use-magic-mgc-from-another-language/34298493#34298493", "title": "Use magic.mgc from another language", "body": "<p>According to Christos Zoulas, main contributor of file:</p>\n\n<blockquote>\n  <p>If you want to use them directly you\n  need to understand the binary format (which changes over time) and load\n  it in your own data structures. [...] The code that parses the file is in apprentice.c. See <a href=\"https://github.com/file/file/blob/27c975960f00c7c46a3bc7429c5caad3398c2979/src/apprentice.c#L3099\" rel=\"nofollow noreferrer\">check_buffer()</a>\n  for the reader and apprentice_compile() for the writer.  There is\n  a 4 byte magic number, followed by a 4 byte version number followed\n  by MAGIG_SET (2) number of 4 byte counts one for each set (ascii,\n  binary) followed by an array of 'struct magic' entries, in native\n  byte format.</p>\n</blockquote>\n\n<p>So that's the format one should expect! Nevertheless, it has to be parsed just like the raw files.</p>\n"}], "owner": {"reputation": 3117, "user_id": 4686743, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1ca31a61cae3ec468b1c1bff333c3e1?s=128&d=identicon&r=PG", "display_name": "David Castillo", "link": "https://stackoverflow.com/users/4686743/david-castillo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 535, "favorite_count": 0, "accepted_answer_id": 34298493, "answer_count": 1, "score": 1, "last_activity_date": 1510607779, "creation_date": 1450149592, "last_edit_date": 1450182510, "question_id": 34280565, "link": "https://stackoverflow.com/questions/34280565/use-magic-mgc-from-another-language", "title": "Use magic.mgc from another language", "body": "<p>I'm currently working on a project which involves reading <code>file</code>'s magic files (without bindings). I'd like to know how it would be possible to read the file tests from the compiled binary <code>magic.mgc</code> directly, in another language (like Go), as I'm unsure of how its contents should be interpreted.</p>\n"}, {"tags": ["git", "go", "git-submodules"], "comments": [{"owner": {"reputation": 7810, "user_id": 2671317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13862b290e178f5a6c40b8d8dfc4f05?s=128&d=identicon&r=PG", "display_name": "ptierno", "link": "https://stackoverflow.com/users/2671317/ptierno"}, "edited": false, "score": 1, "creation_date": 1450167137, "post_id": 34280436, "comment_id": 56309496, "body": "sounds to me like a documentation task more than anything. you should just supply the instructions to get things working (with or without dependencies) in your README... or... you can just <code>rm -rf **&#47;.git</code> and then commit and push.. sounds like a bad idea though."}, {"owner": {"reputation": 1183, "user_id": 906437, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c2c5b5e4028c774cf620fe99133a3a54?s=128&d=identicon&r=PG", "display_name": "stephenalexbrowne", "link": "https://stackoverflow.com/users/906437/stephenalexbrowne"}, "reply_to_user": {"reputation": 7810, "user_id": 2671317, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f13862b290e178f5a6c40b8d8dfc4f05?s=128&d=identicon&r=PG", "display_name": "ptierno", "link": "https://stackoverflow.com/users/2671317/ptierno"}, "edited": false, "score": 0, "creation_date": 1451596007, "post_id": 34280436, "comment_id": 56845511, "body": "@ptierno thanks for the suggestions. It&#39;s important that the library works with <code>go get</code> by default. It would be annoying if you had to follow additional non-standard instructions for getting the library to work, especially if you didn&#39;t import the library directly (e.g. Library A imports Library B, which imports my library). I tried removing the .git file but that seemed to cause issues with <code>go get</code> and CircleCI. See my answer below for an explanation of what I decided to go with. Basically, I decided to just use submodules."}], "answers": [{"comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1451597555, "post_id": 34551564, "comment_id": 56845913, "body": "+1. I am not sure, but submodules should be compatible with the 1.5/1.6 vendoring detailed in <a href=\"https://blog.gopheracademy.com/advent-2015/vendor-folder/\" rel=\"nofollow noreferrer\">blog.gopheracademy.com/advent-2015/vendor-folder</a>."}], "tags": [], "owner": {"reputation": 1183, "user_id": 906437, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c2c5b5e4028c774cf620fe99133a3a54?s=128&d=identicon&r=PG", "display_name": "stephenalexbrowne", "link": "https://stackoverflow.com/users/906437/stephenalexbrowne"}, "is_accepted": false, "score": 1, "last_activity_date": 1451597635, "last_edit_date": 1451597635, "creation_date": 1451595788, "answer_id": 34551564, "question_id": 34280436, "link": "https://stackoverflow.com/questions/34280436/how-can-i-manage-go-dependencies-while-checking-the-vendor-directory-into-versio/34551564#34551564", "title": "How can I manage Go dependencies while checking the vendor directory into version control?", "body": "<p>Note that the original title of this question was \"How can I prevent git from using submodules by default?\". I have updated the title because the solution I came up with does not involve doing that. As far as I know, there is no way to prevent git from using submodules when the dependencies you add contain a .git directory.</p>\n\n<p>Instead, I've decided to simply let git add the dependencies as submodules. Submodules are admittedly confusing and even come with their own distinct set of commands. What I've discovered is that it doesn't matter. Users of the library will never have to interact with submodules directly because <code>go get</code> and the Go vendor experiment will work fine. Additionally, the <code>glide get</code> and <code>glide install</code> commands will also still work.</p>\n\n<p>So in conclusion, I've decided to stick with submodules, but I don't ever use the submodule commands directly.</p>\n\n<p>You might also be interested in seeing the release notes for <a href=\"https://github.com/albrow/zoom/releases/tag/v0.14.1\" rel=\"nofollow\">version 0.14.1 of Zoom</a>, where I implemented this change and provided some additional context. Glide <a href=\"https://github.com/Masterminds/glide/issues/112\" rel=\"nofollow\">issue #112</a> also provides some more information on the problem.</p>\n\n<p>Update: I spoke too soon. It appears that using submodules the way I did (which is just using the default git behavior) causes problems with <code>go get</code> when installing from scratch. I'm deselecting this as the chosen answer until I can figure out how to make it work.</p>\n"}], "owner": {"reputation": 1183, "user_id": 906437, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c2c5b5e4028c774cf620fe99133a3a54?s=128&d=identicon&r=PG", "display_name": "stephenalexbrowne", "link": "https://stackoverflow.com/users/906437/stephenalexbrowne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 725, "favorite_count": 3, "answer_count": 1, "score": 4, "last_activity_date": 1451597635, "creation_date": 1450148521, "last_edit_date": 1451595375, "question_id": 34280436, "link": "https://stackoverflow.com/questions/34280436/how-can-i-manage-go-dependencies-while-checking-the-vendor-directory-into-versio", "title": "How can I manage Go dependencies while checking the vendor directory into version control?", "body": "<h2>Context</h2>\n\n<p>I have written a Go library and would like to lock-in and vendor the third-party dependencies. That way, any backwards-incompatible changes to these third-party dependencies will not break my library for other users. See the original proposal for the <a href=\"https://docs.google.com/document/d/1Bz5-UB7g2uPBdOx-rw5t9MxJwkfpx90cqG9AFL0JAYo/edit\" rel=\"nofollow\">Go 1.5 Vendoring Experiment</a> for some additional background on how vendoring works.</p>\n\n<p>I am using <a href=\"https://github.com/Masterminds/glide\" rel=\"nofollow\">Glide</a> to manage dependencies and lock-in specific versions. Since the project is a library intended for other people to use, I would like to check the vendor folder into version control. That way, users of the library do not have install Glide in order to use it. All they have to do is set the environment variable <code>GO15VENDOREXPERIMENT=1</code>.</p>\n\n<p>I have used Glide in the past and I'm very comfortable with it. However, I have never tried to submit the vendor folder to version control before. That's why I am suddenly running into problems. I don't believe this is a problem that Glide needs to fix, otherwise I would open an issue there. Really, this strikes me as a problem with git.</p>\n\n<h2>Problem</h2>\n\n<p>I'm using git version 2.5.4. When I run <code>glide install</code>, all the dependencies are cloned and stored in the vendor folder. When I try to add the vendor folder to git, it confusingly tries to create submodules for them. (I believe it has to do with the fact that each dependency is a cloned repo and still has a .git file in it). This is not the behavior that I want, and I was surprised that git does this by default. In fact, it took me a while to figure out what was actually happening and why the dependencies weren't being added correctly.</p>\n\n<p>Git submodules are confusing and break a lot of tools. I just want to add the vendored projects to version control as they are. I want all the source code to be there, as is, so it won't mess up any other tools and will work the way I want it to.</p>\n\n<h2>Question</h2>\n\n<p>Is there a way to turn off this default behavior in git? Ideally it could be on a per-project basis. The only relevant <a href=\"https://www.kernel.org/pub/software/scm/git/docs/git-config.html\" rel=\"nofollow\">options for .gitconfig</a> I could find appear to do with displaying submodules in <code>git diff</code> or fetching submodules recursively with <code>git fetch</code>, <code>pull</code>, or <code>clone</code>.</p>\n\n<p>If there's not, is there a way to do a one-off add the files and folders in the vendor folder without using submodules? I'm hoping for something like <code>git add --no-submodules vendor</code> but I could not find anything like this.</p>\n\n<p>I realize that I could simply remove the .git file in each dependency, but that solution is not ideal for a number of reasons. Chiefly, I or another contributor could easily forget to remove the .git file and as a result the dependency would not be checked in correctly. We would have to remember to do this anytime we update or add a new dependency.</p>\n"}, {"tags": ["debugging", "go", "concurrency", "compiler-errors", "goroutine"], "comments": [{"owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "edited": false, "score": 3, "creation_date": 1450133621, "post_id": 34277857, "comment_id": 56298304, "body": "In <code>Euler2</code> function, you closed channel generated by <code>FibonacciGen</code> but generator doesn&#39;t know about it and still tries to send to closed channel which is panic as you see. You need to notify back to generator to stop writing into that channel."}, {"owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "reply_to_user": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "edited": false, "score": 1, "creation_date": 1450133978, "post_id": 34277857, "comment_id": 56298449, "body": "But if I run only the Euler2 function I will get no error. Why?"}, {"owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "edited": false, "score": 0, "creation_date": 1450134535, "post_id": 34277857, "comment_id": 56298644, "body": "Scheduling of goroutines matter, try a bit sleeping via <code>time.Sleep</code> or force rescheduling via <code>runtime.Gosched</code> so that other goroutine can continue. Then, you should see same error."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1450140908, "post_id": 34277857, "comment_id": 56300602, "body": "Run <code>go test -race</code>."}], "answers": [{"tags": [], "owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "is_accepted": false, "score": 1, "last_activity_date": 1450156702, "creation_date": 1450156702, "answer_id": 34281626, "question_id": 34277857, "link": "https://stackoverflow.com/questions/34277857/go-error-when-compiling-a-group-of-functions/34281626#34281626", "title": "Go - Error when compiling a group of functions", "body": "<p>In your <code>Euler2()</code> you don't check if the channel has been closed. Once it's closed it's unblocked, so it tries to send a value to a now closed channel. </p>\n\n<p>If you only run <code>Euler2()</code> your program might just exit before you send the value to the closed channel.</p>\n"}, {"tags": [], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "is_accepted": true, "score": 0, "last_activity_date": 1450567111, "creation_date": 1450567111, "answer_id": 34376417, "question_id": 34277857, "link": "https://stackoverflow.com/questions/34277857/go-error-when-compiling-a-group-of-functions/34376417#34376417", "title": "Go - Error when compiling a group of functions", "body": "<p>Thank you all. With your help I could understand that I was closing the channel in the wrong way.</p>\n\n<p>Now works correctly.</p>\n\n<pre><code>func Euler2() int {\n\n    c := make(chan int)\n    done := make(chan bool)\n\n    go numbers.FibonacciGen(c, done)\n\n    sum := 0\n    var f int\n\n    for {\n        f = &lt;-c\n        if f &lt; 4000000 {\n            if f%2 == 0 {\n                sum += f\n            }\n        } else {\n            close(done)\n            return sum\n        }\n    }\n}\n\nfunc FibonacciGen(c chan int, done chan bool) {\n\n    for {\n        select {\n        case &lt;-done:\n            return\n        default:\n            for i, j := 0, 1; ; i, j = i+j, i {\n                c &lt;- i\n            }\n        }\n    }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 863, "user_id": 2218023, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/JmNYB.jpg?s=128&g=1", "display_name": "Alessandro Resta", "link": "https://stackoverflow.com/users/2218023/alessandro-resta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 34376417, "answer_count": 2, "score": 1, "last_activity_date": 1450567111, "creation_date": 1450132361, "last_edit_date": 1450290849, "question_id": 34277857, "link": "https://stackoverflow.com/questions/34277857/go-error-when-compiling-a-group-of-functions", "title": "Go - Error when compiling a group of functions", "body": "<p>I'm trying to implement a very simple test function to verify results coming from my solutions for Euler problems.</p>\n\n<p>In the following code I've created a map of slices where on the index 0, I call the function which return a integer and on the index 1, the result I expect from that function.</p>\n\n<pre><code>package euler\n\nimport \"testing\"\n\nfunc TestEulers(t *testing.T) {\n\n    tests := map[string][]int{\n        \"Euler1\": {Euler1(), 233168},\n        \"Euler2\": {Euler2(), 4613732},\n        \"Euler3\": {Euler3(), 6857},\n        \"Euler4\": {Euler4(), 906609},\n        \"Euler5\": {Euler5(), 232792560},\n        \"Euler6\": {Euler6(), 25164150},\n    }\n\n    for key, value := range tests {\n        if value[0] != value[1] {\n            t.Errorf(\"%s\\nExpected: %d\\nGot:%d\",\n                key, value[0], value[1])\n        }\n    }\n}\n</code></pre>\n\n<p>For that map, <strong>every function works fine</strong> and return the result I expect <strong>if</strong> I run one by one or if I comment, let's say, half part of those keys/values.</p>\n\n<p>For example, if I call the the function above with these lines commented the test will PASS.</p>\n\n<pre><code>tests := map[string][]int{\n    \"Euler1\": {Euler1(), 233168},\n    // \"Euler2\": {Euler2(), 4613732},\n    \"Euler3\": {Euler3(), 6857},\n    \"Euler4\": {Euler4(), 906609},\n    // \"Euler5\": {Euler5(), 232792560},\n    // \"Euler6\": {Euler6(), 25164150},\n} \n</code></pre>\n\n<p>But if I arrange the comments on that next way, for example, the test wouldn't.</p>\n\n<pre><code>tests := map[string][]int{\n        //\"Euler1\": {Euler1(), 233168},\n        \"Euler2\": {Euler2(), 4613732},\n        \"Euler3\": {Euler3(), 6857},\n        \"Euler4\": {Euler4(), 906609},\n        //\"Euler5\": {Euler5(), 232792560},\n        // \"Euler6\": {Euler6(), 25164150},\n    }\n</code></pre>\n\n<p>The test will give me an error:</p>\n\n<pre><code>    WARNING: DATA RACE\nWrite by goroutine 6:\n  runtime.closechan()\n      /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/runtime/chan.go:295 +0x0\n  github.com/alesr/project-euler.Euler2()\n      /Users/Alessandro/GO/src/github.com/alesr/project-euler/euler.go:40 +0xd7\n  github.com/alesr/project-euler.TestEulers()\n      /Users/Alessandro/GO/src/github.com/alesr/project-euler/euler_test.go:9 +0x46\n  testing.tRunner()\n      /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/testing/testing.go:456 +0xdc\n\nPrevious read by goroutine 7:\n  runtime.chansend()\n      /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/runtime/chan.go:107 +0x0\n  github.com/alesr/numbers.FibonacciGen.func1()\n      /Users/Alessandro/GO/src/github.com/alesr/numbers/numbers.go:103 +0x59\n\nGoroutine 6 (running) created at:\n  testing.RunTests()\n      /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/testing/testing.go:561 +0xaa3\n  testing.(*M).Run()\n      /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/testing/testing.go:494 +0xe4\n  main.main()\n      github.com/alesr/project-euler/_test/_testmain.go:54 +0x20f\n\nGoroutine 7 (running) created at:\n  github.com/alesr/numbers.FibonacciGen()\n      /Users/Alessandro/GO/src/github.com/alesr/numbers/numbers.go:105 +0x60\n  github.com/alesr/project-euler.Euler2()\n      /Users/Alessandro/GO/src/github.com/alesr/project-euler/euler.go:27 +0x32\n  github.com/alesr/project-euler.TestEulers()\n      /Users/Alessandro/GO/src/github.com/alesr/project-euler/euler_test.go:9 +0x46\n  testing.tRunner()\n      /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/testing/testing.go:456 +0xdc\n==================\npanic: send on closed channel\n\ngoroutine 36 [running]:\ngithub.com/alesr/numbers.FibonacciGen.func1(0xc8200a01e0)\n    /Users/Alessandro/GO/src/github.com/alesr/numbers/numbers.go:103 +0x5a\ncreated by github.com/alesr/numbers.FibonacciGen\n    /Users/Alessandro/GO/src/github.com/alesr/numbers/numbers.go:105 +0x61\n\ngoroutine 1 [chan receive]:\ntesting.RunTests(0x24d038, 0x2f7340, 0x1, 0x1, 0xf78401)\n    /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/testing/testing.go:562 +0xafa\ntesting.(*M).Run(0xc82004df00, 0x1ff0e8)\n    /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/testing/testing.go:494 +0xe5\nmain.main()\n    github.com/alesr/project-euler/_test/_testmain.go:54 +0x210\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/runtime/asm_amd64.s:1696 +0x1\n\ngoroutine 35 [runnable]:\ngithub.com/alesr/strings.Flip(0xc8200727a0, 0x6, 0x0, 0x0)\n    /Users/Alessandro/GO/src/github.com/alesr/strings/strings.go:33 +0x17e\ngithub.com/alesr/project-euler.Euler4(0x1ac9)\n    /Users/Alessandro/GO/src/github.com/alesr/project-euler/euler.go:73 +0x95\ngithub.com/alesr/project-euler.TestEulers(0xc8200b6000)\n    /Users/Alessandro/GO/src/github.com/alesr/project-euler/euler_test.go:11 +0x63\ntesting.tRunner(0xc8200b6000, 0x2f7340)\n    /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/testing/testing.go:456 +0xdd\ncreated by testing.RunTests\n    /private/var/folders/q8/bf_4b1ts2zj0l7b0p1dv36lr0000gp/T/workdir/go/src/testing/testing.go:561 +0xaa4\nexit status 2\nFAIL    github.com/alesr/project-euler  0.022s\n</code></pre>\n\n<p>But still, I checked every single function and they work just as expected.\nYou can access the <a href=\"https://github.com/alesr/project-euler/blob/master/euler.go\" rel=\"nofollow\">Euler source code</a> or the packages <a href=\"https://github.com/alesr/numbers/blob/master/numbers.go\" rel=\"nofollow\">numbers</a> and <a href=\"https://github.com/alesr/strings/blob/master/strings.go\" rel=\"nofollow\">strings</a> if you want.</p>\n\n<p>At Euler2 function I have a defer statement to close the channel which is receiving from FibonacciGen.</p>\n\n<p>And on FibonacciGen I do have another defer statement to close the same channel.</p>\n\n<p>It seems that's the my first error. I should have just one and not two statements to close the channel, since they are trying to close the same thing. Is that correct?</p>\n\n<p>Second (and here I'm even a little more unsure), the defer statement will prevent the function to be called until the main goroutine returns, right? Independently if I call it on the package main or not? </p>\n\n<p>Plus, since the data is flowing through the channel from FibonacciGen to the main function. It seems for me, that if I close the channel at FibonacciGen I don't need to notify the main function. But If I close the channel on the main function I do have to notify FibonacciGen to stop trying to send to this channel.</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 15, "last_activity_date": 1450131318, "last_edit_date": 1450131318, "creation_date": 1450130966, "answer_id": 34277541, "question_id": 34277464, "link": "https://stackoverflow.com/questions/34277464/golang-app-using-sync-waitgroup-channels-never-exits/34277541#34277541", "title": "Golang app using sync.WaitGroup &amp; channels never exits", "body": "<p>You're never closing the <code>fetchedSymbols</code> channel, so that range loop will never exit.</p>\n\n<p>One way to handle this is to use use the WaitGroup you already have to signal when to close the channel. Ranging over <code>fetchedSymbols</code> is enough to block the progress in main, and you don't need another channel or WaitGroup.</p>\n\n<pre><code>...\ngo func() {\n    wg.Wait()\n    close(fetchedSymbols)\n}()\n\nfor response := range fetchedSymbols {\n    fmt.Println(\"fetched \" + response)\n}\n\n...\n</code></pre>\n"}], "owner": {"reputation": 6558, "user_id": 93222, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/1e206e741f51c787b0fd29550fab8d98?s=128&d=identicon&r=PG", "display_name": "Mickel", "link": "https://stackoverflow.com/users/93222/mickel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1887, "favorite_count": 2, "accepted_answer_id": 34277541, "answer_count": 1, "score": 5, "last_activity_date": 1450131318, "creation_date": 1450130607, "question_id": 34277464, "link": "https://stackoverflow.com/questions/34277464/golang-app-using-sync-waitgroup-channels-never-exits", "title": "Golang app using sync.WaitGroup &amp; channels never exits", "body": "<p>I use <code>sync.WaitGroup</code>, <code>defer wg.Close()</code> and <code>wg.Wait()</code> to wait for my goroutines to complete.</p>\n\n<p>The program do wait, but it never exits.</p>\n\n<p>This is my program (runnable):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n    \"sync\"\n)\n\nvar symbols = []string{\n    \"ASSA-B.ST\",\n    \"ELUX-B.ST\",\n    \"HM-B.ST\",\n}\n\nfunc main() {\n\n    fmt.Println(\"fetching quotes...\")\n\n    fetchedSymbols := make(chan string)\n    var wg sync.WaitGroup\n    wg.Add(len(symbols))\n\n    for _, symbol := range symbols {\n        go fetchSymbol(symbol, &amp;wg, fetchedSymbols)\n    }\n\n    for response := range fetchedSymbols {\n        fmt.Println(\"fetched \" + response)\n    }\n\n    wg.Wait()\n\n    fmt.Println(\"done\")\n\n}\n\nfunc fetchSymbol(symbol string, wg *sync.WaitGroup, c chan&lt;- string) {\n    defer wg.Done()\n    resp, err := http.Get(\"http://ichart.yahoo.com/table.csv?s=\" + symbol + \"&amp;a=0&amp;b=1&amp;c=2000\")\n    defer resp.Body.Close()\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    out, err := os.Create(\"./stock-quotes/\" + symbol + \".csv\")\n    defer out.Close()\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    io.Copy(out, resp.Body)\n    c &lt;- symbol\n}\n</code></pre>\n\n<p>Shouldn't this program exit when all the quotes have been downloaded? (FYI: I just started learning GO)</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1450130195, "post_id": 34277201, "comment_id": 56296722, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/33336850/environment-variables-specified-on-app-yaml-but-its-not-fetching-on-main-go\">Environment variables specified on app.yaml but it&#39;s not fetching on main.go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 757655, "user_id": 95810, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/e8d5fe90f1fe2148bf130cccd4dc311c?s=128&d=identicon&r=PG", "display_name": "Alex Martelli", "link": "https://stackoverflow.com/users/95810/alex-martelli"}, "is_accepted": false, "score": 1, "last_activity_date": 1450143568, "last_edit_date": 1495541044, "creation_date": 1450143568, "answer_id": 34279662, "question_id": 34277201, "link": "https://stackoverflow.com/questions/34277201/passing-values-to-a-go-application-on-app-engine-with-environment-variables/34279662#34279662", "title": "Passing values to a Go application on App Engine with Environment variables", "body": "<p>As <a href=\"https://stackoverflow.com/questions/29186031/how-to-set-environment-variables-on-google-appengine\">how to set environment variables on google appengine?</a> explains, \"environment variables are not ready until all the init functions are run and I would say same might be applying to the global variable declaration too. It works from a function because by that time environment variables are set\".</p>\n\n<p>You appear to be saying otherwise -- can you try the example code at the other Q I pointed to, which was working when that Q was answered, and tell us what you observe instead?</p>\n"}], "owner": {"reputation": 144, "user_id": 788275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb33150db41e23ebf0850f8cc263e253?s=128&d=identicon&r=PG", "display_name": "Andrew Watson", "link": "https://stackoverflow.com/users/788275/andrew-watson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 280, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1450143568, "creation_date": 1450129622, "question_id": 34277201, "link": "https://stackoverflow.com/questions/34277201/passing-values-to-a-go-application-on-app-engine-with-environment-variables", "title": "Passing values to a Go application on App Engine with Environment variables", "body": "<p>According to the docs, you just have to include them in the app.yaml file\n<a href=\"https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Defining_environment_variables\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/config/appconfig#Go_app_yaml_Defining_environment_variables</a></p>\n\n<p>So I did that like this:</p>\n\n<pre><code>env_variables:\n    DEVDOT_OAUTH_CLIENT_ID: 'xxxxx'\n    DEVDOT_OAUTH_CLIENT_SECRET: 'xxxxxx'\n</code></pre>\n\n<p>But when my application runs, it doesn't get these values.  I'm running on a MVM runtime so I removed my init() function and tried calling os.Getenv() from both main() and from a handler I had assigned to the /_ah/start path.</p>\n\n<p>Any ideas?</p>\n"}, {"tags": ["pointers", "go"], "comments": [{"owner": {"reputation": 2820, "user_id": 2562283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6ef4e835ba48416df3d5607ae1a89bbf?s=128&d=identicon&r=PG", "display_name": "E. Moffat", "link": "https://stackoverflow.com/users/2562283/e-moffat"}, "edited": false, "score": 9, "creation_date": 1450125789, "post_id": 34276205, "comment_id": 56294414, "body": "You&#39;re comparing the values stored in the pointers, not the pointers themselves. Try <code>fmt.Println(p == q)</code>."}, {"owner": {"reputation": 9620, "user_id": 1783163, "user_type": "registered", "accept_rate": 97, "profile_image": "https://i.stack.imgur.com/BfUwH.jpg?s=128&g=1", "display_name": "peterh", "link": "https://stackoverflow.com/users/1783163/peterh"}, "edited": false, "score": 0, "creation_date": 1503408521, "post_id": 34276205, "comment_id": 78595494, "body": "Related (not dupe) <a href=\"https://stackoverflow.com/q/45818964/1783163\">question</a> about the <code>&lt;</code> / <code>&gt;</code> operators."}], "answers": [{"comments": [{"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "edited": false, "score": 0, "creation_date": 1450126162, "post_id": 34276260, "comment_id": 56294661, "body": "Are you sure about that? the two variables should hold the values returned by the functions (which are the addresses of the results)"}, {"owner": {"reputation": 33, "user_id": 5679552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2b2bb4b9dd0f6144eda492037c3ba2?s=128&d=identicon&r=PG&f=1", "display_name": "fufex79", "link": "https://stackoverflow.com/users/5679552/fufex79"}, "edited": false, "score": 0, "creation_date": 1450126165, "post_id": 34276260, "comment_id": 56294664, "body": "Ok, understood. But why then f() == f() is false. Each call of f() should return a pointer pointing to the same variable?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1450126176, "post_id": 34276260, "comment_id": 56294670, "body": "What methods do you think are being compared? He&#39;s comparing two <code>*int</code>, both of which are 1, so they&#39;re equal after dereferencing."}, {"owner": {"reputation": 3125, "user_id": 2878796, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8bxWv.png?s=128&g=1", "display_name": "UnholySheep", "link": "https://stackoverflow.com/users/2878796/unholysheep"}, "reply_to_user": {"reputation": 33, "user_id": 5679552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2b2bb4b9dd0f6144eda492037c3ba2?s=128&d=identicon&r=PG&f=1", "display_name": "fufex79", "link": "https://stackoverflow.com/users/5679552/fufex79"}, "edited": false, "score": 0, "creation_date": 1450126356, "post_id": 34276260, "comment_id": 56294769, "body": "@fufex79 the values would only be equal if the compiler optimised the function call to return the same value (the same address), however he shouldn&#39;t do that, as that value may be later modified. so each call to the function creates a new variable (with a new address)"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450126877, "post_id": 34276260, "comment_id": 56295067, "body": "@JimB as I stated originally, I wasn&#39;t sure of what comparison was being done, only that it wasn&#39;t the pointers. I thought those were function pointers, not just pointers holding the returned <code>int*</code> haha. Anyway, I&#39;ve edited to remove the random nonsense about equality comparisons on functions. The main points are still true... The values are equal because he dereferenced."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 10, "last_activity_date": 1450126964, "last_edit_date": 1450126964, "creation_date": 1450125889, "answer_id": 34276260, "question_id": 34276205, "link": "https://stackoverflow.com/questions/34276205/comparing-pointers-in-go/34276260#34276260", "title": "Comparing pointers in Go", "body": "<p>You aren't comparing the pointers themselves because you use the 'derefernce operator' <code>*</code> which returns the value stored at that address. In your example code, you've called the methods which returned two different pointers. The value stored at each of those different addresses happens to be <code>1</code>. When you derefernce the pointer you get the value stored there so you're just comparing <code>1 == 1</code> which is true.</p>\n\n<p>Comparing the pointers themselves you get false; </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var p = f()\n    var q = f2()\n    fmt.Println(*p == *q) // why true?\n\n    fmt.Println(p == q) // pointer comparison, compares the memory address value stored\n    // rather than the the value which resides at that address value\n\n    // check out what you're actually getting\n    fmt.Println(p) // hex address values here\n    fmt.Println(q)\n    fmt.Println(*p) // 1\n    fmt.Println(*q) // 1\n}\n\nfunc f() *int {\n    v := 1\n    return &amp;v\n}\n\nfunc f2() *int {\n    w := 1\n    return &amp;w\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/j2FCGHrp18\" rel=\"noreferrer\">https://play.golang.org/p/j2FCGHrp18</a></p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 5075253, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-8l1WEdFn_sQ/AAAAAAAAAAI/AAAAAAAAAGc/TGG2-j8cSvc/photo.jpg?sz=128", "display_name": "Nibir Bora", "link": "https://stackoverflow.com/users/5075253/nibir-bora"}, "is_accepted": false, "score": 2, "last_activity_date": 1450142202, "creation_date": 1450142202, "answer_id": 34279477, "question_id": 34276205, "link": "https://stackoverflow.com/questions/34276205/comparing-pointers-in-go/34279477#34279477", "title": "Comparing pointers in Go", "body": "<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    var p = f()\n    var q = f2()\n\n    fmt.Println(*p == *q)\n    /* is true, since *p = *q = 1 */\n\n    fmt.Println(p == q)\n    /* is false, since *p and *q store two different memory addresses */\n}\n\nfunc f() *int {\n    v := 1\n    return &amp;v\n}\n\nfunc f2() *int {\n    w := 1\n    return &amp;w\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/i1tK4hhjOf\" rel=\"nofollow\">https://play.golang.org/p/i1tK4hhjOf</a></p>\n"}], "owner": {"reputation": 33, "user_id": 5679552, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1e2b2bb4b9dd0f6144eda492037c3ba2?s=128&d=identicon&r=PG&f=1", "display_name": "fufex79", "link": "https://stackoverflow.com/users/5679552/fufex79"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16534, "favorite_count": 0, "accepted_answer_id": 34276260, "answer_count": 2, "score": 2, "last_activity_date": 1450142202, "creation_date": 1450125678, "question_id": 34276205, "link": "https://stackoverflow.com/questions/34276205/comparing-pointers-in-go", "title": "Comparing pointers in Go", "body": "<p>I am reading in my Go book that pointers are comparable. It says: two pointers are equal if and only if they Point to the same variable or both are nil.</p>\n\n<p>So why is my following code printing 'true' when comparing two pointers which are pointing to two different variables?</p>\n\n<pre><code>func main() {\n    var p = f()\n    var q = f2()\n    fmt.Println(*p == *q) // why true?\n}\n\nfunc f() *int {\n    v := 1\n    return &amp;v\n}\n\nfunc f2() *int {\n    w := 1\n    return &amp;w\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450118864, "post_id": 34274351, "comment_id": 56290450, "body": "Can you update with your final json?"}, {"owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1450119087, "post_id": 34274351, "comment_id": 56290567, "body": "@evanmcdonnal I updated OP with final output. Thanks for looking"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450119276, "post_id": 34274351, "comment_id": 56290676, "body": "Single quotes aren&#39;t valid json either. Can you fix what is generating this output?"}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450122769, "post_id": 34274613, "comment_id": 56292710, "body": "Note that this doesn&#39;t work as soon as you encounter escaped quotes."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1450119664, "last_edit_date": 1450119664, "creation_date": 1450119606, "answer_id": 34274613, "question_id": 34274351, "link": "https://stackoverflow.com/questions/34274351/removing-invalid-characters-from-json-string/34274613#34274613", "title": "removing invalid characters from (json) string", "body": "<p>As JimB pointed out in comments single quotes are not valid json. So if you run another string replace <code>k = strings.Replace(k, `'`, `\"`, -1)</code> to produce this;</p>\n\n<pre><code>[{\n    \"name\": \"Leroy\",\n    \"phone\": \"12345\"\n}, {\n    \"name\": \"Jimmy\",\n    \"phone\": \"23456\"\n}]\n</code></pre>\n\n<p>Then it should work as you expect.</p>\n"}], "owner": {"reputation": 35121, "user_id": 577455, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/2f5b02182d3fa5ca4afeb39c32f09953?s=128&d=identicon&r=PG", "display_name": "Leahcim", "link": "https://stackoverflow.com/users/577455/leahcim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2589, "favorite_count": 0, "accepted_answer_id": 34274613, "answer_count": 1, "score": 0, "last_activity_date": 1450119664, "creation_date": 1450118736, "last_edit_date": 1450119059, "question_id": 34274351, "link": "https://stackoverflow.com/questions/34274351/removing-invalid-characters-from-json-string", "title": "removing invalid characters from (json) string", "body": "<p>I'm am executing a command in a go program which gives me some output with the structure</p>\n\n<pre><code>  c := exec.Command(\"mycommand\")\n  stdout, _ := c.Output()\n</code></pre>\n\n<p>Output</p>\n\n<pre><code>{\n 'name': 'mike',\n 'phone': '12345'\n},\n{\n 'name': 'jim',\n 'phone': '1234'\n}, //notice the final comma\n</code></pre>\n\n<p>To make valid json, I am trying to prepend <code>[</code> and then append <code>]</code>, and, finally, remove the final comma. </p>\n\n<pre><code>k := \"[\"\nmystring := string(stdout)\nk += mystring\nk += \"]\"\nstr := strings.Replace(k, \"},]\", \"}]\", -1)\n\nw.Header().Set(\"Content-Type\", \"application/json; charset=utf-8\")\nfmt.Fprintf(w, str)\n</code></pre>\n\n<p>When I put the final product in a json validator, I get this error</p>\n\n<pre><code>Error: Parse error on line 1:\n[{  \n---^\nExpecting 'STRING', '}', got 'undefined'\n</code></pre>\n\n<p>Question: is there a way to do json.Compact or something similar on a string, or how can I make valid json in this situation?</p>\n\n<p>Update</p>\n\n<p>this is the output that my coding magic produces. I'm not sure exactly what part of it is <code>invalid</code></p>\n\n<pre><code>[{\n  'name': 'Leroy',\n  'phone': '12345'\n},\n{\n  'name': 'Jimmy',\n  'phone': '23456'\n}]\n</code></pre>\n"}, {"tags": ["reflection", "go"], "comments": [{"owner": {"reputation": 1889, "user_id": 1036501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z8PwP.png?s=128&g=1", "display_name": "zstewart", "link": "https://stackoverflow.com/users/1036501/zstewart"}, "edited": false, "score": 0, "creation_date": 1450113703, "post_id": 34272837, "comment_id": 56287592, "body": "You can use reflection to look up the names of members that exist on the structure and get access to the members. You don&#39;t actually get an instance of the structure back ever, since the structures being used are compiled in; instead you have to work with the set of interfaces to the structure properties provided by reflection. These give access to read and set functions which can be used to manipulate the underlying structure (as long as it is modifiable)."}, {"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "reply_to_user": {"reputation": 1889, "user_id": 1036501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z8PwP.png?s=128&g=1", "display_name": "zstewart", "link": "https://stackoverflow.com/users/1036501/zstewart"}, "edited": false, "score": 0, "creation_date": 1450114149, "post_id": 34272837, "comment_id": 56287879, "body": "That&#39;s essentially what I&#39;m doing.  The wrapping in an &#39;interface{}&#39; is purely invented to mirror the problem I&#39;m having in my code.  I did actually find a work around, but the go library seems to exhibit this pattern of unwrapping an interface{} into a concrete type via interface.  (<a href=\"https://golang.org/src/encoding/json/decode.go?s=2621:2669#L64\" rel=\"nofollow noreferrer\">golang.org/src/encoding/json/decode.go?s=2621:2669#L64</a>)"}, {"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "reply_to_user": {"reputation": 1889, "user_id": 1036501, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/z8PwP.png?s=128&g=1", "display_name": "zstewart", "link": "https://stackoverflow.com/users/1036501/zstewart"}, "edited": false, "score": 0, "creation_date": 1450201402, "post_id": 34272837, "comment_id": 56333348, "body": "This question is poorly worded and doesn&#39;t properly reflect the issue I&#39;m having (although I thought it did).   I&#39;m working on recreating the problem more fully and reading the json decoding section as I go.  Thanks for everyones input, I will post a new question when ready and put a link here.  Thanks for everyone&#39;s input."}], "answers": [{"comments": [{"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1450113514, "post_id": 34272896, "comment_id": 56287458, "body": "That doesn&#39;t answer the question.  I want to know how to pass an interface in and access the underlying struct."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 1, "creation_date": 1450113649, "post_id": 34272896, "comment_id": 56287559, "body": "@Gary: you can&#39;t access the underlying struct if you don&#39;t pass in a pointer. Wrapping it in an interface again is superfluous, since it&#39;s put into an <code>interface{}</code> in the function call."}, {"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1450113801, "post_id": 34272896, "comment_id": 56287665, "body": "How does this work then:     74\tfunc Unmarshal(data []byte, v interface{}) error {"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1450114073, "post_id": 34272896, "comment_id": 56287836, "body": "@Gary, I&#39;m guessing you&#39;re referring to the json package??, You get an error if you don&#39;t pass in a pointer: <a href=\"http://play.golang.org/p/55mMqnZt8c\" rel=\"nofollow noreferrer\">play.golang.org/p/55mMqnZt8c</a>"}, {"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1450114343, "post_id": 34272896, "comment_id": 56287993, "body": "That&#39;s probably the confusion, I am passing in a pointer.  (&amp;iface) (or at least it certainly looks that way)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 4, "creation_date": 1450114509, "post_id": 34272896, "comment_id": 56288100, "body": "@Gary, a pointer to an interface is mostly useless, and is almost always a mistake. A pointer to an interface doesn&#39;t give you a pointer to it&#39;s value; you can&#39;t modify a struct field without a pointer to that struct."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1450116583, "post_id": 34272896, "comment_id": 56289174, "body": "@Gary: maybe this will better explain your confusion with the json package: <a href=\"http://play.golang.org/p/R2bb71fFoL\" rel=\"nofollow noreferrer\">play.golang.org/p/R2bb71fFoL</a>"}, {"owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "edited": false, "score": 0, "creation_date": 1450118448, "post_id": 34272896, "comment_id": 56290225, "body": "I&#39;ll be digging into this, this answer and the below one are relevant.  Thanks for the info.  I&#39;ll spend some time wrapping my head around it."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 4, "last_activity_date": 1450120749, "last_edit_date": 1450120749, "creation_date": 1450113465, "answer_id": 34272896, "question_id": 34272837, "link": "https://stackoverflow.com/questions/34272837/golang-get-a-struct-from-an-interface-via-reflection/34272896#34272896", "title": "golang get a struct from an interface via reflection", "body": "<p>You don't want to pass a pointer to the interface, you want to pass in a pointer to your struct itself. </p>\n\n<pre><code>robot := &amp;Robot{}\nf(robot)\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/owv-Y4dnkl\" rel=\"nofollow\">http://play.golang.org/p/owv-Y4dnkl</a></p>\n\n<p>The moment you assigned <code>robot</code> to <code>iface</code>, you created a copy of the <code>robot</code> value. There's is no way to ever get a reference back to <code>robot</code> from <code>iface</code>.</p>\n\n<p>When you pass in <code>f(&amp;iface)</code>, the call to <code>reflect.ValueOf(i).Elem()</code> is just returning the inner <code>iface</code> value, not a <code>Robot</code> struct value.</p>\n"}, {"tags": [], "owner": {"reputation": 955, "user_id": 2971199, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb63823d6104c2aa08f929d8ac9d6a92?s=128&d=identicon&r=PG", "display_name": "damick", "link": "https://stackoverflow.com/users/2971199/damick"}, "is_accepted": false, "score": -1, "last_activity_date": 1523489617, "creation_date": 1523489617, "answer_id": 49785848, "question_id": 34272837, "link": "https://stackoverflow.com/questions/34272837/golang-get-a-struct-from-an-interface-via-reflection/49785848#49785848", "title": "golang get a struct from an interface via reflection", "body": "<p>You could use Type Assertion.</p>\n\n<pre><code>value, ok := i(Robot)\nif ok {\n    fmt.Println(value.Id)\n}\n</code></pre>\n\n<p>From this <a href=\"https://stackoverflow.com/a/40946999/2971199\">stackoverflow post</a>.</p>\n"}, {"comments": [{"owner": {"reputation": 1484, "user_id": 7410383, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211966226936527/picture?type=large", "display_name": "Edeki Okoh", "link": "https://stackoverflow.com/users/7410383/edeki-okoh"}, "edited": false, "score": 0, "creation_date": 1550785443, "post_id": 54816264, "comment_id": 96409597, "body": "Please explain why this will help the user."}, {"owner": {"reputation": 59, "user_id": 10060023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97bedefefc59dde4e218382cb2e5f22?s=128&d=identicon&r=PG&f=1", "display_name": "J Korpics", "link": "https://stackoverflow.com/users/10060023/j-korpics"}, "reply_to_user": {"reputation": 1484, "user_id": 7410383, "user_type": "registered", "profile_image": "https://graph.facebook.com/10211966226936527/picture?type=large", "display_name": "Edeki Okoh", "link": "https://stackoverflow.com/users/7410383/edeki-okoh"}, "edited": false, "score": 0, "creation_date": 1550916340, "post_id": 54816264, "comment_id": 96454446, "body": "Explanation added."}], "tags": [], "owner": {"reputation": 59, "user_id": 10060023, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c97bedefefc59dde4e218382cb2e5f22?s=128&d=identicon&r=PG&f=1", "display_name": "J Korpics", "link": "https://stackoverflow.com/users/10060023/j-korpics"}, "is_accepted": false, "score": 1, "last_activity_date": 1550916994, "last_edit_date": 1550916994, "creation_date": 1550783458, "answer_id": 54816264, "question_id": 34272837, "link": "https://stackoverflow.com/questions/34272837/golang-get-a-struct-from-an-interface-via-reflection/54816264#54816264", "title": "golang get a struct from an interface via reflection", "body": "<p>In your original code, use:</p>\n\n<pre><code>var iface interface{} = &amp;robot\nf(iface)\n</code></pre>\n\n<p><strong>Explanation</strong><br/>\nIn the original version, we are sending in the address of the interface variable (which is a copy of the robot). This sends a pointer of type interface, and so reflect works on the copy of the robot.</p>\n\n<pre><code>var iface interface{} = robot\nf(&amp;iface)\n</code></pre>\n\n<p>What we need to do, is assign a pointer of type robot to the interface variable. Thus, when we send the interface we are sending the pointer of type robot, so reflect works with the actual robot object and not a copy.</p>\n\n<pre><code>var iface interface{} = &amp;robot\nf(iface)\n</code></pre>\n"}], "owner": {"reputation": 2161, "user_id": 73521, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/d7255055d1d9db546a73b0180f265245?s=128&d=identicon&r=PG", "display_name": "Gary", "link": "https://stackoverflow.com/users/73521/gary"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19595, "favorite_count": 1, "answer_count": 3, "score": 6, "last_activity_date": 1550916994, "creation_date": 1450113234, "last_edit_date": 1450300138, "question_id": 34272837, "link": "https://stackoverflow.com/questions/34272837/golang-get-a-struct-from-an-interface-via-reflection", "title": "golang get a struct from an interface via reflection", "body": "<p>Original question:</p>\n\n<p>I'm trying to do some deserialization and I'm a little confused about how to access a struct when passing in an interface.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Robot struct {\n    Id int\n}\n\nfunc f(i interface{}) {\n    v := reflect.ValueOf(i).Elem().FieldByName(\"Id\")\n    fmt.Println(\"fields: \", reflect.ValueOf(i).Elem().NumField()) \n    ptr := v.Addr().Interface().(*int)\n    *ptr = 100\n}\n\nfunc main() {\n    robot := Robot{}\n\n    var iface interface{} = robot // if I omit this line and pass in robot this works\n    f(&amp;iface)\n    fmt.Println(robot.Id) //I want to get here 100\n\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/y6UN3KZxRB\" rel=\"noreferrer\">http://play.golang.org/p/y6UN3KZxRB</a></p>\n\n<p>The play example works if you just pass in the struct directly, however as it's possible for anything to be passed in that implements a specific interface (in my example case I'm just using the empty interface). However I can't figure out how to then treat it as a struct underneath.</p>\n\n<p>Updated:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype MessageOne struct {\n    Header   string `FixedWidth:0,4`\n    FieldOne string `FixedWidth:\"4,4\"`\n    FieldTwo string `FixedWidth:\"8,4\"`\n}\n\ntype MessageTwo struct {\n    FieldX string `FixedWidth:\"X,Y\"`\n    FieldY string `FixedWidth:\"X,Y\"`\n}\n\nvar (\n    messageMap = map[string]interface{}{\n        \"msg1\": MessageOne{FieldOne: \"testValueUnchanged\"},\n        \"msg2\": MessageTwo{},\n    }\n)\n\nfunc deserialize(input string, i interface{}) interface{} {\n    value := reflect.ValueOf(i)\n    fmt.Println(\"1st Value Type: \", value.Kind())\n    // unswarp ptr\n    value = value.Elem()\n    fmt.Println(\"Unwrapped: \", value.Kind())\n    value = value.Elem()\n    fmt.Println(\"Unwrapped: \", value.Kind())\n\n    // Create a copy that I can set?\n    copyValue := reflect.New(value.Type()).Elem()\n    fmt.Println(\"Orig Struct is settable\", value.CanSet())\n    fmt.Println(\"Orig StructField0 is settable\", value.Field(0).CanSet())\n\n    fmt.Println(\"Copy is: \", copyValue.Kind())\n    fmt.Println(\"Copy Struct is settable\", copyValue.CanSet())\n    fmt.Println(\"Copy StructField0 is settable\", copyValue.Field(0).CanSet())\n    fmt.Println(\"Orig struct type is: \", value.Type())\n    fmt.Println(\"Copy struct type is: \", copyValue.Type())\n\n    copyValue.Field(1).SetString(\"testValueChanged\")\n\n    return copyValue.Interface()\n}\n\nfunc GetMessageFromInput(input string) interface{} {\n    selector := input[0:4]\n    fmt.Println(selector)\n    field := messageMap[selector]\n    return deserialize(input, &amp;field)\n}\n\nfunc main() {\n    val := messageMap[\"msg1\"]\n\n    serializedData := \"msg1.012345678\"\n\n    deserializedVal := GetMessageFromInput(serializedData)\n\n    //msg1 := deserializedVal.(MessageOne)\n\n    fmt.Printf(\"Orig: %+v \\nReceived: %+v\", val, deserializedVal)\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/Cj9oPPGSLM\" rel=\"noreferrer\">http://play.golang.org/p/Cj9oPPGSLM</a></p>\n\n<p>I got the idea of copying my struct and thereby getting an addressable instance from here: <a href=\"https://gist.github.com/hvoecking/10772475\" rel=\"noreferrer\">https://gist.github.com/hvoecking/10772475</a></p>\n\n<p>So I guess my question is now, is there a mechanism to access an addressable / settable struct without having to resort to a copy? </p>\n\n<p>The underlying problem is taking strings (byte arrays really) and having a struct have the necessary info to effectively deserialize it without having to write a couple dozen deserialization functions which would suck to maintain.  So the tags in those sample structs aren't addressed in the sample question, but accessing the structs tag fields would provide the offsets from which to populate the struct from the input bytes.  Obviously I haven't gotten that far.  Part of my frustration here is that it seems I've worked very hard to not get very far and I don't feel like i've learned much in the process.</p>\n\n<p>Some additional play edits that got me my tags back:\n<a href=\"http://play.golang.org/p/2DbbWLDKPI\" rel=\"noreferrer\">http://play.golang.org/p/2DbbWLDKPI</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 925, "user_id": 94416, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c6bdec5132fd3906e89001ad195df15b?s=128&d=identicon&r=PG", "display_name": "Chadit", "link": "https://stackoverflow.com/users/94416/chadit"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1450109173, "post_id": 34271248, "comment_id": 56284562, "body": "ah you are probably correct, sorry I am just learning go and was using Atom.  I followed the steps to run the formatter on save."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1450110251, "post_id": 34271248, "comment_id": 56285333, "body": "<code>golint</code> (which it seems you&#39;re referring to) has no options, and is only to provide suggestions that match the preferred style guide. Turn it off if you don&#39;t like its suggestions. However, I would still run it occasionally to see if there are any other style issues you may have in your code."}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1450112725, "post_id": 34271248, "comment_id": 56286970, "body": "If you follow the Go naming conventions, <code>UserID</code> is the correct name for something containing a &quot;user identity&quot; (<code>ID</code> is short for &quot;identity&quot; and should be all-uppercase) and <code>UserId</code> is the correct name for a variable containing a users&#39;s id (that is, the most basic part of the user&#39;s personality)."}, {"owner": {"reputation": 925, "user_id": 94416, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c6bdec5132fd3906e89001ad195df15b?s=128&d=identicon&r=PG", "display_name": "Chadit", "link": "https://stackoverflow.com/users/94416/chadit"}, "edited": false, "score": 0, "creation_date": 1450117334, "post_id": 34271248, "comment_id": 56289593, "body": "I don&#39;t have control over the Database which uses stuff like UserId, I know that I can create maps and stuff in the struct.  I was worried about a possible performance hit when moving from one map to the next.     Example:  Database UserId, go code UserID, json output UserId"}], "answers": [{"tags": [], "owner": {"reputation": 24651, "user_id": 628273, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/999ac8e29041aeeda8e0e35b416efa04?s=128&d=identicon&r=PG", "display_name": "Teoman Soygul", "link": "https://stackoverflow.com/users/628273/teoman-soygul"}, "is_accepted": true, "score": 6, "last_activity_date": 1450113192, "last_edit_date": 1450113192, "creation_date": 1450111277, "answer_id": 34272213, "question_id": 34271248, "link": "https://stackoverflow.com/questions/34271248/is-it-possible-to-override-the-automatic-formatter-in-go/34272213#34272213", "title": "is it possible to override the automatic formatter in go", "body": "<p>Just fork the <code>golint</code> repo and modify the <code>lintNames</code> function as you like: <a href=\"https://github.com/golang/lint/blob/32a87160691b3c96046c0c678fe57c5bef761456/lint.go#L510\" rel=\"nofollow\">https://github.com/golang/lint/blob/32a87160691b3c96046c0c678fe57c5bef761456/lint.go#L510</a></p>\n\n<p>My suggestion: Don't override conventions or your code will look alien to other Gophers!</p>\n"}], "owner": {"reputation": 925, "user_id": 94416, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/c6bdec5132fd3906e89001ad195df15b?s=128&d=identicon&r=PG", "display_name": "Chadit", "link": "https://stackoverflow.com/users/94416/chadit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "accepted_answer_id": 34272213, "answer_count": 1, "score": 0, "last_activity_date": 1450113192, "creation_date": 1450108282, "question_id": 34271248, "link": "https://stackoverflow.com/questions/34271248/is-it-possible-to-override-the-automatic-formatter-in-go", "title": "is it possible to override the automatic formatter in go", "body": "<p>In a GO struct I personally do not like the id fields following the convension - UserID.  Is there a way to tell the GO formatter that UserId is ok and to stop giving me a warning?</p>\n"}, {"tags": ["go", "ssl-certificate", "reverse-proxy"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1450103867, "post_id": 34269540, "comment_id": 56280463, "body": "What is returning the certificate error? What is <code>httpProxy</code>? If apache is behind the go server, why is it https at all?"}, {"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450104169, "post_id": 34269540, "comment_id": 56280701, "body": "p.httpProxy = &amp;httputil.ReverseProxy{ \t\tDirector: p.directorApache, \t} Because if somebody connects directly to my apache. And if I use the reverse Proxy as https and apache as http then I get erros about mixed content because of mixing https and http..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450104494, "post_id": 34269540, "comment_id": 56280966, "body": "is it the proxy that&#39;s returning the cert error? Does apache have a cert signed by a trusted CA? You&#39;re setting <code>InsecureSkipVerify: true</code> on the listener, but that&#39;s a client setting (though you shouldn&#39;t need that at all with a valid cert)."}, {"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450104786, "post_id": 34269540, "comment_id": 56281212, "body": "I think the proxy returning the errorr as response form the Apache. I generated a self-signed cert for localhost with a tutorial, because i am new to SSL and those certificates.  How can i verify if its a valid cert or how can I get a valid cert? Oh ok thank you, i didn&#39;t know that."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1450105404, "post_id": 34269540, "comment_id": 56281689, "body": "I would advise against using apache directly and via reverse-proxy for the same project, as it only serves to complicate the architecture. If you need to connect directly to apache for some reason, connect to it for all resources it serves, or even put that in front of your go server."}], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "edited": false, "score": 0, "creation_date": 1450165358, "post_id": 34270146, "comment_id": 56308562, "body": "thank you a lot. The first solution solved my problem very good :)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1450106962, "last_edit_date": 1450106962, "creation_date": 1450105215, "answer_id": 34270146, "question_id": 34269540, "link": "https://stackoverflow.com/questions/34269540/go-reverseproxy-to-apache-proxy-error-x509-certificate-signed-by-unknown-aut/34270146#34270146", "title": "Go - ReverseProxy to Apache proxy error: x509: certificate signed by unknown authority", "body": "<p>If you're using a self-signed certificate in the backend server, you need to tell your proxy's http client to not verify the certificate.</p>\n\n<p>You can override the default for the http package:</p>\n\n<pre><code>http.DefaultTransport.(*http.Transport).TLSClientConfig = &amp;tls.Config{InsecureSkipVerify: true}\n</code></pre>\n\n<p>Or create a new Transport specifically for your proxy:</p>\n\n<pre><code>httpProxy.Transport = &amp;http.Transport{\n    Proxy: http.ProxyFromEnvironment,\n    Dial: (&amp;net.Dialer{\n        Timeout:   30 * time.Second,\n        KeepAlive: 30 * time.Second,\n    }).Dial,\n    TLSHandshakeTimeout: 10 * time.Second,\n    TLSClientConfig: &amp;tls.Config{InsecureSkipVerify: true},\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2715821, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6e2c1f7817c37a0a912c3186b05d5eea?s=128&d=identicon&r=PG&f=1", "display_name": "Feralus", "link": "https://stackoverflow.com/users/2715821/feralus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2934, "favorite_count": 2, "accepted_answer_id": 34270146, "answer_count": 1, "score": 3, "last_activity_date": 1450106962, "creation_date": 1450103574, "question_id": 34269540, "link": "https://stackoverflow.com/questions/34269540/go-reverseproxy-to-apache-proxy-error-x509-certificate-signed-by-unknown-aut", "title": "Go - ReverseProxy to Apache proxy error: x509: certificate signed by unknown authority", "body": "<p>i have some troubles with my own ReverseProxy i've written in Go. I want to connect my Golang-Webserver with my Apache Webserver. My Apache Webserver should be running on https and the Reverse-Proxy too. So i've written following code, but I always get the error: proxy error: x509: certificate signed by unknown authority.\nSo must the apache uses the same certificate as the apache or what is the problem? Here some code snippets but I think its a problem with the certificates without ssl everything works fine :(</p>\n\n<pre><code>func (p *Proxy) directorApache(req *http.Request) {\n    mainServer := fmt.Sprintf(\"%s:%d\", Config.HostMain, Config.PortMain)\n    req.URL.Scheme = \"https\"\n    req.URL.Host = mainServer\n}\nfunc (p *Proxy) directorGo(req *http.Request) {\n    goServer := fmt.Sprintf(\"%s:%d\", Config.GoHost, Config.GoPort)\n    req.URL.Scheme = \"http\"\n    req.URL.Host = goServer\n}\n\n\nfunc (p *Proxy) ServeHTTP(rw http.ResponseWriter, req *http.Request) {\n    fmt.Println(req.URL.Path)\n    if p.isGoRequest(req) {\n        fmt.Println(\"GO\")\n        p.goProxy.ServeHTTP(rw, req)\n        return\n    }\n    p.httpProxy.ServeHTTP(rw, req)\n}\nfunc main() {\n\n    var configPath = flag.String(\"conf\", \"./configReverse.json\", \"Path to the Json config file.\")\n\n    flag.Parse()\n    proxy := New(*configPath)\n\n    cert, err := tls.LoadX509KeyPair(Config.PathCert, Config.PathPrivateKey)\n    if err != nil {\n        log.Fatalf(\"server: loadkeys: %s\", err)\n    }\n    config := tls.Config{InsecureSkipVerify: true, Certificates: []tls.Certificate{cert}}\n\n    listener, err := net.Listen(\"tcp\",\n    net.JoinHostPort(proxy.Host, strconv.Itoa(proxy.Port)))\n    if err != nil {\n        log.Fatalf(\"server: listen: %s\", err)\n    }\n    log.Printf(\"server: listening on %s\")\n    proxy.listener = tls.NewListener(listener, &amp;config)\n\n    serverHTTPS := &amp;http.Server{\n        Handler:   proxy.mux,\n        TLSConfig: &amp;config,\n    }\n\n    if err := serverHTTPS.Serve(proxy.listener); err != nil {\n        log.Fatal(\"SERVER ERROR:\", err)\n    }\n\n   }\n</code></pre>\n\n<p>I tried a lot and generated several self-signed SSL-Certificates but nothing solved my problem.\nHope somebody can help me.</p>\n\n<p>greetings</p>\n\n<p>David</p>\n"}, {"tags": ["java", "go", "binding", "code-generation", "backend"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450165935, "post_id": 34267148, "comment_id": 56308869, "body": "is there some JNI feature in Android not compatible?"}, {"owner": {"reputation": 357, "user_id": 1520360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cefb7c450948c41bfad15187676e30da?s=128&d=identicon&r=PG", "display_name": "saintech", "link": "https://stackoverflow.com/users/1520360/saintech"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450186703, "post_id": 34267148, "comment_id": 56322740, "body": "@JiangYD no, generated by <code>go bind</code> library is not compatible with Linux"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1450236746, "post_id": 34267148, "comment_id": 56349045, "body": "gomobile use android features, like <code>Context</code> and <code>Log</code>. so better to use a   RPC for java-golang interaction, like protobuf."}], "owner": {"reputation": 357, "user_id": 1520360, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cefb7c450948c41bfad15187676e30da?s=128&d=identicon&r=PG", "display_name": "saintech", "link": "https://stackoverflow.com/users/1520360/saintech"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 504, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1450309513, "creation_date": 1450096351, "last_edit_date": 1450309513, "question_id": 34267148, "link": "https://stackoverflow.com/questions/34267148/golang-bind-generator-for-java-like-gomobile-bind-for-android", "title": "golang bind generator for Java like `gomobile bind` for Android", "body": "<p>Is there an easier way to make Java binding for my go package? I want to use my small go package in backend builded on Java stack. The <code>gomobile bind</code> for Android is great tool, but i need the same thing just for Java.</p>\n"}, {"tags": ["go", "variable-assignment"], "comments": [{"owner": {"reputation": 2901, "user_id": 729784, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d76fae8519fd3b58c86d830b90301599?s=128&d=identicon&r=PG", "display_name": "Aliaksandr Kazlou", "link": "https://stackoverflow.com/users/729784/aliaksandr-kazlou"}, "edited": false, "score": 0, "creation_date": 1450097526, "post_id": 34266337, "comment_id": 56276134, "body": "Well, I almost finished <a href=\"http://www.gopl.io/\" rel=\"nofollow noreferrer\">gopl.io</a> (although focused on data type, methods, interfaces, concurrency), and read effective go, and other resources (although usually the topics I am interested in the moment), I&#39;ve used Go for algorithmic competitions, as well building CLI tool. I mean reading a doc is a good thing, but it is much better building things and while building learning a language, for me it is a balance, between time spending on learning vs building (having a result) things. Especially when you start leaning a new language, you want to see the results to keep it going."}, {"owner": {"reputation": 2901, "user_id": 729784, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d76fae8519fd3b58c86d830b90301599?s=128&d=identicon&r=PG", "display_name": "Aliaksandr Kazlou", "link": "https://stackoverflow.com/users/729784/aliaksandr-kazlou"}, "edited": false, "score": 0, "creation_date": 1450097720, "post_id": 34266337, "comment_id": 56276263, "body": "And when I talk about CLI, I mean using crypto/ssh/net/http/base64/yaml and other packages, as well as go-bindata :), just as overall overview :)"}, {"owner": {"reputation": 2901, "user_id": 729784, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d76fae8519fd3b58c86d830b90301599?s=128&d=identicon&r=PG", "display_name": "Aliaksandr Kazlou", "link": "https://stackoverflow.com/users/729784/aliaksandr-kazlou"}, "edited": false, "score": 0, "creation_date": 1450100428, "post_id": 34266337, "comment_id": 56278109, "body": "But, thank you for mentioning this in the effective go doc."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 19, "last_activity_date": 1450097269, "last_edit_date": 1450097269, "creation_date": 1450093942, "answer_id": 34266366, "question_id": 34266337, "link": "https://stackoverflow.com/questions/34266337/why-it-is-possible-to-redefine-err-in-multiple-return-statement-in-go/34266366#34266366", "title": "Why it is possible to redefine err in multiple return statement in Go", "body": "<p>It is because you used <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"noreferrer\">Short variable declaration</a> <code>:=</code>. Quoting from the spec:</p>\n\n<blockquote>\n  <p>Unlike regular variable declarations, a short variable declaration may <em>redeclare</em> variables provided they were originally declared earlier in the same block (or the parameter lists if the block is the function body) with the same type, and at least one of the non-<a href=\"https://golang.org/ref/spec#Blank_identifier\" rel=\"noreferrer\">blank</a> variables is new. As a consequence, <strong>redeclaration can only appear in a multi-variable short declaration</strong>. Redeclaration does not introduce a new variable; it just assigns a new value to the original.</p>\n</blockquote>\n\n<p>This line:</p>\n\n<pre><code>n1, err := strconv.Atoi(\"1\")\n</code></pre>\n\n<p>Is a multi-variable short declaration, and all variables on the left side are new, and so all will be declared (and return values of <code>strconv.Atoi()</code> assigned).</p>\n\n<p>This line:</p>\n\n<pre><code>n2, err := strconv.Atoi(\"2\")\n</code></pre>\n\n<p>It is a multi-variable short declaration, and <code>n2</code> is new. So it declares <code>n2</code> and only assigns a new value to <code>err</code>, because <code>err</code> is already declared in the same block.</p>\n\n<p>This line:</p>\n\n<pre><code>err := fmt.Errorf(\"new error\") &lt;- line 1\n</code></pre>\n\n<p>It is <strong>not</strong> a multi-variable short declaration. It would try to declare <code>err</code> but it is already declared in the same block, therefore it is a compile-time error.</p>\n\n<p>And this line:</p>\n\n<pre><code>n1, err := strconv.Atoi(\"3\") &lt;- line 2\n</code></pre>\n\n<p>It is a multi-variable short declaration, but <strong>all the variables</strong> on the left side have been <strong>previously declared</strong> in the same block, so it is also a compile-time error (it doesn't introduce any new variables on the left side).</p>\n\n<p>Note that if all the variables on the left side have been previously declared, simply changing from Short variable declaration <code>:=</code> to <a href=\"https://golang.org/ref/spec#Assignments\" rel=\"noreferrer\">Assignment</a> <code>=</code> will make it work (assumed values on the right side are <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"noreferrer\">assignable</a> to the variables on the left side).</p>\n"}], "owner": {"reputation": 2901, "user_id": 729784, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/d76fae8519fd3b58c86d830b90301599?s=128&d=identicon&r=PG", "display_name": "Aliaksandr Kazlou", "link": "https://stackoverflow.com/users/729784/aliaksandr-kazlou"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2189, "favorite_count": 1, "accepted_answer_id": 34266366, "answer_count": 1, "score": 14, "last_activity_date": 1450097269, "creation_date": 1450093822, "question_id": 34266337, "link": "https://stackoverflow.com/questions/34266337/why-it-is-possible-to-redefine-err-in-multiple-return-statement-in-go", "title": "Why it is possible to redefine err in multiple return statement in Go", "body": "<p>Consider the following example illustrating the question (it was just built to explain the question, but I saw similar code in books as well in real projects):</p>\n\n<pre><code>package main\n\nimport (\n    \"strconv\"\n    \"fmt\"\n    \"log\"\n)\n\nfunc main() {\n    n1, err := strconv.Atoi(\"1\")\n    if err != nil {\n        log.Panicf(\"%v\", err)\n    }\n\n    n2, err := strconv.Atoi(\"2\")\n    if err != nil {\n        log.Panicf(\"%v\", err)\n    }\n\n    // err := fmt.Errorf(\"new error\") &lt;- line 1\n\n    // n1, err := strconv.Atoi(\"3\") &lt;- line 2\n\n    fmt.Printf(\"n1 = %d, n2 = %d\\n\", n1, n2)\n}\n</code></pre>\n\n<p>The compiler doesn't complain about redefining <code>err</code>, but if I uncomment <code>&lt;- line 1</code> or <code>&lt;- line 2</code>, it will complain <code>no new variable on left side of :=</code>.</p>\n\n<p>So, how does it work? Why the compiler happily allows to override <code>err</code> in multi return statement, using <code>:=</code>, but not <code>n1</code> on <code>&lt;- line 2</code> example?</p>\n\n<p>Better if you can point into the official reference explaining this behavior.</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore", "sharding"], "answers": [{"comments": [{"owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "edited": false, "score": 0, "creation_date": 1450100797, "post_id": 34266162, "comment_id": 56278398, "body": "You are really an expert! Thank you so much for your help!"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1450105360, "last_edit_date": 1450105360, "creation_date": 1450093269, "answer_id": 34266162, "question_id": 34265862, "link": "https://stackoverflow.com/questions/34265862/google-app-engine-datastore-sharding-in-go/34266162#34266162", "title": "Google App Engine Datastore sharding in Go", "body": "<p>You get an error stating that the key you provide is incomplete. This is because you specify an empty key name (<code>\"\"</code>) (<code>stringID</code>), and <code>accountKey.IntID()</code> plus a random number (from the range <code>0..4</code> - both inclusive) as the numeric key ID (<code>intID</code>). Note that if your <code>accountKey.IntID()</code> is not initialized, it will be <code>0</code> and the random number may also be <code>0</code> in which case a <code>0</code> is used as the <code>intID</code>.</p>\n\n<p>And quoting from the doc of <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#NewKey\" rel=\"nofollow\"><code>datastore.Key</code></a>:</p>\n\n<blockquote>\n  <p>Either one or both of <code>stringID</code> and <code>intID</code> must be zero. If both are zero, the key returned is incomplete.</p>\n</blockquote>\n\n<p>The chance of getting <code>0</code> for the <code>intID</code> is 1 out of 5 which is 20% (this is close to your reported 3 out of 10).</p>\n\n<p>A value of <code>0</code> for <code>intID</code> is invalid, it has to be a non-zero value as <code>0</code> is a special value just like the empty string <code>\"\"</code> for the <code>stringID</code>, both which are used to indicate that the other property is used to identify the entity; or - if both are the zero value - to indicate that the key is an incomplete key (and so system assigned random <code>intID</code> is wanted).</p>\n\n<p>Please note that this solution is bad as you use keys with <em>relative</em> numeric ID (<code>intID</code>), relative compared to the numeric ID of the account key (<code>accountKey.IntID()</code>). System-assigned keys will be randomly distributed, but there is a chance that 2 account keys may be close to each other (e.g. one is the other +1). In such case your shard keys would overlap!</p>\n\n<p>If you use <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference#NewKey\" rel=\"nofollow\"><code>datastore.Put()</code></a> to save an entity, the system assigned random key is the return value of <code>Put()</code>:</p>\n\n<pre><code>func Put(c context.Context, key *Key, src interface{}) (*Key, error)\n</code></pre>\n"}], "owner": {"reputation": 633, "user_id": 1902969, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/303ccdcc2f1d211ec4665f18f4bf5d39?s=128&d=identicon&r=PG", "display_name": "Ook", "link": "https://stackoverflow.com/users/1902969/ook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 34266162, "answer_count": 1, "score": 2, "last_activity_date": 1477936634, "creation_date": 1450092323, "last_edit_date": 1477936634, "question_id": 34265862, "link": "https://stackoverflow.com/questions/34265862/google-app-engine-datastore-sharding-in-go", "title": "Google App Engine Datastore sharding in Go", "body": "<p>I have made a shard in GAE and only sometimes, not always got this message after running the sharding code.</p>\n\n<pre><code>(datastore_v3: BAD_REQUEST): Key path element must not be incomplete: [ResumeShard: ]\n</code></pre>\n\n<p>The code:</p>\n\n<pre><code>//Sharding\n//Getting shard ID\nrand.Seed(time.Now().UnixNano())\nshardId := rand.Int63n(5)\nresumeShardKey := datastore.NewKey(*pC, \"ResumeShard\", \"\", accountKey.IntID()+shardId, nil)\n\nvar resumeShard param.ResumeShard\n\nif err = datastore.Get(*pC, resumeShardKey, &amp;resumeShard); err != nil {\n\n    if err == datastore.ErrNoSuchEntity {\n        resumeShard = param.ResumeShard{}\n        resumeShard.Counter = 1\n    } else {\n        log.Println(err.Error())\n    }\n\n} else {\n    resumeShard.Counter += 1\n}\n</code></pre>\n\n<p><code>*pC</code> is a pointer to the context from appengine.</p>\n\n<p><code>accountKey</code> is a datastore <code>Key</code> unique to each user.</p>\n\n<p>This error shows up randomly, like 3 times in 10 requests. I am wondering because I have to use <code>datastore.NewKey(..)</code> to create keys for shards, how can I get the complete key that I will receive after calling <code>Put(..)</code> since this is sharding and the example on GAE doc uses <code>datastore.NewKey(..)</code> as well.</p>\n\n<p>Please suggest.</p>\n"}, {"tags": ["go", "bigtable", "google-cloud-bigtable"], "comments": [{"owner": {"reputation": 6972, "user_id": 738710, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ca1feddf2040d79ad8ec24d3f0a623c1?s=128&d=identicon&r=PG", "display_name": "Les Vogel - Google DevRel", "link": "https://stackoverflow.com/users/738710/les-vogel-google-devrel"}, "edited": false, "score": 0, "creation_date": 1450118354, "post_id": 34263088, "comment_id": 56290168, "body": "Why do you do the JWTConfigFromJSON?  That shouldn&#39;t be needed in either MVM&#39;s or GCP.  You should have already been configured.  Take a look at: <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/blob/master/examples/bigtable/bigtable-hello/helloworld.go#L42\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/gcloud-golang/blob/master/&hellip;</a> or <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/blob/master/examples/bigtable/search/search.go#L120\" rel=\"nofollow noreferrer\">github.com/GoogleCloudPlatform/gcloud-golang/blob/master/&hellip;</a> which uses GOOGLE_APPLICATION_CREDENTIALS env var."}, {"owner": {"reputation": 123, "user_id": 4924412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NZ579.jpg?s=128&g=1", "display_name": "PrasadJay", "link": "https://stackoverflow.com/users/4924412/prasadjay"}, "reply_to_user": {"reputation": 6972, "user_id": 738710, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ca1feddf2040d79ad8ec24d3f0a623c1?s=128&d=identicon&r=PG", "display_name": "Les Vogel - Google DevRel", "link": "https://stackoverflow.com/users/738710/les-vogel-google-devrel"}, "edited": false, "score": 1, "creation_date": 1450238672, "post_id": 34263088, "comment_id": 56349548, "body": "Our project may or may not be hosted in separate servers other than Google VMs, so need authentication that would work anywhere."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 4924412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NZ579.jpg?s=128&g=1", "display_name": "PrasadJay", "link": "https://stackoverflow.com/users/4924412/prasadjay"}, "edited": false, "score": 0, "creation_date": 1450238742, "post_id": 34279810, "comment_id": 56349571, "body": "Project uses a central config system, we aren&#39;t allowed to make other configs rather than that since servers may or may not be google VMs. That&#39;s why."}], "tags": [], "owner": {"reputation": 6972, "user_id": 738710, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/ca1feddf2040d79ad8ec24d3f0a623c1?s=128&d=identicon&r=PG", "display_name": "Les Vogel - Google DevRel", "link": "https://stackoverflow.com/users/738710/les-vogel-google-devrel"}, "is_accepted": false, "score": 1, "last_activity_date": 1450144518, "creation_date": 1450144518, "answer_id": 34279810, "question_id": 34263088, "link": "https://stackoverflow.com/questions/34263088/google-cloud-bigtable-authentication-with-go/34279810#34279810", "title": "Google Cloud Bigtable authentication with Go", "body": "<p>Take a look at: <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/blob/master/examples/bigtable/bigtable-hello/helloworld.go#L42\" rel=\"nofollow\">helloworld.go</a> or <a href=\"https://github.com/GoogleCloudPlatform/gcloud-golang/blob/master/examples/bigtable/search/search.go#L120\" rel=\"nofollow\">search.go</a> which uses <code>GOOGLE_APPLICATION_CREDENTIALS</code> environment variable.</p>\n\n<p>For most environments, you no longer even need to set <code>GOOGLE_APPLICATION_CREDENTIALS</code>.  <strong>Google Cloud Platform</strong>, <strong>Managed VMs</strong> or <strong>Google App Engine</strong> all have the right thing set for you.  Your desktop environment will also be correct if you've used <code>gcloud init</code> or it's predecessor <code>gcloud auth login</code> followed by <code>gcloud config set project &lt;projectID&gt;</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 123, "user_id": 4924412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NZ579.jpg?s=128&g=1", "display_name": "PrasadJay", "link": "https://stackoverflow.com/users/4924412/prasadjay"}, "is_accepted": true, "score": 3, "last_activity_date": 1450239147, "creation_date": 1450239147, "answer_id": 34303801, "question_id": 34263088, "link": "https://stackoverflow.com/questions/34263088/google-cloud-bigtable-authentication-with-go/34303801#34303801", "title": "Google Cloud Bigtable authentication with Go", "body": "<p>I've solved the problem. It's nothing wrong with the code, but config json itself. So anyone who out there want to authenticate and came here by google search... This code is correct and working perfectly. What I've done wrong is follows.</p>\n\n<p>First I made a service account and got the json. But google warned me that im not an owner of project hence it wont be added to accept list but anyway it let me download the json.\nThen I deleted that key from console and requested project owner to create a key for me. \nThere he has created another key with the same name I given.. And since he's the owner no error/warning msgs displayed and successfully json file was downloaded.</p>\n\n<p>When I tried with that... my question begun. That's when i posted this question.\nAfter that with no solutions. I asked owner to delete that key and create another key but with a different name..</p>\n\n<p>Then it worked! It seems if you try to create a key with non-owner account and then again create with same name ( after deleting original of course ) has no effect. Hope this helps everyone out there :)</p>\n"}], "owner": {"reputation": 123, "user_id": 4924412, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NZ579.jpg?s=128&g=1", "display_name": "PrasadJay", "link": "https://stackoverflow.com/users/4924412/prasadjay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 638, "favorite_count": 0, "accepted_answer_id": 34303801, "answer_count": 2, "score": 4, "last_activity_date": 1450239147, "creation_date": 1450084043, "question_id": 34263088, "link": "https://stackoverflow.com/questions/34263088/google-cloud-bigtable-authentication-with-go", "title": "Google Cloud Bigtable authentication with Go", "body": "<p>I'm trying to insert a simple record as in GoDoc. But this returns,</p>\n\n<pre><code>rpc error: code = 7 desc = \"User can't access project: tidy-groove\"\n</code></pre>\n\n<p>When I searched for grpc codes, it says..</p>\n\n<pre><code>PermissionDenied Code = 7\n\n// Unauthenticated indicates the request does not have valid\n// authentication credentials for the operation.\n</code></pre>\n\n<p>I've enabled Big table in my console and created a cluster and a service account and recieved the json. What I'm doing wrong here? </p>\n\n<pre><code>package main\n\nimport (\n\"fmt\"\n\"golang.org/x/net/context\"\n\"golang.org/x/oauth2/google\"\n\"google.golang.org/cloud\"\n\"google.golang.org/cloud/bigtable\"\n\"io/ioutil\"\n)\n\nfunc main() {\nfmt.Println(\"Start!\")\nput()\n}\n\nfunc getClient() *bigtable.Client {\njsonKey, err := ioutil.ReadFile(\"TestProject-7854ea9op741.json\")\nif err != nil {\n    fmt.Println(err.Error())\n}\n\nconfig, err := google.JWTConfigFromJSON(\n    jsonKey,\n    bigtable.Scope,\n) // or bigtable.AdminScope, etc.\n\nif err != nil {\n    fmt.Println(err.Error())\n}\n\nctx := context.Background()\nclient, err := bigtable.NewClient(ctx, \"tidy-groove\", \"asia-east1-b\", \"test1-bigtable\", cloud.WithTokenSource(config.TokenSource(ctx)))\n\nif err != nil {\n    fmt.Println(err.Error())\n}\n\nreturn client\n}\n\nfunc put() {\nctx := context.Background()\nclient := getClient()\ntbl := client.Open(\"table1\")\nmut := bigtable.NewMutation()\nmut.Set(\"links\", \"maps.google.com\", bigtable.Now(), []byte(\"1\"))\nmut.Set(\"links\", \"golang.org\", bigtable.Now(), []byte(\"1\"))\nerr := tbl.Apply(ctx, \"com.google.cloud\", mut)\nif err != nil {\n    fmt.Println(err.Error())\n}\n}\n</code></pre>\n"}, {"tags": ["inheritance", "plugins", "go", "embedding"], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1450083394, "post_id": 34262240, "comment_id": 56267244, "body": "An interesting idea.  So I still have to tie everything together in my top-level code, but that glue is pretty minimal (and most importantly: fairly easy to document for future users of my API + plugins).  It&#39;s not as seamless as JavaScript, but then it&#39;s a static language, so that&#39;s to be expected. It is a clear improvement over my previous attempts.  Thanks."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1484731492, "last_edit_date": 1484731492, "creation_date": 1450080489, "answer_id": 34262240, "question_id": 34261933, "link": "https://stackoverflow.com/questions/34261933/how-to-arbitrarily-extend-an-object/34262240#34262240", "title": "How to arbitrarily extend an &quot;object&quot;", "body": "<p>You may achieve what you want if you don't try to push everything to be the plugins' responsibility.</p>\n\n<p>For example if you want your plugins to be independent from each other (that is, they shouldn't know about each other) and you want all your plugins to be optional (that is, you want to choose what plugins you want to turn on), you may choose to create the wrapper type (the wrapper <code>struct</code>) at the place of usage; which embeds only the plugins you want to use.</p>\n\n<p>See this example, which defines a base <code>Thing</code> type, and defines 3 optional plugins, all which don't know about each other, only about the <code>Thing</code> type. Then let's say we want a \"thing\" extended with <code>Plugin1</code> and <code>Plugin3</code>, we can create a custom wrapper <code>Thing13</code> which embeds <code>*Plugin1</code> and <code>*Plugin3</code> only (besides <code>*Thing</code> of course).</p>\n\n<pre><code>type Thing struct{ Name string }\n\nfunc (t *Thing) Stuff() { fmt.Printf(\"Stuff, name: %s (%p)\\n\", t.Name, t) }\n\ntype Plugin1 struct{ *Thing }\n\nfunc (p1 *Plugin1) Stuff1() { fmt.Printf(\"Stuff1, name: %s (%p)\\n\", p1.Name, p1.Thing) }\n\ntype Plugin2 struct{ *Thing }\n\nfunc (p2 *Plugin2) Stuff2() { fmt.Printf(\"Stuff2, name: %s (%p)\\n\", p2.Name, p2.Thing) }\n\ntype Plugin3 struct{ *Thing }\n\nfunc (p3 *Plugin3) Stuff3() { fmt.Printf(\"Stuff3, name: %s (%p)\\n\", p3.Name, p3.Thing) }\n\nfunc main() {\n    t := &amp;Thing{\"BaseThing\"}\n    // Let's say you now want a \"Thing\" extended with Plugin1 and Plugin3:\n    type Thing13 struct {\n        *Thing\n        *Plugin1\n        *Plugin3\n    }\n    t13 := &amp;Thing13{t, &amp;Plugin1{t}, &amp;Plugin3{t}}\n\n    fmt.Println(t13.Name)\n    t13.Stuff()\n    t13.Stuff1()\n    t13.Stuff3()\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/vo-9nWQTHB\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>BaseThing\nStuff, name: BaseThing (0x1040a130)\nStuff1, name: BaseThing (0x1040a130)\nStuff3, name: BaseThing (0x1040a130)\n</code></pre>\n\n<p>Please note that as only a pointer to <code>Thing</code> is embedded in each struct (<code>*Thing</code>), there is only one <code>Thing</code> value created, and it is shared across all utilized plugins (via its pointer/address), the printed pointers prove this. Also note that the <code>Thing13</code> type declaration doesn't need to be in the <code>main()</code> function, I just did that to save some space.</p>\n\n<p><strong>Note:</strong></p>\n\n<p>Although I implemented plugins in a way that they embed <code>*Thing</code>, this is not a requirement. The <code>*Thing</code> in plugins may be a \"normal\" field, and everything would still work as expected.</p>\n\n<p>It could look like this (the rest of the code is unchanged):</p>\n\n<pre><code>type Plugin1 struct{ t *Thing }\n\nfunc (p1 *Plugin1) Stuff1() { fmt.Printf(\"Stuff1, name: %s (%p)\\n\", p1.t.Name, p1.t) }\n\ntype Plugin2 struct{ t *Thing }\n\nfunc (p2 *Plugin2) Stuff2() { fmt.Printf(\"Stuff2, name: %s (%p)\\n\", p2.t.Name, p2.t) }\n\ntype Plugin3 struct{ t *Thing }\n\nfunc (p3 *Plugin3) Stuff3() { fmt.Printf(\"Stuff3, name: %s (%p)\\n\", p3.t.Name, p3.t) }\n</code></pre>\n\n<p>Output is the same, try this variant on the <a href=\"http://play.golang.org/p/hdn0ljcMyx\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<p><strong>Note #2:</strong></p>\n\n<p>For simplicity I didn't add <code>New()</code> functions for creating plugins, just used <code>struct</code> literals. If creation is complex, it can be added of course. It could look like this for <code>Plugin1</code> if it is in package <code>plugin1</code>:</p>\n\n<pre><code>func New(t *Thing) *Plugin1 {\n    p := &amp;Plugin1{t}\n    // Do other complex things\n    return p\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>t13 := &amp;Thing13{t, plugin1.New(t), &amp;Plugin3{t}}\n</code></pre>\n\n<p><strong>Note #3:</strong></p>\n\n<p>Also note that a new, named type is not required to acquire a \"thing\" value armored with <code>Plugin1</code> and <code>Plugin3</code>. You could just use an anonymous struct type and literal, like this:</p>\n\n<pre><code>t := &amp;Thing{\"BaseThing\"}\n// Let's say you now want a \"Thing\" extended with Plugin1 and Plugin3:\nt13 := struct { *Thing; *Plugin1; *Plugin3 }{t, &amp;Plugin1{t}, &amp;Plugin3{t}}\n</code></pre>\n"}], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 295, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1587648939, "creation_date": 1450079043, "last_edit_date": 1587648939, "question_id": 34261933, "link": "https://stackoverflow.com/questions/34261933/how-to-arbitrarily-extend-an-object", "title": "How to arbitrarily extend an &quot;object&quot;", "body": "<p>I hope my question can be made clear. I've done my best to make this concise, but please ask for clarification if it is necessary.</p>\n\n<p>In JavaScript, it's common practice to have a \"plugin\" modify an existing object by creating new methods.  <a href=\"https://plugins.jquery.com/\" rel=\"nofollow\">jQuery plugins</a> do this, for example.</p>\n\n<p>I have the need to do something similar in Go, and am looking for the best way to do it.</p>\n\n<p>The simplest to implement would simply be to store functions in a <code>map[string]func</code> type of data structure, then call these new \"methods\" with something like:</p>\n\n<pre><code>func (f *Foo) Call(name string) {\n    fn := f.FuncMap[name]\n    fn()\n}\n</code></pre>\n\n<p>I can also get a much friendlier API if I use interface embedding, such as:</p>\n\n<pre><code>package thingie\n\ntype Thingie struct { ... }\ntype Thingier interface { ... }\n\nfunc New() *Thingie { ... }\nfunc (t *Thingie) Stuff() { ... }\n</code></pre>\n\n<p>And</p>\n\n<pre><code>package pluginone\n\ntype PluginOne struct { thingie.Thingier, ... }\n\nfunc New(t *thingie.Thingie) *PluginOne { ... }\nfunc (p1 *PluginOne) MoreStuff() { ... }\n</code></pre>\n\n<p>This works, with up to one \"plugin\".  That is to say, I can create an object which can access all the methods in both the <code>thingie</code> and <code>pluginone</code> packages.</p>\n\n<pre><code>package main\n\nfunc main() {\n    t := thingie.New()\n    p1 := pluginone.New(t)\n    p1.Stuff()\n    p1.MoreStuff()\n}\n</code></pre>\n\n<p>The problem comes when I add a second plugin:</p>\n\n<pre><code>t := thingie.New()\np1 := pluginone.New(t)\np2 := plugintwo.New(p2)\np2.Stuff() // This works\np2.MoreStuff() // P2 doesn't know about pluginone's methods, so this fails\n</code></pre>\n\n<p>So I seem to be left with the options of an ugly API based on <code>map[string]func</code>, or a maximum of a single \"plugin\".</p>\n\n<p>Are there any other alternatives I haven't considered?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1450073391, "creation_date": 1450073391, "answer_id": 34260772, "question_id": 34260219, "link": "https://stackoverflow.com/questions/34260219/google-appengine-saying-my-import-is-incorrect/34260772#34260772", "title": "Google appengine saying my import is incorrect?", "body": "<p>Use absolute an absolute path in the import statement:</p>\n\n<pre><code>import (\n    \"controllers/common\"\n) \n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 53, "favorite_count": 0, "accepted_answer_id": 34260772, "answer_count": 1, "score": 2, "last_activity_date": 1450073391, "creation_date": 1450070242, "question_id": 34260219, "link": "https://stackoverflow.com/questions/34260219/google-appengine-saying-my-import-is-incorrect", "title": "Google appengine saying my import is incorrect?", "body": "<p>First time using google AppEngine and I am trying to launch this is my current files</p>\n\n<pre><code>\u251c\u2500\u2500 app.yaml\n\u251c\u2500\u2500 controllers\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 admin\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 admin.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 auth\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 login.go\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 register.go\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 validate.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 common\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u251c\u2500\u2500 common.go\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 dbstructs.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 forum\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 forum.go\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 home\n\u2502\u00a0\u00a0 \u2502\u00a0\u00a0 \u2514\u2500\u2500 home.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 user\n\u2502\u00a0\u00a0     \u2514\u2500\u2500 user.go\n</code></pre>\n\n<p>then I do <code>goapp serve</code> and I get :</p>\n\n<p><code>2015/12/13 22:16:29 go-app-builder: Failed parsing input: parser: bad import \"../common\" in controllers/home/home.go</code></p>\n\n<p>I'm not sure why it's a bad import or of appengine makes its own environment or something any help would be great.</p>\n"}, {"tags": ["time", "go", "timestamp"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 3, "creation_date": 1450073063, "post_id": 34260158, "comment_id": 56262768, "body": "This is certainly a valid answer. It&#39;s just succinct because there&#39;s little to add beyond a one-line example!"}, {"owner": {"reputation": 185, "user_id": 2147751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e580f6ab14ac6ca552f30ace3599ff89?s=128&d=identicon&r=PG", "display_name": "Kipz", "link": "https://stackoverflow.com/users/2147751/kipz"}, "edited": false, "score": 0, "creation_date": 1450179067, "post_id": 34260158, "comment_id": 56317564, "body": "Thanks, it does the job!"}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 9, "last_activity_date": 1450069802, "creation_date": 1450069802, "answer_id": 34260158, "question_id": 34260121, "link": "https://stackoverflow.com/questions/34260121/get-timestamp-for-the-next-hour/34260158#34260158", "title": "Get timestamp for the next hour", "body": "<p><code>time.Now().Add(time.Hour)</code></p>\n\n<p><a href=\"https://play.golang.org/p/48KATjPbc-\" rel=\"noreferrer\">playground</a></p>\n"}], "owner": {"reputation": 185, "user_id": 2147751, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e580f6ab14ac6ca552f30ace3599ff89?s=128&d=identicon&r=PG", "display_name": "Kipz", "link": "https://stackoverflow.com/users/2147751/kipz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 34260158, "answer_count": 1, "score": -1, "last_activity_date": 1450069802, "creation_date": 1450069562, "question_id": 34260121, "link": "https://stackoverflow.com/questions/34260121/get-timestamp-for-the-next-hour", "title": "Get timestamp for the next hour", "body": "<p>How can I get the timestamp of the next hour?</p>\n\n<p>Example: Something expires in 1 hours, so it would be time.Now() plus one hour</p>\n\n<p>How can I do this?</p>\n\n<p>Thanks!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 7763, "user_id": 501494, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5dc2a48c68041b350359e623be076651?s=128&d=identicon&r=PG", "display_name": "Jesse", "link": "https://stackoverflow.com/users/501494/jesse"}, "edited": false, "score": 2, "creation_date": 1450103267, "post_id": 34259943, "comment_id": 56280042, "body": "That is a helpful piece of feedback. I had not as of yet been exposed to &quot;range&quot;."}, {"owner": {"reputation": 391, "user_id": 1304076, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fb8e5a1596efa01374ffabe734cacec?s=128&d=identicon&r=PG", "display_name": "Jeffrey Goldberg", "link": "https://stackoverflow.com/users/1304076/jeffrey-goldberg"}, "edited": false, "score": 0, "creation_date": 1511110471, "post_id": 34259943, "comment_id": 81710984, "body": "Thank you for the pointer to &quot;internal&quot; packages. I do have duplicated unexported functions like this, and internal looks like the way to better maintain these."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 40, "last_activity_date": 1543834355, "last_edit_date": 1543834355, "creation_date": 1450068436, "answer_id": 34259943, "question_id": 34259800, "link": "https://stackoverflow.com/questions/34259800/is-there-a-built-in-min-function-for-a-slice-of-int-arguments-or-a-variable-numb/34259943#34259943", "title": "Is there a built in min function for a slice of int arguments or a variable number of int arguments in golang?", "body": "<p>There is no built-in for this. </p>\n\n<p>If you need this functionality only in one package you can write an un-exported function (e.g. <code>minIntSlice</code>). </p>\n\n<p>If you need this functionality in multiple packages you can create a package and put similar functions there. You should consider making this package internal (<a href=\"https://golang.org/s/go14internal\" rel=\"noreferrer\">https://golang.org/s/go14internal</a>).</p>\n\n<p>A few suggestions how to improve your code:</p>\n\n<ol>\n<li><p><code>MinIntSlice</code> will return 0 for an empty slice. However 0 is a valid min element as well. I think calling panic on an empty slice is a better option.</p></li>\n<li><p>Use range loop:</p>\n\n<pre><code>for i, e := range v {\n    if i==0 || e &lt; m {\n        m = e\n    }\n}\n</code></pre></li>\n</ol>\n\n<p>by not giving the index of value it will give you the minimum value 0, which may not be present in given values, so you also have to apply condition on index.</p>\n"}, {"tags": [], "owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "is_accepted": false, "score": 9, "last_activity_date": 1592479273, "last_edit_date": 1592479273, "creation_date": 1504168037, "answer_id": 45976758, "question_id": 34259800, "link": "https://stackoverflow.com/questions/34259800/is-there-a-built-in-min-function-for-a-slice-of-int-arguments-or-a-variable-numb/45976758#45976758", "title": "Is there a built in min function for a slice of int arguments or a variable number of int arguments in golang?", "body": "<p>As @kostya correctly stated there is no built-in min or max function in Golang. </p>\n\n<p>However, I would suggest a slightly different solution:</p>\n\n<pre><code>func MinMax(array []int) (int, int) {\n    var max int = array[0]\n    var min int = array[0]\n    for _, value := range array {\n        if max &lt; value {\n            max = value\n        }\n        if min &gt; value {\n            min = value\n        }\n    }\n    return min, max\n}\n</code></pre>\n\n<p>By that the problem of an empty slice is solved: a runtime error shows up (<code>index out of range</code>)</p>\n"}, {"comments": [{"owner": {"reputation": 7583, "user_id": 310196, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/222fc4209d728b2996b390cf90e835a0?s=128&d=identicon&r=PG", "display_name": "devshorts", "link": "https://stackoverflow.com/users/310196/devshorts"}, "edited": false, "score": 4, "creation_date": 1542824132, "post_id": 52070050, "comment_id": 93710675, "body": "Mutating the underlying slice just to pick something is a terrible idea.  This could change assertions about the implicit ordering elsewhere"}, {"owner": {"reputation": 9564, "user_id": 743188, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/gPyaY.jpg?s=128&g=1", "display_name": "Tommy", "link": "https://stackoverflow.com/users/743188/tommy"}, "edited": false, "score": 2, "creation_date": 1556287062, "post_id": 52070050, "comment_id": 98398406, "body": "sorting is o(n log n) but maximum is a linear time o(n) algorithm, this &quot;code is shorter&quot; but the algorithm is worse."}, {"owner": {"reputation": 45, "user_id": 1333504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31bf63a453b5f448e0a9faf8bf9c7a03?s=128&d=identicon&r=PG", "display_name": "Yury Alexandrov", "link": "https://stackoverflow.com/users/1333504/yury-alexandrov"}, "edited": false, "score": 0, "creation_date": 1557202521, "post_id": 52070050, "comment_id": 98674869, "body": "Right, it&#39;s far from optimal. But when you need min/max of small slice somewhere in middle of algorithm it&#39;s fine to sort it and take first/last instead of making separate function which you will never use again."}, {"owner": {"reputation": 21281, "user_id": 1122645, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/mrljv.png?s=128&g=1", "display_name": "UmNyobe", "link": "https://stackoverflow.com/users/1122645/umnyobe"}, "reply_to_user": {"reputation": 348, "user_id": 984904, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b26369cdd54fca4a8497e4162ca44cb9?s=128&d=identicon&r=PG", "display_name": "fullpipe", "link": "https://stackoverflow.com/users/984904/fullpipe"}, "edited": false, "score": 1, "creation_date": 1558014507, "post_id": 52070050, "comment_id": 98966796, "body": "@fullpipe the slice is passed by value. Not the underlying data. It will be modified."}], "tags": [], "owner": {"reputation": 45, "user_id": 1333504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31bf63a453b5f448e0a9faf8bf9c7a03?s=128&d=identicon&r=PG", "display_name": "Yury Alexandrov", "link": "https://stackoverflow.com/users/1333504/yury-alexandrov"}, "is_accepted": false, "score": 0, "last_activity_date": 1535520659, "creation_date": 1535520659, "answer_id": 52070050, "question_id": 34259800, "link": "https://stackoverflow.com/questions/34259800/is-there-a-built-in-min-function-for-a-slice-of-int-arguments-or-a-variable-numb/52070050#52070050", "title": "Is there a built in min function for a slice of int arguments or a variable number of int arguments in golang?", "body": "<p>With sorting it can be shorter:</p>\n\n\n\n<pre class=\"lang-go prettyprint-override\"><code>func MinIntSlice(v []int) int {\n  sort.Ints(v)\n  return v[0]\n}\n\nfunc MaxIntSlice(v []int) int {\n  sort.Ints(v)\n  return v[len(v)-1]\n}\n</code></pre>\n\n<p>But don't forget to modify it for zero length slices on your taste.</p>\n"}, {"tags": [], "owner": {"reputation": 324, "user_id": 5388438, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-8vDH5qSd-Ks/AAAAAAAAAAI/AAAAAAAAAEs/uEKhkeq_B2k/photo.jpg?sz=128", "display_name": "Irrfan23", "link": "https://stackoverflow.com/users/5388438/irrfan23"}, "is_accepted": false, "score": 0, "last_activity_date": 1543809622, "creation_date": 1543809622, "answer_id": 53587287, "question_id": 34259800, "link": "https://stackoverflow.com/questions/34259800/is-there-a-built-in-min-function-for-a-slice-of-int-arguments-or-a-variable-numb/53587287#53587287", "title": "Is there a built in min function for a slice of int arguments or a variable number of int arguments in golang?", "body": "<p>Using @kostya's <a href=\"https://stackoverflow.com/a/34259943/5388438\">answer</a> </p>\n\n<ol start=\"2\">\n<li><p>Use range loop:</p>\n\n<pre><code>for i, e := range v {\n    if i==0 || e &lt; m {\n        m = e\n    }\n}\n</code></pre></li>\n</ol>\n\n<p>by not giving the index of value it will give you the minimum value 0, which may not be present in given values</p>\n"}, {"tags": [], "owner": {"reputation": 71, "user_id": 3262468, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/28420f618a3c3e688222aba9269da875?s=128&d=identicon&r=PG&f=1", "display_name": "ren70n", "link": "https://stackoverflow.com/users/3262468/ren70n"}, "is_accepted": false, "score": 1, "last_activity_date": 1555509780, "creation_date": 1555509780, "answer_id": 55729389, "question_id": 34259800, "link": "https://stackoverflow.com/questions/34259800/is-there-a-built-in-min-function-for-a-slice-of-int-arguments-or-a-variable-numb/55729389#55729389", "title": "Is there a built in min function for a slice of int arguments or a variable number of int arguments in golang?", "body": "<p>if you don't care about input array</p>\n\n<pre><code>import . \"sort\"\nfunc MinIntSlice(v []int){\n    Ints(v)\n    return z[0]\n}\n\nfunc MaxIntSlice(v []int){\n    Ints(v)\n    return z[len(v)-1]\n}\n// and MinMax version\nfunc MinMax(v []int)(int,int){\n    Ints(v)\n    return z[0],z[len(v)-1]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 59, "user_id": 12637653, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QphxFOh-dPc/AAAAAAAAAAI/AAAAAAAAAAA/ACHi3rcNf6Jw1cTdmELyEbCmdL74Far5jQ/photo.jpg?sz=128", "display_name": "LoveRick", "link": "https://stackoverflow.com/users/12637653/loverick"}, "is_accepted": false, "score": 2, "last_activity_date": 1578143158, "creation_date": 1578143158, "answer_id": 59590956, "question_id": 34259800, "link": "https://stackoverflow.com/questions/34259800/is-there-a-built-in-min-function-for-a-slice-of-int-arguments-or-a-variable-numb/59590956#59590956", "title": "Is there a built in min function for a slice of int arguments or a variable number of int arguments in golang?", "body": "<p><a href=\"https://github.com/adam-lavrik/go-imath\" rel=\"nofollow noreferrer\">This package</a> contains some implementations of <code>Min</code> and <code>Max</code> functions for separate values or slices. After <code>go get</code> it can be used like:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"fmt\"\n    \"&lt;Full URL&gt;/go-imath/ix\" // Functions for int type\n)\n...\nfmt.Println(ix.Min(100, 152)) // Output: 100\nfmt.Println(ix.Mins(234, 55, 180)) // Output: 55\nfmt.Println(ix.MinSlice([]int{2, 29, 8, -1})) // Output: -1\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 80989, "user_id": 466862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d873f397779db38cd510d9ee5416fd43?s=128&d=identicon&r=PG", "display_name": "Mark Rotteveel", "link": "https://stackoverflow.com/users/466862/mark-rotteveel"}, "edited": false, "score": 1, "creation_date": 1592732222, "post_id": 62465524, "comment_id": 110524609, "body": "Please don&#39;t post only code as answer, but also provide an explanation what your code does and how it solves the problem of the question. Answers with an explanation are usually more helpful and of better quality, and are more likely to attract upvotes."}], "tags": [], "owner": {"reputation": 31, "user_id": 11966001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b021ac9d6d7e4d0bd362d3d639f16102?s=128&d=identicon&r=PG&f=1", "display_name": "funnyDev", "link": "https://stackoverflow.com/users/11966001/funnydev"}, "is_accepted": false, "score": 3, "last_activity_date": 1592552381, "creation_date": 1592552381, "answer_id": 62465524, "question_id": 34259800, "link": "https://stackoverflow.com/questions/34259800/is-there-a-built-in-min-function-for-a-slice-of-int-arguments-or-a-variable-numb/62465524#62465524", "title": "Is there a built in min function for a slice of int arguments or a variable number of int arguments in golang?", "body": "<pre><code>    min := s[0]\n    for i :=1; i &lt; len(s); i++ {\n        if min &gt; s[i] {\n            min = s[i]\n        }\n    }\n</code></pre>\n\n<blockquote>\n  <p><code>min &gt; s[i]? min = s[i] : min</code></p>\n</blockquote>\n"}], "owner": {"reputation": 7763, "user_id": 501494, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/5dc2a48c68041b350359e623be076651?s=128&d=identicon&r=PG", "display_name": "Jesse", "link": "https://stackoverflow.com/users/501494/jesse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47822, "favorite_count": 2, "accepted_answer_id": 34259943, "answer_count": 7, "score": 31, "last_activity_date": 1592552381, "creation_date": 1450067427, "last_edit_date": 1450074761, "question_id": 34259800, "link": "https://stackoverflow.com/questions/34259800/is-there-a-built-in-min-function-for-a-slice-of-int-arguments-or-a-variable-numb", "title": "Is there a built in min function for a slice of int arguments or a variable number of int arguments in golang?", "body": "<p>Precursor: I'm just starting to get my feet wet with golang. </p>\n\n<p>This may prove to a be a silly question as it's quite easy to perform these calculations but I'm going to ask it anyway as I didn't find an answer when Googling. </p>\n\n<p>Is there a built in function that returns the minimum of a slice of int arguments:</p>\n\n<pre><code>func MinIntSlice(v []int) (m int) {\n    if len(v) &gt; 0 {\n        m = v[0]\n    }\n    for i := 1; i &lt; len(v); i++ {\n        if v[i] &lt; m {\n            m = v[i]\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>OR the minimum of a variable number of int arguments:</p>\n\n<pre><code>func MinIntVarible(v1 int, vn ...int) (m int) {\n    m = v1\n    for i := 0; i &lt; len(vn); i++ {\n        if vn[i] &lt; m {\n            m = vn[i]\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>If not, is the best \"convention\" simply to create a package that contains helpers like this?</p>\n"}, {"tags": ["api", "go", "http-headers"], "answers": [{"tags": [], "owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "is_accepted": true, "score": 0, "last_activity_date": 1450066721, "creation_date": 1450066721, "answer_id": 34259703, "question_id": 34259350, "link": "https://stackoverflow.com/questions/34259350/go-headers-when-fetching-urls/34259703#34259703", "title": "Go headers when fetching URLs", "body": "<p>If you for example just do a <code>http.Get</code> then just</p>\n\n<pre><code>User-Agent: Go-http-client/1.1\nAccept-Encoding: gzip\n</code></pre>\n"}], "owner": {"reputation": 185, "user_id": 5642668, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/1628562877399159/picture?type=large", "display_name": "Adriaan Joubert", "link": "https://stackoverflow.com/users/5642668/adriaan-joubert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26, "favorite_count": 0, "accepted_answer_id": 34259703, "answer_count": 1, "score": 0, "last_activity_date": 1450066721, "creation_date": 1450063889, "question_id": 34259350, "link": "https://stackoverflow.com/questions/34259350/go-headers-when-fetching-urls", "title": "Go headers when fetching URLs", "body": "<p>When I write a programme in Python and post a request using <code>urllib</code>, my header is sent to the server as <code>Python-urllib/3.4</code></p>\n\n<p>What HTTP headers are sent to a server by default when accessing an API with a Go programme?</p>\n"}, {"tags": ["go", "type-assertion"], "answers": [{"tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 0, "last_activity_date": 1450066480, "last_edit_date": 1450066480, "creation_date": 1450066139, "answer_id": 34259615, "question_id": 34259333, "link": "https://stackoverflow.com/questions/34259333/golang-pass-struct-to-function-args-interface/34259615#34259615", "title": "goLang pass struct to function (args interface{})", "body": "<p>Type of <code>foo</code> in your program is <code>*Msg</code> (pointer to Msg), not <code>Msg</code>. You need to cast <code>y</code> to <code>*Msg</code> in <code>print</code> (<a href=\"http://play.golang.org/p/MTi7QhSVQz\" rel=\"nofollow\">http://play.golang.org/p/MTi7QhSVQz</a>):</p>\n\n<pre><code>z, ok := y.(*Msg)\n</code></pre>\n\n<p>Alternatively you can use <code>Msg</code> type for <code>foo</code> (<a href=\"http://play.golang.org/p/XMftjVtzBk\" rel=\"nofollow\">http://play.golang.org/p/XMftjVtzBk</a>):</p>\n\n<pre><code>foo := Msg{Message: \"Hello\"}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var foo Msg\nfoo.Message = \"Hello\"\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1450066895, "creation_date": 1450066895, "answer_id": 34259729, "question_id": 34259333, "link": "https://stackoverflow.com/questions/34259333/golang-pass-struct-to-function-args-interface/34259729#34259729", "title": "goLang pass struct to function (args interface{})", "body": "<p>If you run your program, one thing that you will notice is that value of \"ok\" is false and that's the reason for your print statement in if not getting executed. If you  remove \"ok\" from  z, ok := y.(Msg), you will see the error that Go is throwing while executing this assert statement. With ok, Go will not panic and will return false if assertion fails. Which is happening in your case.</p>\n\n<p>The reason for asserting failing is, expected, type in print method is Msg(main.Msg), but passed is pointer i.e. *main.Msg. You will see this error when you don't use \"ok\"</p>\n\n<p>So one way is to </p>\n\n<pre><code>print(*foo)\n</code></pre>\n\n<p>Or</p>\n\n<pre><code>z, ok := y.(*Msg)\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2864521, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/193b7abdc0177550910abcd8fd063c76?s=128&d=identicon&r=PG&f=1", "display_name": "Anne", "link": "https://stackoverflow.com/users/2864521/anne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1461, "favorite_count": 0, "accepted_answer_id": 34259615, "answer_count": 2, "score": -1, "last_activity_date": 1450066895, "creation_date": 1450063748, "question_id": 34259333, "link": "https://stackoverflow.com/questions/34259333/golang-pass-struct-to-function-args-interface", "title": "goLang pass struct to function (args interface{})", "body": "<p>Here is my code\n<a href=\"http://play.golang.org/p/h0N4t2ZAKQ\" rel=\"nofollow\">http://play.golang.org/p/h0N4t2ZAKQ</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype Msg struct {\n    Message string\n}\n\nfunc print(y interface{}) {\n    z, ok := y.(Msg)\n    fmt.Println(reflect.TypeOf(z))\n    fmt.Println(\"Value of ok \", ok)\n    if ok {\n        fmt.Println(\"Message is \"+ z.Message)\n    }\n}\n\nfunc main() {\n\n    foo := new(Msg)\n    foo.Message=\"Hello\"\n    fmt.Println(\"Messege in main \"+foo.Message)\n    print(foo)\n\n}\n</code></pre>\n\n<p>When I run it z.Message does not print Hello\nNot sure why. Can someone clarify?\nThanks in advance</p>\n"}, {"tags": ["linux", "ubuntu", "service", "go", "systemd"], "comments": [{"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 3, "creation_date": 1450049578, "post_id": 34257440, "comment_id": 56257057, "body": "xwindows doesn&#39;t let users other than the current session owner to send it commands.  try &quot;xhost +&quot; from a shell (as you) before invoking your service.  it could be that root is getting blocked from turning off the screen.  but it works when you run commands from the shell since you own the session"}, {"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1450050510, "post_id": 34257440, "comment_id": 56257280, "body": "I stopped the service, tried &quot;xhost +&quot; which said &quot;access control disabled, clients can connect from any host&quot; then started the service again but it&#39;s still getting &quot;exit status 1&quot; from the xset command :/"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1450052907, "post_id": 34257440, "comment_id": 56257786, "body": "do you have the actual error message generated to go with the exit code 1?"}, {"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1450055982, "post_id": 34257440, "comment_id": 56258370, "body": "I played around with go and got it to show me the stderr output too: (exit status 1: xset:  unable to open display &quot;&quot;) I&#39;m wondering if it&#39;s like you said, and that root is getting blocked, although I can run the golang program from a root terminal and it works.. but is that working because I started the root session (via &quot;sudo -i&quot;) from the desktop users session? This is getting deeper than i expected it to, interesting stuff :)"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 1, "creation_date": 1450058425, "post_id": 34257440, "comment_id": 56258855, "body": "when it says display &quot;&quot;, that means it doesn&#39;t know which display.  When you execute a command line app from go, you can pass the environment, try doing that with DISPLAY=&quot;:0&quot;"}, {"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1450059777, "post_id": 34257440, "comment_id": 56259169, "body": "Awesome that worked! I set the display env using:  cmd.Env = []string{&quot;DISPLAY=:0&quot;}; Thank you :)"}], "answers": [{"comments": [{"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1450063898, "post_id": 34259026, "comment_id": 56260103, "body": "I thought Upstart was replaced with systemd in 15.04? (I&#39;m on 15.10) But, indeed it wont work unless I run &quot;xhost +&quot; from the user session... Is it possible to authorize the root user to have access to display too? so no matter who is logged in, it will still work. Would there be any issues in doing that?"}, {"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1450066294, "post_id": 34259026, "comment_id": 56260738, "body": "I notice I can run <code>xhost +SI:localuser:root</code> to get it to authorize the root user, so I put that at the bottom of the /etc/bash.bashrc file to run for all users, hopefully there&#39;s nothing wrong with that :)"}, {"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1450067640, "post_id": 34259026, "comment_id": 56261088, "body": "Now its only working after logging into the desktop (which is fine, it would be nice if it worked while on the login screen, but meh) and then after having to open a terminal window... :s but it still works after closing the terminal... I don&#39;t even know what to google to fix that one :s So close to working!"}, {"owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1450070822, "post_id": 34259026, "comment_id": 56262024, "body": "Solved by putting the <code>xhost +SI:localuser:root</code> at the top of the <code>&#47;etc&#47;profile</code> file instead of the bash.bashrc file. Thanks for the help :)"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "edited": false, "score": 0, "creation_date": 1450078053, "post_id": 34259026, "comment_id": 56264841, "body": "Prior to 15.04, you would have had two copies of Upstart running: the system one as pid 1, and a second one running as your user account to manage your desktop login session.  The system instance has indeed been replaced with systemd, but the user session one remains.  It will probably also be replaced with systemd at some point, but that hasn&#39;t happened yet."}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 1, "last_activity_date": 1450061251, "creation_date": 1450061251, "answer_id": 34259026, "question_id": 34257440, "link": "https://stackoverflow.com/questions/34257440/linux-display-command-works-in-terminal-but-not-in-systemd-service/34259026#34259026", "title": "Linux display command works in terminal, but not in systemd service", "body": "<p>The <code>xset</code> command is just a client for the X server.  It determines which X server to talk to by checking the <code>DISPLAY</code> environment variable, which won't be set when you run your command as a system service.</p>\n\n<p>And even if you ensured <code>DISPLAY</code> was set when running your daemon, it would likely be run as a different user account and denied access to the display by default.</p>\n\n<p>A better option would be to run the your daemon as part of the user session.  This will solve the authentication issues (it will be running as you), and the ability to locate the display (the environment variable should be visible).  The daemon won't be running when you aren't logged in, but that probably doesn't matter for this particular use case.</p>\n\n<p>You've tagged your question with \"Ubuntu\", where the session is still managed by <a href=\"http://upstart.ubuntu.com/\" rel=\"nofollow\">Upstart</a>.  You can create new user session jobs by creating a file in <code>~/.config/upstart</code>.  The details of the file format can be found in the <a href=\"http://manpages.ubuntu.com/manpages/wily/man5/init.5.html\" rel=\"nofollow\"><code>init(5)</code> man page</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "is_accepted": true, "score": 1, "last_activity_date": 1450075498, "last_edit_date": 1450075498, "creation_date": 1450066426, "answer_id": 34259657, "question_id": 34257440, "link": "https://stackoverflow.com/questions/34257440/linux-display-command-works-in-terminal-but-not-in-systemd-service/34259657#34259657", "title": "Linux display command works in terminal, but not in systemd service", "body": "<p>As per David Budworth's comment, the fix was exceedingly simple; as the service was running under root, it didn't have the DISPLAY environment variable set. </p>\n\n<p>In go you can set the environment variables when using exec like so:</p>\n\n<pre><code>//execute screens off command\ncmd := exec.Command(\"xset\", \"-display\", \":0\", \"dpms\", \"force\", \"off\")\ncmd.Env = []string{\"DISPLAY=:0\"} // set the display before executing\nstdout, stderr := cmd.CombinedOutput() //execute and return all output\n</code></pre>\n\n<p>And from James Henstridge answer I found I also needed to run <code>xhost +SI:localuser:root</code> to allow the root user access to the X server.</p>\n\n<p>You can do this for users after they've logged in by adding this line to the top of the <code>/etc/profile</code> file</p>\n\n<pre><code>xhost +SI:localuser:root &gt; /dev/null 2&gt;&amp;1\n</code></pre>\n\n<p><strong>OR</strong></p>\n\n<p>You can get it to work even when no user is logged in (when the login screen is showing)</p>\n\n<p>First I created the directory <code>/opt/scripts</code>\nthen created the file <code>/opt/scripts/xhost.sh</code>\nand gave it executable permissions with <code>chmod +x /opt/scripts/xhost.sh</code></p>\n\n<p>In this file is just the one line:</p>\n\n<pre><code>xhost +SI:localuser:root &gt; /dev/null 2&gt;&amp;1\n</code></pre>\n\n<p>Then edit the file <code>/etc/lightdm/lightdm.conf</code> (I had to create it, but edit it if it's there) and add the line\n<code>display-setup-script=/opt/scripts/xhost.sh</code></p>\n\n<p>So my <code>lightdm.conf</code> file looks like this:</p>\n\n<pre><code>[SeatDefaults]\ngreeter-session=unity-greeter\nuser-session=ubuntu\ndisplay-setup-script=/opt/scripts/xhost.sh\n</code></pre>\n\n<p>This tells LightDM (the display manager running in Ubuntu) to run the script <code>/opt/scripts/xhost.sh</code> after the X server is started but before anything else, therefore root is given the xhost authorization straightaway!</p>\n\n<p><em><strong>note:</strong></em></p>\n\n<p>display-setup-script is run after the X server starts but before the user session / greeter is run. Set this if you need to configure anything special in the X server. It is run as root. If this command returns an error code the X server is stopped.\n<em>Source: <a href=\"https://wiki.ubuntu.com/LightDM_\" rel=\"nofollow\">https://wiki.ubuntu.com/LightDM</em></a></p>\n"}], "owner": {"reputation": 612, "user_id": 1551924, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1d04ae409af850c5285e869aefb90ea9?s=128&d=identicon&r=PG&f=1", "display_name": "nevernew", "link": "https://stackoverflow.com/users/1551924/nevernew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2428, "favorite_count": 0, "accepted_answer_id": 34259657, "answer_count": 2, "score": 1, "last_activity_date": 1450075498, "creation_date": 1450047616, "last_edit_date": 1450066661, "question_id": 34257440, "link": "https://stackoverflow.com/questions/34257440/linux-display-command-works-in-terminal-but-not-in-systemd-service", "title": "Linux display command works in terminal, but not in systemd service", "body": "<p>I made a web app to turn off my computer's screens, there are a few different technologies but it's fairly simple:</p>\n\n<p>I have a html/js frontend that detects a button click (Screens On / Screens Off) which sends the option to the PHP backend via ajax</p>\n\n<p>The php then connects over a tcp port, sending the option to a program written in golang</p>\n\n<p>Then my golang program executes the command to turn off/on the screens.\nThe command it runs is (\"xset -display :0 dpms force off\")</p>\n\n<p>The problem I'm having is that the command only works when im running the golang program in the terminal, but when i set it up as a service the command wont work.</p>\n\n<p>This is the golang code:</p>\n\n<pre><code>package main\n\nimport (\n    \"os/exec\"\n    \"net\"\n    \"fmt\"\n    \"bufio\"\n)\n\nfunc main() {\n    fmt.Println(\"Launching server\")\n\n    ln, _ := net.Listen(\"tcp\", \":7777\")\n    fmt.Println(\"Listening...\\n\")\n\n    for {\n        // accept connection on port\n        conn, _ := ln.Accept()\n        fmt.Println(\"New connection\")\n\n        // listen for message ending in \\n\n        message, _ := bufio.NewReader(conn).ReadString('\\n')\n        rec := string(message)\n\n        // remove trailing \\n\n        rec = rec[:len(rec)-1]\n\n        fmt.Println(\"Message Received: \", \"\\\"\"+rec+\"\\\"\")\n\n        returnMessage := \"fail\"\n\n        if (rec == \"screensOff\") {\n            fmt.Println(\"Turning off screens...\")\n\n            //execute screens off command\n            cmd := exec.Command(\"xset\", \"-display\", \":0\", \"dpms\", \"force\", \"off\")\n            stdout, err := cmd.Output()\n\n            if err != nil {\n                fmt.Println(err.Error())\n            } else {\n                fmt.Println(string(stdout))\n                returnMessage = \"done\"\n            }\n        } else if (rec == \"screensOn\") {\n            fmt.Println(\"Turning on screens...\");\n\n            //execute screens on command\n            cmd := exec.Command(\"xset\", \"-display\", \":0\", \"dpms\", \"force\", \"on\")\n\n            stdout, err := cmd.Output()\n            if err != nil {\n                fmt.Println(err.Error())\n            } else {\n                fmt.Println(string(stdout))\n                returnMessage = \"done\"\n            }\n            returnMessage = \"done\"\n        } \n\n        conn.Write([]byte(returnMessage + \"\\n\"))\n\n        conn.Close()\n        fmt.Println(\"Connection closed\\n\")\n    }\n}\n</code></pre>\n\n<p>And relevant PHP code:</p>\n\n<pre><code>&lt;?php\nfunction sendServiceMessage($message) {\n    $host = \"localhost\";\n    $port = 7777;\n    $timeout = 30;\n\n    // connect to service\n    $socket = fsockopen($host, $port, $errnum, $errstr, $timeout);\n    if (!is_resource($socket)) {\n        exit(\"connection fail: \".$errnum.\" \".$errstr);\n    }\n    else {\n        // send message\n        fputs($socket, $message.\"\\n\");\n\n        // receive return message\n        $recieved = \"\";\n        while (!feof($socket)) {\n            $recieved .= fgets ($socket, 1024);\n        }\n    }\n\n    // close connection\n    fclose($socket);\n    if ($recieved == \"done\") {\n        return true;\n    }\n    return false;   \n}\n\nsendServiceMessage(\"screensOff\");\n</code></pre>\n\n<p>I used systemd to set up the service, so after building the program and placing it in /usr/bin/</p>\n\n<pre><code>...$ go build screenControl.go\n...$ sudo cp screenControl /usr/bin/screenControl\n</code></pre>\n\n<p>I can run the screenControl program in the terminal, and select \"screens off\" in the web app and it all works as expected:</p>\n\n<pre><code>...$ screenControl\nLaunching server\nListening...\n\nNew Connection\nMessage Received:  \"screensOff\"\nTurning off screens...\n\nConnection closed\n</code></pre>\n\n<p>I then created a systemd unit file (/etc/systemd/system/screenControl.service):</p>\n\n<pre><code>[Unit]\nDescription=Screen control service\n\n[Service]\nExecStart=/usr/bin/screenControl\nRestart=on-abort\n\n[Install]\nWantedBy=multi-user.target\n</code></pre>\n\n<p>I started the service and checked it:</p>\n\n<pre><code>...$ systemctl start screenControl\n...$ systemctl status screenControl\n\u25cf screenControl.service - Screen control service\n   Loaded: loaded (/etc/systemd/system/screenControl.service; disabled; vendor preset: enabled)\n   Active: active (running) since Sun 2015-12-13 22:31:54 GMT; 6s ago\n Main PID: 19871 (screenControl)\n   CGroup: /system.slice/screenControl.service\n           \u2514\u250019871 /usr/bin/screenControl\n\nDec 13 22:31:54 User systemd[1]: Started Screen control service.\nDec 13 22:31:54 User screenControl[19871]: Launching server\nDec 13 22:31:54 User screenControl[19871]: Listening...\n</code></pre>\n\n<p>So it's running, but then when I select screens off in the web app now, nothing happens... I checked the service status again and it is receiving the message to turn the screens off but the command is exiting with an error:</p>\n\n<pre><code>...\nDec 13 22:31:54 User screenControlTest[19871]: Launching server\nDec 13 22:31:54 User screenControlTest[19871]: Listening...\nDec 13 22:32:25 User screenControlTest[19871]: New connection\nDec 13 22:32:25 User screenControlTest[19871]: Message Received:  \"screensOff\"\nDec 13 22:32:25 User screenControlTest[19871]: Turning off screens...\nDec 13 22:32:25 User screenControlTest[19871]: exit status 1\nDec 13 22:32:25 User screenControlTest[19871]: Connection closed\n</code></pre>\n\n<p>What's the problem here and how can I get that command to work as a service? Once this is working I want to have the service start automatically when the machine turns on, although with systemd I think that's as simple as:</p>\n\n<pre><code>...$ systemctl enable screenControl\n</code></pre>\n\n<p>Any help would be great, thank you :)</p>\n\n<p><strong><em>Edit</em></strong></p>\n\n<p>After having the golang program show me the stderr of the xset command, I now also have the error message: </p>\n\n<pre><code>xset:  unable to open display \"\"\n</code></pre>\n"}, {"tags": ["json", "rest", "struct", "go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 0, "creation_date": 1450029812, "post_id": 34254345, "comment_id": 56250390, "body": "What is <code>daysIn</code> function?"}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1450029939, "creation_date": 1450029939, "answer_id": 34254440, "question_id": 34254345, "link": "https://stackoverflow.com/questions/34254345/list-of-struct-as-json-golang/34254440#34254440", "title": "list of struct as json golang", "body": "<p><a href=\"https://golang.org/ref/spec#Exported_identifiers\" rel=\"nofollow\">Export</a> the fields in CalendarDay by starting the name with an uppercase character.</p>\n\n<pre><code>type CalendarDay struct {\n    Day     int    `json:\"day\"`\n    Weekday string `json:\"weekday\"`\n}\n</code></pre>\n\n<p>The encoding/json package and similar packages ignore unexported fields.</p>\n"}], "owner": {"reputation": 85, "user_id": 5424399, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8c08d3694d079d1658e58b7ac43664f0?s=128&d=identicon&r=PG&f=1", "display_name": "user5424399", "link": "https://stackoverflow.com/users/5424399/user5424399"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 505, "favorite_count": 0, "closed_date": 1450030108, "answer_count": 1, "score": -2, "last_activity_date": 1450029939, "creation_date": 1450029397, "question_id": 34254345, "link": "https://stackoverflow.com/questions/34254345/list-of-struct-as-json-golang", "closed_reason": "Duplicate", "title": "list of struct as json golang", "body": "<p>I am trying to return a json with a list in each property but I am always obtaining the lists as empty lists. It seems that I have a mistake inside a structure but I cannot found it.</p>\n\n<p>I have two structs:</p>\n\n<pre><code>type CalendarDay struct {\n    day     int    `json:\"day\"`\n    weekday string `json:\"weekday\"`\n}\n\ntype CalendarYear struct {\n    January   []CalendarDay `json:\"january\"`\n    February  []CalendarDay `json:\"february\"`\n    March     []CalendarDay `json:\"march\"`\n    April     []CalendarDay `json:\"april\"`\n    May       []CalendarDay `json:\"may\"`\n    June      []CalendarDay `json:\"june\"`\n    July      []CalendarDay `json:\"july\"`\n    August    []CalendarDay `json:\"august\"`\n    September []CalendarDay `json:\"september\"`\n    October   []CalendarDay `json:\"october\"`\n    November  []CalendarDay `json:\"november\"`\n    December  []CalendarDay `json:\"december\"`\n}\n</code></pre>\n\n<p>I'm trying to return a json as:</p>\n\n<pre><code>{\n    \"january\": [{1 Thursday}, ...]\n    ...\n}\n</code></pre>\n\n<p>but I obatain:</p>\n\n<pre><code>{\n    \"january\": [{}, {}, {} ...]\n    ...\n}\n</code></pre>\n\n<p>My API is:</p>\n\n<pre><code>func Calendar(w http.ResponseWriter, r *http.Request) {\n    fmt.Println(\"GET /\")\n    year := getYear(2015)\n    json.NewEncoder(w).Encode(year)\n}\n\nfunc getMonthDays(month time.Month, year int) []CalendarDay {\n    cdays := []CalendarDay{}\n    for i := 1; i &lt;= daysIn(month, year); i++ {\n        date := time.Date(year, month, i, 0, 0, 0, 0, time.UTC)\n        weekday := date.Weekday()\n        cday := CalendarDay{\n            day:     date.Day(),\n            weekday: weekday.String()}\n        cdays = append(cdays, cday)\n    }\n    return cdays\n}\n\nfunc getYear(year int) CalendarYear {\n    yearCal := CalendarYear{\n        January:   getMonthDays(time.January, year),\n        February:  getMonthDays(time.February, year),\n        March:     getMonthDays(time.March, year),\n        April:     getMonthDays(time.April, year),\n        May:       getMonthDays(time.May, year),\n        June:      getMonthDays(time.June, year),\n        July:      getMonthDays(time.July, year),\n        August:    getMonthDays(time.August, year),\n        September: getMonthDays(time.September, year),\n        October:   getMonthDays(time.October, year),\n        November:  getMonthDays(time.November, year),\n        December:  getMonthDays(time.December, year)}\n    return yearCal\n}\n</code></pre>\n\n<p>What am I doing wrong?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "edited": false, "score": 4, "creation_date": 1450024913, "post_id": 34253393, "comment_id": 56248568, "body": "Alternatively, make the map use OpType instead of int32, <code>map[OpType]string{</code>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1450040005, "post_id": 34253393, "comment_id": 56254034, "body": "I think it worth to do a bit of nit-picking: <code>OpType</code> is not <code>int32</code>: it only shares the internal representation of the values of its type with <code>int32</code>. The crucial point is that <code>type B A</code> does not make <code>B</code> &quot;inherit&quot; any methods of <code>A</code>. This does not matter for <code>int32</code>, which does not have methods, but is important to know when dealing with custom types."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1450040309, "post_id": 34253393, "comment_id": 56254139, "body": "I mean, that&#39;s the reason why Go does allow type-conversion from <code>int32</code> to <code>OpType</code> (the internal representation of the value is the same) but does not allow to assign a value of <code>OpType</code> to a receiver of type <code>int32</code>: if it would be allowed, the receiver might want to call a method defined for its type but the value passed to it would not have it in its (different) type."}], "tags": [], "owner": {"reputation": 33452, "user_id": 296452, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/15ba69c4116f6646b861202252d953ab?s=128&d=identicon&r=PG", "display_name": "Andreas Wederbrand", "link": "https://stackoverflow.com/users/296452/andreas-wederbrand"}, "is_accepted": true, "score": 6, "last_activity_date": 1450035010, "last_edit_date": 1450035010, "creation_date": 1450024161, "answer_id": 34253393, "question_id": 34253313, "link": "https://stackoverflow.com/questions/34253313/how-to-access-map-values-in-go/34253393#34253393", "title": "How to access map values in GO?", "body": "<p>Go is very strict on types. Your maps all have keys with typ int32 and you are trying to access them using a value of type OpType. It doesn't matter that OpType is an int32.</p>\n\n<p>You can cast your OpType to int32 and make it work</p>\n\n<pre><code>func main() {\n  fmt.Println(OpType_name[int32(OpType_UNKNOWN)])\n}\n</code></pre>\n\n<p>The comment from @nos is a good way to go, it's probably what you want in this case.</p>\n\n<p><a href=\"https://play.golang.org/p/dum5GiB3zS\" rel=\"nofollow\">https://play.golang.org/p/dum5GiB3zS</a></p>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 596, "favorite_count": 0, "accepted_answer_id": 34253393, "answer_count": 1, "score": 4, "last_activity_date": 1450035010, "creation_date": 1450023719, "question_id": 34253313, "link": "https://stackoverflow.com/questions/34253313/how-to-access-map-values-in-go", "title": "How to access map values in GO?", "body": "<p>How do I access the map value for the following code? The code snippet is auto generated, so I can't modify it. I have tried <code>OpType_name[OpType_UNKNOWN]</code> but I am getting error from the golang compiler.</p>\n\n<pre><code>type OpType int32\n\nconst (\n    OpType_UNKNOWN OpType = 0\n    OpType_CREATE OpType = 1\n    OpType_DELETE OpType = 3\n)\n\nvar OpType_name = map[int32]string{\n    0: \"UNKNOWN\",\n    1: \"CREATE\",\n    2: \"DELETE\",\n}\nvar OpType_value = map[string]int32{\n    \"UNKNOWN\": 0,\n    \"CREATE\": 1,\n    \"DELETE\": 2,\n}\n</code></pre>\n\n<p>Error:\n<code>cannot use int(api.OpType_UNKNOWN) (type int) as type int32 in map index</code></p>\n"}, {"tags": ["go", "concurrency", "parallel-processing", "producer-consumer"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1450035192, "post_id": 34253215, "comment_id": 56252306, "body": "You could start by using the real name of the language: Go. For the rest: Completely unanswerable as it solely depends on all the nasty details of the requirements and your storage."}, {"owner": {"reputation": 720, "user_id": 1752124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f37430e935542dafdc7f86c6e9fa03e4?s=128&d=identicon&r=PG", "display_name": "ravi", "link": "https://stackoverflow.com/users/1752124/ravi"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1450036539, "post_id": 34253215, "comment_id": 56252793, "body": "Okay! I don&#39;t think using Golang instead of Go is offensive. Even, the official website is named Golang.org. As for the part of nasty details, I can explain every bit of that if you want. Just let me know, which part is nasty?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1450038051, "post_id": 34253215, "comment_id": 56253367, "body": "What are your requirements and constraints? How do you want to display errors to the user? What does your cloud storage do if you do the same store twice and/or in parallel? Expected traffic? And so on."}, {"owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 1, "creation_date": 1450038843, "post_id": 34253215, "comment_id": 56253628, "body": "Goroutines are cheap, quite normal to spawn one or two for request handling. With first approach you can pipe to cloud before the upload finish. Second way easy to implement, just send file descriptors to channel and one or more workers will read and transfer to cloud. Channel is the queue. Personaly, I&#39;d rather generate auth token and redirect user to cloud with token provided."}, {"owner": {"reputation": 720, "user_id": 1752124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f37430e935542dafdc7f86c6e9fa03e4?s=128&d=identicon&r=PG", "display_name": "ravi", "link": "https://stackoverflow.com/users/1752124/ravi"}, "reply_to_user": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "edited": false, "score": 0, "creation_date": 1450075207, "post_id": 34253215, "comment_id": 56263563, "body": "@Uvelichitel: Thanks for the comment! I recommended using auth token and uploading the file directly to S3(please refer to update in question), but not accepted by clients."}, {"owner": {"reputation": 720, "user_id": 1752124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f37430e935542dafdc7f86c6e9fa03e4?s=128&d=identicon&r=PG", "display_name": "ravi", "link": "https://stackoverflow.com/users/1752124/ravi"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1450075300, "post_id": 34253215, "comment_id": 56263608, "body": "@Volker: I am new at designing architectures, so my question might have been confusing or incomplete. I have updated it somewhat. Appreciate your suggestions."}], "answers": [{"tags": [], "owner": {"reputation": 3000, "user_id": 1335245, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3b201e069f3e6868c1c0285f6e31801c?s=128&d=identicon&r=PG", "display_name": "Charney Kaye", "link": "https://stackoverflow.com/users/1335245/charney-kaye"}, "is_accepted": true, "score": 2, "last_activity_date": 1450083256, "last_edit_date": 1450083256, "creation_date": 1450061922, "answer_id": 34259115, "question_id": 34253215, "link": "https://stackoverflow.com/questions/34253215/producer-consumer-in-golang-concurrency-vs-parallelism/34259115#34259115", "title": "producer consumer in golang - concurrency vs parallelism?", "body": "<p>A User uploading a file could tolerate an error, and try again. But the danger exists when an uploaded file exists only on the machine it was uploaded to, and something goes wrong before it gets uploaded to cloud storage. In that case, the file would be lost, and it would be a bummer for the User.</p>\n\n<p>This is solved by good architecture. It's a <a href=\"https://en.wikipedia.org/wiki/FIFO_%28computing_and_electronics%29\" rel=\"nofollow\">first-in, first out queue pattern</a>.</p>\n\n<p>A favorite Go implementation of this pattern is <a href=\"https://github.com/jrallison/go-workers\" rel=\"nofollow\">go-workers</a> perhaps backed by a <a href=\"http://redis.io/\" rel=\"nofollow\">Redis</a> database.</p>\n\n<p>Assume there are <strong><em>n</em></strong> number of servers running your service at any given time. Assume that your backend code compiles two separate binaries, a <strong>server</strong> binary and a <strong>worker</strong> binary.</p>\n\n<p>Ideally, the machines accepting file uploads would all mount a shared <a href=\"https://en.wikipedia.org/wiki/Network_File_System\" rel=\"nofollow\">Network File System</a> such that:</p>\n\n<ol>\n<li><p>User uploads a file to a <strong>server</strong></p>\n\n<p>a. <strong>server</strong> adds a record into the work queue, which contains a unique ID from the Redis storage.</p>\n\n<p>b. This unique ID is used to create the filename, and the file is piped directly from the User upload to temporary storage on NFS server. Note that the file never resides on the storage of the machine running the <strong>server</strong>.</p></li>\n<li><p>File is uploaded to cloud storage by a <strong>worker</strong></p>\n\n<p>a. <strong>worker</strong> picks up the next to-do record from the work queue, which has a unique ID</p>\n\n<p>b. Using the unique ID to find the file on NFS server, the <strong>worker</strong> uploads the file to cloud storage</p>\n\n<p>c. When successful, <strong>worker</strong> updates the record in the work queue to reflect success</p>\n\n<p>d. <strong>worker</strong> deletes the file on NFS server</p></li>\n</ol>\n\n<p>By monitoring the server traffic and work queue size as two separate metrics, it can be determined how many servers ought to run the server/worker services respectively.</p>\n"}, {"comments": [{"owner": {"reputation": 720, "user_id": 1752124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f37430e935542dafdc7f86c6e9fa03e4?s=128&d=identicon&r=PG", "display_name": "ravi", "link": "https://stackoverflow.com/users/1752124/ravi"}, "edited": false, "score": 0, "creation_date": 1450075546, "post_id": 34261056, "comment_id": 56263697, "body": "Thanks! Let me go through both the articles and update."}], "tags": [], "owner": {"reputation": 382, "user_id": 812039, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/7eKW0.jpg?s=128&g=1", "display_name": "Vivek", "link": "https://stackoverflow.com/users/812039/vivek"}, "is_accepted": false, "score": 2, "last_activity_date": 1463386865, "last_edit_date": 1495535244, "creation_date": 1450074921, "answer_id": 34261056, "question_id": 34253215, "link": "https://stackoverflow.com/questions/34253215/producer-consumer-in-golang-concurrency-vs-parallelism/34261056#34261056", "title": "producer consumer in golang - concurrency vs parallelism?", "body": "<p>Marcio Castilho had written a good article on a similar problem. It can be found at <a href=\"http://marcio.io/2015/07/handling-1-million-requests-per-minute-with-golang/\" rel=\"nofollow noreferrer\">Handling one million requests per minutes with golang</a>. </p>\n\n<p>He shows the mistakes that he made and the steps which he took to correct them. Good source to learn the use of channels, goroutines and concurrency in general.</p>\n\n<p><a href=\"https://github.com/jrallison/go-workers\" rel=\"nofollow noreferrer\">go-workers</a> mentioned by <a href=\"https://stackoverflow.com/users/1335245/charneykaye\">charneykaye</a> is also excellent source.</p>\n"}], "owner": {"reputation": 720, "user_id": 1752124, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f37430e935542dafdc7f86c6e9fa03e4?s=128&d=identicon&r=PG", "display_name": "ravi", "link": "https://stackoverflow.com/users/1752124/ravi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 848, "favorite_count": 2, "accepted_answer_id": 34259115, "answer_count": 2, "score": 2, "last_activity_date": 1463386865, "creation_date": 1450023270, "last_edit_date": 1450075051, "question_id": 34253215, "link": "https://stackoverflow.com/questions/34253215/producer-consumer-in-golang-concurrency-vs-parallelism", "title": "producer consumer in golang - concurrency vs parallelism?", "body": "<p>I am working on backend architecture which is purely in Golang. I have an API which is used to upload a file to golang server and then I am transferring the file to cloud storage(from the golang server itself). Now, I want both the transfers to be independent, so that, the end user should not has to wait for the response after uploading a file. </p>\n\n<pre><code>End User -&gt; Golang Server -&gt;[Concurrency/Parallelism] -&gt; Cloud Storage\n</code></pre>\n\n<p>Now, I thought of two ways:</p>\n\n<ol>\n<li>Create a goroutine as soon as the user finishes the upload and transfer the file to cloud.</li>\n<li>Insert the file handler into a queue, and a different process would read this queue and transfer the file to cloud storage (Multiple producers - Single Consumer model).</li>\n</ol>\n\n<p>I found examples of doing this using goroutine and channels but I think that would create as many goroutines as much there are uploads. I want to use the second option but not able to understand of how to go about it in golang?</p>\n\n<p>Also, do suggest if I am using wrong approach and there is some other efficient method of doing this.</p>\n\n<p><strong>Update</strong></p>\n\n<p>Details about the requirement and constraint:<br>\n1. I am using AWS S3 as cloud storage. If at some point, the upload from Go server to Amazon S3 fails, the file handler should be kept as in to keep record of the failed upload.(I am not prioritising this, I might change this based on clients feedback)<br>\n2. The file will be deleted from the Go server as soon as the upload completes successfully to Amazon S3, so as to avoid repetitive uploads. Also, if a file is uploaded with same name, it will be replaced at Amazon S3.<br>\n3. As pointed out in comments, I can use channel as the queue. Is it possible to design the above architecture using Go's Channels and goroutines?</p>\n"}, {"tags": ["go", "makefile"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1450004140, "post_id": 34250228, "comment_id": 56242194, "body": "You cannot do this (under the constraint minimal dependency)."}, {"owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1450004365, "post_id": 34250228, "comment_id": 56242255, "body": "@Volker, can you please suggest  just a way to do this with make using external tools?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1450004886, "post_id": 34250228, "comment_id": 56242399, "body": "You need some tool watching the file system and call make. These fs-watching tools are typically OS dependent. So look for files system watching tool which suites your need. (This has nothing to do with make)."}, {"owner": {"reputation": 13458, "user_id": 1773798, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/4Ljqn.png?s=128&g=1", "display_name": "Renaud Pacalet", "link": "https://stackoverflow.com/users/1773798/renaud-pacalet"}, "edited": false, "score": 0, "creation_date": 1450076230, "post_id": 34250228, "comment_id": 56263960, "body": "It is make&#39;s purpose to update what needs to be upon file changes. So, if <i>watch</i>, in your question, means <i>take into account</i>, just write a makefile with the proper rules (target, prerequisites, recipe) and call make to do the job. If <i>watch</i> means <i>periodically check and update if needed</i>, then it is not a make question, it is a question about periodically executing a task, whatever it is and does. Under MAC OS X, GNU/Linux or UNIX systems, have a look at <code>cron</code> and <code>anacron</code>, for instance."}], "answers": [{"tags": [], "owner": {"reputation": 8296, "user_id": 216488, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c510f6396aac23ff75e25f50cf3014d6?s=128&d=identicon&r=PG", "display_name": "Caleb", "link": "https://stackoverflow.com/users/216488/caleb"}, "is_accepted": false, "score": 0, "last_activity_date": 1450268189, "creation_date": 1450268189, "answer_id": 34311813, "question_id": 34250228, "link": "https://stackoverflow.com/questions/34250228/how-to-execute-a-make-target-on-file-change-automatically/34311813#34311813", "title": "How to execute a make target on file change automatically?", "body": "<p>For the watching you can use <a href=\"https://github.com/emcrisostomo/fswatch\" rel=\"nofollow\">fswatch</a>. (There's also a go version of this program which may be easier to install: <a href=\"https://github.com/codeskyblue/fswatch\" rel=\"nofollow\">fswatch</a>) For example:</p>\n\n<pre><code>fswatch -ext cpp,c,h make -f Makefile\n</code></pre>\n\n<p>Anytime you change a <code>cpp</code>, <code>c</code> or <code>h</code> file it will run make again.</p>\n\n<p>Make can be a bit slow for this, so I tend to use <a href=\"https://ninja-build.org/manual.html\" rel=\"nofollow\">ninja</a> instead, but that really depends on the size of your project.</p>\n\n<p>Another option is <a href=\"http://gittup.org/tup/\" rel=\"nofollow\">tup</a>, which has watching built-in:</p>\n\n<pre><code>tup monitor\n</code></pre>\n\n<p>But, sadly, only for linux.</p>\n"}, {"tags": [], "owner": {"reputation": 5846, "user_id": 2248627, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g6uq8.jpg?s=128&g=1", "display_name": "Levon", "link": "https://stackoverflow.com/users/2248627/levon"}, "is_accepted": false, "score": 0, "last_activity_date": 1596303357, "creation_date": 1596303357, "answer_id": 63208199, "question_id": 34250228, "link": "https://stackoverflow.com/questions/34250228/how-to-execute-a-make-target-on-file-change-automatically/63208199#63208199", "title": "How to execute a make target on file change automatically?", "body": "<p>You can use <a href=\"https://github.com/eradman/entr\" rel=\"nofollow noreferrer\"><strong>entr</strong></a> and adjust your <code>Makefile</code> similar to this one</p>\n<pre><code>.DEFAULT_GOAL := run\nSHELL := /bin/bash\n\nrun:\n    clear &amp;&amp; \\                    \n    cp one.txt two.txt &amp;&amp; \\       \n    rm -f _* *.l2m *.o2m &amp;&amp; \\     \n    Ganlib &lt; testgan2.x2m\n\nwatch:\n    while sleep 1 ; do find . -name '*.x2m' -o -name '*.c2m' \\\n    | entr -d make -f ./Makefile ; done\n\n.PHONY: run watch \n\n</code></pre>\n<p>followed by</p>\n<pre><code>$ make watch\n</code></pre>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 295, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1596303357, "creation_date": 1450003419, "question_id": 34250228, "link": "https://stackoverflow.com/questions/34250228/how-to-execute-a-make-target-on-file-change-automatically", "title": "How to execute a make target on file change automatically?", "body": "<p>How do I write a <code>make</code> target that will watch for any file changes in specific folders and execute some other make target to compile files? I am looking for a way that can do this with minimal dependency on tools in addition to <code>make</code> itself to keep things simple.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1449998329, "post_id": 34249560, "comment_id": 56240705, "body": "Why on earth do you want to <b>re</b>-parse the time after printing it with fmt.Sprintf? The whole code is completely pointless."}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1449998476, "post_id": 34249560, "comment_id": 56240736, "body": "@Volker the intention was to get it into the format of <code>2015-12-13 @ 05:06:06</code> which I though I would have to parse it into a string so I could call parse on it, maybe I&#39;m just confused who knows"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1449998657, "post_id": 34249560, "comment_id": 56240778, "body": "Yes that is a confusion. time.Time --&gt; string is done with the time.Format() method (<a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#Time.Format</a>) and <i>not</i> with fmt.Sprintf. There is zero need to parse a string if you want to format a time as a string."}, {"owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "edited": false, "score": 0, "creation_date": 1450035690, "post_id": 34249560, "comment_id": 56252484, "body": "What is your input format? I am confused by the double timezone"}], "answers": [{"tags": [], "owner": {"reputation": 1288, "user_id": 437276, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b17c2d117a867b6d755ffa4d601ca42?s=128&d=identicon&r=PG", "display_name": "0x434D53", "link": "https://stackoverflow.com/users/437276/0x434d53"}, "is_accepted": true, "score": 1, "last_activity_date": 1450035915, "creation_date": 1450035915, "answer_id": 34255503, "question_id": 34249560, "link": "https://stackoverflow.com/questions/34249560/not-able-to-parse-time-properly/34255503#34255503", "title": "Not able to parse time properly", "body": "<p>You have to parse it as </p>\n\n<pre><code>t, _ := time.Parse(\"2006-01-02 15:04:05 -0700 MST\")\n</code></pre>\n\n<p>For parsing you have to give the format of the date you are receiving.</p>\n\n<p>Then you can format the correctly parsed time using</p>\n\n<pre><code>t.Format(\"Jan 2 2006 @ 15:04:05\")\n</code></pre>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 34255503, "answer_count": 1, "score": 1, "last_activity_date": 1450035915, "creation_date": 1449997867, "question_id": 34249560, "link": "https://stackoverflow.com/questions/34249560/not-able-to-parse-time-properly", "title": "Not able to parse time properly", "body": "<p>I'm trying to parse time for values in a template like so:</p>\n\n<pre><code>\"parseDate\": func(timeStamp time.Time) string {\n            newTime, err := time.Parse(\"Jan 2 2006 @ 15:04:05\", fmt.Sprintf(\"%v\", timeStamp))\n            if err != nil {\n                log.Println(err)\n            }\n            return fmt.Sprintf(\"%v\", newTime)\n},\n</code></pre>\n\n<p>which is one of my handler funcs, but I get this error:</p>\n\n<p><code>parsing time \"2015-12-13 06:49:52 +0000 UTC\" as \"Jan 2 2006 @ 15:04:05\": cannot parse \"2015-12-13 06:49:52 +0000 UTC\" as \"Jan\"</code></p>\n\n<p>Not sure what I'm doing wrong</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1449998466, "post_id": 34248302, "comment_id": 56240733, "body": "You naming of the interface suggests you think of subclasses or inheritance. Stop this now and forever. Thinking along this concepts will not help you programming in Go. It really won&#39;t. If you model your problems with this state of mind you will fail."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1449985694, "last_edit_date": 1449985694, "creation_date": 1449985050, "answer_id": 34248326, "question_id": 34248302, "link": "https://stackoverflow.com/questions/34248302/why-the-interface-field-access-in-the-go-language-program-given-in-details-works/34248326#34248326", "title": "Why the interface field access in the GO language program given in details works?", "body": "<p>The result of the type assertion expression <code>m.(Sub)</code> is of type <code>Sub</code>.  Interface <code>Sub</code> has a <code>Name()</code> method which you can call.</p>\n\n<p>The type assertion of <code>m</code> to <code>Sub</code> succeeds because the value in <code>m</code> is a <code>HumanStruct</code> and that type satisfies the <code>Sub</code> interface.</p>\n"}], "owner": {"reputation": 513, "user_id": 5673789, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/4ade403dabcac1cdd5cd25bbd600f7ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jsmith", "link": "https://stackoverflow.com/users/5673789/jsmith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 34248326, "answer_count": 1, "score": 0, "last_activity_date": 1484254896, "creation_date": 1449984699, "last_edit_date": 1484254896, "question_id": 34248302, "link": "https://stackoverflow.com/questions/34248302/why-the-interface-field-access-in-the-go-language-program-given-in-details-works", "title": "Why the interface field access in the GO language program given in details works?", "body": "<p>I have defined 2 interfaces {Main, Sub} and a structure HumanStruct in the code in the following link. I know why s1.(Main).Title() works.But I want to know why m.(Sub).Name() works. Here 'm' is variable of interface Main type. This Main interface has no field 'Sub'. Then how it works?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Main interface {\n    Title() string\n}\n\ntype Sub interface {\n    Main\n    Name() string\n}\n\ntype HumanStruct struct {\n    name  string\n    title string\n}\n\nfunc (hs HumanStruct) Name() string {\n    return hs.name\n}\n\nfunc (hs HumanStruct) Title() string {\n    return hs.title\n}\n\nfunc main() {\n    h := HumanStruct{name: \"John\", title: \"Kings\"}\n\n    var m Main\n    m = h\n\n    var s1 Sub\n    s1 = h\n\n    fmt.Println(\"From main: \", m.(Sub).Name())\n    fmt.Println(\"From sub:  \", s1.(Main).Title())\n}\n</code></pre>\n"}, {"tags": ["go", "google-api", "gmail-api"], "comments": [{"owner": {"reputation": 601, "user_id": 5351638, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c59e9b88305b699f628610b73d815fb8?s=128&d=identicon&r=PG&f=1", "display_name": "Andres", "link": "https://stackoverflow.com/users/5351638/andres"}, "edited": false, "score": 0, "creation_date": 1450122152, "post_id": 34248076, "comment_id": 56292363, "body": "It looks like there is something malformed in your request. Can you provide the full request?"}, {"owner": {"reputation": 1691, "user_id": 9609442, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bC135.jpg?s=128&g=1", "display_name": "Gabe", "link": "https://stackoverflow.com/users/9609442/gabe"}, "edited": false, "score": 0, "creation_date": 1581811467, "post_id": 34248076, "comment_id": 106561602, "body": "did you ever figure this out?"}], "answers": [{"tags": [], "owner": {"reputation": 690, "user_id": 3377170, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9ed1f46ee137f59695a3340aac0f89a0?s=128&d=identicon&r=PG&f=1", "display_name": "Brandon Jewett-Hall", "link": "https://stackoverflow.com/users/3377170/brandon-jewett-hall"}, "is_accepted": false, "score": 0, "last_activity_date": 1450724983, "creation_date": 1450724983, "answer_id": 34402673, "question_id": 34248076, "link": "https://stackoverflow.com/questions/34248076/golang-gmail-api-400-badrequest-failed-precondition/34402673#34402673", "title": "Golang - Gmail API 400 BadRequest Failed Precondition", "body": "<p>To send mail, you must specify a valid address for the From: header (<a href=\"https://support.google.com/mail/answer/22370\" rel=\"nofollow\">https://support.google.com/mail/answer/22370</a>).  <code>noreply@example.com</code> is unlikely to be such an address given that example.com is a test-only domain per <a href=\"https://tools.ietf.org/html/rfc2606#section-3\" rel=\"nofollow\">RFC 2606</a>.</p>\n"}], "owner": {"reputation": 2146, "user_id": 455637, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/bc02d63efa6e4af9c2f1a217d15d8419?s=128&d=identicon&r=PG", "display_name": "max", "link": "https://stackoverflow.com/users/455637/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 887, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1450724983, "creation_date": 1449982013, "last_edit_date": 1495539883, "question_id": 34248076, "link": "https://stackoverflow.com/questions/34248076/golang-gmail-api-400-badrequest-failed-precondition", "title": "Golang - Gmail API 400 BadRequest Failed Precondition", "body": "<p>I've been struggling against this error (<code>googleapi: Error 400: Bad Request, failedPrecondition</code>) for about 8 hours now. I've written a simple go program which reproduces the problem for me. Maybe someone familiar with the Google APIs can help me out.</p>\n\n<p>The error is the same as the one mentioned here: <a href=\"https://stackoverflow.com/questions/29327846/gmail-rest-api-400-bad-request-failed-precondition\">Gmail REST API : 400 Bad Request + Failed Precondition</a>. The only difference is that it is in Go. I've followed the steps but still no luck.</p>\n\n<p>I've also updated my code based on <a href=\"https://stackoverflow.com/questions/25382821/how-to-send-email-through-gmail-go-sdk/25387678#25387678\">How to send email through Gmail Go SDK?</a></p>\n\n<p>Both questions were helpful but did not help resolve the latest issue. I have also set <code>GOOGLE_APPLICATION_CREDENTIALS</code> to my project's json.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"fmt\"\n    \"log\"\n    \"net/mail\"\n    \"strings\"\n\n    \"golang.org/x/net/context\"\n    \"golang.org/x/oauth2/google\"\n\n    gmail \"google.golang.org/api/gmail/v1\"\n)\n\nfunc main() {\n    // Use oauth2.NoContext if there isn't a good context to pass in.\n    ctx := context.TODO()\n\n    client, err := google.DefaultClient(ctx, gmail.GmailSendScope)\n    if err != nil {\n        panic(err)\n    }\n\n    // create service\n    svc, err := gmail.New(client)\n    if err != nil {\n        log.Fatalf(\"Unable to create Gmail service: %v\", err)\n    }\n\n    if err := SendEmail(ctx, svc, &lt;redacted&gt;); err != nil {\n        log.Fatalf(\"failed to send email: %v\", err)\n    }\n}\n\nfunc SendEmail(ctx context.Context, svc *gmail.Service, email string) error {\n    from := mail.Address{\"\", \"noreply@example.com\"}\n\n    header := make(map[string]string)\n    header[\"From\"] = from.String()\n    header[\"To\"] = email\n    header[\"Subject\"] = encodeRFC2047(\"Hello, Gmail!\")\n    header[\"MIME-Version\"] = \"1.0\"\n    header[\"Content-Type\"] = \"text/html; charset=\\\"utf-8\\\"\"\n    header[\"Content-Transfer-Encoding\"] = \"base64\"\n\n    var msg string\n    for k, v := range header {\n        msg += fmt.Sprintf(\"%s: %s\\r\\n\", k, v)\n    }\n    msg += \"\\r\\n\" + \"Hello, Gmail!\"\n\n    gmsg := gmail.Message{\n        Raw: encodeWeb64String([]byte(msg)),\n    }\n\n    _, err := svc.Users.Messages.Send(\"me\", &amp;gmsg).Do()\n    return err\n}\n\nfunc encodeRFC2047(s string) string {\n    // use mail's rfc2047 to encode any string\n    addr := mail.Address{s, \"\"}\n    return strings.Trim(addr.String(), \" &lt;&gt;\")\n}\n\nfunc encodeWeb64String(b []byte) string {\n\n    s := base64.URLEncoding.EncodeToString(b)\n\n    var i = len(s) - 1\n    for s[i] == '=' {\n        i--\n    }\n\n    return s[0 : i+1]\n}\n</code></pre>\n\n<p>Running the code above should produce the following error:</p>\n\n<pre><code>2015/12/12 22:16:46 failed to send email: googleapi: Error 400: Bad Request, failedPrecondition\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1183, "user_id": 2959387, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459784500061e41da68ed5af11f92183?s=128&d=identicon&r=PG&f=1", "display_name": "Prashant Thakkar", "link": "https://stackoverflow.com/users/2959387/prashant-thakkar"}, "edited": false, "score": 0, "creation_date": 1449981969, "post_id": 34248059, "comment_id": 56237845, "body": "Provide more code to understand the issue and also what is the current outcome of the thing you tried."}], "answers": [{"comments": [{"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 0, "creation_date": 1517562217, "post_id": 34248109, "comment_id": 84154369, "body": "what if  the field i want to access is an variable? <code>(index .Posts 0).$fieldName </code> doesn&#39;t work"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1449982320, "creation_date": 1449982320, "answer_id": 34248109, "question_id": 34248059, "link": "https://stackoverflow.com/questions/34248059/golang-how-can-i-access-a-slices-fields-from-html-template/34248109#34248109", "title": "Golang how can I access a slices fields from html/template", "body": "<p>Use the following to access the thread name of the first post:</p>\n\n<pre><code>{{(index .Posts 0).ThreadName}}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/wUxh7rwp-w\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 148, "favorite_count": 0, "accepted_answer_id": 34248109, "answer_count": 1, "score": 0, "last_activity_date": 1449982320, "creation_date": 1449981747, "question_id": 34248059, "link": "https://stackoverflow.com/questions/34248059/golang-how-can-i-access-a-slices-fields-from-html-template", "title": "Golang how can I access a slices fields from html/template", "body": "<p>I have a <code>[]struct{}</code> and that <code>[]struct{}</code> has a field called <code>ThreadName</code> and I'm trying to access that from in the template like so:</p>\n\n<p><code>{{ index .Posts 0 $.ThreadName}}</code></p>\n\n<p>not sure how to do this properly any information would be great thanks.</p>\n"}, {"tags": ["javascript", "go", "go-gorm"], "comments": [{"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449971643, "post_id": 34246904, "comment_id": 56236125, "body": "Could you add more info? How did you define the models? How are you querying?"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449972234, "post_id": 34246904, "comment_id": 56236241, "body": "@AbelardoMendoza updated"}, {"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449973597, "post_id": 34246904, "comment_id": 56236484, "body": "Well, I have a similar schema with one-to-many relationships and the slice is coming as an empty slice and is being passed correctly to the frontend as an empty array. Could you try: <code>fmt.Println(forumContainers.MainThreads)</code> right after the query <code>db.Preload(&quot;MainThreads&quot;).Find(&amp;forumContainers)</code> is executed. It might also be an older version of the GORM. Which version are you using?"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449973999, "post_id": 34246904, "comment_id": 56236565, "body": "@AbelardoMendoza I&#39;m using as far as I know, the most recent I just did a <code>go get</code> a few hours ago"}, {"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449974417, "post_id": 34246904, "comment_id": 56236639, "body": "I just updated my gorm and tried with the same one-to-many models and I still got the empty slice. Did you try the fmt.Println right after the query?"}, {"owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "reply_to_user": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449974844, "post_id": 34246904, "comment_id": 56236700, "body": "@AbelardoMendoza hmm weird it seems to be working now, I wonder if I had changed something and not realized it or what...."}], "owner": {"reputation": 12897, "user_id": 2128168, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/tOuCx.png?s=128&g=1", "display_name": "Datsik", "link": "https://stackoverflow.com/users/2128168/datsik"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1570, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1450037031, "creation_date": 1449968858, "last_edit_date": 1450037031, "question_id": 34246904, "link": "https://stackoverflow.com/questions/34246904/is-it-possible-to-get-gorm-to-populate-nil-values-with-say-an-empty-slice-instea", "title": "Is it possible to get GORM to populate nil values with say an empty slice instead of being just nil?", "body": "<p>I'm currently working on a project and right now I have some basic Javascript</p>\n\n<p><code>blah.map(function(lBlah) {});</code></p>\n\n<p><code>blah</code> is generated from an ajax request to a database which returns an array of objects (or slice if you prefer)</p>\n\n<p>The only problem is I get a JS error: <code>cannot read property 'map' of null</code> this is because if my <code>one-to-many</code> association has no associated values at the time, it just makes that field <code>nil</code> instead of an empty slice so when I <code>json.Marshal</code> it it sends a null value instead of an empty <code>[]</code> which would fix all my errors, currently having to range over each <code>struct</code> that is returned from the database and check for nil values then <code>make([]blah, 0)</code> is annoying and looks messy. Is there an easier way to accomplish this? Is it possible to set a default <code>json:\"default:[]\"</code> or something? </p>\n\n<pre><code>// ForumContainer is a table in the database\ntype ForumContainer struct {\n    gorm.Model\n    ContainerName string `sql:\"not null;unique\"`\n    AccessLevel   int    `sql:\"not null;default:0\"`\n    MainThreads   []ForumMainThreads\n}\n\n// ForumMainThreads is the table in the database\ntype ForumMainThreads struct {\n    gorm.Model\n    ForumContainerID int    `sql:\"index\"`\n    ThreadName       string `sql:\"not null;unique\"`\n    Threads          int    `sql:\"not null;default:0\"`\n    Replies          int    `sql:\"not null;default:0\"`\n    AccessLevel      int    `sql:\"not null;default:0\"`\n    Posts            []ForumMainThreadsPosts\n}\n\n// ForumMainThreadsPosts is a table in the database\ntype ForumMainThreadsPosts struct {\n    gorm.Model\n    UserID             int    `sql:\"index\"`\n    ForumMainThreadsID int    `sql:\"index\"`\n    Title              string `sql:\"not null;unique\"`\n    Body               string `sql:\"type:text;not null\"`\n    Sticky             bool   `sql:\"not null;default:0\"`\n    Views              int    `sql:\"not null;default:0\"`\n    ReplyCount         int    `sql:\"not null;default:0\"`\n    Replies            []ForumMainPostsReplies\n}\n\n// ForumMainPostsReplies is a table in the database\ntype ForumMainPostsReplies struct {\n    gorm.Model\n    ForumMainThreadsPostsID int `sql:\"index\"`\n    UserID                  int `sql:\"index\"`\n    Body                    string\n}\n</code></pre>\n\n<p>Querying is accomplished by:</p>\n\n<p><code>db.Preload(\"MainThreads\").Find(&amp;forumContainers)</code></p>\n"}, {"tags": ["go", "types", "interface", "equality"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 4, "creation_date": 1449960922, "post_id": 34245932, "comment_id": 56233710, "body": "If the structs are <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">comparable</a>, then the code works as is."}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1449962647, "post_id": 34245932, "comment_id": 56234150, "body": "to expand on that a bit, quoting from @CodingPickle&#39;s linked doc: <code>Interface values are comparable. Two interface values are equal if they have identical dynamic types and equal dynamic values or if both have value nil.</code>"}], "answers": [{"tags": [], "owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "is_accepted": true, "score": 39, "last_activity_date": 1560948209, "last_edit_date": 1560948209, "creation_date": 1449962904, "answer_id": 34246225, "question_id": 34245932, "link": "https://stackoverflow.com/questions/34245932/checking-equality-of-interface/34246225#34246225", "title": "Checking equality of interface{}", "body": "<p>Thanks to @CodingPickle comment, I provide the following from the <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"noreferrer\">Go Programming Language Specification</a></p>\n\n<blockquote>\n  <p>The equality operators == and != apply to operands that are comparable.</p>\n</blockquote>\n\n<p>Regarding <code>interface{}</code>s and <code>structs</code>:</p>\n\n<ul>\n<li>Interface values are comparable. Two interface values are equal if they have identical dynamic types and equal dynamic values or if both have value nil.</li>\n<li>A value x of non-interface type X and a value t of interface type T are comparable when values of type X are comparable and X implements T. They are equal if t's dynamic type is identical to X and t's dynamic value is equal to x.</li>\n<li>Struct values are comparable if all their fields are comparable. Two struct values are equal if their corresponding non-blank fields are equal.</li>\n</ul>\n\n<p>You can also try this playground <a href=\"https://play.golang.org/p/bgO1_V87v9k\" rel=\"noreferrer\">https://play.golang.org/p/bgO1_V87v9k</a></p>\n\n<p>In other words, handling equality seems easy in Go! </p>\n"}, {"tags": [], "owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "is_accepted": false, "score": 3, "last_activity_date": 1566376693, "creation_date": 1566376693, "answer_id": 57587604, "question_id": 34245932, "link": "https://stackoverflow.com/questions/34245932/checking-equality-of-interface/57587604#57587604", "title": "Checking equality of interface{}", "body": "<p>Update: since the above question and answers were written the Go language has changed slightly.</p>\n\n<p>Previously if two interfaces are compared and either or both contained a non-comparable type then the run-time would panic. Now the runtime will only panic if they both contain the <em>same</em> non-comparable type. (If they contain different types then the result is now false even if either type is non-comparable.)</p>\n\n<p>What are non-comparable types?  Basically, they are slices, maps, functions and any struct or array type that uses them.</p>\n\n<p>AFAIK this was a silent change around Go 1.9 or 1.10.</p>\n"}, {"comments": [{"owner": {"reputation": 2292, "user_id": 767903, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/7ae9acb5bf16896b78a9708403da20ca?s=128&d=identicon&r=PG", "display_name": "Andrew W. Phillips", "link": "https://stackoverflow.com/users/767903/andrew-w-phillips"}, "edited": false, "score": 1, "creation_date": 1600827724, "post_id": 63948724, "comment_id": 113208342, "body": "The table is a good idea but it is slightly wrong for Interface type. (You should also explain what is meant by <code>depends</code> - it&#39;s only allowed if the contained type(s) are comparable.)  For Interface types the code will compile but if at runtime the types contained are not comparable then the runtime will <i>panic</i>."}], "tags": [], "owner": {"reputation": 3367, "user_id": 5281824, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JEhRj.png?s=128&g=1", "display_name": "weaming", "link": "https://stackoverflow.com/users/5281824/weaming"}, "is_accepted": false, "score": 0, "last_activity_date": 1600923237, "last_edit_date": 1600923237, "creation_date": 1600397987, "answer_id": 63948724, "question_id": 34245932, "link": "https://stackoverflow.com/questions/34245932/checking-equality-of-interface/63948724#63948724", "title": "Checking equality of interface{}", "body": "<p>I have a summary of properties of Go types</p>\n<p><a href=\"https://i.stack.imgur.com/nBHAM.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nBHAM.png\" alt=\"properties of Go types\" /></a></p>\n<p>Explanation</p>\n<ul>\n<li><code>depends</code> - it's only allowed if the contained type(s) are comparable.) For <strong>Interface</strong> types the code will compile but if at runtime the types contained are not comparable then the runtime will panic. Thanks to @Andrew W. Phillips.</li>\n</ul>\n"}], "owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 23057, "favorite_count": 6, "accepted_answer_id": 34246225, "answer_count": 3, "score": 26, "last_activity_date": 1600923237, "creation_date": 1449960687, "last_edit_date": 1500839224, "question_id": 34245932, "link": "https://stackoverflow.com/questions/34245932/checking-equality-of-interface", "title": "Checking equality of interface{}", "body": "<p>I am searching a <code>[]interface{}</code> slice for a given <code>interface{}</code> value:</p>\n\n<pre><code>var v interface{}\nfor i := 0; i &lt; len(A); i++ {\n  if (A[i] == v) {\n    fmt.Println(\"Gotcha!\")\n    break\n  }\n}\n</code></pre>\n\n<p>In the trivial case the types are <code>int</code>. However what should I do if, for example, the types are some custom <code>struct</code>? </p>\n"}, {"tags": ["go", "xlib", "cgo"], "answers": [{"comments": [{"owner": {"reputation": 33, "user_id": 5625653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba07657871fbd62a08a154d0eeb3dd?s=128&d=identicon&r=PG&f=1", "display_name": "Ya H", "link": "https://stackoverflow.com/users/5625653/ya-h"}, "edited": false, "score": 0, "creation_date": 1449952244, "post_id": 34244362, "comment_id": 56231035, "body": "Thanks, useful, but:  <code>go run g2.go # command-line-arguments could not determine kind of name for C.event</code>"}, {"owner": {"reputation": 33, "user_id": 5625653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba07657871fbd62a08a154d0eeb3dd?s=128&d=identicon&r=PG&f=1", "display_name": "Ya H", "link": "https://stackoverflow.com/users/5625653/ya-h"}, "edited": false, "score": 0, "creation_date": 1449952512, "post_id": 34244362, "comment_id": 56231155, "body": "...so, here is a conflict: how to declare someting like this <code>C.event.xbutton.x</code> and use something like <code>C.event.xbutton.x</code>"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 33, "user_id": 5625653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba07657871fbd62a08a154d0eeb3dd?s=128&d=identicon&r=PG&f=1", "display_name": "Ya H", "link": "https://stackoverflow.com/users/5625653/ya-h"}, "edited": false, "score": 0, "creation_date": 1449964844, "post_id": 34244362, "comment_id": 56234693, "body": "in this case, it&#39;s event.xbutton.x, not C.event.xbutton.x   the C prefix is only used when declaring types or calling functions.  Since you have an event variable already, just access the fields directly"}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1449950623, "creation_date": 1449950623, "answer_id": 34244362, "question_id": 34243761, "link": "https://stackoverflow.com/questions/34243761/errors-while-using-go-with-cgo-and-xlib/34244362#34244362", "title": "Errors while using Go with cgo and Xlib", "body": "<p>For the error about \"type\", that is a reserved word in go so it is not directly accessible.</p>\n\n<p>According to <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">this posting</a> you should change your reference to:</p>\n\n<pre><code>switch C.event._type {\n</code></pre>\n\n<p>Also, else cannot be on a line on it's own.\nChange it to</p>\n\n<pre><code>if button == Button1 {\n    fmt.Printf(\"leftclick at %d %d \\n\", x, y)\n} else {\n    fmt.Printf(\"rightclick at %d %d \\n\", x, y)\n}\n</code></pre>\n\n<p>Switch statements don't fallthrough in go, so your break statements are unnecessary.</p>\n\n<p>Lastly, make sure to run go fmt on your code, you are using parens where they are not needed.</p>\n\n<p>Here's a formatted version with breaks removed that should work for you (I did not test this code):</p>\n\n<pre><code>package main\n\n// #cgo LDFLAGS: -lX11\n// #include &lt;X11/Xlib.h&gt;\n// #include &lt;X11/Xutil.h&gt;\nimport \"C\"\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var x = -1\n    var y = -1\n    var event C.XEvent\n    var button int\n    var display = C.XOpenDisplay(nil)\n    if display == nil {\n        panic(\"Cannot connect to X server!\\n\")\n    }\n\n    var root = C.XDefaultRootWindow(display)\n    C.XGrabPointer(display, root, C.False, C.ButtonPressMask, C.GrabModeAsync,\n        C.GrabModeAsync, C.None, C.None, C.CurrentTime)\n    for {\n        C.XSelectInput(display, root, C.ButtonReleaseMask)\n        for {\n            C.XNextEvent(display, &amp;event)\n            switch C.event._type {\n            case C.ButtonPress:\n                switch C.event.xbutton.button {\n                case C.Button1:\n                    x = C.event.xbutton.x\n                    y = C.event.xbutton.y\n                    button = C.Button1\n\n                case Button3:\n                    x = C.event.xbutton.x\n                    y = C.event.xbutton.y\n                    button = C.Button3\n                }\n            }\n            if x &gt;= 0 &amp;&amp; y &gt;= 0 {\n                break\n            }\n        }\n        if button == Button1 {\n            fmt.Printf(\"leftclick at %d %d \\n\", x, y)\n        } else {\n            fmt.Printf(\"rightclick at %d %d \\n\", x, y)\n        }\n    }\n    C.XCloseDisplay(display)\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 5625653, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a8ba07657871fbd62a08a154d0eeb3dd?s=128&d=identicon&r=PG&f=1", "display_name": "Ya H", "link": "https://stackoverflow.com/users/5625653/ya-h"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 165, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1449950623, "creation_date": 1449947122, "question_id": 34243761, "link": "https://stackoverflow.com/questions/34243761/errors-while-using-go-with-cgo-and-xlib", "title": "Errors while using Go with cgo and Xlib", "body": "<p>I trying to rewrite C-code to Go with help of cgo, but when trying to run the go-code it gives me some errors, which I don't know how to solve. The code allows to get coordinates of mouse clicks on a Linux-desktop.</p>\n\n<p>C code:</p>\n\n<pre><code>#include &lt;stdio.h&gt;\n#include &lt;stdlib.h&gt;\n#include &lt;X11/Xlib.h&gt;\n#include &lt;X11/Xutil.h&gt;\n\nint main () {\n    int x=-1, y=-1;\n    XEvent event;\n    int button;\n    Display *display = XOpenDisplay(NULL);\n    if (display == NULL) {\n    fprintf(stderr, \"Cannot connect to X server!\\n\");\n    exit (EXIT_FAILURE);\n    }\n    Window root= XDefaultRootWindow(display);\n    XGrabPointer(display, root, False, ButtonPressMask, GrabModeAsync,\n         GrabModeAsync, None, None, CurrentTime);\n    while(1){\n    XSelectInput(display, root, ButtonReleaseMask);\n    while(1) {\n      XNextEvent(display,&amp;event);\n      switch(event.type) {\n    case ButtonPress:\n        switch(event.xbutton.button) {\n          case Button1:\n          x=event.xbutton.x;\n          y=event.xbutton.y;\n          button=Button1;\n          break;\n\n          case Button3:\n          x=event.xbutton.x;\n          y=event.xbutton.y;\n          button=Button3;\n          break;\n          default:\n          break;\n\n        }\n        break;\n    default:\n        break;\n      }\n      if(x&gt;=0 &amp;&amp; y&gt;=0)break;\n    }\n\n    if(button==Button1)printf(\"leftclick at %d %d \\n\",x,y);\n    else printf(\"rightclick at %d %d \\n\",x,y);}\n    XCloseDisplay(display);\n    return 0;\n}\n</code></pre>\n\n<p>Go code:</p>\n\n<pre><code>package main\n\n// #cgo LDFLAGS: -lX11\n// #include &lt;X11/Xlib.h&gt;\n// #include &lt;X11/Xutil.h&gt;\nimport \"C\"\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    var x = -1\n    var y = -1\n    var event C.XEvent\n    var button int\n    var display = C.XOpenDisplay(nil)\n    if display == nil {\n        panic(\"Cannot connect to X server!\\n\")\n    }\n\n    var root = C.XDefaultRootWindow(display);\n    C.XGrabPointer(display, root, C.False, C.ButtonPressMask, C.GrabModeAsync, \n        C.GrabModeAsync, C.None, C.None, C.CurrentTime)\n    for {\n        C.XSelectInput(display, root, C.ButtonReleaseMask)\n        for {\n            C.XNextEvent(display, &amp;event)\n            switch(C.event.type) {\n                case C.ButtonPress:\n                    switch C.event.xbutton.button  {\n                        case C.Button1:\n                            x=C.event.xbutton.x\n                            y=C.event.xbutton.y\n                            button=C.Button1\n                            break\n\n                        case Button3:\n                            x=C.event.xbutton.x\n                            y=C.event.xbutton.y\n                            button=C.Button3\n                            break\n                            default:\n                                break\n\n                    }\n                    break\n                default:\n                    break\n            }\n            if(x&gt;=0 &amp;&amp; y&gt;=0) {\n                break\n            }\n        }\n        if(button==Button1) {\n            fmt.Printf(\"leftclick at %d %d \\n\",x,y)\n        }\n        else  {\n            fmt.Printf(\"rightclick at %d %d \\n\",x,y)\n        }\n    }\n    C.XCloseDisplay(display)\n}\n</code></pre>\n\n<p>Errors in Go code:</p>\n\n<pre><code>go run g.go\n# command-line-arguments\n./g.go:29:19: expected selector or type assertion, found 'type'\n./g.go:58:3: expected statement, found 'else'\n./g.go:63:3: expected '}', found 'EOF'\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1449946198, "post_id": 34243560, "comment_id": 56228922, "body": "What is the problem with using packageName.ErrorName, e.g. <code>models.EOK</code>? That name will be the same in all uses, everywhere in your program. Maybe put the errors in their own package called, maybe called err to make it shorter and easier to remember?"}, {"owner": {"reputation": 938, "user_id": 1772722, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/17346489240f67dafa4bad5967fa1aae?s=128&d=identicon&r=PG", "display_name": "lionelmessi", "link": "https://stackoverflow.com/users/1772722/lionelmessi"}, "reply_to_user": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "edited": false, "score": 0, "creation_date": 1449946346, "post_id": 34243560, "comment_id": 56228964, "body": "not a issue but it would save unnecessary bloating the code by having <code>models</code>, was wondering if this is possbile in Go or is there a general coding pattern followed to generate errors?"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 2, "creation_date": 1449947982, "post_id": 34243560, "comment_id": 56229534, "body": "As flexy answered you can &quot;dot&quot; import all exported names to your file.  But, it&#39;s not a great habit to get in to.  I appreciate the desire to reduce code bloat, but always remember to balance that with readability.  A naked &quot;EOK&quot; in the codebase may leave the next developer reading your code to wonder where it comes from, where &quot;models.EOK&quot; obviously comes from the models package."}, {"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "reply_to_user": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1449948462, "post_id": 34243560, "comment_id": 56229721, "body": "@DavidBudworth: correct."}, {"owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "edited": false, "score": 0, "creation_date": 1449948500, "post_id": 34243560, "comment_id": 56229729, "body": "@lionelmessi I&#39;ve added some reads for you to my answers, related to golang error handling style and package/code organisation"}, {"owner": {"reputation": 876, "user_id": 137196, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/244e6196a79d2f18d873577f0d6459f7?s=128&d=identicon&r=PG", "display_name": "Louie Miranda", "link": "https://stackoverflow.com/users/137196/louie-miranda"}, "edited": false, "score": 0, "creation_date": 1597396679, "post_id": 34243560, "comment_id": 112125123, "body": "good question. on the same task"}], "answers": [{"tags": [], "owner": {"reputation": 2104, "user_id": 1948449, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c676c54012cadb31459cc0ad8cd9a204?s=128&d=identicon&r=PG", "display_name": "tike", "link": "https://stackoverflow.com/users/1948449/tike"}, "is_accepted": true, "score": 10, "last_activity_date": 1539629217, "last_edit_date": 1539629217, "creation_date": 1449947433, "answer_id": 34243819, "question_id": 34243560, "link": "https://stackoverflow.com/questions/34243560/create-constants-visible-across-packages-accessible-directly/34243819#34243819", "title": "Create constants visible across packages, accessible directly", "body": "<h2>To answer you core question</h2>\n\n<p>You can use the <code>dot</code> import syntax to import the exported symbols from another package directly into your package's namespace (<a href=\"https://golang.org/ref/spec#Import_declarations\" rel=\"nofollow noreferrer\">godoc</a>):</p>\n\n<pre><code>import . \"models\"\n</code></pre>\n\n<p>This way you could directly refer to the <code>EOK</code> constant without prefixing it with <code>models</code>.</p>\n\n<p><strong>However I'd strongly advice against doing so, as it generates rather unreadable code.</strong> see below</p>\n\n<h2>General/style advice</h2>\n\n<ol>\n<li>Don't use unprefixed export path like <code>models</code>. This is considered bad style as it will easily globber. Even for small projects, that are used only internally, use something like <code>myname/models</code>. see <a href=\"https://blog.golang.org/organizing-go-code\" rel=\"nofollow noreferrer\">goblog</a></li>\n<li>Regarding your question about <em>error generation</em>, there are functions for generating <code>error</code> values, e.g. <code>errors.New</code> (<a href=\"https://golang.org/pkg/errors/#New\" rel=\"nofollow noreferrer\">godoc</a>) and <code>fmt.Errorf</code> (<a href=\"https://golang.org/pkg/fmt#Errorf\" rel=\"nofollow noreferrer\">godoc</a>).\nFor a general introduction on go and error handling see <a href=\"https://blog.golang.org/errors-are-values\" rel=\"nofollow noreferrer\">goblog</a></li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 938, "user_id": 1772722, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/17346489240f67dafa4bad5967fa1aae?s=128&d=identicon&r=PG", "display_name": "lionelmessi", "link": "https://stackoverflow.com/users/1772722/lionelmessi"}, "edited": false, "score": 0, "creation_date": 1449949824, "post_id": 34244067, "comment_id": 56230199, "body": "Looks like you caught me from where I am coming from :) I will explore more on this topic!"}], "tags": [], "owner": {"reputation": 3913, "user_id": 1274815, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cfa80d65597d3e43664c762cbb715e38?s=128&d=identicon&r=PG", "display_name": "gbulmer", "link": "https://stackoverflow.com/users/1274815/gbulmer"}, "is_accepted": false, "score": 1, "last_activity_date": 1449954101, "last_edit_date": 1449954101, "creation_date": 1449948782, "answer_id": 34244067, "question_id": 34243560, "link": "https://stackoverflow.com/questions/34243560/create-constants-visible-across-packages-accessible-directly/34244067#34244067", "title": "Create constants visible across packages, accessible directly", "body": "<p>W.r.t. the initial question, use a compact package name, for example err.</p>\n\n<p>Choosing an approach to propagating errors, and generating error messages depends on the scale and complexity of the application. The error style you show, using an int, and then a function to decode it, is quite C-ish. </p>\n\n<p>That style was partly caused by:</p>\n\n<ul>\n<li>the lack of multiple value returns (unlike Go),</li>\n<li>the need to use a simple type (to be easily propagated), and</li>\n<li>that gets translated to text with a function (unlike Go's error interface), so that the local language strings can be changed.</li>\n</ul>\n\n<p>For small apps with simple errors strings. I put the packages' error strings at the head of a package file, and just return them, maybe using errors.New(...), or fmt.Errorf if the string needs to be completed using some data.</p>\n\n<p>That 'int' style of error reporting doesn't offer something as flexible as Go's error interface. The error interface lets us build information-rich error structures, to return useful information, and not just an int value or string. </p>\n\n<p>An implication is <em>different packages</em> can yield <em>different real-types</em> which implement the Error interface. We don't need to agree a single error real-type across an entire set of packages. So error is an interface which can be easily propagated, like an int, yet, the real-type of error can be much richer than an int. Error generation (implementing Error) can be as centralised or distributed as we need, unlike strerror()-style functions which can be awkward to extend. </p>\n"}], "owner": {"reputation": 938, "user_id": 1772722, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/17346489240f67dafa4bad5967fa1aae?s=128&d=identicon&r=PG", "display_name": "lionelmessi", "link": "https://stackoverflow.com/users/1772722/lionelmessi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6502, "favorite_count": 0, "accepted_answer_id": 34243819, "answer_count": 2, "score": 4, "last_activity_date": 1539629217, "creation_date": 1449945874, "last_edit_date": 1449953175, "question_id": 34243560, "link": "https://stackoverflow.com/questions/34243560/create-constants-visible-across-packages-accessible-directly", "title": "Create constants visible across packages, accessible directly", "body": "<p>I would like to define my <code>Error Codes</code> in a package <code>models</code>.</p>\n\n<p><strong>error.go</strong></p>\n\n<pre><code>package models\n\nconst{\n  EOK = iota\n  EFAILED\n}\n</code></pre>\n\n<p>How can I use them in another package without referring to them as <code>models.EOK</code>. I would like to use directly as EOK, since these codes would be common across all packages.</p>\n\n<p>Is it the right way to do it? Any better alternatives?</p>\n"}, {"tags": ["math", "go"], "comments": [{"owner": {"reputation": 484, "user_id": 2620485, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MGptC.jpg?s=128&g=1", "display_name": "Willian", "link": "https://stackoverflow.com/users/2620485/willian"}, "edited": false, "score": 2, "creation_date": 1450066049, "post_id": 34242970, "comment_id": 56260679, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/588004/is-floating-point-math-broken\">Is floating point math broken?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 87, "user_id": 1017029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3252d93318776c1aca7ed605f8e8c542?s=128&d=identicon&r=PG", "display_name": "Tobias Artz", "link": "https://stackoverflow.com/users/1017029/tobias-artz"}, "is_accepted": false, "score": 0, "last_activity_date": 1449942272, "creation_date": 1449942272, "answer_id": 34242999, "question_id": 34242970, "link": "https://stackoverflow.com/questions/34242970/precision-in-golang/34242999#34242999", "title": "Precision in Golang", "body": "<p>Turns out this inherit with floats. Read more here:\n<a href=\"http://floating-point-gui.de/\" rel=\"nofollow\">http://floating-point-gui.de/</a></p>\n"}], "owner": {"reputation": 87, "user_id": 1017029, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3252d93318776c1aca7ed605f8e8c542?s=128&d=identicon&r=PG", "display_name": "Tobias Artz", "link": "https://stackoverflow.com/users/1017029/tobias-artz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 99, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1449942272, "creation_date": 1449942102, "question_id": 34242970, "link": "https://stackoverflow.com/questions/34242970/precision-in-golang", "title": "Precision in Golang", "body": "<p>I'm trying to do the following calculation:\n28860.000000001 - 28800 = 60.000000001</p>\n\n<p>However Go gives me 60.000000001000444</p>\n\n<pre><code>a := float64(28860.000000001)\nb := float64(28800)\nexpected := float64(60.000000001)\nanswer := a - b\n</code></pre>\n\n<p>What am I doing wrong here?</p>\n"}, {"tags": ["json", "dictionary", "go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5237024, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lnq7jBK21ho/AAAAAAAAAAI/AAAAAAAAAs0/e03ID_-lT1s/photo.jpg?sz=128", "display_name": "Gilmar Palega", "link": "https://stackoverflow.com/users/5237024/gilmar-palega"}, "edited": false, "score": 0, "creation_date": 1449937912, "post_id": 34242199, "comment_id": 56226182, "body": "thank you so much, worked like a charm. I tried this approach, making a temp map, but I was creating outside the loop, giving the same results."}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "reply_to_user": {"reputation": 73, "user_id": 5237024, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lnq7jBK21ho/AAAAAAAAAAI/AAAAAAAAAs0/e03ID_-lT1s/photo.jpg?sz=128", "display_name": "Gilmar Palega", "link": "https://stackoverflow.com/users/5237024/gilmar-palega"}, "edited": false, "score": 0, "creation_date": 1449941968, "post_id": 34242199, "comment_id": 56227549, "body": "@GilmarPalega: No problem. Remember to <a href=\"http://stackoverflow.com/help/someone-answers\">accept answers that solve your problem</a>."}], "tags": [], "owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "is_accepted": true, "score": 3, "last_activity_date": 1449937721, "creation_date": 1449937721, "answer_id": 34242199, "question_id": 34242185, "link": "https://stackoverflow.com/questions/34242185/produce-a-dictionary-map-from-a-map-in-golang/34242199#34242199", "title": "Produce a dictionary map from a map in golang", "body": "<p>A new <code>temp</code> map needs to be created on each iteration of the loop. Otherwise, you are just overwriting the same map:</p>\n\n<pre><code>for key, value := range res {\n    temp := make(map[string]interface{})\n    // ...\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/v-RaL2fswp\" rel=\"nofollow\">https://play.golang.org/p/v-RaL2fswp</a></p>\n"}], "owner": {"reputation": 73, "user_id": 5237024, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-Lnq7jBK21ho/AAAAAAAAAAI/AAAAAAAAAs0/e03ID_-lT1s/photo.jpg?sz=128", "display_name": "Gilmar Palega", "link": "https://stackoverflow.com/users/5237024/gilmar-palega"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 0, "accepted_answer_id": 34242199, "answer_count": 1, "score": 1, "last_activity_date": 1449937721, "creation_date": 1449937628, "question_id": 34242185, "link": "https://stackoverflow.com/questions/34242185/produce-a-dictionary-map-from-a-map-in-golang", "title": "Produce a dictionary map from a map in golang", "body": "<p>This is the code that I am trying to make run on playground: <a href=\"http://play.golang.org/p/zX1G50txzf\" rel=\"nofollow\">http://play.golang.org/p/zX1G50txzf</a></p>\n\n<p>I have this map:</p>\n\n<pre><code>map[producer:Tesla model:Model S year:2015]\n</code></pre>\n\n<p>and I want turn this into this :</p>\n\n<pre><code>[map[field:producer value:Tesla] map[field:model value:S] map[field:year value:2015]]\n</code></pre>\n\n<p>but in the end I will get this:</p>\n\n<pre><code>[map[field:year value:2015] map[field:year value:2015] map[field:year value:2015]]\n</code></pre>\n\n<p>Looks like every time the loop iterate over the original map, I am copying the reference instead of the value, so I end up with the last value replicated 3 times, instead of one of each.</p>\n\n<p>What am I missing here?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["heroku", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449932150, "post_id": 34239521, "comment_id": 56224241, "body": "The README shows that your Procfile should have <code>program: &#47;bin&#47;&lt;name&gt;</code> rather than <code>web: ...</code> - have you tried that?"}], "answers": [{"tags": [], "owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "is_accepted": true, "score": 0, "last_activity_date": 1449932301, "creation_date": 1449932301, "answer_id": 34241235, "question_id": 34239521, "link": "https://stackoverflow.com/questions/34239521/heroku-run-binary-version-of-webgolang/34241235#34241235", "title": "Heroku run binary version of web(golang)", "body": "<p>Was caused by a heroku issue, resolved now\n<a href=\"https://status.heroku.com/\" rel=\"nofollow\">https://status.heroku.com/</a></p>\n"}], "owner": {"reputation": 1012, "user_id": 1812225, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f4353e2db7dca0676814e41a0582980?s=128&d=identicon&r=PG", "display_name": "let4be", "link": "https://stackoverflow.com/users/1812225/let4be"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "accepted_answer_id": 34241235, "answer_count": 1, "score": 0, "last_activity_date": 1449932301, "creation_date": 1449921164, "question_id": 34239521, "link": "https://stackoverflow.com/questions/34239521/heroku-run-binary-version-of-webgolang", "title": "Heroku run binary version of web(golang)", "body": "<p>I'm trying to use <a href=\"https://github.com/ryandotsmith/null-buildpack\" rel=\"nofollow\">https://github.com/ryandotsmith/null-buildpack</a>\nand have compiled <code>web</code> process version(linux x64)\nbut when i'm <code>doing git push heroku master</code> process hangs on</p>\n\n<p><code>remote: Compressing source files... done.\nremote: Building source:\nremote:\nremote: Build stream timed out, reverting to polling...............</code></p>\n\n<p>Procfile:</p>\n\n<p><code>web: /app/bin/www</code></p>\n"}, {"tags": ["file", "google-app-engine", "post", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1449922970, "post_id": 34239284, "comment_id": 56221680, "body": "Please show us your HTML <code>&lt;form&gt;</code>."}, {"owner": {"reputation": 721, "user_id": 856844, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1a73fe1b931421469fe5612fd6e9a38a?s=128&d=identicon&r=PG", "display_name": "P&#230;tur Magnussen", "link": "https://stackoverflow.com/users/856844/p%c3%a6tur-magnussen"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1449925491, "post_id": 34239284, "comment_id": 56222342, "body": "Added the HTML &lt;form&gt;"}, {"owner": {"reputation": 721, "user_id": 856844, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1a73fe1b931421469fe5612fd6e9a38a?s=128&d=identicon&r=PG", "display_name": "P&#230;tur Magnussen", "link": "https://stackoverflow.com/users/856844/p%c3%a6tur-magnussen"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1449925782, "post_id": 34239284, "comment_id": 56222416, "body": "And by the way, the image is saved successfully in the Blobstore."}, {"owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "edited": false, "score": 1, "creation_date": 1450007127, "post_id": 34239284, "comment_id": 56242997, "body": "@P&#230;turMagnussen  did you saw this question <a href=\"http://stackoverflow.com/a/14937952/817571\">stackoverflow.com/a/14937952/817571</a>"}, {"owner": {"reputation": 721, "user_id": 856844, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1a73fe1b931421469fe5612fd6e9a38a?s=128&d=identicon&r=PG", "display_name": "P&#230;tur Magnussen", "link": "https://stackoverflow.com/users/856844/p%c3%a6tur-magnussen"}, "edited": false, "score": 0, "creation_date": 1450018219, "post_id": 34239284, "comment_id": 56246295, "body": "Perfect! That solved my problem. Thanks a lot, @MlkCode"}], "owner": {"reputation": 721, "user_id": 856844, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/1a73fe1b931421469fe5612fd6e9a38a?s=128&d=identicon&r=PG", "display_name": "P&#230;tur Magnussen", "link": "https://stackoverflow.com/users/856844/p%c3%a6tur-magnussen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 456, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449925477, "creation_date": 1449919704, "last_edit_date": 1449925477, "question_id": 34239284, "link": "https://stackoverflow.com/questions/34239284/handle-image-and-text-upload-in-go-in-google-app-engine", "title": "Handle image and text upload in Go in Google App Engine", "body": "<p>I'm following this guide on how to handle file upload in Go: <a href=\"https://cloud.google.com/appengine/docs/go/blobstore/\" rel=\"nofollow\">https://cloud.google.com/appengine/docs/go/blobstore/</a></p>\n\n<p>Scroll down to 'Complete Sample Application' to see the whole code.</p>\n\n<p>I'm trying to handle a POST request with both an image file and some text, but I can't seem to get it working. I want to save the image in Blobstore and I want to save the text in my own struct as its own type called \"Item\".</p>\n\n<p>Here's my code:</p>\n\n<pre><code>func handleUpload(w http.ResponseWriter, r *http.Request) {\n  ctx := appengine.NewContext(r)\n  blobs, _, err := blobstore.ParseUpload(r)\n  if err != nil {\n    serveError(ctx, w, err)\n    return\n  }\n  file := blobs[\"file\"]\n  if len(file) == 0 {\n    log.Errorf(ctx, \"no file uploaded\")\n    http.Redirect(w, r, \"/\", http.StatusFound)\n    return\n  }\n\n  var n string = r.FormValue(\"name\")\n  lat, errLat := strconv.ParseFloat(r.FormValue(\"latitude\"), 64)\n  long, errLong := strconv.ParseFloat(r.FormValue(\"longitude\"), 64)\n\n  if errLat != nil {\n    http.Error(w, \"Invalid latitude format: \" + errLat.Error(), http.StatusInternalServerError)\n  }\n\n  if errLong != nil {\n    http.Error(w, \"Invalid longitude format: \" + errLong.Error(), http.StatusInternalServerError)\n  }\n\n  c := appengine.NewContext(r)\n  g := Item { Name: n, Date: time.Now(), Latitude: lat, Longitude: long, ImageKey: string(file[0].BlobKey)}\n  // We set the same parent key on every Greeting entity to ensure each Greeting\n  // is in the same entity group. Queries across the single entity group\n  // will be consistent. However, the write rate to a single entity group\n  // should be limited to ~1/second.\n  key := datastore.NewIncompleteKey(c, \"Item\", itemKey(c))\n  _, err = datastore.Put(c, key, &amp;g)\n  if err != nil {\n    http.Error(w, err.Error(), http.StatusInternalServerError)\n    return\n  }\n\n  http.Redirect(w, r, \"/serve/?blobKey=\"+string(file[0].BlobKey), http.StatusFound)\n}\n</code></pre>\n\n<p>When I get down to retrieve the text from the post in</p>\n\n<pre><code>var n string = r.FormValue(\"name\")\n</code></pre>\n\n<p>The text is empty because it has already been used in the request to save the image. I know that a request can only be \"used\" once.</p>\n\n<p>My question is: Am I approaching this the wrong way? How would you grab both text and image out of a POST request in Go?</p>\n\n<p>Here's the HTML form:</p>\n\n<pre><code>&lt;html&gt;\n    &lt;body&gt;\n       &lt;form action=\"{{.}}\" method=\"POST\" enctype=\"multipart/form-data\"&gt;\n            Name: &lt;br&gt;\n            &lt;div&gt;&lt;textarea name=\"name\" rows=\"1\" cols=\"60\"&gt;&lt;/textarea&gt;&lt;/div&gt;\n            Latitude: &lt;br&gt;\n            &lt;div&gt;&lt;textarea name=\"latitude\" rows=\"1\" cols=\"60\"&gt;&lt;/textarea&gt;&lt;/div&gt;\n            longitude: &lt;br&gt;\n            &lt;div&gt;&lt;textarea name=\"longitude\" rows=\"1\" cols=\"60\"&gt;&lt;/textarea&gt;&lt;/div&gt;\n            Upload File: &lt;input type=\"file\" name=\"file\"&gt;&lt;br&gt;\n            &lt;input type=\"submit\" name=\"submit\" value=\"Submit\"&gt;\n        &lt;/form&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["go", "constants"], "answers": [{"tags": [], "owner": {"reputation": 12672, "user_id": 1200821, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Cm117.jpg?s=128&g=1", "display_name": "Juan Diego Godoy Robles", "link": "https://stackoverflow.com/users/1200821/juan-diego-godoy-robles"}, "is_accepted": true, "score": 6, "last_activity_date": 1452365180, "last_edit_date": 1452365180, "creation_date": 1449918204, "answer_id": 34239081, "question_id": 34239045, "link": "https://stackoverflow.com/questions/34239045/is-constant-value-evaluated-at-compile-time-in-go/34239081#34239081", "title": "Is constant value evaluated at compile time in Go?", "body": "<p><em>Yes</em></p>\n\n<blockquote>\n  <p><strong>Constant expressions</strong> may contain only constant operands and <strong>are\n  evaluated at compile time</strong>.</p>\n</blockquote>\n\n<p>Check <a href=\"https://golang.org/ref/spec#Constant_expressions\" rel=\"nofollow noreferrer\">constant expressions</a>.</p>\n"}], "owner": {"reputation": 68230, "user_id": 1426056, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/3ac815b6fca201737db888a28efd7248?s=128&d=identicon&r=PG", "display_name": "waitingkuo", "link": "https://stackoverflow.com/users/1426056/waitingkuo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 348, "favorite_count": 0, "accepted_answer_id": 34239081, "answer_count": 1, "score": 2, "last_activity_date": 1452365180, "creation_date": 1449917956, "last_edit_date": 1449921106, "question_id": 34239045, "link": "https://stackoverflow.com/questions/34239045/is-constant-value-evaluated-at-compile-time-in-go", "title": "Is constant value evaluated at compile time in Go?", "body": "<p>If I have something like:</p>\n\n<pre><code>const a = 1 + 1\n</code></pre>\n\n<p>Is <code>1 + 1</code> added during the compiling time?</p>\n"}, {"tags": ["windows", "go"], "answers": [{"comments": [{"owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "edited": false, "score": 0, "creation_date": 1450114010, "post_id": 34236444, "comment_id": 56287800, "body": "Ah...that&#39;s what I was missing. Thanks!"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 4, "last_activity_date": 1449896307, "creation_date": 1449896307, "answer_id": 34236444, "question_id": 34236162, "link": "https://stackoverflow.com/questions/34236162/go-install-not-working-on-window/34236444#34236444", "title": "Go install not working on Window?", "body": "<blockquote>\n  <p>Windows can't find the executables</p>\n</blockquote>\n\n<p>If you mean the executable built from your go programs (by <code>go install</code>) and delivered by Go in <code>%GOPATH%\\bin</code>, all you need is to add to your <code>PATH</code> environment variable <code>%GOPATH%\\bin</code> (in addition of <code>%GOROOT%\\bin</code>)</p>\n\n<pre><code>set PATH=%PATH%;%GOPATH%\\bin\ncd %GOPATH%\\src\\path\\to\\a\\go\\project\ngo install\n</code></pre>\n\n<p>Then you can call your executable, and Windows will find it in <code>%GOPATH%\\bin</code> (the <code>C:\\Users\\{user}\\Development\\go\\bin</code> folder)</p>\n"}], "owner": {"reputation": 1256, "user_id": 4949938, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/7586b74526dc4ef59eb6f8b6d4cb6a94?s=128&d=identicon&r=PG", "display_name": "mxplusb", "link": "https://stackoverflow.com/users/4949938/mxplusb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1671, "favorite_count": 2, "accepted_answer_id": 34236444, "answer_count": 1, "score": 3, "last_activity_date": 1449896307, "creation_date": 1449893435, "question_id": 34236162, "link": "https://stackoverflow.com/questions/34236162/go-install-not-working-on-window", "title": "Go install not working on Window?", "body": "<p>I just installed Golang on my Windows box today, and I have my <code>%GOPATH%</code> set. However, when I run <code>go install {...}</code> for various binaries, Windows can't find the executables. My <code>%GOROOT%</code> is <code>C:\\Go</code>, the default .msi install location.</p>\n\n<pre><code>PS C:\\Users\\{user}\\Development\\go&gt; ls\n    Directory: C:\\Users\\{user}\\Development\\go\n\n\nMode                LastWriteTime     Length Name\n----                -------------     ------ ----\nd----        12/11/2015   9:02 PM            bin\nd----        12/11/2015  11:08 AM            pkg\nd----        12/11/2015  11:08 AM            src\nC:\\Users\\{user}\\Development\\go&gt;echo %GOPATH%\nC:\\Users\\{user}\\Development\\go\n</code></pre>\n\n<p>Do I have the environmental variables set incorrectly?</p>\n"}, {"tags": ["go", "sqlite"], "answers": [{"comments": [{"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1450168332, "post_id": 34236242, "comment_id": 56310097, "body": "Is there any documentation on this? I looked as hard as I could on the official repo with no luck."}, {"owner": {"reputation": 3262, "user_id": 5273921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvzQp.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5273921/mike"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1450213156, "post_id": 34236242, "comment_id": 56340355, "body": "Unfortunately, I couldn&#39;t find much on their repo with respect to documentation. There are a couple of examples though in their repo:  <a href=\"https://github.com/mattn/go-sqlite3/blob/master/_example/simple/simple.go\" rel=\"nofollow noreferrer\">github.com/mattn/go-sqlite3/blob/master/_example/simple/&hellip;</a>   The queries themselves are derived from this library:  <a href=\"https://golang.org/pkg/database/sql/#DB.Query\" rel=\"nofollow noreferrer\">golang.org/pkg/database/sql/#DB.Query</a>  In your case, you&#39;ll likely need to pay particular attention to the &#39;Row&#39;, &#39;Stmt&#39; and &#39;Db&#39; sections."}], "tags": [], "owner": {"reputation": 3262, "user_id": 5273921, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/kvzQp.jpg?s=128&g=1", "display_name": "Mike", "link": "https://stackoverflow.com/users/5273921/mike"}, "is_accepted": true, "score": 2, "last_activity_date": 1449894773, "last_edit_date": 1449894773, "creation_date": 1449894425, "answer_id": 34236242, "question_id": 34236038, "link": "https://stackoverflow.com/questions/34236038/how-to-get-the-count-value-from-a-go-sqlite3-query/34236242#34236242", "title": "How to get the count value from a go-sqlite3 query?", "body": "<p>This should work:</p>\n\n<pre><code>// Output will be stored here.\nvar output string\n\nid := \"1234\"\n\n // Prepare your query\nquery, err := db.Prepare(\"select count(notebook) from pages where notebook = ?\")\n\nif err != nil {\n    fmt.Printf(\"%s\", err)\n}\n\ndefer query.Close()\n\n// Execute query using 'id' and place value into 'output'\nerr = query.QueryRow(id).Scan(&amp;output)\n\n// Catch errors\nswitch {\ncase err == sql.ErrNoRows:\n        fmt.Printf(\"No notebook with that ID.\")\ncase err != nil:\n        fmt.Printf(\"%s\", err)\ndefault:\n        fmt.Printf(\"Counted %s notebooks\\n\", output)\n}\n</code></pre>\n"}], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1452, "favorite_count": 0, "accepted_answer_id": 34236242, "answer_count": 1, "score": 2, "last_activity_date": 1449894773, "creation_date": 1449892176, "question_id": 34236038, "link": "https://stackoverflow.com/questions/34236038/how-to-get-the-count-value-from-a-go-sqlite3-query", "title": "How to get the count value from a go-sqlite3 query?", "body": "<p>I am using <a href=\"https://github.com/mattn/go-sqlite3\" rel=\"nofollow\">go-sqlite3</a> to retrieve the number of rows with a column of a certain value:</p>\n\n<pre><code>query := \"select count(notebook) from pages where notebook=\"\nresult, err := db.Query(fmt.Sprint(query, id))\n</code></pre>\n\n<p>Where <code>id</code> is passed to the function running the query.</p>\n\n<p>How can I retrieve the count value from <code>result</code>?</p>\n"}, {"tags": ["mysql", "go", "go-gorm"], "comments": [{"owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "edited": false, "score": 0, "creation_date": 1449875766, "post_id": 34234027, "comment_id": 56212085, "body": "typically the table names and columns would be wrapped in back-ticks or nothing. For instance, a back-tick would be spectacular if the column name was <code>limit</code> or <code>My Column</code> or <code>this-thing</code>"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1449876341, "post_id": 34234027, "comment_id": 56212272, "body": "Have you tried keeping the function call <code>GeomFromText</code> in the query and have your <code>Point</code> <code>Value</code> method return <code>p.ToWKT()</code>?"}, {"owner": {"reputation": 376, "user_id": 4981332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e1b1e4adb0a6d62718938f1ae9822?s=128&d=identicon&r=PG", "display_name": "devfubar", "link": "https://stackoverflow.com/users/4981332/devfubar"}, "edited": false, "score": 0, "creation_date": 1449881610, "post_id": 34234027, "comment_id": 56213600, "body": "Thanks for the replies.  I suppose I didn&#39;t make my difficulties clear. I have no problem with my schema and I know how to insert spatial data, it&#39;s more of a sql driver issue. I know that <code>db.Exec(&quot;INSERT INTO &#39;table&#39; (&#39;spot&#39;) VALUES (GeomFromText($1))&quot;, p.ToWKT())</code> will work however I am trying to avoid using raw sql queries usch as that. I know that the reason my code is failing is because <code>func (p Point) Value()</code> is returning a string and my MySQL function is being placed in quotes.  Is there a way of using this interface and have only part of the string placed in quotes?"}], "answers": [{"comments": [{"owner": {"reputation": 15271, "user_id": 133747, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/6703c5e8fecd2b0d0d3e137bcff7c61e?s=128&d=identicon&r=PG", "display_name": "huggie", "link": "https://stackoverflow.com/users/133747/huggie"}, "edited": false, "score": 0, "creation_date": 1583380701, "post_id": 34234432, "comment_id": 107098815, "body": "I am running into the same issue. Is this writing raw SQL query? I don&#39;t understand how you make it work."}], "tags": [], "owner": {"reputation": 24080, "user_id": 1816093, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/ZImpg.jpg?s=128&g=1", "display_name": "Drew", "link": "https://stackoverflow.com/users/1816093/drew"}, "is_accepted": false, "score": 1, "last_activity_date": 1449877708, "creation_date": 1449877708, "answer_id": 34234432, "question_id": 34234027, "link": "https://stackoverflow.com/questions/34234027/golang-mysql-driver-database-functions/34234432#34234432", "title": "golang - mysql driver - database functions", "body": "<p>Please see the two urls below where the concept was poached from</p>\n\n<h2>Schema</h2>\n\n<pre><code>-- http://howto-use-mysql-spatial-ext.blogspot.com/\n\ncreate table Points\n(   id int auto_increment primary key,\n    name VARCHAR(20) not null, \n    location Point NOT NULL, \n    description VARCHAR(200) not null, \n    SPATIAL INDEX(location),\n    key(name)\n)engine=MyISAM; -- for use of spatial indexes and avoiding error 1464\n\n-- insert a row, so we can prove Update later will work\nINSERT INTO Points (name, location, description) VALUES \n( 'point1' , GeomFromText( ' POINT(31.5 42.2) ' ) , 'some place');\n</code></pre>\n\n<h2>Update statement</h2>\n\n<pre><code>-- concept borrowed from http://stackoverflow.com/a/7135890\nUPDATE Points \nset location = PointFromText(CONCAT('POINT(',13.33,' ',26.48,')'))\nwhere id=1;\n</code></pre>\n\n<h2>Verify</h2>\n\n<pre><code>select * from points;\n</code></pre>\n\n<p>(when you open the Value Editor to see the blob, the point is updated)</p>\n\n<p>So, the takeaway is to play with the <code>concat()</code> inside of the update statement.</p>\n"}], "owner": {"reputation": 376, "user_id": 4981332, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/570e1b1e4adb0a6d62718938f1ae9822?s=128&d=identicon&r=PG", "display_name": "devfubar", "link": "https://stackoverflow.com/users/4981332/devfubar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1394, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1449958874, "creation_date": 1449875211, "last_edit_date": 1592644375, "question_id": 34234027, "link": "https://stackoverflow.com/questions/34234027/golang-mysql-driver-database-functions", "title": "golang - mysql driver - database functions", "body": "<p>I have created a struct to store spatial types and I have created a scan function to help query rows in my database.  I am having issues inserting this type.</p>\n<p>I can insert data using the following sql;</p>\n<pre><code>INSERT INTO 'table' ('spot') VALUES (GeomFromText('POINT(10 10)'));\n</code></pre>\n<p>If I use Value interface in <em>database/sql/driver</em>;</p>\n<blockquote>\n<p>type Value interface{}</p>\n<p>Value is a value that drivers must be able to handle. It is either nil or an instance of one of these types:</p>\n<p>int64</p>\n<p>float64</p>\n<p>bool</p>\n<p>[]byte</p>\n<p>string   [*] everywhere except from Rows.Next.</p>\n<p>time.Time</p>\n</blockquote>\n<p>And use this code;</p>\n<pre><code>func (p Point) Value() (driver.Value, error) {\n    return &quot;GeomFromText('&quot; + p.ToWKT() + &quot;')&quot;, nil\n}\n</code></pre>\n<p>I end up with the following sql statement going to the database;</p>\n<pre><code>INSERT INTO 'table' ('spot') VALUES ('GeomFromText('POINT(10 10)')');\n</code></pre>\n<p>The issue being that the function <em>GeomFromText</em> is in quotes.  Is there a way to avoid this scenario? I am using gorm and trying to keep raw sql queries to a minimum.</p>\n<p>The mysql type being used on the database end is a <em>point</em>.</p>\n"}, {"tags": ["html", "go", "sublimetext3", "syntax-highlighting", "hugo"], "answers": [{"tags": [], "owner": {"reputation": 5024, "user_id": 1419891, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/bb825cd3f1905f42c16408393480a65b?s=128&d=identicon&r=PG", "display_name": "425nesp", "link": "https://stackoverflow.com/users/1419891/425nesp"}, "is_accepted": true, "score": 2, "last_activity_date": 1449907527, "creation_date": 1449907527, "answer_id": 34237684, "question_id": 34233453, "link": "https://stackoverflow.com/questions/34233453/how-do-i-tell-sublime-text-to-highlight-the-go-code-inside-my-html/34237684#34237684", "title": "How do I tell Sublime Text to highlight the Go code inside my HTML?", "body": "<p>The default highlighting packages will not correctly highlight your templates. You'll need to <a href=\"https://packagecontrol.io/installation\" rel=\"nofollow\">install Package Control</a> and then install <a href=\"https://packagecontrol.io/packages/GoSublime\" rel=\"nofollow\">GoSublime</a>.</p>\n\n<p>Once you've done that, open your template file. Then click View > Syntax > GoSublime > GoSublime: HTML.</p>\n\n<p>You should now have <code>{{define \"foo\"}}{{end}}</code> highlighted as Go and <code>&lt;p&gt;foo&lt;/p&gt;</code> highlighted as HTML.</p>\n"}], "owner": {"reputation": 5421, "user_id": 1457116, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/bf6b07afba82aeccdfd9ae734aa9789a?s=128&d=identicon&r=PG", "display_name": "ele", "link": "https://stackoverflow.com/users/1457116/ele"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 34237684, "answer_count": 1, "score": 2, "last_activity_date": 1449910900, "creation_date": 1449872223, "last_edit_date": 1449910900, "question_id": 34233453, "link": "https://stackoverflow.com/questions/34233453/how-do-i-tell-sublime-text-to-highlight-the-go-code-inside-my-html", "title": "How do I tell Sublime Text to highlight the Go code inside my HTML?", "body": "<p>Sublime Text can highlight HTML. It can highlight Go. I would like to tell Sublime Text 3 to highlight the Go code in between the <code>{{</code> and <code>}}</code> markers in my HTML to highlight in Go rather than as plain text.</p>\n\n<p>There must be some way to combine the two. I thought surely one of the golang packages on Package Control would address this but I haven't found one that offers an <em>HTML (Go)</em> syntax like GitHub's Atom editor does by default.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 3971427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4638fe150483fddfe5ad6bed1c4f2f9a?s=128&d=identicon&r=PG&f=1", "display_name": "jzapata", "link": "https://stackoverflow.com/users/3971427/jzapata"}, "edited": false, "score": 0, "creation_date": 1449937291, "post_id": 34233149, "comment_id": 56225967, "body": "Thanks, but I am also hoping to understand why a library might do this. I am relatively new to Go and perhaps this is fairly common."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1079, "user_id": 3971427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4638fe150483fddfe5ad6bed1c4f2f9a?s=128&d=identicon&r=PG&f=1", "display_name": "jzapata", "link": "https://stackoverflow.com/users/3971427/jzapata"}, "edited": false, "score": 0, "creation_date": 1449972976, "post_id": 34233149, "comment_id": 56236368, "body": "@jzapata: The reason is history: Gustavo made mgo and used hosted the project on his labix.org site. He later created the gopkg.in service (which anyone can use), and started using that for versioning the driver. The latter url is not enforced as the canonical import in the code, so either could be used, and they both point to the actual git repo at <a href=\"https://github.com/go-mgo/mgo/tree/v2\" rel=\"nofollow noreferrer\">github.com/go-mgo/mgo/tree/v2</a>."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 0, "last_activity_date": 1449870813, "creation_date": 1449870813, "answer_id": 34233149, "question_id": 34233073, "link": "https://stackoverflow.com/questions/34233073/which-of-these-two-import-statements-for-the-mongodb-golang-mgo-driver-is-correc/34233149#34233149", "title": "Which of these two import statements for the MongoDB/golang mgo driver is correct?", "body": "<p>They are the same package, and there is no canonical import enforced for mgo.</p>\n\n<p>Use the \"gopkg.in/mgo.v2\", if only because that's what the documentation states. </p>\n"}], "owner": {"reputation": 1079, "user_id": 3971427, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4638fe150483fddfe5ad6bed1c4f2f9a?s=128&d=identicon&r=PG&f=1", "display_name": "jzapata", "link": "https://stackoverflow.com/users/3971427/jzapata"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 0, "accepted_answer_id": 34233149, "answer_count": 1, "score": 1, "last_activity_date": 1449870813, "creation_date": 1449870451, "question_id": 34233073, "link": "https://stackoverflow.com/questions/34233073/which-of-these-two-import-statements-for-the-mongodb-golang-mgo-driver-is-correc", "title": "Which of these two import statements for the MongoDB/golang mgo driver is correct?", "body": "<p>Could someone shed some light on the difference between these two import statements for the same mgo (MongoDB/golang) library:</p>\n\n<pre><code>gopkg.in/mgo.v2\nlabix.org/v2/mgo\n</code></pre>\n\n<p>I know you have to pick one or the other, but they both seem to work the same for me. Why are there two and which one should I be using?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1449866256, "post_id": 34232126, "comment_id": 56208056, "body": "Just because it&#39;s not specified, doesn&#39;t mean the current implementation doesn&#39;t pick a single way to evaluate the order."}, {"owner": {"reputation": 3263, "user_id": 3525315, "user_type": "registered", "profile_image": "https://graph.facebook.com/628622722/picture?type=large", "display_name": "Mikel Bitson", "link": "https://stackoverflow.com/users/3525315/mikel-bitson"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1449866381, "post_id": 34232126, "comment_id": 56208112, "body": "@JimB I think the question is why does the function, which is added to the slice second, get evaluated before the first value is added to the slice, when the first value is entered into the array first? It really has nothing to do with the specifications on the golang site- it has to do with how the code operates. EDIT: Though I could be completely misunderstanding- but I&#39;d like to know :\\"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1449866469, "post_id": 34232126, "comment_id": 56208162, "body": "As JimB points out, the spec is telling you what the language guarantees you. It&#39;s common to see things like this. In reality, the result is usually consistent as long as there is no implementation change (like in a new language version). That being said, there is a reason the spec says what it does and I recommend taking it at face value."}, {"owner": {"reputation": 125, "user_id": 5416504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2Fj4.jpg?s=128&g=1", "display_name": "pellucid", "link": "https://stackoverflow.com/users/5416504/pellucid"}, "edited": false, "score": 0, "creation_date": 1449866734, "post_id": 34232126, "comment_id": 56208307, "body": "I think it&#39;s vague to say &quot;is not specified&quot; in the document. Because it doesn&#39;t clarify WHEN the value of x is [1,2] or [2,2]. Maybe I run it for 1million times and got one for [1,2] or maybe I run the code in a different architect platform for a different result."}, {"owner": {"reputation": 3263, "user_id": 3525315, "user_type": "registered", "profile_image": "https://graph.facebook.com/628622722/picture?type=large", "display_name": "Mikel Bitson", "link": "https://stackoverflow.com/users/3525315/mikel-bitson"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1449866744, "post_id": 34232126, "comment_id": 56208315, "body": "@evanmcdonnal Thank you for explaining. :) So it could go in either order- best to test it each time you implement something like this then?"}, {"owner": {"reputation": 125, "user_id": 5416504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2Fj4.jpg?s=128&g=1", "display_name": "pellucid", "link": "https://stackoverflow.com/users/5416504/pellucid"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1449866836, "post_id": 34232126, "comment_id": 56208355, "body": "@evanmcdonnal  It sounds reasonable. Thank you."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 3263, "user_id": 3525315, "user_type": "registered", "profile_image": "https://graph.facebook.com/628622722/picture?type=large", "display_name": "Mikel Bitson", "link": "https://stackoverflow.com/users/3525315/mikel-bitson"}, "edited": false, "score": 2, "creation_date": 1449866920, "post_id": 34232126, "comment_id": 56208394, "body": "@MikelBitson: no, you don&#39;t test it at all. You simply don&#39;t write code that depends on unspecified behavior."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 3263, "user_id": 3525315, "user_type": "registered", "profile_image": "https://graph.facebook.com/628622722/picture?type=large", "display_name": "Mikel Bitson", "link": "https://stackoverflow.com/users/3525315/mikel-bitson"}, "edited": false, "score": 0, "creation_date": 1449866937, "post_id": 34232126, "comment_id": 56208404, "body": "@MikelBitson no, my point is I would not write any code that depends on a particular observed ordering because Google could go and change the code behind that since they haven&#39;t specified an order. If they knew that it would not change, then it probably would have been specified."}], "answers": [{"comments": [{"owner": {"reputation": 125, "user_id": 5416504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2Fj4.jpg?s=128&g=1", "display_name": "pellucid", "link": "https://stackoverflow.com/users/5416504/pellucid"}, "edited": false, "score": 0, "creation_date": 1449867166, "post_id": 34232264, "comment_id": 56208517, "body": "Then, since the compiler for Golang is most likely the official one, then for a certain Golang version and certain platform. The order of evaluation is always &quot;specified&quot;(a certain result)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 125, "user_id": 5416504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2Fj4.jpg?s=128&g=1", "display_name": "pellucid", "link": "https://stackoverflow.com/users/5416504/pellucid"}, "edited": false, "score": 2, "creation_date": 1449868052, "post_id": 34232264, "comment_id": 56208957, "body": "@pellucid: there are multiple go implementations (gc, gccgo). Go has an official specification, and there&#39;s simply no reason to ever rely on unspecified behavior."}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1449869018, "post_id": 34232264, "comment_id": 56209433, "body": "Even in C, &quot;undefined behavior&quot; does not guarantee a crash. And in C, order of evaluation of subexpressions is usually unspecified, not undefined, so the issue the OP is asking about in Go is equally applicable to C."}, {"owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "edited": false, "score": 0, "creation_date": 1449869512, "post_id": 34232264, "comment_id": 56209645, "body": "Yes, no crash guarantee, &#39;usually != always&#39;, but relying upon it is a sure way to possible unexpected behaviour in the future"}, {"owner": {"user_type": "does_not_exist", "display_name": "user774340"}, "reply_to_user": {"reputation": 125, "user_id": 5416504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2Fj4.jpg?s=128&g=1", "display_name": "pellucid", "link": "https://stackoverflow.com/users/5416504/pellucid"}, "edited": false, "score": 0, "creation_date": 1450195756, "post_id": 34232264, "comment_id": 56329435, "body": "@pellucid: No, if you add something else to your program, the compiler may optimise the program differently or build the program in a different order, and you can&#39;t be surprised if the order of function evaluation changes. Do not EVER depend on this order."}, {"owner": {"reputation": 5468, "user_id": 89233, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/a36afadc530a6936e9e336a729f7ecf3?s=128&d=identicon&r=PG", "display_name": "Jon Watte", "link": "https://stackoverflow.com/users/89233/jon-watte"}, "edited": false, "score": 0, "creation_date": 1581626597, "post_id": 34232264, "comment_id": 106509958, "body": "Call it &quot;implementation defined&quot; and you get close to the meaning they have here.&quot;  Also, C has two different kinds of behaviors: Undefined Behavior, Unspecified Behavior, and Implementation Defined behavior. They are different levels of &quot;bad.&quot;"}], "tags": [], "owner": {"reputation": 16587, "user_id": 177053, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f6c516626d381a1ea383cedd1799486?s=128&d=identicon&r=PG", "display_name": "Vasfed", "link": "https://stackoverflow.com/users/177053/vasfed"}, "is_accepted": true, "score": 4, "last_activity_date": 1449866730, "creation_date": 1449866730, "answer_id": 34232264, "question_id": 34232126, "link": "https://stackoverflow.com/questions/34232126/order-of-evaluation-in-a-slice-literal/34232264#34232264", "title": "Order of evaluation in a slice literal", "body": "<p>Order 'not specified' means that it's up to compiler to decide, and it is not guaranteed to be the same over different versions of a compiler/other compilers etc/other machine/other time of day etc.</p>\n\n<p>It does not mean that it has to be different each time or crash (as you may be accustomed to from C, where 'undefined behaviour' usually meant something bad, for example like using a pointer after freeing memory)</p>\n"}], "owner": {"reputation": 125, "user_id": 5416504, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/l2Fj4.jpg?s=128&g=1", "display_name": "pellucid", "link": "https://stackoverflow.com/users/5416504/pellucid"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1459, "favorite_count": 0, "accepted_answer_id": 34232264, "answer_count": 1, "score": 3, "last_activity_date": 1581628385, "creation_date": 1449866159, "last_edit_date": 1581628385, "question_id": 34232126, "link": "https://stackoverflow.com/questions/34232126/order-of-evaluation-in-a-slice-literal", "title": "Order of evaluation in a slice literal", "body": "<p>I recently went through Go's \"Language Specification\" <a href=\"https://golang.org/ref/spec#Order_of_evaluation\" rel=\"nofollow noreferrer\">https://golang.org/ref/spec#Order_of_evaluation</a> but found the order of evaluation being different from what it is explained in this document.</p>\n\n<p>For example, it says:</p>\n\n<pre><code>a := 1\nf := func() int { a++; return a }\nx := []int{a, f()}            // x may be [1, 2] or [2, 2]: evaluation order between a and f() is not specified\n</code></pre>\n\n<p>Then I tried with this code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    for {\n        result := evaluate()\n        if result == 1 { \n            break\n        }   \n    }   \n}\n\nfunc evaluate() int {\n    a := 1\n    f := func() int { a++; return a } \n    x := []int{a, f()}\n    fmt.Println(x)\n    return x[0]\n}\n</code></pre>\n\n<p>I found the value of slice x is always [2,2]. Is there anything I misunderstand?</p>\n"}, {"tags": ["go", "go-gin"], "comments": [{"owner": {"reputation": 146, "user_id": 7602866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sM8GA.jpg?s=128&g=1", "display_name": "R wang", "link": "https://stackoverflow.com/users/7602866/r-wang"}, "edited": false, "score": 0, "creation_date": 1542346280, "post_id": 34231904, "comment_id": 93543592, "body": "have you resolve this?I have same question"}], "answers": [{"comments": [{"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "edited": false, "score": 0, "creation_date": 1450116099, "post_id": 34232219, "comment_id": 56288904, "body": "thanks, I am using NoRoute, I still see my middleware being called (when no route is found), so I still want control inside my middleware function."}], "tags": [], "owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "is_accepted": false, "score": 1, "last_activity_date": 1449866474, "creation_date": 1449866474, "answer_id": 34232219, "question_id": 34231904, "link": "https://stackoverflow.com/questions/34231904/gin-gonic-middleware-how-to-get-failure-success-status-for-next-handler-in-chai/34232219#34232219", "title": "gin gonic middleware, how to get failure/success status for next handler in chain", "body": "<p>There is a method on <code>Engine</code> called <a href=\"https://godoc.org/github.com/gin-gonic/gin#Engine.NoRoute\" rel=\"nofollow\"><code>NoRoute</code></a> that you can pass route handlers to handle 404's and such.</p>\n"}, {"tags": [], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "is_accepted": false, "score": 1, "last_activity_date": 1450487638, "creation_date": 1450487638, "answer_id": 34366229, "question_id": 34231904, "link": "https://stackoverflow.com/questions/34231904/gin-gonic-middleware-how-to-get-failure-success-status-for-next-handler-in-chai/34366229#34366229", "title": "gin gonic middleware, how to get failure/success status for next handler in chain", "body": "<p>I am going to answer my question since I found a way to handle this kind of issues with route not found / method not found etc. The idea is to set an error in the gin context using context.Error() from the NoRoute/NoMethod handlers. This adds an error to the slice of errors in the c.Errors, which can then later on be used inside your middleware function. </p>\n\n<pre><code>func MyMiddleware() gin.HandlerFunc {\n    return func(c *gin.Context) {\n       //do something here\n       c.Next()\n       //do something based on error in c.\n       if c.Errors.Error() != nil {\n           //error case, get out\n           return \n       }\n       //else continue regular processing. \n    }\n}\n\n\nengine.NoRoute(func(c *gin.Context) {\n    c.JSON(404,\n        gin.H{\"error\": gin.H{\n            \"key\":         \"not allowed\",\n            \"description\": \"not allowed\",\n        }})\n    c.Error(errors.New(\"Failed to find route\")) //Set the error here. \n})\n</code></pre>\n\n<p>Hope it helps. </p>\n"}], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3435, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1490875622, "creation_date": 1449865179, "last_edit_date": 1490875622, "question_id": 34231904, "link": "https://stackoverflow.com/questions/34231904/gin-gonic-middleware-how-to-get-failure-success-status-for-next-handler-in-chai", "title": "gin gonic middleware, how to get failure/success status for next handler in chain", "body": "<p>I am writing a middleware, using gin gonic golang framework. I want to know within my middleware, if the call to next handler failed and take action based on that. </p>\n\n<pre><code>func foo() gin.HandlerFunc {\n    //do something..\n    c.Next()\n    //do something based on result of c.Next()\n}\n</code></pre>\n\n<p>How can I do that? Documentation for next doesnt give much information <a href=\"https://godoc.org/github.com/gin-gonic/gin#Context.Next\" rel=\"nofollow\">https://godoc.org/github.com/gin-gonic/gin#Context.Next</a></p>\n\n<p>Can you offer any suggestions. I basically want to check for non-existing api endpoints, for example, someone enters a URL, for which we don't have any api endpoint, then can I detect it here. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1449857119, "post_id": 34229699, "comment_id": 56203420, "body": "It gets called all over the place throughout that package (16 different places in print.go in fact). I wouldn&#39;t worry about it too much. Trying to work through how it prints for a particular example is pretty arduous and complicated, that package handles printing for all types... It has a lot of different code paths."}, {"owner": {"reputation": 2154, "user_id": 2312075, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/g2VYN.jpg?s=128&g=1", "display_name": "saarrrr", "link": "https://stackoverflow.com/users/2312075/saarrrr"}, "edited": false, "score": 0, "creation_date": 1449857416, "post_id": 34229699, "comment_id": 56203572, "body": "I was going to try and answer this one, but Evan is right.  You&#39;re correct though, String is called somewhere in the stack and it works because interfaces are satisfied implicitly based on the method name."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 12, "last_activity_date": 1449857926, "last_edit_date": 1449857926, "creation_date": 1449857753, "answer_id": 34229994, "question_id": 34229699, "link": "https://stackoverflow.com/questions/34229699/golang-where-is-an-interface-method-called/34229994#34229994", "title": "Golang: Where is an Interface method called?", "body": "<p>The value is passed to <code>Println</code> as an <code>interface{}</code>, and is checked if it satisfies the <code>fmt.Stringer</code> interface via a <a href=\"https://golang.org/ref/spec#Type_assertions\">\"type assertion\"</a> often in the form of a <a href=\"https://golang.org/ref/spec#Type_switches\">\"type switch\"</a>.</p>\n\n<pre><code>func IsStringer(i interface{}) {\n    switch s := i.(type) {\n    case fmt.Stringer:\n        fmt.Println(\"Person a has a String() method\")\n        fmt.Println(s.String())\n    default:\n        fmt.Println(\"not a stringer\")\n    }\n\n    // OR for a single type\n\n    if s, ok := i.(fmt.Stringer); ok {\n        fmt.Println(\"Person a has a String() method\")\n        fmt.Println(s.String())\n    }\n}\n</code></pre>\n\n<p>However, other methods may take precedence when printing from the <code>fmt</code> package. There are first checks for <code>fmt.Formatter</code>, <code>fmt.GoStringer</code>, <code>error</code>, and then finally <code>fmt.Stringer</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": false, "score": 1, "last_activity_date": 1449858040, "creation_date": 1449858040, "answer_id": 34230067, "question_id": 34229699, "link": "https://stackoverflow.com/questions/34229699/golang-where-is-an-interface-method-called/34230067#34230067", "title": "Golang: Where is an Interface method called?", "body": "<p>The <code>fmt</code> package works with the interfaces it defines, in this case <code>Stringer</code>. It does not know of interfaces defined by you so it wouldn't know to call <code>String2()</code> even if you pass it a type that meets the <code>Stringer2</code> interface. </p>\n\n<p>Interfaces are a way to have common behavior between types. So if you create a function <code>Foo(s Stringer2)</code>, Foo can simply call <code>s.String2()</code> confident that anything passed into it will have the function <code>String2()</code>.</p>\n\n<p>To go a bit deeper, <code>fmt.Println</code> takes <code>interface{}</code> types and then uses reflection to check if the given argument meets the <code>Stringer</code> interface to then call <code>String()</code>. </p>\n\n<p>Make sense?</p>\n"}], "owner": {"reputation": 391, "user_id": 5669884, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/130c678fcfc1608105f30bbe7057fe66?s=128&d=identicon&r=PG&f=1", "display_name": "Kosie", "link": "https://stackoverflow.com/users/5669884/kosie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 557, "favorite_count": 1, "accepted_answer_id": 34229994, "answer_count": 2, "score": 9, "last_activity_date": 1542143956, "creation_date": 1449856670, "last_edit_date": 1542143956, "question_id": 34229699, "link": "https://stackoverflow.com/questions/34229699/golang-where-is-an-interface-method-called", "title": "Golang: Where is an Interface method called?", "body": "<p>I don't understand at which point an Interface method is being called. I'm looking at the following example from the <em>Go Tour</em>:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Person struct {\n    Name string\n    Age  int\n}\n\nfunc (p Person) String() string {\n    return fmt.Sprintf(\"%v (%v years)\", p.Name, p.Age)\n}\n\nfunc main() {\n    a := Person{\"Arthur Dent\", 42}\n    z := Person{\"Zaphod Beeblebrox\", 9001}\n    fmt.Println(a, z)\n}\n</code></pre>\n\n<p><strong>Problem:</strong></p>\n\n<p>I understand that the <code>func (p Person)</code> receives the <code>String()</code> method and that it returns the <code>string</code> I want to display. But the <code>fmt.Println</code> in the <code>main()</code> method has to call <code>String()</code> at some point, right?</p>\n\n<p>I had a look at the source of <code>fmt</code> in <em>godoc</em>, but I still cannot figure it out!</p>\n\n<p><strong>Another example:</strong></p>\n\n<p>If I add my own interface, lets say <code>Stringer2</code> with a method called <code>String2()</code> and then create a <code>func (p Person) String2() {....}</code>. \nHow does <code>String()</code> get executed by <code>fmt.Println</code>, but <code>String2()</code> not?</p>\n"}, {"tags": ["go", "executable"], "answers": [{"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1450005715, "post_id": 34229542, "comment_id": 56242629, "body": "For bash users, <code>type</code> is preferable over <code>which</code> (the latter is a script)."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1450005842, "post_id": 34229542, "comment_id": 56242662, "body": "Also note that bash had a serious security bug this year, although this has been fixed. But if you have a choice, prefer the default shell <code>sh</code> (usually this is Dash) for all server-side shell scripting."}, {"owner": {"reputation": 341, "user_id": 5170621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eV_pBcYJai8/AAAAAAAAAAI/AAAAAAAAAAA/N0q9MrkHOOs/photo.jpg?sz=128", "display_name": "joe mwirigi", "link": "https://stackoverflow.com/users/5170621/joe-mwirigi"}, "edited": false, "score": 1, "creation_date": 1555419859, "post_id": 34229542, "comment_id": 98098415, "body": "This worked for me but instead of using the complete /bin/bash path I just used sh as below exec.Command(&quot;sh&quot;, &quot;-c&quot;, &quot;command -v foo&quot;) otherwise I was getting the exit error 26/27 for most of my excecutions."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 10, "last_activity_date": 1449856237, "last_edit_date": 1449856237, "creation_date": 1449856106, "answer_id": 34229542, "question_id": 34229486, "link": "https://stackoverflow.com/questions/34229486/how-to-execute-a-shell-built-in-command/34229542#34229542", "title": "How to execute a shell built-in command", "body": "<p>Just like that article says, \"command\" is a shell built-in. You can do this natively in go via <a href=\"https://golang.org/pkg/os/exec/#LookPath\" rel=\"noreferrer\"><code>exec.LookPath</code></a>.</p>\n\n<p>If you must, you can either use the system <code>which</code> binary, or you can execute <code>command</code> from within a shell,</p>\n\n<pre><code>exec.Command(\"/bin/bash\", \"-c\", \"command -v foo\")\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 302, "user_id": 3038425, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Iw3Mk.png?s=128&g=1", "display_name": "lyderic", "link": "https://stackoverflow.com/users/3038425/lyderic"}, "edited": false, "score": 1, "creation_date": 1528394170, "post_id": 34235164, "comment_id": 88502423, "body": "uuidgen is not a shell built-in command. A built-in command are e.g. alias, source, read, printf etc. <a href=\"https://www.gnu.org/software/bash/manual/html_node/Bash-Builtins.html#Bash-Builtins\" rel=\"nofollow noreferrer\">gnu.org/software/bash/manual/html_node/&hellip;</a>"}], "tags": [], "owner": {"reputation": 2532, "user_id": 809198, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f9aa79f93a3c988f32b7fa40d097c6be?s=128&d=identicon&r=PG", "display_name": "Chris Townsend", "link": "https://stackoverflow.com/users/809198/chris-townsend"}, "is_accepted": false, "score": 1, "last_activity_date": 1449883737, "creation_date": 1449883737, "answer_id": 34235164, "question_id": 34229486, "link": "https://stackoverflow.com/questions/34229486/how-to-execute-a-shell-built-in-command/34235164#34235164", "title": "How to execute a shell built-in command", "body": "<p>Alternatively, if it is a built in command that doesn't need parameters you could do something like the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"os/exec\"\n)\n\nfunc main() {\n    out, err := exec.Command(\"uuidgen\").Output()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%s\", out)\n}\n</code></pre>\n\n<p>This would print out a unique ID like the following : 4cdb277e-3c25-48ef-a367-ba734ce407c1 just like calling it directly from the command line.</p>\n"}], "owner": {"reputation": 307, "user_id": 1864805, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d0393fcefefad7c5a1ce9434a2897a79?s=128&d=identicon&r=PG", "display_name": "Konoha", "link": "https://stackoverflow.com/users/1864805/konoha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10169, "favorite_count": 2, "accepted_answer_id": 34229542, "answer_count": 2, "score": 11, "last_activity_date": 1563100548, "creation_date": 1449855905, "last_edit_date": 1563100548, "question_id": 34229486, "link": "https://stackoverflow.com/questions/34229486/how-to-execute-a-shell-built-in-command", "title": "How to execute a shell built-in command", "body": "<p>I am trying to find out if a program exists on Linux and I found this <a href=\"https://stackoverflow.com/questions/592620/check-if-a-program-exists-from-a-bash-script\">article</a>. I tried executing this from my go program and it keeps giving me an error saying it can-not find \"command\" in my $PATH, which is to be expected since it's a built-in command in linux and not a binary. So my question is how to execute built in commands of linux from within go programs?</p>\n\n<pre><code>exec.Command(\"command\", \"-v\", \"foo\")\n</code></pre>\n\n<p>error: exec: \"command\": executable file not found in $PATH</p>\n"}, {"tags": ["go", "cassandra"], "comments": [{"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "edited": false, "score": 0, "creation_date": 1449853672, "post_id": 34228765, "comment_id": 56201590, "body": "What do you mean by testing support? gocql is by far the most matured and heavily contributed."}, {"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1449853684, "post_id": 34228765, "comment_id": 56201597, "body": "We use gocql and can unit test with it.  It does require us to define our own interface which acts mainly as a proxy to the underlying gocql client code, but allows us to replace the implementation with a stub or mock."}, {"owner": {"reputation": 1320, "user_id": 357480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nSHyr.jpg?s=128&g=1", "display_name": "pbathala", "link": "https://stackoverflow.com/users/357480/pbathala"}, "reply_to_user": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1449856017, "post_id": 34228765, "comment_id": 56202897, "body": "@sberry The *gocql.Session that we use in gocql for interacting with cassandra is not a interface. How do you provide mock implementation ? Can you point me to any code you have ?"}, {"owner": {"reputation": 8805, "user_id": 1817176, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/479f89f122c20918e9fe81f856f0a8c6?s=128&d=identicon&r=PG", "display_name": "jmaloney", "link": "https://stackoverflow.com/users/1817176/jmaloney"}, "edited": false, "score": 0, "creation_date": 1449876752, "post_id": 34228765, "comment_id": 56212402, "body": "You can create your own interface, one type that is implemented with a gocql session and one type that is used for mocking."}], "answers": [{"comments": [{"owner": {"reputation": 6511, "user_id": 188108, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/b091399da83212608f7ce92128d73030?s=128&d=identicon&r=PG", "display_name": "Torsten Bronger", "link": "https://stackoverflow.com/users/188108/torsten-bronger"}, "edited": false, "score": 0, "creation_date": 1478976053, "post_id": 34236443, "comment_id": 68369428, "body": "But how is the state of the database used?  For example, if a read in Cassandra is supposed to fail, how can the mock code know to signal the failure?"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 2, "last_activity_date": 1449896305, "creation_date": 1449896305, "answer_id": 34236443, "question_id": 34228765, "link": "https://stackoverflow.com/questions/34228765/golang-client-for-cassandra/34236443#34236443", "title": "Golang client for Cassandra", "body": "<p>This is a very simple example of what I was referring to in the comments:</p>\n\n<pre><code>type CassAPI interface {\n    GetFoo(rowKey string) (someType, error)\n}\n\ntype CassWrapper struct {\n    cass *gocql.Session\n}\n\nfunc (cw *CassWrapper) GetFoo(rowKey string) (someType, error) {\n    // do things with cw.cass\n    return someType\n}\n</code></pre>\n\n<p>In the application code, an instance of CassWrapper would be used, and in tests an instance of some mock or stub would be used which adhered to the same interface of CassAPI.</p>\n"}], "owner": {"reputation": 1320, "user_id": 357480, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/nSHyr.jpg?s=128&g=1", "display_name": "pbathala", "link": "https://stackoverflow.com/users/357480/pbathala"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1782, "favorite_count": 0, "closed_date": 1450679794, "accepted_answer_id": 34236443, "answer_count": 1, "score": 6, "last_activity_date": 1449896305, "creation_date": 1449853382, "question_id": 34228765, "link": "https://stackoverflow.com/questions/34228765/golang-client-for-cassandra", "closed_reason": "Not suitable for this site", "title": "Golang client for Cassandra", "body": "<p>I am looking for a golang client for Cassandra with unit testing support. I have found some libraries like </p>\n\n<ol>\n<li>Goosie (not maintained any more)</li>\n<li>gocql (any client library with no testing support is useless for me)</li>\n<li>gocassa (same issue as above)</li>\n</ol>\n\n<p>Can someone suggest me any client lib that has what I am looking for ?</p>\n"}, {"tags": ["go", "decoding", "quoted-printable"], "answers": [{"comments": [{"owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "edited": false, "score": 0, "creation_date": 1449855869, "post_id": 34228351, "comment_id": 56202826, "body": "Ahh.. I&#39;ve just had a second look. I understand now. There is a container message that is multipart. Then each &quot;part&quot; is quoted-printable... penny drops. Thanks a million!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 0, "last_activity_date": 1449851971, "creation_date": 1449851971, "answer_id": 34228351, "question_id": 34227760, "link": "https://stackoverflow.com/questions/34227760/mime-quotedprintable-having-trouble-decoding-this-message/34228351#34228351", "title": "mime.quotedprintable having trouble decoding this message", "body": "<p>You don't just have quoted-printable data, it's part of a MIME multipart message. The <code>=_</code> pattern is specifically used because it can never occur in a quoted-printable message. </p>\n\n<p>Use a <a href=\"https://golang.org/pkg/mime/multipart/#Reader\" rel=\"nofollow\"><code>multipart.Reader</code></a> to get the contents of each part.</p>\n"}], "owner": {"reputation": 7718, "user_id": 225885, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/pKYBo.jpg?s=128&g=1", "display_name": "jim", "link": "https://stackoverflow.com/users/225885/jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 131, "favorite_count": 0, "accepted_answer_id": 34228351, "answer_count": 1, "score": 1, "last_activity_date": 1449851971, "creation_date": 1449849950, "question_id": 34227760, "link": "https://stackoverflow.com/questions/34227760/mime-quotedprintable-having-trouble-decoding-this-message", "title": "mime.quotedprintable having trouble decoding this message", "body": "<p>I am trying to decode a message which doesn't completely conform to the <code>Quoted Printable String</code> idea.</p>\n\n<p>One of the snippets as shown below has an <code>=</code> where should be an <code>=3D</code> this occurs in a number of places. In fact there are two offences occurring here:</p>\n\n<pre><code>------=_Part_7575500_2105086112.1449628640342\nContent-Type: text/html; charset=\"UTF-8\"\n</code></pre>\n\n<p>I'm decoding with the as follows:</p>\n\n<pre><code>qpr := quotedprintable.NewReader(msg.Body)\n    cleanBody, err := ioutil.ReadAll(qpr)\n</code></pre>\n\n<p>The resulting error is: (complaining about the _ after first =)</p>\n\n<pre><code>quotedprintable: invalid hex byte 0x5f\n</code></pre>\n\n<p>How can I fix get this to work please? Thank you.</p>\n"}, {"tags": ["azure", "go", "client-certificates", "azure-sql-database"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1449856066, "post_id": 34227296, "comment_id": 56202920, "body": "To me, it smells like a plain TLS handshake error: the TLS handshake tries to verify the server&#39;s certificate (the default behaviour) but the certificate subject (an entity which is entitled to present it) does not match the host name of the server serving the request. So, two things to check: 1) try connecting to <code>tr12.northcentralus1-a.worker.database.windows.net</code> or any host in the domain <code>tr12.northcentralus1-a.worker.database.windows.net</code>. I know nothing about AWS and have no idea if it makes sense; but the check will supposedly pass;"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1449856264, "post_id": 34227296, "comment_id": 56203002, "body": "2) Read the <code>go-mssqldb</code> sources and try finding where it does <code>tls.Dial()</code> or utherwise uses the <code>tls</code> package (it may be used just for authentication phase if I recall <code>[MS-TDS]</code> correctly). Try to see if any knobs related to certificate validation are exposed to the clients via connection params. If not, you could hack the required configuration right into the package code to make it work and file an issue to the <code>go-mssqldb</code> tracker. The idea is to pass the TLS-setup code a custom <a href=\"https://golang.org/pkg/crypto/tls/#Config\" rel=\"nofollow noreferrer\">config</a> instance which has <code>InsecureSkipVerify</code> set to true."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1449856369, "post_id": 34227296, "comment_id": 56203061, "body": "...and in the meantime contact the Azure support as whatever they do is wrong: the only way to get around this problem is to make the client skip the certificate verification check which defeats 80% of the purpose of using TLS in the first place ;-)  ...OK, and start with <code>encrypt=false</code> -- it should make the handshake phase not use TLS at all."}], "answers": [{"tags": [], "owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "is_accepted": true, "score": 2, "last_activity_date": 1449857241, "creation_date": 1449857241, "answer_id": 34229845, "question_id": 34227296, "link": "https://stackoverflow.com/questions/34227296/azure-sql-database-error-tls-handshake-failed-since-v12-upgrade/34229845#34229845", "title": "Azure SQL Database error TLS Handshake failed since v12 upgrade", "body": "<p>Based on this closed issue I changed <code>TrustServerCertificate</code> from <code>False</code> to <code>True</code> and added this parameter <code>hostNameInCertificate</code> to the connection string and it is working now:</p>\n\n<p><a href=\"https://github.com/denisenkom/go-mssqldb/issues/55\" rel=\"nofollow\">https://github.com/denisenkom/go-mssqldb/issues/55</a></p>\n\n<p><code>TrustServerCertificate=True;hostNameInCertificate=*.database.windows.net;</code></p>\n\n<p>Azure portal suggests to have <code>TrustServerCertificate=False</code> and no <code>hostNameInCertificate</code>.</p>\n"}], "owner": {"reputation": 2349, "user_id": 316855, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1e4268090367ad8c19af73ea30561aad?s=128&d=identicon&r=PG", "display_name": "Dominic St-Pierre", "link": "https://stackoverflow.com/users/316855/dominic-st-pierre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 961, "favorite_count": 0, "accepted_answer_id": 34229845, "answer_count": 1, "score": 4, "last_activity_date": 1492739463, "creation_date": 1449848530, "last_edit_date": 1492739463, "question_id": 34227296, "link": "https://stackoverflow.com/questions/34227296/azure-sql-database-error-tls-handshake-failed-since-v12-upgrade", "title": "Azure SQL Database error TLS Handshake failed since v12 upgrade", "body": "<p>I receive this error since this morning, new v12 updated server / Azure SQL Database:</p>\n\n<blockquote>\n  <p>TLS Handshake failed: x509: certificate is valid for\n  tr12.northcentralus1-a.worker.database.windows.net,\n  *.tr12.northcentralus1-a.worker.database.windows.net, not [server-name].database.windows.net</p>\n</blockquote>\n\n<p>Locally I have no problem connecting to the Azure SQL database. On Azure Web App the connection cannot be established.</p>\n\n<p>Same connection string as local - was working fine before v12 update.</p>\n\n<p>I'm using this SQL driver <code>github.com/denisenkom/go-mssqldb/</code></p>\n\n<p>Any pointer, don't believe I should change the connection string? Why it's working on local and not on Azure web app.</p>\n\n<p>Edit 1: Just tried to replace <code>[server-name].database.windows.net</code> with the tr12... but tcp connection cannot be established.</p>\n\n<p>Edit 2: Here's the connection string if it can help, bottom line, why it's working locally, same driver package version, I'm building executable locally and deploying via FTP, so not using Kudo deployment for this app. Was working A1 until Azure auto-upgraded to v12.</p>\n\n<blockquote>\n  <p>Server=[server-name].database.windows.net;Port=1433;Database=[dbname];User\n  ID=[user];Password=[pass];Trusted_Connection=False;Encrypt=True;Connection\n  Timeout=30;</p>\n</blockquote>\n\n<p>Should trusted connection be true? or Encryption false? Will try changing those to see....</p>\n\n<p>Edit 3: I've look at the connection string from Azure portal, and v12 seems to have this new parameters: <code>TrustServerCertificate=False</code> but no chance, did not fixed the issue</p>\n"}, {"tags": ["go", "manifest", "rsrc"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1449846618, "post_id": 34226565, "comment_id": 56197119, "body": "It just looks like <code>rsrc</code> isn&#39;t in your PATH"}, {"owner": {"reputation": 245, "user_id": 5288333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c465eaf0afc2a5144d585102920744d0?s=128&d=identicon&r=PG", "display_name": "JackFrost", "link": "https://stackoverflow.com/users/5288333/jackfrost"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1449852695, "post_id": 34226565, "comment_id": 56200964, "body": "thanks this was the error!"}], "answers": [{"tags": [], "owner": {"reputation": 245, "user_id": 5288333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c465eaf0afc2a5144d585102920744d0?s=128&d=identicon&r=PG", "display_name": "JackFrost", "link": "https://stackoverflow.com/users/5288333/jackfrost"}, "is_accepted": true, "score": 1, "last_activity_date": 1449852836, "creation_date": 1449852836, "answer_id": 34228624, "question_id": 34226565, "link": "https://stackoverflow.com/questions/34226565/using-the-akavel-rsrc-tool/34228624#34228624", "title": "Using the akavel rsrc tool", "body": "<p>If anyone runs into the same error you need to actually run the rsrc, so for me the steps were:</p>\n\n<p>1) Navigate in command line to the location of rsrc.exe: </p>\n\n<p><em>For me it was 'C:\\GoProjects\\bin'</em></p>\n\n<p>2) Run the command:</p>\n\n<pre><code>.\\rsrc.exe -manifest '*PATHTOMANIFESTLOCATION*' -o rsrc.syso\n</code></pre>\n\n<p>3) Copy the rsrc.syso file back to the location of my goproject before running go build.</p>\n"}, {"tags": [], "owner": {"reputation": 133, "user_id": 97220, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/516b4ec67af648e62f765b2224f80181?s=128&d=identicon&r=PG", "display_name": "Austin", "link": "https://stackoverflow.com/users/97220/austin"}, "is_accepted": false, "score": 1, "last_activity_date": 1482893904, "creation_date": 1482893904, "answer_id": 41354786, "question_id": 34226565, "link": "https://stackoverflow.com/questions/34226565/using-the-akavel-rsrc-tool/41354786#41354786", "title": "Using the akavel rsrc tool", "body": "<p>An easier way to do what @JackFrost mentioned is to use your %GOPATH% environment variable. </p>\n\n<p>This saved me a small headache from compiling my manifest file in the bin file.</p>\n\n<p><code>%GOPATH%\\bin\\rsrc.exe -manifest file.manifest -o rsrc.syso</code></p>\n"}], "owner": {"reputation": 245, "user_id": 5288333, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c465eaf0afc2a5144d585102920744d0?s=128&d=identicon&r=PG", "display_name": "JackFrost", "link": "https://stackoverflow.com/users/5288333/jackfrost"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1217, "favorite_count": 0, "accepted_answer_id": 34228624, "answer_count": 2, "score": 4, "last_activity_date": 1482893904, "creation_date": 1449846485, "question_id": 34226565, "link": "https://stackoverflow.com/questions/34226565/using-the-akavel-rsrc-tool", "title": "Using the akavel rsrc tool", "body": "<p>Basically I am following this tutorial:\n<a href=\"https://gowalker.org/github.com/lxn/walk\" rel=\"nofollow\">https://gowalker.org/github.com/lxn/walk</a></p>\n\n<p>But when it comes to building the manifest file into a .syso file using the akavel rsrc tool I am running into the following error:</p>\n\n<pre><code>rsrc : The term 'rsrc' is not recognized as the name of a cmdlet, function, script file, or operable program. \nCheck the spelling of the name, or if a path was included, verify that the path is correct and try again.\n</code></pre>\n\n<p>I have run the go get and the package is in the goprojects folder and I am only changing the make of the manifest from 'test.manifest' to windowService.manifest' but this is updated in the command and I don't think this is my error?</p>\n\n<p>IF you could shed any light on this I would be grateful as google doesn't seem to return anything helpful to this tool specifically!</p>\n"}, {"tags": ["go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 19, "last_activity_date": 1449843760, "creation_date": 1449843760, "answer_id": 34225703, "question_id": 34225656, "link": "https://stackoverflow.com/questions/34225656/unmarshal-json-into-struct-cannot-unmarshal-array-into-go-value/34225703#34225703", "title": "Unmarshal json into struct: cannot unmarshal array into Go value", "body": "<p>You need to unmarshal into a slice of Property:\n<a href=\"http://play.golang.org/p/eRgjfBHypH\">http://play.golang.org/p/eRgjfBHypH</a></p>\n\n<pre><code>var props []Property\ner := json.Unmarshal(resp, &amp;props)\nif er != nil {\n    panic(er)\n} else {\n    fmt.Println(props)\n}\n</code></pre>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5629, "favorite_count": 0, "accepted_answer_id": 34225703, "answer_count": 1, "score": 5, "last_activity_date": 1449843765, "creation_date": 1449843594, "last_edit_date": 1449843765, "question_id": 34225656, "link": "https://stackoverflow.com/questions/34225656/unmarshal-json-into-struct-cannot-unmarshal-array-into-go-value", "title": "Unmarshal json into struct: cannot unmarshal array into Go value", "body": "<p>I have a service which provides me properties through REST. Now I want to unmarshal the body into a properties struct. Please see this playground example: <a href=\"http://play.golang.org/p/m7RV9pGadj\" rel=\"noreferrer\">click</a>. When I have only one property, I can easily unmarshal it into a <code>Property</code>. However the ACTUAL response from the server is somehow difference. The actual response I want to unmarshal is this:</p>\n\n<pre><code>[\n    {\n        \"key\": \"blabla\",\n        \"secret\": false,\n        \"type\": \"string\",\n        \"value\": \"hereisthevalue\"\n    },\n    {\n        \"key\": \"yepyepakey\",\n        \"secret\": true,\n        \"type\": \"string\",\n        \"value\": \"dummy\"\n    }\n]\n</code></pre>\n\n<p>Unfortunately I don't know how to unmarshal this. Can someone please point me in the right direction?</p>\n"}, {"tags": ["python", "go", "interpreter", "multiple-instances"], "comments": [{"owner": {"reputation": 2532, "user_id": 809198, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f9aa79f93a3c988f32b7fa40d097c6be?s=128&d=identicon&r=PG", "display_name": "Chris Townsend", "link": "https://stackoverflow.com/users/809198/chris-townsend"}, "edited": false, "score": 1, "creation_date": 1449845115, "post_id": 34224258, "comment_id": 56196171, "body": "If I understand you correctly you want to spawn multiple instances of Python script(s) from a Go program.  I would use a combination of goroutines and the <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">os/exec</a> package to kick off and monitor the Python processes on the goroutine threads."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 2532, "user_id": 809198, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/f9aa79f93a3c988f32b7fa40d097c6be?s=128&d=identicon&r=PG", "display_name": "Chris Townsend", "link": "https://stackoverflow.com/users/809198/chris-townsend"}, "edited": false, "score": 1, "creation_date": 1449853872, "post_id": 34224258, "comment_id": 56201719, "body": "I think it&#39;s an overkill to do that can can become very complicate. Instead, I think you should decouple two languages&#39; code as much as possible and use some kind of broker or interface like @ChrisTownsend suggested <code>os&#47;exec</code> package or message broker if it&#39;s a distributed system."}, {"owner": {"reputation": 1010, "user_id": 3187183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CxbLu.jpg?s=128&g=1", "display_name": "b.ben", "link": "https://stackoverflow.com/users/3187183/b-ben"}, "edited": false, "score": 0, "creation_date": 1449950392, "post_id": 34224258, "comment_id": 56230398, "body": "I throw away my go-python bridge. Thank you both of you."}], "answers": [{"tags": [], "owner": {"reputation": 1010, "user_id": 3187183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CxbLu.jpg?s=128&g=1", "display_name": "b.ben", "link": "https://stackoverflow.com/users/3187183/b-ben"}, "is_accepted": true, "score": 0, "last_activity_date": 1450268344, "creation_date": 1450268344, "answer_id": 34311874, "question_id": 34224258, "link": "https://stackoverflow.com/questions/34224258/how-to-create-multiple-pythons-instances-within-a-go-application/34311874#34311874", "title": "How to create multiple Python&#39;s instances within a Go application", "body": "<p>As Chris Townsend and pie-o-pah said,</p>\n\n<p>Trying to implement sub-interpreter is much more complicate.</p>\n\n<p>Try to create the language interface is make senses to my case.</p>\n\n<p>In this situation <code>os/exec</code> is the way to go.</p>\n\n<p>And can even create ssh to remote my python module if my main server is overload.</p>\n"}], "owner": {"reputation": 1010, "user_id": 3187183, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/CxbLu.jpg?s=128&g=1", "display_name": "b.ben", "link": "https://stackoverflow.com/users/3187183/b-ben"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "accepted_answer_id": 34311874, "answer_count": 1, "score": 1, "last_activity_date": 1450268344, "creation_date": 1449839042, "last_edit_date": 1449847590, "question_id": 34224258, "link": "https://stackoverflow.com/questions/34224258/how-to-create-multiple-pythons-instances-within-a-go-application", "title": "How to create multiple Python&#39;s instances within a Go application", "body": "<p>Currently I'm doing a project in Golang which need to call to Python.</p>\n\n<p>In Python it's a library of singleton-like instance. </p>\n\n<p>But I can't modify those library because It's too complicated. (for me)</p>\n\n<p>Most thing I can do is wrap it with my own Python script.</p>\n\n<p>So I'm finding a way to create multiple Python interpreter in Go.</p>\n\n<p>Or maybe multiple sub-interpreter in Python.</p>\n\n<p>Which mean I can create many python instance(same application).</p>\n\n<p>Any ways I can do this?</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449836514, "post_id": 34222841, "comment_id": 56190654, "body": "This suggests your package structure isn&#39;t well thought out. Have you considered moving your Handlers function into a separate package?"}, {"owner": {"reputation": 503, "user_id": 2219116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cWP58.jpg?s=128&g=1", "display_name": "Mahesh Haldar", "link": "https://stackoverflow.com/users/2219116/mahesh-haldar"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449836806, "post_id": 34222841, "comment_id": 56190862, "body": "Yes, I did but again cycle import is happening. Reason that new package will call <code>child_package</code> and child_package will again call <code>handler package</code>. Problem not solved with new handler package."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449839888, "post_id": 34222841, "comment_id": 56192909, "body": "Packages shouldn&#39;t need each other to test like that. Without knowing more about your structure, &#39;main package&#39; should probably be a &#39;package main&#39; and import what it needs to set up, and be imported by nothing else."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1449843463, "post_id": 34222841, "comment_id": 56195116, "body": "It&#39;s only polite to point out when you cross-post so people aren&#39;t wasting time duplicating answers: <a href=\"https://groups.google.com/forum/?fromgroups#!topic/golang-nuts/3mqquk6sYb8\" rel=\"nofollow noreferrer\">groups.google.com/forum/?fromgroups#!topic/golang-nuts/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 503, "user_id": 2219116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cWP58.jpg?s=128&g=1", "display_name": "Mahesh Haldar", "link": "https://stackoverflow.com/users/2219116/mahesh-haldar"}, "edited": false, "score": 0, "creation_date": 1450082613, "post_id": 34230466, "comment_id": 56266828, "body": "Thanks for sharing this approach of broker package. This is really awesome solution for avoiding cyclic imports.  But my problem was majorly around sharing the gorilla mux route Handlers with other child packages so that, the route handlers can be shared by packages and by test assertions. Can you share your thought on this??"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 503, "user_id": 2219116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cWP58.jpg?s=128&g=1", "display_name": "Mahesh Haldar", "link": "https://stackoverflow.com/users/2219116/mahesh-haldar"}, "edited": false, "score": 0, "creation_date": 1450111847, "post_id": 34230466, "comment_id": 56286427, "body": "@MaheshHaldar I have completely rewritten the answer for your case. Hope it works out."}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 503, "user_id": 2219116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cWP58.jpg?s=128&g=1", "display_name": "Mahesh Haldar", "link": "https://stackoverflow.com/users/2219116/mahesh-haldar"}, "edited": false, "score": 0, "creation_date": 1453107490, "post_id": 34230466, "comment_id": 57441166, "body": "@MaheshHaldar Please vote as best answer if you think it is useful."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 2, "last_activity_date": 1450111779, "last_edit_date": 1450111779, "creation_date": 1449859556, "answer_id": 34230466, "question_id": 34222841, "link": "https://stackoverflow.com/questions/34222841/cycle-import-issue-in-gorilla-mux-routing-with-multiple-sub-packages/34230466#34230466", "title": "Cycle import issue in gorilla mux routing with multiple sub packages", "body": "<p>I assume your <code>main_package</code> isn't the <code>main</code> package in Go. I think the child_packages shouldn't be under the <code>main_package</code> as our goal is to decouple each package from one another. </p>\n\n<p>This is the pattern that I'm currently using in my project to avoid dependency conflicts:</p>\n\n<pre><code>project/\n\u251c\u2500\u2500 main_package\n\u2502   \u2514\u2500\u2500 main_package.go\n\u251c\u2500\u2500 brokers\n\u2502   \u2514\u2500\u2500 brokers.go\n\u251c\u2500\u2500 child_package1\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 child_package1.go\n\u251c\u2500\u2500 child_package2\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 child_package2.go\n\u2514\u2500\u2500 child_package3\n \u00a0\u00a0 \u2514\u2500\u2500 child_package3.go\n</code></pre>\n\n<p>Essentially, each package should never have to deal with anything outside of itself (or at least do so with as little as possible). The <code>broker</code> will be the sole party who \"negotiates\" between any two packages. </p>\n\n<pre><code>// main_package.go\npackage main_package\n\nimport (\n    \"path/to/sql\"\n    \"path/to/mux\"\n    \"path/to/brokers\"\n)\n\n// Never use selectors from packages directly\n// but create a `Broker` object for each endpoint\nvar bk1 = brokers.New(\"/api1\")\nvar bk2 = brokers.New(\"/api2\")\nvar bk3 = brokers.New(\"/api3\")\n\nfunc Handlers(db *sql.DB, customeruploadFile string) *mux.Router {\n    router := mux.NewRouter()\n\n    // each broker has its own `MyHandler` function\n    router.HandleFunc(\"/api1\", bk1.MyHandler)\n    router.HandleFunc(\"/api2\", bk2.MyHandler)\n    router.HandleFunc(\"/api3\", bk3.MyHandler)\n\n    fileHandler := http.FileServer(http.Dir(\"./client/compiled\"))\n    router.PathPrefix(\"/\").Handler(http.StripPrefix(\"/\", fileHandler))\n    return router\n}\n</code></pre>\n\n<p>The <code>brokers</code> package is the central interface for the communication</p>\n\n<pre><code>// brokers.go\npackage brokers\n\nimport (\n    \"path/to/child_package1\"\n    \"path/to/child_package2\"\n    \"path/to/child_package3\"\n    \"net/http\"\n)\n\ntype Broker interface {\n    MyHandler(http.ResponseWriter, *http.Request) \n}\n\n// Factory function to create a `Broker` instance\nfunc New(uri string) Broker {\n    if uri == \"/api1\" {\n        return Broker( new(child_package1.Delegate) )\n    } else if uri == \"/api2\" {\n        return Broker( new(child_package2.Delegate) )\n    } else if uri == \"/api3\" {\n        return Broker( new(child_package3.Delegate) )\n    }\n    return nil\n}\n</code></pre>\n\n<p>Now <code>child_packageX</code> is no long decoupled to any internal dependency, provided\nit expose a \"representative\" or <code>Delegate</code> object to talk to the broker.</p>\n\n<pre><code>// child_package1.go\npackage child_package1\n\nimport \"net/http\"\n\ntype Delegate struct {\n   // Optional parameters can be carried by the Delegate\n   // to be used in the created Broker anywhere\n}\n\nfunc (d *Delegate) MyHandler(w http.ResponseWriter, r *http.Request) {\n  // Maybe return a JSON here\n}\n</code></pre>\n\n<p>Each child can have its own <code>MyHandler</code> that does different things for different api calls, without having to know what endpoints they are serving.</p>\n\n<pre><code>// child_package2\npackage child_package2\n\nimport \"net/http\"\n\ntype Delegate struct {}\n\nfunc (d *Delegate) MyHandler(w http.ResponseWriter, r *http.Request) {\n    // Maybe return an XML here\n}\n</code></pre>\n\n<p>The <code>main_package</code> doesn't import all the <code>child_packageX</code>, but just the <code>broker</code> package. You can write a test that imports the <code>broker</code> package instead of the actual packages, or you can even write another broker for testing.</p>\n\n<pre><code>package test\n\nimport (\n    \"testing\"\n    \"path/to/main_package\"\n)\n\nfunc TestMain(*testing.T) {\n    // test the routing in `main_package`\n}\n</code></pre>\n\n<p>You're no longer testing a functionality of a handler function, but one of an endpoint exposed by a broker. This encourage you to write generic handler functions and focus on the higher level endpoints.</p>\n\n<pre><code>package test\n\nimport (\n    \"testing\"\n    \"path/to/broker\"\n\n)\n\nfunc TestGetJSONAlright(*testing.T) {\n     bk1 := brokers.New(\"/api1\")\n     // test if I get JSON here\n}\n\nfunc TestGetXMLAlright(*testing.T) {\n    bk1 := brokers.New(\"/api2\")\n    // test if I get XML here\n}\n</code></pre>\n\n<p>This, in my opinion, is a powerful pattern since you can write more \"generic\" handlers and just plug them in to the routes you want.  </p>\n"}], "owner": {"reputation": 503, "user_id": 2219116, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/cWP58.jpg?s=128&g=1", "display_name": "Mahesh Haldar", "link": "https://stackoverflow.com/users/2219116/mahesh-haldar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 34230466, "answer_count": 1, "score": 2, "last_activity_date": 1450111779, "creation_date": 1449834494, "question_id": 34222841, "link": "https://stackoverflow.com/questions/34222841/cycle-import-issue-in-gorilla-mux-routing-with-multiple-sub-packages", "title": "Cycle import issue in gorilla mux routing with multiple sub packages", "body": "<p>Here is my project structure</p>\n\n<pre>\n--main package\n--|--child_package1\n--|--child_package2\n--|--child_package3\n</pre>\n\n<p>I have all the the routes and method call management for API calls listed in main_package</p>\n\n<p>The router Handler from main_package.go looks like this:</p>\n\n<pre><code>func Handlers(db *sql.DB, customeruploadFile string) *mux.Router {\n  router := mux.NewRouter()\n  router.HandleFunc(\"/api1\", child_package1.method )\n  router.HandleFunc(\"/api2\", child_package2.method)\n  router.HandleFunc(\"/api3\", child_package3.mehtod)\n\n  fileHandler := http.FileServer(http.Dir(\"./client/compiled\"))\n  router.PathPrefix(\"/\").Handler(http.StripPrefix(\"/\", fileHandler))\n  return router\n}\n</code></pre>\n\n<p>The problem is when I write test cases for child packages, I need this Handlers method to create test server, for that I need to import main_package in child_packages, then as obvious there is cycle imports happening, as child_packages are imported in main_package.\nCan any one please suggest me the best approach to tackle this?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449834592, "post_id": 34221639, "comment_id": 56189450, "body": "What have you tried? Are you getting specific errors? You will need to use the appengine libraries to deploy it there. (this may be a question better suited for <a href=\"https://forum.golangbridge.org/\" rel=\"nofollow noreferrer\">forum.golangbridge.org</a> due to the broad nature)"}, {"owner": {"reputation": 2613, "user_id": 1305989, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c6dc5f37a2bbdec9b9ff24dfdc6f0035?s=128&d=identicon&r=PG", "display_name": "user1305989", "link": "https://stackoverflow.com/users/1305989/user1305989"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449837287, "post_id": 34221639, "comment_id": 56191177, "body": "Thanks for comment elithrar. As I mentioned, I didnt understand to try. I was able to deploy basic golang app but dont even know deploying gin-gonic/aerospike with app engine. Thanks for the link to the forum. I have to deploy basic app fast so it will good if I am given answer fast. Thank you :)"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449839972, "post_id": 34221639, "comment_id": 56192957, "body": "FYI, Aerospike can&#39;t be deployed on AppEngine - you will have to install it on a VPS, Google Compute Engine, Amazon EC2, etc - see here for the hosted solutions: <a href=\"http://www.aerospike.com/cloud-partners/\" rel=\"nofollow noreferrer\">aerospike.com/cloud-partners</a>"}, {"owner": {"reputation": 2613, "user_id": 1305989, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c6dc5f37a2bbdec9b9ff24dfdc6f0035?s=128&d=identicon&r=PG", "display_name": "user1305989", "link": "https://stackoverflow.com/users/1305989/user1305989"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449840268, "post_id": 34221639, "comment_id": 56193131, "body": "Thanks a lot. Thats what I am worrying/doubtful. I thought I missed something. So, I will install aerospike on digital ocean and gin-gonic on appengine. I will comment again if I need further help. Thankyou."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1449840420, "post_id": 34221639, "comment_id": 56193227, "body": "You can&#39;t install appengine on Digital Ocean. appengine is a Google hosted platform+library combination. You could install Aerospike on a Compute Engine (VPS) and have your Gin app on the same VPS, another VPS, or appengine communicate with it. Unless you built your app with appengine from the start there will be some work to make it compatible, so I would suggest just going with the VPS route or using a service like Heroku that doesn&#39;t require modifications."}, {"owner": {"reputation": 2613, "user_id": 1305989, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c6dc5f37a2bbdec9b9ff24dfdc6f0035?s=128&d=identicon&r=PG", "display_name": "user1305989", "link": "https://stackoverflow.com/users/1305989/user1305989"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449840485, "post_id": 34221639, "comment_id": 56193265, "body": "Yeah, thats a typo and I edited now. I was about to write aerospike."}, {"owner": {"reputation": 2613, "user_id": 1305989, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c6dc5f37a2bbdec9b9ff24dfdc6f0035?s=128&d=identicon&r=PG", "display_name": "user1305989", "link": "https://stackoverflow.com/users/1305989/user1305989"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1449841671, "post_id": 34221639, "comment_id": 56193968, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/97648/discussion-between-user1305989-and-elithrar\">continue this discussion in chat</a>."}], "owner": {"reputation": 2613, "user_id": 1305989, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/c6dc5f37a2bbdec9b9ff24dfdc6f0035?s=128&d=identicon&r=PG", "display_name": "user1305989", "link": "https://stackoverflow.com/users/1305989/user1305989"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 564, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1449830731, "creation_date": 1449830731, "question_id": 34221639, "link": "https://stackoverflow.com/questions/34221639/how-to-deploy-gin-gonicgolang-app-with-aerospike-on-google-app-engine", "title": "How to deploy gin gonic(golang) app with aerospike on Google app engine?", "body": "<p>I was able to deploy a simple hello.go written in golang(without extra libs). </p>\n\n<p>Can anyone help me how to deploy the webapplication I have developed locally using gin-gonic framework and aerospike(aerospike-client-go).</p>\n\n<p>Particularly I am unable to understand whether I should install aerospike on some other vps and provide its url here in code to connect remotely. I am not getting the best way/correct/working way to use appengine.</p>\n"}, {"tags": ["xml", "go"], "answers": [{"comments": [{"owner": {"reputation": 145, "user_id": 994781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8dd812e068671cdb970260105db7a55?s=128&d=identicon&r=PG", "display_name": "Jim Gaylard", "link": "https://stackoverflow.com/users/994781/jim-gaylard"}, "edited": false, "score": 1, "creation_date": 1449831500, "post_id": 34221665, "comment_id": 56187690, "body": "Thanks. The <code>&gt;.</code> was the missing piece and something I hadn&#39;t seen before."}], "tags": [], "owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "is_accepted": true, "score": 2, "last_activity_date": 1449831224, "last_edit_date": 1449831224, "creation_date": 1449830794, "answer_id": 34221665, "question_id": 34221384, "link": "https://stackoverflow.com/questions/34221384/how-to-marshal-xml-with-optional-tags-in-go/34221665#34221665", "title": "How to marshal xml with optional tags in Go", "body": "<p>Put <code>&gt;.</code> after <code>mainCarriage</code> field tag to indicate that you want to put contents of the field inside <code>mainCarriage</code> tag. Change the name of <code>Sea</code> field to <code>XMLName</code> as required by marshaller.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"log\"\n)\n\ntype Carriage struct {\n    MainCarriage interface{} `xml:\"mainCarriage&gt;.\"`\n}\n\ntype SeaCarriage struct {\n    XMLName      xml.Name `xml:\"http://www.example.com/XMLSchema/standard/2012 sea\"`\n    LoadFactor   float64  `xml:\"loadFactor,attr\"`\n    SeaCargoType string   `xml:\"seaCargoType,attr\"`\n}\n\ntype RoadCarriage struct {\n    Road xml.Name `xml:\"http://www.example.com/XMLSchema/standard/2012 road\"`\n}\n\nfunc main() {\n\n    fr := Carriage{\n        MainCarriage: SeaCarriage{\n            LoadFactor:   70,\n            SeaCargoType: \"Container\",\n        },\n    }\n    xmlBlob, err := xml.MarshalIndent(&amp;fr, \"\", \"\\t\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(xmlBlob))\n}\n</code></pre>\n\n<p><kbd><a href=\"https://play.golang.org/p/pDoyqzrQtX\" rel=\"nofollow\">Playground</a></kbd></p>\n"}], "owner": {"reputation": 145, "user_id": 994781, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f8dd812e068671cdb970260105db7a55?s=128&d=identicon&r=PG", "display_name": "Jim Gaylard", "link": "https://stackoverflow.com/users/994781/jim-gaylard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1464, "favorite_count": 0, "accepted_answer_id": 34221665, "answer_count": 1, "score": 3, "last_activity_date": 1449831224, "creation_date": 1449829939, "last_edit_date": 1449830998, "question_id": 34221384, "link": "https://stackoverflow.com/questions/34221384/how-to-marshal-xml-with-optional-tags-in-go", "title": "How to marshal xml with optional tags in Go", "body": "<p>The code for my problem is here: <a href=\"https://play.golang.org/p/X8Ey2hqmxL\" rel=\"nofollow\">https://play.golang.org/p/X8Ey2hqmxL</a></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/xml\"\n    \"fmt\"\n    \"log\"\n)\n\ntype Carriage struct {\n    MainCarriage interface{} `xml:\"mainCarriage\"`\n}\n\ntype SeaCarriage struct {\n    Sea          xml.Name `xml:\"http://www.example.com/XMLSchema/standard/2012 sea\"`\n    LoadFactor   float64  `xml:\"loadFactor,attr\"`\n    SeaCargoType string   `xml:\"seaCargoType,attr\"`\n}\n\ntype RoadCarriage struct {\n    Road xml.Name `xml:\"http://www.example.com/XMLSchema/standard/2012 road\"`\n}\n\nfunc main() {\n\n    fr := Carriage{\n        MainCarriage: SeaCarriage{\n            LoadFactor:   70,\n            SeaCargoType: \"Container\",\n        },\n    }\n    xmlBlob, err := xml.MarshalIndent(&amp;fr, \"\", \"\\t\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(string(xmlBlob))\n}\n</code></pre>\n\n<p>I need to marshall data into SOAP xml. I'm currently getting this result:</p>\n\n<pre><code>&lt;Carriage&gt;\n    &lt;mainCarriage loadFactor=\"70\" seaCargoType=\"Container\"&gt;\n        &lt;sea xmlns=\"http://www.example.com/XMLSchema/standard/2012\"&gt;&lt;/sea&gt;\n    &lt;/mainCarriage&gt;\n&lt;/Carriage&gt;\n</code></pre>\n\n<p>But I need this result:</p>\n\n<pre><code>&lt;Carriage&gt;\n    &lt;mainCarriage&gt;\n        &lt;sea xmlns=\"http://www.example.com/XMLSchema/standard/2012\" loadFactor=\"70\" seaCargoType=\"Container\"&gt;&lt;/sea&gt;\n    &lt;/mainCarriage&gt;\n&lt;/Carriage&gt;\n</code></pre>\n\n<p>No matter what I try I cannot marshal the structs so that the loadFactor and the seaCargoType are attrs of the <code>sea</code> tag.</p>\n\n<p>The Carriage struct takes an empty interface because depending on the shipment type the tag should be either sea or road but never both.</p>\n"}, {"tags": ["go", "sqlite"], "comments": [{"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1449823783, "post_id": 34219285, "comment_id": 56182974, "body": "How is your users defined?"}, {"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1449824265, "post_id": 34219285, "comment_id": 56183220, "body": "Does <a href=\"https://github.com/jinzhu/gorm/issues/18#issuecomment-29351315\" rel=\"nofollow noreferrer\">this issue</a> do any help for you ?"}, {"owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "reply_to_user": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1449824362, "post_id": 34219285, "comment_id": 56183281, "body": "@holys Unfortunately, no.  I believe that is a solution for those using a <code>mysql</code> db."}, {"owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1449825362, "post_id": 34219285, "comment_id": 56183835, "body": "Does the <code>parseTime=True</code>  case-sensitive?"}, {"owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "reply_to_user": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "edited": false, "score": 0, "creation_date": 1449826310, "post_id": 34219285, "comment_id": 56184355, "body": "@holys Just tried with <code>?charset=utf8&amp;parseTime=True</code>, no luck."}, {"owner": {"reputation": 14632, "user_id": 428260, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Jr7uO.png?s=128&g=1", "display_name": "iltempo", "link": "https://stackoverflow.com/users/428260/iltempo"}, "edited": false, "score": 0, "creation_date": 1449830417, "post_id": 34219285, "comment_id": 56186986, "body": "Is it intended that you are converting <code>DeletedAt</code> into a pointer <code>*time.Time</code>? Did you try to change it to <code>time.Time</code>?"}, {"owner": {"reputation": 9869, "user_id": 1292052, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c1d8149aa7711d6016cdf6557aa8cdbf?s=128&d=identicon&r=PG", "display_name": "slashingweapon", "link": "https://stackoverflow.com/users/1292052/slashingweapon"}, "edited": false, "score": 1, "creation_date": 1449855311, "post_id": 34219285, "comment_id": 56202524, "body": "What is the schema in SqlLite?  And what do the rows look like when you do a query like that from the command line?"}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "edited": false, "score": 0, "creation_date": 1449959753, "post_id": 34219285, "comment_id": 56233389, "body": "How is the table <code>users</code> defined in SQL? Tell us the output of <code>.schema users</code> from the sqlite3 shell."}, {"owner": {"reputation": 6313, "user_id": 328115, "user_type": "registered", "accept_rate": 44, "profile_image": "https://www.gravatar.com/avatar/9a029d2d948f128443f996fa12b3d3a1?s=128&d=identicon&r=PG", "display_name": "dolmen", "link": "https://stackoverflow.com/users/328115/dolmen"}, "reply_to_user": {"reputation": 14632, "user_id": 428260, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Jr7uO.png?s=128&g=1", "display_name": "iltempo", "link": "https://stackoverflow.com/users/428260/iltempo"}, "edited": false, "score": 0, "creation_date": 1449959829, "post_id": 34219285, "comment_id": 56233412, "body": "@iltempo <code>*time.Time</code> is used because <code>DeletedAt</code> is <code>NULL</code> until the user is deleted."}], "answers": [{"tags": [], "owner": {"reputation": 14632, "user_id": 428260, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/Jr7uO.png?s=128&g=1", "display_name": "iltempo", "link": "https://stackoverflow.com/users/428260/iltempo"}, "is_accepted": false, "score": 5, "last_activity_date": 1449961415, "creation_date": 1449961415, "answer_id": 34246025, "question_id": 34219285, "link": "https://stackoverflow.com/questions/34219285/how-to-parse-time-time-from-sql-in-golang/34246025#34246025", "title": "How to parse *time.Time from sql in golang?", "body": "<p>lib/pq implements a <a href=\"https://github.com/lib/pq/blob/b269bd035a727d6c1081f76e7a239a1b00674c40/encode.go#L521\" rel=\"noreferrer\">NullTime</a> type for that. It defines a scanner interface for a time.Time type that may be null. You can use it in exchange to <code>*time.Time</code>.</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>type NullTime struct {\n    Time  time.Time\n    Valid bool // Valid is true if Time is not NULL\n}\n\n// Scan implements the Scanner interface.\nfunc (nt *NullTime) Scan(value interface{}) error {\n    nt.Time, nt.Valid = value.(time.Time)\n    return nil\n}\n\n// Value implements the driver Valuer interface.\nfunc (nt NullTime) Value() (driver.Value, error) {\n    if !nt.Valid {\n        return nil, nil\n    }\n    return nt.Time, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 10776, "user_id": 749477, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6845c6b2318e02258cc1dc56fe620482?s=128&d=identicon&r=PG", "display_name": "Derek", "link": "https://stackoverflow.com/users/749477/derek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6170, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1449961415, "creation_date": 1449823399, "last_edit_date": 1449824005, "question_id": 34219285, "link": "https://stackoverflow.com/questions/34219285/how-to-parse-time-time-from-sql-in-golang", "title": "How to parse *time.Time from sql in golang?", "body": "<p>Using <code>gorm</code> and <code>go-sqlite3</code>.  Opening my db using <code>gorm.Open(\"sqlite3\", \"/dev.db?charset=utf8&amp;parseTime=true\")</code>.</p>\n\n<p>Trying to execute </p>\n\n<pre><code>db.Raw(\"SELECT * from users;\").Scan(&amp;users)\n// models.User has a deleted_at column that is of the type *time.Time\n// I am getting Scan error on column index 1: unsupported driver -&gt; Scan pair: []uint8 -&gt; *time.Time\n</code></pre>\n\n<p>How do I parse sql into *time.Time?</p>\n\n<p>User struct</p>\n\n<pre><code>type User struct {\n    ID        uint64 `gorm:\"primary_key\"`\n    Name      sql.NullString\n    CreatedAt time.Time\n    UpdatedAt time.Time\n    DeletedAt *time.Time\n}\n</code></pre>\n"}, {"tags": ["memory", "struct", "go", "padding", "sizeof"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1449824887, "post_id": 34219232, "comment_id": 56183577, "body": "2. does some memory need allocated for meta data, like type info."}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "edited": false, "score": 0, "creation_date": 1449885682, "post_id": 34219232, "comment_id": 56214337, "body": "structs do not contain type info (and have no size overhead other than the fields), this is all handled by the compiler.  Interfaces, however, contain the type and the value."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 13, "last_activity_date": 1561477687, "last_edit_date": 1561477687, "creation_date": 1449825547, "answer_id": 34219916, "question_id": 34219232, "link": "https://stackoverflow.com/questions/34219232/struct-has-different-size-if-the-field-order-is-different/34219916#34219916", "title": "Struct has different size if the field order is different", "body": "<h2>1. Struct sizes</h2>\n\n<p><strong>TL;DR; (Summary):</strong> Different implicit padding will be used if you reorder the fields, and the implicit padding counts towards the size of the <code>struct</code>.</p>\n\n<p><em>Note that the result depends on the target architecture; results you posted applies when <code>GOARCH=386</code>, but when <code>GOARCH=amd64</code>, sizes of both <code>A{}</code> and <code>B{}</code> will be 24 bytes.</em></p>\n\n<p>Address of fields of a struct must be aligned, and the address of fields of type <code>int64</code> must be a multiple of 8 bytes. <a href=\"https://golang.org/ref/spec#Package_unsafe\" rel=\"nofollow noreferrer\">Spec: Package <code>unsafe</code>:</a></p>\n\n<blockquote>\n  <p>Computer architectures may require memory addresses to be <em>aligned</em>; that is, for addresses of a variable to be a multiple of a factor, the variable's type's <em>alignment</em>. The function <code>Alignof</code> takes an expression denoting a variable of any type and returns the alignment of the (type of the) variable in bytes.</p>\n</blockquote>\n\n<p>Align of <code>int64</code> is 8 bytes:</p>\n\n<pre><code>fmt.Println(unsafe.Alignof((int64(0)))) // Prints 8\n</code></pre>\n\n<p>So in case of <code>A</code> since first field is <code>bool</code>, there is a 7-byte implicit padding after <code>A.a</code> so that <code>A.b</code> which is of type <code>int64</code> can start on an address that is a multiple of 8. This (that 7-byte padding is needed exactly) is guaranteed as the <code>struct</code> itself is aligned to an address which is a multiple of 8, because that is the largest size of all of its fields. See: <a href=\"https://golang.org/ref/spec#Size_and_alignment_guarantees\" rel=\"nofollow noreferrer\">Spec: Size alignment guarantees:</a></p>\n\n<blockquote>\n  <p>For a variable <code>x</code> of struct type: <code>unsafe.Alignof(x)</code> is the largest of all the values <code>unsafe.Alignof(x.f)</code> for each field <code>f</code> of <code>x</code>, but at least <code>1</code>.</p>\n</blockquote>\n\n<p>In case of <code>B</code> (and if <code>GOARCH=386</code> which is your case) there will only be a 3-byte implicit padding after the <code>B.a</code> field of type <code>bool</code> because this field is followed by a field of type <code>int</code> (which has size of 4 bytes) and not <code>int64</code>.</p>\n\n<p>Align of <code>int</code> is 4 bytes if <code>GOARCH=386</code>, and 8 bytes if <code>GOARCH=amd64</code>:</p>\n\n<pre><code>fmt.Println(unsafe.Alignof((int(0))))   // Prints 4 if GOARCH=386, and 8 if GOARCH=amd64\n</code></pre>\n\n<p>Use <a href=\"https://golang.org/pkg/unsafe/#Offsetof\" rel=\"nofollow noreferrer\"><code>unsafe.Offsetof()</code></a> to find out the offsets of fields:</p>\n\n<pre><code>// output 24\na := A{}\nfmt.Println(unsafe.Sizeof(a),\n    unsafe.Offsetof(a.a), unsafe.Offsetof(a.b), unsafe.Offsetof(a.c))\n\n// output 16\nb := B{}\nfmt.Println(unsafe.Sizeof(b),\n    unsafe.Offsetof(b.b), unsafe.Offsetof(b.a), unsafe.Offsetof(b.c))\n\n// output 0\nfmt.Println(unsafe.Sizeof(C{}))\n\nvar i int\nfmt.Println(unsafe.Sizeof(i))\n</code></pre>\n\n<p>Output if <code>GOARCH=386</code> (try it on the <a href=\"http://play.golang.org/p/JovERjbY0V\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>24 0 8 16\n16 0 8 12\n0\n4\n</code></pre>\n\n<p>Output if <code>GOARCH=amd64</code>:</p>\n\n<pre><code>24 0 8 16\n24 0 8 16\n0\n8\n</code></pre>\n\n<h2>2. Zero size values</h2>\n\n<p><a href=\"https://golang.org/ref/spec#Size_and_alignment_guarantees\" rel=\"nofollow noreferrer\">Spec: Size alignment guarantees:</a></p>\n\n<blockquote>\n  <p>A struct or array type has size zero if it contains no fields (or elements, respectively) that have a size greater than zero. <strong>Two distinct zero-size variables may have the same address in memory.</strong></p>\n</blockquote>\n\n<p>So the spec just gives a hint to use the same memory address but it's not a requirement. But current implementations follow it. That is, no memory will be allocated for values of types having a size of zero, this includes the empty struct <code>struct{}</code> and arrays of zero length, e.g. <code>[0]int</code>, or arrays whose elements has a size of zero (and with arbitrary length).</p>\n\n<p>See this example:</p>\n\n<pre><code>a := struct{}{}\nb := struct{}{}\nc := [0]int{}\nd := [3]struct{}{}\n\nfmt.Printf(\"%p %p %p %p %p\", &amp;a, &amp;b, &amp;c, &amp;d, &amp;d[2])\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/lv87mVaKuL\" rel=\"nofollow noreferrer\">Go Playground</a>): All the addresses are the same.</p>\n\n<pre><code>0x21cd7c 0x21cd7c 0x21cd7c 0x21cd7c 0x21cd7c\n</code></pre>\n\n<hr>\n\n<p>For an interesting and related topic, read: <a href=\"http://dave.cheney.net/2015/10/09/padding-is-hard\" rel=\"nofollow noreferrer\"><strong>Dave Cheney: Padding is hard</strong></a></p>\n"}], "owner": {"reputation": 5435, "user_id": 1078503, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/00cb3812de2cb2d15f6e5d14c15e6ed8?s=128&d=identicon&r=PG", "display_name": "leiyonglin", "link": "https://stackoverflow.com/users/1078503/leiyonglin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 34219916, "answer_count": 1, "score": 3, "last_activity_date": 1561477687, "creation_date": 1449823205, "last_edit_date": 1449827936, "question_id": 34219232, "link": "https://stackoverflow.com/questions/34219232/struct-has-different-size-if-the-field-order-is-different", "title": "Struct has different size if the field order is different", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"unsafe\"\n)\n\ntype A struct {\n    a bool\n    b int64\n    c int\n}\n\ntype B struct {\n    b int64\n    a bool\n    c int\n}\n\ntype C struct {\n}\n\nfunc main() {\n    // output 24\n    fmt.Println(unsafe.Sizeof(A{}))\n\n    // output 16\n    fmt.Println(unsafe.Sizeof(B{}))\n\n    // output 0\n    fmt.Println(unsafe.Sizeof(C{}))\n}\n</code></pre>\n\n<ol>\n<li><p>Struct <code>A</code> and <code>B</code> have the same fields, but if specified in different order they result in different size. why?</p></li>\n<li><p>Size of struct <code>C</code> is zero. How much memory is allocated by the system for <code>a := C{}</code>?</p></li>\n</ol>\n\n<p>Thanks.</p>\n"}, {"tags": ["javascript", "go", "blockchain", "ethereum"], "answers": [{"tags": [], "owner": {"reputation": 866, "user_id": 1193814, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/Ugyyj.jpg?s=128&g=1", "display_name": "Vishakh", "link": "https://stackoverflow.com/users/1193814/vishakh"}, "is_accepted": false, "score": 3, "last_activity_date": 1451067697, "creation_date": 1451067697, "answer_id": 34465279, "question_id": 34216759, "link": "https://stackoverflow.com/questions/34216759/which-is-the-more-efficient-way-to-hold-contract-data-on-the-ethereum-block-chai/34465279#34465279", "title": "Which is the more efficient way to hold contract data on the Ethereum block chain?", "body": "<ol>\n<li><p>Yes. However, each time you want to add a user you will have to send a transaction for adding a new record to the existing contract.</p></li>\n<li><p>Blocks consist of transactions. Each time you add a user, you will have to create a transaction for the corresponding function call. However, you will only have to do this once and not the data will not be redundantly copied to future blocks.</p></li>\n<li><p>Yes.</p></li>\n</ol>\n\n<p>From the way your question is structured, it seems you should read up again on the difference between transactions and blocks.</p>\n"}, {"tags": [], "owner": {"reputation": 389, "user_id": 200696, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/569fd2d332678063a82e61df2359b38d?s=128&d=identicon&r=PG", "display_name": "HackaZach", "link": "https://stackoverflow.com/users/200696/hackazach"}, "is_accepted": false, "score": 0, "last_activity_date": 1513196237, "creation_date": 1513196237, "answer_id": 47801461, "question_id": 34216759, "link": "https://stackoverflow.com/questions/34216759/which-is-the-more-efficient-way-to-hold-contract-data-on-the-ethereum-block-chai/47801461#47801461", "title": "Which is the more efficient way to hold contract data on the Ethereum block chain?", "body": "<p>A single contract for all users should be sufficient, given that your user objects are not too large.</p>\n\n<p>From the code above, suggest using a <code>map</code> which will allow more efficient fetching of user records than an array. Key the records by any string, such as first+last name.</p>\n\n<pre><code>mapping(string =&gt; user_struct) public users;\n</code></pre>\n"}], "owner": {"reputation": 17385, "user_id": 2714730, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/26d4fa31138c5c8ba1cb76392d9fc64d?s=128&d=identicon&r=PG", "display_name": "Josh Beam", "link": "https://stackoverflow.com/users/2714730/josh-beam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 365, "favorite_count": 1, "answer_count": 2, "score": 3, "last_activity_date": 1513196237, "creation_date": 1449811988, "question_id": 34216759, "link": "https://stackoverflow.com/questions/34216759/which-is-the-more-efficient-way-to-hold-contract-data-on-the-ethereum-block-chai", "title": "Which is the more efficient way to hold contract data on the Ethereum block chain?", "body": "<p>I am playing with a private Ethereum blockchain, and I am interested in implementing some smart contracts. However, information is very limited since this is a newer implementation of the blockchain.</p>\n\n<p>Just as an example, say I want a contract that holds information about a person. Is it more efficient to <strong>create a new contract for each person, or simply hold information about all users in the same contract?</strong></p>\n\n<p>In pseudo-code, the two options look like this.</p>\n\n<p>Option 1 (instantiate a new contract for each person):</p>\n\n<pre><code>contract = // contract code\n\nethereum.newContract(contract, userInfo);\n</code></pre>\n\n<p>Option 2 (hold info of <em>all</em> users in one contract):</p>\n\n<pre><code>contract = {\n  var users = [];\n\n  // other contract code\n}\n\nethereum.newContract(contract, userInfo);\n</code></pre>\n\n<p>Here's how we can quantify \"efficiency\" in this case:</p>\n\n<ol>\n<li>Each time a new contract is instantiated, we have to mine the block for the contract, and then mine any transactions the user makes to the contract. If we only instantiate one contract, however, we only mine the contract deployment <em>once</em>, and then any transactions thereafter, but...</li>\n<li>If we go with the option of storing <em>all info for all users</em> in one contract, is only the \"diff\" of the contract data (the \"array\" of all users) stored as a block, or is the entire set of data stored in every block? Or...</li>\n<li>If we go with the option of \"contract per user\", does it \"waste space\" if we're storing the entire contract definition multiple times (and is it worth the possibly redundant mining that needs to take place)?</li>\n</ol>\n\n<p>Hopefully I was clear in my question, but if not, please let me know. I believe this question is one of \"trade offs\".</p>\n\n<p>(Re: the tags -- I'm using the golang implementation of Ethereum, and a JavaScript API to interact with it.)</p>\n"}, {"tags": ["go", "channel"], "answers": [{"comments": [{"owner": {"reputation": 79, "user_id": 5619626, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b2368a790fa396107c82297e5fb7b93?s=128&d=identicon&r=PG&f=1", "display_name": "Henry John", "link": "https://stackoverflow.com/users/5619626/henry-john"}, "edited": false, "score": 0, "creation_date": 1450082187, "post_id": 34216507, "comment_id": 56266621, "body": "Yes,  Slice is  a reference type, so the read and writes will come to race. When use value type like &quot;string&quot;, the result is good."}, {"owner": {"reputation": 79, "user_id": 5619626, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b2368a790fa396107c82297e5fb7b93?s=128&d=identicon&r=PG&f=1", "display_name": "Henry John", "link": "https://stackoverflow.com/users/5619626/henry-john"}, "edited": false, "score": 0, "creation_date": 1450082547, "post_id": 34216507, "comment_id": 56266799, "body": "And, When I use sync.Mutex to   synchronous  the read and write operations in these two goroutines,  the program will always get into deadlock."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1449812270, "last_edit_date": 1449812270, "creation_date": 1449810462, "answer_id": 34216507, "question_id": 34215373, "link": "https://stackoverflow.com/questions/34215373/how-to-continuously-receive-data-from-channel-of-goroutine/34216507#34216507", "title": "How to continuously receive data from channel of goroutine", "body": "<p>Method2 and Method3 get messed up text because there's a race on the buffer shared by the reader and writer.</p>\n\n<p>Here's a possible sequence of statement execution for the program above:</p>\n\n<pre><code> R: bytes_len, err = f.Read(buf)  \n R: ch&lt;-buf[:bytes_len]\n W: bytes, ok := &lt;-ch; ok\n R: bytes_len, err = f.Read(buf)  // this writes over buffer\n W: f.Write(bytes)                // writes data from second read\n</code></pre>\n\n<p>Run your program <a href=\"https://golang.org/doc/articles/race_detector.html\" rel=\"nofollow\">with the race dectector</a>.  It will flag the issues for you.</p>\n\n<p>One way to fix the problem is to copy the data. For example, create a string from the bytes read and send the string to the channel.</p>\n\n<p>Another option is to connect the goroutines with an <a href=\"http://godoc.org/io#Pipe\" rel=\"nofollow\">io.Pipe</a>.  One goroutine reads from the source and writes to the pipe.  The other goroutine reads from the pipe and writes to the destination. The pipe takes care of the synchronization issues.</p>\n"}, {"tags": [], "owner": {"reputation": 1890, "user_id": 1694885, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/G1T2T.png?s=128&g=1", "display_name": "syllabix", "link": "https://stackoverflow.com/users/1694885/syllabix"}, "is_accepted": false, "score": 1, "last_activity_date": 1450221122, "last_edit_date": 1450221122, "creation_date": 1449811839, "answer_id": 34216724, "question_id": 34215373, "link": "https://stackoverflow.com/questions/34215373/how-to-continuously-receive-data-from-channel-of-goroutine/34216724#34216724", "title": "How to continuously receive data from channel of goroutine", "body": "<p>In order to get the code snippets using the for loops in what you have put in comments as <code>Method2</code> and <code>Method3</code>, you will need to use a <a href=\"https://tour.golang.org/concurrency/3\" rel=\"nofollow\">buffered</a> channel.</p>\n\n<p>The reason the text gets messed up in the target file is the loop in <code>func main</code> has no mechanism to synchronize in lock step with the loops listening on the channel in <code>WriteFile</code>.</p>\n\n<p>Sends to a buffered channel, on the other hand, block only when the buffer is full. Receives block when the buffer is empty. So by initializing a channel with a buffer length of one, your can use <code>Method1</code> and/or <code>Method2</code>. All that's left is remembering to close the channel when you are done.</p>\n\n<pre><code>func main() {\n    f, _ := os.OpenFile(\"test.txt\", os.O_RDONLY, 0600)\n    defer f.Close()\n    ch := make(chan []byte, 1) // use second argument to make to give buffer length 1\n    buf := make([]byte, 10)\n    go WriteFile(ch)\n    for {\n        ch &lt;- buf\n        byteLen, err := f.Read(buf)\n        if err != nil {\n            break\n        }\n        if byteLen &lt; 10 {\n            ch &lt;- buf[:byteLen]\n            break\n        }\n    }\n    close(ch) //close the channel when you done\n}\n\nfunc WriteFile(ch &lt;-chan []byte) {\n    f, err := os.OpenFile(\"othertest.txt\", os.O_RDWR|os.O_APPEND|os.O_CREATE, 0660)\n    defer f.Close()\n    if err != nil {\n        fmt.Println(\"* Error:\", err)\n        return\n    }\n\n    //Method 3: use \"for range\"\n    for data := range ch {\n        f.Write(data)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 79, "user_id": 5619626, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/2b2368a790fa396107c82297e5fb7b93?s=128&d=identicon&r=PG&f=1", "display_name": "Henry John", "link": "https://stackoverflow.com/users/5619626/henry-john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3748, "favorite_count": 2, "accepted_answer_id": 34216507, "answer_count": 2, "score": 4, "last_activity_date": 1450221122, "creation_date": 1449802458, "question_id": 34215373, "link": "https://stackoverflow.com/questions/34215373/how-to-continuously-receive-data-from-channel-of-goroutine", "title": "How to continuously receive data from channel of goroutine", "body": "<p>I am a beginner of the Golang.  I had made a practice about Go channel. Which I open and read data from a file in the main goroutine, then pass the data to the second goroutine to save to another file with channel.\n    My code is as flows</p>\n\n<pre><code>  func main() {\n   f, err := os.OpenFile(\"test.go\", os.O_RDONLY, 0600)\n   ch := make(chan []byte)\n   buf := make([]byte, 10)\n   bytes_len, err := f.Read(buf)\n   fmt.Println(\"ReadLen:\", bytes_len)\n   if err != nil {\n      fmt.Println(\"Error: \", err)\n      return\n   }\n   go WriteFile(ch)\n   for {\n      ch&lt;-buf\n      bytes_len, err = f.Read(buf)\n      if err != nil {\n          fmt.Println(\"error=\", err)\n          break\n      }\n      if bytes_len &lt; 10 {\n          ch&lt;-buf[:bytes_len]\n          fmt.Println(\"Finished!\")\n          break\n      }\n   }\n   time.Sleep(1e9)\n   f.Close()\n }\n\n  func WriteFile(ch &lt;-chan []byte) {\n    fmt.Println(\"* begin!\")\n    f, err := os.OpenFile(\"/home/GoProgram/test/test.file\",  os.O_RDWR|os.O_APPEND|os.O_CREATE, 0660)\n    if err != nil {\n       fmt.Println(\"* Error:\", err)\n       return\n    }\n    /* Method1:  use the \"select\" will write to target file OK, but it is too slow!!!\n    for {\n      select {\n         case bytes, ok:= &lt;-ch:\n            if ok {\n              f.Write(bytes)\n            } else {\n              fmt.Println(\"* file closed!\")\n              break\n            }\n         default:\n            fmt.Println(\"* waiting data!\")\n      }\n    } \\*/\n    // Method 2: use \"for {if}\", this will get messed text in target file, not identical with the source file.\n    for {\n      if bytes, ok := &lt;-ch; ok {\n            f.Write(bytes)\n            fmt.Println(\"* buff=\", string(bytes))\n            bytes = nil\n            ok = false\n      } else {\n        fmt.Println(\"** End \", string(bytes), \"  \", ok)\n        break\n      }\n    }\n\n    /* Method 3: use \"for range\", this will get messed text like in method2\n    for data:= range ch {\n         f.Write(data)\n       //fmt.Println(\"* Data:\", string(data))\n    }\n    \\*/\n    f.Close()\n}\n</code></pre>\n\n<p>My question is why the Method2 and Method3 will get messed text in the target file? How can I fix it?</p>\n"}, {"tags": ["string", "replace", "go"], "comments": [{"owner": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1449800671, "post_id": 34215080, "comment_id": 56174865, "body": "Perhaps theres another way to do what you want? Is your input always the same structure? That is, do you always want <code>&#47;not_this&#47;this&#47;not_this&#47;this</code> ?"}, {"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "reply_to_user": {"reputation": 57021, "user_id": 1517578, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/gd070.png?s=128&g=1", "display_name": "Simon Whitehead", "link": "https://stackoverflow.com/users/1517578/simon-whitehead"}, "edited": false, "score": 0, "creation_date": 1449808223, "post_id": 34215080, "comment_id": 56176753, "body": "@SimonWhitehead, for most of the inputs, this will apply, perhaps if you have any suggestion, it might help think about the solution."}, {"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449808929, "post_id": 34215080, "comment_id": 56176918, "body": "@GauravSinha For the original example you could try this: <code>replacer := strings.NewReplacer(&quot;&#47;emp_1&quot;, &quot;&quot;, &quot;&#47;v1.0&#47;&quot;, &quot;&quot;, &quot;&#47;&quot;, &quot;_&quot;)</code> or try replacing the double _s for just one."}], "answers": [{"tags": [], "owner": {"reputation": 152, "user_id": 5660064, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Q0D4N3-5iEE/AAAAAAAAAAI/AAAAAAAALB4/Lv6t4v1ANRg/photo.jpg?sz=128", "display_name": "Todd McLeod", "link": "https://stackoverflow.com/users/5660064/todd-mcleod"}, "is_accepted": false, "score": 2, "last_activity_date": 1449809227, "creation_date": 1449809227, "answer_id": 34216299, "question_id": 34215080, "link": "https://stackoverflow.com/questions/34215080/strings-replacer-how-to-replace-all-substrings-at-once/34216299#34216299", "title": "Strings.Replacer: how to replace all substrings at once?", "body": "<p>strings.Split might accomplish what you want:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\n//Expecting output to be emp_my_stats\n\nfunc main() {\n\n    input := \"/v1.0/emp/emp_1/my_stats\"\n    xs := strings.Split(input, \"/\")\n    fmt.Println(xs)\n    fmt.Println(xs[4])\n    fmt.Println(xs[3] + xs[4])\n    fmt.Println(xs[3][:4] + xs[4])\n    fmt.Println(xs[3][:len(xs[3])-1] + xs[4])\n}\n</code></pre>\n\n<p>The above produces this output:</p>\n\n<pre><code>[ v1.0 emp emp_1 my_stats]\nmy_stats\nemp_1my_stats\nemp_my_stats\nemp_my_stats\n</code></pre>\n\n<p>You can see it here in action on the <a href=\"https://play.golang.org/p/Fw6F2e7rc3\" rel=\"nofollow\">go playground.</a></p>\n"}, {"comments": [{"owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "edited": false, "score": 0, "creation_date": 1449862368, "post_id": 34217656, "comment_id": 56206009, "body": "thanks for your detailed answer, tips about replacer, good to keep this in mind while adding handler."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 15, "last_activity_date": 1539542852, "last_edit_date": 1539542852, "creation_date": 1449816495, "answer_id": 34217656, "question_id": 34215080, "link": "https://stackoverflow.com/questions/34215080/strings-replacer-how-to-replace-all-substrings-at-once/34217656#34217656", "title": "Strings.Replacer: how to replace all substrings at once?", "body": "<p>You haven't specified any other possible inputs, but it looks that from this:</p>\n\n<pre><code>input := \"/v1.0/emp/emp_1/my_stats\"\n</code></pre>\n\n<p>You need the <code>\"emp\"</code> and <code>\"my_stats\"</code> parts connected with an underscore <code>'_'</code>. And judging by your attempt for the replacer, <code>\"/v1.0/\"</code> and <code>\"/emp_1/\"</code> parts are static, so you can simply do this with one replacer:</p>\n\n<pre><code>replacer := strings.NewReplacer(\"/v1.0/\", \"\", \"/emp_1/\", \"_\")\n</code></pre>\n\n<p>Complete example:</p>\n\n<pre><code>input := \"/v1.0/emp/emp_1/my_stats\"\n\nreplacer := strings.NewReplacer(\"/v1.0/\", \"\", \"/emp_1/\", \"_\")\n\noutput := replacer.Replace(input)\nfmt.Println(\"Output:\", output)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/G-ZIaye2Vs\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Output: emp_my_stats\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<p>You mentioned you have to do this frequently and you want this to be efficient. So make sure you only create one <a href=\"https://golang.org/pkg/strings/#Replacer\" rel=\"noreferrer\"><code>Replacer</code></a>, and reuse it whenever you need to do the replacing (e.g. you can store it in a global variable initialized once). Judging from your input, it looks like it is the path of some URL, and most likely you want to do this is HTTP handlers, which may run concurrently on multiple goroutines. It is safe to use a <code>Replacer</code> from multiple goroutines, quoting from the doc of <code>Replacer</code>:</p>\n\n<blockquote>\n  <p>It is safe for concurrent use by multiple goroutines.</p>\n</blockquote>\n\n<p><strong>Notes #2:</strong></p>\n\n<p>If the <code>\"/v1.0/\"</code> and <code>\"/emp_1/\"</code> parts in the input are not static, you can't really solve your problem with a <code>Replacer</code>. In this case you may use regexp or as a more efficient solution, splitting the string by <code>'/'</code> and joining the relevant parts with <code>'_'</code>.</p>\n"}], "owner": {"reputation": 2170, "user_id": 927370, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/f9c81e4d799a162e9f04472e2d09c6f0?s=128&d=identicon&r=PG", "display_name": "SeattleOrBayArea", "link": "https://stackoverflow.com/users/927370/seattleorbayarea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10654, "favorite_count": 2, "accepted_answer_id": 34217656, "answer_count": 2, "score": 8, "last_activity_date": 1539542852, "creation_date": 1449800064, "last_edit_date": 1449816810, "question_id": 34215080, "link": "https://stackoverflow.com/questions/34215080/strings-replacer-how-to-replace-all-substrings-at-once", "title": "Strings.Replacer: how to replace all substrings at once?", "body": "<p>I am trying to replace multiple different characters from a string using <code>Replacer</code> but having issues replacing one string. Output has two underscores instead of one, and if I try replacing using other <code>Replacer</code>, then it cannot replace it entirely.</p>\n\n<p>Try the code on the <a href=\"https://play.golang.org/p/wsIVZ6Ci5p\" rel=\"noreferrer\">Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    )\n\n//Expecting output to be emp_my_stats\n\nfunc main() {\n    var input string = \"/v1.0/emp/emp_1/my_stats\"\n\n    replacer := strings.NewReplacer(\"/v1.0/\", \"\", \"/\", \"_\", \"emp_1\", \"\")\n//  replacer := strings.NewReplacer(\"/v1.0/\", \"\", \"/\", \"_\", \"/emp_1\", \"\")\n\n    output := replacer.Replace(input)\n    fmt.Printf(\"output %v\", output) \n}\n</code></pre>\n\n<p>I can use multiple <code>Replacer</code> etc. but would really like to do it in one pass / or one statement. </p>\n\n<p>Any suggestions how so do it cleanly? My goal is to be efficient (this will be done frequently, so important although these strings are short) and also to not use multiple <code>Replacer</code>s. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1449796995, "post_id": 34214674, "comment_id": 56173950, "body": "@icza: You know these might show up less often if the duplicate answer said something directly about the error interface."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1449797110, "post_id": 34214674, "comment_id": 56173981, "body": "@ZanLynx But the duplicate answer does say something about the <code>error</code> interface. The 2nd half of the answer is a demonstration directly with <code>error</code>."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1449797155, "post_id": 34214674, "comment_id": 56173994, "body": "@icza: Yes but test this by starting to ask a question using the title of this one, for example."}, {"owner": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1449797354, "post_id": 34214674, "comment_id": 56174042, "body": "@icza: Never mind it is hopeless. I tried several obvious question titles for this problem and the silly SO question search does not even filter by tag, let alone find even vaguely relevant answers. No wonder there are so many dupes."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 49065, "user_id": 13422, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/94b309d78a1253a334e9b82643a8dc97?s=128&d=identicon&r=PG", "display_name": "Zan Lynx", "link": "https://stackoverflow.com/users/13422/zan-lynx"}, "edited": false, "score": 0, "creation_date": 1449797406, "post_id": 34214674, "comment_id": 56174062, "body": "@ZanLynx Yes, I tried too, but the suggestions come up before you enter tags, and when you do enter tags, suggestions are not refreshed. As you said, tags are not used to select suggestions."}], "owner": {"reputation": 6557, "user_id": 2495795, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/13606de0b736d7191e2cf2bfea1d4fda?s=128&d=identicon&r=PG", "display_name": "BufBills", "link": "https://stackoverflow.com/users/2495795/bufbills"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 66, "favorite_count": 0, "closed_date": 1449796838, "answer_count": 0, "score": 0, "last_activity_date": 1449796656, "creation_date": 1449796656, "question_id": 34214674, "link": "https://stackoverflow.com/questions/34214674/in-go-programming-language-why-nil-is-not-nil", "closed_reason": "Duplicate", "title": "in Go programming language, why nil is not nil?", "body": "<pre><code>package main\n\nimport \"fmt\"\n\ntype MagicError struct{}\n\nfunc (MagicError) Error() string {\n    return \"[Magic]\"\n}\n\nfunc Generate() *MagicError {\n    return nil\n}\n\nfunc Test() error {\n    return Generate()\n}\n\nfunc main() {\n    if Test() != nil {\n        fmt.Println(\"Hello, Mr. Pike!\")\n    }\n}\n</code></pre>\n\n<p>Why the test() is not nil? Could anybody explain it to me a little bit?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "syntax", "casting"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1449792678, "post_id": 34211905, "comment_id": 56172704, "body": "See the <a href=\"https://golang.org/doc/faq#convert_slice_of_interface\" rel=\"nofollow noreferrer\">FAQ</a>."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 3, "last_activity_date": 1449782480, "last_edit_date": 1495540758, "creation_date": 1449782480, "answer_id": 34211966, "question_id": 34211905, "link": "https://stackoverflow.com/questions/34211905/casting-from-a-list-of-strings-to-a-list-of-interface-in-go/34211966#34211966", "title": "Casting From a list of strings to a list of interface in go", "body": "<p>You have to deal with each string individually. You can't just cast the whole collection. Here's an example;</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n  a := []string {\"Abc\", \"def\", \"ghi\"}\n  b := []interface{}{} // initialize a slice of type interface{}\n\n  for _, s := range a {\n     b = append(b, s) // append each item in a to b\n  }\n  fmt.Println(len(b)) // prove we got em all\n\n  for _, s := range b {\n    fmt.Println(s) // in case you're real skeptical\n  }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/VWtRTm01ah\" rel=\"nofollow noreferrer\">https://play.golang.org/p/VWtRTm01ah</a></p>\n\n<p>As you can see, no cast is necessary because the collection of type <code>inferface{}</code> will accept any type (all types implement the empty interface <a href=\"https://stackoverflow.com/questions/8996771/go-equivalent-of-a-void-pointer-in-c\">Go equivalent of a void pointer in C</a>). But you do have to deal with each item in collection individually.</p>\n"}], "owner": {"reputation": 1, "user_id": 5666262, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ef47a0c0c65dfda23b52313175a27e1?s=128&d=identicon&r=PG&f=1", "display_name": "Question man 99432", "link": "https://stackoverflow.com/users/5666262/question-man-99432"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 57, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1449782480, "creation_date": 1449782272, "question_id": 34211905, "link": "https://stackoverflow.com/questions/34211905/casting-from-a-list-of-strings-to-a-list-of-interface-in-go", "title": "Casting From a list of strings to a list of interface in go", "body": "<p>I want to pass in a list of strings as generic parameters in go, but not sure if its possible.  I have workarounds but feel like I'm just not able to get syntax correct.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc Set(otherFields ...interface{}) {\n  fmt.Printf(\"%v\", otherFields)\n}\n\nfunc main() {\n  a := []string {\"Abc\", \"def\", \"ghi\"}\n  Set(a)  // incorrect behavior because a passed through as a list, rather than a bunch of parameters \n//   Set(a...)  // compiler error: cannot use a (type []string) as type []interface {} in argument to Set\n//  Set([]interface{}(a)) // compiler error: cannot convert a (type []string) to type []interface {}\n  // This works but I want to do what was above.\n  b := []interface{} {\"Abc\", \"def\", \"ghi\"}\n  Set(b...)\n}\n</code></pre>\n"}, {"tags": ["go", "godeps"], "comments": [{"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449777446, "post_id": 34210127, "comment_id": 56165278, "body": "Which commands did you use? I typically run: <code>godep save .&#47;...</code> and it creates the _workspace folder and copies every dependency in _workspace/src/"}, {"owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "reply_to_user": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449778494, "post_id": 34210127, "comment_id": 56165891, "body": "@AbelardoMendoza whats ur GOPATH set to? and where is your project relative to it? Also what working directory do you run the command (if it matters)?"}, {"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449778865, "post_id": 34210127, "comment_id": 56166105, "body": "$GOPATH: ~/go  Project: $GOPATH/src/github.com/user/project/ .. and just run the command <code>godep save .&#47;...</code> inside of $GOPATH/src/github.com/user/project/"}, {"owner": {"reputation": 599, "user_id": 4327041, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8ZbnQ.jpg?s=128&g=1", "display_name": "abm", "link": "https://stackoverflow.com/users/4327041/abm"}, "edited": false, "score": 0, "creation_date": 1449780223, "post_id": 34210127, "comment_id": 56166893, "body": "Also, is your <b>GO15VENDOREXPERIMENT</b> environment variable set?"}], "owner": {"reputation": 373, "user_id": 5641538, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/8b268f431d5fa6d9f3fc10e059d995a2?s=128&d=identicon&r=PG&f=1", "display_name": "devinov", "link": "https://stackoverflow.com/users/5641538/devinov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 857, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449775636, "creation_date": 1449775636, "question_id": 34210127, "link": "https://stackoverflow.com/questions/34210127/how-do-i-get-my-godep-dependencies-in-my-project-folder-godeps-workspace", "title": "How do I get my godep dependencies in my ...project_folder/Godeps/_workspace/?", "body": "<p>I was given source code with a <em>Godeps/Godeps.json</em> file. From what I understand is I need to get my dependancies into <em>...project_folder/Godeps/_workspace/src</em>.</p>\n\n<p><strong>My Go Path:</strong>\n/users/me/work</p>\n\n<p>I used <em>godep restore</em> which downloaded all the dependancies to <em>/users/me/work/src</em></p>\n\n<p>Am I supposed to manipulate to the GoPATH so that <em>godep restore</em> puts it where I want? Or do I need to manually copy it after? Or am I just using the wrong command?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 0, "creation_date": 1449775724, "post_id": 34210017, "comment_id": 56164358, "body": "The graphs aren&#39;t very helpful without knowing what the Y-axis means, also see <a href=\"https://golang.org/doc/go1.5#performance\" rel=\"nofollow noreferrer\">golang.org/doc/go1.5#performance</a> for some notes about the performance in 1.5. The new GC trades some throughput for latency."}, {"owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "reply_to_user": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 0, "creation_date": 1449776650, "post_id": 34210017, "comment_id": 56164836, "body": "@nuss.justin: Sorry about that. I should have said they represent number of requests per second. The first graph is number of received requests per second, the second graph represent average number of timeouts per second."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1449778500, "post_id": 34210017, "comment_id": 56165894, "body": "Since you say your application is allocation heavy, and 1.5 is when the perf degraded, it&#39;s most likely related to the new GC. You can try making the GC a little less aggressive, something like <code>GOGC=400</code>. The GC stats are probably useful too, with <code>GODEBUG=gctrace=1</code>. Also check the GOMAXPROCS, since the default setting changed in go1.5. This topic would be more appropriate on the go mailing list (there&#39;s not really a programming related question here)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1449789076, "post_id": 34210017, "comment_id": 56171339, "body": "Totally plausible the write barriers and assists cause you more timeouts than the old pauses did. Other data that might help (here or on lists): what the timeout is, the old and new GC pause stats and latency histograms."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1449789343, "post_id": 34210017, "comment_id": 56171481, "body": "Two things you could play with: setting GOGC high and forcing STW GCs every so often with runtime.GC(), or trying many smaller processes."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1449843300, "post_id": 34210017, "comment_id": 56195009, "body": "Not that this answers the question directly, but if this code is at all related to the code in your previous question, it looks like you may have a lot of unnecessary allocations. Reducing the amount of garbage you create should help with your program&#39;s efficiency in general."}, {"owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1449867629, "post_id": 34210017, "comment_id": 56208752, "body": "Thanks for the response guys. @twotwotwo The timeout is 50ms (it&#39;s a time sensitive application). I will pull down more debug logs of GC pauses. I already have it for 1.4.2 but pulling down 1.5 is hard since we can&#39;t have such high timeouts in our production system but we don&#39;t have any ways to replicate the production traffic."}, {"owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1449867887, "post_id": 34210017, "comment_id": 56208876, "body": "@JimB If you mean this (<a href=\"http://stackoverflow.com/questions/34093038/dial-tcp-addrport-i-o-timeout-eof-and-connection-reset-by-peer\" title=\"dial tcp addrport i o timeout eof and connection reset by peer\">stackoverflow.com/questions/34093038/&hellip;</a>) then it&#39;s not the same code but it&#39;s similar. I will try to upload some code to give better insight."}], "owner": {"reputation": 71, "user_id": 5613532, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b7fcfda0f73fa7a2fc20924a755b7356?s=128&d=identicon&r=PG&f=1", "display_name": "Tesseract", "link": "https://stackoverflow.com/users/5613532/tesseract"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 128, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1449776685, "creation_date": 1449775258, "last_edit_date": 1592644375, "question_id": 34210017, "link": "https://stackoverflow.com/questions/34210017/performance-degradation-with-go-1-5", "title": "Performance degradation with Go 1.5", "body": "<p>For sometime now we have been thinking about switching to Go 1.5 for our production servers. Last time we tried, it was back when Go 1.5 was released but we saw major performance degradation with it so we decided to hold off on it. We decided to, once again, try Go 1.5 (1.5.2) and again, we saw the same performance degradation. Whenever we switch to Go 1.5, our timeouts increase significantly. The server handles around 30-40k requests/second with payload of around 2KB. The server basically unmarshals JSON payload -&gt; reorganize the data into another struct -&gt; marshals the data into JSON. The processing is pretty simple, but it's allocation heavy (requests + JSON un/marshalling). Here are the stats we saw when we deployed Go 1.5</p>\n<p><a href=\"https://i.stack.imgur.com/nIGcR.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/nIGcR.png\" alt=\"Number of requests\" /></a></p>\n<p><a href=\"https://i.stack.imgur.com/BsByc.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BsByc.png\" alt=\"Timeouts\" /></a></p>\n<p>EDIT: Both graph above represent average number of requests on the Y-Axis.</p>\n<p>Is there something we are doing wrong when switching to Go 1.5? Or is the performance degradation expected? Or are there some setting we need to tweak with Go 1.5?</p>\n"}, {"tags": ["security", "go", "hmac", "trello", "hmacsha1"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1449777862, "post_id": 34209823, "comment_id": 56165537, "body": "Do you have an example request and signature that we could match ?"}, {"owner": {"reputation": 117, "user_id": 4006407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d3KDU.jpg?s=128&g=1", "display_name": "doykle", "link": "https://stackoverflow.com/users/4006407/doykle"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1449807143, "post_id": 34209823, "comment_id": 56176479, "body": "Thanks for the interest! If I cannot get this working in the next day or two I will add all the information needed to test these functions. At the moment I am reluctant to create a new Trello account for the sole purpose of sharing the secret here."}], "answers": [{"comments": [{"owner": {"reputation": 117, "user_id": 4006407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d3KDU.jpg?s=128&g=1", "display_name": "doykle", "link": "https://stackoverflow.com/users/4006407/doykle"}, "edited": false, "score": 0, "creation_date": 1449806895, "post_id": 34215799, "comment_id": 56176415, "body": "I was trying to do something like this and was getting overflow errors, which is why <code>bitShift</code> is the way it is. This is much cleaner! Thanks! But I think they have the same output, right?"}, {"owner": {"reputation": 275, "user_id": 3205784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213012f39ccb8156f7058d4b2ef8880a?s=128&d=identicon&r=PG", "display_name": "mammothbane", "link": "https://stackoverflow.com/users/3205784/mammothbane"}, "reply_to_user": {"reputation": 117, "user_id": 4006407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d3KDU.jpg?s=128&g=1", "display_name": "doykle", "link": "https://stackoverflow.com/users/4006407/doykle"}, "edited": false, "score": 1, "creation_date": 1449807516, "post_id": 34215799, "comment_id": 56176572, "body": "On an en-dash, yes, because bit 7 (zero-indexed) is zero, but not for anything with that bit set. <code>bitShift</code> throws that bit out, but <code>ascii</code> preserves it. For instance, <code>bitShift(0b10001110)</code> yields <code>0b00001110</code>, where <code>ascii(0b10001110)</code> just gives you back the byte unchanged: <code>0b10001110</code>."}, {"owner": {"reputation": 275, "user_id": 3205784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213012f39ccb8156f7058d4b2ef8880a?s=128&d=identicon&r=PG", "display_name": "mammothbane", "link": "https://stackoverflow.com/users/3205784/mammothbane"}, "reply_to_user": {"reputation": 117, "user_id": 4006407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d3KDU.jpg?s=128&g=1", "display_name": "doykle", "link": "https://stackoverflow.com/users/4006407/doykle"}, "edited": false, "score": 0, "creation_date": 1449808637, "post_id": 34215799, "comment_id": 56176838, "body": "I&#39;m also pretty sure the reason <code>bitShift</code> is giving 63 there rather than 255 is the cast directly to <code>string</code> from <code>rune</code>, but I&#39;m not sure."}, {"owner": {"reputation": 117, "user_id": 4006407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d3KDU.jpg?s=128&g=1", "display_name": "doykle", "link": "https://stackoverflow.com/users/4006407/doykle"}, "edited": false, "score": 0, "creation_date": 1449819194, "post_id": 34215799, "comment_id": 56180656, "body": "Well, 0xff me. You&#39;re right. I had been looking at strings <a href=\"https://play.golang.org/p/BqLgsEDEdf\" rel=\"nofollow noreferrer\">cast as byte slices</a> because I was getting confused by the errors I got from other attempts.  I&#39;ll put this in!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 117, "user_id": 4006407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d3KDU.jpg?s=128&g=1", "display_name": "doykle", "link": "https://stackoverflow.com/users/4006407/doykle"}, "edited": false, "score": 0, "creation_date": 1449842466, "post_id": 34215799, "comment_id": 56194443, "body": "@doykle: note that this is only OK if you&#39;re guaranteed to not have any non-utf8 bytes in your data. When go transforms a string to runes, any invalid utf8 is converted to the unicode replacement character 0xfffd. <a href=\"http://play.golang.org/p/0gNumZzJ_V\" rel=\"nofollow noreferrer\">play.golang.org/p/0gNumZzJ_V</a> . I have no idea what the behavior of the node libraries would be in this case."}], "tags": [], "owner": {"reputation": 275, "user_id": 3205784, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/213012f39ccb8156f7058d4b2ef8880a?s=128&d=identicon&r=PG", "display_name": "mammothbane", "link": "https://stackoverflow.com/users/3205784/mammothbane"}, "is_accepted": true, "score": 2, "last_activity_date": 1449807947, "last_edit_date": 1449807947, "creation_date": 1449805755, "answer_id": 34215799, "question_id": 34209823, "link": "https://stackoverflow.com/questions/34209823/verifying-trello-webhook-signature/34215799#34215799", "title": "Verifying Trello Webhook signature", "body": "<p>Why are you throwing away the MSB? You're converting each <code>rune</code> to <code>byte</code>, which is signless (and actually an alias for <code>uint8</code>), so that bit holds information that you're losing. </p>\n\n<p>You might consider using a function like this instead:\n</p>\n\n<pre><code>func ascii(s string) []byte {\n    var ret []byte\n    for _, r := range s {\n        ret = append(ret, byte(r))\n    }\n    return ret\n}\n</code></pre>\n\n<p>Since <code>rune</code> is an alias for <code>int32</code>, the cast to <code>byte</code> just drops the top 24 bits, which is what you want.</p>\n\n<p>(Caveat: this assumes little-endianness.)</p>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 4006407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d3KDU.jpg?s=128&g=1", "display_name": "doykle", "link": "https://stackoverflow.com/users/4006407/doykle"}, "is_accepted": false, "score": 1, "last_activity_date": 1449822192, "last_edit_date": 1495542192, "creation_date": 1449821803, "answer_id": 34218892, "question_id": 34209823, "link": "https://stackoverflow.com/questions/34209823/verifying-trello-webhook-signature/34218892#34218892", "title": "Verifying Trello Webhook signature", "body": "<p>There were two problems with my code. The major issue was my use of <code>requestURL.String()</code> for the <code>callbackURL</code>. </p>\n\n<p>In the <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\">comments</a> above <code>http.Request.URL</code>: </p>\n\n<blockquote>\n  <p>For most requests, fields other than Path and RawQuery will be empty.</p>\n</blockquote>\n\n<p>It turned out that <code>requestURL.String()</code> was only giving the <code>[Path]</code> portion of <code>[Scheme]://[Host][Path]</code>. The correct callbackURL is </p>\n\n<pre><code>callbackURL := \"https://\" + request.Host + request.URL.String()\n</code></pre>\n\n<p>The second problem was pointed out in <a href=\"https://stackoverflow.com/a/34215799/4006407\">this answer</a>, where the verification would have failed for any request whose body contained 8th-bit-having characters. </p>\n"}], "owner": {"reputation": 117, "user_id": 4006407, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d3KDU.jpg?s=128&g=1", "display_name": "doykle", "link": "https://stackoverflow.com/users/4006407/doykle"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 501, "favorite_count": 0, "accepted_answer_id": 34215799, "answer_count": 2, "score": 4, "last_activity_date": 1449822192, "creation_date": 1449774627, "last_edit_date": 1449821897, "question_id": 34209823, "link": "https://stackoverflow.com/questions/34209823/verifying-trello-webhook-signature", "title": "Verifying Trello Webhook signature", "body": "\n\n<p>I am having trouble successfully verifying a webhook request from Trello. Here's what I know.</p>\n\n<p>Trello's webhook documentation <a href=\"https://developers.trello.com/apis/webhooks\" rel=\"nofollow\">here</a> states:</p>\n\n<blockquote>\n  <p>Each webhook trigger contains the HTTP header X-Trello-Webhook. The header is a base64 digest of an HMAC-SHA1 hash. The hashed content is the concatenation of the full request body and the callbackURL exactly as it was provided during webhook creation. The key used to sign this text is your application\u2019s secret.</p>\n</blockquote>\n\n<p>Which is understandable. They go on to say</p>\n\n<blockquote>\n  <p>Because of certain defaults in the crypto utilities in node, the payloads that we sign are treated as binary strings, not utf-8. For example, if you take the en-dash character (U+2013 or 8211 in decimal), and create a binary buffer out of it in Node, it will show up as a buffer of [19], which are the 8 least significant bits of 8211. That is the value that is being used in the digest to compute the SHA-1.</p>\n</blockquote>\n\n<p>This is less clear to me. My understanding is that each character of the payload (body + callbackURL) has been put into an 8-bit integer, with the overflow ignored. (Because 8211 == 0b10000000010011, and 0b00010011 == 19) This is where I think my problem is.</p>\n\n<p>The function I am using to accommodate Trello's node payload issue is:</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>func bitShift(s string) []byte {\n    var byteString []byte\n\n    // For each rune in the string\n    for _, c := range s {\n\n        // Create a byte slice\n        b := []byte(string(c))\n\n        // Take the sign off the least significant byte\n        tmp := b[len(b)-1] &lt;&lt; 1\n        tmp = tmp &gt;&gt; 1\n\n        // Append it to the byte string\n        byteString = append(byteString, tmp)\n    }\n    return byteString\n}\n</code></pre>\n\n<p>It is also very possible that I am doing something wrong with the basic verification step. It looks okay to me, though I am somewhat new to this.</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>// VerifyNotificationHeader ...\nfunc VerifyNotificationHeader(signedHeader, trelloAPISecret string, requestURL *url.URL, body []byte) bool {\n\n    // Put callbackURL and body into byte slice\n    urlBytes := bitShift(requestURL.String())\n    bitBody := bitShift(string(body))\n\n    // Sign, hash, and encode the payload\n    secret := []byte(trelloAPISecret)\n    keyHMAC := hmac.New(sha1.New, secret)\n    keyHMAC.Write(append(bitBody, urlBytes...))\n    signedHMAC := keyHMAC.Sum(nil)\n    base64signedHMAC := base64.StdEncoding.EncodeToString(signedHMAC)\n\n    if comp := strings.EqualFold(base64signedHMAC, signedHeader); !comp {\n        return false\n    }\n    return true\n}\n</code></pre>\n\n<p>Let me know if you need any more information. Thank you!</p>\n\n<p><strong>Update</strong>: This is solved, check out the answers.</p>\n"}]