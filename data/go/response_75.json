[{"tags": ["go"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 1, "creation_date": 1466057007, "post_id": 37847463, "comment_id": 63160921, "body": "the error message has told."}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1466086285, "post_id": 37853586, "comment_id": 63180584, "body": "I get &quot;undefined: Foo&quot;.   I understand the concept, but there must be a"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1466086467, "post_id": 37853586, "comment_id": 63180721, "body": "reason it does not work.  Using the reflection example worked fine and all i did was replace the reflection code with the type assertion code as you suggested.  Any clues -- Did you test your fix?  Why does it not see Foo?"}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1466086739, "post_id": 37853586, "comment_id": 63180953, "body": "@Godfather In your example Foo is inside a function, not visible outside. Try moving it out of the function. Then try reading Effective Go :)"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1466087027, "post_id": 37853586, "comment_id": 63181180, "body": "Thanks - Youthful naive goes on a short time - stupid goes on forever!"}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1466087230, "post_id": 37853586, "comment_id": 63181332, "body": "Question, since i need to do the type assertion inside the function since I am working from an interface value sent from outside the function, the only way for it to work is define Foo again inside function, not good coding practice.  So within the function the reflection method is really the only thing that will work - right!"}, {"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "reply_to_user": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1466087429, "post_id": 37853586, "comment_id": 63181485, "body": "@Godfather But you can define your Foo struct outside of any function. Then any function will be able to see it (any package really, since it&#39;s Capitalized)."}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1466087868, "post_id": 37853586, "comment_id": 63181775, "body": "You are right again -- I should read my own code - I thought I defined it"}], "tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": false, "score": 1, "last_activity_date": 1466093395, "last_edit_date": 1466093395, "creation_date": 1466065063, "answer_id": 37853586, "question_id": 37847463, "link": "https://stackoverflow.com/questions/37847463/how-to-get-chan-value-from-an-interface-and-use-it-in-reflect-select/37853586#37853586", "title": "How to get chan value from an interface and use it in reflect.Select(...)", "body": "<p>One way to do this is to not do reflection but do type assertion instead. So you could say:</p>\n\n<pre><code>val, ok := f.(Foo)\nif !ok {\n    fmt.Printf(\"Not Foo? Try Bar.\\n\")\n}\nsendCh := val.Ch\n</code></pre>\n\n<hr>\n\n<p>Alternatively, if you insist on using <code>reflect</code> (which is an inferior solution here) you could get what you want by dropping <code>Elem()</code>. For example:</p>\n\n<pre><code>val := reflect.ValueOf(f)\nvalueField := val.FieldByName(\"Ch\")\nsendCh := valueField.Interface()\n</code></pre>\n\n<p>Or even <code>val.Field(0)</code> if you don't want to use the name. Again, the type assertion method is better than this.</p>\n"}], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 962, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1466093395, "creation_date": 1466033311, "question_id": 37847463, "link": "https://stackoverflow.com/questions/37847463/how-to-get-chan-value-from-an-interface-and-use-it-in-reflect-select", "title": "How to get chan value from an interface and use it in reflect.Select(...)", "body": "<p>I took an example of reflect.Select from:\n <strong><a href=\"https://www.socketloop.com/references/golang-reflect-select-and-selectcase-function-example\" rel=\"nofollow\">https://www.socketloop.com/references/golang-reflect-select-and-selectcase-function-example</a></strong></p>\n\n<p>It works as far as it goes.  But it was creating the reflect.Value() from a simple\n\"chan\" := make(chan int) setup.  </p>\n\n<p>But I wanted to use a channel from a structure passed as an interface{}.</p>\n\n<p>So I modified the program to create a struct and pass it to the processing as\nan interface parameter.</p>\n\n<p>When run I get:  <strong>panic: reflect: call of reflect.Value.Elem on struct Valuepanic: reflect: call of reflect.Value.Elem on struct Value</strong></p>\n\n<p>This is strange because I the exact code another program that works!! </p>\n\n<pre><code>func inspect(f interface{}) map[string]string {\n\n    m := make(map[string]string)\n    val := reflect.ValueOf(f).Elem()\n\n    for i := 0; i &lt; val.NumField(); i++ {\n        valueField := val.Field(i)\n        typeField := val.Type().Field(i)\n        f := valueField.Interface()\n\n        val := reflect.ValueOf(f)\n        m[typeField.Name] = val.String()\n    }\n\n    return m\n}\n</code></pre>\n\n<p>Can any\nbody tell me where I am going wrong trying to use the interface code\nin replace of the simple variable version.</p>\n\n<p>The program is below with comments showing changes:</p>\n\n<pre><code>package main\n\n// Original Example from:\n// https://www.socketloop.com/references/golang-reflect-select-and-selectcase-function-example\n//\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n\n    // following replaces  \" var sendCh := make(chan int) \"\n    type Foo struct {\n        Ch chan int\n    }\n    sendCh := Foo{make(chan int)}\n    // End of replacement code\n\n    var increaseInt = func(c chan int) {\n        for i := 0; i &lt; 8; i++ {\n            c &lt;- i\n        }\n        close(c)\n    }\n\n    go increaseInt(sendCh.Ch)\n\n    // This routine call replaces the code incorporated in \"runJob\"\n    // It was done so I could call through an empty interface{}\n    runJob(sendCh)\n    // End replaement code--\n}\n\nfunc runJob(f interface{}) {\n    var selectCase = make([]reflect.SelectCase, 1)\n\n    // This code replaces just using the orginal \"sendCh\" value\n    // I am trying here to construct \"sendCh\" from the interface value\n    val := reflect.ValueOf(f).Elem()\n    valueField := val.Field(0)\n    sendCh := valueField.Interface()\n    // End of replacement code\n\n    selectCase[0].Dir = reflect.SelectRecv\n    selectCase[0].Chan = reflect.ValueOf(sendCh)\n\n    counter := 0\n    for counter &lt; 1 {\n        chosen, recv, recvOk := reflect.Select(selectCase) // &lt;--- here\n        if recvOk {\n            fmt.Println(chosen, recv.Int(), recvOk)\n\n        } else {\n            fmt.Println(\"Exit Condition Detected:  \", chosen, recv.Int(), recvOk)\n            counter++\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "sha256", "bitcoin", "blockchain", "mining"], "comments": [{"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466034970, "post_id": 37846548, "comment_id": 63155214, "body": "Sick project good luck. see also <a href=\"http://bitcoin.stackexchange.com/\">bitcoin.stackexchange.com</a> and <a href=\"https://github.com/bitcoin/bitcoin/search?utf8=%E2%9C%93&amp;q=previousblockhash\" rel=\"nofollow noreferrer\">github.com/bitcoin/bitcoin/&hellip;</a>"}, {"owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1466272453, "post_id": 37846548, "comment_id": 63253018, "body": "Thank you very much, those links are really useful!"}, {"owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 1, "creation_date": 1466601549, "post_id": 37846548, "comment_id": 63384251, "body": "I&#39;ve asked the same question over <a href=\"http://bitcoin.stackexchange.com/questions/46021/bitcoin-mining-block-structure/\">here</a> as indicated by mr. Plato and my issue has been solved. Hope this helps anyone who comes to this topic as well. Cheers!"}, {"owner": {"reputation": 287, "user_id": 2761187, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8f97ce6be14463596a12174d29c654f0?s=128&d=identicon&r=PG&f=1", "display_name": "skang404", "link": "https://stackoverflow.com/users/2761187/skang404"}, "edited": false, "score": 0, "creation_date": 1523379549, "post_id": 37846548, "comment_id": 86533290, "body": "<a href=\"https://github.com/btcsuite/btcd/blob/master/blockchain/blockindex.go\" rel=\"nofollow noreferrer\">github.com/btcsuite/btcd/blob/master/blockchain/blockindex.g&zwnj;&#8203;o</a>"}], "owner": {"reputation": 314, "user_id": 5565786, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/92X4d.jpg?s=128&g=1", "display_name": "G Oliveira", "link": "https://stackoverflow.com/users/5565786/g-oliveira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 803, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1466028086, "creation_date": 1466028086, "last_edit_date": 1592644375, "question_id": 37846548, "link": "https://stackoverflow.com/questions/37846548/bitcoin-mining-block-structure", "title": "Bitcoin mining: block structure", "body": "<p>Hello my dear friends,</p>\n<p>I am writing a program using GoLang to mine bitcoins. It's part of my college conclusion project and likely won't be used to mine bitcoins since it's not gonna be efficient enough running on regular PC's (facing a race against those huge chinese mining pools). Though it's not originally intended for real usage, my college expects nothing less than a flawless piece of software to mine real bitcoins (in parallel).</p>\n<p>So far, I have implemented quite an extensive code, therefore, you guys may assume I already have means to achieve:</p>\n<blockquote>\n<ol>\n<li>Get pending transactions to fill my block (from <a href=\"https://blockchain.info\" rel=\"nofollow noreferrer\">https://blockchain.info</a>)</li>\n<li>Build the merkle tree over the transactions data retrieved</li>\n<li>Calculate a sha256 of a given data input (I also understand the concepts behind such hash functions)</li>\n</ol>\n</blockquote>\n<p>I have organized my questions regarding this subject below:</p>\n<blockquote>\n<p>Question 1) I can't precisely tell how to build a block header which would be appended to the block chain. I know it has fields like the root of our merkle tree (which I already know how to calculate) or a version field, but if I was to produce a block header as an array of bytes, how would I do it ? I'd like to see <strong>how to calculate each field we need to build the header</strong> and <strong>how our byte array (representing the header) would look like</strong>.</p>\n<p>Any dummy data may be used for this example, my focus stays on understanding the process and the data structure.</p>\n<p>Please, note I have already read this: <a href=\"https://bitcoin.org/en/developer-reference#block-headers\" rel=\"nofollow noreferrer\">https://bitcoin.org/en/developer-reference#block-headers</a></p>\n</blockquote>\n<p>I have studied quite a lot regarding how the bitcoin protocol works to achieve the code I currently have, but I feel extremely limited on the information I can find online regarding the internal details of the bitcoin protocol:</p>\n<blockquote>\n<p>Question 2) Is there any online technical information you guys would consider useful for me to read regarding the headers subject and/or anything else in bitcoin? Keep in mid that I still have quite some code to write, therefore, I'm taking all the information I can get : )</p>\n</blockquote>\n<p>Thanks in advance!</p>\n"}, {"tags": ["go", "pprof"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466026761, "post_id": 37845201, "comment_id": 63152721, "body": "how are you invoking pprof?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466058802, "post_id": 37845201, "comment_id": 63161832, "body": "It&#39;s bound on a <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">github.com/gin-gonic/gin</a> router with <a href=\"https://github.com/DeanThompson/ginpprof\" rel=\"nofollow noreferrer\">github.com/DeanThompson/ginpprof</a>. It listens for 30s on  <code>go tool pprof https:&#47;&#47;url&#47;debug&#47;profile</code>."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1466062934, "post_id": 37845201, "comment_id": 63164311, "body": "@User2910293 I&#39;m not sure if we&#39;re on the same page, you need to create a go benchmark that uses the sessions library and then run <code>go test -bench=Session -cpuprofile=cpu.out</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1466084334, "post_id": 37845201, "comment_id": 63178980, "body": "@JohnSPerayil: there are other ways to create a profile"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466084606, "post_id": 37845201, "comment_id": 63179253, "body": "@User2910293: I haven&#39;t seen this error from a remote session, but do you have the same tooling versions, environment, and packages locally? Does the <code>top</code> command show a breakdown of the call times, even without source info? (also, pprof is a sampling profiler, you you need to ensure that the system is under sufficient load while sampling)"}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466186621, "post_id": 37845201, "comment_id": 63230173, "body": "@JimB Yes I know, I mentioned this method since OP wanted to look into the Get call of sessions specifically."}], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 148, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466022581, "creation_date": 1466022581, "question_id": 37845201, "link": "https://stackoverflow.com/questions/37845201/pprof-source-information-from-packages", "title": "pprof source information from packages", "body": "<p>When having open-source Go libraries their code local and running <code>pprof</code>, how could you actually ask <code>pprof</code> to inspect the source of those packages too?</p>\n\n<p>I want to look into the <code>Get</code> call of the <code>sessions</code> library, which then goes into Gorilla's <code>sessions</code>.</p>\n\n<p>This is, obviously, the output:</p>\n\n<pre><code>(pprof) list sessions\nTotal: 7.73s\nNo source information for github.com/gin-gonic/contrib/sessions.(*session).Get\nNo source information for github.com/gin-gonic/contrib/sessions.(*session).Session\nNo source information for github.com/gin-gonic/contrib/sessions.Sessions.func1\n(pprof)\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"comments": [{"owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1466022931, "post_id": 37845186, "comment_id": 63150864, "body": "It&#39;s a little more complicated than that since there can be nested differences. I&#39;ll go ahead and try to make my own then."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "edited": false, "score": 0, "creation_date": 1466024434, "post_id": 37845186, "comment_id": 63151646, "body": "@JoshWilson or you could just define a struct and then define a method for that struct that does a deep equals... Writing generic code for no reason is stupid and usually leads to poor quality. Beyond that since the actual json is apparently missing keys it would just fail at the point of unmarshalling."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1466022532, "creation_date": 1466022532, "answer_id": 37845186, "question_id": 37844810, "link": "https://stackoverflow.com/questions/37844810/go-test-difference-between-maps/37845186#37845186", "title": "Go test Difference between maps", "body": "<p>There's not an existing function, it's like 5 lines of code.</p>\n\n<pre><code>diff := &amp;[]string{} // initialize some storage for the diff\n\nfor _, k := range map1 { // range over one of the maps\n    if _, ok := map2[k]; !ok { // check if the key from the first map exists in the second\n        diff = append(diff, k)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466022532, "creation_date": 1466021275, "question_id": 37844810, "link": "https://stackoverflow.com/questions/37844810/go-test-difference-between-maps", "title": "Go test Difference between maps", "body": "<p>I'm trying to run some tests on json objects. Currently I have a function to compare the json string and output an error message if they don't match:</p>\n\n<pre><code>func assertJsonEqual(expected, actual string) bool {\n    actualStruct := make(map[string]interface{})\n    expectedStruct := make(map[string]interface{})\n\n    json.Unmarshal([]byte(expected), &amp;expectedStruct)\n    json.Unmarshal([]byte(actual), &amp;actualStruct)\n\n    if !reflect.DeepEqual(expectedStruct, actualStruct) {\n        log.Errorf(\"Expected: %#v\\n but got %#v\", expectedStruct, actualStruct)\n        return false\n    }\n    return true\n}\n</code></pre>\n\n<p>The problem is this makes it really hard to see exactly which key is missing or extra in the actual tool. I'm thinking about building a simple diff of the map keys, but am wondering if there is an existing library that already does this?</p>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466019224, "post_id": 37844133, "comment_id": 63148912, "body": "You can&#39;t set environment variables for another process. A process inherits its environment from its parent, and can only set its own variables."}, {"owner": {"reputation": 1, "user_id": 2782484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/211d016a06846a2939cbbd4e7eab6756?s=128&d=identicon&r=PG&f=1", "display_name": "BJR", "link": "https://stackoverflow.com/users/2782484/bjr"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466021129, "post_id": 37844133, "comment_id": 63149945, "body": "Is my title too limited? It seems like this question is answered and I should create a new question."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1466034807, "post_id": 37844133, "comment_id": 63155174, "body": "take a look at <a href=\"https://github.com/coreos/etcd\" rel=\"nofollow noreferrer\">github.com/coreos/etcd</a> it may be too heavyweight for your requirements"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 2782484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/211d016a06846a2939cbbd4e7eab6756?s=128&d=identicon&r=PG&f=1", "display_name": "BJR", "link": "https://stackoverflow.com/users/2782484/bjr"}, "edited": false, "score": 0, "creation_date": 1466022760, "post_id": 37845126, "comment_id": 63150784, "body": "just want to add <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/6zhuuYpCg8Y\" rel=\"nofollow noreferrer\">info</a> about the location for the config file."}], "tags": [], "owner": {"reputation": 5164, "user_id": 1461269, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/f5507a725df760d1a9b0dd88505f8bd1?s=128&d=identicon&r=PG", "display_name": "arjabbar", "link": "https://stackoverflow.com/users/1461269/arjabbar"}, "is_accepted": true, "score": 0, "last_activity_date": 1466022300, "creation_date": 1466022300, "answer_id": 37845126, "question_id": 37844133, "link": "https://stackoverflow.com/questions/37844133/passing-configuration-values-between-multiple-golang-programs/37845126#37845126", "title": "Passing configuration values between multiple Golang programs", "body": "<p>If you just want to share configuration that might change at runtime, then having a shared configuration file that is read in either periodically or whenever a change occurs. There are some mechanisms that you can use to notify you when a file changes, but those may be OS dependent.</p>\n\n<p>Another option is to use some form of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa365574(v=vs.85).aspx\" rel=\"nofollow\">inter-process communication</a> but that may be a bit much if all you want to do is share some config variables.</p>\n"}], "owner": {"reputation": 1, "user_id": 2782484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/211d016a06846a2939cbbd4e7eab6756?s=128&d=identicon&r=PG&f=1", "display_name": "BJR", "link": "https://stackoverflow.com/users/2782484/bjr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 721, "favorite_count": 0, "accepted_answer_id": 37845126, "answer_count": 1, "score": -2, "last_activity_date": 1466031816, "creation_date": 1466018765, "last_edit_date": 1466031816, "question_id": 37844133, "link": "https://stackoverflow.com/questions/37844133/passing-configuration-values-between-multiple-golang-programs", "title": "Passing configuration values between multiple Golang programs", "body": "<p>I am interested in passing configuration values between multiple golang programs.  </p>\n\n<p>I have experimented with environment variables but they cannot be read by a different program than the one that set them. </p>\n\n<p>I have tested and I am certain that the environment variable is being set and can be read in the same process that set it. Also, if I call the second process through the first it will print it:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)    \n\nfunc main() {\n    os.Setenv(\"AVARIABLE\", \"12345\")\n\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Enter text: \")\n    _, _ = reader.ReadString('\\n')\n    fmt.Println(\"exiting\")\n}              \n</code></pre>\n\n<p>and </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    fmt.Println(os.Getenv(\"AVARIABLE\"))\n}\n</code></pre>\n\n<p>The environment variable context is too narrow for my purpose.</p>\n\n<p>I am considering these options: </p>\n\n<ol>\n<li><p>Create a file at <code>/etc/profile.d/&lt;filename&gt;.sh</code> and run <code>source /etc/profile.d/&lt;filename&gt;.sh</code> in order to set the variable more globally. </p></li>\n<li><p>Create a file somewhere which anybody can read and avoid the environment variable issue. </p></li>\n</ol>\n\n<p>Are there better ways? how should I proceed?</p>\n"}, {"tags": ["go", "cgo", "vendor"], "answers": [{"tags": [], "owner": {"reputation": 9, "user_id": 6471172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bc2223544f19e99c6461f657548335b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Yutzler", "link": "https://stackoverflow.com/users/6471172/jeff-yutzler"}, "is_accepted": false, "score": -1, "last_activity_date": 1468937438, "creation_date": 1468937438, "answer_id": 38460964, "question_id": 37843920, "link": "https://stackoverflow.com/questions/37843920/how-do-you-vendor-a-go-library-with-a-cgo-binding/38460964#38460964", "title": "How do you vendor a Go library with a Cgo binding?", "body": "<p>I got the following feedback offline:</p>\n\n<blockquote>\n  <p>The low-level C dependencies, like the cgo binding mentioned in the stack overflow are super tricky, and are difficult to vendor as you can imagine. This is why in the past I've simply either bypassed the vendoring requirement by building my go binary (linux target) on a local or CI box and pushing using the binary buildpack or I've built a Docker image with my application's binary in it.</p>\n</blockquote>\n\n<p>In other words, don't do what I was suggesting. Just build it the old fashioned way.</p>\n"}], "owner": {"reputation": 9, "user_id": 6471172, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bc2223544f19e99c6461f657548335b?s=128&d=identicon&r=PG&f=1", "display_name": "Jeff Yutzler", "link": "https://stackoverflow.com/users/6471172/jeff-yutzler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 520, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1468937438, "creation_date": 1466017960, "question_id": 37843920, "link": "https://stackoverflow.com/questions/37843920/how-do-you-vendor-a-go-library-with-a-cgo-binding", "title": "How do you vendor a Go library with a Cgo binding?", "body": "<p>I have a Go 1.5 application that binds with a C library (GEOS, FWIW) using cgo. What I need to do is vendor it so that it can ultimately be deployed through our continuous integration system. The problem is that I don't know how to convince the linker to link with the library once it is vendored. After running <code>godep</code>, the file with the cgo directive is <code>.../vendor/.../geos.go</code>.  I created a lib directory there, added in the five .so files from GEOS, and changed the preamble to the following:</p>\n\n<pre><code>/*\n#cgo LDFLAGS: -L${SRCDIR}/lib -lgeos_c\n#include \"geos.h\"\n*/\nimport \"C\"\n</code></pre>\n\n<p>This only works to a point - when I run <code>go build</code> it finds the first library but not any of the successive libraries. </p>\n\n<blockquote>\n  <p>/usr/bin/ld: warning: libgeos-3.4.2.so, needed by vendor/github.com/paulsmith/gogeos/geos/lib/libgeos_c.so, not found (try using -rpath or -rpath-link)</p>\n</blockquote>\n\n<p>How do I get the entire thing to link properly?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1466009608, "post_id": 37840981, "comment_id": 63143587, "body": "There isn&#39;t a need for all types to be exported. It is not a convention. Upper vs low case on the names of identifiers in a package is chosen for functional reasons."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466010877, "post_id": 37840981, "comment_id": 63144296, "body": "Some people write their main package types with Uppercase, and some don&#39;t. If the type doesn&#39;t need to be exported, then there is no other reason."}, {"owner": {"reputation": 401, "user_id": 3841164, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3bd18c9b6f5c168eee19575431053ccc?s=128&d=identicon&r=PG", "display_name": "avertocle", "link": "https://stackoverflow.com/users/3841164/avertocle"}, "edited": false, "score": 1, "creation_date": 1536579937, "post_id": 37840981, "comment_id": 91461285, "body": "side point : as types starting with small case are private, go-doc is not able to generate documentation for them."}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 3, "last_activity_date": 1466009388, "last_edit_date": 1466009388, "creation_date": 1466008665, "answer_id": 37841100, "question_id": 37840981, "link": "https://stackoverflow.com/questions/37840981/in-go-is-it-convention-to-capitalize-type-names/37841100#37841100", "title": "In Go, is it convention to capitalize type names?", "body": "<p>Types can be private.</p>\n\n<p>Having a public function returning a private type however does not work. As long as the type is only used package internally, I keep it private.</p>\n\n<p>EDIT:\nIn your example, Server has to be public because it is returned by public functions and thus used outside the package. The function NewServer returns *Server.</p>\n\n<p>EDIT for new example:</p>\n\n<p>In the new example this is the main package. It can't be imported anyway.</p>\n"}, {"comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1466009098, "post_id": 37841120, "comment_id": 63143299, "body": "actually in the example Server has an exported function and it is also returned by the exported function NewServer. It has to be exported."}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 1, "creation_date": 1466009239, "post_id": 37841120, "comment_id": 63143378, "body": "@TehSphinX The <code>Server</code> type implements <code>http.Handler</code>, so it is possible to hide it behind the <code>http.Handler</code> interface."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1466009445, "post_id": 37841120, "comment_id": 63143478, "body": "yes, you are right. But wouldn&#39;t NewServer have to return http.Handler then if we wanted to unexport the Server variable?"}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": false, "score": 8, "last_activity_date": 1466009632, "last_edit_date": 1466009632, "creation_date": 1466008723, "answer_id": 37841120, "question_id": 37840981, "link": "https://stackoverflow.com/questions/37840981/in-go-is-it-convention-to-capitalize-type-names/37841120#37841120", "title": "In Go, is it convention to capitalize type names?", "body": "<p>The type starting with an uppercase letter are exported to other packages. Those starting with a lowercase letter can be used only inside the package. Important note: it is possible to export an interface without exporting the struct that implements it.</p>\n\n<p>It is not a convention to export types. Only export them if you allow them to be used outside the package. In the example you provided, there was no need to export the <code>Server</code> type, because it has no exported field or methods.</p>\n\n<p>Export only the types that are part of the contract with the client. Exporting types that are only used internally is a mistake and is confusing in the documentation.</p>\n\n<p>Edit:</p>\n\n<p>A little clarification about the <code>Server</code> type. It implements the <code>http.Handler</code> interface (must define <code>ServeHTTP(http.ResponseWriter, *http.Request)</code> ), so it is possible to make it not exported and use the interface as the return type of <code>NewServer</code> function.</p>\n"}, {"comments": [{"owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "edited": false, "score": 0, "creation_date": 1466008924, "post_id": 37841125, "comment_id": 63143214, "body": "I know that it makes them exported, I actually wrote it in my question (now twice). I want to know why all those example export their types."}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 0, "last_activity_date": 1466008744, "creation_date": 1466008744, "answer_id": 37841125, "question_id": 37840981, "link": "https://stackoverflow.com/questions/37840981/in-go-is-it-convention-to-capitalize-type-names/37841125#37841125", "title": "In Go, is it convention to capitalize type names?", "body": "<p>It's not a matter of convention, Go actually uses capitalization to determine which things are exported, i.e. available when you import the package.</p>\n\n<p>E.g. if I have:</p>\n\n<pre><code>package a\n\nconst Exported = \"hi\"\nconst nonExported = \"mom\"\n</code></pre>\n\n<p>Then in a different package, you can import <code>a.Exported</code> but not <code>a.nonExported</code>:</p>\n\n<pre><code>package main\n\nimport \"PATH/a\"\n\nfunc main() {\n  println(a.Exported)\n  // this won't compile\n  // println(a.nonExported)\n}\n</code></pre>\n"}], "owner": {"reputation": 27770, "user_id": 476074, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/3ad32697402bb21379768728e8640a22?s=128&d=identicon&r=PG", "display_name": "AndreKR", "link": "https://stackoverflow.com/users/476074/andrekr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3245, "favorite_count": 1, "accepted_answer_id": 37841100, "answer_count": 3, "score": 6, "last_activity_date": 1466009632, "creation_date": 1466008312, "last_edit_date": 1466009202, "question_id": 37840981, "link": "https://stackoverflow.com/questions/37840981/in-go-is-it-convention-to-capitalize-type-names", "title": "In Go, is it convention to capitalize type names?", "body": "<p>In most Go programs I have seen, even those that have just one package, the names of types are written with a capital letter, which makes them exported. (Example)</p>\n\n<p>Is this just a convention to make clear that they are types or is there a need for all types to be exported?</p>\n\n<p>Here are some examples:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/example/blob/master/outyet/main.go#L60\" rel=\"noreferrer\">outyet</a><br>\n(This one I added by mistake: <code>NewServer()</code> returns a <code>Server</code>, so it needs to be exported.) </li>\n<li><a href=\"https://github.com/golang/example/blob/master/template/main.go#L44\" rel=\"noreferrer\">template</a></li>\n</ul>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1466001611, "post_id": 37838429, "comment_id": 63138102, "body": "I&#39;m not sure I understand what the maps have to do with comparing interfaces. Are you asking how those maps are compared to each other, how the interfaces are hashed in the map compared to a string, or how 2 interfaces are compared directly?"}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466002034, "post_id": 37838429, "comment_id": 63138442, "body": "@JimB I have updated the question. I am asking about how hashes are evaluated in the two scenarios."}, {"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "edited": false, "score": 1, "creation_date": 1466003113, "post_id": 37838429, "comment_id": 63139206, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/34245932/golang-checking-equality-of-interface\">Golang - Checking equality of interface{}</a>"}], "answers": [{"comments": [{"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "edited": false, "score": 0, "creation_date": 1466003213, "post_id": 37839072, "comment_id": 63139281, "body": "I updated the 1st scenario of question. What would happen in that case."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "edited": false, "score": 0, "creation_date": 1466004095, "post_id": 37839072, "comment_id": 63139927, "body": "@Prateek: that&#39;s invalid, because an <code>interface{}</code> is not assignable to a <code>string</code>."}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "edited": false, "score": 0, "creation_date": 1466005015, "post_id": 37839072, "comment_id": 63140600, "body": "Yeah... Without type assertion it will give a compile error."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1466002866, "creation_date": 1466002866, "answer_id": 37839072, "question_id": 37838429, "link": "https://stackoverflow.com/questions/37838429/how-are-two-interfaces-matched-in-golang/37839072#37839072", "title": "How are two interfaces matched in golang", "body": "<p>Go interfaces are a 2 word value, and are compared as such. From the <a href=\"https://golang.org/ref/spec\" rel=\"nofollow\">Language Specification</a> section on <a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow\">Comparison Operators</a>:</p>\n\n<ul>\n<li>Interface values are comparable. Two interface values are equal if they have identical dynamic types and equal dynamic values or if both have value nil.</li>\n<li>A value x of non-interface type X and a value t of interface type T are comparable when values of type X are comparable and X implements T. They are equal if t's dynamic type is identical to X and t's dynamic value is equal to x.</li>\n</ul>\n\n<p>Only the first point is relevant in the case of the <code>map[interface{}]T</code>, since the key is always converted to an <code>interface{}</code> for comparison. </p>\n"}], "owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 623, "favorite_count": 0, "accepted_answer_id": 37839072, "answer_count": 1, "score": -1, "last_activity_date": 1466003153, "creation_date": 1466001211, "last_edit_date": 1466003153, "question_id": 37838429, "link": "https://stackoverflow.com/questions/37838429/how-are-two-interfaces-matched-in-golang", "title": "How are two interfaces matched in golang", "body": "<p>How are interface{} values compared if I have a type of <code>map[interface{}]interface{}</code> and I have another map which has map[string]interface{}.</p>\n\n<p>How are the hashes evaluated if I have a \n<code>m := make(map[string]interface{})</code> and I execute <code>m[m[\"key\"]]</code> i.e. I am passing an interface{} value for a map with string as key.</p>\n\n<p>And vice versa case, that is : \n<code>m1 := make(map[interface{}]interface{})</code> and I execute <code>m1[m[\"key\"]]</code></p>\n"}, {"tags": ["eclipse", "go", "goclipse"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465996526, "post_id": 37836141, "comment_id": 63134177, "body": "Don&#39;t set GOROOT. And GOPATH should be  <code>D:\\eclipseGo\\workspace</code>, with the <code>src</code> directory inside GOPATH. See <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>"}, {"owner": {"reputation": 618, "user_id": 3953199, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/609f40c9cb71f8007eeee7feb6b4850b?s=128&d=identicon&r=PG&f=1", "display_name": "KJaeg", "link": "https://stackoverflow.com/users/3953199/kjaeg"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1466067847, "post_id": 37836141, "comment_id": 63167445, "body": "I didn&#39;t set GOROOT, it was set during the Go installation manually. After installing Goclipse, this was also detected automatically. After I created a Go-project, the GOROOT inside of the project was automatically fetched. If I type in <code>%GOPATH%</code> into the console, it is showing me <code>D:\\eclipseGo\\workspace</code>. In the Preferences under &quot;Go&quot; it is set to use the same value as the GOPATH environment variable, which also is displayed as <code>D:\\eclipseGo\\workspace</code>. I don&#39;t know why the picture is showing the <code>src</code>at the end of the GOPATH."}, {"owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "edited": false, "score": 0, "creation_date": 1466193898, "post_id": 37836141, "comment_id": 63233617, "body": "The <code>src</code> bit is added just for display purposes in the Project Explorer (yes, that is perhaps confusing). Also note, if you make changes to the GOPATH, the Project Explorer is not updated unless you press refresh (F5). This is a bug/limitation."}], "answers": [{"tags": [], "owner": {"reputation": 1357, "user_id": 393898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/89b55a355cb66fff949fe85c45ea4897?s=128&d=identicon&r=PG", "display_name": "BrunoMedeiros", "link": "https://stackoverflow.com/users/393898/brunomedeiros"}, "is_accepted": false, "score": 0, "last_activity_date": 1466194210, "creation_date": 1466194210, "answer_id": 37889655, "question_id": 37836141, "link": "https://stackoverflow.com/questions/37836141/wrong-configuration-of-goclipse-in-eclipse/37889655#37889655", "title": "Wrong configuration of Goclipse in Eclipse", "body": "<p>Your project setup seems to indicate MyProject is not contained inside <code>D:\\eclipseGo\\workspace</code>, so you either need to move your project to a folder inside <code>D:\\eclipseGo\\workspace\\src</code>, or alternatively enable the option \"Also add project location to GOPATH, if it's not contained there already.\" in the project's GOPATH settings (note that this can be configurate globally or per-project).</p>\n\n<p>The Project Explorer display above is misleading because the folder icons  seem to indicate MyProject/src is a \"source folder\" and the files it contains are part of the GOPATH, when they are in fact not. <strong>I'm making a note to have this fixed in the next release, as well as the refresh bug.</strong></p>\n"}], "owner": {"reputation": 618, "user_id": 3953199, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/609f40c9cb71f8007eeee7feb6b4850b?s=128&d=identicon&r=PG&f=1", "display_name": "KJaeg", "link": "https://stackoverflow.com/users/3953199/kjaeg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 793, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1466194210, "creation_date": 1465995453, "question_id": 37836141, "link": "https://stackoverflow.com/questions/37836141/wrong-configuration-of-goclipse-in-eclipse", "title": "Wrong configuration of Goclipse in Eclipse", "body": "<p>Everytime, when I try to run my Hello-world-program, I get an error message from Eclipse saying \"Resource doesnt have a corresponding Go package.\" There is already a post about the same error message, but the provided solutions didn't help me.</p>\n\n<p>The installation set the GOROOT automatically to \"C:\\Go\\src\"\nFor my workspace I created a directory \"D:\\eclipseGo\\workspace\", and assigned it to my GOPATH variable.</p>\n\n<p>Following picture shows my setup from the project explorer</p>\n\n<p><a href=\"https://i.stack.imgur.com/n2FmI.jpg\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/n2FmI.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>As you can see, the GOPATH there points to the src-folder.</p>\n\n<p>In the preferences (under \"Go\"), the GOROOT was set automatically.\nUnter Go-Tools I picked the path of the gocode.exe with the \"Browse...\"-button, and selected the gocode.exe, which was at \"D:\\eclipseGo\\workspace\\bin\\gocode.exe\". Below, the gofmt was set automatically.</p>\n\n<p>That's all what I configured. Does anyone know, where the problem is?</p>\n"}, {"tags": ["json", "pointers", "methods", "go", "struct"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1465995881, "post_id": 37836100, "comment_id": 63133712, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/34760950/assigned-pointer-field-becomes-nil\">Assigned pointer field becomes &lt;nil&gt;</a>. Using <code>for _, i := range</code> the loop variable is a copy of the slice element, and you modify the copy, not the element in the slice. Use <code>for i:= range</code> and refer to <code>params.Parameters[i]</code>."}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1465996169, "post_id": 37836100, "comment_id": 63133915, "body": "Thank you @icza for pointing to a similar question, but I tried that as well, as <code>script := string(reader); &amp;i.Script = &amp;script</code>, which threw an error saying <code>cannot assign to &amp;i.Script</code> and nothing else."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1465996248, "post_id": 37836100, "comment_id": 63133977, "body": "Refresh the page, I edited my first comment."}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1465996515, "post_id": 37836100, "comment_id": 63134168, "body": "Thank you @icza, Checking that."}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1465996913, "post_id": 37836100, "comment_id": 63134483, "body": "Thank you @icza, that worked. If you can post it as an answer, I can accept and mark it as solved."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1466000309, "last_edit_date": 1466000309, "creation_date": 1465997253, "answer_id": 37836860, "question_id": 37836100, "link": "https://stackoverflow.com/questions/37836100/editing-a-struct-list-variable-using-pointer-not-working-as-expected-in-go/37836860#37836860", "title": "Editing a struct list variable using pointer not working as expected in go", "body": "<p>The problem is that you are using a <code>for _, i := range</code> loop, and you modify the loop variable inside the loop:</p>\n\n<pre><code>for _, i := range params.Parameters {\n    switch i.Attached {\n    case false:\n        // ...\n        i.SetScript(string(reader))\n    }\n}\n</code></pre>\n\n<p>The loop variable <code>i</code> is a <em>copy</em> of the slice elements you range over. So if you do any modification to it, you will only modify the <em>copy</em> and not the element in the slice. (Note that it's true that the <code>SetScript()</code> method has a pointer receiver, but it will receive the address of the <em>copy</em>, so it can and will modify only the copy.)</p>\n\n<p>One workaround is use an index-only <code>range</code>, and refer to the slice element using indexing (replace all occurrence of <code>i</code> with <code>params.Parameters[i]</code>):</p>\n\n<pre><code>for i := range params.Parameters {\n    switch params.Parameters[i].Attached {\n    case false:\n        // ...\n        params.Parameters[i].SetScript(string(reader))\n    }\n}\n</code></pre>\n\n<p>You can simplify the above code by assigning the slice to a local variable (this will copy only the slice header not its elements, and it will refer to the same underlying array), and use <code>if</code> statement instead of that ugly <code>switch</code>:</p>\n\n<pre><code>p := params.Parameters\nfor i := range p {\n    if !p[i].Attached {\n        // ...\n        p[i].SetScript(string(reader))\n    }\n}\n</code></pre>\n\n<p>An alternative simplification / improvement is to take the address of the index expression, and use that (so you can omit repeating it multiple times):</p>\n\n<pre><code>for i := range params.Parameters {\n    p := &amp;params.Parameters[i]\n    if !p.Attached {\n        // ...\n        p.SetScript(string(reader))\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "accepted_answer_id": 37836860, "answer_count": 1, "score": 5, "last_activity_date": 1466000309, "creation_date": 1465995318, "question_id": 37836100, "link": "https://stackoverflow.com/questions/37836100/editing-a-struct-list-variable-using-pointer-not-working-as-expected-in-go", "title": "Editing a struct list variable using pointer not working as expected in go", "body": "<p>I have a struct that looks like</p>\n\n<pre><code>type Request struct {\n    Name string `json:\"name\"`\n    Parameters []Parameter `json:\"parameters\"`\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type Parameter struct {\n    Attached bool `json:\"attached\"`\n    Script string `json:\"script\"`\n}\n</code></pre>\n\n<p>Now, I have unmarshalled the json into the struct, and the Script variable has an http location \"<a href=\"http://localhost/helloworld.sh\">http://localhost/helloworld.sh</a>\". What I am trying to do is, to change the struct variable <code>Parameter.Script</code> from <code>http://localhost/helloworld.sh</code> with the actual content of the script, which is a plain ascii shell script. I wrote a method for the inner struct like</p>\n\n<pre><code>func (p *Parameter) SetScript(script string)  {\n    p.Script = script\n}\n</code></pre>\n\n<p>using pointer to <code>Parameter</code>, </p>\n\n<p>and in the <code>GetScript</code> function, try to call that method after getting the response body.</p>\n\n<pre><code>func GetScript(params *Request)  {\n  for _, i := range params.Parameters {\n    switch i.Attached {\n    case false:\n        client := new(http.Client)\n        req, _ := http.NewRequest(\"GET\", i.Script, nil)\n        resp, _ := client.Do(req)\n        defer resp.Body.Close()\n        reader, _ := ioutil.ReadAll(resp.Body)\n        i.SetScript(string(reader))\n    }\n  }\n}\n</code></pre>\n\n<p>However, when I print the struct after calling this function, it has not modified the variables, and prints the <code>http://localhost/helloworld.sh</code> only.\nI am able to get the response body, which is the actual content of the script, but I am not able to replace the struct variable from within the <code>GetScript</code> function.\nCould someone please point out the right way to do this?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "timer", "triggers", "cron"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465994346, "post_id": 37835492, "comment_id": 63132536, "body": "see: <a href=\"https://golang.org/doc/faq#closures_and_goroutines\" rel=\"nofollow noreferrer\">golang.org/doc/faq#closures_and_goroutines</a>"}, {"owner": {"reputation": 31, "user_id": 2185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1838771f995d549852ba43eef6b834ca?s=128&d=identicon&r=PG", "display_name": "Alexander Rickardsson", "link": "https://stackoverflow.com/users/2185968/alexander-rickardsson"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465996509, "post_id": 37835492, "comment_id": 63134162, "body": "@JimB Thanks! That solved it for me"}], "owner": {"reputation": 31, "user_id": 2185968, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1838771f995d549852ba43eef6b834ca?s=128&d=identicon&r=PG", "display_name": "Alexander Rickardsson", "link": "https://stackoverflow.com/users/2185968/alexander-rickardsson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 54, "favorite_count": 0, "closed_date": 1465996593, "answer_count": 0, "score": 0, "last_activity_date": 1465998865, "creation_date": 1465993782, "last_edit_date": 1465998865, "question_id": 37835492, "link": "https://stackoverflow.com/questions/37835492/golang-execute-functions-at-specific-times", "closed_reason": "Duplicate", "title": "Golang execute functions at specific times", "body": "<p>I am having some problems figuring out how to implement a cron-like feature in my program.</p>\n\n<p>I have been trying <a href=\"https://godoc.org/github.com/robfig/cron\" rel=\"nofollow\">https://godoc.org/github.com/robfig/cron</a> with some success, but can't fully figure it out.</p>\n\n<p>My code current look like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/robfig/cron\"\n)\n\nfunc first() {\n    c := cron.New()\n    c.AddFunc(\"@every 5s\", func() {fmt.Println(\"First\", 1) })\n    c.AddFunc(\"@every 5s\", func() {fmt.Println(\"First\", 2) })\n    c.Start()\n}\n\nfunc second() {\n    c := cron.New()\n    for i := 1; i&lt;=2; i++ {\n        c.AddFunc(\"@every 5s\", func() {fmt.Println(\"Second\", i) })\n    }\n    c.Start()\n}\n\nfunc main() {\n    first()\n    second()\n}\n</code></pre>\n\n<p>The first() function works like I expect it to. Every five seconds, I get two rows; one saying \"First 1\", and the other \"First 2\".</p>\n\n<p>The second() function however is what is causing me problems.\nI expected similar behavior, but instead every 5 seconds, I get two rows saying \"Second 3\".</p>\n\n<p>Anyone able to explain what I am doing wrong here?</p>\n"}, {"tags": ["c++", "go", "cgo"], "comments": [{"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 1, "creation_date": 1465994261, "post_id": 37835316, "comment_id": 63132458, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/1713214/how-to-use-c-in-go\">How to use C++ in Go?</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1465994525, "post_id": 37835316, "comment_id": 63132681, "body": "Go can&#39;t link directly against C++. You either use a C interface and cgo, or use swig to create one."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1466029002, "post_id": 37835316, "comment_id": 63153544, "body": "To the things in the &quot;Hard questions&quot; section, no, I don&#39;t think there&#39;s a way exposed for C to return a <code>map[int]map[int]int</code> or <code>interface{}</code>. You might make some kind of struct on the C side and then have a Go wrapper marshal it to/from Go types, or possibly provide a Go type that wraps calls manipulating a complicated C type (but cgo call overhead may make that inadvisable)."}], "owner": {"reputation": 2549, "user_id": 749515, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/fdf40887bfac87aba430eec018cc0d2a?s=128&d=identicon&r=PG", "display_name": "pavelkolodin", "link": "https://stackoverflow.com/users/749515/pavelkolodin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 654, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1466159927, "creation_date": 1465993264, "last_edit_date": 1466159927, "question_id": 37835316, "link": "https://stackoverflow.com/questions/37835316/how-to-write-a-golang-package-using-c", "title": "How to write a golang package using C++?", "body": "<p>What tools exists today for implementing the golang package in C++? I want this to work:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"zuzu\" // my package\n}\n\nv := zuzu.Func(1,2,3)\n</code></pre>\n\n<p>and the <code>zuzu.Func()</code> must be written in C++ as following:</p>\n\n<pre><code>// C++ code:\nint Func(int a, int b, int c) {\n    return a + b + c;\n}\n</code></pre>\n\n<p>Should I use the cgo ( <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow\">https://golang.org/cmd/cgo/</a> ) to achieve this? As I understand, I must create a .go file which provides the declarations of the Func() and uses <code>cgo</code> syntax to link against my <code>.cpp / .h</code> files with the actual implementation?</p>\n\n<p><strong>Hard questions</strong></p>\n\n<p>Can the C++ function construct and return a non-trivial Go variables, for example the <code>map[int]map[int]int</code>?</p>\n\n<p>Can the C++ function return a value of a variable type? Pseudo-CPP-code:</p>\n\n<pre><code>// C++ code\n// This function may return map[float32] or int.\nMIXED_RETURN_TYPE cpp_func(int x) {\n    if ( 1 == x  ) {\n        return MAP_OF_FLOATS; // go type: map[float32]\n    } else {\n        return 2;             // go type: int\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "http-headers"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1465996221, "last_edit_date": 1465996221, "creation_date": 1465995118, "answer_id": 37836031, "question_id": 37835184, "link": "https://stackoverflow.com/questions/37835184/set-static-headers-avoid-allocation/37836031#37836031", "title": "Set static headers, avoid allocation?", "body": "<p>You <em>could</em> hijack the connection, and write the headers directly, but that's only going to save you half the header allocations since the incoming request is still going to allocate a map and strings to fill in the Request struct. It also means that you would need to handle the raw TCP connection yourself from that point forward.</p>\n\n<p>You should profile thoroughly to ensure that the header allocations are actually a bottleneck for your application. There's a lot more overhead to an http request than just the headers.</p>\n\n<p>You can also try alternative http stacks, like <code>github.com/valyala/fasthttp</code>, which strive to minimize allocations. </p>\n"}], "owner": {"reputation": 631, "user_id": 155734, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6bed507c0085d39447171b95c515a890?s=128&d=identicon&r=PG", "display_name": "dvdplm", "link": "https://stackoverflow.com/users/155734/dvdplm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 37836031, "answer_count": 1, "score": 2, "last_activity_date": 1465996221, "creation_date": 1465992896, "question_id": 37835184, "link": "https://stackoverflow.com/questions/37835184/set-static-headers-avoid-allocation", "title": "Set static headers, avoid allocation?", "body": "<p>I am trying to write a Go http handler which is performance sensitive (in particular I want to minimize the amount of RAM used). The handler sets a bunch of headers for each request. All headers are always the same and with the same values.\nIs there a way to use a single <code>const</code> for all headers and set them all in a single call?</p>\n\n<p>Example. Instead of doing this for all requests:</p>\n\n<pre><code>w.Header().Set(\"Access-Control-Allow-Origin\", \"*\")\nw.Header().Set(\"Cache-Control\", \"no-cache\")\nw.Header().Set(\"Connection\", \"keep-alive\")\n</code></pre>\n\n<p>\u2026do something like this:</p>\n\n<pre><code>const staticHeaders = `\n\nAccess-Control-Allow-Origin: *\nCache-Control: no-cache\nConnection: keep-alive`\n\nw.Headers.WriteRaw(staticHeaders)\n</code></pre>\n\n<p>Is that possible?</p>\n"}, {"tags": ["pointers", "go", "slice"], "comments": [{"owner": {"reputation": 1786, "user_id": 4099287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OMz777BPLQI/AAAAAAAAAAI/AAAAAAAAFcM/tV8IW2TybOw/photo.jpg?sz=128", "display_name": "Kevin M Granger", "link": "https://stackoverflow.com/users/4099287/kevin-m-granger"}, "edited": false, "score": 1, "creation_date": 1465993140, "post_id": 37835087, "comment_id": 63131662, "body": "Please give a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Viable, Complete Example.</a> Based on the code you&#39;ve given us, this shouldn&#39;t even compile. You&#39;re referencing attrData, did you mean attrCode?"}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "reply_to_user": {"reputation": 1786, "user_id": 4099287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OMz777BPLQI/AAAAAAAAAAI/AAAAAAAAFcM/tV8IW2TybOw/photo.jpg?sz=128", "display_name": "Kevin M Granger", "link": "https://stackoverflow.com/users/4099287/kevin-m-granger"}, "edited": false, "score": 0, "creation_date": 1465993806, "post_id": 37835087, "comment_id": 63132141, "body": "I have given the required code."}], "answers": [{"comments": [{"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "edited": false, "score": 0, "creation_date": 1465994857, "post_id": 37835728, "comment_id": 63132908, "body": "I tried the above, but missed the *p = append(*p, val)  part. Thanks, it is working now."}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "edited": false, "score": 1, "creation_date": 1465995772, "post_id": 37835728, "comment_id": 63133631, "body": "I have another question - All slices and maps are passed as  references. So when I pass the reference of TopAttributes (which is a slice) and setting the value as p = append(p, val) , shouldn&#39;t it work. This is also updating the reference in a way."}, {"owner": {"reputation": 1786, "user_id": 4099287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OMz777BPLQI/AAAAAAAAAAI/AAAAAAAAFcM/tV8IW2TybOw/photo.jpg?sz=128", "display_name": "Kevin M Granger", "link": "https://stackoverflow.com/users/4099287/kevin-m-granger"}, "reply_to_user": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "edited": false, "score": 1, "creation_date": 1465996968, "post_id": 37835728, "comment_id": 63134528, "body": "You are updating a reference. But only the reference that setAttribute sees. When you use a pointer to that &quot;reference&quot;, you&#39;re updating the variable that setAttributeData has. In C terms, it&#39;s a pointer to a pointer."}], "tags": [], "owner": {"reputation": 1786, "user_id": 4099287, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-OMz777BPLQI/AAAAAAAAAAI/AAAAAAAAFcM/tV8IW2TybOw/photo.jpg?sz=128", "display_name": "Kevin M Granger", "link": "https://stackoverflow.com/users/4099287/kevin-m-granger"}, "is_accepted": false, "score": 28, "last_activity_date": 1465994350, "creation_date": 1465994350, "answer_id": 37835728, "question_id": 37835087, "link": "https://stackoverflow.com/questions/37835087/go-pointers-append-values-to-slice-via-pointer/37835728#37835728", "title": "Go Pointers - append values to slice via pointer", "body": "<p><code>append</code> returns a reference to the appended-to slice. This is because it could point to a new location in memory if it needed to be resized.</p>\n\n<p>In your first example, you are updating the variable passed to your <code>setAttribute</code> function, but that's it. The only reference is lost when that function exits.</p>\n\n<p>It works in the second example because that variable lives in your struct, and is thus updated.</p>\n\n<p>You can fix the first version by using a pointer:</p>\n\n<pre><code>func (p *ProductInfo) setAttributeData() {\n    key := \"key\"\n    value := \"value\"\n    setAttribute(&amp;p.TopAttributes, key, value)\n}\n\nfunc setAttribute(p *[]map[string]interface{}, key string, value interface{}) {\n    val := map[string]interface{}{\n        key: value,\n    }\n    *p = append(*p, val)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 5, "last_activity_date": 1465994962, "creation_date": 1465994962, "answer_id": 37835965, "question_id": 37835087, "link": "https://stackoverflow.com/questions/37835087/go-pointers-append-values-to-slice-via-pointer/37835965#37835965", "title": "Go Pointers - append values to slice via pointer", "body": "<p>You are trying to append a <code>map</code> value which is used as a function parameter, so it has a local scope, accessible only within the function. Because this is referenced by value and not by pointer address, it's access is restricted only to it's local scope. </p>\n\n<p>Map types are reference types, like pointers or slices, and so the value of parameter <code>p</code> is nil; it doesn't point to an initialized map.</p>\n\n<p>To point it to a map you have to access trough it's pointer:</p>\n\n<pre><code>func (p *ProductInfo) setAttributeData() {\n    key := \"key\"\n    value := \"value\"\n    setAttribute(p.TopAttributes, key, value)\n}\n\nfunc setAttribute(p *[]map[string]interface{}, key string, value interface{}) {\n    val := map[string]interface{}{\n        key: value,\n    }\n    *p = append(*p, val)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 8143320, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/woNmB.jpg?s=128&g=1", "display_name": "diamondu", "link": "https://stackoverflow.com/users/8143320/diamondu"}, "is_accepted": false, "score": 0, "last_activity_date": 1511535043, "creation_date": 1511535043, "answer_id": 47475643, "question_id": 37835087, "link": "https://stackoverflow.com/questions/37835087/go-pointers-append-values-to-slice-via-pointer/47475643#47475643", "title": "Go Pointers - append values to slice via pointer", "body": "<p>Shortly, though we can use slice to modify the source data, but for slice itself, when as an argument for function, it just pass a copy into the function.\nso, your code like this</p>\n\n<pre><code>func test(i int) {\n    i = i + 1\n}\nvar a int = 3\ntest(a)\n</code></pre>\n"}], "owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28782, "favorite_count": 3, "answer_count": 3, "score": 24, "last_activity_date": 1511535043, "creation_date": 1465992635, "last_edit_date": 1465993763, "question_id": 37835087, "link": "https://stackoverflow.com/questions/37835087/go-pointers-append-values-to-slice-via-pointer", "title": "Go Pointers - append values to slice via pointer", "body": "<p>I have a struct ProductData and its instance p which has a slice attribute :</p>\n\n<pre><code>type ProductInfo struct {\n    TopAttributes []map[string]interface{}\n}\n</code></pre>\n\n<p>I want to set TopAttributes as follows</p>\n\n<pre><code>func (p *ProductInfo) setAttributeData() {\n    key := \"key\"\n    value := \"value\"\n    setAttribute(p.TopAttributes, key, value)\n}\n\nfunc setAttribute(p []map[string]interface{}, key string, value interface{}) {\n    val := map[string]interface{}{\n        key: value,\n    }\n    p = append(p, val)\n}\n</code></pre>\n\n<h2>But this does not seem to work.</h2>\n\n<p>However, there is another way which works fine when I define a method as:</p>\n\n<pre><code>   func (p *ProductInfo) setAttributeData() {\n    key := \"key\"\n    value := \"value\"\n    p.setAttribute(key, value)\n}\n\nfunc (p *ProductInfo) setAttribute(key string, value interface{}) {\n    val := map[string]interface{}{\n        key: value,\n    }\n    p.TopAttributes = append(p.TopAttributes, val)\n}\n</code></pre>\n\n<p>I want to find out why it is not working. There were no errors in my code, but the data coming was empty.\nI am trying to do this to make it a generic function as I have another BottomAttributes which has to be set the same way. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1465984058, "post_id": 37831477, "comment_id": 63125228, "body": "No this is not possible."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465995395, "post_id": 37831477, "comment_id": 63133323, "body": "You can always deallocate memory you&#39;ve manually allocated. Is that what you&#39;re looking to do?"}, {"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1466009815, "post_id": 37831477, "comment_id": 63143707, "body": "The language strives to make you forget about memory management, so it&#39;s understandable why they wouldn&#39;t have this feature."}], "answers": [{"tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": true, "score": 18, "last_activity_date": 1481886978, "last_edit_date": 1481886978, "creation_date": 1465984814, "answer_id": 37832151, "question_id": 37831477, "link": "https://stackoverflow.com/questions/37831477/is-it-possible-to-deallocate-memory-manually-in-go/37832151#37832151", "title": "Is it possible to deallocate memory manually in go?", "body": "<p>Here is a thread that may interest you: <a href=\"https://github.com/golang/go/issues/13761\" rel=\"noreferrer\">Add runtime.Free() for GOGC=off</a></p>\n\n<p>Interesting part:</p>\n\n<blockquote>\n  <p>The Go GC does not have the ability to manually deallocate blocks \n  anymore. And besides, runtime. Free is unsafe (people might free still\n  in use pointers or double free) and then all sorts of C memory problem\n  that Go tries hard to get rid of will come back. The other reason is\n  that runtime sometimes allocates behind your back and there is no way\n  for the program to explicitly free memory.</p>\n  \n  <p>If you really want to manually manage memory with Go, implement your\n  own memory allocator based on syscall.Mmap or cgo malloc/free.</p>\n  \n  <p>Disabling GC for extended period of time is generally a bad solution\n  for a concurrent language like Go. And Go's GC will only be better\n  down the road.</p>\n</blockquote>\n\n<p><strong>TL;DR: Yes, but don't do it</strong></p>\n"}, {"tags": [], "owner": {"reputation": 3181, "user_id": 3828581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gfmiT.jpg?s=128&g=1", "display_name": "ThomasP1988", "link": "https://stackoverflow.com/users/3828581/thomasp1988"}, "is_accepted": false, "score": 0, "last_activity_date": 1616838452, "last_edit_date": 1616838452, "creation_date": 1616838009, "answer_id": 66829883, "question_id": 37831477, "link": "https://stackoverflow.com/questions/37831477/is-it-possible-to-deallocate-memory-manually-in-go/66829883#66829883", "title": "Is it possible to deallocate memory manually in go?", "body": "<p>I am a bit late but this question is high ranked on google, so here is an article by the creator of DGraph database which explains an alternative to malloc/calloc which is jemalloc, worth a look</p>\n<p><a href=\"https://dgraph.io/blog/post/manual-memory-management-golang-jemalloc/\" rel=\"nofollow noreferrer\">https://dgraph.io/blog/post/manual-memory-management-golang-jemalloc/</a></p>\n<blockquote>\n<p>With these techniques, we get the best of both worlds: We can do manual memory allocation in critical, memory-bound code paths. At the same time, we can get the benefits of automatic garbage collection in non-critical code paths. Even if you are not comfortable using Cgo or jemalloc, you could apply these techniques on bigger chunks of Go memory, with similar impact.</p>\n</blockquote>\n<p>And I haven't tested it yet, but there is a github library called jemalloc-go</p>\n<p><a href=\"https://github.com/spinlock/jemalloc-go\" rel=\"nofollow noreferrer\">https://github.com/spinlock/jemalloc-go</a></p>\n"}], "owner": {"reputation": 10277, "user_id": 190446, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/c544188078900e5d5976689949177f11?s=128&d=identicon&r=PG", "display_name": "S\u0142awosz", "link": "https://stackoverflow.com/users/190446/s%c5%82awosz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4253, "favorite_count": 3, "accepted_answer_id": 37832151, "answer_count": 2, "score": 9, "last_activity_date": 1616838452, "creation_date": 1465983055, "question_id": 37831477, "link": "https://stackoverflow.com/questions/37831477/is-it-possible-to-deallocate-memory-manually-in-go", "title": "Is it possible to deallocate memory manually in go?", "body": "<p>After discussion with college, I wonder if it would be possible (even if completely does not make any sense) to deallocate memory manually in go (ie. by using unsafe package). Is it?</p>\n"}, {"tags": ["ruby", "go", "deferred"], "answers": [{"tags": [], "owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "is_accepted": false, "score": 15, "last_activity_date": 1466021501, "last_edit_date": 1466021501, "creation_date": 1465975990, "answer_id": 37828900, "question_id": 37828645, "link": "https://stackoverflow.com/questions/37828645/what-is-the-ruby-equivalent-of-go-defer/37828900#37828900", "title": "What is the ruby equivalent of Go defer?", "body": "<p>There are no proper equivalents to the <code>defer</code> statement in ruby, however if you want to make sure that a specific code block is executed, you can use the <code>ensure</code> statement. The difference is that you cannot stack code blocks like defer does, but the result is the same.</p>\n\n<p><strong>In a block</strong></p>\n\n<pre><code>begin\n  # ...\nensure\n  # This code will be executed even if an exception is thrown\nend\n</code></pre>\n\n<p><strong>In a method</strong></p>\n\n<pre><code>def foo\n  # ...\nensure\n  # ...\nend\n</code></pre>\n\n<blockquote>\n  <p><a href=\"http://ruby-doc.org/docs/keywords/1.9/Object.html#method-i-ensure\" rel=\"noreferrer\">Object#ensure</a> Marks the final, optional clause of a begin/end block,\n  generally in cases where the block also contains a rescue clause. The\n  code in the ensure clause is guaranteed to be executed, whether\n  control flows to the rescue block or not.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 4921, "user_id": 171916, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/810fb8ed5b7f4d81ade67a2d34c1ffeb?s=128&d=identicon&r=PG", "display_name": "Narfanator", "link": "https://stackoverflow.com/users/171916/narfanator"}, "edited": false, "score": 1, "creation_date": 1492712037, "post_id": 37829583, "comment_id": 74107073, "body": "Someone downvoted this. Why? Does this code not work? Are there ugly consequences? This looks legit and neat."}], "tags": [], "owner": {"reputation": 821, "user_id": 1166593, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/fd1b53c45386ed7ac737bdd65b1f9fe2?s=128&d=identicon&r=PG", "display_name": "AlexN", "link": "https://stackoverflow.com/users/1166593/alexn"}, "is_accepted": false, "score": 5, "last_activity_date": 1493102456, "last_edit_date": 1493102456, "creation_date": 1465978044, "answer_id": 37829583, "question_id": 37828645, "link": "https://stackoverflow.com/questions/37828645/what-is-the-ruby-equivalent-of-go-defer/37829583#37829583", "title": "What is the ruby equivalent of Go defer?", "body": "<p>It doesn't have such a statement, but you can use metaprogramming to get this behavior.</p>\n\n<pre><code>module Deferable\n  def defer &amp;block\n    @defered_methods &lt;&lt; block\n  end\n\n  def self.included(mod)\n    mod.extend ClassMethods\n  end\n\n  module ClassMethods\n    def deferable method\n      original_method = instance_method(method)\n      define_method(method) do |*args|\n        @@defered_method_stack ||= []\n        @@defered_method_stack &lt;&lt; @defered_methods\n        @defered_methods = []\n        begin\n          original_method.bind(self).(*args)\n        ensure\n          @defered_methods.each {|m| m.call }\n          @defered_methods = @@defered_method_stack.pop\n        end\n      end\n    end\n  end\nend\n\nclass Test\n  include Deferable\n\n  def test\n    defer { puts \"world\" }\n    puts \"hello\"\n  end\n\n  def stacked_methods str\n    defer { puts \"and not broken\" }\n    defer { puts \"at all\" }\n    puts str\n    test\n  end\n\n  def throw_exception\n    defer { puts \"will be executed even if exception is thrown\" }\n    throw Exception.new\n  end\n\n  deferable :test\n  deferable :stacked_methods\n  deferable :throw_exception\nend\n</code></pre>\n\n<p>Example calls:</p>\n\n<pre><code>t = Test.new\nt.test\n\n# -&gt; Output:\n# hello\n# world\n\nt.stacked_methods \"stacked methods\"\n\n# -&gt; Output:\n# stacked methods\n# hello\n# world\n# and not broken\n# at all\n\nt.throw_exception\n# -&gt; Output:\n# will be executed even if exception is thrown\n# deferable.rb:45:in `throw': uncaught throw #&lt;Exception: Exception&gt; (UncaughtThrowError)\n#         from deferable.rb:45:in `throw_exception'\n#         from deferable.rb:18:in `call'\n#         from deferable.rb:18:in `block in deferable'\n#         from deferable.rb:59:in `&lt;main&gt;'\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6468119, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55e576d3ec6efe55060f0eeabbf81e1c?s=128&d=identicon&r=PG&f=1", "display_name": "reassesad", "link": "https://stackoverflow.com/users/6468119/reassesad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1568, "favorite_count": 0, "answer_count": 2, "score": 8, "last_activity_date": 1493102456, "creation_date": 1465975287, "last_edit_date": 1465979425, "question_id": 37828645, "link": "https://stackoverflow.com/questions/37828645/what-is-the-ruby-equivalent-of-go-defer", "title": "What is the ruby equivalent of Go defer?", "body": "<p>I am a new to Ruby and I am working on a project which involves using this. Go offers the <a href=\"https://tour.golang.org/flowcontrol/12\" rel=\"noreferrer\"><code>defer</code></a> statement, and I wanted to know how I could replicate that function in ruby.</p>\n\n<p>Example:</p>\n\n<pre><code>dst, err := os.Create(dstName)\nif err != nil {\n    return\n}\ndefer dst.Close()\n</code></pre>\n"}, {"tags": ["web-services", "heroku", "go"], "comments": [{"owner": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "edited": false, "score": 1, "creation_date": 1465982700, "post_id": 37828536, "comment_id": 63124272, "body": "What error exactly do you encounter? I&#39;m not sure to fully grasp the issue here"}, {"owner": {"reputation": 2628, "user_id": 421085, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3c78ec632ab3dd2dd15716a1013a221?s=128&d=identicon&r=PG", "display_name": "Tim Specht", "link": "https://stackoverflow.com/users/421085/tim-specht"}, "reply_to_user": {"reputation": 4025, "user_id": 763799, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r4nZd.jpg?s=128&g=1", "display_name": "basgys", "link": "https://stackoverflow.com/users/763799/basgys"}, "edited": false, "score": 0, "creation_date": 1465983869, "post_id": 37828536, "comment_id": 63125101, "body": "It seems like the webserver is not able to quickly enough process requests. E.g. a couple of hundreds are dopped in the first seconds/minute"}, {"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1466355084, "post_id": 37828536, "comment_id": 63271196, "body": "getting that h10 error myself"}, {"owner": {"reputation": 666, "user_id": 1002122, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e3b74939d0e6e28eda5747e3a84c5eb4?s=128&d=identicon&r=PG", "display_name": "xanderflood", "link": "https://stackoverflow.com/users/1002122/xanderflood"}, "edited": false, "score": 0, "creation_date": 1552825949, "post_id": 37828536, "comment_id": 97150141, "body": "Not sure if this is relevant, but is there anything after the code snippet you provided? If not, the goroutine at the end is probably not ever executing. A go process exits when its main goroutine exits, and if you start a goroutine immediately before the end of your <code>main</code>, the process will kill it before it can do anything."}], "owner": {"reputation": 2628, "user_id": 421085, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/c3c78ec632ab3dd2dd15716a1013a221?s=128&d=identicon&r=PG", "display_name": "Tim Specht", "link": "https://stackoverflow.com/users/421085/tim-specht"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 104, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465974951, "creation_date": 1465974951, "question_id": 37828536, "link": "https://stackoverflow.com/questions/37828536/golang-server-crashing-on-heroku", "title": "Golang server crashing on Heroku", "body": "<p>I'm running my Golang service on Heroku. Very weirdly I have small hickups in that service that seem to be quite random. The service is simply written in Golang and does not interact with any database, storage solution or caching services.</p>\n\n<p>I contacted the Heroku support already and they hinted me at this happening mainly during dyno-restart. They told me that albeit preboot is enabled when a dyno is recycled that the new dyno is coming up and takes traffic immediately and then the old one is shut off. Hence I would think that maybe the interruptions come from the Golang HTTP server not starting up fast enough? Here's how I run it:</p>\n\n<pre><code>s := &amp;http.Server{\n    Addr:           \":\"+exposePort,\n    Handler:        h,\n    ReadTimeout:    time.Duration(timeout) * time.Second,\n    WriteTimeout:   time.Duration(timeout) * time.Second,\n}\n\nerr = s.ListenAndServe()\nerrs &lt;- fmt.Errorf(\"Server error\", err.Error())\nif client != nil {\n    client.CaptureMessage(err.Error())\n}\n\ngo func() {\n    c := make(chan os.Signal)\n    signal.Notify(c, syscall.SIGINT)\n    errs &lt;- fmt.Errorf(\"%s\", &lt;-c)\n}()\n</code></pre>\n\n<p>Is this a known issue or has someone experienced similar so far? Would really appreciate some help with that!</p>\n"}, {"tags": ["go", "redis", "redislabs"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1465974660, "post_id": 37828284, "comment_id": 63119201, "body": "please attach the pool initialization code."}, {"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1465974832, "post_id": 37828284, "comment_id": 63119298, "body": "@Not_a_Golfer done"}], "answers": [{"comments": [{"owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "edited": false, "score": 3, "creation_date": 1465991595, "post_id": 37828671, "comment_id": 63130553, "body": "Awesome! you rock. Added the code that solved this for future generations."}], "tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 6, "last_activity_date": 1465975354, "creation_date": 1465975354, "answer_id": 37828671, "question_id": 37828284, "link": "https://stackoverflow.com/questions/37828284/redigo-getting-dial-tcp-connect-cannot-assign-requested-address/37828671#37828671", "title": "redigo: getting dial tcp: connect: cannot assign requested address", "body": "<ol>\n<li><p>You're closing the connection after sending on the channels, if the channel is blocking you're not closing connections, which would result in the error you're seeing. so don't just defer, close the connection explicitly. </p></li>\n<li><p>I don't think it's the problem but a good idea regardless - set a timeout on your connections with <code>DialTimeout</code>.</p></li>\n<li><p>Make sure you have a proper <code>TestOnBorrow</code> function to get rid of dead connections, especially if you have timeout. I usually do a PING if the connection has been idle for more than 3 seconds (the function receives the idle time as a parameter)</p></li>\n<li><p>Try setting <code>MaxIdle</code> to a larger number as well, I remember having problems with pooling that were resolved by increasing that parameter in the pool.</p></li>\n</ol>\n"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7106, "favorite_count": 2, "accepted_answer_id": 37828671, "answer_count": 1, "score": 7, "last_activity_date": 1465991538, "creation_date": 1465974272, "last_edit_date": 1465991538, "question_id": 37828284, "link": "https://stackoverflow.com/questions/37828284/redigo-getting-dial-tcp-connect-cannot-assign-requested-address", "title": "redigo: getting dial tcp: connect: cannot assign requested address", "body": "<p>I have an application that makes about 400 reads per seconds and 100 writes per second to redis (hosted on redislabs). The application is using <code>github.com/garyburd/redigo</code> package as a redis proxy. </p>\n\n<p>I have two functions which are the only ones being used to read and write:</p>\n\n<pre><code>func getCachedVPAIDConfig(key string) chan *cachedVPAIDConfig {\n    c := make(chan *cachedVPAIDConfig)\n    go func() {\n        p := pool.Get()\n        defer p.Close()\n\n        switch p.Err() {\n        case nil:\n            item, err := redis.Bytes(p.Do(\"GET\", key))\n            if err != nil {\n                c &lt;- &amp;cachedVPAIDConfig{nil, err}\n                return\n            }\n\n            c &lt;- &amp;cachedVPAIDConfig{item, nil}\n        default:\n            c &lt;- &amp;cachedVPAIDConfig{nil, p.Err()}\n            return\n        }\n    }()\n    return c\n}\n\n\n\nfunc setCachedVPAIDConfig(key string, j []byte) chan error {\n    c := make(chan error)\n    go func() {\n        p := pool.Get()\n        defer p.Close()\n\n        switch p.Err() {\n        case nil:\n            _, err := p.Do(\"SET\", key, j)\n\n            if err != nil {\n                c &lt;- err\n                return\n            }\n\n            c &lt;- nil\n        default:\n            c &lt;- p.Err()\n            return\n        }\n    }()\n    return c\n}\n</code></pre>\n\n<p>As you can see, I'm using the recommended connection pooling mechanism (<a href=\"http://godoc.org/github.com/garyburd/redigo/redis#Pool\" rel=\"nofollow\">http://godoc.org/github.com/garyburd/redigo/redis#Pool</a>). </p>\n\n<p>I'm calling these functions on every http request an endpoint on the application is getting. The problem is: once the application starts getting requests, it immediately starts throwing the error</p>\n\n<pre><code>dial tcp 54.160.xxx.xx:yyyy: connect: cannot assign requested address\n</code></pre>\n\n<p>(54.160.xxx.xx:yyyy is the redis host)</p>\n\n<p>I see on redis that there are only about 600 connections when this starts to happen, which doesn't sound like a lot.</p>\n\n<p>I tried playing with the <code>MaxActive</code> setting of the <code>pool</code>, setting it anywhere between 1000 and 50K, but the result is the same. </p>\n\n<p>Any ideas?</p>\n\n<p><strong>EDIT</strong></p>\n\n<p>Here's my pool initialization code (doing this in <code>func init</code>):</p>\n\n<pre><code>pool = redis.Pool{\n    MaxActive:   1000, // note: I tried changing this to 50K, result the same\n    Dial: func() (redis.Conn, error) {\n        c, err := redis.Dial(\"tcp\", redisHost)\n        if err != nil {\n            return nil, err\n        }\n        if _, err := c.Do(\"AUTH\", redisPassword); err != nil {\n            c.Close()\n            return nil, err\n        }\n        return c, err\n    },\n}\n</code></pre>\n\n<p><strong>Edit 2:</strong>\nIssue solved by applying the stuff suggested in the answer below! </p>\n\n<p>New code for pool init:</p>\n\n<pre><code>pool = redis.Pool{\n    MaxActive:   500,\n    MaxIdle:     500,\n    IdleTimeout: 5 * time.Second,\n    Dial: func() (redis.Conn, error) {\n        c, err := redis.DialTimeout(\"tcp\", redisHost, 100*time.Millisecond, 100*time.Millisecond, 100*time.Millisecond)\n        if err != nil {\n            return nil, err\n        }\n        if _, err := c.Do(\"AUTH\", redisPassword); err != nil {\n            c.Close()\n            return nil, err\n        }\n        return c, err\n    },\n}\n</code></pre>\n\n<p>This new init makes it so that the get and set timeouts are handled by redigo internally, so I no longer need to return a channel on the getCachedVPAIDConfig and setCachedVPAIDConfig funcs. This is how they look now:</p>\n\n<pre><code>func setCachedVPAIDConfig(key string, j []byte) error {\n    p := pool.Get()\n    switch p.Err() {\n    case nil:\n        _, err := p.Do(\"SET\", key, j)\n        p.Close()\n        return err\n    default:\n        p.Close()\n        return p.Err()\n    }\n}\n\nfunc getCachedVPAIDConfig(key string) ([]byte, error) {\n    p := pool.Get()\n    switch p.Err() {\n    case nil:\n        item, err := redis.Bytes(p.Do(\"GET\", key))\n        p.Close()\n        return item, err\n    default:\n        p.Close()\n        return nil, p.Err()\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 3, "creation_date": 1465942371, "post_id": 37822603, "comment_id": 63109564, "body": "One example is selecting on a dynamic number of channels <a href=\"http://stackoverflow.com/q/19992334/714501\">stackoverflow.com/q/19992334/714501</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465943112, "post_id": 37822603, "comment_id": 63109821, "body": "Or just selecting channels where the specific type is unknown."}], "answers": [{"tags": [], "owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "is_accepted": false, "score": 1, "last_activity_date": 1465945992, "creation_date": 1465945992, "answer_id": 37823611, "question_id": 37822603, "link": "https://stackoverflow.com/questions/37822603/reflect-select-function-is-need-why-i-assume-it-is-because-the-channel-has-to-b/37823611#37823611", "title": "reflect.Select Function is need why? I assume it is because the channel has to be a reflection value?", "body": "<p>There was a <a href=\"https://engineering.mongodb.com/post/multiplexing-golang-channels-to-maximize-throughput/\" rel=\"nofollow\">write-up recently</a> from the guys at MongoDB. Apparently this code is in production use in their <code>mongodump</code> utility.</p>\n\n<p>The specific code that uses <code>reflect.Select</code> looks like this (from the article):</p>\n\n<pre><code>// Run multiplexer until it receives an EOF on the control channel.\nfunc (mux *Multiplexer) Run() {\n    for {\n        index, value, recv := reflect.Select(mux.selectCases)\n        EOF := !recv\n        // note that the control channel is always at index 0\n        if index == 0 {\n            if EOF {\n                return\n            }\n            muxInput, _ := value.Interface().(*muxInputSource)\n            mux.selectCases = append(mux.selectCases, reflect.SelectCase{\n                Dir:  reflect.SelectRecv,\n                Chan: reflect.ValueOf(muxInput.collection),\n                Send: reflect.Value{},\n            })\n        } else {\n            if EOF {\n                mux.writeEOF()\n                mux.selectCases = append(mux.selectCases[:index], mux.selectCases[index+1:]...)\n            } else {\n                document, _ := value.Interface().([]byte)\n                mux.writeDocument(document)[]\n            }\n        }\n    }\n}\n</code></pre>\n\n<p>The reasons I can think that they use <code>reflect.Select</code> instead of a straight <code>select</code>:</p>\n\n<ul>\n<li>The number of goroutines (and therefore the number of channels) is determined at runtime (using the <code>-j</code> flag). In fact, it seems to change dynamically with <code>append</code>. (credit to @cnicutar's comment)</li>\n<li>The type of the channel is determined at runtime. This allows their <code>muxInput.collection</code> type to be anything it wants. (credit to @JimB's comment)</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 67, "user_id": 4418755, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-Mjayd5hmHQE/AAAAAAAAAAI/AAAAAAAAADs/uFWBg7vLqmI/photo.jpg?sz=128", "display_name": "Miffa Young", "link": "https://stackoverflow.com/users/4418755/miffa-young"}, "is_accepted": false, "score": 0, "last_activity_date": 1605857671, "last_edit_date": 1605857671, "creation_date": 1605857231, "answer_id": 64925402, "question_id": 37822603, "link": "https://stackoverflow.com/questions/37822603/reflect-select-function-is-need-why-i-assume-it-is-because-the-channel-has-to-b/64925402#64925402", "title": "reflect.Select Function is need why? I assume it is because the channel has to be a reflection value?", "body": "<p>If  your  channels are  fixed, you can use select to watch them;\nBut if your channels is unfixed  and you want to watch them, you can use reflect.Select.</p>\n<p>There are some code snippet</p>\n<pre><code>var (\n      events  []reflect.SelectCase\n      err     error\n      lenHdr  = 3 // zk conn event chan, shutdown chan, children refresh chan\n      lenCW   = len(z.ChildWatches)    // a channel slice:chan ChildWatche\n      lenDW   = len(z.DataWatches)     //a channel slice:chan DataWatche\n      lenEN   = len(z.EphemeralNodes)  //a channel slice: chan EphemeralNode\n  )\n  events = make([]reflect.SelectCase, lenHdr+lenCW+lenDW+lenEN)\n  events[0] = reflect.SelectCase{Dir: reflect.SelectRecv, Chan: reflect.ValueOf(FreshChanConEvent())} // kick off the event loop\n  events[1] = reflect.SelectCase{Dir: reflect.SelectRecv, Chan: reflect.ValueOf(z.shutdownChan)}\n  events[2] = reflect.SelectCase{Dir: reflect.SelectRecv, Chan: reflect.ValueOf(z.refreshChildChan)}\n  for i, _ := range z.ChildWatches {\n      events[lenHdr+i] = reflect.SelectCase{Dir: reflect.SelectRecv, Chan: reflect.Zero(reflect.TypeOf((chan zk.Event)(nil)))}\n  }\n  for i, _ := range z.DataWatches {\n      events[lenHdr+lenCW+i] = reflect.SelectCase{Dir: reflect.SelectRecv, Chan: reflect.Zero(reflect.TypeOf((chan zk.Event)(nil)))}\n  }\n  for i, info := range z.EphemeralNodes {\n    events[lenHdr+lenCW+lenDW+i] = reflect.SelectCase{Dir: reflect.SelectRecv, Chan: reflect.ValueOf(info.Ch)}\n  }\n\n  for {\n    chosen, value, ok := reflect.Select(events)\n    if chosen == xxxxx {...}\n</code></pre>\n<p>This code is watching   channels array (z.ChildWatches\u3001z.DataWatches\u3001z.EphemeralNodes\uff09</p>\n"}], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 605, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1605857671, "creation_date": 1465940508, "question_id": 37822603, "link": "https://stackoverflow.com/questions/37822603/reflect-select-function-is-need-why-i-assume-it-is-because-the-channel-has-to-b", "title": "reflect.Select Function is need why? I assume it is because the channel has to be a reflection value?", "body": "<p>Under what cases would <strong>reflect.Select</strong> be needed?</p>\n\n<p>I have found examples, but the use of Select seems contrived.</p>\n\n<p>Any example where reflect.Select is necessary over normal Select?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 4, "last_activity_date": 1465950350, "creation_date": 1465950350, "answer_id": 37824235, "question_id": 37822168, "link": "https://stackoverflow.com/questions/37822168/how-to-use-ws-setwritedeadline/37824235#37824235", "title": "How to use ws.SetWriteDeadline?", "body": "<p>You are you using WriteDeadline correctly.  The deadline specifies the time for writing data to the TCP stack's buffers, not the time that the peer receives the data (if it does at all).</p>\n\n<p>To reliably detect closed connections, the application should send PINGs to the peer and wait for the expected PONGs. The package you are using does not support this functionality, but the <a href=\"https://github.com/gorilla/websocket\" rel=\"nofollow\">Gorilla</a> package does. The <a href=\"https://github.com/gorilla/websocket/tree/master/examples/chat\" rel=\"nofollow\">Gorilla chat application</a> shows how use PING and PONG to detect closed connections.</p>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1359, "favorite_count": 1, "accepted_answer_id": 37824235, "answer_count": 1, "score": 0, "last_activity_date": 1465950350, "creation_date": 1465938694, "last_edit_date": 1465939236, "question_id": 37822168, "link": "https://stackoverflow.com/questions/37822168/how-to-use-ws-setwritedeadline", "title": "How to use ws.SetWriteDeadline?", "body": "<p>When I close a browser I want to disconnect a websocket in 3 seconds instead of 1 minute. The following just keep writing into a void without error until the tcp ip timeout I guess, not the SetWriteDeadline.</p>\n\n<pre><code>f := func(ws *websocket.Conn) {\n    for {\n        select {\n        case msg := &lt;-out:\n            ws.SetWriteDeadline(time.Now().Add(3 * time.Second))\n            if _, err := ws.Write([]byte(msg)); err != nil {\n                fmt.Println(err)\n                return\n            }\n        case &lt;-time.After(3 * time.Second):\n            fmt.Println(\"timeout 3\")\n            return\n        }\n    }\n}\nreturn websocket.Handler(f)\n</code></pre>\n\n<p>I need to wait for this err</p>\n\n<p><code>write tcp [::1]:8080-&gt;[::1]:65459: write: broken pipe</code></p>\n\n<p>before it finally closes the connection, which takes about a minute or more.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1465938524, "post_id": 37822081, "comment_id": 63107997, "body": "Go is lexically scoped via blocks. It&#39;s just for variable scope. See <a href=\"http://stackoverflow.com/questions/34684265/is-this-a-block-argument\" title=\"is this a block argument\">stackoverflow.com/questions/34684265/is-this-a-block-argumen&zwnj;&#8203;t</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1466017380, "post_id": 37822081, "comment_id": 63147878, "body": "Note that the same feature is available in <code>C</code> and <code>C++</code> as well (Go draws certain ideas from the former)."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 1, "last_activity_date": 1465979014, "last_edit_date": 1465979014, "creation_date": 1465940050, "answer_id": 37822517, "question_id": 37822081, "link": "https://stackoverflow.com/questions/37822081/statement-blocks-in-go/37822517#37822517", "title": "Statement blocks in go", "body": "<p>Those braces are defining a more specific scope for local variables. In your case each scope is declaring <code>stop_1</code>, <code>stop_2</code> and <code>left_to_win</code>. Without the additional curly braces you would get a compiler error saying you're redeclaring or defining those variables since you're using the short hand <code>:=</code> which declares and assigns in one statement.In this case the code could be written to instead just use <code>:=</code> on the initial declaration and then <code>=</code> for subsequent assignment which would remove the need for those scopes defined by the curly braces.</p>\n\n<p>See <a href=\"https://golang.org/ref/spec#Declarations_and_scope\" rel=\"nofollow\">here</a> for more details.</p>\n"}], "owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 37822517, "answer_count": 1, "score": 1, "last_activity_date": 1465979229, "creation_date": 1465938332, "last_edit_date": 1465979229, "question_id": 37822081, "link": "https://stackoverflow.com/questions/37822081/statement-blocks-in-go", "title": "Statement blocks in go", "body": "<p>I'm not sure what the correct name for it is (and thus how to search for it), but I was just looking through some go code and saw it organized with statements inside of {}'s. I'm wondering what the reason is for supporting grouping statements like this?</p>\n\n<p>The code looks like this:</p>\n\n<pre><code>// Check horizontal\n{\n    left_to_win := 3\n\n    stop_1 := false\n    stop_2 := false\n    for x := 1; x &lt;= 4; x++ {\n        // ....\n    }\n}\n\n// Check vertical\n{\n    left_to_win := 3\n\n    stop_1 := false\n    stop_2 := false\n\n    for x := 1; x &lt;= 4; x++ {\n        // ...\n    }\n}\n\n// Check diagonal bottom to top\n{\n    left_to_win := 3\n\n    stop_1 := false\n    stop_2 := false\n\n    for x := 1; x &lt;= 4; x++ {\n        // ...\n    }\n}\n</code></pre>\n\n<p>In the specific example it seems like it could easily be refactored into a single utility function. What's the name of this feature, and are there any good examples of times to use it?</p>\n"}, {"tags": ["go", "pq"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1465932368, "post_id": 37818970, "comment_id": 63104961, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/33751165/mysql-insert-float32-and-float64-go\">MySQL Insert Float32 and Float64 Go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "is_accepted": true, "score": 13, "last_activity_date": 1465929424, "creation_date": 1465929424, "answer_id": 37819690, "question_id": 37818970, "link": "https://stackoverflow.com/questions/37818970/how-can-i-check-whether-psql-successfully-updated-the-record-in-go/37819690#37819690", "title": "How can I check whether Psql successfully updated the record in Go", "body": "<p>Try using <code>db.Exec()</code> instead of <code>db.Query()</code> for queries that do not return results.  Instead of returning a <code>sql.Rows</code> object (which doesn't have a way to check how many rows were affected), it returns a <code>sql.Result</code> object, which has a method <code>RowsAffected() (int64, error)</code>.  This returns the number of rows affected (inserted, deleted, updated) by any write operations in the query fed to the <code>Exec()</code> call.</p>\n\n<p>Note that if your query doesn't affect any rows directly, but only does so via a subquery, the rows affected by the subquery will not be counted as rows affected for that method call.</p>\n\n<p>Also, as the method comment notes, this doesn't work for <em>all</em> database types, but I know for a fact it works with <code>pq</code>, as we're using that driver ourselves (and using the <code>RowsAffected()</code> method).</p>\n\n<p>Reference links:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/database/sql/#DB.Exec\" rel=\"noreferrer\">https://golang.org/pkg/database/sql/#DB.Exec</a></li>\n<li><a href=\"https://golang.org/pkg/database/sql/#Result\" rel=\"noreferrer\">https://golang.org/pkg/database/sql/#Result</a></li>\n</ul>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2803, "favorite_count": 0, "accepted_answer_id": 37819690, "answer_count": 1, "score": 5, "last_activity_date": 1465929424, "creation_date": 1465926908, "question_id": 37818970, "link": "https://stackoverflow.com/questions/37818970/how-can-i-check-whether-psql-successfully-updated-the-record-in-go", "title": "How can I check whether Psql successfully updated the record in Go", "body": "<p>I use <a href=\"https://github.com/lib/pq\" rel=\"noreferrer\">this driver</a> to communicate with psql from Go. Now when I issue an update query, I have no possibility to know whether it actually updated anything (it can update 0 rows if such id is not present).</p>\n\n<pre><code>_, err := Db.Query(\"UPDATE tags SET name=$1 WHERE id=1\", name)\n</code></pre>\n\n<p>I tried to investigate err variable (in the way the doc suggests for Insert statement):</p>\n\n<pre><code>if err == sql.ErrNoRows {\n    ...\n}\n</code></pre>\n\n<p>But even with non-existent id, err is still null.</p>\n\n<p>I also tried to use QueryRow with returning clause:</p>\n\n<pre><code>id := 0\nerr := Db.QueryRow(\"UPDATE tags SET name=$1 WHERE id=1 RETURNING id\", name).Scan(&amp;id)\n</code></pre>\n\n<p>But this one fails to scan &amp;id when id=1 is not present in the database.</p>\n\n<hr>\n\n<p>So what is the canonical way to check whether my update updated anything?</p>\n"}, {"tags": ["go", "struct", "interface"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1465929327, "post_id": 37818427, "comment_id": 63103436, "body": "I think an <a href=\"https://github.com/jinzhu/gorm\" rel=\"nofollow noreferrer\">ORM</a> might help you out."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1465929791, "post_id": 37818427, "comment_id": 63103697, "body": "Why are you insisting on custom-building a new interface for storing the value?  Is it just that you want to have a method that scans the rows without having to know what the destination type is?  Might be worth checking out <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">sqlx</a>, it adds a couple additional methods to the db that let you directly scan into structures instead of having to provide each field explicitly or a slice.  With that, your scan function only needs to accept an interface and pass it blindly to <code>db.Select()</code> or <code>db.Get()</code>."}, {"owner": {"reputation": 1488, "user_id": 5543633, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7b84cfa076b2cbd3cdf7747651cde611?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Ocando", "link": "https://stackoverflow.com/users/5543633/martin-ocando"}, "edited": false, "score": 0, "creation_date": 1465931134, "post_id": 37818427, "comment_id": 63104365, "body": "ohh, well, thanks."}], "answers": [{"comments": [{"owner": {"reputation": 1488, "user_id": 5543633, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7b84cfa076b2cbd3cdf7747651cde611?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Ocando", "link": "https://stackoverflow.com/users/5543633/martin-ocando"}, "edited": false, "score": 0, "creation_date": 1465931034, "post_id": 37819763, "comment_id": 63104318, "body": "Thanks :)  You know how i can combine StructRow and StructForScan in the same function?"}, {"owner": {"reputation": 325, "user_id": 3781442, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001923358820/picture?type=large", "display_name": "hitesh_noty", "link": "https://stackoverflow.com/users/3781442/hitesh-noty"}, "reply_to_user": {"reputation": 1488, "user_id": 5543633, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7b84cfa076b2cbd3cdf7747651cde611?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Ocando", "link": "https://stackoverflow.com/users/5543633/martin-ocando"}, "edited": false, "score": 0, "creation_date": 1465939246, "post_id": 37819763, "comment_id": 63108297, "body": "I think the method that you implemented is pretty straight forward :) . Also as stated in comments above, have a look at <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">github.com/jmoiron/sqlx</a> . I also did. It is pretty awesome."}], "tags": [], "owner": {"reputation": 325, "user_id": 3781442, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001923358820/picture?type=large", "display_name": "hitesh_noty", "link": "https://stackoverflow.com/users/3781442/hitesh-noty"}, "is_accepted": true, "score": 1, "last_activity_date": 1465929703, "creation_date": 1465929703, "answer_id": 37819763, "question_id": 37818427, "link": "https://stackoverflow.com/questions/37818427/golang-structs-interfaces/37819763#37819763", "title": "Golang Structs/Interfaces", "body": "<p>Changing your function <code>StructRow</code> to </p>\n\n<pre><code> func StructRow(u interface{}, rows *sql.Rows) []interface{} {\n    var data []interface{}\n    for rows.Next() {\n\n         t := reflect.TypeOf(u)\n         val := reflect.New(t).Interface()\n\n         errScan := rows.Scan(StrutForScan(val)...)\n         if errScan != nil {\n             //proper err handling\n         }\n         data = append(data, val)\n    }\n    return data\n }\n</code></pre>\n\n<p>will fix it. I guess. \nFor more on reflect package go to: <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow\">https://golang.org/pkg/reflect/</a></p>\n"}], "owner": {"reputation": 1488, "user_id": 5543633, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7b84cfa076b2cbd3cdf7747651cde611?s=128&d=identicon&r=PG&f=1", "display_name": "Martin Ocando", "link": "https://stackoverflow.com/users/5543633/martin-ocando"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1141, "favorite_count": 0, "accepted_answer_id": 37819763, "answer_count": 1, "score": 0, "last_activity_date": 1465929703, "creation_date": 1465924951, "question_id": 37818427, "link": "https://stackoverflow.com/questions/37818427/golang-structs-interfaces", "title": "Golang Structs/Interfaces", "body": "<p>I'm trying to do something to bring the SQL results dynamically structure, basically I want to run a function by passing the rows and the structure(to get the data type and make one) and return in interface array.</p>\n\n<p>Anyone know how I can do?</p>\n\n<p>I dont want pass the direct \"User\" struct as param.. that is not dynamically</p>\n\n<pre><code>type User struct{\n   Id_user int `json:\"id_user\"`\n   Name string `json:\"name\"`\n   Email string `json:\"email\"`\n   Username string `json: \"username\"`\n}\n\nfunc main() {\n  var user User\n  rows, _ := db.Query(\"SELECT id_user, name, email, username FROM users\")\n  json.NewEncoder(w).Encode(StructRow(user, rows)) \n}\n\nfunc StructRow(u interface{}, rows *sql.Rows)[]interface{}{\n   var data []interface{}\n   for rows.Next() {\n\n      //How i can create a \"user\" here, dynamically\n      //for Example\n      //var user reflect.TypeOf(u)\n\n      _ = rows.Scan(StrutForScan(&amp;user)...)\n      data = append(data, user)\n   }\n   return data\n}\n\nfunc StrutForScan(u interface{}) []interface{} {\n   val := reflect.ValueOf(u).Elem()\n   v := make([]interface{}, val.NumField())\n   for i := 0; i &lt; val.NumField(); i++ {\n      valueField := val.Field(i)\n      v[i] = valueField.Addr().Interface()\n   }\n   return v\n}\n</code></pre>\n"}, {"tags": ["mysql", "sql", "go"], "answers": [{"tags": [], "owner": {"reputation": 1368, "user_id": 1599940, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/7KpaW.png?s=128&g=1", "display_name": "rootatdarkstar", "link": "https://stackoverflow.com/users/1599940/rootatdarkstar"}, "is_accepted": false, "score": 5, "last_activity_date": 1465923882, "last_edit_date": 1465923882, "creation_date": 1465923564, "answer_id": 37818062, "question_id": 37817648, "link": "https://stackoverflow.com/questions/37817648/golang-why-sql-placeholder-not-work/37818062#37818062", "title": "Golang - Why SQL placeholder not work?", "body": "<p>You can't place a placeholder inside a string like <code>'?'</code>.</p>\n\n<p>It's does not work like string interpolation it's just variable binding.</p>\n\n<p>So try:</p>\n\n<pre><code>    searchKeyword := \"%\" + keyword + \"%\"\n    rows, err := db.Raw(`SELECT songs.name, singers.name, albums.name \n      FROM songs, singers, albums \n      WHERE (songs.singer_id = singers.id AND songs.album_id = albums.id) \n      AND (songs.name LIKE ? OR singers.name LIKE ? OR albums.name LIKE ?)`, \n      searchKeyword, \n      searchKeyword, \n      searchKeyword).Rows()\n</code></pre>\n"}], "owner": {"reputation": 641, "user_id": 3087000, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/4dd1dcaf7efecd574bb2273a5a8c06fc?s=128&d=identicon&r=PG&f=1", "display_name": "user3087000", "link": "https://stackoverflow.com/users/3087000/user3087000"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2118, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1465923882, "creation_date": 1465922210, "question_id": 37817648, "link": "https://stackoverflow.com/questions/37817648/golang-why-sql-placeholder-not-work", "title": "Golang - Why SQL placeholder not work?", "body": "<p>My code is as follow (I use gorm):</p>\n\n<pre><code>e.GET(\"/search\", func(c echo.Context) error {\n    keyword := c.QueryParam(\"keyword\")\n\n    results := make([]searchResult, 0)\n    if keyword != \"\" {\n        db, err := models.ConnectDB()\n        defer db.Close()\n        if err != nil {\n            return err\n        }\n\n        rows, err := db.Raw(\"SELECT songs.name, singers.name, albums.name FROM songs, singers, albums WHERE (songs.singer_id = singers.id AND songs.album_id = albums.id) AND (songs.name LIKE '%?%' OR singers.name LIKE '%?%' OR albums.name LIKE '%?%')\", keyword, keyword, keyword).Rows()\n        defer rows.Close()\n\n        var songName, singerName, albumName string\n        if err == nil {\n            for rows.Next() {\n                rows.Scan(&amp;songName, &amp;singerName, &amp;albumName)\n                results = append(results, searchResult{\n                    SongName:   songName,\n                    SingerName: singerName,\n                    AlbumName:  albumName,\n                })\n            }\n        } else {\n            return err\n        }\n    }\n    return c.Render(http.StatusOK, \"search\", results)\n})\n</code></pre>\n\n<p>I got error: <code>sql: statement expects 0 inputs; got 3</code>, so it means the placeholder didn't be parsed. Could anyone give me some idea? </p>\n\n<p>I can't find out why by myself.</p>\n\n<p>Please help me. Thanks.</p>\n"}, {"tags": ["web-services", "soap", "go", "xmlsec"], "comments": [{"owner": {"reputation": 30237, "user_id": 6371459, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/0DDLp.jpg?s=128&g=1", "display_name": "pedrofb", "link": "https://stackoverflow.com/users/6371459/pedrofb"}, "edited": false, "score": 0, "creation_date": 1465970988, "post_id": 37816740, "comment_id": 63117403, "body": "Implement XMLSignature from scratch really requires great effort. The signature value is calculated over the digest of the node &lt;SignedInfo&gt; after applying transforms and canonicalization. The node also includes the digest of the XML document. After this you have to fight with a lot of SOAP request parameters regarding security token. I do not know &#39;Go&#39;, but I suggest you use a framework for soap"}], "answers": [{"comments": [{"owner": {"reputation": 306, "user_id": 1205434, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9d611ff65ade7a460cb747868f40f38?s=128&d=identicon&r=PG", "display_name": "chatoooo", "link": "https://stackoverflow.com/users/1205434/chatoooo"}, "edited": false, "score": 1, "creation_date": 1465937774, "post_id": 37821834, "comment_id": 63107660, "body": "Well, that doesn&#39;t answers my question."}], "tags": [], "owner": {"reputation": 1, "user_id": 6368624, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4a107bcacfbb24b25bfd7b606d06712f?s=128&d=identicon&r=PG", "display_name": "goerr", "link": "https://stackoverflow.com/users/6368624/goerr"}, "is_accepted": false, "score": -1, "last_activity_date": 1465937416, "creation_date": 1465937416, "answer_id": 37821834, "question_id": 37816740, "link": "https://stackoverflow.com/questions/37816740/xml-signature-of-soap-body/37821834#37821834", "title": "XML Signature of SOAP Body", "body": "<p>calculate sha256 like this</p>\n\n<pre><code>import (\n\"crypto/sha256\"\n\n)\n\nvar slice = []byte(\"test\")\n\nreturn sha256.Sum256(slice)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 296, "user_id": 2219679, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6614807a87be61ccb2f41bfc79d336ea?s=128&d=identicon&r=PG", "display_name": "Stefan Babos", "link": "https://stackoverflow.com/users/2219679/stefan-babos"}, "edited": false, "score": 0, "creation_date": 1487625276, "post_id": 37833903, "comment_id": 71859369, "body": "Perfect answer."}], "tags": [], "owner": {"reputation": 306, "user_id": 1205434, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9d611ff65ade7a460cb747868f40f38?s=128&d=identicon&r=PG", "display_name": "chatoooo", "link": "https://stackoverflow.com/users/1205434/chatoooo"}, "is_accepted": true, "score": 2, "last_activity_date": 1465989411, "creation_date": 1465989411, "answer_id": 37833903, "question_id": 37816740, "link": "https://stackoverflow.com/questions/37816740/xml-signature-of-soap-body/37833903#37833903", "title": "XML Signature of SOAP Body", "body": "<p>Finally, I found how to get all values.</p>\n\n<ol>\n<li>Canonicalize XML element defined in &lt;SignedInfo&gt;&lt;Reference&gt;. In this case it's the &lt;soap:Body&gt; element. Canonicalization adds just soap namespace and adds closing tags. I'm generating these in Go and Go never generates self-closing tags.</li>\n<li>Calculate hash from a string representation of canonicalized &lt;soap:Body&gt; as it will be sent in a request.</li>\n<li>Add calculated digest into &lt;DigestValue&gt; of corresponding &lt;Reference&gt;.</li>\n<li>Canonicalize &lt;SignedInfo&gt; and calculate hash of it.</li>\n<li>Sign this hash and add value to &lt;SignedValue&gt;.</li>\n</ol>\n\n<p>I know that this is not a general approach but it should work for me. C14N is not necessary because Go can produce the same result if you pay attention to attributes order and manually add namespaces.</p>\n"}, {"tags": [], "owner": {"reputation": 117, "user_id": 1875068, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9733cf2cd0fe30073e7808312c9fe98b?s=128&d=identicon&r=PG", "display_name": "Joerg Veigel", "link": "https://stackoverflow.com/users/1875068/joerg-veigel"}, "is_accepted": false, "score": 2, "last_activity_date": 1472828649, "last_edit_date": 1472828649, "creation_date": 1472825496, "answer_id": 39294476, "question_id": 37816740, "link": "https://stackoverflow.com/questions/37816740/xml-signature-of-soap-body/39294476#39294476", "title": "XML Signature of SOAP Body", "body": "<p>Referring to the XML example CZ00000019.valid.v3.xml (of the Czech Fiscal Authority EET) the canonicized SignedInfo is:</p>\n\n<pre><code>var signedinfoCanon \n= '&lt;ds:SignedInfo xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;'\n+ '&lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"&gt;'\n+ '&lt;ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"soap\"&gt;&lt;/ec:InclusiveNamespaces&gt;'\n+ '&lt;/ds:CanonicalizationMethod&gt;'\n+ '&lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"&gt;&lt;/ds:SignatureMethod&gt;'\n+ '&lt;ds:Reference URI=\"#id-A72D6FD4C41B1F545F14700558808234\"&gt;'\n+ '&lt;ds:Transforms&gt;'\n+ '&lt;ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"&gt;'\n+ '&lt;ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"\"&gt;&lt;/ec:InclusiveNamespaces&gt;'\n+ '&lt;/ds:Transform&gt;'\n+ '&lt;/ds:Transforms&gt;'\n+ '&lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"&gt;&lt;/ds:DigestMethod&gt;'\n+ '&lt;ds:DigestValue&gt;4hn06sSS2yurIiUmWaV36JQJZrwbWf36sG9bOHH/ycM=&lt;/ds:DigestValue&gt;'\n+ '&lt;/ds:Reference&gt;'\n+ '&lt;/ds:SignedInfo&gt;'\n</code></pre>\n"}], "owner": {"reputation": 306, "user_id": 1205434, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/b9d611ff65ade7a460cb747868f40f38?s=128&d=identicon&r=PG", "display_name": "chatoooo", "link": "https://stackoverflow.com/users/1205434/chatoooo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2815, "favorite_count": 0, "accepted_answer_id": 37833903, "answer_count": 3, "score": 1, "last_activity_date": 1472828649, "creation_date": 1465919485, "question_id": 37816740, "link": "https://stackoverflow.com/questions/37816740/xml-signature-of-soap-body", "title": "XML Signature of SOAP Body", "body": "<p>I'm implementing a client for a WS which requires soap:body to be signed. The application is written in Go so I would prefer to avoid linking to C.</p>\n\n<p>The biggest issue is: how to calculate SHA256? What should be the input of digest algorithm? I assume that \"/CJj9686ARgbV/YmDrr+1yhcaJuXu022cADK/M8efQs=\" is a SHA256 result that is later signed. I tried many variations of canonicalized XML but none of them results in this hash.</p>\n\n<p>Here is an example of correct SOAP message</p>\n\n<pre><code>&lt;soap:Envelope xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n    &lt;SOAP-ENV:Header xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n        &lt;wsse:Security xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"\n                       xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"\n                       soap:mustUnderstand=\"1\"&gt;\n            &lt;wsse:BinarySecurityToken\n                    EncodingType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-soap-message-security-1.0#Base64Binary\"\n                    ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"\n                    wsu:Id=\"X509-16FE2A6FC1AFE42BE9146412186273511\"&gt;\n                MIID7DCCAtSgAwIBAgIEAQAABDANBgkqhkiG9w0BAQsFADBYMQswCQYDVQQGEwJDWjEaMBgGA1UEAwwRR0ZSIEVFVCB0ZXN0IENBIDExLTArBgNVBAoMJEdlbmVyw6FsbsOtIGZpbmFuxI1uw60gxZllZGl0ZWxzdHbDrTAeFw0xNjA1MTkxMjQ4MjVaFw0xODA1MTkxMjQ4MjVaMFQxCzAJBgNVBAYTAkNaMRMwEQYDVQQDDApDWjAwMDAwMDE5MRowGAYDVQQKDBFQcsOhdm5pY2vDoSBvc29iYTEUMBIGA1UEBRMLVDAwMDAwMDAwMDQwggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDFCIfnLl3YjNyxM3y2FAVovKQMetfyyj/lfLY3DoN1z/8gaVRfcqTZbwh9Btg0HafSmrWBvfgjEC/pG9HNawYZ9nPE+WIP9bXkoOfDTmmVtX4n6OLi2Di+U7+FmPJzykV0ujsOsfcGnQ0f63xZYoGJIwLJuz3gmAF//DfnOeTT7OUZeOKobBSYkQOKv1j05QqQZ7HP+5oq7+hNylFrjuEi5OAeVgJAYScE4COvcpqPKpb7OeR9f78knYFffg5zp/6bi6qkP5uGYEuuQvbW1mATjoqbAWz8c7HNA56uNFlz8V+z9bL0f/xwQjgy4d+5qelTX46tq0vJ2XM9dJaF8ytJAgMBAAGjgcEwgb4wHgYDVR0RBBcwFYETZXBvZHBvcmFAZnMubWZjci5jejAfBgNVHSMEGDAWgBR6WvwNy+w2pg3aaRlmjJvvgsOpNDAdBgNVHQ4EFgQU8oKPLNlNY0/h8jWEmz3EZ1O3bBMwTAYDVR0gBEUwQzBBBgpghkgBZQMCATACMDMwMQYIKwYBBQUHAgIwJRojVGVudG8gY2VydGlmaWthdCBKRSBQT1VaRSBURVNUT1ZBQ0kwDgYDVR0PAQH/BAQDAgbAMA0GCSqGSIb3DQEBCwUAA4IBAQBVulEYg6noEHqAW3DfNWLvW9XdHFZQj3L5EE3Nwdd0CtMZm4/RZ/CvSENkk+GWv0YCUqHPJzhcKs0NETMKW7L6CI+hY17rD5SHhuoCYzSMlcuMA6gZJr8wIxSWerQrvuZ4uAUMistWG9cgwETZjkGU9JK+H98wdAm2co7WaRweDsNx04aSXagUMDAmRY/jNe7c8/HvwIdnXftbIl56wbYlYiCIG2qS+6lVO+09EIEP40kz1PXlqFZbPLCSlT2YsYiqizfkCX/Ka+AebJykAQ3pOqD6PQ+Y2AMAIRX8AypcN6Yj9p+oof9rda8boA8rA7wwzlJs/+ipWt2ceqPPuL9x\n            &lt;/wsse:BinarySecurityToken&gt;\n            &lt;ds:Signature xmlns:ds=\"http://www.w3.org/2000/09/xmldsig#\" Id=\"SIG-16FE2A6FC1AFE42BE9146412186273615\"&gt;\n                &lt;ds:SignedInfo&gt;\n                    &lt;ds:CanonicalizationMethod Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"&gt;\n                        &lt;ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\" PrefixList=\"soap\"/&gt;\n                    &lt;/ds:CanonicalizationMethod&gt;\n                    &lt;ds:SignatureMethod Algorithm=\"http://www.w3.org/2001/04/xmldsig-more#rsa-sha256\"/&gt;\n                    &lt;ds:Reference URI=\"#id-16FE2A6FC1AFE42BE9146412186273614\"&gt;\n                        &lt;ds:Transforms&gt;\n                            &lt;ds:Transform Algorithm=\"http://www.w3.org/2001/10/xml-exc-c14n#\"&gt;\n                                &lt;ec:InclusiveNamespaces xmlns:ec=\"http://www.w3.org/2001/10/xml-exc-c14n#\"\n                                                        PrefixList=\"\"/&gt;\n                            &lt;/ds:Transform&gt;\n                        &lt;/ds:Transforms&gt;\n                        &lt;ds:DigestMethod Algorithm=\"http://www.w3.org/2001/04/xmlenc#sha256\"/&gt;\n                        &lt;ds:DigestValue&gt;/CJj9686ARgbV/YmDrr+1yhcaJuXu022cADK/M8efQs=&lt;/ds:DigestValue&gt;\n                    &lt;/ds:Reference&gt;\n                &lt;/ds:SignedInfo&gt;\n                &lt;ds:SignatureValue&gt;\n                    Ii+W0EB2V6GJo4jMGwK1HCRdt6+r9TkgfhXyAuY8FNCXhPOtfoUi/Bw31U4Hm7SLscM/8klrQI3Z2vSfdNe3oDi1cm2Qouv1sOBK17VSg/IgKN92BC8kUaoF5W5ZBEcZr0WHjDWasSYEerZQ3Q+ZIJzt6cbS+cLZfQkLFg1UDOi5qLUkWE1pQ9AVYCvwrOFj/hFQx5koQTpigyG/DPlyoh2xOh/DAh6U/P5p+IiQwwCMdo1Rh2czUVpRCr3Cnz97AlQ8G6IGAtWNykXorVYZ1tGnXEaRngzjsn5RE/zCcRkqRpFaiEQuYly1I6YtFOEYIPXskE5oMZkCLINebu1Law==\n                &lt;/ds:SignatureValue&gt;\n                &lt;ds:KeyInfo Id=\"KI-16FE2A6FC1AFE42BE9146412186273512\"&gt;\n                    &lt;wsse:SecurityTokenReference\n                            xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\"\n                            xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"\n                            wsu:Id=\"STR-16FE2A6FC1AFE42BE9146412186273513\"&gt;\n                        &lt;wsse:Reference URI=\"#X509-16FE2A6FC1AFE42BE9146412186273511\"\n                                        ValueType=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-x509-token-profile-1.0#X509v3\"/&gt;\n                    &lt;/wsse:SecurityTokenReference&gt;\n                &lt;/ds:KeyInfo&gt;\n            &lt;/ds:Signature&gt;\n        &lt;/wsse:Security&gt;\n    &lt;/SOAP-ENV:Header&gt;\n    &lt;soap:Body xmlns:wsu=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd\"\n               wsu:Id=\"id-16FE2A6FC1AFE42BE9146412186273614\"&gt;\n        &lt;Trzba xmlns=\"http://fs.mfcr.cz/eet/schema/v2\"&gt;\n            &lt;Hlavicka dat_odesl=\"2016-09-19T19:06:37+01:00\" prvni_zaslani=\"false\"\n                      uuid_zpravy=\"9edeb22b-4234-4047-869c-3a76f86c20d3\"/&gt;\n            &lt;Data celk_trzba=\"34113.00\" cerp_zuct=\"679.00\" cest_sluz=\"5460.00\" dan1=\"-172.39\" dan2=\"-530.73\"\n                  dan3=\"975.65\" dat_trzby=\"2016-01-05T00:30:12+01:00\" dic_popl=\"CZ00000019\" id_pokl=\"/5546/RO24\"\n                  id_provoz=\"273\" porad_cis=\"0/6460/ZQ42\" pouzit_zboz1=\"784.00\" pouzit_zboz2=\"967.00\"\n                  pouzit_zboz3=\"189.00\" rezim=\"0\" urceno_cerp_zuct=\"324.00\" zakl_dan1=\"-820.92\" zakl_dan2=\"-3538.20\"\n                  zakl_dan3=\"9756.46\" zakl_nepodl_dph=\"3036.00\"/&gt;\n            &lt;KontrolniKody&gt;\n                &lt;pkp cipher=\"RSA2048\" digest=\"SHA256\" encoding=\"base64\"&gt;\n                    W7UlA4hXNsDLvCj/eeRAYeOAsNsgMSdltcJNIW98KQRsfspTMW0Lr/OGQgRHZfO5KjolZgzN3k9mgzrVoX2+N90fCNEnOri2kjrW5vzTgMK6OZ9IryAEg0xFZjjjCQ0qKsQsVi8OLQOn3ZnN/BUGG2SIduER+iIOrhfOmes7OXaa5/2jQSfPTHZHZ/Bxhqld3gL4PHvd7sevZYUupHpE1fM7Uw1+lu8i1YOdghZoMyOfKw7FcqvRJpHrW/JZL5Dr5iCgu5ClmhZrb3hZavsxlDG7P2cUhSQgmEVTxJ2n38q/Cf91KE8e52SODN4Q8BfncXpmtkQ7Go3KsRsY3xN7xg==\n                &lt;/pkp&gt;\n                &lt;bkp digest=\"SHA1\" encoding=\"base16\"&gt;1F1A2D90-4EAD34A8-411CFB0B-EB17616E-B2CE8114&lt;/bkp&gt;\n            &lt;/KontrolniKody&gt;\n        &lt;/Trzba&gt;\n    &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;\n</code></pre>\n"}, {"tags": ["go", "character-encoding", "go-templates"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1465916029, "post_id": 37815242, "comment_id": 63095031, "body": "Why do you need to escape / use entities for those characters?  They&#39;re fine in both utf-8 and iso-8859-1 encodings, I believe..."}, {"owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1465916190, "post_id": 37815242, "comment_id": 63095170, "body": "because i&#39;m a german guy living in Sweden, so data (e.g. last names) may contain these characters and currently an &quot;&#246;&quot; looks like &quot;&#195;&#182;&quot;."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1465916222, "post_id": 37815242, "comment_id": 63095197, "body": "What character encoding is your HTML document specifying?  (ideally, can you link us to the page you are viewing?   server can override document setting...)"}, {"owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1465916330, "post_id": 37815242, "comment_id": 63095305, "body": "none :D which should i use? (yes, the answer may be so simple) &lt;!DOCTYPE html&gt; &lt;html&gt; ..."}, {"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1465916356, "post_id": 37815242, "comment_id": 63095335, "body": "Try adding <code>&lt;meta http-equiv=&quot;Content-Type&quot; content=&quot;text&#47;html; charset=utf-8&quot; &#47;&gt;</code> in the <code>&lt;head&#47;&gt;</code>..."}, {"owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "reply_to_user": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 0, "creation_date": 1465916557, "post_id": 37815242, "comment_id": 63095515, "body": "yes, that fixed it! Do you want to write an Answer so i can click on &quot;answered&quot; and you get some points?"}], "answers": [{"tags": [], "owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "is_accepted": true, "score": 1, "last_activity_date": 1465916668, "creation_date": 1465916668, "answer_id": 37815720, "question_id": 37815242, "link": "https://stackoverflow.com/questions/37815242/how-to-escape-special-characters-other-than-in-golang-templates/37815720#37815720", "title": "How to escape special characters (other than &lt;&gt;&amp;&#39;&quot;) in golang templates?", "body": "<p>These characters are fine as-is in modern browsers, but you'll need to specify a character encoding in your webpage.</p>\n\n<p>Add the line </p>\n\n<pre><code>&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=utf-8\" /&gt; \n</code></pre>\n\n<p>in your document's head.</p>\n\n<p>For more on character encodings in HTML, see the <a href=\"https://www.w3.org/International/questions/qa-html-encoding-declarations.en\" rel=\"nofollow\">W3C documentation</a>.</p>\n"}], "owner": {"reputation": 596, "user_id": 4515050, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/88TBE.jpg?s=128&g=1", "display_name": "StephanS", "link": "https://stackoverflow.com/users/4515050/stephans"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4865, "favorite_count": 0, "accepted_answer_id": 37815720, "answer_count": 1, "score": 1, "last_activity_date": 1465916682, "creation_date": 1465915443, "last_edit_date": 1465916682, "question_id": 37815242, "link": "https://stackoverflow.com/questions/37815242/how-to-escape-special-characters-other-than-in-golang-templates", "title": "How to escape special characters (other than &lt;&gt;&amp;&#39;&quot;) in golang templates?", "body": "<p>Go templates auto-escape but only the five characters &lt;>&amp;' and \" (see <a href=\"https://golang.org/pkg/html/#EscapeString\" rel=\"nofollow\">html.EscapeString</a>)</p>\n\n<p>so this code like</p>\n\n<pre><code>check := func(err error) {\n    if err != nil {\n        log.Fatal(err)\n    }\n}\nt, err := template.New(\"foo\").Parse(`{{define \"T\"}}special chars: {{.}}{{end}}`)\ncheck(err)\nerr = t.ExecuteTemplate(os.Stdout, \"T\", \"&lt;&gt;&amp;' \u00e4\u00e5\u00fc\u00f6\u00df\")\ncheck(err)\n</code></pre>\n\n<p>returns (as you can check here: <a href=\"https://play.golang.org/p/q8B-8kM_GL\" rel=\"nofollow\">Go Playground</a>)</p>\n\n<pre><code>special chars: &amp;lt;&amp;gt;&amp;amp;&amp;#39; \u00e4\u00e5\u00fc\u00f6\u00df\n</code></pre>\n\n<p>So how do i use golang templates to render text that may contain characters like \u00e4\u00e5\u00fc\u00f6\u00df?</p>\n\n<p>It's not like i could escape these myself, because e.g. \"\u00e4\" escapes to \"&amp;auml;\" which means that efter i escape manually, golang just escapes the \"&amp;\" character part of that a second time and i get \"&amp;amp;auml;\" (but the html-file should contain a single escaped \"&amp;auml;\" so that the browser displays an \"&auml;\").</p>\n"}, {"tags": ["string", "go", "int", "scanf"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1465911092, "creation_date": 1465911092, "answer_id": 37813566, "question_id": 37813173, "link": "https://stackoverflow.com/questions/37813173/golang-scan-in-string-or-int/37813566#37813566", "title": "golang scan in string or int", "body": "<p>Your <code>default</code> case is first, so nothing else can ever match. Put that at the end. You can't scan into a value, you need a pointer, so change the type switch cases to their pointer equivalents.</p>\n\n<pre><code>switch t := input.(type) {\ncase *int:\n    _, err = fmt.Scanf(\"%d\", input)\ncase *string:\n    _, err = fmt.Scanf(\"%s\", input)\ndefault:\n    fmt.Printf(\"unexpected type %T\", t)\n}\n</code></pre>\n\n<p>You have to pass in a pointer to the interface argument, so use the use <code>&amp;</code> operator there.</p>\n\n<pre><code>var firstName string\ngetUserInput(&amp;firstName)\n\nvar age int\ngetUserInput(&amp;age)\n</code></pre>\n\n<ul>\n<li>You lose the input, or only read part of it if you try to scan the wrong type. If you want to scan for multiple types, it's often better to read the token from stdin, and check that against the types you want. Not only do you then have the input for comparison, but you also have it to produce useful error messages.</li>\n</ul>\n"}], "owner": {"reputation": 433, "user_id": 2138979, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/7e694c0612733c362cbc9ef02620f37a?s=128&d=identicon&r=PG", "display_name": "Matthew", "link": "https://stackoverflow.com/users/2138979/matthew"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4140, "favorite_count": 0, "accepted_answer_id": 37813566, "answer_count": 1, "score": 4, "last_activity_date": 1465911092, "creation_date": 1465910148, "question_id": 37813173, "link": "https://stackoverflow.com/questions/37813173/golang-scan-in-string-or-int", "title": "golang scan in string or int", "body": "<p>I'm trying to write a function to input either a string or int something like the below, but can't find a way to do it...\nNot sure what I'm doing though, quite new to go....</p>\n\n<pre><code>func getUserInput(input interface{}) (int, error) {\n\n    var err error\n\n    switch t := input.(type) {\n    default:\n        fmt.Printf(\"unexpected type %T\", t)\n    case int:\n        _, err = fmt.Scanf(\"%d\", input)\n    case string:\n        _, err = fmt.Scanf(\"%s\", input)\n    }\n\n    if err != nil {\n        return 0, err\n    }\n\n    return 0, nil\n}\n</code></pre>\n\n<p>and then use it something like (this doesn't work though!):</p>\n\n<pre><code>var firstName string\ngetUserInput(firstName)\n\nvar age int\ngetUserInput(age)\n</code></pre>\n"}, {"tags": ["go", "go-templates", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 2262, "user_id": 2229600, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/jSDJ2.jpg?s=128&g=1", "display_name": "kikulikov", "link": "https://stackoverflow.com/users/2229600/kikulikov"}, "edited": false, "score": 0, "creation_date": 1465914991, "post_id": 37814341, "comment_id": 63094187, "body": "Thank you! The resource is really useful."}, {"owner": {"reputation": 526, "user_id": 1035977, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/310abc9d873d41cede1258891d6bcaf3?s=128&d=identicon&r=PG", "display_name": "Gwyneth Llewelyn", "link": "https://stackoverflow.com/users/1035977/gwyneth-llewelyn"}, "edited": false, "score": 1, "creation_date": 1591620194, "post_id": 37814341, "comment_id": 110116070, "body": "Another useful resource is <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\">golang.org/pkg/text/template</a> \u2014 that&#39;s the official documentation for templates. It&#39;s not as well done as what @pie-oh-pah posted, but at least it&#39;s clear what is part of the &#39;official&#39; documentation, and what is specific to <code>Hugo</code>."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 6, "last_activity_date": 1465913185, "creation_date": 1465913185, "answer_id": 37814341, "question_id": 37813067, "link": "https://stackoverflow.com/questions/37813067/how-to-use-templates-in-go-gin-for-dynamic-content/37814341#37814341", "title": "How to use templates in Go Gin for dynamic content", "body": "<p>You can use <code>define</code> to define partials and <code>template</code> to mix multiple HTML partials.</p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n\n    \"github.com/gin-gonic/gin\"\n)\n\nvar (\n    partial1 = `{{define \"elm1\"}}&lt;div&gt;element1&lt;/div&gt;{{end}}`\n    partial2 = `{{define \"elm2\"}}&lt;div&gt;element2&lt;/div&gt;{{end}}`\n    body     = `{{template \"elm1\"}}{{template \"elm2\"}}`\n)\n\nfunc main() {\n    // Or use `ParseFiles` to parse tmpl files instead \n    t := template.Must(template.New(\"elements\").Parse(body))\n\n    app := gin.Default()\n    app.GET(\"/\", func(c *gin.Context) {\n        c.HTML(200, \"elements\", nil)\n    })\n    app.Run(\":8000\")\n}\n</code></pre>\n\n<p>This is a good place to read <a href=\"https://gohugo.io/templates/go-templates/\" rel=\"noreferrer\">https://gohugo.io/templates/go-templates/</a></p>\n"}], "owner": {"reputation": 2262, "user_id": 2229600, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/jSDJ2.jpg?s=128&g=1", "display_name": "kikulikov", "link": "https://stackoverflow.com/users/2229600/kikulikov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7236, "favorite_count": 1, "accepted_answer_id": 37814341, "answer_count": 1, "score": 7, "last_activity_date": 1465913185, "creation_date": 1465909904, "last_edit_date": 1465910389, "question_id": 37813067, "link": "https://stackoverflow.com/questions/37813067/how-to-use-templates-in-go-gin-for-dynamic-content", "title": "How to use templates in Go Gin for dynamic content", "body": "<p>I have a simple Go / Gin web app. I need to put some dynamic content in html template.</p>\n\n<p>For e.g. I have a few tables (the number is dynamic) with a few rows (the number is dynamic). I need to put them in html template. Is there any way to combine templates in code? I'd prefer to use templates rather than build tables in the code.</p>\n\n<p>I've checked a tutorial <a href=\"https://github.com/gin-gonic/gin\" rel=\"noreferrer\">https://github.com/gin-gonic/gin</a> but it is not covered there.</p>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465910248, "post_id": 37810455, "comment_id": 63090474, "body": "Are you using the latest version of revel? It&#39;s calling the go command with invalid parameters. (or are you adding an <code>-ldflags -X</code> option somewhere?)"}, {"owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465920044, "post_id": 37810455, "comment_id": 63098164, "body": "Yeah I am using version v0.13.1. No I am not adding any flag here."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465920602, "post_id": 37810455, "comment_id": 63098510, "body": "It looks like the revel command hasn&#39;t been kept up to date, and the <code>github.com&#47;revel&#47;cmd&#47;harness</code> package doesn&#39;t format the linker flags correctly. You can bypass this by not using the <code>watch</code> option (or you can patch the build.go file in the harness package)"}, {"owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465986066, "post_id": 37810455, "comment_id": 63126553, "body": "@JimB I have checked both revel and revel cmd are on v0.12.0 now, but same problem."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465987824, "post_id": 37810455, "comment_id": 63127793, "body": "I&#39;m not saying you&#39;re doing anything wrong, the revel command is broken. I think you can disable the &quot;watch&quot; option, use an older release of go, or patch the ldflags option on the revel source."}], "owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 837, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1465986350, "creation_date": 1465902985, "last_edit_date": 1465986350, "question_id": 37810455, "link": "https://stackoverflow.com/questions/37810455/revel-x-flag-requires-argument-of-the-form-importpath-name-value", "title": "Revel: -X flag requires argument of the form importpath.name=value", "body": "<p>I am getting following error on running revel app in development mode. I am posting logs below</p>\n\n<pre><code>INFO  2016/06/14 16:18:17 build.go:172: Cleaning dir tmp\nINFO  2016/06/14 16:18:17 build.go:172: Cleaning dir routes\n2016/06/14 16:18:17 reflect.go:728: Failed to generate name for field. Make sure the field name is valid.\n2016/06/14 16:18:17 reflect.go:728: Failed to generate name for field. Make sure the field name is valid.\n2016/06/14 16:18:17 reflect.go:728: Failed to generate name for field. Make sure the field name is valid.\nINFO  2016/06/14 16:18:17 build.go:172: Cleaning dir tmp\nINFO  2016/06/14 16:18:17 build.go:172: Cleaning dir routes\nERROR 2016/06/14 16:18:19 build.go:101: # gocars-api-core/app/tmp\n/home/deploy/.gvm/gos/go1.6/pkg/tool/linux_amd64/link: -X flag requires argument of the form importpath.name=value\n\nERROR 2016/06/14 16:18:19 build.go:298: Failed to parse build errors:\n # gocars-api-core/app/tmp\n/home/deploy/.gvm/gos/go1.6/pkg/tool/linux_amd64/link: -X flag requires argument of the form importpath.name=value\n</code></pre>\n\n<p>Also on running revel build I am getting following error</p>\n\n<pre><code>deploy@ip-172-xx-xx-x9 ~/gocars $ revel build gocars-api-core ./buiding1\n~\n~ revel! http://revel.github.io\n~\nINFO  2016/06/15 15:52:51 revel.go:365: Loaded module static\nINFO  2016/06/15 15:52:51 revel.go:230: Initialized Revel v0.13.1 (2016-06-06) for &gt;= go1.4\nINFO  2016/06/15 15:52:51 build.go:172: Cleaning dir tmp\nINFO  2016/06/15 15:52:51 build.go:172: Cleaning dir routes\n2016/06/15 15:52:51 reflect.go:728: Failed to generate name for field. Make sure the field name is valid.\n2016/06/15 15:52:51 reflect.go:728: Failed to generate name for field. Make sure the field name is valid.\n2016/06/15 15:52:51 reflect.go:728: Failed to generate name for field. Make sure the field name is valid.\nINFO  2016/06/15 15:52:51 build.go:172: Cleaning dir tmp\nINFO  2016/06/15 15:52:51 build.go:172: Cleaning dir routes\nTRACE 2016/06/15 15:52:51 build.go:94: Exec: [/home/deploy/.gvm/gos/go1.6/bin/go build -ldflags -X gocars-api-core/app.APP_VERSION \"\" -tags  -o /home/deploy/gocars/bin/revel.d/gocars-api-core/gocars-api-core gocars-api-core/app/tmp]\nERROR 2016/06/15 15:52:54 build.go:101: # gocars-api-core/app/tmp\n/home/deploy/.gvm/gos/go1.6/pkg/tool/linux_amd64/link: -X flag requires argument of the form importpath.name=value\n\nERROR 2016/06/15 15:52:54 build.go:298: Failed to parse build errors:\n # gocars-api-core/app/tmp\n/home/deploy/.gvm/gos/go1.6/pkg/tool/linux_amd64/link: -X flag requires argument of the form importpath.name=value\n</code></pre>\n\n<p>I am new to revel and not sure why this compilation error is coming?</p>\n"}, {"tags": ["c#", "sockets", "go", "tcp", "localhost"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1465901858, "post_id": 37809702, "comment_id": 63084151, "body": "use 127.0.0.1. For all practical purposes it is always defined."}], "answers": [{"tags": [], "owner": {"reputation": 57221, "user_id": 3032289, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9c171ec0f2c8040d24436a40a3bf075b?s=128&d=identicon&r=PG", "display_name": "Luaan", "link": "https://stackoverflow.com/users/3032289/luaan"}, "is_accepted": true, "score": 3, "last_activity_date": 1465901923, "creation_date": 1465901923, "answer_id": 37810070, "question_id": 37809702, "link": "https://stackoverflow.com/questions/37809702/which-address-to-use-for-local-tcp-server/37810070#37810070", "title": "Which address to use for local TCP server?", "body": "<p><code>IPAddress.Loopback</code> is what you're looking for. You still have a separate address for IPv6, though - <code>IPAddress.IPv6Loopback</code>. The two correspond to <code>127.0.0.1</code> and <code>::1</code> respectively, by definition - it's part of the IP standard.</p>\n\n<p>If you want to have the server available from other computers as well, <code>IPAddress.Any</code> (and <code>IPAddress.IPv6Any</code> for IPv6) binds to all the NICs on the system.</p>\n\n<p>In general, there is no way to have a common solution that uses IPv4 and IPv6 \"natively\", since the two protocols are really entirely separate (with an IPv4 \"fallback\" in IPv6 - however, it isn't widely supported, and nobody really uses it). This is not a big deal on localhost, though - just try to bind <code>IPAddress.Loopback</code>, and if it fails, try <code>IPAddress.IPv6Loopback</code>.</p>\n"}], "owner": {"reputation": 735, "user_id": 190833, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c214bae9cd1b284a7006c2d725392747?s=128&d=identicon&r=PG", "display_name": "FrontierPsycho", "link": "https://stackoverflow.com/users/190833/frontierpsycho"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1923, "favorite_count": 0, "accepted_answer_id": 37810070, "answer_count": 1, "score": 3, "last_activity_date": 1465901923, "creation_date": 1465900874, "question_id": 37809702, "link": "https://stackoverflow.com/questions/37809702/which-address-to-use-for-local-tcp-server", "title": "Which address to use for local TCP server?", "body": "<p>I'm writing a system where two programs will asynchronously communicate over a TCP socket. The client is written in golang, but the server might vary. I'm currently writing one in C#.</p>\n\n<p>During development, I used</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>conn, err := net.Dial(\"tcp\", net.JoinHostPort(\"127.0.0.1\", strconv.Itoa(d.port)))\n</code></pre>\n\n<p>for the client, and on the server I did:</p>\n\n<pre class=\"lang-cs prettyprint-override\"><code>this.listener = new TcpListener(IPAddress.Parse(\"127.0.0.1\"), port);\n</code></pre>\n\n<p>However, for production, I suspect that might not work in all cases. For example, the user might use IPv6. I also tried <code>localhost</code> on the server, but on Windows that doesn't seem to be the same as <code>127.0.0.1</code> by default (it has to be enabled, which is not an option).</p>\n\n<p>Is there a more fool-proof way of running a local TCP server, that should work in all cases?</p>\n"}, {"tags": ["vim", "go", "youcompleteme"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1465913707, "post_id": 37808985, "comment_id": 63093136, "body": "this belongs on their issue tracker not here imo"}, {"owner": {"reputation": 534, "user_id": 2251364, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c387b641bba38ce5779f088c8f24ebdf?s=128&d=identicon&r=PG", "display_name": "Hritik", "link": "https://stackoverflow.com/users/2251364/hritik"}, "edited": false, "score": 0, "creation_date": 1600729204, "post_id": 37808985, "comment_id": 113173958, "body": "YCM currently only supports <i>canonical</i> file structures. You might want to stick with vim-go for a while."}], "answers": [{"tags": [], "owner": {"reputation": 1096, "user_id": 2810981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2bc5e190a5230f2271826504866bd0f2?s=128&d=identicon&r=PG", "display_name": "timfeirg", "link": "https://stackoverflow.com/users/2810981/timfeirg"}, "is_accepted": false, "score": 2, "last_activity_date": 1466051077, "creation_date": 1466051077, "answer_id": 37849885, "question_id": 37808985, "link": "https://stackoverflow.com/questions/37808985/youcompleteme-gotodefinition-command-for-golang/37849885#37849885", "title": "youcompleteme GoToDefinition command for golang", "body": "<p>I haven't been reading the docs carefully, it's <code>:YcmCompleter GoTo</code></p>\n"}], "owner": {"reputation": 1096, "user_id": 2810981, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/2bc5e190a5230f2271826504866bd0f2?s=128&d=identicon&r=PG", "display_name": "timfeirg", "link": "https://stackoverflow.com/users/2810981/timfeirg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 799, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1466051077, "creation_date": 1465898827, "question_id": 37808985, "link": "https://stackoverflow.com/questions/37808985/youcompleteme-gotodefinition-command-for-golang", "title": "youcompleteme GoToDefinition command for golang", "body": "<p>I've installed <a href=\"https://github.com/timfeirg/workspace-setup/blob/master/.vimrc#L53\" rel=\"nofollow\">YouCompleteMe</a> for my vim, alongside <code>vim-go</code> and <code>gocode</code>, I think I've done every step right but there's no <code>GoToDefinition</code> command in vim.</p>\n\n<p><code>GoDef</code> works great, but can ycm goto commands be made available for golang?</p>\n"}, {"tags": ["go", "struct", "interface"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1465900174, "post_id": 37808237, "comment_id": 63082969, "body": "Rule of thumb: If you do not understand <code>interface{}</code> do not use it."}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1465902492, "post_id": 37808237, "comment_id": 63084622, "body": "in fact, i don&#39;t want to use, but many library function&#39;s iput parameter is interface{} type"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465900795, "post_id": 37808328, "comment_id": 63083373, "body": "when convert , it just assign the underlying pointer ? or need to make a new tmp object ,then copy value?"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465901213, "post_id": 37808328, "comment_id": 63083665, "body": "Nope. A copy of value in above sample."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465901350, "post_id": 37808328, "comment_id": 63083770, "body": "Similarly when you convert it to value like k := v.(Person), it uses a  new value. But that&#39;s not the only cost then, type checking is one more cost."}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465902317, "post_id": 37808328, "comment_id": 63084495, "body": "sorry, v = p, if the assignment  follow the three step, first allocate a new object on heap, second copy p values to new object, third, assign the v pointer to new object, the asssignment cost is very expensive, if the p object size is big"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465902419, "post_id": 37808328, "comment_id": 63084564, "body": "Yes. But that cost will remain even if you assign to another struct var.  Or copy to another value. What&#39;s different from a struct to interface will be type checking cost and underlying type cost. Will modify my answer with this clarification."}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465902673, "post_id": 37808328, "comment_id": 63084744, "body": "i have long time c experience, if v =p need to copy value, i have to use pointer to avoid the copy process, i hope the v can just hold the pointer to p, then it don&#39;t need to copy underlying value"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465903030, "post_id": 37808328, "comment_id": 63084999, "body": "@DongLiu You can avoid that too in interface using pointer. Check here <a href=\"https://play.golang.org/p/Or62SdNG-S\" rel=\"nofollow noreferrer\">play.golang.org/p/Or62SdNG-S</a>"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465903074, "post_id": 37808328, "comment_id": 63085032, "body": "But there&#39;s one more additional cost as I said, cost of underlying type and during conversion, type checking."}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465903328, "post_id": 37808328, "comment_id": 63085211, "body": "i suspect ,  v = p doesn&#39;t copy value,  the copy process happens when execute following code  p1, ok := v.(Person)"}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465903481, "post_id": 37808328, "comment_id": 63085352, "body": "i can&#39;t access the url\uff1a play.golang.org/p/8BbTsIXZOt  , the reply is forbbiden"}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465903713, "post_id": 37808328, "comment_id": 63085537, "body": "yes, play.golang.org is normal, <a href=\"https://play.golang.org/p/8BbTsIXZOt\" rel=\"nofollow noreferrer\">play.golang.org/p/8BbTsIXZOt</a> can&#39;t access, you can send the content via email liudong9183@163.com"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465903714, "post_id": 37808328, "comment_id": 63085538, "body": "I created both here:  <a href=\"https://gist.github.com/khrm/26e4e71ec08fac6af303b0a632a52197\" rel=\"nofollow noreferrer\">gist.github.com/khrm/26e4e71ec08fac6af303b0a632a52197</a>"}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465903764, "post_id": 37808328, "comment_id": 63085566, "body": "how to prove your idea?"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465903840, "post_id": 37808328, "comment_id": 63085639, "body": "In that you will see that changing the value in struct isn&#39;t changing the value in interface"}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465904037, "post_id": 37808328, "comment_id": 63085750, "body": "i read the code, maybe you &#39;re right..i need to think ..i use json.Marshal(v interface{}) function,  the object is very large, the cost of copy is hard to accept.."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465904092, "post_id": 37808328, "comment_id": 63085792, "body": "Don&#39;t use interface to marshal if you know the struct. Use struct."}, {"owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465904265, "post_id": 37808328, "comment_id": 63085921, "body": "json.Marshal is offical library function, it use interface{} as input parameter type"}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "reply_to_user": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "edited": false, "score": 0, "creation_date": 1465904756, "post_id": 37808328, "comment_id": 63086288, "body": "Welcome. Accept if it was useful. I would recommend ffjson for marshalling if performance is a factor."}], "tags": [], "owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "is_accepted": true, "score": 4, "last_activity_date": 1465902566, "last_edit_date": 1465902566, "creation_date": 1465897140, "answer_id": 37808328, "question_id": 37808237, "link": "https://stackoverflow.com/questions/37808237/what-happend-when-golang-convert-struct-to-interface-what-is-the-cost/37808328#37808328", "title": "what happend when golang convert struct to interface{} ? what is the cost?", "body": "<p>Interface{} is a type. It consists of two things : underlying type and underlying value. Size doesn't matter. Cost is that every time convert it or to it, you incur cost. One thing that size effect is value during copying from struct to interface underlying value. But this cost is similar to one you get when you assign to a struct or copy to a struct. The additional cost of interface isn't affected by size.</p>\n\n<p>You don't need that function to convert, you can convert it like this:</p>\n\n<pre><code>func main() {\n    p := Person{\"test\", 11}\n    // how to build an interface{} object from person struct?\n    // what is the cost? the field need copy?\n    var v interface{}\n    v = p    \n}\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6463592, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dc99adeff5ce353a4351b6456fb0534e?s=128&d=identicon&r=PG&f=1", "display_name": "Dong Liu", "link": "https://stackoverflow.com/users/6463592/dong-liu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4534, "favorite_count": 1, "accepted_answer_id": 37808328, "answer_count": 1, "score": 2, "last_activity_date": 1465902566, "creation_date": 1465896921, "last_edit_date": 1465897216, "question_id": 37808237, "link": "https://stackoverflow.com/questions/37808237/what-happend-when-golang-convert-struct-to-interface-what-is-the-cost", "title": "what happend when golang convert struct to interface{} ? what is the cost?", "body": "<p>i'm confused about interface{} type,<br>\nhow to build an interface{} object from Person struct?<br>\nif the struct is very big,  the conversion cost whether is expensive  </p>\n\n<pre><code>type Person struct {  \n  name string  \n  age  int  \n} \n\nfunc test(any interface{}) {  \n\n} \n\nfunc main() {  \n    p := Person{\"test\", 11}\n    // how to build an interface{} object from person struct? \n    // what is the cost? the field need copy?\n    test(p) \n}\n</code></pre>\n"}, {"tags": ["go", "lexical-scope"], "comments": [{"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "edited": false, "score": 0, "creation_date": 1465897358, "post_id": 37808177, "comment_id": 63080959, "body": "You are not redefine nothing. In your code inside the main you are declaring err and then assign two values foreach variable"}], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 5, "last_activity_date": 1465897398, "creation_date": 1465897398, "answer_id": 37808457, "question_id": 37808177, "link": "https://stackoverflow.com/questions/37808177/understanding-lexical-scoping-in-golang/37808457#37808457", "title": "Understanding lexical scoping in golang", "body": "<blockquote>\n  <p>My understanding is that the := operator creates variables which are\n  not defined and hence, only err has to get defined.</p>\n</blockquote>\n\n<p>This is expected and your workaround is OK. It is described in some detail in <a href=\"https://golang.org/doc/effective_go.html\" rel=\"noreferrer\">Effective Go</a>.</p>\n\n<blockquote>\n  <p>In a <code>:=</code> declaration a variable v may appear even if it has already\n  been declared, provided:</p>\n  \n  <ul>\n  <li>this declaration is in the same scope as the existing declaration of v\n  (<strong>if v is already declared in an outer scope, the declaration will\n  create a new variable</strong> \u00a7),</li>\n  <li>the corresponding value in the\n  initialization is assignable to v, and</li>\n  <li>there is at least one other\n  variable in the declaration that is being declared anew.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 963, "user_id": 385280, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/82d083ee140420fe7acde11d5109a311?s=128&d=identicon&r=PG", "display_name": "Venkat", "link": "https://stackoverflow.com/users/385280/venkat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 796, "favorite_count": 0, "accepted_answer_id": 37808457, "answer_count": 1, "score": 2, "last_activity_date": 1465897398, "creation_date": 1465896756, "question_id": 37808177, "link": "https://stackoverflow.com/questions/37808177/understanding-lexical-scoping-in-golang", "title": "Understanding lexical scoping in golang", "body": "<p><a href=\"https://play.golang.org/p/kK9c71Yt9N\" rel=\"nofollow\">https://play.golang.org/p/kK9c71Yt9N</a> - This is the code I'm working off of.</p>\n\n<p>I'm trying to understand lexical scoping for the variable <code>X</code>. If I use the <code>:=</code> operator in line 11, <code>X</code> defined outside of <code>func main</code> gets hidden and a new scope is getting created within the function. If I use the <code>=</code> operator in the same line, the compiler complains that <code>err</code> is undefined.</p>\n\n<p>My understanding is that the <code>:=</code> operator creates variables which are not defined and hence, only <code>err</code> has to get defined. But, this understanding is clearly wrong. </p>\n\n<p>What code changes can I do to make sure <code>X</code> is not redefined within <code>main()</code>?</p>\n\n<p>I know I can do the following to make sure <code>X</code> is not redefined within <code>main()</code>:</p>\n\n<pre><code>var err error\nX, err = InitX()\n</code></pre>\n\n<p>Is there a better way that I might be missing?</p>\n"}, {"tags": ["multithreading", "go", "daemon", "background-process", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 4510, "user_id": 6224823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-eVoU_E2fMho/AAAAAAAAAAI/AAAAAAAAAC4/7qlAOwlIJkM/photo.jpg?sz=128", "display_name": "Olian04", "link": "https://stackoverflow.com/users/6224823/olian04"}, "is_accepted": false, "score": 0, "last_activity_date": 1465992126, "last_edit_date": 1495542720, "creation_date": 1465992126, "answer_id": 37834902, "question_id": 37807265, "link": "https://stackoverflow.com/questions/37807265/golang-daemon-with-goroutines-wont-stop-executing/37834902#37834902", "title": "Golang daemon with goroutines won&#39;t stop executing", "body": "<p>When asking questions like this you should consider putting together a <a href=\"https://stackoverflow.com/help/mcve\">MCVE</a>. </p>\n\n<p>That way, since the problem size is a lot smaller, you might figure out the problem on your own.<br>\nIf not, at least the people here will have an easier time helping you.</p>\n"}, {"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": true, "score": 1, "last_activity_date": 1466064799, "creation_date": 1466064799, "answer_id": 37853486, "question_id": 37807265, "link": "https://stackoverflow.com/questions/37807265/golang-daemon-with-goroutines-wont-stop-executing/37853486#37853486", "title": "Golang daemon with goroutines won&#39;t stop executing", "body": "<p>This code will never exit until it does processing for <code>len(queues)</code> times. It is not a concurrent code - all in main body - and there is no signal to tell the code to stop. The problem is here:</p>\n\n<pre><code>case \"run\":\n    // Installing the service\n    installed, err := service.Install()\n    logError(err, installed)\n    // Starting the service\n    started, err := service.Start()\n    logError(err, started)\n    if err == nil {\n        // Creating a goroutine and executing the queue's processes in parallel\n        for i := 0; i &lt; len(queues); i++ {\n            go startProcessing(queues[i])\n            time.Sleep(time.Second) // Waiting for other functions to execute\n        }\n        select {} // To prevent the goroutine from exiting the main func\n    }\n    fmt.Println(started)\n</code></pre>\n\n<p>As it can be seen the <code>select{}</code> line will sit there and run for ever! :) It is better to move this case clauses, into their's own goroutines and have a quit signal there like this:</p>\n\n<pre><code>select {\n    case &lt;-quit:\n        return\n}\n</code></pre>\n\n<p>Though this is not the cleanest way to handle start/stop in Go apps; it just shows the problem.</p>\n"}], "owner": {"reputation": 63, "user_id": 5537397, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/6914e0dcff3a44473dbb453ad1fa470f?s=128&d=identicon&r=PG&f=1", "display_name": "smbss", "link": "https://stackoverflow.com/users/5537397/smbss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 577, "favorite_count": 0, "accepted_answer_id": 37853486, "answer_count": 2, "score": 0, "last_activity_date": 1466065593, "creation_date": 1465894380, "question_id": 37807265, "link": "https://stackoverflow.com/questions/37807265/golang-daemon-with-goroutines-wont-stop-executing", "title": "Golang daemon with goroutines won&#39;t stop executing", "body": "<p>I've created a daemon that has the goal to consume queues in parallel. To test if it keeps executing in the background I've implemented a function that creates a file every 10 seconds until it reaches X, where X is the highest number of processes that I configured for the queues. The parameters for the queues are defined on the config.yaml file.</p>\n\n<p>The problem now is that even though I stop and remove the daemon, it seems that the program keeps running and creating files... I've tried building and running the program again, exiting it, ending the processes, deleting the files, but nothing seems to work, files keep being created on the program directory. </p>\n\n<p>You can check the program code <a href=\"https://gist.github.com/SandroSimes/f8f18ccad22e68693b76457b5cea772e\" rel=\"nofollow\">here</a>, and the config file <a href=\"https://gist.github.com/SandroSimes/5a6fb31c5e591107c5d4b39345c92819\" rel=\"nofollow\">here</a>. \nDo you have any idea how I can solve this problem?\nThanks in advance!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 1, "creation_date": 1465888717, "post_id": 37804804, "comment_id": 63075382, "body": "What&#39;s your ulimit?"}, {"owner": {"reputation": 595, "user_id": 5443590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c3c26c54f6d700cd85d73e1f0cc4b5f?s=128&d=identicon&r=PG&f=1", "display_name": "GKV", "link": "https://stackoverflow.com/users/5443590/gkv"}, "reply_to_user": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1465889295, "post_id": 37804804, "comment_id": 63075751, "body": "i restarted my service then i didn&#39;t get any error,but output of lsof|wc -l output is keep on incresing."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1465889345, "post_id": 37804804, "comment_id": 63075789, "body": "Are you closing after reading it?"}, {"owner": {"reputation": 595, "user_id": 5443590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c3c26c54f6d700cd85d73e1f0cc4b5f?s=128&d=identicon&r=PG&f=1", "display_name": "GKV", "link": "https://stackoverflow.com/users/5443590/gkv"}, "reply_to_user": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1465889432, "post_id": 37804804, "comment_id": 63075847, "body": "No i think so ,how to do it. can you please help."}, {"owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "edited": false, "score": 0, "creation_date": 1465889841, "post_id": 37804804, "comment_id": 63076119, "body": "<code>io.ReadFile</code> does not provide a close file function directly. It&#39;s included into the <code>ReadFile</code> function itself. So it&#39;s not needed to close the file explicitly. It will close automatically."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 0, "creation_date": 1465889900, "post_id": 37804804, "comment_id": 63076148, "body": "ioutil.ReadFile closes after the read. And dump whole content."}, {"owner": {"reputation": 4393, "user_id": 4946286, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a23f5b1b48421368971c04e06e1ccbce?s=128&d=identicon&r=PG&f=1", "display_name": "khrm", "link": "https://stackoverflow.com/users/4946286/khrm"}, "edited": false, "score": 3, "creation_date": 1465889967, "post_id": 37804804, "comment_id": 63076192, "body": "How are you calling the function? Leakage seems to be from somewhere else."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465909985, "post_id": 37804804, "comment_id": 63090259, "body": "<code>lsof|wc -l</code> counts open files system wide. You have to run it with the <code>-p</code> option for your process. It also helps to actually look at the output of <code>lsof</code> to see what the open fds are to to help identify the problem."}], "answers": [{"comments": [{"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 1, "creation_date": 1465893941, "post_id": 37806391, "comment_id": 63078608, "body": "To be honest, I would&#39;ve expected ioutil.ReadFile to close the file (although it may well be that there&#39;s other file descriptors being opened elsewhere causing the problem)."}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "reply_to_user": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1465894282, "post_id": 37806391, "comment_id": 63078832, "body": "If we look on ReadFile we can see that the Close() function is only called when the open file fails (<a href=\"https://golang.org/src/io/ioutil/ioutil.go?s=1464:1510#L39\" rel=\"nofollow noreferrer\">golang.org/src/io/ioutil/ioutil.go?s=1464:1510#L39</a>). There is another option to call automatically the Close() function and is using the return statement (as void so you must return nothing)"}, {"owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 2, "creation_date": 1465897823, "post_id": 37806391, "comment_id": 63081321, "body": "No, there&#39;s a &quot;defer f.Close()&quot; on line 54, causing the file to be closed during the return from the function. There&#39;s an early return if the Open call fails (so as to not call the Close() method on an undefined value)."}, {"owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "reply_to_user": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "edited": false, "score": 0, "creation_date": 1465898750, "post_id": 37806391, "comment_id": 63081990, "body": "You are right @Vatine I didn&#39;t see the earlier return, my fault"}], "tags": [], "owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "is_accepted": false, "score": 7, "last_activity_date": 1465891703, "creation_date": 1465891703, "answer_id": 37806391, "question_id": 37804804, "link": "https://stackoverflow.com/questions/37804804/too-many-open-file-error-in-golang/37806391#37806391", "title": "Too Many Open File Error in Golang", "body": "<p>Basically in UNIX platforms, the OS places a limit to the number of open file descriptors that a process may have at any given time.<br>\nThe error <code>too many open files</code> is raised since you have reached the limit of file (and or pipe or socket)currently opened and you are trying to open a new file (and or pipe or socket).<br>\nTo avoid this problem you must close the file when you have finished to use the open file using the <code>Close()</code> function</p>\n"}, {"comments": [{"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "edited": false, "score": 0, "creation_date": 1613680584, "post_id": 45501034, "comment_id": 117158082, "body": "do not forget to check for errors"}, {"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "edited": false, "score": 0, "creation_date": 1613680706, "post_id": 45501034, "comment_id": 117158114, "body": "f.Write requires a []byte as an input, i.e. <code>[]byte(&quot;some text&quot;)</code>"}], "tags": [], "owner": {"reputation": 11776, "user_id": 1864294, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2b93a0614502fce3ed01786e631b0cb6?s=128&d=identicon&r=PG", "display_name": "Michael Dorner", "link": "https://stackoverflow.com/users/1864294/michael-dorner"}, "is_accepted": false, "score": 13, "last_activity_date": 1613681298, "last_edit_date": 1613681298, "creation_date": 1501832857, "answer_id": 45501034, "question_id": 37804804, "link": "https://stackoverflow.com/questions/37804804/too-many-open-file-error-in-golang/45501034#45501034", "title": "Too Many Open File Error in Golang", "body": "<p>I ran into the same problem (maybe different circumstances or setup) and fixed it differently:</p>\n<pre><code>func some_func(file_name []string) {\n    for _, file_name := range file_names {\n        f, _ := os.Create(file_name)\n        // defer f.Close() // bad idea\n        _, _ = f.Write([]byte(&quot;some text&quot;))\n        f.Close() // better idea\n    }\n}\n</code></pre>\n<p>The problem is that <code>defer</code> will be executed, when the function will return, which could take a while - depending on the loop size (bad idea). So just do it explicit (better idea )</p>\n"}, {"comments": [{"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1582142922, "post_id": 58885773, "comment_id": 106679880, "body": "// Body is the request&#39;s body. \t// \t// For client requests, a nil body means the request has no \t// body, such as a GET request. The HTTP Client&#39;s Transport \t// is responsible for calling the Close method. \t// \t// For server requests, the Request Body is always non-nil \t// but will return EOF immediately when no body is present. \t// The Server will close the request body. The ServeHTTP \t// Handler does not need to. \tBody io.ReadCloser"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1586575597, "post_id": 58885773, "comment_id": 108183055, "body": "If <code>defer</code> is used in the context of a larger function, it may be a good idea to wrap that portion in a separate function (maybe an <a href=\"https://stackoverflow.com/q/40081996/86967\">IIFE</a>) -- since the execution is deferred <a href=\"https://tour.golang.org/flowcontrol/12\" rel=\"nofollow noreferrer\">&quot;until the surrounding function returns&quot;</a>."}], "tags": [], "owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "is_accepted": false, "score": 6, "last_activity_date": 1573858849, "creation_date": 1573858849, "answer_id": 58885773, "question_id": 37804804, "link": "https://stackoverflow.com/questions/37804804/too-many-open-file-error-in-golang/58885773#58885773", "title": "Too Many Open File Error in Golang", "body": "<p>The OP does not provide a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">Minimal, Reproducible Example</a>.  The error in question is caused by code that was not posted.  An easy way to demonstrate this is to simply run the provided code in a minimal example (with no other activity), and see that it does <em>not</em> fail.</p>\n\n<p>The function <a href=\"https://golang.org/pkg/io/ioutil/#ReadFile\" rel=\"noreferrer\"><code>ioutil.ReadFile</code></a>, of course, closes the file.  It has been implicated, in this case, simply because it is attempting to open a new file when the resource limit has <em>already</em> been reached.</p>\n\n<hr>\n\n<p>One common <em>gotcha</em> in Go is failure to close streams that were opened implicitly.  A specific case of this is that a stream is opened when using the client functions of the <a href=\"https://golang.org/pkg/net/http/\" rel=\"noreferrer\"><code>http</code></a> library.</p>\n\n<p>Examples: <a href=\"https://stackoverflow.com/q/23362632/86967\">(1)</a>,\n<a href=\"https://stackoverflow.com/q/33238518\">(2)</a></p>\n\n<blockquote>\n  <p>The client must close the response body when finished with it:</p>\n</blockquote>\n\n<pre><code>resp, err := http.Get(\"http://example.com/\")\nif err != nil {\n    // handle error\n}\ndefer resp.Body.Close()\nbody, err := ioutil.ReadAll(resp.Body)\n</code></pre>\n\n<p><strong>Such requests should always include a call to <code>Close</code></strong>, using a form as shown above.</p>\n\n<p>There may be other, similar, cases of implicit streams being opened...</p>\n\n<hr>\n\n<p>This is a particularly tricky issue because, for trivial programs, you'll never know the difference.  You won't know there is a problem until you run this through hundreds, or thousands, of iterations.  And, then, <em>the error may often be presented as a failure of some unrelated function call</em> -- just as demonstrated by the OP.</p>\n"}], "owner": {"reputation": 595, "user_id": 5443590, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/8c3c26c54f6d700cd85d73e1f0cc4b5f?s=128&d=identicon&r=PG&f=1", "display_name": "GKV", "link": "https://stackoverflow.com/users/5443590/gkv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 17737, "favorite_count": 2, "answer_count": 3, "score": 8, "last_activity_date": 1613681298, "creation_date": 1465886836, "last_edit_date": 1465887532, "question_id": 37804804, "link": "https://stackoverflow.com/questions/37804804/too-many-open-file-error-in-golang", "title": "Too Many Open File Error in Golang", "body": "<p>I am simply reading the <code>/proc/diskstats</code> file.  My code is:</p>\n\n<pre><code>func ReadFromFile(filepath string)(string){\n    defer func() {\n        if err1 := recover(); err1 != nil {\n            fmt.Println(\"!!!!!!!!!!!!!!!!Panic Occured and Recovered in readFromFile(), Error Info: \", err1)\n        }\n     }()\n\n    strData := \"\"\n\n    data, err := ioutil.ReadFile(filepath)\n    if err != nil{\n        fmt.Println(\"File read error: \", err)\n        return \"\"\n    }\n\n    strData = string(data)\n    return strData\n}\n</code></pre>\n\n<p>The error I am getting is:</p>\n\n<pre><code>File read error: open /proc/diskstats: too many open files\n</code></pre>\n\n<p>Not only for this file, I am also getting the same error for some other files.</p>\n\n<p>I have also run this command:</p>\n\n<pre><code>root@golang:~# lsof|wc -l\n\n785\n</code></pre>\n\n<p>Please guide me.</p>\n"}, {"tags": ["java", "go", "cryptography", "rsa"], "answers": [{"tags": [], "owner": {"reputation": 2124, "user_id": 1290244, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/4ztts.png?s=128&g=1", "display_name": "onemouth", "link": "https://stackoverflow.com/users/1290244/onemouth"}, "is_accepted": true, "score": 2, "last_activity_date": 1465887557, "creation_date": 1465887557, "answer_id": 37805007, "question_id": 37802869, "link": "https://stackoverflow.com/questions/37802869/rsa-oaep-golang-decrypt-java-encrypt/37805007#37805007", "title": "RSA OAEP , Golang Decrypt , Java Encrypt", "body": "<p>The hash functions in the two programs are not the same.\nIn Java version, <code>SHA-256</code> is used, but in Go version, <code>SHA-1</code> is used.</p>\n\n<p>You can try to use <code>RSA/ECB/OAEPWithSHA-1AndMGF1Padding</code> in the Java side.</p>\n"}], "owner": {"reputation": 55, "user_id": 5736431, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/391bef6df7e006286ba76b4f6a1e884d?s=128&d=identicon&r=PG&f=1", "display_name": "cong chen", "link": "https://stackoverflow.com/users/5736431/cong-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1429, "favorite_count": 3, "accepted_answer_id": 37805007, "answer_count": 1, "score": 5, "last_activity_date": 1465904724, "creation_date": 1465877765, "last_edit_date": 1465904724, "question_id": 37802869, "link": "https://stackoverflow.com/questions/37802869/rsa-oaep-golang-decrypt-java-encrypt", "title": "RSA OAEP , Golang Decrypt , Java Encrypt", "body": "<p>The Android client encrypt message, the java code </p>\n\n<pre><code>Cipher cipher = Cipher.getInstance(\"RSA/ECB/OAEPWITHSHA-256ANDMGF1PADDING\");\n\nbyte[] publicBytes = Base64.decode(Configs.PUBLIC_KEY.getBytes(\"UTF-8\"),Base64.DEFAULT);\nX509EncodedKeySpec keySpec = new X509EncodedKeySpec(publicBytes);\n\nKeyFactory keyFactory = KeyFactory.getInstance(\"RSA\");\nPublicKey pubKey = keyFactory.generatePublic(keySpec);\n\ncipher.init(Cipher.ENCRYPT_MODE, pubKey);\n\nString plaintext = \"test\";\n\nbyte[] encryptedBytes = cipher.doFinal(plaintext.getBytes(\"UTF-8\"));\nString chipertext = Base64.encodeToString(encryptedBytes,Base64.DEFAULT);\nLog.d(TAG,\"encrypted (chipertext) = \" + chipertext);\n</code></pre>\n\n<p>The Golang server decrypt message, the golang code </p>\n\n<pre><code>func RsaDecrypt(encryptedString string) (string, error) {\n     base64DecodeBytes, err := base64.StdEncoding.DecodeString(encryptedString)\n     if err != nil {\n         return \"\", err\n     }\n     privateKeyBlock, _ := pem.Decode([]byte(privateKey))\n     var pri *rsa.PrivateKey\n     pri, parseErr := x509.ParsePKCS1PrivateKey(privateKeyBlock.Bytes)\n     if parseErr != nil {\n         return \"\", parseErr\n     }\n     decryptedData, decryptErr := rsa.DecryptOAEP(sha1.New(), rand.Reader, pri, base64DecodeBytes, nil)\n     if decryptErr != nil {\n         return \"\", decryptErr\n     }\n\n     return string(decryptedData), nil\n}\n</code></pre>\n\n<p>and the error in golang : <code>crypto/rsa: decryption error</code> </p>\n\n<p>I can't change the code on the server, so how to change the code in Java?</p>\n\n<p>Need your help</p>\n\n<p>Thx.</p>\n"}, {"tags": ["go", "prepared-statement"], "comments": [{"owner": {"reputation": 2722, "user_id": 4740606, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sWt5W.jpg?s=128&g=1", "display_name": "Snowman", "link": "https://stackoverflow.com/users/4740606/snowman"}, "edited": false, "score": 0, "creation_date": 1465956144, "post_id": 37802505, "comment_id": 63112928, "body": "<a href=\"https://stackoverflow.com/questions/37683218/golang-sql-drivers-prepare-statement/37686891#37686891\">This might help</a>"}], "answers": [{"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1465880100, "post_id": 37803004, "comment_id": 63071508, "body": "Is there anything to backup this claim. Because the way it stands now, it is the same assumption that I wrote in my question, and I would like to have some credible source to back up this assumption."}, {"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "reply_to_user": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 1, "creation_date": 1465880385, "post_id": 37803004, "comment_id": 63071599, "body": "@SalvadorDali according to the document you linked Query[Row] just prepares the statement, runs it, and closes it, right?   It seems intuitive to me that if you prepare that statement once, then constantly run the same prepared statement, you&#39;re going to reduce round trips at a factor approaching 3.  Your first and second examples are doing roughly the same thing as you&#39;re creating a new prepared statement at every function call."}, {"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1465882382, "post_id": 37803004, "comment_id": 63072177, "body": "Seems reasonable. Thank you, +1"}], "tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": 3, "last_activity_date": 1465878457, "creation_date": 1465878457, "answer_id": 37803004, "question_id": 37802505, "link": "https://stackoverflow.com/questions/37802505/would-i-be-better-by-using-a-prepared-statement-here/37803004#37803004", "title": "Would I be better by using a prepared statement here?", "body": "<p>In both of those examples, there's roughly the same database overhead. If you're going to use a statement a lot, prepare it once in a wider scope so it's reusable. </p>\n\n<p>You would only be making one round trip to the database with that pattern.</p>\n"}, {"comments": [{"owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "edited": false, "score": 0, "creation_date": 1466016313, "post_id": 37834997, "comment_id": 63147282, "body": "First of all this does not answer my question, second queryRow with parameter $1 will also prepare the statement for me, so your answer is not really correct"}], "tags": [], "owner": {"reputation": 4510, "user_id": 6224823, "user_type": "registered", "accept_rate": 75, "profile_image": "https://lh4.googleusercontent.com/-eVoU_E2fMho/AAAAAAAAAAI/AAAAAAAAAC4/7qlAOwlIJkM/photo.jpg?sz=128", "display_name": "Olian04", "link": "https://stackoverflow.com/users/6224823/olian04"}, "is_accepted": false, "score": 0, "last_activity_date": 1465992394, "creation_date": 1465992394, "answer_id": 37834997, "question_id": 37802505, "link": "https://stackoverflow.com/questions/37802505/would-i-be-better-by-using-a-prepared-statement-here/37834997#37834997", "title": "Would I be better by using a prepared statement here?", "body": "<p>If you're ever using databases in conjunction with user input, you should always prepare the statement beforehand.  </p>\n\n<p>If not, you run a risk of DB Insertion (SQL Insertion ex).</p>\n"}], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1465992394, "creation_date": 1465875124, "question_id": 37802505, "link": "https://stackoverflow.com/questions/37802505/would-i-be-better-by-using-a-prepared-statement-here", "title": "Would I be better by using a prepared statement here?", "body": "<p>I <a href=\"http://go-database-sql.org/retrieving.html\" rel=\"nofollow\">still</a> <a href=\"http://go-database-sql.org/prepared.html\" rel=\"nofollow\">struggle</a> understanding the benefits of prepared statement in Go / <a href=\"https://github.com/lib/pq\" rel=\"nofollow\">psql</a>.</p>\n\n<p>Let's assume I have a struct </p>\n\n<pre><code>type Brand struct {\n    Id        int        `json:\"id,omitempty\"`\n    Name      string     `json:\"name,omitempty\"`\n    Issued_at *time.Time `json:\"issued_at,omitempty\"`\n}\n</code></pre>\n\n<p>And some table <code>brands</code>, where id is a unique field. Now I want to retrieve the element from that table using and id.</p>\n\n<p>I can write the following function using QueryRow.</p>\n\n<pre><code>func GetBrand1(id int) (Brand, error) {\n    brand := Brand{}\n    if err := Db.QueryRow(\"SELECT name, issued_at FROM brands WHERE id = $1\", id).Scan(&amp;brand.Name, &amp;brand.Issued_at); err != nil {\n        if err == sql.ErrNoRows {\n            return brand, nil\n        }\n\n        return brand, err\n    }\n\n    brand.Id = id\n    return brand, nil\n}\n</code></pre>\n\n<p>and I can do the same (I hope it is the same) using prepared statement:</p>\n\n<pre><code>func GetBrand2(id int) (Brand, error) {\n    brand := Brand{}\n\n    stmt, err := Db.Prepare(\"SELECT name, issued_at FROM brands WHERE id = $1\")\n    if err != nil {\n        return brand, err\n    }\n    defer stmt.Close()\n\n    rows, err := stmt.Query(id)\n    if err != nil {\n        return brand, err\n    }\n    defer rows.Close()\n\n    for rows.Next() {\n        rows.Scan(&amp;brand.Name, &amp;brand.Issued_at)\n        brand.Id = id\n        return brand, err\n    }\n    if err = rows.Err(); err != nil {\n        return brand, err\n    }\n\n    return brand, err\n}\n</code></pre>\n\n<hr>\n\n<p>Now in my application I am planning to execute <code>GetBrand*</code> function many times (with different parameters). Will is one of this implementations is more preferable to another (in terms of sql-requests/memory/anything). Or may be they both suck and I would be better doing something else.</p>\n\n<p>I have read <a href=\"http://go-database-sql.org/retrieving.html\" rel=\"nofollow\">this</a> and a <a href=\"http://go-database-sql.org/prepared.html\" rel=\"nofollow\">followed up link</a> and I saw that:</p>\n\n<blockquote>\n  <p>db.Query() actually prepares, executes, and closes a prepared\n  statement. That\u2019s three round-trips to the database. If you\u2019re not\n  careful, you can triple the number of database interactions your\n  application makes</p>\n</blockquote>\n\n<p>but I think that prepared statement in the second case will be removed at the end of the function.</p>\n"}, {"tags": ["function", "go", "variadic-functions"], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 5465655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e900ff0b9014f7b4bdb86fbb4c209521?s=128&d=identicon&r=PG&f=1", "display_name": "Cheral Irumborai", "link": "https://stackoverflow.com/users/5465655/cheral-irumborai"}, "edited": false, "score": 0, "creation_date": 1465871052, "post_id": 37801936, "comment_id": 63069376, "body": "Brian Vanover :  When I use the  interface , I just get the memory address as the output printed instead of the parameter strings passed."}, {"owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "reply_to_user": {"reputation": 73, "user_id": 5465655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e900ff0b9014f7b4bdb86fbb4c209521?s=128&d=identicon&r=PG&f=1", "display_name": "Cheral Irumborai", "link": "https://stackoverflow.com/users/5465655/cheral-irumborai"}, "edited": false, "score": 0, "creation_date": 1465871317, "post_id": 37801936, "comment_id": 63069438, "body": "@CheralIrumborai, use the <code>fmt</code> package. The code above will work for you."}], "tags": [], "owner": {"reputation": 6350, "user_id": 2399935, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/0dba94ea111afa694c3615b18bea3589?s=128&d=identicon&r=PG&f=1", "display_name": "Brian", "link": "https://stackoverflow.com/users/2399935/brian"}, "is_accepted": true, "score": 3, "last_activity_date": 1465870485, "creation_date": 1465870485, "answer_id": 37801936, "question_id": 37801883, "link": "https://stackoverflow.com/questions/37801883/pass-parameters-of-different-datatypes-to-a-golang-variadic-function/37801936#37801936", "title": "Pass Parameters of different datatypes to a Golang Variadic function", "body": "<p>You can use an <a href=\"https://golang.org/doc/effective_go.html#interfaces\" rel=\"nofollow\">interface</a></p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() { \n  variadicFunc(\"hello\", \"Change\", \"the \", \"World using Golang\", 1, 2, 3, 4)\n}\n\nfunc variadicFunc(messages ...interface{}) {\n  for _, i := range messages {\n    fmt.Println(i)\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 5465655, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e900ff0b9014f7b4bdb86fbb4c209521?s=128&d=identicon&r=PG&f=1", "display_name": "Cheral Irumborai", "link": "https://stackoverflow.com/users/5465655/cheral-irumborai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 946, "favorite_count": 0, "accepted_answer_id": 37801936, "answer_count": 1, "score": 1, "last_activity_date": 1465877354, "creation_date": 1465870139, "last_edit_date": 1465877354, "question_id": 37801883, "link": "https://stackoverflow.com/questions/37801883/pass-parameters-of-different-datatypes-to-a-golang-variadic-function", "title": "Pass Parameters of different datatypes to a Golang Variadic function", "body": "<p>I have the following Golang <code>main</code> function where another variadic function <code>variadicFunc</code> is called to which I need to pass parameters of different datatypes. The code is as  follows.</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    variadicFunc(\"hello\", \"Change\", \"the \", \"World using Golang\", 1, 2, 3, 4)\n}\n\nfunc variadicFunc(messages ...string) {\n    for _, i := range messages {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p>When running the program following error is thrown. </p>\n\n<blockquote>\n  <p>Cannot use 1(type int) as type string in argument to variadicFunc</p>\n</blockquote>\n"}, {"tags": ["go", "single-sign-on", "cas", "microservices", "beego"], "comments": [{"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1465889056, "post_id": 37801454, "comment_id": 63075592, "body": "Architecturally, it may be better to not make A and B depend on Redis persistence just to get a session cookie. Only the &#39;Authentication service&#39; should connect to Redis. A and B should speak to the Authentication service (via an HTTP API or something) to get the session information."}, {"owner": {"reputation": 679, "user_id": 5658049, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/loHIM.jpg?s=128&g=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/5658049/yang"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1465891756, "post_id": 37801454, "comment_id": 63077256, "body": "@Nadh Thanks for the reply. In order to share the session of user info, there&#39;s only one session for all the services, each of them set values to the key with a prefix like &quot;appname.sessionname&quot;. If A and B communicate with Auth Service, it works exactly as what CAS does. Do you mean CAS pattern is the only choice? Is there other solutions?"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1465898071, "post_id": 37801454, "comment_id": 63081474, "body": "CAS, by definition, is &quot;central&quot;. Your method also works in the short term, but it&#39;s not very modular or scalable. What if A and B move to a different data centre? Establishing Redis connections over the internet is going to be a pain. Also, every service you create (in whatever language) will have to have Redis drivers and connectivity. Check out this for an overview of different kinds of implementations -- <a href=\"https://en.wikipedia.org/wiki/List_of_single_sign-on_implementations\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/List_of_single_sign-on_implementations</a>"}, {"owner": {"reputation": 679, "user_id": 5658049, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/loHIM.jpg?s=128&g=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/5658049/yang"}, "reply_to_user": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 0, "creation_date": 1465961823, "post_id": 37801454, "comment_id": 63114229, "body": "@Nadh Thanks very much! Your points are exactly what I omitted. CAS is a flexible way indeed to share sessions. My original motivation is to simplify the workflow of request processing, as the API Gateway pattern, which transmits requests by a Nginx server with the <code>auth_request</code> mod. A stupid question, why is it pain to connect to the remote Redis server? Doesn&#39;t the <code>redis-cli -h HOST</code> work well, or complicated security consideration?"}, {"owner": {"reputation": 5779, "user_id": 1357978, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1492420466abb7ec2ed53cac8c7e8d02?s=128&d=identicon&r=PG", "display_name": "Nadh", "link": "https://stackoverflow.com/users/1357978/nadh"}, "edited": false, "score": 1, "creation_date": 1465971957, "post_id": 37801454, "comment_id": 63117830, "body": "Exposing your Redis server over the internet, just to share sessions, raises security concerns. You&#39;ll have to then have strong firewall and security measures in place, adding another point of failure. A simple HTTP API would eliminate such concerns and complexities."}], "answers": [{"comments": [{"owner": {"reputation": 679, "user_id": 5658049, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/loHIM.jpg?s=128&g=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/5658049/yang"}, "edited": false, "score": 0, "creation_date": 1465977524, "post_id": 37828818, "comment_id": 63120878, "body": "Thanks for the reply! You&#39;re so expirenced in the architecture! The &quot;session-shared-cluster&quot; really costs much mem, since there&#39;s many sessions are not destroied, and most of users do not logout manually. I just start learning the microservices, is the &quot;API Gateway&quot; pattern, like <a href=\"https://getkong.org/\" rel=\"nofollow noreferrer\">Kong</a>, sort of &quot;portlet-servers&quot;?"}, {"owner": {"reputation": 3016, "user_id": 2195638, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/XwoD5.jpg?s=128&g=1", "display_name": "Martin Baumgartner", "link": "https://stackoverflow.com/users/2195638/martin-baumgartner"}, "reply_to_user": {"reputation": 679, "user_id": 5658049, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/loHIM.jpg?s=128&g=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/5658049/yang"}, "edited": false, "score": 0, "creation_date": 1465980067, "post_id": 37828818, "comment_id": 63122456, "body": "Sorry Yang, i don&#39;t know anything about Kong."}, {"owner": {"reputation": 679, "user_id": 5658049, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/loHIM.jpg?s=128&g=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/5658049/yang"}, "edited": false, "score": 0, "creation_date": 1465983736, "post_id": 37828818, "comment_id": 63125007, "body": "I don&#39;t know much either. The source code was opened last year. I just start Kong with the <a href=\"https://getkong.org/docs/0.8.x/getting-started/quickstart/\" rel=\"nofollow noreferrer\">QuickStart</a>, so I&#39;m wondering the possibility of SSO implementation in that way."}], "tags": [], "owner": {"reputation": 3016, "user_id": 2195638, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/XwoD5.jpg?s=128&g=1", "display_name": "Martin Baumgartner", "link": "https://stackoverflow.com/users/2195638/martin-baumgartner"}, "is_accepted": false, "score": 1, "last_activity_date": 1465975780, "creation_date": 1465975780, "answer_id": 37828818, "question_id": 37801454, "link": "https://stackoverflow.com/questions/37801454/is-there-a-way-to-implement-sso-in-front-of-the-microservices/37828818#37828818", "title": "Is there a way to implement SSO in front of the microservices?", "body": "<blockquote>\n  <p>But the workflow of CAS is a little bit complicated: too many redirections, too many tickets transmitted among the CAS, web apps, and the user browser. I can't figure out why people deploy the Authentication Services in the center of all the web apps, rather than the front, like the following diagram.</p>\n</blockquote>\n\n<p>You are thinking the old fashioned way, and thats why architects came up in the past with solutions like using portlet-servers for webapplications, session-shared-clusters, and lots of other heavy error-prone system-solutions which ate your cpu, memory or bandwith in ways which you could never predict until the first real life test. </p>\n\n<p>The CAS solution might look complicated on the first move, but you can predict how much logins, traffic and synchronisation data your system will generate and compared to the \"old solutions\", your system-to-user load will raise linear and not exponential. </p>\n"}], "owner": {"reputation": 679, "user_id": 5658049, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/loHIM.jpg?s=128&g=1", "display_name": "Yang", "link": "https://stackoverflow.com/users/5658049/yang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1833, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1466468940, "creation_date": 1465866635, "last_edit_date": 1592644375, "question_id": 37801454, "link": "https://stackoverflow.com/questions/37801454/is-there-a-way-to-implement-sso-in-front-of-the-microservices", "title": "Is there a way to implement SSO in front of the microservices?", "body": "<p>Recently I have a project to implement <a href=\"https://en.wikipedia.org/wiki/Single_sign-on\" rel=\"nofollow noreferrer\">SSO(Single-Sign-On)</a> for multiple web applications based on <a href=\"http://beego.me/\" rel=\"nofollow noreferrer\">Beego Framework</a>. The most popular SSO project is <a href=\"https://en.wikipedia.org/wiki/Central_Authentication_Service\" rel=\"nofollow noreferrer\">CAS</a>, which needs a CAS Server in the center, and a CAS Client before each web application. Unfortunately, it seems that there's not any offical CAS clients written in Golang, except <a href=\"https://github.com/go-cas/cas\" rel=\"nofollow noreferrer\">go-cas/cas</a>, and <a href=\"https://github.com/adanteng/cas\" rel=\"nofollow noreferrer\">adanteng/cas</a>, which supports Beego.</p>\n<p>But the workflow of CAS is a little bit complicated: too many redirections, too many tickets transmitted among the CAS, web apps, and the user browser. I can't figure out why people deploy the Authentication Services in the center of all the web apps, rather than the front, like the following diagram:</p>\n<p><a href=\"https://i.stack.imgur.com/aqOmDm.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aqOmDm.png\" alt=\"enter image description here\" /></a></p>\n<p>In this diagram, all the requests are forced to be processed in the Authenticate Service first, if authenticated successfully, then generate a session ID, saved in the cookies and Redis which is shared by other microservices. There's not any redirections or tickets at all, only requests transmittion.</p>\n<p>So is this diagram possible, or some critical problems I ignored?</p>\n<h1>Update 0</h1>\n<p>The session-sharing way is indeed not scalable and modular as <a href=\"https://stackoverflow.com/users/1357978/nadh\">Nadh</a> counsels. How about transmitting user information, like name, email, etc., in the headers of requests between the auth service and downstream services, like the creative work of Heipei at <a href=\"https://heipei.github.io/2015/09/23/nginx-sso-Simple-offline-SSO-for-nginx/\" rel=\"nofollow noreferrer\">nginx-sso</a>? Is it possible to make it work as an SSO Gateway as Sam Newman sharing in the book <a href=\"http://samnewman.io/books/building_microservices/\" rel=\"nofollow noreferrer\">Building Microservices</a>?</p>\n<h1>Update 1</h1>\n<p>A more detailed diagram is shown as follows, in order to describe my childish idea a little bit clearly, hoping that there is not much misunderstanding from Heipei and Sam Newman.</p>\n<p>Rather than handling so many redirections and handshakes, all the requests are processed in the authentication service firstly, which writes user info from MySQL, into the Redis as the session provider, and the HTTP header to transmit to the downstream services, if the request is authenticated successfully.</p>\n<p>In this way, the user info is transmitted via HTTP header instead of the above shared-Redis as <a href=\"https://stackoverflow.com/users/1357978/nadh\">Nadh</a> warning, and Redis can be depolyed with the auth service, or shared among auth instances only.</p>\n<p><a href=\"https://i.stack.imgur.com/BeMFF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/BeMFF.png\" alt=\"enter image description here\" /></a></p>\n<h1>Update 2</h1>\n<p>It seems that Cookie and Session are old-school techs. The cross-domain problem of cookie, and the sharing problem of session are the primary barrier to the scalability and flexibility of the modern web applications. Fortunately, JSON Web Token comes to be the best Single Sign-on solution for multiple lightweight services nowadays, by moving the user info(maybe id is enough) storage from the server side to the client side, and transmitted only if necessary.</p>\n"}, {"tags": ["go", "cassandra", "gocql"], "comments": [{"owner": {"reputation": 3420, "user_id": 675723, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/8f525203adb5093c5954b43a5b6420c2?s=128&d=identicon&r=PG", "display_name": "BadZen", "link": "https://stackoverflow.com/users/675723/badzen"}, "edited": false, "score": 1, "creation_date": 1465862471, "post_id": 37800892, "comment_id": 63067493, "body": "I don&#39;t see any aggregate support at all in the API.    =/"}], "answers": [{"comments": [{"owner": {"reputation": 121, "user_id": 6407048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1731554ee39dc7e00b9bc2ad891bea?s=128&d=identicon&r=PG&f=1", "display_name": "user6407048", "link": "https://stackoverflow.com/users/6407048/user6407048"}, "edited": false, "score": 0, "creation_date": 1465924377, "post_id": 37803208, "comment_id": 63100736, "body": "Thanks, I saw the NumRows thing too, but I didn&#39;t want to have to iterate through. I have contacted the developers already. I am asking for this functionality."}, {"owner": {"reputation": 517, "user_id": 2138524, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EOhzF.jpg?s=128&g=1", "display_name": "Tanny", "link": "https://stackoverflow.com/users/2138524/tanny"}, "reply_to_user": {"reputation": 121, "user_id": 6407048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1731554ee39dc7e00b9bc2ad891bea?s=128&d=identicon&r=PG&f=1", "display_name": "user6407048", "link": "https://stackoverflow.com/users/6407048/user6407048"}, "edited": false, "score": 0, "creation_date": 1503319530, "post_id": 37803208, "comment_id": 78552521, "body": "@user6407048 did you figure out any solution for the same yet? I am currently looking into it. I wish to get the count of total rows for a query."}], "tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": 1, "last_activity_date": 1465879770, "creation_date": 1465879770, "answer_id": 37803208, "question_id": 37800892, "link": "https://stackoverflow.com/questions/37800892/how-to-get-the-number-of-rows-returned-by-a-query-using-gocql/37803208#37803208", "title": "How to get the number of rows returned by a query using gocql", "body": "<p>The closest thing I could find that would help you out is <a href=\"https://godoc.org/github.com/gocql/gocql#Iter\" rel=\"nofollow\">Iter.NumRows</a></p>\n\n<p>If they paginate rows that won't give you what you're looking for. In the event that they do, this is a reasonable feature to request on their Github.</p>\n"}, {"comments": [{"owner": {"reputation": 51388, "user_id": 388389, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/zK42B.png?s=128&g=1", "display_name": "npocmaka", "link": "https://stackoverflow.com/users/388389/npocmaka"}, "edited": false, "score": 0, "creation_date": 1598286195, "post_id": 58990541, "comment_id": 112402644, "body": "why the count is of type string?"}], "tags": [], "owner": {"reputation": 164, "user_id": 3859889, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ebd9463fb0d02373bb0a4ad2db950465?s=128&d=identicon&r=PG&f=1", "display_name": "soul", "link": "https://stackoverflow.com/users/3859889/soul"}, "is_accepted": false, "score": 1, "last_activity_date": 1574412542, "creation_date": 1574412542, "answer_id": 58990541, "question_id": 37800892, "link": "https://stackoverflow.com/questions/37800892/how-to-get-the-number-of-rows-returned-by-a-query-using-gocql/58990541#58990541", "title": "How to get the number of rows returned by a query using gocql", "body": "<p>You can do like this</p>\n\n<pre><code>var count string\niter := session.Query(`SELECT count(*) FROM tablename`).Iter()\nfor iter.Scan(&amp;count) {\n    print(count)\n}\n</code></pre>\n\n<p>You will get the count in count variable.</p>\n"}, {"tags": [], "owner": {"reputation": 51388, "user_id": 388389, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/zK42B.png?s=128&g=1", "display_name": "npocmaka", "link": "https://stackoverflow.com/users/388389/npocmaka"}, "is_accepted": false, "score": 1, "last_activity_date": 1598287088, "creation_date": 1598287088, "answer_id": 63565167, "question_id": 37800892, "link": "https://stackoverflow.com/questions/37800892/how-to-get-the-number-of-rows-returned-by-a-query-using-gocql/63565167#63565167", "title": "How to get the number of rows returned by a query using gocql", "body": "<p>I would prefer :</p>\n<pre><code>var count int\ntc.Session.Query(`SELECT COUNT(*) FROM ks.tbl WHERE something = ? ALLOW FILTERING`, &quot;something_else&quot;).Iter().Scan(&amp;count)\nprint(count)\n</code></pre>\n<p>As the counting will be performed by the database itself but not by the application. soul's answer will also work but I prefer the count to be saved as integer and scanning to be done directly but not with additional loop</p>\n"}], "owner": {"reputation": 121, "user_id": 6407048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c1731554ee39dc7e00b9bc2ad891bea?s=128&d=identicon&r=PG&f=1", "display_name": "user6407048", "link": "https://stackoverflow.com/users/6407048/user6407048"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1542, "favorite_count": 1, "answer_count": 3, "score": 2, "last_activity_date": 1598287088, "creation_date": 1465861961, "question_id": 37800892, "link": "https://stackoverflow.com/questions/37800892/how-to-get-the-number-of-rows-returned-by-a-query-using-gocql", "title": "How to get the number of rows returned by a query using gocql", "body": "<p>I am using the gocql library which is documented here: <a href=\"https://godoc.org/github.com/relops/cqlc/cqlc#Fetchable\" rel=\"nofollow\">https://godoc.org/github.com/relops/cqlc/cqlc#Fetchable</a> and am trying to write an API call in golang that will ask for all of the elements in my database that fulfill a particular field and return the total number of elements returned. I know when I am in the Cassandra interface I can use the call <code>SELECT COUNT(*) from table1 WHERE ...;</code> where table1 is the table name. I have been going through the documentation and all I can find is the limit function that limits the number of entries that are returned.</p>\n\n<p>For example, just say I have a database table of events in Cassandra that take place on different days. I just want to return the number of events that take place on Tuesday, and I want to do this using gocql.</p>\n\n<p>Currently I do something like:</p>\n\n<pre><code>cx := cqlc.NewContext()\niter, err := cx.Select().\n            From(db.EVENTLOG).\n            Where(db.EVENTLOG.DAY.Eq(day).\n            Limit(10000).       \n            Fetch(cass)\ndata, err = db.BindEventlog(iter)\n</code></pre>\n\n<p>The BindEventLog function returns an array of the events that happen on 'day' but again, I just want the number of events, not the events themselves. Is there a way to get this without iterating through this array because I am anyways going to throw out the array so it would be really slow to get the database to give me the entire array of data.</p>\n\n<p>I am a beginner at this so if you need more information please ask, I tried to make this as specific as possible. Thanks.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465849907, "post_id": 37798572, "comment_id": 63063290, "body": "What are your goals? There&#39;s nothing wrong with what you&#39;re doing, and there&#39;s nothing really different for a Go program vs any other."}, {"owner": {"reputation": 74246, "user_id": 80911, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9e9b4f80c65dc6076d74cd421084e4fc?s=128&d=identicon&r=PG", "display_name": "Evert", "link": "https://stackoverflow.com/users/80911/evert"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465851094, "post_id": 37798572, "comment_id": 63063859, "body": "@JimB I&#39;m just making sure that it is actually ok. I imagine for example many HTTP services would finish handling any outstanding requests before exiting. <code>kill</code> feels wrong, but that might just be my inexperience."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 1, "creation_date": 1465851401, "post_id": 37798572, "comment_id": 63063986, "body": "Like others said, kill-and-restart isn&#39;t that uncommon (in Go or elsewhere). There is some code that goes out of its way to avoid dropping connections at restart: <a href=\"https://github.com/facebookgo/grace\" rel=\"nofollow noreferrer\">github.com/facebookgo/grace</a>"}, {"owner": {"reputation": 74246, "user_id": 80911, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9e9b4f80c65dc6076d74cd421084e4fc?s=128&d=identicon&r=PG", "display_name": "Evert", "link": "https://stackoverflow.com/users/80911/evert"}, "edited": false, "score": 1, "creation_date": 1465852194, "post_id": 37798572, "comment_id": 63064291, "body": "Thanks, this is helpful!"}], "answers": [{"comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 3, "creation_date": 1465852065, "post_id": 37798872, "comment_id": 63064243, "body": "Better way without blocking <code>main()</code> indefinitely: <a href=\"https://play.golang.org/p/X-6_qY810j\" rel=\"nofollow noreferrer\">play.golang.org/p/X-6_qY810j</a>.  No reason to fire <code>gracefulShutdown()</code> in a goroutine when it&#39;s going to light another one anyway, and this lets <b>main</b> be the one to actually end the program (which is what should be happening).  Also, in your version, forever doesn&#39;t actually have to be run through <code>make</code>, as a nil channel blocks indefinitely.  Thus <code>var forever chan int</code> avoids an allocation and works the same way."}], "tags": [], "owner": {"reputation": 6282, "user_id": 625540, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/r279R.jpg?s=128&g=1", "display_name": "codefreak", "link": "https://stackoverflow.com/users/625540/codefreak"}, "is_accepted": true, "score": 8, "last_activity_date": 1465850944, "creation_date": 1465850944, "answer_id": 37798872, "question_id": 37798572, "link": "https://stackoverflow.com/questions/37798572/exiting-go-applications-gracefully/37798872#37798872", "title": "Exiting go applications gracefully", "body": "<p>There's nothing wrong in killing the process, replacing and restarting. If you want to do some cleanup on exiting you may do following:</p>\n\n<pre><code>import(\n   \"fmt\"\n   \"os\"\n   \"os/signal\"\n   \"syscall\"\n)\n\nfunc main(){\n   //work here\n\n   go gracefulShutdown()\n   forever := make(chan int)\n   &lt;-forever\n}\n\nfunc gracefulShutdown() {\n    s := make(chan os.Signal, 1)\n    signal.Notify(s, os.Interrupt)\n    signal.Notify(s, syscall.SIGTERM)\n    go func() {\n        &lt;-s\n        fmt.Println(\"Sutting down gracefully.\")\n        // clean up here\n        os.Exit(0)\n    }()\n}\n</code></pre>\n\n<p>If you do kill {pid} (without -9 switch), process will call <code>gracefullShutdown</code> function before terminating.</p>\n"}], "owner": {"reputation": 74246, "user_id": 80911, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/9e9b4f80c65dc6076d74cd421084e4fc?s=128&d=identicon&r=PG", "display_name": "Evert", "link": "https://stackoverflow.com/users/80911/evert"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2420, "favorite_count": 0, "accepted_answer_id": 37798872, "answer_count": 1, "score": 6, "last_activity_date": 1465851791, "creation_date": 1465849690, "question_id": 37798572, "link": "https://stackoverflow.com/questions/37798572/exiting-go-applications-gracefully", "title": "Exiting go applications gracefully", "body": "<p>I'm new to Go and I have a few small services running.</p>\n\n<p>When I'm deploying a new version, I typically just upload the new binary, <code>kill</code> the existing process and start a new one.</p>\n\n<p>I'm wondering if this is the correct thing to do, or if there is a better way to do this. </p>\n"}, {"tags": ["qt", "go", "qml", "static-linking", "cgo"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465844070, "post_id": 37796977, "comment_id": 63060373, "body": "I would assume the warning/error message <code>plugins are disabled in static builds</code> has something to do with it"}, {"owner": {"reputation": 88126, "user_id": 1329652, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/fa4ef026ee4be15d3dbacc95f1773d03?s=128&d=identicon&r=PG&f=1", "display_name": "Kuba hasn&#39;t forgotten Monica", "link": "https://stackoverflow.com/users/1329652/kuba-hasnt-forgotten-monica"}, "edited": false, "score": 0, "creation_date": 1465845035, "post_id": 37796977, "comment_id": 63060847, "body": "You need to statically link your application with relevant plugins."}, {"owner": {"reputation": 313, "user_id": 3567989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce071dd3264c7d9f5d9c0b7137faa6b?s=128&d=identicon&r=PG", "display_name": "emersion", "link": "https://stackoverflow.com/users/3567989/emersion"}, "edited": false, "score": 0, "creation_date": 1465847913, "post_id": 37796977, "comment_id": 63062279, "body": "@buka-ober That&#39;s what I&#39;m trying to do with <code>-lqxcb</code> (I have <code>libqxcb.a</code>) but maybe I missed something? How to do that?"}], "owner": {"reputation": 313, "user_id": 3567989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ce071dd3264c7d9f5d9c0b7137faa6b?s=128&d=identicon&r=PG", "display_name": "emersion", "link": "https://stackoverflow.com/users/3567989/emersion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 579, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1465843322, "creation_date": 1465843322, "question_id": 37796977, "link": "https://stackoverflow.com/questions/37796977/building-a-go-app-with-qt-statically-linked", "title": "Building a Go app with QT statically linked", "body": "<p>I want to build a self-contained app using QML and Go.</p>\n\n<p>I compiled QT statically:</p>\n\n<pre><code>./configure -static -release -opensource -confirm-license -prefix /home/simon/projects/qt-5.6.1/ -nomake examples -nomake tests -no-cups -no-alsa -no-pulseaudio -no-egl -no-audio-backend -no-gstreamer -no-sql-mysql -no-sql-sqlite -skip qtwebengine -skip multimedia -skip qtwebsockets -skip qtwebchannel  -qt-zlib -qt-libpng -qt-libjpeg -qt-freetype -qt-harfbuzz -no-libproxy -qt-pcre -qt-xcb -qt-xkbcommon-x11 -dbus-runtime -no-mtdev -no-openssl -no-glib -no-xcursor -no-xfixes -no-xrandr -no-xinerama -no-xinput -no-iconv -no-largefile -skip qtwayland -skip qtwinextras -skip qtsvg -skip qtsensors -skip qtcanvas3d -skip qtconnectivity -no-icu\nmake -j2\nmake install\n</code></pre>\n\n<p>I compiled my app with:</p>\n\n<pre><code>go build --ldflags '-extldflags \"-L/home/simon/projects/qt-5.6.1/lib -l qtpcre -l poly2tri -lqxcb -l qtharfbuzzng -l GL -l icuuc -l icuio -l icui18n -Wl,--no-as-needed -ldl\"'\n</code></pre>\n\n<p>What I get is an executable statically linked with QT and dynamically linked with libc/opengl/others:</p>\n\n<pre><code>ldd frontend \n\nlinux-vdso.so.1 (0x00007fffa295d000)\n\nlibstdc++.so.6 =&gt; /usr/lib/libstdc++.so.6 (0x00007f7006012000)\n\nlibpthread.so.0 =&gt; /usr/lib/libpthread.so.0 (0x00007f7005df5000)\n\nlibdl.so.2 =&gt; /usr/lib/libdl.so.2 (0x00007f7005bf1000)\n\nlibGL.so.1 =&gt; /usr/lib/libGL.so.1 (0x00007f7005980000)\n\nlibicuuc.so.57 =&gt; /usr/lib/libicuuc.so.57 (0x00007f70055d8000)\n\nlibicuio.so.57 =&gt; /usr/lib/libicuio.so.57 (0x00007f70053ca000)\n\nlibicui18n.so.57 =&gt; /usr/lib/libicui18n.so.57 (0x00007f7004f50000)\n\nlibm.so.6 =&gt; /usr/lib/libm.so.6 (0x00007f7004c4c000)\n\nlibgcc_s.so.1 =&gt; /usr/lib/libgcc_s.so.1 (0x00007f7004a36000)\n\nlibc.so.6 =&gt; /usr/lib/libc.so.6 (0x00007f7004695000)\n\n/lib64/ld-linux-x86-64.so.2 (0x00007f7006399000)\n\nlibexpat.so.1 =&gt; /usr/lib/libexpat.so.1 (0x00007f7004469000)\n\nlibxcb-dri3.so.0 =&gt; /usr/lib/libxcb-dri3.so.0 (0x00007f7004266000)\n\nlibxcb-present.so.0 =&gt; /usr/lib/libxcb-present.so.0 (0x00007f7004063000)\n\nlibxcb-randr.so.0 =&gt; /usr/lib/libxcb-randr.so.0 (0x00007f7003e53000)\n\nlibxcb-xfixes.so.0 =&gt; /usr/lib/libxcb-xfixes.so.0 (0x00007f7003c4b000)\n\nlibxcb-render.so.0 =&gt; /usr/lib/libxcb-render.so.0 (0x00007f7003a3d000)\n\nlibxcb-shape.so.0 =&gt; /usr/lib/libxcb-shape.so.0 (0x00007f7003839000)\n\nlibxcb-sync.so.1 =&gt; /usr/lib/libxcb-sync.so.1 (0x00007f7003632000)\n\nlibxshmfence.so.1 =&gt; /usr/lib/libxshmfence.so.1 (0x00007f700342f000)\n\nlibglapi.so.0 =&gt; /usr/lib/libglapi.so.0 (0x00007f7003201000)\n\nlibXext.so.6 =&gt; /usr/lib/libXext.so.6 (0x00007f7002fef000)\n\nlibXdamage.so.1 =&gt; /usr/lib/libXdamage.so.1 (0x00007f7002dec000)\n\nlibXfixes.so.3 =&gt; /usr/lib/libXfixes.so.3 (0x00007f7002be6000)\n\nlibX11-xcb.so.1 =&gt; /usr/lib/libX11-xcb.so.1 (0x00007f70029e4000)\n\nlibX11.so.6 =&gt; /usr/lib/libX11.so.6 (0x00007f70026a2000)\n\nlibxcb-glx.so.0 =&gt; /usr/lib/libxcb-glx.so.0 (0x00007f7002486000)\n\nlibxcb-dri2.so.0 =&gt; /usr/lib/libxcb-dri2.so.0 (0x00007f7002281000)\n\nlibxcb.so.1 =&gt; /usr/lib/libxcb.so.1 (0x00007f7002058000)\n\nlibXxf86vm.so.1 =&gt; /usr/lib/libXxf86vm.so.1 (0x00007f7001e52000)\n\nlibdrm.so.2 =&gt; /usr/lib/libdrm.so.2 (0x00007f7001c43000)\n\nlibicudata.so.57 =&gt; /usr/lib/libicudata.so.57 (0x00007f70001c7000)\n\nlibXau.so.6 =&gt; /usr/lib/libXau.so.6 (0x00007f6ffffc3000)\n\nlibXdmcp.so.6 =&gt; /usr/lib/libXdmcp.so.6 (0x00007f6fffdbd000)\n</code></pre>\n\n<p>But when I try to run it:</p>\n\n<pre><code>./frontend \n\n2016/06/13 19:49:18 .:0: QFactoryLoader::QFactoryLoader() ignoring \"org.qt-project.Qt.QPA.QPlatformIntegrationFactoryInterface.5.3\" since plugins are disabled in static builds\n\n2016/06/13 19:49:18 .:0: This application failed to start because it could not find or load the Qt platform plugin \"xcb\"\n\nin \"\".\n\nReinstalling the application may fix this problem.\n\nSIGABRT: abort\n\nPC=0x7f85aa7fc295 m=0\n\nsignal arrived during cgo execution\n\ngoroutine 1 [syscall, locked to thread]:\n\nruntime.cgocall(0x7d9df0, 0xc82004be10, 0x0)\n\n    /usr/lib/go/src/runtime/cgocall.go:123 +0x11b fp=0xc82004bde8 sp=0xc82004bdb8\n\ngopkg.in/qml%2ev1._Cfunc_newGuiApplication()\n\n    ??:0 +0x36 fp=0xc82004be10 sp=0xc82004bde8\n\ngopkg.in/qml%2ev1.Run(0xc82000b240, 0x0, 0x0)\n\n    /home/simon/go/src/gopkg.in/qml.v1/bridge.go:55 +0x10f fp=0xc82004be68 sp=0xc82004be10\n\nmain.main()\n\n    /home/simon/go/src/github.com/ProtonMail/Desktop-Import/frontend/main.go:52 +0x2d3 fp=0xc82004bf50 sp=0xc82004be68\n\nruntime.main()\n\n    /usr/lib/go/src/runtime/proc.go:188 +0x2b0 fp=0xc82004bfa0 sp=0xc82004bf50\n\nruntime.goexit()\n\n    /usr/lib/go/src/runtime/asm_amd64.s:1998 +0x1 fp=0xc82004bfa8 sp=0xc82004bfa0\n\ngoroutine 17 [syscall, locked to thread]:\n\nruntime.goexit()\n\n    /usr/lib/go/src/runtime/asm_amd64.s:1998 +0x1\n\nrax    0x0\n\nrbx    0x7ffc69a64030\n\nrcx    0x7f85aa7fc295\n\nrdx    0x6\n\nrdi    0x359b\n\nrsi    0x359b\n\nrbp    0x407b270\n\nrsp    0x7ffc69a63cd8\n\nr8     0x211f1e0\n\nr9     0x8\n\nr10    0x8\n\nr11    0x202\n\nr12    0x7ffc69a63ff0\n\nr13    0x18\n\nr14    0x7ffc69a64040\n\nr15    0x7ffc69a64000\n\nrip    0x7f85aa7fc295\n\nrflags 0x202\n\ncs     0x33\n\nfs     0x0\n\ngs     0x0\n</code></pre>\n\n<p>What's going on?</p>\n"}, {"tags": ["unit-testing", "go"], "answers": [{"comments": [{"owner": {"reputation": 833, "user_id": 458346, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9625fc13a1f2b06315c9cfefc97951ba?s=128&d=identicon&r=PG", "display_name": "thomascirca", "link": "https://stackoverflow.com/users/458346/thomascirca"}, "edited": false, "score": 0, "creation_date": 1465839410, "post_id": 37795750, "comment_id": 63057851, "body": "I was missing this crucial bit, re-reading the docs / examples this makes perfect sense."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 5, "last_activity_date": 1465838746, "creation_date": 1465838746, "answer_id": 37795750, "question_id": 37795629, "link": "https://stackoverflow.com/questions/37795629/correctly-using-httptest-to-mock-responses/37795750#37795750", "title": "Correctly using httptest to mock responses", "body": "<p>Your client only calls the URL you provided as the first argument to the <code>CheckURL</code> method. Give your client the URL of your test server:</p>\n\n<pre><code>done := client.CheckURL(ts.URL, json_response)\n</code></pre>\n"}], "owner": {"reputation": 833, "user_id": 458346, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9625fc13a1f2b06315c9cfefc97951ba?s=128&d=identicon&r=PG", "display_name": "thomascirca", "link": "https://stackoverflow.com/users/458346/thomascirca"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 704, "favorite_count": 0, "accepted_answer_id": 37795750, "answer_count": 1, "score": 1, "last_activity_date": 1465838746, "creation_date": 1465838341, "last_edit_date": 1495540727, "question_id": 37795629, "link": "https://stackoverflow.com/questions/37795629/correctly-using-httptest-to-mock-responses", "title": "Correctly using httptest to mock responses", "body": "<p>I have something that looks like so:</p>\n\n<pre><code>func (client *MyCustomClient) CheckURL(url string, json_response *MyCustomResponseStruct) bool {\n     r, err = http.Get(url)\n     if err != nil {\n         return false\n     }\n     defer r.Body.Close()\n     .... do stuff with json_response\n</code></pre>\n\n<p>And in my test, I have the following:</p>\n\n<pre><code>  func TestCheckURL(t *test.T) {\n       ts := httptest.NewServer(http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n           w.Header().Set(\"Content-Type\", \"text/html; charset=UTF-8\")\n           fmt.Fprintln(w, `{\"status\": \"success\"}`)\n       }))\n       defer ts.Close()\n\n       json_response := new(MyCustomResponseStruct)\n       client := NewMyCustomClient()  // returns instance of MyCustomClient\n       done := client.CheckURL(\"test.com\", json_response)\n</code></pre>\n\n<p>However, it does not appear as if the HTTP test server is working and that it actually goes out to test.com, as evidenced by the log output:</p>\n\n<pre><code> Get http:/test.com: dial tcp X.Y.Z.A: i/o timeout\n</code></pre>\n\n<p>My question is how to properly use the httptest package to mock out this request... I read through <a href=\"https://golang.org/pkg/net/http/httptest/\" rel=\"nofollow noreferrer\">the docs</a> and this helpful <a href=\"https://stackoverflow.com/questions/16154999/how-to-test-http-calls-in-go-using-httptest\">SO Answer</a> but I'm still stuck.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1465838525, "last_edit_date": 1465838525, "creation_date": 1465837479, "answer_id": 37795392, "question_id": 37795217, "link": "https://stackoverflow.com/questions/37795217/how-can-a-variadic-function-be-used-by-reflect-makefunc/37795392#37795392", "title": "How can a variadic function be used by reflect.MakeFunc", "body": "<p>A variadic argument is just represented as a slice, so in your example the swap function arguments would be a single slice of Values, instead of multiple Values. You can access the slice values via the <code>Value.Index</code> method:  <a href=\"https://play.golang.org/p/2b22FV_5v8\" rel=\"nofollow\">https://play.golang.org/p/2b22FV_5v8</a></p>\n\n<pre><code>swap := func(in []reflect.Value) []reflect.Value {\n    return []reflect.Value{in[0].Index(1), in[0].Index(0)}\n}\n\nmakeSwap := func(fptr interface{}) {\n    fn := reflect.ValueOf(fptr).Elem()\n    v := reflect.MakeFunc(fn.Type(), swap)\n    fn.Set(v)\n}\n\nvar intSwap func(...int) (int, int)\nmakeSwap(&amp;intSwap)\nfmt.Println(intSwap(0, 1))\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 277, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465838525, "creation_date": 1465836793, "question_id": 37795217, "link": "https://stackoverflow.com/questions/37795217/how-can-a-variadic-function-be-used-by-reflect-makefunc", "title": "How can a variadic function be used by reflect.MakeFunc", "body": "<p>The following is an excerpt from the MakeFunc Example in the reflection\ndocumentation.  I understand how it works with as it is shown.</p>\n\n<pre><code>// Make and call a swap function for ints.\nvar intSwap func(int, int) (int, int)\nmakeSwap(&amp;intSwap)\nfmt.Println(intSwap(0, 1))\n</code></pre>\n\n<p>WHAT I DON'T UNDERSTAND is how in the heck could it be used with a \nvariadic input.  </p>\n\n<pre><code>var intswap func(...int) (...int)   // Got to be wrong\nvar intswap func(...int) (int, int) // Will not work even with 2 inputs\n</code></pre>\n\n<p>Can someone give an example of MakeFunc using a variadic input??</p>\n\n<p>Can not find an example anywhere on the net!!!</p>\n\n<p>Thanks</p>\n"}, {"tags": ["function", "http", "go", "parameters"], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 1496317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8aaed7a968f12467148e2a8a8c4ac2c0?s=128&d=identicon&r=PG", "display_name": "tsdtsdtsd", "link": "https://stackoverflow.com/users/1496317/tsdtsdtsd"}, "edited": false, "score": 4, "creation_date": 1465830993, "post_id": 37793070, "comment_id": 63052878, "body": "In addition, the &quot;function without brackets&quot; as you named it, is called a callback and is a common technique, for which you can find lots of resources online. It is very common (and imho essential) in e.g. JavaScript."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 9, "last_activity_date": 1465831349, "last_edit_date": 1465831349, "creation_date": 1465829976, "answer_id": 37793070, "question_id": 37793000, "link": "https://stackoverflow.com/questions/37793000/in-golang-how-calling-a-function-with-and-without-trailing-brackets-works-when-u/37793070#37793070", "title": "In golang how calling a function with and without trailing brackets works when using net/http", "body": "<p>You are not \"calling\" the function from main, you are providing it as a argument to <code>HandleFunc</code>, registering it to be called for the path \"/\" in the <code>mux.Router</code>. This pattern of providing a function to be called later is typically known as a \"callback\".</p>\n\n<p>Your <code>ParseSlash</code> function is of the type <a href=\"https://golang.org/pkg/net/http/#HandlerFunc\"><code>http.HandlerFunc</code></a></p>\n\n<pre><code>type HandlerFunc func(ResponseWriter, *Request)\n</code></pre>\n\n<p>Your function is eventually called by the <code>http.Server</code> via its <code>ServeHTTP</code> method (here, via the <code>mux.Router</code>), passing the arguments shown. When the function is called, the <code>http.ResponseWriter</code> and <code>*http.Request</code> arguments are for the individual http request being handled.</p>\n"}, {"tags": [], "owner": {"reputation": 938, "user_id": 4951096, "user_type": "registered", "accept_rate": 20, "profile_image": "https://www.gravatar.com/avatar/b61a485cb682ddf00bf756e3680b3c50?s=128&d=identicon&r=PG&f=1", "display_name": "lofcek", "link": "https://stackoverflow.com/users/4951096/lofcek"}, "is_accepted": false, "score": 2, "last_activity_date": 1465832647, "creation_date": 1465832647, "answer_id": 37794006, "question_id": 37793000, "link": "https://stackoverflow.com/questions/37793000/in-golang-how-calling-a-function-with-and-without-trailing-brackets-works-when-u/37794006#37794006", "title": "In golang how calling a function with and without trailing brackets works when using net/http", "body": "<p>It is a simple callback. You need that, when you want to call some function in the future, but now you don't have enough information to do it. Look - http.ListenAndServe create a server and waits for client.</p>\n\n<p>You cannot call function ParseSlash, because it make sense after client will connect and will send address \"/\". When it happened router would have enough information to call your code back with arguments http.ResponseWriter and *http.Request.</p>\n\n<p>Now you should learn how closures works - <a href=\"https://tour.golang.org/moretypes/25\" rel=\"nofollow\">https://tour.golang.org/moretypes/25</a> . And you will done let's return back to http server <a href=\"https://www.nicolasmerouze.com/middlewares-golang-best-practices-examples/\" rel=\"nofollow\">https://www.nicolasmerouze.com/middlewares-golang-best-practices-examples/</a> .</p>\n"}], "owner": {"reputation": 1317, "user_id": 5414872, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/07e71c5939c157e8fa39100bb785262d?s=128&d=identicon&r=PG&f=1", "display_name": "scott", "link": "https://stackoverflow.com/users/5414872/scott"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 803, "favorite_count": 0, "accepted_answer_id": 37793070, "answer_count": 2, "score": 2, "last_activity_date": 1465832647, "creation_date": 1465829781, "last_edit_date": 1465831899, "question_id": 37793000, "link": "https://stackoverflow.com/questions/37793000/in-golang-how-calling-a-function-with-and-without-trailing-brackets-works-when-u", "title": "In golang how calling a function with and without trailing brackets works when using net/http", "body": "<p>In the main function, I have a gorilla mux router, and a function to handle the route.</p>\n\n<pre><code>var router = mux.NewRouter()\nfunc main() {   \n    router.HandleFunc(\"/\", ParseSlash)\n    http.Handle(\"/\", router)\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>and ParseSlash looks like</p>\n\n<pre><code>const slash = `&lt;h1&gt;Login&lt;/h1&gt;\n&lt;form method=\"post\" action=\"/login\"&gt;\n  &lt;label for=\"name\"&gt;User name&lt;/label&gt;\n  &lt;input type=\"text\" id=\"name\" name=\"name\"&gt;\n  &lt;label for=\"password\"&gt;Password&lt;/label&gt;\n  &lt;input type=\"password\" id=\"password\" name=\"password\"&gt;\n  &lt;button type=\"submit\"&gt;Login&lt;/button&gt;\n&lt;/form&gt;`\n\nfunc ParseSlash(response http.ResponseWriter, request *http.Request)  {\n    fmt.Fprintf(response, slash)\n}\n</code></pre>\n\n<p>However, in main, we are not calling the function as <code>ParseSlash()</code>, but <code>ParseSlash</code> inside <code>router.HandleFunc()</code>. Where do the function get the parameters from, if we are not providing explicitely? What is this way of calling a function termed as?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["dictionary", "go"], "comments": [{"owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 1, "creation_date": 1465834923, "post_id": 37789230, "comment_id": 63055455, "body": "is discoveryAttr a map?"}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "reply_to_user": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1465835578, "post_id": 37789230, "comment_id": 63055815, "body": "@matt.s Yes, it is a map."}, {"owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1465839536, "post_id": 37789230, "comment_id": 63057927, "body": "It isn&#39;t obvious since you have an integer key, which could be an index instead."}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "reply_to_user": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1465851331, "post_id": 37789230, "comment_id": 63063963, "body": "@matt.s Yeah. I have updated the question to make it clear now."}], "answers": [{"comments": [{"owner": {"reputation": 245, "user_id": 1496317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8aaed7a968f12467148e2a8a8c4ac2c0?s=128&d=identicon&r=PG", "display_name": "tsdtsdtsd", "link": "https://stackoverflow.com/users/1496317/tsdtsdtsd"}, "edited": false, "score": 1, "creation_date": 1465822675, "post_id": 37789231, "comment_id": 63046849, "body": "discoveryAttr could also be a slice containing maps, so []map[string][]string would also work, right?"}, {"owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1465835065, "post_id": 37789231, "comment_id": 63055536, "body": "@Prateek, the parentheses aren&#39;t necessary (though they can be helpful), so the type is more accurately <code>map[int]map[string][]string</code>."}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "reply_to_user": {"reputation": 245, "user_id": 1496317, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8aaed7a968f12467148e2a8a8c4ac2c0?s=128&d=identicon&r=PG", "display_name": "tsdtsdtsd", "link": "https://stackoverflow.com/users/1496317/tsdtsdtsd"}, "edited": false, "score": 0, "creation_date": 1465835499, "post_id": 37789231, "comment_id": 63055773, "body": "@tsdtsdtsd It cannot be a slice. Slice cannot be accessed via key."}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "reply_to_user": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "edited": false, "score": 0, "creation_date": 1465835556, "post_id": 37789231, "comment_id": 63055810, "body": "@matt.s Yes, the parenthesis are helpful for understanding although not required."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 2, "creation_date": 1465851141, "post_id": 37789231, "comment_id": 63063876, "body": "@Prateek yes, but the &quot;0&quot; can easily be a slice index rather than a key: <a href=\"https://play.golang.org/p/hcAAm3aF4G\" rel=\"nofollow noreferrer\">play.golang.org/p/hcAAm3aF4G</a>.  In that case, the same assignment syntax (<code>discoveryAttr[0][&quot;add&quot;] = []string{&quot;brand_name&quot;}</code>) could mean that <code>discoveryAttr</code> is a map of ints to maps of strings to slices of strings, or it could mean that <code>discoveryAttr</code> is a slice of maps of strings to slices of strings.  Both are valid interpretations."}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1465851286, "post_id": 37789231, "comment_id": 63063942, "body": "@Kaedys Yeah, I cleared up the issue in Question Description now."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1465851397, "post_id": 37789231, "comment_id": 63063984, "body": "@Prateek ok, then the nested map version is the correct way of doing it.  <code>map[int]map[string][]string</code>."}, {"owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "reply_to_user": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1465851558, "post_id": 37789231, "comment_id": 63064029, "body": "@Kaedys Yes, I have mentioned the same in answer along with parenthesis to make it easy to understand."}], "tags": [], "owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "is_accepted": false, "score": 2, "last_activity_date": 1465818965, "creation_date": 1465818965, "answer_id": 37789231, "question_id": 37789230, "link": "https://stackoverflow.com/questions/37789230/create-a-map-with-a-particular-type-of-data/37789231#37789231", "title": "Create a map with a particular type of data", "body": "<p>A go map must have 2 components only. </p>\n\n<p>map[key]data -> key and data can be any type of value. </p>\n\n<p>In the above case, the 1st key is int. Hence the value must mapstring</p>\n\n<p>Hence, the type will be <code>map[int](map[string]([]string)))</code></p>\n"}], "owner": {"reputation": 4704, "user_id": 2077459, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/c66fbcda79317065038bbe8f63a55267?s=128&d=identicon&r=PG", "display_name": "Prateek", "link": "https://stackoverflow.com/users/2077459/prateek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465851243, "creation_date": 1465818965, "last_edit_date": 1465851243, "question_id": 37789230, "link": "https://stackoverflow.com/questions/37789230/create-a-map-with-a-particular-type-of-data", "title": "Create a map with a particular type of data", "body": "<p>I want to set values in a particular format as follows:</p>\n\n<p><code>discoveryAttr[0][\"add\"] = []string{\"brand_name\"}</code></p>\n\n<p>How to design my map here? </p>\n\n<p>Here 0 is not a slice index. It refers to the value of item - like itemId.</p>\n"}, {"tags": ["go", "gitlab-ci", "gitlab-ci-runner"], "comments": [{"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 1, "creation_date": 1465849852, "post_id": 37786462, "comment_id": 63063258, "body": "Are you not vendoring your dependencies?  That would solve the fetch-everything-on-build issue, as all of the deps would be safely checked into your repository.  Vendoring also ensures reliably repeatable builds, even if one of your deps makes a breaking change or its repo vanishes.  Go 1.5+ added in direct support for vendoring, where anything in <code>&lt;project root&gt;&#47;vendor&#47;</code> gets treated as if it&#39;s in <code>$GOPATH&#47;src</code> by the Go tool for any builds of that project only, so you don&#39;t even have to change your import lines."}], "answers": [{"tags": [], "owner": {"reputation": 122, "user_id": 4241670, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/329e413106cac2bb6d6a281b40f8b8d3?s=128&d=identicon&r=PG&f=1", "display_name": "Corbin", "link": "https://stackoverflow.com/users/4241670/corbin"}, "is_accepted": true, "score": 1, "last_activity_date": 1465933963, "creation_date": 1465933963, "answer_id": 37820932, "question_id": 37786462, "link": "https://stackoverflow.com/questions/37786462/global-gopath-in-gitlab-ci/37820932#37820932", "title": "Global GOPATH in gitlab-ci", "body": "<p>I would agree with @Kaedys on this one. If you use vendored dependencies and cached your <code>vendor</code> directories you wouldn't have to fetch them for every build. If you aren't vendoring already there's a handful of <a href=\"https://github.com/golang/go/wiki/PackageManagementTools\" rel=\"nofollow\">tools to help you</a>. </p>\n\n<p>I have seen local GOPATH work too. I'm not sure exactly how you implemented it, but you can take a look <a href=\"https://github.com/concourse/concourse\" rel=\"nofollow\">here for an example</a> of how it can be done. They have a local environment that sets the GOPATH to the project directory when inside the directory. </p>\n"}], "owner": {"reputation": 1250, "user_id": 51721, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/KcEea.jpg?s=128&g=1", "display_name": "Igor Lankin", "link": "https://stackoverflow.com/users/51721/igor-lankin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1117, "favorite_count": 0, "accepted_answer_id": 37820932, "answer_count": 1, "score": 0, "last_activity_date": 1465940526, "creation_date": 1465811009, "last_edit_date": 1465940526, "question_id": 37786462, "link": "https://stackoverflow.com/questions/37786462/global-gopath-in-gitlab-ci", "title": "Global GOPATH in gitlab-ci", "body": "<p>We are building several GO projects on our gitlab ci and we have the following dilemma. </p>\n\n<p>When building projects with a <em>global</em> GOPATH (like on local machines), the builds take too long as all the dependencies are fetched on every build.  </p>\n\n<p>On the other hand, when defining a local GOPATH and caching the folders created by go get, we get fast builds, but awkward project setups, where the project itself is not on the GOPATH etc...</p>\n\n<p>It would be nice if there was global caching but gitlab-ci does not allow that:</p>\n\n<blockquote>\n  <p>WARNING: /build/src/git.my.repo: not supported: outside build directory</p>\n</blockquote>\n"}, {"tags": ["testing", "go", "glog"], "answers": [{"tags": [], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "is_accepted": true, "score": 3, "last_activity_date": 1465799201, "creation_date": 1465799201, "answer_id": 37783058, "question_id": 37782433, "link": "https://stackoverflow.com/questions/37782433/how-to-set-log-level-in-go-test/37783058#37783058", "title": "How to set log level in go test?", "body": "<p>You can log your messages to console by setting few flags. Try the below code in the init() function. </p>\n\n<pre><code>flag.Set(\"alsologtostderr\", fmt.Sprintf(\"%t\", true))\nvar logLevel string\nflag.StringVar(&amp;logLevel, \"logLevel\", \"4\", \"test\")\nflag.Lookup(\"v\").Value.Set(logLevel)\n</code></pre>\n"}], "owner": {"reputation": 3680, "user_id": 1813875, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/6078165a3f6a8693a0b1a1101e9260c7?s=128&d=identicon&r=PG", "display_name": "harryz", "link": "https://stackoverflow.com/users/1813875/harryz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3318, "favorite_count": 1, "accepted_answer_id": 37783058, "answer_count": 1, "score": 1, "last_activity_date": 1465799201, "creation_date": 1465796093, "question_id": 37782433, "link": "https://stackoverflow.com/questions/37782433/how-to-set-log-level-in-go-test", "title": "How to set log level in go test?", "body": "<p>Hi I am running my unit tests by using:\n<code>godep go test -v -run TestMyCode</code>, </p>\n\n<p>but I did not find a way to show my info logs in my tests:</p>\n\n<pre><code>glog.V(4).Infof(\"Adding new pods from source %s : %v\", source, update.Pods)\n</code></pre>\n\n<p>Is it possible? </p>\n"}, {"tags": ["json", "postgresql", "datetime", "go", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 5805, "user_id": 880118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/qdJEg.jpg?s=128&g=1", "display_name": "TecHunter", "link": "https://stackoverflow.com/users/880118/techunter"}, "edited": false, "score": 0, "creation_date": 1617784969, "post_id": 37782482, "comment_id": 118400237, "body": "what if you have have no control over the JSON input? what would be the solution then"}, {"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "reply_to_user": {"reputation": 5805, "user_id": 880118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/qdJEg.jpg?s=128&g=1", "display_name": "TecHunter", "link": "https://stackoverflow.com/users/880118/techunter"}, "edited": false, "score": 0, "creation_date": 1617792825, "post_id": 37782482, "comment_id": 118403808, "body": "@techunter a custom unmarshaller"}], "tags": [], "owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "is_accepted": true, "score": 9, "last_activity_date": 1465797790, "last_edit_date": 1465797790, "creation_date": 1465796373, "answer_id": 37782482, "question_id": 37782278, "link": "https://stackoverflow.com/questions/37782278/fully-parsing-timestamps-in-golang/37782482#37782482", "title": "Fully Parsing Timestamps in Golang", "body": "<p>JSON unmarshalling of <code>time.Time</code> <a href=\"https://golang.org/pkg/time/#Time.UnmarshalJSON\" rel=\"noreferrer\">expects</a> date string to be in RFC 3339 format.</p>\n\n<p>So in your golang program that generates the JSON, instead of simply printing the <code>time.Time</code> value, use <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"noreferrer\">Format</a> to print it in RFC 3339 format.</p>\n\n<pre><code>t.Format(time.RFC3339)\n</code></pre>\n\n<blockquote>\n  <p>if I serialize a Time.time type, I would think it should still be\n  understood at the other side of the process</p>\n</blockquote>\n\n<p>If you used the <a href=\"https://golang.org/pkg/time/#Time.MarshalJSON\" rel=\"noreferrer\">Marshaller interface</a> with the serializing, it would indeed output the date in RFC 3339 format. So the other side of the process will understand it. So you can do that as well.</p>\n\n<pre><code>d := DataBlob{Datetime: t}\nenc := json.NewEncoder(fileWriter)\nenc.Encode(d)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5805, "user_id": 880118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/qdJEg.jpg?s=128&g=1", "display_name": "TecHunter", "link": "https://stackoverflow.com/users/880118/techunter"}, "is_accepted": false, "score": 0, "last_activity_date": 1617954462, "creation_date": 1617954462, "answer_id": 67017059, "question_id": 37782278, "link": "https://stackoverflow.com/questions/37782278/fully-parsing-timestamps-in-golang/67017059#67017059", "title": "Fully Parsing Timestamps in Golang", "body": "<p>For reference, if you need custom unmarshalling with time types you need to create your own type with the UnmarshallJSON method. Exemple with Timestamp</p>\n<pre><code>type Timestamp struct {\n    time.Time\n}\n\n// UnmarshalJSON decodes an int64 timestamp into a time.Time object\nfunc (p *Timestamp) UnmarshalJSON(bytes []byte) error {\n    // 1. Decode the bytes into an int64\n    var raw int64\n    err := json.Unmarshal(bytes, &amp;raw)\n\n    if err != nil {\n        fmt.Printf(&quot;error decoding timestamp: %s\\n&quot;, err)\n        return err\n    }\n\n    // 2 - Parse the unix timestamp\n    *&amp;p.Time = time.Unix(raw, 0)\n    return nil\n}\n</code></pre>\n<p>Then use the type in your struct:</p>\n<pre><code>type DataBlob struct {\n  ....\n  Datetime Timestamp `json:&quot;datetime&quot;`\n  ....\n}\n</code></pre>\n"}], "owner": {"reputation": 5438, "user_id": 1944335, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/8675e8c601fc98c0ad3a8272b417d0de?s=128&d=identicon&r=PG&f=1", "display_name": "James Taylor", "link": "https://stackoverflow.com/users/1944335/james-taylor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8995, "favorite_count": 2, "accepted_answer_id": 37782482, "answer_count": 2, "score": 9, "last_activity_date": 1617954462, "creation_date": 1465795132, "question_id": 37782278, "link": "https://stackoverflow.com/questions/37782278/fully-parsing-timestamps-in-golang", "title": "Fully Parsing Timestamps in Golang", "body": "<p>I'm trying to make a simple tool which parses JSON-formatted lines in a file and performs an <code>INSERT</code> operation into a database.</p>\n\n<p>I have a struct which looks like this:</p>\n\n<pre><code>type DataBlob struct {\n  ....\n  Datetime time.Time `json:\"datetime, string\"`\n  ....\n}\n</code></pre>\n\n<p>And parsing code which looks like this:</p>\n\n<pre><code>scanner := bufio.NewScanner(file)\n// Loop through all lines in the file\nfor scanner.Scan() {\n    var t DataBlob\n\n    // Decode the line, parse the JSON\n    dec := json.NewDecoder(strings.NewReader(scanner.Text()))\n    if err := dec.Decode(&amp;t);\n    err != nil {\n        panic(err)\n    }\n\n    // Perform the database operation\n    executionString: = \"INSERT INTO observations (datetime) VALUES ($1)\"\n    _, err := db.Exec(executionString, t.Datetime)\n    if err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>My JSON file has lines, each containing a <code>datetime</code> value that looks like this:</p>\n\n<pre><code>{ \"datetime\": 1465793854 }\n</code></pre>\n\n<p>When the <code>datetime</code> is formatted as a Unix timestamp, the Marshaller complains:</p>\n\n<pre><code>panic: parsing time \"1465793854\" as \"\"2006-01-02T15:04:05Z07:00\"\": cannot parse \"1465793854\" as \"\"\"\n</code></pre>\n\n<hr>\n\n<p>In the script that generates the JSON (also written in Golang), I tried simply printing the String representation of the <code>Time.time</code> type, producing the following:</p>\n\n<pre><code>{ \"datetime\": \"2016-06-13 00:23:34 -0400 EDT\" }\n</code></pre>\n\n<p>To which the Marshaller complains when I go to parse it:</p>\n\n<pre><code>panic: parsing time \"\"2016-06-13 00:23:34 -0400 EDT\"\" as \"\"2006-01-02T15:04:05Z07:00\"\": cannot parse \" 00:23:34 -0400 EDT\"\" as \"T\"\n</code></pre>\n\n<p>If I also treat this timestamp (which looks pretty standard) as a String and avoid the Marshaling problem, Postgres complains when I try to perform the insertion:</p>\n\n<pre><code>panic: pq: invalid input syntax for type timestamp: \"2016-06-13 00:23:34 -0400 EDT\"\n</code></pre>\n\n<p>This is frustrating on a number of levels, but mainly because if I serialize a <code>Time.time</code> type, I would think it should still be understood at the other side of the process.</p>\n\n<p>How can I go about parsing this timestamp to perform the database insertion? Apologizes for the lengthy question and thanks for your help!</p>\n"}, {"tags": ["http", "go", "server", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 1024, "user_id": 2702306, "user_type": "registered", "accept_rate": 32, "profile_image": "https://i.stack.imgur.com/FlJhs.jpg?s=128&g=1", "display_name": "IhtkaS", "link": "https://stackoverflow.com/users/2702306/ihtkas"}, "is_accepted": false, "score": 1, "last_activity_date": 1465798226, "creation_date": 1465798226, "answer_id": 37782846, "question_id": 37782073, "link": "https://stackoverflow.com/questions/37782073/webhook-process-run-on-another-goroutine/37782846#37782846", "title": "Webhook process run on another goroutine", "body": "<p>If you care for acknowledgement for the mail, then the posted code won't help. Running the code in separate goroutine makes it independent and the server reply will be success even if the mail is not sent due to some error in the goroutine function.</p>\n"}, {"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1465812189, "last_edit_date": 1495540354, "creation_date": 1465801167, "answer_id": 37783535, "question_id": 37782073, "link": "https://stackoverflow.com/questions/37782073/webhook-process-run-on-another-goroutine/37783535#37783535", "title": "Webhook process run on another goroutine", "body": "<p>Serving each http request runs in its own goroutine (<a href=\"https://stackoverflow.com/questions/37529511/process-management-for-the-go-webserver\">more details on this</a>). You are allowed to start new goroutines from your handler, and they will run concurrently, independently from the goroutine executing the handler.</p>\n\n<p>Some things to look out for:</p>\n\n<ul>\n<li><p>The new goroutine runs independently from the handler goroutine. This means it may complete before or after the handler goroutine, you cannot (should not) assume anything regarding to this without explicit synchronization.</p></li>\n<li><p>The <a href=\"https://golang.org/pkg/net/http/#ResponseWriter\" rel=\"nofollow noreferrer\"><code>http.ResponseWriter</code></a> and <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\"><code>http.Request</code></a> arguments of the handler are only valid and safe to use until the handler returns! These values (or \"parts\" of them) may be reused - this is an implementation detail of which you should also not assume anything. Once the handler returns, you should not touch (not even read) these values.</p></li>\n<li><p>Once the handler returns, the response is committed (or may be committed at any moment). Which means your new goroutine should not attempt to send back any data using the <code>http.ResponseWriter</code> after this. This is true to the extent that even if you don't touch the <code>http.ResponseWriter</code> in your handler, not panicing from the handler is taken as a successful handling of the request and thus HTTP 200 status is sent back (<a href=\"https://stackoverflow.com/questions/27972715/multiple-response-writeheader-calls-in-really-simple-example\">see an example of this</a>).</p></li>\n</ul>\n\n<p>You are allowed to pass the <code>http.Request</code> and <code>http.ResponseWriter</code> values to other functions and to new goroutines, but care must be taken: you should use explicit synchronization (e.g. locks, channels) if you intend to read / modify these values from multiple goroutines (or you want to send back data from multiple goroutines).</p>\n\n<p>Note that seemingly if both your handler goroutine and your new goroutine just reads / inspects the <code>http.Request</code>, that still may be problematic. Yes, multiple goroutines can read the same variable without synchronization (if nobody modifies it). But calling certain methods of <code>http.Request</code> also modify the <code>http.Request</code>, and without synchronization there is no guarantee what other goroutines would see from this change. For example <a href=\"https://golang.org/pkg/net/http/#Request.FormValue\" rel=\"nofollow noreferrer\"><code>Request.FormValue()</code></a> returns a form value associated with the given key. But this method calls <a href=\"https://golang.org/pkg/net/http/#Request.ParseMultipartForm\" rel=\"nofollow noreferrer\"><code>ParseMultiPartForm()</code></a> and <a href=\"https://golang.org/pkg/net/http/#Request.ParseForm\" rel=\"nofollow noreferrer\"><code>ParseForm()</code></a> if necessary which modify the <code>http.Request</code> (e.g. they set the <code>Request.PostForm</code> and <code>Request.Form</code> struct fields).</p>\n\n<p>So unless you synchronize your goroutines, you should not pass <code>Request</code> and <code>ResponseWriter</code> to the new goroutine, but acquire data needed from the <code>Request</code> in the handler goroutine, and pass only e.g. a <code>struct</code> holding the needed data.</p>\n\n<p>Your second example:</p>\n\n<pre><code>foo := int64(0)\nbar := func() {\n   // do slow things with foo\n}\ngo bar()\n</code></pre>\n\n<p>This is perfectly fine. This is a <a href=\"https://golang.org/ref/spec#Function_literals\" rel=\"nofollow noreferrer\">closure</a>, and local variables referred by it will survive as long as they are accessible.</p>\n\n<p>Note that alternatively you could pass the value of the local variable to the anonymous function call as an argument like this:</p>\n\n<pre><code>foo := int64(0)\nbar := func(foo int64) {\n   // do slow things with param foo (not the local foo var)\n}\ngo bar(foo)\n</code></pre>\n\n<p>In this example the anonymous function will see and use its parameter <code>foo</code> and not the local variable <code>foo</code>. This may or may not be what you want (depending on whether the handler also uses the <code>foo</code> and whether changes made by any of the goroutines need to be visible to the other - but that would require synchronization anyway, which would be superseded by a channel solution).</p>\n"}], "owner": {"reputation": 20389, "user_id": 1620210, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/8f130b2fa9903fca10a10b31ed3f7b94?s=128&d=identicon&r=PG", "display_name": "Kokizzu", "link": "https://stackoverflow.com/users/1620210/kokizzu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 389, "favorite_count": 0, "accepted_answer_id": 37783535, "answer_count": 2, "score": 2, "last_activity_date": 1552463161, "creation_date": 1465793886, "last_edit_date": 1552463161, "question_id": 37782073, "link": "https://stackoverflow.com/questions/37782073/webhook-process-run-on-another-goroutine", "title": "Webhook process run on another goroutine", "body": "<p>I want to run some slow routine in another goroutine, is it safe to do it like this:</p>\n\n<pre><code>func someHandler(w http.ResponseWriter, r *http.Request) {\n   go someReallySlowFunction() // sending mail or something slow\n   fmt.Fprintf(w,\"Mail will be delivered shortly..\")\n}\n\nfunc otherHandler(w http.ResponseWriter, r *http.Request) {\n   foo := int64(0)\n   bar := func() {\n      // do slow things with foo\n   }\n   go bar()\n   fmt.Fprintf(w,\"Mail will be delivered shortly..\")\n}\n</code></pre>\n\n<p>Is there any gotchas by doing this?</p>\n"}, {"tags": ["windows", "dll", "go", "com"], "comments": [{"owner": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "edited": false, "score": 0, "creation_date": 1465819194, "post_id": 37781676, "comment_id": 63044413, "body": "You are using <code>proc</code> incorrectly. It is like a wrapper for a function DllGetClassObject, not a class object which DllGetClassObject returned. It doesn&#39;t have such method."}, {"owner": {"reputation": 71, "user_id": 5579183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ebddaf1f13fa6169eee72a89e06c7bd?s=128&d=identicon&r=PG&f=1", "display_name": "Jungwan Nam", "link": "https://stackoverflow.com/users/5579183/jungwan-nam"}, "reply_to_user": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "edited": false, "score": 0, "creation_date": 1465820151, "post_id": 37781676, "comment_id": 63045087, "body": "What should I change? @V.Kravchenko"}, {"owner": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "edited": false, "score": 4, "creation_date": 1465820737, "post_id": 37781676, "comment_id": 63045522, "body": "Using com is quite difficult with go, I guess. Try studying more deeply com and looking here <a href=\"https://github.com/go-ole/go-ole\" rel=\"nofollow noreferrer\">github.com/go-ole/go-ole</a> ."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 1743, "user_id": 5502206, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/07e05d0d997fd75b4881e5c39055222a?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kravchenko", "link": "https://stackoverflow.com/users/5502206/v-kravchenko"}, "edited": false, "score": 1, "creation_date": 1465837292, "post_id": 37781676, "comment_id": 63056685, "body": "COM is different from merely calling exported functions of loaded DLLs, so I&#39;m with @V.Kravchenko on that you should probably use the dedicated package to work with COM. As to calling exported functions, look at your Go sources -- specifically the files with names matching <code>*_windows.go</code> under the <code>src&#47;syscall</code> directory: they contain lots of examples which make use of <code>NewProc()</code> and <code>syscall.Syscall*()</code> functions."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1465837559, "post_id": 37781676, "comment_id": 63056825, "body": "Two more points: 1) from the screenshot, it appears the DLL is written in C++; the problem with such libraries is that the mechanism for exporting symbols from dynamically-linked libraries predates C++ and does not &quot;know&quot; about C++&#39;s namespaces and function overloading, so to support those things in exported names C++ compilers perform the so-called &quot;name mangling&quot; on the symbols they export, and there&#39;s no standard on doing that -- different compilers to that differently."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 3, "creation_date": 1465837790, "post_id": 37781676, "comment_id": 63056966, "body": "Hence I&#39;m afraid that to actually interface a DLL produced by a C++ compiler with Go you&#39;d need to either wrap that DLL in another one -- written in C++ and exposing a plain C interface (via the <code>extern &quot;C&quot; { ... }&quot;</code> standard mechanism) wrapping those C++ methods or use a tool like SWIG to create a &quot;bridge&quot; code for Go. 2) When using COM, you don&#39;t load DLLs providing COM objects directly, but rather you use the appropriate Win32 API calls which <i>indirectly</i> instantiate a COM object for you -- by its name or GUID identifier. And then operate it indirectly as well. That&#39;s what <code>go-ole</code> does."}, {"owner": {"reputation": 5609, "user_id": 1226748, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/RfDKy.jpg?s=128&g=1", "display_name": "Jimmy Obonyo Abor", "link": "https://stackoverflow.com/users/1226748/jimmy-obonyo-abor"}, "edited": false, "score": 0, "creation_date": 1489088949, "post_id": 37781676, "comment_id": 72530496, "body": "i think go-ole: github.com/go-ole/go-ole package is actually what you need here"}], "answers": [{"tags": [], "owner": {"reputation": 3592, "user_id": 6276385, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/89c7b071a5c25c2f6ccc6f1f41bdb2e3?s=128&d=identicon&r=PG&f=1", "display_name": "gonutz", "link": "https://stackoverflow.com/users/6276385/gonutz"}, "is_accepted": false, "score": 4, "last_activity_date": 1505462479, "creation_date": 1505462479, "answer_id": 46234640, "question_id": 37781676, "link": "https://stackoverflow.com/questions/37781676/how-to-use-com-component-object-model-in-golang/46234640#46234640", "title": "How to use COM (Component Object Model) in Golang", "body": "<p>I had a similar problem in my <a href=\"https://github.com/gonutz/d3d9\" rel=\"nofollow noreferrer\">Direct3D9 Go wrapper</a>, see <a href=\"https://stackoverflow.com/questions/39162054/call-com-object-method-from-go-without-cgo\">this thread</a>, where I was able to call DirectX COM functions from pure Go.</p>\n\n<p>In your code you try to call <code>proc.ConnectServer(...)</code> but the way to call a <code>syscall.LazyProc</code> is with its <code>Call</code> function. Looking at the <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms680760(v=vs.85).aspx\" rel=\"nofollow noreferrer\">documentation for DllGetClassObject</a>, the signature is</p>\n\n<pre><code>HRESULT __stdcall DllGetClassObject(\n  _In_  REFCLSID rclsid,\n  _In_  REFIID   riid,\n  _Out_ LPVOID   *ppv\n);\n</code></pre>\n\n<p>This means you have to pass these three parameters to <code>proc.Call</code> as <code>uintptr</code>s (<code>Call</code> expects all arguments to be <code>uintptr</code>s).</p>\n\n<pre><code>package main\n\nimport \"syscall\"\n\nvar (\n    xaSession      = syscall.NewLazyDLL(\"XA_Session.dll\")\n    getClassObject = xaSession.NewProc(\"DllGetClassObject\")\n)\n\nfunc main() {\n    // TODO set these variables to the appropriate values\n    var rclsid, riid, ppv uintptr\n    ret, _, _ := getClassObject.Call(rclsid, riid, ppv)\n    // ret is the HRESULT value returned by DllGetClassObject, check it for errors\n}\n</code></pre>\n\n<p>Note that you need to set the parameter values correctly, the CLSID and IID may be contained in the accompanying C header file for the library, I don't know this XA_Session library.</p>\n\n<p>The <code>ppv</code> will in this case be a pointer to the COM object that you created. To use COM methods from Go, you can create wrapper types, given you know all the COM methods defined by it and their correct order. All COM objects support the <code>QueryInterface</code>, <code>AddRef</code> and <code>Release</code> functions and then additional, type specific methods.</p>\n\n<p>Let's say your XA_Session object additionally supports these two functions (again, I don't know what it really supports, you have to look that up)</p>\n\n<pre><code>int ConnectServer(int id)\nDisconnectServer()\n</code></pre>\n\n<p>then what you can do to wrap that in Go is the following:</p>\n\n<pre><code>package xasession\n\nimport (\n    \"syscall\"\n    \"unsafe\"\n)\n\n// NewXASession casts your ppv from above to a *XASession\nfunc NewXASession(ppv uintptr) *XASession {\n    return (*XASession)(unsafe.Pointer(ppv))\n}\n\n// XASession is the wrapper object on which to call the wrapper methods.\ntype XASession struct {\n    vtbl *xaSessionVtbl\n}\n\ntype xaSessionVtbl struct {\n    // every COM object starts with these three\n    QueryInterface uintptr\n    AddRef         uintptr\n    Release        uintptr\n    // here are all additional methods of this COM object\n    ConnectServer    uintptr\n    DisconnectServer uintptr\n}\n\nfunc (obj *XASession) AddRef() uint32 {\n    ret, _, _ := syscall.Syscall(\n        obj.vtbl.AddRef,\n        1,\n        uintptr(unsafe.Pointer(obj)),\n        0,\n        0,\n    )\n    return uint32(ret)\n}\n\nfunc (obj *XASession) Release() uint32 {\n    ret, _, _ := syscall.Syscall(\n        obj.vtbl.Release,\n        1,\n        uintptr(unsafe.Pointer(obj)),\n        0,\n        0,\n    )\n    return uint32(ret)\n}\n\nfunc (obj *XASession) ConnectServer(id int) int {\n    ret, _, _ := syscall.Syscall(\n        obj.vtbl.ConnectServer, // function address\n        2, // number of parameters to this function\n        uintptr(unsafe.Pointer(obj)), // always pass the COM object address first\n        uintptr(id), // then all function parameters follow\n        0,\n    )\n    return int(ret)\n}\n\nfunc (obj *XASession) DisconnectServer() {\n    syscall.Syscall(\n        obj.vtbl.DisconnectServer,\n        1,\n        uintptr(unsafe.Pointer(obj)),\n        0,\n        0,\n    )\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1759, "user_id": 4417818, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/100000126145913/picture?type=large", "display_name": "Nilesh", "link": "https://stackoverflow.com/users/4417818/nilesh"}, "is_accepted": false, "score": 0, "last_activity_date": 1581420142, "creation_date": 1581420142, "answer_id": 60167712, "question_id": 37781676, "link": "https://stackoverflow.com/questions/37781676/how-to-use-com-component-object-model-in-golang/60167712#60167712", "title": "How to use COM (Component Object Model) in Golang", "body": "<p><a href=\"https://github.com/go-adsi/adsi\" rel=\"nofollow noreferrer\">https://github.com/go-adsi/adsi</a> library has implementation for ADSI COM objects. It uses go-ole and comutil library.\nThis could be good starting point for other COM object use cases.</p>\n"}], "owner": {"reputation": 71, "user_id": 5579183, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ebddaf1f13fa6169eee72a89e06c7bd?s=128&d=identicon&r=PG&f=1", "display_name": "Jungwan Nam", "link": "https://stackoverflow.com/users/5579183/jungwan-nam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6894, "favorite_count": 3, "answer_count": 2, "score": 4, "last_activity_date": 1581420142, "creation_date": 1465790817, "last_edit_date": 1525712697, "question_id": 37781676, "link": "https://stackoverflow.com/questions/37781676/how-to-use-com-component-object-model-in-golang", "title": "How to use COM (Component Object Model) in Golang", "body": "<p>I have a Windows DLL (XA_Session.dll) file but I don't know how to use it in golang.</p>\n\n<p>This is a DLL Viewer picture </p>\n\n<p><img src=\"https://i.stack.imgur.com/ppSY5.jpg\" alt=\"\"></p>\n\n<p>I want to use the <code>ConnectServer</code> COM Method.</p>\n\n<p>Here is my code</p>\n\n<pre><code>package main\n\nimport (\n    \"syscall\"\n    \"fmt\"\n)\n\nvar (\n    mod = syscall.NewLazyDLL(\"XA_Session.dll\")\n    proc = mod.NewProc(\"DllGetClassObject\")\n)\n\nfunc main() {\n    var bConnect bool\n    bConnect = proc.ConnectServer(\"hts.ebestsec.co.kr\", 20001)\n\n    if bConnect {\n        fmt.Println(\"Success\")\n    } else {\n        fmt.Println(\"Fail\")\n    }\n}\n</code></pre>\n\n<p>compile error: </p>\n\n<blockquote>\n  <p>.\\main.go:17: proc.ConnectServer undefined (type *syscall.LazyProc has no field or method ConnectServer)</p>\n</blockquote>\n"}, {"tags": ["go", "syntax"], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": true, "score": 19, "last_activity_date": 1465786137, "creation_date": 1465786137, "answer_id": 37781160, "question_id": 37781135, "link": "https://stackoverflow.com/questions/37781135/golang-function-parameter-without-type/37781160#37781160", "title": "Golang function parameter without type?", "body": "<p>Per <a href=\"https://tour.golang.org/basics/5\" rel=\"noreferrer\">https://tour.golang.org/basics/5</a>:</p>\n\n<blockquote>\n  <p>When two or more consecutive named function parameters share a type,\n  you can omit the type from all but the last.</p>\n  \n  <p>In this example, we shortened</p>\n  \n  <p><code>x int, y int</code></p>\n  \n  <p>to</p>\n  \n  <p><code>x, y int</code></p>\n</blockquote>\n"}], "owner": {"reputation": 6841, "user_id": 1190965, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/3e74ed8e572542a718df5f15ead40581?s=128&d=identicon&r=PG", "display_name": "nodakai", "link": "https://stackoverflow.com/users/1190965/nodakai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4085, "favorite_count": 1, "accepted_answer_id": 37781160, "answer_count": 1, "score": 13, "last_activity_date": 1465786137, "creation_date": 1465785902, "question_id": 37781135, "link": "https://stackoverflow.com/questions/37781135/golang-function-parameter-without-type", "title": "Golang function parameter without type?", "body": "<pre><code>func Match(pattern, name string) (matched bool, err error)\n</code></pre>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/path/filepath/#Match\" rel=\"noreferrer\">https://golang.org/pkg/path/filepath/#Match</a></li>\n</ul>\n\n<p>Why does <code>pattern</code> not have to have a type (like <code>pattern string</code>)?</p>\n"}, {"tags": ["json", "dictionary", "go", "interface"], "answers": [{"tags": [], "owner": {"reputation": 54533, "user_id": 94559, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab13b7f135315a91b9ef13e073354d90?s=128&d=identicon&r=PG&f=1", "display_name": "user94559", "link": "https://stackoverflow.com/users/94559/user94559"}, "is_accepted": false, "score": 1, "last_activity_date": 1465780461, "creation_date": 1465780461, "answer_id": 37780650, "question_id": 37780558, "link": "https://stackoverflow.com/questions/37780558/go-lang-help-accessing-array-slice-of-interfaces/37780650#37780650", "title": "Go Lang Help - Accessing Array/Slice of interfaces", "body": "<p>I believe you need to do a type assertion. You have an <code>interface{}</code>, but you need some sort of slice to index into. Try <code>resp[\"results\"].([]interface{})[0]</code>? (Sorry, haven't had a chance to test this myself.)</p>\n"}, {"tags": [], "owner": {"reputation": 43, "user_id": 1274864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f145822a9a2b409caa844f6848f098dd?s=128&d=identicon&r=PG", "display_name": "Len Smith", "link": "https://stackoverflow.com/users/1274864/len-smith"}, "is_accepted": false, "score": 2, "last_activity_date": 1465859174, "creation_date": 1465859174, "answer_id": 37800511, "question_id": 37780558, "link": "https://stackoverflow.com/questions/37780558/go-lang-help-accessing-array-slice-of-interfaces/37800511#37800511", "title": "Go Lang Help - Accessing Array/Slice of interfaces", "body": "<p>A co-worker provided the code fragement below which made it possible to access the map entries I was looking for.</p>\n\n<pre><code>    respBody, _ := ioutil.ReadAll(response.Body)\n\n    var rsp interface{}\n    if err := json.Unmarshal(respBody, &amp;rsp); err != nil {\n            log.Fatal(err)\n    }\n    resultMap := rsp.(map[string]interface{})[\"results\"].([]interface{})[0].(map[string]interface{})\n    fmt.Printf(\"test: %s&lt;\\n\", resultMap[\"errors\"] )\n</code></pre>\n\n<p>test: [Configuration file 'c2-web-2.conf' already exists.]&lt;</p>\n"}], "owner": {"reputation": 43, "user_id": 1274864, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f145822a9a2b409caa844f6848f098dd?s=128&d=identicon&r=PG", "display_name": "Len Smith", "link": "https://stackoverflow.com/users/1274864/len-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 606, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1465859174, "creation_date": 1465779449, "question_id": 37780558, "link": "https://stackoverflow.com/questions/37780558/go-lang-help-accessing-array-slice-of-interfaces", "title": "Go Lang Help - Accessing Array/Slice of interfaces", "body": "<p>I'm trying to decode dynamic/random JSON responses in GO, with nested data</p>\n\n<pre><code>    body, _ := ioutil.ReadAll(response.Body)\n    resp := make(map[string]interface{})\n    err = json.Unmarshal(body, &amp;resp)\n\n    fmt.Printf(\"BODY: %T&lt;\\n\", body)\n    fmt.Printf(\"BODY: %s&lt;\\n\", body)\n    fmt.Printf(\"RESP: %s&lt;\\n\", resp)\n    fmt.Printf(\"RESP: %T&lt;\\n\", resp)\n    fmt.Printf(\"RESP[results]: %T&lt;\\n\", resp[\"results\"])\n    fmt.Printf(\"RESP[results]: %s&lt;\\n\", resp[\"results\"])\n</code></pre>\n\n<p>body is the JSON result from the HTTP server and I unmarshall it and the result looks to be a slice of bytes.</p>\n\n<p>BODY: []uint8</p>\n\n<p>BODY: {\"results\":[{\"code\":500.0,\"errors\":[\"Configuration file 'c2-web-2.conf' already exists.\"],\"status\":\"Object could not be created.\"}]}</p>\n\n<p>So I unmarshall it into resp and that works as expected.</p>\n\n<p>RESP: map[string]interface {}</p>\n\n<p>RESP: map[results:[map[code:%!s(float64=500) errors:[Configuration file 'c2-web-2.conf' already exists.] status:Object could not be created.]]]&lt;</p>\n\n<p>I'm able to access the map with the key results.</p>\n\n<p>RESP[results]: []interface {}</p>\n\n<p>RESP[results]: [map[code:%!s(float64=500) errors:[Configuration file 'conf.d/hosts/c2-web-2.conf' already exists.] status:Object could not be created.]]&lt;</p>\n\n<p>Now what i want to access it the \"code\", \"errors\" and \"status\" which is in resp[\"results\"] This looks like an array or slice and I've tried indexing it but I get the error at compile time</p>\n\n<p>./create_host.go:62: invalid operation: resp[\"results\"][0] (type interface {} does not support indexing)</p>\n\n<p>I've done a lot of googling, tried unmarshalling the data within resp[\"results\"] etc, but after a few days I have not made much progress.</p>\n\n<p>How should I access the map which seems to be a member of an array? The data structure is not guaranteed so I can't create a structure and unmarshall into that.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1582, "user_id": 4604899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WyuD9.jpg?s=128&g=1", "display_name": "Julien Chien", "link": "https://stackoverflow.com/users/4604899/julien-chien"}, "edited": false, "score": 0, "creation_date": 1465779748, "post_id": 37780565, "comment_id": 63028647, "body": "Oh really, did not know that! Thanks, will try that!"}, {"owner": {"reputation": 4599, "user_id": 42198, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/1d34218bc4e20dd8dfbc82cc20ea643a?s=128&d=identicon&r=PG", "display_name": "Somatik", "link": "https://stackoverflow.com/users/42198/somatik"}, "edited": false, "score": 20, "creation_date": 1536919362, "post_id": 37780565, "comment_id": 91605941, "body": "The compiler could be a bit friendlier here"}, {"owner": {"reputation": 8130, "user_id": 239657, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b53c0fe850111d3f1bbd41c24c7c62b3?s=128&d=identicon&r=PG", "display_name": "Beni Cherniavsky-Paskin", "link": "https://stackoverflow.com/users/239657/beni-cherniavsky-paskin"}, "edited": false, "score": 0, "creation_date": 1553606149, "post_id": 37780565, "comment_id": 97439899, "body": "Thanks!  The error wording confused me so I forgot all about visibility rules...  Filed <a href=\"https://github.com/golang/go/issues/31053\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/31053</a> to improve the error message."}], "tags": [], "owner": {"reputation": 17595, "user_id": 41455, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/4788a6e08db703f60f249356c95d5775?s=128&d=identicon&r=PG", "display_name": "superfell", "link": "https://stackoverflow.com/users/41455/superfell"}, "is_accepted": true, "score": 106, "last_activity_date": 1465779488, "creation_date": 1465779488, "answer_id": 37780565, "question_id": 37780520, "link": "https://stackoverflow.com/questions/37780520/unknown-field-in-struct-literal/37780565#37780565", "title": "unknown field in struct literal", "body": "<p>Fields that start with lower case characters are package internal and not exposed, If you want to reference the field from another package it needs to start with an upper case character, eg. </p>\n\n<pre><code>package yelk\n\ntype PhoneOptions struct {\n    Phone string\n    Cc    string\n    Lang  string\n}\n</code></pre>\n\n<p>and then</p>\n\n<pre><code>number := os.Args[1]\nphoneOptions := yelk.PhoneOptions{Phone: number}\n</code></pre>\n"}], "owner": {"reputation": 1582, "user_id": 4604899, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/WyuD9.jpg?s=128&g=1", "display_name": "Julien Chien", "link": "https://stackoverflow.com/users/4604899/julien-chien"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 27294, "favorite_count": 4, "accepted_answer_id": 37780565, "answer_count": 1, "score": 55, "last_activity_date": 1465779570, "creation_date": 1465779061, "question_id": 37780520, "link": "https://stackoverflow.com/questions/37780520/unknown-field-in-struct-literal", "title": "unknown field in struct literal", "body": "<p>I'm trying to create a struct, and it is giving me an error, telling me the field is unknown.</p>\n\n<p>The struct I am trying to initialize is: </p>\n\n<pre><code>package yelk\n\ntype PhoneOptions struct {\n    phone string\n    cc    string\n    lang  string\n}\n</code></pre>\n\n<p>And I'm trying to initialize a <code>PhoneOptions</code> struct in <code>cli.go</code> like this:</p>\n\n<pre><code>number := os.Args[1]\nphoneOptions := yelk.PhoneOptions{phone: number}\n</code></pre>\n\n<p>I do <code>go run cli.go 5555555555</code> but it gives me an error </p>\n\n<pre><code>./cli.go:29: unknown yelk.PhoneOptions field 'phone' in struct literal\n</code></pre>\n\n<p>All The StackOverflow posts I've seen with this error seem to be from nested structs. I'm wondering what I'm doing wrong. <code>cli.go</code> will give this error if I just try to run <code>go build</code> on it, so I don't think it's the inputs I've been running it with.</p>\n\n<p>Any idea why this happens? </p>\n"}, {"tags": ["go", "yaml", "docker-compose"], "answers": [{"tags": [], "owner": {"reputation": 1039, "user_id": 5252955, "user_type": "registered", "accept_rate": 78, "profile_image": "https://lh6.googleusercontent.com/-a_QM0l16-xk/AAAAAAAAAAI/AAAAAAAAARc/RFsNPxQgnfs/photo.jpg?sz=128", "display_name": "Nick Rucci", "link": "https://stackoverflow.com/users/5252955/nick-rucci"}, "is_accepted": true, "score": -1, "last_activity_date": 1465960569, "creation_date": 1465960569, "answer_id": 37825498, "question_id": 37779700, "link": "https://stackoverflow.com/questions/37779700/how-do-i-output-the-the-line-that-threw-an-error-in-a-yaml-unmarshal-of-a-docker/37825498#37825498", "title": "How do I output the the line that threw an error in a yaml unmarshal of a Docker-Compose.yml?", "body": "<p>Set flag on the logger to print out the line number</p>\n\n<pre><code>// main.go or config file\n\nfunc init() {\n    log.SetFlags(log.LstdFlags | log.Lshortfile)\n}\n</code></pre>\n\n<p>You can find more of these flags <a href=\"https://golang.org/pkg/log/#pkg-constants\" rel=\"nofollow\">here</a></p>\n\n<p><strong>handle the error</strong></p>\n\n<pre><code>dockerData []byte\nvar struct *struct\nif err := yaml.Unmarshal(dockerData, &amp;struct); err != nil {\n    log.Print(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 41, "user_id": 4591851, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/08e29e58c59bf7905607843df941977a?s=128&d=identicon&r=PG&f=1", "display_name": "Indigo", "link": "https://stackoverflow.com/users/4591851/indigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 37825498, "answer_count": 1, "score": 1, "last_activity_date": 1465960569, "creation_date": 1465770587, "question_id": 37779700, "link": "https://stackoverflow.com/questions/37779700/how-do-i-output-the-the-line-that-threw-an-error-in-a-yaml-unmarshal-of-a-docker", "title": "How do I output the the line that threw an error in a yaml unmarshal of a Docker-Compose.yml?", "body": "<p>I'm writing some code that takes in a Docker-Compose.yml and unmarshals it into a struct.  I take the docker compose data in as a []byte.</p>\n\n<pre><code>    dockerData []byte\n    var struct *struct\n    if err := yaml.Unmarshal(dockerData, &amp;struct)\n</code></pre>\n\n<p>I run a lot of compose files through this process.  When errors are thrown, is there a way to output the line or section of the compose file that threw the error?</p>\n"}, {"tags": ["jquery", "go", "angular", "http2", "go-gin"], "comments": [{"owner": {"reputation": 1726, "user_id": 87733, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a6eb054fb0432d6249e6fb22b816e164?s=128&d=identicon&r=PG", "display_name": "Chris Stavropoulos", "link": "https://stackoverflow.com/users/87733/chris-stavropoulos"}, "edited": false, "score": 0, "creation_date": 1516366275, "post_id": 37779156, "comment_id": 83668269, "body": "This is not a full answer but have you looked into JSON Lines as your streaming pattern?"}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "edited": false, "score": 0, "creation_date": 1516607133, "post_id": 37779156, "comment_id": 83740153, "body": "maybe this can help? <a href=\"https://medium.com/stupid-gopher-tricks/streaming-data-in-go-without-buffering-3285ddd2a1e5\" rel=\"nofollow noreferrer\">medium.com/stupid-gopher-tricks/&hellip;</a>"}], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 455, "favorite_count": 2, "answer_count": 0, "score": 8, "last_activity_date": 1541595759, "creation_date": 1465766156, "last_edit_date": 1465900242, "question_id": 37779156, "link": "https://stackoverflow.com/questions/37779156/returning-json-data-as-a-stream-per-chunk-to-angular2-or-jquery-over-http2-http", "title": "Returning JSON data as a stream per chunk to Angular2 or jQuery over HTTP2 (HTTPS)", "body": "<p>In one of my API's I mostly return a result (let's say paged 50 results) as one whole in an <code>json</code> array like so:</p>\n\n<pre><code>[{},{},{},{},{},...]\n</code></pre>\n\n<p>I was wondering if there are better ways of doing this over HTTP2 (as it has many new partial streaming features) with Go's HTTP server (using HTTPS in Gin for this project).</p>\n\n<p>Maybe I could chunk every <code>{}</code> result and send them as segments on a stream? How would the AJAX call in Angular or jQuery know that there's a new chunk delivered (newline or some character marker?)? And what call in the library could actually handle such a <em>multi-promise</em> (does that even exist? :P)? Could I benefit from the HTTP2 stream-features in some way to prevent multiple-connections from opening?</p>\n\n<p>I'm kind of aiming to have the results nicely <em>plop</em> into the list as they come in.</p>\n\n<p><strong>UPDATE</strong></p>\n\n<p>Maybe it's easier to use <code>Keep-Alive</code> header in some way to let's keep the connection open for for a certain amount of seconds to be able to stream over and fire many smaller requests/responses?</p>\n"}, {"tags": ["go", "pagefile", "ldflags"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465823031, "post_id": 37779092, "comment_id": 63047139, "body": "are you using an up to date version of Go?"}], "owner": {"reputation": 15, "user_id": 3725253, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7d3cf8c14a8626bccaafec7af479f771?s=128&d=identicon&r=PG&f=1", "display_name": "user3725253", "link": "https://stackoverflow.com/users/3725253/user3725253"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 91, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465765654, "creation_date": 1465765654, "question_id": 37779092, "link": "https://stackoverflow.com/questions/37779092/go-lang-compiler-causes-unknown-error-with-ldflags", "title": "Go lang compiler causes (unknown) error with ldflags", "body": "<p>I'm trying to compile Syncthing for WD My Cloud Ex2. It's an arm architecture and it works with 64kb pagefile, so while compiling, there must be a flag (\"-R 65536\").</p>\n\n<p>When compiling I get the following error</p>\n\n<pre><code>c:\\src\\github.com\\syncthing\\syncthing&gt;go run -ldflags \"-R 65536\" build.go  -goos\n linux -goarch arm -no-upgrade tar\n# command-line-arguments\nsyscall.errors: .data.VirtualAddress = 0x347000, want 0x350000\n</code></pre>\n\n<p>Unfortunately at Google there aren't any results at all concerning this error message. What can I do about this message?</p>\n"}, {"tags": ["go", "osx-elcapitan"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1465762513, "post_id": 37778643, "comment_id": 63024968, "body": "If you only have one goroutine, with one loop, you can&#39;t really use more than one core."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1465765432, "post_id": 37778846, "comment_id": 63025824, "body": "Yes this clarifies things. <code>runtime</code> shows the (default) max cores are running so that was not the issue luckily. I&#39;ll do some tests tomorrow to see the differences of putting the boot-up part of my system in a goroutine."}], "tags": [], "owner": {"reputation": 6654, "user_id": 2606098, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/P2wJB.jpg?s=128&g=1", "display_name": "Tinwor", "link": "https://stackoverflow.com/users/2606098/tinwor"}, "is_accepted": true, "score": 1, "last_activity_date": 1465763827, "creation_date": 1465763827, "answer_id": 37778846, "question_id": 37778643, "link": "https://stackoverflow.com/questions/37778643/only-100-shown-on-benchmark-run/37778846#37778846", "title": "Only 100% shown on benchmark run", "body": "<p>Your application is using only one thread so it's correct that there is only one core that run at 100%.<br>\nIf you want use more than one core you must use more than one go routine, remeber to set <code>GOMAXPROCS</code> shell enviroment or your application will use only one core.<br>\nRemember that it's possible that your application could be even slower using more than one process because if your behaviuor is intrinsically sequential you cannot speed up the application just adding more <code>goroutine</code>. You can take a real advantage of multi threading only if your behaviour is intrinsically parallel.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 37, "favorite_count": 0, "accepted_answer_id": 37778846, "answer_count": 1, "score": 0, "last_activity_date": 1465763827, "creation_date": 1465762394, "question_id": 37778643, "link": "https://stackoverflow.com/questions/37778643/only-100-shown-on-benchmark-run", "title": "Only 100% shown on benchmark run", "body": "<p>I was just doing a 10Million insert benchmark to see the performance of a small cache system I'm building. While observing the Activity Monitor I noticed that the <code>main</code> Go process only shows 100% (of the 800%) CPU.</p>\n\n<p>Do I need to split my loops into routines to make it split up to all 8 cores or is there another reason?</p>\n\n<p>I'm not posting code as the test code is not much more than a loop in a testing function in the main body.</p>\n"}, {"tags": ["go", "multiprocessing", "virtualization", "hyperthreading"], "comments": [{"owner": {"reputation": 716, "user_id": 924272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/077b810c7cc7deae3d83850675c0e86f?s=128&d=identicon&r=PG", "display_name": "user924272", "link": "https://stackoverflow.com/users/924272/user924272"}, "edited": false, "score": 0, "creation_date": 1465760569, "post_id": 37778319, "comment_id": 63024329, "body": "There are a lot of unknowns from my perspective here.  How many go routines are you running concurrently?  Is Hyper threading switched on in your BIOS?  Are you running in a Virtual Machine on your Mac?   By the way, a Hyperthreaded core isn&#39;t a real core, it&#39;s just clever instruction scheduling which allows another thread of execution to run concurrently during idle states of the other program running on the same CPU core."}], "answers": [{"comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1465762620, "post_id": 37778384, "comment_id": 63025009, "body": "The point of having these virtual cores is that while one task is stalled (waiting on main memory or something slow like floating-point division, say), the CPU can try to sneak in work on another. Whether it helps depends partly on whether your code has those long stalls (like, adding a long stream of numbers probably won&#39;t) and whether the other thread really uses complementary CPU resources (e.g. a load of all floating-point divisions on all threads may be limited by your cores&#39; physical dividers, HT or no)."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1465762685, "post_id": 37778384, "comment_id": 63025033, "body": "As another example of how it&#39;s super workload-dependent, there&#39;s a benchmark on a database workload where it averages a 24% gain, but less or much more depending on the query: <a href=\"http://sqlblog.com/blogs/joe_chang/archive/2013/04/08/hyper-threading-performance.aspx\" rel=\"nofollow noreferrer\">sqlblog.com/blogs/joe_chang/archive/2013/04/08/&hellip;</a>"}], "tags": [], "owner": {"reputation": 3724, "user_id": 3142963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb984a54fc82c443b2c9e34271d8787d?s=128&d=identicon&r=PG&f=1", "display_name": "nwk", "link": "https://stackoverflow.com/users/3142963/nwk"}, "is_accepted": true, "score": 6, "last_activity_date": 1465810649, "last_edit_date": 1495541308, "creation_date": 1465760567, "answer_id": 37778384, "question_id": 37778319, "link": "https://stackoverflow.com/questions/37778319/go-counts-virtual-cores-not-physical/37778384#37778384", "title": "Go counts virtual cores, not physical?", "body": "<blockquote>\n  <p>1) is this normal?</p>\n</blockquote>\n\n<p>If you mean the virtual cores showing up in <code>runtime.NumCPU()</code>, then yes, at least in the sense that programs written in C as well as those running on top of other runtimes like the JVM will see <a href=\"https://stackoverflow.com/questions/4523331/is-there-a-way-in-java-to-find-out-how-many-cpus-or-cores-are-installed\">the same number</a> of CPUs. If you mean the performance, see below.</p>\n\n<blockquote>\n  <p>2) why, if it is, do multiple virtual cores benefit a machine like my macbook?</p>\n</blockquote>\n\n<p>It's a complicated matter that depends on the workload. The workloads where its benefits show the most are typically highly parallel like 3D rendering and certain kinds of data compression. In other workloads, the benefits may be absent and the impact of HT on performance may be negative (due to the communication and context-switching overhead of running more threads). Reading the Wikipedia article on <a href=\"https://en.wikipedia.org/wiki/Hyper-threading\" rel=\"nofollow noreferrer\">hyper-threading</a> can elucidate the matter further.</p>\n\n<p><a href=\"http://www.extremetech.com/computing/133121-maximized-performance-comparing-the-effects-of-hyper-threading-software-updates\" rel=\"nofollow noreferrer\">Here</a> is a sample benchmark that compares the performance of the same CPU with and without HT. Note how the performance is not always improved by HT and in some cases, in fact, decreases.</p>\n"}], "owner": {"reputation": 2174, "user_id": 2712644, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/qbg3j.jpg?s=128&g=1", "display_name": "domoarigato", "link": "https://stackoverflow.com/users/2712644/domoarigato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1485, "favorite_count": 0, "accepted_answer_id": 37778384, "answer_count": 1, "score": 5, "last_activity_date": 1571663568, "creation_date": 1465760101, "last_edit_date": 1571663568, "question_id": 37778319, "link": "https://stackoverflow.com/questions/37778319/go-counts-virtual-cores-not-physical", "title": "Go counts virtual cores, not physical?", "body": "<p>I have some Go code I am benchmarking on my Macbook (Intel Core i5 processor with two physical cores). </p>\n\n<p>Go's <code>runtime.NumCPU()</code> yields 4, because it counts \"virtual cores\"</p>\n\n<p>I don't know much about virtual cores in this context, but my benchmarks seems to indicate a multiprocessing speedup of only 2x when I configure my code using</p>\n\n<pre><code>runtime.GOMAXPROCS(runtime.NumCPU())\n</code></pre>\n\n<p>I get the same performance if I use 2 instead of 4 cores.  I would post the code, but I think it's largely irrelevant to my questions, which are:</p>\n\n<p>1) is this normal?</p>\n\n<p>2) why, if it is, do multiple virtual cores benefit a machine like my macbook?</p>\n\n<h2>Update:</h2>\n\n<p>In case it matters, in my code, there are the same number of goroutines as whatever you set <code>runtime.GOMAXPROCS()</code>  the tasks are fully parallel, have no interdependencies or shared state. its running as a native compiled binary.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "edited": false, "score": 0, "creation_date": 1465759288, "post_id": 37777920, "comment_id": 63023963, "body": "So this is safe even when the collection is empty? that syntax looks odd to me!"}], "tags": [], "owner": {"reputation": 1470, "user_id": 151825, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lpRxz.png?s=128&g=1", "display_name": "matt.s", "link": "https://stackoverflow.com/users/151825/matt-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1465757519, "creation_date": 1465757519, "answer_id": 37777920, "question_id": 37777869, "link": "https://stackoverflow.com/questions/37777869/looping-over-a-map-using-range-only-iterate-once/37777920#37777920", "title": "Looping over a map using range, only iterate once", "body": "<p>instead of range, give <code>index</code> with an argument</p>\n\n<pre><code>{{index .Users 0}}\n&lt;div&gt;\n  {{.Name}}\n&lt;/div&gt;\n{{end}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 2, "last_activity_date": 1465784763, "creation_date": 1465784763, "answer_id": 37781028, "question_id": 37777869, "link": "https://stackoverflow.com/questions/37777869/looping-over-a-map-using-range-only-iterate-once/37781028#37781028", "title": "Looping over a map using range, only iterate once", "body": "<p>Two solutions; either check that your index is 0 when looping:</p>\n\n<pre><code>{{range $index, $element := . }}{{if eq $index 0 -}}\nItem: {{$element}}\n{{end}}{{end -}}\n</code></pre>\n\n<p>Or you could define a \"first\" function that takes a slice and truncates it to length 1.</p>\n\n<pre><code>{{range first .}}\nItem: {{.}}\n{{end}}\n</code></pre>\n\n<p>Here's complete code that demonstrates both, which you can also <a href=\"https://play.golang.org/p/nZudLCiwdm\" rel=\"nofollow\">try on the playground.</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"text/template\"\n)\n\nvar t = template.Must(template.New(\"x\").Parse(\n    \"[{{range $index, $element := . }}{{if eq $index 0 -}}{{$element}}{{end}}{{end -}}]\"))\n\nvar funcs = map[string]interface{}{\n    \"first\": func(arg []string) []string {\n        if len(arg) &gt; 0 {\n            return arg[:1]\n        }\n        return nil\n    },\n}\n\nvar t2 = template.Must(template.New(\"x\").Funcs(funcs).Parse(\n    \"[{{range first . }}{{.}}{{end -}}]\"))\n\nfunc main() {\n    tmpls := []*template.Template{t, t2}\n    for i, t := range tmpls {\n        fmt.Println(\"TEMPLATE\", i)\n        a := []string{\"one\", \"two\", \"three\"}\n        for j := 0; j &lt; len(a); j++ {\n            fmt.Println(\"with input slice of length\", j)\n            t.Execute(os.Stdout, a[:j])\n            fmt.Println()\n        }\n        fmt.Println()\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 235600, "user_id": 39677, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/77aa7bc1ace6e4b0b49a2102e4fa4059?s=128&d=identicon&r=PG", "display_name": "Blankman", "link": "https://stackoverflow.com/users/39677/blankman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 90, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1465784763, "creation_date": 1465757271, "question_id": 37777869, "link": "https://stackoverflow.com/questions/37777869/looping-over-a-map-using-range-only-iterate-once", "title": "Looping over a map using range, only iterate once", "body": "<p>I need to only iterate over a loop once in my golang template, currently it is looping over all the keys but I want it to stop after a single iteration.</p>\n\n<p>How can I do this?</p>\n\n<pre><code>{{range .Users}}\n&lt;div&gt;\n  {{.Name}}\n&lt;/div&gt;\n{{end}}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1465745138, "post_id": 37775874, "comment_id": 63019267, "body": "os.Getenv(&quot;GOHOSTOS&quot;) ?"}, {"owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "reply_to_user": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "edited": false, "score": 0, "creation_date": 1465745979, "post_id": 37775874, "comment_id": 63019551, "body": "Does GOHOSTOS env variable exist, if there is not go compiler installation?"}, {"owner": {"reputation": 8880, "user_id": 2363866, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToSkw.png?s=128&g=1", "display_name": "creker", "link": "https://stackoverflow.com/users/2363866/creker"}, "edited": false, "score": 0, "creation_date": 1465746404, "post_id": 37775874, "comment_id": 63019698, "body": "<code>runtime.GOOS</code> and <code>runtime.GOARCH</code>"}], "answers": [{"tags": [], "owner": {"reputation": 905, "user_id": 3781709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4fa60c6b287ee4f006d6c4e320daf5?s=128&d=identicon&r=PG", "display_name": "Pradip Patil", "link": "https://stackoverflow.com/users/3781709/pradip-patil"}, "is_accepted": false, "score": 2, "last_activity_date": 1465748470, "creation_date": 1465748470, "answer_id": 37776514, "question_id": 37775874, "link": "https://stackoverflow.com/questions/37775874/how-to-detect-gohostos-and-gohostarch-at-runtime/37776514#37776514", "title": "How to detect $GOHOSTOS and $GOHOSTARCH at runtime?", "body": "<p><code>$GOHOSTOS</code> and <code>$GOHOSTARCH</code> ( serve default values for <code>GOOS</code> and <code>GOARCH</code> respectively) are used while building of go programs and do not influence the execution of the run-time system.</p>\n\n<p><code>GOOS</code> and <code>GOARCH</code> are recorded at compile time and made available by constants <code>runtime.GOOS</code> and <code>runtime.GOARCH</code>. \nYou may want to check these constants.</p>\n"}, {"comments": [{"owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "edited": false, "score": 1, "creation_date": 1465769274, "post_id": 37777681, "comment_id": 63026723, "body": "Thanks. That&#39;s what I ended up doing."}], "tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": true, "score": 1, "last_activity_date": 1465756007, "creation_date": 1465756007, "answer_id": 37777681, "question_id": 37775874, "link": "https://stackoverflow.com/questions/37775874/how-to-detect-gohostos-and-gohostarch-at-runtime/37777681#37777681", "title": "How to detect $GOHOSTOS and $GOHOSTARCH at runtime?", "body": "<p>Short version, you can't.</p>\n\n<p>Long version, you can create a build script that embeds the info in your code, for example:</p>\n\n<p>- main.go:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nvar (\n    hostOS   string\n    hostArch string\n)\n\nfunc main() {\n    fmt.Println(\"runtime values:\", runtime.GOOS, runtime.GOARCH)\n    fmt.Println(\"build time values:\", hostOS, hostArch)\n}\n</code></pre>\n\n<p>- build.sh</p>\n\n<pre><code>#!/bin/sh\n# replace main. with whatever package you're using\ngo build -ldflags \"-X main.hostOS=$(go env GOHOSTOS) -X main.hostArch=$(go env GOHOSTARCH)\" $*\n</code></pre>\n\n<p>- output:</p>\n\n<pre><code>$ env GOARCH=386 ./build.sh\n$ ./tmp\nruntime values: linux 386\nbuild time values: linux amd64\n</code></pre>\n"}], "owner": {"reputation": 7906, "user_id": 244009, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bd8e93613dba2b3b39c97afd6d065279?s=128&d=identicon&r=PG", "display_name": "codefx", "link": "https://stackoverflow.com/users/244009/codefx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 828, "favorite_count": 0, "accepted_answer_id": 37777681, "answer_count": 2, "score": 3, "last_activity_date": 1465756007, "creation_date": 1465744752, "question_id": 37775874, "link": "https://stackoverflow.com/questions/37775874/how-to-detect-gohostos-and-gohostarch-at-runtime", "title": "How to detect $GOHOSTOS and $GOHOSTARCH at runtime?", "body": "<p>How do I detect the value of $GOHOSTOS and $GOHOSTARCH at runtime on any system a go binary is running? Please note that I want to detect these values even if there is no go compiler installation on a host.</p>\n"}, {"tags": ["http", "go", "concurrency"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465742817, "post_id": 37774624, "comment_id": 63018536, "body": "Are all or a large portion of the pages coming from the same server? what is the max number of requests you&#39;re making concurrently?"}, {"owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465765924, "post_id": 37774624, "comment_id": 63025947, "body": "All pages are from the same server (edited the question to reflect this). I am not sure how many are made concurrently. I just start as many go routines as there are web pages to download and then let the CPU/Golang impose the limits on concurrency."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465766528, "post_id": 37774624, "comment_id": 63026076, "body": "There are no defined limits on concurrency, you need to do that yourself."}], "answers": [{"comments": [{"owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "edited": false, "score": 0, "creation_date": 1465766061, "post_id": 37775588, "comment_id": 63025981, "body": "Considering that everything runs fine when I run it on a server in the same country as the web server, it seemingly does not have such limits (unless they are only imposed on people from other countries, which does not make a lot of sense in my scenario). However, I will look into limiting the amounts of requests per second."}, {"owner": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1465786496, "post_id": 37775588, "comment_id": 63029764, "body": "Generally servers can only handle a certain number of concurrent requests, and you might be past that capacity. A reason it would run fine from the same country is that the request would probably take significantly less time, so the connection isn&#39;t used up as long and the server can handle more."}, {"owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "reply_to_user": {"reputation": 15950, "user_id": 324978, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/9a271d8f6946301fa1f0c0fc4c7b9f14?s=128&d=identicon&r=PG", "display_name": "robbrit", "link": "https://stackoverflow.com/users/324978/robbrit"}, "edited": false, "score": 0, "creation_date": 1465819117, "post_id": 37775588, "comment_id": 63044360, "body": "@robbrit I&#39;m guessing that&#39;s probably the case. I will have to implement a connection pool I think."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "edited": false, "score": 0, "creation_date": 1465821900, "post_id": 37775588, "comment_id": 63046303, "body": "@fgblomqvist: you don&#39;t need a connection pool, the http.Transport already does that for you. Just limit the concurrency, and set <code>Transport.MaxIdleConnsPerHost</code> to match your max concurrency."}, {"owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465891524, "post_id": 37775588, "comment_id": 63077091, "body": "@JimB Wanna expand on that? I don&#39;t understand how setting the MaxIdleConnsPerHost will limit the max open connections to the host? Also, why would I need to limit the concurrency as well? If I start 1000 go routines, all making one GET request each, they will open ~1000 connections, whether they share an HTTP client or not"}], "tags": [], "owner": {"reputation": 39, "user_id": 4639752, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-bZgkLCRd7yk/AAAAAAAAAAI/AAAAAAAAAS8/IL7ReXFT-ig/photo.jpg?sz=128", "display_name": "Paritosh Gupta", "link": "https://stackoverflow.com/users/4639752/paritosh-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1465742989, "last_edit_date": 1495540020, "creation_date": 1465742989, "answer_id": 37775588, "question_id": 37774624, "link": "https://stackoverflow.com/questions/37774624/go-http-get-concurrency-and-connection-reset-by-peer/37775588#37775588", "title": "Go http.Get, concurrency, and &quot;Connection reset by peer&quot;", "body": "<p>It might be possible that the server from which you are downloading the webpages has some type of throttling mechanism which prevents more than a certain number of requests per second/(or similar) from a certain ip?. Try limiting to maybe 100 requests per second or adding sleep between requests.\nConnection reset by peer is basically server denying you service. (<a href=\"https://stackoverflow.com/questions/1434451/what-does-connection-reset-by-peer-mean\">What does &quot;connection reset by peer&quot; mean?</a>)</p>\n"}, {"comments": [{"owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "edited": false, "score": 2, "creation_date": 1465913451, "post_id": 37813844, "comment_id": 63092936, "body": "This is a great answer. I ended up doing some measurements on how many simultaneous connections gave the best performance, and for this connection I am currently on, that came out to be about 50, more connections than that gave very little to no extra performance. I limited the amount of go routines running to max 50, and set the MaxIdleConnsPerHost to 50. Works every time now!"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6398, "user_id": 761288, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/dcde0598aea083061f3b142d14a52736?s=128&d=identicon&r=PG", "display_name": "AG1", "link": "https://stackoverflow.com/users/761288/ag1"}, "edited": false, "score": 0, "creation_date": 1501158974, "post_id": 37813844, "comment_id": 77662866, "body": "@AG1: what code are you looking for? The answer comes down to just setting <code>MaxIdleConnsPerHost</code> to equal the number of concurrent requests."}, {"owner": {"reputation": 6398, "user_id": 761288, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/dcde0598aea083061f3b142d14a52736?s=128&d=identicon&r=PG", "display_name": "AG1", "link": "https://stackoverflow.com/users/761288/ag1"}, "edited": false, "score": 0, "creation_date": 1501196005, "post_id": 37813844, "comment_id": 77685707, "body": "@JimB I added the code as an answer to make it more concrete."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 6398, "user_id": 761288, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/dcde0598aea083061f3b142d14a52736?s=128&d=identicon&r=PG", "display_name": "AG1", "link": "https://stackoverflow.com/users/761288/ag1"}, "edited": false, "score": 0, "creation_date": 1501196132, "post_id": 37813844, "comment_id": 77685750, "body": "@AG1: you can see a more complete example of that in <a href=\"https://stackoverflow.com/questions/39813587/go-client-program-generates-a-lot-a-sockets-in-time-wait-state/39834253#39834253\">this answer</a>"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 29, "last_activity_date": 1580399978, "last_edit_date": 1580399978, "creation_date": 1465911833, "answer_id": 37813844, "question_id": 37774624, "link": "https://stackoverflow.com/questions/37774624/go-http-get-concurrency-and-connection-reset-by-peer/37813844#37813844", "title": "Go http.Get, concurrency, and &quot;Connection reset by peer&quot;", "body": "<p>The message <code>connection reset by peer</code> indicates that the remote server sent an <code>RST</code> to forcefully close the connection, either deliberately as a mechanism to limit connections, or as a result of a lack of resources. Either way you are likely opening too many connections, or reconnecting too fast. </p>\n\n<p>Starting 1000-2000 connections in parallel is rarely the most efficient way to download that many pages, especially if most or all are coming from a single server. If you test the throughput you will find an optimal concurrency level that is far lower.</p>\n\n<p>You will also  want to set the <code>Transport.MaxIdleConnsPerHost</code> to match your level of concurrency. If <code>MaxIdleConnsPerHost</code> is lower than the expected number of concurrent connections, the server connections will often be closed after a request, only to be immediately opened again -- this will slow your progress significantly and possibly reach connection limits imposed by the server. </p>\n"}, {"tags": [], "owner": {"reputation": 6398, "user_id": 761288, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/dcde0598aea083061f3b142d14a52736?s=128&d=identicon&r=PG", "display_name": "AG1", "link": "https://stackoverflow.com/users/761288/ag1"}, "is_accepted": false, "score": 18, "last_activity_date": 1501194441, "creation_date": 1501194441, "answer_id": 45362012, "question_id": 37774624, "link": "https://stackoverflow.com/questions/37774624/go-http-get-concurrency-and-connection-reset-by-peer/45362012#45362012", "title": "Go http.Get, concurrency, and &quot;Connection reset by peer&quot;", "body": "<p>Still a golang newbie, hopefully this helps.</p>\n\n<pre><code>var netClient = &amp;http.Client{}\n\nfunc init() {\n    tr := &amp;http.Transport{\n        MaxIdleConns:       20,\n        MaxIdleConnsPerHost:  20,\n    }\n    netClient = &amp;http.Client{Transport: tr}\n}\n\nfunc foo() {\n    resp, err := netClient.Get(\"http://www.example.com/\")\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "edited": false, "score": 0, "creation_date": 1566913936, "post_id": 57669718, "comment_id": 101799491, "body": "This is basically the same solution that @AG1 posted over 2 years ago...."}, {"owner": {"reputation": 12262, "user_id": 603256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df0e70f6e810442b86d701afcb193249?s=128&d=identicon&r=PG", "display_name": "JamesHalsall", "link": "https://stackoverflow.com/users/603256/jameshalsall"}, "reply_to_user": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "edited": false, "score": 2, "creation_date": 1566917077, "post_id": 57669718, "comment_id": 101801311, "body": "it&#39;s not, read my answer carefully, AG1 used <code>MaxIdleConnsPerHost</code> which did not work for me, <code>MaxConnsPerHost</code> was introduced in Go 1.11 (released in November 2018) which was not even released when AG1 posted his answer..."}, {"owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "edited": false, "score": 1, "creation_date": 1566918955, "post_id": 57669718, "comment_id": 101802384, "body": "Apologies, read your answer a little too quickly. Nontheless, thanks for the clarification, will certainly help future readers."}, {"owner": {"reputation": 107, "user_id": 1326168, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/DJBd4.jpg?s=128&g=1", "display_name": "Amir Khoshhal", "link": "https://stackoverflow.com/users/1326168/amir-khoshhal"}, "edited": false, "score": 0, "creation_date": 1592838680, "post_id": 57669718, "comment_id": 110561256, "body": "How can I set different proxies for every request in this way ? Is it possible ?"}], "tags": [], "owner": {"reputation": 12262, "user_id": 603256, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/df0e70f6e810442b86d701afcb193249?s=128&d=identicon&r=PG", "display_name": "JamesHalsall", "link": "https://stackoverflow.com/users/603256/jameshalsall"}, "is_accepted": false, "score": 2, "last_activity_date": 1566917159, "last_edit_date": 1566917159, "creation_date": 1566891080, "answer_id": 57669718, "question_id": 37774624, "link": "https://stackoverflow.com/questions/37774624/go-http-get-concurrency-and-connection-reset-by-peer/57669718#57669718", "title": "Go http.Get, concurrency, and &quot;Connection reset by peer&quot;", "body": "<p>I had good results by setting the <code>MaxConnsPerHost</code> option on transport...</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>cl := &amp;http.Client{\n    Transport: &amp;http.Transport{MaxConnsPerHost: 50}\n}\n</code></pre>\n\n<blockquote>\n  <p>MaxConnsPerHost optionally limits the total number of connections per host, including connections in the dialing, active, and idle states. On limit violation, dials will block.</p>\n</blockquote>\n\n<p><a href=\"https://golang.org/pkg/net/http/#Transport.MaxConnsPerHost\" rel=\"nofollow noreferrer\">https://golang.org/pkg/net/http/#Transport.MaxConnsPerHost</a></p>\n\n<p>EDIT: To clarify, this option was released in Go 1.11 which was not available at the time of @AG1's or @JimB's answers above, hence me posting this.</p>\n"}], "owner": {"reputation": 1629, "user_id": 998919, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/947cfda8c228b7ca9b72764e93d2600e?s=128&d=identicon&r=PG", "display_name": "fgblomqvist", "link": "https://stackoverflow.com/users/998919/fgblomqvist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24905, "favorite_count": 10, "accepted_answer_id": 37813844, "answer_count": 4, "score": 18, "last_activity_date": 1580399978, "creation_date": 1465736949, "last_edit_date": 1465765939, "question_id": 37774624, "link": "https://stackoverflow.com/questions/37774624/go-http-get-concurrency-and-connection-reset-by-peer", "title": "Go http.Get, concurrency, and &quot;Connection reset by peer&quot;", "body": "<p>I have between 1000-2000 webpages to download from one server, and I am using go routines and channels to achieve a high efficiency. The problem is that every time I run my program up to 400 requests fail with the error \"connection reset by peer\". Rarely (maybe 1 out of 10 times), no requests fail.</p>\n\n<p>What can I do to prevent this?</p>\n\n<p>One thing that is interesting is that when I ran this program on a server in the same country as the server the website is hosted in, 0 requests failed, so I am guessing there is some problem with delay (as it is now running on a server on a different continent).</p>\n\n<p>The code I am using is basically just a simple http.Get(url) request, no extra parameters or a custom client.</p>\n"}, {"tags": ["reflection", "go", "types"], "answers": [{"comments": [{"owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "edited": false, "score": 0, "creation_date": 1465701435, "post_id": 37770064, "comment_id": 63009280, "body": "Cool, I didn&#39;t realize it was defined as an alias by the language spec. (And why is a rune an <code>int32</code> instead of a <code>uint32</code>, huh?)"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "edited": false, "score": 0, "creation_date": 1465705552, "post_id": 37770064, "comment_id": 63009846, "body": "Hard to say! Bytes kinda have to be unsigned because all values are valid and it&#39;s convention that they&#39;re 0-255. For Unicode code point they had a choice since there aren&#39;t more than 2^31 code points. I think they weakly prefer signed ints some places (like array indices) because unsigned wraparound (<code>0-1==0xffffffff</code>) can be unintuitive. On the other hand, bit-shift amounts are defined to be uints! (Maybe that&#39;s because attempting to do a negative shift can act weirdly in architecture-dependent ways, rather than just being invalid by convention.)"}], "tags": [], "owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "is_accepted": false, "score": 10, "last_activity_date": 1465699428, "last_edit_date": 1465699428, "creation_date": 1465696865, "answer_id": 37770064, "question_id": 37770005, "link": "https://stackoverflow.com/questions/37770005/why-is-there-no-byte-kind-in-the-reflect-package/37770064#37770064", "title": "Why is there no &quot;byte&quot; kind in the reflect package?", "body": "<p>Yes, <a href=\"https://golang.org/ref/spec#Numeric_types\" rel=\"noreferrer\"><code>byte</code> is an alias for <code>uint8</code></a>: \"all numeric types are distinct <em>except</em> <code>byte</code>, which is an alias for <code>uint8</code>, and <code>rune</code>, which is an alias for <code>int32</code>\" (italics mine). You can even write code like <code>var x []uint8 = []byte(\"hi!\")</code> <a href=\"https://play.golang.org/p/xLr7-uDIEe\" rel=\"noreferrer\">and it compiles</a>. </p>\n\n<p>Since there's no difference except in how the source is written, the <code>reflect</code> package can't do much special with <code>byte</code>s when manipulating the (identical) structures in RAM at runtime.</p>\n\n<p>Thinking more about <code>Kind</code>s specifically, they refer to <em>data storage</em> rather than <em>type names</em>. So, for example, if you declare <code>type A uint8</code>, variables of types <code>A</code> and <code>uint8</code> <a href=\"https://play.golang.org/p/cWqmLJvdel\" rel=\"noreferrer\">will have distinct <code>reflect.Type</code>s but the same <code>Kind</code></a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\ntype A uint8\n\nfunc main() {\n    x, y := A(1), uint8(1)\n    valX, valY := reflect.ValueOf(x), reflect.ValueOf(y)\n    fmt.Println(\"Types: x is\", valX.Type(), \"y is\", valY.Type())\n    fmt.Println(\"Types match:\", valX.Type() == valY.Type())\n    fmt.Println(\"Kinds: x is\", valX.Kind(), \"y is\", valY.Kind())\n    fmt.Println(\"Kinds match:\", valX.Kind() == valY.Kind())\n}\n</code></pre>\n\n<p>has output</p>\n\n<pre><code>Types: x is main.A y is uint8\nTypes match: false\nKinds: x is uint8 y is uint8\nKinds match: true\n</code></pre>\n\n<p>So though it's a little silly to think about hypothetical languages, even if Go <code>byte</code> were a distinct type rather than an alias, they'd have the same <code>reflect.Kind</code>.</p>\n"}], "owner": {"reputation": 7430, "user_id": 2105930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/6e884c31250cf768e8b8261e31cd0821?s=128&d=identicon&r=PG", "display_name": "chowey", "link": "https://stackoverflow.com/users/2105930/chowey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 683, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1465699428, "creation_date": 1465696048, "question_id": 37770005, "link": "https://stackoverflow.com/questions/37770005/why-is-there-no-byte-kind-in-the-reflect-package", "title": "Why is there no &quot;byte&quot; kind in the reflect package?", "body": "<p>I see all sorts of <a href=\"https://golang.org/pkg/reflect/#Kind\" rel=\"noreferrer\">Kind</a> enums in Go's <code>reflect</code> package. But no <code>byte</code>.</p>\n\n<p>Why is that? There is a definite distinction made between the other numeric types. Why not <code>byte</code>? Are we supposed to assume <code>uint8</code> instead?</p>\n"}, {"tags": ["css", "web-applications", "go"], "comments": [{"owner": {"reputation": 4928, "user_id": 1150725, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/dfe8aa21199e444d60f32a9ec4f94c6e?s=128&d=identicon&r=PG&f=1", "display_name": "Aruna Herath", "link": "https://stackoverflow.com/users/1150725/aruna-herath"}, "edited": false, "score": 0, "creation_date": 1465697405, "post_id": 37769912, "comment_id": 63008749, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/13302020/rendering-css-in-a-go-web-application\">Rendering CSS in a Go Web Application</a>"}], "answers": [{"comments": [{"owner": {"reputation": 322, "user_id": 4214173, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/e6186849fa903475fdfca205612d767e?s=128&d=identicon&r=PG&f=1", "display_name": "bajky", "link": "https://stackoverflow.com/users/4214173/bajky"}, "edited": false, "score": 0, "creation_date": 1465721011, "post_id": 37770034, "comment_id": 63012612, "body": "I try this solution more time before and it&#39;s not working"}, {"owner": {"reputation": 322, "user_id": 4214173, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/e6186849fa903475fdfca205612d767e?s=128&d=identicon&r=PG&f=1", "display_name": "bajky", "link": "https://stackoverflow.com/users/4214173/bajky"}, "edited": false, "score": 0, "creation_date": 1465726109, "post_id": 37770034, "comment_id": 63013806, "body": "I had to add one &quot;.&quot; before my path -_- ... thanks for your tip."}], "tags": [], "owner": {"reputation": 1980, "user_id": 6375498, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51ade4f86c3426c9f67f1a54b270b398?s=128&d=identicon&r=PG&f=1", "display_name": "Seva", "link": "https://stackoverflow.com/users/6375498/seva"}, "is_accepted": false, "score": 1, "last_activity_date": 1465696453, "creation_date": 1465696453, "answer_id": 37770034, "question_id": 37769912, "link": "https://stackoverflow.com/questions/37769912/how-to-include-css-to-go-lang-app/37770034#37770034", "title": "How to include css to go lang app", "body": "<p>You need to tell go to serve files from root/css directory. And keep in mind that root/css should be in the working folder of your app when you're running it.</p>\n\n<p>I don't use http package directly, but believe in your case it should be as follows (before ListenAndServe):</p>\n\n<pre><code>http.Handle(\"/todo/\", http.StripPrefix(\"root/css/\", http.FileServer(http.Dir(\"root/css\"))))\n</code></pre>\n\n<p>But you might need to adjust it according to your actual folders configuration.</p>\n\n<p>See documentation <a href=\"https://golang.org/pkg/net/http/#example_FileServer_stripPrefix\" rel=\"nofollow\">here</a></p>\n"}], "owner": {"reputation": 322, "user_id": 4214173, "user_type": "registered", "accept_rate": 16, "profile_image": "https://www.gravatar.com/avatar/e6186849fa903475fdfca205612d767e?s=128&d=identicon&r=PG&f=1", "display_name": "bajky", "link": "https://stackoverflow.com/users/4214173/bajky"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1668, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1465696453, "creation_date": 1465694668, "last_edit_date": 1465694849, "question_id": 37769912, "link": "https://stackoverflow.com/questions/37769912/how-to-include-css-to-go-lang-app", "title": "How to include css to go lang app", "body": "<p>I have problem with adding some CSS to my web app, which is created with go lang. <code>main.go</code> and html file are included to root directory and <code>style.css</code> is included to <code>root/css</code> directory</p>\n\n<p>my .*go code is </p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"net/http\"\n)\n\nfunc main(){\n\n    http.HandleFunc(\"/home\", mainViewHandler)\n    http.ListenAndServe(\":8080\", nil)\n}\n\nfunc mainViewHandler(responseWriter http.ResponseWriter,request *http.Request){\n\n    t, _ := template.ParseFiles(\"main.html\")\n    t.Execute(responseWriter, 0)\n}\n</code></pre>\n\n<p>and html code is</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html lang=\"en\"&gt;\n\n    &lt;head&gt;\n        &lt;link rel=\"stylesheet\" href=\"todo/style.css\"&gt;\n        &lt;meta charset=\"UTF-8\"&gt;\n        &lt;title&gt;Main Page&lt;/title&gt;\n\n    &lt;/head&gt;\n\n    &lt;body&gt;\n        &lt;h2&gt;Take your choice&lt;/h2&gt;\n        &lt;a href=\"/edit\"&gt;Edit&lt;/a&gt;\n        &lt;a href=\"/add\"&gt;Add&lt;/a&gt;\n        &lt;a href=\"/list\"&gt;List&lt;/a&gt;\n    &lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n"}, {"tags": ["vim", "go", "syntastic"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1465705587, "post_id": 37769882, "comment_id": 63009850, "body": "You might have better luck asking on the vim-go repo as SO isn&#39;t geared for &quot;tooling&quot; questions."}], "answers": [{"tags": [], "owner": {"reputation": 905, "user_id": 3781709, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd4fa60c6b287ee4f006d6c4e320daf5?s=128&d=identicon&r=PG", "display_name": "Pradip Patil", "link": "https://stackoverflow.com/users/3781709/pradip-patil"}, "is_accepted": false, "score": 0, "last_activity_date": 1465705741, "creation_date": 1465705741, "answer_id": 37770735, "question_id": 37769882, "link": "https://stackoverflow.com/questions/37769882/vim-go-synstastic-errors-not-automatically-displaying-on-save/37770735#37770735", "title": "vim-go/synstastic Errors not automatically displaying on save", "body": "<p>Assuming you are talking about errors shown by syntastic, this issue is probably similar to the one discussed here : <a href=\"https://github.com/fatih/vim-go/issues/848\" rel=\"nofollow\">vim-go with syntastic</a></p>\n\n<blockquote>\n  <p>Synastic doesn't check Go files on save by default (anymore). Add this\n  to your <code>.vimrc</code> to make that happen:</p>\n  \n  <p><code>let g:syntastic_go_checkers = ['go']</code></p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 5271, "user_id": 1658042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/879e79284efb4639584574a5fc46c9e4?s=128&d=identicon&r=PG", "display_name": "lcd047", "link": "https://stackoverflow.com/users/1658042/lcd047"}, "edited": false, "score": 0, "creation_date": 1465750883, "post_id": 37771505, "comment_id": 63021164, "body": "Beware that support for Go checkers in syntastic <a href=\"https://github.com/scrooloose/syntastic/issues/1759\" rel=\"nofollow noreferrer\">is going away</a>."}], "tags": [], "owner": {"reputation": 18703, "user_id": 3951782, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/5zDXr.png?s=128&g=1", "display_name": "sudo bangbang", "link": "https://stackoverflow.com/users/3951782/sudo-bangbang"}, "is_accepted": true, "score": 4, "last_activity_date": 1465719085, "last_edit_date": 1465719085, "creation_date": 1465714115, "answer_id": 37771505, "question_id": 37769882, "link": "https://stackoverflow.com/questions/37769882/vim-go-synstastic-errors-not-automatically-displaying-on-save/37771505#37771505", "title": "vim-go/synstastic Errors not automatically displaying on save", "body": "<p>Readme file in <a href=\"https://github.com/fatih/vim-go#using-with-syntastic\" rel=\"nofollow\"><code>vim-go</code></a> explains its usage with <code>syantastic</code></p>\n\n<blockquote>\n  <p>Sometimes when using both vim-go and syntastic Vim will start lagging while saving and opening files. The following fixes this:</p>\n\n<pre><code>let g:syntastic_go_checkers = ['golint', 'govet', 'errcheck']\nlet g:syntastic_mode_map = { 'mode': 'active', 'passive_filetypes': ['go'] }\n</code></pre>\n  \n  <p>Another issue with vim-go and syntastic is that the location list window that contains the output of commands such as :GoBuild and :GoTest might not appear. To resolve this:</p>\n\n<pre><code>let g:go_list_type = \"quickfix\"\n</code></pre>\n</blockquote>\n\n<p>In <a href=\"https://github.com/fatih/vim-go/issues/886\" rel=\"nofollow\">this issue</a></p>\n\n<p>One recommendation is to remove the lines</p>\n\n<pre><code>let g:syntastic_go_checkers = ['golint', 'govet', 'errcheck']\nlet g:syntastic_mode_map = { 'mode': 'active', 'passive_filetypes': \n</code></pre>\n\n<p>and use </p>\n\n<pre><code>let g:syntastic_go_checkers = ['govet', 'errcheck', 'go']\n</code></pre>\n\n<p>instead</p>\n"}], "owner": {"reputation": 3730, "user_id": 464064, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/5b106b3ab0dfec1dcc591dd7b8d309fb?s=128&d=identicon&r=PG", "display_name": "John F.", "link": "https://stackoverflow.com/users/464064/john-f"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1677, "favorite_count": 0, "accepted_answer_id": 37771505, "answer_count": 2, "score": 1, "last_activity_date": 1465750741, "creation_date": 1465694221, "last_edit_date": 1465750741, "question_id": 37769882, "link": "https://stackoverflow.com/questions/37769882/vim-go-synstastic-errors-not-automatically-displaying-on-save", "title": "vim-go/synstastic Errors not automatically displaying on save", "body": "<p>I noticed that when I save a file and I have a syntax error in my code, the error quickfix window does not automatically appear. I recently rebuilt my system and simply copied over my <code>.vim/</code> directory along with the same <code>.vimrc</code>file. I've done this before and have never had any issues. However, if I manually enter <code>:GoErrCheck</code> or <code>GoBuild</code>, the window shows up. What gives?</p>\n\n<p>Here is my .vimrc</p>\n\n<pre><code>execute pathogen#infect()                                                                                                                                                                                                                     \nsyntax on                                                                                                                                                                                                                                     \nfiletype plugin indent on                                                                                                                                                                                                                     \n\nset nu                                                                                                                                                                                                                                        \nset completeopt-=preview                                                                                                                                                                                                                      \nset encoding=utf-8              \" Set default encoding to UTF-8                                                                                                                                                                               \nset autoread                                                                                                                                                                                                                                  \nset laststatus=2                                                                                                                                                                                                                              \nset noswapfile               \" Don't use swapfile                                                                                                                                                                                             \nset nobackup \" Don't create annoying backup files                                                                                                                                                                                             \n\"                                                                                                                                                                                                                                             \nnmap &lt;Leader&gt;t :TagbarToggle&lt;CR&gt;                                                                                                                                                                                                              \n\nautocmd FileType qf wincmd J                                                                                                                                                                                                                  \n\"CtrlP Settings                                                                                                                                                                                                                               \nlet g:ctrlp_show_hidden = 1                                                                                                                                                                                                                   \nlet g:neocomplete#enable_at_startup = 1                                                                                                                                                                                                       \n\nlet g:go_highlight_functions = 1                                                                                                                                                                                                              \nlet g:go_highlight_methods = 1                                                                                                                                                                                                                \nlet g:go_highlight_fields = 1                                                                                                                                                                                                                 \nlet g:go_highlight_structs = 1                                                                                                                                                                                                                \nlet g:go_highlight_interfaces = 1                                                                                                                                                                                                             \nlet g:go_highlight_operators = 1                                                                                                                                                                                                              \nlet g:go_highlight_build_constraints = 1                                                                                                                                                                                                      \nlet g:molokai_original = 1                                                                                                                                                                                                                    \n\n\nlet mapleader=\",\"                                                                                                                                                                                                              \ncolorscheme molokai    \n</code></pre>\n"}, {"tags": ["go", "pug"], "comments": [{"owner": {"reputation": 1362, "user_id": 1638814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/79045cf2a5e6cd8d939d0e6d39327133?s=128&d=identicon&r=PG", "display_name": "nvartolomei", "link": "https://stackoverflow.com/users/1638814/nvartolomei"}, "edited": false, "score": 0, "creation_date": 1465708519, "post_id": 37769835, "comment_id": 63010278, "body": "i think you should open an issue to golang jade package about this <a href=\"https://github.com/Joker/jade/issues\" rel=\"nofollow noreferrer\">github.com/Joker/jade/issues</a>"}, {"owner": {"reputation": 89, "user_id": 3905292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8802a093e310ecbe1f1d50bc8feac6?s=128&d=identicon&r=PG", "display_name": "Zac Pullar-Strecker", "link": "https://stackoverflow.com/users/3905292/zac-pullar-strecker"}, "reply_to_user": {"reputation": 1362, "user_id": 1638814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/79045cf2a5e6cd8d939d0e6d39327133?s=128&d=identicon&r=PG", "display_name": "nvartolomei", "link": "https://stackoverflow.com/users/1638814/nvartolomei"}, "edited": false, "score": 1, "creation_date": 1465712001, "post_id": 37769835, "comment_id": 63010814, "body": "@nvartolomei Is this an issue? I didn&#39;t think of doing that because I thought I was missing something."}, {"owner": {"reputation": 1362, "user_id": 1638814, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/79045cf2a5e6cd8d939d0e6d39327133?s=128&d=identicon&r=PG", "display_name": "nvartolomei", "link": "https://stackoverflow.com/users/1638814/nvartolomei"}, "edited": false, "score": 0, "creation_date": 1465806959, "post_id": 37769835, "comment_id": 63036798, "body": "Zac Pullar-Strecker I think so, though not sure. At least in original jade implementation this works."}], "owner": {"reputation": 89, "user_id": 3905292, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9e8802a093e310ecbe1f1d50bc8feac6?s=128&d=identicon&r=PG", "display_name": "Zac Pullar-Strecker", "link": "https://stackoverflow.com/users/3905292/zac-pullar-strecker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 74, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465693728, "creation_date": 1465693183, "last_edit_date": 1465693728, "question_id": 37769835, "link": "https://stackoverflow.com/questions/37769835/in-jade-how-can-i-call-a-function-without-escaping-the-returned-string", "title": "In jade how can I call a function without escaping the returned string?", "body": "<p>I'm using jade as part of a simple website using golang as the backend.</p>\n\n<p>As part of this I have jade that looks like this:</p>\n\n<pre><code>p#{printf(\"%s\", Body)}\n</code></pre>\n\n<p>I'm using the package github.com/go-floki/jade to compile this into an executable go template. The function printf is a go builtin that is run once the template is executed.</p>\n\n<p>The problem is that I want unescaped html. The jade doc seems to indicate that this:</p>\n\n<pre><code>p!{printf(\"%s\", Body)}\n</code></pre>\n\n<p>should work but that just ends up as:</p>\n\n<pre><code>&lt;p&gt;printf(\"%s\", Body)}&lt;/p&gt;\n</code></pre>\n\n<p>Is there a way to escape the function without escaping its argument?</p>\n\n<p>Thanks, Zac</p>\n"}, {"tags": ["database", "go", "deadlock"], "answers": [{"comments": [{"owner": {"reputation": 1101, "user_id": 2309005, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3d0825cedde3d48482239962f5f0ffa0?s=128&d=identicon&r=PG", "display_name": "splinter123", "link": "https://stackoverflow.com/users/2309005/splinter123"}, "edited": false, "score": 0, "creation_date": 1465719006, "post_id": 37769626, "comment_id": 63012233, "body": "Yes, tx.Query() would work, but I cannot always control that. The transaction tx is used to do some updates to the db by the admin, while the query is called by users visiting the website. So the two things might happen at the same time and I&#39;d prefer if it didn&#39;t shut down my database!"}, {"owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "reply_to_user": {"reputation": 1101, "user_id": 2309005, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3d0825cedde3d48482239962f5f0ffa0?s=128&d=identicon&r=PG", "display_name": "splinter123", "link": "https://stackoverflow.com/users/2309005/splinter123"}, "edited": false, "score": 0, "creation_date": 1465742943, "post_id": 37769626, "comment_id": 63018588, "body": "I would only expect this to deadlock when being executed back to back in same goroutine.  You get this issue when different routines are executing different the various things?   Also, postgresql SELECT statements don&#39;t lock unless you do &quot;for update&quot;, are you doing that?"}, {"owner": {"reputation": 1101, "user_id": 2309005, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3d0825cedde3d48482239962f5f0ffa0?s=128&d=identicon&r=PG", "display_name": "splinter123", "link": "https://stackoverflow.com/users/2309005/splinter123"}, "edited": false, "score": 0, "creation_date": 1465748159, "post_id": 37769626, "comment_id": 63020289, "body": "I haven&#39;t tested it on different goroutines, I was trying to naively replicate a concurrent behavior by doing different things on the same thread, but probably it&#39;s not the good way to go. The select statement is just a plain &quot;select * from mytable&quot;, where the same &quot;mytable&quot; was modified by the previous insert."}], "tags": [], "owner": {"reputation": 9777, "user_id": 121631, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/85801ee3b7b70969f6713aaa5768ca20?s=128&d=identicon&r=PG", "display_name": "David Budworth", "link": "https://stackoverflow.com/users/121631/david-budworth"}, "is_accepted": false, "score": 0, "last_activity_date": 1465690531, "creation_date": 1465690531, "answer_id": 37769626, "question_id": 37769338, "link": "https://stackoverflow.com/questions/37769338/dead-lock-in-golang-database-sql/37769626#37769626", "title": "Dead Lock in golang database/sql", "body": "<p>The connection.Query function does not execute on the same session as your tx.XXX functionsso if select_statement happens to reference anything that was written to by insert_statement, you potentially would block.</p>\n\n<p>try tx.Query(select_statement) to see if that one blocks.</p>\n"}], "owner": {"reputation": 1101, "user_id": 2309005, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/3d0825cedde3d48482239962f5f0ffa0?s=128&d=identicon&r=PG", "display_name": "splinter123", "link": "https://stackoverflow.com/users/2309005/splinter123"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1891, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1465690531, "creation_date": 1465687221, "question_id": 37769338, "link": "https://stackoverflow.com/questions/37769338/dead-lock-in-golang-database-sql", "title": "Dead Lock in golang database/sql", "body": "<p>I've noticed a strange behavior in Go's database/sql package, using the PostgreSQL driver from lib/pq. Basically if I use a database connection for a query while I'm building a transaction on the same connection, I enter in a dead lock and the program blocks (I need to manually restart the database server to make it work again). In the example code below, I would get stuck at the select statement, and the second insert statement would never be executed (while if I remove the query the code executes normally).</p>\n\n<pre><code>tx, _ := connection.Begin()\ntx.Exec(insert_statement)\nrows, _ := connection.Query(select_statement)\nrows.Close()\ntx.Exec(insert_statement_2)\ntx.Commit()\n</code></pre>\n\n<p>Is this normal? Should I create a new database connection every time I want to use transactions?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465687041, "post_id": 37769252, "comment_id": 63007136, "body": "Everything you pass to reflect is in an interface. The signature of TypeOf is <code>func TypeOf(i interface{}) Type</code>"}], "answers": [{"comments": [{"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1465699375, "post_id": 37769322, "comment_id": 63008990, "body": "THANK YOU !!   As I am exploring GO and I seem to find obscure questions that I can not find an answer to.  If there is a missing assumption in anything I am studying,  it seems to jump up and bite me~  Is this value to interface conversion mentioned anywhere specifically?  If so I like a reference to it.   One other question, I assume the value to interface conversion is done at compile time - Not Run-time!  Is this correct."}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1465699751, "post_id": 37769322, "comment_id": 63009028, "body": "-----------------------One other question: ------------------------------------------------ Can I assume the value to interface conversion is done at compile time - Not Run-time!  Is this correct?"}, {"owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "reply_to_user": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1465700201, "post_id": 37769322, "comment_id": 63009082, "body": "<a href=\"https://golang.org/ref/spec#Calls\" rel=\"nofollow noreferrer\">golang.org/ref/spec#Calls</a> explains how function calls work, although it&#39;s not explicitly spelled out what happens when you have a formal parameter of the function of interface type. I don&#39;t know what you mean when you ask whether it&#39;s ok to assume that the value to interface conversion is done at compile time. I don&#39;t know what it would mean to do a conversion at compile time, so I think it&#39;s necessarily done at runtime, but I suspect I don&#39;t understand the question."}, {"owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "edited": false, "score": 0, "creation_date": 1465721833, "post_id": 37769322, "comment_id": 63012777, "body": "I mean you say there is an implicit conversion from value &#39;x&#39; to implicitly converted to interface{}.  When an Where does this conversion take place."}], "tags": [], "owner": {"reputation": 44047, "user_id": 1400793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7VxVK.png?s=128&g=1", "display_name": "Paul Hankin", "link": "https://stackoverflow.com/users/1400793/paul-hankin"}, "is_accepted": false, "score": 1, "last_activity_date": 1465687050, "creation_date": 1465687050, "answer_id": 37769322, "question_id": 37769252, "link": "https://stackoverflow.com/questions/37769252/reflection-representation-of-var-as-opposed-to-an-interface/37769322#37769322", "title": "reflection representation of var as opposed to an interface.", "body": "<p>The type of <code>reflect.TypeOf</code> is:</p>\n\n<pre><code>func TypeOf(i interface{}) Type\n</code></pre>\n\n<p>When you call <code>reflect.ValueOf(x)</code> in your code, the value of <code>x</code> is implicitly converted to <code>interface{}</code>. At compile time, the type of <code>x</code> is known (<code>float64</code>), and the interface value is represented as you already know; as a two word pair with the pointer to the information for <code>float64</code> and a pointer to the <code>float64</code> value (3.4).</p>\n\n<p>The same reasoning applies to <code>s</code> later in your program.</p>\n\n<p>There's very little implicit conversion done between types in Go, but the conversion between values and interfaces when calling a function (or assigning to a variable) is an exception.</p>\n"}], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 47, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465687050, "creation_date": 1465686299, "question_id": 37769252, "link": "https://stackoverflow.com/questions/37769252/reflection-representation-of-var-as-opposed-to-an-interface", "title": "reflection representation of var as opposed to an interface.", "body": "<p>I am trying to understand the representation of a reflection value:</p>\n\n<pre><code>type S struct {\n    F string `species:\"gopher\" color:\"blue\"`\n}\n\nvar x float64 = 3.4\nv := reflect.ValueOf(x)     \nfmt.Println(\"v = \", v)     // v = 3.4\n\n\ns := S{}\nss := reflect.ValueOf(s)\nfmt.Println(\"ss = \", ss)   // ss = {}   \n</code></pre>\n\n<p>I understand that the representation of a reflection interface value is a two-word pair that gives a pointer to type information and a pointer to the associated value.</p>\n\n<p>What is the reflection representation of a variable. Is it just the value and if so, how is the type determined by code below:</p>\n\n<pre><code>fmt.Println(\"type:\", reflect.TypeOf(x))\n</code></pre>\n\n<p>If the representation is just value, as it appears to be, where does the code above find the type information?  </p>\n"}, {"tags": ["unit-testing", "testing", "go"], "comments": [{"owner": {"reputation": 3258, "user_id": 2058014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a12b9d9a9cd413b4ddccd046428f72c?s=128&d=identicon&r=PG&f=1", "display_name": "Brrrr", "link": "https://stackoverflow.com/users/2058014/brrrr"}, "edited": false, "score": 3, "creation_date": 1465676718, "post_id": 37768137, "comment_id": 63004871, "body": "on the side: add -v to get the fmt.Println of your Tests"}, {"owner": {"reputation": 1127, "user_id": 6171872, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2wfQM.jpg?s=128&g=1", "display_name": "StarSheriff", "link": "https://stackoverflow.com/users/6171872/starsheriff"}, "reply_to_user": {"reputation": 3258, "user_id": 2058014, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3a12b9d9a9cd413b4ddccd046428f72c?s=128&d=identicon&r=PG&f=1", "display_name": "Brrrr", "link": "https://stackoverflow.com/users/2058014/brrrr"}, "edited": false, "score": 0, "creation_date": 1465677152, "post_id": 37768137, "comment_id": 63004977, "body": "yes, I usually do. I really like the <code>t.Log()</code> and <code>t.Logf()</code> methods! Omitted it here since it has no effect on the example."}, {"owner": {"reputation": 9811, "user_id": 168717, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/851da71d0192b0e34ac44dd6c98c31d2?s=128&d=identicon&r=PG", "display_name": "AkiRoss", "link": "https://stackoverflow.com/users/168717/akiross"}, "edited": false, "score": 3, "creation_date": 1465721150, "post_id": 37768137, "comment_id": 63012653, "body": "Well, with the <code>-run</code> flag you are explicitly selecting which tests to run. If you select none, I think it&#39;s correct to execute no test without raising any error."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1465753126, "post_id": 37768137, "comment_id": 63021933, "body": "Otherwise it would not be possible to execute benchmarks only as you have to turn tests off in this case."}], "answers": [{"tags": [], "owner": {"reputation": 368279, "user_id": 1288, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/fc763c6ff6c160ddad05741e87e517b6?s=128&d=identicon&r=PG", "display_name": "Bill the Lizard", "link": "https://stackoverflow.com/users/1288/bill-the-lizard"}, "is_accepted": false, "score": 0, "last_activity_date": 1612721732, "creation_date": 1612721732, "answer_id": 66091458, "question_id": 37768137, "link": "https://stackoverflow.com/questions/37768137/why-doesnt-raise-go-test-run-testthatdoesnotexist-an-error/66091458#66091458", "title": "Why doesn&#39;t raise &quot;go test -run testThatDoesNotExist&quot; an error?", "body": "<p>Go now emits a warning when the <code>-run</code> regexp doesn't match anything.</p>\n<pre><code>$go test -run TestDoesNotExist\ntesting: warning: no tests to run\nPASS\nok      starsheriff.net/helloworld  0.179s\n</code></pre>\n<p>I think the reasoning before was that because you are passing a regular expression with the <code>-run</code> flag, if you pass something that doesn't match any tests it should just pass, since technically all (zero) tests passed, and nothing failed.</p>\n<p>It was probably better before to pass the verbose (<code>-v</code>) flag with <code>-run</code>, that way you could always see which tests were run, not just which tests failed. In verbose mode, go test will always print out a message for passing tests, so at least you'd see there were no tests run at all. With the warning message, there's no longer the same need to run tests with <code>-v</code>.</p>\n"}], "owner": {"reputation": 1127, "user_id": 6171872, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2wfQM.jpg?s=128&g=1", "display_name": "StarSheriff", "link": "https://stackoverflow.com/users/6171872/starsheriff"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 69, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1612721732, "creation_date": 1465676161, "question_id": 37768137, "link": "https://stackoverflow.com/questions/37768137/why-doesnt-raise-go-test-run-testthatdoesnotexist-an-error", "title": "Why doesn&#39;t raise &quot;go test -run testThatDoesNotExist&quot; an error?", "body": "<p>I just stumbled over a situation that made me curious. I spent half an hour to figure out why <code>go test -run testWrittenWithSmallT</code> is not executing my test. Except that I spelled it with a small <strong>t</strong> instead of <strong>T</strong> I noticed that <code>go test</code> passes if the given test method does not exist.</p>\n\n<p>Little background: Initially I was wondering why my tests are not printing <code>fmt.Println</code> to <code>stdout</code>, or at least I thought that was the error. Only after a while I found out that the test is not executed at all.</p>\n\n<p>So I am wondering, is there any reason why that should pass silently?</p>\n\n<p>Examples <code>go</code> file:</p>\n\n<pre><code>package helloworld\n\nimport(\n  \"fmt\"\n  \"testing\"\n)\n\nfunc testWithSmallT(t *testing.T) {\n    fmt.Println(\"test with small t executed\")\n}\n\nfunc TestWithCapitalT(t *testing.T) {\n    fmt.Println(\"test with capital T executed\")\n}\n</code></pre>\n\n<p>Test results:</p>\n\n<pre><code>$go test -run testWithSmallT\nPASS\nok      starsheriff.net/helloworld  0.004s\n\n$go test -run TestWithCapitalT\ntest with capital T executed\nPASS\nok      starsheriff.net/helloworld  0.003s\n\n$go test -run TestDoesNotExist\nPASS\nok      starsheriff.net/helloworld  0.004s\n</code></pre>\n"}, {"tags": ["xml", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1473775565, "last_edit_date": 1495535431, "creation_date": 1465672734, "answer_id": 37767670, "question_id": 37767089, "link": "https://stackoverflow.com/questions/37767089/unmarshal-array-from-xml-in-go-language/37767670#37767670", "title": "Unmarshal array from xml in go language", "body": "<p>Fix is really easy: you have to put the path in quotes:</p>\n\n<pre><code>CommunicationNumbers []Communication `xml:\"CommunicationNumbers&gt;Communication\"`\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/d7vVd8fyZa\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<blockquote>\n  <p>main.Patient{Name:main.Name{LastName:\"Biscayne\", FirstName:\"Sophia\"}, Gender:\"F\", CommunicationNumbers:[]main.Communication{main.Communication{Number:\"9415551223\", Qualifier:\"TE\"}, main.Communication{Number:\"4055559999\", Qualifier:\"TE\"}}}</p>\n</blockquote>\n\n<p>In fact you always have to put it in quotes, even if it is not a path but just an XML tag name:</p>\n\n<pre><code>type Communication struct {\n    Number    string `xml:\"Number\"`\n    Qualifier string `xml:\"Qualifier\"`\n}\n</code></pre>\n\n<p>As mentioned in the documentation of <a href=\"http://golang.org/pkg/reflect/#StructTag\" rel=\"nofollow noreferrer\"><code>reflect.StructTag</code></a>, by convention the value of a tag string is a space-separated <code>key:\"value\"</code> pairs. The <code>encoding/xml</code> package uses this convention by using the <a href=\"https://golang.org/pkg/reflect/#StructTag.Get\" rel=\"nofollow noreferrer\"><code>StructTag.Get()</code></a> method. If you omit the quotes, the name you specify in the tag will not be used (but the name of the field will be used).</p>\n\n<p>Read more about struct tags here: <a href=\"https://stackoverflow.com/questions/10858787/what-are-the-uses-for-tags-in-go/30889373#30889373\">What are the use(s) for tags in Go?</a></p>\n"}], "owner": {"reputation": 1365, "user_id": 1848653, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01b16c9fb1ae46f317a53694e944a1e6?s=128&d=identicon&r=PG", "display_name": "Tusshu", "link": "https://stackoverflow.com/users/1848653/tusshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 478, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1473775565, "creation_date": 1465668910, "last_edit_date": 1465673217, "question_id": 37767089, "link": "https://stackoverflow.com/questions/37767089/unmarshal-array-from-xml-in-go-language", "title": "Unmarshal array from xml in go language", "body": "<p>Trying to parse xml containing an array using <code>encoding/xml</code> package</p>\n\n<p><a href=\"https://play.golang.org/p/lcYXQ_cBTX\" rel=\"nofollow\">Link to code here</a></p>\n\n<pre><code>import (\n    \"fmt\"\n    \"encoding/xml\"\n)\nvar data = `\n&lt;Patient&gt;\n          &lt;Name&gt;\n                &lt;LastName&gt;Biscayne&lt;/LastName&gt;\n                &lt;FirstName&gt;Sophia&lt;/FirstName&gt;\n            &lt;/Name&gt;\n            &lt;Gender&gt;F&lt;/Gender&gt;\n            &lt;CommunicationNumbers&gt;\n                &lt;Communication&gt;\n                    &lt;Number&gt;9415551223&lt;/Number&gt;\n                    &lt;Qualifier&gt;TE&lt;/Qualifier&gt;\n                &lt;/Communication&gt;\n    &lt;Communication&gt;\n                    &lt;Number&gt;4055559999&lt;/Number&gt;\n                    &lt;Qualifier&gt;TE&lt;/Qualifier&gt;\n                &lt;/Communication&gt;\n            &lt;/CommunicationNumbers&gt;\n        &lt;/Patient&gt;\n`\ntype Name struct {\n    LastName string\n    FirstName string\n}\n\ntype Communication struct {\n    Number string `xml:Number`\n    Qualifier string `xml:Qualifier`\n}\n\ntype Patient struct {\n    Name Name\n    Gender string\n    CommunicationNumbers []Communication `xml:CommunicationNumbers&gt;Communication`\n}\n\nfunc main() {\n\n    patient := Patient{}\n    _ = xml.Unmarshal([]byte(data), &amp;patient)   \n\n    fmt.Printf(\"%#v\\n\", patient)\n}\n</code></pre>\n\n<p>I am not able to get communication numbers. The output is as follows:</p>\n\n<blockquote>\n  <p>main.Patient{Name:main.Name{LastName:\"Biscayne\", FirstName:\"Sophia\"}, Gender:\"F\", CommunicationNumbers:[]main.Communication{main.Communication{Number:\"\", Qualifier:\"\"}}}</p>\n</blockquote>\n"}, {"tags": ["unit-testing", "go", "filesystems"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1465674962, "post_id": 37766632, "comment_id": 63004364, "body": "Don&#39;t aim at 100%."}, {"owner": {"reputation": 467, "user_id": 5152721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/3Wr2w.jpg?s=128&g=1", "display_name": "Lerenn", "link": "https://stackoverflow.com/users/5152721/lerenn"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1465675726, "post_id": 37766632, "comment_id": 63004610, "body": "I could do that but I find that strange that the system hasn&#39;t been made to solve this problem..."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 3, "creation_date": 1465723186, "post_id": 37766632, "comment_id": 63013091, "body": "Reaching 100% line coverage is not a &quot;problem&quot; worth solving."}, {"owner": {"reputation": 467, "user_id": 5152721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/3Wr2w.jpg?s=128&g=1", "display_name": "Lerenn", "link": "https://stackoverflow.com/users/5152721/lerenn"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1465740447, "post_id": 37766632, "comment_id": 63017797, "body": "So I&#39;ll ignore it. Thanks for the advice :)"}], "answers": [{"tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 0, "last_activity_date": 1470221153, "last_edit_date": 1470221153, "creation_date": 1465753356, "answer_id": 37777254, "question_id": 37766632, "link": "https://stackoverflow.com/questions/37766632/golang-testing-with-filesystem-and-reaching-100/37777254#37777254", "title": "Golang - Testing with filesystem and reaching 100%", "body": "<p>I attempted to do same thing, just to try it. I achieved it by referencing all system file calls as interfaces and having method accept an interface.  Then if no interface was provided the system method was used. I am brand new to Go, so I'm not sure if it violates best practices or not.</p>\n\n<pre><code>import \"io/ioutil\"\n\n\ntype ReadFile func (string) ([]byte, error)\n\n\ntype FileLoader interface {\n    LoadPath(path string) []byte\n}\n\n// Initializes a LocalFileSystemLoader with default ioutil.ReadFile\n// as the method to read file.  Optionally allows caller to provide\n// their own ReadFile for testing.\nfunc NewLocalFileSystemLoader(rffn ReadFile) *localFileSystemLoader{\n    var rf ReadFile = ioutil.ReadFile\n\n    if rffn != nil {\n        rf = rffn\n    }\n    return &amp;localFileSystemLoader{\n        ReadFileFn: rf}\n}\n\ntype localFileSystemLoader struct {\n    ReadFileFn ReadFile\n}\n\nfunc (lfsl *localFileSystemLoader) LoadPath(path string) []byte {\n    dat, err := lfsl.ReadFileFn(path)\n    if err != nil {\n        panic(err)\n    }\n\n    return dat\n}\n</code></pre>\n"}], "owner": {"reputation": 467, "user_id": 5152721, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/3Wr2w.jpg?s=128&g=1", "display_name": "Lerenn", "link": "https://stackoverflow.com/users/5152721/lerenn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 479, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1470221153, "creation_date": 1465666183, "question_id": 37766632, "link": "https://stackoverflow.com/questions/37766632/golang-testing-with-filesystem-and-reaching-100", "title": "Golang - Testing with filesystem and reaching 100%", "body": "<p>I'm trying to test one of my package to reach 100%.\nHowever, I can't find how I can do this without being \"against the system\" (functions pointers, etc.).</p>\n\n<p>I tried to do something similar to this, but I can't reach 100% because of \"real\" functions : </p>\n\n<pre><code>var fs fileSystem = osFS{}\n\ntype fileSystem interface {\n    Open(name string) (file, error)\n    Stat(name string) (os.FileInfo, error)\n}\n\ntype file interface {\n    io.Closer\n    io.Reader\n    io.ReaderAt\n    io.Seeker\n    Stat() (os.FileInfo, error)\n}\n\n// osFS implements fileSystem using the local disk.\ntype osFS struct{}\n\nfunc (osFS) Open(name string) (file, error)        { return os.Open(name) }\nfunc (osFS) Stat(name string) (os.FileInfo, error) { return os.Stat(name) }\n</code></pre>\n\n<p>(From <a href=\"https://talks.golang.org/2012/10things.slide#8\" rel=\"nofollow\">https://talks.golang.org/2012/10things.slide#8</a>)</p>\n\n<p>Does someone would have a suggestion ? :)\nThanks !</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 1, "creation_date": 1465662263, "post_id": 37765878, "comment_id": 63000623, "body": "Any parsing (xml or json) works only on exported field. &quot;release&quot; and &quot;version&quot; are unexported, I guess that&#39;s why they remain empty."}], "answers": [{"tags": [], "owner": {"reputation": 325, "user_id": 3781442, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001923358820/picture?type=large", "display_name": "hitesh_noty", "link": "https://stackoverflow.com/users/3781442/hitesh-noty"}, "is_accepted": false, "score": 0, "last_activity_date": 1465672857, "creation_date": 1465672857, "answer_id": 37767684, "question_id": 37765878, "link": "https://stackoverflow.com/questions/37765878/how-to-get-xml-attribute-values-using-encoding-xml-package-in-go-language/37767684#37767684", "title": "How to get xml attribute values using encoding/xml package in go language", "body": "<p>Changing your struct to:</p>\n\n<pre><code>type Message struct {\n   XMLName  xml.Name `xml:http://www.ncpdp.org/schema/SCRIPT \"Message\"`\n   Release string `xml:\"release,attr\"`\n   Version string `xml:\"version,attr\"`\n}\n</code></pre>\n\n<p>will solve the issue.\nGo uses case to determine whether a particular identifier is public or private within the context of your package. In your code, the fields are not visible to <code>xml.Unmarshal</code> because it is not part of the package containing your code.</p>\n\n<p>When you change the fields to be upper case, they became public so could be exported.</p>\n\n<p>Working Example : <a href=\"https://play.golang.org/p/h8Q4t_3ctS\" rel=\"nofollow\">https://play.golang.org/p/h8Q4t_3ctS</a></p>\n"}], "owner": {"reputation": 1365, "user_id": 1848653, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/01b16c9fb1ae46f317a53694e944a1e6?s=128&d=identicon&r=PG", "display_name": "Tusshu", "link": "https://stackoverflow.com/users/1848653/tusshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 244, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465672857, "creation_date": 1465661640, "question_id": 37765878, "link": "https://stackoverflow.com/questions/37765878/how-to-get-xml-attribute-values-using-encoding-xml-package-in-go-language", "title": "How to get xml attribute values using encoding/xml package in go language", "body": "<p>I need to convert following xml to go struct.</p>\n\n<p><a href=\"https://play.golang.org/p/tboi-mp06k\" rel=\"nofollow\">https://play.golang.org/p/tboi-mp06k</a></p>\n\n<pre><code>var data = `&lt;Message xmlns=\"http://www.ncpdp.org/schema/SCRIPT\"\n     xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n     release=\"006\"\n     version=\"010\"&gt;`\n\ntype Message struct {\n   XMLName  xml.Name `xml:http://www.ncpdp.org/schema/SCRIPT \"Message\"`\n   release string `xml:\"release,attr\"`\n   version string `xml:\"version,attr\"`\n}\n\nfunc main() {\n\n    msg := Message{}\n    _ = xml.Unmarshal([]byte(data), &amp;msg)   \n\n   fmt.Printf(\"%#v\\n\", msg)\n</code></pre>\n\n<p>}</p>\n\n<p>Program outputs the following:\nmain.Message{XMLName:xml.Name{Space:\"<a href=\"http://www.ncpdp.org/schema/SCRIPT\" rel=\"nofollow\">http://www.ncpdp.org/schema/SCRIPT</a>\", Local:\"Message\"}, release:\"\", version:\"\"}\nrelease and version are empty. Any suggestions please?</p>\n"}, {"tags": ["go", "blockchain", "hyperledger"], "comments": [{"owner": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "edited": false, "score": 0, "creation_date": 1465665249, "post_id": 37765837, "comment_id": 63001559, "body": "Not sure if your peer executable was compiled correctly. If you will try to run \u201cmake peer\u201d in the fabric folder, the peer file will be created in \u201cfabric/build/bin/\u201d. Do you use this path to run Validation Peer ?"}, {"owner": {"reputation": 1758, "user_id": 4627552, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/PKXU2.jpg?s=128&g=1", "display_name": "Clyde D&#39;Cruz", "link": "https://stackoverflow.com/users/4627552/clyde-dcruz"}, "reply_to_user": {"reputation": 2061, "user_id": 539877, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2078f8c58536286626ce779e7bfdb10c?s=128&d=identicon&r=PG&f=1", "display_name": "Sergey Balashevich", "link": "https://stackoverflow.com/users/539877/sergey-balashevich"}, "edited": false, "score": 0, "creation_date": 1465666541, "post_id": 37765837, "comment_id": 63001869, "body": "I am using the executables that were generated in the fabric/build/bin by the &#39;make peer&#39; and &#39;make membersrvc&#39;"}], "answers": [{"comments": [{"owner": {"reputation": 1758, "user_id": 4627552, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/PKXU2.jpg?s=128&g=1", "display_name": "Clyde D&#39;Cruz", "link": "https://stackoverflow.com/users/4627552/clyde-dcruz"}, "edited": false, "score": 0, "creation_date": 1465706895, "post_id": 37766223, "comment_id": 63010024, "body": "Thanks :) . I had an old executable in my GOBIN that was causing the trouble."}], "tags": [], "owner": {"reputation": 7694, "user_id": 5529712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/7uvxg.png?s=128&g=1", "display_name": "Gari Singh", "link": "https://stackoverflow.com/users/5529712/gari-singh"}, "is_accepted": true, "score": 1, "last_activity_date": 1465667054, "last_edit_date": 1465667054, "creation_date": 1465663641, "answer_id": 37766223, "question_id": 37765837, "link": "https://stackoverflow.com/questions/37765837/error-while-starting-peer-with-security-and-privacy-turned-on/37766223#37766223", "title": "Error while starting peer with security and privacy turned on", "body": "<p>Well I still think the fact that we panic is a bug, but my guess is that you have not built and/or started membership services which are required when security is enabled:  <a href=\"https://github.com/hyperledger/fabric/blob/master/docs/API/SandboxSetup.md#security-setup-optional\" rel=\"nofollow\">https://github.com/hyperledger/fabric/blob/master/docs/API/SandboxSetup.md#security-setup-optional</a></p>\n\n<p>Edit:  I originally missed something in the stack trace above.  Looks like you are running on a very old version of the fabric code.  For example <code>github.com/hyperledger/fabric/core/crypto/utils/keys.go</code> is no longer in the current code.  I checked out your fork and it seems you are still pretty far behind.  Not sure if you are building out of your fork or not, but looks like you definitely have old code and need to pull down upstream changes</p>\n"}], "owner": {"reputation": 1758, "user_id": 4627552, "user_type": "registered", "accept_rate": 65, "profile_image": "https://i.stack.imgur.com/PKXU2.jpg?s=128&g=1", "display_name": "Clyde D&#39;Cruz", "link": "https://stackoverflow.com/users/4627552/clyde-dcruz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 164, "favorite_count": 0, "accepted_answer_id": 37766223, "answer_count": 1, "score": 0, "last_activity_date": 1465667054, "creation_date": 1465661393, "question_id": 37765837, "link": "https://stackoverflow.com/questions/37765837/error-while-starting-peer-with-security-and-privacy-turned-on", "title": "Error while starting peer with security and privacy turned on", "body": "<p>When I try to start the peer using </p>\n\n<pre><code>peer node start\n</code></pre>\n\n<p>I get the following error</p>\n\n<pre><code>hyperledger@linux-box:/opt/gopath/src/github.com/hyperledger/fabric$ peer node start\n20:42:02.999 [crypto] main -&gt; INFO 001 Log level recognized 'info', set to INFO\n20:42:03.017 [main] serve -&gt; INFO 002 Security enabled status: true\n20:42:03.017 [main] serve -&gt; INFO 004 Privacy enabled status: true\n20:42:03.017 [crypto] func1 -&gt; INFO 005 Registering validator [vp] with name [vp]...\n20:42:03.017 [eventhub_producer] start -&gt; INFO 003 event processor started\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x10 pc=0x8ad221]\n\ngoroutine 1 [running]:\npanic(0xd43fe0, 0xc82000e120)\n    /opt/go/src/runtime/panic.go:481 +0x3e6\ngithub.com/hyperledger/fabric/core/crypto/utils.PEMtoPrivateKey(0x15409e0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0)\n    /opt/gopath/src/github.com/hyperledger/fabric/core/crypto/utils/keys.go:117 +0x91\ngithub.com/hyperledger/fabric/core/crypto.(*nodeImpl).retrieveEnrollmentData(0xc820226630, 0xc8201c35c8, 0x2, 0xc8201c35f0, 0xc, 0x0, 0x0)\n    /opt/gopath/src/github.com/hyperledger/fabric/core/crypto/node_eca.go:120 +0xe55\ngithub.com/hyperledger/fabric/core/crypto.(*nodeImpl).registerCryptoEngine(0xc820226630, 0xc8201c35c8, 0x2, 0xc8201c35f0, 0xc, 0x0, 0x0)\n    /opt/gopath/src/github.com/hyperledger/fabric/core/crypto/node_crypto.go:49 +0x5d6\ngithub.com/hyperledger/fabric/core/crypto.(*nodeImpl).register(0xc820226630, 0x2, 0xc8201c35c8, 0x2, 0x0, 0x0, 0x0, 0xc8201c35c8, 0x2, 0xc8201c35f0, ...)\n    /opt/gopath/src/github.com/hyperledger/fabric/core/crypto/node_impl.go:114 +0x5b8\ngithub.com/hyperledger/fabric/core/crypto.(*peerImpl).register(0xc820242840, 0x2, 0xc8201c35c8, 0x2, 0x0, 0x0, 0x0, 0xc8201c35c8, 0x2, 0xc8201c35f0, ...)\n    /opt/gopath/src/github.com/hyperledger/fabric/core/crypto/peer_impl.go:177 +0x20a\ngithub.com/hyperledger/fabric/core/crypto.(*validatorImpl).register(0xc8201fd600, 0xc8201c35c8, 0x2, 0x0, 0x0, 0x0, 0xc8201c35c8, 0x2, 0xc8201c35f0, 0xc, ...)\n    /opt/gopath/src/github.com/hyperledger/fabric/core/crypto/validator_impl.go:147 +0x20a\ngithub.com/hyperledger/fabric/core/crypto.RegisterValidator(0xc8201c35c8, 0x2, 0x0, 0x0, 0x0, 0xc8201c35c8, 0x2, 0xc8201c35f0, 0xc, 0x0, ...)\n    /opt/gopath/src/github.com/hyperledger/fabric/core/crypto/validator.go:55 +0x55d\nmain.getSecHelper.func1()\n    /opt/gopath/src/github.com/hyperledger/fabric/peer/main.go:360 +0x200\nsync.(*Once).Do(0x1540ad8, 0xc8201fd768)\n    /opt/go/src/sync/once.go:44 +0xe4\nmain.getSecHelper(0x0, 0x0, 0x0, 0x0)\n    /opt/gopath/src/github.com/hyperledger/fabric/peer/main.go:380 +0x7d\nmain.serve(0x15409e0, 0x0, 0x0, 0x0, 0x0)\n    /opt/gopath/src/github.com/hyperledger/fabric/peer/main.go:446 +0xc23\nmain.glob.func3(0x1503160, 0x15409e0, 0x0, 0x0, 0x0, 0x0)\n    /opt/gopath/src/github.com/hyperledger/fabric/peer/main.go:95 +0x41\ngithub.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).execute(0x1503160, 0x15409e0, 0x0, 0x0, 0x0, 0x0)\n    /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:497 +0x62c\ngithub.com/hyperledger/fabric/vendor/github.com/spf13/cobra.(*Command).Execute(0x1502de0, 0x0, 0x0)\n    /opt/gopath/src/github.com/hyperledger/fabric/vendor/github.com/spf13/cobra/command.go:584 +0x46a\nmain.main()\n    /opt/gopath/src/github.com/hyperledger/fabric/peer/main.go:314 +0x18d9\n</code></pre>\n\n<p>My core.yaml contains the default contents , with security and privacy enabled.</p>\n\n<p>Is this a bug ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 1, "creation_date": 1465680184, "post_id": 37765687, "comment_id": 63005735, "body": "Keep in mind that int size in go depends on the host CPU, it&#39;s 32bit on 32bit CPUs and 64bit on well, 64bit CPUs."}, {"owner": {"reputation": 879, "user_id": 5440006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SAyQS.jpg?s=128&g=1", "display_name": "yamachan", "link": "https://stackoverflow.com/users/5440006/yamachan"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1465820319, "post_id": 37765687, "comment_id": 63045215, "body": "@OneOfOne Thank you for your comment. Yes, when I used <code>ParseInt()</code>, an error occurred in my netbook. So, I used <code>Atoi</code> instead."}], "answers": [{"comments": [{"owner": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 2, "creation_date": 1465664445, "post_id": 37766137, "comment_id": 63001336, "body": "I down voted your answer because I think it is not relevant. First, it adds nothing to the question (you just reuse the code in the question and remove some parts of it). Second avoiding a returned error in go is always a bad advice. Third, according to the link in the question the value N exists and shall be used. And finally, using function is a better way of coding, so no need to remove it."}, {"owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "reply_to_user": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 0, "creation_date": 1465683330, "post_id": 37766137, "comment_id": 63006367, "body": "I answer to the exact question you asked. Or do you want us to solve your problem completely with clean &quot;production&quot; ready code? Stackoverflow is not the place for these kind of questions."}, {"owner": {"reputation": 879, "user_id": 5440006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SAyQS.jpg?s=128&g=1", "display_name": "yamachan", "link": "https://stackoverflow.com/users/5440006/yamachan"}, "edited": false, "score": 0, "creation_date": 1465821039, "post_id": 37766137, "comment_id": 63045739, "body": "@Darigaaz Thank you for your reply. Yeah, I thought I did make it complicated. So I asked. I am a beginner of Go, so I thought there are something like packages or libraries which I don&#39;t know and couldn&#39;t find. Ah, I didn&#39;t write the comment. I didn&#39;t imply your solving the question. I just wanted to ask the part which to convert String to Int."}, {"owner": {"reputation": 879, "user_id": 5440006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SAyQS.jpg?s=128&g=1", "display_name": "yamachan", "link": "https://stackoverflow.com/users/5440006/yamachan"}, "reply_to_user": {"reputation": 815, "user_id": 5595052, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-VCv1pzX179I/AAAAAAAAAAI/AAAAAAAAANM/1-bBYl0T9ZE/photo.jpg?sz=128", "display_name": "jnmoal", "link": "https://stackoverflow.com/users/5595052/jnmoal"}, "edited": false, "score": 0, "creation_date": 1465821178, "post_id": 37766137, "comment_id": 63045835, "body": "@Jean-NicolasMoal Thank you for your comment. I will implement the error handling later. Thank you."}], "tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": false, "score": 2, "last_activity_date": 1465663088, "creation_date": 1465663088, "answer_id": 37766137, "question_id": 37765687, "link": "https://stackoverflow.com/questions/37765687/golang-how-to-convert-string-to-int/37766137#37766137", "title": "Golang: How to convert string to []int?", "body": "<p>I think you overcomplicating things unless I am missing something.</p>\n\n<p><a href=\"https://play.golang.org/p/HLvV8R1Ux-\" rel=\"nofollow\">https://play.golang.org/p/HLvV8R1Ux-</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"strconv\"\n)\n\nfunc main() {\n    A := \"5 2 4 6 1 3\"\n\n    strs := strings.Split(A, \" \")\n    ary := make([]int, len(strs))\n    for i := range ary {\n        ary[i], _ = strconv.Atoi(strs[i])\n    }\n\n    fmt.Println(ary)    \n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 879, "user_id": 5440006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SAyQS.jpg?s=128&g=1", "display_name": "yamachan", "link": "https://stackoverflow.com/users/5440006/yamachan"}, "edited": false, "score": 0, "creation_date": 1465820553, "post_id": 37767467, "comment_id": 63045384, "body": "Thank you for your answer. Ah, I will write error handling later. Thanks. And thank you for your next one. Ah, I will try <code>fmt.Scanf</code>. Thank you so much."}, {"owner": {"reputation": 879, "user_id": 5440006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SAyQS.jpg?s=128&g=1", "display_name": "yamachan", "link": "https://stackoverflow.com/users/5440006/yamachan"}, "edited": false, "score": 0, "creation_date": 1465826245, "post_id": 37767467, "comment_id": 63049533, "body": "Ah, so is <code>fmt.Scanf()</code> better than <code>scanner = bufio.NewScanner(os.Stdin);  scanner.Scan(); N := scanner.Text()</code>?"}, {"owner": {"reputation": 325, "user_id": 3781442, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001923358820/picture?type=large", "display_name": "hitesh_noty", "link": "https://stackoverflow.com/users/3781442/hitesh-noty"}, "reply_to_user": {"reputation": 879, "user_id": 5440006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SAyQS.jpg?s=128&g=1", "display_name": "yamachan", "link": "https://stackoverflow.com/users/5440006/yamachan"}, "edited": false, "score": 1, "creation_date": 1465828995, "post_id": 37767467, "comment_id": 63051438, "body": "so if you want to take faster input <a href=\"http://stackoverflow.com/questions/31333353/faster-input-scanning\" title=\"faster input scanning\">stackoverflow.com/questions/31333353/faster-input-scanning</a> have a look at this."}, {"owner": {"reputation": 879, "user_id": 5440006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SAyQS.jpg?s=128&g=1", "display_name": "yamachan", "link": "https://stackoverflow.com/users/5440006/yamachan"}, "edited": false, "score": 0, "creation_date": 1466037274, "post_id": 37767467, "comment_id": 63155696, "body": "Thank you. I use <code>fmt.Scanf()</code> instead."}], "tags": [], "owner": {"reputation": 325, "user_id": 3781442, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001923358820/picture?type=large", "display_name": "hitesh_noty", "link": "https://stackoverflow.com/users/3781442/hitesh-noty"}, "is_accepted": true, "score": 4, "last_activity_date": 1465671474, "creation_date": 1465671474, "answer_id": 37767467, "question_id": 37765687, "link": "https://stackoverflow.com/questions/37765687/golang-how-to-convert-string-to-int/37767467#37767467", "title": "Golang: How to convert string to []int?", "body": "<blockquote>\n  <p>Would you please let me know if my way is correct?</p>\n</blockquote>\n\n<p>If you just want to convert string(space separated integers) to []int</p>\n\n<pre><code>func AizuArray(A string, N string) []int {\n a := strings.Split(A, \" \")\n n, _ := strconv.Atoi(N) // int 32bit\n b := make([]int, n)\n for i, v := range a {\n     b[i], err = strconv.Atoi(v)\n     if err != nil {\n        //proper err handling\n        //either b[i] = -1 (in case positive integers)\n     }\n }\n return b\n}\n</code></pre>\n\n<p>then your approach is correct.</p>\n\n<blockquote>\n  <p>I tackle with this question.</p>\n</blockquote>\n\n<p>In context of this <a href=\"http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=ALDS1_1_A\" rel=\"nofollow\">question</a> you want to take input from STDIN so should do,</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc insertionSort(arr []int) {\n    //do further processing here.\n   fmt.Println(arr)\n}\n\nfunc main() {\n    var N int\n    fmt.Scanf(\"%d\", &amp;N)\n    b := make([]int, N)\n    for iter:=0;iter&lt;N;iter++ {\n        fmt.Scanf(\"%d\",&amp;b[iter])\n    }\n    insertionSort(b)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1044, "user_id": 786474, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2ad73e24e5f072cebb29a807b45a774e?s=128&d=identicon&r=PG", "display_name": "Carcamano", "link": "https://stackoverflow.com/users/786474/carcamano"}, "edited": false, "score": 0, "creation_date": 1603411529, "post_id": 55665684, "comment_id": 114037141, "body": "Can you use <code>int(digit - &#39;0&#39;)</code>?"}], "tags": [], "owner": {"reputation": 2945, "user_id": 5345715, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/13f05631812e06e1599ce28b59ed000c?s=128&d=identicon&r=PG&f=1", "display_name": "User12547645", "link": "https://stackoverflow.com/users/5345715/user12547645"}, "is_accepted": false, "score": 1, "last_activity_date": 1555160054, "creation_date": 1555160054, "answer_id": 55665684, "question_id": 37765687, "link": "https://stackoverflow.com/questions/37765687/golang-how-to-convert-string-to-int/55665684#55665684", "title": "Golang: How to convert string to []int?", "body": "<p>Here is a simpler example where you would not have to split the string:</p>\n\n<pre><code>str := \"123456\"\nif _, err := strconv.Atoi(str); err != nil {\n    // do stuff, in case str can not be converted to an int\n}\nvar slice []int // empty slice\nfor _, digit := range str {\n    slice = append(slice, int(digit)-int('0')) // build up slice\n}\n</code></pre>\n\n<p>Why do you need the <code>int('0')</code>? Because <code>int()</code> will convert the character to the corresponding ASCII code (<a href=\"https://www.google.com/search?q=ascii%20table&amp;newwindow=1&amp;tbm=isch&amp;source=iu&amp;ictx=1&amp;fir=Gcjw1cCFnJ60BM%253A%252CW0bMX2lmb8aQuM%252C%252Fm%252F0hb8&amp;vet=1&amp;usg=AI4_-kRJ-CZpv9PrYoPExSr8rOnQ3F2R9w&amp;sa=X&amp;ved=2ahUKEwjVkqn7jc3hAhWDZFAKHSfMC4QQ_B0wJnoECCEQBg#imgrc=uTkeCfqmL0Fz1M:&amp;vet=1\" rel=\"nofollow noreferrer\">ascii table here</a>). For 0 that would be 48. So you will have to substract 48 from whatever your digit corresponds to in \"ascii decimal\".</p>\n"}], "owner": {"reputation": 879, "user_id": 5440006, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/SAyQS.jpg?s=128&g=1", "display_name": "yamachan", "link": "https://stackoverflow.com/users/5440006/yamachan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14871, "favorite_count": 1, "accepted_answer_id": 37767467, "answer_count": 3, "score": 2, "last_activity_date": 1555160054, "creation_date": 1465660519, "question_id": 37765687, "link": "https://stackoverflow.com/questions/37765687/golang-how-to-convert-string-to-int", "title": "Golang: How to convert string to []int?", "body": "<p>I tackle with <a href=\"http://judge.u-aizu.ac.jp/onlinejudge/description.jsp?id=ALDS1_1_A\" rel=\"nofollow\">this question</a>.</p>\n\n<p>I need to convert strings to int.\nIn this case, I need to convert \"5 2 4 6 1 3\" to, for example, [6]int{5,2,4,6,1,3}.\nI wrote following this code, especially <code>AizuArray()</code>.\nIt seems elements are int <a href=\"https://ideone.com/3yersW\" rel=\"nofollow\">here</a>.\nWould you please let me know if my way is correct?\nOr could you let me know the better ways?\nI ask this because I feel my way would be redundant and <a href=\"http://judge.u-aizu.ac.jp/onlinejudge/review.jsp?rid=1841434#1\" rel=\"nofollow\">Java way</a> is much easier.\nThank you.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc AizuArray(A string, N string) []int {\n    a := strings.Split(A, \" \")\n    n, _ := strconv.Atoi(N) // int 32bit\n    b := make([]int, n)\n    for i, v := range a {\n        b[i], _ = strconv.Atoi(v)\n    }\n    return b\n}\n\nfunc main() {\n    A := \"5 2 4 6 1 3\"\n    N := \"6\"\n    j := strings.Split(A, \" \")\n    for _, v := range j {\n        fmt.Println(reflect.TypeOf(v))\n    }\n    b := AizuArray(A, N)\n    fmt.Println(b)\n    for _, v := range b {\n        fmt.Println(reflect.TypeOf(v))\n    }\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 11, "creation_date": 1465655724, "post_id": 37764900, "comment_id": 62998446, "body": "This is <b>invalid</b> json. No comments are allowed in json."}, {"owner": {"reputation": 573, "user_id": 9100468, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CmkMNlW2J6k/AAAAAAAAAAI/AAAAAAAAYbA/S66MIb_UIX0/photo.jpg?sz=128", "display_name": "Isaac Weingarten", "link": "https://stackoverflow.com/users/9100468/isaac-weingarten"}, "edited": false, "score": 0, "creation_date": 1601060197, "post_id": 37764900, "comment_id": 113297533, "body": "check out this article <a href=\"https://golangexample.com/json-with-comments-for-go/\" rel=\"nofollow noreferrer\">golangexample.com/json-with-comments-for-go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 67, "user_id": 6453722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MkOXFOijcns/AAAAAAAAAAI/AAAAAAAAABY/_AQhf__TZd0/photo.jpg?sz=128", "display_name": "Viola Rulan", "link": "https://stackoverflow.com/users/6453722/viola-rulan"}, "is_accepted": false, "score": 1, "last_activity_date": 1465667086, "creation_date": 1465667086, "answer_id": 37766799, "question_id": 37764900, "link": "https://stackoverflow.com/questions/37764900/how-to-parse-a-json-with-comments-inside/37766799#37766799", "title": "How to parse a JSON with comments inside?", "body": "<p>Yes,this is invalid JSON.</p>\n\n<p>I found a solution:</p>\n\n<pre><code>for _, v:= range s {\n    if len(strings.TrimSpace(v)) &gt; 3 {\n        if strings.TrimSpace(v)[:1] != \"/\" {\n            t = t + v\n        }\n    } else {\n        t = t + v\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3289, "user_id": 6386175, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-esfxCT4PVLI/AAAAAAAAAAI/AAAAAAAAAAw/kTn2Gre4tPk/photo.jpg?sz=128", "display_name": "Dario", "link": "https://stackoverflow.com/users/6386175/dario"}, "is_accepted": true, "score": 7, "last_activity_date": 1465758473, "creation_date": 1465758473, "answer_id": 37778086, "question_id": 37764900, "link": "https://stackoverflow.com/questions/37764900/how-to-parse-a-json-with-comments-inside/37778086#37778086", "title": "How to parse a JSON with comments inside?", "body": "<p>Strict <a href=\"http://www.ietf.org/rfc/rfc7159.txt\" rel=\"noreferrer\">JSON specification</a>, don't allow comments. </p>\n\n<p>But exist not-official superset of JSON that permits comments (and more other cool things), like <a href=\"http://json5.org/\" rel=\"noreferrer\"><strong>JSON5</strong></a> or <a href=\"https://hjson.org\" rel=\"noreferrer\"><strong>HJSON</strong></a> (human-json).</p>\n\n<p>You can try with these Go libraries:</p>\n\n<ul>\n<li>JSON5: <a href=\"https://github.com/yosuke-furukawa/json5\" rel=\"noreferrer\">https://github.com/yosuke-furukawa/json5</a></li>\n<li>HJSON: <a href=\"https://github.com/client9/xson/tree/master/hjson\" rel=\"noreferrer\">https://github.com/client9/xson/tree/master/hjson</a></li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 5230520, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efab8f8f186d1277b7fb3272bec43f57?s=128&d=identicon&r=PG&f=1", "display_name": "cathy Chou", "link": "https://stackoverflow.com/users/5230520/cathy-chou"}, "is_accepted": false, "score": 0, "last_activity_date": 1556000468, "creation_date": 1556000468, "answer_id": 55805388, "question_id": 37764900, "link": "https://stackoverflow.com/questions/37764900/how-to-parse-a-json-with-comments-inside/55805388#55805388", "title": "How to parse a JSON with comments inside?", "body": "<p>I wrote a simple json uncommenter in go that support line comment.\nuse it before unmarshal. </p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>    // f is a raw io.Reader\n    newReader := jsonuncommenter.RemoveComment(f)\n\n    jsonParser := json.NewDecoder(newReader)\n    var s seeds\n    jsonParser.Decode(&amp;s)\n</code></pre>\n\n<p><a href=\"https://github.com/wuxiangzhou2010/jsonuncommenter\" rel=\"nofollow noreferrer\">https://github.com/wuxiangzhou2010/jsonuncommenter</a></p>\n"}], "owner": {"reputation": 67, "user_id": 6453722, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-MkOXFOijcns/AAAAAAAAAAI/AAAAAAAAABY/_AQhf__TZd0/photo.jpg?sz=128", "display_name": "Viola Rulan", "link": "https://stackoverflow.com/users/6453722/viola-rulan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3657, "favorite_count": 0, "accepted_answer_id": 37778086, "answer_count": 3, "score": 1, "last_activity_date": 1556000468, "creation_date": 1465655534, "last_edit_date": 1465900150, "question_id": 37764900, "link": "https://stackoverflow.com/questions/37764900/how-to-parse-a-json-with-comments-inside", "title": "How to parse a JSON with comments inside?", "body": "<p>In <code>go</code> the standard package <a href=\"https://golang.org/pkg/encoding/json/\" rel=\"nofollow\">encoding/json</a> exposes <code>json.Unmarshal</code> function to parse JSON.</p>\n\n<p>I have a JSON like this:</p>\n\n<pre><code>{\n    ...\n    \"tyo\": {\n        \"ping_only\": true,\n        \"addresses\": [\n            //\"155.133.245.25:27015-27050\",\n            //\"155.133.245.26:27015-27050\",\n            //\"155.133.245.27:27015-27050\",\n            \"45.121.186.20:27015-27016\",\n            \"45.121.186.21:27015-27016\"\n        ]\n    },\n    \"vie\": {\n        \"addresses\": [\n            \"185.25.182.225:27015-27050\",\n            \"185.25.182.226:27015-27050\"\n        ]\n    },\n    ...\n}\n</code></pre>\n\n<p>When I use <code>json.Unmarshal</code> I got error:</p>\n\n<blockquote>\n  <p>Handler crashed with error invalid character '/' looking for beginning of value</p>\n</blockquote>\n\n<p>Can someone tell me how to parse this?</p>\n"}, {"tags": ["google-app-engine", "go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1465641650, "creation_date": 1465641650, "answer_id": 37762753, "question_id": 37762384, "link": "https://stackoverflow.com/questions/37762384/cross-platform-go-code-for-appengine/37762753#37762753", "title": "Cross platform go code for appengine", "body": "<p>You could get some clues in the <a href=\"https://github.com/golang/appengine\" rel=\"nofollow\"><code>golang/appengine</code></a> project itself.</p>\n\n<p>For instance, its <a href=\"https://github.com/golang/appengine/blob/12d5545dc1cfa6047a286d5e853841b6471f4c19/remote_api/client.go#L30-L67\" rel=\"nofollow\"><code>remote_api/client.go</code></a> provides the client for connecting remotely to a user's production application.</p>\n"}, {"comments": [{"owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "edited": false, "score": 0, "creation_date": 1465697337, "post_id": 37763591, "comment_id": 63008744, "body": "You went above and beyond for that answer by including the examples. I was unaware of the ability to use <code>&#47;&#47; +build</code>. Thanks so much."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1465711939, "last_edit_date": 1592644375, "creation_date": 1465647266, "answer_id": 37763591, "question_id": 37762384, "link": "https://stackoverflow.com/questions/37762384/cross-platform-go-code-for-appengine/37763591#37763591", "title": "Cross platform go code for appengine", "body": "<p>If you have some code which works both on local machine and on AppEngine environment, you have nothing to do.</p>\n<p>If you need to do something which should or must be done differently on AppEngine, then you need to detect the environment and write different code for the different environments.</p>\n<p>This detection and code selection is easiest done using <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">build constraints</a>. You can put a special comment line in the beginning of your <code>.go</code> file, and it may or may not be compiled and run depending on the environment.</p>\n<p>Quoting from <a href=\"https://blog.golang.org/the-app-engine-sdk-and-workspaces-gopath\" rel=\"nofollow noreferrer\">The Go Blog: The App Engine SDK and workspaces (GOPATH)</a>:</p>\n<blockquote>\n<p>The App Engine SDK introduces a new build constraint term: <code>&quot;appengine&quot;</code>. Files that specify</p>\n<pre><code>// +build appengine\n</code></pre>\n<p>will be built by the App Engine SDK and ignored by the go tool. Conversely, files that specify</p>\n<pre><code>// +build !appengine\n</code></pre>\n<p>are ignored by the App Engine SDK, while the go tool will happily build them.</p>\n</blockquote>\n<p>So for example you can have 2 separate <code>.go</code> files, one for AppEngine and one for local (non-AppEngine) environment. Define the same function in both (with same parameter list), so no matter in which environment the code is built, the function will have one declaration. We will use this signature:</p>\n<pre><code>func GetURL(url string, r *http.Request) ([]byte, error)\n</code></pre>\n<p>Note that the 2nd parameter (<code>*http.Request</code>) is only required for the AppEngine (in order to be able to create a <code>Context</code>), so in the implementation for local env it is not used (can even be <code>nil</code>).</p>\n<p>An elegant solution can take advantage of the <a href=\"https://golang.org/pkg/net/http/#Client\" rel=\"nofollow noreferrer\"><code>http.Client</code></a> type which is available in both the standard environment and in AppEngine, and which can be used to do an HTTP GET request. An <code>http.Client</code> value can be acquired differently on AppEngine, but once we have an <code>http.Client</code> value, we can proceed the same way. So we will have a common code that receives an <code>http.Client</code> and can do the rest.</p>\n<p>Example implementation can look like this:</p>\n<p><code>url_local.go</code>:</p>\n<pre><code>// +build !appengine\n\npackage mypackage\n\nimport (\n    &quot;net/http&quot;\n)\n\nfunc GetURL(url string, r *http.Request) ([]byte, error) {\n    // Local GetURL implementation\n    return GetClient(url, &amp;http.Client{})\n}\n</code></pre>\n<p><code>url_gae.go</code>:</p>\n<pre><code>// +build appengine\n\npackage mypackage\n\nimport (\n    &quot;google.golang.org/appengine&quot;\n    &quot;google.golang.org/appengine/urlfetch&quot;\n    &quot;net/http&quot;\n)\n\nfunc GetURL(url string, r *http.Request) ([]byte, error) {\n    // Appengine GetURL implementation\n    ctx := appengine.NewContext(r)\n    c := urlfetch.Client(ctx)\n    return GetClient(url, c)\n}\n</code></pre>\n<p><code>url_common.go</code>:</p>\n<pre><code>// No build constraint: this is common code\n\npackage mypackage\n\nimport (\n    &quot;net/http&quot;\n)\n\nfunc GetClient(url string, c *http.Client) ([]byte, error) {\n    // Implementation for both local and AppEngine\n    resp, err := c.Get(url)\n    if err != nil {\n        return nil, err\n    }\n    defer resp.Body.Close()\n    body, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return nil, err\n    }\n    return body, nil\n}\n</code></pre>\n"}], "owner": {"reputation": 17696, "user_id": 84118, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/49489bce90d3514596cb1ed0ead0d0db?s=128&d=identicon&r=PG&f=1", "display_name": "Jay", "link": "https://stackoverflow.com/users/84118/jay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 80, "favorite_count": 2, "accepted_answer_id": 37763591, "answer_count": 2, "score": 2, "last_activity_date": 1465711939, "creation_date": 1465639186, "question_id": 37762384, "link": "https://stackoverflow.com/questions/37762384/cross-platform-go-code-for-appengine", "title": "Cross platform go code for appengine", "body": "<p>What is the GO appropriate way to create a FetchUrl/GetURL function that works from the command line and works from google app engine with its custom way to fetch a url.</p>\n\n<p>I have basic code that fetches and processes some data on a URL. I want to be able to call it from code I use on my desktop, and code deployed to app engine. </p>\n\n<p>Hopefully thats clear, if not please let me know and Ill clarify.</p>\n"}, {"tags": ["sockets", "go", "tcp"], "comments": [{"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1465642460, "post_id": 37761538, "comment_id": 62994429, "body": "Maybe you would need your own loop in order to not allow fragment, as in <a href=\"https://github.com/beatgammit/arduino-tcp-server/blob/master/TCPServer.ino\" rel=\"nofollow noreferrer\">github.com/beatgammit/arduino-tcp-server/blob/master/&hellip;</a>"}, {"owner": {"reputation": 681, "user_id": 2643326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xyF3m.jpg?s=128&g=1", "display_name": "zzy", "link": "https://stackoverflow.com/users/2643326/zzy"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1465647857, "post_id": 37761538, "comment_id": 62995984, "body": "@VonC  Hello, I don&#39;t fully understand why setting the first byte as 0x81 (as mentioned in their README) could prevent fragment. My gut feeling is that this magic number could form the byte for a packet without fragmenting, but actually the packet can still be fragmented. Am I correct or do I miss anything here? Thanks!!"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1465648461, "post_id": 37761538, "comment_id": 62996155, "body": "Good question. I don&#39;t know, except section 5.7 of <a href=\"https://datatracker.ietf.org/doc/rfc6455/?include_text=1\" rel=\"nofollow noreferrer\">datatracker.ietf.org/doc/rfc6455/?include_text=1</a> has single frame examples starting with <code>0x81</code>."}, {"owner": {"reputation": 681, "user_id": 2643326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xyF3m.jpg?s=128&g=1", "display_name": "zzy", "link": "https://stackoverflow.com/users/2643326/zzy"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 0, "creation_date": 1465650484, "post_id": 37761538, "comment_id": 62996815, "body": "@VonC  Thanks! That example makes sense and perhaps fits my assumption - such byte represents unfragmented frames."}], "answers": [{"tags": [], "owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "is_accepted": true, "score": 6, "last_activity_date": 1465674188, "last_edit_date": 1495542330, "creation_date": 1465674188, "answer_id": 37767878, "question_id": 37761538, "link": "https://stackoverflow.com/questions/37761538/how-to-set-dont-fragment-flag-bit-for-tcp-packet-in-go/37767878#37767878", "title": "How to set &quot;don&#39;t fragment&quot; flag bit for TCP packet in Go?", "body": "<blockquote>\n  <p>How to set \"don't fragment\" flag bit for TCP packet in Go?</p>\n</blockquote>\n\n<p>First up you should know that TCP really doesn't like IP fragments. Most if not all major implementations avoid fragmentation for TCP segments by using path MTU discovery.</p>\n\n<p>The TL;DR is that the typical IP packet containing a TCP segment has a DF bit set. You can (and should) try this out. Here I am sniffing a few seconds of traffic between my machine and stackoverflow.com:</p>\n\n<pre><code>% tshark -w /tmp/tcp.pcap tcp and host stackoverflow.com\n&lt;wait a few seconds&gt;\n% tshark -r /tmp/tcp.pcap -T fields -e ip.flags | sort | uniq -c\n    186 0x00000002\n</code></pre>\n\n<p>0x02 means the DF bit is set. I confess in other captures I have seen the occasional TCP segment in an IP packet without a DF bit; I suspect <a href=\"https://www.ietf.org/rfc/rfc1191.txt\" rel=\"nofollow noreferrer\">rfc1191</a> has an explanation for this.</p>\n\n<hr>\n\n<p>Now back to your question,  I think there's no portable way to set the DF bit and this is a more widespread question (there isn't even a POSIX-portable way).\nThere is (likely) an escape hatch in the relevant package for your implementation under <a href=\"https://godoc.org/golang.org/x/sys\" rel=\"nofollow noreferrer\">golang.org/x/sys</a>.</p>\n\n<p>For example, on a Unix that supports <code>IP_DONTFRAG</code> such as <a href=\"http://www.freebsd.org/cgi/man.cgi?query=ip&amp;sektion=4\" rel=\"nofollow noreferrer\">FreeBSD</a> one could use <a href=\"https://godoc.org/golang.org/x/sys/unix#SetsockoptInt\" rel=\"nofollow noreferrer\"><code>unix.SetsockoptInt</code></a> and dig the relevant constant value.</p>\n\n<p>On Linux there is not <code>IP_DONTFRAG</code>, as you discovered from <a href=\"https://stackoverflow.com/questions/973439/how-to-set-the-dont-fragment-df-flag-on-a-socket\">the question you linked</a>. The workaround seems to be to use <code>IP_MTU_DISCOVER</code> which happens to be available as <a href=\"https://godoc.org/golang.org/x/sys/unix#pkg-constants\" rel=\"nofollow noreferrer\">a constant in the unix package</a>. You can use that same <code>unix.SetsockoptInt</code> to set it.</p>\n"}], "owner": {"reputation": 681, "user_id": 2643326, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xyF3m.jpg?s=128&g=1", "display_name": "zzy", "link": "https://stackoverflow.com/users/2643326/zzy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3344, "favorite_count": 1, "accepted_answer_id": 37767878, "answer_count": 1, "score": 6, "last_activity_date": 1465674188, "creation_date": 1465633115, "last_edit_date": 1495540919, "question_id": 37761538, "link": "https://stackoverflow.com/questions/37761538/how-to-set-dont-fragment-flag-bit-for-tcp-packet-in-go", "title": "How to set &quot;don&#39;t fragment&quot; flag bit for TCP packet in Go?", "body": "<p>I intend to set the \"don't fragment\" flag bit in Go, the same thing as <a href=\"https://stackoverflow.com/questions/973439/how-to-set-the-dont-fragment-df-flag-on-a-socket\">this post</a> while it is in C. I checked the <a href=\"https://golang.org/pkg/syscall/#pkg-constants\" rel=\"nofollow noreferrer\">constant list</a> but I didn't find this option. So what is the corresponding option in Go?</p>\n\n<p>Thanks in advance!</p>\n"}, {"tags": ["go", "cflags"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465643087, "post_id": 37761362, "comment_id": 62994610, "body": "If you have to edit the CFLAGS, it&#39;s likely because you&#39;re using an outdated version of Go"}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 2084248, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qCRnE.jpg?s=128&g=1", "display_name": "LB415", "link": "https://stackoverflow.com/users/2084248/lb415"}, "is_accepted": false, "score": 1, "last_activity_date": 1473808375, "creation_date": 1473808375, "answer_id": 39480297, "question_id": 37761362, "link": "https://stackoverflow.com/questions/37761362/unable-to-use-cgo-cflags/39480297#39480297", "title": "Unable to use cgo CFLAGS", "body": "<p>Likely a mistake with the include path, one tensorflow too many? Perhaps you should do </p>\n\n<pre><code>// #cgo CFLAGS: -I /home/arafat/go/src/github.com/tensorflow\n</code></pre>\n\n<p>or</p>\n\n<pre><code>#include \"core/public/tensor_c_api.h\"\n</code></pre>\n"}], "owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 870, "favorite_count": 0, "answer_count": 1, "score": 7, "last_activity_date": 1473808375, "creation_date": 1465631905, "question_id": 37761362, "link": "https://stackoverflow.com/questions/37761362/unable-to-use-cgo-cflags", "title": "Unable to use cgo CFLAGS", "body": "<p>I have manually cloned the go directory of tensorflow(a library I am working on ) in  <code>/home/arafat/go/src/github.com/tensorflow/tensorflow/tensorflow/contrib/go</code> you can take a look <a href=\"https://github.com/tensorflow/tensorflow/tree/go/tensorflow/contrib/go\">here</a>. \nI have made changes to <a href=\"https://github.com/tensorflow/tensorflow/blob/go/tensorflow/contrib/go/lib.go\">lib.go</a> as </p>\n\n<pre><code>// #cgo LDFLAGS: -ltensorflow\n// #cgo CFLAGS: -I /home/arafat/go/src/github.com/tensorflow/tensorflow\n// #cgo CXXFLAGS: -I /home/arafat/go/src/github.com/tensorflow/tensorflow -std=c++11\n</code></pre>\n\n<p>But I am getting the error </p>\n\n<pre><code># github.com/tensorflow/tensorflow/tensorflow/contrib/go\nIn file included from go/src/github.com/tensorflow/tensorflow/tensorflow/contrib/go/tf_session_helper.cc:20:0:\ngo/src/github.com/tensorflow/tensorflow/tensorflow/contrib/go/tf_session_helper.h:22:49: fatal error: tensorflow/core/public/tensor_c_api.h: No such file or directory\n #include \"tensorflow/core/public/tensor_c_api.h\"\n                                                 ^\ncompilation terminated.\n</code></pre>\n\n<p>on doing </p>\n\n<pre><code>go get github.com/tensorflow/tensorflow/tensorflow/contrib/go\n</code></pre>\n\n<p>I am not able to understand why this is not working.</p>\n"}, {"tags": ["json", "go", "interface"], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1465636393, "post_id": 37761536, "comment_id": 62992636, "body": "I have a question about defining a struct and extracting the json into it. If I were to have some json looking like: { &quot;name&quot;: &quot;Jimmy&quot;, &quot;traits&quot;: { &quot;age&quot;: 23, &quot;gender&quot;: 0 } } ... How would I define the values &quot;age&quot; and &quot;gender&quot; in a struct? Here is a base of where you can work from to answer my question: <a href=\"https://play.golang.org/p/TyXbrFAtGo\" rel=\"nofollow noreferrer\">play.golang.org/p/TyXbrFAtGo</a>"}, {"owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 1, "creation_date": 1465636705, "post_id": 37761536, "comment_id": 62992711, "body": "Make a nested struct <code>Traits</code> which contains <code>age</code> and <code>gender</code>. Also, read the documentation of the <a href=\"https://godoc.org/encoding/json#Marshal\" rel=\"nofollow noreferrer\">encoding/json</a> package"}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 1, "creation_date": 1465637147, "post_id": 37761536, "comment_id": 62992849, "body": "Thank you for such a quick reply. For anyone who is interested, here is how I solved my problem: <a href=\"https://play.golang.org/p/mq5XL47msM\" rel=\"nofollow noreferrer\">play.golang.org/p/mq5XL47msM</a>"}], "tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 2, "last_activity_date": 1579027107, "last_edit_date": 1579027107, "creation_date": 1465633104, "answer_id": 37761536, "question_id": 37761312, "link": "https://stackoverflow.com/questions/37761312/golang-check-if-interface-type-is-nil/37761536#37761536", "title": "Golang check if interface type is nil", "body": "<p>Check if the key exist instead of letting it panic.</p>\n\n<pre><code>func keyExists(decoded map[string]interface{}, key string) {\n    val, ok := decoded[key]\n    return ok &amp;&amp; val != nil\n}\n\nfunc main() {\n\njsonText := `{\n        \"name\": \"Jimmy\",\n        \"age\":  23\n    }`\n\n    var decoded map[string]interface{}\n\n    if err := json.Unmarshal([]byte(jsonText), &amp;decoded); err != nil {\n        fmt.Println(err)\n        os.Exit(0)\n    }\n\n    if keyExists(decoded, \"name\") {\n        fmt.Println(decoded[\"name\"].(string))\n    }\n    if keyExists(decoded, \"age\") {\n        fmt.Println(decoded[\"age\"].(float64))\n    }\n    if keyExists(decoded, \"gender\") {\n        fmt.Println(decoded[\"gender\"].(int))\n    }\n}\n</code></pre>\n\n<p>Also, this is far from being optimal if you know what your json will look like. As specified in the documentation, you can unmarshal it directly into a struct:</p>\n\n<pre><code>type Human struct {\n    Name string\n    Age int\n    Gender int\n}\n\nfunc main() {\n    jsonText := `{\n        \"name\": \"Jimmy\",\n        \"age\":  23\n    }`\n\n    decoded := Human{}\n\n    if err := json.Unmarshal([]byte(jsonText), &amp;decoded); err != nil {\n        fmt.Println(err)\n        os.Exit(0)\n    }\n\n    fmt.Println(decoded.Name)\n    fmt.Println(decoded.Age)\n    fmt.Println(decoded.Gender)\n}\n</code></pre>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6643, "favorite_count": 0, "accepted_answer_id": 37761536, "answer_count": 1, "score": 4, "last_activity_date": 1579027107, "creation_date": 1465631513, "last_edit_date": 1540378342, "question_id": 37761312, "link": "https://stackoverflow.com/questions/37761312/golang-check-if-interface-type-is-nil", "title": "Golang check if interface type is nil", "body": "<p>When unmarshalling a string of json, using Golang's <code>json.Unmarshal()</code> function, I always unmarshal the string into a <code>map[string]interface{}</code> - <em>I'm not sure weather there is a more optimal way of decoding json.</em></p>\n\n<p><strong>To get to the point:</strong> </p>\n\n<p>Sometimes the json's unmarshalled type is <code>nil</code>, not <code>string</code> (or <code>int</code> etc.). This always throws a panic, saying:</p>\n\n<blockquote>\n  <p>interface conversion: interface is nil, not int</p>\n</blockquote>\n\n<p>How can I avoid this panic or check if the interface's type is <code>nil</code> or not?</p>\n\n<p><strong>Example:</strong></p>\n\n<p>Here is an example of my problem in action: <a href=\"https://play.golang.org/p/0ATzXBbdoS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/0ATzXBbdoS</a></p>\n"}, {"tags": ["git", "go"], "comments": [{"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 0, "creation_date": 1465626386, "post_id": 37760616, "comment_id": 62990305, "body": "Hello, You can continue on your first question. You don&#39;t need to ask an another one!"}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "reply_to_user": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 2, "creation_date": 1465626412, "post_id": 37760616, "comment_id": 62990313, "body": "I am new to this website and I was told to ask a new question by the person who answered my previous question. At Least read the question and answer before downvoting."}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "reply_to_user": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "edited": false, "score": 2, "creation_date": 1465630140, "post_id": 37760616, "comment_id": 62991066, "body": "@VonC I think the error has something to do with the flags here <a href=\"https://github.com/tensorflow/tensorflow/blob/go/tensorflow/contrib/go/lib.go\" rel=\"nofollow noreferrer\">github.com/tensorflow/tensorflow/blob/go/tensorflow/contrib/&zwnj;&#8203;go/&hellip;</a>"}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "reply_to_user": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 2, "creation_date": 1465630314, "post_id": 37760616, "comment_id": 62991108, "body": "When I changed -I${SRCDIR}/../../../  to  -I &quot;/home/arafat/go/src/github.com/tensorflow/tensorflow&quot;. That is the actual location of the place The error changed to ` In file included from ../../../../go/src/github.com/tensorflow/tensorflow/tensorfl&zwnj;&#8203;ow/contrib/go/tf_ses&zwnj;&#8203;sion_helper.cc:20:0: ../../../../go/src/github.com/tensorflow/tensorflow/tensorfl&zwnj;&#8203;ow/contrib/go/tf_ses&zwnj;&#8203;sion_helper.h:22:49: fatal error: tensorflow/core/public/tensor_c_api.h: No such file or directory  #include &quot;tensorflow/core/public/tensor_c_api.h&quot;                                                  ^ compilation terminated. `"}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "reply_to_user": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 2, "creation_date": 1465630339, "post_id": 37760616, "comment_id": 62991112, "body": "I think I am not really able to make the flag directory work properly."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465664463, "post_id": 37760616, "comment_id": 63001344, "body": "Updated your version of go first, so that you can at least use the SRCDIR variable."}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "edited": false, "score": 2, "creation_date": 1465711802, "post_id": 37760616, "comment_id": 63010780, "body": "I updated to go 1.4 and the same problem still persisted."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465743010, "post_id": 37760616, "comment_id": 63018609, "body": "@ArafatK Go1.4 is not supported for this. Go1.6.2 is the current version. Go1.7 is coming soon."}], "owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 219, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1465626889, "creation_date": 1465625837, "last_edit_date": 1495542756, "question_id": 37760616, "link": "https://stackoverflow.com/questions/37760616/error-on-using-go-get", "title": "Error on using Go get", "body": "<p>After managing to <code>go get</code> the <a href=\"https://github.com/tensorflow/tensorflow/\" rel=\"nofollow noreferrer\">tensorflow repo</a> (<a href=\"https://stackoverflow.com/questions/37760199/unable-to-use-go-get-properly/37760303?noredirect=1#comment62989984_37760303\">as described in my previous question</a>).</p>\n\n<p>I now have the right code in <code>$GOPATH</code> (the <a href=\"https://github.com/tensorflow/tensorflow/tree/go/tensorflow/contrib/go\" rel=\"nofollow noreferrer\">one from the go branch</a>), but the compilation now generates the error message:</p>\n\n<pre><code>can't load package: \npackage github.com/tensorflow/tensorflow/tensorflow/contrib/go:\n/home/arafat/go/src/github.com/tensorflow/tensorflow/tensorflow/contrib/go/lib.g\u200c\u200bo: \nmalformed #cgo argument: -I${SRCDIR}/../../../\n</code></pre>\n\n<p>How can I solve this compilation issue?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8174, "user_id": 620179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7956e2be899b59538fce218039e3c4dd?s=128&d=identicon&r=PG", "display_name": "Lynch", "link": "https://stackoverflow.com/users/620179/lynch"}, "edited": false, "score": 0, "creation_date": 1465622309, "post_id": 37760199, "comment_id": 62989439, "body": "the address is not found. Open it your browser and you will see. <a href=\"https://github.com/tensorflow/\" rel=\"nofollow noreferrer\">github.com/tensorflow</a>. I managed to get there: <a href=\"https://github.com/tensorflow/tensorflow/tree/master/tensorflow/contrib\" rel=\"nofollow noreferrer\">github.com/tensorflow/tensorflow/tree/master/tensorflow/cont&zwnj;&#8203;rib</a> but did not found a go subfolder."}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "reply_to_user": {"reputation": 8174, "user_id": 620179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7956e2be899b59538fce218039e3c4dd?s=128&d=identicon&r=PG", "display_name": "Lynch", "link": "https://stackoverflow.com/users/620179/lynch"}, "edited": false, "score": 2, "creation_date": 1465622481, "post_id": 37760199, "comment_id": 62989468, "body": "Maybe because of the branch <a href=\"https://github.com/tensorflow/tensorflow/tree/go/tensorflow/contrib/go\" rel=\"nofollow noreferrer\">github.com/tensorflow/tensorflow/tree/go/tensorflow/contrib/&zwnj;&#8203;go</a>"}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "reply_to_user": {"reputation": 8174, "user_id": 620179, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7956e2be899b59538fce218039e3c4dd?s=128&d=identicon&r=PG", "display_name": "Lynch", "link": "https://stackoverflow.com/users/620179/lynch"}, "edited": false, "score": 2, "creation_date": 1465622796, "post_id": 37760199, "comment_id": 62989537, "body": "Also the error message seems really weird."}], "answers": [{"comments": [{"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "edited": false, "score": 2, "creation_date": 1465623652, "post_id": 37760303, "comment_id": 62989741, "body": "I am getting the error <code>can&#39;t load package: package github.com&#47;tensorflow&#47;tensorflow&#47;tensorflow&#47;contrib&#47;go: &#47;home&#47;arafat&#47;go&#47;src&#47;github.com&#47;tensorflow&#47;tensorflow&#47;tensorf&zwnj;&#8203;low&#47;contrib&#47;go&#47;lib.g&zwnj;&#8203;o: malformed #cgo argument: -I${SRCDIR}&#47;..&#47;..&#47;..&#47;</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "edited": false, "score": 0, "creation_date": 1465623737, "post_id": 37760303, "comment_id": 62989758, "body": "@ArafatK That is different. Now it finds the package, which was the initial question. Ie <code>go get</code> works. Let me check if there are any additional step in order to enable the compilation."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "edited": false, "score": 0, "creation_date": 1465624043, "post_id": 37760303, "comment_id": 62989833, "body": "@ArafatK I didn&#39;t see any issue on that error message in the GitHub repo. Maybe SRCDIR is not correctly set?"}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "edited": false, "score": 3, "creation_date": 1465624695, "post_id": 37760303, "comment_id": 62989974, "body": "I am not sure how to resolve that can you please elaborate. It would be a great help."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "edited": false, "score": 0, "creation_date": 1465624750, "post_id": 37760303, "comment_id": 62989984, "body": "@ArafatK I am not sure either: I was answering your original question. You could ask a new one, with that new error message more visible."}, {"owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "edited": false, "score": 2, "creation_date": 1465625897, "post_id": 37760303, "comment_id": 62990213, "body": "I posted a new question"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "edited": false, "score": 0, "creation_date": 1465626714, "post_id": 37760303, "comment_id": 62990372, "body": "@ArafatK OK. Don&#39;t forget to mark this one as resolved: <a href=\"http://stackoverflow.com/help/accepted-answer\">stackoverflow.com/help/accepted-answer</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 1, "last_activity_date": 1465623087, "creation_date": 1465623087, "answer_id": 37760303, "question_id": 37760199, "link": "https://stackoverflow.com/questions/37760199/unable-to-use-go-get-properly/37760303#37760303", "title": "Unable to use Go get properly", "body": "<p>If the code to compile and install is <em>not</em> in the <code>master</code> branch (checked out by default by the <code>go get</code>), but <a href=\"https://github.com/tensorflow/tensorflow/tree/go/tensorflow/contrib/go\" rel=\"nofollow\">only in the <code>go</code> branch of that repo</a>, try and:</p>\n\n<pre><code>cd $GOPATH/github.com/tensorflow/tensorflow\ngit checkout go\n</code></pre>\n\n<p>Then try again the compilation.</p>\n"}], "owner": {"reputation": 700, "user_id": 5668464, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/caaa9a33119f603eebf2ace9844c61c2?s=128&d=identicon&r=PG&f=1", "display_name": "ArafatK", "link": "https://stackoverflow.com/users/5668464/arafatk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 200, "favorite_count": 1, "accepted_answer_id": 37760303, "answer_count": 1, "score": 3, "last_activity_date": 1465623087, "creation_date": 1465622142, "question_id": 37760199, "link": "https://stackoverflow.com/questions/37760199/unable-to-use-go-get-properly", "title": "Unable to use Go get properly", "body": "<p>I am a new user to go and I am trying this command.</p>\n\n<pre><code>go get github.com/tensorflow/tensorflow/tensorflow/contrib/go\n</code></pre>\n\n<p>And I am getting this error </p>\n\n<pre><code>package github.com/tensorflow/tensorflow/tensorflow/contrib/go\n    imports github.com/tensorflow/tensorflow/tensorflow/contrib/go\n    imports github.com/tensorflow/tensorflow/tensorflow/contrib/go: cannot find package \"github.com/tensorflow/tensorflow/tensorflow/contrib/go\" in any of:\n    /usr/lib/go/src/pkg/github.com/tensorflow/tensorflow/tensorflow/contrib/go (from $GOROOT)\n    /home/arafat/go/src/github.com/tensorflow/tensorflow/tensorflow/contrib/go (from $GOPATH)\n</code></pre>\n\n<p>I know this seems to be a trivial issue but I am stuck at it.</p>\n"}, {"tags": ["json", "go", "interface", "marshalling"], "comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "edited": false, "score": 0, "creation_date": 1465623373, "post_id": 37760037, "comment_id": 62989669, "body": "Interesting question, I see merit for both sides of the argument."}], "owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 41, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465620964, "creation_date": 1465620662, "last_edit_date": 1465620964, "question_id": 37760037, "link": "https://stackoverflow.com/questions/37760037/json-encoding-a-zero-value-embedded-json-marshaler-panics-would-you-consider-th", "title": "JSON encoding a zero value embedded json.Marshaler panics, would you consider this a bug?", "body": "<pre><code>json.NewEncoder(os.Stdout).Encode(struct {\n    M json.Marshaler\n}{})\n</code></pre>\n\n<p>panics:</p>\n\n<pre><code>panic: interface conversion: interface is nil, not json.Marshaler \n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Vur0JJq6SF\" rel=\"nofollow\">https://play.golang.org/p/Vur0JJq6SF</a></p>\n\n<p>I'd like to explicitly state for my interface that it should marshal itself:</p>\n\n<pre><code>type thing interface {\n    json.Marshaler\n    Type() string\n    ....\n}\n</code></pre>\n\n<p>would you consider this a bug? If no, why not?</p>\n"}, {"tags": ["json", "elasticsearch", "go"], "answers": [{"tags": [], "owner": {"reputation": 1216, "user_id": 6248842, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/84403e264482ffd6f4ac8c8eee99f122?s=128&d=identicon&r=PG", "display_name": "Darigaaz", "link": "https://stackoverflow.com/users/6248842/darigaaz"}, "is_accepted": true, "score": 3, "last_activity_date": 1465618429, "last_edit_date": 1465618429, "creation_date": 1465617721, "answer_id": 37759782, "question_id": 37759697, "link": "https://stackoverflow.com/questions/37759697/go-how-do-i-turn-response-body-into-request-body/37759782#37759782", "title": "Go: How do I turn response body into request body?", "body": "<p>I am not really sure what are you trying to achive, but may be it help.</p>\n\n<pre><code>bodyBytes, err := ioutil.ReadAll(resp.Body)\nreader := bytes.NewReader(bodyBytes)\nhttp.Post(\"https://httpbin.org/post\", \"application/json; charset=utf-8\", reader)\n\n//or you can do it directly\n//http.Post(\"https://httpbin.org/post\", \"application/json; charset=utf-8\", resp.Body)\n</code></pre>\n"}], "owner": {"reputation": 754, "user_id": 4379762, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/d6e0a911a9fe018db744b4565f3dfc6d?s=128&d=identicon&r=PG&f=1", "display_name": "eriel marimon", "link": "https://stackoverflow.com/users/4379762/eriel-marimon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 61, "favorite_count": 0, "accepted_answer_id": 37759782, "answer_count": 1, "score": 0, "last_activity_date": 1465618429, "creation_date": 1465616720, "question_id": 37759697, "link": "https://stackoverflow.com/questions/37759697/go-how-do-i-turn-response-body-into-request-body", "title": "Go: How do I turn response body into request body?", "body": "<p>I have a handler that makes a request to elasticsearch.\nI cat get the json response from that request:</p>\n\n<pre><code>resp, err := http.Get(getUrl)\ndefer resp.Body.Close()\nbodyString := \"\"\nif resp.StatusCode == 200{\n    bodyBytes, err := ioutil.ReadAll(resp.Body) \n    checkForError(err)\n       bodyString = string(bodyBytes)\n\n       fmt.Fprintf(w, bodyString)\n}\n</code></pre>\n\n<p>How do I turn that <code>bodyString</code> into something I can pass to an http.Post of this sort:</p>\n\n<pre><code>http.Post(\"https://httpbin.org/post\", \"application/json; charset=utf-8\", jsonData)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "edited": false, "score": 0, "creation_date": 1465613718, "post_id": 37759462, "comment_id": 62988231, "body": "do you want to serve the entire directory or specific file?"}, {"owner": {"reputation": 911, "user_id": 4728636, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yQ2Rl.jpg?s=128&g=1", "display_name": "anonrose", "link": "https://stackoverflow.com/users/4728636/anonrose"}, "reply_to_user": {"reputation": 3964, "user_id": 5288071, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/hdcFK.png?s=128&g=1", "display_name": "zola", "link": "https://stackoverflow.com/users/5288071/zola"}, "edited": false, "score": 0, "creation_date": 1465616231, "post_id": 37759462, "comment_id": 62988532, "body": "@zola the entire directory."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1465619571, "post_id": 37759462, "comment_id": 62988990, "body": "ive used <a href=\"https://github.com/gin-gonic/contrib/blob/master/static/static_test.go#L36\" rel=\"nofollow noreferrer\">gin&#39;s static middleware</a> but i have never tried updating what is being served at runtime (only useful for making the files available, not downloading as a batch)"}], "answers": [{"tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": 0, "last_activity_date": 1465615818, "creation_date": 1465615818, "answer_id": 37759643, "question_id": 37759462, "link": "https://stackoverflow.com/questions/37759462/how-to-serve-a-created-directory-to-a-user/37759643#37759643", "title": "How to serve a created directory to a user?", "body": "<p>This isn't a Golang specific question or answer but the best solution would be to compress the folder into an archive and have your users download that.</p>\n"}], "owner": {"reputation": 911, "user_id": 4728636, "user_type": "registered", "accept_rate": 0, "profile_image": "https://i.stack.imgur.com/yQ2Rl.jpg?s=128&g=1", "display_name": "anonrose", "link": "https://stackoverflow.com/users/4728636/anonrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 35, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1465615818, "creation_date": 1465613305, "question_id": 37759462, "link": "https://stackoverflow.com/questions/37759462/how-to-serve-a-created-directory-to-a-user", "title": "How to serve a created directory to a user?", "body": "<p>How do I serve up a directory that is created server side to a user for them to download it? The directory doesn't just contain files, but sub directories as well. </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": true, "score": 1, "last_activity_date": 1465622687, "last_edit_date": 1465622687, "creation_date": 1465616024, "answer_id": 37759649, "question_id": 37759408, "link": "https://stackoverflow.com/questions/37759408/printing-all-values-of-a-struct-with-mixed-values/37759649#37759649", "title": "Printing all values of a struct with mixed values?", "body": "<p>There's no fmt verb you could use for that functionality. You could implement <a href=\"https://golang.org/pkg/fmt/#Stringer\" rel=\"nofollow\">Stringer</a> on your struct and have full control over how the struct is printed.</p>\n"}], "owner": {"reputation": 23, "user_id": 6452362, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2618aa18bbd00b633f7118f686245833?s=128&d=identicon&r=PG&f=1", "display_name": "user 13145131541", "link": "https://stackoverflow.com/users/6452362/user-13145131541"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 0, "accepted_answer_id": 37759649, "answer_count": 1, "score": 2, "last_activity_date": 1465622687, "creation_date": 1465612681, "question_id": 37759408, "link": "https://stackoverflow.com/questions/37759408/printing-all-values-of-a-struct-with-mixed-values", "title": "Printing all values of a struct with mixed values?", "body": "<p>Is there any way of printing a struct with mixed value types, including pointer types, such that all value are shown? For example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype test struct {\n  Str string\n  Ptr *string\n}\n\nfunc main() {\n  s := \"some string\"\n  p := &amp;s\n\n  t := test{\n     Str: s,\n     Ptr: p,\n  }\n\n  fmt.Printf(\"%#v\\n\", t)\n}\n</code></pre>\n\n<p>I want something like: <code>main.test{Str:\"some string\", Ptr:(*string)(\"some string\"}</code><br>\ninstead of: <code>main.test{Str:\"some string\", Ptr:(*string)(0x1040a120)}</code> </p>\n\n<p><a href=\"https://play.golang.org/p/YkZrPOeQ_Y\" rel=\"nofollow\">https://play.golang.org/p/YkZrPOeQ_Y</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "is_accepted": false, "score": 3, "last_activity_date": 1465606333, "creation_date": 1465606333, "answer_id": 37758924, "question_id": 37758699, "link": "https://stackoverflow.com/questions/37758699/why-is-reflection-working-with-unexported-struct-and-unexported-fields/37758924#37758924", "title": "Why is reflection working with UNEXPORTED Struct and Unexported Fields?", "body": "<p>From: <a href=\"https://blog.golang.org/laws-of-reflection\" rel=\"nofollow\">https://blog.golang.org/laws-of-reflection</a></p>\n\n<blockquote>\n  <p>the field names of T are upper case (exported) because only exported fields of a struct are settable.\"</p>\n</blockquote>\n\n<p>This easily shows and proves the concept:</p>\n\n<pre><code>fmt.Printf(\"can set 'last'? %v; can set 'Id'? %v\",\n    reflect.ValueOf(&amp;dish{}).Elem().FieldByName(\"last\").CanSet(),\n    reflect.ValueOf(&amp;dish{}).Elem().FieldByName(\"Id\").CanSet(),\n)\n</code></pre>\n\n<p>This prints: <code>can set 'last'? false; can set 'Id'? true</code></p>\n\n<p>On the visibility of the type (struct) name (\"dish\" vs \"Dish\") that only affects the visibility when you directly use the type at compile time.  For example:</p>\n\n<pre><code>import \"whatever/something\"\n...\nv := something.someStruct{} // will give compile error\n...\n// this can return an instance of someStruct, which can be inspected\n// with reflect just like any other struct (and that works fine because\n// we haven't directly put a literal \"something.someStruct\" in this code\nv := something.SomeFunc()\n</code></pre>\n"}], "owner": {"reputation": 171, "user_id": 2533972, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/8c8d9c2ef759224739138d5095f0170a?s=128&d=identicon&r=PG", "display_name": "Godfather", "link": "https://stackoverflow.com/users/2533972/godfather"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3437, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1465606333, "creation_date": 1465603692, "question_id": 37758699, "link": "https://stackoverflow.com/questions/37758699/why-is-reflection-working-with-unexported-struct-and-unexported-fields", "title": "Why is reflection working with UNEXPORTED Struct and Unexported Fields?", "body": "<p>I expected in code to Work with struct <strong>Dish</strong> was EXPORTED as Dish.\nI expected the program to fail when a structure <strong>dish</strong> was unexported and not see the unexported field within it. (OK, I could see the unexported field being present in an EXPORTED STRUCTURE, but even that seems wrong). </p>\n\n<p>But program still works as shown?? How can the reflection package see 'dish' if it is unexported?</p>\n\n<p>--------------Program Follows----------\n    //Modified Example From blog:   <a href=\"http://merbist.com/2011/06/27/golang-reflection-exampl/\" rel=\"nofollow\">http://merbist.com/2011/06/27/golang-reflection-exampl/</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc main() {\n    // iterate through the attributes of a Data Model instance\n    for name, mtype := range attributes(&amp;dish{}) {\n        fmt.Printf(\"Name:  %s,  Type:  %s\\n\", name, mtype)\n    }\n}\n\n// Data Model\ntype dish struct {\n    Id     int\n    last   string\n    Name   string\n    Origin string\n    Query  func()\n}\n\n// Example of how to use Go's reflection\n// Print the attributes of a Data Model\nfunc attributes(m interface{}) map[string]reflect.Type {\n    typ := reflect.TypeOf(m)\n    // if a pointer to a struct is passed, get the type of the dereferenced object\n    if typ.Kind() == reflect.Ptr {\n        typ = typ.Elem()\n    }\n\n    // create an attribute data structure as a map of types keyed by a string.\n    attrs := make(map[string]reflect.Type)\n    // Only structs are supported so return an empty result if the passed object\n    // isn't a struct\n    if typ.Kind() != reflect.Struct {\n        fmt.Printf(\"%v type can't have attributes inspected\\n\", typ.Kind())\n        return attrs\n    }\n\n    // loop through the struct's fields and set the map\n    for i := 0; i &lt; typ.NumField(); i++ {\n        p := typ.Field(i)\n        fmt.Println(\"P = \", p)\n        if !p.Anonymous {\n            attrs[p.Name] = p.Type\n        }\n    }\n\n    return attrs\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465600321, "post_id": 37758267, "comment_id": 62986000, "body": "I believe the value you&#39;re looking at is hex. If you know the formula for floating point representations (more info here <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/IEEE_floating_point</a>) then you could in theory apply it to that value and it would give you 4."}], "answers": [{"tags": [], "owner": {"reputation": 12067, "user_id": 499466, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3cc0612ec9a2b6af96500cc6e4bfdc7c?s=128&d=identicon&r=PG", "display_name": "JensG", "link": "https://stackoverflow.com/users/499466/jensg"}, "is_accepted": false, "score": 2, "last_activity_date": 1465601764, "last_edit_date": 1465601764, "creation_date": 1465600161, "answer_id": 37758307, "question_id": 37758267, "link": "https://stackoverflow.com/questions/37758267/golang-float64bits/37758307#37758307", "title": "Golang Float64bits", "body": "<p>As the <a href=\"https://golang.org/src/math/unsafe.go\" rel=\"nofollow\">documentation</a> says,  the function just interprets the data that form the float as uint64.</p>\n\n<p>An <a href=\"http://steve.hollasch.net/cgindex/coding/ieeefloat.html\" rel=\"nofollow\">IEEE 754 double</a> has this bit layout:</p>\n\n<pre><code>SEEEEEEE EEEEMMMM MMMMMMMM MMMMMMMM MMMMMMMM MMMMMMMM MMMMMMMM MMMMMMMM\n</code></pre>\n\n<p>These are 64 bits consisting of:</p>\n\n<ul>\n<li>one sign bit <code>S</code></li>\n<li>exponent bits <code>E</code> </li>\n<li>mantissa bits <code>M</code></li>\n</ul>\n\n<p>The value <code>4.0</code> equals this bit representation:</p>\n\n<pre><code>01000000 00010000 00000000 00000000 00000000 00000000 00000000 00000000\n</code></pre>\n\n<p>An detailed explanation why is looks this way would be too lengthy. There are some special rules regarding the mantissa which play a key role here. We can just ignore that for now, please see the linked doc if you are interested in all the dirty details of how numbers are represented in IEEE float format. </p>\n\n<p>The above function does nothing else as treating these 64 bits as if they were an <code>uint64</code>. At the end this is just casting a bunch of bits that happen to fit into an <code>uint64</code>. Hence, the resulting number is totally different from the float value.</p>\n"}, {"tags": [], "owner": {"reputation": 8007, "user_id": 6336139, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yZ1gA.png?s=128&g=1", "display_name": "T. Claverie", "link": "https://stackoverflow.com/users/6336139/t-claverie"}, "is_accepted": true, "score": 3, "last_activity_date": 1465601470, "creation_date": 1465601470, "answer_id": 37758465, "question_id": 37758267, "link": "https://stackoverflow.com/questions/37758267/golang-float64bits/37758465#37758465", "title": "Golang Float64bits", "body": "<p>From the documentation, it converts the <code>float64</code> into an <code>uint64</code> without changing the bits, it's the way the bits are interpreted that change.</p>\n\n<p>Here is the full source code of the <code>Float64bits</code> function:</p>\n\n<pre><code>func Float64bits(f float64) uint64 { return *(*uint64)(unsafe.Pointer(&amp;f)) }\n</code></pre>\n\n<p>Don't be scared by that syntax trick of using an unsafe Pointer, it's quite common in Go's source code (avoids copying the data). So, that really is that simple: take the binary data of the given float and interpret it as an unsigned integer.</p>\n\n<p>The reason it changes so much is because of the representation of floating point numbers. According to the specification, a floating point number is composed of a Sign, an Exponent and a Mantissa.</p>\n\n<p>On a 64 bits float, there is 1 bit for the Sign, 11 bits for the exponent and 52 bits for the mantissa.</p>\n\n<p>The representation of 4 as a floating point number on 64 bits is:</p>\n\n<pre><code>0b0100 0000 0001 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000 0000\n  SEEE EEEE EEEE MMMM MMMM MMMM MMMM MMMM MMMM MMMM MMMM MMMM MMMM MMMM MMMM MMMM\n</code></pre>\n\n<p>It turns out that this value is 4616189618054758400 if interpreted as an unsigned integer. You'll find plenty of great tutorials on the web regarding the IEEE754 to understand fully how the above value is a representation of 4.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1465618209, "last_edit_date": 1495539952, "creation_date": 1465618209, "answer_id": 37759829, "question_id": 37758267, "link": "https://stackoverflow.com/questions/37758267/golang-float64bits/37759829#37759829", "title": "Golang Float64bits", "body": "<p>use %#X in fmt.Printf to format Hex value.  and %[1] to refer to the first arg  like this sample code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math\"\n\nfunc main() {\n    var x float64 = 4\n    fmt.Println(\"x =\", x)\n\n    ix := math.Float64bits(x)\n    fmt.Printf(\"bits: %#X = %[1]v %[1]T\\n\", ix)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>x = 4\nbits: 0X4010000000000000 = 4616189618054758400 uint64\n</code></pre>\n\n<p>and see:</p>\n\n<p><a href=\"https://en.wikipedia.org/wiki/Double-precision_floating-point_format\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/Double-precision_floating-point_format</a> <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"nofollow noreferrer\">https://en.wikipedia.org/wiki/IEEE_floating_point</a>  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/26120311/why-does-adding-0-1-multiple-times-remain-lossless\">Why does adding 0.1 multiple times remain lossless?</a>  </p>\n\n<p><a href=\"https://stackoverflow.com/questions/36537806/golang-what-does-b-do-in-fmt-printf-for-float64-and-what-is-min-subnormal-po\">golang: what does &quot;%b&quot; do in fmt.Printf for float64 and what is Min subnormal positive double in float64 in binary format?</a></p>\n\n<p>I hope this helps.</p>\n"}], "owner": {"reputation": 567, "user_id": 2442168, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/d37ccab219555941fa5b88bd02284a05?s=128&d=identicon&r=PG", "display_name": "smugcloud", "link": "https://stackoverflow.com/users/2442168/smugcloud"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 748, "favorite_count": 0, "accepted_answer_id": 37758465, "answer_count": 3, "score": 1, "last_activity_date": 1465618209, "creation_date": 1465599974, "question_id": 37758267, "link": "https://stackoverflow.com/questions/37758267/golang-float64bits", "title": "Golang Float64bits", "body": "<p>I'm trying to understand the Go <a href=\"https://golang.org/src/math/sqrt.go?s=3704:3732#L82\" rel=\"nofollow\">Sqrt</a> implementation and can't quite comprehend what is going on with the <code>Float64bits</code> function.  I have some test code and output below.  Why does the value of ix change so drastically with this operation?</p>\n\n<pre><code>package main\n\nimport (\"math\"\n        \"fmt\")\n\nfunc main()  {\n\n    var x float64 = 4\n    fmt.Printf(\"The value of x is: %v \\n\", x)\n\n    ix := math.Float64bits(x)\n    fmt.Printf(\"The value of ix is: %v \\n\", ix)\n    fmt.Printf(\"The type of ix is: %T \\n\", ix)\n\n}\nThe value of x is: 4 \nThe value of ix is: 4616189618054758400 \nThe type of ix is: uint64 \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1465596041, "post_id": 37757683, "comment_id": 62984764, "body": "Adding the part where you call <code>ParseInt</code> could help."}, {"owner": {"reputation": 247, "user_id": 5025966, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-5XHYjI1LoPg/AAAAAAAAAAI/AAAAAAAAHdI/mXq1G3pmhLs/photo.jpg?sz=128", "display_name": "Dennis Hein", "link": "https://stackoverflow.com/users/5025966/dennis-hein"}, "reply_to_user": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1465596287, "post_id": 37757683, "comment_id": 62984837, "body": "@cnicutar Thanks for the comment, I&#39;ve added the relevant code."}], "answers": [{"tags": [], "owner": {"reputation": 3119, "user_id": 816630, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/1142da20004b16811dc122f13ef1993f?s=128&d=identicon&r=PG", "display_name": "Josh Wilson", "link": "https://stackoverflow.com/users/816630/josh-wilson"}, "is_accepted": false, "score": 0, "last_activity_date": 1465597337, "creation_date": 1465597337, "answer_id": 37757923, "question_id": 37757683, "link": "https://stackoverflow.com/questions/37757683/parsing-integer-from-exec-command-output/37757923#37757923", "title": "Parsing integer from exec.Command output", "body": "<p>It looks like there might be some additional escaped data on that line. Try splitting by space and using that.</p>\n\n<pre><code>out, _ := exec.Command(pwd+\"/osx_fukyobrane_amd64\", \"fyb_src/\"+filename, \"fyb_src/salty.fyb\", \"t\").CombinedOutput()\nparts := strings.Split(string(out), \"\\n\")\n\nparts = strings.Split(parts, \" \")\n\nfmt.Println(parts[0])\n\nrounds, err := strconv.Atoi(strings.TrimSpace(parts[0]))\nif err != nil {\n    panic(err.Error())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 247, "user_id": 5025966, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-5XHYjI1LoPg/AAAAAAAAAAI/AAAAAAAAHdI/mXq1G3pmhLs/photo.jpg?sz=128", "display_name": "Dennis Hein", "link": "https://stackoverflow.com/users/5025966/dennis-hein"}, "edited": false, "score": 0, "creation_date": 1465598643, "post_id": 37757936, "comment_id": 62985566, "body": "Actually the last <code>\\r6</code> contains the desired number (6). Splitting <code>string(out)</code> with your regular expression yields the right string for <code>strconv.Atoi</code> at index <code>len(parts)-3</code>. I don&#39;t think I really comprehend what&#39;s going on here (I get the regular expression, but not why the string &quot;6&quot; in the terminal would be some crazy string internally). Anyways, thank you very much for your help."}, {"owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "reply_to_user": {"reputation": 247, "user_id": 5025966, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-5XHYjI1LoPg/AAAAAAAAAAI/AAAAAAAAHdI/mXq1G3pmhLs/photo.jpg?sz=128", "display_name": "Dennis Hein", "link": "https://stackoverflow.com/users/5025966/dennis-hein"}, "edited": false, "score": 0, "creation_date": 1465598714, "post_id": 37757936, "comment_id": 62985583, "body": "What is the format of the output you are trying to capture?  You say it&#39;s the &quot;6&quot;, but why?  Is it always the 6th line down? Or the last one? or what?"}, {"owner": {"reputation": 247, "user_id": 5025966, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-5XHYjI1LoPg/AAAAAAAAAAI/AAAAAAAAHdI/mXq1G3pmhLs/photo.jpg?sz=128", "display_name": "Dennis Hein", "link": "https://stackoverflow.com/users/5025966/dennis-hein"}, "edited": false, "score": 0, "creation_date": 1465599000, "post_id": 37757936, "comment_id": 62985657, "body": "The content of the first blockquote in my question is what you see in the terminal. It appears to be <code>6 \\n fyb_src&#47;ex1.fyb (1) wins!</code>, but as we have seen it is not. The error message is always <code>0 \\r1 \\r2 ...\\rn</code> where <code>n</code> is the actual number (in this case 6). So in this case it was <code>0 \\r1 \\r2 \\r3 \\r4 \\r5 \\r6</code>."}, {"owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "reply_to_user": {"reputation": 247, "user_id": 5025966, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-5XHYjI1LoPg/AAAAAAAAAAI/AAAAAAAAHdI/mXq1G3pmhLs/photo.jpg?sz=128", "display_name": "Dennis Hein", "link": "https://stackoverflow.com/users/5025966/dennis-hein"}, "edited": false, "score": 0, "creation_date": 1465604022, "post_id": 37757936, "comment_id": 62986800, "body": "Hm - I would try running the command manually from the command line and sending it to a file (e.g. <code>osx_fukyobrane_amd64 fyb_src&#47;whatever fyb_src&#47;salty.fyb t &gt; temp.out</code>) and then running hexdump on it to see exactly what bytes it&#39;s outputting, e.g. <code>hexdump -C temp.out</code>"}], "tags": [], "owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "is_accepted": true, "score": 1, "last_activity_date": 1465597413, "creation_date": 1465597413, "answer_id": 37757936, "question_id": 37757683, "link": "https://stackoverflow.com/questions/37757683/parsing-integer-from-exec-command-output/37757936#37757936", "title": "Parsing integer from exec.Command output", "body": "<p>It would appear that your problem is that <code>parts[0]</code> contains the string <code>\"0 \\r1 \\r2 \\r3 \\r4 \\r5 \\r6\"</code> instead of a number.</p>\n\n<p>The strconv.Atoi function is looking for just one number to parse - I assume you are trying to get that first \"0\" in this case.  If so, the problem is that this code: <code>strings.Split(string(out), \"\\n\")</code> is only looking for \"\\n\" not \"\\r\", which is apparently what is being returned from <code>osx_fukyobrane_amd64</code>.</p>\n\n<p>One solution would be to instead split the lines like this:</p>\n\n<pre><code>regexp.MustCompile(`[\\r\\n]+`).Split(parts[0], -1)\n</code></pre>\n\n<p>That will collapse multiple lines together into one and treat \\r, \\n, and \\r\\n (or other weird combinations) as valid line breaks.</p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 1, "last_activity_date": 1465668171, "creation_date": 1465668171, "answer_id": 37766963, "question_id": 37757683, "link": "https://stackoverflow.com/questions/37757683/parsing-integer-from-exec-command-output/37766963#37766963", "title": "Parsing integer from exec.Command output", "body": "<p>Use <a href=\"https://golang.org/pkg/strings/#Fields\" rel=\"nofollow\"><code>strings.Fields</code></a> instead of <code>Split</code>, it automagically handle <code>\\n</code> and <code>\\r</code>.</p>\n\n<p>This is also much faster than using regexp, which is considerably slow in Go, although it is getting improved.</p>\n\n<pre><code>func splitAndTrim(line string) []string {\n    out := strings.Fields(line)\n    for i, s := range out {\n        out[i] = strings.TrimSpace(s)\n    }\n    return out\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/G2QoLGABO5\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 247, "user_id": 5025966, "user_type": "registered", "accept_rate": 33, "profile_image": "https://lh5.googleusercontent.com/-5XHYjI1LoPg/AAAAAAAAAAI/AAAAAAAAHdI/mXq1G3pmhLs/photo.jpg?sz=128", "display_name": "Dennis Hein", "link": "https://stackoverflow.com/users/5025966/dennis-hein"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 711, "favorite_count": 0, "accepted_answer_id": 37757936, "answer_count": 3, "score": 0, "last_activity_date": 1465668171, "creation_date": 1465595865, "last_edit_date": 1465596256, "question_id": 37757683, "link": "https://stackoverflow.com/questions/37757683/parsing-integer-from-exec-command-output", "title": "Parsing integer from exec.Command output", "body": "<p>I'm currently trying to run a command from inside my Go program and parse an integer from the response. The command returns output like this:</p>\n\n<blockquote>\n  <p>6<br>\n  fyb_src/ex1.fyb (1) wins!</p>\n</blockquote>\n\n<p>Splitting the lines and removing the whitespace with <code>strings.Split</code> and <code>strings.TrimSpaces</code> works fine. However, while trying to parse the number into an integer I get the following error:</p>\n\n<blockquote>\n  <p>panic: strconv.ParseInt: parsing \"0          \\r1         \\r2          \\r3          \\r4          \\r5          \\r6\": invalid syntax</p>\n</blockquote>\n\n<p>But printing the string I'm trying to parse to the terminal yields the following result:</p>\n\n<blockquote>\n  <p>6</p>\n</blockquote>\n\n<p>I'm not really sure where to go from here. The number clearly looks like an integer to me. The error message isn't useful either (at least for me). Does anyone have an idea?</p>\n\n<p>EDIT: The code I'm running</p>\n\n<pre><code>    out, _ := exec.Command(pwd+\"/osx_fukyobrane_amd64\", \"fyb_src/\"+filename, \"fyb_src/salty.fyb\", \"t\").CombinedOutput()\n    parts := strings.Split(string(out), \"\\n\")\n\n    fmt.Println(parts[0])\n\n    rounds, err := strconv.Atoi(strings.TrimSpace(parts[0]))\n    if err != nil {\n        panic(err.Error())\n    }\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 1258, "user_id": 5606836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d188c6c0908205bfbaac125a962deea4?s=128&d=identicon&r=PG&f=1", "display_name": "Jerrybibo", "link": "https://stackoverflow.com/users/5606836/jerrybibo"}, "edited": false, "score": 0, "creation_date": 1465588765, "post_id": 37756236, "comment_id": 62981954, "body": "Wait, so, what&#39;s the question?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 7, "creation_date": 1465589393, "post_id": 37756236, "comment_id": 62982239, "body": "when you need to differentiate between unset and zero values, use a pointer."}, {"owner": {"reputation": 373, "user_id": 6451644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99746194ff8736e513e09dd276adcbd?s=128&d=identicon&r=PG&f=1", "display_name": "mbfrahry", "link": "https://stackoverflow.com/users/6451644/mbfrahry"}, "reply_to_user": {"reputation": 1258, "user_id": 5606836, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d188c6c0908205bfbaac125a962deea4?s=128&d=identicon&r=PG&f=1", "display_name": "Jerrybibo", "link": "https://stackoverflow.com/users/5606836/jerrybibo"}, "edited": false, "score": 0, "creation_date": 1465589408, "post_id": 37756236, "comment_id": 62982245, "body": "I added the question. Let me know if that makes sense @Jerrybibo"}, {"owner": {"reputation": 373, "user_id": 6451644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99746194ff8736e513e09dd276adcbd?s=128&d=identicon&r=PG&f=1", "display_name": "mbfrahry", "link": "https://stackoverflow.com/users/6451644/mbfrahry"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465589675, "post_id": 37756236, "comment_id": 62982356, "body": "That did it. Thanks @JimB"}], "answers": [{"comments": [{"owner": {"reputation": 166, "user_id": 8396530, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wjl6O0AG6Xk/AAAAAAAAAAI/AAAAAAAAABM/wvpCxWB0Oqk/photo.jpg?sz=128", "display_name": "IFTEKHAR I ASIF", "link": "https://stackoverflow.com/users/8396530/iftekhar-i-asif"}, "edited": false, "score": 0, "creation_date": 1575951096, "post_id": 37756476, "comment_id": 104728963, "body": "If I don&#39;t want to use some_value. Instead of it if I use <code>json:&quot;true,omitempty&quot;</code>, will it work?"}, {"owner": {"reputation": 828, "user_id": 3646020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aeca918d51e29ba37e4e2c55f9773ba1?s=128&d=identicon&r=PG&f=1", "display_name": "sabhiram", "link": "https://stackoverflow.com/users/3646020/sabhiram"}, "reply_to_user": {"reputation": 166, "user_id": 8396530, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-wjl6O0AG6Xk/AAAAAAAAAAI/AAAAAAAAABM/wvpCxWB0Oqk/photo.jpg?sz=128", "display_name": "IFTEKHAR I ASIF", "link": "https://stackoverflow.com/users/8396530/iftekhar-i-asif"}, "edited": false, "score": 0, "creation_date": 1602557714, "post_id": 37756476, "comment_id": 113750932, "body": "@IFTEKHARIASIF - the first item in the <code>json</code> tag for go is the name of the variable key in json that you are mapping the &lt;-- field to."}], "tags": [], "owner": {"reputation": 3895, "user_id": 3169754, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/sP8Pj.png?s=128&g=1", "display_name": "gavv", "link": "https://stackoverflow.com/users/3169754/gavv"}, "is_accepted": true, "score": 57, "last_activity_date": 1465589725, "last_edit_date": 1465589725, "creation_date": 1465589599, "answer_id": 37756476, "question_id": 37756236, "link": "https://stackoverflow.com/questions/37756236/json-golang-boolean-omitempty/37756476#37756476", "title": "JSON golang boolean omitempty", "body": "<p><a href=\"https://play.golang.org/p/L5rUx1BHT5\" rel=\"noreferrer\"><strong>Use pointers</strong></a></p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype SomeStruct struct {\n    SomeValue *bool `json:\"some_value,omitempty\"`\n}\n\nfunc main() {\n    t := new(bool)\n    f := new(bool)\n\n    *t = true\n    *f = false\n\n    s1, _ := json.Marshal(SomeStruct{nil})\n    s2, _ := json.Marshal(SomeStruct{t})\n    s3, _ := json.Marshal(SomeStruct{f})\n\n    fmt.Println(string(s1))\n    fmt.Println(string(s2))\n    fmt.Println(string(s3))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>{}\n{\"some_value\":true}\n{\"some_value\":false}\n</code></pre>\n"}], "owner": {"reputation": 373, "user_id": 6451644, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b99746194ff8736e513e09dd276adcbd?s=128&d=identicon&r=PG&f=1", "display_name": "mbfrahry", "link": "https://stackoverflow.com/users/6451644/mbfrahry"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 19140, "favorite_count": 8, "accepted_answer_id": 37756476, "answer_count": 1, "score": 37, "last_activity_date": 1465589725, "creation_date": 1465588628, "last_edit_date": 1465589048, "question_id": 37756236, "link": "https://stackoverflow.com/questions/37756236/json-golang-boolean-omitempty", "title": "JSON golang boolean omitempty", "body": "<p>I'm having issues with writing a golang library for an api. The json aspect of booleans is causing issues. </p>\n\n<p>Let's say the default value of a boolean is true for an api call.</p>\n\n<p>If I do </p>\n\n<pre><code>SomeValue bool `json:some_value,omitempty`\n</code></pre>\n\n<p>and I don't set the value through the library, the value will be set to true. If I set the value to false in the library, omitempty says that a false value is an empty value so the value will stay true through the api call.</p>\n\n<p>Let's take out the omitempty and have it look like this </p>\n\n<pre><code>SomeValue bool `json:some_value`\n</code></pre>\n\n<p>Now I have the opposite issue, I can set the value to false but if I don't set the value then the value will be false even though I expect it to be true. </p>\n\n<p>Edit: How do I maintain the behavior of not having to set the value to true while also being able to set the value to false?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465586708, "post_id": 37755531, "comment_id": 62980991, "body": "It downloaded the repo, and the vet command didn&#39;t exist locally in the codebase. The <code>vet</code> tool is included in the go distribution be default."}, {"owner": {"reputation": 15751, "user_id": 1345655, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2f01aca0b4d2d9347a6fd0f16f24d084?s=128&d=identicon&r=PG", "display_name": "Kshitiz Sharma", "link": "https://stackoverflow.com/users/1345655/kshitiz-sharma"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465587086, "post_id": 37755531, "comment_id": 62981177, "body": "@JimB If it&#39;s included by default, then I guess it should find it in <code>GOROOT</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465587266, "post_id": 37755531, "comment_id": 62981273, "body": "No, because the source in GOROOT has a different path. (<code>$GOROOT&#47;src&#47;cmd&#47;vet</code>), but it should already be built."}, {"owner": {"reputation": 15751, "user_id": 1345655, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2f01aca0b4d2d9347a6fd0f16f24d084?s=128&d=identicon&r=PG", "display_name": "Kshitiz Sharma", "link": "https://stackoverflow.com/users/1345655/kshitiz-sharma"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465587404, "post_id": 37755531, "comment_id": 62981345, "body": "@JimB So is there no need to install <code>vet</code> using <code>go get</code>? I&#39;m following <a href=\"https://www.wolfe.id.au/2015/03/05/using-sublime-text-for-go-development/\" rel=\"nofollow noreferrer\">this guide here</a> to install <code>gosublime</code> and it lists installing <code>vet</code> in instructions."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1465588952, "post_id": 37755531, "comment_id": 62982043, "body": "No, that guide is just out of date."}], "answers": [{"tags": [], "owner": {"reputation": 8698, "user_id": 961810, "user_type": "registered", "accept_rate": 69, "profile_image": "https://lh3.googleusercontent.com/-sx37srgARV4/AAAAAAAAAAI/AAAAAAAAAhw/XUlBN6N5Y6E/photo.jpg?sz=128", "display_name": "Brad Peabody", "link": "https://stackoverflow.com/users/961810/brad-peabody"}, "is_accepted": true, "score": 9, "last_activity_date": 1465598515, "creation_date": 1465598515, "answer_id": 37758103, "question_id": 37755531, "link": "https://stackoverflow.com/questions/37755531/cannot-install-vet-package-with-go-get/37758103#37758103", "title": "Cannot install vet package with go get", "body": "<p>@JimB summed it up in the comments - you don't need to install <code>go vet</code> separately.</p>\n\n<p>But just for completeness, the direct answer to OP question is that the code for the <code>go vet</code> command no longer lives at <code>golang.org/x/tools/cmd/vet</code> (see <a href=\"https://golang.org/doc/go1.2#go_tools_godoc\" rel=\"noreferrer\">https://golang.org/doc/go1.2#go_tools_godoc</a> - and since that the code has moved to GitHub).</p>\n\n<p>So when you run: <code>go get -u golang.org/x/tools/cmd/vet</code> it appears that it is git cloning the <code>golang.org/x/tools/cmd</code> package and then trying to compile <code>golang.org/x/tools/cmd/vet</code> which is resulting in an error (\"cannot find package...\") because the \"vet\" part doesn't exist - it moved out a while ago.  (<code>go get</code> first downloads/clones the code and then attempts to compile the package on your local system.)</p>\n\n<p>And all of that is to say, you probably already have <code>go vet</code> - try typing \"go vet -h\" and if it works (you should see something like: \"usage: vet ...\"), you're set.</p>\n"}], "owner": {"reputation": 15751, "user_id": 1345655, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/2f01aca0b4d2d9347a6fd0f16f24d084?s=128&d=identicon&r=PG", "display_name": "Kshitiz Sharma", "link": "https://stackoverflow.com/users/1345655/kshitiz-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4916, "favorite_count": 1, "accepted_answer_id": 37758103, "answer_count": 1, "score": 6, "last_activity_date": 1465598515, "creation_date": 1465585577, "question_id": 37755531, "link": "https://stackoverflow.com/questions/37755531/cannot-install-vet-package-with-go-get", "title": "Cannot install vet package with go get", "body": "<p>I'm running following command:</p>\n\n<pre><code>$ go get -u golang.org/x/tools/cmd/vet\n</code></pre>\n\n<blockquote>\n  <p>package golang.org/x/tools/cmd/vet: cannot find package\n  \"golang.org/x/tools/cmd/vet\" in any of:\n              C:\\Development\\Software\\go\\src\\golang.org\\x\\tools\\cmd\\vet (from $GOROOT)<br>\n  C:\\Development\\Software\\go\\downloaded_packages\\src\\golang.org\\x\\tools\\cmd\\vet\n  (from $GOPATH)</p>\n</blockquote>\n\n<p>I can't really understand how <code>cannot find package</code> makes sense with <code>get</code>. It is supposed to get the package from internet. Why is it looking for it locally?</p>\n"}, {"tags": ["c#", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465586408, "post_id": 37755484, "comment_id": 62980848, "body": "When you&#39;re invoking a process, you can read it&#39;s output in your C# code. There are probably numerous examples on SO. I&#39;m not aware of any interop between Go and C#/the CLR though it wouldn&#39;t surprise me if there&#39;s one out there."}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465586457, "post_id": 37755484, "comment_id": 62980866, "body": "@evan Well, didn&#39;t know that. Thanks. But I&#39;ll still prefer an API though :)"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1465586574, "post_id": 37755484, "comment_id": 62980930, "body": "Just based of a quick Google search I don&#39;t think you&#39;re going to be finding any API for Go - C# interop."}, {"owner": {"reputation": 6778, "user_id": 2023861, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a45c405990aa8f4b4b0877f3423ba5bd?s=128&d=identicon&r=PG", "display_name": "user2023861", "link": "https://stackoverflow.com/users/2023861/user2023861"}, "edited": false, "score": 0, "creation_date": 1465586814, "post_id": 37755484, "comment_id": 62981049, "body": "Can you use the Tardis Go Transpiler? <a href=\"https://tardisgo.github.io/\" rel=\"nofollow noreferrer\">tardisgo.github.io</a>  (Disclaimer: I have no Go experience)"}, {"owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "reply_to_user": {"reputation": 6778, "user_id": 2023861, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/a45c405990aa8f4b4b0877f3423ba5bd?s=128&d=identicon&r=PG", "display_name": "user2023861", "link": "https://stackoverflow.com/users/2023861/user2023861"}, "edited": false, "score": 0, "creation_date": 1465587339, "post_id": 37755484, "comment_id": 62981311, "body": "@user2023861 yeah, I guess I could. Thanks"}], "answers": [{"comments": [{"owner": {"reputation": 4023, "user_id": 1639347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToOjW.png?s=128&g=1", "display_name": "cahit beyaz", "link": "https://stackoverflow.com/users/1639347/cahit-beyaz"}, "edited": false, "score": 9, "creation_date": 1506598289, "post_id": 37755868, "comment_id": 79890882, "body": "this question is not true anymore. go now can be dynamically build and can be called from languages like c, c++,c# etc.."}, {"owner": {"reputation": 1954, "user_id": 667580, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/3388c175dfb30626acd20517f825ac69?s=128&d=identicon&r=PG", "display_name": "FLCL", "link": "https://stackoverflow.com/users/667580/flcl"}, "reply_to_user": {"reputation": 4023, "user_id": 1639347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToOjW.png?s=128&g=1", "display_name": "cahit beyaz", "link": "https://stackoverflow.com/users/1639347/cahit-beyaz"}, "edited": false, "score": 2, "creation_date": 1515854068, "post_id": 37755868, "comment_id": 83463954, "body": "@cahitbeyaz could you add some links how to run golang code with taking into account CLR security constrains?"}, {"owner": {"reputation": 2804, "user_id": 2326753, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/tzfnK.png?s=128&g=1", "display_name": "C4d", "link": "https://stackoverflow.com/users/2326753/c4d"}, "reply_to_user": {"reputation": 4023, "user_id": 1639347, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ToOjW.png?s=128&g=1", "display_name": "cahit beyaz", "link": "https://stackoverflow.com/users/1639347/cahit-beyaz"}, "edited": false, "score": 0, "creation_date": 1526975842, "post_id": 37755868, "comment_id": 87938124, "body": "@cahitbeyaz still can&#39;t find anything about it."}], "tags": [], "owner": {"reputation": 6841, "user_id": 3960399, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/c5OVT.jpg?s=128&g=1", "display_name": "Frank Bryce", "link": "https://stackoverflow.com/users/3960399/frank-bryce"}, "is_accepted": true, "score": 4, "last_activity_date": 1591289327, "last_edit_date": 1591289327, "creation_date": 1465587065, "answer_id": 37755868, "question_id": 37755484, "link": "https://stackoverflow.com/questions/37755484/how-to-execute-go-function-in-c/37755868#37755868", "title": "How to execute Go function in C#", "body": "<p>EDIT: my answer is now not true, since Go has been updated since I posted.  <a href=\"https://stackoverflow.com/a/19919835/3960399\">this stackoverflow thread</a> will help you solve your problem.</p>\n\n<p>ORIGINAL ANSWER:</p>\n\n<p>I don't think you're going to have much luck finding what you're looking for.  <a href=\"https://stackoverflow.com/questions/13720425/can-go-code-generate-dll-in-windows-or-can-c-c-call-golang-code\">Go is statically linked</a> and <a href=\"https://stackoverflow.com/questions/729562/how-to-compile-c-sharp-application-with-c-static-library\">C# doesn't support that</a>.</p>\n\n<p>From C#, <a href=\"https://stackoverflow.com/questions/206323/how-to-execute-command-line-in-c-get-std-out-results\">calling a pre-compiled executable and reading the output</a> is the easiest thing I can think of.</p>\n"}, {"comments": [{"owner": {"reputation": 139, "user_id": 7924504, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-_WC7QUeJAX4/AAAAAAAAAAI/AAAAAAAAACg/to31yfYVfI4/photo.jpg?sz=128", "display_name": "Flavien Marianacci", "link": "https://stackoverflow.com/users/7924504/flavien-marianacci"}, "edited": false, "score": 0, "creation_date": 1589105861, "post_id": 50225450, "comment_id": 109155522, "body": "link is deprecated, this thread might help <a href=\"https://stackoverflow.com/questions/19431296/building-and-linking-dynamically-from-a-go-binary\" title=\"building and linking dynamically from a go binary\">stackoverflow.com/questions/19431296/&hellip;</a>"}], "tags": [], "owner": {"reputation": 121, "user_id": 3150602, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab3ac12c4c86d0cc08fa6eea237b245?s=128&d=identicon&r=PG&f=1", "display_name": "nathan.xu", "link": "https://stackoverflow.com/users/3150602/nathan-xu"}, "is_accepted": false, "score": 5, "last_activity_date": 1525750758, "creation_date": 1525750758, "answer_id": 50225450, "question_id": 37755484, "link": "https://stackoverflow.com/questions/37755484/how-to-execute-go-function-in-c/50225450#50225450", "title": "How to execute Go function in C#", "body": "<p>I think Frank's answer is not right! Golang supports many build mode, and one is c-shared mode, it means you can use it like a c module.\ne.g:\n<a href=\"https://www.trs.ai/c%E8%B0%83%E7%94%A8golang%E4%BB%A3%E7%A0%81/\" rel=\"noreferrer\">https://www.trs.ai/c%E8%B0%83%E7%94%A8golang%E4%BB%A3%E7%A0%81/</a></p>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 6249688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/465ae66ea36ea277d33528789e9cab3d?s=128&d=identicon&r=PG&f=1", "display_name": "Blue Joy", "link": "https://stackoverflow.com/users/6249688/blue-joy"}, "is_accepted": false, "score": 0, "last_activity_date": 1525832734, "creation_date": 1525832734, "answer_id": 50244656, "question_id": 37755484, "link": "https://stackoverflow.com/questions/37755484/how-to-execute-go-function-in-c/50244656#50244656", "title": "How to execute Go function in C#", "body": "<p>you can use <a href=\"https://grpc.io/\" rel=\"nofollow noreferrer\">grpc</a> implement calls<br>\ngrpc works across languages and platforms</p>\n"}], "owner": {"reputation": 42370, "user_id": 3980929, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/xyKrD.png?s=128&g=1", "display_name": "Rakete1111", "link": "https://stackoverflow.com/users/3980929/rakete1111"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7050, "favorite_count": 1, "accepted_answer_id": 37755868, "answer_count": 3, "score": 5, "last_activity_date": 1591289327, "creation_date": 1465585329, "last_edit_date": 1465587483, "question_id": 37755484, "link": "https://stackoverflow.com/questions/37755484/how-to-execute-go-function-in-c", "title": "How to execute Go function in C#", "body": "<p>Is there any way to execute a Go function from C#? For Python I would use Ironpython for example.</p>\n\n<p>I know that I could spawn a process to execute a Go script, but I don't really want to fallback to such a solution, if possible.</p>\n\n<p>A Google search didn't reveal anything, so is there any way to do that using an API? Or do I have to fallback on processes?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1465584616, "post_id": 37755250, "comment_id": 62980043, "body": "I think that&#39;s coincidence about the types affecting results (but maybe someone who knows better will reply). You need locking around the map iteration and delete in <code>Round()</code> too."}, {"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "reply_to_user": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1465585550, "post_id": 37755250, "comment_id": 62980483, "body": "Thanks, so I have wrapped the range loop with RLock and RUnlock, this removed the second data race"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465585814, "post_id": 37755250, "comment_id": 62980604, "body": "The race detector tells you <i>exactly</i> where the race occurred. You&#39;re calling <code>delete</code> without taking the lock."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 2, "creation_date": 1465586019, "post_id": 37755250, "comment_id": 62980687, "body": "@maksadbek Since there&#39;s a <code>delete</code> inside that loop, you really need a <code>Lock</code>, not just an <code>RLock</code>."}], "answers": [{"comments": [{"owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "edited": false, "score": 0, "creation_date": 1465585253, "post_id": 37755330, "comment_id": 62980332, "body": "Thanks, this solved one data race of two. I updated it. But the second data race one still occurs"}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "edited": false, "score": 0, "creation_date": 1465585792, "post_id": 37755330, "comment_id": 62980595, "body": "(Noting the second race seems to be resolved as well, per your reply to my comment on the question.)"}], "tags": [], "owner": {"reputation": 7800, "user_id": 1144203, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e9563e87ef7289e475f9ffdf6e61081c?s=128&d=identicon&r=PG", "display_name": "ivan.sim", "link": "https://stackoverflow.com/users/1144203/ivan-sim"}, "is_accepted": true, "score": 1, "last_activity_date": 1466020513, "last_edit_date": 1466020513, "creation_date": 1465584677, "answer_id": 37755330, "question_id": 37755250, "link": "https://stackoverflow.com/questions/37755250/golang-data-race-with-66-exit-status/37755330#37755330", "title": "Golang Data Race, with 66 exit status", "body": "<p>UPDATES:</p>\n\n<blockquote>\n  <p>But when I change the value type of the map to int or string, there is not data race.</p>\n</blockquote>\n\n<p>I tested your code further. Changing the map's value type to int or string continues to yield the race condition. Try run it in a <code>while</code> loop on your shell, you will see what I mean:</p>\n\n<pre><code>$ while true; do go run -race main.go; done\n</code></pre>\n\n<p>There shouldn't be any differences between the value types.</p>\n\n<hr>\n\n<p>As reported by the race detectors, there are two different race conditions. The first race (which you've fixed) happens between the read (of <code>i</code>) at line 54 and the write (to <code>i</code>) at line 51. This happens because your goroutine closure holds a reference to <code>i</code>, which is changed by the <code>for</code> loop in your <code>main</code> goroutine. You can resolve it by either getting rid of the <code>println(\"&gt;&gt;\", i)</code> or passing <code>i</code> into your closure like this:</p>\n\n<pre><code>for i := 0; i &lt; 4; i++ {\n  go func(index int) {\n    time.Sleep(2 * time.Second)\n    println(\"&gt;&gt;\", index)\n    go m.Add(\"uz\", City{\"CityMakon\"})\n    go m.Add(\"uzb\", City{\"CityMakon\"})\n  }(i)\n}\n</code></pre>\n\n<p>The second race condition happens between the assignment on line 37 (<code>m.Data[id] = h</code>) and the delete in line 25 (<code>delete(m.Data, i)</code>). The race detector marks this as a race condition because it can't guarantee the <a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"nofollow\"><em>Happen Before</em></a> constraint on your code. You can resolve this by either:</p>\n\n<p>Locking the <code>delete</code> statement:</p>\n\n<pre><code>m.Lock()\ndelete(m.Data, i)\nm.Unlock()\n</code></pre>\n\n<p>Or alternately, extract the two cases in your <code>Round()</code> method into two methods, ranging over the channel:</p>\n\n<pre><code>func (m *Map) Round() {\n  for i, v := range m.Data {\n    fmt.Println(\"-----\", v)\n    delete(m.Data, i)\n  }\n}\n\nfunc (m *Map) Done() {\n  for range done {\n    println(\"bye\")\n    break\n  }\n}\n\nfunc main() {\n  // ...\n  go Round()\n  go Done()\n}\n</code></pre>\n"}], "owner": {"reputation": 1137, "user_id": 2660766, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/qiIdj.png?s=128&g=1", "display_name": "maksadbek", "link": "https://stackoverflow.com/users/2660766/maksadbek"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 898, "favorite_count": 0, "accepted_answer_id": 37755330, "answer_count": 1, "score": 3, "last_activity_date": 1466020513, "creation_date": 1465584306, "last_edit_date": 1495535645, "question_id": 37755250, "link": "https://stackoverflow.com/questions/37755250/golang-data-race-with-66-exit-status", "title": "Golang Data Race, with 66 exit status", "body": "<p>I have the following code, and I am having data race.\nThe Round function periodically check runs the function to delete the contents of the map\nAs I read here: <a href=\"https://stackoverflow.com/questions/23229975/is-it-safe-to-remove-selected-keys-from-golang-map-within-a-range-loop\">Is it safe to remove selected keys from Golang map within a range loop?</a></p>\n\n<p>Removing the data from map is safe, but I am having data race</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\ntype City struct {\n    ID string\n}\n\ntype Map struct {\n    sync.RWMutex\n    Data map[string]City\n}\n\nvar done = make(chan struct{})\n\nfunc (m *Map) Round() {\n    for {\n        select {\n        case &lt;-time.After(2 * time.Second):\n            for i, v := range m.Data {\n                fmt.Println(\"-----\", v)\n                delete(m.Data, i)\n            }\n        case &lt;-done:\n            println(\"bye\")\n            break\n        }\n    }\n}\n\nfunc (m *Map) Add(id string, h City) {\n    m.Lock()\n    m.Data[id] = h\n    m.Unlock()\n}\n\nfunc main() {\n    m := Map{}\n    m.Data = make(map[string]City)\n\n    m.Data[\"Ottowa\"] = City{\"Canada\"}\n    m.Data[\"London\"] = City{\"GB\"}\n    m.Data[\"malafya\"] = City{\"malafya\"}\n\n    go m.Round()\n\n    for i := 0; i &lt; 4; i++ {\n        go func() {\n            time.Sleep(2 * time.Second)\n            go m.Add(\"uz\", City{\"CityMakon\"})\n            go m.Add(\"uzb\", City{\"CityMakon\"})\n        }()\n    }\n    time.Sleep(5 * time.Second)\n    done &lt;- struct{}{}\n}\n</code></pre>\n\n<p>the output:</p>\n\n<pre><code>----- {Canada}\n----- {GB}\n----- {malafya}\n==================\nWARNING: DATA RACE\nWrite by goroutine 12:\n  runtime.mapassign1()\n      /usr/lib/golang/src/runtime/hashmap.go:411 +0x0\n  main.(*Map).Add()\n      /home/narkoz/elixir/round.go:37 +0xaa\n\nPrevious write by goroutine 6:\n  runtime.mapdelete()\n      /usr/lib/golang/src/runtime/hashmap.go:511 +0x0\n  main.(*Map).Round()\n      /home/narkoz/elixir/round.go:26 +0x3a9\n\nGoroutine 12 (running) created at:\n  main.main.func1()\n      /home/narkoz/elixir/round.go:54 +0x8c\n\nGoroutine 6 (running) created at:\n  main.main()\n      /home/narkoz/elixir/round.go:49 +0x2af\n==================\n----- {CityMakon}\n----- {CityMakon}\nFound 1 data race(s)\nexit status 66\n</code></pre>\n\n<p>But when I change the value type of the map to int or string, there is not data race.</p>\n\n<p>What solution do you recommend ?</p>\n"}, {"tags": ["logging", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1465587137, "post_id": 37755236, "comment_id": 62981205, "body": "To check if an <code>io.Writer</code> is also an <code>io.Closer</code> you just use a type assertion. But yes, there is no way to ensure it&#39;s closed. if your output is buffered and requires Close to flush it before exit, you need to setup and handler to do that on your own."}, {"owner": {"reputation": 79, "user_id": 4107638, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AQR0KKfSnLg/AAAAAAAAAAI/AAAAAAAAB3I/cn28_X4a8Jg/photo.jpg?sz=128", "display_name": "Stewart Grant", "link": "https://stackoverflow.com/users/4107638/stewart-grant"}, "edited": false, "score": 0, "creation_date": 1465602128, "post_id": 37755236, "comment_id": 62986459, "body": "With regard to &quot;when do I close it?&quot; you should take a look at the <code>defer</code> statement <a href=\"https://blog.golang.org/defer-panic-and-recover\" rel=\"nofollow noreferrer\">link</a>. Defer places functionality onto a call stack that is executed after the surrounding function exits. Using defer you can ensure that your file will be closed eventually."}, {"owner": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "reply_to_user": {"reputation": 79, "user_id": 4107638, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-AQR0KKfSnLg/AAAAAAAAAAI/AAAAAAAAB3I/cn28_X4a8Jg/photo.jpg?sz=128", "display_name": "Stewart Grant", "link": "https://stackoverflow.com/users/4107638/stewart-grant"}, "edited": false, "score": 0, "creation_date": 1465607722, "post_id": 37755236, "comment_id": 62987402, "body": "@StewartGrant The problem with defer in this case is that it will cause the file to close before it can be written to (because it will only be written to when <code>log.Debug</code> is called from an importing package).  It may be the case that if I have a daemon process that&#39;s going to keep the file open all the time for logging that it doesn&#39;t matter whether it gets closed.  I welcome any opinions on that as well."}], "owner": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 57, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465824728, "creation_date": 1465584268, "last_edit_date": 1465824728, "question_id": 37755236, "link": "https://stackoverflow.com/questions/37755236/ensure-files-passed-to-log-setoutput-are-closed-properly", "title": "Ensure files passed to log.SetOutput are closed properly", "body": "<p>Consider this package that configures a logging adapter based on the environment, and allows changes to logging output at runtime.</p>\n\n<pre><code>package mylog\n\nimport (\n    \"log\"\n    \"os\"\n    \"io\"\n)\n\nconst StdOut = \"STDOUT\"\n\nvar logger *log.Logger\n\nfunc init() {\n    outputLocation := os.Getenv(\"MY_LOG_OUTPUT\")\n    if outputLocation == \"\" || outputLocation == StdOut {\n        log.SetOutput(os.Stdout)\n        return\n    }\n\n    f, _ := getFile(outputLocation)\n    log.SetOutput(f)\n}\n\nfunc getFile(path string) (*os.File, error) {\n    openFlags := os.O_WRONLY | os.O_APPEND | os.O_CREATE\n    f, err := os.OpenFile(path, openFlags, 0666)\n    if err != nil {\n        return nil, err\n    }\n\n    return f, nil\n}\n\nfunc SetOutput(w io.Writer) {\n    logger.SetOutput(w)\n}\n\nfunc Debug(v ...interface{}) {\n    log.Println(v...)\n}\n</code></pre>\n\n<p>There are two problems that I have with this:</p>\n\n<ol>\n<li>There is not a way of being sure that <code>w</code> passed to <code>SetOutput</code> is a <code>Closer</code>.</li>\n<li>Even if I could be sure (reflection?), when do I close it?</li>\n</ol>\n\n<p>Edit:\nIt's difficult to give a simple example of use case that causes a problem.  For example, it I import this package into a simple program that runs and exits, I could expose a method to close log files and call that (with <code>defer</code> or without) before that program finishes execution.  The real problem is with a long-running process (like a webserver) that does not have a point that you would want to close the log unless the process dies.  </p>\n\n<p>So part of my question is, is it even necessary to close the file?</p>\n"}, {"tags": ["opencv", "go", "gobot.io"], "comments": [{"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 1, "creation_date": 1465610389, "post_id": 37755099, "comment_id": 62987798, "body": "Apart from missing image file warnings, the only problem I see here is your HIGHGUI ERROR log. Have you seen at <a href=\"http://stackoverflow.com/questions/16287488/runtime-opencv-highgui-error-highgui-error-v4l-v4l2-vidioc-s-crop-opencv-c\">this</a>?"}, {"owner": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "reply_to_user": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 0, "creation_date": 1465672114, "post_id": 37755099, "comment_id": 63003556, "body": "Thanks , I fixed that part, could you tell me what are those images missing??"}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 0, "creation_date": 1465673257, "post_id": 37755099, "comment_id": 63003886, "body": "Hard to tell, looks like a gtk bug affecting multiple users. What OS are you on? I will try and run your example."}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 0, "creation_date": 1465675139, "post_id": 37755099, "comment_id": 63004431, "body": "There seems to be more to it than your ambiguous warnings. <a href=\"https://github.com/hybridgroup/gobot/platforms/opencv\" rel=\"nofollow noreferrer\">gobot/platforms/opencv</a> gives me a 404. But <a href=\"https://github.com/hybridgroup/go-opencv/blob/master/samples/hellocv.go\" rel=\"nofollow noreferrer\">hellocv.go here</a> works for me on OSX after installing opencv using brew. They obviously haven&#39;t updated the docs, if you don&#39;t have a specific use for gobot take a look at <a href=\"https://github.com/hybridgroup/go-opencv\" rel=\"nofollow noreferrer\">hybridgroup/go-opencv</a>."}], "answers": [{"comments": [{"owner": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "edited": false, "score": 0, "creation_date": 1465677221, "post_id": 37768191, "comment_id": 63005000, "body": "Thanks, I m using Ubuntu, but this is the output I got   /usr/share/themes/Yuyo-Dark/gtk-2.0/Apps/libreoffice.rc:40: Unable to locate image file in pixmap_path: &quot;Entry/entry-border-bg-solid.png&quot; /usr/share/themes/Yuyo-Dark/gtk-2.0/Apps/libreoffice.rc:43: Background image options specified without filename /usr/share/themes/Yuyo-Dark/gtk-2.0/Apps/libreoffice.rc:49: Unable to locate image file in pixmap_path: &quot;Entry/entry-border-active-bg-solid.png&quot; /usr/share/themes/Yuyo-Dark/gtk-2.0/Apps/libreoffice.rc:52: Background image options specified without filename"}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "reply_to_user": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "edited": false, "score": 0, "creation_date": 1465677328, "post_id": 37768191, "comment_id": 63005036, "body": "can you please try removing and reinstalling the &quot;yuyo-gtk-theme package&quot; with <code>sudo apt-get remove --purge yuyo-gtk-theme &amp;&amp; sudo apt-get install yuyo-gtk-theme</code>?"}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "reply_to_user": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "edited": false, "score": 0, "creation_date": 1465677861, "post_id": 37768191, "comment_id": 63005159, "body": "source with identical logs:<a href=\"http://askubuntu.com/a/694793/200350\">askubuntu.com/a/694793/200350</a> I guess that should do it."}, {"owner": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "edited": false, "score": 0, "creation_date": 1465679058, "post_id": 37768191, "comment_id": 63005461, "body": "Tried all reinstalling the package the mate-env-core, still the same error."}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "reply_to_user": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "edited": false, "score": 1, "creation_date": 1465681425, "post_id": 37768191, "comment_id": 63006018, "body": "Obviously something is wrong with your packages but why not try this on another machine, a friend&#39;s pc perhaps? If go is already set up, it literally takes a few commands to run the example. I can&#39;t relate your issue to either gobot or opencv. Maybe as a last resort, try installing gimp as some people reported it helped fix the issue, probably because it fixes the gtk during installation."}], "tags": [], "owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "is_accepted": true, "score": 1, "last_activity_date": 1465682302, "last_edit_date": 1465682302, "creation_date": 1465676575, "answer_id": 37768191, "question_id": 37755099, "link": "https://stackoverflow.com/questions/37755099/gobot-opencv-fails/37768191#37768191", "title": "Gobot OpenCV fails", "body": "<p>Following up on comments; I gave gobot another go for the sample <a href=\"https://github.com/hybridgroup/gobot/blob/dev/examples/opencv_face_detect.go\" rel=\"nofollow noreferrer\">opencv_face_detect</a> and it works for me. Although the example link you posted seems to be faulty/outdated.</p>\n\n<p>This is on OS X 10.11.5 and go1.6.2 darwin/amd64. </p>\n\n<p>Here are the steps I did;</p>\n\n<ul>\n<li><p>Install opencv;</p>\n\n<blockquote>\n  <p>brew tap homebrew/science &amp;&amp; brew install opencv</p>\n</blockquote></li>\n<li><p>Install gobot and go-opencv;</p>\n\n<blockquote>\n  <p>go get github.com/hybridgroup/gobot &amp;&amp; go get github.com/lazywei/go-opencv</p>\n</blockquote></li>\n<li><p>Run the face_detect example located at \"github.com/hybridgroup/gobot/examples\" and don't forget to smile!</p>\n\n<blockquote>\n  <p>go run opencv_face_detect.go </p>\n</blockquote></li>\n</ul>\n\n<p><a href=\"https://i.stack.imgur.com/5d064.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5d064.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 492, "user_id": 1755577, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/faf477c1a801a6b33d7f695d29b7884e?s=128&d=identicon&r=PG&f=1", "display_name": "Jishnu U Nair", "link": "https://stackoverflow.com/users/1755577/jishnu-u-nair"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 174, "favorite_count": 0, "accepted_answer_id": 37768191, "answer_count": 1, "score": 1, "last_activity_date": 1465682302, "creation_date": 1465583686, "question_id": 37755099, "link": "https://stackoverflow.com/questions/37755099/gobot-opencv-fails", "title": "Gobot OpenCV fails", "body": "<p>I'm trying to run OpenCV test application from GoBot <a href=\"https://gobot.io/documentation/platforms/opencv/\" rel=\"nofollow\">Go Lang OpenCV</a> . I tried to run the example code given in that page and all I get is an error:</p>\n\n<pre><code>2016/06/10 20:15:26 Initializing Robot cameraBot ...\n2016/06/10 20:15:26 Initializing devices...\n2016/06/10 20:15:26 Initializing device window ...\n2016/06/10 20:15:26 Initializing device camera ...\n2016/06/10 20:15:26 Starting Robot cameraBot ...\n2016/06/10 20:15:26 Starting connections...\n2016/06/10 20:15:26 Starting devices...\n2016/06/10 20:15:26 Starting device window...\n/usr/share/themes/Yuyo-Dark/gtk-2.0/Apps/libreoffice.rc:40: Unable to    locate image file in pixmap_path: \"Entry/entry-border-bg-solid.png\"\n/usr/share/themes/Yuyo-Dark/gtk-2.0/Apps/libreoffice.rc:43: Background     image options specified without filename\n/usr/share/themes/Yuyo-Dark/gtk-2.0/Apps/libreoffice.rc:49: Unable to   locate image file in pixmap_path: \"Entry/entry-border-active-bg-solid.png\"\n/usr/share/themes/Yuyo-Dark/gtk-2.0/Apps/libreoffice.rc:52: Background   image options specified without filename\ninit done \nopengl support available \n2016/06/10 20:15:26 Starting device camera...\nHIGHGUI ERROR: V4L/V4L2: VIDIOC_S_CROP\n2016/06/10 20:15:26 Starting work...\n</code></pre>\n\n<p>What am I doing wrong? I have installed and run C++ OpenCV before</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465582994, "post_id": 37754712, "comment_id": 62979186, "body": "The only thing you could do is panic and recover it yourself, but depending on your use case, it may not be any faster."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465583047, "post_id": 37754712, "comment_id": 62979223, "body": "You think letting this just run it&#39;s course (let&#39;s say on 1M+ JSON records, so a vast amount of bytes) won&#39;t hurt performance?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465583155, "post_id": 37754712, "comment_id": 62979284, "body": "Sorry, I can&#39;t tell from the context here. If aborting the stack from your entrypoint is OK, you can have your callback panic, and you can recover. A panic and recover isn&#39;t cheap, but yes, it probably a lot cheaper than parsing 1M json record."}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465583378, "post_id": 37754712, "comment_id": 62979401, "body": "In Objective-C I would solve this by using a <code>__block BOOL done</code> for example and check if it was done. Still causing the loops, but at least preventing the full value comparison to be executed. Is this possible in Go?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465583510, "post_id": 37754712, "comment_id": 62979476, "body": "I think I managed it by just using a boolean on the same scope-level. I didn&#39;t know they could be accessed inside a callback scope too. Lol now I feel silly :P. Went from <code>67498865 ns&#47;op</code> to <code>37491376 ns&#47;op</code> in the benchmark."}], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 211, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1465582905, "creation_date": 1465582213, "last_edit_date": 1465582905, "question_id": 37754712, "link": "https://stackoverflow.com/questions/37754712/abort-arrayeach-callback-in-jsonparser-early", "title": "Abort ArrayEach callback in jsonparser early", "body": "<p>Looking at this <a href=\"https://github.com/buger/jsonparser/blob/5048f353608edffd70b6532f2a0c8b0ccd36df12/parser.go#L412\" rel=\"nofollow\">callback</a> (line 412), is it possible to break out of the callback loop from inside the callback function itself? Or would I need to wrap it or extend it in some way to create that capability?</p>\n\n<p>This is the code:</p>\n\n<pre><code>jsonparser.ArrayEach(data, func(value []byte, dataType jsonparser.ValueType, offset int, err error) {\n    if v, err := jsonparser.GetUnsafeString(value, \"username\"); nil == err &amp;&amp; v == lookFor {\n        z = v\n        return // Abort in some way?\n    }\n})\n</code></pre>\n\n<p>The library is still waiting for a <em>query-like</em> update so for now this is the cheapest way to find a value, which still outperforms any full <code>json</code> parser by far (doing about 9.21x to 9.38x faster on benchmarks). So I'm kind of aiming for a <code>LIMIT 1</code>-ish solution.</p>\n\n<p>I was thinking of doing a full copy-paste and making an cloned version on the interface and making..</p>\n\n<pre><code>if t != NotExist {\n    cb(v, t, o, e)\n}\n</code></pre>\n\n<p>into...</p>\n\n<pre><code>if t != NotExist {\n    boolVal = cb(v, t, o, e) // Extending it to have a return value\n}\n</code></pre>\n\n<p>... return a <code>boolean</code> and validate as a continue indicator. But would there be a more clean way without fully duplicating this code?</p>\n"}, {"tags": ["optimization", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465579241, "post_id": 37753843, "comment_id": 62977293, "body": "yes, this is done in assembly, by the <code>runtime&#183;eqstring</code> function"}, {"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465579291, "post_id": 37753843, "comment_id": 62977321, "body": "Thank your for your response JimB. Do you know how that process goes about the inspection? Does it always fully iterate and/of compare both variable&#39;s length or does it early abort when equal index-depth doesn&#39;t match anymore?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465579381, "post_id": 37753843, "comment_id": 62977367, "body": "no, it always compares length first. there&#39;s no reason to iterate if they&#39;re not the same length."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465581414, "post_id": 37753843, "comment_id": 62978328, "body": "checking the first byte might be a special case optimization for you. I think the default amd64 comparison for large strings will always load 2 64byte chunks into registers to make the first comparison. It&#39;s possible that the single byte check is slightly faster. This is in the realm of &quot;very hard to measure&quot;, because this all depends so much on the cpu, memory layout, and cache state."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1465579632, "post_id": 37753988, "comment_id": 62977503, "body": "I did NASM on an old Mac years ago. I should really get into that again to be able to debug on this scale too :). I&#39;ll up vote this when the cooldown period is over. Thanks so much for collaborating as always JimB!"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 6, "last_activity_date": 1465580008, "last_edit_date": 1465580008, "creation_date": 1465579481, "answer_id": 37753988, "question_id": 37753843, "link": "https://stackoverflow.com/questions/37753843/string-comparison-in-the-core-language/37753988#37753988", "title": "String comparison in the core language", "body": "<p>The function is handled in assembly. The amd64 version is:</p>\n\n<pre><code>TEXT runtime\u00b7eqstring(SB),NOSPLIT,$0-33\n    MOVQ    s1str+0(FP), SI\n    MOVQ    s2str+16(FP), DI\n    CMPQ    SI, DI\n    JEQ eq\n    MOVQ    s1len+8(FP), BX\n    LEAQ    v+32(FP), AX\n    JMP runtime\u00b7memeqbody(SB)\neq:\n    MOVB    $1, v+32(FP)\n    RET\n</code></pre>\n\n<p>And it's the compiler's job to ensure that the strings are of equal length before that is called. (The <code>runtime\u00b7memeqbody</code> function is actually where the optimized memory comparisons happen, but there's probably no need to post the full text here)</p>\n\n<p>The equivalent Go code would be:</p>\n\n<pre><code>func eqstring_generic(s1, s2 string) bool {\n    if len(s1) != len(s2) {\n        return false\n    }\n    for i := 0; i &lt; len(s1); i++ {\n        if s1[i] != s2[i] {\n            return false\n        }\n    }\n    return true\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 59, "favorite_count": 0, "accepted_answer_id": 37753988, "answer_count": 1, "score": 3, "last_activity_date": 1465580008, "creation_date": 1465578938, "question_id": 37753843, "link": "https://stackoverflow.com/questions/37753843/string-comparison-in-the-core-language", "title": "String comparison in the core language", "body": "<p>Taking this simple comparison <code>loopValue == \"Firstname\"</code>, is the following statement true?</p>\n\n<blockquote>\n  <p>If the internal operand inspecting the first <code>char</code> does not match the compared string, it will early abort</p>\n</blockquote>\n\n<p>So taking the rawer form <code>loopValue</code> and <code>\"Firstname\"</code> are both <code>[]byte</code>. And it would <em>walk</em> the array kind of like so as callback loop for truth:</p>\n\n<pre><code>someInspectionFunc(loopValue, \"Firstname\", func(charA, charB) {\n    return charA == charB\n})\n</code></pre>\n\n<p>... making it keep on going until it bumps <code>false</code> and checks if the number of <code>iterations</code> was equal to both their lengths. Also does it check length first?</p>\n\n<pre><code>if len(loopValue) != len(\"Firstname\") {\n    return false\n}\n</code></pre>\n\n<p>I can't really find an explanation in the <code>go</code> source-code on GitHub as it's a bit above me.</p>\n\n<p>The reason I'm asking this is because I'm doing big data processing and am benchmarking and doing cpu, memory and allocation <code>pprof</code> to squeeze some more juice out of the process. From that process it kind of made me think how Go (but also just C in general) would do this under the hood. Is this fully on an assembly level or does the comparison already happen in native Go code (kind of like sketched in the snippets above)?</p>\n\n<p>Please let me know if I'm being too vague or if I missed something. Thank you</p>\n\n<p><strong>Update</strong></p>\n\n<p>When I did a <code>firstCharater</code> match in big strings of <code>json</code>, before really comparing I got about <code>3.7%</code> benchmarking gain on 100k heavy entries:</p>\n\n<pre><code>&lt;some irrelevant inspection code&gt;.. v[0] == firstChar &amp;&amp; v == lookFor {\n    // Match found when it reaches here\n}\n</code></pre>\n\n<p>the code above (especially on long strings) is faster than just going for <code>v == lookFor</code>.</p>\n"}, {"tags": ["go", "amazon-s3", "gzip", "aws-sdk"], "comments": [{"owner": {"reputation": 15752, "user_id": 16998, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PstY2.jpg?s=128&g=1", "display_name": "jrwren", "link": "https://stackoverflow.com/users/16998/jrwren"}, "edited": false, "score": 0, "creation_date": 1465579640, "post_id": 37753396, "comment_id": 62977507, "body": "what is t.File, is it open? io.Copy copies until EOF or error. You should be checking the return values of io.Copy for bytes written and errors."}, {"owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "reply_to_user": {"reputation": 15752, "user_id": 16998, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PstY2.jpg?s=128&g=1", "display_name": "jrwren", "link": "https://stackoverflow.com/users/16998/jrwren"}, "edited": false, "score": 0, "creation_date": 1465580829, "post_id": 37753396, "comment_id": 62978048, "body": "t (or Table) is a struct that has an open pointer to File"}, {"owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "reply_to_user": {"reputation": 15752, "user_id": 16998, "user_type": "registered", "accept_rate": 44, "profile_image": "https://i.stack.imgur.com/PstY2.jpg?s=128&g=1", "display_name": "jrwren", "link": "https://stackoverflow.com/users/16998/jrwren"}, "edited": false, "score": 0, "creation_date": 1465580925, "post_id": 37753396, "comment_id": 62978099, "body": "I did update io.Copy to:     _, err := io.Copy(gw, t.File) just to check for errors and there are none."}, {"owner": {"reputation": 1778, "user_id": 2303988, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/VcVRc.jpg?s=128&g=1", "display_name": "Alessio", "link": "https://stackoverflow.com/users/2303988/alessio"}, "edited": false, "score": 0, "creation_date": 1493844392, "post_id": 37753396, "comment_id": 74580805, "body": "have you ever encountered performance issue with this approach? to me it seems quite slow"}], "answers": [{"tags": [], "owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "is_accepted": false, "score": 1, "last_activity_date": 1465582626, "last_edit_date": 1465582626, "creation_date": 1465582064, "answer_id": 37754672, "question_id": 37753396, "link": "https://stackoverflow.com/questions/37753396/streaming-gzipped-file-to-s3-via-aws-sdk-go/37754672#37754672", "title": "Streaming gzipped file to S3 via AWS SDK GO", "body": "<p>I discovered that even though you may have a struct designed as such (as I do):</p>\n\n<pre><code>type Table struct {                                                                                                                                                                                                                                                                                                           \n  Name     string                                                                                                                                                                                                                                                                                                             \n  Path     string                                                                                                                                                                                                                                                                                                             \n  FileName string                                                                                                                                                                                                                                                                                                             \n  File     *os.File                                                                                                                                                                                                                                                                                                           \n  Buffer   *bufio.Writer                                                                                                                                                                                                                                                                                                      \n  Data     chan string                                                                                                                                                                                                                                                                                                        \n}\n</code></pre>\n\n<p>using a function that requires a pointer to that struct does not necessarily leave the Table.File in an open state.</p>\n\n<p>I made sure the file was closed when writing to it was complete and reopened it inside my upload function. This resolved the issue and uploaded the full gzipped file to S3.</p>\n\n<p>Thanks for the heads up on the possible issue @jrwren</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6561466, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-QJ02-gQWD3Q/AAAAAAAAAAI/AAAAAAAAACE/nGP0MhzUahU/photo.jpg?sz=128", "display_name": "hanjm", "link": "https://stackoverflow.com/users/6561466/hanjm"}, "is_accepted": false, "score": 0, "last_activity_date": 1522719856, "last_edit_date": 1522719856, "creation_date": 1522718739, "answer_id": 49620909, "question_id": 37753396, "link": "https://stackoverflow.com/questions/37753396/streaming-gzipped-file-to-s3-via-aws-sdk-go/49620909#49620909", "title": "Streaming gzipped file to S3 via AWS SDK GO", "body": "<p>Do you call <code>t.File.Write()</code> in other code?  If you do\uff0c the cursor of <code>t.File</code> could be the end of file. So you should seek the file cursor to the origin of file.</p>\n\n<p>Call  <code>t.File.Seek(0,0)</code>   before <code>io.Copy(gw,t.File)</code> (line 9) </p>\n"}], "owner": {"reputation": 511, "user_id": 402520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/caa9c447547d8560335a7bd1c3649072?s=128&d=identicon&r=PG", "display_name": "Ode", "link": "https://stackoverflow.com/users/402520/ode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1771, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1522719856, "creation_date": 1465577316, "last_edit_date": 1465577724, "question_id": 37753396, "link": "https://stackoverflow.com/questions/37753396/streaming-gzipped-file-to-s3-via-aws-sdk-go", "title": "Streaming gzipped file to S3 via AWS SDK GO", "body": "<p>I followed the example on the AWS site for gzipping files and streaming them to S3, found here: <a href=\"http://docs.aws.amazon.com/sdk-for-go/latest/v1/developerguide/common-examples.title.html\" rel=\"nofollow\">http://docs.aws.amazon.com/sdk-for-go/latest/v1/developerguide/common-examples.title.html</a></p>\n\n<p>I am having an issue where the only thing landing in my S3 bucket are files with basically just the GZIP headers. Every single file is 23b in size.</p>\n\n<p>Any idea what would cause this?</p>\n\n<p>My code:</p>\n\n<pre><code>func (t *Table) Upload() {\n  year := time.Now().Format(\"2006\")\n  month := time.Now().Format(\"01\")\n  day := time.Now().Format(\"02\")\n  reader, writer := io.Pipe()\n  go func() {\n    gw := gzip.NewWriter(writer)\n    io.Copy(gw, t.File)\n    t.File.Close()\n    gw.Close()\n    writer.Close()\n  }()\n  uploader := s3manager.NewUploader(session.New(&amp;aws.Config{Region: aws.String(os.Getenv(\"AWS_REGION\"))}))\n  result, err := uploader.Upload(&amp;s3manager.UploadInput{\n    Body:   reader,\n    Bucket: aws.String(os.Getenv(\"S3_BUCKET\")),\n    Key:    aws.String(fmt.Sprintf(\"%s/%s/%s/%s/%s\", os.Getenv(\"S3_KEY\"), year, month, day, t.Name+\".csv.gz\")),\n  })\n  if err != nil {\n    log.WithField(\"error\", err).Fatal(\"Failed to upload file.\")\n  }\n  log.WithField(\"location\", result.Location).Info(\"Successfully uploaded to\")\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "docker", "docker-compose"], "comments": [{"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 0, "creation_date": 1465610514, "post_id": 37753055, "comment_id": 62987814, "body": "Can you show the line where you connect the <code>db</code>?"}, {"owner": {"reputation": 2445, "user_id": 1505341, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9XpLu.jpg?s=128&g=1", "display_name": "Kerem", "link": "https://stackoverflow.com/users/1505341/kerem"}, "edited": false, "score": 0, "creation_date": 1465611661, "post_id": 37753055, "comment_id": 62987954, "body": "I am assuming you are using a different user name than &quot;user&quot;. Perhaps you are using <a href=\"https://godoc.org/github.com/lib/pq#ParseURL\" rel=\"nofollow noreferrer\">ParseURL</a> and your connection string is not being generated properly? Also see <a href=\"https://github.com/hashicorp/vault/issues/938\" rel=\"nofollow noreferrer\">this</a>."}], "answers": [{"comments": [{"owner": {"reputation": 2501, "user_id": 69362, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/29398298ab2a881fc9949f8d68964bfd?s=128&d=identicon&r=PG", "display_name": "Deepak N", "link": "https://stackoverflow.com/users/69362/deepak-n"}, "edited": false, "score": 0, "creation_date": 1501820910, "post_id": 37764191, "comment_id": 77957448, "body": "This answer saved my day. Thanks!"}], "tags": [], "owner": {"reputation": 4230, "user_id": 1804317, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/84f00e56b203aec51a3104f1ed30c3da?s=128&d=identicon&r=PG", "display_name": "Jakob Abfalter", "link": "https://stackoverflow.com/users/1804317/jakob-abfalter"}, "is_accepted": false, "score": 8, "last_activity_date": 1465651047, "creation_date": 1465651047, "answer_id": 37764191, "question_id": 37753055, "link": "https://stackoverflow.com/questions/37753055/postgres-error-running-query-on-database-could-not-detect-default-username/37764191#37764191", "title": "Postgres Error running query on database: Could not detect default username", "body": "<p>Hey for anyone having a similiar issue in the future:</p>\n\n<p>The problem was this line in the docker-compose.yml</p>\n\n<pre><code> - DATA_SOURCE_NAME=\"postgresql://user:pass@localhost:5432/?sslmode=disable\" \n</code></pre>\n\n<p>Changing it to</p>\n\n<pre><code> - DATA_SOURCE_NAME=postgresql://user:pass@localhost:5432/?sslmode=disable\n</code></pre>\n\n<p>(Without the quotes) made everything work :)</p>\n"}], "owner": {"reputation": 4230, "user_id": 1804317, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/84f00e56b203aec51a3104f1ed30c3da?s=128&d=identicon&r=PG", "display_name": "Jakob Abfalter", "link": "https://stackoverflow.com/users/1804317/jakob-abfalter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1957, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1465651047, "creation_date": 1465576028, "last_edit_date": 1465635682, "question_id": 37753055, "link": "https://stackoverflow.com/questions/37753055/postgres-error-running-query-on-database-could-not-detect-default-username", "title": "Postgres Error running query on database: Could not detect default username", "body": "<p>Hi I am trying to monitor postgres SQL with Prometheus. For this purpose I am using this exporter <a href=\"https://github.com/wrouesnel/postgres_exporter\" rel=\"nofollow\">https://github.com/wrouesnel/postgres_exporter</a></p>\n\n<p>I am starting the exporter in my <code>docker-compose.yml</code> like this:</p>\n\n<pre><code>  exporter-postgres:\n    image: wrouesnel/postgres_exporter\n    ports:\n      - 9113:9113\n    environment:\n      - DATA_SOURCE_NAME=\"postgresql://user:pass@localhost:5432/?sslmode=disable\" \n</code></pre>\n\n<p>When the exporter is trying to access the database errors like this are thrown:</p>\n\n<pre><code>Error running query on database: pg_stat_database pg: Could not detect default username. Please provide one explicitly. file=\"postgres-exporter.go\" line=490\n</code></pre>\n\n<p>and </p>\n\n<pre><code>Error scanning runtime variable: pg_stat_database pg: Could not detect default username. Please provide one explicitly. file=\"postgres-exporter.go\" line=464\n</code></pre>\n\n<p>I am not really sure what this message could mean. Also I am not really sure if the issues originates in my docker-compose file, or the exporter.</p>\n\n<p>The lines which throw the error in the <code>postgres-exporter.go</code> are:</p>\n\n<pre><code>// Use SHOW to get the value\nrow := db.QueryRow(fmt.Sprintf(\"SHOW %s;\", columnName))\n\nvar val interface{}\nerr := row.Scan(&amp;val)\nif err != nil {\n    log.Errorln(\"Error scanning runtime variable:\", columnName, err)\n    continue\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>query, er := queryOverrides[namespace]\nif er == false {\n    query = fmt.Sprintf(\"SELECT * FROM %s;\", namespace)\n}\n\n// Don't fail on a bad scrape of one metric\nrows, err := db.Query(query)\nif err != nil {\n    log.Println(\"Error running query on database: \", namespace, err)\n    e.error.Set(1)\n    return\n}\n</code></pre>\n\n<p><a href=\"https://github.com/wrouesnel/postgres_exporter/blob/master/postgres_exporter.go\" rel=\"nofollow\">https://github.com/wrouesnel/postgres_exporter/blob/master/postgres_exporter.go</a></p>\n\n<p>I am thankful for any help!</p>\n\n<p>Edit:</p>\n\n<p>Here is the connection to the database:</p>\n\n<pre><code>db, err := sql.Open(\"postgres\", e.dsn)\n</code></pre>\n\n<p>Whereas <code>e.dsn</code> is generated like this:</p>\n\n<pre><code>dsn := os.Getenv(\"DATA_SOURCE_NAME\")\n</code></pre>\n\n<p>The connection doesn't throw any error</p>\n"}, {"tags": ["go", "continuous-integration", "drone"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465574913, "post_id": 37752630, "comment_id": 62974916, "body": "You can&#39;t build go-sqlite3 without cgo."}], "owner": {"reputation": 13, "user_id": 1804456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/u3yCl.png?s=128&g=1", "display_name": "collegecoder", "link": "https://stackoverflow.com/users/1804456/collegecoder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 266, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1465574613, "creation_date": 1465574613, "question_id": 37752630, "link": "https://stackoverflow.com/questions/37752630/drone-io-build-failed-exit-code-1", "title": "Drone.io build failed exit code 1", "body": "<p>Attached is a snippet of my drone (v0.4) build log when I trigger a build by pushing my project to master. Cant figure out why the build is failing. Am I missing something <a href=\"http://i.stack.imgur.com/YQxqW.png\" rel=\"nofollow\">here?</a> </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465572434, "post_id": 37751899, "comment_id": 62973418, "body": "It&#39;s a convenient size. You you mean why 512 instead of something like 500?"}, {"owner": {"reputation": 347, "user_id": 5207376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/929972057068521/picture?type=large", "display_name": "Xu Chen", "link": "https://stackoverflow.com/users/5207376/xu-chen"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1465572846, "post_id": 37751899, "comment_id": 62973662, "body": "Yes, but more like instead of 256? or anything power of 2 and relatively large."}, {"owner": {"reputation": 1894, "user_id": 2269979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22a1e835980e29baccf08a62e7ff71?s=128&d=identicon&r=PG", "display_name": "molivier", "link": "https://stackoverflow.com/users/2269979/molivier"}, "edited": false, "score": 1, "creation_date": 1465573056, "post_id": 37751899, "comment_id": 62973793, "body": "Found a good thread about that: <a href=\"http://stackoverflow.com/questions/236861/how-do-you-determine-the-ideal-buffer-size-when-using-fileinputstream\" title=\"how do you determine the ideal buffer size when using fileinputstream\">stackoverflow.com/questions/236861/&hellip;</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1465573184, "post_id": 37751899, "comment_id": 62973873, "body": "It&#39;s just an arbitrary value. For example, the <code>bufio.Reader</code> default is 4096, which is used throughout the http package."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1894, "user_id": 2269979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22a1e835980e29baccf08a62e7ff71?s=128&d=identicon&r=PG", "display_name": "molivier", "link": "https://stackoverflow.com/users/2269979/molivier"}, "edited": false, "score": 0, "creation_date": 1465573252, "post_id": 37751899, "comment_id": 62973914, "body": "@molivier: that&#39;s specifically about the filesystem, and is less applicable to the network."}, {"owner": {"reputation": 1894, "user_id": 2269979, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ff22a1e835980e29baccf08a62e7ff71?s=128&d=identicon&r=PG", "display_name": "molivier", "link": "https://stackoverflow.com/users/2269979/molivier"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1465573629, "post_id": 37751899, "comment_id": 62974109, "body": "@JimB Yes sorry I paste the wrong link: <a href=\"http://stackoverflow.com/questions/2811006/what-is-a-good-buffer-size-for-socket-programming\" title=\"what is a good buffer size for socket programming\">stackoverflow.com/questions/2811006/&hellip;</a>"}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "edited": false, "score": 0, "creation_date": 1465574876, "post_id": 37751899, "comment_id": 62974896, "body": "The key is that the buffer size should strike a balance between memory size  and expected read/write size.  The entire point of that type of buffer is to avoid allocations for small reads and/or writes, so if it&#39;s sufficiently large that most of your read/writes fit in it, you avoid a lot of extraneous (and unnecessary) allocations of memory.  An argument could also be made that such a buffer should ideally fit in a cache line on the expected environment."}], "answers": [{"comments": [{"owner": {"reputation": 269, "user_id": 2687743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5ce68fb8b38a5e08e7abe9ac0a34f1?s=128&d=identicon&r=PG", "display_name": "Seth Pollack", "link": "https://stackoverflow.com/users/2687743/seth-pollack"}, "edited": false, "score": 0, "creation_date": 1479956383, "post_id": 37754268, "comment_id": 68778399, "body": "The bytes package in go has a constant called MinRead that is set to 512, so it seems like it does have some meaning. <a href=\"https://golang.org/pkg/bytes/?m=all#pkg-constants\" rel=\"nofollow noreferrer\">golang.org/pkg/bytes/?m=all#pkg-constants</a>"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 269, "user_id": 2687743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5ce68fb8b38a5e08e7abe9ac0a34f1?s=128&d=identicon&r=PG", "display_name": "Seth Pollack", "link": "https://stackoverflow.com/users/2687743/seth-pollack"}, "edited": false, "score": 0, "creation_date": 1479969746, "post_id": 37754268, "comment_id": 68782374, "body": "@SethPollack, IMO that&#39;s a red herring: from the description, that constant appears to serve a heuristic used to prevent premature growing of the buffer <code>ReadFrom()</code> reads the data into. You know... in the end, the only &quot;magic&quot; thing about 512 -- as opposed to, say, 511 or 516, -- is that it&#39;s 2^9. 512 is exactly half of a kilobyte (a kibibyte to be precise), or twice as much as 256 which is 2x128, which is 2x64, which is 2x32, which is 2x16, which is 2x8 etc ;-)"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 269, "user_id": 2687743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5ce68fb8b38a5e08e7abe9ac0a34f1?s=128&d=identicon&r=PG", "display_name": "Seth Pollack", "link": "https://stackoverflow.com/users/2687743/seth-pollack"}, "edited": false, "score": 0, "creation_date": 1479970040, "post_id": 37754268, "comment_id": 68782499, "body": "@SethPollack, I mean, for those who started to dabble with programming back in those days when it usually meant learning some assembly language and machine codes, 512 has that warm cozy feeling. ;-) That&#39;s part of the reason such numbers are used. The other -- more serious consideration -- is that on some architectures, memory access is only effective (or even possible!) when the starting address of a memory block of a given size is naturally <i>aligned</i>. Say, to read a 64-bit word, it has to be located at an address wholly divisible by 8."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 269, "user_id": 2687743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3f5ce68fb8b38a5e08e7abe9ac0a34f1?s=128&d=identicon&r=PG", "display_name": "Seth Pollack", "link": "https://stackoverflow.com/users/2687743/seth-pollack"}, "edited": false, "score": 0, "creation_date": 1479970146, "post_id": 37754268, "comment_id": 68782546, "body": "@SethPollack, hence operating on memory blocks of such &quot;even&quot; sizes like 512 (which contains an exact/whole number of the H/W architecture words -- be them 16- or 32- or 64- or 128-bit in size) could allow the compiler to generate the code which accesses that memory in the most effective way possible."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 1, "last_activity_date": 1465582556, "last_edit_date": 1465582556, "creation_date": 1465580564, "answer_id": 37754268, "question_id": 37751899, "link": "https://stackoverflow.com/questions/37751899/why-a-buffer-byte-array-of-length-512-aka-512byte-is-preferred-in-go-for-read/37754268#37754268", "title": "Why a buffer byte array of length 512, aka [512]byte is preferred in Go for reading and writing?", "body": "<p>Not a direct answer but some background in addition to what other folks stated in comments.</p>\n\n<p>The Go types which wrap files and sockets are relatively thin in the sense any <code>Read()</code> and <code>Write()</code> call done on them results in a syscall being performed (with the sockets, it's more tricky as they use async I/O via the system-provided poller such as <code>epoll</code>, <code>kqueue</code>, <code>IOCP</code> etc).  This means that reading from a file or network by chunks of 1 byte is woefully ineffective.</p>\n\n<p>To consider another extreme, it's possible to allocate, say, a 100MiB buffer and attempt to pass it to <code>Read()</code>.  While the kernel's syscall will happily accept a destination of that size, it should be noted that contemporary OSes have internal buffers on network sockets of around 64KiB<sup>1</sup> in size so your <code>Read()</code> call under most circumstances will return having read just that much data or less.  This means you will be wasting most of your buffer space.</p>\n\n<p>Now comes another set of considerations: what pattern of reading data from a socket your application has?</p>\n\n<p>Say, when you're streaming data from a socket to an open file, you don't really care about buffering (you'd like it would be someone else's decision to pick the \"right\" size).  For this case, just use <code>io.Copy()</code> (which currently (Go 1.6) uses an internal buffer of 32KiB).</p>\n\n<p>Conversely, if you're parsing some application-level protocol utilizing TCP as its transport, you often need to read the data in chunks of arbitrary fixed size.  For this case, the best pattern is wrapping the socket in a <code>bufio.Reader</code> &mdash; to combat the \"small reads\" problem outlined above &mdash; and then use <code>io.ReadFull()</code> to read data into your local arrays/slices of the size you need (if possible, do reuse your arrays and slices to lower the pressure on the garbage collector).</p>\n\n<p>Another case is text-based \"linewise\" protocols such as <code>SMTP</code> or <code>HTTP</code>.\nIn these protocols, the maximum line length is typically fixed, and it makes sense to use buffers of the maximum size of the protocol's line to deal with them. (But anyway, to deal with such protocols, it's best to use the <code>net/textproto</code> standard package.)</p>\n\n<p>As to your question <em>per se,</em> my stab at it is that 512 is just a beautiful number which has no special meaning.  When you write a book like this you <em>have to</em> pick some value anyway.</p>\n\n<p>As you can see from my descriptions of real-work patterns of reading from the network, most of the time you simply have no business dealing with buffering &mdash; let the standard tools do this for you.  You should only resort to thinking about tuning that stuff when you're facing a real problem with the defaults provided by the standard packages.</p>\n\n<p>TL;DR</p>\n\n<ul>\n<li>The book you're reading merely explains you the basic concepts, so it has to use some number.</li>\n<li>Real-world code seems to use other numbers when it needs to buffer (usually higher)&hellip;</li>\n<li>&hellip;but you should not concern you with these numbers until absolutely necessary: use the ready-made tools where possible.</li>\n</ul>\n\n<hr>\n\n<p><sup>1</sup> Of course, I can't say for all operating systems, and they have different knobs to tweak this stuff, and \"contemporary\" might start to mean different things in over a year or less, you know&hellip; still I consider my estimation as being quite close to the truth.</p>\n"}], "owner": {"reputation": 347, "user_id": 5207376, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/929972057068521/picture?type=large", "display_name": "Xu Chen", "link": "https://stackoverflow.com/users/5207376/xu-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1212, "favorite_count": 0, "accepted_answer_id": 37754268, "answer_count": 1, "score": 1, "last_activity_date": 1465582556, "creation_date": 1465572324, "question_id": 37751899, "link": "https://stackoverflow.com/questions/37751899/why-a-buffer-byte-array-of-length-512-aka-512byte-is-preferred-in-go-for-read", "title": "Why a buffer byte array of length 512, aka [512]byte is preferred in Go for reading and writing?", "body": "<p>I was studying Go from \"Network programming with Go\" by Jan Newmarch, and I noticed that almost all his examples involve [512]byte as a buffer for writing and reading to a connection. </p>\n\n<p>I tried to search online but failed to get an answer. I suspect it might have something to do with i/o, but am not sure what is the exact reason behind this design. </p>\n\n<p>Could anyone elaborate a bit on the choice of the buffer? </p>\n\n<p>Some sample codes from the book: </p>\n\n<pre><code>func handleConn(c net.Conn){ \n    defer c.Close()\n\n    var buf [512]byte \n\n    for{ \n        n, err := c.Read(buf[0:])\n\n        if err != nil{ return }\n\n        _, err2 := c.Write(buf[0:]) \n\n        if err2 != nil{ \n          return \n         }\n    }\n }\n</code></pre>\n"}]