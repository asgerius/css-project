[{"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "is_accepted": true, "score": 8, "last_activity_date": 1436396486, "creation_date": 1436396486, "answer_id": 31305313, "question_id": 31305267, "link": "https://stackoverflow.com/questions/31305267/is-this-syntax-a-pointer-to-a-slice-or-a-slice-of-pointers/31305313#31305313", "title": "Is this syntax a pointer to a slice or a slice of pointers?", "body": "<p>This is a slice of pointers, just read from left to right: (<code>[]</code>) a slice of (<code>*</code>) pointers to (<code>int</code>) integer. On the other hand, <code>*[]int</code> would be (<code>*</code>) a pointer to (<code>[]</code>) a slice of (<code>int</code>) integers.</p>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1436396725, "creation_date": 1436396725, "answer_id": 31305353, "question_id": 31305267, "link": "https://stackoverflow.com/questions/31305267/is-this-syntax-a-pointer-to-a-slice-or-a-slice-of-pointers/31305353#31305353", "title": "Is this syntax a pointer to a slice or a slice of pointers?", "body": "<p>That is a slice of int pointers. <code>[]</code> brackets come before the type so <code>*int</code> is the type in your example while <code>*[]int</code> is a pointer to an int array or *[]*int for a pointer to an array of int pointers.</p>\n\n<p>Just as a matter of style I would generally avoid using <code>*[]int</code> syntax in favor or something like <code>foo := &amp;[]int{}</code> which results in <code>foo</code> being a pointer to the start of a new int array.</p>\n"}], "owner": {"reputation": 62800, "user_id": 391161, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb76d8bcc69144a3ee4c893ece7fc588?s=128&d=identicon&r=PG&f=1", "display_name": "merlin2011", "link": "https://stackoverflow.com/users/391161/merlin2011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 31305313, "answer_count": 2, "score": 3, "last_activity_date": 1436396725, "creation_date": 1436396258, "question_id": 31305267, "link": "https://stackoverflow.com/questions/31305267/is-this-syntax-a-pointer-to-a-slice-or-a-slice-of-pointers", "title": "Is this syntax a pointer to a slice or a slice of pointers?", "body": "<p>After looking at <a href=\"http://blog.golang.org/gos-declaration-syntax\" rel=\"nofollow\">this blog post</a>, I am still unclear about whether the following syntax means a slice of pointers or a pointer to a slice.</p>\n\n<pre><code>foo  []*int\n</code></pre>\n\n<p>Which one is it, and what is the general rule of thumb for this case?</p>\n"}, {"tags": ["javascript", "regex", "go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436399705, "post_id": 31304999, "comment_id": 50601195, "body": "by copy/pasting into a .js file?"}, {"owner": {"reputation": 566, "user_id": 4934782, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ae4c1c1fd0fa82205af63dc62eeb347f?s=128&d=identicon&r=PG", "display_name": "Aaron", "link": "https://stackoverflow.com/users/4934782/aaron"}, "edited": false, "score": 0, "creation_date": 1436908969, "post_id": 31304999, "comment_id": 50807805, "body": "@rikkigibson is right, that is a monstrosity of a pattern.  Better to match 99% of cases with a clear &amp; succinct regular expression rather than wading through a pile of ascii puke that <i>ehem</i> <i>still</i> only catches 99% of cases.  Btw, fantastic presentation about ascii puke here: <a href=\"https://youtu.be/EkluES9Rvak\" rel=\"nofollow noreferrer\">/Reg(exp){2}lained/: Demystifying Regular Expressions</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1079, "user_id": 583910, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/734253eac643b58dcc0f65a0b0f400d5?s=128&d=identicon&r=PG", "display_name": "webbydevy", "link": "https://stackoverflow.com/users/583910/webbydevy"}, "edited": false, "score": 0, "creation_date": 1436406821, "post_id": 31305051, "comment_id": 50602908, "body": "Believe me, I know it is a monster. I ended up pretty much doing what you have suggested for #2 and accepted your answer. Interesting how much the syntax between Go and Javascript differs for Regexp."}], "tags": [], "owner": {"reputation": 3022, "user_id": 2855742, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/7e0f6308b243a91de005292bc440d89c?s=128&d=identicon&r=PG", "display_name": "Rikki Gibson", "link": "https://stackoverflow.com/users/2855742/rikki-gibson"}, "is_accepted": true, "score": 3, "last_activity_date": 1436395011, "creation_date": 1436395011, "answer_id": 31305051, "question_id": 31304999, "link": "https://stackoverflow.com/questions/31304999/translate-go-regexp-to-javascript/31305051#31305051", "title": "Translate Go Regexp to Javascript", "body": "<ol>\n<li><p>There has to be a better way to do what you're doing than that monstrosity of a pattern.</p></li>\n<li><p>Regular expressions tend to be pretty portable. You should just drop it into a regex tester (Google it) or a script file and see if you get the matches you expect. If you don't, rebuild the regex in chunks and see which piece causes it to fail.</p></li>\n</ol>\n"}], "owner": {"reputation": 1079, "user_id": 583910, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/734253eac643b58dcc0f65a0b0f400d5?s=128&d=identicon&r=PG", "display_name": "webbydevy", "link": "https://stackoverflow.com/users/583910/webbydevy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 464, "favorite_count": 0, "accepted_answer_id": 31305051, "answer_count": 1, "score": -1, "last_activity_date": 1459896045, "creation_date": 1436394802, "last_edit_date": 1459896045, "question_id": 31304999, "link": "https://stackoverflow.com/questions/31304999/translate-go-regexp-to-javascript", "title": "Translate Go Regexp to Javascript", "body": "<p>How would this Go Regexp translate to JavaScript?</p>\n\n<pre><code>\"[\\\\w!#$%&amp;'*+/=?^_`{|}~-]+(?:\\\\.[\\\\w!#$%&amp;'*+/=?^_`{|}~-]+)*@(?:[\\\\w](?:[\\\\w-]*[\\\\w])?\\\\.)+[a-zA-Z0-9](?:[\\\\w-]*[\\\\w])?\"\n</code></pre>\n"}, {"tags": ["mysql", "sql", "go", "sql-injection"], "comments": [{"owner": {"reputation": 37954, "user_id": 905902, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a18869332564b1c3dfad9586d37095b2?s=128&d=identicon&r=PG", "display_name": "wildplasser", "link": "https://stackoverflow.com/users/905902/wildplasser"}, "edited": false, "score": 1, "creation_date": 1436393329, "post_id": 31304576, "comment_id": 50599078, "body": "You need dynamic SQL if you want to parametrize table- or column-names. (or prebuild the query as a string, leaving only the <i>constants</i> as parameters)"}], "answers": [{"comments": [{"owner": {"reputation": 1541, "user_id": 395059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad82e88848bab09d379e402207405874?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/395059/joey"}, "edited": false, "score": 0, "creation_date": 1436394017, "post_id": 31304712, "comment_id": 50599326, "body": "Okay, this worked. I wrote a method to check if the column name is within a slice of valid names for each table. I suppose I can look into dynamic SQL if this application logic becomes unwieldy at some point, but for now it&#39;s fine."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 7, "last_activity_date": 1436393357, "creation_date": 1436393357, "answer_id": 31304712, "question_id": 31304576, "link": "https://stackoverflow.com/questions/31304576/how-can-i-use-a-parameterized-query-to-search-on-a-column-by-its-name/31304712#31304712", "title": "How can I use a parameterized query to search on a column by its name?", "body": "<p>This is trying to help keep you safe from bad args (prevent things like SQL injection) but isn't designed to do replacement on anything other than a value. You want it to insert a table name. Unfortunately for you the code is aware of <code>col</code>'s type (string) and quotes it because in SQL it's nvarchar and that's how they literals are written, enclosed in single quotes. Might seem a bit like a hack but you need this instead;</p>\n\n<pre><code>db.Query(fmt.Sprintf(\"SELECT * FROM mytable WHERE %s = ?\", col), searchStr)\n</code></pre>\n\n<p>Putting the table name into your query string before passing it to <code>Query</code> so it doesn't get treated like an argument (ie a value used in the where clause).</p>\n"}, {"comments": [{"owner": {"reputation": 1541, "user_id": 395059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad82e88848bab09d379e402207405874?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/395059/joey"}, "edited": false, "score": 0, "creation_date": 1437172271, "post_id": 31320941, "comment_id": 50935956, "body": "I can&#39;t find an example of how to use gocraft/dbr to parameterize a field within a <code>WHERE</code> clause. I am using the package for other dynamic query building however :)"}, {"owner": {"reputation": 249, "user_id": 3602982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f498120f2b82de0f4e2a9440f7c039d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Phomsopha", "link": "https://stackoverflow.com/users/3602982/sam-phomsopha"}, "reply_to_user": {"reputation": 1541, "user_id": 395059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad82e88848bab09d379e402207405874?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/395059/joey"}, "edited": false, "score": 0, "creation_date": 1437173633, "post_id": 31320941, "comment_id": 50936291, "body": "Using the dbrSess.Select, it would just be this: dbrSess.Select(&quot;id, title&quot;).From(&quot;suggestions&quot;).         Where(&quot;id = ?&quot;, 13).  The resulting sql query would be &quot;select id, title from suggestions where id = 13&quot;"}, {"owner": {"reputation": 1541, "user_id": 395059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad82e88848bab09d379e402207405874?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/395059/joey"}, "edited": false, "score": 2, "creation_date": 1437414560, "post_id": 31320941, "comment_id": 51007185, "body": "In my question as well as my comment I think I made it clear I wanted to parameterize the <code>field</code> being selected on, not the string being searched for."}], "tags": [], "owner": {"reputation": 249, "user_id": 3602982, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f498120f2b82de0f4e2a9440f7c039d7?s=128&d=identicon&r=PG&f=1", "display_name": "Sam Phomsopha", "link": "https://stackoverflow.com/users/3602982/sam-phomsopha"}, "is_accepted": false, "score": 2, "last_activity_date": 1436453269, "creation_date": 1436453269, "answer_id": 31320941, "question_id": 31304576, "link": "https://stackoverflow.com/questions/31304576/how-can-i-use-a-parameterized-query-to-search-on-a-column-by-its-name/31320941#31320941", "title": "How can I use a parameterized query to search on a column by its name?", "body": "<p>You should take a look at this package.\n<a href=\"https://github.com/gocraft/dbr\" rel=\"nofollow\">https://github.com/gocraft/dbr</a></p>\n\n<p>It's great for what you want to do.</p>\n\n<pre><code>import \"github.com/gocraft/dbr\"\n\n// Simple data model\ntype Suggestion struct {\n    Id        int64\n    Title     string\n    CreatedAt dbr.NullTime\n}\n\nvar connection *dbr.Connection\n\nfunc main() {\n\n    db, _ := sql.Open(\"mysql\",\"root@unix(/Applications/MAMP/tmp/mysql/mysql.sock)/dbname\")\n    connection = dbr.NewConnection(db, nil)\n    dbrSess := connection.NewSession(nil)\n\n    // Get a record\n    var suggestion Suggestion\n    err := dbrSess.Select(\"id, title\").From(\"suggestions\").\n        Where(\"id = ?\", 13).\n        LoadStruct(&amp;suggestion)\n\n    if err != nil {\n             fmt.Println(err.Error())\n    } else {\n             fmt.Println(\"Title:\", suggestion.Title)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1541, "user_id": 395059, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/ad82e88848bab09d379e402207405874?s=128&d=identicon&r=PG", "display_name": "Joey", "link": "https://stackoverflow.com/users/395059/joey"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 887, "favorite_count": 0, "accepted_answer_id": 31304712, "answer_count": 2, "score": 5, "last_activity_date": 1436453269, "creation_date": 1436392676, "last_edit_date": 1436394045, "question_id": 31304576, "link": "https://stackoverflow.com/questions/31304576/how-can-i-use-a-parameterized-query-to-search-on-a-column-by-its-name", "title": "How can I use a parameterized query to search on a column by its name?", "body": "<p>My users should be able to search the database by entering a search term in an input box and selecting the column they'd like to search on from a dropdown box.</p>\n\n<p>However, I can't find a way to parameterize a query in golang such that the column name is recognized as a column name instead of a value. Let me give an example:</p>\n\n<pre><code>rows, err := db.Query(\"SELECT * FROM mytable WHERE ? = ?\", col, searchStr)\n</code></pre>\n\n<p>I turned on MySQL logging and this was the resulting query:</p>\n\n<pre><code>   41 Execute   SELECT *\n    FROM mytable \n    WHERE 'Username' = 'Foo'\n</code></pre>\n\n<p>Clearly <code>Username</code> should not have single quotes around it.</p>\n\n<p>How can I parameterize this query? Do I have to write application logic to check each query for the proper column names and use string manipulation to add the column name into the query (perhaps using some placeholder character to find-and-replace)? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 81, "user_id": 4257253, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/23SFY.png?s=128&g=1", "display_name": "bluehexagons", "link": "https://stackoverflow.com/users/4257253/bluehexagons"}, "edited": false, "score": 0, "creation_date": 1436391035, "post_id": 31303966, "comment_id": 50598019, "body": "<code>groups</code> is an array, with &quot;foo&quot; being at index 1 and &quot;bar&quot; being at 2; so 0 is just a default value (empty string), but still technically there. xGroups is a map that only has entries for 1 and 2."}], "answers": [{"comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 2, "creation_date": 1436401881, "post_id": 31304549, "comment_id": 50601756, "body": "It&#39;s also worth noting that order of iteration for a map is not defined and can be different even on a subsequent run."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1436393737, "last_edit_date": 1436393737, "creation_date": 1436392558, "answer_id": 31304549, "question_id": 31303966, "link": "https://stackoverflow.com/questions/31303966/golang-declaring-maps-and-slices-with-iota-values/31304549#31304549", "title": "Golang: declaring maps and slices with iota values", "body": "<p>You're expecting <code>range</code> to behave the same on both types but in the first case it's ranging over an array and you just have an empty index 0. The value being stored in <code>k</code> is the current index; 0, 1, 2. In your second example you're ranging over the map and getting the key stored in <code>k</code> which only contains 1 and 2.</p>\n\n<p>You might be wondering how is this happening? It's because this;</p>\n\n<pre><code>var groups = [...]string{\n    fooGroup: \"foo\",\n    barGroup: \"bar\",\n}\n</code></pre>\n\n<p>Little confusing (imo very bad) code is giving you this;</p>\n\n<pre><code>var groups = [...]string{\n    1: \"foo\",\n    2: \"bar\",\n}\n</code></pre>\n\n<p>Which is causing <code>groups</code> to be allocated/initialized with an empty string in index 0. Of course, the map doesn't need a key 0 to let you put something there in key 1 so it doesn't suffer from the same problems. If this is anything more than an exercise to demonstrate the features of the language I would highly recommend you get rid of the intentionally obfuscated code and use more clear constructs for constants, types and initialization.</p>\n\n<p>If your skeptical about that mechanism add the following lines to your main and you can clearly see </p>\n\n<pre><code>fmt.Printf(\"Lenght of groups is %d and index 0 is %s\\n\", len(groups), groups[0])\nfmt.Printf(\"Lenght of xGroups is %d\\n\", len(xGroups))\n</code></pre>\n"}], "owner": {"reputation": 3847, "user_id": 251840, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e3bf4bcc6dfbe7c13231f914334db925?s=128&d=identicon&r=PG", "display_name": "jwesonga", "link": "https://stackoverflow.com/users/251840/jwesonga"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1021, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436393737, "creation_date": 1436390345, "question_id": 31303966, "link": "https://stackoverflow.com/questions/31303966/golang-declaring-maps-and-slices-with-iota-values", "title": "Golang: declaring maps and slices with iota values", "body": "<p>I have this Go code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype baseGroup int\n\nconst (\n    fooGroup baseGroup = iota + 1\n    barGroup\n)\n\nvar groups = [...]string{\n    fooGroup: \"foo\",\n    barGroup: \"bar\",\n}\n\nvar xGroups = map[baseGroup]string{\n    fooGroup: \"foo\",\n    barGroup: \"bar\",\n}\n\nfunc main() {\n    fmt.Println(\"groups\")\n    for k, v := range groups {\n        fmt.Println(k, v)\n    }\n\n    fmt.Println(\"xGroups\")\n    for k, v := range xGroups {\n        fmt.Println(k, v)\n    }\n}\n</code></pre>\n\n<p>If i run the code i get:</p>\n\n<pre><code>groups\n0 \n1 foo\n2 bar\nxGroups\n1 foo\n2 bar\n</code></pre>\n\n<p>I'm wondering why the different outputs?</p>\n"}, {"tags": ["go", "lisp", "interpreter", "s-expression"], "comments": [{"owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "edited": false, "score": 0, "creation_date": 1436393655, "post_id": 31302815, "comment_id": 50599199, "body": "It actually is a parsing problem, not a lisp one. An example of s-expressions could help to answer."}, {"owner": {"reputation": 44043, "user_id": 1565698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7dace33805b9dcdec5aa63308daf88dc?s=128&d=identicon&r=PG", "display_name": "Sylwester", "link": "https://stackoverflow.com/users/1565698/sylwester"}, "edited": false, "score": 1, "creation_date": 1436402334, "post_id": 31302815, "comment_id": 50601858, "body": "A counter wouldn&#39;t work. Just like with lis.py you need to use stack or recursion to parse code into cons and symbols."}], "answers": [{"tags": [], "owner": {"reputation": 28585, "user_id": 23567, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/HmHeE.png?s=128&g=1", "display_name": "soegaard", "link": "https://stackoverflow.com/users/23567/soegaard"}, "is_accepted": false, "score": 1, "last_activity_date": 1436481224, "creation_date": 1436481224, "answer_id": 31329433, "question_id": 31302815, "link": "https://stackoverflow.com/questions/31302815/parsing-s-expressions-in-go/31329433#31329433", "title": "Parsing s-expressions in Go", "body": "<p>There is an S-expression parser implemented in Go at Rosetta code:</p>\n\n<p><a href=\"http://rosettacode.org/wiki/S-Expressions#Go\" rel=\"nofollow\">S-expression parser in Go</a></p>\n\n<p>It might give you an idea of how to attack the problem.</p>\n"}, {"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 1, "last_activity_date": 1436531413, "creation_date": 1436531413, "answer_id": 31340828, "question_id": 31302815, "link": "https://stackoverflow.com/questions/31302815/parsing-s-expressions-in-go/31340828#31340828", "title": "Parsing s-expressions in Go", "body": "<p>You'd probably need to have an interface \"Sexpr\" and ensure that your symbol and list data structures matches the interface. Then you can use the fact that an S-expression is simply \"a single symbol\" or \"a list of S-expressions\".</p>\n\n<p>That is, if the first character is \"(\", it's not a symbol, but a list, so start accumulating a []Sexpr, reading each contained Sexpr at a time, until you hit a \")\" in your input stream. Any contained list will already have had its terminal \")\" consumed.</p>\n\n<p>If it's not a \"(\", you're reading a symbol, so read until you hit a non-symbol-constituent character, unconsume it and return the symbol.</p>\n"}], "owner": {"reputation": 69, "user_id": 4996401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb89e2cf45084d095f214b4906c61cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/4996401/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1436534408, "creation_date": 1436386474, "last_edit_date": 1436534408, "question_id": 31302815, "link": "https://stackoverflow.com/questions/31302815/parsing-s-expressions-in-go", "title": "Parsing s-expressions in Go", "body": "<p>Here's a link to lis.py if you're unfamiliar: <a href=\"http://norvig.com/lispy.html\" rel=\"nofollow\">http://norvig.com/lispy.html</a></p>\n\n<p>I'm trying to implement a tiny lisp interpreter in Go. I've been inspired by Peter Norvig's Lis.py lisp implementation in Python.</p>\n\n<p>My problem is I can't think of a single somewhat efficient way to parse the s-expressions. I had thought of a counter that would increment by 1 when it see's a \"(\" and that would decrement when it sees a \")\". This way when the counter is 0 you know you've got a complete expression.</p>\n\n<p>But the problem with that is that it means you have to loop for every single expression which would make the interpreter incredibly slow for any large program.</p>\n\n<p>Any alternative ideas would be great because I can't think of any better way.</p>\n"}, {"tags": ["concurrency", "go", "parallel-processing"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1436367715, "post_id": 31296054, "comment_id": 50583640, "body": "Probably the first one finishes before the other one gets a chance to start. make them run longer and you&#39;ll see it in parallel."}], "answers": [{"tags": [], "owner": {"reputation": 7084, "user_id": 640277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/14f57fec5c9a807c0eeff896afb5ad86?s=128&d=identicon&r=PG", "display_name": "Ezra", "link": "https://stackoverflow.com/users/640277/ezra"}, "is_accepted": true, "score": 6, "last_activity_date": 1436370410, "last_edit_date": 1436370410, "creation_date": 1436370091, "answer_id": 31297452, "question_id": 31296054, "link": "https://stackoverflow.com/questions/31296054/why-is-my-supposedly-parallel-go-program-not-parallel/31297452#31297452", "title": "Why is my supposedly parallel go program not parallel", "body": "<p>You're missing nothing. It's working. The calls aren't showing up \"interlaced\" (mixed up) not because they're not being parallelized, but because they're happening <em>really fast</em>.</p>\n\n<p>You can easily add some calls to <code>time.Sleep</code> to see the parallelization better. By sleeping, we know 100% that printing <code>alphabets</code> and <code>numbers</code> should be interlaced.</p>\n\n<h2>Your program with <code>Sleep</code> calls to \"force\" interlacing</h2>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nvar wg sync.WaitGroup\n\nfunc alphabets() {\n    defer wg.Done()\n    for char := 'a'; char &lt; 'a'+26; char++ {\n        fmt.Printf(\"%c \", char)\n        time.Sleep(time.Second * 2)\n    }\n}\n\nfunc numbers() {\n    defer wg.Done()\n    for number := 1; number &lt; 27; number++ {\n        fmt.Printf(\"%d \", number)\n        time.Sleep(time.Second * 3)\n    }    \n}\n\nfunc main() {\n    fmt.Println(\"Starting Go Routines\")\n    wg.Add(2)\n    go alphabets()\n    go numbers()\n\n    fmt.Println(\"\\nWaiting To Finish\")\n    wg.Wait()\n    fmt.Println(\"\\nTerminating Program\")\n}\n</code></pre>\n\n<h2>Note</h2>\n\n<p>You probably already know this, but setting <code>GOMAXPROCS</code> doesn't have any effect on whether or not this example is executed in parallel, just how many resources it consumes.</p>\n\n<blockquote>\n  <p>The GOMAXPROCS setting controls how many operating systems threads attempt to execute code simultaneously. For example, if GOMAXPROCS is 4, then the program will only execute code on 4 operating system threads at once, even if there are 1000 goroutines. The limit does not count threads blocked in system calls such as I/O.</p>\n</blockquote>\n\n<p>Source: <a href=\"http://golang.org/s/go15gomaxprocs\">Go 1.5 GOMAXPROCS Default</a></p>\n"}, {"tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1436370245, "creation_date": 1436370245, "answer_id": 31297515, "question_id": 31296054, "link": "https://stackoverflow.com/questions/31296054/why-is-my-supposedly-parallel-go-program-not-parallel/31297515#31297515", "title": "Why is my supposedly parallel go program not parallel", "body": "<p>Are you using the Go playground by any chance? When I run your code locally, I get:</p>\n\n<pre><code>Starting Go Routines\n\nWaiting To Finish\n1 2 3 4 5 6 7 8 9 10 11 12 a 13 14 15 16 17 b 18 19 c 20 21 d 22 23 e 24 25 f 26 g h i j k l m n o p q r s t u v w x y z \nTerminating Program\n</code></pre>\n\n<p>The playground is deterministic in nature. Goroutines don't yield as often and don't run in multiple threads.</p>\n"}], "owner": {"reputation": 11396, "user_id": 2768067, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hSTUv.png?s=128&g=1", "display_name": "Komu", "link": "https://stackoverflow.com/users/2768067/komu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 31297452, "answer_count": 2, "score": 0, "last_activity_date": 1436370410, "creation_date": 1436366624, "last_edit_date": 1436370038, "question_id": 31296054, "link": "https://stackoverflow.com/questions/31296054/why-is-my-supposedly-parallel-go-program-not-parallel", "title": "Why is my supposedly parallel go program not parallel", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"sync\"\n)\n\nvar wg sync.WaitGroup\n\nfunc alphabets() {\n    for char := 'a'; char &lt; 'a'+26; char++ {\n        fmt.Printf(\"%c \", char)\n    }\n    wg.Done() //decrement number of goroutines to wait for\n}\n\nfunc numbers() {\n    for number := 1; number &lt; 27; number++ {\n        fmt.Printf(\"%d \", number)\n    }\n    wg.Done()\n}\n\nfunc main() {\n    runtime.GOMAXPROCS(2)\n    wg.Add(2) //wait for two goroutines\n\n    fmt.Println(\"Starting Go Routines\")\n    go alphabets()\n    go numbers()\n\n    fmt.Println(\"\\nWaiting To Finish\")\n\n    wg.Wait() //wait for the two goroutines to finish executing\n\n    fmt.Println(\"\\nTerminating Program\")\n}\n</code></pre>\n\n<p>I expect the output to be mixed up(for lack of a better word), but instead; a sample output is:</p>\n\n<p>$ go run parallel_prog.go </p>\n\n<p>Starting Go Routines\nWaiting To Finish\na b c d e f g h i j k l m n o p q r s t u v w x y z 1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \nTerminating Program</p>\n\n<p>What I'm I missing?</p>\n\n<p>Thanks,</p>\n"}, {"tags": ["go", "aerospike"], "answers": [{"tags": [], "owner": {"reputation": 2459, "user_id": 1364745, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/8wyHq.jpg?s=128&g=1", "display_name": "kporter", "link": "https://stackoverflow.com/users/1364745/kporter"}, "is_accepted": true, "score": 5, "last_activity_date": 1436368839, "creation_date": 1436368839, "answer_id": 31296956, "question_id": 31294985, "link": "https://stackoverflow.com/questions/31294985/how-to-get-list-of-sets-with-aerospike-go-client/31296956#31296956", "title": "How to get list of sets with Aerospike go client?", "body": "<p>You are looking for the \"info\" commands.</p>\n\n<p><a href=\"https://godoc.org/github.com/aerospike/aerospike-client-go#RequestInfo\" rel=\"noreferrer\">https://godoc.org/github.com/aerospike/aerospike-client-go#RequestInfo</a></p>\n\n<p>For your request, you will need to invoke the \"sets\" command.</p>\n\n<p><a href=\"http://www.aerospike.com/docs/reference/info/#sets\" rel=\"noreferrer\">http://www.aerospike.com/docs/reference/info/#sets</a></p>\n"}], "owner": {"reputation": 468, "user_id": 1117026, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/1b833426c9221e4b886def0ddd170d05?s=128&d=identicon&r=PG", "display_name": "elgris", "link": "https://stackoverflow.com/users/1117026/elgris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 969, "favorite_count": 0, "accepted_answer_id": 31296956, "answer_count": 1, "score": 3, "last_activity_date": 1436368839, "creation_date": 1436363967, "question_id": 31294985, "link": "https://stackoverflow.com/questions/31294985/how-to-get-list-of-sets-with-aerospike-go-client", "title": "How to get list of sets with Aerospike go client?", "body": "<p>With Aerospike aql tool it's possible to execute \"SHOW SETS\" query and get list of all available sets in a namespace. But how to get this list with Aerospike golang client?</p>\n"}, {"tags": ["http", "go", "error-handling", "exit", "abort"], "answers": [{"comments": [{"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1436360851, "post_id": 31293435, "comment_id": 50577981, "body": "yes, I said for the the main function it&#39;s OK ,but for  the other functions it doesn&#39;t work because <b>return</b> exit just the function not the  HTTP request."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1436361250, "post_id": 31293435, "comment_id": 50578284, "body": "@Aziz Then you have to return this error state to <code>ServeHTTP()</code> so that it can return. See the edited answer which shows an example to this."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1436373378, "last_edit_date": 1495541711, "creation_date": 1436360271, "answer_id": 31293435, "question_id": 31293314, "link": "https://stackoverflow.com/questions/31293314/terminating-or-aborting-an-http-request/31293435#31293435", "title": "Terminating or aborting an HTTP request", "body": "<p>Terminating the serving of an HTTP request is nothing more than to return from the <code>ServeHTTP()</code> method, e.g.:</p>\n\n<pre><code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    // examine incoming params\n    if !ok {\n        str := `{\"Result\":\"\",\"Error\":\"No valide Var\"}`\n        fmt.Fprint(w, str)\n        return\n    }\n\n    // Do normal API serving\n})\n\npanic(http.ListenAndServe(\":8080\", nil))\n</code></pre>\n\n<p><strong>Notes:</strong></p>\n\n<p>If the input params of your API service are invalid, you should consider returning an HTTP error code instead of the implied default <code>200 OK</code>. For this you can use the <a href=\"https://golang.org/pkg/net/http/#Error\" rel=\"nofollow noreferrer\"><code>http.Error()</code></a> function, for example:</p>\n\n<pre><code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    // examine incoming params\n    if !ok {\n        http.Error(w, `Invalid input params!`, http.StatusBadRequest) \n        return\n    }\n\n    // Do normal API serving\n})\n</code></pre>\n\n<p>For a more sophisticated example where you send back JSON data along with the error code:</p>\n\n<pre><code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    // examine incoming params\n    if !ok {\n        w.Header().Set(\"Content-Type\", \"application/json\")\n        w.WriteHeader(http.StatusBadRequest)\n        str := `{\"Result\":\"\",\"Error\":\"No valide Var\"}`\n        fmt.Fprint(w, str)\n        return\n    }\n\n    // Do normal API serving\n})\n</code></pre>\n\n<p><strong>Example showing how to propagate \"returning\"</strong></p>\n\n<p>If the error is detected outside of <code>ServeHTTP()</code>, e.g. in a function that is called from <code>ServeHTTP()</code>, you have to return this error state so that <code>ServeHTTP()</code> can return.</p>\n\n<p>Let's assume you have the following custom type for your required parameters and a function which is responsible to decode them from a request:</p>\n\n<pre><code>type params struct {\n    // fields for your params \n}\n\nfunc decodeParams(r *http.Request) (*params, error) {\n    p := new(params)\n    // decode params, if they are invalid, return an error:\n\n    if !ok {\n        return nil, errors.New(\"Invalid params\")\n    }\n\n    // If everything goes well:\n    return p, nil\n}\n</code></pre>\n\n<p>Using these:</p>\n\n<pre><code>http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n    p, err := decodeParams(r)\n    if err != nil {\n        http.Error(w, `Invalid input params!`, http.StatusBadRequest)\n        return\n    }\n\n    // Do normal API serving\n})\n</code></pre>\n\n<p>Also see this related question: <a href=\"https://stackoverflow.com/questions/30858823/golang-how-to-return-in-func-from-another-func\">Golang, how to return in func FROM another func?</a></p>\n"}], "owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3858, "favorite_count": 0, "accepted_answer_id": 31293435, "answer_count": 1, "score": 4, "last_activity_date": 1560856642, "creation_date": 1436359928, "last_edit_date": 1560856642, "question_id": 31293314, "link": "https://stackoverflow.com/questions/31293314/terminating-or-aborting-an-http-request", "title": "Terminating or aborting an HTTP request", "body": "<p>What's the way to abort my <strong>API</strong> serving with some error message?</p>\n\n<p>Link to call my service:</p>\n\n<pre><code>http://creative.test.spoti.io/api/getVastPlayer?add=\n    {\"Json\":Json}&amp;host=api0.spoti.io&amp;domain=domain&amp;userAgent=userAgent&amp;mobile=true\n</code></pre>\n\n<p>To call my service the client need to send a Json and some params.</p>\n\n<p>I want to test if the params that I get are correct, if not I want send a error message.</p>\n\n<p>The response should be a Json Code <code>{\"Result\":\"Result\",\"Error\":\"error message\"}</code>  </p>\n\n<p>I tried <code>log.fatal</code> and <code>os.Exit(1)</code> they stop the service, not just the call request. <code>panic</code> aborts the call but it prevents me to send a <code>http.ResponseWriter</code> which is my error message.</p>\n\n<p>I read something about <strong>panic, defer, recover</strong> but I don't really know how can I use them to solve this problem.</p>\n\n<p><code>return</code> works:</p>\n\n<pre><code>mobile :=query.Get(\"mobile\")\nif mobile==\"mobile\" {\n            str:=`{\"Resultt\":\"\",\"Error\":\"No valide Var\"}`\n            fmt.Fprint(w, str)      \n            fmt.Println(\"No successfull Operation!!\")\n            return}  \n</code></pre>\n\n<p><strong>But I can use it just in the main function, because in the other functions it exits just the func not the caller function (request).</strong>  </p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1436358388, "creation_date": 1436358388, "answer_id": 31292646, "question_id": 31292548, "link": "https://stackoverflow.com/questions/31292548/how-to-set-nsec-to-zero-for-a-time-time-typed-value/31292646#31292646", "title": "How to set nsec to zero for a time.Time typed value", "body": "<p>Use <a href=\"http://golang.org/pkg/time/#Time.Truncate\" rel=\"nofollow\"><code>time.Truncate</code></a> with <code>time.Second</code>:</p>\n\n<blockquote>\n  <p>Truncate returns the result of rounding t down to a multiple of d (since the zero time). If d &lt;= 0, Truncate returns t unchanged.</p>\n</blockquote>\n\n<p>Playground: <a href=\"http://play.golang.org/p/go-IdYU18E\" rel=\"nofollow\">http://play.golang.org/p/go-IdYU18E</a>.</p>\n"}], "owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 459, "favorite_count": 0, "accepted_answer_id": 31292646, "answer_count": 1, "score": 0, "last_activity_date": 1436358388, "creation_date": 1436358159, "question_id": 31292548, "link": "https://stackoverflow.com/questions/31292548/how-to-set-nsec-to-zero-for-a-time-time-typed-value", "title": "How to set nsec to zero for a time.Time typed value", "body": "<p>There's a time.Time value created from current time, is there any quick way to set its \"nsec\" field to zero? As this part in my case is not useful to map to a second level date time field in mysql.  </p>\n"}, {"tags": ["go", "floating-point-conversion"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436353700, "post_id": 31289409, "comment_id": 50572742, "body": "In <code>%.Ng</code> N is a total number of digits, not a precision. Unfortunately I don&#39;t think you can implement your requirements using <code>Sprintf</code> only."}], "answers": [{"tags": [], "owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "is_accepted": false, "score": 7, "last_activity_date": 1436354874, "last_edit_date": 1436354874, "creation_date": 1436350409, "answer_id": 31289629, "question_id": 31289409, "link": "https://stackoverflow.com/questions/31289409/format-a-float-to-n-decimal-places-and-no-trailing-zeros/31289629#31289629", "title": "Format a float to n decimal places and no trailing zeros", "body": "<p>Not sure for <code>Sprintf</code> but to make it worked. Just trim right, first <code>0</code> then <code>.</code>.</p>\n\n<pre><code>fmt.Println(strings.TrimRight(strings.TrimRight(fmt.Sprintf(\"%.2f\", 100.900), \"0\"), \".\")) // 100.9\nfmt.Println(strings.TrimRight(strings.TrimRight(fmt.Sprintf(\"%.2f\", 100.0), \"0\"), \".\")) // 100\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 56, "user_id": 5277433, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/83QVg.jpg?s=128&g=1", "display_name": "devoxel", "link": "https://stackoverflow.com/users/5277433/devoxel"}, "edited": false, "score": 5, "creation_date": 1507900313, "post_id": 40555281, "comment_id": 80407560, "body": "This does not strictly solve their problem, because they want a precision of 2 points."}], "tags": [], "owner": {"reputation": 406, "user_id": 1798422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bede5ac6e10de479a4b377c78ab0a05e?s=128&d=identicon&r=PG", "display_name": "Eric E.", "link": "https://stackoverflow.com/users/1798422/eric-e"}, "is_accepted": true, "score": 39, "last_activity_date": 1478894179, "creation_date": 1478894179, "answer_id": 40555281, "question_id": 31289409, "link": "https://stackoverflow.com/questions/31289409/format-a-float-to-n-decimal-places-and-no-trailing-zeros/40555281#40555281", "title": "Format a float to n decimal places and no trailing zeros", "body": "<p><code>strconv.FormatFloat(10.900, 'f', -1, 64)</code></p>\n\n<p>This will result in <code>10.9</code>.</p>\n\n<p>The <code>-1</code> as the third parameter tells the function to print the fewest digits necessary to accurately represent the float.</p>\n\n<p>See here: <a href=\"https://golang.org/pkg/strconv/#FormatFloat\" rel=\"noreferrer\">https://golang.org/pkg/strconv/#FormatFloat</a></p>\n"}, {"tags": [], "owner": {"reputation": 415, "user_id": 2692945, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PZexo.jpg?s=128&g=1", "display_name": "Hamid Karimi", "link": "https://stackoverflow.com/users/2692945/hamid-karimi"}, "is_accepted": false, "score": 2, "last_activity_date": 1547759740, "creation_date": 1547759740, "answer_id": 54244410, "question_id": 31289409, "link": "https://stackoverflow.com/questions/31289409/format-a-float-to-n-decimal-places-and-no-trailing-zeros/54244410#54244410", "title": "Format a float to n decimal places and no trailing zeros", "body": "<p>I used the below func to achive the same:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>//return 45.00 with \"45\" or 45.50 with \"45.5\"\nfunc betterFormat(num float32) string {\n    s := fmt.Sprintf(\"%.4f\", num)\n    return strings.TrimRight(strings.TrimRight(s, \"0\"), \".\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 3, "user_id": 13535383, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Y2Qd1.jpg?s=128&g=1", "display_name": "Sadegh Ramezani", "link": "https://stackoverflow.com/users/13535383/sadegh-ramezani"}, "is_accepted": false, "score": 0, "last_activity_date": 1592073282, "creation_date": 1592073282, "answer_id": 62364101, "question_id": 31289409, "link": "https://stackoverflow.com/questions/31289409/format-a-float-to-n-decimal-places-and-no-trailing-zeros/62364101#62364101", "title": "Format a float to n decimal places and no trailing zeros", "body": "<p>Use the below function to format and controls the number of digits.</p>\n\n<pre><code>func FormatFloat(num float64, prc int) string {\n    var (\n        zero, dot = \"0\", \".\"\n\n        str = fmt.Sprintf(\"%.\"+strconv.Itoa(prc)+\"f\", num)\n    )\n\n    return strings.TrimRight(strings.TrimRight(str, zero), dot)\n}\n</code></pre>\n\n<p>Here is an example:</p>\n\n<pre><code>// Convert 18.24100100 to 18.24\nfmt.Print(FormatFloat(18.24100100, 2))\n</code></pre>\n"}], "owner": {"reputation": 11554, "user_id": 451480, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/SU8kZ.jpg?s=128&g=1", "display_name": "Blaise", "link": "https://stackoverflow.com/users/451480/blaise"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 16119, "favorite_count": 0, "accepted_answer_id": 40555281, "answer_count": 4, "score": 19, "last_activity_date": 1592073282, "creation_date": 1436349817, "question_id": 31289409, "link": "https://stackoverflow.com/questions/31289409/format-a-float-to-n-decimal-places-and-no-trailing-zeros", "title": "Format a float to n decimal places and no trailing zeros", "body": "<p>I want to display a float with the entire integer part and up to two decimals for the fractional part, without trailing zeros.</p>\n\n<p><a href=\"http://play.golang.org/p/mAdQl6erWX\" rel=\"noreferrer\">http://play.golang.org/p/mAdQl6erWX</a>:</p>\n\n<pre><code>// Desired output: \n// \"1.9\"\n// \"10.9\"\n// \"100.9\"\n\nfmt.Println(\"2g:\")\nfmt.Println(fmt.Sprintf(\"%.2g\", 1.900)) // outputs \"1.9\"\nfmt.Println(fmt.Sprintf(\"%.2g\", 10.900)) // outputs \"11\"\nfmt.Println(fmt.Sprintf(\"%.2g\", 100.900)) // outputs \"1e+02\"\n\nfmt.Println(\"\\n2f:\")\nfmt.Println(fmt.Sprintf(\"%.2f\", 1.900)) // outputs \"1.90\"\nfmt.Println(fmt.Sprintf(\"%.2f\", 10.900)) // outputs \"10.90\"\nfmt.Println(fmt.Sprintf(\"%.2f\", 100.900)) // outputs \"100.90\"\n</code></pre>\n\n<p>Formatting with <code>2g</code> has the problem that it starts rounding when the integer increases order of magnitudes. Also, it sometimes displays numbers with an <code>e</code>.</p>\n\n<p>Formatting with <code>2f</code> has the problem that it will display trailing zeros. I could write a post-processing function that removes trailing zeros, but I rather do this with <code>Sprintf</code>.</p>\n\n<p>Can this be done in a generic way using <code>Sprintf</code>?<br>\nIf not, what's a good way to do this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "reply_to_user": {"reputation": 73, "user_id": 4007499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9daa97346b817786b4ea6e5d108a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4007499/michael"}, "edited": false, "score": 0, "creation_date": 1436346678, "post_id": 31288103, "comment_id": 50568257, "body": "It will be agains the site rules to answer &quot;homework&quot;-style questions by providing complete code. But I can sketch the solution - see above."}], "tags": [], "owner": {"reputation": 11891, "user_id": 1930219, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/5ae618e4950c81bf0d83d17c2c2ddaab?s=128&d=identicon&r=PG", "display_name": "Alex Netkachov", "link": "https://stackoverflow.com/users/1930219/alex-netkachov"}, "is_accepted": false, "score": 0, "last_activity_date": 1436347050, "last_edit_date": 1495539883, "creation_date": 1436346245, "answer_id": 31288103, "question_id": 31287644, "link": "https://stackoverflow.com/questions/31287644/how-to-filter-the-elements-in-the-given-data-using-golang/31288103#31288103", "title": "How to filter the elements in the given data using golang?", "body": "<ol>\n<li>You need to design the data model for your data. You have several alternatives here but most simple one is struct with three fields: for name, for department and for college. The data is in the array. Read about data structures here: <a href=\"https://golang.org/doc/effective_go.html#data\" rel=\"nofollow noreferrer\">https://golang.org/doc/effective_go.html#data</a></li>\n<li>You need to initialise your data structure. Maybe you have the input in text file? Then you can use methods of the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">fmt</a> or <a href=\"http://golang.org/pkg/bufio/\" rel=\"nofollow noreferrer\">bufio</a> to read it.</li>\n<li>They you need to read the command line arguments - get them from <a href=\"http://golang.org/pkg/os/#pkg-variables\" rel=\"nofollow noreferrer\">os.Args</a>.</li>\n<li>The filter data and output the result. This is a simple <code>for</code> loop over the slice with one <code>if</code> in it. Use <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow noreferrer\">Println</a> to output the result.</li>\n</ol>\n\n<p>Sample code:</p>\n\n<pre><code>package main\n\nimport (\n  . \"fmt\"\n  \"os\"\n)\n\ntype Record struct {\n  Name string\n  Department string\n  College string\n}\n\nfunc main() {\n  records := make([]Record, 0)\n\n  // add records\n  records = append(records, Record{\"A1\", \"CSE\", \"SR1\"})\n  ...\n\n  // get filter from os.Args\n  filter := ...\n\n  for _, v := range records {\n    if v.College == filter {\n      Println(v.Name, v.Department)\n    }\n  }\n}\n</code></pre>\n\n<p>P.S. If you ask yourself why the question is downvoted (not by me) - because it does not demonstrate the you actually tried to solve the problem. See <a href=\"https://stackoverflow.com/help/on-topic\">https://stackoverflow.com/help/on-topic</a></p>\n"}], "owner": {"reputation": 73, "user_id": 4007499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9daa97346b817786b4ea6e5d108a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4007499/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 860, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1451421381, "creation_date": 1436344993, "last_edit_date": 1451421381, "question_id": 31287644, "link": "https://stackoverflow.com/questions/31287644/how-to-filter-the-elements-in-the-given-data-using-golang", "title": "How to filter the elements in the given data using golang?", "body": "<p>This is the input data:</p>\n\n<pre><code> Name   Dept    College\n A1     CSE     SR1\n A2     CSE     SR2\n A3     ECE     SR1\n A4     EEE     SR3\n A5     ECE     SR1\n A6     MECH    SR2\n A7     CSE     SR1\n A8     EEE     SR1\n A9     ECE     SR3\n A10    MECH    SR3\n A11    EEE     SR1\n</code></pre>\n\n<p>Expected output:\nIf I filter the college name (for example: <code>--flag=SR3</code>) the output should print under <code>SR3</code> , what are the names and depts are there.</p>\n\n<pre><code>A4 EEE\n\nA10 MECH\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1436347699, "post_id": 31287325, "comment_id": 50568948, "body": "can&#39;t call function from template, that&#39;s true. so will you go ahead with <code>wrapper function</code>?  show your current works on it and let people help you work it out."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1436348858, "post_id": 31287325, "comment_id": 50569710, "body": "Related: <a href=\"http://stackoverflow.com/questions/31221849/text-template-cant-call-method-function-with-0-results\">Text/template: \u201ccan&#39;t call method/function with 0 results.\u201d</a>. Solution is the same: you have to create a custom function."}, {"owner": {"reputation": 63, "user_id": 5092855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469fc013c4d23b9d17eed3e9f3958139?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Charlton", "link": "https://stackoverflow.com/users/5092855/andrew-charlton"}, "edited": false, "score": 0, "creation_date": 1436355452, "post_id": 31287325, "comment_id": 50573892, "body": "I tried to make a function (FirstValue) that would take another function as its argument, and then return just the first value of the original output.  Unfortunately it seems that I can&#39;t then pass the method through in the template so it won&#39;t work:  {{FirstValue .Baz}} calls .Baz() }}rather than passes it, so it&#39;s a no go."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1500204315, "post_id": 31287325, "comment_id": 77225688, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/31221849/text-template-cant-call-method-function-with-0-results\">Text/template: &quot;can&#39;t call method/function with 0 results.&quot;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 5092855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469fc013c4d23b9d17eed3e9f3958139?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Charlton", "link": "https://stackoverflow.com/users/5092855/andrew-charlton"}, "edited": false, "score": 0, "creation_date": 1436355765, "post_id": 31290524, "comment_id": 50574086, "body": "Thanks a lot.  I though that was probably the case.  My solution involves doing a set of calculations by iterating through a set of items and doing some (linked) work with them.  I&#39;m trying to avoid the overhead of iterating through multiple times, which would essentially double the calculations needed.  I like the idea of passing a struct back though, that makes a lot of sense.  Thanks!"}], "tags": [], "owner": {"reputation": 5331, "user_id": 555017, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/06aa109f3832c30df43af5fcd2f13d9c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/555017/jonathan"}, "is_accepted": true, "score": 6, "last_activity_date": 1436352723, "last_edit_date": 1495539946, "creation_date": 1436352723, "answer_id": 31290524, "question_id": 31287325, "link": "https://stackoverflow.com/questions/31287325/using-methods-with-multiple-return-values/31290524#31290524", "title": "Using methods with multiple return values", "body": "<p>You won't be able to call a function that returns two values in a template unless one of those values is an error. This is so that your template is guaranteed to work at runtime. There is a great answer that explains that <a href=\"https://stackoverflow.com/a/28233172/555017\">here</a>, if you're interested.</p>\n\n<p>To solve your problem you need to either 1) break your function into two separate getter functions that you can call in the appropriate place in your template; or 2) have your function return a simple struct with the values inside.</p>\n\n<p>I can't tell which would be better for you because I really have no idea what your implementation requires. Foo and Baz don't give many clues. ;)</p>\n\n<p>Here is a quick-n-dirty example of option one:</p>\n\n<pre><code>type Foo struct {\n    Name string\n}\n\nfunc (f Foo) GetA() (int) {\n    return 1\n}\n\nfunc (f Foo) GetB() (int) {\n    return 5\n}\n</code></pre>\n\n<p>And then modify the template accordingly:</p>\n\n<pre><code>const tmpl = `Name: {{.Name}}, Ints: {{.GetA}}, {{.GetB}}`\n</code></pre>\n\n<p>Hopefully this is of some help. :)</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 865715, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466c72454aa889d7df070a37c06c8e1b?s=128&d=identicon&r=PG", "display_name": "phonkee", "link": "https://stackoverflow.com/users/865715/phonkee"}, "is_accepted": false, "score": 2, "last_activity_date": 1477758584, "creation_date": 1477758584, "answer_id": 40321201, "question_id": 31287325, "link": "https://stackoverflow.com/questions/31287325/using-methods-with-multiple-return-values/40321201#40321201", "title": "Using methods with multiple return values", "body": "<p>There is also possibility to return struct with multiple fields and use them.</p>\n\n<pre><code>type Result struct {\n    First string\n    Second string\n}\n\nfunc GetResult() Result {\n     return Result{First: \"first\", Second: \"second\"}\n}\n</code></pre>\n\n<p>And then use in template</p>\n\n<pre><code>{{$result := GetResult}}\n{{$result.First}} - {{$result.Second}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 9911189, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-FpQ1Ants5QU/AAAAAAAAAAI/AAAAAAAAAAc/E4smqVInW44/photo.jpg?sz=128", "display_name": "Arthur Ruckman", "link": "https://stackoverflow.com/users/9911189/arthur-ruckman"}, "is_accepted": false, "score": 0, "last_activity_date": 1556387639, "creation_date": 1556387639, "answer_id": 55883331, "question_id": 31287325, "link": "https://stackoverflow.com/questions/31287325/using-methods-with-multiple-return-values/55883331#55883331", "title": "Using methods with multiple return values", "body": "<p>I recently had a problem similar to this one and came across this question. I think this might be a little cleaner. It doesn't require you to create multiple new functions:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>const tmpl = `Name: {{.Name}}, Ints: {{BazWrapper .}}`\n\nfunc main() {\n\n    f := Foo{\"Foo\"}\n\n    funcMap := template.FuncMap{\n        \"BazWrapper\": func(f Foo) string {\n            a, b := f.Baz()\n            return fmt.Sprintf(\"%d, %d\", a, b)\n        },\n    }\n\n    t, err := template.New(\"test\").Funcs(funcMap).Parse(tmpl)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    t.Execute(os.Stdout, f)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 5092855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/469fc013c4d23b9d17eed3e9f3958139?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Charlton", "link": "https://stackoverflow.com/users/5092855/andrew-charlton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2533, "favorite_count": 1, "accepted_answer_id": 31290524, "answer_count": 3, "score": 6, "last_activity_date": 1556387639, "creation_date": 1436344083, "last_edit_date": 1500204300, "question_id": 31287325, "link": "https://stackoverflow.com/questions/31287325/using-methods-with-multiple-return-values", "title": "Using methods with multiple return values", "body": "<p>I'm trying to write a template (using html/template) and passing it a struct that has some methods attached to it, many of which return multiple values.  Is there any way of accessing these from within the template?  I'd like to be able to do something like:</p>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"os\"\n        \"text/template\"\n)\n\ntype Foo struct {\n    Name string\n}\n\nfunc (f Foo) Baz() (int, int) {\n    return 1, 5\n}\n\nconst tmpl = `Name: {{.Name}}, Ints: {{$a, $b := .Baz}}{{$a}}, {{b}}`\n\nfunc main() {\n\n    f := Foo{\"Foo\"}\n\n    t, err := template.New(\"test\").Parse(tmpl)\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    t.Execute(os.Stdout, f)\n\n}\n</code></pre>\n\n<p>But obviously this doesn't work.  Is there no way around it?</p>\n\n<p>I've considered creating an anonymous struct in my code:</p>\n\n<pre><code>data := struct {\n    Foo\n    a   int\n    b   int\n}{\n    f,\n    0,\n    0,\n}\ndata.a, data.b = f.Baz()\n</code></pre>\n\n<p>And passing that in, but would much prefer to have something in the template.  Any ideas?  I also tried writing a wrapper function which I added to funcMaps but could never get that to work at all.</p>\n\n<p>Thanks for any suggestions!</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1443444176, "post_id": 31286087, "comment_id": 53481940, "body": "for completeness  issue, add the source json file and how it should turn out in the end."}], "owner": {"reputation": 19, "user_id": 4285527, "user_type": "registered", "profile_image": "https://graph.facebook.com/100000918339022/picture?type=large", "display_name": "Shinichi Masuda", "link": "https://stackoverflow.com/users/4285527/shinichi-masuda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 358, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1436490066, "creation_date": 1436340328, "last_edit_date": 1436490066, "question_id": 31286087, "link": "https://stackoverflow.com/questions/31286087/how-can-i-get-data-on-tableview", "title": "How can I get data on TableView?", "body": "<p>all.</p>\n\n<p>Now I develop my task management application using Go programming language and walk(\"Windows application library kit\" for the Go programming language).</p>\n\n<p>The application has the function of following from \u2460 to \u2461.</p>\n\n<p>\u2460Read data from JSON file, and display data on TableView(TableView is a component of walk).<br />\n\u2461Write data on TableView to JSON file.</p>\n\n<p>I could develop the function of \u2460. But I cannot develop the function of \u2461, because I cannnot get data on TableView.</p>\n\n<p>How can I get data on TableView?</p>\n\n<p>\u3010Version\u3011<br />\ngo : 1.4.2<br />\nwalk : commit baac4d4</p>\n\n<p>\u3010Source Code\u3011</p>\n\n<pre><code>package main\n\nimport (\n    \"reflect\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"encoding/json\"\n    \"sort\"\n\n    \"github.com/lxn/walk\"\n    . \"github.com/lxn/walk/declarative\"\n    //\"strings\"\n)\n\ntype Task struct {\n    TaskId string\n    TaskNo string\n    TaskName string\n    ManDay string\n    Term string\n    ManDayDay string\n    StartDate string\n    EndDate string\n    Progress string\n}\n\ntype TaskModel struct {\n    walk.TableModelBase\n    walk.SorterBase\n    sortColumn int\n    sortOrder walk.SortOrder\n    items []Task\n}\n\nfunc NewTaskModel() *TaskModel {\n    t := new(TaskModel)\n\n    t.items = make([]Task, 3)\n\n    var tasks []Task\n    tasks = read(\"\")\n\n    for i := 0; i &lt; len(tasks); i++ {\n        var task Task\n        task = tasks[i]\n        t.items[i] = task\n    }\n\n    t.PublishRowsReset()\n\n    return t\n}\n\nfunc (m *TaskModel) RowCount() int {\n    return len(m.items)\n}\n\nfunc (m *TaskModel) Len() int {\n    return len(m.items)\n}\n\nfunc (m *TaskModel) Value(row, col int) interface{} {\n    item := m.items[row]\n\n    switch col {\n        case 0:\n            return item.TaskId\n        case 1:\n            return item.TaskNo\n        case 2:\n            return item.TaskName\n        case 3:\n            return item.ManDay\n        case 4:\n            return item.Term\n        case 5:\n            return item.ManDayDay\n        case 6:\n            return item.StartDate\n        case 7:\n            return item.EndDate\n        case 8:\n            return item.Progress\n    }\n\n    panic(\"unexpected col\")\n}\n\nfunc (m *TaskModel) Sort(col int, order walk.SortOrder) error {\n    m.sortColumn, m.sortOrder = col, order\n\n    sort.Sort(m)\n\n    return m.SorterBase.Sort(col, order)\n}\n\nfunc (m *TaskModel) Less(i, j int) bool {\n    a, b := m.items[i], m.items[j]\n\n    c := func(ls bool) bool {\n        if m.sortOrder == walk.SortAscending {\n            return ls\n        }\n\n        return !ls\n    }\n\n    switch m.sortColumn {\n        case 0:\n            return c(a.TaskId &lt; b.TaskId)\n        case 1:\n            return c(a.TaskNo &lt; b.TaskNo)\n        case 2:\n            return c(a.TaskName &lt; b.TaskName)\n        case 3:\n            return c(a.ManDay &lt; b.ManDay)\n        case 4:\n            return c(a.Term &lt; b.Term)\n        case 5:\n            return c(a.ManDayDay &lt; b.ManDayDay)\n        case 6:\n            return c(a.StartDate &lt; b.StartDate)\n        case 7:\n            return c(a.EndDate &lt; b.EndDate)\n        case 8:\n            return c(a.Progress &lt; b.Progress)\n    }\n\n    panic(\"error\")\n}\n\nfunc (m *TaskModel) Swap(i, j int) {\n    m.items[i], m.items[j] = m.items[j], m.items[i]\n}\n\nfunc read(filePath string) []Task{\n\n    file, err := os.Open(\"C:/Dev/xampp/htdocs/workspace/SampleGoProject/src/main/task.json\")\n    //file, err := os.Open(filePath)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer file.Close()\n\n    var tasks []Task\n\n    decoder := json.NewDecoder(file)\n    //json.NewDecoder(file)\n\n    //fmt.Print(tasks)\n\n    //err = decoder.Decode(&amp;tasks)\n    decoder.Decode(&amp;tasks)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    //fmt.Print(tasks)\n\n    return tasks;\n}\n\nfunc write(filePath string, mw *MyMainWindow) {\n\n    var children *walk.WidgetList\n    children = mw.MainWindow.Children()\n\n    var child walk.Widget\n    child = children.At(0)\n\n    to := reflect.TypeOf(child)\n    fv := reflect.ValueOf(child).Convert(to).Interface()\n\n    //tableview := fv.Type().In(0)\n    //var tableview TableView\n    //tableview := child.Cursor()\n\n    //fmt.Print(child)\n\n    //fmt.Println(tableview)\n\n    fmt.Println(to)\n    fmt.Println(fv)\n\n\n\n    //r := fv.InterfaceData()\n    //fmt.Println(r)\n    //fmt.Println(reflect.ValueOf(child).Convert(fv))\n\n    file, err := os.Create(\"C:/Dev/xampp/htdocs/workspace/SampleGoProject/src/main/task2.json\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    defer file.Close()\n\n    //var tasks []Task\n\n    encoder := json.NewEncoder(file)\n\n    err = encoder.Encode(fv)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n}\n\ntype MyMainWindow struct {\n    *walk.MainWindow\n    prevFilePath string\n}\n\nfunc main() {\n\n    model := NewTaskModel()\n\n    mw := new (MyMainWindow)\n\n    var openAction, saveAction *walk.Action\n\n    if err:= (MainWindow{\n        AssignTo: &amp;mw.MainWindow,\n        Title: \"WBS\",\n        MenuItems: []MenuItem{\n            Menu {\n                Text: \"&amp;File\",\n                Items: []MenuItem{\n                    Action{\n                        AssignTo: &amp;openAction,\n                        Text: \"&amp;Open\",\n                        OnTriggered: mw.openAction_Triggered,\n                    },\n                    Action{\n                        AssignTo: &amp;saveAction,\n                        Text: \"&amp;Save\",\n                        OnTriggered: mw.saveAction_Triggered,\n                    },\n                    Separator{},\n                    Action{\n                        Text: \"&amp;Exit\",\n                        OnTriggered: func() {\n                            mw.Close()  \n                        },\n                    },\n                },\n            },\n        },\n        MinSize: Size{800, 400},\n        Layout: VBox{},\n        Children: []Widget{\n            TableView {\n                Columns: []TableViewColumn{\n                    {Title: \"Task Id\"},\n                    {Title: \"Task No\"},\n                    {Title: \"Task Name\"},\n                    {Title: \"Man Day\"},\n                    {Title: \"Term\"},\n                    {Title: \"Man Day Day\"},\n                    {Title: \"Start Date\"},\n                    {Title: \"End Date\"},\n                    {Title: \"Progress\"},\n                },\n                Model: model,\n            },\n        },\n    }.Create()); err != nil {\n        //fmt.Print(err)\n        //log.Fatal(err)\n\n    }\n\n    mw.Run()\n}\n\nfunc (mw *MyMainWindow) openAction_Triggered() {\n    if err := mw.openFile(); err != nil {\n        log.Print(err)\n    }\n}\n\nfunc (mw *MyMainWindow) openFile() error {\n    dlg := new(walk.FileDialog)\n\n    dlg.FilePath = mw.prevFilePath\n    dlg.Filter = \"JSON Files|*.json\"\n    dlg.Title = \"Select a json file\"\n\n    if ok, err := dlg.ShowOpen(mw); err != nil {\n        return err\n    } else if !ok {\n        return nil\n    }\n\n    mw.prevFilePath = dlg.FilePath\n\n    read(mw.prevFilePath)\n\n    return nil\n}\n\nfunc (mw *MyMainWindow) saveAction_Triggered() {\n    if err := mw.saveFile(); err != nil {\n        log.Print(err)\n    }\n}\n\nfunc (mw *MyMainWindow) saveFile() error {\n    dlg := new(walk.FileDialog)\n\n    dlg.FilePath = mw.prevFilePath\n    dlg.Filter = \"JSON Files|*.json\"\n    dlg.Title = \"Input a json file name\"\n\n    if ok, err := dlg.ShowSave(mw); err != nil {\n        return err\n    } else if !ok {\n        return nil\n    }\n\n    mw.prevFilePath = dlg.FilePath\n\n    write(mw.prevFilePath, mw)\n\n    return nil\n}\n</code></pre>\n\n<p><img src=\"https://i.stack.imgur.com/be9xD.png\" alt=\"enter image description here\"></p>\n"}, {"tags": ["go", "relative-path", "filepath"], "comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1436342938, "post_id": 31285963, "comment_id": 50565853, "body": "@BravadaZadada, hm...good. The following works as expected: <code>pck, err := build.Import(&quot;github.com&#47;user&#47;dbms&quot;, &quot;&quot;, build.FindOnly); fmt.Println(pck.Dir, err)</code>. Looks like <code>build.Import(..)</code> a little bit complex to use it only to resolve dir of package. Are there any simpler ways to do the same?  If it&#39;s the only way - post you answer I accept it."}], "answers": [{"tags": [], "owner": {"reputation": 5331, "user_id": 555017, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/06aa109f3832c30df43af5fcd2f13d9c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/555017/jonathan"}, "is_accepted": true, "score": 3, "last_activity_date": 1436350855, "creation_date": 1436350855, "answer_id": 31289814, "question_id": 31285963, "link": "https://stackoverflow.com/questions/31285963/how-to-get-filepath-relative-to-imported-packages-path/31289814#31289814", "title": "How to get filepath relative to imported package&#39;s path?", "body": "<p>The issue is that your database file will not be a part of the compiled binary. It seems you are expecting it to be packaged with your binary when you run your code.</p>\n\n<p>I think you should reconsider your approach. Your source code will be compiled into a static binary to be ran, but that binary will not include your database file. You are going to have a bad time trying to guess the correct path reliably.</p>\n\n<p>I would move the path to your database file into a configuration param, either in a config file that is required to be in the current working directory at runtime, or as an environment variable. Then, pull the database file out of the package directory, since it won't be helping you by being there.</p>\n\n<p>As far as getting the file initially at runtime, you could just add a setup function that will scaffold your database as appropriate. Or, if you are expecting some preloaded data in the database, just ship it in a package with the final binary and config file.</p>\n\n<p>Hope that helps!</p>\n"}, {"tags": [], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "is_accepted": false, "score": 1, "last_activity_date": 1436616748, "creation_date": 1436616748, "answer_id": 31357051, "question_id": 31285963, "link": "https://stackoverflow.com/questions/31285963/how-to-get-filepath-relative-to-imported-packages-path/31357051#31357051", "title": "How to get filepath relative to imported package&#39;s path?", "body": "<p>Thank to @BravadaZadada who suggested this solution:</p>\n\n<pre><code>~/go/src/github.com/user/dbms\n  data/\n    database.db\n  dbms.go\n\n~/projects/myproj/bin\n  main.go\n</code></pre>\n\n<p><strong>dbms.go</strong></p>\n\n<pre><code>package dbms\n\nimport (\n  \"os\"\n  \"fmt\"\n  \"path/filepath\"\n)\n\ntype dbms struct {\n  filepath string\n}\n\nfunc New() *dbms {\n  // Solution here!\n  pck, err := build.Import(\"github.com/user/dbms\", \"\", build.FindOnly);\n  return &amp;dbms{filepath: filepath.Join(pck.Dir, \"data/database.db\")}\n}\n\nfunc (d *dbms) Run() {\n  fmt.Println(filepath.Abs(d.filepath))\n  // output: /home/timur/go/src/github.com/user/dbms/data\n  file, err := os.OpenFile(d.filepath, os.O_RDWR, 0666)\n  // ...\n}\n</code></pre>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 93, "favorite_count": 0, "accepted_answer_id": 31289814, "answer_count": 2, "score": 0, "last_activity_date": 1436616748, "creation_date": 1436339975, "last_edit_date": 1436349074, "question_id": 31285963, "link": "https://stackoverflow.com/questions/31285963/how-to-get-filepath-relative-to-imported-packages-path", "title": "How to get filepath relative to imported package&#39;s path?", "body": "<p>The problem is I can't reach the file relative to the package path where it is actual used. Let's consider the example. I have the following structure:</p>\n\n<pre><code>~/go/src/github.com/user/dbms\n  data/\n    database.db\n  dbms.go\n\n~/projects/myproj/bin\n  main.go\n</code></pre>\n\n<p><strong>dbms.go</strong>:</p>\n\n<pre><code>package dbms\n\nimport (\n  \"os\"\n  \"fmt\"\n  \"path/filepath\"\n)\n\ntype dbms struct {\n  filepath string\n}\n\nfunc New() *dbms {\n  return &amp;dbms{filepath: \"./data/database.db\"}\n}\n\nfunc (d *dbms) Run() {\n  fmt.Println(filepath.Abs(d.Path))\n  // output: /home/timur/projects/myproj/bin/data\n  // I need: /home/timur/go/src/github.com/user/dbms/data\n  file, err := os.OpenFile(d.filepath, os.O_RDWR, 0666)\n  // error\n}\n</code></pre>\n\n<p><strong>main.go</strong>:</p>\n\n<pre><code>package main\n\nimport (\n  \"github.com/user/dbms\"\n)\n\nfunc main() {\n  db := dbms.New()\n  db.Run()\n}\n</code></pre>\n\n<p>As you can see <code>dbms.Path</code> resolves path relative to the entry point and not package itself. What do I wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "edited": false, "score": 0, "creation_date": 1436490355, "post_id": 31285493, "comment_id": 50647199, "body": "why do you want to know this?"}, {"owner": {"reputation": 317, "user_id": 4005052, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xlj1f.jpg?s=128&g=1", "display_name": "Rob Archibald", "link": "https://stackoverflow.com/users/4005052/rob-archibald"}, "reply_to_user": {"reputation": 109950, "user_id": 86989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4bd262de5d82a235eeb64f71e4058198?s=128&d=identicon&r=PG", "display_name": "newacct", "link": "https://stackoverflow.com/users/86989/newacct"}, "edited": false, "score": 2, "creation_date": 1436674840, "post_id": 31285493, "comment_id": 50709127, "body": "I wanted to know more about the underlying type contained in the interface because the encoding/json package that I am using to decode json data doesn&#39;t work if you pass it a struct rather than a pointer to a struct.  I have a method that allows you to provide a URL and a struct and it&#39;ll download data from the web, Unmarshal the json and return the struct.  To make it easier to use, I wanted to be able to error if the developer passed in a pointer rather than just a struct instead of just returning empty data"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1436339792, "post_id": 31285786, "comment_id": 50563911, "body": "<a href=\"https://golang.org/pkg/reflect/#Value\" rel=\"nofollow noreferrer\"><code>reflect.Value</code></a> has a <a href=\"https://golang.org/pkg/reflect/#Value.Kind\" rel=\"nofollow noreferrer\"><code>Kind()</code></a> method, so it is enough to just write <code>reflect.ValueOf(i).Kind()</code>."}, {"owner": {"reputation": 141, "user_id": 7388072, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Oti0y.jpg?s=128&g=1", "display_name": "hoenir", "link": "https://stackoverflow.com/users/7388072/hoenir"}, "edited": false, "score": 0, "creation_date": 1558439949, "post_id": 31285786, "comment_id": 99094278, "body": "This answer does not even compile. The correct code is :  <code>func isStruct(i interface{}) bool { return reflect.ValueOf(i).Kind() == reflect.Struct }</code>"}], "tags": [], "owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "is_accepted": true, "score": 9, "last_activity_date": 1565273289, "last_edit_date": 1565273289, "creation_date": 1436339457, "answer_id": 31285786, "question_id": 31285493, "link": "https://stackoverflow.com/questions/31285493/how-can-i-tell-if-my-interface-is-a-pointer/31285786#31285786", "title": "How can I tell if my interface{} is a pointer?", "body": "<pre><code>func isStruct(i interface{}) bool {\n    return reflect.ValueOf(i).Type().Kind() == reflect.Struct\n}\n</code></pre>\n\n<p>You can test via changing type according to your needs such as <code>reflect.Ptr</code>. You can even get pointed value with <code>reflect.Indirect(reflect.ValueOf(i))</code> after you ensured it's a pointer.</p>\n\n<p>Addition:</p>\n\n<p>It seems <code>reflect.Value</code> has a <code>Kind</code> method so <code>reflect.ValueOf(i).Kind()</code> is enough.</p>\n"}, {"tags": [], "owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "is_accepted": false, "score": 1, "last_activity_date": 1436339864, "creation_date": 1436339864, "answer_id": 31285922, "question_id": 31285493, "link": "https://stackoverflow.com/questions/31285493/how-can-i-tell-if-my-interface-is-a-pointer/31285922#31285922", "title": "How can I tell if my interface{} is a pointer?", "body": "<p>If you know the \"real\" type of the interface, you can simply use a <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow\"><code>type switch</code></a>:</p>\n\n<pre><code>type MyStruct struct {\n    Value string\n}\n\nfunc TestInterfaceIsOrIsntPointer(t *testing.T) {\n    var myStruct interface{} = MyStruct{Value: \"hello1\"}\n    var myPointerToStruct interface{} = &amp;MyStruct{Value: \"hello1\"}\n    // the IsPointer method doesn't exist on interface, but I need something like this\n    switch myStruct.(type) {\n       case MyStruct:\n           // ok\n           break\n       case *MyStruct:\n           // error here\n           break\n    }\n    switch myPointerToStruct.(type) {\n       case MyStruct:\n           // error here\n           break\n       case *MyStruct:\n           // ok\n           break\n    }\n}\n</code></pre>\n\n<p>The code is longer but at least you don't need to use the <code>reflect</code> package.</p>\n"}, {"tags": [], "owner": {"reputation": 4122, "user_id": 1743957, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/fa0c08c9d80f0702b0eba6398a4ae26d?s=128&d=identicon&r=PG", "display_name": "Sebastien C.", "link": "https://stackoverflow.com/users/1743957/sebastien-c"}, "is_accepted": false, "score": 0, "last_activity_date": 1436339890, "creation_date": 1436339890, "answer_id": 31285931, "question_id": 31285493, "link": "https://stackoverflow.com/questions/31285493/how-can-i-tell-if-my-interface-is-a-pointer/31285931#31285931", "title": "How can I tell if my interface{} is a pointer?", "body": "<p>You could use the reflect package:</p>\n\n<pre><code>i := 42\nj := &amp;i\nkindOfJ := reflect.ValueOf(j).Kind()\n\nfmt.Print(kindOfJ == reflect.Ptr)\n</code></pre>\n"}], "owner": {"reputation": 317, "user_id": 4005052, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/xlj1f.jpg?s=128&g=1", "display_name": "Rob Archibald", "link": "https://stackoverflow.com/users/4005052/rob-archibald"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2297, "favorite_count": 1, "accepted_answer_id": 31285786, "answer_count": 3, "score": 5, "last_activity_date": 1565273289, "creation_date": 1436338493, "question_id": 31285493, "link": "https://stackoverflow.com/questions/31285493/how-can-i-tell-if-my-interface-is-a-pointer", "title": "How can I tell if my interface{} is a pointer?", "body": "<p>If I have an interface being passed into a function, is there a way to tell if the item passed in is a struct or a pointer to a struct?  I wrote this silly test to illustrate what I need to figure out.</p>\n\n<pre><code>type MyStruct struct {\n    Value string\n}\n\nfunc TestInterfaceIsOrIsntPointer(t *testing.T) {\n    var myStruct interface{} = MyStruct{Value: \"hello1\"}\n    var myPointerToStruct interface{} = &amp;MyStruct{Value: \"hello1\"}\n    // the IsPointer method doesn't exist on interface, but I need something like this\n    if myStruct.IsPointer() || !myPointerToStruct.IsPointer() { \n        t.Fatal(\"expected myStruct to not be pointer and myPointerToStruct to be a pointer\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "goconvey"], "answers": [{"comments": [{"owner": {"reputation": 4513, "user_id": 605022, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/CRrSr.jpg?s=128&g=1", "display_name": "mdwhatcott", "link": "https://stackoverflow.com/users/605022/mdwhatcott"}, "edited": false, "score": 0, "creation_date": 1436477223, "post_id": 31317766, "comment_id": 50643169, "body": "This looks like the correct answer... Haven&#39;t tried GoConvey in a docker container yet."}, {"owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "edited": false, "score": 0, "creation_date": 1436507164, "post_id": 31317766, "comment_id": 50651399, "body": "Interesting, Just had a quick test now still seems to be serving up 404&#39;s. the goconvey binary is in /usr/local/bin and the GOPATH is set to looks at 2 directories (were vendoring the libs we import) so &quot;/workspace:/workspace/vendor&quot; the code lies in /workspace.. I confirmed that the files do lie in /workspace/vendor/src/github/smartystreets/goconvey/..."}, {"owner": {"reputation": 46, "user_id": 2322962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybUQi.jpg?s=128&g=1", "display_name": "Christoph Berger", "link": "https://stackoverflow.com/users/2322962/christoph-berger"}, "edited": false, "score": 1, "creation_date": 1436518048, "post_id": 31317766, "comment_id": 50657080, "body": "After peeking into goconvey&#39;s sources, it would appear to me that goconvey takes a quite ad-hoc approach to find the static files. The code calls <code>runtime.Caller(0)</code> to get the path to its own .go file, then it appends /web/client. (See <code>func folders()</code> in goconvey.go, lines 47ff.) So assuming that you compiled goconvey with a different GOPATH than the current one, this would explain why it cannot find its static files."}, {"owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "edited": false, "score": 0, "creation_date": 1437038453, "post_id": 31317766, "comment_id": 50868141, "body": "Yup I recompiled the exe with the same GOPATH as my projects /vendor directory and it seems to work. Hummm is this ideal behaviour? - I also have noticed that the coverage reports don&#39;t seem to be serving up the correct files after they get regenerated...I have to delete them for it to serve up the new ones... not sure if this is related or not..."}, {"owner": {"reputation": 46, "user_id": 2322962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybUQi.jpg?s=128&g=1", "display_name": "Christoph Berger", "link": "https://stackoverflow.com/users/2322962/christoph-berger"}, "edited": false, "score": 0, "creation_date": 1437043500, "post_id": 31317766, "comment_id": 50871481, "body": "Looks as if goconvey was not designed with GOPATH switching in mind. The chosen approach (that is, to assume that the current GOPATH contains the goconvey directories) may not be as flexible as it could be, but on the other hand, I think this helps to make goconvey so easy to install through a simple go get."}], "tags": [], "owner": {"reputation": 46, "user_id": 2322962, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ybUQi.jpg?s=128&g=1", "display_name": "Christoph Berger", "link": "https://stackoverflow.com/users/2322962/christoph-berger"}, "is_accepted": false, "score": 2, "last_activity_date": 1436445504, "creation_date": 1436445504, "answer_id": 31317766, "question_id": 31285448, "link": "https://stackoverflow.com/questions/31285448/running-goconvey-http-server-from-within-a-docker-container/31317766#31317766", "title": "Running goconvey http server from within a docker container", "body": "<p>The goconvey server returns 404 when it cannot find the directory that contains the static resources.<br>\nThe location of this directory depends on where go get stored the goconvey files, usually in</p>\n\n<pre><code>$GOPATH/src/github.com/smartystreets/goconvey\n</code></pre>\n\n<p>So in your docker container, ensure that goconvey is installed using the current <code>$GOPATH</code> value, and also verify that the <code>/goconvey</code> dir contains <code>/web/client/...</code> subdirectories, which is where the html, css, and js files for the Web UI reside.</p>\n\n<p>(To test this, I renamed the client dir, which caused goconvey to return a plain 404 message.) </p>\n"}], "owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 440, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1436564841, "creation_date": 1436338306, "last_edit_date": 1436564841, "question_id": 31285448, "link": "https://stackoverflow.com/questions/31285448/running-goconvey-http-server-from-within-a-docker-container", "title": "Running goconvey http server from within a docker container", "body": "<p>I'm using docker containers for some of my golang web service projects and part of the development workflow is using goconvey for some fast tdd feedback. I'd like to spin this up within a docker container and expose the port to the host machine so I can point my web browser to it and get coding.</p>\n\n<p>We have compiled the goconvey binary and have popped it in /usr/local/bin\nThe problem is that whenever I connect to the port exposed form the docker container I only get \"404 Page not found\" errors.</p>\n\n<p>There are a few tweaks we have with out GOPATH specifically I'm vendoring my libs eg GOPATH=/proj-dir/vendor and code dev is happening in /src </p>\n\n<p>I can get goconvey working nicely on my host but in the docker i'm stumped. \nThe 404 suggest that I'm hitting the goconvey server but it does not serve up anything?</p>\n\n<p>Any assistance appreciated.</p>\n"}, {"tags": ["go", "parallel-processing", "goroutine"], "comments": [{"owner": {"reputation": 3056, "user_id": 586229, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/fWSco.png?s=128&g=1", "display_name": "hoijui", "link": "https://stackoverflow.com/users/586229/hoijui"}, "edited": false, "score": 3, "creation_date": 1436337912, "post_id": 31285215, "comment_id": 50562817, "body": "you do just 3 println&#39;s in a row without intermediate delay. it seems quite reasonable that this little work is all down in a row. try adding a sleep after/before each println. switching between threads/processes is not free, thus it it is not done after every instruction."}, {"owner": {"reputation": 739, "user_id": 4023835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qRavX.jpg?s=128&g=1", "display_name": "Le_Enot", "link": "https://stackoverflow.com/users/4023835/le-enot"}, "reply_to_user": {"reputation": 3056, "user_id": 586229, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/fWSco.png?s=128&g=1", "display_name": "hoijui", "link": "https://stackoverflow.com/users/586229/hoijui"}, "edited": false, "score": 0, "creation_date": 1436338427, "post_id": 31285215, "comment_id": 50563131, "body": "@hoijui Yes, it works! But in examples that I found people didn&#39;t use any Sleep instructions and had printlns switching. Also I tried up to 100 cycles without sleep and it didn&#39;t work. When I try 400 and more - it switches but really not often. Maybe it is hardware-related issue?"}, {"owner": {"reputation": 3056, "user_id": 586229, "user_type": "registered", "accept_rate": 20, "profile_image": "https://i.stack.imgur.com/fWSco.png?s=128&g=1", "display_name": "hoijui", "link": "https://stackoverflow.com/users/586229/hoijui"}, "edited": false, "score": 0, "creation_date": 1436340269, "post_id": 31285215, "comment_id": 50564226, "body": "i would say it is more software (kernel, used scheduling method) then hardware related, but yeah, also that. in general you should rely on the underlying system to do thread scheduling right, except you have very very good reason not to, and think you know better how to do scheduling then the people writing the OS kernel, for the performance of your application."}], "answers": [{"comments": [{"owner": {"reputation": 739, "user_id": 4023835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qRavX.jpg?s=128&g=1", "display_name": "Le_Enot", "link": "https://stackoverflow.com/users/4023835/le-enot"}, "edited": false, "score": 0, "creation_date": 1436345318, "post_id": 31287203, "comment_id": 50567360, "body": "I got the same output as well. How could author of the example get what he got - thats the question. Maybe he just <i>assumed</i> and wrote the &quot;compile-in-mind&quot; output"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 739, "user_id": 4023835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qRavX.jpg?s=128&g=1", "display_name": "Le_Enot", "link": "https://stackoverflow.com/users/4023835/le-enot"}, "edited": false, "score": 0, "creation_date": 1436346513, "post_id": 31287203, "comment_id": 50568150, "body": "of course not <code>in mind</code>. if you add <code>runtime.GOMAXPROCS(4)</code> at the very begin in main function, you will get  <code>direct : 0 direct : 1 direct : 2 goroutine : 0 goroutine : 1 going goroutine : 2  done</code>"}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436346603, "last_edit_date": 1436346603, "creation_date": 1436343802, "answer_id": 31287203, "question_id": 31285215, "link": "https://stackoverflow.com/questions/31285215/goroutines-dont-work-in-parallel/31287203#31287203", "title": "Goroutines don&#39;t work in parallel", "body": "<p>you should not predict the goroutine schedule. by running the example you provided, I got this output.</p>\n\n<pre><code>direct : 0\ndirect : 1\ndirect : 2\ngoroutine : 0\ngoroutine : 1\ngoroutine : 2\ngoing\ndone\n</code></pre>\n\n<p>if I add <code>runtime.GOMAXPROCS(4)</code> at the begin of main function, and run it on my i5 Qcore desktop ubuntu, it output</p>\n\n<pre><code>direct : 0\ndirect : 1\ndirect : 2\ngoroutine : 0\ngoroutine : 1\ngoroutine : 2\ngoing\n\ndone\n</code></pre>\n\n<p>it not always produce same output I think. So we should assume goroutine may  parallel, add lock if you need control the sequence.</p>\n"}], "owner": {"reputation": 739, "user_id": 4023835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qRavX.jpg?s=128&g=1", "display_name": "Le_Enot", "link": "https://stackoverflow.com/users/4023835/le-enot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 493, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1436346603, "creation_date": 1436337559, "last_edit_date": 1436339593, "question_id": 31285215, "link": "https://stackoverflow.com/questions/31285215/goroutines-dont-work-in-parallel", "title": "Goroutines don&#39;t work in parallel", "body": "<p>Given following code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n    \"time\"\n)\n\n\nfunc f(from string) {\n\n    for i := 0; i &lt; 3; i++ {\n        fmt.Println(from, \":\", i)\n        //runtime.Gosched()\n    }\n}\n\nfunc main() {\n\n    runtime.GOMAXPROCS(runtime.NumCPU()*2)\n    time.Sleep(100)\n\n    go f(\"i am not parallel\")\n\n    go f(\"neither me\")\n\n    var input string\n    fmt.Scanln(&amp;input)\n}\n</code></pre>\n\n<p>The output in most cases is:</p>\n\n<blockquote>\n  <p>i am not parallel : 0<br>\n  i am not parallel : 1<br>\n  i am not parallel : 2<br>\n  neither me : 0 <br>\n  neither me : 1 <br>\n  neither me : 2<br></p>\n</blockquote>\n\n<p>And sometimes:</p>\n\n<blockquote>\n  <p>neither me : 0 <br>\n  neither me : 1 <br>\n  neither me : 2<br>\n  i am not parallel : 0<br>\n  i am not parallel : 1<br>\n  i am not parallel : 2<br></p>\n</blockquote>\n\n<p>When <code>runtime.Gosched()</code> is uncommented all seems to be OK. \nI have tried changing GOMAXPROCS number from 2 to NumCPU, number of goroutines, cycles: none could get it to work in parallel. <br>\nWhy so strange behaviour?</p>\n\n<p><strong>Edit:</strong>\nOk, seems to be context-switching is heavy work and is not done very often without reasonable matters. One thing I still can't understand - why people <a href=\"https://gobyexample.com/goroutines\" rel=\"nofollow\">get it to work</a> without any sleep instructions? </p>\n"}, {"tags": ["go", "producer-consumer"], "answers": [{"comments": [{"owner": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "edited": false, "score": 0, "creation_date": 1436326144, "post_id": 31282898, "comment_id": 50558812, "body": "That is how I initially tackled it but when the flag is true I get a deadlock error for all go routines being asleep. Any thoughts?"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436326305, "post_id": 31282898, "comment_id": 50558849, "body": "You need to make sending to a channel conditional too. This answer shows the correct approach: <code>if stats != nil { ...</code>"}, {"owner": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "edited": false, "score": 0, "creation_date": 1436326602, "post_id": 31282898, "comment_id": 50558914, "body": "I double checked, its the exact same as the example above"}, {"owner": {"reputation": 1299, "user_id": 1733239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e2e0ce638ca008172efc846ebd17e0?s=128&d=identicon&r=PG", "display_name": "Soheil Hassas Yeganeh", "link": "https://stackoverflow.com/users/1733239/soheil-hassas-yeganeh"}, "edited": false, "score": 0, "creation_date": 1436455429, "post_id": 31282898, "comment_id": 50630431, "body": "I can&#39;t give you a definite answer without a complete stacktrace, but my guess is that the deadlock is not because of statistics() but is because of how you handle done. I&#39;ve updated my answer. Note the select clauses in <code>statistics</code> and <code>process</code>, and <code>close(done)</code> in <code>produce</code>. Please check it out and let me know if it fixes your issue."}], "tags": [], "owner": {"reputation": 1299, "user_id": 1733239, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/59e2e0ce638ca008172efc846ebd17e0?s=128&d=identicon&r=PG", "display_name": "Soheil Hassas Yeganeh", "link": "https://stackoverflow.com/users/1733239/soheil-hassas-yeganeh"}, "is_accepted": true, "score": 1, "last_activity_date": 1436455576, "last_edit_date": 1436455576, "creation_date": 1436325215, "answer_id": 31282898, "question_id": 31282829, "link": "https://stackoverflow.com/questions/31282829/conditional-go-routine-channel/31282898#31282898", "title": "Conditional Go Routine/Channel", "body": "<p>There is nothing wrong with making this conditional:</p>\n\n<pre><code>var stats chan []string  // Don't initialize stats.\n\nfunc main() {\n    options()\n    go produce(readCSV(loc))\n    go process()\n    if flag {\n        stats = make(chan []string, 1024)\n        go statistics() // only on flag\n    }\n    &lt;-done\n}\n\nfunc produce(entries [][]string) {\n    regex, err := regexp.Compile(reg)\n    if err != nil {\n        log.Error(reg + \", is not a valid regular expression\")\n    } else {\n        for _, each := range entries {\n            if regex.MatchString(each[col]) {\n                matches &lt;- each\n                if stats != nil {\n                    stats &lt;- each // only on flag\n                }\n            }\n        }\n    }\n    close(done)\n}\n\nfunc process() {\n    for {\n        select {\n        case match := &lt;-matches:\n            if len(match) != 0 {\n              // PROCESS\n            }\n        case &lt;-done:\n            return\n        }\n    }\n}\n\nfunc statistics() {\n    for {\n        select {\n        case stat := &lt;-stats:\n            if len(stat) != 0 {\n                // STATISTICS\n            }\n        case &lt;-done:\n            return\n        }\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436325423, "post_id": 31282910, "comment_id": 50558657, "body": "This won&#39;t work, you will also need to make sending to <code>stats</code> channel conditional"}, {"owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436325737, "post_id": 31282910, "comment_id": 50558726, "body": "I was mostly pointing at the flag package, but you are correct @kostya. Updated, thanks."}, {"owner": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "edited": false, "score": 0, "creation_date": 1436326284, "post_id": 31282910, "comment_id": 50558843, "body": "Thank you very much for the response, I am aware of the flag lib but decided to go my own route. My main issue is getting the conditional channel to run without causing deadlock."}, {"owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "edited": false, "score": 0, "creation_date": 1436326646, "post_id": 31282910, "comment_id": 50558928, "body": "Looks like the answer below is more suitable then."}, {"owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "reply_to_user": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "edited": false, "score": 0, "creation_date": 1436327004, "post_id": 31282910, "comment_id": 50559022, "body": "@pdago have you considered using sync.WaitGroup?"}, {"owner": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "edited": false, "score": 0, "creation_date": 1436327294, "post_id": 31282910, "comment_id": 50559080, "body": "Yes and no, it was one of the options I looked at but went with a simpler method. I will revisit that now, thanks for the suggestion!"}], "tags": [], "owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "is_accepted": false, "score": 0, "last_activity_date": 1436325683, "last_edit_date": 1436325683, "creation_date": 1436325294, "answer_id": 31282910, "question_id": 31282829, "link": "https://stackoverflow.com/questions/31282829/conditional-go-routine-channel/31282910#31282910", "title": "Conditional Go Routine/Channel", "body": "<p>Perhaps you're looking for the flag package.</p>\n\n<pre><code>import \"flag\"\n\nvar withStats = flag.Boolean(\"s\", false, \"Do statistics\")\n\nfunc main() {\n    flag.Parse()\n    ...\n    if *withStats == true {\n        t := statType\n        size := 100\n        stats := make(chan, t, size)\n        go statistics() // only on flag\n    }\n    ...\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "edited": false, "score": 0, "creation_date": 1436326535, "post_id": 31283035, "comment_id": 50558895, "body": "Although I don&#39;t this is still awesome and will come in handy later down the road. Thank you very much for the share!"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 0, "last_activity_date": 1436326146, "creation_date": 1436326146, "answer_id": 31283035, "question_id": 31282829, "link": "https://stackoverflow.com/questions/31282829/conditional-go-routine-channel/31283035#31283035", "title": "Conditional Go Routine/Channel", "body": "<p>If you update statistics from many places in your code you might want to add some helper methods. Something like:</p>\n\n<pre><code>type stats struct {\n    ch chan []string\n}\n\nfunc (s *stats) update(a []string) {\n    if s != nil {\n        s.ch &lt;- a\n    }\n}\n\nfunc (s *stats) start() {\n    if s != nil {\n        s.ch = make(chan []string)\n        go statistics()\n    }\n}\n\nvar s *stats\nif enabled {\n    s = new(stats)\n}\ns.start()\n\n// later in the code\ns.update(each)\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 2827170, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a38c65b780e8dbf9cc9d2920c89378e0?s=128&d=identicon&r=PG", "display_name": "pdago", "link": "https://stackoverflow.com/users/2827170/pdago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 469, "favorite_count": 0, "accepted_answer_id": 31282898, "answer_count": 3, "score": 0, "last_activity_date": 1436455576, "creation_date": 1436324627, "question_id": 31282829, "link": "https://stackoverflow.com/questions/31282829/conditional-go-routine-channel", "title": "Conditional Go Routine/Channel", "body": "<p>I would like to make the statistics routine conditional so that it only runs on certain cases otherwise it will waste cycles half the time. Right now I have one go routine act as a producer to feed the two consumer routines via buffered channels. Is there a way I can make it so the statistics routine is conditional or is there a better pattern I should follow? Thanks in advance for any and all help!</p>\n\n<pre><code>func main() {\n    options()\n    go produce(readCSV(loc))\n    go process()\n    go statistics() // only on flag\n    &lt;-done\n}\n\nfunc produce(entries [][]string) {\n    regex, err := regexp.Compile(reg)\n    if err != nil {\n        log.Error(reg + \", is not a valid regular expression\")\n    } else {\n        for _, each := range entries {\n            if regex.MatchString(each[col]) {\n                matches &lt;- each\n                stats &lt;- each // only on flag\n            }\n        }\n    }\n    done &lt;- true\n}\n\nfunc process() {\n    for {\n        match := &lt;-matches\n        if len(match) != 0 {\n            // PROCESS\n        }\n    }\n}\n\nfunc statistics() {\n    for {\n        stat := &lt;-stats\n        if len(stat) != 0 {\n            // STATISTICS\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "edited": false, "score": 1, "creation_date": 1436321086, "post_id": 31281444, "comment_id": 50557651, "body": "After checking in the library code to see if <code>fmt</code> or <code>reflect</code> was doing any modification of function pointer values when printing them, I came to the conclusion that they don&#39;t. Go really just maps your code near the very bottom of the VM space. :)"}, {"owner": {"reputation": 5654, "user_id": 2939690, "user_type": "registered", "accept_rate": 17, "profile_image": "https://www.gravatar.com/avatar/71797fe963333d41de913eb798916eae?s=128&d=identicon&r=PG", "display_name": "vuhung3990", "link": "https://stackoverflow.com/users/2939690/vuhung3990"}, "edited": false, "score": 2, "creation_date": 1456998758, "post_id": 31281444, "comment_id": 59209073, "body": "he don&#39;t know and ask, why vote him down?"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 2, "last_activity_date": 1436315934, "creation_date": 1436315934, "answer_id": 31281693, "question_id": 31281444, "link": "https://stackoverflow.com/questions/31281444/does-golang-run-on-a-virtual-machine/31281693#31281693", "title": "Does Golang run on a virtual machine?", "body": "<p>They are function values:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc plus(a int, b int) int {\n    return a + b\n}\n\nfunc plusPlus(a, b, c int) int {\n    return a + b + c\n}\n\nfunc main() {\n    funcp := plus\n    funcpp := plusPlus\n    fmt.Println(funcp)\n    fmt.Println(funcpp)\n    fmt.Println(funcp(1, 2))\n    fmt.Println(funcpp(1, 2, 3))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>0x20000\n0x20020\n3\n6\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 12, "last_activity_date": 1548974442, "last_edit_date": 1548974442, "creation_date": 1436315995, "answer_id": 31281706, "question_id": 31281444, "link": "https://stackoverflow.com/questions/31281444/does-golang-run-on-a-virtual-machine/31281706#31281706", "title": "Does Golang run on a virtual machine?", "body": "<p>Go does not run on a virtual machine.</p>\n\n<p>From the view of the language specification, <code>ptr</code> and <code>ptr2</code> are <a href=\"https://golang.org/ref/spec#Function_types\" rel=\"nofollow noreferrer\">function values</a>.  They can be called as <code>ptr(1, 2)</code> and <code>ptr2(1, 2, 3)</code>. </p>\n\n<p>Diving down into the implementation, the variables <code>ptr</code> and <code>ptr2</code> are pointers to func values. See the <a href=\"https://docs.google.com/document/d/1bMwCey-gmqZVTpRax-ESeVuZGmjwbocYs1iHplK-cjo/pub\" rel=\"nofollow noreferrer\">Function Call</a> design document for information on func values. Note the distinction between the language's \"function\" value and the implementation's \"func\" value. </p>\n\n<p>Because the <a href=\"http://godoc.org/reflect#Value.Pointer\" rel=\"nofollow noreferrer\">reflection</a> API used by the <a href=\"http://godoc.org/fmt\" rel=\"nofollow noreferrer\">fmt</a> package <a href=\"https://github.com/golang/go/blob/bd45bce373db750580e1a0f9a45563f0c0991d46/src/fmt/print.go#L601\" rel=\"nofollow noreferrer\">indirects</a> through the func values to get the pointer to print, the call to<code>fmt.Println(ptr)</code> prints the actual address of the <code>plus</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": false, "score": 10, "last_activity_date": 1436321522, "creation_date": 1436321522, "answer_id": 31282394, "question_id": 31281444, "link": "https://stackoverflow.com/questions/31281444/does-golang-run-on-a-virtual-machine/31282394#31282394", "title": "Does Golang run on a virtual machine?", "body": "<p>Go doesn't run on a virtual machine. Those are the actual addresses of the functions.</p>\n\n<p>On my machine (go 1.4.1, Linux amd64) the program prints</p>\n\n<pre><code>0x400c00\n0x400c20\n</code></pre>\n\n<p>which are different from the values in your example, but still pretty low. Checking the compiled code:</p>\n\n<pre><code>$ nm test | grep 'T main.plus'\n0000000000400c00 T main.plus\n0000000000400c20 T main.plusPlus\n</code></pre>\n\n<p>these are the actual addresses of the functions. <code>func plus</code> compiles to a mere 19 bytes of code, so <code>plusPlus</code> appears only 32 (0x20) bytes later to satisfy optimal alignment requirements.</p>\n\n<p>For the sake of curiosity, here's the disassembly of <code>func plus</code> from <code>objdump -d</code>, which should dispell any doubts that Go compiles to anything but native code:</p>\n\n<pre><code>0000000000400c00 &lt;main.plus&gt;:\n  400c00:       48 8b 5c 24 08          mov    0x8(%rsp),%rbx\n  400c05:       48 8b 6c 24 10          mov    0x10(%rsp),%rbp\n  400c0a:       48 01 eb                add    %rbp,%rbx\n  400c0d:       48 89 5c 24 18          mov    %rbx,0x18(%rsp)\n  400c12:       c3                      retq   \n</code></pre>\n"}], "owner": {"reputation": 587, "user_id": 3582467, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/805cee70da40b10138134970787daed0?s=128&d=identicon&r=PG", "display_name": "abgordon", "link": "https://stackoverflow.com/users/3582467/abgordon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 14571, "favorite_count": 2, "answer_count": 3, "score": 17, "last_activity_date": 1548974442, "creation_date": 1436313935, "last_edit_date": 1436314162, "question_id": 31281444, "link": "https://stackoverflow.com/questions/31281444/does-golang-run-on-a-virtual-machine", "title": "Does Golang run on a virtual machine?", "body": "<p>say for some very simple Golang code:</p>\n\n<pre><code>package main \nimport \"fmt\"\n\nfunc plus( a int, b int) int {\n\n    return a+b\n}\n\nfunc plusPlus(a,b,c int) int {\n    return a  +b  + c\n}\n\nfunc main() {\n\n    ptr := plus\n    ptr2 := plusPlus\n\n    fmt.Println(ptr)\n    fmt.Println(ptr2)\n}\n</code></pre>\n\n<p>This has the following output:</p>\n\n<pre><code>0x2000\n0x2020\n</code></pre>\n\n<p>What is going on here?  This doesn't look like a function pointer, or any kind of pointer for that matter, that one would find in the stack.  I also understand that Go, while offering some nice low level functionality in the threading department, also requires an OS for it to function; C is functional across all computer platforms and operating systems can be written in it while Go needs an operating system to function and in fact only works on a few OS right now.  Do the very regular function pointers mean that this works on a VM? Or is the compiler just linked to low level C functions?</p>\n"}, {"tags": ["go", "pprof"], "answers": [{"comments": [{"owner": {"reputation": 1683, "user_id": 3624201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4103a1a9daaf21559dbb9b7f83bfa314?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sandler", "link": "https://stackoverflow.com/users/3624201/ben-sandler"}, "edited": false, "score": 0, "creation_date": 1436317420, "post_id": 31281835, "comment_id": 50556834, "body": "This isn&#39;t really what I am looking for. I want to profile an arbitrary Go process (not necessarily one I create)."}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 1683, "user_id": 3624201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4103a1a9daaf21559dbb9b7f83bfa314?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sandler", "link": "https://stackoverflow.com/users/3624201/ben-sandler"}, "edited": false, "score": 1, "creation_date": 1436318972, "post_id": 31281835, "comment_id": 50557222, "body": "you must not know how pprof work. you can not profile a go process if there is no pprof server embedded in. means you can not profile an arbitrary Go process."}, {"owner": {"reputation": 1683, "user_id": 3624201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4103a1a9daaf21559dbb9b7f83bfa314?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sandler", "link": "https://stackoverflow.com/users/3624201/ben-sandler"}, "edited": false, "score": 0, "creation_date": 1436319494, "post_id": 31281835, "comment_id": 50557330, "body": "I know that the process exposes a pprof endpoint. I want to find the local port that process is running at. Your suggestion is possible, but it would require me to change the code of many Go applications."}, {"owner": {"reputation": 1683, "user_id": 3624201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4103a1a9daaf21559dbb9b7f83bfa314?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sandler", "link": "https://stackoverflow.com/users/3624201/ben-sandler"}, "edited": false, "score": 0, "creation_date": 1436322072, "post_id": 31281835, "comment_id": 50557863, "body": "That&#39;s a good idea. The only issue is that those commands require sudo (which I will not be able to use). Do you have any idea of how to do it without sudo?"}, {"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "reply_to_user": {"reputation": 1683, "user_id": 3624201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4103a1a9daaf21559dbb9b7f83bfa314?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sandler", "link": "https://stackoverflow.com/users/3624201/ben-sandler"}, "edited": false, "score": 0, "creation_date": 1436322307, "post_id": 31281835, "comment_id": 50557918, "body": "run the go process in same user would help"}, {"owner": {"reputation": 1683, "user_id": 3624201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4103a1a9daaf21559dbb9b7f83bfa314?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sandler", "link": "https://stackoverflow.com/users/3624201/ben-sandler"}, "reply_to_user": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1436330869, "post_id": 31281835, "comment_id": 50559993, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/82659/discussion-between-ben-sandler-and-jiang-yd\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "is_accepted": false, "score": 0, "last_activity_date": 1436319811, "last_edit_date": 1436319811, "creation_date": 1436316889, "answer_id": 31281835, "question_id": 31281409, "link": "https://stackoverflow.com/questions/31281409/go-tool-pprof-using-application-pid-instead-of-http-endpoint/31281835#31281835", "title": "go tool pprof using application PID instead of http endpoint", "body": "<p>Service Discovery is designed to resolve problems like this.\nA simple solution is to create a tmp file for every PID, writing each port to the according file. and read the port when you need <code>go tool pprof</code>.</p>\n\n<pre><code>http.ListenAndServe(\"localhost:\" + PORT, nil)\ntmpFilePath := filePath.Join(os.TempDir(), \"myport_\" + strconv.FormatInt(os.Getpid(), 10))\nf, _ := os.OpenFile(tmpFilePath, os.O_RDWR|os.O_CREATE|os.O_EXCL, 0600)\nf.Write(byte[](strconv.FormatInt(PORT, 10)))\nf.Close()\n</code></pre>\n\n<p>in go tool prof bash: go tool <a href=\"http://localhost:%60cat\" rel=\"nofollow\">http://localhost:`cat</a> /tmp/myport_10303`/debug/pprof/profile</p>\n\n<p>not tested in real, maybe some syntax error</p>\n\n<p>UPDATE:</p>\n\n<p>another way not change go source is, use bash command like netstat/lsof to find out the listening port of the go process. like:</p>\n\n<pre><code>netstat -antp | grep 10303| grep LISTEN | awk '{ print $4 }' | awk -F: '{print $2}'\n</code></pre>\n\n<p>not best bash script I think, just for reference.</p>\n"}], "owner": {"reputation": 1683, "user_id": 3624201, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4103a1a9daaf21559dbb9b7f83bfa314?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Sandler", "link": "https://stackoverflow.com/users/3624201/ben-sandler"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 457, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1436319811, "creation_date": 1436313699, "question_id": 31281409, "link": "https://stackoverflow.com/questions/31281409/go-tool-pprof-using-application-pid-instead-of-http-endpoint", "title": "go tool pprof using application PID instead of http endpoint", "body": "<p>Right now, I profile Go applications using go tool pprof like this:</p>\n\n<pre><code>go tool pprof http://localhost:8080/debug/pprof/profile\n</code></pre>\n\n<p>I want to use the pprof tool on an arbitrary Go process which is running a http server on an unknown port. The only information I have about the process is its PID. I need to do one of two things:</p>\n\n<ul>\n<li>Get the Go processes port number from its PID.</li>\n<li>Profile the running process directly. For example, something like <code>go tool pprof 10303</code> where the PID is 10303.</li>\n</ul>\n\n<p>Would either of these work?</p>\n"}, {"tags": ["scroll", "go", "scrollbar", "gxui"], "comments": [{"owner": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "edited": false, "score": 1, "creation_date": 1436345994, "post_id": 31280709, "comment_id": 50567781, "body": "You need <a href=\"https://godoc.org/github.com/google/gxui#ScrollLayout\" rel=\"nofollow noreferrer\">ScrollLayout</a> I think..."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "reply_to_user": {"reputation": 461, "user_id": 1821490, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/U91FX.jpg?s=128&g=1", "display_name": "Alex Kroll", "link": "https://stackoverflow.com/users/1821490/alex-kroll"}, "edited": false, "score": 0, "creation_date": 1436354097, "post_id": 31280709, "comment_id": 50572973, "body": "@AlexKroll , the main problem is to move the display area  together with the square-scroll."}, {"owner": {"reputation": 566, "user_id": 5091163, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100000663691395/picture?type=large", "display_name": "Barry McNamara", "link": "https://stackoverflow.com/users/5091163/barry-mcnamara"}, "edited": false, "score": 0, "creation_date": 1437152295, "post_id": 31280709, "comment_id": 50927181, "body": "ScrollLayout seems to be the way, but I&#39;m getting issues with display cutting off."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 0, "creation_date": 1437205040, "post_id": 31280709, "comment_id": 50942042, "body": "@BarryMcNamara ,  changed from 100 to 2000,everything displays as it should."}, {"owner": {"reputation": 566, "user_id": 5091163, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100000663691395/picture?type=large", "display_name": "Barry McNamara", "link": "https://stackoverflow.com/users/5091163/barry-mcnamara"}, "edited": false, "score": 0, "creation_date": 1437416770, "post_id": 31280709, "comment_id": 51008415, "body": "@Atomic_alarm that&#39;s disappointing. When I change 100 to 2000 it no longer displays properly. I get 0 1 on the first row, 4 5 on the second, and so on down until I hit 664 in the first column and then the second column disappears. The third and fourth columns are gone entirely."}, {"owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "edited": false, "score": 1, "creation_date": 1437419928, "post_id": 31280709, "comment_id": 51010314, "body": "@BarryMcNamara , that&#39;s really strange. For me display so: <a href=\"http://s9.postimg.org/owni8v1hb/image.jpg\" rel=\"nofollow noreferrer\">s9.postimg.org/owni8v1hb/image.jpg</a>"}, {"owner": {"reputation": 566, "user_id": 5091163, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100000663691395/picture?type=large", "display_name": "Barry McNamara", "link": "https://stackoverflow.com/users/5091163/barry-mcnamara"}, "edited": false, "score": 0, "creation_date": 1437434493, "post_id": 31280709, "comment_id": 51017049, "body": "Well at least I know it&#39;s not my code. I guess I&#39;ll try updating and rebuilding the GXUI packages."}], "answers": [{"comments": [{"owner": {"reputation": 566, "user_id": 5091163, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100000663691395/picture?type=large", "display_name": "Barry McNamara", "link": "https://stackoverflow.com/users/5091163/barry-mcnamara"}, "edited": false, "score": 0, "creation_date": 1437146676, "post_id": 31356910, "comment_id": 50923831, "body": "So that mostly works, but the scroll bar is awkwardly in the middle of the screen (an easy fix) and in adding it the rows got changed to some sort of selecting list. This wouldn&#39;t really work as a general solution to making any application window scroll."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user4651282"}, "is_accepted": false, "score": 2, "last_activity_date": 1436615662, "creation_date": 1436615662, "answer_id": 31356910, "question_id": 31280709, "link": "https://stackoverflow.com/questions/31280709/make-window-scroll-in-go-with-gxui/31356910#31356910", "title": "Make window scroll in Go with GXUI", "body": "<p>I wasn't able to do with help ScrollLayout, but I can propose this variant  on the basis of examples from <a href=\"https://github.com/google/gxui/blob/master/samples/lists/main.go\" rel=\"nofollow\">github</a>. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/google/gxui\"\n    \"github.com/google/gxui/drivers/gl\"\n    \"github.com/google/gxui/math\"\n    \"github.com/google/gxui/samples/flags\"\n    \"github.com/google/gxui/themes/dark\"\n)\n\ntype customAdapter struct {\n    gxui.AdapterBase\n}\n\nfunc (a *customAdapter) Count() int {\n    return 1000\n}\n\nfunc (a *customAdapter) ItemAt(index int) gxui.AdapterItem {\n    return index\n}\n\nfunc (a *customAdapter) ItemIndex(item gxui.AdapterItem) int {\n    return item.(int)\n}\n\nfunc (a *customAdapter) Size(theme gxui.Theme) math.Size {\n    return math.Size{W: 200, H: 25}\n}\n\nfunc (a *customAdapter) Create(theme gxui.Theme, index int) gxui.Control {\n\n    layout1 := theme.CreateLinearLayout()\n    layout1.SetDirection(gxui.LeftToRight)\n    for c := 0; c &lt; 4; c++ {\n        col := theme.CreateLinearLayout()\n        col.SetDirection(gxui.TopToBottom)\n        cell := theme.CreateLabel()\n        cell.SetText(fmt.Sprintf(\"%d\", index*4+c))\n        col.AddChild(cell)\n        layout1.AddChild(col)\n    }\n    return layout1\n}\n\nfunc appMain(driver gxui.Driver) {\n    theme := dark.CreateTheme(driver)\n    window := theme.CreateWindow(600, 400, \"Grid\")\n    window.BorderPen()\n    window.SetScale(flags.DefaultScaleFactor)\n    window.OnClose(driver.Terminate)\n    adapter := &amp;customAdapter{}\n    list := theme.CreateList()\n    list.SetAdapter(adapter)\n    list.SetOrientation(gxui.Vertical)\n    window.AddChild(list)\n}\n\nfunc main() {\n    gl.StartDriver(appMain)\n}\n</code></pre>\n\n<p>Each line is placed in the list,their number and size are specified in the overridden methods.  The advantage is that in the list already have the scrollbar.</p>\n"}, {"tags": [], "owner": {"reputation": 566, "user_id": 5091163, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100000663691395/picture?type=large", "display_name": "Barry McNamara", "link": "https://stackoverflow.com/users/5091163/barry-mcnamara"}, "is_accepted": true, "score": 1, "last_activity_date": 1437434800, "creation_date": 1437434800, "answer_id": 31527968, "question_id": 31280709, "link": "https://stackoverflow.com/questions/31280709/make-window-scroll-in-go-with-gxui/31527968#31527968", "title": "Make window scroll in Go with GXUI", "body": "<p>The following code uses ScrollLayout to add a scroll bar to the window. The trick is to make ScrollLayout the window's child and make the next widget (in this case a LinearLayout) a child of the ScrollLayout.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/google/gxui\"\n    \"github.com/google/gxui/drivers/gl\"\n    \"github.com/google/gxui/samples/flags\"\n    \"github.com/google/gxui/themes/dark\"\n)\n\nfunc appMain(driver gxui.Driver) {\n    theme := dark.CreateTheme(driver)\n    window := theme.CreateWindow(800, 600, \"Grid\")\n    window.SetScale(flags.DefaultScaleFactor)\n    window.OnClose(driver.Terminate)\n    sl := theme.CreateScrollLayout()\n    row := theme.CreateLinearLayout()\n    row.SetDirection(gxui.LeftToRight)\n    for c := 0; c &lt; 4; c++ {\n        col := theme.CreateLinearLayout()\n        col.SetDirection(gxui.TopToBottom)\n        for r := 0; r &lt; 100; r++ {\n            cell := theme.CreateLabel()\n            cell.SetText(fmt.Sprintf(\"%d\", r*4+c))\n            col.AddChild(cell)\n        }\n        row.AddChild(col)\n    }\n    sl.SetChild(row)\n    window.AddChild(sl)\n}\n\nfunc main() {\n    gl.StartDriver(appMain)\n}\n</code></pre>\n\n<p>Note that my computer gave me display issues when I increased the number of rows (the rightmost columns began to get cut off), but other people did not encounter this issue, so it is likely due to a bad installation on my end.</p>\n"}], "owner": {"reputation": 566, "user_id": 5091163, "user_type": "registered", "accept_rate": 71, "profile_image": "https://graph.facebook.com/100000663691395/picture?type=large", "display_name": "Barry McNamara", "link": "https://stackoverflow.com/users/5091163/barry-mcnamara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 626, "favorite_count": 0, "accepted_answer_id": 31527968, "answer_count": 2, "score": 2, "last_activity_date": 1437434832, "creation_date": 1436309328, "last_edit_date": 1437434832, "question_id": 31280709, "link": "https://stackoverflow.com/questions/31280709/make-window-scroll-in-go-with-gxui", "title": "Make window scroll in Go with GXUI", "body": "<p>I am trying to add scroll bars to my application windows in Go using GXUI.</p>\n\n<p>Say I have this code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/google/gxui\"\n    \"github.com/google/gxui/drivers/gl\"\n    \"github.com/google/gxui/samples/flags\"\n    \"github.com/google/gxui/themes/dark\"\n)\n\nfunc appMain(driver gxui.Driver) {\n    theme := dark.CreateTheme(driver)\n\n    window := theme.CreateWindow(800, 600, \"Grid\")\n    window.SetScale(flags.DefaultScaleFactor)\n    window.OnClose(driver.Terminate)\n\n    row := theme.CreateLinearLayout()\n    row.SetDirection(gxui.LeftToRight)\n    for c := 0; c &lt; 4; c++ {\n        col := theme.CreateLinearLayout()\n        col.SetDirection(gxui.TopToBottom)\n        for r := 0; r &lt; 100; r++ {\n            cell := theme.CreateLabel()\n            cell.SetText(fmt.Sprintf(\"%d\", r*4+c))\n            col.AddChild(cell)\n        }\n        row.AddChild(col)\n    }\n\n    window.AddChild(row)\n}\n\nfunc main() {\n    gl.StartDriver(appMain)\n}\n</code></pre>\n\n<p>When I run it, I get this window:</p>\n\n<p><img src=\"https://i.stack.imgur.com/bf0Mo.png\" alt=\"enter image description here\"></p>\n\n<p>How can I get the window to have a scroll bar so that I can view all of the lines?</p>\n"}, {"tags": ["go", "compiler-construction", "scheme", "lisp", "interpreter"], "comments": [{"owner": {"reputation": 44043, "user_id": 1565698, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/7dace33805b9dcdec5aa63308daf88dc?s=128&d=identicon&r=PG", "display_name": "Sylwester", "link": "https://stackoverflow.com/users/1565698/sylwester"}, "edited": false, "score": 1, "creation_date": 1436305921, "post_id": 31279557, "comment_id": 50553436, "body": "I don&#39;t think a lisp interpreter is a good first code to inspect in a new language unless you have implemented a good deal of your own lisp interpreters. In your&#39;re interested in LISP <a href=\"http://lib.store.yahoo.net/lib/paulgraham/jmc.ps\" rel=\"nofollow noreferrer\">read the roots of Lisp</a> (NB: Postscript file)."}], "answers": [{"tags": [], "owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "is_accepted": false, "score": 2, "last_activity_date": 1436307027, "creation_date": 1436307027, "answer_id": 31280222, "question_id": 31279557, "link": "https://stackoverflow.com/questions/31279557/scheme-interpreter-in-go/31280222#31280222", "title": "Scheme interpreter in Go", "body": "<p>First one is type switch. You can read about it more <a href=\"https://golang.org/doc/effective_go.html#type_switch\" rel=\"nofollow\">here</a>.</p>\n\n<p>Second one is slicing like in python (if you know it, should be familiar)</p>\n\n<pre><code>ls = ls[1:]\n</code></pre>\n\n<p>We're skipping first item and taking the rest of the slice/list.</p>\n\n<p>As I see from your comments, I think it's not a good starting point to experiment with golang.</p>\n"}, {"tags": [], "owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "is_accepted": false, "score": 1, "last_activity_date": 1436351346, "creation_date": 1436351346, "answer_id": 31289995, "question_id": 31279557, "link": "https://stackoverflow.com/questions/31279557/scheme-interpreter-in-go/31289995#31289995", "title": "Scheme interpreter in Go", "body": "<p><code>e := expression.(type)</code> is a <a href=\"http://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a>.</p>\n\n<p><code>switch p := procedure.(type) {</code> (with the following case statements) is a <a href=\"http://golang.org/ref/spec#Type_switches\" rel=\"nofollow\">type switch</a>.</p>\n\n<p><code>*tokens = (*tokens)[1:]</code> is a <a href=\"http://golang.org/ref/spec#Slice_expressions\" rel=\"nofollow\">slice expression</a> changing the value stored in <code>*tokens</code>.</p>\n\n<pre><code>token := (*tokens)[0]       // Set token to first element of tokens slice.\n*tokens = (*tokens)[1:]     // Update tokens to remove first element.\nswitch token {              // Switch on token.\ncase \"(\": //a list begins   // If token is \"(\"\n    L := make([]scmer, 0)       // Make a new, empty slice.\n    for (*tokens)[0] != \")\" {   // While the first element of tokens is not \")\":\n                                    // Read from tokens; if not empty symbol:\n        if i := readFrom(tokens); i != symbol(\"\") {\n            L = append(L, i)        // Add the token read (in i) to L.\n        }\n    }\n    *tokens = (*tokens)[1:]     // Remove the first element from tokens.\n    return L                    // Return the newly created slice.\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 4996401, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bb89e2cf45084d095f214b4906c61cd9?s=128&d=identicon&r=PG&f=1", "display_name": "Francis", "link": "https://stackoverflow.com/users/4996401/francis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 337, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1436351346, "creation_date": 1436304365, "question_id": 31279557, "link": "https://stackoverflow.com/questions/31279557/scheme-interpreter-in-go", "title": "Scheme interpreter in Go", "body": "<p>I'm quite a basic Go programmer and I've been taking a look at this small Scheme interpreter and I've been trying to understand how it works.</p>\n\n<p>I found it here:\n<a href=\"https://pkelchte.wordpress.com/2013/12/31/scm-go/\" rel=\"nofollow\">https://pkelchte.wordpress.com/2013/12/31/scm-go/</a></p>\n\n<p>I read the webpage, but I'm still struggling to understand how it works because the source code is obviously written by someone who's a lot more familiar with Go than I am.</p>\n\n<p>Particularly there's these lines that I'm struggling to understand:</p>\n\n<pre><code>e := expression.(type) // Line 73\n</code></pre>\n\n<p>I'm not sure what the <code>.(type)</code> part means, I thought it was casting but it doesn't look like the casting I've seen before.</p>\n\n<pre><code>switch p := procedure.(type) {\ncase func(...scmer) scmer:\n    value = p(args...)\ncase proc:\n    en := &amp;env{make(vars), p.en}\n    switch params := p.params.(type) {\n    case []scmer:\n        for i, param := range params {\n            en.vars[param.(symbol)] = args[i]\n        }\n    default:\n        en.vars[params.(symbol)] = args\n    }\n    value = eval(p.body, en)\n</code></pre>\n\n<p>I don't really understand any of this code to be honest. Lines 73 - 86</p>\n\n<pre><code>*tokens = (*tokens)[1:] // Line 208\n</code></pre>\n\n<p>I'm not sure what this line means due to it's weird syntax. I get that its pointers and that the parenthesises are because of the *. But I'm not sure what that lines doing.</p>\n\n<p>Finally there's these lines:</p>\n\n<pre><code>token := (*tokens)[0]\n*tokens = (*tokens)[1:]\nswitch token {\ncase \"(\": //a list begins\n    L := make([]scmer, 0)\n    for (*tokens)[0] != \")\" {\n        if i := readFrom(tokens); i != symbol(\"\") {\n            L = append(L, i)\n        }\n    }\n    *tokens = (*tokens)[1:]\n    return L\n</code></pre>\n\n<p>I don't know what these lines do either. Lines 198 - 209</p>\n\n<p>Here's the complete code if you want it, I realise it's 250 lines long but I'd really appreciate as many explanations about what its doing as possible.</p>\n\n<pre><code>/*\n * A minimal Scheme interpreter, as seen in lis.py and SICP\n * http://norvig.com/lispy.html\n * http://mitpress.mit.edu/sicp/full-text/sicp/book/node77.html\n *\n * Pieter Kelchtermans 2013\n * LICENSE: WTFPL 2.0\n */\npackage main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"log\"\n    \"os\"\n    \"reflect\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    Repl()\n}\n\n/*\n Eval / Apply\n*/\n\nfunc eval(expression scmer, en *env) (value scmer) {\n    switch e := expression.(type) {\n    case number:\n        value = e\n    case symbol:\n        value = en.Find(e).vars[e]\n    case []scmer:\n        switch car, _ := e[0].(symbol); car {\n        case \"quote\":\n            value = e[1]\n        case \"if\":\n            if eval(e[1], en).(bool) {\n                value = eval(e[2], en)\n            } else {\n                value = eval(e[3], en)\n            }\n        case \"set!\":\n            v := e[1].(symbol)\n            en.Find(v).vars[v] = eval(e[2], en)\n            value = \"ok\"\n        case \"define\":\n            en.vars[e[1].(symbol)] = eval(e[2], en)\n            value = \"ok\"\n        case \"lambda\":\n            value = proc{e[1], e[2], en}\n        case \"begin\":\n            for _, i := range e[1:] {\n                value = eval(i, en)\n            }\n        default:\n            operands := e[1:]\n            values := make([]scmer, len(operands))\n            for i, x := range operands {\n                values[i] = eval(x, en)\n            }\n            value = apply(eval(e[0], en), values)\n        }\n    default:\n        log.Println(\"Unknown expression type - EVAL\", e)\n    }\n    return\n}\n\nfunc apply(procedure scmer, args []scmer) (value scmer) {\n    switch p := procedure.(type) {\n    case func(...scmer) scmer:\n        value = p(args...)\n    case proc:\n        en := &amp;env{make(vars), p.en}\n        switch params := p.params.(type) {\n        case []scmer:\n            for i, param := range params {\n                en.vars[param.(symbol)] = args[i]\n            }\n        default:\n            en.vars[params.(symbol)] = args\n        }\n        value = eval(p.body, en)\n    default:\n        log.Println(\"Unknown procedure type - APPLY\", p)\n    }\n    return\n}\n\ntype proc struct {\n    params, body scmer\n    en           *env\n}\n\n/*\n Environments\n*/\n\ntype vars map[symbol]scmer\ntype env struct {\n    vars\n    outer *env\n}\n\nfunc (e *env) Find(s symbol) *env {\n    if _, ok := e.vars[s]; ok {\n        return e\n    } else {\n        return e.outer.Find(s)\n    }\n}\n\n/*\n Primitives\n*/\n\nvar globalenv env\n\nfunc init() {\n    globalenv = env{\n        vars{ //aka an incomplete set of compiled-in functions\n            \"+\": func(a ...scmer) scmer {\n                v := a[0].(number)\n                for _, i := range a[1:] {\n                    v += i.(number)\n                }\n                return v\n            },\n            \"-\": func(a ...scmer) scmer {\n                v := a[0].(number)\n                for _, i := range a[1:] {\n                    v -= i.(number)\n                }\n                return v\n            },\n            \"*\": func(a ...scmer) scmer {\n                v := a[0].(number)\n                for _, i := range a[1:] {\n                    v *= i.(number)\n                }\n                return v\n            },\n            \"/\": func(a ...scmer) scmer {\n                v := a[0].(number)\n                for _, i := range a[1:] {\n                    v /= i.(number)\n                }\n                return v\n            },\n            \"&lt;=\": func(a ...scmer) scmer {\n                return a[0].(number) &lt;= a[1].(number)\n            },\n            \"equal?\": func(a ...scmer) scmer {\n                return reflect.DeepEqual(a[0], a[1])\n            },\n            \"cons\": func(a ...scmer) scmer {\n                switch car := a[0]; cdr := a[1].(type) {\n                case []scmer:\n                    return append([]scmer{car}, cdr...)\n                default:\n                    return []scmer{car, cdr}\n                }\n            },\n            \"car\": func(a ...scmer) scmer {\n                return a[0].([]scmer)[0]\n            },\n            \"cdr\": func(a ...scmer) scmer {\n                return a[0].([]scmer)[1:]\n            },\n            \"list\": eval(read(\n                \"(lambda z z)\"),\n                &amp;globalenv),\n        },\n        nil}\n}\n\n/*\n Parsing\n*/\n\n//symbols, numbers, expressions, procedures, lists, ... all implement this interface, which enables passing them along in the interpreter\ntype scmer interface{}\n\ntype symbol string  //symbols are represented by strings\ntype number float64 //numbers by float64\n\nfunc read(s string) (expression scmer) {\n    tokens := tokenize(s)\n    return readFrom(&amp;tokens)\n}\n\n//Syntactic Analysis\nfunc readFrom(tokens *[]string) (expression scmer) {\n    //pop first element from tokens\n    token := (*tokens)[0]\n    *tokens = (*tokens)[1:]\n    switch token {\n    case \"(\": //a list begins\n        L := make([]scmer, 0)\n        for (*tokens)[0] != \")\" {\n            if i := readFrom(tokens); i != symbol(\"\") {\n                L = append(L, i)\n            }\n        }\n        *tokens = (*tokens)[1:]\n        return L\n    default: //an atom occurs\n        if f, err := strconv.ParseFloat(token, 64); err == nil {\n            return number(f)\n        } else {\n            return symbol(token)\n        }\n    }\n}\n\n//Lexical Analysis\nfunc tokenize(s string) []string {\n    return strings.Split(\n        strings.Replace(strings.Replace(s, \"(\", \"( \",\n            -1), \")\", \" )\",\n            -1), \" \")\n}\n\n/*\n Interactivity\n*/\n\nfunc String(v scmer) string {\n    switch v := v.(type) {\n    case []scmer:\n        l := make([]string, len(v))\n        for i, x := range v {\n            l[i] = String(x)\n        }\n        return \"(\" + strings.Join(l, \" \") + \")\"\n    default:\n        return fmt.Sprint(v)\n    }\n}\n\nfunc Repl() {\n    scanner := bufio.NewScanner(os.Stdin)\n    for fmt.Print(\"&gt; \"); scanner.Scan(); fmt.Print(\"&gt; \") {\n        fmt.Println(\"==&gt;\", String(eval(read(scanner.Text()), &amp;globalenv)))\n    }\n}\n</code></pre>\n"}, {"tags": ["time", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1436303787, "post_id": 31278948, "comment_id": 50552504, "body": "Both the answers in the marked duplicate contains your solution (using <code>Time.In()</code>)."}, {"owner": {"reputation": 395, "user_id": 733880, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1d9a1a77a93e3338a009e9b28b78cd7?s=128&d=identicon&r=PG", "display_name": "Stephen Smith", "link": "https://stackoverflow.com/users/733880/stephen-smith"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1436303894, "post_id": 31278948, "comment_id": 50552560, "body": "The other question was about how to make a new time instead of parse into a timezone which I am trying to do with ParseInLocation"}, {"owner": {"reputation": 116, "user_id": 567512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1b4319173ff1a5fb56ea2cfbd6781414?s=128&d=identicon&r=PG", "display_name": "reedobrien", "link": "https://stackoverflow.com/users/567512/reedobrien"}, "edited": false, "score": 0, "creation_date": 1436304434, "post_id": 31278948, "comment_id": 50552779, "body": "You are printing the time wihtout the location. You can do       <code>.Println(t.Format(&quot;Monday Jan 2, 3:01pm (MST)&quot;))</code>  to print the time with the Location information. Also t.UTC() works. Your math is reversed.       <code>&#47;&#47; This looks correct, 20 - 0400 = 16 = 4pm</code>   The time should be added to get the UTC time. So UTC time is 12am next day rather than UTC minus 8  <a href=\"https://play.golang.org/p/WL9DQtvcBh\" rel=\"nofollow noreferrer\">Updated playground link</a>  See also the linked answer for <code>time.In()</code>"}, {"owner": {"reputation": 395, "user_id": 733880, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1d9a1a77a93e3338a009e9b28b78cd7?s=128&d=identicon&r=PG", "display_name": "Stephen Smith", "link": "https://stackoverflow.com/users/733880/stephen-smith"}, "edited": false, "score": 0, "creation_date": 1436390773, "post_id": 31278948, "comment_id": 50597897, "body": "My math can&#39;t be reversed... I used a date returned by twitter at 4pm, and the twitter date said 8pm +0000, then golang converted it to 8pm -0400"}, {"owner": {"reputation": 395, "user_id": 733880, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1d9a1a77a93e3338a009e9b28b78cd7?s=128&d=identicon&r=PG", "display_name": "Stephen Smith", "link": "https://stackoverflow.com/users/733880/stephen-smith"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1437597072, "post_id": 31278948, "comment_id": 51101719, "body": "@icza I have updated the question explaining the exact problem I have, including the solution from the &quot;duplicate&quot;, which doesn&#39;t work for me."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1437600334, "post_id": 31278948, "comment_id": 51103440, "body": "@Stephen Yes, it is good now. Reopened and answered your question."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1578571465, "last_edit_date": 1578571465, "creation_date": 1437600218, "answer_id": 31574241, "question_id": 31278948, "link": "https://stackoverflow.com/questions/31278948/how-to-format-a-local-time-object-in-go-with-correct-minutes/31574241#31574241", "title": "How to format a local time object in Go with correct minutes?", "body": "<p>Your layout (format) strings are incorrect. As noted in the doc of the <a href=\"http://golang.org/pkg/time/\" rel=\"nofollow noreferrer\">time</a> package, the layout string must denote this time:</p>\n\n<pre><code>Mon Jan 2 15:04:05 MST 2006\n</code></pre>\n\n<p>When parsing, use the following format string:</p>\n\n<pre><code>t, _ := time.Parse(\"Mon Jan 02 15:04:05 -0700 2006\", \"Tue Jul 07 10:38:18 +0000 2015\")\n</code></pre>\n\n<p>And when printing, use this format string:</p>\n\n<pre><code>fmt.Println(t.Format(\"Monday Jan 2, 3:04pm\"))\n</code></pre>\n\n<p>This will result in your expected output:</p>\n\n<pre><code>Tuesday Jul 7, 6:38am\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/0HohAuY239\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n"}], "owner": {"reputation": 395, "user_id": 733880, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/c1d9a1a77a93e3338a009e9b28b78cd7?s=128&d=identicon&r=PG", "display_name": "Stephen Smith", "link": "https://stackoverflow.com/users/733880/stephen-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 715, "favorite_count": 0, "accepted_answer_id": 31574241, "answer_count": 1, "score": 0, "last_activity_date": 1578571465, "creation_date": 1436302004, "last_edit_date": 1437596987, "question_id": 31278948, "link": "https://stackoverflow.com/questions/31278948/how-to-format-a-local-time-object-in-go-with-correct-minutes", "title": "How to format a local time object in Go with correct minutes?", "body": "<p>Edit: I have updated the question with code that highlights why the alleged duplicate's solution doesn't work for me</p>\n\n<p>I am trying to take UTC (+0000) times and format them into local times (eastern time in my case) without hard coding any timezone offsets (as to avoid implementing dst correction).</p>\n\n<p>I have the following code which demonstrates the problem I am having</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    // Here I load the timezone\n    timezone, _ := time.LoadLocation(\"America/New_York\")\n\n    // I parse the time\n    t, _ := time.Parse(\"Mon Jan 2 15:04:05 +0000 2006\", \"Tue Jul 07 10:38:18 +0000 2015\")\n\n    // This looks correct, it's still a utc time\n    fmt.Println(t)\n    // 2015-07-07 10:38:18 +0000 UTC\n\n    // This seems to be fine - -4 hours to convert to est\n    t = t.In(timezone)\n    fmt.Println(t)\n    // 2015-07-07 06:38:18 -0400 EDT\n\n    // This prints 6:07am, completely incorrect as it should be 6:38am\n    fmt.Println(t.Format(\"Monday Jan 2, 3:01pm\"))\n    // Tuesday Jul 7, 6:07am\n}\n</code></pre>\n\n<p>(<a href=\"https://play.golang.org/p/e57slFhWFk\" rel=\"nofollow\">https://play.golang.org/p/e57slFhWFk</a>)</p>\n\n<p>So to me it seems that it parses and converts timezones fine, but when I output it using format, it gets rid of the minutes and uses 07. It doesn't matter what I set the minutes to, it always comes out as 07.</p>\n"}, {"tags": ["go", "libgit2"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436294604, "post_id": 31276740, "comment_id": 50547541, "body": "After you call <code>repo.Merge</code> how do you know nothing has happened? I just glanced at the code and it seems like you&#39;re using it correctly, if no error occurs I would expect something to happen, at least for the changes to be staged."}, {"owner": {"reputation": 1598, "user_id": 1104534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad2bdd8c4d37364f52e6ab7aa92ef570?s=128&d=identicon&r=PG", "display_name": "Calin", "link": "https://stackoverflow.com/users/1104534/calin"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436294701, "post_id": 31276740, "comment_id": 50547608, "body": "The changes are not staged, the index is not updated in any way. The only thing that I can see is the origin/master being updated, as a result of the <code>Fetch()</code> and if I <code>git checkout origin&#47;master</code> I can see the new changes in the working tree."}], "answers": [{"tags": [], "owner": {"reputation": 1598, "user_id": 1104534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad2bdd8c4d37364f52e6ab7aa92ef570?s=128&d=identicon&r=PG", "display_name": "Calin", "link": "https://stackoverflow.com/users/1104534/calin"}, "is_accepted": true, "score": 1, "last_activity_date": 1436351495, "creation_date": 1436351495, "answer_id": 31290050, "question_id": 31276740, "link": "https://stackoverflow.com/questions/31276740/merge-current-branch-with-upstream-or-any-other-ref-in-git2go/31290050#31290050", "title": "Merge current branch with upstream (or any other ref) in git2go", "body": "<p>Checkout is performing a dry run by default, so to be able to successfully merge I had to use something like this:</p>\n\n\n\n<pre><code>checkoutOpts := git.CheckoutOpts{\n    Strategy: git.CheckoutSafe | git.CheckoutRecreateMissing | git.CheckoutAllowConflicts | git.CheckoutUseTheirs,\n}\n</code></pre>\n\n<p>The only documentation available is in the <a href=\"https://github.com/libgit2/git2go/blob/next/checkout.go#L16\" rel=\"nofollow\">checkout.go source</a>.</p>\n"}], "owner": {"reputation": 1598, "user_id": 1104534, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/ad2bdd8c4d37364f52e6ab7aa92ef570?s=128&d=identicon&r=PG", "display_name": "Calin", "link": "https://stackoverflow.com/users/1104534/calin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 1, "accepted_answer_id": 31290050, "answer_count": 1, "score": 1, "last_activity_date": 1436351495, "creation_date": 1436294345, "last_edit_date": 1436302923, "question_id": 31276740, "link": "https://stackoverflow.com/questions/31276740/merge-current-branch-with-upstream-or-any-other-ref-in-git2go", "title": "Merge current branch with upstream (or any other ref) in git2go", "body": "<p>I'm trying to replicate the outcome of the following command in git2go:</p>\n\n<pre><code>git merge -X theirs --no-ff -m \"Commit msg\" &lt;commit&gt;\n</code></pre>\n\n<p>I'm able to successfully fetch the upstream remote using <code>remote.Fetch(nil, nil, \"\")</code>, but I cannot do the actual merge. This is the code I'm using for merging:</p>\n\n\n\n<pre><code>// get the upstream ref's annotated commit to merge in\nhead, _ := repo.Head()\nupstream, _ := head.Branch().Upstream()\nannotatedCommit, _ := repo.AnnotatedCommitFromRef(upstream)\n\n// prepare merge and checkout options\nmergeOpts, _ := git.DefaultMergeOptions()\nmergeOpts.FileFavor = git.MergeFileFavorTheirs\ncheckoutOpts := git.CheckoutOpts{\n    Strategy: git.CheckoutUseTheirs,\n}\n\n// do the merge\nerr := repo.Merge([]*git.AnnotatedCommit{annotatedCommit}, &amp;mergeOpts, &amp;checkoutOpts)\n// no error here\n</code></pre>\n\n<p>I understand that after this I need to check the index for any conflicts, and actually do the commit with the two parents, however I'm stuck here at the moment because the <code>Merge()</code> doesn't appear to be doing anything (no merge, no checkout).</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-ec2"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436293476, "post_id": 31276319, "comment_id": 50546852, "body": "Have you tried some variations on the inputs? Just noticing minor differences between the bash command and the string literals in Go for example; <code>sg-1357</code> vs <code>1357</code>. A glance at the docs makes me think you need the former."}, {"owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436293954, "post_id": 31276319, "comment_id": 50547132, "body": "I do have the correct GroupID in my actual code.  That was an error when deleting my specific data.  Edited the code to reflect sg-1357"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1436294202, "post_id": 31276319, "comment_id": 50547285, "body": "I&#39;m getting nit picky but your <code>CIDRIP</code> value is also a little different. Also, can you just remove the groupName from the command? It says it&#39;s looking in the default VPC for that group however your use of an GroupID indicates you might be using something other than the default? Besides that neither are required so I would think one of the two would suffice."}, {"owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "reply_to_user": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436294878, "post_id": 31276319, "comment_id": 50547706, "body": "I nearly answered that I had tried removing the GroupName. So the answer would be &quot;Comment out the GroupName: line&quot; and it works up to the DryRun error.  If you answer I&#39;ll confirm it.  Thanks."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1436296095, "post_id": 31276319, "comment_id": 50548488, "body": "my pleasure and much appreciate the opportunity to answer :D"}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 2, "last_activity_date": 1436299261, "last_edit_date": 1436299261, "creation_date": 1436295482, "answer_id": 31277109, "question_id": 31276319, "link": "https://stackoverflow.com/questions/31276319/cant-call-ec2-authorizesecuritygroupingressinput-when-using-other-than-the-defa/31277109#31277109", "title": "Can&#39;t call ec2.AuthorizeSecurityGroupIngressInput when using other than the default VPC (aws-sdk-go)", "body": "<p>If you comment out the <code>GroupName</code> line it will work up to the <code>DryRun</code> error.</p>\n\n<p>params end up looking like this:</p>\n\n<pre><code>  params := &amp;ec2.AuthorizeSecurityGroupIngressInput{\n    CIDRIP:    aws.String(\"127.0.0.1/32\"),\n    DryRun:    aws.Boolean(true),\n    FromPort:  aws.Long(443),\n    GroupID:   aws.String(\"sg-1357\"),\n    IPProtocol:                 aws.String(\"tcp\"),\n    SourceSecurityGroupName:    aws.String(\"\"),\n    SourceSecurityGroupOwnerID: aws.String(\"\"),\n    ToPort: aws.Long(443),\n  }\n</code></pre>\n"}], "owner": {"reputation": 1667, "user_id": 359660, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/73a63c1f44ef127e609753975421ef7f?s=128&d=identicon&r=PG", "display_name": "LanceH", "link": "https://stackoverflow.com/users/359660/lanceh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 31277109, "answer_count": 1, "score": 0, "last_activity_date": 1436299261, "creation_date": 1436292920, "last_edit_date": 1436293873, "question_id": 31276319, "link": "https://stackoverflow.com/questions/31276319/cant-call-ec2-authorizesecuritygroupingressinput-when-using-other-than-the-defa", "title": "Can&#39;t call ec2.AuthorizeSecurityGroupIngressInput when using other than the default VPC (aws-sdk-go)", "body": "<p>When running the below code, I get the error message</p>\n\n<pre><code>InvalidGroup.NotFound The security group 'OddName' does not exist in default VPC 'vpc-2468'\n</code></pre>\n\n<p>That is the correct VPC name, but not the VPC ID that would be seen when looking at sg-1357.  This is a request error, not an aws error, so it's getting at least that far.</p>\n\n<p>From the command line this works:</p>\n\n<pre><code>aws ec2 authorize-security-group-ingress --group-id sg-1357 --cidr 127.0.0.1/32  --protocol tcp --port 443\n</code></pre>\n\n<p>And I can confirm the ip has been added.</p>\n\n<p>Modifying the example code from the <a href=\"https://github.com/aws/aws-sdk-go/blob/master/service/ec2/examples_test.go\" rel=\"nofollow\" title=\"example\">sdk on github</a>, the following produces the default VPC error:</p>\n\n<pre><code>func ExampleEC2_AuthorizeSecurityGroupIngress() {\nsvc := ec2.New(nil)\n\nparams := &amp;ec2.AuthorizeSecurityGroupIngressInput{\n    CIDRIP:    aws.String(\"127.0.0.1\"),\n    DryRun:    aws.Boolean(true),\n    FromPort:  aws.Long(443),\n    GroupID:   aws.String(\"sg-1357\"),\n    GroupName: aws.String(\"OddName\"),\n    IPPermissions: []*ec2.IPPermission{\n        { // Required\n            FromPort:   aws.Long(1),\n            IPProtocol: aws.String(\"String\"),\n            IPRanges: []*ec2.IPRange{\n                { // Required\n                    CIDRIP: aws.String(\"String\"),\n                },\n                // More values...\n            },\n            PrefixListIDs: []*ec2.PrefixListID{\n                { // Required\n                    PrefixListID: aws.String(\"String\"),\n                },\n                // More values...\n            },\n            ToPort: aws.Long(1),\n            UserIDGroupPairs: []*ec2.UserIDGroupPair{\n                { // Required\n                    GroupID:   aws.String(\"String\"),\n                    GroupName: aws.String(\"String\"),\n                    UserID:    aws.String(\"String\"),\n                },\n                // More values...\n            },\n        },\n        // More values...\n    },\n    IPProtocol:                 aws.String(\"String\"),\n    SourceSecurityGroupName:    aws.String(\"String\"),\n    SourceSecurityGroupOwnerID: aws.String(\"String\"),\n    ToPort: aws.Long(443),\n}\nresp, err := svc.AuthorizeSecurityGroupIngress(params)\n\nif err != nil {\n    if awsErr, ok := err.(awserr.Error); ok {\n        // Generic AWS error with Code, Message, and original error (if any)\n        fmt.Println(awsErr.Code(), awsErr.Message(), awsErr.OrigErr())\n        if reqErr, ok := err.(awserr.RequestFailure); ok {\n            // A service error occurred\n            // ERROR GETS REPORTED HERE\n            fmt.Println(reqErr.Code(), reqErr.Message(), reqErr.StatusCode(), reqErr.RequestID())\n        }\n    } else {\n        // This case should never be hit, the SDK should always return an\n        // error which satisfies the awserr.Error interface.\n        fmt.Println(err.Error())\n    }\n}\n\n// Pretty-print the response data.\nfmt.Println(awsutil.StringValue(resp))\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["unix", "logging", "go"], "comments": [{"owner": {"reputation": 5681, "user_id": 3040064, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/02e7081757e69605a91b7f7aea47f4ae?s=128&d=identicon&r=PG&f=1", "display_name": "Jason Hu", "link": "https://stackoverflow.com/users/3040064/jason-hu"}, "edited": false, "score": 0, "creation_date": 1436287686, "post_id": 31274669, "comment_id": 50543425, "body": "that&#39;s redirection. are you sure you have output in stdout?"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 7, "last_activity_date": 1436287699, "creation_date": 1436287699, "answer_id": 31274715, "question_id": 31274669, "link": "https://stackoverflow.com/questions/31274669/can-not-use-or-to-write-to-file-from-log-println-and-log-printf/31274715#31274715", "title": "Can not use &#39;&gt;&#39; or &#39;&gt;&gt;&#39; to write to file from log.Println() and log.Printf()", "body": "<p>Go's <a href=\"https://github.com/golang/go/blob/release-branch.go1.4/src/log/log.go#L58\" rel=\"noreferrer\">standard logger</a> writes to stderr. You should either use <code>2&gt;</code> and <code>2&gt;&gt;</code> and their friends in your shell scripts, or create your own logger that writes to stdout.</p>\n"}, {"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1436291362, "last_edit_date": 1436291362, "creation_date": 1436287701, "answer_id": 31274716, "question_id": 31274669, "link": "https://stackoverflow.com/questions/31274669/can-not-use-or-to-write-to-file-from-log-println-and-log-printf/31274716#31274716", "title": "Can not use &#39;&gt;&#39; or &#39;&gt;&gt;&#39; to write to file from log.Println() and log.Printf()", "body": "<p>I don't think you're writing to stdout, try using <code>fmt</code> instead of log. If the default <code>fmt.Println</code> and <code>fmt.Printf</code> don't work, the package details are here can get an io.Writer specific to stdout or stderr which will surely work. The docs are here <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow\">https://golang.org/pkg/fmt/</a></p>\n"}], "owner": {"reputation": 1066, "user_id": 1307718, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e77eecdb3703ef9bace953101779216?s=128&d=identicon&r=PG", "display_name": "Methuz Kaewsai-kao", "link": "https://stackoverflow.com/users/1307718/methuz-kaewsai-kao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 258, "favorite_count": 0, "accepted_answer_id": 31274715, "answer_count": 2, "score": 2, "last_activity_date": 1436291362, "creation_date": 1436287558, "question_id": 31274669, "link": "https://stackoverflow.com/questions/31274669/can-not-use-or-to-write-to-file-from-log-println-and-log-printf", "title": "Can not use &#39;&gt;&#39; or &#39;&gt;&gt;&#39; to write to file from log.Println() and log.Printf()", "body": "<p>I try to write to file using <code>&gt;&gt;</code> as usual by for Go project, It does not work.</p>\n\n<p><code>./main &gt;&gt; info.log</code> or <code>go run main.go &gt;&gt; info.log</code></p>\n\n<p>I'm running as root and I've tried to change file permission to 755 but still noting in info.log. I've also tried <code>ls &gt;&gt; ls.log</code> It works fine.\nSo I think there is something wrong with my code. All I use are <code>log.Println()</code> and <code>log.Printf()</code></p>\n\n<p>My code runs on Ubuntu 12.04.5 LTS (GNU/Linux 3.13.0-32-generic x86_64)</p>\n"}, {"tags": ["go", "net-http", "redigo"], "comments": [{"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "edited": false, "score": 3, "creation_date": 1436286737, "post_id": 31274300, "comment_id": 50542859, "body": "It may be giving you an error message, but you would have no way of seeing it as you aren&#39;t piping the output anywhere.  If you start it with <code>nohup .&#47;myProgram &amp;</code> it will run in the background but put all of the output in the file <code>nohup.out</code>, and then once it crashed you could look at the file and see if there is an error message."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 1, "creation_date": 1436286746, "post_id": 31274300, "comment_id": 50542868, "body": "Obviously no one here is going to be able to debug your webservice for you and obviously you have a bug which is resulting in a fatal panic (no recover)... Find your way to a specific programming problem and you&#39;ll surely find help but there&#39;s not much to do here. As far as catching your error goes, you can use a defer/recover pattern to implement what acts like an application level exception handler (catch block). Then log your error and use that information to write an actual question."}], "answers": [{"comments": [{"owner": {"reputation": 474, "user_id": 3249983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b731b133349215fb4d53a6bde054d4a3?s=128&d=identicon&r=PG&f=1", "display_name": "GuillaumeP", "link": "https://stackoverflow.com/users/3249983/guillaumep"}, "edited": false, "score": 0, "creation_date": 1436365153, "post_id": 31281427, "comment_id": 50581478, "body": "Thank you ! With nohup, my service doesn&#39;t crash anymore !"}], "tags": [], "owner": {"reputation": 1101, "user_id": 757102, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/60bb12c55b318f541cb55c7eeb6bec8f?s=128&d=identicon&r=PG", "display_name": "Colin Nicholson", "link": "https://stackoverflow.com/users/757102/colin-nicholson"}, "is_accepted": false, "score": 2, "last_activity_date": 1436313814, "last_edit_date": 1492085627, "creation_date": 1436313814, "answer_id": 31281427, "question_id": 31274300, "link": "https://stackoverflow.com/questions/31274300/golang-webservice-crashes-unexpectedly-without-error/31281427#31281427", "title": "golang webservice crashes unexpectedly without error", "body": "<p>You mention that this only happens when running on a production server.</p>\n\n<p>Could it be the case that the process is being killed when you disconnect your login session? If so, you want to either use a proper startup script, or at least start it with <strong>nohup</strong></p>\n\n<pre><code>nohup ./myProgram &amp;\n</code></pre>\n\n<p>See <a href=\"https://serverfault.com/questions/311593/keeping-a-linux-process-running-after-i-logout\">this answer at serverfault</a> for more details.</p>\n"}], "owner": {"reputation": 474, "user_id": 3249983, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/b731b133349215fb4d53a6bde054d4a3?s=128&d=identicon&r=PG&f=1", "display_name": "GuillaumeP", "link": "https://stackoverflow.com/users/3249983/guillaumep"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1217, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1436313814, "creation_date": 1436286389, "question_id": 31274300, "link": "https://stackoverflow.com/questions/31274300/golang-webservice-crashes-unexpectedly-without-error", "title": "golang webservice crashes unexpectedly without error", "body": "<p>I'm developping a webservice with golang. It uses the net/http package and others packages like github.com/go-sql-driver/mysql and redigo (redis).\nI have no problem when I develop it, no bugs.\nWhen I put it on a server in production as a service in back ground (i.e. : launched with ./myProgram &amp;).\nThe problem is that after a few times, which is never the same : it can be a few minutes or a few hours, it just crash. The service doesn't appear anymore in netstat : it is down.\nI look the memory/CPU consumption/opened tcp connections, there's nothing anormal. \nI also log information on errors and requests on my service in a file, but there is nothing anormal, it just crashes.</p>\n\n<p>If you have any idea,please tell me. Or any idea on the way I can track the error.</p>\n"}, {"tags": ["email", "parsing", "go"], "comments": [{"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 2, "creation_date": 1436285883, "post_id": 31272725, "comment_id": 50542320, "body": "Side notes: don&#39;t read in everything then use <code>bytes.NewBuffer</code> to &quot;get an <code>io.Reader</code>&quot; when <code>os.Stdin</code> <i>already is an <code>io.Reader</code></i>; don&#39;t just exit without any reason/feedback on <code>err != nil</code>, at least do something like <code>log.Fatal(err)</code>."}], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 2, "last_activity_date": 1436286938, "last_edit_date": 1436286938, "creation_date": 1436286481, "answer_id": 31274335, "question_id": 31272725, "link": "https://stackoverflow.com/questions/31272725/how-to-send-an-e-mail-from-go/31274335#31274335", "title": "How to send an e-mail from Go", "body": "<p>Using <code>net/smtp</code> you can do this fairly easily... Assuming you have an smtp server running that you can connect to without authentication. I would guess for what you're trying to accomplish it's actually a lot easier to do through something simple like your gmail ( <a href=\"https://www.digitalocean.com/community/tutorials/how-to-use-google-s-smtp-server\" rel=\"nofollow\">https://www.digitalocean.com/community/tutorials/how-to-use-google-s-smtp-server</a> )</p>\n\n<p>Anyway, here's a couple code samples to cover either case;</p>\n\n<pre><code>    c, err := smtp.Dial(\"mail.example.com:25\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer c.Close()\n    // Set the sender and recipient.\n    c.Mail(\"sender@example.org\")\n    c.Rcpt(\"recipient@example.net\")\n    // Send the email body.\n    wc, err := c.Data()\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer wc.Close()\n    buf := bytes.NewBufferString(\"This is the email body.\")\n    if _, err = buf.WriteTo(wc); err != nil {\n        log.Fatal(err)\n    }\n</code></pre>\n\n<p>Alternatively here's a go playground example that uses simple auth; <a href=\"http://play.golang.org/p/ATDCgJGKZ3\" rel=\"nofollow\">http://play.golang.org/p/ATDCgJGKZ3</a> unless you've already got an smtp server running on your dev box following something like that will probably be a lot easier.</p>\n"}], "owner": {"reputation": 213, "user_id": 3612491, "user_type": "registered", "accept_rate": 0, "profile_image": "https://graph.facebook.com/100000907896915/picture?type=large", "display_name": "user3612491", "link": "https://stackoverflow.com/users/3612491/user3612491"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3388, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1436286938, "creation_date": 1436282319, "question_id": 31272725, "link": "https://stackoverflow.com/questions/31272725/how-to-send-an-e-mail-from-go", "title": "How to send an e-mail from Go", "body": "<p>I'm trying to send an e-mail in Golang and I have a lot of problems with it. I'm new in Go so maybe this is very simply but I cannot find the answer on the doc.</p>\n\n<p>This is what I want to do:\n1. get an e-mail from the STDIN\n2. parse the e-mail (getting from, to, subject, attachments and so on)\n3. send this e-mail (put it again to the queue in local postfix)</p>\n\n<p>I did 1 and 2 but I have a problem with 3th one.</p>\n\n<p>This is what I have now:</p>\n\n<pre><code>package main \n\nimport (\n  \"fmt\"\n  \"github.com/jhillyerd/go.enmime\"\n  //\"github.com/sendgrid/sendgrid-go\"\n  \"net/smtp\"\n  \"github.com/jordan-wright/email\"\n  \"os\"\n  \"net/mail\"\n  \"io/ioutil\"\n  \"bytes\"\n  )\n\nfunc main() {\n\n  mail_stdin, err := ioutil.ReadAll(os.Stdin)\n  if err != nil {\n      return\n  }\n\n  // Convert type to io.Reader\n  buf := bytes.NewBuffer(mail_stdin)\n\n  msg, err := mail.ReadMessage(buf)\n  if err != nil {\n    return\n  }\n\n  mime, err := enmime.ParseMIMEBody(msg)\n  if err != nil {\n    return\n  }\n\n  # saving attachments\n  for _, value := range mime.Attachments {\n    fmt.Println(value.FileName())\n\n    err := ioutil.WriteFile(value.FileName(), value.Content(), 0664)\n    if err != nil {\n      //panic(err)\n      return\n    }\n\n  fmt.Printf(\"From: %v\\n\", msg.Header.Get(\"From\"))\n  fmt.Printf(\"Subject: %v\\n\", mime.GetHeader(\"Subject\"))\n  fmt.Printf(\"Text Body: %v chars\\n\", len(mime.Text))\n  fmt.Printf(\"HTML Body: %v chars\\n\", len(mime.Html))\n  fmt.Printf(\"Inlines: %v\\n\", len(mime.Inlines))\n  fmt.Printf(\"Attachments: %v\\n\", len(mime.Attachments))\n  fmt.Println(mime.Attachments)\n  fmt.Println(mime.OtherParts)\n  fmt.Printf(\"Attachments: %v\\n\", mime.Attachments)\n}\n</code></pre>\n\n<p>I already did few tests using: net/smtp, sendgrid-go and jordan-wright/email.\nAll I want to do is to send an e-mail (without changing anything) from the server to the queue again. Most of those modules needs to have Auth, but I just want to simply send is using sendmail, in the same way as I can do this from the bash:</p>\n\n<pre><code># echo \"test\" | mail {address}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 608, "user_id": 2742953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6440a8ea0b00a8259b04bef0d57881?s=128&d=identicon&r=PG", "display_name": "Gerard Abello", "link": "https://stackoverflow.com/users/2742953/gerard-abello"}, "edited": false, "score": 0, "creation_date": 1436282086, "post_id": 31272577, "comment_id": 50539522, "body": "I would not return nil as the error, because in go that means there was no error and that&#39;s not the case."}, {"owner": {"reputation": 613, "user_id": 1206835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5371554b7b078e898cf96c17d13dad23?s=128&d=identicon&r=PG", "display_name": "Michal Karm Babacek", "link": "https://stackoverflow.com/users/1206835/michal-karm-babacek"}, "reply_to_user": {"reputation": 608, "user_id": 2742953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6440a8ea0b00a8259b04bef0d57881?s=128&d=identicon&r=PG", "display_name": "Gerard Abello", "link": "https://stackoverflow.com/users/2742953/gerard-abello"}, "edited": false, "score": 0, "creation_date": 1437137735, "post_id": 31272577, "comment_id": 50917761, "body": "Well, yes, that is a semantic question of error handling -- the issue on hand is about the number of return values though..."}], "tags": [], "owner": {"reputation": 613, "user_id": 1206835, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5371554b7b078e898cf96c17d13dad23?s=128&d=identicon&r=PG", "display_name": "Michal Karm Babacek", "link": "https://stackoverflow.com/users/1206835/michal-karm-babacek"}, "is_accepted": false, "score": -1, "last_activity_date": 1436281932, "creation_date": 1436281932, "answer_id": 31272577, "question_id": 31272189, "link": "https://stackoverflow.com/questions/31272189/how-handle-error-in-http-get-in-function/31272577#31272577", "title": "how handle error in http.Get in function", "body": "<p>From my limited experience, errors are values. Your function returns two values, <code>return</code>, ain't enough. How about <code>return nil, nil</code> if there is no response to return anyway...\nOr you can bring it down with <code>panic(err)</code>. Depends on what you want to do if the request fails.</p>\n"}, {"comments": [{"owner": {"reputation": 225, "user_id": 834875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5d410288881f37e01491c48c1a6709?s=128&d=identicon&r=PG&f=1", "display_name": "desarrolla2", "link": "https://stackoverflow.com/users/834875/desarrolla2"}, "edited": false, "score": 0, "creation_date": 1436282698, "post_id": 31272612, "comment_id": 50539962, "body": "if i do this get <code>main.go:113: cannot use nil as type goreq.Response in return argument </code>"}, {"owner": {"reputation": 608, "user_id": 2742953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6440a8ea0b00a8259b04bef0d57881?s=128&d=identicon&r=PG", "display_name": "Gerard Abello", "link": "https://stackoverflow.com/users/2742953/gerard-abello"}, "reply_to_user": {"reputation": 225, "user_id": 834875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5d410288881f37e01491c48c1a6709?s=128&d=identicon&r=PG&f=1", "display_name": "desarrolla2", "link": "https://stackoverflow.com/users/834875/desarrolla2"}, "edited": false, "score": 0, "creation_date": 1436283420, "post_id": 31272612, "comment_id": 50540535, "body": "In that case what I would do is to return a pointer (*goreq.Response) so you can return nil in the case that the response from the .Do() function is nil, and dereference the pointer where the response is actually needed.  I will update the answer."}], "tags": [], "owner": {"reputation": 608, "user_id": 2742953, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b6440a8ea0b00a8259b04bef0d57881?s=128&d=identicon&r=PG", "display_name": "Gerard Abello", "link": "https://stackoverflow.com/users/2742953/gerard-abello"}, "is_accepted": true, "score": 2, "last_activity_date": 1436289943, "last_edit_date": 1436289943, "creation_date": 1436282032, "answer_id": 31272612, "question_id": 31272189, "link": "https://stackoverflow.com/questions/31272189/how-handle-error-in-http-get-in-function/31272612#31272612", "title": "how handle error in http.Get in function", "body": "<p>I'm not used to http requests in go, but I guess the error comes from '*res' as 'res' is nil when there's an error.</p>\n\n<p>What I'd do is to return a pointer (*goreq.Response), avoiding the dereference: </p>\n\n<pre><code>func execute(query Query) (*goreq.Response, error) {\n    return goreq.Request{\n       // original code goes here\n    }.Do()\n}\n</code></pre>\n\n<p>In that case you will dereference the pointer where the value of the response is needed and can be ignored if the error is not nil.</p>\n\n<p>Hope it helps.</p>\n"}, {"comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436290355, "post_id": 31274287, "comment_id": 50545033, "body": "While this solution works as well, the solution proposed by Gerard Abello has the following advantages: there is less code and the returned goreq.Response object is not copied via stack (fairly fast operation but not exactly free especially for big structs)"}], "tags": [], "owner": {"reputation": 225, "user_id": 834875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5d410288881f37e01491c48c1a6709?s=128&d=identicon&r=PG&f=1", "display_name": "desarrolla2", "link": "https://stackoverflow.com/users/834875/desarrolla2"}, "is_accepted": false, "score": 1, "last_activity_date": 1436286326, "creation_date": 1436286326, "answer_id": 31274287, "question_id": 31272189, "link": "https://stackoverflow.com/questions/31272189/how-handle-error-in-http-get-in-function/31274287#31274287", "title": "how handle error in http.Get in function", "body": "<p>finally i resolve this as follow</p>\n\n<pre><code>if err != nil {\n    var empty goreq.Response\n    return empty, err\n}\n</code></pre>\n"}], "owner": {"reputation": 225, "user_id": 834875, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd5d410288881f37e01491c48c1a6709?s=128&d=identicon&r=PG&f=1", "display_name": "desarrolla2", "link": "https://stackoverflow.com/users/834875/desarrolla2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 0, "accepted_answer_id": 31272612, "answer_count": 3, "score": 2, "last_activity_date": 1436289943, "creation_date": 1436280995, "question_id": 31272189, "link": "https://stackoverflow.com/questions/31272189/how-handle-error-in-http-get-in-function", "title": "how handle error in http.Get in function", "body": "<p>I have a problem whith this function:</p>\n\n<pre><code>func execute(query Query) (goreq.Response, error) {\n\n    res, err := goreq.Request{\n        Uri:         \"http://path/to/host\",\n        QueryString: query,\n        Accept:      \"application/json\",\n        UserAgent:   \"XXXGoClient/1.0\",\n        Timeout:     2000 * time.Millisecond,\n        Compression: goreq.Gzip(),\n        //ShowDebug:   true,\n    }.Do()\n\n    return *res, err\n}\n</code></pre>\n\n<p>i am getting <code>panic: runtime error: invalid memory address or nil pointer dereference</code> when a error in http request ocurrs.</p>\n\n<p>I know that i would check for something like this:</p>\n\n<pre><code>if err != nil {\n    // do somthing here\n}\n</code></pre>\n\n<p>but i dont know what i must to do, for example this:</p>\n\n<pre><code>if err != nil {\n    return\n}\n</code></pre>\n\n<p>i get <code>./main.go:113: not enough arguments to return</code></p>\n"}, {"tags": ["session", "cookies", "go", "session-cookies"], "comments": [{"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 1, "creation_date": 1436277310, "post_id": 31270461, "comment_id": 50535623, "body": "See <a href=\"https://godoc.org/net/http#CookieJar\" rel=\"nofollow noreferrer\"><code>net&#47;http.CookieJar</code></a>."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436279716, "post_id": 31270461, "comment_id": 50537537, "body": "Tangentially related: use <a href=\"https://github.com/gorilla/securecookie\" rel=\"nofollow noreferrer\">github.com/gorilla/securecookie</a> or sessions if you need to use cookies for storing data. Authenticated cookies are important for security."}], "answers": [{"comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 7, "creation_date": 1436295924, "post_id": 31270794, "comment_id": 50548377, "body": "That is a nice explanation."}, {"owner": {"reputation": 364, "user_id": 7414029, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/5HNys.jpg?s=128&g=1", "display_name": "Mihir Kumar Thakur", "link": "https://stackoverflow.com/users/7414029/mihir-kumar-thakur"}, "edited": false, "score": 0, "creation_date": 1596172804, "post_id": 31270794, "comment_id": 111732660, "body": "This is an explanation, I am searching for. Thanks"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 51, "last_activity_date": 1436282744, "last_edit_date": 1436282744, "creation_date": 1436277790, "answer_id": 31270794, "question_id": 31270461, "link": "https://stackoverflow.com/questions/31270461/what-is-the-difference-between-cookie-and-cookiejar/31270794#31270794", "title": "What is the difference between cookie and cookiejar?", "body": "<p>As you described in your question, cookies are managed by browsers (HTTP clients) and they allow to store information on the clients' computers which are sent automatically by the browser on subsequent requests.</p>\n\n<p>If your application acts as a client (you connect to remote HTTP servers using the <a href=\"http://golang.org/pkg/net/http/\"><code>net/http</code></a> package), then there is no browser which would handle / manage the cookies. By this I mean storing/remembering cookies that arrive as <code>Set-Cookie:</code> response headers, and attaching them to subsequent outgoing requests being made to the same host/domain. Also cookies have expiration date which you would also have to check before deciding to include them in outgoing requests.</p>\n\n<p>The <a href=\"http://golang.org/pkg/net/http/#Client\"><code>http.Client</code></a> type however allows you to set a value of type <a href=\"http://golang.org/pkg/net/http/#CookieJar\"><code>http.CookieJar</code></a>, and if you do so, you will have automatic cookie management which otherwise would not exist or you would have to do it yourself. This enables you to do multiple requests with the <code>net/http</code> package that the server will see as part of the same session just as if they were made by a real browser, as often HTTP sessions (the session ids) are maintained using cookies.</p>\n\n<p>The package <a href=\"http://golang.org/pkg/net/http/cookiejar/\"><code>net/http/cookiejar</code></a> is a CookieJar implementation which you can use out of the box. Note that this implementation is in-memory only which means if you restart your application, the cookies will be lost.</p>\n\n<hr>\n\n<p>So basically an <a href=\"https://en.wikipedia.org/wiki/HTTP_cookie\"><strong>HTTP cookie</strong></a> is a small piece of data sent from a website and stored in a user's web browser while the user is browsing that website.</p>\n\n<p><strong>Cookiejar</strong> is a <a href=\"http://golang.org/pkg/net/http/#CookieJar\">Go interface</a> of a simple cookie manager (to manage cookies from HTTP request and response headers) and an <a href=\"http://golang.org/pkg/net/http/cookiejar/\">implementation of that interface</a>. </p>\n"}, {"tags": [], "owner": {"reputation": 932, "user_id": 4543156, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1274fe246bfc572130966c1bd836844c?s=128&d=identicon&r=PG", "display_name": "Michael K&#228;fer", "link": "https://stackoverflow.com/users/4543156/michael-k%c3%a4fer"}, "is_accepted": false, "score": 2, "last_activity_date": 1544131792, "creation_date": 1544131792, "answer_id": 53659945, "question_id": 31270461, "link": "https://stackoverflow.com/questions/31270461/what-is-the-difference-between-cookie-and-cookiejar/53659945#53659945", "title": "What is the difference between cookie and cookiejar?", "body": "<p>In general it is a datastore where an application (browser or not) puts the cookies it uses during requests and responses. So it is really a jar for cookies.</p>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11646, "favorite_count": 10, "accepted_answer_id": 31270794, "answer_count": 2, "score": 24, "last_activity_date": 1544131792, "creation_date": 1436277017, "last_edit_date": 1436282612, "question_id": 31270461, "link": "https://stackoverflow.com/questions/31270461/what-is-the-difference-between-cookie-and-cookiejar", "title": "What is the difference between cookie and cookiejar?", "body": "<p>Today I faced with the term \"cookiejar\" (package <code>net/http/cookiejar</code>). I tried to gather some information regarding it, but got nothing intelligible. I know that <strong>cookie</strong> is key/value pairs that server sends to a client, eg: <code>Set-Cookie: foo=10</code>, browser store it locally and then each subsequent request browser will send these cookies back to the server, eg: <code>Cookie: foo=10</code>.</p>\n\n<p>Ok, but what about <strong>cookiejar</strong>? What is it and how it looks like?</p>\n"}, {"tags": ["go", "websocket", "server-sent-events", "http-streaming"], "comments": [{"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1436273924, "post_id": 31268628, "comment_id": 50532973, "body": "Could you send a data message from the server indicating that the client should close the connection, and then having the client expilicitly call close on the connection?"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 1, "creation_date": 1436273958, "post_id": 31268628, "comment_id": 50532999, "body": "what sse client are you using ? <code>EventSource</code>?"}, {"owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "reply_to_user": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1436310954, "post_id": 31268628, "comment_id": 50555210, "body": "I was using <a href=\"https://github.com/JanBerktold/sse\" rel=\"nofollow noreferrer\">github.com/JanBerktold/sse</a> but my question is a little more general that a specific lib implementation. I think I might try work out a good client server example.."}], "answers": [{"comments": [{"owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "edited": false, "score": 0, "creation_date": 1436311203, "post_id": 31279926, "comment_id": 50555285, "body": "Ok I see, maybe I was just working under the assumption that there was something in the connection protocol I could use. So essentially I would need to create some sort of disconnect message for my client then handle it. I guess that could work ok. My specific client might need to stricter rules  around handling disconnects ie, shutdown the app if it looses connection etc..Thanks for the info!"}, {"owner": {"reputation": 24189, "user_id": 841830, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/thtU5.jpg?s=128&g=1", "display_name": "Darren Cook", "link": "https://stackoverflow.com/users/841830/darren-cook"}, "reply_to_user": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "edited": false, "score": 0, "creation_date": 1436339074, "post_id": 31279926, "comment_id": 50563490, "body": "Just checked my book, and that is covered on p.59 - using the error handler. It is not very useful, and I don&#39;t recommend you use it for your case, but I will update my answer."}], "tags": [], "owner": {"reputation": 24189, "user_id": 841830, "user_type": "registered", "accept_rate": 74, "profile_image": "https://i.stack.imgur.com/thtU5.jpg?s=128&g=1", "display_name": "Darren Cook", "link": "https://stackoverflow.com/users/841830/darren-cook"}, "is_accepted": true, "score": 3, "last_activity_date": 1436339785, "last_edit_date": 1436339785, "creation_date": 1436305733, "answer_id": 31279926, "question_id": 31268628, "link": "https://stackoverflow.com/questions/31268628/server-sent-events-golang/31279926#31279926", "title": "server-sent events Golang", "body": "<p>The SSE standard requires that the browser reconnect, automatically, after N seconds, if the connection is lost or if the server deliberately closes the socket. (N defaults to 5 in Firefox, 3 in Chrome and Safari, last time I checked.) So, if that is desirable, you don't need to do anything.  (In WebSockets you would have to implement this kind of reconnect for yourself.)</p>\n\n<p>If that kind of reconnect is <em>not</em> desirable, you should instead send a message back to the client, saying \"the show is over, go away\". E.g. if you are streaming financial data, you might send that on a Friday evening, when the markets shut. The client should then intercept this message and close the connection from its side. (The socket will then disappear, so the server process will automatically get closed.)</p>\n\n<p>In JavaScript, and assuming you are using JSON to send data, that would look something like:</p>\n\n<pre><code>var es = EventSource(\"/datasource\");\nes.addEventListener(\"message\", function(e){\n  var d = JSON.parse(e.data);\n  if(d.shutdownRequest){\n    es.close();\n    es=null;\n    //Tell user what just happened.\n    }\n  else{\n    //Normal processing here\n    }\n  },false);\n</code></pre>\n\n<p><strong>UPDATE:</strong></p>\n\n<p>You can find out when the reconnects are happening, by listening for the \"close\" event, then looking at the <code>e.target.readyState</code></p>\n\n<pre><code>es.addEventListener(\"error\", handleError, false);\nfunction handleError(e){\n  if(e.target.readyState == 0)console.log(\"Reconnecting...\");\n  if(e.target.readyState == 2)console.log(\"Giving up.\");\n  }\n</code></pre>\n\n<p>No other information is available, but more importantly it cannot tell the difference between your server process deliberately closing the connection, your web server crashing, or your client's internet connection going down.</p>\n\n<p>One other thing you can customize is the retry time, by having the the server send a <code>retry:NN</code> message. So if you don't want quick reconnections, but instead want at least 60 seconds between any reconnect attempts do this have your server send <code>retry:60</code>.</p>\n"}], "owner": {"reputation": 462, "user_id": 1365520, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/aa5f0c4003145813dec46fddbf8c470a?s=128&d=identicon&r=PG", "display_name": "mcbain83", "link": "https://stackoverflow.com/users/1365520/mcbain83"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4314, "favorite_count": 1, "accepted_answer_id": 31279926, "answer_count": 1, "score": 5, "last_activity_date": 1436395026, "creation_date": 1436272317, "last_edit_date": 1436395026, "question_id": 31268628, "link": "https://stackoverflow.com/questions/31268628/server-sent-events-golang", "title": "server-sent events Golang", "body": "<p>I would like to do some one way streaming of data and am experimenting with SSE vs Websockets.</p>\n\n<p>Using SSE form a golang server I'm finding it confusing on how to notify the client when sessions are finished. (eg the server has finished sending the events or the server suddenly goes offline or client looses connectivity)</p>\n\n<p>One thing I need is to reliably know when these disconnect situations. Without using timeouts etc.\nMy experiments so far , when I take the server offline the client gets EOF. But I'm having trouble trying to figure out how to signal from the server to the client that a connection is closed / finished and then how to handle / read it? Is EOF a reliable way to determine a closed / error / finished state?</p>\n\n<p>Many of the examples with SSE fail to show client good client connection handling.</p>\n\n<p>Would this be easier with Websockets?</p>\n\n<p>Any experiences suggestions most appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["types", "go", "integer"], "comments": [{"owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 0, "creation_date": 1436266002, "post_id": 31266352, "comment_id": 50527563, "body": "That is not a positive contribution, Michael. &quot;Many&quot; doesn&#39;t mean &quot;all&quot;."}, {"owner": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 0, "creation_date": 1436266132, "post_id": 31266352, "comment_id": 50527638, "body": "Hence why I removed my initial comment. I misread <i>&quot;many&quot;</i> as <i>&quot;any&quot;</i>."}, {"owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "reply_to_user": {"reputation": 51929, "user_id": 1524450, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BSzDV.png?s=128&g=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/1524450/michael"}, "edited": false, "score": 4, "creation_date": 1436266187, "post_id": 31266352, "comment_id": 50527668, "body": "I find it rather amusing that the question gets downvoted with no credible explanation whatsoever. This is a legitimate question."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 4, "creation_date": 1436266903, "post_id": 31266352, "comment_id": 50528114, "body": "The hardware has different size of addressing and integers, so why not expose the hardware details to the programmer? And bit operations are much simpler on unsigned types, so why not expose the unsigned types present in hardware too? Why waste bytes when 8 bits are sufficient? This is all so dead basic that a downvote is okay. Just because nonsens languages like JavaScript don&#39;t give you much control is absolutely no argument for not having them. If you don&#39;t like or understand the need for an uint64: Just stick with ints."}, {"owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 5, "creation_date": 1436267158, "post_id": 31266352, "comment_id": 50528280, "body": "The use of &quot;nonsense&quot; to refer to languages like JavaScript and Python shows your level of sophistication."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 9, "last_activity_date": 1436277482, "last_edit_date": 1436277482, "creation_date": 1436266369, "answer_id": 31266563, "question_id": 31266352, "link": "https://stackoverflow.com/questions/31266352/why-does-go-have-several-different-integer-types/31266563#31266563", "title": "Why does Go have several different integer types?", "body": "<p>Why does Go have several different types at all? To work with different type/kind of data.</p>\n\n<p>Why does Go have several different integer types? To work with different type/kind of integer data.</p>\n\n<p>There are even more which you haven't listed:</p>\n\n<pre><code>byte    alias for uint8\nrune    alias for int32\n</code></pre>\n\n<p>The distinction between signed and unsigned is pretty obvious. In Java there are no unsigned integers and I find it more confusing than to have extra types and have the convenience to choose. In Java to write applications that inter-operate with other systems which send/receive unsigned integer data is just annoying.</p>\n\n<p>Regarding the bit-size, you have the convenience to choose that best suits your memory needs (or memory strictness) and also to restrict the possible range of the values your variable represents. Without adding complexity to the language or to your program.</p>\n\n<p>The \"palette\" to choose bit-size of integer variables is not exhausting whatsoever, most other languages provide the same range of integer types. If you exclude sign-ness, then Java basically has the same amount:</p>\n\n<pre><code>Java         Go\n-------------------------\nbyte    =&gt;   int8\nshort   =&gt;   int16\nint     =&gt;   int32\nlong    =&gt;   int64\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 1, "creation_date": 1436267802, "post_id": 31266595, "comment_id": 50528714, "body": "So, for instance, Python that lacks these distinctions is less portable than Go?"}, {"owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "reply_to_user": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "edited": false, "score": 0, "creation_date": 1436267859, "post_id": 31266595, "comment_id": 50528763, "body": "It depends how it defines them. Python aims for expressivity, not efficiency. IIRC, Python integers are all <a href=\"https://en.wikipedia.org/wiki/Arbitrary-precision_arithmetic\" rel=\"nofollow noreferrer\">bigints</a>"}], "tags": [], "owner": {"reputation": 208003, "user_id": 841108, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/Fm52y.png?s=128&g=1", "display_name": "Basile Starynkevitch", "link": "https://stackoverflow.com/users/841108/basile-starynkevitch"}, "is_accepted": true, "score": 7, "last_activity_date": 1436278282, "last_edit_date": 1436278282, "creation_date": 1436266452, "answer_id": 31266595, "question_id": 31266352, "link": "https://stackoverflow.com/questions/31266352/why-does-go-have-several-different-integer-types/31266595#31266595", "title": "Why does Go have several different integer types?", "body": "<p>The C99 language has a similar classification thru <a href=\"http://pubs.opengroup.org/onlinepubs/009695399/basedefs/stdint.h.html\" rel=\"nofollow\"><code>&lt;stdint.h&gt;</code></a> (and C is even more fine-grained, with types like <code>int_fast32_t</code>) ; having that many integral types is useful for <a href=\"https://en.wikipedia.org/wiki/Software_portability\" rel=\"nofollow\">portability</a> and efficiency.</p>\n\n<p><sup>Compatibility with C99 &amp; C++ may be enough a reason for Go to have these types.</sup></p>\n\n<p>You may want to write code which can efficiently run on embedded microcontrollers, tablets (32 bits ARM), cheap laptops (32 bits x86), bigger desktops (64 bits x86-64), servers (perhaps also PowerPC or 64 bits <a href=\"https://en.wikipedia.org/wiki/ARM_architecture#AArch64\" rel=\"nofollow\">AARCH64 ARM</a>), etc... And you have various programming models or <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow\">ABI</a>s on some operating systems (e.g. x86, <a href=\"https://en.wikipedia.org/wiki/X32_ABI\" rel=\"nofollow\">x32</a>, amd64 on my Linux desktop).</p>\n\n<p>On various architectures, the cost of integral operations may vary greatly. On some machines, adding an <code>int</code> might be more costly than adding a <em>C</em> <code>long</code> (or an <code>int64</code> from <em>Go</em>). On other machines (probably most of them), it might be the opposite. And <a href=\"https://en.wikipedia.org/wiki/CPU_cache\" rel=\"nofollow\">CPU cache</a> considerations could matter a lot w.r.t. performance. And in some cases (e.g. if you have billion-sized array) data size matters a lot. At last, for binary data coming from outside, size, layout, alignment, and <a href=\"https://en.wikipedia.org/wiki/Endianness\" rel=\"nofollow\">endianness</a> matter a lot. Read about <a href=\"https://en.wikipedia.org/wiki/Serialization\" rel=\"nofollow\">serialization</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 11, "last_activity_date": 1436266515, "creation_date": 1436266515, "answer_id": 31266615, "question_id": 31266352, "link": "https://stackoverflow.com/questions/31266352/why-does-go-have-several-different-integer-types/31266615#31266615", "title": "Why does Go have several different integer types?", "body": "<p>Go has two kinds of types:</p>\n\n<ol>\n<li><strong>architecture dependent types</strong>  such as <code>int</code>, <code>uint</code>, <code>uintptr</code>. and</li>\n<li><strong>architecture independent types</strong> such as <code>int32</code>, <code>int64</code> etc.</li>\n</ol>\n\n<p>The architecture dependent types have the appropriate length for the machine on which the program runs:</p>\n\n<ul>\n<li>an <code>int</code> is the default signed type: it takes 32 bit (4 bytes) on a 32\nbit machine and 64 bit (8 bytes) on a 64 bit machine; the same goes for the unsigned <code>uint</code>.</li>\n<li><code>uintptr</code> is an unsigned integer large enough to store a pointer value.</li>\n</ul>\n\n<p>The architecture independent types have fixed size (in bits) indicated by their names:</p>\n\n<p><strong>For integers the ranges are:</strong> </p>\n\n<pre><code>int8 (-128 -&gt; 127)\nint16 (-32768 -&gt; 32767)\nint32 (\u2212 2,147,483,648 -&gt; 2,147,483,647)\nint64 (\u2212 9,223,372,036,854,775,808 -&gt; 9,223,372,036,854,775,807)\n</code></pre>\n\n<p><strong>For unsigned integers</strong>: </p>\n\n<pre><code>uint8 (with alias byte, 0 -&gt; 255)\nuint16 (0 -&gt; 65,535)\nuint32 (0 -&gt; 4,294,967,295)\nuint64 (0 -&gt; 18,446,744,073,709,551,615)\n</code></pre>\n\n<p><strong>For floats</strong>: </p>\n\n<pre><code>float32 (+- 1O-45 -&gt; +- 3.4 * 1038 )\n(IEEE-754) float64 (+- 5 * 10-324 -&gt; 1.7 * 10308 )\n</code></pre>\n\n<p><code>int</code> is the integer type which offers the fastest processing speeds.\nThe initial (default) value for integers is <code>0</code>, and for floats this is <code>0.0</code>\nA float32 is reliably accurate to about 7 decimal places, a float64 to about 15 decimal places. </p>\n\n<p>Due to the fact that perfect accuracy is not possible for floats comparing them with <code>==</code> or <code>!=</code> must be done very carefully!</p>\n"}, {"tags": [], "owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "is_accepted": false, "score": 5, "last_activity_date": 1436351947, "creation_date": 1436351947, "answer_id": 31290231, "question_id": 31266352, "link": "https://stackoverflow.com/questions/31266352/why-does-go-have-several-different-integer-types/31290231#31290231", "title": "Why does Go have several different integer types?", "body": "<p>The existing answers are correct.  Let me offer a different perspective.</p>\n\n<p>Asking this question implies that you are used to languages that are higher level than Go.  Languages like Python can be seen as providing a single integer type with unlimited precision.  This isn't true internally, but in practice you can write your code assuming that it is true.</p>\n\n<p>Go is not that kind of language.  The language proper does not offer an integer type with unlimited precision (there is one available in the <a href=\"http://golang.org/pkg/math/big/\" rel=\"noreferrer\">math/big package</a>).  Instead, each integer type has a specific size, and operations that yield integers that do not fit in that size wrap.  So, in Go, <code>uint32(0xffffffff) + uint32(1) == uint32(0)</code>.</p>\n\n<p>Go works this way because the resulting code is, in general, more efficient.  It also permits Go programmers to write struct types that can be stored in memory more efficiently.  However, it does mean that a programmer working with large numbers has to be aware of the possibility of overflow.</p>\n"}], "owner": {"reputation": 1801, "user_id": 4321788, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/BC8VC.jpg?s=128&g=1", "display_name": "Morteza R", "link": "https://stackoverflow.com/users/4321788/morteza-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2072, "favorite_count": 3, "accepted_answer_id": 31266595, "answer_count": 4, "score": 7, "last_activity_date": 1436351947, "creation_date": 1436265728, "question_id": 31266352, "link": "https://stackoverflow.com/questions/31266352/why-does-go-have-several-different-integer-types", "title": "Why does Go have several different integer types?", "body": "<p>I find it rather confusing that there are different integer types in Go. What is the necessity of defining these different categories, given that these distinctions are not present in many other major programming languages?</p>\n\n<pre><code>int  int8  int16  int32  int64\nuint uint8 uint16 uint32 uint64 uintptr\n</code></pre>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1436262657, "post_id": 31265072, "comment_id": 50525281, "body": "I found the revel.BasePath variable but it seems like its empty."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1436262778, "last_edit_date": 1495540699, "creation_date": 1436262778, "answer_id": 31265304, "question_id": 31265072, "link": "https://stackoverflow.com/questions/31265072/relative-paths-in-revel-framework/31265304#31265304", "title": "Relative paths in revel framework", "body": "<p>There are exported global variables in the <a href=\"http://revel.github.io/docs/godoc/revel.html\" rel=\"nofollow noreferrer\"><code>revel</code></a> package, you can use any of these:</p>\n\n<pre><code>var (\n    // App details\n    AppName    string // e.g. \"sample\"\n    BasePath   string // e.g. \"/Users/revel/gocode/src/corp/sample\"\n    AppPath    string // e.g. \"/Users/revel/gocode/src/corp/sample/app\"\n    ViewsPath  string // e.g. \"/Users/revel/gocode/src/corp/sample/app/views\"\n    ImportPath string // e.g. \"corp/sample\"\n    SourcePath string // e.g. \"/Users/revel/gocode/src\"\n\n    // Revel installation details\n    RevelPath string // e.g. \"/Users/revel/gocode/src/revel\"\n\n    // Where to look for templates and configuration.\n    // Ordered by priority.  (Earlier paths take precedence over later paths.)\n    CodePaths     []string\n    ConfPaths     []string\n    TemplatePaths []string\n)\n</code></pre>\n\n<p>If it is empty for you, that is most likely because you started your app from the base folder.</p>\n\n<p>Note that these paths are set by the <a href=\"http://revel.github.io/docs/godoc/revel.html#Init\" rel=\"nofollow noreferrer\"><code>Init(mode, importPath, srcPath string)</code></a> function. It's documentation states:</p>\n\n<blockquote>\n<pre><code>srcPath - the path to the source directory, containing Revel and the app.\n  If not specified (\"\"), then a functioning Go installation is required.\n</code></pre>\n</blockquote>\n\n<p>Also check out: <a href=\"https://stackoverflow.com/questions/31059023/how-to-reference-a-relative-file-from-code-and-tests\">how to reference a relative file from code and tests</a></p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 3686026, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/myy5v.jpg?s=128&g=1", "display_name": "ggerman", "link": "https://stackoverflow.com/users/3686026/ggerman"}, "is_accepted": false, "score": 1, "last_activity_date": 1436809540, "creation_date": 1436809540, "answer_id": 31390031, "question_id": 31265072, "link": "https://stackoverflow.com/questions/31265072/relative-paths-in-revel-framework/31390031#31390031", "title": "Relative paths in revel framework", "body": "<p>I use this method:\nIn conf/app.conf add a line with the configuration path of this way:</p>\n\n<p>projectname.path = \"/foldersnames/\"</p>\n\n<p>and in the controller Write a method like this:</p>\n\n<pre><code>func info(field string) string {                                                                                                                                                                               \n  config, err := revel.LoadConfig(\"app.conf\")                                                                                                                                                                  \n  if err != nil || config == nil {                                                                                                                                                                             \n    log.Fatalln(\"Failed to load configuration file\", err)                                                                                                                                                      \n   }                                                                                                                                                                                                            \n  return config.StringDefault(field, \"empty\")                                                                                                                                                                  \n} \n</code></pre>\n\n<p>You can build a helper with this code and take configurations variables from all applications.</p>\n\n<p>You must call of this way:</p>\n\n<pre><code>info(\"projectname.path\")\n</code></pre>\n"}], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 853, "favorite_count": 0, "accepted_answer_id": 31265304, "answer_count": 2, "score": 1, "last_activity_date": 1436809540, "creation_date": 1436262125, "question_id": 31265072, "link": "https://stackoverflow.com/questions/31265072/relative-paths-in-revel-framework", "title": "Relative paths in revel framework", "body": "<p>How can import a file realtive to the revel basefolder in revel framework. Currently I do the following to get hold of some config values.</p>\n\n<pre><code>file, err := ioutil.ReadFile(\"conf/config.conf\")\n...\n</code></pre>\n\n<p>This results in my server only working if i stand in the app directory when starting revel with </p>\n\n<pre><code>revel run myapp\n</code></pre>\n\n<p>Is there a way to access the base folder?</p>\n"}, {"tags": ["go", "revel"], "answers": [{"comments": [{"owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "edited": false, "score": 0, "creation_date": 1436261900, "post_id": 31264789, "comment_id": 50524791, "body": "I actually found this on my own but still thanks! :D I have another question for you aswell."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 5, "last_activity_date": 1436261359, "creation_date": 1436261359, "answer_id": 31264789, "question_id": 31264754, "link": "https://stackoverflow.com/questions/31264754/programatically-determine-if-in-production-in-revel-framework/31264789#31264789", "title": "Programatically determine if in production in revel framework", "body": "<p>There are exported global variables in the <a href=\"http://revel.github.io/docs/godoc/revel.html\" rel=\"noreferrer\"><code>revel</code></a> package:</p>\n\n<pre><code>var (\n    RunMode string // Application-defined (by default, \"dev\" or \"prod\")\n    DevMode bool   // if true, RunMode is a development mode.\n)\n</code></pre>\n\n<p>So for example:</p>\n\n<pre><code>if revel.DevMode {\n    // Running in development mode\n} else {\n    // Production mode\n}\n</code></pre>\n"}], "owner": {"reputation": 7938, "user_id": 1511332, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/E2WEq.jpg?s=128&g=1", "display_name": "Pablo Jomer", "link": "https://stackoverflow.com/users/1511332/pablo-jomer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 31264789, "answer_count": 1, "score": 1, "last_activity_date": 1436262204, "creation_date": 1436261271, "last_edit_date": 1436262204, "question_id": 31264754, "link": "https://stackoverflow.com/questions/31264754/programatically-determine-if-in-production-in-revel-framework", "title": "Programatically determine if in production in revel framework", "body": "<p>How can I programatically detect if I'm in production mode or development mode in revel framework?</p>\n"}, {"tags": ["go", "packages"], "comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 1, "creation_date": 1436261840, "post_id": 31264507, "comment_id": 50524749, "body": "You might be able to get better answers if you add information why you need this functionality. Have you checked <a href=\"http://godoc.org/golang.org/x/tools/cmd/godoc\" rel=\"nofollow noreferrer\">godoc.org/golang.org/x/tools/cmd/godoc</a>?"}, {"owner": {"reputation": 249, "user_id": 4460434, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e284baeb830754a30047a316e20e3224?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/4460434/manoj-kumar"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436263137, "post_id": 31264507, "comment_id": 50525622, "body": "I need to get the documentation only for a function. But the thing is i know only the function name but not the package to which it belongs."}, {"owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "edited": false, "score": 0, "creation_date": 1436266275, "post_id": 31264507, "comment_id": 50527731, "body": "Give a try to <code>godoc -q Println | sed -n -e &#39;&#47;Functions&#47;,$p&#39; | head -n 2</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1051, "user_id": 809410, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a1ffc49c668c0066df3196ecf48aa39f?s=128&d=identicon&r=PG", "display_name": "iant", "link": "https://stackoverflow.com/users/809410/iant"}, "edited": false, "score": 1, "creation_date": 1436352049, "post_id": 31271519, "comment_id": 50571737, "body": "Note that the doc tool will be part of the upcoming Go 1.5 release, so with a standard release you will be able to write &quot;go doc Println&quot;."}], "tags": [], "owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "is_accepted": false, "score": 1, "last_activity_date": 1436279442, "creation_date": 1436279442, "answer_id": 31271519, "question_id": 31264507, "link": "https://stackoverflow.com/questions/31264507/get-package-name-for-a-function-in-go-language/31271519#31271519", "title": "Get package name for a function in go language", "body": "<p>From your comment it seems that you're looking for a command line tool like <code>godoc</code> but which instead of requiring something like <code>godoc net/http StatusText</code> you want to be able to just use <code>doc StatusText</code> and have it find <code>http.StatusText</code> for you (and possibly other <code>foo.StatusText</code> functions as well).</p>\n\n<p>Rob Pike's <a href=\"https://godoc.org/robpike.io/cmd/doc\" rel=\"nofollow\"><code>doc</code></a> tool can do exactly that, it looks through all packages in your <code>GOPATH</code>. (Although it's output isn't just the package name as your original question asks for).</p>\n\n<p>You can get and install <code>doc</code> with: <code>go install robpike.io/cmd/doc</code></p>\n\n<p>Or are you actually looking for a way of getting this information from within Go code rather than the command line?</p>\n"}], "owner": {"reputation": 249, "user_id": 4460434, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/e284baeb830754a30047a316e20e3224?s=128&d=identicon&r=PG&f=1", "display_name": "Manoj Kumar", "link": "https://stackoverflow.com/users/4460434/manoj-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 487, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1436279442, "creation_date": 1436260658, "last_edit_date": 1436276277, "question_id": 31264507, "link": "https://stackoverflow.com/questions/31264507/get-package-name-for-a-function-in-go-language", "title": "Get package name for a function in go language", "body": "<p>I need to get the package name for a function in Go.\nFor example if <code>Println</code> is the input then the output must be <code>fmt</code>. If <code>StatusText</code> is the input then the output must be <code>net/http</code>.</p>\n\n<p>What is the right method to achieve this?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1436260474, "post_id": 31264348, "comment_id": 50523901, "body": "You should include your code here in the answer too."}, {"owner": {"reputation": 73, "user_id": 4007499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9daa97346b817786b4ea6e5d108a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4007499/michael"}, "edited": false, "score": 0, "creation_date": 1436263110, "post_id": 31264348, "comment_id": 50525601, "body": "Hi Kostya, I have some doubt"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 73, "user_id": 4007499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9daa97346b817786b4ea6e5d108a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4007499/michael"}, "edited": false, "score": 0, "creation_date": 1436263636, "post_id": 31264348, "comment_id": 50525957, "body": "@Michael, what this doubt is about? Can you explain?"}, {"owner": {"reputation": 73, "user_id": 4007499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9daa97346b817786b4ea6e5d108a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4007499/michael"}, "edited": false, "score": 0, "creation_date": 1436266336, "post_id": 31264348, "comment_id": 50527764, "body": "i have some empty values in the array. how to skip the empty value                      farr := [...]string{         &quot;table&quot;,         &quot;chair&quot;,         &quot;table&quot;,         &quot;table&quot;,         &quot;chair&quot;,         &quot;bench&quot;,         &quot;table,chair&quot;,         &quot;bench,chair&quot;,         &quot;chair,table,bench&quot;,         &quot;&quot;,                                                                                                                                           }"}, {"owner": {"reputation": 73, "user_id": 4007499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9daa97346b817786b4ea6e5d108a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4007499/michael"}, "edited": false, "score": 0, "creation_date": 1436268318, "post_id": 31264348, "comment_id": 50529053, "body": "I dont want to print the empty value in the list"}, {"owner": {"reputation": 16814, "user_id": 3849456, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AonOf.jpg?s=128&g=1", "display_name": "Anzel", "link": "https://stackoverflow.com/users/3849456/anzel"}, "reply_to_user": {"reputation": 73, "user_id": 4007499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9daa97346b817786b4ea6e5d108a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4007499/michael"}, "edited": false, "score": 1, "creation_date": 1436271337, "post_id": 31264348, "comment_id": 50531060, "body": "@Michael, cant you simply just print/add to map <code>if w != &quot;&quot;</code>?"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 4, "last_activity_date": 1436260593, "last_edit_date": 1436260593, "creation_date": 1436260201, "answer_id": 31264348, "question_id": 31264096, "link": "https://stackoverflow.com/questions/31264096/how-to-return-the-unique-elements-of-large-data-structures-in-go/31264348#31264348", "title": "How to return the unique elements of large data structures in go?", "body": "<p>Idea: use <code>map[string]bool</code> to collect unique elements, use <code>strings.Split</code> to split comma-separated list of words into strings.</p>\n\n<p>Example: <a href=\"http://play.golang.org/p/sBopFGrzbX\" rel=\"nofollow\">http://play.golang.org/p/sBopFGrzbX</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n)\n\nfunc main() {\n    arr := [...]string{\n        \"table\",\n        \"chair\",\n        \"table\",\n        \"table\",\n        \"chair\",\n        \"bench\",\n        \"table,chair\",\n        \"bench,chair\",\n        \"chair,table,bench\",\n        \"car\",\n    }\n\n    m := make(map[string]bool)\n    for _, e := range arr {\n        for _, w := range strings.Split(e, \",\") {\n            m[w] = true\n        }\n    }\n\n    for k, _ := range m {\n        fmt.Println(k)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 4007499, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8a9daa97346b817786b4ea6e5d108a6e?s=128&d=identicon&r=PG&f=1", "display_name": "Michael", "link": "https://stackoverflow.com/users/4007499/michael"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 50, "favorite_count": 0, "accepted_answer_id": 31264348, "answer_count": 1, "score": -1, "last_activity_date": 1436260593, "creation_date": 1436259539, "last_edit_date": 1436260590, "question_id": 31264096, "link": "https://stackoverflow.com/questions/31264096/how-to-return-the-unique-elements-of-large-data-structures-in-go", "title": "How to return the unique elements of large data structures in go?", "body": "<p>I am new to Go language and troubling in the code to find the unique elements in the go.</p>\n\n<pre><code>   var arr [10]string\n      arr[0]=\"table\"\n      arr[1]=\"chair\"\n      arr[2]=\"table\"\n      arr[3]=\"table\"\n      arr[4]=\"chair\"\n      arr[5]=\"bench\"\n      arr[6]=\"table,chair\"\n      arr[7]=\"bench,chair\"\n      arr[8]=\"chair,table,bench\"\n      arr[9]=\"car\"\n</code></pre>\n\n<p>The output should be like:</p>\n\n<pre><code>table \nchair\nbench\ncar\n</code></pre>\n\n<p>I am really stuck on this. how to get the unique elements from the above array.\nThe array contains comma seperated values also but i need to print only the unique elements.</p>\n\n<p>Pls someone help me on this.</p>\n\n<p>Thanks for advance.</p>\n"}, {"tags": ["angularjs", "go"], "comments": [{"owner": {"reputation": 628, "user_id": 4990401, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LRgtNy7i3OU/AAAAAAAAAAI/AAAAAAAAAOg/_KFYN5SmLWo/photo.jpg?sz=128", "display_name": "Pawe\u0142 Smo\u0142ka", "link": "https://stackoverflow.com/users/4990401/pawe%c5%82-smo%c5%82ka"}, "edited": false, "score": 0, "creation_date": 1436260231, "post_id": 31263727, "comment_id": 50523747, "body": "Show content of getUserbyId function"}, {"owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "reply_to_user": {"reputation": 628, "user_id": 4990401, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-LRgtNy7i3OU/AAAAAAAAAAI/AAAAAAAAAOg/_KFYN5SmLWo/photo.jpg?sz=128", "display_name": "Pawe\u0142 Smo\u0142ka", "link": "https://stackoverflow.com/users/4990401/pawe%c5%82-smo%c5%82ka"}, "edited": false, "score": 0, "creation_date": 1436270684, "post_id": 31263727, "comment_id": 50530594, "body": "the content is just fmt.Fprint(w, &quot;Welcome!\\n&quot;)"}], "answers": [{"tags": [], "owner": {"reputation": 232, "user_id": 4999035, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/9d76a1cd7adf79d16508210a751d04ee?s=128&d=identicon&r=PG&f=1", "display_name": "Priyanka", "link": "https://stackoverflow.com/users/4999035/priyanka"}, "is_accepted": false, "score": 1, "last_activity_date": 1436294392, "last_edit_date": 1436294392, "creation_date": 1436265281, "answer_id": 31266172, "question_id": 31263727, "link": "https://stackoverflow.com/questions/31263727/how-do-you-set-up-the-go-server-to-be-compatible-with-angularjs-html5mode/31266172#31266172", "title": "How do you set up the go server to be compatible with AngularJS html5mode?", "body": "<p>If route is not found, add</p>\n\n<pre><code>router.GET(\"/\", Yourfunction)\n</code></pre>\n\n<p>and your function as,</p>\n\n<pre><code>func Yourfunction(res http.ResponseWriter, req *http.Request) {\n    file, _ := ioutil.ReadFile(\"/srv/www/public_html\")\n    t := template.New(\"\")\n    t, _ = t.Parse(string(file))\n\n    t.Execute(res, nil)\n}\n</code></pre>\n"}], "owner": {"reputation": 4421, "user_id": 3759007, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/7e4b340203ea76ae1e9e1110fce0b343?s=128&d=identicon&r=PG&f=1", "display_name": "Alex", "link": "https://stackoverflow.com/users/3759007/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436294392, "creation_date": 1436258439, "question_id": 31263727, "link": "https://stackoverflow.com/questions/31263727/how-do-you-set-up-the-go-server-to-be-compatible-with-angularjs-html5mode", "title": "How do you set up the go server to be compatible with AngularJS html5mode?", "body": "<p>I am using the julienschmidt/httprouter alongside with http.FileServer.</p>\n\n<p>Something like this:</p>\n\n<pre><code>func main() {\n    router := httprouter.New()\n    router.NotFound = http.FileServer(http.Dir(\"/srv/www/public_html\"))\n    router.GET(\"/api/user/:id\", getUserbyId)\n    log.Fatal(http.ListenAndServe(\":80\", router))\n}\n</code></pre>\n\n<p>So if a route is not found just serve them from root dir \"/\"</p>\n\n<p>But this does not work as intended. In nginx I do it like this</p>\n\n<pre><code>location / {\n        autoindex on;\n        try_files $uri $uri/ /index.html =404;\n}\n</code></pre>\n\n<p>Check if there are any files in the given url, if not then give them /index.html</p>\n\n<p>How can I make the server compatible with AngularJS html5mode?</p>\n"}, {"tags": ["go", "websocket", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 8, "last_activity_date": 1436274437, "last_edit_date": 1436274437, "creation_date": 1436268412, "answer_id": 31267308, "question_id": 31263519, "link": "https://stackoverflow.com/questions/31263519/gorilla-websocket-compared-with-golang-org-x-net-websocket/31267308#31267308", "title": "Gorilla WebSocket compared with golang.org/x/net/websocket", "body": "<blockquote>\n  <p>According Gorilla Websockets Project it is not possible to send pings and pongs using golang.org/x/net/websocket</p>\n</blockquote>\n\n<p>The <a href=\"https://github.com/gorilla/websocket/tree/a3ec486e6a7a41858210b0fc5d7b5df593b3c4a3#gorilla-websocket-compared-with-other-packages\" rel=\"noreferrer\">Gorilla README says</a> something different. It says that the golang.org/x/net package cannot <em>send a ping</em> or <em>receive a pong</em>. It does not say that the package will not send a pong.</p>\n\n<p>The golang.org/x/net package automatically responds to a ping received from the peer by sending a pong to the peer, as does the Gorilla package. Both packages work correctly with a peer that's using ping and pongs to keep the connection alive.</p>\n\n<p>An application that uses the golang.org/x/net/websocket package cannot employ pings and pongs to keep the connection alive. There's no way to send the ping. There's no way to detect that the pong was received.</p>\n"}], "owner": {"reputation": 7731, "user_id": 1614378, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/lOzxR.png?s=128&g=1", "display_name": "dieter", "link": "https://stackoverflow.com/users/1614378/dieter"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3540, "favorite_count": 1, "accepted_answer_id": 31267308, "answer_count": 1, "score": 4, "last_activity_date": 1436274437, "creation_date": 1436257825, "last_edit_date": 1436261546, "question_id": 31263519, "link": "https://stackoverflow.com/questions/31263519/gorilla-websocket-compared-with-golang-org-x-net-websocket", "title": "Gorilla WebSocket compared with golang.org/x/net/websocket", "body": "<p>According <a href=\"https://github.com/gorilla/websocket#gorilla-websocket-compared-with-other-packages\" rel=\"nofollow\">Gorilla Websockets Project</a> it is not possible to send pings and pongs using <strong>golang.org/x/net/websocket</strong>. At the same time, the following is on the project page of <a href=\"http://godoc.org/golang.org/x/net/websocket\" rel=\"nofollow\">golang.org/x/net/websocket</a>:</p>\n\n<blockquote>\n  <p>Package websocket implements a client and server for the WebSocket protocol as specified in RFC 6455.</p>\n</blockquote>\n\n<p>I am a little confused. <strong>golang.org/x/net/websocket</strong> implements RFC 6455 but can not send control frames (cancel, ping, pong) although this is specified in <a href=\"http://tools.ietf.org/html/rfc6455#section-5.5\" rel=\"nofollow\">RFC 6455 - Section Control Frames</a></p>\n\n<p>So what will happen if I use <strong>golang.org/x/net/websocket</strong> package. Will the connection abort after a timeout? In other words, how is it ensured here that the connection does not break off.</p>\n"}, {"tags": ["html", "struct", "go"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436251359, "post_id": 31260231, "comment_id": 50518481, "body": "Look at using <a href=\"https://github.com/goji/param\" rel=\"nofollow noreferrer\">github.com/goji/param</a> or <a href=\"http://www.gorillatoolkit.org/pkg/schema\" rel=\"nofollow noreferrer\">gorillatoolkit.org/pkg/schema</a> to marshal <code>r.PostForm</code> data into a struct. <a href=\"https://github.com/justinas/nosurf\" rel=\"nofollow noreferrer\">github.com/justinas/nosurf</a> may also be useful for CSRF protection."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1436249074, "last_edit_date": 1436249074, "creation_date": 1436247086, "answer_id": 31260440, "question_id": 31260231, "link": "https://stackoverflow.com/questions/31260231/how-to-move-html-data-to-struct-in-golang/31260440#31260440", "title": "How to move html data to struct in Golang", "body": "<p>The first problem is that you registered your handler for the pattern <code>\"/public/new_user/\"</code> but you direct your form post to <code>/public/new_user</code>.</p>\n\n<p>You have to change your HTML <code>&lt;form&gt;</code> to use this URL:</p>\n\n<pre><code>&lt;form action=\"/public/new_user/\" method=\"post\" id=\"form1\"&gt;\n</code></pre>\n\n<p>The importance of this is that even though visiting the URL <code>/public/new_user</code> works because an automatic redirect (<code>301 Moved permanently</code> response) happens, but the submitted form will not be \"carried\" over when your browser makes the 2nd request to the new URL (ending with a slash).</p>\n\n<p>After doing this you will still receiving a blank page because your <code>signup()</code> function does not write any response (although you will now see the submitted and printed form data on your console).</p>\n\n<p>If you want to see a response, either write something or redirect to another page.</p>\n\n<p>Also note that <a href=\"https://golang.org/pkg/fmt/#Println\" rel=\"nofollow\"><code>fmt.Println()</code></a> does not have a format string parameter, it just prints everything you pass to it. Use <a href=\"https://golang.org/pkg/fmt/#Printf\" rel=\"nofollow\"><code>fmt.Printf()</code></a> if you want to use a format string. Also you can use the <code>%+v</code> format string to print a complete struct with field names.</p>\n\n<p>For example:</p>\n\n<pre><code>func signup(w http.ResponseWriter, r *http.Request) {\n    var S Signup\n    S.name = r.FormValue(\"name\")\n    S.email = r.FormValue(\"email\")\n\n    fmt.Printf(\"%+v\\n\", S)\n\n    fmt.Fprintf(w, \"Form received, you used name: %s\", S.name)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 164, "user_id": 1957835, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/65d3b38093aa7662cbe0cce12e0d62c4?s=128&d=identicon&r=PG", "display_name": "ahmetlutfu", "link": "https://stackoverflow.com/users/1957835/ahmetlutfu"}, "is_accepted": false, "score": 0, "last_activity_date": 1436248976, "creation_date": 1436248976, "answer_id": 31260917, "question_id": 31260231, "link": "https://stackoverflow.com/questions/31260231/how-to-move-html-data-to-struct-in-golang/31260917#31260917", "title": "How to move html data to struct in Golang", "body": "<p>i think you are skipping form validation. You must check client input and you should put token parameter for prevent Xsrf attack.</p>\n\n<p>You can use this package for validate user's inputs.</p>\n\n<p><a href=\"https://github.com/albrow/forms\" rel=\"nofollow\">Form validator</a></p>\n"}], "owner": {"reputation": 69, "user_id": 4417105, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5edabcdce5bff009b2807c66de04517?s=128&d=identicon&r=PG&f=1", "display_name": "ztredded", "link": "https://stackoverflow.com/users/4417105/ztredded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1098, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1436249074, "creation_date": 1436246105, "last_edit_date": 1436248825, "question_id": 31260231, "link": "https://stackoverflow.com/questions/31260231/how-to-move-html-data-to-struct-in-golang", "title": "How to move html data to struct in Golang", "body": "<p>I'm new to Golang and I am trying to move data from an action field to a struct.</p>\n\n<p>My func main is:</p>\n\n<pre><code>func main () {\n    http.HandleFunc(\"/public/\", func (w http.ResponseWriter, r *http.Request) {\n        http.ServeFile(w, r, r.URL.Path[1:]) })\n    http.HandleFunc(\"/public/new_user/\", signup) \n    http.ListenAndServe(\":8080\", nil)\n}\n\n\n// struct for recieving Signup data input from signup.html\ntype Signup struct {\n    name  string\n    email string\n}\n\n// func to receive data into struc above FROM signup.html\nfunc signup(w http.ResponseWriter, r *http.Request) {\n    var S Signup \n\n    S.name = r.FormValue(\"name\")\n    S.email = r.FormValue(\"email\")\n\n    //this is just to test the output\n    fmt.Println(\"%v\\n\", S.name)\n    fmt.Println(\"%v\\n\", S.email)\n}\n</code></pre>\n\n<p>I have <code>http.HandleFunc(\"public/new_user/\", signup)</code> which should render the <code>signup</code> function.  However, I am receiving a BLANK html page when I route to <code>public/new_user</code> instead of receiving the struct from func signup.</p>\n\n<p>The <code>S.name = r.FormValue(\"name\")</code> and <code>S.email = r.FormValue(\"email\")</code> lines ABOVE are getting their info from the signup page which is:</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n&lt;meta charset=\"UTF-8\"&gt;\n&lt;title&gt;Sign Up&lt;/title&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n\n&lt;h1&gt;Sign Up&lt;/h1&gt;\n&lt;br/&gt;\n\n&lt;form action=\"/public/new_user\" method=\"post\" id=\"form1\"&gt;\n\n&lt;label&gt;Name:&lt;/label&gt;\n&lt;input type=\"string\" name=\"name\" /&gt;\n&lt;/br&gt;\n&lt;/br&gt;\n&lt;label&gt;Email:&lt;/label&gt;\n&lt;input type=\"string\" name=\"email\" /&gt;\n&lt;/form&gt;\n\n&lt;/br&gt;\n\n&lt;button type=\"submit\" form=\"form1\" value=\"Submit\"&gt;Submit&lt;/button&gt;\n\n&lt;/body&gt;\n\n&lt;!-- Latest compiled and minified CSS --&gt;\n&lt;link rel=\"stylesheet\" href=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/css/bootstrap.min.css\"&gt;\n\n&lt;!-- jQuery library --&gt;\n&lt;script src=\"https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js\"&gt;&lt;/script&gt;\n\n&lt;!-- Latest compiled JavaScript --&gt;\n&lt;script src=\"http://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js\"&gt;&lt;/script&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>As you can see, this page routes to <code>public/new_user</code> upon submit.  Can anyone please tell me why <code>public/new_user</code> is blank seeing as how I have <code>public/new_user</code> in:</p>\n\n<pre><code>http.HandleFunc(\"/public/new_user/\", signup) \n</code></pre>\n\n<p>Which should render the signup function? Thanks</p>\n"}, {"tags": ["go", "io"], "answers": [{"comments": [{"owner": {"reputation": 1066, "user_id": 1307718, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e77eecdb3703ef9bace953101779216?s=128&d=identicon&r=PG", "display_name": "Methuz Kaewsai-kao", "link": "https://stackoverflow.com/users/1307718/methuz-kaewsai-kao"}, "edited": false, "score": 1, "creation_date": 1436254328, "post_id": 31259899, "comment_id": 50520212, "body": "io.Pipe() does not return io.Writer and io.Reader but it returns *PipeReader, *PipeWriter instead. Are they the same?"}, {"owner": {"reputation": 28098, "user_id": 86072, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/dd41ab60469c4ee32c957c97fc101b9d?s=128&d=identicon&r=PG", "display_name": "LeGEC", "link": "https://stackoverflow.com/users/86072/legec"}, "reply_to_user": {"reputation": 1066, "user_id": 1307718, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e77eecdb3703ef9bace953101779216?s=128&d=identicon&r=PG", "display_name": "Methuz Kaewsai-kao", "link": "https://stackoverflow.com/users/1307718/methuz-kaewsai-kao"}, "edited": false, "score": 4, "creation_date": 1436255017, "post_id": 31259899, "comment_id": 50520586, "body": "@MethuzKaewsai-kao: <a href=\"https://golang.org/pkg/io/#Reader\" rel=\"nofollow noreferrer\"><code>io.Reader</code></a> is an interface, <code>*PipeReader</code> is a concrete type which implements the <code>io.Reader</code> interface. (Same goes for the writers.) So yes, you can use a <code>*PipeReader</code> in any place which accepts an <code>io.Reader</code>."}], "tags": [], "owner": {"reputation": 185743, "user_id": 152948, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/194ef8f807c34a9d7aab0e11a8674768?s=128&d=identicon&r=PG", "display_name": "hobbs", "link": "https://stackoverflow.com/users/152948/hobbs"}, "is_accepted": true, "score": 19, "last_activity_date": 1436247368, "last_edit_date": 1436247368, "creation_date": 1436244298, "answer_id": 31259899, "question_id": 31259812, "link": "https://stackoverflow.com/questions/31259812/how-do-i-connect-io-reader-and-io-writer/31259899#31259899", "title": "How do I connect io.Reader and io.Writer?", "body": "<p>You want to use <a href=\"http://golang.org/pkg/io/#Pipe\" rel=\"noreferrer\">io.Pipe</a>. You can do:</p>\n\n<pre><code>reader, writer := io.Pipe()\nerrChan := make(chan error)\ngo func() {\n    errChan &lt;- myFTP.Stor(path, reader)\n}()\nerr := myXLS.Write(writer)\n// handle err\nerr = &lt;-errChan\n// handle err\n</code></pre>\n\n<p>You might want to <code>writer.CloseWithError(err)</code> if <code>xlsx.Write</code> returns an error without closing the writer.</p>\n"}, {"tags": [], "owner": {"reputation": 91, "user_id": 3943776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mklj6.jpg?s=128&g=1", "display_name": "Arthur Wang", "link": "https://stackoverflow.com/users/3943776/arthur-wang"}, "is_accepted": false, "score": 1, "last_activity_date": 1529286350, "last_edit_date": 1529286350, "creation_date": 1527333297, "answer_id": 50542167, "question_id": 31259812, "link": "https://stackoverflow.com/questions/31259812/how-do-i-connect-io-reader-and-io-writer/50542167#50542167", "title": "How do I connect io.Reader and io.Writer?", "body": "<p>you can use <code>bytes.Buffer</code>:</p>\n\n<pre><code>func uploadFileToQiniu(file *xlsx.File) (key string, err error) {\n    key = fmt.Sprintf(\"%s.xlsx\", util.SerialNumber())\n    log.Debugf(\"file key is %s\", key)\n\n    log.Debug(\"start to write file to a writer\")\n    buf := new(bytes.Buffer)\n    err = file.Write(buf)\n    if err != nil {\n        log.Errorf(\"error caught when writing file: %v\", err)\n        return\n    }\n\n    size := int64(buf.Len())\n    log.Debugf(\"file size is %d\", size)\n    err = Put(key, size, buf)\n    if err != nil {\n        log.Errorf(\"error caught when uploading file: %v\", err)\n    }\n    return key, nil\n}\n</code></pre>\n\n\n\n<pre><code>func Put(key string, size int64, reader io.Reader) error {}\n</code></pre>\n"}], "owner": {"reputation": 1066, "user_id": 1307718, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/9e77eecdb3703ef9bace953101779216?s=128&d=identicon&r=PG", "display_name": "Methuz Kaewsai-kao", "link": "https://stackoverflow.com/users/1307718/methuz-kaewsai-kao"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 11475, "favorite_count": 3, "accepted_answer_id": 31259899, "answer_count": 2, "score": 13, "last_activity_date": 1529286350, "creation_date": 1436243759, "question_id": 31259812, "link": "https://stackoverflow.com/questions/31259812/how-do-i-connect-io-reader-and-io-writer", "title": "How do I connect io.Reader and io.Writer?", "body": "<p>I'm writing a long running task which fetch from mongodb (using mgo) multiple times. Then write it to an xlsx file using <a href=\"https://godoc.org/github.com/tealeg/xlsx#File.Save\" rel=\"noreferrer\">this module</a>. Then read it again using <code>os.Open</code> then store it to my ftp server.</p>\n\n<p><code>Stor</code> function consume my memory so much, So I think there should be a way not to save file but pass my data from xlsx.Write to ftp.Store directly. (If I can stream simultaneously would be perfect because I don't have to hold all of my documents in server's memory before send them to Stor function)</p>\n\n<p>These are prototype of the functions</p>\n\n<p><code>func (f *File) Write(writer io.Writer) (err error)</code> <a href=\"https://godoc.org/github.com/tealeg/xlsx#File.Write\" rel=\"noreferrer\">xlsl</a></p>\n\n<p><code>func (ftp *FTP) Stor(path string, r io.Reader) (err error)</code> <a href=\"https://godoc.org/github.com/dutchcoders/goftp\" rel=\"noreferrer\">ftp</a></p>\n"}, {"tags": ["postgresql", "go", "postgresql-9.4"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1436239112, "post_id": 31259154, "comment_id": 50514551, "body": "There should be an error message. &quot;the query hangs&quot; is not descriptive enough."}, {"owner": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "edited": false, "score": 1, "creation_date": 1436239245, "post_id": 31259154, "comment_id": 50514584, "body": "is the DB located on the same machine as the app, or is it separate? Are firewalls / NAT involved (where state could be timing out due to inactivity.  When the app hangs does a netstat still show the connection as active?"}, {"owner": {"reputation": 2863, "user_id": 1675384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f1954353e8bf19f1ce9a7ac1cfd32ca8?s=128&d=identicon&r=PG", "display_name": "Anshu Prateek", "link": "https://stackoverflow.com/users/1675384/anshu-prateek"}, "edited": false, "score": 0, "creation_date": 1436239473, "post_id": 31259154, "comment_id": 50514642, "body": "Where are you running the db? Is it on heroku? Heroku &quot;sleeps&quot; if not used hence the next live query will take time. Also, please note that you dont need to open and close connections for every query, but you should have a close statement in the end of your program."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 2863, "user_id": 1675384, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/f1954353e8bf19f1ce9a7ac1cfd32ca8?s=128&d=identicon&r=PG", "display_name": "Anshu Prateek", "link": "https://stackoverflow.com/users/1675384/anshu-prateek"}, "edited": false, "score": 0, "creation_date": 1436239966, "post_id": 31259154, "comment_id": 50514753, "body": "@AnshuPrateek Note that a <code>defer db.Close()</code> in <code>main()</code> won&#39;t get executed if your application is sent a <code>SIGINT</code> (via the keyboard or a process manager) - you&#39;d have to explicitly catch that case. It won&#39;t functionally make a difference for most applications."}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 18224, "user_id": 406987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8865b16d4f3493cfae865af2b3247fd3?s=128&d=identicon&r=PG", "display_name": "Doon", "link": "https://stackoverflow.com/users/406987/doon"}, "edited": false, "score": 0, "creation_date": 1436240645, "post_id": 31259154, "comment_id": 50514893, "body": "@Doon The database is hosted on an external server running a vanilla Ubuntu install w/ Postgresql 9.4"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1436240772, "post_id": 31259154, "comment_id": 50514929, "body": "@zerkms I am printing errors on query execution as well as when I scan the rows. There is no error reported...unless I am not handling my error correctly in my code.....The query usually runs in less than 1 second but if I leave the app running and come back &amp; execute again the query takes a loooooong time. I can then restart the app &amp; run the query again and it runs, again, in less than a second."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1436241887, "post_id": 31259154, "comment_id": 50515197, "body": "Look at setting <code>db.SetMaxIdleConns(x)</code> (5 - 10 idles is a good starting point). Without it, there can be some setup time for the pool to re-auth and provide you with a usable connection."}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436319964, "post_id": 31259154, "comment_id": 50557424, "body": "@elithrar that doesn&#39;t seem to work."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436320075, "post_id": 31259154, "comment_id": 50557451, "body": "Does it have no effect? What do your Postgres server logs (under <code>&#47;var&#47;log&#47;postgres</code>) indicate at the time your Go application appears to &quot;hang&quot; on reconnect?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436394381, "post_id": 31259154, "comment_id": 50599447, "body": "@elithrar please see my edit for the log"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436395115, "post_id": 31259154, "comment_id": 50599714, "body": "It appears the client is timing out. I assume your client is running on your local machine? (since you say the database is on an external server). Is it possible your local machine is sleeping and causing a timeout?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "edited": false, "score": 0, "creation_date": 1436396370, "post_id": 31259154, "comment_id": 50600185, "body": "My client is running on my local machine. The above code is also running on my local machine &amp; postgresql is on a remote machine. I hit &quot;127.0.0.1:8080/page&quot; in chrome. I wouldn&#39;t think chrome sleeps but even if it did why doesn&#39;t it sleep when I restart the above code?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436398760, "post_id": 31259154, "comment_id": 50600909, "body": "Chrome won&#39;t sleep, but your computer (running your Go server) might. If your Postgres connection times out <i>every 16 minutes</i> (consistently) then it would point to a sleep/suspend issue. 15 minutes is a common &quot;my laptop sleeps now&quot; setting. (note that I&#39;m taking a stab here - there&#39;s not enough information to genuinely solve this directly)"}, {"owner": {"reputation": 693, "user_id": 2305236, "user_type": "registered", "accept_rate": 15, "profile_image": "https://i.stack.imgur.com/WWEWr.jpg?s=128&g=1", "display_name": "David Carrigan", "link": "https://stackoverflow.com/users/2305236/david-carrigan"}, "edited": false, "score": 0, "creation_date": 1436637071, "post_id": 31259154, "comment_id": 50701218, "body": "I would agree with those above, since you are dealing with two separate system. The server can be closing the connection regardless of what your client wants or is doing. This isn&#39;t my language, but conceptually would it be so harmful to just open and then close the connection as you need it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "reply_to_user": {"reputation": 693, "user_id": 2305236, "user_type": "registered", "accept_rate": 15, "profile_image": "https://i.stack.imgur.com/WWEWr.jpg?s=128&g=1", "display_name": "David Carrigan", "link": "https://stackoverflow.com/users/2305236/david-carrigan"}, "edited": false, "score": 0, "creation_date": 1436644201, "post_id": 31259154, "comment_id": 50703150, "body": "@DavidCarrigan In Go the DB connection is meant to be long-lived...if that&#39;s the case then we shouldn&#39;t need to constantly close &amp; re-open connections."}], "answers": [{"tags": [], "owner": {"reputation": 22505, "user_id": 1411457, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/XqssD.png?s=128&g=1", "display_name": "harmic", "link": "https://stackoverflow.com/users/1411457/harmic"}, "is_accepted": true, "score": 4, "last_activity_date": 1436762128, "creation_date": 1436762128, "answer_id": 31375478, "question_id": 31259154, "link": "https://stackoverflow.com/questions/31259154/database-hangs-if-not-used/31375478#31375478", "title": "Database hangs if not used", "body": "<p>I have experienced similar issues. In our case, the problem was caused by a connection tracking firewall located between the client machine and the database.</p>\n\n<p>Such firewalls keep track of TCP level connections, and in order to limit resource usage, then will time out connections which to them appear inactive for an extended period. The symptoms we observed in this case were very similar to yours: at the client end, the connection appears to be hanging, while at the server end you can see <code>connection reset by peer</code>.</p>\n\n<p>One way to prevent this is to ensure that <a href=\"http://tldp.org/HOWTO/TCP-Keepalive-HOWTO/overview.html\" rel=\"nofollow\">TCP Keepalives</a> are enabled, and that the keepalive interval is less than the timeout of the firewalls, routers, etc which are causing your connection issue. This is controlled by the libpq connection parameters <code>keepalives</code>, <code>keepalives_idle</code>, <code>keepalives_interval</code> and <code>keepalives_count</code> which you can set in the connection string. See the <a href=\"http://www.postgresql.org/docs/current/static/libpq-connect.html#LIBPQ-CONNSTRING\" rel=\"nofollow\">manual</a> for a description of these parameters.</p>\n\n<ul>\n<li><code>keepalive</code> determines if the keepalive function is enabled or not. It defaults to <code>1</code> (enabled) so you probably do not need to specify this.</li>\n<li><p><code>keepalives_idle</code> determines the amount of idle time before it will send a keepalive. If you do not specify this, it will default to the default for the operating system. </p>\n\n<p>In a Linux system you can see the default by examining <code>/proc/sys/net/ipv4/tcp_keepalive_time</code> - in my server it is set to 7200 seconds, which would be too long in your case, since your observation is that the connection is dropped after ~1 hour.</p>\n\n<p>You could try setting it to, say, 2500 seconds.</p></li>\n</ul>\n\n<p>The Linux Documentation Project provides a useful <a href=\"http://www.tldp.org/HOWTO/html_single/TCP-Keepalive-HOWTO/\" rel=\"nofollow\">TCP Keepalive HOWTO</a> document that describes how they work in some detail.</p>\n\n<p>Note that not all operating systems support TCP keepalives. If you are unable to enable keepalives here are some other options you might like to consider:</p>\n\n<ol>\n<li><p>If it is in your control, reconfigure the firewall/router which is dropping the connection so that it will not do so for Postgresql client connections</p></li>\n<li><p>At an application level, you might be able to send some traffic that will keep the DB handles active - for example sending a statement such as <code>SELECT 1;</code> every hour or so. If your programming environment provides connection caching (from the comments I gather it does) then this might be tricky.</p></li>\n</ol>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user776942"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1326, "favorite_count": 0, "accepted_answer_id": 31375478, "answer_count": 1, "score": 5, "last_activity_date": 1436762128, "creation_date": 1436238859, "last_edit_date": 1436394531, "question_id": 31259154, "link": "https://stackoverflow.com/questions/31259154/database-hangs-if-not-used", "title": "Database hangs if not used", "body": "<p>I have a web application I am starting. Works fine upon startup but if I leave it (for say, an hour) and hit it with another request the query hangs. I thought about closing it after each query then opening up a new connection but the docs explicitly say \"It is rare to Close a DB, as the DB handle is meant to be long-lived and shared between many goroutines.\". What am I doing wrong?</p>\n\n<pre><code>package main\n\nimport (\n  \"database/sql\"\n  \"log\"\n  \"net/http\"\n  _ \"github.com/lib/pq\"\n)\n\nvar Db *sql.DB\n\nfunc main() {\n  var err error\n  Db, err = sql.Open(\"postgres\", \"user=me password=openupitsme host=my.host.not.yours dbname=mydb sslmode=require\")\n  if err != nil {\n    log.Fatal(\"Cannot connect to db: \", err)\n  }\n  http.HandleFunc(\"/page\", myHandler)\n  http.ListenAndServe(\":8080\", nil)\n}\n\nfunc myHandler(w http.ResponseWriter, r *http.Request) {\n  log.Println(\"Handling Request....\", r)\n  query := `SELECT pk FROM mytable LIMIT 1`\n  rows, err := Db.Query(query)\n  if err != nil {\n    log.Println(err)\n  }\n  defer rows.Close()\n  for rows.Next() {\n    var pk int64\n    if err := rows.Scan(&amp;pk); err != nil {\n      log.Println(err)\n    }\n    log.Println(pk)\n  }\n  log.Println(\"Request Served...\")\n}\n</code></pre>\n\n<p>EDIT #1:\nMy postgres log shows:</p>\n\n<pre><code>2015-07-08 18:10:01 EDT [7710-1] user@here LOG:  could not receive data from client: Connection reset by peer\n2015-07-08 18:20:01 EDT [7756-1] user@here LOG:  could not receive data from client: Connection reset by peer\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1436238137, "creation_date": 1436238137, "answer_id": 31259041, "question_id": 31259023, "link": "https://stackoverflow.com/questions/31259023/whats-the-usage-of-golang-static-library-file/31259041#31259041", "title": "What&#39;s the usage of Golang static library file?", "body": "<p>The compiled packages can be reused if you compile something else. This saves time on subsequent compiles. When you recompile you only need to compile the package and the things that depend on it, not its dependencies.</p>\n\n<p>They also contain data used by <a href=\"https://github.com/nsf/gocode\" rel=\"nofollow\">gocode</a> for autcompleting.</p>\n"}], "owner": {"reputation": 1014, "user_id": 2447860, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/ce99f307eeddec0a6912d7b9b73e91e2?s=128&d=identicon&r=PG&f=1", "display_name": "Eric Zheng", "link": "https://stackoverflow.com/users/2447860/eric-zheng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 776, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1436238137, "creation_date": 1436238017, "question_id": 31259023, "link": "https://stackoverflow.com/questions/31259023/whats-the-usage-of-golang-static-library-file", "title": "What&#39;s the usage of Golang static library file?", "body": "<p>I see <code>go install &lt;main package&gt;</code> will compile the dependency packages into static library files and install them into the <code>pkg</code> directory, but the executable doesn't need the library files when running. And I also discover that source file is necessary when compiling.</p>\n\n<p>So, is there any special usage of the static files?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 6, "last_activity_date": 1436230587, "last_edit_date": 1436230587, "creation_date": 1436224088, "answer_id": 31257201, "question_id": 31257125, "link": "https://stackoverflow.com/questions/31257125/why-cant-i-key-in-a-string-in-golang-map/31257201#31257201", "title": "Why can&#39;t I key in a string in Golang map?", "body": "<p>Because you haven't actually initilize/allocated <code>m</code>, you've only declared it. Make this; <code>var m map[string]int</code> into <code>m := map[string]int{}</code>.</p>\n\n<p>Which does initilization and assignment both in the same statement. You could also add another line <code>m = make(map[string]int)</code> which would prevent the error though I personally prefer the compacted syntax.</p>\n\n<p>fyi your code is barfing on this line; <code>m[c_string[i]] = 0</code>, the error message should make sense when combining that with the information above.</p>\n"}], "owner": {"reputation": 4504, "user_id": 3681199, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/70b2072de3d0d43e1af48fd2d416157f?s=128&d=identicon&r=PG&f=1", "display_name": "Nona", "link": "https://stackoverflow.com/users/3681199/nona"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 518, "favorite_count": 0, "accepted_answer_id": 31257201, "answer_count": 1, "score": 0, "last_activity_date": 1436230587, "creation_date": 1436223604, "question_id": 31257125, "link": "https://stackoverflow.com/questions/31257125/why-cant-i-key-in-a-string-in-golang-map", "title": "Why can&#39;t I key in a string in Golang map?", "body": "<p>I'm writing a function in go to remove duplicate characters in a string.  Here is my approach.  When I run the following test, why do I get this error?  I'm new to Go and used to more dynamic languages like Ruby/Python.</p>\n\n<pre><code>panic: assignment to entry in nil map [recovered]\n    panic: assignment to entry in nil map\n</code></pre>\n\n<p><strong>source.go</strong></p>\n\n<pre><code>func removeDuplicate(s string) string {\n  var m map[string]int\n    var c_string []string = strings.Split(s, \"\")\n    for i :=0; i &lt; len(c_string); i++ {\n      m[c_string[i]] = 0\n    }\n    for i :=0; i &lt; len(c_string); i++ {\n      m[c_string[i]] = m[c_string[i]] + 1\n    }\n  var (\n        result string = \"\"\n    )\n    for i :=0; i &lt; len(c_string); i++ {\n      if m[c_string[i]] &lt; 1 {\n      result  = result + c_string[i]\n        }\n    }\n    return result\n}\n</code></pre>\n\n<p><em>source_test.go</em></p>\n\n<pre><code>func TestRemoveDuplicateChars(t *testing.T) {\n  got := removeDuplicateChars(\"abbcde\")\n    if got != \"abcde\" {\n        t.Fatalf(\"removeDuplicateChars fails\")\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "makefile"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436206934, "post_id": 31252748, "comment_id": 50502819, "body": "You have to provide the version somehow. If it&#39;s not <code>package main</code>, then you need to import the package and read the variable."}, {"owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436207553, "post_id": 31252748, "comment_id": 50503144, "body": "so the ldflags are setting the variables in main package <code>main.buildTime</code> etc. and I can&#39;t import main, so I tried setting it with other package, but somehow still not working, I get empty string :("}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436208235, "post_id": 31252748, "comment_id": 50503508, "body": "If you&#39;re setting the variable in main, it only exists as you set it in the final binary -- so make the binary output the version with a special flag. As for &quot;setting it with another package&quot;, you&#39;ll have to show an example because I don&#39;t know what you mean."}, {"owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436209772, "post_id": 31252748, "comment_id": 50504385, "body": "You mean, if I add another flag such as <code>-X xyz.buildVersion</code> in make file, then I should be able to access buildVersion in <code>xyz</code> package. I am doing that and then I have <code>var buildVersion string</code> in xyz package, but it is empty although I am doing <code>go install -ldflags myapp.go</code>"}, {"owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436209937, "post_id": 31252748, "comment_id": 50504481, "body": "oh missed the &quot;make the binary output the version with special flag&quot; part."}], "answers": [{"tags": [], "owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "is_accepted": true, "score": 2, "last_activity_date": 1436212633, "creation_date": 1436212633, "answer_id": 31254545, "question_id": 31252748, "link": "https://stackoverflow.com/questions/31252748/getting-make-file-variables-in-a-go-package/31254545#31254545", "title": "getting make file variables in a go package?", "body": "<p>Directory structure:</p>\n\n<pre><code>- main.go\n- test/\n  - test.go\n</code></pre>\n\n<p><strong>test.go</strong></p>\n\n<pre><code>package test\n\nvar Version = \"\"\n</code></pre>\n\n<p><strong>main.go</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"test\"\n)\n\nfunc main() {\n    fmt.Println(test.Version)\n}\n</code></pre>\n\n<p>Finally, run:</p>\n\n<pre><code>go run -ldflags=\"-X test.Version 2.0.0\" main.go\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>&gt; 2.0.0\n</code></pre>\n\n<p>Since we can specify import path, we can set the value of a string everywhere, not only in main.</p>\n\n<p>From go 1.5 up, syntax is changed to <code>importpath.name=string</code>.</p>\n"}], "owner": {"reputation": 951, "user_id": 631593, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/6f0ab0bf648041c211675b2bd06313c6?s=128&d=identicon&r=PG", "display_name": "Varun", "link": "https://stackoverflow.com/users/631593/varun"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 514, "favorite_count": 0, "accepted_answer_id": 31254545, "answer_count": 1, "score": 2, "last_activity_date": 1436212633, "creation_date": 1436206203, "question_id": 31252748, "link": "https://stackoverflow.com/questions/31252748/getting-make-file-variables-in-a-go-package", "title": "getting make file variables in a go package?", "body": "<p>I have a variable <code>VERSION</code> in a make file that sets the version for binary at compile time using <code>-ldflags</code></p>\n\n<pre><code>VERSION = $(strip $(TIMESTAMP))\nLDFLAGS = -ldflags \"-X main.buildTime $(BUILD_TIME) -X main.buildNumber $(VERSION)\"\n</code></pre>\n\n<p>Now I want to get the VERSION in a package which is not <code>main</code> and print it. I tried bunch of options, but not able to make it work.</p>\n\n<p>My question is how can I get it in the package and then print it to client at run time, such as <code>you are connected to app version 2.0</code>..??</p>\n"}, {"tags": ["windows", "github", "elasticsearch", "go", "packetbeat"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1436202933, "post_id": 31251338, "comment_id": 50500581, "body": "The <a href=\"https://github.com/elastic/packetbeat/blob/master/docs/windows.asciidoc\" rel=\"nofollow noreferrer\">windows docs</a> were recently updated. If they don&#39;t work, you should probably file and issue there."}, {"owner": {"reputation": 168, "user_id": 2125025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa8e20fc9dbab3ab996bb65b778b71?s=128&d=identicon&r=PG", "display_name": "Shannon Duncan", "link": "https://stackoverflow.com/users/2125025/shannon-duncan"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436205599, "post_id": 31251338, "comment_id": 50502092, "body": "@JimB ah ok. I didn&#39;t see that. However their download link doesn&#39;t have the windows packages. I&#39;ll file with them."}], "answers": [{"comments": [{"owner": {"reputation": 8303, "user_id": 2055765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0bd6b4cd13f414803f6a3beea6ab4c96?s=128&d=identicon&r=PG", "display_name": "Richard Telford", "link": "https://stackoverflow.com/users/2055765/richard-telford"}, "edited": false, "score": 0, "creation_date": 1468262420, "post_id": 38312948, "comment_id": 64044357, "body": "While this link may answer the question, it is better to include the essential parts of the answer here and provide the link for reference.  Link-only answers can become invalid if the linked page changes. - <a href=\"/review/low-quality-posts/12971993\">From Review</a>"}, {"owner": {"reputation": 284, "user_id": 4016294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100002173853814/picture?type=large", "display_name": "rresol", "link": "https://stackoverflow.com/users/4016294/rresol"}, "reply_to_user": {"reputation": 8303, "user_id": 2055765, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0bd6b4cd13f414803f6a3beea6ab4c96?s=128&d=identicon&r=PG", "display_name": "Richard Telford", "link": "https://stackoverflow.com/users/2055765/richard-telford"}, "edited": false, "score": 0, "creation_date": 1468262947, "post_id": 38312948, "comment_id": 64044620, "body": "I have updated the answer now , please let me know if you face some problems with it."}], "tags": [], "owner": {"reputation": 284, "user_id": 4016294, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/100002173853814/picture?type=large", "display_name": "rresol", "link": "https://stackoverflow.com/users/4016294/rresol"}, "is_accepted": false, "score": 1, "last_activity_date": 1468262836, "last_edit_date": 1468262836, "creation_date": 1468258669, "answer_id": 38312948, "question_id": 31251338, "link": "https://stackoverflow.com/questions/31251338/installing-packetbeat-on-windows/38312948#38312948", "title": "Installing PacketBeat on Windows", "body": "<ul>\n<li>Download and install WinPcap from this <a href=\"http://www.winpcap.org/install/default.htm\" rel=\"nofollow\">page</a>. WinPcap is a library that uses a driver to enable packet capturing.</li>\n<li>Download the Packetbeat Windows zip file from <a href=\"https://www.elastic.co/downloads/beats/packetbeat\" rel=\"nofollow\">here</a>.</li>\n<li>Extract the contents of the zip file into C:\\Program Files.</li>\n<li>Rename the packetbeat--windows directory to Packetbeat.</li>\n<li>Open a PowerShell prompt as an Administrator (right-click the PowerShell icon and select Run As Administrator). If you are running Windows XP, you may need to download and install PowerShell.</li>\n<li><p>Run the following commands to install Packetbeat as a Windows service:</p></li>\n<li><p>PS > cd 'C:\\Program Files\\Packetbeat'</p></li>\n<li>PS C:\\Program Files\\Packetbeat> .\\install-service-packetbeat.ps1</li>\n<li><p>Note</p>\n\n<h2>If script execution is disabled on your system, you need to set the execution policy for the current session to allow the script to run. For example: PowerShell.exe -ExecutionPolicy UnRestricted -File .\\install-service-packetbeat.ps1.</h2></li>\n<li><p>Before starting Packetbeat, you should look at the configuration options in the configuration file, for example C:\\Program Files\\Packetbeat\\packetbeat.yml or /etc/packetbeat/packetbeat.yml</p></li>\n</ul>\n\n<p>Here is the <a href=\"https://www.elastic.co/guide/en/beats/packetbeat/current/packetbeat-installation.html\" rel=\"nofollow\">link</a> to the documentation of installing packetbeat on windows.</p>\n"}, {"tags": [], "owner": {"reputation": 1584, "user_id": 1096596, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/14589ba62c2be9b44bcf93de41d7f9ef?s=128&d=identicon&r=PG", "display_name": "BobbyA", "link": "https://stackoverflow.com/users/1096596/bobbya"}, "is_accepted": false, "score": 0, "last_activity_date": 1500496232, "creation_date": 1500496232, "answer_id": 45200451, "question_id": 31251338, "link": "https://stackoverflow.com/questions/31251338/installing-packetbeat-on-windows/45200451#45200451", "title": "Installing PacketBeat on Windows", "body": "<p>Follow the instructions <a href=\"https://www.elastic.co/guide/en/beats/packetbeat/current/packetbeat-getting-started.html\" rel=\"nofollow noreferrer\">on this page</a> to install packetbeat on your windows machine.</p>\n\n<p>Note:</p>\n\n<p>winpcap.dll is required for packetbeat to function on a windows machine. WinPCap itself isn't currently supported, so the current best practice is to use npcap in winpcap compatibility mode instead. <a href=\"https://www.elastic.co/guide/en/beats/packetbeat/current/faq.html#packetbeat-loopback-interface\" rel=\"nofollow noreferrer\">See this section of the Packetbeat FAQ</a></p>\n\n<p>You can download npcap's installer <a href=\"https://nmap.org/npcap/\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>The command line call to install npcap (version 0.86) in winpcap compatibility mode is:</p>\n\n<pre><code>npcap-0.86.exe /winpcap_mode=yes\n</code></pre>\n\n<p>The silent install would be:</p>\n\n<pre><code>npcap-0.86.exe /S /winpcap_mode=yes\n</code></pre>\n"}], "owner": {"reputation": 168, "user_id": 2125025, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/edaa8e20fc9dbab3ab996bb65b778b71?s=128&d=identicon&r=PG", "display_name": "Shannon Duncan", "link": "https://stackoverflow.com/users/2125025/shannon-duncan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2589, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1500496232, "creation_date": 1436201208, "question_id": 31251338, "link": "https://stackoverflow.com/questions/31251338/installing-packetbeat-on-windows", "title": "Installing PacketBeat on Windows", "body": "<p>I am unable to find a reliable way to install elastic's packetbeat on windows. I know I'll have to download source and create my own windows package. However, all instructions are outdated and are from before it moved to elastic's domain.</p>\n\n<p>Anyone know how to compile this package for windows?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 2, "last_activity_date": 1436200935, "creation_date": 1436200935, "answer_id": 31251258, "question_id": 31251204, "link": "https://stackoverflow.com/questions/31251204/not-able-to-create-custom-packages-in-golang/31251258#31251258", "title": "Not able to create custom packages in golang", "body": "<p><code>go run</code> is for executables, and works on separate files. Use <code>go install</code> and <code>go build</code> to work with packages. Additional reading: <a href=\"http://golang.org/doc/code.html\" rel=\"nofollow\">http://golang.org/doc/code.html</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 177, "user_id": 5086822, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/853c6f82008ed7b4728c143159e206f1?s=128&d=identicon&r=PG", "display_name": "Zhuharev", "link": "https://stackoverflow.com/users/5086822/zhuharev"}, "is_accepted": false, "score": 3, "last_activity_date": 1436213389, "creation_date": 1436213389, "answer_id": 31254721, "question_id": 31251204, "link": "https://stackoverflow.com/questions/31251204/not-able-to-create-custom-packages-in-golang/31254721#31254721", "title": "Not able to create custom packages in golang", "body": "<p>Create dir <code>mypackage</code> and <code>mypackage.go</code> in <code>$GOPATH</code></p>\n\n<p>put in <code>mypackage.go</code> following code</p>\n\n<pre><code>package mypackage\n\nfunc Hello() {\n   println(\"hello\")\n}\n</code></pre>\n\n<p>Create <code>main.go</code></p>\n\n<pre><code>package main\n\nimport \"mypackage\"\n\nfunc main() {\n     mypackage.Hello()\n}\n</code></pre>\n\n<p><code>go run</code> command must be applied to <code>main</code> package</p>\n\n<p><strong>In you case, create main.go file and import <code>github.com/mypkg</code></strong></p>\n\n<p>Also importing packages should not contain <code>main</code> function.</p>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1506325832, "last_edit_date": 1506325832, "creation_date": 1498402727, "answer_id": 44747579, "question_id": 31251204, "link": "https://stackoverflow.com/questions/31251204/not-able-to-create-custom-packages-in-golang/44747579#44747579", "title": "Not able to create custom packages in golang", "body": "<p>I have been through this problem. It is showing this error because there is no main package in any .go file. You should create a main folder in which create a main.go file to call main package function main and import your package in that just like below:</p>\n\n<pre><code>package main \nimport(\n    \"fmt\"\n    \"github.com/mypkg\"\n)\nfunc main(){\n// use use your package functions here by packagename.functionname\n    mypkg.functionName()\n    fmt.Println(\"Hello\")\n}\n</code></pre>\n\n<p>Now build the package by moving to mypkg directory and run <code>go build</code> on terminal or command line if you are window user.\nMove up to main directory which contains main.go file and run <code>go install</code>\nit will create executable file in the name of main directory. The directory structure be like.</p>\n\n<pre><code>workspace\n  \u251c\u2500\u2500 bin\n  \u2502   \u2514\u2500\u2500 app\n  \u251c\u2500\u2500 pkg\n  \u2502   \u2514\u2500\u2500 linux_amd64\n  |         \u2514\u2500\u2500 user\n  |              \u2514\u2500\u2500 handlers.a\n  \u2514\u2500\u2500 src\n    \u251c\u2500\u2500 bitbucket.org\n    \u251c\u2500\u2500 github.com\n         \u2514\u2500\u2500 user\n              \u2514\u2500\u2500 app\n                   \u251c\u2500\u2500 main.go\n                   \u2514\u2500\u2500 mypkg\n                         \u2514\u2500\u2500mypkg.go\n</code></pre>\n"}], "owner": {"reputation": 43, "user_id": 2513034, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cc42220b3991f4172d5de4473ac0cda?s=128&d=identicon&r=PG", "display_name": "Sridhar Udayakumar", "link": "https://stackoverflow.com/users/2513034/sridhar-udayakumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4761, "favorite_count": 2, "answer_count": 3, "score": 1, "last_activity_date": 1506325832, "creation_date": 1436200748, "question_id": 31251204, "link": "https://stackoverflow.com/questions/31251204/not-able-to-create-custom-packages-in-golang", "title": "Not able to create custom packages in golang", "body": "<p>I am pretty new to GO. I was trying few examples and one of them was to use cgo to call a C code from GO.</p>\n\n<p>Here is the example I am trying: <a href=\"https://code.google.com/p/go-wiki/wiki/cgo\" rel=\"nofollow\">https://code.google.com/p/go-wiki/wiki/cgo</a></p>\n\n<p>With the above link as a reference I created a package structure as below:</p>\n\n<p>gocode/src/github.com/mypkg/test.go</p>\n\n<p>\"mypkg\" is the custom package that I have created and used it in the test.go as below:</p>\n\n<p>package mypkg</p>\n\n<p>I get an error when I run my go program.\n<strong>\"go run: cannot run non-main package\"</strong></p>\n\n<p>I have set my GOPATH to the GO source code folder.</p>\n\n<p>GOPATH=/xyz/gocode/src/</p>\n\n<p>I searched for solutions and found the below links which says, custom pacakages cannot be created:\n    <a href=\"https://groups.google.com/forum/#!topic/golang-nuts/vmebkoqYMH4\" rel=\"nofollow\">https://groups.google.com/forum/#!topic/golang-nuts/vmebkoqYMH4</a></p>\n\n<pre><code>http://stackoverflow.com/questions/23870801/go-run-cannot-run-non-main-package\n</code></pre>\n\n<p>But, All the code I see is with a custom pacakage name. Please help me to resolve this issue.</p>\n\n<p>Any help is really appreciated.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1436199560, "post_id": 31250617, "comment_id": 50498742, "body": "possible duplicate of <a href=\"http://stackoverflow.com/questions/6235317/why-doesnt-the-go-statement-execute-in-parallel\">Why doesn&#39;t the go statement execute in parallel?</a>"}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 0, "creation_date": 1436206686, "post_id": 31250617, "comment_id": 50502670, "body": "Note that the default random number generator is safe for concurrent use, which it achieves by locking. If you&#39;re using lots of random numbers in goroutines you want to avoid them serializing access to random numbers by having an isolated <code>*math.Rand</code> per goroutine. You can do this via <a href=\"https://golang.org/pkg/math/rand/#New\" rel=\"nofollow noreferrer\"><code>rand.New</code></a> (and <a href=\"https://golang.org/pkg/math/rand/#NewSource\" rel=\"nofollow noreferrer\"><code>rand.NewSource</code></a>, with different seeds for each of course)."}, {"owner": {"reputation": 5149, "user_id": 1689770, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/78b5dcbdd9f67f569c6102e091faafeb?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/1689770/jonathan"}, "edited": false, "score": 0, "creation_date": 1553403204, "post_id": 31250617, "comment_id": 97368373, "body": "Tangentially related: The fastest way to speed up file writing is write it all at once with one big fwrite, and if you need faster than that, then you can look into toggling off internal buffering in the processor caches &amp; hard drive caches which is typically, I presume, system dependant. You may need a lower level language for this such as C if you get really detailed"}], "answers": [{"comments": [{"owner": {"reputation": 43, "user_id": 2990251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1682662484/picture?type=large", "display_name": "art_vandelay", "link": "https://stackoverflow.com/users/2990251/art-vandelay"}, "edited": false, "score": 0, "creation_date": 1436199999, "post_id": 31250883, "comment_id": 50498994, "body": "Ok that was something I always thought could hinder the performance when you are doing writes. Basically what you are saying is that no matter how fast you generate data, writing will always be the same unless we have some sort of &quot;done&quot; condition?"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 43, "user_id": 2990251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1682662484/picture?type=large", "display_name": "art_vandelay", "link": "https://stackoverflow.com/users/2990251/art-vandelay"}, "edited": false, "score": 2, "creation_date": 1436200287, "post_id": 31250883, "comment_id": 50499155, "body": "@art_vandelay I&#39;m saying the OS and hard drive will dictate how fast you can write to a single file, not your apps level of concurrency. If you wrote to a bunch of files and aggregated them into one (assuming you&#39;re dealing with very large amounts of data now) then it could save you time perhaps. What I&#39;m saying is that if generating data is slower than writing you can do the data generation concurrently to improve performance. Since your writes are inherently not concurrent you can&#39;t just do try writing from a bunch of different go routines to make performance better."}, {"owner": {"reputation": 43, "user_id": 2990251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1682662484/picture?type=large", "display_name": "art_vandelay", "link": "https://stackoverflow.com/users/2990251/art-vandelay"}, "edited": false, "score": 0, "creation_date": 1436200608, "post_id": 31250883, "comment_id": 50499333, "body": "Wow, that makes perfect sense haha. Ok with this better understanding im going to try and re-write this badboy. I appreciate the input."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436202215, "post_id": 31250883, "comment_id": 50500206, "body": "(sorry, previous comment was inaccurate), it&#39;s not safe to assume that reads and write are atomic per the filesystem. Different filesystems guarantee &quot;conform&quot; to POSIX at varying levels, and often don&#39;t provide atomic writes, or have differing behavior depending on write size."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436202926, "post_id": 31250883, "comment_id": 50500578, "body": "@JimB to be clear, I&#39;m not saying the file system is going to guarantee atomic writes but simply that you can&#39;t have a bunch of threads writing to the same file at the same time without some system of coordination and ultimately they will have to take turns. If you pass a writer into a bunch of goroutines I would assume they would coordinate by locking the file."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436203284, "post_id": 31250883, "comment_id": 50500750, "body": "But you do say &quot;writes are almost always atomic&quot;, which is misleading. Also, when you say &quot;coordinate by locking the file&quot;, you must mean the <code>os.File</code> in the user&#39;s code, since the <code>os</code> package makes no such guarantees, and the filesystems locks are only advisory."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436206666, "post_id": 31250883, "comment_id": 50502660, "body": "@JimB yeah, I agree that is somewhat misleading. Perhaps it should say &quot;almost always need to be&quot;. Regarding <code>os</code> and <code>os.File</code> I choose not to discuss their specifics because the users design doesn&#39;t make sense on a high level regardless of those details. Yes, I was vaguely referring to locking an <code>os.File</code> in the users code using a <code>sync.Mutex</code>, again, I don&#39;t get into the specifics because I don&#39;t think it makes sense to use such an approach as the <code>sync.Mutex</code> inherently makes the act of writing synchronous."}, {"owner": {"reputation": 43, "user_id": 2990251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1682662484/picture?type=large", "display_name": "art_vandelay", "link": "https://stackoverflow.com/users/2990251/art-vandelay"}, "edited": false, "score": 0, "creation_date": 1436208357, "post_id": 31250883, "comment_id": 50503577, "body": "Just an update. I came to the conclusion that it would take very long to generate one giant file. However, I found that it was more efficient to create multiple files. Since my end goal was to make a giant spreadsheet of 100 million records then split them into 1000 seperate .csv files. Thankfully, using my same model and some go different routines, I am now able to accomplish this goal. Thanks so much @evanmcdonnal for helping me grasp this concept and steer me in the right direction."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 43, "user_id": 2990251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1682662484/picture?type=large", "display_name": "art_vandelay", "link": "https://stackoverflow.com/users/2990251/art-vandelay"}, "edited": false, "score": 1, "creation_date": 1436211734, "post_id": 31250883, "comment_id": 50505515, "body": "@art_vandelay glad I could help! In that case doing each write in it&#39;s own go routine makes perfect sense. You still may want to use a similar model to what I have above because it&#39;s somewhat necessary to make a responsive app but when you read you could call a method to do the write in a goroutine and pass the item into it so that execution continues and the next file begins writing as soon as data for it becomes available."}, {"owner": {"reputation": 43, "user_id": 2990251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1682662484/picture?type=large", "display_name": "art_vandelay", "link": "https://stackoverflow.com/users/2990251/art-vandelay"}, "edited": false, "score": 0, "creation_date": 1436212991, "post_id": 31250883, "comment_id": 50506187, "body": "Yeah just now since everything is randomly generated and using go routines, I have to address my issue of seeding because I get the same data everytime. It seems every step forward, there is always something else to hurdle over haha."}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "reply_to_user": {"reputation": 43, "user_id": 2990251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1682662484/picture?type=large", "display_name": "art_vandelay", "link": "https://stackoverflow.com/users/2990251/art-vandelay"}, "edited": false, "score": 1, "creation_date": 1436213122, "post_id": 31250883, "comment_id": 50506259, "body": "@art_vandelay I would recommend seeding in your for loop using the loop variable to ensure a different value each iteration and pass that into the worker method. ie <code>func Seed(seed int64)</code> with <code>i</code> as the arg, then add an arg to <code>worker</code> and call it with <code>rand.Uint32()</code> or 64 or whatever type you want your random value to be."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 1, "last_activity_date": 1436199741, "creation_date": 1436199741, "answer_id": 31250883, "question_id": 31250617, "link": "https://stackoverflow.com/questions/31250617/golang-and-concurrency-parallelism/31250883#31250883", "title": "Golang and Concurrency/Parallelism", "body": "<p>I don't think you should be trying to use a go routine here. File writes are almost always atomic, you want to make the mechanism which writes to your file concurrent... That would require a complicated locking mechanism that ultimately probably won't improve application performance due to the write itself still being atomic.</p>\n\n<p>If data generation were bottle necking your program then it would make sense to split that work off in go routines and write from that place where you get all the data. But </p>\n\n<pre><code>for i := 0; i &lt; 100; i++ {\n    go worker(receive)\n}\n\nfor {\n    select {\n    case item := &lt;-receive:\n         writer(item)\n    case &lt;-abort:\n         cleanUp()\n         return\n    }\n}\n</code></pre>\n\n<p>You can't just loop on some int while recieving from a channel and calling a function endlessly... You can receive from a channel in a select though. Or just by doing <code>item := &lt;-recieve</code> which would block until one item gets read. In my example above I've provided some pseudo code to demonstrate more what your design should be in this case. You need an abort channel so you can get out of your go routines should you want to stop the application. It should probably finalize the write to your file and then close it before returning.</p>\n"}, {"tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": false, "score": 0, "last_activity_date": 1436203039, "creation_date": 1436203039, "answer_id": 31251838, "question_id": 31250617, "link": "https://stackoverflow.com/questions/31250617/golang-and-concurrency-parallelism/31251838#31251838", "title": "Golang and Concurrency/Parallelism", "body": "<p>Try <a href=\"http://openmymind.net/Introduction-To-Go-Buffered-Channels/\" rel=\"nofollow\">buffering your channel</a>:</p>\n\n<pre><code>receive := make(chan string, 1000)\n</code></pre>\n\n<p>Write speed is limited by your disk, so there's only so much you can do to help by writing concurrently, and from what you're telling generating data concurrently doesn't help either.</p>\n\n<p>Concurrency isn't the solution for anything slow, either accept you're at the limit or optimize.</p>\n"}], "owner": {"reputation": 43, "user_id": 2990251, "user_type": "registered", "profile_image": "https://graph.facebook.com/1682662484/picture?type=large", "display_name": "art_vandelay", "link": "https://stackoverflow.com/users/2990251/art-vandelay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 720, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1436203039, "creation_date": 1436198942, "question_id": 31250617, "link": "https://stackoverflow.com/questions/31250617/golang-and-concurrency-parallelism", "title": "Golang and Concurrency/Parallelism", "body": "<p>I am diving into Golang and have a problem that I have been working on a few days and I just cant seem to grasp the concept of go routines and how they are used.</p>\n\n<p>Basically I am, trying to generate millions of random records. I have functions that make the random data, and will create a giant .CSV file containing this data.</p>\n\n<p>My questions is if it is possible to make this concurrent and speed things up?</p>\n\n<p>My code is basically generate a random string, write string to file up to N times (where N is whatever you want).</p>\n\n<p>My question is if its possible to even do this concurrently in order to reduce execution time. It seems that no matter how I approach this problem, I still get the same benchmark as if I did it without go routines.</p>\n\n<p>This is a sample of what I have so far:</p>\n\n<pre><code>func worker(c chan string) {\n        for {\n                c &lt;- /* Generate random data using other functions here */\n        }\n        close(c)\n}\n\nfunc writer(s string) {\n        csvfile.WriteString(s)\n}\n\nfunc main(){    \n    receive := make(chan string)\n\n    for i := 0; i &lt; 100; i++ {\n        go worker(receive)\n    }\n\n    for i := 0; i &lt; 10000; i++ {\n        go writer(&lt;-receive)\n    }\n}\n</code></pre>\n\n<p>Where I generate data, I am using tons and tons of function calls from: <a href=\"https://github.com/Pallinder/go-randomdata\" rel=\"nofollow\">https://github.com/Pallinder/go-randomdata</a>. Do you think that that could be where I am losing all this time?</p>\n\n<p>Any help would be appreciated.</p>\n"}, {"tags": ["go", "iterable"], "answers": [{"tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": true, "score": 3, "last_activity_date": 1436200065, "last_edit_date": 1436200065, "creation_date": 1436198537, "answer_id": 31250464, "question_id": 31250385, "link": "https://stackoverflow.com/questions/31250385/go-abstract-iterable/31250464#31250464", "title": "Go: abstract iterable", "body": "<blockquote>\n  <p>Or, maybe, the whole design is \"bad\" for Go and I should consider something else?</p>\n</blockquote>\n\n<p>While you could build some interface on top of the types so that you can deal with them as if they were the same I would say it's a poor choice. The far simpler one is to take advantage of multiple return types and define your func with <code>chan myType, []myType, error</code> for it's return then just use 3 way if-else to check for error, followed by chan or slice. Read of the channel like you normally would, iterate the slice like you normally would. Put the code that does work on <code>myType</code> in a helper method so you can call it from both control flows.</p>\n\n<p>My money says this is no more code and it's also far more straight forward. I don't have to read through some abstraction to understand that I have a channel and the inherit complications that come along with it (chan and a slice are incongruous so trying to model them the same sounds like a nightmare), instead you just have an extra step in the programs control flow. </p>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 3, "last_activity_date": 1436199822, "creation_date": 1436199822, "answer_id": 31250921, "question_id": 31250385, "link": "https://stackoverflow.com/questions/31250385/go-abstract-iterable/31250921#31250921", "title": "Go: abstract iterable", "body": "<p>I'm kinda late to the party, but if you really need some \"abstract iterable\", you could create an interface like this:</p>\n\n<pre><code>type Iterable interface {\n    Next() (int, error)\n}\n</code></pre>\n\n<p>(Inspired by <a href=\"http://golang.org/pkg/database/sql/#Rows\" rel=\"nofollow\"><code>sql.Rows</code></a>.)</p>\n\n<p>Then, you could use it like this:</p>\n\n<pre><code>for n, err := iter.Next(); err != nil; n, err = iter.Next() {\n    fmt.Println(n)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "is_accepted": false, "score": 0, "last_activity_date": 1436205647, "creation_date": 1436205647, "answer_id": 31252600, "question_id": 31250385, "link": "https://stackoverflow.com/questions/31250385/go-abstract-iterable/31252600#31252600", "title": "Go: abstract iterable", "body": "<p>For iteration I usually follow pattern found in <a href=\"http://golang.org/pkg/database/sql/#Rows\" rel=\"nofollow\">sql.Rows</a> and <a href=\"http://golang.org/pkg/bufio/#Scanner\" rel=\"nofollow\">bufio.Scanner</a>. Both have a next-equivalent function returning bool, indicating whether next item has been successfully fetched. Then there's a separate method to access the value and error. This pattern lets you write very clean <code>for</code> loops without complex conditions (and without using <code>break</code> or <code>continue</code> statements) and moves error handling outside of the loop.</p>\n\n<p>If you were to abstract your line input, you could for example create an interface like this:</p>\n\n<pre><code>type LineScanner interface {\n    Scan() bool\n    Text() string\n    Err() error\n}\n</code></pre>\n\n<p>This would give you and abstract line source reader. As a bonus, by using exactly these method names you would make <code>bufio.Scanner</code> instantly implementing your interface, so you could use it along with your own types, for example tail-like reader mentioned in your question.</p>\n\n<p>Fuller example:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"strings\"\n)\n\ntype LineScanner interface {\n    Scan() bool\n    Text() string\n    Err() error\n}\n\nfunc main() {\n    var lr LineScanner\n\n    // Use scanner from bufio package\n    lr = bufio.NewScanner(strings.NewReader(\"one\\ntwo\\nthree!\\n\"))\n    // Alternatively you can provide your own implementation of LineScanner,\n    // for example tail-like, blocking on Scan() until next line appears.\n\n    // Very clean for loop, isn't it?\n    for lr.Scan() {\n        // Handle next line\n        fmt.Println(lr.Text())\n    }\n    // Check if no error while reading\n    if lr.Err() != nil {\n        fmt.Println(\"Error:\", lr.Err())\n    }\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/LRbGWj9_Xw\" rel=\"nofollow\">http://play.golang.org/p/LRbGWj9_Xw</a></p>\n"}], "owner": {"reputation": 1662, "user_id": 4258834, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/LK9Tq.jpg?s=128&g=1", "display_name": "oopcode", "link": "https://stackoverflow.com/users/4258834/oopcode"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 176, "favorite_count": 0, "accepted_answer_id": 31250464, "answer_count": 3, "score": 3, "last_activity_date": 1436205647, "creation_date": 1436198268, "last_edit_date": 1436198605, "question_id": 31250385, "link": "https://stackoverflow.com/questions/31250385/go-abstract-iterable", "title": "Go: abstract iterable", "body": "<p>Suppose I want to have a method that should <em>either</em> return a <code>chan</code> <em>or</em> a <code>slice</code>. For example, I need a <code>chan</code> if I want to \"follow\" a file as new lines come, and a slice if I just want to read and return existing lines.</p>\n\n<p>In both cases I will only have to iterate through this return value. Here is an abstract example in Python (which has nothing to do with files but sort of shows the idea):</p>\n\n<pre><code>def get_iterable(self):\n    if self.some_flag:\n        return (x for x in self.some_iterable)\n    return [x for x in self.some_iterable]\n\ndef do_stuff(self):\n    items = self.get_iterable()\n    for item in items:\n        self.process(item)\n</code></pre>\n\n<p>Now, I have a difficulty doing this in Go. I suppose I should look for something like an \"iterable interface\" which I should return, but I failed to google up some ready-to-use solutions (sorry if it's just my poor googling skills).</p>\n\n<p>What is the best way to do what I want? Or, maybe, the whole design is \"bad\" for Go and I should consider something else?</p>\n"}, {"tags": ["go", "error-handling", "header", "http-headers"], "comments": [{"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 0, "creation_date": 1436192912, "post_id": 31248242, "comment_id": 50494132, "body": "how are you going to resolve the <code>ParseFiles</code> incorrect path issue?"}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1436193200, "post_id": 31248242, "comment_id": 50494335, "body": "why doesn&#39;t work , this is my question when I check the header don&#39;t find &quot;Error&quot; on the header. I tiried without <b>panic</b> doesn&#39;t work. I don&#39;t want to resolve **ParseFiles ** I just want to send the message through a header"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1436193335, "post_id": 31248242, "comment_id": 50494446, "body": "@Aziz: it doesn&#39;t work because you&#39;re calling <code>panic</code> and aborting the handler. Don&#39;t do that."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436193736, "post_id": 31248242, "comment_id": 50494734, "body": "@JimB I tried without <code>panic</code>,it doesn&#39;t work."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436194169, "post_id": 31248242, "comment_id": 50495081, "body": "Put some debugging statements in there to make sure it&#39;s doing what you expect. We can&#39;t tell what this code does out of context, (plus <code>job_1.Complete(health.Panic)</code> sounds like it might panic too). Please make a <a href=\"http://stackoverflow.com/help/mcve\">reproducible example</a> if you can&#39;t figure out what&#39;s going on."}, {"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1436196633, "post_id": 31248242, "comment_id": 50496842, "body": "@JimB I edited my question I hope that it&#39;s clear now"}], "answers": [{"comments": [{"owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "edited": false, "score": 0, "creation_date": 1436197565, "post_id": 31249954, "comment_id": 50497495, "body": "Great the problem was the <code>return</code> I put it after the <code>http.Error</code> and it works perfectly now. Gracias."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 1, "last_activity_date": 1436197097, "creation_date": 1436197097, "answer_id": 31249954, "question_id": 31248242, "link": "https://stackoverflow.com/questions/31248242/golang-send-errors-using-http-header/31249954#31249954", "title": "Golang: Send errors using Http Header", "body": "<p>The <code>502</code> response, is coming from nginx, so first test the go server directly on port 6001. Also, look at the output for your server's process, there error will be printed there.</p>\n\n<p>After you set your error header and call <code>http.Error</code> you need a <code>return</code>, otherwise you're going to continue executing the rest of the handler. Since <code>tmpl</code> is nil if there was an error, calling <code>tmpl.Execute</code> causes a nil pointer dereference, and the server panics. </p>\n\n<p>(And you start out setting a \"successful\" header, so that will always be there, even if there's an error.)</p>\n"}], "owner": {"reputation": 621, "user_id": 4851387, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/92ef9e7d030494e2e142ce9d7a1f436b?s=128&d=identicon&r=PG&f=1", "display_name": "abdel", "link": "https://stackoverflow.com/users/4851387/abdel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1339, "favorite_count": 0, "accepted_answer_id": 31249954, "answer_count": 1, "score": 0, "last_activity_date": 1436197097, "creation_date": 1436192267, "last_edit_date": 1436196570, "question_id": 31248242, "link": "https://stackoverflow.com/questions/31248242/golang-send-errors-using-http-header", "title": "Golang: Send errors using Http Header", "body": "<p>I want  to send all the errors that I get to another service(Consume my service) using Http Header </p>\n\n<p>Ex: I tried this but it doesn't work:</p>\n\n<pre><code>func main() {\n  http.HandleFunc(\"/\", foo)\n  log.Println(\"Listening...\")\n  http.ListenAndServe(\":6001\", nil)\n  }\n\nfunc foo(w http.ResponseWriter, r *http.Request) {\n  w.Header().Set(\"successfull\", \"A Go Web Server\")\n\n  fi := path.Join(\"templates/VastPlayer\", \"TempVide_.txt\")\n  tmpl, err := template.ParseFiles(fi)\n\n        if err != nil {\n            w.Header().Set(\"Error\", err.Error())\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            }\n        if  err := tmpl.Execute(w, \"\"); err != nil{\n              w.Header().Set(\"Error\", err.Error())  \n              http.Error(w, err.Error(), http.StatusInternalServerError)\n          }\n  }\n</code></pre>\n\n<p>if I give a valide template I got <strong>\"successfull\" : \"A Go Web Server\"</strong> on the Header, but if I give no existing tempalte I got <strong>502 Bad Gateway</strong> and this on the header </p>\n\n<pre><code>HTTP/1.1 502 Bad Gateway\nServer: nginx/1.8.0\nDate: Mon, 06 Jul 2015 15:19:31 GMT\nContent-Type: text/html\nContent-Length: 574\nConnection: keep-alive\n</code></pre>\n\n<p>I want to know if there is a way to send the Error that i got through a header,\nI mean <strong>templates/VastPlayer/TempVide_.txt: no such file or directory</strong></p>\n\n<p>Thank you in advance</p>\n"}, {"tags": ["go", "nan"], "answers": [{"comments": [{"owner": {"reputation": 1320, "user_id": 593146, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2404c3e4304714294c0458b3feb39ff0?s=128&d=identicon&r=PG", "display_name": "Zyl", "link": "https://stackoverflow.com/users/593146/zyl"}, "edited": false, "score": 1, "creation_date": 1541108810, "post_id": 31246269, "comment_id": 93114870, "body": "A noteworthy addendum while we&#39;re on it: <code>math.NaN()</code> is not equal to itself: <a href=\"https://play.golang.org/p/H_SziEAdCvc\" rel=\"nofollow noreferrer\">play.golang.org/p/H_SziEAdCvc</a>"}, {"owner": {"reputation": 131, "user_id": 6869797, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0bf1d8137f52e4bd3a43b8cc95c02872?s=128&d=identicon&r=PG&f=1", "display_name": "Nico Vergauwen", "link": "https://stackoverflow.com/users/6869797/nico-vergauwen"}, "edited": false, "score": 0, "creation_date": 1604964042, "post_id": 31246269, "comment_id": 114503140, "body": "NaN == NaN results to false in every language as per the IEEE 754 spec which nearly all languages implement <a href=\"https://en.wikipedia.org/wiki/IEEE_754\" rel=\"nofollow noreferrer\">en.wikipedia.org/wiki/IEEE_754</a>"}], "tags": [], "owner": {"reputation": 19808, "user_id": 1472049, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/1qeQt.jpg?s=128&g=1", "display_name": "serejja", "link": "https://stackoverflow.com/users/1472049/serejja"}, "is_accepted": true, "score": 39, "last_activity_date": 1436186806, "creation_date": 1436186806, "answer_id": 31246269, "question_id": 31246192, "link": "https://stackoverflow.com/questions/31246192/how-to-check-for-nan-in-golang/31246269#31246269", "title": "How to check for NaN in golang", "body": "<p>Use <code>math.IsNaN(...)</code> for that: <a href=\"http://play.golang.org/p/edvbSR-Cth\" rel=\"noreferrer\">playground</a></p>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 13, "last_activity_date": 1436186816, "creation_date": 1436186816, "answer_id": 31246272, "question_id": 31246192, "link": "https://stackoverflow.com/questions/31246192/how-to-check-for-nan-in-golang/31246272#31246272", "title": "How to check for NaN in golang", "body": "<p>Use <a href=\"http://golang.org/pkg/math/#IsNaN\"><code>math.IsNaN</code></a>:</p>\n\n<blockquote>\n  <p>IsNaN reports whether f is an IEEE 754 \u201cnot-a-number\u201d value.</p>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 2188, "user_id": 3157428, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/NdasB.jpg?s=128&g=1", "display_name": "Ruli", "link": "https://stackoverflow.com/users/3157428/ruli"}, "edited": false, "score": 0, "creation_date": 1611928926, "post_id": 65954043, "comment_id": 116614715, "body": "This does not provide an answer to the question. Once you have sufficient <a href=\"https://stackoverflow.com/help/whats-reputation\">reputation</a> you will be able to <a href=\"https://stackoverflow.com/help/privileges/comment\">comment on any post</a>; instead, <a href=\"https://meta.stackexchange.com/questions/214173/why-do-i-need-50-reputation-to-comment-what-can-i-do-instead\">provide answers that don&#39;t require clarification from the asker</a>. - <a href=\"/review/low-quality-posts/28196514\">From Review</a>"}], "tags": [], "owner": {"reputation": 11, "user_id": 14655020, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99691e210ecb39b1614a468aaa93cc8a?s=128&d=identicon&r=PG&f=1", "display_name": "bacchus", "link": "https://stackoverflow.com/users/14655020/bacchus"}, "is_accepted": false, "score": 1, "last_activity_date": 1612057385, "last_edit_date": 1612057385, "creation_date": 1611921532, "answer_id": 65954043, "question_id": 31246192, "link": "https://stackoverflow.com/questions/31246192/how-to-check-for-nan-in-golang/65954043#65954043", "title": "How to check for NaN in golang", "body": "<p>As mentioned in Nico's comment, because NaN is defined as <code>f != f</code>, that's all that <code>math.IsNaN</code> does.\n<a href=\"https://golang.org/src/math/bits.go?s=791:822#L24\" rel=\"nofollow noreferrer\">See the src here</a>.</p>\n<p>So, you can just check:</p>\n<pre><code>if f != f {\n    fmt.Printf(&quot;%v is NaN&quot;, f)\n}\n</code></pre>\n<p>Edited to make into a standalone answer.</p>\n"}], "owner": {"reputation": 959, "user_id": 4258990, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh3.googleusercontent.com/-HV2VFWdvYJk/AAAAAAAAAAI/AAAAAAAAABE/ZuH-L91ZV00/photo.jpg?sz=128", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/4258990/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18736, "favorite_count": 2, "accepted_answer_id": 31246269, "answer_count": 3, "score": 20, "last_activity_date": 1612057385, "creation_date": 1436186611, "question_id": 31246192, "link": "https://stackoverflow.com/questions/31246192/how-to-check-for-nan-in-golang", "title": "How to check for NaN in golang", "body": "<p>How can I check whether a float variable is NaN or not? e.g.</p>\n\n<pre><code>math.Log(1.0) // not NaN\nmath.Log(-1.0)  // NaN\n</code></pre>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1436183392, "post_id": 31244438, "comment_id": 50487515, "body": "How do you print it where it appears as <code>&quot;_id&quot; : &quot;U\ufffd</code>\ufffd\\u0006@\ufffd\\rU\\u0000\\u0000\\u0001&quot;`?"}, {"owner": {"reputation": 1085, "user_id": 3169138, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSAPm.jpg?s=128&g=1", "display_name": "byrnedo", "link": "https://stackoverflow.com/users/3169138/byrnedo"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1436183856, "post_id": 31244438, "comment_id": 50487805, "body": "I&#39;m using the <code>mongo</code> cli command and just copying the output of <code>db.mycol.find()</code>. Thing is, ids that were autogenerated appear as <code>ObjectId(&quot;blah...&quot;)</code>"}], "answers": [{"comments": [{"owner": {"reputation": 1085, "user_id": 3169138, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSAPm.jpg?s=128&g=1", "display_name": "byrnedo", "link": "https://stackoverflow.com/users/3169138/byrnedo"}, "edited": false, "score": 0, "creation_date": 1436193488, "post_id": 31248135, "comment_id": 50494556, "body": "The issue is hopefully solved. I am using a library which imports mgo via <code>gopkg.in&#47;mgo.v2</code>. I was importing mgo myself as well as <code>gopkg.in&#47;v2&#47;mgo</code>. After copying the external code into the project and making them all import from <code>labix.org&#47;v2&#47;mgo</code> it now works. So the path confusion possibly caused it."}, {"owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "reply_to_user": {"reputation": 1085, "user_id": 3169138, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSAPm.jpg?s=128&g=1", "display_name": "byrnedo", "link": "https://stackoverflow.com/users/3169138/byrnedo"}, "edited": false, "score": 1, "creation_date": 1436195097, "post_id": 31248135, "comment_id": 50495766, "body": "labix.org/v2/mgo is extremely old. Please use gopkg.in/mgo.v2 instead."}, {"owner": {"reputation": 1085, "user_id": 3169138, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSAPm.jpg?s=128&g=1", "display_name": "byrnedo", "link": "https://stackoverflow.com/users/3169138/byrnedo"}, "edited": false, "score": 0, "creation_date": 1436294077, "post_id": 31248135, "comment_id": 50547208, "body": "Thanks @Gustavo, will update the imports to that path."}], "tags": [], "owner": {"reputation": 18455, "user_id": 2657550, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88d553accfca32636d96a8d5075e85d1?s=128&d=identicon&r=PG", "display_name": "Gustavo Niemeyer", "link": "https://stackoverflow.com/users/2657550/gustavo-niemeyer"}, "is_accepted": true, "score": 2, "last_activity_date": 1436195634, "last_edit_date": 1436195634, "creation_date": 1436191989, "answer_id": 31248135, "question_id": 31244438, "link": "https://stackoverflow.com/questions/31244438/mgo-newobjectid-corrupt-on-insert/31248135#31248135", "title": "mgo NewObjectId corrupt on insert", "body": "<p>The representation <code>\"U\ufffd`\ufffd\\u0006@\ufffd\\rU\\u0000\\u0000\\u0001\"</code> is clearly indicating that an ObjectId got sent to the database as a string rather than as a properly typed object id. Every such case before was a code path in the application side delivering the string explicitly as such by mistake. I recommend investigating every code path that inserts objects in that collection, and if you can find no case that is sending it as an actual string, then try to create a reproducer and report it upstream to the mgo driver.</p>\n\n<p><strong>Update:</strong> Per your comment below, the issue is being caused because some part of the application is using an <code>ObjectId</code> type from a package that is not the one actually used during communication with the database. This has the effect described above: the <code>ObjectId</code> type coming from the wrong package is just a normal string, as far as the correct <code>bson</code> package is concerned.</p>\n"}], "owner": {"reputation": 1085, "user_id": 3169138, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wSAPm.jpg?s=128&g=1", "display_name": "byrnedo", "link": "https://stackoverflow.com/users/3169138/byrnedo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 525, "favorite_count": 0, "accepted_answer_id": 31248135, "answer_count": 1, "score": 0, "last_activity_date": 1436195634, "creation_date": 1436181374, "question_id": 31244438, "link": "https://stackoverflow.com/questions/31244438/mgo-newobjectid-corrupt-on-insert", "title": "mgo NewObjectId corrupt on insert", "body": "<p>If I generate a new object id for a document in mgo:</p>\n\n<pre><code>obId := bson.NewObjectId()\n</code></pre>\n\n<p>and then insert it, it ends up in mongo (looking via the cli) as </p>\n\n<pre><code>\"_id\" : \"U\ufffd`\ufffd\\u0006@\ufffd\\rU\\u0000\\u0000\\u0001\"\n</code></pre>\n\n<p>When it should be </p>\n\n<pre><code>\"_id\" : ObjectId(\"559a47643d9827f0d9405420\")\n</code></pre>\n\n<p>Same goes if I try and update an existing document where I generate the id by </p>\n\n<pre><code>obId := bson.ObjectIdHex(stringId)\n</code></pre>\n\n<p>It still gets serialized to the corrupted format.</p>\n\n<p>My struct which I'm trying to insert looks like this:</p>\n\n<pre><code>type MyStruct struct {\n    Id            bson.ObjectId `bson:\"_id,omitempty\" json:\"id\"`\n    ...\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1701, "user_id": 788887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68a54ea809de360f7049f5c970df1d7?s=128&d=identicon&r=PG", "display_name": "ReyCharles", "link": "https://stackoverflow.com/users/788887/reycharles"}, "edited": false, "score": 1, "creation_date": 1436167388, "post_id": 31239758, "comment_id": 50477620, "body": "I believe one of the design goals of Go is simplicity. The language spec is very short. I believe this might be an example of simplicity at the cost of nonsense constructs."}, {"owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "reply_to_user": {"reputation": 1701, "user_id": 788887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68a54ea809de360f7049f5c970df1d7?s=128&d=identicon&r=PG", "display_name": "ReyCharles", "link": "https://stackoverflow.com/users/788887/reycharles"}, "edited": false, "score": 2, "creation_date": 1436168765, "post_id": 31239758, "comment_id": 50478448, "body": "@ReyCharles I would accept that for why, say, <code>var ch chan&lt;- int = make(chan int)</code> is valid, but <code>make</code> is such a special construct whose behavior is rather clearly and comprehensively spelled out in the spec that  I think it&#39;s more of an oversight than a consequence of simplicity."}, {"owner": {"reputation": 22907, "user_id": 2714852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a6e4d0e8ce0d468dd3b93a97893b67b3?s=128&d=identicon&r=PG&f=1", "display_name": "twotwotwo", "link": "https://stackoverflow.com/users/2714852/twotwotwo"}, "reply_to_user": {"reputation": 1701, "user_id": 788887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68a54ea809de360f7049f5c970df1d7?s=128&d=identicon&r=PG", "display_name": "ReyCharles", "link": "https://stackoverflow.com/users/788887/reycharles"}, "edited": false, "score": 8, "creation_date": 1436174169, "post_id": 31239758, "comment_id": 50481594, "body": "I think it&#39;s a thing you&#39;d never want to do. (Or, at least, someone who comes up with a use for it wins today&#39;s round of Go Pub Trivia\u2122.) But along the lines of what @ReyCharles said, specs aren&#39;t required to exclude all nonsense constructs. Go attempts to prevent some forms of nonsense that C doesn&#39;t (e.g., unused vars); Rust has static checks that try to exclude some nonsense Go happily compiles (e.g., races). That&#39;s OK, and we mostly chuckle at the occasional oddity and move on to trying to build stuff."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 4, "last_activity_date": 1436234455, "creation_date": 1436234455, "answer_id": 31258576, "question_id": 31239758, "link": "https://stackoverflow.com/questions/31239758/is-there-a-purpose-for-makeing-a-one-directional-channel/31258576#31258576", "title": "Is there a purpose for &quot;make&quot;ing a one-directional channel?", "body": "<p>You have a language: words (tokens) and a grammar. You can always write valid nonsense: blue is not a color.</p>\n\n<p>You wrote some valid nonsense:</p>\n\n<pre><code>package main\n\nfunc main() {\n    ch := make(chan&lt;- int)\n    ch &lt;- 5\n}\n</code></pre>\n\n<p>Here's some more valid nonsense:</p>\n\n<pre><code>package main\n\nfunc main() {\n    for {\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 17491, "user_id": 901827, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/86a6acccf7e8dbe398ebda4f8524ed50?s=128&d=identicon&r=PG", "display_name": "LinearZoetrope", "link": "https://stackoverflow.com/users/901827/linearzoetrope"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 234, "favorite_count": 1, "answer_count": 1, "score": 13, "last_activity_date": 1436234455, "creation_date": 1436166901, "last_edit_date": 1495541713, "question_id": 31239758, "link": "https://stackoverflow.com/questions/31239758/is-there-a-purpose-for-makeing-a-one-directional-channel", "title": "Is there a purpose for &quot;make&quot;ing a one-directional channel?", "body": "<p>NB: This is not a duplicate of <a href=\"https://stackoverflow.com/questions/13596186/whats-the-point-of-one-way-channels-in-go\">this</a> question, because I understand when you would use one-directional channels. I do so all the time. My question is why this program is valid:</p>\n\n<pre><code>func main() {\n    ch := make(chan&lt;- int)\n    ch &lt;- 5\n    fmt.Println(\"Hello, playground\")\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/OdQr4oac94\" rel=\"nofollow noreferrer\">Playground</a></p>\n\n<p>Running it, of course, gives a deadlock. If you check the type with %T, Go does in fact report that the type of <code>ch</code> is a send-only channel. In Go, you're allowed to <code>make</code> uni-directional channels, but it makes little sense because by making a channel that at its inception is one-way only, you're ensuring at least one of read/write will never occur.</p>\n\n<p>A possible explanation would be to force a goroutine to hang but that's just as easily accomplished with <code>select {}</code>. </p>\n\n<p>My only other idea is to force a goroutine to only do something <code>n</code> times,</p>\n\n<pre><code>ch := make(chan&lt;- int, 50)\n// do something 50 times, since then the buffer is full\nfor {\n  ch &lt;- doSomething()\n}\n</code></pre>\n\n<p>But that's more easily, not to mention less confusingly, accomplished with any number of different constructions.</p>\n\n<p>Is this just a quirk/oversight of the type system, or is there use for this behavior I'm not thinking of?</p>\n"}, {"tags": ["string", "unicode", "go"], "answers": [{"comments": [{"owner": {"reputation": 1277, "user_id": 1709647, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/efef9722d3a47141694ee7e2b3ae7f55?s=128&d=identicon&r=PG", "display_name": "Knights", "link": "https://stackoverflow.com/users/1709647/knights"}, "edited": false, "score": 0, "creation_date": 1436166462, "post_id": 31239411, "comment_id": 50477121, "body": "Thank you. Yes...I am aware a string is treated automatically as an array of characters. JavaScript does this too."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1277, "user_id": 1709647, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/efef9722d3a47141694ee7e2b3ae7f55?s=128&d=identicon&r=PG", "display_name": "Knights", "link": "https://stackoverflow.com/users/1709647/knights"}, "edited": false, "score": 3, "creation_date": 1436166666, "post_id": 31239411, "comment_id": 50477235, "body": "@JheneKnights No, in Go a <code>string</code> is stored as a slice of <code>bytes</code> in memory, which is the <code>utf-8</code> encoded byte sequence of the characters. See this blog post for more details: <a href=\"http://blog.golang.org/strings\" rel=\"nofollow noreferrer\">Strings, bytes, runes and characters in Go</a>. So obtaining <code>rune</code>s requires decoding the bytes."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1499624388, "post_id": 31239411, "comment_id": 76973104, "body": "The <code>charCodeAt</code> function returns the rune at the byte index <code>n</code>, not at rune index <code>n</code>.  See <a href=\"https://play.golang.org/p/QDLzyqSxkI\" rel=\"nofollow noreferrer\">play.golang.org/p/QDLzyqSxkI</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 20, "last_activity_date": 1539724120, "last_edit_date": 1539724120, "creation_date": 1436165674, "answer_id": 31239411, "question_id": 31239330, "link": "https://stackoverflow.com/questions/31239330/go-langs-equivalent-of-charcode-method-of-javascript/31239411#31239411", "title": "Go lang&#39;s equivalent of charCode() method of JavaScript", "body": "<p>The character type in Go is <code>rune</code> which is an alias for <code>int32</code> so it is already a number, just print it.</p>\n\n<p>You still need a way to get the character at the specified position. Simplest way is to convert the <code>string</code> to a <code>[]rune</code> which you can index. To convert a <code>string</code> to runes, simply use the type conversion <code>[]rune(\"some string\")</code>:</p>\n\n<pre><code>fmt.Println([]rune(\"s\")[0])\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>115\n</code></pre>\n\n<p>If you want it printed as a character, use the <code>%c</code> format string:</p>\n\n<pre><code>fmt.Println([]rune(\"absdef\")[2])      // Also prints 115\nfmt.Printf(\"%c\", []rune(\"absdef\")[2]) // Prints s\n</code></pre>\n\n<p>Also note that the <code>for range</code> on a <code>string</code> iterates over the runes of the string, so you can also use that. It is more efficient than converting the whole <code>string</code> to <code>[]rune</code>:</p>\n\n<pre><code>i := 0\nfor _, r := range \"absdef\" {\n    if i == 2 {\n        fmt.Println(r)\n        break\n    }\n    i++\n}\n</code></pre>\n\n<p>Note that the counter <code>i</code> must be a distinct counter, it cannot be the loop iteration variable, as the <code>for range</code> returns the byte position and not the <code>rune</code> index (which will be different if the <code>string</code> contains multi-byte characters in the UTF-8 representation).</p>\n\n<p>Wrapping it into a function:</p>\n\n<pre><code>func charCodeAt(s string, n int) rune {\n    i := 0\n    for _, r := range s {\n        if i == n {\n            return r\n        }\n        i++\n    }\n    return 0\n}\n</code></pre>\n\n<p>Try these on the <a href=\"https://play.golang.org/p/LPQbLXgFr9X\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>Also note that <code>string</code>s in Go are stored in memory as a <code>[]byte</code> which is the UTF-8 encoded byte sequence of the text (read the blog post <a href=\"http://blog.golang.org/strings\" rel=\"noreferrer\">Strings, bytes, runes and characters in Go</a> for more info). If you have guarantees that the <code>string</code> uses characters whose code is less than 127, you can simply work with bytes. That is indexing a <code>string</code> in Go indexes its bytes, so for example <code>\"s\"[0]</code> is the byte value of <code>'s'</code> which is <code>115</code>.</p>\n\n<pre><code>fmt.Println(\"s\"[0])      // Prints 115\nfmt.Println(\"absdef\"[2]) // Prints 115\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 318, "user_id": 2298063, "user_type": "registered", "profile_image": "https://graph.facebook.com/100001716275596/picture?type=large", "display_name": "rhozet", "link": "https://stackoverflow.com/users/2298063/rhozet"}, "is_accepted": false, "score": 4, "last_activity_date": 1522981908, "last_edit_date": 1522981908, "creation_date": 1522981048, "answer_id": 49684249, "question_id": 31239330, "link": "https://stackoverflow.com/questions/31239330/go-langs-equivalent-of-charcode-method-of-javascript/49684249#49684249", "title": "Go lang&#39;s equivalent of charCode() method of JavaScript", "body": "<p>Internally string is a 8 bit byte array in golang. So every byte will represent the ascii value.</p>\n\n<pre><code>str:=\"abc\"\nbyteValue := str[0]\nintValue := int(byteValue)\nfmt.Println(byteValue)//97\nfmt.Println(intValue)//97\n</code></pre>\n"}], "owner": {"reputation": 1277, "user_id": 1709647, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/efef9722d3a47141694ee7e2b3ae7f55?s=128&d=identicon&r=PG", "display_name": "Knights", "link": "https://stackoverflow.com/users/1709647/knights"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 13829, "favorite_count": 1, "accepted_answer_id": 31239411, "answer_count": 2, "score": 11, "last_activity_date": 1539724120, "creation_date": 1436165390, "last_edit_date": 1436166787, "question_id": 31239330, "link": "https://stackoverflow.com/questions/31239330/go-langs-equivalent-of-charcode-method-of-javascript", "title": "Go lang&#39;s equivalent of charCode() method of JavaScript", "body": "<p>The <code>charCodeAt()</code> method in JavaScript returns the numeric Unicode value of the character at the given index, e.g.</p>\n\n<pre><code>\"s\".charCodeAt(0) // returns 115\n</code></pre>\n\n<p>How would I go by to get the numeric unicode value of the the same string/letter in Go?</p>\n"}, {"tags": ["go", "docker"], "comments": [{"owner": {"reputation": 38746, "user_id": 4332, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/11e0717b37120636599e19dfc789b193?s=128&d=identicon&r=PG", "display_name": "Adrian Mouat", "link": "https://stackoverflow.com/users/4332/adrian-mouat"}, "edited": false, "score": 1, "creation_date": 1436169808, "post_id": 31238712, "comment_id": 50479023, "body": "I&#39;d need to see the Go code, but I suspect you&#39;ve bound to localhost or 127.0.0.1 instead of 0.0.0.0."}], "answers": [{"comments": [{"owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 1, "creation_date": 1436397301, "post_id": 31300285, "comment_id": 50600494, "body": "Thanks Jonathan! This was a very helpful reply. Just doing the first step of your answer (changing localhost to 0.0.0.0) already solved the problem for me."}, {"owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1436398673, "post_id": 31300285, "comment_id": 50600887, "body": "A quick follow up question if you don&#39;t mind. Even though blog is being served correctly, the blog also starts a web socket connection which fails in handshake because of the origin check made <a href=\"https://github.com/maddyonline/tools/blob/master/playground/socket/socket.go#L93\" rel=\"nofollow noreferrer\">here</a>."}, {"owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1436399518, "post_id": 31300285, "comment_id": 50601132, "body": "Specifically, the connection origin host and websocket origin don&#39;t match: 0.0.0.0:8080, localhost:8080. Any suggestions how to get around this (other than updating the <a href=\"https://github.com/maddyonline/tools/blob/master/playground/socket/socket.go#L93\" rel=\"nofollow noreferrer\">code in socket.go</a>)."}, {"owner": {"reputation": 5331, "user_id": 555017, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/06aa109f3832c30df43af5fcd2f13d9c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/555017/jonathan"}, "reply_to_user": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1436402128, "post_id": 31300285, "comment_id": 50601816, "body": "Yeah, I noticed that too. I was thinking you could set an allow-origin CORS header to get around it. More info on <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Access_control_CORS#Access-Control-Allow-Origin\" rel=\"nofollow noreferrer\">MDN</a>"}, {"owner": {"reputation": 5331, "user_id": 555017, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/06aa109f3832c30df43af5fcd2f13d9c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/555017/jonathan"}, "reply_to_user": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1436402305, "post_id": 31300285, "comment_id": 50601853, "body": "Ooooh. Dang, that is being hard-checked in the Go websockets library you are using. I am not sure there is a way around it without changing that code. I originally thought it was a the browser blocking the request."}, {"owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1436402406, "post_id": 31300285, "comment_id": 50601876, "body": "Yeaah I think I will change the socket library code. FYI, will award the bounty as soon as the 5 hour wait time (imposed by stackoverflow) finishes."}, {"owner": {"reputation": 5331, "user_id": 555017, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/06aa109f3832c30df43af5fcd2f13d9c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/555017/jonathan"}, "reply_to_user": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "edited": false, "score": 0, "creation_date": 1436402625, "post_id": 31300285, "comment_id": 50601921, "body": "Thanks! My first bounty."}, {"owner": {"reputation": 908, "user_id": 8084731, "user_type": "registered", "profile_image": "https://graph.facebook.com/1653815704646436/picture?type=large", "display_name": "princebillyGK", "link": "https://stackoverflow.com/users/8084731/princebillygk"}, "edited": false, "score": 0, "creation_date": 1615655405, "post_id": 31300285, "comment_id": 117761143, "body": "Thank you so much changing from localhost to 0.0.0.0 saved my day. this answer required more upvote"}], "tags": [], "owner": {"reputation": 5331, "user_id": 555017, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/06aa109f3832c30df43af5fcd2f13d9c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/555017/jonathan"}, "is_accepted": true, "score": 3, "last_activity_date": 1436378940, "last_edit_date": 1436378940, "creation_date": 1436378589, "answer_id": 31300285, "question_id": 31238712, "link": "https://stackoverflow.com/questions/31238712/docker-publish-not-working-correctly-for-golang-application/31300285#31300285", "title": "Docker publish not working correctly for golang application", "body": "<p>I found two issues with your current code.</p>\n\n<p>The first is that the string <code>localhost</code> in your <code>main.go</code> needs to be <code>0.0.0.0</code>. The problem is that you've told your webserver to only serve requests sent to <code>localhost</code>. Because of the network mangling that Docker does, none of the traffic showing up to your webserver look to the webserver as though they were sent to <code>localhost</code>. By telling your webserver to listen on <code>0.0.0.0</code> you're effectively telling it that it doesn't care where the traffic was originally sent and it will accept it all.</p>\n\n<pre><code>var (\n    httpFlag   = flag.String(\"http\", \"0.0.0.0:8080\", \"HTTP listen address\") // &lt;--- Here it the change. It's roughly line 25 of [main.go](https://github.com/maddyonline/gotutorial/blob/master/main.go#L25)\n    originFlag = flag.String(\"origin\", \"\", \"web socket origin for Go Playground (e.g. localhost)\")\n    baseFlag   = flag.String(\"base\", \"\", \"base path for articles and resources\")\n)\n</code></pre>\n\n<p>The second issue has to due with your import paths colliding with the predetermined directory structure of the <code>onbuild</code> Dockerfile from which you were extending. I saw that you were trying to hardcode the import path, which is not a good idea, but I think it was your only option due to the weirdness of the <code>go-wrapper</code> that was being forced onto you by the <code>onbuild</code> Dockerfile. Ultimately you should just have the docker build process stick a static Go binary in that container. That will simplify the process of actually starting up the server in the container.</p>\n\n<p>I didn't mess with your paths in your Go code, I figured you could work that out, but I did grab the upstream <code>onbuild</code> Dockerfile and customize it to what you need. BTW, if you look at the <a href=\"https://registry.hub.docker.com/_/golang/\" rel=\"nofollow\">documentation</a> for the <code>onbuild</code> Dockerfile it actually says that it's a bad idea to use that Dockerfile. ;) So, I took their advice and here is my port:</p>\n\n<pre><code>FROM golang:1.4.2\n\nRUN mkdir -p /go/src/github.com/maddyonline/gotutorial\nWORKDIR      /go/src/github.com/maddyonline/gotutorial\n\nADD . /go/src/github.com/maddyonline/gotutorial\nRUN go-wrapper download\nRUN go-wrapper install\n\nEXPOSE 8080\nCMD [\"go-wrapper\", \"run\"]\n</code></pre>\n\n<p>Your other sample server app didn't have the same issues because the import paths weren't specified in the same way they are in this project. Basically, it didn't care where it was living because its dependencies were not being hardcoded to a file path. It is using the normal Go packaging conventions.</p>\n\n<p>Sorry, it probably seems like a lot of change, but I hope it at least helps you move forward on your project. Let me know if anything doesn't make sense.</p>\n"}], "owner": {"reputation": 713, "user_id": 1846021, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/975c623c961d8fd39daaa6ab78d37065?s=128&d=identicon&r=PG", "display_name": "Madhav Jha", "link": "https://stackoverflow.com/users/1846021/madhav-jha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1538, "favorite_count": 2, "accepted_answer_id": 31300285, "answer_count": 1, "score": 4, "last_activity_date": 1436378940, "creation_date": 1436162738, "question_id": 31238712, "link": "https://stackoverflow.com/questions/31238712/docker-publish-not-working-correctly-for-golang-application", "title": "Docker publish not working correctly for golang application", "body": "<p>I am trying to run a <a href=\"https://github.com/maddyonline/gotutorial\" rel=\"nofollow\">golang web server application</a> (which tries to run a go blog powered by same tools which power <a href=\"http://blog.golang.org/\" rel=\"nofollow\">golang blog</a>) via docker. It runs fine without docker but fails to give any response if I use docker. I have no clue why this is happening as for a much simpler <a href=\"https://github.com/maddyonline/gowebapp\" rel=\"nofollow\">go web application</a>, the same docker based approach works great. See below for output of various commands I used. Any help would be greatly appreciated.</p>\n\n<pre><code>docker pull maddyonline/gotutorial\ndocker run -d --publish 8080:8080 --name gotut maddyonline/gotutorial\n</code></pre>\n\n<blockquote>\n  <p>81bc36e385286326a6d9f74322515a7b9748e493275c3426bcc6848a4589a7e7</p>\n</blockquote>\n\n<pre><code>docker ps\n</code></pre>\n\n<blockquote>\n  <p>CONTAINER ID        IMAGE                    COMMAND<br>\n  CREATED             STATUS              PORTS                    NAMES\n  81bc36e38528        maddyonline/gotutorial   \"go-wrapper run\"    20\n  seconds ago      Up 20 seconds       0.0.0.0:8080->8080/tcp   gotut</p>\n</blockquote>\n\n<pre><code>curl localhost:8080\n</code></pre>\n\n<blockquote>\n  <p>curl: (52) Empty reply from server</p>\n</blockquote>\n\n<pre><code>docker exec gotut curl localhost:8080\n</code></pre>\n\n<blockquote>\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n</code></pre>\n  \n  <p>And rest of the file</p>\n</blockquote>\n\n<p>The docker file I am using is very simple.</p>\n\n<pre><code>FROM golang:onbuild\nEXPOSE 8080\n</code></pre>\n\n<p>I experimented with the same docker file with a much simpler golang application on the same server. And it works.</p>\n\n<pre><code>docker pull maddyonline/gowebapp\ndocker run -d --publish 8080:8080 --name gowebapp maddyonline/gowebapp\ncurl localhost:8080/icecream\n</code></pre>\n\n<blockquote>\n  <p>Hi there, I think I love icecream!</p>\n</blockquote>\n"}, {"tags": ["algorithm", "go"], "comments": [{"owner": {"reputation": 2888, "user_id": 3555300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e7112ac796e7b182256ac77ab9724d2b?s=128&d=identicon&r=PG&f=1", "display_name": "Jiang YD", "link": "https://stackoverflow.com/users/3555300/jiang-yd"}, "edited": false, "score": 0, "creation_date": 1436162778, "post_id": 31238262, "comment_id": 50475396, "body": "let a Rat is z(=x/y), how about root(z) = root(x)/root(y)?"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436164943, "post_id": 31238262, "comment_id": 50476322, "body": "<a href=\"http://math.stackexchange.com/questions/263087/finding-the-cube-root-of-a-number-using-integer-arithmetic-only\" title=\"finding the cube root of a number using integer arithmetic only\">math.stackexchange.com/questions/263087/&hellip;</a>"}], "answers": [{"tags": [], "owner": {"reputation": 180675, "user_id": 1090562, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/d675b3e6225683ba6432496ec23ed806?s=128&d=identicon&r=PG", "display_name": "Salvador Dali", "link": "https://stackoverflow.com/users/1090562/salvador-dali"}, "is_accepted": false, "score": 3, "last_activity_date": 1436164035, "last_edit_date": 1495540278, "creation_date": 1436164035, "answer_id": 31238969, "question_id": 31238262, "link": "https://stackoverflow.com/questions/31238262/is-there-a-go-function-for-obtaining-the-cube-root-of-a-big-integer/31238969#31238969", "title": "Is there a Go function for obtaining the cube root of a big integer?", "body": "<p>Sadly but there is no such function in <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\">math/big</a> package. This means that you have to roll out something on your own. One of the easiest to understand and implement is the <a href=\"https://en.wikipedia.org/wiki/Newton&#39;s_method\" rel=\"nofollow noreferrer\">Newton's method</a>.</p>\n\n<p>All you need is to select some starting number <code>x_0</code> and use the recursive formula <img src=\"https://i.stack.imgur.com/nT62O.png\" alt=\"enter image description here\"></p>\n\n<hr>\n\n<p>You have to use it in the following way: Let your integer is <code>b</code>. Then your <code>x^3 = b^3</code> and your <code>f(x) = x^3 - b^3</code> and <code>f'(x) = 3 * x^2</code>.</p>\n\n<p>So you need to iterate:\n<code>x_{n+1}=x_n - \\frac{x_{n}^{3} + b^3}{3x_{n}^{2}}</code></p>\n\n<p>(<a href=\"http://latex.codecogs.com/gif.latex?x_%7Bn&plus;1%7D%3Dx_n%20-%20%5Cfrac%7Bx_%7Bn%7D%5E%7B3%7D%20&plus;%20b%5E3%7D%7B3x_%7Bn%7D%5E%7B2%7D%7D\" rel=\"nofollow noreferrer\">check this link</a> with the image of the formula, SO sucks in inserting math formulas).</p>\n\n<p>You start from a guess and ends when previous x_n is close to the next one. How close is for you to decide.</p>\n\n<p><strong>P.S.1</strong> you can look for more complicated numerical methods to find roots (you will need less iterations to converge)</p>\n\n<p><strong>P.S.2</strong> if you need, I wrote a <a href=\"https://stackoverflow.com/q/30316639/1090562\">method for calculating arbitrary precision square roots</a> in Go.</p>\n"}, {"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1532121907, "last_edit_date": 1532121907, "creation_date": 1531864389, "answer_id": 51390715, "question_id": 31238262, "link": "https://stackoverflow.com/questions/31238262/is-there-a-go-function-for-obtaining-the-cube-root-of-a-big-integer/51390715#51390715", "title": "Is there a Go function for obtaining the cube root of a big integer?", "body": "<p>I've implemented a cube root function for <code>big.Int</code>, both using a simple binary search and Newton's method as per Salvador Dali's formula. Although I am pretty sure there is room for improvement, here is the code that I've got:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>var (\n    n0  = big.NewInt(0)\n    n1  = big.NewInt(1)\n    n2  = big.NewInt(2)\n    n3  = big.NewInt(3)\n    n10 = big.NewInt(10)\n)\n\nfunc cbrtBinary(i *big.Int) (cbrt *big.Int, rem *big.Int) {\n    var (\n        guess = new(big.Int).Div(i, n2)\n        dx    = new(big.Int)\n        absDx = new(big.Int)\n        minDx = new(big.Int).Abs(i)\n        step  = new(big.Int).Abs(new(big.Int).Div(guess, n2))\n        cube  = new(big.Int)\n    )\n    for {\n        cube.Exp(guess, n3, nil)\n        dx.Sub(i, cube)\n        cmp := dx.Cmp(n0)\n        if cmp == 0 {\n            return guess, n0\n        }\n\n        absDx.Abs(dx)\n        switch absDx.Cmp(minDx) {\n        case -1:\n            minDx.Set(absDx)\n        case 0:\n            return guess, dx\n        }\n\n        switch cmp {\n        case -1:\n            guess.Sub(guess, step)\n        case +1:\n            guess.Add(guess, step)\n        }\n\n        step.Div(step, n2)\n        if step.Cmp(n0) == 0 {\n            step.Set(n1)\n        }\n    }\n}\n\nfunc cbrtNewton(i *big.Int) (cbrt *big.Int, rem *big.Int) {\n    var (\n        guess   = new(big.Int).Div(i, n2)\n        guessSq = new(big.Int)\n        dx      = new(big.Int)\n        absDx   = new(big.Int)\n        minDx   = new(big.Int).Abs(i)\n        cube    = new(big.Int)\n        fx      = new(big.Int)\n        fxp     = new(big.Int)\n        step    = new(big.Int)\n    )\n    for {\n        cube.Exp(guess, n3, nil)\n        dx.Sub(i, cube)\n        cmp := dx.Cmp(n0)\n        if cmp == 0 {\n            return guess, n0\n        }\n\n        fx.Sub(cube, i)\n        guessSq.Exp(guess, n2, nil)\n        fxp.Mul(n3, guessSq)\n        step.Div(fx, fxp)\n        if step.Cmp(n0) == 0 {\n            step.Set(n1)\n        }\n\n        absDx.Abs(dx)\n        switch absDx.Cmp(minDx) {\n        case -1:\n            minDx.Set(absDx)\n        case 0:\n            return guess, dx\n        }\n\n        guess.Sub(guess, step)\n    }\n}\n</code></pre>\n\n<p>Surprisingly enough, the simple binary algorithm is also the fastest:</p>\n\n<pre><code>BenchmarkCbrt/binary/10e6-4       100000         19195 ns/op\nBenchmarkCbrt/binary/10e12-4       30000         43634 ns/op\nBenchmarkCbrt/binary/10e18-4       20000         73334 ns/op\nBenchmarkCbrt/newton/10e6-4        30000         47027 ns/op\nBenchmarkCbrt/newton/10e12-4       10000        123612 ns/op\nBenchmarkCbrt/newton/10e18-4       10000        214884 ns/op\n</code></pre>\n\n<p>Here is the full code, including tests and benchmarks: <a href=\"https://play.golang.org/p/uoEmxRK5jgs\" rel=\"nofollow noreferrer\">https://play.golang.org/p/uoEmxRK5jgs</a>.</p>\n"}], "owner": {"reputation": 14004, "user_id": 41241, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/10e7a4afa4bebca010d372055bcb694f?s=128&d=identicon&r=PG", "display_name": "Nathaniel Flath", "link": "https://stackoverflow.com/users/41241/nathaniel-flath"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 370, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1532121907, "creation_date": 1436160240, "last_edit_date": 1436170451, "question_id": 31238262, "link": "https://stackoverflow.com/questions/31238262/is-there-a-go-function-for-obtaining-the-cube-root-of-a-big-integer", "title": "Is there a Go function for obtaining the cube root of a big integer?", "body": "<p>I have a <code>big.Int</code> variable, and wish to find the cube root of it.</p>\n\n<p>Is this implemented somewhere in the library?  The Exp function seems to only take an integer, and <code>big.Rat</code> seems to be lacking Exp entirely.</p>\n"}, {"tags": ["templates", "go", "format", "currency"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1436151557, "post_id": 31237072, "comment_id": 50472721, "body": "You&#39;ll want to create a <a href=\"http://golang.org/pkg/html/template/#Template.Funcs\" rel=\"nofollow noreferrer\">template.Func</a> that calls a formatting function. A popular library for &quot;humanizing&quot; numbers is <a href=\"https://github.com/dustin/go-humanize\" rel=\"nofollow noreferrer\">github.com/dustin/go-humanize</a> (I&#39;d love to write an example but I&#39;m pressed for time - this should get you started!)"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1436160877, "post_id": 31237072, "comment_id": 50474758, "body": "Go does not support grouping decimals. <a href=\"http://stackoverflow.com/questions/13020308/how-to-fmt-printf-an-integer-with-thousands-comma\">This question</a> is about how to do that, <a href=\"http://stackoverflow.com/a/31046325/1705598\">this answer</a> shows a really efficient solution using only the standard library."}], "answers": [{"tags": [], "owner": {"reputation": 13022, "user_id": 230340, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/3591e9adea97943ab462c84b0745e110?s=128&d=identicon&r=PG", "display_name": "Zippo", "link": "https://stackoverflow.com/users/230340/zippo"}, "is_accepted": false, "score": 1, "last_activity_date": 1436203851, "creation_date": 1436203851, "answer_id": 31252082, "question_id": 31237072, "link": "https://stackoverflow.com/questions/31237072/go-templates-currency-pipe-format/31252082#31252082", "title": "Go templates: Currency pipe format?", "body": "<p>You can leverage <code>github.com/dustin/go-humanize</code> to do this.</p>\n\n<pre><code>funcMap := template.FuncMap{\n    \"comma\": humanize.Comma,\n}\nt := template.New(\"\").Funcs(templateFuncs).Parse(`A million: {{comma .}}`)\nerr := tmpl.Execute(os.Stdout, 1000000)\nif err != nil {\n  log.Fatalf(\"execution: %s\", err)\n}\n// A million: 1,000,000\n</code></pre>\n"}], "owner": {"reputation": 1636, "user_id": 539133, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f66837101863aea91fd42192b0639c22?s=128&d=identicon&r=PG", "display_name": "Glstunna", "link": "https://stackoverflow.com/users/539133/glstunna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 437, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436203851, "creation_date": 1436150280, "question_id": 31237072, "link": "https://stackoverflow.com/questions/31237072/go-templates-currency-pipe-format", "title": "Go templates: Currency pipe format?", "body": "<p>I'm trying to represent money in a go template.\n{{.cash}}</p>\n\n<p>But right now, cash comes as 1000000</p>\n\n<p>Would it be possible to make it output 1,000,000 ?</p>\n\n<p>Is there some sort of {{.cash | Currency}} formatter?\nIf not, how do I go about getting the desired output?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["unicode", "go", "normalization", "unicode-normalization"], "answers": [{"tags": [], "owner": {"reputation": 5822, "user_id": 546218, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f6f59bf629073f1eb8cdd492d10386c4?s=128&d=identicon&r=PG", "display_name": "rocky", "link": "https://stackoverflow.com/users/546218/rocky"}, "is_accepted": true, "score": 0, "last_activity_date": 1436253249, "last_edit_date": 1436253249, "creation_date": 1436143774, "answer_id": 31236464, "question_id": 31235584, "link": "https://stackoverflow.com/questions/31235584/last-rune-of-golang-unicode-norm-iterator-not-being-read/31236464#31236464", "title": "Last rune of golang unicode/norm iterator not being read", "body": "<p>It is possible this is a bug in <code>golang.org/x/text/unicode/norm</code> and its <em>Init()</em> function. </p>\n\n<p>In the package's test and example that I see all use <em>InitString</em>. So as a workaround, if you change:</p>\n\n<pre><code> it.Init(norm.NFD, in)\n</code></pre>\n\n<p>to:</p>\n\n<pre><code> it.InitString(norm.NFD, `test`)\n</code></pre>\n\n<p>things will work as expected.</p>\n\n<p>I would suggest opening up a bug report, but beware that since this is in the \"/x\" directory that package is considered experimental by go developers. </p>\n\n<p>(BTW, I used my the <a href=\"https://github.com/rocky/ssa-interp\" rel=\"nofollow\">go debugger</a> to help me track down what's going on, but I should say its use was far the kind of debugger I'd like to see.)</p>\n"}], "owner": {"reputation": 459, "user_id": 2051586, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/928c9956c28f02addef8493fe9cae40b?s=128&d=identicon&r=PG", "display_name": "frank", "link": "https://stackoverflow.com/users/2051586/frank"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 252, "favorite_count": 0, "accepted_answer_id": 31236464, "answer_count": 1, "score": 2, "last_activity_date": 1442634719, "creation_date": 1436135146, "last_edit_date": 1442634719, "question_id": 31235584, "link": "https://stackoverflow.com/questions/31235584/last-rune-of-golang-unicode-norm-iterator-not-being-read", "title": "Last rune of golang unicode/norm iterator not being read", "body": "<p>I'm using the <code>golang.org/x/text/unicode/norm</code> package to iterate over runes in a <code>[]byte</code>. I've chosen this approach as I need to inspect each rune and maintain information about the sequence of runes. The last call to <code>iter.Next()</code> does not read the last rune. It gives 0 bytes read on the last rune.</p>\n\n<p>Here is the code:</p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"unicode/utf8\"\n\n  \"golang.org/x/text/unicode/norm\"\n)\n\nfunc main() {\n  var (\n    n   int\n    r   rune\n    it  norm.Iter\n    out []byte\n  )\n  in := []byte(`test`)\n  fmt.Printf(\"%s\\n\", in)\n  fmt.Println(in)\n  it.Init(norm.NFD, in)\n  for !it.Done() {\n    ruf := it.Next()\n    r, n = utf8.DecodeRune(ruf)\n    fmt.Printf(\"bytes read: %d. val: %q\\n\", n, r)\n    buf := make([]byte, utf8.RuneLen(r))\n    utf8.EncodeRune(buf, r)\n    out = norm.NFC.Append(out, buf...)\n  }\n  fmt.Printf(\"%s\\n\", out)\n  fmt.Println(out)\n}\n</code></pre>\n\n<p>This produces the following output:  </p>\n\n<pre><code>test\n[116 101 115 116]\nbytes read: 1. val: 't'\nbytes read: 1. val: 'e'\nbytes read: 1. val: 's'\nbytes read: 0. val: '\ufffd'\ntes\ufffd\n[116 101 115 239 191 189]\n</code></pre>\n"}, {"tags": ["templates", "go", "beego"], "answers": [{"comments": [{"owner": {"reputation": 4312, "user_id": 274811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94807cb89f41f2a6dcc48ba70b95f839?s=128&d=identicon&r=PG", "display_name": "webwurst", "link": "https://stackoverflow.com/users/274811/webwurst"}, "edited": false, "score": 63, "creation_date": 1480679012, "post_id": 31235243, "comment_id": 69073703, "body": "To access a field on an array item use <code>{{ (index .a 2).field }}</code>."}, {"owner": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "reply_to_user": {"reputation": 4312, "user_id": 274811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/94807cb89f41f2a6dcc48ba70b95f839?s=128&d=identicon&r=PG", "display_name": "webwurst", "link": "https://stackoverflow.com/users/274811/webwurst"}, "edited": false, "score": 1, "creation_date": 1517560347, "post_id": 31235243, "comment_id": 84153436, "body": "@webwurst what if field is an variable? <code>.$field</code> doesn&#39;t work"}, {"owner": {"reputation": 4560, "user_id": 8675, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/78b9c7ea09849f2ea634c6ab27865629?s=128&d=identicon&r=PG", "display_name": "Erik Forsberg", "link": "https://stackoverflow.com/users/8675/erik-forsberg"}, "reply_to_user": {"reputation": 3258, "user_id": 1085848, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/86a0ff3564f750b3ed49cfc8b57f1275?s=128&d=identicon&r=PG", "display_name": "TomSawyer", "link": "https://stackoverflow.com/users/1085848/tomsawyer"}, "edited": false, "score": 3, "creation_date": 1572269949, "post_id": 31235243, "comment_id": 103496934, "body": "@TomSawyer Wrap it in another index <code>{{\u00a0index (index .a 2) $field }}</code>"}], "tags": [], "owner": {"reputation": 52116, "user_id": 197788, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/851acbab08553d1f7aa3eecad17f6aa9?s=128&d=identicon&r=PG", "display_name": "Ken Bloom", "link": "https://stackoverflow.com/users/197788/ken-bloom"}, "is_accepted": true, "score": 122, "last_activity_date": 1436132252, "creation_date": 1436132252, "answer_id": 31235243, "question_id": 31235211, "link": "https://stackoverflow.com/questions/31235211/go-templates-how-do-i-access-array-item-arr2-in-templates/31235243#31235243", "title": "Go templates: How do I access array item (arr[2]) in templates?", "body": "<p>You need to use the <code>index</code> template function.</p>\n\n<pre><code>{{index .a 2}}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 311, "user_id": 6433161, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YEQ55.jpg?s=128&g=1", "display_name": "Sandeep Jain", "link": "https://stackoverflow.com/users/6433161/sandeep-jain"}, "is_accepted": false, "score": 4, "last_activity_date": 1610634875, "creation_date": 1610634875, "answer_id": 65720986, "question_id": 31235211, "link": "https://stackoverflow.com/questions/31235211/go-templates-how-do-i-access-array-item-arr2-in-templates/65720986#65720986", "title": "Go templates: How do I access array item (arr[2]) in templates?", "body": "<p>to access a field on an array item as go templating in *.yaml format :</p>\n<p>{{ (index .Values.fields 0).fieldItem }}</p>\n<p>Index of zero(0) as in fields array of field as fieldItem .</p>\n"}], "owner": {"reputation": 1636, "user_id": 539133, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f66837101863aea91fd42192b0639c22?s=128&d=identicon&r=PG", "display_name": "Glstunna", "link": "https://stackoverflow.com/users/539133/glstunna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 26214, "favorite_count": 10, "accepted_answer_id": 31235243, "answer_count": 2, "score": 66, "last_activity_date": 1610634875, "creation_date": 1436132024, "question_id": 31235211, "link": "https://stackoverflow.com/questions/31235211/go-templates-how-do-i-access-array-item-arr2-in-templates", "title": "Go templates: How do I access array item (arr[2]) in templates?", "body": "<p>How do I access an array item (e.g. a[2]) in templates?</p>\n\n<p>Whenever I do this I get \"bad character U+005B '['\"</p>\n\n<pre><code>{{ .a[2] }}\n</code></pre>\n"}, {"tags": ["json", "postgresql", "rest", "go", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436129300, "post_id": 31233492, "comment_id": 50468334, "body": "If you know the number of rows you want it can be more performant to <code>make([]Message, 15)</code> where 15 is the number of rows."}], "tags": [], "owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "is_accepted": false, "score": 1, "last_activity_date": 1436134051, "last_edit_date": 1436134051, "creation_date": 1436120106, "answer_id": 31233492, "question_id": 31232316, "link": "https://stackoverflow.com/questions/31232316/golang-slices-of-struct-or-newbie-trouble-building-rest/31233492#31233492", "title": "Golang slices of struct or newbie trouble building REST", "body": "<p>disclaimer: I am brand new to go</p>\n\n<p>Since you <code>Scan</code>ned your column data into your variables, you should be able to initialize a structure with their values:</p>\n\n<p><code>m := &amp;Message{ticket_id: ticket_id, event: event}</code></p>\n\n<p>You could initialize a slice with</p>\n\n<p><code>s := make([]*Message, 0)</code></p>\n\n<p>And then append each of your message structs after instantiation:</p>\n\n<p><code>s = append(s, m)</code></p>\n\n<hr>\n\n<p>Because I'm not too familiar with go there are a couple things i'm not sure about:</p>\n\n<ul>\n<li><p>after copying data from query to your vars using <code>rows.Scan</code> does initializing the <code>Message</code> struct copy the current iterations values as expected??</p></li>\n<li><p>If there is a way to get the total number of rows from your query it might be slighlty more performant to initialize a static length array, instead of a slice?</p></li>\n<li><p>I think @inf deleted answer about marshalling your <code>Message</code> to json down the line might need to be addressed, and <code>Message</code> field's might need to be capitalized</p></li>\n</ul>\n\n<p>copied from @inf:</p>\n\n<blockquote>\n  <p>The names of the members of your struct need be capitalized so that\n  they get exported and can be accessed.</p>\n\n<pre><code>type Message struct {\n    Ticket_id int    `json:\"ticket_id\"`\n    Event     string `json:\"event\"` }\n</code></pre>\n</blockquote>\n"}, {"comments": [{"owner": {"reputation": 45, "user_id": 4103549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/222c540b4b4a30886e2d50a0bf526b83?s=128&d=identicon&r=PG&f=1", "display_name": "Painhardcore", "link": "https://stackoverflow.com/users/4103549/painhardcore"}, "edited": false, "score": 0, "creation_date": 1436477347, "post_id": 31235104, "comment_id": 50643223, "body": "messages := []*Message makes &quot;syntax error: unexpected semicolon or newline, expecting {&quot; I made it with&quot;var messages []*Message&quot; But now get error when db.Select error handlind &quot;non-struct dest type struct with &gt;1 columns (2)&quot;"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 45, "user_id": 4103549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/222c540b4b4a30886e2d50a0bf526b83?s=128&d=identicon&r=PG&f=1", "display_name": "Painhardcore", "link": "https://stackoverflow.com/users/4103549/painhardcore"}, "edited": false, "score": 0, "creation_date": 1436477589, "post_id": 31235104, "comment_id": 50643334, "body": "How many items are you selecting? If it&#39;s just one you only need a <code>Message</code> \u2014 if it&#39;s more you&#39;ll need a <code>[]*Message</code>."}, {"owner": {"reputation": 45, "user_id": 4103549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/222c540b4b4a30886e2d50a0bf526b83?s=128&d=identicon&r=PG&f=1", "display_name": "Painhardcore", "link": "https://stackoverflow.com/users/4103549/painhardcore"}, "edited": false, "score": 0, "creation_date": 1436480997, "post_id": 31235104, "comment_id": 50644632, "body": "error with select was because i need to make uppercase variable like @inf said. thx a lot 4 answers"}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 0, "last_activity_date": 1436482852, "last_edit_date": 1436482852, "creation_date": 1436131264, "answer_id": 31235104, "question_id": 31232316, "link": "https://stackoverflow.com/questions/31232316/golang-slices-of-struct-or-newbie-trouble-building-rest/31235104#31235104", "title": "Golang slices of struct or newbie trouble building REST", "body": "<p>I'm going to cheat a little here and fix a few things along the way:</p>\n\n<p>First: open your database connection pool once at program start-up (and not on every request).</p>\n\n<p>Second: we'll use <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow\">sqlx</a> to make it easier to marshal our database rows into our struct.</p>\n\n<pre class=\"lang-go prettyprint-override\"><code>package main\n\nvar db *sqlx.DB\n\nfunc main() {\n    var err error\n    // sqlx.Connect also checks that the connection works.\n    // sql.Open only \"establishes\" a pool, but doesn't ping the DB.\n    db, err = sqlx.Connect(\"postgres\", \"postgres:///...\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    router := gin.Default()\n    router.GET(\"/search/:text\", SearchWord)\n    router.Run(\":8080\")\n\n}\n\n// in_another_file.go\n\ntype Message struct {\n    TicketID int    `json:\"ticket_id\" db:\"ticket_id\"`\n    Event     string `json:\"event\" db:\"event\"`\n}\n\nfunc SearchWord(c *gin.Context) {\n    word := c.Params.ByName(\"text\")\n    // We create a slice of structs to marshal our rows into\n    var messages []*Message{}\n    // Our DB connection pool is safe to use concurrently from here\n    err := db.Select(&amp;messages, \"SELECT ticket_id,event FROM ....$1, word)\n    if err != nil {\n        http.Error(c.Writer, err.Error(), 500)\n        return\n    }\n\n    // Write it out using gin-gonic's JSON writer.\n    c.JSON(200, messages)\n}\n</code></pre>\n\n<p>I hope that's clear. <code>sqlx</code> also takes care of calling <code>rows.Close()</code> for you, which will otherwise leave connections hanging.</p>\n"}], "owner": {"reputation": 45, "user_id": 4103549, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/222c540b4b4a30886e2d50a0bf526b83?s=128&d=identicon&r=PG&f=1", "display_name": "Painhardcore", "link": "https://stackoverflow.com/users/4103549/painhardcore"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1660, "favorite_count": 0, "accepted_answer_id": 31235104, "answer_count": 2, "score": 0, "last_activity_date": 1489459479, "creation_date": 1436112615, "last_edit_date": 1489459479, "question_id": 31232316, "link": "https://stackoverflow.com/questions/31232316/golang-slices-of-struct-or-newbie-trouble-building-rest", "title": "Golang slices of struct or newbie trouble building REST", "body": "<p>and need your help.\nWanted to build simple api and stuck with some problem.\nI've choose <a href=\"https://github.com/gin-gonic/gin\" rel=\"nofollow noreferrer\">gin</a> and database/sql with <a href=\"https://www.postgresql.org/\" rel=\"nofollow noreferrer\">postgres driver</a></p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"fmt\"\n\n    \"github.com/gin-gonic/gin\"\n\n    _ \"github.com/lib/pq\"\n)\n\nfunc main() {\n\n    router := gin.Default()\n    router.GET(\"/search/:text\", SearchWord)\n    router.Run(\":8080\")\n\n}\n</code></pre>\n\n<p>I need to make query to DB and make json out of this request.</p>\n\n<pre><code>func checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\ntype Message struct {\n    ticket_id int    `json:\"ticket_id\"`\n    event     string `json:\"event\"`\n}\n\nfunc SearchWord(c *gin.Context) {\n    word := c.Params.ByName(\"text\")\n    db, err := sql.Open(\"postgres\", \"host=8.8.8.8 user= password= dbname=sample\")\n    defer db.Close()\n    checkErr(err)\n    rows, err2 := db.Query(\"SELECT ticket_id,event FROM ....$1, word)\n    checkErr(err)\n    for rows.Next() {\n        var ticket_id int\n        var event string\n        err = rows.Scan(&amp;ticket_id, &amp;event)\n        checkErr(err)\n        fmt.Printf(\"%d | %s \\n\\n\", ticket_id, event)\n    }\n\n}\n</code></pre>\n\n<p>This coda working nice, but when i need to make json.\nI need to make struct of a row</p>\n\n<pre><code>type Message struct {\n    ticket_id int    `json:\"ticket_id\"`\n    event     string `json:\"event\"`\n}\n</code></pre>\n\n<p>an then i need to create slice , and append every rows.Next() loop an than answer to browser with Json...</p>\n\n<pre><code>c.JSON(200, messages)\n</code></pre>\n\n<p>But how to do that...don't know :(</p>\n"}, {"tags": ["multithreading", "go", "event-handling", "worker"], "comments": [{"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 1, "creation_date": 1436113445, "post_id": 31232209, "comment_id": 50463530, "body": "No, this sounds like the perfect usecase for go."}, {"owner": {"reputation": 1340, "user_id": 1751451, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16a6f6308f507ee56ca6a845a192f13e?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1751451/adrian"}, "reply_to_user": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1436116283, "post_id": 31232209, "comment_id": 50464451, "body": "Thank you, @inf . would you suggest using emission or is there a different way to raise events?"}, {"owner": {"reputation": 30739, "user_id": 1804599, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/v91P3.jpg?s=128&g=1", "display_name": "rightfold", "link": "https://stackoverflow.com/users/1804599/rightfold"}, "edited": false, "score": 3, "creation_date": 1436117289, "post_id": 31232209, "comment_id": 50464721, "body": "Spawn goroutines and send events over channels."}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 1, "creation_date": 1436120446, "post_id": 31232209, "comment_id": 50465720, "body": "<a href=\"https://gobyexample.com/worker-pools\" rel=\"nofollow noreferrer\">gobyexample.com/worker-pools</a>"}, {"owner": {"reputation": 50179, "user_id": 594589, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/0f9d5953607841d6a50b843a1107e51e?s=128&d=identicon&r=PG", "display_name": "dm03514", "link": "https://stackoverflow.com/users/594589/dm03514"}, "edited": false, "score": 1, "creation_date": 1436121029, "post_id": 31232209, "comment_id": 50465880, "body": "<a href=\"http://nesv.github.io/golang/2014/02/25/worker-queues-in-go.html\" rel=\"nofollow noreferrer\">nesv.github.io/golang/2014/02/25/worker-queues-in-go.html</a>"}, {"owner": {"reputation": 1340, "user_id": 1751451, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16a6f6308f507ee56ca6a845a192f13e?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1751451/adrian"}, "edited": false, "score": 0, "creation_date": 1436123154, "post_id": 31232209, "comment_id": 50466528, "body": "One of you guys wants to add this as an answer? :D"}], "answers": [{"comments": [{"owner": {"reputation": 1340, "user_id": 1751451, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16a6f6308f507ee56ca6a845a192f13e?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1751451/adrian"}, "edited": false, "score": 0, "creation_date": 1436567875, "post_id": 31349948, "comment_id": 50685713, "body": "You&#39;re right about channels not being straightforward. I had issue with the blocking for long running process initially &amp; then noticed I needed to do it in loops. It finally clicked."}], "tags": [], "owner": {"reputation": 96, "user_id": 2093404, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c9c01450f25df29c12ffede3a44e3ac2?s=128&d=identicon&r=PG", "display_name": "Luis", "link": "https://stackoverflow.com/users/2093404/luis"}, "is_accepted": true, "score": 1, "last_activity_date": 1436560974, "creation_date": 1436560974, "answer_id": 31349948, "question_id": 31232209, "link": "https://stackoverflow.com/questions/31232209/possible-recommended-to-write-event-driven-app-in-go/31349948#31349948", "title": "Possible / Recommended to write event driven app in Go?", "body": "<p>I had not seen Emission library before which could work very neatly to send different messages to your workers. This could also be achieved by using channels which would be a more flexible implementation but also more cumbersome if you do not know the language.</p>\n\n<p>I would certainly read on channels but be very careful as broadcasting through channels is not straightforward. Take a look at this example (<a href=\"https://rogpeppe.wordpress.com/2009/12/01/concurrent-idioms-1-broadcasting-values-in-go-with-linked-channels/\" rel=\"nofollow\">https://rogpeppe.wordpress.com/2009/12/01/concurrent-idioms-1-broadcasting-values-in-go-with-linked-channels/</a>)</p>\n\n<p>Overall I would take a look at Tunny (<a href=\"https://github.com/Jeffail/tunny\" rel=\"nofollow\">https://github.com/Jeffail/tunny</a>) to manage workers it already has most of the implementation done for you.</p>\n"}, {"comments": [{"owner": {"reputation": 1340, "user_id": 1751451, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16a6f6308f507ee56ca6a845a192f13e?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1751451/adrian"}, "edited": false, "score": 0, "creation_date": 1436830989, "post_id": 31391877, "comment_id": 50766672, "body": "eventually the app will manage more than just RabbitMQ workers &amp; the workers need to be language agnostic. This app is work &amp; we don&#39;t have many programmers that can write go."}, {"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "reply_to_user": {"reputation": 1340, "user_id": 1751451, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16a6f6308f507ee56ca6a845a192f13e?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1751451/adrian"}, "edited": false, "score": 0, "creation_date": 1436868065, "post_id": 31391877, "comment_id": 50780885, "body": "Fair enough - Go is easy to learn but it&#39;s unreasonable and risky to demand that colleagues learn quickly on the job."}], "tags": [], "owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "is_accepted": false, "score": 0, "last_activity_date": 1436815953, "creation_date": 1436815953, "answer_id": 31391877, "question_id": 31232209, "link": "https://stackoverflow.com/questions/31232209/possible-recommended-to-write-event-driven-app-in-go/31391877#31391877", "title": "Possible / Recommended to write event driven app in Go?", "body": "<p>Go is a very good language for i/o intensive apps, particularly if they involve messaging. However, your use case appears to concern <em>managing</em> RabbitMQ rather than <em>messaging</em>. For this purpose, Go has rather less that makes it stand out in its favour.</p>\n\n<p>You might want to stand back and consider the system as a whole. How much of it needs to use RabbitMQ? If that is an open question, you might find that the lightweight goroutines and channels are a useful tool. Just maybe, you can implement parts of your system that use MQ directly in a Go program. But if you try this, remember that the fundamental CSP model is of <em>synchronous / blocking message passing</em>, quite different from the MQ model. Buffering, queueing, asynchronous operations etc are layered on top of this primitive behaviour.</p>\n\n<p>If your intention really is just managing RabbitMQ, maybe take a look at the <a href=\"https://github.com/smallfish/rabbitmq-http\" rel=\"nofollow\">rabbitmq-http</a> project to help you make up your mind.</p>\n"}], "owner": {"reputation": 1340, "user_id": 1751451, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/16a6f6308f507ee56ca6a845a192f13e?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/1751451/adrian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 510, "favorite_count": 0, "accepted_answer_id": 31349948, "answer_count": 2, "score": 2, "last_activity_date": 1436815953, "creation_date": 1436111873, "question_id": 31232209, "link": "https://stackoverflow.com/questions/31232209/possible-recommended-to-write-event-driven-app-in-go", "title": "Possible / Recommended to write event driven app in Go?", "body": "<p>I am designing an app to manage RabbitMQ workers given certain rules. For example:</p>\n\n<ul>\n<li>Maintain a minimum number of workers</li>\n<li>Spawn up to N max number of workers if queue grows beyond M tasks</li>\n<li>Kill workers older than X minutes</li>\n</ul>\n\n<p>I originally thought of writing it in Go because it is compiled &amp; I could simply compile the app to the target OS &amp; daemonize it. However, my concept design involves having a loop that gathers data every Y seconds &amp; passes it through a decision engine. The engine would then raise events that would be listened to by other goroutines to either spawn or kill workers.</p>\n\n<p>I've found the <a href=\"https://github.com/chuckpreslar/emission\" rel=\"nofollow\">Emission</a> library which would acommodate this, but I read a comment somewhere that it might not be thread safe. Honestly, my knowledge of Go &amp; threaded programming are not sufficient to properly evaluate if this library would accomplish what I need or if this is even possible in Go.</p>\n\n<p>I could write this very quickly in NodeJS and even get it compiled using <a href=\"https://github.com/crcn/nexe\" rel=\"nofollow\">nexe</a>. However, I wanted to learn a new language, I liked the targeted compilation in Go, and that it can be multi-threaded beyond the goroutines themselves.</p>\n\n<p>Is this possible or am I trying to shoehorn something into Go that it wasn't designed to do? Would it be better to accomplish the same goals differently or to just use a different language all together?</p>\n"}, {"tags": ["json", "rest", "go"], "answers": [{"tags": [], "owner": {"reputation": 5356, "user_id": 1885921, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/02ba513b62ef9f2f7798b9bac1ccf822?s=128&d=identicon&r=PG", "display_name": "vodolaz095", "link": "https://stackoverflow.com/users/1885921/vodolaz095"}, "is_accepted": true, "score": 0, "last_activity_date": 1436104119, "last_edit_date": 1436104119, "creation_date": 1436102881, "answer_id": 31230842, "question_id": 31230756, "link": "https://stackoverflow.com/questions/31230756/golang-json-from-url-as-map/31230842#31230842", "title": "Golang: Json from URL as map", "body": "<p>Why not to parse it into map[string]string as this code have to do</p>\n\n<pre><code>var d map[string]interface{}\ndata, err := json.Unmarshal(apiResponse, &amp;d)\n</code></pre>\n\n<p>You can traverse data in this struct too.</p>\n\n<p>If you suspect, that api response can be not singular object, but the collection of objects, the <code>interface{}</code> also works for arrays.</p>\n"}, {"tags": [], "owner": {"reputation": 75620, "user_id": 23643, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/Efp8C.jpg?s=128&g=1", "display_name": "Alex B", "link": "https://stackoverflow.com/users/23643/alex-b"}, "is_accepted": false, "score": 0, "last_activity_date": 1436106167, "creation_date": 1436106167, "answer_id": 31231332, "question_id": 31230756, "link": "https://stackoverflow.com/questions/31230756/golang-json-from-url-as-map/31231332#31231332", "title": "Golang: Json from URL as map", "body": "<p>If you don't know what's coming in a message, you can have several situations.</p>\n\n<h1>Message contents that depend on type</h1>\n\n<p>Type is usually indicated by some type field. In this case you can use a \"union\" struct that contains fields from all types:</p>\n\n<pre><code>type Foo struct {\n    A int\n    B string\n}\n\ntype Bar struct {\n    C int\n    D string\n}\n\ntype Message struct {\n    Type string\n    Foo\n    Bar\n}\n\n// or this, if you have common fields\n\ntype Message struct {\n    Type string\n    A int\n    B string\n    C int\n    D string\n}\n</code></pre>\n\n<p>Unmarshal the message into the union struct, dispatch on type, and select the sub-struct.</p>\n\n<pre><code>var m Message\njson.Unmarshal(data, &amp;m)\nswitch m.Type {\n    case \"foo\":\n        ...\n    case \"bar\":\n        ...\n}\n</code></pre>\n\n<h1>Completely dynamic messages</h1>\n\n<p>In this case you have a collection of unrelated key-values and process  them individually.</p>\n\n<p>Parse into a <code>map[string]interface{}</code>. The downside, of course, is that you have to cast each value and check its type dynamically. <strong>Caveat:</strong> <code>map[string]interface{}</code> will convert all numbers to floats, even integers, so you have cast them to <code>float64</code>.</p>\n\n<p>You can also use <code>map[string]json.RawMessage</code>, if you do not want to parse values, only keys (<code>json.RawMessage</code> is a <code>[]byte</code>, and is preserved as is when unmarshaled).</p>\n\n<h1>\"Envelope\" message with dynamic payload</h1>\n\n<p>For example:</p>\n\n<pre><code>{\n    \"type\": \"foo\",\n    \"payload\": {\n        \"key1\": \"value1\"\n    }\n}\n\n{\n    \"type\": \"bar\",\n    \"payload\": {\n        \"key2\": \"value2\",\n        \"key3\": [1, 2]\n    }\n}\n</code></pre>\n\n<p>Use a struct with <code>json.RawMessage</code>.</p>\n\n<pre><code>type Message struct {\n    Type string\n    Payload json.RawMessage\n}\n\ntype Foo struct {\n    Key1 string\n}\n\ntype Bar struct {\n    Key2 string\n    Key3 []int\n}\n</code></pre>\n\n<p>Parse the envelope (payload will be preserved), then dispatch on type, and parse payload into a sub-struct.</p>\n\n<pre><code>var m Message\n_ = json.Unmarshal(data, &amp;m)\nswitch m.Type {\n    case \"foo\":\n        var payload Foo\n        _ = json.Unmarshal(m.Payload, &amp;payload)\n        // do stuff\n    case \"bar\":\n        var payload Bar\n        _ = json.Unmarshal(m.Payload, &amp;payload)\n        // do stuff\n}\n</code></pre>\n"}], "owner": {"reputation": 1636, "user_id": 539133, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/f66837101863aea91fd42192b0639c22?s=128&d=identicon&r=PG", "display_name": "Glstunna", "link": "https://stackoverflow.com/users/539133/glstunna"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 736, "favorite_count": 2, "accepted_answer_id": 31230842, "answer_count": 2, "score": 2, "last_activity_date": 1436106167, "creation_date": 1436102291, "question_id": 31230756, "link": "https://stackoverflow.com/questions/31230756/golang-json-from-url-as-map", "title": "Golang: Json from URL as map", "body": "<p>What is the best way to extract json from a url i.e. Rest service from Go?\nAlso it seems most rest client libraries in go force a use of the json.marshall which needs a struct to be used with it.</p>\n\n<p>This doesn't work in the case of unstructured data where you don't fully know what will be coming in.  Is there a way to have it all simply come in as a map[string:string]?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1436248805, "post_id": 31228093, "comment_id": 50517303, "body": "@ OneOfOne: I want to pass the interface as reference and let the method initialize it."}, {"owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "reply_to_user": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1436263105, "post_id": 31228093, "comment_id": 50525596, "body": "please give an advice instead of voting down, I need to pass an interface by reference and let the method fill it by an instance of a type which implements the passed interface."}], "answers": [{"tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": false, "score": 3, "last_activity_date": 1436316185, "last_edit_date": 1436316185, "creation_date": 1436265692, "answer_id": 31266331, "question_id": 31228093, "link": "https://stackoverflow.com/questions/31228093/set-the-interface-value-passed-to-the-function-in-go/31266331#31266331", "title": "Set the interface value passed to the function in go", "body": "<p>Go doesn't have the concept of transparent reference arguments as found in languages like C++, so what you are asking is not possible:  Your <code>Get</code> function receives a copy of the interface variable, so won't be updating variable in the calling scope.</p>\n\n<p>If you do want a function to be able to update something passed as an argument, then it must be passed as a pointer (i.e. called as <code>Get(\"title\", &amp;i)</code>).  There is no syntax to specify that an argument should be a pointer to an arbitrary type, but all pointers can be stored in an <code>interface{}</code> so that type can be used for the argument.  You can then use a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow\">type assertion</a> / <a href=\"https://golang.org/ref/spec#Type_switches\" rel=\"nofollow\">switch</a> or the <a href=\"http://golang.org/pkg/reflect/\" rel=\"nofollow\"><code>reflect</code> package</a> to determine what sort of type you've been given.  You'll need to rely on a runtime error or panic to catch bad types for the argument.</p>\n\n<p>For example:</p>\n\n<pre><code>func Get(title string, out interface{}) {\n    ...\n    switch p := out.(type) {\n    case *int:\n        *p = 42\n    case *string:\n        *p = \"Hello world\"\n    ...\n    default:\n        panic(\"Unexpected type\")\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 868, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1436316185, "creation_date": 1436081216, "last_edit_date": 1436263570, "question_id": 31228093, "link": "https://stackoverflow.com/questions/31228093/set-the-interface-value-passed-to-the-function-in-go", "title": "Set the interface value passed to the function in go", "body": "<p>I want to change</p>\n\n<pre><code>Get(title string )(out interface{})\n</code></pre>\n\n<p>to something like :</p>\n\n<pre><code>Get(title string,out interface{})\n</code></pre>\n\n<p>So that I can passing the interface by reference and let the method fill it for me like :</p>\n\n<pre><code>var i CustomInterface\nGet(\"title\" , CustomInterface)\ni.SomeOperationWithoutTypeAssertion() //the i is nil here(my problem)\n\nfunc Get(title string,typ interface{}){\n     ...\n     typ=new(ATypeWhichImplementsTheUnderlyingInterface)\n}\n</code></pre>\n\n<p>but the <code>i.SomeOperationWithoutTypeAssertion()</code> doesn't work because the i is nil after calling the <code>Get(\"title\" , CustomInterface)</code></p>\n"}, {"tags": ["ssl", "encryption", "go"], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 8, "last_activity_date": 1436098115, "last_edit_date": 1436098115, "creation_date": 1436071574, "answer_id": 31227225, "question_id": 31226131, "link": "https://stackoverflow.com/questions/31226131/how-to-set-tls-cipher-for-go-server/31227225#31227225", "title": "How to set TLS cipher for Go server?", "body": "<p>You can see an example in <a href=\"https://github.com/rollbackup/secrpc/blob/d39882fcd2a6cd32ad6874725084f256e35251ec/tls_server.go\" rel=\"noreferrer\"><code>secrpc/tls_server.go</code></a>:</p>\n\n<pre><code>tls.Listen(\"tcp\", addr, &amp;tls.Config{\n    Certificates: []tls.Certificate{cert},\n    CipherSuites: []uint16{\n        tls.TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256,\n        tls.TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256,\n    },\n    MinVersion:               tls.VersionTLS12,\n    PreferServerCipherSuites: true,\n})\n</code></pre>\n\n<p>See also <a href=\"https://github.com/golang/go/issues/11047\" rel=\"noreferrer\">go/issues/11047</a> for an example using ListenAndServeTLS: once you have defined your <code>Config</code>, you define your server:</p>\n\n<pre><code>server := &amp;http.Server{Addr: \":4000\", Handler: nil, TLSConfig: config}\nserver.ListenAndServeTLS(tlsPublicKey, tlsPrivateKey)\n</code></pre>\n"}], "owner": {"reputation": 2549, "user_id": 181509, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/bc38deaf59377e15ec390fa1c7903393?s=128&d=identicon&r=PG", "display_name": "EmpireJones", "link": "https://stackoverflow.com/users/181509/empirejones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3247, "favorite_count": 3, "accepted_answer_id": 31227225, "answer_count": 1, "score": 4, "last_activity_date": 1436098115, "creation_date": 1436054909, "last_edit_date": 1436056096, "question_id": 31226131, "link": "https://stackoverflow.com/questions/31226131/how-to-set-tls-cipher-for-go-server", "title": "How to set TLS cipher for Go server?", "body": "<p>I'm currently using the following listen and serve command to run a secure websocket/file server:</p>\n\n<p><code>http.ListenAndServeTLS(\":443\", \"site.crt\",\"site.key\", router)</code></p>\n\n<p>However, I want to set the cipher to TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256 and also set a min SSL/TLS version.</p>\n\n<p>How can I do this?</p>\n\n<p>I think I need to use this <a href=\"https://golang.org/src/crypto/tls/common.go?s=8340:12616#L233\" rel=\"nofollow\">Config</a> structure somehow, but I'm not sure how to do this. </p>\n"}, {"tags": ["linux", "go"], "comments": [{"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "edited": false, "score": 0, "creation_date": 1436066030, "post_id": 31225883, "comment_id": 50453340, "body": "Check <a href=\"https://github.com/boombuler/hid\" rel=\"nofollow noreferrer\">github.com/boombuler/hid</a> (I haven&#39;t personally tried it)"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "edited": false, "score": 0, "creation_date": 1436072664, "post_id": 31225883, "comment_id": 50454114, "body": "If it is acts as a HID keyboard, then can&#39;t you just read the input the same as you would for any other keyboard events coming in over stdin?"}, {"owner": {"reputation": 295, "user_id": 3602897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9338050fb1efc0b82becfb9acdd7df86?s=128&d=identicon&r=PG&f=1", "display_name": "virus.cmd", "link": "https://stackoverflow.com/users/3602897/virus-cmd"}, "edited": false, "score": 0, "creation_date": 1436111386, "post_id": 31225883, "comment_id": 50462843, "body": "The server won&#39;t be logged in, so stdin is not an option. The end goal is to scan a barcodewithout being logged in and send the information over udp."}], "answers": [{"tags": [], "owner": {"reputation": 295, "user_id": 3602897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9338050fb1efc0b82becfb9acdd7df86?s=128&d=identicon&r=PG&f=1", "display_name": "virus.cmd", "link": "https://stackoverflow.com/users/3602897/virus-cmd"}, "is_accepted": true, "score": 0, "last_activity_date": 1437766971, "creation_date": 1437766971, "answer_id": 31618592, "question_id": 31225883, "link": "https://stackoverflow.com/questions/31225883/hook-linux-keyboard-events/31618592#31618592", "title": "Hook Linux Keyboard Events", "body": "<p>The answer was just to read the raw event and parse it.</p>\n"}], "owner": {"reputation": 295, "user_id": 3602897, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9338050fb1efc0b82becfb9acdd7df86?s=128&d=identicon&r=PG&f=1", "display_name": "virus.cmd", "link": "https://stackoverflow.com/users/3602897/virus-cmd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 122, "favorite_count": 0, "accepted_answer_id": 31618592, "answer_count": 1, "score": 0, "last_activity_date": 1505163861, "creation_date": 1436052091, "last_edit_date": 1505163861, "question_id": 31225883, "link": "https://stackoverflow.com/questions/31225883/hook-linux-keyboard-events", "title": "Hook Linux Keyboard Events", "body": "<p>This past week at my work we aquired a laser barcode scanner, and are looking to use it with ubuntu server. The scanner acts as a HID, so we need to hook the keystrokes it generates. We are hoping to use GO to do so.</p>\n\n<p>Any help would be greatly appreciated.</p>\n"}, {"tags": ["go", "template-engine"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1436034024, "post_id": 31221849, "comment_id": 50447533, "body": "So what is your question?"}], "answers": [{"tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": true, "score": 1, "last_activity_date": 1436073991, "last_edit_date": 1436073991, "creation_date": 1436073669, "answer_id": 31227382, "question_id": 31221849, "link": "https://stackoverflow.com/questions/31221849/text-template-cant-call-method-function-with-0-results/31227382#31227382", "title": "Text/template: &quot;can&#39;t call method/function with 0 results.&quot;", "body": "<p>Templates in Go are not like those in other languages (e.g. PHP).  Use <code>template.FuncMap</code> to create custom functions for your templates. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/url\"\n    \"os\"\n    \"text/template\"\n)\n\nfunc main() {\n    funcMap := template.FuncMap{\n        \"delete\": deleteMap,\n    }\n\n    u, err := url.Parse(\"http://example.com/test?param1=true&amp;param2=true\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    u = deleteMap(u, \"param1\") // works in regular code and templates\n\n    fmt.Println(u.RawQuery)\n\n    const tmpl = `\n    {{$m := delete . \"param2\"}} &lt;!-- WORKS! --&gt;\n    {{$m.RawQuery}}\n    `\n    t := template.New(\"\").Funcs(funcMap)\n    t = template.Must(t.Parse(tmpl))\n\n    err = t.Execute(os.Stdout, u)\n\n    if err != nil {\n        log.Println(\"executing template:\", err)\n    }\n\n}\n\nfunc deleteMap(u *url.URL, key string) *url.URL {\n    m := u.Query()\n    m.Del(key) // key successful deleted!\n    u.RawQuery = m.Encode()\n    return u\n}\n</code></pre>\n\n<p>Or, try the <a href=\"http://play.golang.org/p/VxtuqdCM_l\" rel=\"nofollow\">playground version</a>.</p>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 818, "favorite_count": 0, "accepted_answer_id": 31227382, "answer_count": 1, "score": 1, "last_activity_date": 1436084346, "creation_date": 1436020745, "last_edit_date": 1436084346, "question_id": 31221849, "link": "https://stackoverflow.com/questions/31221849/text-template-cant-call-method-function-with-0-results", "title": "Text/template: &quot;can&#39;t call method/function with 0 results.&quot;", "body": "<p>How can I execute function in templates that returns no value? Here is example:</p>\n\n<pre><code>func main() {\n    u, err := url.Parse(\"http://example.com/test?param1=true&amp;param2=true\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    m := u.Query()\n    m.Del(\"param1\") // param1 successful deleted!\n    u.RawQuery = m.Encode()\n    fmt.Println(u.RawQuery)\n\n    const tmpl = `\n    {{$m := .Query}}\n    {{$m.Del \"param2\"}} &lt;!-- failed to delete param2! --&gt;\n    {{.RawQuery}}\n    `\n    t := template.Must(template.New(\"\").Parse(tmpl))\n    err = t.Execute(os.Stdout, u)\n    if err != nil {\n        log.Println(\"executing template:\", err)\n    }\n\n}\n</code></pre>\n\n<a href=\"http://play.golang.org/p/tJbaKZbOkt\" rel=\"nofollow\">see this code in play.golang.org</a>\n\n<p><br>\nI know that in templates shouldn't be much logic, but ignorance of running function that returns no value seems to me interesting issue.</p>\n"}, {"tags": ["arrays", "string", "go", "byte"], "comments": [{"owner": {"reputation": 10650, "user_id": 847869, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Uk4Ey.jpg?s=128&g=1", "display_name": "tomasz", "link": "https://stackoverflow.com/users/847869/tomasz"}, "edited": false, "score": 3, "creation_date": 1436014476, "post_id": 31220421, "comment_id": 50441675, "body": "<a href=\"http://golang.org/pkg/strconv/#Itoa\" rel=\"nofollow noreferrer\">golang.org/pkg/strconv/#Itoa</a>"}], "answers": [{"tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": false, "score": 7, "last_activity_date": 1436015053, "creation_date": 1436015053, "answer_id": 31220955, "question_id": 31220421, "link": "https://stackoverflow.com/questions/31220421/convert-a-byte-to-a-string-in-go/31220955#31220955", "title": "Convert a byte to a string in Go", "body": "<p>If you are not bound to the exact representation then you can use <code>fmt.Sprint</code>:</p>\n\n<pre><code>fmt.Sprint(bytes) // [1 2 3 4]\n</code></pre>\n\n<p>On the other side if you want your exact comma style then you have to build it yourself using a loop together with <code>strconv.Itoa</code>.</p>\n"}, {"tags": [], "owner": {"reputation": 62894, "user_id": 1114486, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3b0513d720af96f4496f4b869fe9579a?s=128&d=identicon&r=PG", "display_name": "Didier Spezia", "link": "https://stackoverflow.com/users/1114486/didier-spezia"}, "is_accepted": true, "score": 12, "last_activity_date": 1436015445, "creation_date": 1436015445, "answer_id": 31221013, "question_id": 31220421, "link": "https://stackoverflow.com/questions/31220421/convert-a-byte-to-a-string-in-go/31221013#31221013", "title": "Convert a byte to a string in Go", "body": "<p>Not the most efficient way to implement it, but you can simply write:</p>\n\n<pre><code>func convert( b []byte ) string {\n    s := make([]string,len(b))\n    for i := range b {\n        s[i] = strconv.Itoa(int(b[i]))\n    }\n    return strings.Join(s,\",\")\n}\n</code></pre>\n\n<p>to be called by:</p>\n\n<pre><code>bytes := [4]byte{1,2,3,4}\nstr := convert(bytes[:])\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2983, "user_id": 875138, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ca8ece04c788b78293e646ce5c4feb79?s=128&d=identicon&r=PG", "display_name": "Dan Garland", "link": "https://stackoverflow.com/users/875138/dan-garland"}, "is_accepted": false, "score": 5, "last_activity_date": 1525949685, "creation_date": 1525949685, "answer_id": 50271276, "question_id": 31220421, "link": "https://stackoverflow.com/questions/31220421/convert-a-byte-to-a-string-in-go/50271276#50271276", "title": "Convert a byte to a string in Go", "body": "<p>Similar to inf's suggestion but allowing for commas:</p>\n\n<p><code>fmt.Sprintf(\"%d,%d,%d,%d\", bytes[0], bytes[1], bytes[2], bytes[3])</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 10186336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/JNI6x.jpg?s=128&g=1", "display_name": "BlockedMan", "link": "https://stackoverflow.com/users/10186336/blockedman"}, "is_accepted": false, "score": -1, "last_activity_date": 1542615712, "last_edit_date": 1542615712, "creation_date": 1542610250, "answer_id": 53369626, "question_id": 31220421, "link": "https://stackoverflow.com/questions/31220421/convert-a-byte-to-a-string-in-go/53369626#53369626", "title": "Convert a byte to a string in Go", "body": "<p><code>hex.EncodeToString(input)</code> may work for you.</p>\n"}, {"tags": [], "owner": {"reputation": 628, "user_id": 2970582, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/0i4u3.jpg?s=128&g=1", "display_name": "Sathish", "link": "https://stackoverflow.com/users/2970582/sathish"}, "is_accepted": false, "score": 0, "last_activity_date": 1595016684, "creation_date": 1595016684, "answer_id": 62961147, "question_id": 31220421, "link": "https://stackoverflow.com/questions/31220421/convert-a-byte-to-a-string-in-go/62961147#62961147", "title": "Convert a byte to a string in Go", "body": "<p>using <code>strings.Builder</code> would be the most efficient way to do the same..</p>\n<pre><code>package main\n\nimport (\n  &quot;fmt&quot;\n  &quot;strings&quot;\n)\n\nfunc convert( bytes []byte) string {\n    var str strings.Builder\n    for _, b := range bytes {\n       fmt.Fprintf(&amp;str, &quot;%d,&quot;, int(b))\n    }\n    return str.String()[:str.Len() - 1]\n}\n\nfunc main(){\n    s := [4]byte{1,2,3,4}\n    fmt.Println(convert(s[:]))\n}\n</code></pre>\n<p>=&gt; <code>1,2,3,4</code></p>\n"}], "owner": {"reputation": 1281, "user_id": 615576, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/7776c58ea658279aacf53bffda62f1e6?s=128&d=identicon&r=PG", "display_name": "ZHAO Xudong", "link": "https://stackoverflow.com/users/615576/zhao-xudong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24719, "favorite_count": 4, "accepted_answer_id": 31221013, "answer_count": 5, "score": 8, "last_activity_date": 1602525072, "creation_date": 1436011484, "last_edit_date": 1602525072, "question_id": 31220421, "link": "https://stackoverflow.com/questions/31220421/convert-a-byte-to-a-string-in-go", "title": "Convert a byte to a string in Go", "body": "<p>I am trying to do something like this:</p>\n<pre><code>bytes := [4]byte{1,2,3,4}\nstr := convert(bytes)\n\n//str == &quot;1,2,3,4&quot;\n</code></pre>\n<p>I searched a lot and really have no idea how to do this.</p>\n<p>I know this will not work:</p>\n<pre><code>str = string(bytes[:])\n</code></pre>\n"}, {"tags": ["go", "package", "names"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1436003029, "post_id": 31218501, "comment_id": 50438659, "body": "Here&#39;s some additional tips about naming and writing Go packages: <a href=\"http://dave.cheney.net/2014/12/01/five-suggestions-for-setting-up-a-go-project\" rel=\"nofollow noreferrer\">dave.cheney.net/2014/12/01/&hellip;</a>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1436003360, "post_id": 31218501, "comment_id": 50438750, "body": "@elithrar good article. I have included your comment in the answer for more visibility."}, {"owner": {"reputation": 1124, "user_id": 1263312, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/698a447f866ea18b3b0c45cb7b0bf780?s=128&d=identicon&r=PG", "display_name": "PickBoy", "link": "https://stackoverflow.com/users/1263312/pickboy"}, "edited": false, "score": 0, "creation_date": 1491988103, "post_id": 31218501, "comment_id": 73791874, "body": "@VonC What if we have to use multi-word names for packages? Mixed caps or underscore are not recommended in the blog."}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 1124, "user_id": 1263312, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/698a447f866ea18b3b0c45cb7b0bf780?s=128&d=identicon&r=PG", "display_name": "PickBoy", "link": "https://stackoverflow.com/users/1263312/pickboy"}, "edited": false, "score": 0, "creation_date": 1491997544, "post_id": 31218501, "comment_id": 73798987, "body": "@PickBoy True. I try to avoid those names, and re-read <a href=\"https://hackernoon.com/software-complexity-naming-6e02e7e6c8cb\" rel=\"nofollow noreferrer\">hackernoon.com/software-complexity-naming-6e02e7e6c8cb</a>"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 9, "last_activity_date": 1436003331, "last_edit_date": 1495542336, "creation_date": 1435997514, "answer_id": 31218501, "question_id": 31218423, "link": "https://stackoverflow.com/questions/31218423/go-library-package-names/31218501#31218501", "title": "Go library package names", "body": "<p>The reference on that naming topic is \"<a href=\"https://blog.golang.org/package-names\" rel=\"nofollow noreferrer\">blog: Package names</a>\"</p>\n\n<p>It includes:</p>\n\n<blockquote>\n  <p><strong>Avoid unnecessary package name collisions</strong>.<br>\n  While packages in different directories may have the same name, packages that are frequently used together should have distinct names. This reduces confusion and the need for local renaming in client code. For the same reason, avoid using the same name as popular standard packages like io or http. </p>\n</blockquote>\n\n<p>Check also your <a href=\"https://github.com/golang/go/wiki/PackagePublishing\" rel=\"nofollow noreferrer\">package publishing practice</a>, as it will help disambiguate your \"<code>text</code>\" package from others.</p>\n\n<p>As illustrated in \"<a href=\"https://www.golang-book.com/books/intro/11\" rel=\"nofollow noreferrer\">An Introduction to Programming in Go / Packages</a>\":</p>\n\n<blockquote>\n  <p><code>math</code> is the name of a package that is part of Go's standard distribution, but since Go packages can be hierarchical we are safe to use the same name for our package. (The real math package is just math, ours is <code>golang-book/chapter11/math</code>)</p>\n  \n  <p>When we import our <code>math</code> library we use its full name (<code>import \"golang-book/chapter11/math\"</code>), but inside of the <code>math.go</code> file we only use the last part of the name (<code>package math</code>).</p>\n  \n  <p>We also only use the short name math when we reference functions from our library. If we wanted to use both libraries in the same program Go allows us to use an alias:</p>\n</blockquote>\n\n<pre><code>import m \"golang-book/chapter11/math\"\n\nfunc main() {\n  xs := []float64{1,2,3,4}\n  avg := m.Average(xs)\n  fmt.Println(avg)\n}\n</code></pre>\n\n<blockquote>\n  <p><code>m</code> is the alias.</p>\n</blockquote>\n\n<hr>\n\n<p>As <a href=\"https://stackoverflow.com/questions/31218423/go-library-package-names/31218501?noredirect=1#comment50438659_31218501\">mentioned in the comments</a> by <a href=\"https://stackoverflow.com/users/556573/elithrar\">elithrar</a>, <a href=\"http://dave.cheney.net/about\" rel=\"nofollow noreferrer\">Dave Cheney</a> has some <a href=\"http://dave.cheney.net/2014/12/01/five-suggestions-for-setting-up-a-go-project\" rel=\"nofollow noreferrer\">additional tips</a>:</p>\n\n<blockquote>\n  <p>In other languages it is quite common to ensure your package has a unique namespace by prefixing it with your company name, say <code>com.sun.misc.Unsafe</code>.<br>\n  If everyone only writes packages corresponding to domains that they control, then there is little possibility of a collision.</p>\n  \n  <p>In Go, the convention is to include the location of the source code in the package\u2019s import path, ie</p>\n</blockquote>\n\n<pre><code>$GOPATH/src/github.com/golang/glog\n</code></pre>\n\n<blockquote>\n  <p>This is not required by the language, it is just a <a href=\"https://golang.org/cmd/go/#hdr-Download_and_install_packages_and_dependencies\" rel=\"nofollow noreferrer\">feature of <code>go get</code></a>.</p>\n</blockquote>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1305056"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 15783, "favorite_count": 2, "accepted_answer_id": 31218501, "answer_count": 1, "score": 10, "last_activity_date": 1436003331, "creation_date": 1435996989, "last_edit_date": 1435997546, "question_id": 31218423, "link": "https://stackoverflow.com/questions/31218423/go-library-package-names", "title": "Go library package names", "body": "<p>I have some questions on package naming for external Go libraries.</p>\n\n<p>I am interested if using generic names like \"<code>text</code>\" is considered a good practice? Having in mind that I cannot declare a \"nested package\" and that the library I am building deals with text processing, is it ok to have the package named \"<code>text</code>\" or should I stick to the library name as a package name too?</p>\n\n<p>I am building a set of libraries (different projects) and I want to combine them under the same package. Is this also problematic? I am new to the Go community and am still not sure if package pollution is a problem or not (I do not see a problem as long as I import few packages in my code).</p>\n"}, {"tags": ["go", "template-engine"], "answers": [{"comments": [{"owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1435997375, "post_id": 31218065, "comment_id": 50437292, "body": "Sorry, but it tells me nothing. I&#39;ve read it 3 times.. could you give an example? What does it mean &quot;function value&quot;?"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "edited": false, "score": 0, "creation_date": 1435997541, "post_id": 31218065, "comment_id": 50437334, "body": "@TimurFayzrakhmanov Added an example of how X could look like."}], "tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1435997518, "last_edit_date": 1435997518, "creation_date": 1435994345, "answer_id": 31218065, "question_id": 31218030, "link": "https://stackoverflow.com/questions/31218030/how-to-use-text-templates-predefined-call-function/31218065#31218065", "title": "How to use text/template&#39;s predefined &quot;call&quot; function?", "body": "<p>You need to use <code>call</code> if you want to call a function value.</p>\n\n<p>To quote the <a href=\"https://godoc.org/text/template\" rel=\"nofollow\">docs</a> (See under Functions):</p>\n\n<blockquote>\n  <p>Thus \"call .X.Y 1 2\" is, in Go notation, dot.X.Y(1, 2) where  Y is a\n  func-valued field, map entry, or the like.</p>\n</blockquote>\n\n<p>In this example <code>X</code> could look like this:</p>\n\n<pre><code>type X struct {\n    Y func(a int, b int) int\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 175, "user_id": 6249688, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/465ae66ea36ea277d33528789e9cab3d?s=128&d=identicon&r=PG&f=1", "display_name": "Blue Joy", "link": "https://stackoverflow.com/users/6249688/blue-joy"}, "is_accepted": false, "score": 0, "last_activity_date": 1588215302, "creation_date": 1588215302, "answer_id": 61515145, "question_id": 31218030, "link": "https://stackoverflow.com/questions/31218030/how-to-use-text-templates-predefined-call-function/61515145#61515145", "title": "How to use text/template&#39;s predefined &quot;call&quot; function?", "body": "<p><a href=\"https://play.golang.org/p/usia3d8STOG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/usia3d8STOG</a></p>\n\n<pre><code>    type X struct {\n        Y func(a int, b int) int\n    }\n    x := X{Y: func(a int, b int) int {\n        return a + b\n    }}\n    tmpl, err := template.New(\"test\").Parse(`{{call .X.Y 1 2}}\n    `)\n\n    if err != nil {\n        panic(err)\n    }\n    err = tmpl.Execute(os.Stdout, map[string]interface{}{\"X\": x})\n    if err != nil {\n        panic(err)\n    }\n</code></pre>\n"}], "owner": {"reputation": 13460, "user_id": 1349754, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/QoNQ4.jpg?s=128&g=1", "display_name": "Timur Fayzrakhmanov", "link": "https://stackoverflow.com/users/1349754/timur-fayzrakhmanov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 703, "favorite_count": 0, "accepted_answer_id": 31218065, "answer_count": 2, "score": 4, "last_activity_date": 1588215302, "creation_date": 1435994092, "question_id": 31218030, "link": "https://stackoverflow.com/questions/31218030/how-to-use-text-templates-predefined-call-function", "title": "How to use text/template&#39;s predefined &quot;call&quot; function?", "body": "<p>I'm trying to understand how to use <code>call</code> function in <code>text/template</code> package. Here is example:</p>\n\n<pre><code>type Human struct {\n    Name string\n}\n\nfunc (h *Human) Say(str string) string {\n    return str\n}\n\nfunc main() {\n    const letter = `\n    {{.Name}} wants to say {{\"blabla\" | .Say}}\n    {{.Name}} wants try again, {{call .Say \"blabla\"}}.`\n\n    var h = &amp;Human{\"Tim\"}\n\n    t := template.Must(template.New(\"\").Parse(letter))\n    err := t.Execute(os.Stdout, h)\n    if err != nil {\n        log.Println(\"executing template:\", err)\n    }\n\n}\n</code></pre>\n\n<a href=\"http://play.golang.org/p/ajpat2zFfS\" rel=\"nofollow\">see this code in play.golang.org</a>\n\n<p><br>\nI thought that <code>call</code> calls functions/methods, but as it turned out we can do it just by <code>.Method arg1 arg2</code>. So what is function <code>call</code> intended for?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "edited": false, "score": 1, "creation_date": 1436078990, "post_id": 31218008, "comment_id": 50455117, "body": "By &quot;packages&quot; you mean different projects/libraries?"}, {"owner": {"reputation": 2258, "user_id": 1952811, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3d2de061c9d12cd53ff7674556694d8a?s=128&d=identicon&r=PG", "display_name": "user1952811", "link": "https://stackoverflow.com/users/1952811/user1952811"}, "reply_to_user": {"reputation": 912, "user_id": 1912391, "user_type": "registered", "accept_rate": 22, "profile_image": "https://www.gravatar.com/avatar/890f477cf12dd59c58e326be303f04b6?s=128&d=identicon&r=PG", "display_name": "ZAky", "link": "https://stackoverflow.com/users/1912391/zaky"}, "edited": false, "score": 1, "creation_date": 1436084667, "post_id": 31218008, "comment_id": 50456248, "body": "No, just internal packages."}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1436005960, "post_id": 31219558, "comment_id": 50439466, "body": "PS: I wrote an article on how to pass a struct with your handler or package dependencies: <a href=\"http://elithrar.github.io/article/http-handler-error-handling-revisited/\" rel=\"nofollow noreferrer\">elithrar.github.io/article/&hellip;</a> (an update on an older article) that might help you see it from another angle. Also see <a href=\"http://www.jerf.org/iri/post/2929\" rel=\"nofollow noreferrer\">jerf.org/iri/post/2929</a> and <a href=\"https://medium.com/@benbjohnson/structuring-applications-in-go-3b04be4ff091\" rel=\"nofollow noreferrer\">medium.com/@benbjohnson/&hellip;</a> which are additional takes on these approaches."}, {"owner": {"reputation": 2258, "user_id": 1952811, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3d2de061c9d12cd53ff7674556694d8a?s=128&d=identicon&r=PG", "display_name": "user1952811", "link": "https://stackoverflow.com/users/1952811/user1952811"}, "edited": false, "score": 0, "creation_date": 1436085484, "post_id": 31219558, "comment_id": 50456405, "body": "Awesome, these are good. I kind of find it annoying that I have to pass in the db connection for each handler, but that makes it super explicit."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 13, "last_activity_date": 1436024863, "last_edit_date": 1436024863, "creation_date": 1436005707, "answer_id": 31219558, "question_id": 31218008, "link": "https://stackoverflow.com/questions/31218008/sharing-a-globally-defined-db-conn-with-multiple-packages/31219558#31219558", "title": "Sharing a globally defined db conn with multiple packages", "body": "<p>Simple answer: pass an initialised connection pool to your packages' own globals.</p>\n\n<p>e.g.</p>\n\n<pre><code>// package stuff\n\nvar DB *sql.DB\n\nfunc GetAllStuff() (*Stuff, error) {\n    err := DB.Query(\"...\")\n    // etc.\n}\n\n// package things\n\nvar DB *sql.DB\n\nfunc GetAllThings() (*Thing, error) {\n    err := DB.Query(\"...\")\n    // etc.\n}\n\n// package main\n\nfunc main() {\n    db, err := sql.Open(\"...\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    stuff.DB = db\n    things.DB = db\n\n    // etc.\n}\n</code></pre>\n\n<p>We define package-level globals, make sure they're exported (capitalised) and then pass a pointer to our connection pool to them.</p>\n\n<p>This is \"okay\", but can mask \"where\" things are being used. If you're looking at a handler it may not be clear <em>where</em> the connection is coming from, especially as your package grows. A more scalable approach might look like the below:</p>\n\n<pre><code>// package stuff\n\ntype DB struct {\n    *sql.DB\n}\n\nfunc New(db *sql.DB) (*DB, error) {\n    // Configure any package-level settings\n    return &amp;DB{db}, nil\n}\n\nfunc (db *DB) GetAllStuff() (*Stuff, error) {\n    err := db.Query(\"...\")\n    // etc.\n}\n\n// package things\n\ntype DB struct {\n    *sql.DB\n}\n\nfunc New(db *sql.DB) (*DB, error) {\n    // Configure any package-level settings\n    return &amp;DB{db}, nil\n}\n\nfunc (db *DB) GetAllThings() (*Thing, error) {\n    err := db.Query(\"...\")\n    // etc.\n}\n\n// package main\n\nfunc main() {\n    db, err := sql.Open(\"...\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    stuffDB, err := stuff.New(db)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    thingsDB, err := things.New(db)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Simplified.\n    http.HandleFunc(\"/stuff/all\", stuff.ShowStuffHandler(stuffDB))\n    http.HandleFunc(\"/things/all\", things.ShowThingsHandler(thingsDB))\n\n    // etc.\n}\n\nfunc ShowStuffHandler(db *stuff.DB) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        // We can use our stuff.DB here\n        stuff, err := db.GetAllStuff()\n        // etc.\n    }\n}\n</code></pre>\n\n<p>If you have more than just the DB connection as a dependency (e.g. config params, hostnames, etc.) , wrap them in an <code>things.Env</code> struct or a <code>stuff.Env</code> struct for each package.</p>\n\n<p>An example would be to have a <code>things.New(\"deps...\") *Env</code> function that returns a configured <code>*things.Env</code> that contains the dependencies used by your <code>things</code> package.</p>\n"}, {"comments": [{"owner": {"reputation": 2258, "user_id": 1952811, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3d2de061c9d12cd53ff7674556694d8a?s=128&d=identicon&r=PG", "display_name": "user1952811", "link": "https://stackoverflow.com/users/1952811/user1952811"}, "edited": false, "score": 1, "creation_date": 1436085539, "post_id": 31228542, "comment_id": 50456416, "body": "I kind of like this way. It seems a nicer way to move all database setup related stuff into that package."}, {"owner": {"reputation": 1206, "user_id": 2596734, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/Qd1p8.jpg?s=128&g=1", "display_name": "Roemer", "link": "https://stackoverflow.com/users/2596734/roemer"}, "edited": false, "score": 1, "creation_date": 1496058353, "post_id": 31228542, "comment_id": 75492435, "body": "Useful solution. How can one avoid import cycles though?"}, {"owner": {"reputation": 545, "user_id": 3763112, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/bea14956d83fe906ba4bafcea761250d?s=128&d=identicon&r=PG&f=1", "display_name": "Angger", "link": "https://stackoverflow.com/users/3763112/angger"}, "edited": false, "score": 0, "creation_date": 1497637619, "post_id": 31228542, "comment_id": 76179523, "body": "Is there a trick to store sql.Open statement in &quot;database&quot; package too? that would be super neat."}, {"owner": {"reputation": 3833, "user_id": 2103538, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/zIlIS.jpg?s=128&g=1", "display_name": "Maaz", "link": "https://stackoverflow.com/users/2103538/maaz"}, "reply_to_user": {"reputation": 545, "user_id": 3763112, "user_type": "registered", "accept_rate": 31, "profile_image": "https://www.gravatar.com/avatar/bea14956d83fe906ba4bafcea761250d?s=128&d=identicon&r=PG&f=1", "display_name": "Angger", "link": "https://stackoverflow.com/users/3763112/angger"}, "edited": false, "score": 0, "creation_date": 1503352559, "post_id": 31228542, "comment_id": 78570078, "body": "@Angger if you just need to store the statement so it&#39;s called later, you can put a function inside of the var that, when called executes the defined sql.Open statement."}, {"owner": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "edited": false, "score": 0, "creation_date": 1520459157, "post_id": 31228542, "comment_id": 85329146, "body": "@Maaz, for this option, where would be an ideal place to handle <code>defer database.DBCon.Close()</code>? Would this be on a case-by-case basis?"}, {"owner": {"reputation": 3833, "user_id": 2103538, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/zIlIS.jpg?s=128&g=1", "display_name": "Maaz", "link": "https://stackoverflow.com/users/2103538/maaz"}, "reply_to_user": {"reputation": 585, "user_id": 4109882, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/05080c148683d5bcb04238ea41a7056f?s=128&d=identicon&r=PG&f=1", "display_name": "gpanda", "link": "https://stackoverflow.com/users/4109882/gpanda"}, "edited": false, "score": 1, "creation_date": 1520472169, "post_id": 31228542, "comment_id": 85333434, "body": "@gpanda I guess it depends, I&#39;m treating this as a long lived connection. For example, if you&#39;re using gin-gonic or something you can detect if the server is receiving a shutdown signal and then close the database connection then, example: <a href=\"https://github.com/gin-gonic/gin/blob/master/examples/graceful-shutdown/graceful-shutdown/server.go\" rel=\"nofollow noreferrer\">github.com/gin-gonic/gin/blob/master/examples/graceful-shutd&zwnj;&#8203;own/&hellip;</a>"}, {"owner": {"reputation": 692, "user_id": 3464052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mCyU7.jpg?s=128&g=1", "display_name": "Mithun Arunan", "link": "https://stackoverflow.com/users/3464052/mithun-arunan"}, "edited": false, "score": 1, "creation_date": 1522239396, "post_id": 31228542, "comment_id": 86074832, "body": "Can we use singleton pattern?"}, {"owner": {"reputation": 2467, "user_id": 2035973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45e0c6c643b7e62842071a5ed6f0b333?s=128&d=identicon&r=PG", "display_name": "hellojebus", "link": "https://stackoverflow.com/users/2035973/hellojebus"}, "edited": false, "score": 0, "creation_date": 1528436123, "post_id": 31228542, "comment_id": 88515800, "body": "Mind blown! Is there a name for this pattern?"}], "tags": [], "owner": {"reputation": 3833, "user_id": 2103538, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/zIlIS.jpg?s=128&g=1", "display_name": "Maaz", "link": "https://stackoverflow.com/users/2103538/maaz"}, "is_accepted": true, "score": 90, "last_activity_date": 1556407175, "last_edit_date": 1556407175, "creation_date": 1436085340, "answer_id": 31228542, "question_id": 31218008, "link": "https://stackoverflow.com/questions/31218008/sharing-a-globally-defined-db-conn-with-multiple-packages/31228542#31228542", "title": "Sharing a globally defined db conn with multiple packages", "body": "<p>There is also the option of creating another package to hold your database connection-related settings. It can then have a package level global, which can be initialized in <code>main</code> and used in any package that is importing it. </p>\n\n<p>This way, you can explicitly see that the database package is being imported. Here is some sample code.</p>\n\n<pre><code>package database\n\nvar (\n    // DBCon is the connection handle\n    // for the database\n    DBCon *sql.DB\n)\n</code></pre>\n\n<hr>\n\n<pre><code>package main\n\nimport \"myApp/database\"\n\nfunc main() {\n\n    var err error\n    database.DBCon, err = sql.Open(\"postgres\", \"user=myname dbname=dbname sslmode=disable\")\n\n}\n</code></pre>\n\n<hr>\n\n<pre><code>package user\n\nimport \"myApp/database\"\n\nfunc Index() {\n    // database handle is available here\n    database.DBCon\n\n    ...\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 471, "user_id": 7153178, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nHiV8.jpg?s=128&g=1", "display_name": "AbdessamadEL", "link": "https://stackoverflow.com/users/7153178/abdessamadel"}, "is_accepted": false, "score": 0, "last_activity_date": 1616103417, "last_edit_date": 1616103417, "creation_date": 1616092713, "answer_id": 66697159, "question_id": 31218008, "link": "https://stackoverflow.com/questions/31218008/sharing-a-globally-defined-db-conn-with-multiple-packages/66697159#66697159", "title": "Sharing a globally defined db conn with multiple packages", "body": "<p><em><strong>Update</strong></em></p>\n<p>I've ended up using the <code>package config</code> to initialize database, at the start of the application, It's pretty good, as you don't have to pass any unneeded param to functions.</p>\n<hr />\n<p><em><strong>Original</strong></em></p>\n<p>I'm still new to the golang world, but I'm handling this same problem, by declaring\nlocal variables in the main package, in my case its <code>package app</code></p>\n<pre class=\"lang-golang prettyprint-override\"><code>var mongoClient *mongo.Client\nvar mongoCtx context.Context\nvar mongoCancelCtx context.CancelFunc\n</code></pre>\n<p>then I'm passing them to a database file inside <code>package config</code> to connect to the database, and use the passed pointer to assign the result.</p>\n<pre class=\"lang-golang prettyprint-override\"><code># app/app.go\n\nvar mongoClient *mongo.Client\nvar mongoCtx context.Context\nvar mongoCancelCtx context.CancelFunc\nconfig.BootstrapDatabase(&amp;mongoClient, &amp;mongoCtx, &amp;mongoCancelCtx)\n</code></pre>\n<pre class=\"lang-golang prettyprint-override\"><code># app/config/database.go\n\n// BootstrapDatabase ...\nfunc BootstrapDatabase(mongoClient **mongo.Client, ctx *context.Context, cancel *context.CancelFunc) {\n    *ctx, *cancel = context.WithTimeout(context.Background(), 10*time.Second)\n\n    client, err := mongo.Connect(*ctx, options.Client().ApplyURI(os.Getenv(&quot;MONGO_URI&quot;)))\n    if err != nil {\n        panic(err)\n    }\n\n    if err := client.Ping(*ctx, readpref.Primary()); err != nil {\n        panic(err)\n    }\n\n    *mongoClient = client\n\n    fmt.Println(&quot;Successfully connected and pinged.&quot;)\n}\n</code></pre>\n<p>Then I'm creating a database reference and passing it to each package\nthat will make use of it.</p>\n<pre class=\"lang-golang prettyprint-override\"><code>\n# app/app.go\n\ndb := mongoClient.Database(os.Getenv(&quot;MONGO_DATABASE&quot;))\nrepositories.BootstrapRepositories(db)\n\ne := echo.New()\nroutes.BootstrapRoutes(e, db)\n</code></pre>\n<p>So the idea is to declare the database reference in the high level package which is my <code>app/app.go</code> in my app and pass it down as needed, for example in my <code>package routes</code></p>\n<pre class=\"lang-golang prettyprint-override\"><code>#app/app.go\n\n\n// BootstrapRoutes ...\nfunc BootstrapRoutes(e *echo.Echo, db *mongo.Database) {\n\n    // Set middleware\n    e.Use(middleware.Logger())\n    e.Use(middleware.Recover())\n\n    // Users related routes\n    e.POST(&quot;/api/users&quot;, controllers.CreateUser)\n\n    // Starte web server\n    e.Logger.Fatal(e.Start(&quot;:4242&quot;))\n}\n</code></pre>\n<p>I'm still experimenting with it, I don't know yet if this approach will skill\nwith many endpoints, or I need to try separating it into its own package, as suggested in the first thread of this issue.</p>\n<p>Please share you thoughts I'll be happy to hear from you.</p>\n"}], "owner": {"reputation": 2258, "user_id": 1952811, "user_type": "registered", "accept_rate": 52, "profile_image": "https://www.gravatar.com/avatar/3d2de061c9d12cd53ff7674556694d8a?s=128&d=identicon&r=PG", "display_name": "user1952811", "link": "https://stackoverflow.com/users/1952811/user1952811"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 24470, "favorite_count": 19, "accepted_answer_id": 31228542, "answer_count": 3, "score": 38, "last_activity_date": 1616103417, "creation_date": 1435993898, "last_edit_date": 1598547134, "question_id": 31218008, "link": "https://stackoverflow.com/questions/31218008/sharing-a-globally-defined-db-conn-with-multiple-packages", "title": "Sharing a globally defined db conn with multiple packages", "body": "<p>I've read a few StackOverflow answers on how we handling the db connection. Since it's a pool, we can define it globally and use it in multiple goroutines and it's safe. </p>\n\n<p>The issue I'm having is that I have split my REST API into multiple packages. Each of these packages require a db connection, so I open a database connection in the startup. But even if I define the connection globally, it's only at the package level. What can I do to potentially share it among multiple packages? </p>\n\n<p>For some context I'm using the PostgreSQL driver and gin-gonic in my application.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "reply_to_user": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1435960870, "post_id": 31214598, "comment_id": 50430484, "body": "Thanks @TimCooper. Sorry I didn&#39;t see that question."}], "answers": [{"tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 8, "last_activity_date": 1435960652, "creation_date": 1435960652, "answer_id": 31214623, "question_id": 31214598, "link": "https://stackoverflow.com/questions/31214598/how-to-differentiate-empty-string-and-nothing-in-a-map/31214623#31214623", "title": "How to differentiate empty string and nothing in a map", "body": "<p>If by \"nothing\" you mean that the element is not in the map you can use the  <code>ok</code> idiom:</p>\n\n<pre><code>val, ok := myMap[\"value\"] // ok is true if value was in the map\n</code></pre>\n\n<p>You can find more information in <a href=\"https://golang.org/doc/effective_go.html#maps\" rel=\"noreferrer\">Effective Go</a>.</p>\n"}], "owner": {"reputation": 12745, "user_id": 1663023, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/fc43a735e2c498f450a9908a5bd9ebf4?s=128&d=identicon&r=PG", "display_name": "Qian Chen", "link": "https://stackoverflow.com/users/1663023/qian-chen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1476, "favorite_count": 0, "closed_date": 1435960891, "accepted_answer_id": 31214623, "answer_count": 1, "score": 0, "last_activity_date": 1435960652, "creation_date": 1435960462, "question_id": 31214598, "link": "https://stackoverflow.com/questions/31214598/how-to-differentiate-empty-string-and-nothing-in-a-map", "closed_reason": "Duplicate", "title": "How to differentiate empty string and nothing in a map", "body": "<p>The following code yields <code>true</code>. So I'm wondering for <code>map[string]string</code> in Golang, is there a way to differentiate empty string and nothing?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    m := make(map[string]string)\n    m[\"abc\"] = \"\"\n    fmt.Println(m[\"a\"] == m[\"abc\"]) //true\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 0, "last_activity_date": 1435958102, "creation_date": 1435958102, "answer_id": 31214276, "question_id": 31213791, "link": "https://stackoverflow.com/questions/31213791/how-to-dry-up-database-code/31214276#31214276", "title": "How to dry up database code", "body": "<p>The most obvious simplification would be to move the <code>db.LogMode(false)</code> call into the <code>DBSession()</code> function, and give <code>DBSession()</code> a shorter name like <code>DB()</code>:</p>\n\n<pre><code>func DB() (db gorm.DB) {\n    sqliteSession, err := gorm.Open(\"sqlite3\", cache.db)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    sqliteSession.LogMode(false)\n    return sqliteSession\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>FindSomethingByID(id int) {\n    db := DB()\n    // code\n}\n</code></pre>\n\n<p>Now there's only 1 line in each of your functions using the db session, one simple function call. You can't really make it any shorter if you always need a new db session.</p>\n"}, {"comments": [{"owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1436016181, "post_id": 31215640, "comment_id": 50442197, "body": "I rearranged my code like you mentioned above, but i&#39;m getting a error now src/database/database.go:48: cannot assign gorm.DB to db (type *gorm.DB) in multiple assignment"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1436016556, "post_id": 31215640, "comment_id": 50442292, "body": "I&#39;ve made an edit. <code>gorm</code> returns a value and not a pointer, unlike most other packages that wrap database/sql."}, {"owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "edited": false, "score": 0, "creation_date": 1436016675, "post_id": 31215640, "comment_id": 50442314, "body": "Line 48 is db, err = gorm.Open(&quot;sqlite3&quot;, &quot;cache.db&quot;)"}, {"owner": {"reputation": 696, "user_id": 1126722, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8421dc16b450b3b287fa75c86352b99e?s=128&d=identicon&r=PG&f=1", "display_name": "Cyberlurk", "link": "https://stackoverflow.com/users/1126722/cyberlurk"}, "edited": false, "score": 0, "creation_date": 1437733153, "post_id": 31215640, "comment_id": 51165827, "body": "Don&#39;t you open up a new connection pool this way now - going against your own advise by calling init() from every function that needs to conenct to the database?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 696, "user_id": 1126722, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8421dc16b450b3b287fa75c86352b99e?s=128&d=identicon&r=PG&f=1", "display_name": "Cyberlurk", "link": "https://stackoverflow.com/users/1126722/cyberlurk"}, "edited": false, "score": 0, "creation_date": 1437733273, "post_id": 31215640, "comment_id": 51165908, "body": "@Zahrec No: <code>init()</code> is run once on program initialization only (by the runtime). You don&#39;t call it yourself."}, {"owner": {"reputation": 696, "user_id": 1126722, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8421dc16b450b3b287fa75c86352b99e?s=128&d=identicon&r=PG&f=1", "display_name": "Cyberlurk", "link": "https://stackoverflow.com/users/1126722/cyberlurk"}, "edited": false, "score": 0, "creation_date": 1437749322, "post_id": 31215640, "comment_id": 51176684, "body": "Ah, I see. thanks. So every time you want to run a query, you call a function in your database package? You don&#39;t make a struct type method for lets say a User type so that you can do User.GetAll()?"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1437784747, "post_id": 31215640, "comment_id": 51192278, "body": "It would make more sense to have a <code>GetAllUsers() ([]*Users, error)</code> defined on a UserDB type that embeds the connection. I kept my answer here simple but a better long-term pattern is <a href=\"https://robots.thoughtbot.com/interface-with-your-database-in-go\" rel=\"nofollow noreferrer\">robots.thoughtbot.com/interface-with-your-database-in-go</a> + <a href=\"http://www.alexedwards.net/blog/organising-database-access#using-an-interface\" rel=\"nofollow noreferrer\">alexedwards.net/blog/&hellip;</a> - hope those help."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 6, "last_activity_date": 1436016574, "last_edit_date": 1436016574, "creation_date": 1435969453, "answer_id": 31215640, "question_id": 31213791, "link": "https://stackoverflow.com/questions/31213791/how-to-dry-up-database-code/31215640#31215640", "title": "How to dry up database code", "body": "<p>Calling <code>gorm.Open</code> inside every function isn't very efficient: <code>Open</code> opens a new  connection pool, and should be called just once (<a href=\"http://golang.org/pkg/database/sql/#Open\" rel=\"nofollow\">see the database/sql docs</a>, which gorm wraps).</p>\n\n<p>A simple improvement is to establish a global <code>gorm.DB</code>, initialise it in <code>init()</code>  it from all of your functions - e.g.</p>\n\n<pre><code>package database\n\nvar db gorm.DB\n\nfunc init() {\n    var err error\n    // Note we use an = and not a := as our variables\n    // are already initialised\n    db, err = gorm.Open(\"sqlite3\", \"cache.db\")\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    // Turn off logging globally\n    db.LogMode(false)\n}\n\nFindSomethingByID(id int) {\n    err := db.Query(\"...\")\n    // code\n}\n</code></pre>\n\n<p>This is a quick win and reduces the repetition.</p>\n\n<p>In a larger application it typically makes sense to pass dependencies (like DB pools, config params, etc.) more explicitly by wrapping them in types and creating custom handlers.</p>\n\n<p>You also might initialise the connection in your <code>package main</code> and pass the <code>*gorm.DB</code> to your <code>database</code> package via a <code>func New(db *gorm.DB)</code> function that sets a private, package-level variable.</p>\n"}], "owner": {"reputation": 1023, "user_id": 18933, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/1f1e8008a09a9d4cfe528e25cebe0b25?s=128&d=identicon&r=PG", "display_name": "gregf", "link": "https://stackoverflow.com/users/18933/gregf"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 31215640, "answer_count": 2, "score": 2, "last_activity_date": 1436016574, "creation_date": 1435955064, "question_id": 31213791, "link": "https://stackoverflow.com/questions/31213791/how-to-dry-up-database-code", "title": "How to dry up database code", "body": "<p>I have a database package that contains the following code.</p>\n\n<pre><code>package database\n\nimport (\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n    // required by gorm\n    _ \"github.com/mattn/go-sqlite3\"\n)\n\ntype Podcast struct {\n    ID       int `sql:\"index\"`\n    Title    string\n    RssURL   string `sql:\"unique_index\"`\n    Paused   bool\n    Episodes []Episode\n}\n\ntype Episode struct {\n    ID           int `sql:\"index\"`\n    PodcastID    int\n    Title        string\n    EnclosureURL string `sql:\"unique_index\"`\n    Downloaded   bool\n    GUID         string `sql:\"unique_index\"`\n    PubDate      string\n}\n\nfunc DBSession() (db gorm.DB) {\n    sqliteSession, err := gorm.Open(\"sqlite3\", cache.db)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    return sqliteSession\n}\n</code></pre>\n\n<p>Followed by a bunch of methods that all start with the following code.</p>\n\n<pre><code>FindSomethingByID(id int) {\n    db := DBSession()\n    db.LogMode(false)\n\n    // code\n}\n\nFindSomethingElse {\n    db := DBSession()\n    db.LogMode(false)\n\n    // code\n}\n</code></pre>\n\n<p>Calling DBSession and setting LogMode in each func seems bad. I just don't know how to do it better. Could someone help?</p>\n"}, {"tags": ["ios", "go", "google-cloud-messaging"], "comments": [{"owner": {"reputation": 5331, "user_id": 555017, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/06aa109f3832c30df43af5fcd2f13d9c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/555017/jonathan"}, "edited": false, "score": 1, "creation_date": 1436380128, "post_id": 31212974, "comment_id": 50591799, "body": "Uh, hey, that token isn&#39;t supposed to secret...is it?"}, {"owner": {"reputation": 240, "user_id": 1488741, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1b0f97a5494c383b53577067d7de4b4d?s=128&d=identicon&r=PG", "display_name": "Rafael Garcia", "link": "https://stackoverflow.com/users/1488741/rafael-garcia"}, "reply_to_user": {"reputation": 5331, "user_id": 555017, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/06aa109f3832c30df43af5fcd2f13d9c?s=128&d=identicon&r=PG", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/555017/jonathan"}, "edited": false, "score": 0, "creation_date": 1436382265, "post_id": 31212974, "comment_id": 50593108, "body": "Don&#39;t think so, in order to send a notification to a device, you have to register it using your gcm user token :)"}], "answers": [{"comments": [{"owner": {"reputation": 240, "user_id": 1488741, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1b0f97a5494c383b53577067d7de4b4d?s=128&d=identicon&r=PG", "display_name": "Rafael Garcia", "link": "https://stackoverflow.com/users/1488741/rafael-garcia"}, "edited": false, "score": 0, "creation_date": 1436386184, "post_id": 31277493, "comment_id": 50595471, "body": "I&#39;m trying to achieve that on iOS. I tried it here but it doesn&#39;t work. I&#39;m trying to do that using a XMPP connection by the way."}], "tags": [], "owner": {"reputation": 1353, "user_id": 1546795, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2cd8500c729db4fa7e0000ade8baecec?s=128&d=identicon&r=PG&f=1", "display_name": "evanescent", "link": "https://stackoverflow.com/users/1546795/evanescent"}, "is_accepted": false, "score": 0, "last_activity_date": 1436296850, "creation_date": 1436296850, "answer_id": 31277493, "question_id": 31212974, "link": "https://stackoverflow.com/questions/31212974/not-receiving-back-a-delivery-receipt-notification-from-gcm-ccs/31277493#31277493", "title": "Not receiving back a delivery_receipt_notification from GCM CCS", "body": "<p>Not sure if you're trying this on Android or iOS, since it works for me on Android but it doesn't always work on iOS.</p>\n\n<p>Delivery receipts for iOS do not work with the <code>notification</code> parameter in the request. I was able to get it to work for a plain <code>data</code> message i.e. with payload</p>\n\n<pre><code>{\n  \"to\" : &lt;reg id&gt;,\n  \"data\" : {\n    \"hello\" : \"world\",\n    \"id\" : 123\n  }\n}\n</code></pre>\n\n<p>But if I added the <code>notification</code> payload to the above one it didn't work. </p>\n\n<p>I would assume that since a <code>notification</code> payload message needs to be sent via APNS there is no way for them to know whether the message was delivered or not since APNS does not return any result. </p>\n\n<p>For a <b>no</b> <code>notification</code> message since it's received only when the app is in the foreground they would be able to verify if the message was delivered or not.</p>\n"}, {"comments": [{"owner": {"reputation": 240, "user_id": 1488741, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1b0f97a5494c383b53577067d7de4b4d?s=128&d=identicon&r=PG", "display_name": "Rafael Garcia", "link": "https://stackoverflow.com/users/1488741/rafael-garcia"}, "edited": false, "score": 0, "creation_date": 1436415250, "post_id": 31306163, "comment_id": 50604975, "body": "Hi @TheWonderBird, thank you for your response. Would you mind letting us know where did you get this information from?"}, {"owner": {"reputation": 240, "user_id": 1488741, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1b0f97a5494c383b53577067d7de4b4d?s=128&d=identicon&r=PG", "display_name": "Rafael Garcia", "link": "https://stackoverflow.com/users/1488741/rafael-garcia"}, "edited": false, "score": 1, "creation_date": 1436483138, "post_id": 31306163, "comment_id": 50645343, "body": "Hi @TheWonderBird, could you please point out in the documentation (or somewhere else) informations about that? I couldn&#39;t find anything about that and would love to have some references. Thank you."}], "tags": [], "owner": {"reputation": 653, "user_id": 2910017, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a05b34788061a087e2a1bac8d2ff4101?s=128&d=identicon&r=PG&f=1", "display_name": "TheWonderBird", "link": "https://stackoverflow.com/users/2910017/thewonderbird"}, "is_accepted": false, "score": 1, "last_activity_date": 1436401812, "creation_date": 1436401812, "answer_id": 31306163, "question_id": 31212974, "link": "https://stackoverflow.com/questions/31212974/not-receiving-back-a-delivery-receipt-notification-from-gcm-ccs/31306163#31306163", "title": "Not receiving back a delivery_receipt_notification from GCM CCS", "body": "<p>Thanks for trying out GCM on iOS.\nUnfortunately, delivery receipts are not available for display notifications on iOS at the moment.</p>\n"}], "owner": {"reputation": 240, "user_id": 1488741, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/1b0f97a5494c383b53577067d7de4b4d?s=128&d=identicon&r=PG", "display_name": "Rafael Garcia", "link": "https://stackoverflow.com/users/1488741/rafael-garcia"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 168, "favorite_count": 0, "answer_count": 2, "score": 7, "last_activity_date": 1436401812, "creation_date": 1435950706, "question_id": 31212974, "link": "https://stackoverflow.com/questions/31212974/not-receiving-back-a-delivery-receipt-notification-from-gcm-ccs", "title": "Not receiving back a delivery_receipt_notification from GCM CCS", "body": "<p>I'm trying to get a <code>receipt</code> from CCS, but I'm just not able to.</p>\n\n<p>Here is what I'm doing:</p>\n\n<p>I have a <code>go</code> script:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/brunohenrique/go-gcm/ccs\"\n)\n\nvar (\n    user = struct {\n        gcmToken string\n    }{\"mg0xe56LfjE:APA91bFHtHVQt85iNgyzTeDowovIGPAD_NbBjURppy1LgV9_oaM2R_9zn1fDXNuEeOoALTj7F8e8JmNPI3Md-CbbgTxdvxVrONFVfGz2dOujsaGkZjEhJcBH8sWvRNYZNIp2j2QliAEX\"}\n)\n\n\nfunc main() {\n    con := connect()\n\n\n    // Sends a message\n    con.Send(&amp;ccs.OutMsg{\n        To: user.gcmToken,\n        ID: \"m-1366082849205\",\n        Notification: map[string]interface{}{\n            \"title\": \"Hey!\",\n            \"body\": \"There\",\n            \"sound\": \"default\",\n        },\n        TimeToLive: 600,\n        DeliveryReceiptRequested: true,\n        DelayWhileIdle: true,\n    })\n\n\n    // Listen to messages\n    for {\n        m, err := con.Receive()\n\n        if err != nil {\n            fmt.Printf(\"&gt;&gt;&gt; Err: %+v \\n\", err)\n        }\n\n        go func(m *ccs.InMsg) {\n            fmt.Printf(\"&gt;&gt;&gt; InMsg: %+v \\n\", m)\n        }(m)\n    }\n}\n</code></pre>\n\n<p>Everything seems alright when I run the script, but no receipt message back:</p>\n\n<p><img src=\"https://i.stack.imgur.com/I2lSp.png\" alt=\"enter image description here\"></p>\n\n<p>And this is what I'm doing when I get the notification:</p>\n\n<p><img src=\"https://i.stack.imgur.com/pd4JM.png\" alt=\"enter image description here\"></p>\n\n<p>Am I doing something wrong or missing something?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 4073, "user_id": 2626491, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/UUSae.jpg?s=128&g=1", "display_name": "Alex Woolford", "link": "https://stackoverflow.com/users/2626491/alex-woolford"}, "edited": false, "score": 0, "creation_date": 1435948707, "post_id": 31212546, "comment_id": 50426645, "body": "This may help: <a href=\"http://stackoverflow.com/questions/19209425/how-can-i-clear-the-console-with-golang-in-windows\" title=\"how can i clear the console with golang in windows\">stackoverflow.com/questions/19209425/&hellip;</a>"}, {"owner": {"reputation": 21, "user_id": 5078771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb2eb3f3b2af82e2f07dcc37caa4598?s=128&d=identicon&r=PG&f=1", "display_name": "seomis", "link": "https://stackoverflow.com/users/5078771/seomis"}, "reply_to_user": {"reputation": 4073, "user_id": 2626491, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/UUSae.jpg?s=128&g=1", "display_name": "Alex Woolford", "link": "https://stackoverflow.com/users/2626491/alex-woolford"}, "edited": false, "score": 0, "creation_date": 1435953152, "post_id": 31212546, "comment_id": 50428145, "body": "It really helped, thank you!!!! works almost the same way for Linux"}, {"owner": {"reputation": 1251, "user_id": 1984350, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1398c50ad82b6853c0db90c423697841?s=128&d=identicon&r=PG", "display_name": "Adeeb", "link": "https://stackoverflow.com/users/1984350/adeeb"}, "edited": false, "score": 0, "creation_date": 1436038500, "post_id": 31212546, "comment_id": 50448790, "body": "since the edit is a solution and not a question, can you submit it as such."}], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 0, "last_activity_date": 1435951688, "creation_date": 1435951688, "answer_id": 31213150, "question_id": 31212546, "link": "https://stackoverflow.com/questions/31212546/systemclear-equivalent-in-go/31213150#31213150", "title": "system(&quot;clear&quot;); equivalent in Go", "body": "<p><code>system()</code> in C calls an external program &mdash; <code>clear</code> in your case.</p>\n\n<p>So the equivalent in Go would be using the <a href=\"http://golang.org/pkg/os/exec/\" rel=\"nofollow\"><code>os/exec</code></a> standard package to spawn the same program and wait for it to complete its execution.</p>\n"}, {"tags": [], "owner": {"reputation": 604, "user_id": 538886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fc622ca8108ba3e8faaa40486ebfb53?s=128&d=identicon&r=PG", "display_name": "Svetlin Ralchev", "link": "https://stackoverflow.com/users/538886/svetlin-ralchev"}, "is_accepted": false, "score": 1, "last_activity_date": 1436038071, "creation_date": 1436038071, "answer_id": 31224410, "question_id": 31212546, "link": "https://stackoverflow.com/questions/31212546/systemclear-equivalent-in-go/31224410#31224410", "title": "system(&quot;clear&quot;); equivalent in Go", "body": "<p>You can call the <code>stdlib.h</code> system function in <code>go</code> by using few lines of <code>C</code>:</p>\n\n<pre><code>package main\n\n// #include &lt;stdlib.h&gt;\n//\n// void clear() {\n//  system(\"clear\");\n// }\nimport \"C\"\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    fmt.Println(\"Hello\")\n    fmt.Println(\"World\")\n    fmt.Println(\"Golang\")\n\n    time.Sleep(time.Second * 5)\n\n    C.clear()\n\n    fmt.Println(\"Screen is cleared\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 7565712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/McgQ5.jpg?s=128&g=1", "display_name": "TJ Merritt", "link": "https://stackoverflow.com/users/7565712/tj-merritt"}, "is_accepted": false, "score": 2, "last_activity_date": 1487114573, "creation_date": 1487114573, "answer_id": 42238065, "question_id": 31212546, "link": "https://stackoverflow.com/questions/31212546/systemclear-equivalent-in-go/42238065#42238065", "title": "system(&quot;clear&quot;); equivalent in Go", "body": "<p>The go function below is equivalent to the C system() function.  In go you could use this like:</p>\n\n\n\n<pre class=\"lang-golang prettyprint-override\"><code>import \"system\"\n\n...\n    exitstatus := system.System(\"clear\")\n</code></pre>\n\n<p>Here is the Go code:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package system\n\nimport (\n        \"os\"\n        \"os/exec\"\n        \"syscall\"\n    )\n\nfunc System(cmd string) int {\n    c := exec.Command(\"sh\", \"-c\", cmd)\n    c.Stdin = os.Stdin\n    c.Stdout = os.Stdout\n    c.Stderr = os.Stderr\n    err := c.Run()\n\n    if err == nil {\n        return 0\n    }\n\n    // Figure out the exit code\n    if ws, ok := c.ProcessState.Sys().(syscall.WaitStatus); ok {\n        if ws.Exited() {\n            return ws.ExitStatus()\n        }\n\n        if ws.Signaled() {\n            return -int(ws.Signal())\n        }\n    }\n\n    return -1\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 5078771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7cb2eb3f3b2af82e2f07dcc37caa4598?s=128&d=identicon&r=PG&f=1", "display_name": "seomis", "link": "https://stackoverflow.com/users/5078771/seomis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 948, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1554285636, "creation_date": 1435948233, "last_edit_date": 1554285636, "question_id": 31212546, "link": "https://stackoverflow.com/questions/31212546/systemclear-equivalent-in-go", "title": "system(&quot;clear&quot;); equivalent in Go", "body": "<p>Could anyone show me the equivalent in go to the system(\"clear\"); in C ? I want to clean the console after a certain period of time. Thanks in advance</p>\n\n<p>EDIT: This worked for me in Linux</p>\n\n<pre><code>import \"os/exec\"\n\n// Method body\nclear := exec.Command(\"clear\")\nclear.Stdout = os.Stdout\nclear.Run()\n</code></pre>\n"}, {"tags": ["google-app-engine", "go", "google-api", "service-accounts"], "answers": [{"tags": [], "owner": {"reputation": 21, "user_id": 1880707, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1262fa278356d6fd44e534bf3f6d9e21?s=128&d=identicon&r=PG", "display_name": "lgr", "link": "https://stackoverflow.com/users/1880707/lgr"}, "is_accepted": false, "score": 1, "last_activity_date": 1439507242, "last_edit_date": 1439507242, "creation_date": 1439502603, "answer_id": 31999023, "question_id": 31208905, "link": "https://stackoverflow.com/questions/31208905/service-account-app-engine-go-google-apis/31999023#31999023", "title": "Service account, App engine, Go, Google APIs", "body": "<p>There are two Go packages for Google App Engine:  <code>appengine</code> and <code>google.golang.org/appengine</code>.</p>\n\n<p>The first one uses appengine.Context that is not compatible with the context.Context used by the oauth2 packages. You need to import the second one to <code>google.golang.org/appengine</code>. </p>\n\n<p>Also, change <code>client := config.Client(oauth2.NoContext)</code> to <code>client := config.Client(c)</code>.</p>\n"}], "owner": {"reputation": 1271, "user_id": 3296660, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/a76d22e6c17075af3579b14eacb95192?s=128&d=identicon&r=PG&f=1", "display_name": "Druxtan", "link": "https://stackoverflow.com/users/3296660/druxtan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 880, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1439507242, "creation_date": 1435932864, "question_id": 31208905, "link": "https://stackoverflow.com/questions/31208905/service-account-app-engine-go-google-apis", "title": "Service account, App engine, Go, Google APIs", "body": "<p>I try to connect to drive with a service account.</p>\n\n<p>Actually I have</p>\n\n<pre><code>        c := appengine.NewContext(r)\n        key, err := ioutil.ReadFile(\"key/key.pem\")\n        if err != nil {\n            w.WriteHeader(http.StatusInternalServerError)\n            c.Errorf(\"Pem file not found\")\n            return\n        }\n        config := &amp;jwt.Config{\n            Email: \"xxx@developer.gserviceaccount.com\",\n            PrivateKey: key,\n            Scopes: []string{\n                \"https://www.googleapis.com/auth/drive\",\n            },\n            TokenURL: google.JWTTokenURL,\n        }\n\n        client := config.Client(oauth2.NoContext)\n        service, err := drive.New(client)\n        if (err != nil) {\n            w.WriteHeader(http.StatusInternalServerError)\n            c.Errorf(\"Service connection not works\")\n            return\n        }\n        about, err := service.About.Get().Do()\n        if (err != nil) {\n            w.WriteHeader(http.StatusInternalServerError)\n            c.Errorf(err.Error())\n            return\n        }\n        c.Infof(about.Name)\n</code></pre>\n\n<p>That I found here : <a href=\"https://github.com/golang/oauth2/blob/master/google/example_test.go\" rel=\"nofollow\">https://github.com/golang/oauth2/blob/master/google/example_test.go</a></p>\n\n<p>Of course it doesn't work, I have to use urlfetch, but I don't know how... \nThe error I get is <code>\"ERROR: Get https://www.googleapis.com/drive/v2/about?alt=json: oauth2: cannot fetch token: Post https://accounts.google.com/o/oauth2/token: not an App Engine context\"</code></p>\n\n<p>How I can do?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "abstract-syntax-tree"], "answers": [{"comments": [{"owner": {"reputation": 559, "user_id": 265767, "user_type": "registered", "accept_rate": 51, "profile_image": "https://www.gravatar.com/avatar/4cc3470aa2b9554612ea406ae169be2c?s=128&d=identicon&r=PG", "display_name": "user265767", "link": "https://stackoverflow.com/users/265767/user265767"}, "edited": false, "score": 0, "creation_date": 1460928214, "post_id": 31206858, "comment_id": 60954514, "body": "What about doing this against the standard library? Is the only opportunity to follow env GOROOT path down to the src folder under the compiler? I&#39;am looking for a way to lookup what type is returned from functions in the standard library, and I think this is the only solution??"}, {"owner": {"reputation": 3949, "user_id": 1816872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1V08e.jpg?s=128&g=1", "display_name": "Ivan Black", "link": "https://stackoverflow.com/users/1816872/ivan-black"}, "edited": false, "score": 1, "creation_date": 1463858258, "post_id": 31206858, "comment_id": 62246935, "body": "Hello, my friend. I patched your playground code. It works like a charme now <a href=\"https://play.golang.org/p/yLV6-asPas\" rel=\"nofollow noreferrer\">play.golang.org/p/yLV6-asPas</a>. Feel free to use <code>&#47;tmp</code> directory on the playground."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 3949, "user_id": 1816872, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1V08e.jpg?s=128&g=1", "display_name": "Ivan Black", "link": "https://stackoverflow.com/users/1816872/ivan-black"}, "edited": false, "score": 0, "creation_date": 1463994180, "post_id": 31206858, "comment_id": 62283291, "body": "@IvanBlack Thanks, added to the answer!"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1463994164, "last_edit_date": 1463994164, "creation_date": 1435926416, "answer_id": 31206858, "question_id": 31205830, "link": "https://stackoverflow.com/questions/31205830/simplest-working-example-of-extracting-type-names-from-given-path-of-package/31206858#31206858", "title": "Simplest working example of extracting Type names from given path of package", "body": "<p>I've came up with this example of a program that prints all (top-level) type names. Parse the directory, get the package, and walk it.</p>\n\n<pre><code>fs := token.NewFileSet()\npkgs, err := parser.ParseDir(fs, dir, nil, 0)\n// Check err.\npkg, ok := pkgs[\"pkgname\"]\n// Check ok.\nast.Walk(VisitorFunc(FindTypes), pkg)\n</code></pre>\n\n<p>Where <code>VisitorFunc</code> and <code>FindTypes</code> are defined as</p>\n\n<pre><code>type VisitorFunc func(n ast.Node) ast.Visitor\n\nfunc (f VisitorFunc) Visit(n ast.Node) ast.Visitor { return f(n) }\n\nfunc FindTypes(n ast.Node) ast.Visitor {\n    switch n := n.(type) {\n    case *ast.Package:\n        return VisitorFunc(FindTypes)\n    case *ast.File:\n        return VisitorFunc(FindTypes)\n    case *ast.GenDecl:\n        if n.Tok == token.TYPE {\n            return VisitorFunc(FindTypes)\n        }\n    case *ast.TypeSpec:\n        fmt.Println(n.Name.Name)\n    }\n    return nil\n}\n</code></pre>\n\n<p>Full code on Playground: <a href=\"http://play.golang.org/p/Rk_zmrmD0k\" rel=\"nofollow\">http://play.golang.org/p/Rk_zmrmD0k</a> (won't work there since the FS operations are disallowed).</p>\n\n<hr>\n\n<p><strong>EDIT:</strong> Here is a version that works on the Playground, by Ivan Black in the comments: <a href=\"https://play.golang.org/p/yLV6-asPas\" rel=\"nofollow\">https://play.golang.org/p/yLV6-asPas</a></p>\n"}], "owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1855, "favorite_count": 1, "accepted_answer_id": 31206858, "answer_count": 1, "score": 4, "last_activity_date": 1463994164, "creation_date": 1435923124, "question_id": 31205830, "link": "https://stackoverflow.com/questions/31205830/simplest-working-example-of-extracting-type-names-from-given-path-of-package", "title": "Simplest working example of extracting Type names from given path of package", "body": "<p>I'm new to golang AST package and related go tools like astutils. At the moment I'm a bit stucked in understanding the Stringer example and modifying it for my own purpose.</p>\n\n<p><a href=\"https://github.com/golang/tools/blob/master/cmd/stringer/stringer.go\" rel=\"nofollow\">https://github.com/golang/tools/blob/master/cmd/stringer/stringer.go</a></p>\n\n<p>Is there an working example of simply extract a list of all defined type names in a package path?</p>\n"}, {"tags": ["ubuntu", "go", "network-programming", "dbus"], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1435930816, "post_id": 31205261, "comment_id": 50418183, "body": "Though nm.WatchState() doesn&#39;t work(i.e. I get no notification) so I guess that&#39;s rather a bug because GetState works."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1435931162, "post_id": 31205261, "comment_id": 50418408, "body": "That could be. The package has next to no documentation or examples, which is a bug of its own."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 0, "last_activity_date": 1435921404, "creation_date": 1435921404, "answer_id": 31205261, "question_id": 31204482, "link": "https://stackoverflow.com/questions/31204482/why-networkmanager-watchstate-panics/31205261#31205261", "title": "Why networkmanager.WatchState panics?", "body": "<p>I haven't used the package myself, but from inspecting <a href=\"http://bazaar.launchpad.net/+branch/ubuntu-push/view/head:/bus/endpoint.go\" rel=\"nofollow\">the source code</a>, it seems like you should call <code>endp.Dial</code> before <code>networkmanager.New</code> because otherwise, <code>endpoint.proxy</code> stays uninitialised.</p>\n\n<pre><code>endp := bus.SystemBus.Endpoint(networkmanager.BusAddress, lg)\nerr := endp.Dial()\nif err != nil{\n    log.Printf(\"dial error %v\", err)\n    return\n}\ndefer endp.Close()\nnm := networkmanager.New(endp, lg)\n</code></pre>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 31205261, "answer_count": 1, "score": 1, "last_activity_date": 1435921404, "creation_date": 1435919070, "last_edit_date": 1435919391, "question_id": 31204482, "link": "https://stackoverflow.com/questions/31204482/why-networkmanager-watchstate-panics", "title": "Why networkmanager.WatchState panics?", "body": "<p>I need to watch network changes and set some routing rules whenever the network status changes(e.g. if an interface is rebooted I need to set the ip routing tables again b/c the src is dynamic so I can't hardcode it).\n To achieve this I'm trying to use <a href=\"http://godoc.org/launchpad.net/ubuntu-push/bus/networkmanager#New\" rel=\"nofollow\">networkmanager</a> package but WatchState panics. Any idea why?</p>\n\n<pre><code>package main\n\nimport(\n    \"flag\"\n    \"os\" \n    \"launchpad.net/ubuntu-push/bus\"\n    \"launchpad.net/ubuntu-push/bus/networkmanager\"\n    \"launchpad.net/ubuntu-push/logger\"\n\n)\n\nfunc main(){\n    flag.Parse()\n\n    lg := logger.NewSimpleLogger(os.Stderr, \"info\")\n    endp := bus.SystemBus.Endpoint(networkmanager.BusAddress, lg)\n    nm := networkmanager.New(endp, lg)\n    watchState, cancel, err := nm.WatchState()\n    if err !=nil{\n        log.Printf(\"error %v\", err)\n        return\n    }\n    defer cancel.Cancel()\n    for state := range watchState{\n        log.Printf.(\"state is %v\", state)\n    }\n}\n</code></pre>\n\n<p>Panic trace</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x0 pc=0x488788]\n\n    goroutine 1 [running]:\n    launchpad.net/go-dbus/v1.(*ObjectProxy).WatchSignal(0x0, 0x616cd0, 0x1e, 0x5f0af0, 0xc, 0x7f9733d0e478, 0x0, 0x0)\n        /root/go/src/launchpad.net/go-dbus/v1/dbus.go:97 +0x198\n    launchpad.net/ubuntu-push/bus.(*endpoint).WatchSignal(0xc20803e0c0, 0x5f0af0, 0xc, 0xc20800a0e0, 0xc20802a530, 0x0, 0x0, 0x0, 0x0)\n        /root/go/src/launchpad.net/ubuntu-push/bus/endpoint.go:133 +0x91\n    launchpad.net/ubuntu-push/bus/networkmanager.(*networkManager).WatchState(0xc20800a0c0, 0x5bce80, 0x0, 0x0, 0x0, 0x0)\n        /root/go/src/launchpad.net/ubuntu-push/bus/networkmanager/networkmanager.go:108 +0x1cf\n    main.main()\n        /root/go/src/github.com/vinkoo/net/main.go:16 +0x1f9\n\n    goroutine 2 [runnable]:\n    runtime.forcegchelper()\n        /usr/local/go/src/runtime/proc.go:90\n    runtime.goexit()\n        /usr/local/go/src/runtime/asm_amd64.s:2232 +0x1\n\n    goroutine 3 [runnable]:\n    runtime.bgsweep()\n        /usr/local/go/src/runtime/mgc0.go:82\n    runtime.goexit()\n        /usr/local/go/src/runtime/asm_amd64.s:2232 +0x1\n\n    goroutine 4 [runnable]:\n    runtime.runfinq()\n        /usr/local/go/src/runtime/malloc.go:712\n    runtime.goexit()\n        /usr/local/go/src/runtime/asm_amd64.s:2232 +0x1\n    exit status 2\n</code></pre>\n\n<p><strong>Edit:</strong>  It seems the program panics on any method from the networkmanager. GetState panics as follows. </p>\n\n<pre><code>goroutine 1 [running]:\nlaunchpad.net/go-dbus/v1.(*ObjectProxy).Call(0x0, 0x616c90, 0x1f, 0x5e26d0, 0x3, 0xc20801d5a0, 0x2, 0x2, 0x7f13a95d0b50, 0x0, ...)\n    /root/go/src/launchpad.net/go-dbus/v1/dbus.go:77 +0x1d1\nlaunchpad.net/ubuntu-push/bus.(*endpoint).GetProperty(0xc20803e0c0, 0x5eac50, 0x5, 0x0, 0x0, 0x0, 0x0)\n    /root/go/src/launchpad.net/ubuntu-push/bus/endpoint.go:169 +0x1cf\nlaunchpad.net/ubuntu-push/bus/networkmanager.(*networkManager).GetState(0xc20800a0c0, 0x5bce80)\n    /root/go/src/launchpad.net/ubuntu-push/bus/networkmanager/networkmanager.go:79 +0x62\nmain.main()\n</code></pre>\n"}, {"tags": ["ubuntu", "go", "launchpad"], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1435913355, "post_id": 31202358, "comment_id": 50407595, "body": "I get a lot of compilation errors[0], most likely from other &quot;subpackages&quot;. I&#39;m wondering if it&#39;s possible to get only the networkmanager package not the whole repository. That  seems possible on git / github. <a href=\"http://pastebin.com/LNmSCfxJ\" rel=\"nofollow noreferrer\">pastebin.com/LNmSCfxJ</a>"}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1435913634, "post_id": 31202358, "comment_id": 50407757, "body": "sorry for the noise... it seems to work after all. go get launchpad.net/ubuntu-push/bus/networkmanager"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1435915454, "post_id": 31202358, "comment_id": 50408912, "body": "My fault. I could have noticed that you are only interested in the networkmanager package."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 0, "last_activity_date": 1435912914, "creation_date": 1435912914, "answer_id": 31202358, "question_id": 31202028, "link": "https://stackoverflow.com/questions/31202028/how-to-go-get-ubuntu-launchpad-bazaar-packages/31202358#31202358", "title": "How to go get ubuntu launchpad/bazaar packages?", "body": "<p>With <code>go get</code> you work on packages and not on git refs or file system paths.</p>\n\n<p>Try</p>\n\n<pre><code>go get launchpad.net/ubuntu-push\n</code></pre>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 233, "favorite_count": 0, "accepted_answer_id": 31202358, "answer_count": 1, "score": 0, "last_activity_date": 1435912914, "creation_date": 1435911900, "question_id": 31202028, "link": "https://stackoverflow.com/questions/31202028/how-to-go-get-ubuntu-launchpad-bazaar-packages", "title": "How to go get ubuntu launchpad/bazaar packages?", "body": "<p>I'm trying to go get <a href=\"http://bazaar.launchpad.net/~ubuntu-push-hackers/ubuntu-push/trunk/view/head:/bus/networkmanager\" rel=\"nofollow\">http://bazaar.launchpad.net/~ubuntu-push-hackers/ubuntu-push/trunk/view/head:/bus/networkmanager</a></p>\n\n<p>I've tried :\ngo get bazaar.launchpad.net/~ubuntu-push-hackers/ubuntu-push/bus/networkmanager</p>\n\n<pre><code>package bazaar.launchpad.net/~ubuntu-push-hackers/ubuntu-push/bus/networkmanager: unrecognized import path \"bazaar.launchpad.net/~ubuntu-push-hackers/ubuntu-push/bus/networkmanager\"\n</code></pre>\n\n<p>go get bazaar.launchpad.net/ubuntu-push-hackers/ubuntu-push/bus/networkmanager</p>\n\n<pre><code>Same result as above\n</code></pre>\n\n<p>go get launchpad.net/ubuntu-push-hackers/ubuntu-push/bus/networkmanager</p>\n\n<pre><code># cd .; bzr branch https://launchpad.net/ubuntu-push-hackers /root/go/src/launchpad.net/ubuntu-push-hackers\nbzr: ERROR: Not a branch: \"https://launchpad.net/ubuntu-push-hackers/\".\npackage launchpad.net/ubuntu-push-hackers/ubuntu-push/bus/networkmanager: exit status 3\n</code></pre>\n"}, {"tags": ["testing", "go"], "answers": [{"tags": [], "owner": {"reputation": 4195, "user_id": 2432477, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0a516bc16804edd78d8f6c2a7e06f07b?s=128&d=identicon&r=PG&f=1", "display_name": "nouney", "link": "https://stackoverflow.com/users/2432477/nouney"}, "is_accepted": false, "score": 3, "last_activity_date": 1435912002, "creation_date": 1435912002, "answer_id": 31202063, "question_id": 31201858, "link": "https://stackoverflow.com/questions/31201858/how-to-run-golang-tests-sequentially/31202063#31202063", "title": "How to run golang tests sequentially?", "body": "<p>The best way to achieve that is to create a <code>TestMain</code>, as presented <a href=\"http://golang.org/pkg/testing/#pkg-overview\" rel=\"nofollow\">here</a>. </p>\n\n<pre><code>import (\n  \"testing\"\n  \"os\"\n)\n\nfunc TestMain(m *testing.M) {\n   // Do your stuff here\n   os.Exit(m.Run())\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1159, "user_id": 666397, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/097ee41669d9e37f526dfcf396a632b0?s=128&d=identicon&r=PG", "display_name": "Atifm", "link": "https://stackoverflow.com/users/666397/atifm"}, "edited": false, "score": 2, "creation_date": 1572891588, "post_id": 31204016, "comment_id": 103694333, "body": "This makes sense for unit tests, where you are testing mocked data sources, but when you have an integration test, making the integration tests run sequentially may be a reasonable requirement."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 36, "last_activity_date": 1516659993, "last_edit_date": 1516659993, "creation_date": 1435917798, "answer_id": 31204016, "question_id": 31201858, "link": "https://stackoverflow.com/questions/31201858/how-to-run-golang-tests-sequentially/31204016#31204016", "title": "How to run golang tests sequentially?", "body": "<p>You can't / shouldn't rely on test execution order. The order in which tests are executed is not defined, and with the use of <a href=\"https://golang.org/cmd/go/#hdr-Description_of_testing_flags\" rel=\"noreferrer\">testing flags</a> it is possible to exclude tests from running, so you have no guarantee that they will run at all.</p>\n\n<p>For example the following command will only run tests whose name contains a <code>'W'</code> letter:</p>\n\n<pre><code>go test -run W\n</code></pre>\n\n<p>Also note that if some test functions mark themselves eligible for parallel execution using the <a href=\"https://golang.org/pkg/testing/#T.Parallel\" rel=\"noreferrer\"><code>T.Parallel()</code></a> method, the go tool will reorder the tests to first run non-parallel tests, and then run parallel tests in parallel under certain circumstances (controlled by test flags like <code>-p</code>). You can see examples of this in this answer: <a href=\"https://stackoverflow.com/questions/44325232/are-tests-executed-in-parallel-in-go-or-one-by-one/44326377#44326377\">Are tests executed in parallel in Go or one by one?</a></p>\n\n<p>Tests should be <em>independent</em> from each other. If a test function has prerequisites, that cannot be done/implemented in another test function.</p>\n\n<p><strong>Options to do additional tasks before a test function is run:</strong></p>\n\n<ul>\n<li>You may put it in the test function itself</li>\n<li>You may put it in a package <code>init()</code> function, in the <code>_test.go</code> file itself. This will run once before execution of test functions begins.</li>\n<li>You may choose to implement a <a href=\"http://golang.org/pkg/testing/#pkg-overview\" rel=\"noreferrer\"><code>TestMain()</code></a> function which will be called first and in which you may do additional setup before you call <a href=\"http://golang.org/pkg/testing/#M.Run\" rel=\"noreferrer\"><code>M.Run()</code></a> to trigger the execution of test functions.</li>\n<li>You may mix the above options.</li>\n</ul>\n\n<p>In your case in package <code>init()</code> or <code>TestMain()</code> you should check if your DB is initialized (there are test records inserted), and if not, insert the test records.</p>\n\n<p>Note that starting with Go 1.7, you may use subtests in which you define execution order of subtests. For details see blog post: <a href=\"https://blog.golang.org/subtests\" rel=\"noreferrer\">Using Subtests and Sub-benchmarks</a>, and the package doc of the <a href=\"https://golang.org/pkg/testing/#hdr-Subtests_and_Sub_benchmarks\" rel=\"noreferrer\"><code>testing</code></a> package.</p>\n"}, {"comments": [{"owner": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "edited": false, "score": 0, "creation_date": 1478267831, "post_id": 39734200, "comment_id": 68097155, "body": "Can you confirm that the order is actually controlled by grouping the tests this way? The docs say that you can control paralellism but not that they will necessarily be run in the order that <code>t.Run</code> is called.  Race conditions are so hard to verify... I will reply back if I find any definitive evidence either way."}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 2756, "user_id": 1375316, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/62627013dd03b525ba5954cff57b0f9b?s=128&d=identicon&r=PG", "display_name": "threeve", "link": "https://stackoverflow.com/users/1375316/threeve"}, "edited": false, "score": 0, "creation_date": 1478438191, "post_id": 39734200, "comment_id": 68144860, "body": "@threeve they run sequentially for sure. You are basically running a single test this way."}], "tags": [], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "is_accepted": false, "score": 15, "last_activity_date": 1480429089, "last_edit_date": 1480429089, "creation_date": 1475009945, "answer_id": 39734200, "question_id": 31201858, "link": "https://stackoverflow.com/questions/31201858/how-to-run-golang-tests-sequentially/39734200#39734200", "title": "How to run golang tests sequentially?", "body": "<p>Apart for 3rd party libraries like <a href=\"https://github.com/smartystreets/goconvey\" rel=\"noreferrer\">Convey</a> and <a href=\"https://github.com/onsi/ginkgo\" rel=\"noreferrer\">Ginkgo</a>, with plain Golang 1.7 you can run tests sequentially. You can read more <a href=\"https://tip.golang.org/pkg/testing/#hdr-Subtests_and_Sub_benchmarks\" rel=\"noreferrer\">here</a></p>\n\n<pre><code>func TestFoo(t *testing.T) {\n    // &lt;setup code&gt;\n    t.Run(\"A=1\", func(t *testing.T) { ... })\n    t.Run(\"A=2\", func(t *testing.T) { ... })\n    t.Run(\"B=1\", func(t *testing.T) { ... })\n    // &lt;tear-down code&gt;\n}\n</code></pre>\n\n<p>And you can run them conditionally with:</p>\n\n<pre><code>go test -run ''      # Run all tests.\ngo test -run Foo     # Run top-level tests matching \"Foo\", such as \"TestFooBar\".\ngo test -run Foo/A=  # For top-level tests matching \"Foo\", run subtests matching \"A=\".\ngo test -run /A=1    # For all top-level tests, run subtests matching \"A=1\".\n</code></pre>\n\n<p>So lets say you got an <code>user</code> package from a REST api that you want to test. You need to test the create handler in order to be able to test the login handler. Usually I would have this on the <code>user_test.go</code></p>\n\n<pre><code>type UserTests struct { Test *testing.T}\nfunc TestRunner(t *testing.T) {\n\n    t.Run(\"A=create\", func(t *testing.T) {\n        test:= UserTests{Test: t}\n        test.TestCreateRegularUser()\n        test.TestCreateConfirmedUser()\n        test.TestCreateMasterUser()\n        test.TestCreateUserTwice()\n    })\n    t.Run(\"A=login\", func(t *testing.T) {\n        test:= UserTests{Test: t}\n        test.TestLoginRegularUser()\n        test.TestLoginConfirmedUser()\n        test.TestLoginMasterUser()\n    })\n\n}\n</code></pre>\n\n<p>Then I can append methods to the UserTest type that wont be executed by the <code>go test</code> command in any <code>_test.go</code> file</p>\n\n<pre><code>func (t *UserTests) TestCreateRegularUser() {\n    registerRegularUser := util.TableTest{\n        Method:      \"POST\",\n        Path:        \"/iot/users\",\n        Status:      http.StatusOK,\n        Name:        \"registerRegularUser\",\n        Description: \"register Regular User has to return 200\",\n        Body: SerializeUser(RegularUser),\n    }\n    response := util.SpinSingleTableTests(t.Test, registerRegularUser)\n    util.LogIfVerbose(color.BgCyan, \"IOT/USERS/TEST\", response)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 557, "user_id": 3443964, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2a5db881730f94c9ff8f04a8456ffa8c?s=128&d=identicon&r=PG", "display_name": "Alik Khilazhev", "link": "https://stackoverflow.com/users/3443964/alik-khilazhev"}, "is_accepted": false, "score": 7, "last_activity_date": 1591346798, "creation_date": 1591346798, "answer_id": 62211469, "question_id": 31201858, "link": "https://stackoverflow.com/questions/31201858/how-to-run-golang-tests-sequentially/62211469#62211469", "title": "How to run golang tests sequentially?", "body": "<p>For those who as I am is getting problems because of multiple concurring tests running simultaneously. I found a way to limit the maximum number of test running in parallel:</p>\n\n<pre class=\"lang-sh prettyprint-override\"><code>go test -p 1\n</code></pre>\n\n<p>With this, your test will run sequentially one by one. </p>\n\n<p><a href=\"https://medium.com/@teivah/how-to-run-go-tests-sequentially-a2a206e223b\" rel=\"noreferrer\">Source</a></p>\n"}], "owner": {"reputation": 1109, "user_id": 4160987, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/0fe8027fb4a18d37c60f9ecd3268491e?s=128&d=identicon&r=PG&f=1", "display_name": "Varun Patro", "link": "https://stackoverflow.com/users/4160987/varun-patro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 28857, "favorite_count": 5, "accepted_answer_id": 31204016, "answer_count": 4, "score": 21, "last_activity_date": 1591346798, "creation_date": 1435911292, "last_edit_date": 1435920716, "question_id": 31201858, "link": "https://stackoverflow.com/questions/31201858/how-to-run-golang-tests-sequentially", "title": "How to run golang tests sequentially?", "body": "<p>When I run <code>go test</code>, my output:</p>\n\n<pre><code>--- FAIL: TestGETSearchSuccess (0.00s)\n        Location:       drivers_api_test.go:283\n        Error:          Not equal: 200 (expected)\n                                != 204 (actual)\n\n--- FAIL: TestGETCOSearchSuccess (0.00s)\n        Location:       drivers_api_test.go:391\n        Error:          Not equal: 200 (expected)\n                                != 204 (actual)\n</code></pre>\n\n<p>But after I run <code>go test</code> again, all my tests pass.</p>\n\n<p>Tests fail only when I reset my mysql database, and then run <code>go test</code> for the first time. </p>\n\n<p>For every <code>GET</code> request, I do a <code>POST</code> request before to ensure that there is data created in the DB. </p>\n\n<p>Could anyone help me with how to make sure that tests are run sequentially? That is the <code>POST</code> requests are run before the <code>GET</code> requests?</p>\n"}, {"tags": ["go", "monkeypatching"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 4, "last_activity_date": 1435920572, "creation_date": 1435920572, "answer_id": 31204993, "question_id": 31201822, "link": "https://stackoverflow.com/questions/31201822/monkey-patching-instance-in-go/31204993#31204993", "title": "Monkey patching instance in Go", "body": "<p>No, you can't monkeypatch things like that in Go. Structs are defined at compile time, you can't add fields at runtime.</p>\n\n<blockquote>\n  <p>I can solve this through inheritance (\u2026)</p>\n</blockquote>\n\n<p>No you can't because there is no inheritance in Go. You can solve it through <em>composition:</em></p>\n\n<pre><code>type FooWithFlag struct {\n    Foo\n    Flag bool\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "is_accepted": false, "score": 0, "last_activity_date": 1435934838, "creation_date": 1435934838, "answer_id": 31209492, "question_id": 31201822, "link": "https://stackoverflow.com/questions/31201822/monkey-patching-instance-in-go/31209492#31209492", "title": "Monkey patching instance in Go", "body": "<p>you could also use the <code>json:\",omitempty\"</code> option on your flag</p>\n\n<p>an example:</p>\n\n<p><a href=\"http://play.golang.org/p/ebmZLR8DLj\" rel=\"nofollow\">http://play.golang.org/p/ebmZLR8DLj</a></p>\n"}, {"tags": [], "owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "is_accepted": false, "score": 2, "last_activity_date": 1435951180, "creation_date": 1435951180, "answer_id": 31213056, "question_id": 31201822, "link": "https://stackoverflow.com/questions/31201822/monkey-patching-instance-in-go/31213056#31213056", "title": "Monkey patching instance in Go", "body": "<p>You can always define a custom <a href=\"http://golang.org/pkg/encoding/json/#Marshaler\" rel=\"nofollow\"><code>Marshaler</code></a> / <a href=\"http://golang.org/pkg/encoding/json/#Unmarshaler\" rel=\"nofollow\"><code>Unmarshaler</code></a> interface and handle it in your type:</p>\n\n<pre><code>type X struct {\n    b bool\n}\n\nfunc (x *X) MarshalJSON() ([]byte, error) {\n    out := map[string]interface{}{\n        \"b\": x.b,\n    }\n    if x.b {\n        out[\"other-custom-field\"] = \"42\"\n    }\n    return json.Marshal(out)\n}\n\nfunc (x *X) UnmarshalJSON(b []byte) (err error) {\n    var m map[string]interface{}\n    if err = json.Unmarshal(b, &amp;m); err != nil {\n        return\n    }\n    x.b, _ = m[\"b\"].(bool)\n    if x.b {\n        if v, ok := m[\"other-custom-field\"].(string); ok {\n            log.Printf(\"got a super secret value: %s\", v)\n        }\n    }\n    return\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/vtp6Ajk7Jr\" rel=\"nofollow\"><kbd>playground</kbd></a></p>\n"}], "owner": {"reputation": 9004, "user_id": 1800871, "user_type": "registered", "accept_rate": 42, "profile_image": "https://i.stack.imgur.com/J3ezH.png?s=128&g=1", "display_name": "PaolaJ.", "link": "https://stackoverflow.com/users/1800871/paolaj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 539, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1435951180, "creation_date": 1435911168, "question_id": 31201822, "link": "https://stackoverflow.com/questions/31201822/monkey-patching-instance-in-go", "title": "Monkey patching instance in Go", "body": "<p>I have structure with some fields inside and I Marshall that structure and return <code>json to client</code>. I <code>cannot change json nor structure</code> but in some corner cases I have to add one more additional flag. Is possible <code>instance monkey patching</code> in Go and how to achieve that ?\nI can solve this through inheritance but I would love to see if dynamically adding property to instance of structure is possible in Go. </p>\n"}, {"tags": ["go", "netlink", "iproute"], "answers": [{"tags": [], "owner": {"reputation": 5822, "user_id": 546218, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/f6f59bf629073f1eb8cdd492d10386c4?s=128&d=identicon&r=PG", "display_name": "rocky", "link": "https://stackoverflow.com/users/546218/rocky"}, "is_accepted": false, "score": 0, "last_activity_date": 1436148789, "last_edit_date": 1436148789, "creation_date": 1436148439, "answer_id": 31236901, "question_id": 31198760, "link": "https://stackoverflow.com/questions/31198760/what-field-corresponds-to-dev-device-param-in-netlink/31236901#31236901", "title": "What field corresponds to &quot;dev&quot; (device) param in netlink?", "body": "<p>Looking at the link you sent, I'd guess <code>IifName</code>. And looking <a href=\"https://github.com/krhubert/netlink/blob/master/rule_test.go#L37\" rel=\"nofollow\">at the code</a> seems to confirm that.</p>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1436148789, "creation_date": 1435899289, "last_edit_date": 1435903397, "question_id": 31198760, "link": "https://stackoverflow.com/questions/31198760/what-field-corresponds-to-dev-device-param-in-netlink", "title": "What field corresponds to &quot;dev&quot; (device) param in netlink?", "body": "<p>I'm trying to add a new route using the <a href=\"http://godoc.org/github.com/krhubert/netlink#Route\" rel=\"nofollow\">netlink</a> package. The equivalent I need is <code>ip route add $P1_NET dev $IF1 src $IP1 table $T1</code>. The issue is that I don't know what field corresponds to the <code>dev</code> parameter. Is there a mapping somewhere or can I use the interface index instead its name (\"dev\")?</p>\n"}, {"tags": ["concurrency", "go", "synchronization", "race-condition"], "answers": [{"comments": [{"owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 0, "creation_date": 1435902439, "post_id": 31199275, "comment_id": 50402188, "body": "Thanks for fast comment. The point is the initiation (write) could be concurrent and there&#39;s no good place to do a &quot;freeze&quot;. but eventually the write would be done and no more. Initially I&#39;m thinking of proactively waiting 10 second to guarantee writes are over and flushed to memory. however I&#39;d like to see if I missed something."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 1, "creation_date": 1435902874, "post_id": 31199275, "comment_id": 50402341, "body": "I&#39;ve just realized that my suggested solution is wrong (because readonly field is read without lock). This is just proves that using locks is the best way to make it correct."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "reply_to_user": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 0, "creation_date": 1435902975, "post_id": 31199275, "comment_id": 50402381, "body": "Rules that describe when write to variable becomes visible can be found here: <a href=\"http://golang.org/ref/mem\" rel=\"nofollow noreferrer\">golang.org/ref/mem</a>"}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": false, "score": 1, "last_activity_date": 1435904739, "last_edit_date": 1435904739, "creation_date": 1435902040, "answer_id": 31199275, "question_id": 31198562, "link": "https://stackoverflow.com/questions/31198562/when-can-safely-access-mutex-protected-variable-without-locking/31199275#31199275", "title": "When can safely access mutex protected variable without locking?", "body": "<p><code>RLock</code> and <code>RUnlock</code> are very fast operations. If there are no writers they are essentially lockless and take just 1 atomic operation each (<a href=\"http://golang.org/src/sync/rwmutex.go?h=RLock#L29\" rel=\"nofollow\">http://golang.org/src/sync/rwmutex.go?h=RLock#L29</a>). So unless your application performs poorly because reading configuration is slow I would suggest to use <code>RWLock</code>.</p>\n\n<p>Note, that my initial answer was a proposal to implement <code>Freeze()</code> operation for <code>Register</code> but later I realized that the correct implementation won't be any faster than using RWLock.</p>\n"}, {"comments": [{"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1435905430, "post_id": 31199866, "comment_id": 50403397, "body": "I believe you will have to use <code>LoadPointer</code> to read from a map in this case."}, {"owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 0, "creation_date": 1435906413, "post_id": 31199866, "comment_id": 50403860, "body": "but one thing I still feel not sure is the possible overhead comparison between RWMutex.RLock (an atomic add for pure read) and an atomic LoadPointer. I know it&#39;s very trivial in most system but not sure if anyway to fully get rid of them."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1435909953, "post_id": 31199866, "comment_id": 50405800, "body": "@kostya: if we were going fully lock free, then <code>LoadPointer</code> would be necessary, yes.  With a mutex protecting updates, it shouldn&#39;t be necessary.  The <code>StorePointer</code> is for the benefit of the readers."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "edited": false, "score": 0, "creation_date": 1435910096, "post_id": 31199866, "comment_id": 50405885, "body": "@JasonXu: acquiring the read lock is cheap provided no one has the write lock.  The benefit of RCU is that readers aren&#39;t blocked at all by writes.  Of course, this is only appropriate if you&#39;re okay with readers seeing the old value before the update completes."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1435933709, "post_id": 31199866, "comment_id": 50420043, "body": "@JamesHenstridge, would you mind to explain why is that?"}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1435936058, "post_id": 31199866, "comment_id": 50421379, "body": "@JamesHenstridge, race detector reports a data race in the following program <a href=\"http://play.golang.org/p/iHU2JCgrFl\" rel=\"nofollow noreferrer\">play.golang.org/p/iHU2JCgrFl</a>, note that when using LoadInt32 there is no data race"}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 1, "creation_date": 1436000662, "post_id": 31199866, "comment_id": 50438010, "body": "@kostya: there is a race in the sense that the reader will either see the old or new version of the pointer, but they will never see an intermediate version of the map.  If you need more guarantees than  that, then perhaps the RWLock is more appropriate."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436109703, "post_id": 31199866, "comment_id": 50462374, "body": "At the same time there are no guarantees in the Go spec that StorePointer(&amp;x) happens before reading from x. Correct me if I am wrong but I believe it means that goroutine reading from x can see intermediate version of the map. Also (though very unlikely) it is possible that a reading goroutine will never see an updated value (e.g. when map pointer is cached in a register or processor cache)."}, {"owner": {"reputation": 6783, "user_id": 55504, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69443d894baa7969afa69ca6b34b725b?s=128&d=identicon&r=PG", "display_name": "Dave C", "link": "https://stackoverflow.com/users/55504/dave-c"}, "edited": false, "score": 1, "creation_date": 1436110141, "post_id": 31199866, "comment_id": 50462508, "body": "Note that the <code>sync&#47;atomic</code> package provides <a href=\"https://golang.org/pkg/sync/atomic/#Value\" rel=\"nofollow noreferrer\"><code>atomic.Value</code></a> which can be easier/better than <code>atomic.StorePointer</code> depending on what you&#39;re doing (e.g. the documentation includes an <a href=\"https://golang.org/pkg/sync/atomic/#example_Value_readMostly\" rel=\"nofollow noreferrer\">example showing a safe rarely modified map</a> via copy on write)."}, {"owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "reply_to_user": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436141872, "post_id": 31199866, "comment_id": 50471096, "body": "@kostya: if the reader dereferences <code>x</code> before the <code>StorePointer</code> call, then it will access the old map.  There is no way the reader could access an intermediate version of the map because it has no way of knowing where it is stored until after the pointer update."}, {"owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "edited": false, "score": 0, "creation_date": 1436143227, "post_id": 31199866, "comment_id": 50471302, "body": "@JamesHenstridge, what if a processor or a compiler reorders StorePointer call and operations before it? Or StorePointer value becomes visible to a reader thread, but memory effects from map assignment still haven&#39;t been flushed to the main memory from a processor cache?"}], "tags": [], "owner": {"reputation": 36091, "user_id": 721283, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9d9b7698c26959f57c0e3814005b8b52?s=128&d=identicon&r=PG", "display_name": "James Henstridge", "link": "https://stackoverflow.com/users/721283/james-henstridge"}, "is_accepted": true, "score": 1, "last_activity_date": 1435904520, "creation_date": 1435904520, "answer_id": 31199866, "question_id": 31198562, "link": "https://stackoverflow.com/questions/31198562/when-can-safely-access-mutex-protected-variable-without-locking/31199866#31199866", "title": "When can safely access mutex protected variable without locking?", "body": "<p>As long as no one is modifying the map, it should be safe for multiple threads to read it at once.  Unfortunately, without any locking you'll have no way to make sure no one else is reading the map when you want to update it.</p>\n\n<p>So one solution is to never update the map, but instead replace it atomically.  The <a href=\"https://en.wikipedia.org/wiki/Read-copy-update\" rel=\"nofollow\">read-copy-update</a> algorithm could be used here.  Rather than directly accessing the map, so you need to dereference the pointer to access the map.  To update it, you can do the following:</p>\n\n<ol>\n<li>acquire an \"update lock\" mutex.</li>\n<li>make a copy of the map.  You want to copy all keys/values manually: simple assignment won't work because maps are reference types.</li>\n<li>make your changes to the copy of the map.</li>\n<li>use <code>StorePointer</code> from the <code>sync/atomic</code> package to atomically update the pointer to the live map to point to your new map.</li>\n<li>release the mutex.</li>\n</ol>\n\n<p>Everything that runs before the atomic update in (4) will see the old map, and everything after will see the new map.  At no point will those goroutines be reading from a map that is being written to, so there is no need for an <code>RWMutex</code>.</p>\n"}], "owner": {"reputation": 2581, "user_id": 1682262, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/0fe729661b718d6f6ba16ec8cf6b0e90?s=128&d=identicon&r=PG", "display_name": "Jason Xu", "link": "https://stackoverflow.com/users/1682262/jason-xu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 31199866, "answer_count": 2, "score": 1, "last_activity_date": 1435904739, "creation_date": 1435898220, "last_edit_date": 1435902123, "question_id": 31198562, "link": "https://stackoverflow.com/questions/31198562/when-can-safely-access-mutex-protected-variable-without-locking", "title": "When can safely access mutex protected variable without locking?", "body": "<p>A common pattern of storing config in my code is a \"map[string]interface{}\" protected by RWMutex, but usually after app initiated (could be triggered in multiple go-routine), the map becomes totally readonly. So I have a feeling that from some point of time on, the RWMutex on read should be unnecessary. </p>\n\n<p>An example of this config map is at \n<a href=\"http://play.golang.org/p/tkbj9DBok_\" rel=\"nofollow\">http://play.golang.org/p/tkbj9DBok_</a></p>\n\n<p>One fact that brought me to think of this is in some of production code it actually doing this way of unprotected access of shared object (though it's mostly readonly after it's init'ed), I understand normal way of using RWMutex to protect, but interesting part is this malformed code haven't run into problem in past months.</p>\n\n<p>Is that true that after some accurate \"time point\" that writes are flushed from cache into memory and with a guarantee of no more writes needed, reads can actually go without RWMutex.RLock? If YES, when is the time point or how to setup the conditions before lockless access?</p>\n"}, {"tags": ["json", "struct", "go", "instagram-api"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1435876702, "post_id": 31195707, "comment_id": 50396002, "body": "I think you can use tags on struct types too. Just &quot;rename&quot; your StandardResolution struct via <code>json: &quot;Standard_Resolution&quot;</code>. Go is really dead regular. I didn&#39;t try it ."}, {"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1435876709, "post_id": 31195707, "comment_id": 50396006, "body": "A minimal working example would help on debugging with a plain go compiler. My golang.org Language Specification says <a href=\"http://golang.org/ref/spec#IdentifierList\" rel=\"nofollow noreferrer\">golang.org/ref/spec#IdentifierList</a> that underscore is a valid part of an identifier"}, {"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 1, "creation_date": 1435876878, "post_id": 31195707, "comment_id": 50396066, "body": "But adding a <code>json:&quot;Standard_Resolution&quot;</code> should help too and should make things clearer."}, {"owner": {"reputation": 1150, "user_id": 1988272, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/MKKR5.jpg?s=128&g=1", "display_name": "codingninja", "link": "https://stackoverflow.com/users/1988272/codingninja"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1435877358, "post_id": 31195707, "comment_id": 50396196, "body": "I didnt realize that I could rename my struct by adding <code>json:&quot;standard_resolution&quot;</code> after the brace, I was adding it after the word <code>struct</code>, hence i was getting an error. thanks @volker @ikrabbe"}, {"owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 0, "creation_date": 1435877429, "post_id": 31195707, "comment_id": 50396214, "body": "You realize that if you translate into non-nested structure definitions, as in my attempt to answer, below."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "reply_to_user": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "edited": false, "score": 2, "creation_date": 1435878153, "post_id": 31195707, "comment_id": 50396435, "body": "@ikrabbe The &quot;no underscores&quot; issue is a <i>style</i> recommendation from <code>go vet</code> (which Go Plus would run) rather than a &quot;breaks the OP&#39;s program&quot; issue."}], "answers": [{"tags": [], "owner": {"reputation": 1791, "user_id": 5022759, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Hg0HA.png?s=128&g=1", "display_name": "ikrabbe", "link": "https://stackoverflow.com/users/5022759/ikrabbe"}, "is_accepted": false, "score": 2, "last_activity_date": 1435877141, "creation_date": 1435877141, "answer_id": 31195847, "question_id": 31195707, "link": "https://stackoverflow.com/questions/31195707/golang-nested-structs-unmarshaling-with-underscores/31195847#31195847", "title": "Golang nested structs unmarshaling with underscores", "body": "<p>Anyway it is easier to read if you don't use nested structs.</p>\n\n<pre><code>type RDUser struct { ... }\ntype RDStandardResolution struct { ... }\ntype RDImages struct {\n    StandardResolition RDStandardResolution `json:\"standard_resolution\"`\n}\ntype ResponseData struct {\n    ...\n    User RDUser `json:\"user\"`\n    Images RDImages `json:\"images\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 1150, "user_id": 1988272, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/MKKR5.jpg?s=128&g=1", "display_name": "codingninja", "link": "https://stackoverflow.com/users/1988272/codingninja"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1346, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1435882744, "creation_date": 1435876338, "last_edit_date": 1435882744, "question_id": 31195707, "link": "https://stackoverflow.com/questions/31195707/golang-nested-structs-unmarshaling-with-underscores", "title": "Golang nested structs unmarshaling with underscores", "body": "<p>I am writing an app using the Instagram API. \nI am receiving a JSON request and that gets <code>Unmarshal</code>'ed into nested structs.</p>\n\n<pre><code>// the nested structs\ntype ResponseData struct {\n    ID   string `json:\"id\"`\n    Link string `json:\"link\"`\n    Type string `json:\"type\"`\n    User struct {\n        FullName       string `json:\"full_name\"`\n        ID             int    `json:\"id\"`\n        ProfilePicture string `json:\"profile_picture\"`\n        Username       string `json:\"username\"`\n    }\n    Images struct {\n        Standard_Resolution struct {\n            URL string `json:\"url\"`\n        }\n    }\n}\n</code></pre>\n\n<p>For the Image url to be added it needs to have the underscore in <code>Standard_Resolution</code> , I am using <a href=\"https://github.com/joefitzgerald/go-plus\" rel=\"nofollow\">Go Plus</a> Package for Atom and I get the lint warning: </p>\n\n<blockquote>\n  <p>don't use underscores in Go names; struct field Standard_Resolution\n  should be StandardResolution</p>\n</blockquote>\n\n<p>Is there another way for me fix the error and still have the value in my struct.</p>\n\n<p><strong>Update:</strong></p>\n\n<p>I can add an identifier after the last brace for <code>StandardResolution</code>.</p>\n\n<pre><code>StandardResolution struct {\n    URL string `json:\"url\"`\n} `json:\"standard_resolution\"`\n</code></pre>\n"}, {"tags": ["ssl", "go", "rsa", "token", "jwt"], "comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 1, "creation_date": 1435875103, "post_id": 31195469, "comment_id": 50395485, "body": "I highly recommend against using RSA (esp. with a 1024 bit key) for a JSON Web Token. It really doesn&#39;t offer practical benefits over just using <code>jwt.GetSigningMethod(&quot;HS256&quot;)</code> - which is HMAC-SHA-256. RSA is just easier to get wrong."}, {"owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435890189, "post_id": 31195469, "comment_id": 50399140, "body": "@elithrar RSA vs HMAC ~ public key vs symmetric key; which is preferable depends on use case.  And in what way is RSA &quot;just easier to get wrong&quot;?  The JWT library should do the heavy lifting."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435893492, "post_id": 31195469, "comment_id": 50399780, "body": "HMAC-SHA-256 is simple: you provide a key, it MACs it. RSA is more reliant on key strength (1024 won&#39;t cut it), many of the recent JWT vulns have been related to RSA keys, and it adds more complexity (parsing certs/private keys. Unless you have some pressing need for the client to self-verify the token with your public key, there&#39;s little to be gained."}, {"owner": {"reputation": 4773, "user_id": 4148211, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/DiKJf.jpg?s=128&g=1", "display_name": "frasertweedale", "link": "https://stackoverflow.com/users/4148211/frasertweedale"}, "reply_to_user": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435988092, "post_id": 31195469, "comment_id": 50435124, "body": "@elithrar there are use cases which require public key algorithms that have nothing to do with clients validating tokens, e.g. where the relying party is a third-party.  You can&#39;t give a third-party your HMAC secret.  The questioner has said nothing about how the tokens they are generating are used."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435991986, "post_id": 31195469, "comment_id": 50435958, "body": "Well aware. What I&#39;m trying to say is that &quot;if you have to ask how to generate RSA keys and conflate them with SSL, there&#39;s a high likelihood that you don&#39;t need to use RSA keys.&quot; Those use cases are typically well defined (as you point out). JWTs for a SPA with React or Angular don&#39;t need RSA signed JWTs."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 5914933, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8d3f0e73d6186a081fe7c7fdfab41fb7?s=128&d=identicon&r=PG&f=1", "display_name": "Dennis John", "link": "https://stackoverflow.com/users/5914933/dennis-john"}, "is_accepted": false, "score": 0, "last_activity_date": 1481001801, "creation_date": 1481001801, "answer_id": 40988364, "question_id": 31195469, "link": "https://stackoverflow.com/questions/31195469/golang-jwt-no-signature-crypto-rsa-verification-error/40988364#40988364", "title": "golang JWT No Signature. &quot;crypto/rsa: verification error&quot;", "body": "<p>This worked for me. I generated the private.pem and public.pem using these commands.</p>\n\n<pre><code>openssl genrsa -des3 -out private.pem 1024\nopenssl rsa -in private.pem -outform PEM -pubout -out public.pem\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/dgrijalva/jwt-go\"\n    \"io/ioutil\"\n    \"log\"\n    \"time\"\n)\n\n//Claims can have user id.. etc for Identification purpose\ntype AppClaims struct {\n    UserId string `json:\"userId\"`\n    jwt.StandardClaims\n}\n\nvar (\n    privateKey []byte\n    publicKey  []byte\n    err        error\n)\n\nconst (\n    longForm = \"Jan 2, 2006 at 3:04pm (MST)\"\n)\n\nfunc errLog(err error) {\n    if err != nil {\n        log.Fatal(\"Error:\", err.Error())\n    }\n}\n\nfunc init() {\n    privateKey, err = ioutil.ReadFile(\"../private.pem\")\n    errLog(err)\n    publicKey, err = ioutil.ReadFile(\"../public.pem\")\n    errLog(err)\n}\n\nfunc jwtTokenGen() (interface{}, error) {\n    privateRSA, err := jwt.ParseRSAPrivateKeyFromPEM(privateKey)\n    if err != nil {\n        return nil, err\n    }\n    claims := AppClaims{\n        \"RAJINIS*\",\n        jwt.StandardClaims{\n            ExpiresAt: time.Now().Add(time.Minute * 15).Unix(),\n            Issuer:    \"test\",\n        },\n    }\n    token := jwt.NewWithClaims(jwt.SigningMethodRS256, claims)\n    ss, err := token.SignedString(privateRSA)\n    return ss, err\n}\n\nfunc jwtTokenRead(inToken interface{}) (interface{}, error) {\n    publicRSA, err := jwt.ParseRSAPublicKeyFromPEM(publicKey)\n    if err != nil {\n        return nil, err\n    }\n    token, err := jwt.Parse(inToken.(string), func(token *jwt.Token) (interface{}, error) {\n        if _, ok := token.Method.(*jwt.SigningMethodRSA); !ok {\n            return nil, fmt.Errorf(\"Unexpected signing method: %v\", token.Header[\"alg\"])\n        }\n        return publicRSA, err\n    })\n\n    if claims, ok := token.Claims.(jwt.MapClaims); ok &amp;&amp; token.Valid {\n        return claims, nil\n    } else {\n        return nil, err\n    }\n}\n\nfunc getTokenRemainingValidity(timestamp interface{}) int {\n    expireOffset := 0\n    if validity, ok := timestamp.(float64); ok {\n        tm := time.Unix(int64(validity), 0)\n        remainder := tm.Sub(time.Now())\n        if remainder &gt; 0 {\n            fmt.Println(remainder)\n            return int(remainder.Seconds()) + expireOffset\n        }\n    }\n    return expireOffset\n}\n\nfunc main() {\n    signedString, err := jwtTokenGen()\n    fmt.Println(signedString, err)\n    claims, err := jwtTokenRead(signedString)\n    if err != nil {\n        errLog(err)\n    }\n    claimValue := claims.(jwt.MapClaims)\n    fmt.Println(claimValue[\"iss\"], claimValue[\"exp\"], claimValue[\"userId\"])\n    //  t, _ := time.Parse(longForm, string(claimValue[\"exp\"].(float64)))\n    fmt.Println(getTokenRemainingValidity(claimValue[\"exp\"]))\n}\n</code></pre>\n"}], "owner": {"reputation": 2879, "user_id": 4335588, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/gNlDI.jpg?s=128&g=1", "display_name": "Thellimist", "link": "https://stackoverflow.com/users/4335588/thellimist"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 4065, "favorite_count": 0, "answer_count": 1, "score": 3, "last_activity_date": 1481001801, "creation_date": 1435874939, "question_id": 31195469, "link": "https://stackoverflow.com/questions/31195469/golang-jwt-no-signature-crypto-rsa-verification-error", "title": "golang JWT No Signature. &quot;crypto/rsa: verification error&quot;", "body": "<p>I'm using <a href=\"https://github.com/dgrijalva/jwt-go\" rel=\"nofollow\">JWT</a>. This is how I create the token.</p>\n\n<pre><code>func createToken(user User) (string, error) {\n    token := jwt.New(jwt.GetSigningMethod(\"RS256\"))\n\n    token.Claims[\"Name\"] = user.Name\n    token.Claims[\"Email\"] = user.Email\n    //token.Claims[\"ExpDate\"] = time.Now().Add(time.Hour * 1).Unix()\n\n    tokenString, err := token.SignedString([]byte(config.PrivateKey))\n    if err != nil {\n        return \"\", err\n    }\n\n    return tokenString, nil\n}\n</code></pre>\n\n<p>This is how I verify the token.</p>\n\n<pre><code>token, err := jwt.Parse(tokenString, func(token *jwt.Token) (interface{}, error) {    \n        return []byte(config.PublicKey), nil\n    })\n</code></pre>\n\n<p>I generated my public and private keys with this python code</p>\n\n<pre><code>from Crypto.PublicKey import RSA\n\nprivate = RSA.generate(1024)\npublic  = private.publickey()\n\npriv = private.exportKey()\npub = public.exportKey()\n</code></pre>\n\n<p>I get <code>crypto/rsa: verification error</code>. When I print the parsed token everything looks fine except <code>token.Valid</code> which is false and <code>token.Signature</code> is empty.</p>\n\n<pre><code>type Token struct {\n    Raw       string                 // The raw token.  Populated when you Parse a token\n    Method    SigningMethod          // The signing method used or to be used\n    Header    map[string]interface{} // The first segment of the token\n    Claims    map[string]interface{} // The second segment of the token\n    Signature string                 // The third segment of the token.  Populated when you Parse a token\n    Valid     bool                   // Is the token valid?  Populated when you Parse/Verify a token\n}\n\ntokenString--&gt; eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbWFpbCI6InRlc3RAaG90bWFpbC5jb20iLCJOYW1lIjoidGVzdE5hbWUifQ.fgd1h4LB1zzAiPFLKMOJrQu12rTLeXBDKHdnqiNc04NRn-1v7cHEQpDNawvScMIGrcQLbZo6WrldZQT9ImYWpUyy3CcD2uMO95I5PN6aXOSPb26nNGQpmIi1HNZrq5359hKZ6BWEJnW9iTg7RgmMvZGmIqlGLsOY2a6UiiwBsI0\ntoken.Raw--&gt; eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9.eyJFbWFpbCI6InRlc3RAaG90bWFpbC5jb20iLCJOYW1lIjoidGVzdE5hbWUifQ.fgd1h4LB1zzAiPFLKMOJrQu12rTLeXBDKHdnqiNc04NRn-1v7cHEQpDNawvScMIGrcQLbZo6WrldZQT9ImYWpUyy3CcD2uMO95I5PN6aXOSPb26nNGQpmIi1HNZrq5359hKZ6BWEJnW9iTg7RgmMvZGmIqlGLsOY2a6UiiwBsI0\ntoken.Header--&gt; map[alg:RS256 typ:JWT]\ntoken.Claims--&gt; map[Email:test@hotmail.com Name:testName]\ntoken.Signature--&gt;           \ntoken.Valid--&gt; false\n</code></pre>\n\n<p>PS: I don't have any SSL-Certificates.</p>\n"}, {"tags": ["html", "go", "server"], "comments": [{"owner": {"reputation": 4627, "user_id": 1741346, "user_type": "registered", "accept_rate": 54, "profile_image": "https://i.stack.imgur.com/5iv4J.png?s=128&g=1", "display_name": "Pikamander2", "link": "https://stackoverflow.com/users/1741346/pikamander2"}, "edited": false, "score": 1, "creation_date": 1435874527, "post_id": 31195364, "comment_id": 50395262, "body": "Related? <a href=\"http://stackoverflow.com/questions/26559557/how-do-you-serve-a-static-html-file-using-a-go-web-server\" title=\"how do you serve a static html file using a go web server\">stackoverflow.com/questions/26559557/&hellip;</a>"}, {"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1435874528, "post_id": 31195364, "comment_id": 50395263, "body": "Please show the value you expect <code>data</code> to hold after this line; <code>data, err := ioutil.ReadFile(string(path))</code>."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1435876492, "post_id": 31195364, "comment_id": 50395946, "body": "You are sending almost no header (only the absolute minimum what package http adds). This is bad. If you want your browser to process the data you send as HTML you should tell him: Set the Content-Type header to e.g. &quot;text/html&quot;."}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435879132, "post_id": 31195424, "comment_id": 50396708, "body": "The <code>ServeHTTP</code> method on <code>MyHandler</code> allows it to satisfy <code>http.Handler</code> and hence work with <code>http.Handler</code> (which expects the interface)\u2014although you probably know this. It&#39;s definitely a clunky way to call a handler though: falling back to writing <code>http.HandleFunc(&quot;&#47;&quot;, MyHandler)</code> is better. <code>ServeHTTP</code> should really only be used as a method."}], "tags": [], "owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "is_accepted": false, "score": 0, "last_activity_date": 1435874746, "creation_date": 1435874746, "answer_id": 31195424, "question_id": 31195364, "link": "https://stackoverflow.com/questions/31195364/how-to-run-html-on-a-go-server/31195424#31195424", "title": "How to run html on a Go server", "body": "<p>In your main try using <code>http.HandleFunc(\"/\", ServeHTTP)</code> then edit the <code>ServeHTTP</code> method so it doesn't have a reciever ie; <code>func ServeHTTP(w http.ResponseWriter, req *http.Request)</code></p>\n\n<p>You attempt to use that object and the <code>Handle</code> method may work fine too (if implemented correctly) but most of the examples use <code>HandleFunc</code> and if you do as well I bet your problem will go away.</p>\n\n<p>The only other thing that would be causing the issues you're observing is a failure to read the file who's contents are assigned to <code>data</code> or some misconception about what the data in that file actually is.</p>\n"}, {"tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": false, "score": 0, "last_activity_date": 1435874930, "creation_date": 1435874930, "answer_id": 31195464, "question_id": 31195364, "link": "https://stackoverflow.com/questions/31195364/how-to-run-html-on-a-go-server/31195464#31195464", "title": "How to run html on a Go server", "body": "<p>Right now you're just reading the contents of the file and writing it out. Since Go can't tell <em>what</em> type of file it is, it can't set the header.</p>\n\n<p>Thankfully, there's a useful <code>http.ServeFile</code> function <a href=\"http://golang.org/pkg/net/http/#ServeFile\" rel=\"nofollow\">in the net/http package</a> that can help you.</p>\n\n<pre><code>func (this *MyHandler) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    path := \"public/\" + req.URL.Path\n    http.ServeFile(w, r, filepath.Join(\"path/to/file\", path))\n}\n</code></pre>\n\n<p><code>http.ServeFile</code> attempts to set the <code>Content-Type</code> based on the file extension or first handful of bytes (for a HTML file it should get it right).</p>\n\n<p>A better solution is to make your route handler the <code>http.FileServer</code></p>\n\n<pre><code>func main() {\n    http.Handle(\"/\", http.FileServer(http.Dir(\"./public\"))\n\n    http.ListenAndServe(\":8000\", nil)\n}\n</code></pre>\n\n<p>Take a look at the <a href=\"http://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow\">examples in the Go docs</a> for how to use it in other ways.</p>\n\n<p>Shameless plug: I wrote a small middleware library that makes it a bit easier to serve static files in Go that you may find use in (or read just read the code for insight): <a href=\"https://github.com/elithrar/station\" rel=\"nofollow\">https://github.com/elithrar/station</a></p>\n"}, {"tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1436075958, "last_edit_date": 1436075958, "creation_date": 1436075480, "answer_id": 31227522, "question_id": 31195364, "link": "https://stackoverflow.com/questions/31195364/how-to-run-html-on-a-go-server/31227522#31227522", "title": "How to run html on a Go server", "body": "<p>Start with getting the HTML up and running.  Then, build in your HTTP error handling (e.g. 404).  I recommend using the <code>text/template</code> from the start, even if you're not adding any dynamism to your app... yet!</p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"text/template\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", RootHandler)\n\n    if err := http.ListenAndServe(\":8080\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc RootHandler(res http.ResponseWriter, req *http.Request) {\n    file, _ := ioutil.ReadFile(\"public/index.html\")\n    t := template.New(\"\")\n    t, _ = t.Parse(string(file))\n\n    t.Execute(res, nil)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 10667, "user_id": 4259761, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/yDRx2.png?s=128&g=1", "display_name": "openwonk", "link": "https://stackoverflow.com/users/4259761/openwonk"}, "is_accepted": false, "score": 0, "last_activity_date": 1436075913, "creation_date": 1436075913, "answer_id": 31227560, "question_id": 31195364, "link": "https://stackoverflow.com/questions/31195364/how-to-run-html-on-a-go-server/31227560#31227560", "title": "How to run html on a Go server", "body": "<p>In case you want to hold off on using the <code>text/template</code> package and just serve the HTML straight up, simply read your <code>index.html</code> file and write it to the response writer (e.g. <code>res</code> for response in my example, however many folks also use <code>w</code> for writer).  </p>\n\n<pre><code>package main\n\nimport (\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n)\n\nfunc main() {\n    http.HandleFunc(\"/\", RootHandler)\n\n    if err := http.ListenAndServe(\":8080\", nil); err != nil {\n        log.Fatal(err)\n    }\n}\n\nfunc RootHandler(res http.ResponseWriter, req *http.Request) {\n    file, _ := ioutil.ReadFile(\"public/index.html\")\n    res.Write(file)\n}\n</code></pre>\n"}], "owner": {"reputation": 83, "user_id": 5028849, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/10206706253396255/picture?type=large", "display_name": "Kristine Rooks", "link": "https://stackoverflow.com/users/5028849/kristine-rooks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 236, "favorite_count": 0, "answer_count": 4, "score": 2, "last_activity_date": 1436075958, "creation_date": 1435874406, "question_id": 31195364, "link": "https://stackoverflow.com/questions/31195364/how-to-run-html-on-a-go-server", "title": "How to run html on a Go server", "body": "<p>I've created a server in Go and I'm trying to run an html file in the browser. But the browser just prints out the code like a txt file instead of rendering the html formatting. My index.html file is saved in the /public directory.</p>\n\n<p>My go code looks like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"io/ioutil\"\n)\n\nfunc main() {\n    http.Handle(\"/\", new(MyHandler))\n\n    http.ListenAndServe(\":8000\", nil)\n}\n\ntype MyHandler struct {\n    http.Handler\n}\n\nfunc (this *MyHandler) ServeHTTP(w http.ResponseWriter, req *http.Request) {\n    path := \"public/\" + req.URL.Path\n    data, err := ioutil.ReadFile(string(path))\n\n    if err == nil {\n        w.Write(data)\n    } else {\n        w.WriteHeader(404)\n        w.Write([]byte(\"404 - \" + http.StatusText(404)))\n    }\n\n}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "syntax-error", "prepared-statement"], "answers": [{"tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 4, "last_activity_date": 1435871746, "creation_date": 1435871746, "answer_id": 31194768, "question_id": 31194630, "link": "https://stackoverflow.com/questions/31194630/go-sql-syntax-error/31194768#31194768", "title": "Go SQL syntax error", "body": "<p>You need to use $1, $2, ... as placeholder values in your SQL. The placeholder characters are DB dependent and for Postgres they are <code>$X</code>.</p>\n"}], "owner": {"reputation": 13264, "user_id": 190887, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/b1a747d0a7e3450408e0f07adba49111?s=128&d=identicon&r=PG", "display_name": "Inaimathi", "link": "https://stackoverflow.com/users/190887/inaimathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1195, "favorite_count": 0, "closed_date": 1435871977, "accepted_answer_id": 31194768, "answer_count": 1, "score": 4, "last_activity_date": 1435871746, "creation_date": 1435871114, "question_id": 31194630, "link": "https://stackoverflow.com/questions/31194630/go-sql-syntax-error", "closed_reason": "Duplicate", "title": "Go SQL syntax error", "body": "<p>I'm trying to insert a row into a Postgres table using <a href=\"http://golang.org/pkg/database/sql/\" rel=\"nofollow\"><code>database/sql</code></a>. The code I'm running looks like</p>\n\n<pre><code>...\nres, err := db.Exec(\"INSERT INTO image(name) VALUES(?);\", fname)\nif err != nil {\n    return err\n}\n...\n</code></pre>\n\n<p><code>fname</code> is a string. Something like <code>\"image-name.png\"</code>. The <code>image</code> table was created by the statement</p>\n\n<pre><code>...\n_, err := db.Exec(\"CREATE TABLE image (id SERIAL, name VARCHAR)\")\n...\n</code></pre>\n\n<p>After running that <code>CREATE TABLE</code> statement, I'm able to hop into <code>psql</code> and manually run</p>\n\n<pre><code>INSERT INTO image(name) VALUES('some-random-image.jpg');\n</code></pre>\n\n<p>with the appropriate row being added to the <code>image</code> table. However, the <code>INSERT</code> <code>Exec</code> call above consistently errors with <code>pq: syntax error at or near \")\"</code>.</p>\n\n<p>Can anyone point out what I'm doing wrong here?</p>\n\n<p>Also, as a follow-up, is there any way to see the result of statement formatting in <code>go</code>? I'm thinking of something like <code>func Preview (template string, args...) string</code> such that</p>\n\n<pre><code>Preview(\"INSERT INTO tbl(col) VALUES(?);\", \"test\")\n   =&gt; \"INSERT INTO tbl(col) VALUES('test');\"\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user1467267"}, "edited": false, "score": 0, "creation_date": 1435867122, "post_id": 31193406, "comment_id": 50391907, "body": "You&#39;re asking for a testable situation. Why not try and test it yourself? It&#39;s a good learning moment :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435867337, "post_id": 31193406, "comment_id": 50392017, "body": "This has nothing to do with the behavior of sync.Once, it has to do with the visibility of what your <code>f()</code> does. (I guess you could mess it up by copying the Once value too)"}, {"owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "edited": false, "score": 0, "creation_date": 1435867670, "post_id": 31193406, "comment_id": 50392202, "body": "f() initializes the fields of a struct that other goroutines will then read. I think the answer is that if all the other goroutines also go through the same Once.Do call then they will see the writes that happened in f(), but if they do not, e.g. they get passed a pointer to the struct instance and they never call Once.Do (on the same Once instance of course) they are not guaranteed to see the writes. Correct?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1435867775, "post_id": 31193406, "comment_id": 50392271, "body": "No. <code>sync.Once</code> ensures the argument of <code>Do</code> is called once, and only once. It does <i>nothing</i> else. Any other synchronization you need is up to you to provide."}, {"owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "edited": false, "score": 0, "creation_date": 1435875531, "post_id": 31193406, "comment_id": 50395634, "body": "Is the example wrong then? It claims it prints &quot;hello world&quot; twice but if there&#39;s no guarantee that the 2nd goroutine sees the write to the a var, the claim is not correct. Or is there something else at play here that I&#39;m missing? <a href=\"https://golang.org/ref/mem#tmp_9\" rel=\"nofollow noreferrer\">golang.org/ref/mem#tmp_9</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1435880731, "post_id": 31193406, "comment_id": 50397107, "body": "@JimB <code>sync.Once</code> does more than ensuring that the argument of <code>Do</code> is called once.  Per the <a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"nofollow noreferrer\">memory model</a>, <code>Do</code> also establishes a before relationship between the execution of the function and the return from <code>once.Do()</code>."}], "answers": [{"comments": [{"owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "edited": false, "score": 0, "creation_date": 1435875670, "post_id": 31194663, "comment_id": 50395676, "body": "Is the example wrong then? It claims it prints &quot;hello world&quot; twice but if there&#39;s no guarantee that the 2nd goroutine sees the write to the a var, the claim is not correct. Or is there something else at play here that I&#39;m missing? <a href=\"http://golang.org/ref/mem#tmp_9\" rel=\"nofollow noreferrer\">golang.org/ref/mem#tmp_9</a>"}, {"owner": {"reputation": 80332, "user_id": 145587, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/2ce699e2ec2d8ddb26b6a866191da86d?s=128&d=identicon&r=PG", "display_name": "OneOfOne", "link": "https://stackoverflow.com/users/145587/oneofone"}, "reply_to_user": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "edited": false, "score": 0, "creation_date": 1435879496, "post_id": 31194663, "comment_id": 50396811, "body": "@user2526241 the example isn&#39;t wrong, as long as you call .Do(f) before reading the variable then the variable will be set."}, {"owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "edited": false, "score": 0, "creation_date": 1435881562, "post_id": 31194663, "comment_id": 50397300, "body": "Thanks. That&#39;s what I was looking for, clarification that no extra synchronization is required to ensure visibility. I assume it will work the same for more complicated structs with multiple fields in place of the simple &quot;var a string&quot;."}, {"owner": {"reputation": 123, "user_id": 9672187, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Siva praneeth Alli", "link": "https://stackoverflow.com/users/9672187/siva-praneeth-alli"}, "edited": false, "score": 0, "creation_date": 1594350649, "post_id": 31194663, "comment_id": 111101642, "body": "@Muffin Top, Thanks for answer. I would like to understand how happens-before relationship is established. If we look at the implementation (<a href=\"https://golang.org/src/sync/once.go\" rel=\"nofollow noreferrer\">golang.org/src/sync/once.go</a>), once .Do(f) returns o.done is set to 1 and other goroutines calling .Do(f) returns immediately without acquiring any locks. So I wonder how other goroutines see the complete value of variable a. I know atomic.LoadUint32 does not establish happens before. Can you please shed some light here."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 123, "user_id": 9672187, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XdUIqdMkCWA/AAAAAAAAAAI/AAAAAAAAAAA/4252rscbv5M/photo.jpg?sz=128", "display_name": "Siva praneeth Alli", "link": "https://stackoverflow.com/users/9672187/siva-praneeth-alli"}, "edited": false, "score": 0, "creation_date": 1594354231, "post_id": 31194663, "comment_id": 111102410, "body": "@SivapraneethAlli Because the memory model specifies the happens-before relationship for once.Do, there&#39;s need to consider the implementation of the function.  That said, here&#39;s how it works: In <code>Once.doSlow</code>, the call to function <code>f</code> happens before <code>o.done</code> is atomically set to a non-zero value.  It follows that an atomic load of <code>o.done</code> in <code>Once.Do</code> is non-zero only if <code>f</code> has happened. If this fast check fails, the code falls back to using a mutex in <code>Once.doSlow</code>.  The comments in the function describe other important details."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 2, "last_activity_date": 1435893516, "last_edit_date": 1435893516, "creation_date": 1435871263, "answer_id": 31194663, "question_id": 31193406, "link": "https://stackoverflow.com/questions/31193406/does-sync-once-do-guarantee-visibility-across-goroutines/31194663#31194663", "title": "Does sync.Once.Do guarantee visibility across goroutines?", "body": "<p>Let's break down the <a href=\"https://golang.org/ref/mem#tmp_9\" rel=\"nofollow\">example</a>:</p>\n\n<p>The variable <code>a</code> is set <em>before</em> the function <code>setup()</code> returns because reads and writes within a single goroutine must behave as if they executed in the order specified by the program [<a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"nofollow\">1</a>].</p>\n\n<p>The single call to <code>setup()</code> from <code>once.Do()</code> happens <em>before</em> any call of <code>once.Do()</code> returns [<a href=\"https://golang.org/ref/mem#tmp_2\" rel=\"nofollow\">2</a>].</p>\n\n<p>Therefore, the variable <code>a</code> is set <em>before</em> any call to <code>once.Do()</code> returns. No further synchronization is required to establish this before relationship.</p>\n\n<p>The question asks about struct fields, not a single variable as in the example. As far as the memory model is concerned, struct fields are variables. All of the logic that applies to  the variable in the example applies to fields in a struct.</p>\n"}], "owner": {"reputation": 609, "user_id": 2526241, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5bdd651e0af2498321935177a1d3b215?s=128&d=identicon&r=PG", "display_name": "user2526241", "link": "https://stackoverflow.com/users/2526241/user2526241"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1688, "favorite_count": 0, "accepted_answer_id": 31194663, "answer_count": 1, "score": -1, "last_activity_date": 1435893516, "creation_date": 1435866481, "question_id": 31193406, "link": "https://stackoverflow.com/questions/31193406/does-sync-once-do-guarantee-visibility-across-goroutines", "title": "Does sync.Once.Do guarantee visibility across goroutines?", "body": "<p>The example <a href=\"https://golang.org/ref/mem#tmp_9\" rel=\"nofollow\">here</a> implies that sync.Once.Do guarantees visibility across goroutines for the string var a. Is that also true if for example the function f() called by sync.Once.Do initializes multiple fields of a struct instance? Will all the fields of the struct instance be visible to other goroutines without any additional synchronization?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 14845, "user_id": 522877, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/23600761a82cabda402d13f1bf45bfff?s=128&d=identicon&r=PG", "display_name": "Wex", "link": "https://stackoverflow.com/users/522877/wex"}, "is_accepted": false, "score": 0, "last_activity_date": 1435863953, "creation_date": 1435863953, "answer_id": 31192664, "question_id": 31192663, "link": "https://stackoverflow.com/questions/31192663/access-method-available-to-struct-used-in-type-declaration/31192664#31192664", "title": "Access method available to struct used in type declaration", "body": "<p>This can be solved using <a href=\"http://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">embedding</a>:</p>\n\n<pre><code>type ResourceSet struct {\n  Set\n}\n\nfunc (s ResourceSet) Add(resource Resource) {\n  id := resource.Id\n  s.AddId(id)\n}\n\nfunc main() {\n  resource := Resource{Id: 1}\n\n  s := ResourceSet{Set{}}\n  s.Add(resource)\n}\n</code></pre>\n\n<p>You can also create an <a href=\"https://golang.org/doc/effective_go.html#composite_literals\" rel=\"nofollow\">initializing constructor</a> to make the <code>ResourceSet</code> creation process simpler:</p>\n\n<pre><code>func NewResourceSet() {\n  return ResourceSet{Set{}}\n}\n\nfunc main() {\n  s := NewResourceSet()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 14845, "user_id": 522877, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/23600761a82cabda402d13f1bf45bfff?s=128&d=identicon&r=PG", "display_name": "Wex", "link": "https://stackoverflow.com/users/522877/wex"}, "edited": false, "score": 0, "creation_date": 1435874128, "post_id": 31194018, "comment_id": 50395104, "body": "Ok, that&#39;s useful to know. So what&#39;s the point then? What&#39;s a use case?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "reply_to_user": {"reputation": 14845, "user_id": 522877, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/23600761a82cabda402d13f1bf45bfff?s=128&d=identicon&r=PG", "display_name": "Wex", "link": "https://stackoverflow.com/users/522877/wex"}, "edited": false, "score": 1, "creation_date": 1435876258, "post_id": 31194018, "comment_id": 50395872, "body": "@Wec: The use case is: You want a type with a special method set but you can represent the types state in an other named type (whose method has methods you do not want your type to have)."}], "tags": [], "owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "is_accepted": true, "score": 2, "last_activity_date": 1435868695, "creation_date": 1435868695, "answer_id": 31194018, "question_id": 31192663, "link": "https://stackoverflow.com/questions/31192663/access-method-available-to-struct-used-in-type-declaration/31194018#31194018", "title": "Access method available to struct used in type declaration", "body": "<p>The whole point of a new named type is to have a fresh and empty method set.</p>\n\n<p>Embedding is a different story and add some syntactical sugar to call methods of embedded types. </p>\n"}], "owner": {"reputation": 14845, "user_id": 522877, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/23600761a82cabda402d13f1bf45bfff?s=128&d=identicon&r=PG", "display_name": "Wex", "link": "https://stackoverflow.com/users/522877/wex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 51, "favorite_count": 0, "accepted_answer_id": 31194018, "answer_count": 2, "score": -1, "last_activity_date": 1435868695, "creation_date": 1435863953, "last_edit_date": 1435864668, "question_id": 31192663, "link": "https://stackoverflow.com/questions/31192663/access-method-available-to-struct-used-in-type-declaration", "title": "Access method available to struct used in type declaration", "body": "<p>Is it possible to access methods that are declared in a type's underlying type? For example, I want a <code>ResourceSet</code> to be able to call my <code>Set</code> type's <code>AddId</code> method .</p>\n\n<p>See: <a href=\"http://play.golang.org/p/Fcg6Ryzb67\" rel=\"nofollow\">http://play.golang.org/p/Fcg6Ryzb67</a></p>\n\n<pre><code>package main\n\ntype Resource struct { \n  Id uint32\n}\n\ntype Set map[uint32]struct{}\n\nfunc (s Set) AddId(id uint32) {\n  s[id] = struct{}{}\n}\n\ntype ResourceSet Set\n\nfunc (s ResourceSet) Add(resource Resource) {\n  id := resource.Id\n  s.AddId(id)\n}\n\nfunc main() {\n  resource := Resource{Id: 1}\n\n  s := ResourceSet{}\n  s.Add(resource)\n}\n</code></pre>\n\n<p>The error I'm getting is:</p>\n\n<pre><code>s.AddId undefined (type ResourceSet has no field or method AddId)\n</code></pre>\n"}, {"tags": ["xml", "go", "marshalling", "encode"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1438185243, "creation_date": 1438185243, "answer_id": 31705382, "question_id": 31191772, "link": "https://stackoverflow.com/questions/31191772/go-duplicated-tags-when-marshalling-xml/31705382#31705382", "title": "Go: duplicated tags when marshalling XML", "body": "<p>You haven't added the example of the resulting XML should look like, but you can remove duplication by adding an <code>XMLName</code> field and removing all <code>foo</code>s from your <code>foo&gt;bar</code> tags.</p>\n\n<pre><code>type DataSource struct {\n    XMLName     xml.Name   `xml:\"ns1 ns1:datasource\"`\n    // ...\n    Connect     string     `xml:\"ns1:connection-url\"`\n    Class       string     `xml:\"ns1:driver-class\"`\n    Driver      string     `xml:\"ns1:driver\"`\n    MinPool     int        `xml:\"ns1:pool&gt;min-pool-size\"`\n    MaxPool     int        `xml:\"ns1:pool&gt;max-pool-size\"`\n    SecUser     string     `xml:\"ns1:security&gt;ns1:user-name\"`\n    SecPw       string     `xml:\"ns1:security&gt;ns1:password\"`\n    Validation  Validation `xml:\"ns1:validation\"`\n    Timeout     string     `xml:\"ns1:timeout,omitempty\"`\n    Statement   string     `xml:\"ns1:statement,omitempty\"`\n}\n</code></pre>\n\n<p><a href=\"http://play.golang.org/p/7MDsb_UMjg\" rel=\"nofollow\">http://play.golang.org/p/7MDsb_UMjg</a></p>\n"}], "owner": {"reputation": 153, "user_id": 1751276, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/xclw7.jpg?s=128&g=1", "display_name": "amracel", "link": "https://stackoverflow.com/users/1751276/amracel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "accepted_answer_id": 31705382, "answer_count": 1, "score": 2, "last_activity_date": 1438185317, "creation_date": 1435860884, "last_edit_date": 1438185317, "question_id": 31191772, "link": "https://stackoverflow.com/questions/31191772/go-duplicated-tags-when-marshalling-xml", "title": "Go: duplicated tags when marshalling XML", "body": "<p>I've created structs for xml in Go:</p>\n\n<pre><code>type ExceptionSorter struct {\n    ExceptionClass string `xml:\"class-name,attr\"`\n}\n\ntype ValidConnection struct {\n    ConnClass string  `xml:\"class-name,attr\"`\n}\n\ntype Validation struct {\n    ValidConnection ValidConnection `xml:\"ns1:valid-connection-checker\"`\n    ExceptionSorter ExceptionSorter `xml:\"ns1:exception-sorter\"`\n}\n\ntype DataSource struct {\n    Jta         bool     `xml:\"jta,attr\"`\n    JndiName    string   `xml:\"jndi-name,attr\"`\n    PoolName    string   `xml:\"pool-name,attr\"`\n    Enabled     bool     `xml:\"enabled,attr\"`\n    JavaContext bool     `xml:\"use-java-context,attr\"`\n    Spy         bool     `xml:\"spy,attr\"`\n    UseCcm      bool     `xml:\"use-ccm,attr\"`\n    Connect     string   `xml:\"ns1:datasource&gt;ns1:connection-url\"`\n    Class       string   `xml:\"ns1:datasource&gt;ns1:driver-class\"`\n    Driver      string   `xml:\"ns1:datasource&gt;ns1:driver\"`\n    MinPool     int      `xml:\"ns1:datasource&gt;ns1:pool&gt;min-pool-size\"`\n    MaxPool     int      `xml:\"ns1:datasource&gt;ns1:pool&gt;max-pool-size\"`\n    SecUser     string   `xml:\"ns1:datasource&gt;ns1:security&gt;ns1:user-name\"`\n    SecPw       string   `xml:\"ns1:datasource&gt;ns1:security&gt;ns1:password\"`\n    Validation  Validation `xml:\"ns1:datasource&gt;ns1:validation\"`\n    Timeout     string    `xml:\"ns1:datasource&gt;ns1:timeout,omitempty\"`\n    Statement   string    `xml:\"ns1:datasource&gt;ns1:statement,omitempty\"`\n}\n\ntype DataSources struct {\n    XmlName     string `xml:\"xmlns:xsi,attr\"`\n    XmlNs       string `xml:\"xmlns:ns1,attr\"`\n    SchemaLocn  string `xml:\"xsi:schemaLocation,attr\"`\n    DataSource  DataSource `xml:\"ns1:datasource\"`\n}\n</code></pre>\n\n<p>And I'm having two issues with it:</p>\n\n<p>1) When I try to encode the structure I get duplicates where I'm not expecting them:</p>\n\n<pre><code>    &lt;DataSources ....&gt;\n       &lt;ns1:datasource ....&gt;\n         &lt;ns1:datasource&gt;\n</code></pre>\n\n<p>Oddly, the Validation tag is not duplicated. But I can't see the difference in the way I'm handling them.</p>\n\n<p>2) I can't seem to find a way to put the namespace in the beginning tag. The name, obviously, won't take a colon. But if I add an 'xml.Name' element, the starting tag is duplicated as well.</p>\n\n<p>Here's my attempts to run it in the Playground: <a href=\"http://play.golang.org/p/G5NvLt-ZK7\" rel=\"nofollow\">http://play.golang.org/p/G5NvLt-ZK7</a></p>\n\n<p><strong>FOLLOW-UP:</strong></p>\n\n<p>OK, I've figured out how to get rid of the duplicate, by removing the 'type' in the definition:</p>\n\n<pre><code>type datasources struct {\n      DataSource\n}\n</code></pre>\n\n<p>But then I lose the attributes associated with it:</p>\n\n<pre><code>&lt;ns1:datasource&gt;\n</code></pre>\n"}, {"tags": ["go", "cloud-foundry", "ibm-cloud"], "comments": [{"owner": {"reputation": 1066, "user_id": 1116896, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa0e7d89cbed7e3876a97aa9640f44a2?s=128&d=identicon&r=PG", "display_name": "Jake Peyser", "link": "https://stackoverflow.com/users/1116896/jake-peyser"}, "edited": false, "score": 0, "creation_date": 1435861721, "post_id": 31191580, "comment_id": 50388937, "body": "When was the last time you deployed your app? It looks like the buildpack recently was bumped to 1.4.0 - perhaps this buildpack causes an issue in Bluemix. Try using an older version of the buildpack when you push your app using the <code>-b</code> option"}, {"owner": {"reputation": 6086, "user_id": 914967, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7500194166646eb28af858f0374bd744?s=128&d=identicon&r=PG", "display_name": "shawnzhu", "link": "https://stackoverflow.com/users/914967/shawnzhu"}, "reply_to_user": {"reputation": 1066, "user_id": 1116896, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa0e7d89cbed7e3876a97aa9640f44a2?s=128&d=identicon&r=PG", "display_name": "Jake Peyser", "link": "https://stackoverflow.com/users/1116896/jake-peyser"}, "edited": false, "score": 1, "creation_date": 1435864149, "post_id": 31191580, "comment_id": 50390290, "body": "I uses buildpack 1.4.0 for a while. actually this is caused by application itself. the error message itself tells part of the information because it seems compiling error but no golang specific information provided. so I start to guess it comes from godep configuration <code>Godeps&#47;Godeps.json</code> file because it is only place need to be parsed by buildpack. so my suggestion is improving the buildpack output message for such error path."}, {"owner": {"reputation": 1066, "user_id": 1116896, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/aa0e7d89cbed7e3876a97aa9640f44a2?s=128&d=identicon&r=PG", "display_name": "Jake Peyser", "link": "https://stackoverflow.com/users/1116896/jake-peyser"}, "edited": false, "score": 0, "creation_date": 1435865420, "post_id": 31191580, "comment_id": 50390964, "body": "ok, go ahead and provide an answer to your question so it&#39;s closed out for future SO users :)"}], "answers": [{"tags": [], "owner": {"reputation": 6086, "user_id": 914967, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7500194166646eb28af858f0374bd744?s=128&d=identicon&r=PG", "display_name": "shawnzhu", "link": "https://stackoverflow.com/users/914967/shawnzhu"}, "is_accepted": false, "score": 1, "last_activity_date": 1437532178, "last_edit_date": 1437532178, "creation_date": 1435866578, "answer_id": 31193434, "question_id": 31191580, "link": "https://stackoverflow.com/questions/31191580/compiling-error-when-using-community-golang-buildpack-on-bluemix/31193434#31193434", "title": "compiling error when using community golang buildpack on bluemix", "body": "<p>The error message <code>parse error: Expected separator between values at line 32, column 3</code> comes from <code>jq</code> command within buildpack code, where it tries to read import path from <code>Godeps/Godeps.json</code> by assuming it's a valid JSON file. see line #64 of <a href=\"https://github.com/heroku/heroku-buildpack-go/blob/master/bin/compile#L64\" rel=\"nofollow\"><code>/bin/compile</code></a>.</p>\n\n<p>It will stop buildpack if the <code>Godeps.json</code> is not json.</p>\n\n<p>I created <a href=\"https://github.com/heroku/heroku-buildpack-go/issues/86\" rel=\"nofollow\">issue 86</a> to improve this buildpack to provide more information for such kind of error message.</p>\n\n<p>Thanks for everyone who spent time on this problem.</p>\n\n<p><strong>Update</strong>: issue 86 was fixed in heroku golang buildpack by adding new step to checking <code>Godeps.json</code> format.</p>\n"}], "owner": {"reputation": 6086, "user_id": 914967, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/7500194166646eb28af858f0374bd744?s=128&d=identicon&r=PG", "display_name": "shawnzhu", "link": "https://stackoverflow.com/users/914967/shawnzhu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1437532178, "creation_date": 1435860189, "last_edit_date": 1435866343, "question_id": 31191580, "link": "https://stackoverflow.com/questions/31191580/compiling-error-when-using-community-golang-buildpack-on-bluemix", "title": "compiling error when using community golang buildpack on bluemix", "body": "<p>One of my bluemix application worked for weeks but it start to report parse error with <code>Buildpack compilation step failed</code> when pushing app to bluemix:</p>\n\n<pre><code>-----&gt; Downloaded app package (556K)\nCloning into '/tmp/buildpacks/buildpack-go'...\nSubmodule 'compile-extensions' (https://github.com/cloudfoundry-incubator/compile-extensions.git) registered for path 'compile-extensions'\nCloning into 'compile-extensions'...\nSubmodule path 'compile-extensions': checked out 'f752ecf4b27d2f31bb082dfe7a47c76fefc769d7'\n-------&gt; Buildpack version 1.4.0\nparse error: Expected separator between values at line 32, column 3\nStaging failed: Buildpack compilation step failed\n</code></pre>\n\n<p>Here's my <code>manifest.yml</code> file:</p>\n\n<pre><code>---\napplications:\n- name: joystick\n  memory: 128M\n  path: .\n  buildpack: https://github.com/cloudfoundry/buildpack-go.git\n</code></pre>\n\n<p><strong>Update</strong>: I carefully read the error message and figured out it is application space problem caused by <code>Godeps.json</code> parsing error caused by code merging where one comma is missed. I can not reproduce this locally because I checked in <code>_workspace</code> directory where it never parse <code>Godeps.json</code>.</p>\n\n<p>I created <a href=\"https://github.com/heroku/heroku-buildpack-go/issues/86\" rel=\"nofollow\">issue 86</a> to improve this buildpack to provide more information for such kind of error message.</p>\n"}, {"tags": ["go", "ip"], "comments": [{"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 1, "creation_date": 1435859530, "post_id": 31191313, "comment_id": 50387701, "body": "What do you actually want to achieve?"}, {"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "reply_to_user": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "edited": false, "score": 0, "creation_date": 1435859794, "post_id": 31191313, "comment_id": 50387861, "body": "@inf I&#39;m trying to get / generate a gateway address which by convention is the next IP"}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 8, "last_activity_date": 1435868539, "last_edit_date": 1435868539, "creation_date": 1435860896, "answer_id": 31191775, "question_id": 31191313, "link": "https://stackoverflow.com/questions/31191313/how-to-get-the-next-ip-address/31191775#31191775", "title": "How to get the next IP address?", "body": "<p>Just increment the last octet in the IP address</p>\n\n<pre><code>ip := net.ParseIP(\"127.1.0.0\")\n// make sure it's only 4 bytes\nip = ip.To4()\n// check ip != nil\nip[3]++  // check for rollover\nfmt.Println(ip)\n//127.1.0.1\n</code></pre>\n\n<p>That however is technically incorrect, since the first address in the 127.1.0.1/8 subnet is 127.0.0.1. To get the true \"first\" address, you will also need an IPMask. Since you didn't specify one, you could use DefaultMask for IPv4 addresses (for IPv6 you can't assume a mask, and you must provide it). </p>\n\n<p><a href=\"http://play.golang.org/p/P_QWwRIBIm\" rel=\"noreferrer\">http://play.golang.org/p/P_QWwRIBIm</a></p>\n\n<pre><code>ip := net.IP{192, 168, 1, 10}\nip = ip.To4()\nif ip == nil {\n    log.Fatal(\"non ipv4 address\")\n}\n\nip = ip.Mask(ip.DefaultMask())\nip[3]++\n\nfmt.Println(ip)\n//192.168.1.1\n</code></pre>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2148282"}, "is_accepted": false, "score": 2, "last_activity_date": 1448483705, "creation_date": 1448483705, "answer_id": 33925954, "question_id": 31191313, "link": "https://stackoverflow.com/questions/31191313/how-to-get-the-next-ip-address/33925954#33925954", "title": "How to get the next IP address?", "body": "<p>I would test against CIDR after the IP has been incremented, so overflows don't change the expected subnet.</p>\n\n<pre><code>func incrementIP(origIP, cidr string) (string, error) {\n    ip := net.ParseIP(origIP)\n    _, ipNet, err := net.ParseCIDR(cidr)\n    if err != nil {\n        return origIP, err\n    }\n    for i := len(ip) - 1; i &gt;= 0; i-- {\n        ip[i]++\n        if ip[i] != 0 {\n            break\n        }\n    }\n    if !ipNet.Contains(ip) {\n        return origIP, errors.New(\"overflowed CIDR while incrementing IP\")\n    }\n    return ip.String(), nil\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8129, "user_id": 1011695, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/00787a09c9726b2074f2bb786f88162c?s=128&d=identicon&r=PG", "display_name": "Everton", "link": "https://stackoverflow.com/users/1011695/everton"}, "is_accepted": false, "score": 3, "last_activity_date": 1519933806, "creation_date": 1519933806, "answer_id": 49057611, "question_id": 31191313, "link": "https://stackoverflow.com/questions/31191313/how-to-get-the-next-ip-address/49057611#49057611", "title": "How to get the next IP address?", "body": "<p>If all you need is to compute the next IP address, the function nextIP() below will do the trick.</p>\n\n<p>Usage:</p>\n\n<pre><code>// output is 1.0.1.0\nfmt.Println(nextIP(net.ParseIP(\"1.0.0.255\"), 1))\n</code></pre>\n\n<p>nextIP():</p>\n\n<pre><code>func nextIP(ip net.IP, inc uint) net.IP {\n    i := ip.To4()\n    v := uint(i[0])&lt;&lt;24 + uint(i[1])&lt;&lt;16 + uint(i[2])&lt;&lt;8 + uint(i[3])\n    v += inc\n    v3 := byte(v &amp; 0xFF)\n    v2 := byte((v &gt;&gt; 8) &amp; 0xFF)\n    v1 := byte((v &gt;&gt; 16) &amp; 0xFF)\n    v0 := byte((v &gt;&gt; 24) &amp; 0xFF)\n    return net.IPv4(v0, v1, v2, v3)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/vHrmftkVjn2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/vHrmftkVjn2</a></p>\n\n<p>Gist: <a href=\"https://gist.github.com/udhos/b468fbfd376aa0b655b6b0c539a88c03\" rel=\"nofollow noreferrer\">https://gist.github.com/udhos/b468fbfd376aa0b655b6b0c539a88c03</a></p>\n"}, {"tags": [], "owner": {"reputation": 13, "user_id": 6611635, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/45db469d93ea61dcd3082caa0b21d859?s=128&d=identicon&r=PG&f=1", "display_name": "user-4859", "link": "https://stackoverflow.com/users/6611635/user-4859"}, "is_accepted": false, "score": 0, "last_activity_date": 1523833403, "creation_date": 1523833403, "answer_id": 49847634, "question_id": 31191313, "link": "https://stackoverflow.com/questions/31191313/how-to-get-the-next-ip-address/49847634#49847634", "title": "How to get the next IP address?", "body": "<p>I've encountered this problem just now, and I want to share my solution. It's not that efficient but solves the problem in a few lines.</p>\n\n<pre><code>func nextIP(ip net.IP) net.IP {\n    // Convert to big.Int and increment\n    ipb := big.NewInt(0).SetBytes([]byte(ip))\n    ipb.Add(ipb, big.NewInt(1))\n\n    // Add leading zeros\n    b := ipb.Bytes()\n    b = append(make([]byte, len(ip)-len(b)), b...)\n    return net.IP(b)\n}\n</code></pre>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6418, "favorite_count": 0, "accepted_answer_id": 31191775, "answer_count": 4, "score": 4, "last_activity_date": 1523833403, "creation_date": 1435859327, "last_edit_date": 1436923216, "question_id": 31191313, "link": "https://stackoverflow.com/questions/31191313/how-to-get-the-next-ip-address", "title": "How to get the next IP address?", "body": "<p>I'm considering to call <code>net.IP.String()</code>,  <code>strings.Split(ip, \".\")</code>, some code to calculate all the corner cases and finally <code>net.ParseIP(s)</code>. Is there a better way to this?. Below is the code of my current implementation (no special case handled).</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"net\"\n    \"strconv\"\n    \"strings\"\n)\n\nfunc main() {\n    ip := net.ParseIP(\"127.1.0.0\")\n    next, err := NextIP(ip)\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(ip, next)\n}\n\nfunc NextIP(ip net.IP) (net.IP, error) {\n    s := ip.String()\n    sa := strings.Split(s, \".\")\n    i, err := strconv.Atoi(sa[2])\n    if err != nil {\n        return nil, err\n    }\n    i++\n    sa[3] = strconv.Itoa(i)\n    s = strings.Join(sa, \".\")\n    return net.ParseIP(s), nil\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 38332, "user_id": 763585, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/34f929fab16e27f59c5193f0db678125?s=128&d=identicon&r=PG", "display_name": "evanmcdonnal", "link": "https://stackoverflow.com/users/763585/evanmcdonnal"}, "edited": false, "score": 0, "creation_date": 1435856992, "post_id": 31186814, "comment_id": 50386312, "body": "If it&#39;s a primitive and it&#39;s non nullable, why would you even consider using a pointer? All that does is double your memory consumption and increase the cognitive overhead for people maintaining your code."}], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 0, "creation_date": 1435851219, "post_id": 31187112, "comment_id": 50382714, "body": "Pretty solid arguments. I can&#39;t argue with that. Thanks!"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 10, "last_activity_date": 1435846820, "creation_date": 1435846820, "answer_id": 31187112, "question_id": 31186814, "link": "https://stackoverflow.com/questions/31186814/any-down-side-always-using-pointers-for-struct-field-types/31187112#31187112", "title": "Any down-side always using pointers for struct field types?", "body": "<p>Apart from possible performance (more pointers = more things for the GC to scan), safety (nil pointer dereference), convenience (<code>s.a = 2</code> vs <code>s.a = new(int); *s.a = 42</code>), and memory penalties (a <code>bool</code> is one byte, a <code>*bool</code> is four to eight), there is one thing that really bothers me in the all-pointer approach. It violates the <a href=\"https://en.wikipedia.org/wiki/Single_responsibility_principle\">Single responsibility principle</a>.</p>\n\n<p>Is the <code>MyStruct</code> you get from XML or DB same as <code>MyStruct</code>? What if the DB schema will change? What if the XML changes format? What if you'll also need to unmarshal it into JSON, but in a slightly different manner? And what if you need to support all that (and in multiple versions!) at the same time?</p>\n\n<p>A lot of pain comes to you when you try to make one thing do many things. Is having one do-it-all type instead of N specialised types really worth it?</p>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 0, "accepted_answer_id": 31187112, "answer_count": 1, "score": 5, "last_activity_date": 1435846820, "creation_date": 1435845986, "last_edit_date": 1435846645, "question_id": 31186814, "link": "https://stackoverflow.com/questions/31186814/any-down-side-always-using-pointers-for-struct-field-types", "title": "Any down-side always using pointers for struct field types?", "body": "<p>Originally I figured I'd only use pointers for optional struct fields which could potentionally be nil in cases which it was initially built for.</p>\n\n<p>As my code evolved I was writing different layers upon my models - for xml and json (un)marshalling. In these cases even the fields I thought would always be a requirement (Id, Name etc) actually turned out to be optional for some layers.</p>\n\n<p>In the end I had put a * in front of all the fields including so int became *int, string became *string etc.</p>\n\n<p>Now I'm wondering if I had been better of not generalising my code so much? I could have duplicated the code instead, which I find rather ugly - but perhaps more efficient than using pointers for all struct fields?</p>\n\n<p>So my question is whether this is turning into an anti-pattern and just a bad habbit, or if this added flexibility does not come at a cost from a performance point of view?</p>\n\n<p>Eg. can you come up with good arguments for sticking with option A: </p>\n\n<pre><code>type MyStruct struct {\n    Id int\n    Name string\n    ParentId *int\n    // etc.. only pointers where NULL columns in db might occur\n}\n</code></pre>\n\n<p>over this option B:</p>\n\n<pre><code>type MyStruct struct {\n    Id *int\n    Name *string\n    ParentId *int\n    // etc... using *pointers for all fields\n}\n</code></pre>\n\n<p>Would the best practice way of modelling your structs be from a purely database/column perspective, or eg if you had:</p>\n\n<pre><code>func (m *MyStruct) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    var v struct {\n        XMLName     xml.Name     `xml:\"myStruct\"`\n        Name        string       `xml:\"name\"`\n        Parent      string       `xml:\"parent\"`\n        Children    []*MyStruct  `xml:\"children,omitempty\"`\n    }\n\n    err := d.DecodeElement(&amp;v, &amp;start)\n    if err != nil {\n        return err\n    }\n\n    m.Id = nil // adding to db from xml, there's initially no Id, until after the insert\n    m.Name = v.Name // a parent might be referenced by name or alias\n    m.ParentId = nil // not by parentId, since it's not created yet, but maybe by nesting elements like you see above in the V struct (Children []*ContentType)\n    // etc..\n\n    return nil\n}\n</code></pre>\n\n<p>This example could be part of the scenario where you want to add elements from XML to the database. Here ids would generally not make sense, so instead we use nesting and references on name or other aliases. An Id for the structs would not be set until we got the id, after the INSERT query. Then using that ID we could traverse down the hierachy to the child elements etc.</p>\n\n<p>This would allow us to have just 1 MyStruct, and use eg. different POST http request handler functions, depending if the call came from form input, or xml importing where a nested hierarchy and different relations might need come different handling.</p>\n\n<p><strong>In the end I guess what I'm asking is:</strong> </p>\n\n<p>Would you be better off separating struct models for db, xml- and json operations (or whatever scenario that you can think of), than using struct field pointers all the way, so we can reuse the model for different, yet related stuff?</p>\n"}, {"tags": ["c++", "go", "bitwise-operators"], "comments": [{"owner": {"reputation": 8617, "user_id": 3477950, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/mC5xL.jpg?s=128&g=1", "display_name": "The Paramagnetic Croissant", "link": "https://stackoverflow.com/users/3477950/the-paramagnetic-croissant"}, "edited": false, "score": 3, "creation_date": 1435841271, "post_id": 31185010, "comment_id": 50375363, "body": "<code>uint8(128) == 1000 0000</code> (binary). You shift that to the left by 8 bits, that&#39;s <code>1000 0000 0000 0000</code>, of which only the last 8 bits can be stored in an <code>uint8</code>, which is <code>0000 0000</code>, which is 0."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1435842521, "post_id": 31185010, "comment_id": 50376334, "body": "You ask why is <code>0</code> the result of <code>x &lt;&lt; 8</code>. Let me ask, what result were you expecting when using a value of a type whose max value is <code>255</code>?"}], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 0, "last_activity_date": 1435841561, "last_edit_date": 1592644375, "creation_date": 1435841561, "answer_id": 31185212, "question_id": 31185010, "link": "https://stackoverflow.com/questions/31185010/shift-instructions-in-golang/31185212#31185212", "title": "Shift instructions in Golang", "body": "<ol>\n<li><p>Because <code>uint8</code> is an unsigned 8-bit integer type. That's what &quot;u&quot; stands for.</p>\n</li>\n<li><p>Because <code>uint8(128) &lt;&lt; 8</code> shifts the value, turning <code>1000 0000</code> into <code>0000 0000</code>.</p>\n<p><code>int(x)</code> makes it <code>0000 0000 0000 0000 0000 0000 1000 0000</code> (on 32 bit systems, since <code>int</code> is architecture-dependant) and then the shift comes, making it <code>0000 0000 0000 0000 1000 0000 0000 0000</code>, or 32768.</p>\n</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 359, "user_id": 1507810, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6943d9549e1b9bd6bffacd2a5e7623e?s=128&d=identicon&r=PG", "display_name": "Charlie Scott-Skinner", "link": "https://stackoverflow.com/users/1507810/charlie-scott-skinner"}, "edited": false, "score": 0, "creation_date": 1435842393, "post_id": 31185217, "comment_id": 50376229, "body": "It does as it says in the name - shifts all the bits to the left. Adding a <code>0</code> is a by-product as it pads the space with <code>0</code>. If you shift right in C++ it preserves the sign bit, so may add <code>1</code> or <code>0</code>."}], "tags": [], "owner": {"reputation": 149509, "user_id": 4342498, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/l3j88.jpg?s=128&g=1", "display_name": "NathanOliver", "link": "https://stackoverflow.com/users/4342498/nathanoliver"}, "is_accepted": false, "score": 2, "last_activity_date": 1435842240, "last_edit_date": 1435842240, "creation_date": 1435841573, "answer_id": 31185217, "question_id": 31185010, "link": "https://stackoverflow.com/questions/31185010/shift-instructions-in-golang/31185217#31185217", "title": "Shift instructions in Golang", "body": "<p>The left shift operator is going to shift the binary digits in the number to the left X number of places.  This has the effect of adding X number of <code>0</code>'s to the right hand side the number  A <code>unit8</code> only holds <code>8</code> bits so when you have <code>128</code> your variable has</p>\n\n<pre><code>x =            1000 0000 == 128\nx &lt;&lt; 8\nx=   1000 0000 0000 0000 == 32768\n</code></pre>\n\n<p>Since <code>uint8</code> only holds 8 bits we tak the rightmost 8 bits which is</p>\n\n<pre><code>x =            0000 0000 == 0\n</code></pre>\n\n<p>The reason you get the right number with an <code>int</code> is an <code>int</code> has at least 16 bits worth of storage and most likely has 32 bits on your system.  That is enough to store the entire result.</p>\n"}], "owner": {"reputation": 11045, "user_id": 1297203, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/b213707b2fdedeacf904335b540f1e8f?s=128&d=identicon&r=PG", "display_name": "holys", "link": "https://stackoverflow.com/users/1297203/holys"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 290, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1435842240, "creation_date": 1435840967, "question_id": 31185010, "link": "https://stackoverflow.com/questions/31185010/shift-instructions-in-golang", "title": "Shift instructions in Golang", "body": "<p>The go <a href=\"http://golang.org/ref/spec#Arithmetic_operators\" rel=\"nofollow\">spec</a> says:</p>\n\n<pre><code>&lt;&lt;    left shift             integer &lt;&lt; unsigned integer\n</code></pre>\n\n<p>What if the left side is type of  <code>uint8</code>:</p>\n\n<pre><code>var x uint8 = 128\nfmt.Println(x &lt;&lt; 8)      // it got 0, why ?\nfmt.Println(int(x)&lt;&lt;8)   // it got 32768, sure\n</code></pre>\n\n<p>Questions:</p>\n\n<ol>\n<li>when x is uint8 type, why no compile error?</li>\n<li>why <code>x &lt;&lt; 8</code> got result <code>0</code></li>\n</ol>\n\n<p>For C/C++, </p>\n\n<pre><code>unsigned int a = 128;\nprintf(\"%d\",a &lt;&lt; 8); // result is 32768.\n</code></pre>\n\n<p>Could anyone explain? Thank you.</p>\n"}, {"tags": ["go", "coreos", "flannel", "flanneld"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1435833454, "post_id": 31181747, "comment_id": 50370127, "body": "What OS are you using?"}, {"owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1435833510, "post_id": 31181747, "comment_id": 50370157, "body": "I am using Ubuntu Vivid (15.04)"}, {"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1435839662, "post_id": 31181747, "comment_id": 50374240, "body": "It could be an issue with the versinn of gccgo that supports it. Have you tried compiling it with the default go compiler?"}, {"owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "edited": false, "score": 0, "creation_date": 1435840029, "post_id": 31181747, "comment_id": 50374486, "body": "Yeah, I tried. And it builds with default go compiler. But the arch I am working on, only has gccgo. Could it be the possibility that gccgo doesn&#39;t support all the stuff that default go compiler does?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1435852119, "post_id": 31181747, "comment_id": 50383347, "body": "@Pensu: the syscall package is arch specific. You&#39;ll have to check how the syscall source for your arch is generated, and if that value is valid for your system. You can always lookup the value and define your own const."}], "answers": [{"tags": [], "owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "is_accepted": true, "score": 0, "last_activity_date": 1436351596, "creation_date": 1436351596, "answer_id": 31290093, "question_id": 31181747, "link": "https://stackoverflow.com/questions/31181747/golang-error-reference-to-undefined-identifier-syscall-tunsetiff/31290093#31290093", "title": "golang error: reference to undefined identifier \u2018syscall.TUNSETIFF\u2019", "body": "<p>So, I found the answer. The problem was that gccgo didn't define TUNSETIFF for my arch. I defined the value accordingly and I was able to make it work. Thanks @JimB</p>\n"}], "owner": {"reputation": 2203, "user_id": 773079, "user_type": "registered", "accept_rate": 46, "profile_image": "https://www.gravatar.com/avatar/f494bf18ea8fc96190a398ecee6deedc?s=128&d=identicon&r=PG", "display_name": "Pensu", "link": "https://stackoverflow.com/users/773079/pensu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1522, "favorite_count": 0, "accepted_answer_id": 31290093, "answer_count": 1, "score": 0, "last_activity_date": 1507735460, "creation_date": 1435831857, "question_id": 31181747, "link": "https://stackoverflow.com/questions/31181747/golang-error-reference-to-undefined-identifier-syscall-tunsetiff", "title": "golang error: reference to undefined identifier \u2018syscall.TUNSETIFF\u2019", "body": "<p>So, I have been trying to build flannel (<a href=\"https://github.com/coreos/flannel\" rel=\"nofollow\">https://github.com/coreos/flannel</a>) with gccgo. Here is the error I am getting while building:</p>\n\n<pre><code>$ ./build \nBuilding flanneld...\n# github.com/coreos/flannel/pkg/ip\ngopath/src/github.com/coreos/flannel/pkg/ip/tun.go:57:37: error: reference to undefined identifier \u2018syscall.TUNSETIFF\u2019\n  err = ioctl(int(tun.Fd()), syscall.TUNSETIFF, uintptr(unsafe.Pointer(&amp;ifr)))\n                                     ^\n</code></pre>\n\n<p>I am using gccgo-5 and gcc-5. Can anyone please help me figure out what exactly is the issue here? TIA</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1435828675, "post_id": 31179782, "comment_id": 50366817, "body": "Does the number of &quot;infinite&quot; for loops depend by the GOMAXPROCS value? e.g. if GOMAXPROCS == 3 then we can use 2 Infinite loops?"}, {"owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "reply_to_user": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "edited": false, "score": 0, "creation_date": 1435828997, "post_id": 31179782, "comment_id": 50367060, "body": "@AnthonyHunt GOMAXPROCS determines the number of OS threads that execute user level code concurrently. So yes, you could have two infinite loops. However, you shouldn&#39;t depend on any of that and rather design your code in a way such that this craftery is not needed."}], "tags": [], "owner": {"reputation": 27317, "user_id": 893693, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/yHFyJ.jpg?s=128&g=1", "display_name": "Stephan Dollberg", "link": "https://stackoverflow.com/users/893693/stephan-dollberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1435828799, "last_edit_date": 1435828799, "creation_date": 1435826914, "answer_id": 31179782, "question_id": 31179523, "link": "https://stackoverflow.com/questions/31179523/why-the-infinite-for-loop-is-not-processed/31179782#31179782", "title": "why the &quot;infinite&quot; for loop is not processed?", "body": "<p>There are two (three) problems with your code.</p>\n\n<p>First, you are right that there is no point in the loop at which you give control to the scheduler and such it can't execute the update goroutine. To fix this you can set <code>GOMAXPROCS</code> to something bigger than one and then multiple goroutines can run in parallel.</p>\n\n<p>(However, as it is this won't help as you pass x by value to the update function which means that the main goroutine will never see the update on x. To fix this problem you have to pass x by pointer. Now obsolete as OP fixed the code.)</p>\n\n<p>Finally, note that you have a data race on <code>Addr</code> as you are not using atomic loads and stores.</p>\n"}], "owner": {"reputation": 1172, "user_id": 4063955, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/4e673d7ec4fee43318e34d690606ca7c?s=128&d=identicon&r=PG&f=1", "display_name": "Anthony Hunt", "link": "https://stackoverflow.com/users/4063955/anthony-hunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 76, "favorite_count": 1, "accepted_answer_id": 31179782, "answer_count": 1, "score": 4, "last_activity_date": 1435828799, "creation_date": 1435826237, "last_edit_date": 1435828218, "question_id": 31179523, "link": "https://stackoverflow.com/questions/31179523/why-the-infinite-for-loop-is-not-processed", "title": "why the &quot;infinite&quot; for loop is not processed?", "body": "<p>I need to wait until x.Addr is being updated but it seems the for loop is not run. I suspect this is due the go scheduler and I'm wondering why it works this way or if there is any way I can fix it(without channels). </p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\n\ntype T struct {\n    Addr *string\n}\n\nfunc main() {\n\n    x := &amp;T{}\n    go update(x)\n    for x.Addr == nil {\n        if x.Addr != nil {\n            break\n        }\n    }\n    fmt.Println(\"Hello, playground\")\n}\n\nfunc update(x *T) {\n    time.Sleep(2 * time.Second)\n    y := \"\"\n    x.Addr = &amp;y\n}\n</code></pre>\n"}, {"tags": ["html", "go", "escaping"], "comments": [{"owner": {"reputation": 2232, "user_id": 1969804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b96e9ac4dfd8702e91b87753d6516e5?s=128&d=identicon&r=PG", "display_name": "SBI", "link": "https://stackoverflow.com/users/1969804/sbi"}, "edited": false, "score": 0, "creation_date": 1435820732, "post_id": 31177428, "comment_id": 50361883, "body": "The templating in go is so simple to use, I wouldn&#39;t even bother with trying to output html in any other way."}, {"owner": {"reputation": 187, "user_id": 3258706, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9a9bfcb6a2bbcc89e6da516f4dce81b8?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/3258706/matt"}, "reply_to_user": {"reputation": 2232, "user_id": 1969804, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2b96e9ac4dfd8702e91b87753d6516e5?s=128&d=identicon&r=PG", "display_name": "SBI", "link": "https://stackoverflow.com/users/1969804/sbi"}, "edited": false, "score": 0, "creation_date": 1435821023, "post_id": 31177428, "comment_id": 50362024, "body": "I am trying to create a web server in go"}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 2, "creation_date": 1435822308, "post_id": 31177428, "comment_id": 50362778, "body": "Take a look at <a href=\"http://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\">golang.org/pkg/html/template</a> - you should render data to a template. The template/html library also takes care of handling &#39;user data&#39; safely to avoid XSS. <a href=\"http://jan.newmarch.name/go/template/chapter-template.html\" rel=\"nofollow noreferrer\">jan.newmarch.name/go/template/chapter-template.html</a> is a good primer for learning the package."}], "answers": [{"comments": [{"owner": {"reputation": 2279, "user_id": 1353391, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/113cbd78d7b98635d06c25f31f0b2b94?s=128&d=identicon&r=PG", "display_name": "John Gowers", "link": "https://stackoverflow.com/users/1353391/john-gowers"}, "edited": false, "score": 0, "creation_date": 1528475443, "post_id": 31179039, "comment_id": 88537350, "body": "`&quot;&lt;p&gt;some text&lt;/p&gt;&quot; <i>is</i> a format string, just one that consists entirely of literal characters."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2279, "user_id": 1353391, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/113cbd78d7b98635d06c25f31f0b2b94?s=128&d=identicon&r=PG", "display_name": "John Gowers", "link": "https://stackoverflow.com/users/1353391/john-gowers"}, "edited": false, "score": 0, "creation_date": 1528534335, "post_id": 31179039, "comment_id": 88552442, "body": "@JohnGowers Whether a string is interpreted as a format string depends on where you pass it to. If you pass it as the 2nd argument to <code>fmt.Fprintf()</code>, yes, it will be interpreted as that, yet, it&#39;s not the intention of the asker. The asker just wants to output this string, and thus using a format string <code>&quot;%s&quot;</code> and passing this text as an argument will be more efficient as this string will not be analyzes / interpreted, just outputted as is. Also if it would contain <code>%</code> for example, the output could be entirely different than intended."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 2279, "user_id": 1353391, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/113cbd78d7b98635d06c25f31f0b2b94?s=128&d=identicon&r=PG", "display_name": "John Gowers", "link": "https://stackoverflow.com/users/1353391/john-gowers"}, "edited": false, "score": 0, "creation_date": 1528534429, "post_id": 31179039, "comment_id": 88552470, "body": "@JohnGowers Also using <code>fmt.Fprint()</code> would be more efficient as that doesn&#39;t even use format string, and it doesn&#39;t attempt to interpret the string, just writes it to the output. And if the asker wants to substitute parameters into the string, <code>html&#47;template</code> is a superior solution as that implements context sensitive escaping, safe against code injection."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 3, "last_activity_date": 1481821091, "last_edit_date": 1481821091, "creation_date": 1435824808, "answer_id": 31179039, "question_id": 31177428, "link": "https://stackoverflow.com/questions/31177428/how-do-you-escape-raw-html-in-go/31179039#31179039", "title": "How do you escape raw HTML in Go?", "body": "<p><a href=\"https://golang.org/pkg/fmt/#Fprintf\" rel=\"nofollow noreferrer\"><code>fmt.Fprintf()</code></a> has no knowledge of HTML syntax: it outputs raw data without escaping it (it may do some formatting but that is not escaping).</p>\n\n<p>You don't use it correctly though: its second parameter is a format string, so you should call it rather like this:</p>\n\n<pre><code>fmt.Fprintf(w, \"%s\", \"&lt;p&gt;some text&lt;/p&gt;\")\n</code></pre>\n\n<p>Else if your text contains some format-specific special characters, you will not get the expected result.</p>\n\n<p>What you want is to escape HTML code so it can be safely included in HTML documents/pages. For that you get excellent support from the <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\"><code>html/template</code></a> package which provides you a powerful template engine where automatic escaping functionality being just one feature.</p>\n\n<p>Here's a simple example how to achieve what you want:</p>\n\n<pre><code>w := os.Stdout\n\ntext := \"&lt;p&gt;some text&lt;/p&gt;\"\nfmt.Fprintf(w, \"%s\\n\", text)\n\ntt := `{{.}}`\nt := template.Must(template.New(\"test\").Parse(tt))\nt.Execute(w, text)\n</code></pre>\n\n<p>Output (try it on the <a href=\"http://play.golang.org/p/khD53iVQeJ\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>&lt;p&gt;some text&lt;/p&gt;\n&amp;lt;p&amp;gt;some text&amp;lt;/p&amp;gt;\n</code></pre>\n\n<p>Also note that if you only want to escape some HTML code, there is a <a href=\"https://golang.org/pkg/html/template/#HTMLEscaper\" rel=\"nofollow noreferrer\"><code>template.HTMLEscaper()</code></a> function for that:</p>\n\n<pre><code>fmt.Println(template.HTMLEscaper(text))\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>&amp;lt;p&amp;gt;some text&amp;lt;/p&amp;gt;\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2279, "user_id": 1353391, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/113cbd78d7b98635d06c25f31f0b2b94?s=128&d=identicon&r=PG", "display_name": "John Gowers", "link": "https://stackoverflow.com/users/1353391/john-gowers"}, "edited": false, "score": 0, "creation_date": 1528476477, "post_id": 31188897, "comment_id": 88537891, "body": "I&#39;m curious now as to why this didn&#39;t work for you.  The presence of the <code>&lt;p&gt;</code> tag should be enough for Go&#39;s <code>DetectContentType</code> function to detect that the text is in HTML format.  See here for a description of the algorithm used: <a href=\"https://mimesniff.spec.whatwg.org/#identifying-a-resource-with-an-unknown-mime-type\" rel=\"nofollow noreferrer\">mimesniff.spec.whatwg.org/&hellip;</a>"}], "tags": [], "owner": {"reputation": 187, "user_id": 3258706, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9a9bfcb6a2bbcc89e6da516f4dce81b8?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/3258706/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1435851353, "creation_date": 1435851353, "answer_id": 31188897, "question_id": 31177428, "link": "https://stackoverflow.com/questions/31177428/how-do-you-escape-raw-html-in-go/31188897#31188897", "title": "How do you escape raw HTML in Go?", "body": "<p>The problem here was not the output method that i used. Atchaully, the browser is seeing it as plain text instead of html. Therefore you need to tell the browser that it is html. </p>\n\n<pre><code> w.Header().Set(\"Content-Type\", \"text/html\")\n</code></pre>\n\n<p>This function simply sets the content type to html.</p>\n"}], "owner": {"reputation": 187, "user_id": 3258706, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9a9bfcb6a2bbcc89e6da516f4dce81b8?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/3258706/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1183, "favorite_count": 0, "answer_count": 2, "score": -3, "last_activity_date": 1481821091, "creation_date": 1435819937, "last_edit_date": 1435825302, "question_id": 31177428, "link": "https://stackoverflow.com/questions/31177428/how-do-you-escape-raw-html-in-go", "title": "How do you escape raw HTML in Go?", "body": "<p>I have managed to output text using the following line:</p>\n\n<pre><code>fmt.Fprintf(w, \"&lt;p&gt;some text&lt;/p&gt;\")\n</code></pre>\n\n<p>But this will literally output the HTML tags. How do you output it so it can safely be included in HTML like you would with <code>echo</code> in PHP?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "edited": false, "score": 0, "creation_date": 1436780416, "post_id": 31297418, "comment_id": 50738030, "body": "Well not exactly the answer I had hoped for, but I guess it can&#39;t be helped. Your proposal wouldn&#39;t work in my specific situation, but at least you pointed out the limitations of the Go xml package, which is why I&#39;m accepting this answer."}], "tags": [], "owner": {"reputation": 8146, "user_id": 3477832, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/44M2u.png?s=128&g=1", "display_name": "kostya", "link": "https://stackoverflow.com/users/3477832/kostya"}, "is_accepted": true, "score": 5, "last_activity_date": 1436370002, "creation_date": 1436370002, "answer_id": 31297418, "question_id": 31177050, "link": "https://stackoverflow.com/questions/31177050/correct-use-of-xml-annotations-fields-and-structs-in-custom-unmarshalxml-functi/31297418#31297418", "title": "Correct use of XML annotations, fields and structs in custom UnmarshalXML function", "body": "<p><code>xml</code> package doesn't provide a way to unmarshal XML into <code>map[string]interface{}</code> because there is no single way to do it and in some cases it is not possible. A map doesn't preserve order of the elements (that is important in XML) and doesn't allow elements with duplicate keys.</p>\n\n<p><code>mxj</code> package that you used in your example has some rules how to unmarshal arbitrary XML into Go map. If your requirements do not conflict with these rules you can use <code>mxj</code> package to do all parsing and do not use <code>xml</code> package at all:</p>\n\n<pre><code>// I am skipping error handling here\nm, _ := mxj.NewMapXml([]byte(s))\nmm := m[\"myStruct\"].(map[string]interface{})\nmyStruct.Name = mm[\"name\"].(string)\nmyStruct.Meta = mm[\"meta\"].(map[string]interface{})\n</code></pre>\n\n<p>Full example: <a href=\"http://play.golang.org/p/AcPUAS0QMj\">http://play.golang.org/p/AcPUAS0QMj</a></p>\n"}], "owner": {"reputation": 1751, "user_id": 3973406, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/b2d94768947ebd5fd0f38ee5b3f472c5?s=128&d=identicon&r=PG&f=1", "display_name": "Dac0d3r", "link": "https://stackoverflow.com/users/3973406/dac0d3r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 333, "favorite_count": 0, "accepted_answer_id": 31297418, "answer_count": 1, "score": 13, "last_activity_date": 1436370002, "creation_date": 1435818662, "last_edit_date": 1436344459, "question_id": 31177050, "link": "https://stackoverflow.com/questions/31177050/correct-use-of-xml-annotations-fields-and-structs-in-custom-unmarshalxml-functi", "title": "Correct use of XML annotations, fields and structs in custom UnmarshalXML function", "body": "<p>Consider the following struct:</p>\n\n<pre><code>type MyStruct struct {\n    Name string\n    Meta map[string]interface{}\n}\n</code></pre>\n\n<p>Which has the following UnmarshalXML function:</p>\n\n<pre><code>func (m *MyStruct) UnmarshalXML(d *xml.Decoder, start xml.StartElement) error {\n    var v struct {\n        XMLName xml.Name //`xml:\"myStruct\"`\n        Name    string   `xml:\"name\"`\n        Meta    struct {\n            Inner []byte `xml:\",innerxml\"`\n        } `xml:\"meta\"`\n    }\n\n    err := d.DecodeElement(&amp;v, &amp;start)\n    if err != nil {\n        return err\n    }\n\n    m.Name = v.Name\n    myMap := make(map[string]interface{})\n\n    // ... do the mxj magic here ... -\n\n    temp := v.Meta.Inner\n\n    prefix := \"&lt;meta&gt;\"\n    postfix := \"&lt;/meta&gt;\"\n    str := prefix + string(temp) + postfix\n    //fmt.Println(str)\n    myMxjMap, err := mxj.NewMapXml([]byte(str))\n    myMap = myMxjMap\n\n    // fill myMap\n    //m.Meta = myMap\n    m.Meta = myMap[\"meta\"].(map[string]interface{})\n    return nil\n}\n</code></pre>\n\n<p>My problem with this code is these lines:</p>\n\n<pre><code>prefix := \"&lt;meta&gt;\"\npostfix := \"&lt;/meta&gt;\"\nstr := prefix + string(temp) + postfix\nmyMxjMap, err := mxj.NewMapXml([]byte(str))\nmyMap = myMxjMap\n//m.Meta = myMap\nm.Meta = myMap[\"meta\"].(map[string]interface{})\n</code></pre>\n\n<p>My question is how I make the correct use of the xml annotations (,innerxml etc), fields and structs, so I don't have to manually pre-/append the <code>&lt;meta&gt;&lt;/meta&gt;</code> tags afterwards to get the whole Meta field as a single map.</p>\n\n<p>The full code example is here: <a href=\"http://play.golang.org/p/Q4_tryubO6\">http://play.golang.org/p/Q4_tryubO6</a></p>\n"}, {"tags": ["mysql", "web", "go"], "comments": [{"owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "edited": false, "score": 0, "creation_date": 1435819036, "post_id": 31176777, "comment_id": 50361011, "body": "What is the &quot;http print function&quot;?"}], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435819396, "post_id": 31177120, "comment_id": 50361182, "body": "See <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">golang.org/pkg/fmt</a> - they are format specifiers and common to most C-based languages."}], "tags": [], "owner": {"reputation": 5488, "user_id": 1078890, "user_type": "registered", "accept_rate": 46, "profile_image": "https://i.stack.imgur.com/Dqula.jpg?s=128&g=1", "display_name": "IamNaN", "link": "https://stackoverflow.com/users/1078890/iamnan"}, "is_accepted": true, "score": 3, "last_activity_date": 1435818866, "creation_date": 1435818866, "answer_id": 31177120, "question_id": 31176777, "link": "https://stackoverflow.com/questions/31176777/how-to-fetch-multiple-column-from-mysql-using-go-lang/31177120#31177120", "title": "How to fetch multiple column from mysql using go lang", "body": "<p>You are using the wrong variable names but I assume that's just a \"typo\" in your sample code.</p>\n\n<p>Then the correct syntax is:</p>\n\n<pre><code>var first, second string\nrows.Scan(&amp;first, &amp;second)\n</code></pre>\n\n<p>See <a href=\"https://golang.org/ref/spec#Passing_arguments_to_..._parameters\" rel=\"nofollow\">this</a> on what <code>Scan(dest ...interface{})</code> means and how to use it.</p>\n\n<p>You should also handle and not ignore the errors.</p>\n\n<p>Finally, you should use <a href=\"http://golang.org/pkg/fmt/#Fprintf\" rel=\"nofollow\">Fprintf</a> as it's intended:</p>\n\n<pre><code>fmt.Fprintf(w, \"Title of first is : %s\\nThe second is: %s\", first, second)\n</code></pre>\n"}], "owner": {"reputation": 187, "user_id": 3258706, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/9a9bfcb6a2bbcc89e6da516f4dce81b8?s=128&d=identicon&r=PG&f=1", "display_name": "matt", "link": "https://stackoverflow.com/users/3258706/matt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2488, "favorite_count": 1, "accepted_answer_id": 31177120, "answer_count": 1, "score": 1, "last_activity_date": 1435818951, "creation_date": 1435817545, "last_edit_date": 1435818951, "question_id": 31176777, "link": "https://stackoverflow.com/questions/31176777/how-to-fetch-multiple-column-from-mysql-using-go-lang", "title": "How to fetch multiple column from mysql using go lang", "body": "<p>I am trying to fetch multiple columns in a mysql database using the <strong>go</strong> language. Currently I could modify this script, and it would work perfectly well for just fetching one column, and printing it using the http print function. However, when it fetches two things the script no longer works. I don't have any idea what I need to do to fix it. I know that the sql is fine as I have tested that out in the mysql terminal, and it has given me the expected result that I wanted.  </p>\n\n<pre><code> conn, err := sql.Open(\"mysql\", \"user:password@tcp(localhost:3306)/database\")\n statement, err := conn.Prepare(\"select first,second from table\") \n rows, err := statement.Query()\n for rows.Next() {\n         var first string\n         rows.Scan(&amp;first)\n         var second string\n         rows.Scan(&amp;second)\n         fmt.Fprintf(w, \"Title of first is :\"+first+\"The second is\"+second)\n }\n conn.Close()\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 622, "user_id": 2949830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I9CgV.jpg?s=128&g=1", "display_name": "rusnasonov", "link": "https://stackoverflow.com/users/2949830/rusnasonov"}, "edited": false, "score": 0, "creation_date": 1435816312, "post_id": 31176415, "comment_id": 50359783, "body": "second instance go log.Fatal(http.ListenAndServe(&quot;:8002&quot;, r2)) does&#39;t start. When i go to localhost:8002 the webpage is not available."}, {"owner": {"reputation": 1749, "user_id": 3243380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MrCc3.jpg?s=128&g=1", "display_name": "nussjustin", "link": "https://stackoverflow.com/users/3243380/nussjustin"}, "edited": false, "score": 0, "creation_date": 1435816627, "post_id": 31176415, "comment_id": 50359910, "body": "You&#39;re only running the log.Fatal calls in their own Goroutines. The calls to ListenAndServe still happen on the Main Goroutine and will block."}, {"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435816955, "post_id": 31176415, "comment_id": 50360031, "body": "Fixed it. Hammered it out on my phone. Should work now. The empty <code>select{}</code> is a quick way to block indefinitely."}], "tags": [], "owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "is_accepted": true, "score": 11, "last_activity_date": 1435816918, "last_edit_date": 1435816918, "creation_date": 1435815805, "answer_id": 31176415, "question_id": 31176307, "link": "https://stackoverflow.com/questions/31176307/how-to-create-many-http-servers-into-one-app/31176415#31176415", "title": "How to create many http servers into one app?", "body": "<p>You'll need to create separate <code>http.ServeMux</code> instances. Calling <code>http.ListenAndServe(port, nil)</code> uses the <code>DefaultServeMux</code> (i.e. shared). The docs for this are here: <a href=\"http://golang.org/pkg/net/http/#NewServeMux\">http://golang.org/pkg/net/http/#NewServeMux</a></p>\n\n<p>Example:</p>\n\n<pre><code>func main() {\n    r1 := http.NewServeMux()\n    r1.HandleFunc(\"/\", helloOne)\n\n    r2 := http.NewServeMux()\n    r2.HandleFunc(\"/\", helloTwo)\n\n    go func() { log.Fatal(http.ListenAndServe(\":8001\", r1))}()\n    go func() { log.Fatal(http.ListenAndServe(\":8002\", r2))}()\n    select {}\n}\n</code></pre>\n\n<p>Wrapping the servers with <code>log.Fatal</code> will cause the program to quit if one of the listeners doesn't function. If you wanted the program to stay up if one of the servers fails to start or crashes, you could <code>err := http.ListenAndServe(port, mux)</code> and handle the error another way.</p>\n"}], "owner": {"reputation": 622, "user_id": 2949830, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/I9CgV.jpg?s=128&g=1", "display_name": "rusnasonov", "link": "https://stackoverflow.com/users/2949830/rusnasonov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 774, "favorite_count": 0, "accepted_answer_id": 31176415, "answer_count": 1, "score": 4, "last_activity_date": 1435816918, "creation_date": 1435815271, "question_id": 31176307, "link": "https://stackoverflow.com/questions/31176307/how-to-create-many-http-servers-into-one-app", "title": "How to create many http servers into one app?", "body": "<p>I want create two http servers into one golang app. Example:</p>\n\n<pre><code>    package main\n\n    import (\n    \"io\"\n    \"net/http\"\n)\n\nfunc helloOne(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello world one!\")\n}\n\nfunc helloTwo(w http.ResponseWriter, r *http.Request) {\n    io.WriteString(w, \"Hello world two!\")\n}\n\nfunc main() {\n    // how to create two http server instatce? \n    http.HandleFunc(\"/\", helloOne)\n    http.HandleFunc(\"/\", helloTwo)\n    go http.ListenAndServe(\":8001\", nil)\n    http.ListenAndServe(\":8002\", nil)\n}\n</code></pre>\n\n<p>How to create two http server instance and add handlers for them?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 407, "user_id": 1116320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57109f0ba9d6d7a3ad945a6d5c3c019e?s=128&d=identicon&r=PG", "display_name": "HaseebR7", "link": "https://stackoverflow.com/users/1116320/haseebr7"}, "edited": false, "score": 0, "creation_date": 1435814148, "post_id": 31176008, "comment_id": 50359086, "body": "i also want to assign a value to it in the same line"}, {"owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "reply_to_user": {"reputation": 407, "user_id": 1116320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57109f0ba9d6d7a3ad945a6d5c3c019e?s=128&d=identicon&r=PG", "display_name": "HaseebR7", "link": "https://stackoverflow.com/users/1116320/haseebr7"}, "edited": false, "score": 1, "creation_date": 1435814725, "post_id": 31176008, "comment_id": 50359284, "body": "<code>time.Wednesday</code> is a value"}], "tags": [], "owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "is_accepted": false, "score": 1, "last_activity_date": 1435813780, "creation_date": 1435813780, "answer_id": 31176008, "question_id": 31175910, "link": "https://stackoverflow.com/questions/31175910/using-new-and-assigning-variable-at-the-same-time/31176008#31176008", "title": "Using new and assigning variable at the same time", "body": "<p>you can simply use the time.weekday constants for that: </p>\n\n<p><code>wd := time.Wednesday</code></p>\n"}, {"tags": [], "owner": {"reputation": 5608, "user_id": 660828, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/2ab261718814b4842efac71a1b6cd1a5?s=128&d=identicon&r=PG", "display_name": "Tom Jowitt", "link": "https://stackoverflow.com/users/660828/tom-jowitt"}, "is_accepted": true, "score": 0, "last_activity_date": 1435815508, "creation_date": 1435815508, "answer_id": 31176358, "question_id": 31175910, "link": "https://stackoverflow.com/questions/31175910/using-new-and-assigning-variable-at-the-same-time/31176358#31176358", "title": "Using new and assigning variable at the same time", "body": "<p><a href=\"https://golang.org/pkg/time/#Weekday\" rel=\"nofollow\">time.Weekday</a> is an int so you can assign it as such (or use the defined constants as Adam suggested). Can I ask why you need to use new in this situation?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    var wd time.Weekday = 3\n    fmt.Println(wd)\n}\n</code></pre>\n"}], "owner": {"reputation": 407, "user_id": 1116320, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/57109f0ba9d6d7a3ad945a6d5c3c019e?s=128&d=identicon&r=PG", "display_name": "HaseebR7", "link": "https://stackoverflow.com/users/1116320/haseebr7"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 31176358, "answer_count": 2, "score": -1, "last_activity_date": 1435815508, "creation_date": 1435813232, "question_id": 31175910, "link": "https://stackoverflow.com/questions/31175910/using-new-and-assigning-variable-at-the-same-time", "title": "Using new and assigning variable at the same time", "body": "<pre><code>wd := new(time.Weekday)\nfmt.Println(wd.String())\n</code></pre>\n\n<p>The above two lines return Sunday (weekdays start with a 0)</p>\n\n<p>Is it possible for me to assign a value along with new ? Other method i tried is </p>\n\n<pre><code>var wd time.Weekday\nwd = 3\n</code></pre>\n\n<p>this one returns Wednesday</p>\n"}, {"tags": ["reflection", "go", "arguments", "func"], "answers": [{"comments": [{"owner": {"reputation": 19878, "user_id": 556573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/az7kz.png?s=128&g=1", "display_name": "elithrar", "link": "https://stackoverflow.com/users/556573/elithrar"}, "edited": false, "score": 0, "creation_date": 1435815349, "post_id": 31176148, "comment_id": 50359492, "body": "Good answer. I&#39;d also suggest the OP look at <a href=\"https://justinas.org/writing-http-middleware-in-go/\" rel=\"nofollow noreferrer\">justinas.org/writing-http-middleware-in-go</a> and <a href=\"http://www.alexedwards.net/blog/making-and-using-middleware\" rel=\"nofollow noreferrer\">alexedwards.net/blog/making-and-using-middleware</a> - it looks like they&#39;re currently working against the grain. If you have to reach to <code>reflect</code> just to write HTTP middleware something might be askew!"}, {"owner": {"reputation": 534, "user_id": 2485693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cba523020d38ee3275849615ead69e2?s=128&d=identicon&r=PG", "display_name": "Ricardo Rossi", "link": "https://stackoverflow.com/users/2485693/ricardo-rossi"}, "edited": false, "score": 0, "creation_date": 1435851841, "post_id": 31176148, "comment_id": 50383151, "body": "Thanks for your response Adam! I edited my original question to show how I ended up implementing it."}], "tags": [], "owner": {"reputation": 771, "user_id": 4515252, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--02zX_AQuqM/AAAAAAAAAAI/AAAAAAAAK64/PpH7Pn2gzSg/photo.jpg?sz=128", "display_name": "Adam Vincze", "link": "https://stackoverflow.com/users/4515252/adam-vincze"}, "is_accepted": true, "score": 3, "last_activity_date": 1435814440, "creation_date": 1435814440, "answer_id": 31176148, "question_id": 31175233, "link": "https://stackoverflow.com/questions/31175233/how-do-i-get-the-values-of-arguments-passed-inside-a-func-argument-in-go/31176148#31176148", "title": "How do I get the values of arguments passed inside a func() argument in GO?", "body": "<p>simple answer: you don't. Not at that place at least</p>\n\n<p>the variables <code>rw</code> and <code>req</code> make first sense if the function <code>fn</code> is called. (or a function that calls fn, which probably will have <code>rw</code> and <code>req</code> variables)</p>\n\n<p>In your case it is probably where <code>appContainer</code> uses the routes configured</p>\n\n<p>To better understand how middleware concept works a simple example can be found here: <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow\">https://golang.org/doc/articles/wiki/</a></p>\n\n<p>you might want to scroll down to \"Introducing Function Literals and Closures\"</p>\n"}], "owner": {"reputation": 534, "user_id": 2485693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6cba523020d38ee3275849615ead69e2?s=128&d=identicon&r=PG", "display_name": "Ricardo Rossi", "link": "https://stackoverflow.com/users/2485693/ricardo-rossi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 31176148, "answer_count": 1, "score": -1, "last_activity_date": 1435851749, "creation_date": 1435808625, "last_edit_date": 1435851749, "question_id": 31175233, "link": "https://stackoverflow.com/questions/31175233/how-do-i-get-the-values-of-arguments-passed-inside-a-func-argument-in-go", "title": "How do I get the values of arguments passed inside a func() argument in GO?", "body": "<p>I am trying to create middleware inside routes and wondering how one can get the values of arguments passed inside a func() argument.</p>\n\n<p>For example:</p>\n\n<pre><code>func (c appContainer) Get(path string, fn func(rw http.ResponseWriter, req *http.Request)) {\n\n    // HOW DO I GET THE VALUES OF rw AND req PASSED IN fn func()?\n\n    c.providers[ROUTER].(Routable).Get(path, fn)\n}\n</code></pre>\n\n<p>I looked through the reflection docs but it's not clear to me or perhaps there is a simpler way? </p>\n\n<h1><strong>EDITED (SOLUTION)</strong></h1>\n\n<p>It turns out reflection is not needed, as suggested by Adam in his response to this post, as well as Jason on <a href=\"https://groups.google.com/forum/#!msg/golang-nuts/B4T1dwCIUZk/bvcrEgkL7rEJ\" rel=\"nofollow\">his golang-nuts reply</a> to my question. </p>\n\n<p>The idea is to create a new anonymous function which then intercepts the parameters passed to it for modification/enhancement before calling the original function.</p>\n\n<p>This is what I ended up doing and it worked like a charm, which I am posting in case it helps someone else:</p>\n\n<pre><code>type handlerFn func(rw http.ResponseWriter, req *http.Request)\n\nfunc (c appContainer) Get(path string, fn handlerFn) {\n    nfn := func(rw http.ResponseWriter, req *http.Request) {\n        c.providers[LOGGER].(Loggable).Info(\"[%s] %s\", req.Method, req.URL.Path)\n        fn(rw, req)\n    }\n    c.providers[ROUTER].(Routable).Get(path, nfn)\n}\n</code></pre>\n"}]