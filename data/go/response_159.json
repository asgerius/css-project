[{"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516835548, "post_id": 48432473, "comment_id": 83857763, "body": "You need to decide what that &quot;schema&quot; is going to be regardless, otherwise there&#39;s no way to know what elements/attributes map to what data structures. What is the structure you want to create?"}, {"owner": {"reputation": 68, "user_id": 6153656, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1ITcntfP084/AAAAAAAAAAI/AAAAAAAAEus/Kudp04Im0AM/photo.jpg?sz=128", "display_name": "Cliff Brown", "link": "https://stackoverflow.com/users/6153656/cliff-brown"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516916689, "post_id": 48432473, "comment_id": 83897933, "body": "@JimB The target data store is an elastic search store. The unknown elements are based on a variety of factors manually driven by legacy requirements. There is a schema-based header record, but there are a variety of elements that would be impossible to map to a schema as they are essentially an array of responses."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1516916922, "post_id": 48432473, "comment_id": 83898040, "body": "I put schema in quotes, because I didn&#39;t mean a literal XML schema, I meant a programatic &quot;schema&quot; for how you intend to translate the XML to something with a different structure that isn&#39;t XML. XML can&#39;t map directly to json, so you need some definition of how you intend to do that."}], "answers": [{"tags": [], "owner": {"reputation": 415, "user_id": 5319281, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/22148896d125fa2c7357852622e2911d?s=128&d=identicon&r=PG&f=1", "display_name": "AppTest", "link": "https://stackoverflow.com/users/5319281/apptest"}, "is_accepted": true, "score": 3, "last_activity_date": 1516853631, "last_edit_date": 1516853631, "creation_date": 1516837638, "answer_id": 48433525, "question_id": 48432473, "link": "https://stackoverflow.com/questions/48432473/map-xml-using-attributes-as-value-with-dynamic-nodes/48433525#48433525", "title": "Map XML using attributes as value with dynamic nodes", "body": "<p>When you're unsure about the structure <a href=\"https://github.com/PuerkitoBio/goquery\" rel=\"nofollow noreferrer\">goquery</a> is probably your best bet. Your tag names look a little odd I assume that's just for the sample. The code below uses the tag name for the key and uses the value attribute but you can modify it for any structure.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/PuerkitoBio/goquery\"\n    \"strings\"\n)\n\nfunc main() {\n    xml := `\n      &lt;?xml version=\"1.0\"?&gt;\n      &lt;Data&gt;\n          &lt;f1 value=\"field value\"&gt;&lt;/f1&gt;\n          &lt;f2 value=\"other value\"&gt;&lt;/f2&gt;\n          &lt;f3 value=\"field value 2\"&gt;&lt;/f3&gt;\n          &lt;withchildren&gt;\n              &lt;f31 value=\"testvalue\"&gt;&lt;/f31&gt;\n              &lt;f32 value=\"test value 3\"&gt;&lt;/f32&gt;\n          &lt;/withchildren&gt;\n      &lt;/Data&gt;\n      `\n    data := make(map[string]interface{})\n    reader := strings.NewReader(xml)\n\n    doc, _ := goquery.NewDocumentFromReader(reader)\n    children := doc.Find(\"Data\").Children()\n\n    children.Each(func(i int, s *goquery.Selection) {\n\n        val, exists := s.Attr(\"value\")\n        if exists {\n            data[goquery.NodeName(s)] = val\n        }\n\n        withchildren := s.Children()\n\n        if withchildren.Length() &gt; 0 {\n            withchildren.Each(func(i int, s *goquery.Selection) {\n                val, exists := s.Attr(\"value\")\n                if exists {\n                    data[goquery.NodeName(s)] = val\n                }\n\n            })\n        }\n    })\n    fmt.Println(data)\n}\n</code></pre>\n\n<p>And if you really have no idea what the structure could be or how many nested elements there might be try this recursive version.</p>\n\n<p>If you have multiple elements with the same name then you could modify the code to add a number with the key name. So \"tag1\", \"tag2\", etc. </p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/PuerkitoBio/goquery\"\n    \"strings\"\n)\n\nfunc main() {\n    xml := `\n      &lt;?xml version=\"1.0\"?&gt;\n      &lt;Data&gt;\n          &lt;f1 value=\"field value\"&gt;&lt;/f1&gt;\n          &lt;f2 value=\"other value\"&gt;&lt;/f2&gt;\n          &lt;f3 value=\"field value 2\"&gt;&lt;/f3&gt;\n          &lt;withchildren&gt;\n              &lt;f31 value=\"testvalue\"&gt;&lt;/f31&gt;\n              &lt;f32 value=\"test value 3\"&gt;&lt;/f32&gt;\n          &lt;/withchildren&gt;\n      &lt;/Data&gt;\n      `\n    data := make(map[string]interface{})\n    reader := strings.NewReader(xml)\n\n    doc, _ := goquery.NewDocumentFromReader(reader)\n    children := doc.Find(\"Data\").Children()\n    data = getElements(children)\n}\n\nfunc getElements(children *goquery.Selection) map[string]interface{} {\n    data := make(map[string]interface{})\n    children.Each(func(i int, s *goquery.Selection) {\n        val, exists := s.Attr(\"value\")\n        if exists {\n            data[goquery.NodeName(s)] = val\n        }\n\n        if s.Children().Length() &gt; 0 {\n            data[goquery.NodeName(s)] = getElements(s.Children())\n        }\n    })\n    return data\n}\n</code></pre>\n\n<p>There are also some Go packages that I haven't used. </p>\n\n<p><a href=\"https://github.com/clbanning/mxj\" rel=\"nofollow noreferrer\">mxj</a> converts xml to map[string]interface{}</p>\n\n<p><a href=\"https://github.com/basgys/goxml2json\" rel=\"nofollow noreferrer\">goxml2json</a> converts from xml to json.</p>\n"}], "owner": {"reputation": 68, "user_id": 6153656, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-1ITcntfP084/AAAAAAAAAAI/AAAAAAAAEus/Kudp04Im0AM/photo.jpg?sz=128", "display_name": "Cliff Brown", "link": "https://stackoverflow.com/users/6153656/cliff-brown"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 150, "favorite_count": 0, "accepted_answer_id": 48433525, "answer_count": 1, "score": 0, "last_activity_date": 1516853631, "creation_date": 1516831604, "question_id": 48432473, "link": "https://stackoverflow.com/questions/48432473/map-xml-using-attributes-as-value-with-dynamic-nodes", "title": "Map XML using attributes as value with dynamic nodes", "body": "<p>I am attempting to convert data stored in xml documents into an alternative data store. I have tried a variety of techniques but none have proven effective. The problem is the xml does not have a fixed schema and has an unconventional structure. A sample of the xml is as follows</p>\n\n<pre><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;Data&gt;\n    &lt;f.1 value=\"field value\" /&gt;\n    &lt;f.2 value=\"other value\" /&gt;\n    &lt;f.3 value=\"field value 2\" /&gt;\n    &lt;withchildren&gt;\n        &lt;f.3.1 value=\"testvalue\" /&gt;\n        &lt;f.3.2 value=\"test value 3\" /&gt;\n    &lt;/withchildren&gt;\n&lt;/Data&gt;\n</code></pre>\n\n<p>Ideally the end result should store the result in <code>map[string]interface{}</code> in order to convert the value into a standard multi-dimensional JSON format.</p>\n"}, {"tags": ["go", "gorilla"], "comments": [{"owner": {"reputation": 45, "user_id": 8672969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3907d9bf82fb24d9f02fd547aad881?s=128&d=identicon&r=PG&f=1", "display_name": "shawndo", "link": "https://stackoverflow.com/users/8672969/shawndo"}, "edited": false, "score": 1, "creation_date": 1516832354, "post_id": 48432018, "comment_id": 83856429, "body": "I figured out this is related to the need of the session.Save(r, w) to be executed before anything is written to the response.  The wrapper in this case is writing to the response first.  So now I need to figure out the best-practice way to handle situations like this"}, {"owner": {"reputation": 2032, "user_id": 2807880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa4be6aadf65ca5438f9facc5cd7752?s=128&d=identicon&r=PG&f=1", "display_name": "sbarzowski", "link": "https://stackoverflow.com/users/2807880/sbarzowski"}, "edited": false, "score": 0, "creation_date": 1516844144, "post_id": 48432018, "comment_id": 83860159, "body": "I wouldn&#39;t use middleware like that to write parts of the response. You&#39;re probably better off doing all the rendering in one place, separately from the middleware (which is mostly about http)."}, {"owner": {"reputation": 45, "user_id": 8672969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3907d9bf82fb24d9f02fd547aad881?s=128&d=identicon&r=PG&f=1", "display_name": "shawndo", "link": "https://stackoverflow.com/users/8672969/shawndo"}, "reply_to_user": {"reputation": 2032, "user_id": 2807880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa4be6aadf65ca5438f9facc5cd7752?s=128&d=identicon&r=PG&f=1", "display_name": "sbarzowski", "link": "https://stackoverflow.com/users/2807880/sbarzowski"}, "edited": false, "score": 0, "creation_date": 1516889484, "post_id": 48432018, "comment_id": 83881287, "body": "So what is the customary way of including a common header/navigation bar/etc to all the pages of a webapp ?"}, {"owner": {"reputation": 2032, "user_id": 2807880, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3fa4be6aadf65ca5438f9facc5cd7752?s=128&d=identicon&r=PG&f=1", "display_name": "sbarzowski", "link": "https://stackoverflow.com/users/2807880/sbarzowski"}, "edited": false, "score": 0, "creation_date": 1516892315, "post_id": 48432018, "comment_id": 83883395, "body": "Nested templates are pretty common for that. For example this seems to be a pretty good guide on how to do that: <a href=\"https://hackernoon.com/golang-template-2-template-composition-and-how-to-organize-template-files-4cb40bcdf8f6\" rel=\"nofollow noreferrer\">hackernoon.com/&hellip;</a>"}], "owner": {"reputation": 45, "user_id": 8672969, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0b3907d9bf82fb24d9f02fd547aad881?s=128&d=identicon&r=PG&f=1", "display_name": "shawndo", "link": "https://stackoverflow.com/users/8672969/shawndo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516829875, "creation_date": 1516829875, "question_id": 48432018, "link": "https://stackoverflow.com/questions/48432018/gorilla-sessions-cookie-usage-with-a-wrapper", "title": "Gorilla sessions cookie usage with a wrapper", "body": "<p>I am using a basic wrapper in a web application like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"os\"\n\n    \"github.com/gorilla/mux\"\n    \"github.com/gorilla/sessions\"\n)\n\nconst (\n    PORT = \"8083\"\n)\n\nfunc navbarWrapper(h http.HandlerFunc) http.HandlerFunc {\n    return func(w http.ResponseWriter, r *http.Request) {\n        fmt.Fprintln(w, \"header\")\n        h(w, r) // call original function\n        fmt.Fprintln(w, \"footer\")\n    }\n}\n\nfunc main() {\n    r := mux.NewRouter()\n    r.HandleFunc(\"/cookie_write\", navbarWrapper(cookie_write))\n\n    hostname, _ := os.Hostname()\n    log.Printf(\"Listening on port %s https://%s:%s/\", PORT, hostname, PORT)\n    http.ListenAndServe(\":\"+PORT, r)\n}\n</code></pre>\n\n<p>I would like to set a cookie, but it is not being sent to the browser, but is also not providing an error</p>\n\n<pre><code>var (\n    key   = []byte(\"16bytestufffffff\")\n    store = sessions.NewCookieStore(key)\n)\n\nfunc cookie_write(w http.ResponseWriter, r *http.Request) {\n    session, _ := store.Get(r, \"session-name\")\n\n    session.Values[\"authenticated\"] = true\n    session.Values[\"stuff\"] = \"important info\"\n    if err := session.Save(r, w); err != nil {\n        fmt.Println(err)\n        fmt.Println(\"error\")\n    } else {\n        fmt.Println(\"worked?\")\n    }\n}\n</code></pre>\n\n<p>If I remove the wrapper, then it works fine and I can see the cookie being generated in the browser:</p>\n\n<pre><code>r.HandleFunc(\"/cookie_write\", cookie_write)\n</code></pre>\n\n<p>I know I must not be saving the session correctly, but I can't figure out how to do it.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1516829276, "post_id": 48431529, "comment_id": 83854874, "body": "The compiler doesn&#39;t need cgo, so just build it with <code>CGO_ENABLED=0</code>. You don&#39;t need <code>&#39;-extldflags &quot;-static&quot;&#39;</code> at all, because it&#39;s not invoking an external linker, because there&#39;s no cgo."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8725011"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516835838, "post_id": 48431529, "comment_id": 83857862, "body": "I thought of CGO as some kind of &quot;feature gate&quot; to en- or disable the CGO functionality?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1516836597, "post_id": 48431529, "comment_id": 83858091, "body": "yes, that&#39;s the point, you&#39;re disabling that functionality while building the go toolchain. It also sets the default in <code>go env</code>, but it doesn&#39;t effect what the go tool or the compiler have the ability to build."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8725011"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516904481, "post_id": 48431529, "comment_id": 83891663, "body": "hmm looks like the go docs disagree concerning cgo <a href=\"https://golang.org/doc/install/source#ccompiler\" rel=\"nofollow noreferrer\">golang.org/doc/install/source#ccompiler</a>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516904749, "post_id": 48431529, "comment_id": 83891822, "body": "I don&#39;t understand how you mean that disagrees. That is exactly matches what I&#39;ve said."}], "owner": {"user_type": "does_not_exist", "display_name": "user8725011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 555, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516827746, "creation_date": 1516827746, "question_id": 48431529, "link": "https://stackoverflow.com/questions/48431529/how-do-i-compile-the-go-compiler-statically", "title": "How do I compile the go compiler statically?", "body": "<p>How do I compile the go compiler statically with CGO support?</p>\n\n<p>Compiling the sources with CGO_ENABLED=0 and GO_LDFLAGS='-extldflags \"-static\"'  results in a statically linked binary:</p>\n\n<pre><code>../bin/go: ELF 64-bit LSB executable, x86-64, version 1 (SYSV), statically linked, not stripped\n</code></pre>\n\n<p>However, using the linker flags and CGO_ENABLED=1 does not produced a statically linked binary. </p>\n\n<p>This is what I have done so far:</p>\n\n<pre><code>FROM debian:stretch-slim AS builder                                                                                                   \n\nENV CGO_ENABLED=1                                                                                                                     \nENV GO_LDFLAGS='-extldflags \"-static\"'                                                                                                \nENV GOROOT_BOOTSTRAP=/usr/local/go                                                                                                    \nRUN apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install -y curl git build-essential make cmake                                                \nRUN curl -fLOSs \"https://dl.google.com/go/go1.9.3.linux-amd64.tar.gz\" \\                                                               \n&amp;&amp; tar -C /usr/local -xzf \"go1.9.3.linux-amd64.tar.gz\"                                                                                \nRUN git clone https://go.googlesource.com/go \\                                                                                        \n&amp;&amp; cd go \\                                                                                                                            \n&amp;&amp; git checkout go1.9.3 \\                                                                                                             \n&amp;&amp; cd src \\                                                                                                                           \n&amp;&amp; ./make.bash                                                                                                                        \nRUN apt install -y file &amp;&amp; /usr/bin/file /go/bin/go                                                                                   \n\n\nFROM scratch                                                                                                                         \nENV GOPATH=/code                                                                                                                     \nCOPY --from=builder /go/bin /usr/local/go/bin                                                                                        \nCMD [\"/usr/local/go/bin/go\"] \n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1516827687, "post_id": 48431359, "comment_id": 83854089, "body": "Which line of which file is triggering the error?"}, {"owner": {"reputation": 35, "user_id": 4488825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d355de4268199435af1dd9fdb440de01?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Jolin", "link": "https://stackoverflow.com/users/4488825/ben-jolin"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516827863, "post_id": 48431359, "comment_id": 83854175, "body": "It doesn&#39;t say what line is triggering the error. It just tells me that mssql.go is the file triggering it."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516827908, "post_id": 48431359, "comment_id": 83854197, "body": "I see it: <code>row := db.QueryRow</code>. The error is right, <code>db</code> is not defined. What is it supposed to be referencing?"}, {"owner": {"reputation": 35, "user_id": 4488825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d355de4268199435af1dd9fdb440de01?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Jolin", "link": "https://stackoverflow.com/users/4488825/ben-jolin"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516828154, "post_id": 48431359, "comment_id": 83854336, "body": "According to Ben Johnson&#39;s explanation, main.go is supposed to create a service and that is what mssql.go should be using. I&#39;m just not sure how. The website is not clear on that. I&#39;ll put the link up in a bit."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1516829208, "post_id": 48431359, "comment_id": 83854840, "body": "<code>main.go</code> defines a <code>db</code> package variable, but it&#39;s in a different package from <code>mssql.go</code>, so it&#39;s not accessible from that file, for 3 reasons: it&#39;s not exported (it doesn&#39;t start with an uppercase letter); <code>mssql.go</code> doesn&#39;t reference it by its package; and it&#39;s in the <code>main</code> package, which cannot be imported from another package."}, {"owner": {"reputation": 35, "user_id": 4488825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d355de4268199435af1dd9fdb440de01?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Jolin", "link": "https://stackoverflow.com/users/4488825/ben-jolin"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516829558, "post_id": 48431359, "comment_id": 83855024, "body": "Isn&#39;t &quot;ss := &amp;statementprinter.StatementService{DB: db}&quot; supposed to inject variable db into mssql.go?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516830724, "post_id": 48431359, "comment_id": 83855612, "body": "No. You can&#39;t &quot;inject&quot; a variable into another package."}], "answers": [{"comments": [{"owner": {"reputation": 35, "user_id": 4488825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d355de4268199435af1dd9fdb440de01?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Jolin", "link": "https://stackoverflow.com/users/4488825/ben-jolin"}, "edited": false, "score": 0, "creation_date": 1516830788, "post_id": 48432043, "comment_id": 83855639, "body": "The error message has changed. It looks like db is now defined but I now get main.go39:10: cannot assign *statementprinter.Statement to s (type statementprinter.Statement) in multiple assignment."}, {"owner": {"reputation": 41, "user_id": 8063046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e533f87ddd3b98ab69c5130337991d0d?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/8063046/adam"}, "reply_to_user": {"reputation": 35, "user_id": 4488825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d355de4268199435af1dd9fdb440de01?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Jolin", "link": "https://stackoverflow.com/users/4488825/ben-jolin"}, "edited": false, "score": 0, "creation_date": 1516831639, "post_id": 48432043, "comment_id": 83856096, "body": "That&#39;s because <code>Statement(id string)</code> returns a <code>*statementprinter.Statement</code>, not a <code>statementprinter.Statement</code>"}, {"owner": {"reputation": 35, "user_id": 4488825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d355de4268199435af1dd9fdb440de01?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Jolin", "link": "https://stackoverflow.com/users/4488825/ben-jolin"}, "edited": false, "score": 0, "creation_date": 1516832787, "post_id": 48432043, "comment_id": 83856648, "body": "Thank you very much for your help. I still had a few typos to fix up once I implemented your recommendation. So it took a bit but I got it working. :)"}], "tags": [], "owner": {"reputation": 41, "user_id": 8063046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e533f87ddd3b98ab69c5130337991d0d?s=128&d=identicon&r=PG", "display_name": "Adam", "link": "https://stackoverflow.com/users/8063046/adam"}, "is_accepted": true, "score": 1, "last_activity_date": 1516829989, "creation_date": 1516829989, "answer_id": 48432043, "question_id": 48431359, "link": "https://stackoverflow.com/questions/48431359/golang-standard-package-structure/48432043#48432043", "title": "Golang Standard Package Structure", "body": "<p>This seems like it's just a typo. It seems like the problematic line is in the method </p>\n\n<pre><code> func (s *StatementService) Statement(customer string) \n</code></pre>\n\n<p>in mssql.go,</p>\n\n<pre><code>  row := db.QueryRow(`Select Customer, CustomerName From AccountsReceivable.rptfARStatementHeader(?)`, customer)\n</code></pre>\n\n<p><code>QueryRow</code> is supposed to be a method of <code>db</code>, but <code>db</code> is not defined. However, in the struct</p>\n\n<pre><code>type StatementService struct {\n  DB *sql.DB\n}\n</code></pre>\n\n<p>there's a <code>*sql.DB</code> instance. The method you're using has a <code>*StatementService</code> parameter, <code>s</code>. So, my guess is the intention would be to access the <code>sql.DB</code> field in <code>s</code> like so</p>\n\n<pre><code>func (s *StatementService) Statement(customer string) (*statementprinter.Statement, error) {\n  var err error\n  var t statementprinter.Statement\n   //CHANGED LINE:\n  row := s.DB.QueryRow(`Select Customer, CustomerName From AccountsReceivable.rptfARStatementHeader(?)`, customer)\n  if row.Scan(&amp;t.CustomerId, &amp;t.CustomerName); err != nil {\n    return nil, err\n  }\n  return &amp;t, nil\n</code></pre>\n\n<p>Then, the method is called in main.go, and is passed a <code>StatementService</code> instance that contains a database:</p>\n\n<pre><code>ss := &amp;statementprinter.StatementService{DB: db}\n</code></pre>\n\n<p>I believe you need to change this line to </p>\n\n<pre><code>ss := &amp;mssql.StatementService{DB: db}\n</code></pre>\n\n<p>becuase that's the actual interface implementation. The line you have now treats the StatementService interface like a struct which will not compile.\nThe global <code>db</code> in main.go lives for the lifetime of the application. It's just a pointer which is copied around for use. </p>\n"}], "owner": {"reputation": 35, "user_id": 4488825, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d355de4268199435af1dd9fdb440de01?s=128&d=identicon&r=PG&f=1", "display_name": "Ben Jolin", "link": "https://stackoverflow.com/users/4488825/ben-jolin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 491, "favorite_count": 0, "accepted_answer_id": 48432043, "answer_count": 1, "score": 0, "last_activity_date": 1516834107, "creation_date": 1516826961, "last_edit_date": 1516834107, "question_id": 48431359, "link": "https://stackoverflow.com/questions/48431359/golang-standard-package-structure", "title": "Golang Standard Package Structure", "body": "<p>I am faily new to Go and I am trying to create a structured application using guidance from Ben Johnson's webpage. Unfortunately, his example is not a complete working application.</p>\n\n<p>His webpage is <a href=\"https://medium.com/@benbjohnson/standard-package-layout-7cdbc8391fc1\" rel=\"nofollow noreferrer\">https://medium.com/@benbjohnson/standard-package-layout-7cdbc8391fc1</a></p>\n\n<p>I have tried to use his methods and I keep getting \"Undefined: db\" error. It doesn't tell me what line is causing the error, just the file \"MSSQL.go\"</p>\n\n<p>Could someone help with guidance to help me fix this error?</p>\n\n<p><strong>Edited code with accepted solution.</strong></p>\n\n<h1>StatementPrinter.go</h1>\n\n<pre><code>    package statementprinter\n\n    type Statement struct {\n      CustomerId   string\n      CustomerName string\n    }\n\n    type StatementService interface {\n      Statement(id string) (*Statement, error)\n    }\n</code></pre>\n\n<h1>main.go</h1>\n\n<pre><code>            package main\n\n            import (\n              \"fmt\"\n              \"log\"\n              \"github.com/ybenjolin/StatementPrinter\"\n              \"github.com/ybenjolin/StatementPrinter/mssql\"\n              \"database/sql\"\n              _ \"github.com/alexbrainman/odbc\"\n            )\n\n            const DB_INFO = \"Driver={SQL Server};Server=cdc-edb2;Database=CostarReports;Trusted_Connection=yes;\"\n\n            var db *sql.DB\n\n            func init() {\n              var err error\n              db, err = sql.Open(\"odbc\", DB_INFO)\n              if err != nil {\n                log.Fatal(\"Error opening database connection.\\n\", err.Error())\n              }\n              err = db.Ping()\n              if err != nil {\n                log.Fatal(\"Error pinging database server.\\n\", err.Error())\n              }\n              fmt.Println(\"Database connection established.\")\n            }\n\n            func main () {\n              var err error\n              defer db.Close()\n\n              // Create services\n              // Changes required here. Was ss := &amp;statementprinter.Stat..\n              ss := &amp;mssql.StatementService{DB: db}\n\n              // Use service\n              var s *statementprinter.Statement\n              s, err = ss.Statement(\"101583\")\n              if err != nil {\n                log.Fatal(\"Query failed:\", err.Error())\n              }\n              fmt.Printf(\"Statement: %+v\\n\", s)\n            }\n</code></pre>\n\n<h1>mssql.go</h1>\n\n<pre><code>    package mssql  \n\n    import (\n      _ \"github.com/alexbrainman/odbc\"\n      \"database/sql\"\n      \"github.com/ybenjolin/StatementPrinter\"\n    )\n\n    // StatementService represents a MSSQL implementation of statemenetprinter.StatementService.\n    type StatementService struct {\n      DB *sql.DB\n    }\n\n    // Statement returns a statement for a given customer.\n    func (s *StatementService) Statement(customer string) (*statementprinter.Statement, error) {\n      var err error\n      var t statementprinter.Statement\n      // Changes required here. Was row := db.Query......\n      row := s.DB.QueryRow(`Select Customer, CustomerName From AccountsReceivable.rptfARStatementHeader(?)`, customer)\n      if row.Scan(&amp;t.CustomerId, &amp;t.CustomerName); err != nil {\n        return nil, err\n      }\n      return &amp;t, nil\n</code></pre>\n"}, {"tags": ["go", "profiling"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 4, "creation_date": 1516816866, "post_id": 48428807, "comment_id": 83848277, "body": "You&#39;re missing the <code>[binary]</code> argument. The usage output from pprof: shows <code>pprof &lt;format&gt; [options] [binary] &lt;source&gt; ...</code>"}, {"owner": {"reputation": 181, "user_id": 1549449, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2596ef546183e6e96a6faa03799c21e9?s=128&d=identicon&r=PG", "display_name": "Raghuram", "link": "https://stackoverflow.com/users/1549449/raghuram"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516826678, "post_id": 48428807, "comment_id": 83853583, "body": "Not that I care much, but why is the question being down voted? Whoever did it care to explain?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516830922, "post_id": 48428807, "comment_id": 83855713, "body": "Questions that are easily answered by the docs tend to not go do well around here (the downvote tooltip starts with &quot;this question does not show any research effort&quot; after all), though I agree that it&#39;s strange that the binary argument is basically required, but the pprof tool lets you omit it."}, {"owner": {"reputation": 181, "user_id": 1549449, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2596ef546183e6e96a6faa03799c21e9?s=128&d=identicon&r=PG", "display_name": "Raghuram", "link": "https://stackoverflow.com/users/1549449/raghuram"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516850915, "post_id": 48428807, "comment_id": 83861706, "body": "I want to correct the impression that no research effort has been spent (as I said, I don&#39;t care about the votes). I spent hours finding a way to get block profiler to work. I am not the only one who finds it difficult. See here (<a href=\"https://github.com/golang/go/issues/14689\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/14689</a>). After all that time, I might have missed an optional argument from &quot;pprof&quot; usage info. Doesn&#39;t sound like big deal to me. But thanks for answering any way. It helped me and I did up vote it."}], "answers": [{"comments": [{"owner": {"reputation": 181, "user_id": 1549449, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2596ef546183e6e96a6faa03799c21e9?s=128&d=identicon&r=PG", "display_name": "Raghuram", "link": "https://stackoverflow.com/users/1549449/raghuram"}, "edited": false, "score": 0, "creation_date": 1516826758, "post_id": 48429648, "comment_id": 83853616, "body": "Why is the answer down voted? I added my own answer based on JimB&#39;s comment because he only provided the info as comment. I did this based on the guidance from meta stackexchange. What&#39;s wrong with this?"}], "tags": [], "owner": {"reputation": 181, "user_id": 1549449, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2596ef546183e6e96a6faa03799c21e9?s=128&d=identicon&r=PG", "display_name": "Raghuram", "link": "https://stackoverflow.com/users/1549449/raghuram"}, "is_accepted": false, "score": 1, "last_activity_date": 1516819805, "creation_date": 1516819805, "answer_id": 48429648, "question_id": 48428807, "link": "https://stackoverflow.com/questions/48428807/how-to-get-gos-block-profiler-to-work/48429648#48429648", "title": "How to get Go&#39;s &quot;block&quot; profiler to work?", "body": "<p>As @JimB mentioned in the comment, the correct way of running \"pprof\" is as follows:</p>\n\n<pre><code>$ go tool pprof  --text &lt;PATH_TO_BINARY&gt; &lt;PROFILE_FILE&gt;\n</code></pre>\n"}], "owner": {"reputation": 181, "user_id": 1549449, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/2596ef546183e6e96a6faa03799c21e9?s=128&d=identicon&r=PG", "display_name": "Raghuram", "link": "https://stackoverflow.com/users/1549449/raghuram"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 975, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516819805, "creation_date": 1516816550, "question_id": 48428807, "link": "https://stackoverflow.com/questions/48428807/how-to-get-gos-block-profiler-to-work", "title": "How to get Go&#39;s &quot;block&quot; profiler to work?", "body": "<p>I am trying to enable Go's \"block\" profiler by adding the following code to my main function:</p>\n\n<pre><code>f, err := os.Create(profFile)\nif err != nil {\n    // Error handling\n}\n\nruntime.SetBlockProfileRate(1)\np := pprof.Lookup(\"block\")\ndefer func() {\n    err := p.WriteTo(f, 0)\n    if err != nil {\n        Logger.Error(\"Error writing block profile: %v\", err)\n    }\n}()\n</code></pre>\n\n<p>I do see the profile file created after my application is run and I am trying to interpret the results by running the command:</p>\n\n<pre><code>$ go tool pprof --text &lt;PROFILE_FILE&gt; \n29.95mins of 29.95mins total (  100%)\n      flat  flat%   sum%        cum   cum%\n 29.95mins   100%   100%  29.95mins   100%  \n</code></pre>\n\n<p>I don't see any data on the block times. Is the code to generate block profile data correct? Or perhaps I need to use different options to \"go tool\"? Any help is appreciated.</p>\n\n<p>Thanks,\nRaghu</p>\n"}, {"tags": ["go", "functional-programming"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1516814376, "post_id": 48427872, "comment_id": 83846798, "body": "This does not relate to the side-effects that functional programmers mean when they talk about pure functions. The side effect here is the the init function of the package is executed, which registers the driver."}], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516814113, "post_id": 48427990, "comment_id": 83846631, "body": "import does execuate <code>init</code> function and other function execution on global variable declaration, such as <code>var x = F()</code>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516814196, "post_id": 48427990, "comment_id": 83846679, "body": "True, but a well-written package will limit its initialization side-effects to the <code>init</code> function and stick global variable declarations which do not produce side effects. But yes, technically it can cause side effects this way."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516814415, "post_id": 48427990, "comment_id": 83846831, "body": "Yes, but go does not provide a way to deal with order of multiple <code>init</code> function, so sometimes to make things happens first, global declaration to cause &quot;side-effects&quot; is a work-arond. And I do agree that it shall be avoided by any good practice."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516814596, "post_id": 48427990, "comment_id": 83846920, "body": "It doesn&#39;t provide any more control over the order of global variable execution than <code>init</code> execution; per the spec, <code>init</code>s are executed &quot;in the order they appear in the source&quot;, while &quot;package-level variables are initialized in declaration order but after any of the variables they depend on&quot; - roughly equivalent, though the globals are a little more complicated."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516814761, "post_id": 48427990, "comment_id": 83847035, "body": "I mean, global variables are always before init execuation, which one can take advantage of. Both global variable and <code>init</code> order is quite fragile but the former is always before the latter."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516815396, "post_id": 48427990, "comment_id": 83847420, "body": "True, but I think we&#39;re getting beyond the question here - the main side effect one is generally trying to get from an <code>_</code> import is the execution of <code>init</code> functions."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1516813562, "creation_date": 1516813562, "answer_id": 48427990, "question_id": 48427872, "link": "https://stackoverflow.com/questions/48427872/import-side-effects/48427990#48427990", "title": "Import side effects", "body": "<p>The main side-effect one is interested in with an <code>_</code> import is the execution of <code>init</code> functions. A package can include an <code>init</code> function which will be executed when the program starts, before <code>main</code> is executed. In the case of DB drivers, this is used to register the driver so you can use it with <code>sql.Open</code>; <code>expvar</code> and <code>pprof</code> packages both register HTTP handlers in their <code>init</code> functions, and are similarly often used with <code>_</code> imports.</p>\n\n<p>This is documented in the <a href=\"https://golang.org/ref/spec#Package_initialization\" rel=\"nofollow noreferrer\">Go spec section on package initialization</a>.</p>\n"}], "owner": {"reputation": 98, "user_id": 6768136, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/885793045028e87cfefb12a7d81c2a9f?s=128&d=identicon&r=PG&f=1", "display_name": "venkatReddi", "link": "https://stackoverflow.com/users/6768136/venkatreddi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 765, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516817733, "creation_date": 1516813189, "last_edit_date": 1516817733, "question_id": 48427872, "link": "https://stackoverflow.com/questions/48427872/import-side-effects", "title": "Import side effects", "body": "<p>I am new to Go and functional paradigm. while working with database connections in golang I have to <code>import</code> mysql driver. And I came across \"_\" which is to mention blank identifier for variables and import packages which are soley for their side effects. </p>\n\n<p>Searched for side-effects and found this <a href=\"https://stackoverflow.com/questions/41127479/es6-import-for-side-effects-meaning\">side effects in es6</a> </p>\n\n<p>What I didn't understand is side effect of a function is dependent on a global variable which deviates the referential transparency of a pure function. But how does a package can bring side effect?\nIs it because the dependency on the package as side effect?</p>\n\n<p>eg:</p>\n\n<pre><code>import _ \"github.com/go-sql-driver/mysql\"\n\ndb, err := sql.Open(\"mysql\", \"user:password@/dbname\")\n</code></pre>\n\n<p>Here the import has \"_\" because <code>Open</code> statement is dependent on driver name?</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1516807122, "post_id": 48425692, "comment_id": 83841564, "body": "The Go binary downloads are linked against glibc. If you want a static build, you need to build it from source. You can also look at the alpine dockerfiles directly and see what&#39;s required there."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8725011"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516807266, "post_id": 48425692, "comment_id": 83841659, "body": "Good point. I will have a look at it. Thanks!"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516827858, "post_id": 48425692, "comment_id": 83854172, "body": "Are you using this for a build server? If the containers are to run Go applications, Go itself is not a dependency."}, {"owner": {"user_type": "does_not_exist", "display_name": "user8725011"}, "edited": false, "score": 0, "creation_date": 1516828065, "post_id": 48425692, "comment_id": 83854283, "body": "no. it&#39;s basically about distributing applications packed in small containers. go itself is truly not a dependency, and can be packed as-is in a bare docker container (eg. scratch). the goal is to have all build tools readily configured."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1516864054, "post_id": 48425692, "comment_id": 83865838, "body": "So I get it right that, as an end result, you want to build a binary with Go and deploy the resulting application in a minimal image, right?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user8725011"}, "edited": false, "score": 0, "creation_date": 1516870295, "post_id": 48425692, "comment_id": 83868771, "body": "Not quite. As I said, deploying a single go binary in a container is no problem at all. What I&#39;m trying to do is to package the development tools (the go compiler) into a small container."}], "owner": {"user_type": "does_not_exist", "display_name": "user8725011"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 168, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516806523, "creation_date": 1516806523, "question_id": 48425692, "link": "https://stackoverflow.com/questions/48425692/what-dependencies-are-needed-for-the-golang-tool-chain", "title": "What dependencies are needed for the golang tool chain?", "body": "<p>I'm trying to build a minimal docker image for go using this Dockerfile</p>\n\n<pre><code>FROM debian:stretch-slim AS builder                                                                                                   \n\nENV VERSION 1.9.3.                                                                                                                    \nENV OS linux                                                                                                                          \nENV ARCH amd64                                                                                                                        \n\nRUN apt update &amp;&amp; apt upgrade -y &amp;&amp; apt install -y curl                                                                               \nRUN curl -O -fsSL \"https://dl.google.com/go/go$VERSION$OS-$ARCH.tar.gz\" \\ \n&amp;&amp; tar -C /usr/local -xzf \"go$VERSION$OS-$ARCH.tar.gz\"        \nRUN /usr/local/go/bin/go env                                                                                                          \n\nFROM scratch                                                                                                                          \nENV GOPATH=/code                                                                                                                      \nENV PATH=/usr/local/go/bin                                                                                                            \n\nCOPY --from=builder /usr/local/go /usr/local/go                                                                                       \nCMD [\"/usr/local/go/bin/go\"]\n</code></pre>\n\n<p>Building this image using <code>docker build -t golang:1.9.3 .</code>. The output of the container is as follows, if executed like this <code>docker run --rm -ti golang:1.9.3</code>:</p>\n\n<pre><code>standard_init_linux.go:195: exec user process caused \"no such file or directory\"\n</code></pre>\n\n<p><strong>EDIT</strong>:\nI am aware of the golang images on docker hub like golang:alpine, which is ~265MB in size. </p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 1, "creation_date": 1516803597, "post_id": 48424609, "comment_id": 83838828, "body": "Not ignoring the errors would be a good start. I bet that <code>insert.Exec()</code> returns a (probably useful) error message (which you&#39;re ignoring)."}, {"owner": {"reputation": 1104, "user_id": 6438430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5VRc3dZXdns/AAAAAAAAAAI/AAAAAAAAAeI/nemPXRtg3JU/photo.jpg?sz=128", "display_name": "Ashish Tiwari", "link": "https://stackoverflow.com/users/6438430/ashish-tiwari"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1516803711, "post_id": 48424609, "comment_id": 83838913, "body": "@Carpetsmoker the same error m getting in <code>err</code> also"}, {"owner": {"reputation": 1104, "user_id": 6438430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5VRc3dZXdns/AAAAAAAAAAI/AAAAAAAAAeI/nemPXRtg3JU/photo.jpg?sz=128", "display_name": "Ashish Tiwari", "link": "https://stackoverflow.com/users/6438430/ashish-tiwari"}, "reply_to_user": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1516803850, "post_id": 48424609, "comment_id": 83839023, "body": "<code>Exec</code> It self not returning data. Its just gives above error"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516804050, "post_id": 48424609, "comment_id": 83839196, "body": "@AshishTiwari: if exec is returning an error, then you need to handle that error."}, {"owner": {"reputation": 1104, "user_id": 6438430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5VRc3dZXdns/AAAAAAAAAAI/AAAAAAAAAeI/nemPXRtg3JU/photo.jpg?sz=128", "display_name": "Ashish Tiwari", "link": "https://stackoverflow.com/users/6438430/ashish-tiwari"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516804218, "post_id": 48424609, "comment_id": 83839328, "body": "@JimB i handled its not giving me any mysql error. Just giving me above error.  Which i cannot understand."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1516804449, "post_id": 48424609, "comment_id": 83839508, "body": "You&#39;re not &quot;handling&quot; an error <i>somewhere</i>, because you&#39;re getting a nil pointer where you&#39;re not expecting it. Please show a complete example, with how you&#39;re handling the errors since that is most likely the problem here."}], "answers": [{"tags": [], "owner": {"reputation": 1104, "user_id": 6438430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5VRc3dZXdns/AAAAAAAAAAI/AAAAAAAAAeI/nemPXRtg3JU/photo.jpg?sz=128", "display_name": "Ashish Tiwari", "link": "https://stackoverflow.com/users/6438430/ashish-tiwari"}, "is_accepted": true, "score": 0, "last_activity_date": 1517313754, "creation_date": 1517313754, "answer_id": 48521014, "question_id": 48424609, "link": "https://stackoverflow.com/questions/48424609/prepare-statement-not-deallocate-memory/48521014#48521014", "title": "Prepare statement not deallocate memory", "body": "<p>It may be silly question but i would like to answer of my own question. Got answer from <a href=\"https://github.com/go-sql-driver/mysql/issues/743\" rel=\"nofollow noreferrer\">https://github.com/go-sql-driver/mysql/issues/743</a> . Go-mysql library was making connection continuously. Because of which i got connection refused error. @Carpetsmoker  @jimB you guys was correct i was ignoring the error. In error i got message <code>connection refused</code>. I also posted whole code on above link. I set below param in my code:</p>\n\n<pre><code>DB.SetMaxIdleConns(10)\nDB.SetMaxOpenConns(10)\nDB.SetConnMaxLifetime(time.Second * 10)\n</code></pre>\n\n<p>It start works. Now its not closing or keeps connected for given time. Thanks guys for your support.</p>\n"}], "owner": {"reputation": 1104, "user_id": 6438430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5VRc3dZXdns/AAAAAAAAAAI/AAAAAAAAAeI/nemPXRtg3JU/photo.jpg?sz=128", "display_name": "Ashish Tiwari", "link": "https://stackoverflow.com/users/6438430/ashish-tiwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 196, "favorite_count": 0, "accepted_answer_id": 48521014, "answer_count": 1, "score": -2, "last_activity_date": 1517313754, "creation_date": 1516803398, "last_edit_date": 1516871049, "question_id": 48424609, "link": "https://stackoverflow.com/questions/48424609/prepare-statement-not-deallocate-memory", "title": "Prepare statement not deallocate memory", "body": "<p>I have daemon which continuously inserting data in mysql and returning me to <code>LastInsertId()</code> . When i start daemon its working perfect for first approx 150 000 entries. After that execution get stopped with following error</p>\n\n<pre><code>panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x28 pc=0x45af73]\n</code></pre>\n\n<p>Here is my code snippet:</p>\n\n<pre><code>insert, _ := db.Prepare(\"insert into info set id=?,tg=?, adddate=now() ON DUPLICATE KEY UPDATE tgs=1\")\n\nfor {\n    res, _ := insert.Exec(id, tg)\n    insertid, _ := res.LastInsertId() //Getting error on this line\n}\n</code></pre>\n\n<p>I am running 10 GOROUTINES, Its gives same error with single goroutine . Also i tried with table lock and unlock before and after query. It gives same error.</p>\n\n<p><code>res.RowsAffected()</code> This also not giving any output.</p>\n\n<p>In for loop i just did <code>fmt.Print(insert)</code>. It gives me memory address in array. Which keep increasing . After some point it got breaks. Here it is:</p>\n\n<pre><code>[{0xc4200d6070 0xc4200e0100} {0xc4200d6150 0xc42005e040} {0xc4200d61c0         0xc42005e0c0} {0xc4200d6230 0xc4203e04c0} {0xc4200d62a0 0xc4201585c0} {0xc4200d6310 0xc420469280} {0xc4200d6380 0xc420158200} {0xc4200d63f0 0xc42005fe00} {0xc4200d6460 0xc420468840} {0xc4200d64d0 0xc4200c0cc0} {0xc4200d6540 0xc4200e0a40} {0xc4200d65b0 0xc42005f480} {0xc4200d6620 0xc4200c1a80} {0xc4200d6690 0xc420254bc0} {0xc4200d6700 0xc4200e0200}] 0}insert into trans_tag_master set clientid=69,tag='tag1', adddate=now() ON DUPLICATE KEY UPDATE tagstatus=1 \n</code></pre>\n\n<p>The memory is keep increasing and after some point it exceed limit of prepare statement. How i can avoid this. Thanks</p>\n"}, {"tags": ["go", "bazel"], "answers": [{"comments": [{"owner": {"reputation": 45, "user_id": 9092109, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hrGMno1WHyw/AAAAAAAAAAI/AAAAAAAAJmw/pssDz6hPGQc/photo.jpg?sz=128", "display_name": "Saurabh Garg", "link": "https://stackoverflow.com/users/9092109/saurabh-garg"}, "edited": false, "score": 0, "creation_date": 1516936133, "post_id": 48447393, "comment_id": 83903526, "body": "Thanks for the detailed explanation! I was not able to use your suggested fix as stated. Adding # gazelle:prefix <b>do_not_match</b> to the root build didnt help - unless I did it wrong. However in the root build, I had specified gazelle config and I set the prefix in that to <b>do_not_match</b>. After that I was able to get rid off all the #keep I had around deps. Some imports were unrecognized - appengine &amp; appengine_internal. That is probably because go code in appengine world seems to follow its own conventions. However, the non-appengine bazel BUILDs work great!"}], "tags": [], "owner": {"reputation": 26173, "user_id": 1891, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/c40d475927f7a86639ec54aa32517572?s=128&d=identicon&r=PG", "display_name": "Jay Conrod", "link": "https://stackoverflow.com/users/1891/jay-conrod"}, "is_accepted": true, "score": 1, "last_activity_date": 1516896907, "creation_date": 1516896907, "answer_id": 48447393, "question_id": 48423654, "link": "https://stackoverflow.com/questions/48423654/for-gazelle-how-can-i-make-it-use-go-repository-defined-in-the-workspace/48447393#48447393", "title": "For Gazelle, how can I make it use go_repository defined in the WORKSPACE?", "body": "<p>I'm guessing from your <a href=\"https://stackoverflow.com/questions/48303948/for-gazelle-how-can-i-drop-src-from-the-generated-importpath\">previous question</a> this is because you're using an empty prefix.</p>\n\n<p>Gazelle resolves Go imports to Bazel labels in several steps:</p>\n\n<ol>\n<li>If there is a <code>go_library</code> in your workspace with a matching <code>importpath</code>, Gazelle will use the name of that library.</li>\n<li>If the import path is below the top-level prefix for your repository, the import will be considered \"local\", so you'll get a label like <code>//golang.org/x/net/content:go_default_library</code>.\n\n<ul>\n<li>Since you're using an empty prefix at the top level, this catch will catch every unknown import.</li>\n<li>This should be improved. Gazelle's resolver should be aware of prefixes defined in different directories (currently, those are only used to determine the <code>importpath</code> attribute on generated rules). I've filed <a href=\"https://github.com/bazelbuild/bazel-gazelle/issues/101\" rel=\"nofollow noreferrer\">bazelbuild/bazel-gazelle#101</a> to fix that.</li>\n</ul></li>\n<li>If the import is not considered local, Gazelle will generate a label for an external repository or for the vendor directory, depending on the external mode.</li>\n</ol>\n\n<p>For now, you may want to add a directive to your top-level build file like:</p>\n\n<pre><code># gazelle:prefix __do_not_match__\n</code></pre>\n\n<p>This will basically disable the second case, since no import will start with that. You'll still have an empty prefix in your src directory (set with <code># gazelle:prefix</code> in src/BUILD.bazel), so your libraries will still have the correct <code>importpath</code> directives. You might want to set that to more specific subdirectories though.</p>\n"}], "owner": {"reputation": 45, "user_id": 9092109, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-hrGMno1WHyw/AAAAAAAAAAI/AAAAAAAAJmw/pssDz6hPGQc/photo.jpg?sz=128", "display_name": "Saurabh Garg", "link": "https://stackoverflow.com/users/9092109/saurabh-garg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1207, "favorite_count": 3, "accepted_answer_id": 48447393, "answer_count": 1, "score": 2, "last_activity_date": 1516896907, "creation_date": 1516800498, "question_id": 48423654, "link": "https://stackoverflow.com/questions/48423654/for-gazelle-how-can-i-make-it-use-go-repository-defined-in-the-workspace", "title": "For Gazelle, how can I make it use go_repository defined in the WORKSPACE?", "body": "<p>In my WORKSPACE, I have defined the go_repostitory for importpath golang.org/x/net. </p>\n\n<pre><code>go_repository(\n   name = \"org_golang_x_net\",\n   commit = \"5ccada7d0a7ba9aeb5d3aca8d3501b4c2a509fec\",\n   importpath = \"golang.org/x/net\",\n)\n</code></pre>\n\n<p>But when I run gazelle, the dependency added to BUILD.Bazel is not @org_golang_x_net//context:go_default_library. Instead, it is the following: //golang.org/x/net/context:go_default_library</p>\n\n<p>Why does gazelle ignore the defined go_repository? Is there a way for it to consider deps defined in WORKSPACE?  </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 159, "user_id": 3752049, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5e1257cf08653dbbe352f5d92f88dffc?s=128&d=identicon&r=PG&f=1", "display_name": "user3752049", "link": "https://stackoverflow.com/users/3752049/user3752049"}, "edited": false, "score": 0, "creation_date": 1520925464, "post_id": 48424949, "comment_id": 85503946, "body": "Hi, I have a similar issue in iOS. I have a base64 signature and a public key. I can\u2019t figure out a way to verify the signature. Do you know of any frameworks that could help ? Thanks!"}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 1, "last_activity_date": 1516806373, "last_edit_date": 1516806373, "creation_date": 1516804416, "answer_id": 48424949, "question_id": 48423188, "link": "https://stackoverflow.com/questions/48423188/verifying-a-ecdsa-signature-with-a-provided-public-key/48424949#48424949", "title": "Verifying a ECDSA signature with a provided public key", "body": "<p><code>r</code> and <code>s</code> are just two numbers representing the signature. Asymmetric crypto is just large numbers after all. You can find a description of the verification algorithm <a href=\"https://en.wikipedia.org/wiki/Elliptic_Curve_Digital_Signature_Algorithm#Signature_verification_algorithm\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>How those two numbers are serialized and encoded is what really matters. If the signed just concatenated the raw bytes of the <code>Sign</code> outputs <code>r</code> and <code>s</code>, your proposal would be correct.</p>\n\n<p>However, the string you show look like it is encoded in <a href=\"https://en.wikipedia.org/wiki/Base64#URL_applications\" rel=\"nofollow noreferrer\">url-safe base64</a>. You would need to decode it first, then split it (or maybe split, then decode). Without knowing how the signer chose to represent the signature, we can't tell.</p>\n\n<p>Dealing with jwt (or crypto in general) means knowing exactly how everything is encoded/represented. Instead of rolling out your own, you should use something like <a href=\"https://godoc.org/github.com/dgrijalva/jwt-go\" rel=\"nofollow noreferrer\">jwt-go</a> which has ecdsa signature verification. Their <a href=\"https://github.com/dgrijalva/jwt-go/blob/master/ecdsa.go#L55\" rel=\"nofollow noreferrer\">ecdsa verification</a> should be a good starting point if you want to roll your own.</p>\n"}, {"tags": [], "owner": {"reputation": 581, "user_id": 549765, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a36eb88844eb50d8ce92539dcf344705?s=128&d=identicon&r=PG", "display_name": "y0prst", "link": "https://stackoverflow.com/users/549765/y0prst"}, "is_accepted": false, "score": 3, "last_activity_date": 1539693043, "creation_date": 1539693043, "answer_id": 52835524, "question_id": 48423188, "link": "https://stackoverflow.com/questions/48423188/verifying-a-ecdsa-signature-with-a-provided-public-key/52835524#52835524", "title": "Verifying a ECDSA signature with a provided public key", "body": "<p>If you look at <code>ecdsa.PrivateKey.Sign()</code> source, you'll find this at the very end:</p>\n\n<pre><code>return asn1.Marshal(ecdsaSignature{r, s})\n</code></pre>\n\n<p>So you should <code>asn1.Unmarshal</code> to get original numbers. Unfortunally, <code>ecdsa</code> package neither have such method, nor export <code>ecdsaSignature</code> struct. So you should copy-paste it. In Go you can use unnamed struct:</p>\n\n<pre><code>var esig struct {\n    R, S *big.Int\n}\nif _, err := asn1.Unmarshal(sig, &amp;esig); err != nil {\n    return err\n}\nverify := ecdsa.Verify(publicKey, hasher.Sum(nil), esig.R, esig.S)\n</code></pre>\n\n<p>I've found this solution here:\n<a href=\"https://swenotes.wordpress.com/2018/04/16/trying-to-learn-ecdsa-and-golang/\" rel=\"nofollow noreferrer\">https://swenotes.wordpress.com/2018/04/16/trying-to-learn-ecdsa-and-golang/</a></p>\n"}], "owner": {"reputation": 21, "user_id": 743150, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de444708384f27dd391e108f7fde888d?s=128&d=identicon&r=PG", "display_name": "matthew.clarke", "link": "https://stackoverflow.com/users/743150/matthew-clarke"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1506, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1539693043, "creation_date": 1516798918, "question_id": 48423188, "link": "https://stackoverflow.com/questions/48423188/verifying-a-ecdsa-signature-with-a-provided-public-key", "title": "Verifying a ECDSA signature with a provided public key", "body": "<p>I'm trying to write a verifier for some custom jwt-like logic in go. I'm unsure of how to use the ecdsa verify method. What do <code>r</code> and <code>s</code> represent and how to I populate these from a provided signature? I have the following so far but I'm not sure if it's even close.</p>\n\n<pre><code>sig := \"MEUCIQDLUXOWIw8xuJ1pALV8qeao0ZCBFjBnGLzY_RP-2Y5hdwIgQgB4skfOppPTsuDicJ1O25S50MokqtlQKrXSrnoDEVE\"\n\nhasher := crypto.Hash.New(crypto.SHA512)\nhasher.Write([]byte(j))\n\nr := new(big.Int).SetBytes(signature[:len(signature)/2])\ns := new(big.Int).SetBytes(signature[len(signature)/2:])\n\nverify := ecdsa.Verify(publicKey, hasher.Sum(nil), r, s)\n</code></pre>\n"}, {"tags": ["datetime", "go", "time"], "comments": [{"owner": {"reputation": 477, "user_id": 3831618, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/030bacb6300ae28d45e08c660c1b8c96?s=128&d=identicon&r=PG&f=1", "display_name": "thatrockbottomprogrammer", "link": "https://stackoverflow.com/users/3831618/thatrockbottomprogrammer"}, "edited": false, "score": 0, "creation_date": 1516796945, "post_id": 48422482, "comment_id": 83834398, "body": "HINT: <a href=\"https://golang.org/pkg/time/#FixedZone\" rel=\"nofollow noreferrer\">golang.org/pkg/time/#FixedZone</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1516797031, "post_id": 48422482, "comment_id": 83834444, "body": "It works on the Go Playground, and gives time in IST: <a href=\"https://play.golang.org/p/sd62GE8tU63\" rel=\"nofollow noreferrer\">playground</a>. Most likely your <code>LoadLocation()</code> fails, do check the returned error! And why is this tagged with <a href=\"https://stackoverflow.com/questions/tagged/google-cloud-datastore\">google-cloud-datastore</a>?"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516805366, "post_id": 48422482, "comment_id": 83840222, "body": "You&#39;re not showing the output of your print statement. Anyone trying will see <code>..... IST</code>. The value of <code>visit.Time</code> will just be a timestamp (timezones are just for displaying), if you want that to be displayed in <code>IST</code>, you&#39;ll need to specify the timezone at printing time."}, {"owner": {"reputation": 300, "user_id": 8905729, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-JA_H5h9wfmM/AAAAAAAAAAI/AAAAAAAAAd4/_8vHnTcSjjI/photo.jpg?sz=128", "display_name": "Narendar ", "link": "https://stackoverflow.com/users/8905729/narendar"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516806630, "post_id": 48422482, "comment_id": 83841200, "body": "@Marc Location : Asia/Kolkata Time : 2009-11-11 04:30:00 +0530 IST but getting UCT time only"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516806691, "post_id": 48422482, "comment_id": 83841256, "body": "Then what is the problem? This is working exactly as expected. But to repeat: <code>time.Time</code> doesn&#39;t care about the timezone, timezones are for display only."}, {"owner": {"reputation": 300, "user_id": 8905729, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-JA_H5h9wfmM/AAAAAAAAAAI/AAAAAAAAAd4/_8vHnTcSjjI/photo.jpg?sz=128", "display_name": "Narendar ", "link": "https://stackoverflow.com/users/8905729/narendar"}, "edited": false, "score": 0, "creation_date": 1516806842, "post_id": 48422482, "comment_id": 83841359, "body": "@ Marc But it is not Current time of IST   i need this for at what time the record created exactly"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516807977, "post_id": 48422482, "comment_id": 83842202, "body": "<code>time.Now</code> is the current time on that machine as a number of seconds since Jan 1st 0001 at 00:00 UTC. It does not matter where you are, as long as your clock is correct, <code>time.Now</code> will say the same thing. Once again: timezones are used for display purposes only, they do not change the value of <code>time.Time</code>. Depending on how you insert it into your datastore, you may need to specify the timezone, but you&#39;re not showing that code or saying which datastore."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 1, "creation_date": 1516808163, "post_id": 48422482, "comment_id": 83842357, "body": "Or are you talking about the output on the playground? That&#39;s not going to be the actual time as the playground fakes a lot of system utilities. See <a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">this blog post</a> for details."}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 4, "last_activity_date": 1516814628, "creation_date": 1516814628, "answer_id": 48428314, "question_id": 48422482, "link": "https://stackoverflow.com/questions/48422482/how-to-convert-utc-to-india-local-time-using-golang/48428314#48428314", "title": "how to convert UTC to India local time using golang", "body": "<p>In the <a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">Go Playground</a>, this is working as expected.</p>\n\n<blockquote>\n  <p><a href=\"https://play.golang.org/\" rel=\"nofollow noreferrer\">About the Playground</a></p>\n  \n  <p>The Go Playground is a web service that runs on golang.org's servers.\n  The service receives a Go program, compiles, links, and runs the\n  program inside a sandbox, then returns the output.</p>\n  \n  <p>There are limitations to the programs that can be run in the\n  playground:</p>\n  \n  <p>In the playground the time begins at 2009-11-10 23:00:00 UTC\n  (determining the significance of this date is an exercise for the\n  reader). This makes it easier to cache programs by giving them\n  deterministic output.</p>\n  \n  <p>The article \"<a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">Inside the Go Playground</a>\" describes how the playground is\n  implemented.</p>\n</blockquote>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    loc, _ := time.LoadLocation(\"Asia/Kolkata\")\n    now := time.Now().In(loc)\n    fmt.Println(\"Location : \", loc, \" Time : \", now)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/l8t3BnQATg7\" rel=\"nofollow noreferrer\">https://play.golang.org/p/l8t3BnQATg7</a></p>\n\n<p>Output:</p>\n\n<pre><code>Location :  Asia/Kolkata  Time :  2009-11-11 04:30:00 +0530 IST\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 31, "user_id": 3343491, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c03af8d59f12a98cab75ecb7a6363c3f?s=128&d=identicon&r=PG&f=1", "display_name": "user3343491", "link": "https://stackoverflow.com/users/3343491/user3343491"}, "is_accepted": false, "score": 2, "last_activity_date": 1563174137, "creation_date": 1563174137, "answer_id": 57034690, "question_id": 48422482, "link": "https://stackoverflow.com/questions/48422482/how-to-convert-utc-to-india-local-time-using-golang/57034690#57034690", "title": "how to convert UTC to India local time using golang", "body": "<p>The correct argument for IST is \"Asia/Calcutta\" not \"Asia/Kolkata\". Here is the complete list <a href=\"https://golang.org/src/time/zoneinfo_abbrs_windows.go\" rel=\"nofollow noreferrer\">https://golang.org/src/time/zoneinfo_abbrs_windows.go</a></p>\n"}], "owner": {"reputation": 300, "user_id": 8905729, "user_type": "registered", "accept_rate": 77, "profile_image": "https://lh6.googleusercontent.com/-JA_H5h9wfmM/AAAAAAAAAAI/AAAAAAAAAd4/_8vHnTcSjjI/photo.jpg?sz=128", "display_name": "Narendar ", "link": "https://stackoverflow.com/users/8905729/narendar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2978, "favorite_count": 2, "accepted_answer_id": 48428314, "answer_count": 2, "score": 1, "last_activity_date": 1563174137, "creation_date": 1516796841, "last_edit_date": 1516802326, "question_id": 48422482, "link": "https://stackoverflow.com/questions/48422482/how-to-convert-utc-to-india-local-time-using-golang", "title": "how to convert UTC to India local time using golang", "body": "<p>Mentioning the code below </p>\n\n<pre><code> loc, _ := time.LoadLocation(\"Asia/Kolkata\")\n        now := time.Now().In(loc)\n        fmt.Println(\"Location : \", loc, \" Time : \", now)\n        visit.Time = now\n</code></pre>\n\n<p>getting UTC time but i need to get IST in my datastore</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user8098055"}, "edited": false, "score": 1, "creation_date": 1516796488, "post_id": 48422336, "comment_id": 83834124, "body": "What do you mean by &quot;this function cannot be redeclared in same package&quot;? Do you define any types and make them implement <code>DBInterface</code>?"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1516796758, "post_id": 48422336, "comment_id": 83834294, "body": "Why you want to declare multiple functions with same name? What&#39;s the difference between them? You question seems you only have one <code>ParseDataFromManyTables</code> that parses any table you pass to it."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1516809304, "post_id": 48422336, "comment_id": 83843254, "body": "you can create receivers for each table func by its name, receiver can be of any type . And call your func using that"}], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 1, "last_activity_date": 1516798267, "creation_date": 1516798267, "answer_id": 48422950, "question_id": 48422336, "link": "https://stackoverflow.com/questions/48422336/golang-how-satisfy-interface-from-many-files-in-same-package/48422950#48422950", "title": "golang, how satisfy interface from many files in same package?", "body": "<p>You cannot satisfy an interface with a function. Only types with methods can satisfy an interface.</p>\n\n<p>To satisfy an interface you need to declare a type and then implement a set of methods on that type that match the method signatures of the interface's method set.</p>\n\n<p>In you case you can declare a type in each of your files and for each of those types implement a method that has the same signature as <code>DBInterface</code>'s <code>ParseData</code>:</p>\n\n<p><code>table1.go</code></p>\n\n<pre><code>package tables\n\ntype Table1 struct{}\n\nfunc (t Table1) DataParse(s string) string {\n    // ...\n    return \"...\"\n}\n</code></pre>\n\n<p><code>table2.go</code></p>\n\n<pre><code>package tables\n\ntype Table2 struct{}\n\nfunc (t Table2) DataParse(s string) string {\n    // ...\n    return \"...\"\n}\n</code></pre>\n\n<p>Given this example you can now pass a value of type <code>Table1</code> or <code>Table2</code> to <code>ParseDataFromManyTables</code>.</p>\n"}], "owner": {"reputation": 11, "user_id": 9261336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacc30670774e91750042c59cf6115c4?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/9261336/mat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 288, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516798267, "creation_date": 1516796333, "question_id": 48422336, "link": "https://stackoverflow.com/questions/48422336/golang-how-satisfy-interface-from-many-files-in-same-package", "title": "golang, how satisfy interface from many files in same package?", "body": "<p>I have this logic of my app:</p>\n\n<pre><code>myapp/\n     |- tables/\n              |-table1.go\n              |-table2.go\n              |-table3.go\n      - main.go\n</code></pre>\n\n<p>In main.go I have simple interface:</p>\n\n<pre><code>type DBInterface interface {\n    DataParse(string) string\n}\n</code></pre>\n\n<p>Now, table1, table2, tableN are name of tables in DB. I need to perform specific action on specific table. Hence, in table1.go I have simple function which returns parsed data for table1.go, some for the rest.</p>\n\n<p>Now, problem is that I have in main.go function:</p>\n\n<pre><code>func ParseDataFromManyTables(dbs DBInterface) {\n    // some actions on tables like: dbs.DataParse(\"tablename\")\n    // and these DataParse() are declared in tables/table*.go\n}\n</code></pre>\n\n<p>What I wanted to do is to use function which satisfies interface from each tables/table*.go file (DataParse()). But the problem is - this function cannot be redeclared in same package (tables here), what I can do better here? I know, that I may create new packages(directories) but I does not seem to be correct approach here....</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1516793098, "post_id": 48421187, "comment_id": 83832073, "body": "Go does not support method overloading."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516793426, "post_id": 48421187, "comment_id": 83832276, "body": "To me the most simple way is just use a function <code>EscapeParse(req, param)</code>. But sure you can wrap the request and write a middle ware to convert the request."}, {"owner": {"reputation": 23477, "user_id": 660921, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/3d53595cb2a89131fb3be7b55b3a9ef0?s=128&d=identicon&r=PG", "display_name": "Martin Tournoij", "link": "https://stackoverflow.com/users/660921/martin-tournoij"}, "edited": false, "score": 0, "creation_date": 1516806589, "post_id": 48421187, "comment_id": 83841171, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/18510088/how-to-override-func-of-an-existing-go-package\">How to override func of an existing go package?</a>"}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 5, "last_activity_date": 1516793578, "creation_date": 1516793578, "answer_id": 48421492, "question_id": 48421187, "link": "https://stackoverflow.com/questions/48421187/golang-how-to-override-http-package-method/48421492#48421492", "title": "golang how to override http package method?", "body": "<p>You can't override anything in Go.</p>\n\n<p>The simplest solution here is to define a small helper function along the lines of:</p>\n\n<pre><code>func EscapeFormValue(req *http.Request, key string) string {\n    return template.HTMLEscapeString(req.FormValue(key))\n}\n</code></pre>\n\n<p>However, if you really want a custom struct with the same method, you can use <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"noreferrer\">embedding</a> to wrap the <code>http.Request</code> and use the new wrapped type:</p>\n\n<pre><code>type newReq struct {\n    *http.Request\n}\n\nfunc (n *newReq) FormValue(key string) string {\n    return fmt.Sprintf(\"value: %s\", n.Request.FormValue(key))\n}\n\nfunc main() {\n    req := &amp;http.Request{Method: \"GET\"}\n    req.URL, _ = url.Parse(\"http://www.google.com/search?q=foo&amp;q=bar\")\n    n := newReq{req}\n    fmt.Println(n.FormValue(\"q\"))\n}\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>value: foo\n</code></pre>\n\n<p>Note that this only works because we are using <code>newReq</code> itself. Anything (including the http package) operating on a <code>http.Request</code> will want the embedded struct and will not see <code>newReq.FormValue</code>. This is what makes it <strong>different from overriding</strong>.</p>\n"}], "owner": {"reputation": 914, "user_id": 661716, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/912c9926d5e4b534aa33e30e26061620?s=128&d=identicon&r=PG", "display_name": "tompal18", "link": "https://stackoverflow.com/users/661716/tompal18"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1727, "favorite_count": 1, "answer_count": 1, "score": -1, "last_activity_date": 1516793578, "creation_date": 1516792625, "question_id": 48421187, "link": "https://stackoverflow.com/questions/48421187/golang-how-to-override-http-package-method", "title": "golang how to override http package method?", "body": "<p>I would like to override below method(in request.go) to apply escape string (eg: template.HTMLEscapeString(r.FormValue(\"some_param\")).</p>\n\n<p>I want to override because I do not want to escape on every FormValue calling.</p>\n\n<p>Is there a way to do so?</p>\n\n<pre><code>func (r *Request) FormValue(key string) string{\n    if r.Form == nil {\n        r.ParseMultipartForm(defaultMaxMemory)\n    }\n    if vs := r.Form[key]; len(vs) &gt; 0 {\n        return vs[0]\n    }\n    return \"\"\n}\n</code></pre>\n"}, {"tags": ["go", "networking", "tcp", "dns"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516795707, "post_id": 48421156, "comment_id": 83833665, "body": "Closing idle connections won\u2019t effect any that are in use, because they are not \u201cidle\u201d. Just set <code>IdleConnTimeout</code> to do this automatically."}, {"owner": {"reputation": 93, "user_id": 539069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297e47225abb4b496cf86475808ec6d6?s=128&d=identicon&r=PG", "display_name": "Austin Platt", "link": "https://stackoverflow.com/users/539069/austin-platt"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516799822, "post_id": 48421156, "comment_id": 83836295, "body": "I am setting <code>IdleConnTimeout</code>. The problem arises when a connection never actually lies idle for that long. I would still like the connection to eventually be closed regardless so when a new connection is created it uses the updated dns."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516801390, "post_id": 48421156, "comment_id": 83837315, "body": "Ok, I see what you&#39;re saying, it&#39;s not the idle connections you&#39;re really concerned with. Now that the Transport has <code>IdleConnTimeout</code>, The brute force method of swapping out the transport is probably the easiest to coordinate."}], "answers": [{"comments": [{"owner": {"reputation": 93, "user_id": 539069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297e47225abb4b496cf86475808ec6d6?s=128&d=identicon&r=PG", "display_name": "Austin Platt", "link": "https://stackoverflow.com/users/539069/austin-platt"}, "edited": false, "score": 0, "creation_date": 1516899276, "post_id": 48428656, "comment_id": 83888626, "body": "I think this should get me most of the way there thanks! A remaining issue is that if I&#39;m only passing IP addresses to the Transport, then I cannot securely connect to origin servers using TLS (as these require the hostname). I think I could get around this by keeping a map of IPs to hostnames and doing a lookup when I connect. Is there a cleaner way?"}, {"owner": {"reputation": 27, "user_id": 9226947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GneVo.jpg?s=128&g=1", "display_name": "glinton", "link": "https://stackoverflow.com/users/9226947/glinton"}, "reply_to_user": {"reputation": 93, "user_id": 539069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297e47225abb4b496cf86475808ec6d6?s=128&d=identicon&r=PG", "display_name": "Austin Platt", "link": "https://stackoverflow.com/users/539069/austin-platt"}, "edited": false, "score": 0, "creation_date": 1516900662, "post_id": 48428656, "comment_id": 83889488, "body": "You can set <code>req.Host</code>, which will set the <code>Host</code> header, to be the domain name in question. In the director function: <code>req.URL.Scheme = &quot;https&quot;</code> <code>req.URL.Host = addrs[0]</code> and <code>req.Host = &quot;thing.com&quot;</code> This works quite well for me."}, {"owner": {"reputation": 93, "user_id": 539069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297e47225abb4b496cf86475808ec6d6?s=128&d=identicon&r=PG", "display_name": "Austin Platt", "link": "https://stackoverflow.com/users/539069/austin-platt"}, "edited": false, "score": 0, "creation_date": 1516903369, "post_id": 48428656, "comment_id": 83891065, "body": "But in the <code>Transport</code>, when we dial and make the connection we only use the address of the origin server to connect to (<code>DialTLS func(network, addr string) (net.Conn, error)</code>). In our case the address is the IP so we can&#39;t configure tls with the expected servername?"}], "tags": [], "owner": {"reputation": 27, "user_id": 9226947, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/GneVo.jpg?s=128&g=1", "display_name": "glinton", "link": "https://stackoverflow.com/users/9226947/glinton"}, "is_accepted": false, "score": 3, "last_activity_date": 1516815906, "creation_date": 1516815906, "answer_id": 48428656, "question_id": 48421156, "link": "https://stackoverflow.com/questions/48421156/go-transport-connection-keepalive-when-dns-changes/48428656#48428656", "title": "Go Transport connection keepalive when DNS changes", "body": "<p>Judging by the question, it seems that the proxy implementation was designed to use an ip as an endpoint.</p>\n\n<p>If you cannot avoid using hostnames as your target endpoints, you could configure your <a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\"><code>httputil.ReverseProxy.Director</code></a> to resolve the hostnames. At the expense of the lookup time (could be configured to only lookup when the dns ttl expires), you'd get realtime updated target endpoints, while still utilizing the <a href=\"https://golang.org/pkg/net/http/#Transport\" rel=\"nofollow noreferrer\"><code>http.Transport</code>s</a> connection cache.</p>\n\n<p>Example <code>Director</code>:</p>\n\n<pre><code>func director(req *http.Request) {\n    addrs, err := net.LookupHost(\"yourdomain.com\")\n    if err != nil {\n        handle(err)\n    }\n    if len(addrs) &lt; 1 {\n        handle(fmt.Errorf(\"No addresses found\"))\n    }\n\n    req.URL.Host = addrs[0]\n}\n</code></pre>\n"}], "owner": {"reputation": 93, "user_id": 539069, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297e47225abb4b496cf86475808ec6d6?s=128&d=identicon&r=PG", "display_name": "Austin Platt", "link": "https://stackoverflow.com/users/539069/austin-platt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 852, "favorite_count": 2, "answer_count": 1, "score": 3, "last_activity_date": 1516815906, "creation_date": 1516792539, "question_id": 48421156, "link": "https://stackoverflow.com/questions/48421156/go-transport-connection-keepalive-when-dns-changes", "title": "Go Transport connection keepalive when DNS changes", "body": "<p>I'm currently writing a proxy using go. I'm using the <a href=\"https://golang.org/pkg/net/http/httputil/#ReverseProxy\" rel=\"nofollow noreferrer\">ReverseProxy</a> from the standard library and also the default <a href=\"https://golang.org/pkg/net/http/#Transport\" rel=\"nofollow noreferrer\">Transport</a> from the standard library.</p>\n\n<p>Suppose for this question that we only have one origin host for the proxy. We set <code>DisableKeepAlives</code> to be false, allow more than one idle connection to the origin server and set the <code>IdleConnTimeout</code> to be 60 seconds.</p>\n\n<p>Suppose a client uses the proxy to make one request to the origin host every 10 seconds. The first connection will cause a DNS lookup to find the IP of the origin host. The transport will keep a connection open to that IP which will never be closed as we keep re-using it before the timeout. The way that go caches the connection is on the host rather than the IP.</p>\n\n<p>Now suppose that the DNS record for that host changes and points to a new IP. We will still have our connection open to the original IP, and because this never gets closed, we never need to make a new connection and so will not start communicating to the new IP (on the assumption that the original host is still active after the dns change).</p>\n\n<p>What pattern is appropriate if we want to design the system in such a way that it is responsive to DNS changes? One idea I had was to have an infinite loop which <a href=\"https://golang.org/pkg/net/http/#Transport.CloseIdleConnections\" rel=\"nofollow noreferrer\">closes any idle connections</a> which exist every N seconds. This would work for the toy example above but in the case where we have much more traffic flowing through, then there's a good chance that a request will be in-flight during the flush.</p>\n\n<p>An alternative to that would be to just set a maximum length of time that a connection can be alive for. However I can't see a way to manipulate the standard library to achieve this.</p>\n\n<p>Can anyone advise on a design which would be responsive to a DNS change?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 4, "last_activity_date": 1516815292, "last_edit_date": 1516815292, "creation_date": 1516791566, "answer_id": 48420811, "question_id": 48420649, "link": "https://stackoverflow.com/questions/48420649/why-golang-display-different-values-when-use-different-output-function/48420811#48420811", "title": "Why Golang display different values when use different output function", "body": "<p>You shouldn't be using the <a href=\"https://golang.org/pkg/builtin/#println\" rel=\"nofollow noreferrer\">builtin println</a>, it clearly states:</p>\n\n<blockquote>\n  <p>The println built-in function formats its arguments in an\n  implementation-specific way and writes the result to standard error.\n  Spaces are always added between arguments and a newline is appended.\n  Println is useful for bootstrapping and debugging; it is not\n  guaranteed to stay in the language.</p>\n</blockquote>\n\n<p>And the <a href=\"https://golang.org/ref/spec#Bootstrapping\" rel=\"nofollow noreferrer\">spec</a> also mentions:</p>\n\n<blockquote>\n  <p>Current implementations provide several built-in functions useful\n  during bootstrapping. These functions are documented for completeness\n  but are not guaranteed to stay in the language. They do not return a\n  result.</p>\n  \n  <p>Implementation restriction: print and println need not\n  accept arbitrary argument types, but printing of boolean, numeric, and\n  string types must be supported.</p>\n</blockquote>\n\n<p>This is it. <code>print</code> and <code>println</code> are useful debugging tools but should not be relied upon to:</p>\n\n<ul>\n<li>provide a specific output</li>\n<li>provide the same output on different platforms</li>\n<li>provide the same output over time</li>\n<li>exist</li>\n</ul>\n\n<p>That said, I'm guessing that in your case it is printing the internal interface fields: a pointer to a type, and a value.</p>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 1, "last_activity_date": 1516792761, "creation_date": 1516792761, "answer_id": 48421237, "question_id": 48420649, "link": "https://stackoverflow.com/questions/48420649/why-golang-display-different-values-when-use-different-output-function/48421237#48421237", "title": "Why Golang display different values when use different output function", "body": "<p>First of all, <code>fmt.Println</code> and builtin <code>println</code> are very different matteres: they are different both in implentation and in purpose. <code>fmt.Println</code> deals with many complex cases using reflect while <code>println</code> only deal with some base cases and is only for \"bootstrap or debug\" (as the spec says).</p>\n\n<p>In this specific case, you are printing an <code>interface{}</code> you returned from <code>InitEfacePointer()</code>. The <code>fmt.Println</code> looks into the interface using reflect and gets the underlying data: a nil pointer to a string and it then prints it out: <code>0x0</code>. On the other hand, builtin <code>println</code> takes the interface and by magic of the compiler (or not), it recognize it is an interface. As <a href=\"https://research.swtch.com/interfaces\" rel=\"nofollow noreferrer\">this post</a>, golang interface are auctually two pointers, one to information about the type stored and one to the underlying data. So the builtin <code>println</code>goes into the interface details, <code>0x93d40</code> being the \"type info\" and <code>0x0</code> being the underlying data. (The first <code>0x0</code> is from the function call).</p>\n\n<p>Furthermore, testing whether the returned interface is <code>nil</code> seems like a common mistake. Read here: <a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#nil_error</a></p>\n"}], "owner": {"reputation": 805, "user_id": 548328, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/6349ac8ba7e0daa4b341e7ff79fe879e?s=128&d=identicon&r=PG", "display_name": "Sili", "link": "https://stackoverflow.com/users/548328/sili"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 167, "favorite_count": 0, "accepted_answer_id": 48421237, "answer_count": 2, "score": 1, "last_activity_date": 1516815292, "creation_date": 1516791095, "question_id": 48420649, "link": "https://stackoverflow.com/questions/48420649/why-golang-display-different-values-when-use-different-output-function", "title": "Why Golang display different values when use different output function", "body": "<p>I try to check when Golang return a local value as nil, then I use this code.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype S struct{}\n\nfunc InitEfacePointer() interface{} {\n    var s *S\n    println(s)\n    return s\n}\n\nfunc main() {\n    s := InitEfacePointer()\n    fmt.Println(s)\n    //println(s)\n}\n</code></pre>\n\n<p>The output is\n0x0\n</p>\n\n<p>But when I just use println to output value.</p>\n\n<pre><code>package main\n\ntype S struct{}\n\nfunc InitEfacePointer() interface{} {\n    var s *S\n    println(s)\n    return s\n}\n\nfunc main() {\n    s := InitEfacePointer()\n    println(s)\n}\n</code></pre>\n\n<p>The output changed to \n0x0\n(0x93d40,0x0)</p>\n\n<p>Could anyone explain the mechanism of this behavior? Thanks! </p>\n"}, {"tags": ["go", "methods", "import", "packages"], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 1, "last_activity_date": 1516790714, "creation_date": 1516790714, "answer_id": 48420527, "question_id": 48419618, "link": "https://stackoverflow.com/questions/48419618/how-to-correctly-import-method-from-another-package/48420527#48420527", "title": "How to correctly import method from another package", "body": "<p>This has nothing to do with packages, but with alias declaration vs type definition.</p>\n\n<p>Let's take a simple example:</p>\n\n<pre><code>type A string\n\nfunc (a A) Print() {\n    fmt.Println(a)\n}\n\ntype B A\ntype C = A\n\nfunc main() {\n    A(\"A\").Print()\n    B(\"B\").Print()\n    C(\"C\").Print()\n}\n</code></pre>\n\n<p>This fails to compile on line <code>B(\"B\").Print()</code> with:</p>\n\n<blockquote>\n  <p>B(\"B\").Print undefined (type B has no field or method Print)</p>\n</blockquote>\n\n<p>The spec clearly spells out the difference in the <a href=\"https://golang.org/ref/spec#Type_declarations\" rel=\"nofollow noreferrer\">type declarations section</a></p>\n\n<p>The line <code>type B A</code> is a type definition:</p>\n\n<blockquote>\n  <p>A type definition creates a new, distinct type with the same\n  underlying type and operations as the given type, and binds an\n  identifier to it.</p>\n</blockquote>\n\n<p>While the line <code>type C = A</code> is an alias declaration:</p>\n\n<blockquote>\n  <p>An alias declaration binds an identifier to the given type.</p>\n</blockquote>\n\n<p>The former is a new type, so the receiver type <code>A</code> for method <code>Print()</code> will not match the type <code>B</code>.\nThe latter is just a name pointing to type <code>A</code>.</p>\n\n<p>You'll want to change your code to the following, using type aliases:</p>\n\n<pre><code>import t myapp/tables\n\ntype tableName = t.TableName\n\ntableName(\"string\").GetDataFromDataSource()\n</code></pre>\n\n<p>And a few notes:</p>\n\n<ul>\n<li><code>t.GetDataFromDataSource()</code> can't work, it's a method and needs a receiver</li>\n<li><code>t.tableName(\"string\").GetDataFromDataSource()</code> won't work, <code>t.tableName</code> is not a thing, or if it is, it's not exported</li>\n<li>you can't talk about importing methods, only packages are imported. A method is either exported or not, but it's the package you import</li>\n</ul>\n"}], "owner": {"reputation": 11, "user_id": 9261336, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eacc30670774e91750042c59cf6115c4?s=128&d=identicon&r=PG&f=1", "display_name": "Mat", "link": "https://stackoverflow.com/users/9261336/mat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1043, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516793775, "creation_date": 1516788175, "last_edit_date": 1516793152, "question_id": 48419618, "link": "https://stackoverflow.com/questions/48419618/how-to-correctly-import-method-from-another-package", "title": "How to correctly import method from another package", "body": "<p>I have the following simple project:</p>\n\n<pre><code>myapp/\n    |- mainlib/main.go\n    |- tables/sometable.go\n</code></pre>\n\n<p>In sometable.go I have:</p>\n\n<pre><code>package tables\n\nimport (\n    \"fmt\"\n)\n\ntype TableName string\n\nfunc (table TableName) GetDataFromDataSource() string {\n    return \"getdatafromdatasource\"\n}\n</code></pre>\n\n<p>Those are methods, and now I want to use them in main.go:</p>\n\n<pre><code>package main\n\nimport t myapp/tables\n\ntype tableName t.TableName // and such \"attempts\"\n</code></pre>\n\n<p>I've tried:</p>\n\n<pre><code>t.GetDataFromDataSource()\nt.tableName(\"string\").GetDataFromDataSource()\ntableName(\"string\").GetDataFromDataSource()\n</code></pre>\n\n<p>and similar combinations and compiler says \"undefined reference\" still...</p>\n\n<p>So, my question is: how to correctly use method from another package in such context? Of course my methods starts with captial letters and are exported. If I try to use simple function with same name (not method), then it works correctly...</p>\n"}, {"tags": ["go", "race-condition", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 717, "user_id": 4445988, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/HPoQw.jpg?s=128&g=1", "display_name": "GwydionFR", "link": "https://stackoverflow.com/users/4445988/gwydionfr"}, "edited": false, "score": 0, "creation_date": 1516790134, "post_id": 48419906, "comment_id": 83830186, "body": "Is my edit valid then ? This way the goroutine closes itself"}, {"owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "reply_to_user": {"reputation": 717, "user_id": 4445988, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/HPoQw.jpg?s=128&g=1", "display_name": "GwydionFR", "link": "https://stackoverflow.com/users/4445988/gwydionfr"}, "edited": false, "score": 0, "creation_date": 1516790260, "post_id": 48419906, "comment_id": 83830262, "body": "it is valid, yes"}], "tags": [], "owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "is_accepted": false, "score": 1, "last_activity_date": 1516788955, "creation_date": 1516788955, "answer_id": 48419906, "question_id": 48419499, "link": "https://stackoverflow.com/questions/48419499/pulling-0-sized-golang-chan/48419906#48419906", "title": "Pulling 0-sized golang chan", "body": "<p>It's because you are closing the buffer but your <code>notifySubscriber</code> is still listening on the buffer. A closed channel always returns the default type value(in this case an empty <code>Subscription</code> with empty <code>TargetURL</code>). Hence, you are getting an empty string.</p>\n\n<p>Scenarios:</p>\n\n<ul>\n<li>If you want to keep the goroutines running, then don't close the buffer.</li>\n<li>Stop the goroutines once the work is done and then close the buffer.</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": false, "score": 1, "last_activity_date": 1516790675, "creation_date": 1516790675, "answer_id": 48420514, "question_id": 48419499, "link": "https://stackoverflow.com/questions/48419499/pulling-0-sized-golang-chan/48420514#48420514", "title": "Pulling 0-sized golang chan", "body": "<p>From the spec:</p>\n\n<blockquote>\n  <p>For a channel c, the built-in function close(c) records that no more\n  values will be sent on the channel. It is an error if c is a\n  receive-only channel. Sending to or closing a closed channel causes a\n  run-time panic. Closing the nil channel also causes a run-time panic.\n  After calling close, and after any previously sent values have been\n  received, receive operations will return the zero value for the\n  channel's type without blocking. The multi-valued receive operation\n  returns a received value along with an indication of whether the\n  channel is closed.</p>\n</blockquote>\n\n<p>The last sentence means that <code>sub, more := &lt;-buffer</code>, more will be <code>false</code> if <code>buffer</code> is closed.</p>\n\n<p>However, in your case, the code can use some improvement.</p>\n\n<p>First, it makes no sense to use a <code>select</code> statement where there are only one <code>case</code>. It would just act the same without the <code>select</code>.</p>\n\n<p>Second, in cases that the recieving channel is guaranteed to return, <code>range</code> over channel can be used. So your code can be changed to:</p>\n\n<pre><code>func notifySubscriber(buffer chan Subscription) {\n    log.Println(\"notifySubscriber\")\n    for sub:= range buffer {\n        //Code here...\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 717, "user_id": 4445988, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/HPoQw.jpg?s=128&g=1", "display_name": "GwydionFR", "link": "https://stackoverflow.com/users/4445988/gwydionfr"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 88, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516790675, "creation_date": 1516787853, "question_id": 48419499, "link": "https://stackoverflow.com/questions/48419499/pulling-0-sized-golang-chan", "title": "Pulling 0-sized golang chan", "body": "<p>My use-case is the following: I need to send POST requests to <code>0...N</code> subscribers, which are represented by a targetUrl. I want to limitate the max number of goroutine to let's say, 100. My code (simplified) is the following:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"net/http\"\n    \"errors\"\n)\n\nconst MAX_CONCURRENT_NOTIFICATIONS = 100\n\ntype Subscription struct {\n    TargetUrl string\n}\n\nfunc notifySubscribers(subs []Subscription) {\n    log.Println(\"notifySubscribers\")\n    var buffer = make(chan Subscription, len(subs))\n    defer close(buffer)\n\n    for i := 0; i &lt; MAX_CONCURRENT_NOTIFICATIONS; i++ {\n            go notifySubscriber(buffer)\n    }\n\n    for i := range subs {\n            buffer &lt;- subs[i]\n    }\n}\n\nfunc notifySubscriber(buffer chan Subscription) {\n    log.Println(\"notifySubscriber\")\n    for {\n            select {\n            case sub := &lt;-buffer:\n                    log.Println(\"sending notification to \" + sub.TargetUrl)\n\n                    resp, err := failPost()\n                    if err != nil {\n                            log.Println(fmt.Sprintf(\"failed to notify %s. error: %s\", sub.TargetUrl, err.Error()))\n                    } else {\n                            resp.Body.Close()\n\n                            if resp.StatusCode != http.StatusOK {\n                                    log.Println(fmt.Sprintf(\"%s responded with %d\", sub.TargetUrl, resp.StatusCode))\n                            }\n                    }\n            }\n            log.Println(fmt.Sprintf(\"buffer size: %d\", len(buffer)))\n    }\n}\n\nfunc failPost() (*http.Response, error) {\n    return &amp;http.Response{\n            StatusCode: http.StatusBadRequest,\n    }, errors.New(\"some bad error\")\n}\n\nfunc main() {\n    log.Println(\"main\")\n    var subs []Subscription\n    subs = append(subs, Subscription{TargetUrl: \"http://foo.bar\"})\n    subs = append(subs, Subscription{TargetUrl: \"http://fizz.buzz\"})\n\n    notifySubscribers(subs)\n    select {}\n}\n</code></pre>\n\n<p>The output is the following:\n<code>\n2018/01/24 10:52:48 failed to notify . error: some bad error\n2018/01/24 10:52:48 buffer size: 1\n2018/01/24 10:52:48 sending notification to \n2018/01/24 10:52:48 failed to notify . error: some bad error\n2018/01/24 10:52:48 buffer size: 0\n2018/01/24 10:52:48 sending notification to \n2018/01/24 10:52:48 failed to notify . error: some bad error\n... and so on till I SIGINT the program\n</code></p>\n\n<p>So basically it means that I've successfuly send the notifications to the right people, but I still continue to send to empty targetUrl because I read from an empty chan.</p>\n\n<p>What is wrong ?</p>\n\n<p>[EDIT] Workaround, but I don't like it</p>\n\n<pre><code>for {\n    select {\n        case sub, more := &lt;-buffer:\n            if !more {\n                return\n            }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "timezone"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516783169, "post_id": 48417993, "comment_id": 83825657, "body": "That&#39;s not a time, that&#39;s a location description. Do you have a full date/time string you want to parse, or just the location from this string?"}, {"owner": {"reputation": 157, "user_id": 7794585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf2a2d3ad9fbb255a94137ef6ebf3e7?s=128&d=identicon&r=PG&f=1", "display_name": "sm4ll_3gg", "link": "https://stackoverflow.com/users/7794585/sm4ll-3gg"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516783247, "post_id": 48417993, "comment_id": 83825698, "body": "@Marc just location"}, {"owner": {"reputation": 1332, "user_id": 3664021, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0f3a9f339c82088c5bfe6be353fbae64?s=128&d=identicon&r=PG", "display_name": "leninhasda", "link": "https://stackoverflow.com/users/3664021/leninhasda"}, "edited": false, "score": 0, "creation_date": 1516783720, "post_id": 48417993, "comment_id": 83825999, "body": "<code>time.FixedZone</code> might be the option for you, which returns <code>time.Location</code> when called"}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 1, "last_activity_date": 1516786296, "last_edit_date": 1516786296, "creation_date": 1516783946, "answer_id": 48418299, "question_id": 48417993, "link": "https://stackoverflow.com/questions/48417993/how-to-parse-gmt-timezone-golang/48418299#48418299", "title": "How to parse GMT timezone Golang", "body": "<p>You'll need to extract the zone name from your string, then turn it into a location.</p>\n\n<p>You can do the first part using regexps, the latter with <a href=\"https://golang.org/pkg/time/#LoadLocation\" rel=\"nofollow noreferrer\">time.LoadLocation</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n    \"time\"\n)\n\nfunc main() {\n    re := regexp.MustCompile(`^\\(([A-Z]+)[+-:0-9]+\\).*`)\n    input := \"(GMT+01:00) Brussels, Copenhagen, Madrid, Paris.\"\n\n    matches := re.FindStringSubmatch(input)\n    fmt.Println(\"Found timezone string: \", matches[1])\n\n    l, _ := time.LoadLocation(matches[1])\n    fmt.Println(\"Found timezone:\", l)\n\n    fmt.Println(time.Now())\n    fmt.Println(time.Now().In(l))\n}\n</code></pre>\n\n<p>This prints out:</p>\n\n<pre><code>$ go run ./main.go\nFound timezone string:  GMT\nFound timezone: GMT\n2018-01-24 10:30:28.989832073 +0100 CET\n2018-01-24 09:30:28.989860913 +0000 GMT\n</code></pre>\n\n<p><strong>warning</strong>: I'm ignoring errors and non-matching regexp, you probably shouldn't.</p>\n"}], "owner": {"reputation": 157, "user_id": 7794585, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7bf2a2d3ad9fbb255a94137ef6ebf3e7?s=128&d=identicon&r=PG&f=1", "display_name": "sm4ll_3gg", "link": "https://stackoverflow.com/users/7794585/sm4ll-3gg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1551, "favorite_count": 0, "accepted_answer_id": 48418299, "answer_count": 1, "score": -1, "last_activity_date": 1516786296, "creation_date": 1516782850, "question_id": 48417993, "link": "https://stackoverflow.com/questions/48417993/how-to-parse-gmt-timezone-golang", "title": "How to parse GMT timezone Golang", "body": "<p>I have time zone id like this: <code>(GMT+01:00) Brussels, Copenhagen, Madrid, Paris</code>. What is the best way to get <code>time.Location</code> from this string?  </p>\n"}, {"tags": ["mysql", "go", "query-builder"], "answers": [{"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516809923, "post_id": 48417437, "comment_id": 83843700, "body": "The disadvantage of the first solution is that it exposes anything that consumes your model to the <code>sql</code> package and its semantics."}, {"owner": {"reputation": 1246, "user_id": 4516106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/37134b731235c61f94701c9e5d6882cf?s=128&d=identicon&r=PG", "display_name": "khue bui", "link": "https://stackoverflow.com/users/4516106/khue-bui"}, "edited": false, "score": 0, "creation_date": 1516854418, "post_id": 48417437, "comment_id": 83862642, "body": "hi Flimzy, sorry about the delay in response, good solutions, but it&#39;s make me change many lines of code, I searched around and finally, I decided to use <a href=\"https://github.com/volatiletech/sqlboiler/blob/master/queries/reflect.go#L85\" rel=\"nofollow noreferrer\">queries.Bind</a> from <code>sqlboiler</code>, thanks anyway"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": true, "score": 4, "last_activity_date": 1516781150, "last_edit_date": 1516781150, "creation_date": 1516780776, "answer_id": 48417437, "question_id": 48416958, "link": "https://stackoverflow.com/questions/48416958/get-nil-value-from-sql-in-go/48417437#48417437", "title": "Get nil value from sql in Go", "body": "<p>You shouldn't be checking like that at all. The nullable types are intended for use directly in structs:</p>\n\n<pre><code>type Profile struct {\n    ID        sql.NullInt64  `json:\"id\"`\n    CreatedAt time.Time      `json:\"created_at\"`\n    UpdatedAt time.Time      `json:\"updated_at\"`\n    FirstName sql.NullString `json:\"first_name\"`\n    LastName  sql.NullString `json:\"last_name\"`\n    Age       sql.NullInt64  `json:\"age\"`\n}\n</code></pre>\n\n<p>Then access the values using, for example, <code>product.FirstName.String()</code>.  There is no reason for checking <code>product.FirstName.Valid</code> except where you actually care about the distinction between <code>nil</code> and an empty value (in the examples in your question, you clearly don't care about this distinction).</p>\n\n<p>An alternative, which may be more suitable in some situations, is to just use a pointer:</p>\n\n<pre><code>type Profile struct {\n    ID        *int      `json:\"id\"`\n    CreatedAt time.Time `json:\"created_at\"`\n    UpdatedAt time.Time `json:\"updated_at\"`\n    FirstName *string   `json:\"first_name\"`\n    LastName  *string   `json:\"last_name\"`\n    Age       *int      `json:\"age\"`\n}\n</code></pre>\n\n<p>Of course then any code that uses these variables must dereference them, and check for <code>nil</code>, so this may not always be the most desirable, depending on how you use the values.</p>\n\n<p>A third option, if you never care about the distinction between a <code>NULL</code> value and and empty value, is to create your own type which treats these the same.  Example:</p>\n\n<pre><code>type myString string\n\nfunc (s *myString) Scan(src interface{}) error {\n    if src == nil {\n        return nil\n    }\n    if value, ok := src.(string); ok {\n        *s = value\n        return nil\n    }\n    return fmt.Errorf(\"Unsupported type for myString: %T\", src)\n}\n</code></pre>\n"}], "owner": {"reputation": 1246, "user_id": 4516106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/37134b731235c61f94701c9e5d6882cf?s=128&d=identicon&r=PG", "display_name": "khue bui", "link": "https://stackoverflow.com/users/4516106/khue-bui"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1850, "favorite_count": 0, "accepted_answer_id": 48417437, "answer_count": 1, "score": 1, "last_activity_date": 1516781150, "creation_date": 1516778734, "question_id": 48416958, "link": "https://stackoverflow.com/questions/48416958/get-nil-value-from-sql-in-go", "title": "Get nil value from sql in Go", "body": "<p>let say I have a struct <strong>Profile</strong> and sql table <strong>profiles</strong>.</p>\n\n<pre><code>type Profile struct {\n    ID        int       `json:\"id\"`\n    CreatedAt time.Time `json:\"created_at\"`\n    UpdatedAt time.Time `json:\"updated_at\"`\n    FirstName string    `json:\"first_name\"`\n    LastName  string    `json:\"last_name\"`\n    Age       int       `json:\"age\"`\n}\n</code></pre>\n\n<p>And, I get a record from <strong>profiles</strong> table, assign into the Profile struct.</p>\n\n<p>These fields are <strong>allow null</strong>, so that I used <strong>sql.NullString</strong>, <strong>sql.NullInt64</strong>, <strong>pq.NullTime</strong> to check valid value before assign to struct.</p>\n\n<pre><code>// ... DB.Query(...)\n// ... rows.Next()\n// ... rows.Scan()\n// ...\nif firstName.Valid {\n    p.FirstName = firstName.String\n}\nif lastName.Valid {\n    p.LastName = lastName.String\n}\nif age.Valid {\n    p.Age = age.Int64\n}\n// ...\n</code></pre>\n\n<p>If I have more than 10 tables, each tables has more than 30 columns, I have to check all variables again and again.\nThat make ugly code, someone have any suggestion to make it pretty?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "is_accepted": false, "score": 0, "last_activity_date": 1516778578, "creation_date": 1516778578, "answer_id": 48416916, "question_id": 48416807, "link": "https://stackoverflow.com/questions/48416807/golang-routine-with-unbuffered-channel/48416916#48416916", "title": "Golang routine with unbuffered channel", "body": "<p>If there are 2 or many receivers and one sender on a channel(buffered/unbuffered) and sender sends a message through the channel, only one out of all the receivers will get the message.</p>\n"}, {"tags": [], "owner": {"reputation": 1046, "user_id": 1212463, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/2f71fd74e5a4d487a4db70e4039d655b?s=128&d=identicon&r=PG", "display_name": "lmazgon", "link": "https://stackoverflow.com/users/1212463/lmazgon"}, "is_accepted": false, "score": 0, "last_activity_date": 1516783934, "last_edit_date": 1516783934, "creation_date": 1516781425, "answer_id": 48417597, "question_id": 48416807, "link": "https://stackoverflow.com/questions/48416807/golang-routine-with-unbuffered-channel/48417597#48417597", "title": "Golang routine with unbuffered channel", "body": "<p>You are right, only one receiver can get one specific message from a channel (buffered or unbuffered). If you want multiple receivers to read all messages from a channel, you will have to put a multiplexer between the original channel and the receivers, which would read the messages and forward them to <code>N</code> channels, one for each receiver.</p>\n\n<p>If we would draw it out it would look something like this (<code>GA</code> is the sender, <code>GB</code>, <code>GC</code>, <code>GZ</code> are receivers, <code>c</code>, <code>cB</code>, <code>cC</code>, <code>cZ</code> are channels and <code>multiplexer</code> is self explanatory).</p>\n\n<pre><code>                         +-&gt; [cB] -&gt; GB\n                         |\nGA -&gt; [c] -&gt; multiplexer +-&gt; [cC] -&gt; GC\n                         |\n                         ...\n                         |\n                         +-&gt; [cZ] -&gt; GZ\n</code></pre>\n\n<p>You can also look at <a href=\"https://stackoverflow.com/questions/47589584/how-to-multiplex-channel-output-in-go\">this answer</a> for a code example.</p>\n"}, {"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 0, "last_activity_date": 1516781451, "creation_date": 1516781451, "answer_id": 48417602, "question_id": 48416807, "link": "https://stackoverflow.com/questions/48416807/golang-routine-with-unbuffered-channel/48417602#48417602", "title": "Golang routine with unbuffered channel", "body": "<p>Let say goroutine A and B are reading from unbuffered channel <code>c</code>. They are both blocked as the channel is unbuffered.</p>\n\n<p>Goroutine D write something into channel. One of A or B will receive data and will be unblocked the other one stay blocked until D or other goroutine write another thing into channel.</p>\n"}, {"comments": [{"owner": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "edited": false, "score": 0, "creation_date": 1516795904, "post_id": 48418470, "comment_id": 83833801, "body": "How about the order ? Is it granted that the first goroutine will get 1 and the second get 2?"}, {"owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "reply_to_user": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "edited": false, "score": 1, "creation_date": 1516801788, "post_id": 48418470, "comment_id": 83837569, "body": "No, not generally. Even if the implementation uses a FIFO queue for waiting goroutines, there is a race between the two goroutines in the example I provided to be first to execute the receive operator (<code>&lt;-</code>). You should generally avoid designs where you rely on concurrent things happening in a particular order."}, {"owner": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "edited": false, "score": 0, "creation_date": 1516839689, "post_id": 48418470, "comment_id": 83858999, "body": "So once you send  <code>n</code>   messages from  somewhere, and there are <code>n</code> goroutines to receive the message, it is not granted that the receiver will receive the message by order as they are declared, however is it granted that all the <code>n</code> goroutines will get the message? For example, is it possible one of goroutine receive the message twice which make at least one goroutine get nothing?"}, {"owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "reply_to_user": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "edited": false, "score": 0, "creation_date": 1516972069, "post_id": 48418470, "comment_id": 83916755, "body": "If multiple receivers each execute the <code>&lt;-</code> operator once, they will receive exactly one message each (assuming there are enough messages sent). These will be emitted from the channel in the same order as they were sent. However, unless you add additional logic to control in which order the receiving goroutines <i>execute</i>, you typically can&#39;t know which one will call <code>&lt;-</code> first, nor in which order they will actually process the message after having received it."}], "tags": [], "owner": {"reputation": 1435, "user_id": 180656, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/24c91c0ae420dcaf04e5e9061be6a93c?s=128&d=identicon&r=PG", "display_name": "Josef Grahn", "link": "https://stackoverflow.com/users/180656/josef-grahn"}, "is_accepted": true, "score": 3, "last_activity_date": 1516784514, "creation_date": 1516784514, "answer_id": 48418470, "question_id": 48416807, "link": "https://stackoverflow.com/questions/48416807/golang-routine-with-unbuffered-channel/48418470#48418470", "title": "Golang routine with unbuffered channel", "body": "<p>A message sent through a channel is delivered to <em>exactly one</em> receiving goroutine.</p>\n\n<p>Assuming you have three goroutines, one sending and two receiving, the sending goroutine needs to send <em>two</em> messages for both the receiving goroutines to unblock, like <a href=\"https://play.golang.org/p/V6XCFuPNfhy\" rel=\"nofollow noreferrer\">this</a>:</p>\n\n<pre><code>var c = make(chan int)\n\ngo func() { fmt.Printf(\"got %d\\n\", &lt;-c) }()\ngo func() { fmt.Printf(\"got %d\\n\", &lt;-c) }()\n\nc &lt;- 1\nc &lt;- 2\n</code></pre>\n\n<p>Also notice that this also requires the receiving goroutines to read <em>exactly one</em> message each. If they were to do it in a loop, one of them might receive both messages and the other none.</p>\n"}], "owner": {"reputation": 31023, "user_id": 306719, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/8b5f2224482b0bc3648353d36a0c8814?s=128&d=identicon&r=PG", "display_name": "hguser", "link": "https://stackoverflow.com/users/306719/hguser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 0, "accepted_answer_id": 48418470, "answer_count": 4, "score": 0, "last_activity_date": 1516784514, "creation_date": 1516778186, "question_id": 48416807, "link": "https://stackoverflow.com/questions/48416807/golang-routine-with-unbuffered-channel", "title": "Golang routine with unbuffered channel", "body": "<p>I am reading the book <code>Go in action</code>.</p>\n\n<p>This is how the <code>unbuffered channel</code> are described:</p>\n\n<blockquote>\n  <p>An unbuffered channel is a channel with no capacity to hold any value\n  before it\u2019s received. These types of channels require both a sending\n  and receiving goroutine to be ready at the same instant before any\n  send or receive operation can complete. If the two goroutines aren\u2019t\n  ready at the same instant, the channel makes the goroutine that\n  performs its respective send or receive operation first wait.\n  Synchronization is inherent in the interaction between the send and\n  receive on the channel. One can\u2019t happenwithout the other.</p>\n</blockquote>\n\n<p>The book use the following figure to illustrate the <code>unbuffered channel</code>:</p>\n\n<p><a href=\"https://i.stack.imgur.com/wAkID.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wAkID.png\" alt=\"enter image description here\"></a></p>\n\n<p>So I just wonder how about if there are three or more <code>goroutine</code> which share the same <code>channel</code>? </p>\n\n<p>For example, three goroutine <code>GA</code> <code>GB</code> <code>GC</code> share the same channel <code>c</code></p>\n\n<p>Now once <code>GA</code> send message through <code>c</code>, how do we make sure that both <code>GB</code> and <code>GC</code> will receive the message? Since as the book said:</p>\n\n<blockquote>\n  <p>These types of channels require both a sending and receiving goroutine\n  to be ready at the same instant</p>\n</blockquote>\n\n<p>Which means when two goroutine are exchanging the message, the third must lost the message.</p>\n\n<p>Is this the right way goroutine run?</p>\n"}, {"tags": ["windows", "testing", "go"], "comments": [{"owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1516777263, "post_id": 48416467, "comment_id": 83822641, "body": "1) Which OS you&#39;re using? 2) What have you tried so far?"}, {"owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "reply_to_user": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "edited": false, "score": 0, "creation_date": 1516777387, "post_id": 48416467, "comment_id": 83822692, "body": "Win10 OS. I looked through the settings VSCode to see if there was one I could toggle but did not see any. The testing package does not appear to have (i&#39;m quite new) the ability to redirect output."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1516779492, "post_id": 48416467, "comment_id": 83823836, "body": "fmt.Print writes to stdout and you can redirect that e.g. with shell redirections. If you want your code to write to somewhere else you need to use fmt.Fprint."}, {"owner": {"reputation": 685, "user_id": 7047363, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3a4cda8321abd1a553445a95258babb?s=128&d=identicon&r=PG&f=1", "display_name": "muthukumar selvaraj", "link": "https://stackoverflow.com/users/7047363/muthukumar-selvaraj"}, "edited": false, "score": 0, "creation_date": 1516782611, "post_id": 48416467, "comment_id": 83825360, "body": "where is your code and what is your expected output"}], "answers": [{"tags": [], "owner": {"reputation": 394, "user_id": 2437315, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e01b82306d827dd8c6c85ae087c61d59?s=128&d=identicon&r=PG", "display_name": "Christopher", "link": "https://stackoverflow.com/users/2437315/christopher"}, "is_accepted": false, "score": 0, "last_activity_date": 1516913757, "creation_date": 1516913757, "answer_id": 48451780, "question_id": 48416467, "link": "https://stackoverflow.com/questions/48416467/redirecting-print-statements-to-a-file/48451780#48451780", "title": "Redirecting print statements to a file", "body": "<p>The way that I would recommend redirecting your output, would be to use the <code>fmt.Fprint*</code> family of functions, and specify an <code>io.Writer</code> that you want to write to. The io.Writer can be whatever you need, from an in memory buffer, to a file on your system, or even an open network connection. The <code>fmt.Print*</code> functions are implemented by calling the <code>fmt.Fprint*</code> functions and specifying <code>os.Stdout</code> as the <code>io.Writer</code>.</p>\n\n<p>Because of the way the <code>fmt.Print*</code> functions are defined, it should technically be possible to set <code>os.Stdout</code> to a new <code>*os.File</code> in order to redirect the output of anything that writes to stdout, including the <code>fmt.Print*</code> functions. This is really not recommended, but possible.</p>\n\n<p><a href=\"https://play.golang.org/p/k5GzQIAYLcf\" rel=\"nofollow noreferrer\">https://play.golang.org/p/k5GzQIAYLcf</a></p>\n"}], "owner": {"reputation": 573, "user_id": 1461482, "user_type": "registered", "accept_rate": 28, "profile_image": "https://www.gravatar.com/avatar/5705236c7b4c1258ea03199dee58f841?s=128&d=identicon&r=PG", "display_name": "Riyaz Mansoor", "link": "https://stackoverflow.com/users/1461482/riyaz-mansoor"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 48, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1516913757, "creation_date": 1516776826, "last_edit_date": 1516777443, "question_id": 48416467, "link": "https://stackoverflow.com/questions/48416467/redirecting-print-statements-to-a-file", "title": "Redirecting print statements to a file", "body": "<p>My program outputs a lot of text. </p>\n\n<p>I use VSCode (relatively new) and the display of output is always truncated. </p>\n\n<p>Is it possible to output all such fmt.PrintXXX statements to a file?</p>\n\n<p>OR</p>\n\n<p>How can I capture all of the output from the .Print statements ?</p>\n"}, {"tags": ["go", "zlib"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516807556, "post_id": 48414288, "comment_id": 83841872, "body": "Also see: <a href=\"https://stackoverflow.com/questions/40893411/golang-python-zlib-difference\" title=\"golang python zlib difference\">stackoverflow.com/questions/40893411/&hellip;</a>"}, {"owner": {"reputation": 13, "user_id": 8022543, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_wuQMQxcoKY/AAAAAAAAAAI/AAAAAAAAFXQ/9amJ0QfI5Kc/photo.jpg?sz=128", "display_name": "smith30", "link": "https://stackoverflow.com/users/8022543/smith30"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516872534, "post_id": 48414288, "comment_id": 83870150, "body": "@JimB Thanks.Compression of go is superior to python."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1516887258, "last_edit_date": 1516887258, "creation_date": 1516803010, "answer_id": 48424480, "question_id": 48414288, "link": "https://stackoverflow.com/questions/48414288/the-compression-using-flate-newwriterdict-is-strange/48424480#48424480", "title": "The compression using flate.NewWriterDict is strange", "body": "<p>In general, compression implementations are not guaranteed to produce identical outputs, they only ensure that the output can be reversed by another implementation following the specification. You're calling flush an extra time here, which adds another sync marker, which is why you have to slice off 8 bytes at the end to match your output, rather than 4.</p>\n\n<p>Without the example code for comparison, we can't tell exactly what you're comparing against, but the output appears to be what you expected:</p>\n\n<pre><code>dict := []byte{0x48, 0x65, 0x6c, 0x6c, 0x6f}\n\nout := &amp;bytes.Buffer{}\n\ncmp, _ := flate.NewWriterDict(out, 9, dict)\ncmp.Write([]byte(\"Hello\"))\ncmp.Flush()\n\nfmt.Printf(\"deflated: %#v\\n\", out.Bytes())\n\nr := flate.NewReaderDict(out, dict)\norig, _ := ioutil.ReadAll(r)\n\nfmt.Println(\"inflated:\", string(orig))\n\n// deflated: []byte{0x2, 0x13, 0x0, 0x0, 0x0, 0x0, 0xff, 0xff}\n// inflated: Hello\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Kk_mBytkbD2\" rel=\"nofollow noreferrer\">https://play.golang.org/p/Kk_mBytkbD2</a></p>\n"}], "owner": {"reputation": 13, "user_id": 8022543, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-_wuQMQxcoKY/AAAAAAAAAAI/AAAAAAAAFXQ/9amJ0QfI5Kc/photo.jpg?sz=128", "display_name": "smith30", "link": "https://stackoverflow.com/users/8022543/smith30"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 154, "favorite_count": 0, "accepted_answer_id": 48424480, "answer_count": 1, "score": 1, "last_activity_date": 1516887258, "creation_date": 1516763817, "last_edit_date": 1516781639, "question_id": 48414288, "link": "https://stackoverflow.com/questions/48414288/the-compression-using-flate-newwriterdict-is-strange", "title": "The compression using flate.NewWriterDict is strange", "body": "<h2>Problem</h2>\n\n<p>first process</p>\n\n<pre><code>compressed_1 : []byte{0xf2, 0x48, 0xcd, 0xc9, 0xc9, 0x7, 0x0}\n</code></pre>\n\n<p>second process(compress with dictionary)</p>\n\n<pre><code>compressed_2 : []byte{0x2, 0x13, 0x0, 0x0}\n</code></pre>\n\n<p>but I expected</p>\n\n<pre><code>compressed_2 : []byte{0xf2, 0x0, 0x11, 0x0, 0x0}\n</code></pre>\n\n<p>The basis of my expectation is from the following.\n<a href=\"https://tools.ietf.org/html/rfc7692#section-7.2.3.2\" rel=\"nofollow noreferrer\">https://tools.ietf.org/html/rfc7692#section-7.2.3.2</a></p>\n\n<p>Other implementations of python have confirmed that they will be compressed with the above correct result.\n<a href=\"https://github.com/aaugustin/websockets\" rel=\"nofollow noreferrer\">https://github.com/aaugustin/websockets</a></p>\n\n<p>I do not know if the cause is go code or whether my execution method is bad.\nIf you are familiar with zlib and flate, please advise me...</p>\n\n<h2>Code</h2>\n\n<p><strong>executed code</strong></p>\n\n<pre><code>package flate_dict\n\nimport (\n    \"bytes\"\n    \"compress/flate\"\n    \"fmt\"\n)\n\nfunc compressWithDict(level int) {\n\n    // compress\n    src := []byte(\"Hello\")\n\n    compressed := &amp;bytes.Buffer{}\n    compressor, _ := flate.NewWriter(compressed, level)\n    compressor.Write(src)\n    compressor.Flush()\n    compressor.Close()\n\n    dict := compressed.Bytes()\n    dict = dict[:len(dict)-9]\n    fmt.Printf(\"compressed_1 : %#v\\n\", dict)\n\n    // compress\n    dct := []byte{0x48, 0x65, 0x6c, 0x6c, 0x6f}\n    src_2 := []byte(\"Hello\")\n\n    compressed_2 := &amp;bytes.Buffer{}\n    compressor_2, _ := flate.NewWriterDict(compressed_2, level, dct)\n    compressor_2.Write(src_2)\n    compressor_2.Flush()\n    compressor_2.Close()\n\n    dict_2 := compressed_2.Bytes()\n    dict_2 = dict_2[:len(dict_2)-9]\n\n    fmt.Printf(\"compressed_2 : %#v\\n\\n\", dict_2)\n}\n</code></pre>\n\n<p><strong>test code for debug</strong></p>\n\n<pre><code>package flate_dict\n\nimport \"testing\"\n\nfunc Test_compressWithDict(t *testing.T) {\n    tests := []struct {\n        name  string\n        level int\n    }{\n        {\n            name:  \"01\",\n            level: -2,\n        },\n        {\n            name:  \"02\",\n            level: -1,\n        },\n        {\n            name:  \"03\",\n            level: 0,\n        },\n        {\n            name:  \"04\",\n            level: 1,\n        },\n        {\n            name:  \"05\",\n            level: 2,\n        },\n        {\n            name:  \"06\",\n            level: 3,\n        },\n        {\n            name:  \"07\",\n            level: 4,\n        },\n        {\n            name:  \"08\",\n            level: 5,\n        },\n        {\n            name:  \"09\",\n            level: 6,\n        },\n        {\n            name:  \"10\",\n            level: 7,\n        },\n        {\n            name:  \"11\",\n            level: 8,\n        },\n        {\n            name:  \"12\",\n            level: 9,\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            compressWithDict(tt.level)\n        })\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "github-enterprise"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1516812162, "post_id": 48414157, "comment_id": 83845325, "body": "Setting a GitHub private (ssh) key makes things far simpler for private repos."}], "answers": [{"comments": [{"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1516764549, "post_id": 48414284, "comment_id": 83818556, "body": "If I do that, I get a &quot;repository does not exist error."}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1516764587, "post_id": 48414284, "comment_id": 83818568, "body": "Just looked at your profile.  Are you Milton Baxter?"}, {"owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "reply_to_user": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 0, "creation_date": 1516765189, "post_id": 48414284, "comment_id": 83818731, "body": "Indeed I am. Are you @Matt somebody?.  Have you tried without the .git suffix.  I tried a little test run here with just <code>&#47;myproject</code>"}, {"owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "edited": false, "score": 2, "creation_date": 1516765383, "post_id": 48414284, "comment_id": 83818782, "body": "haha.  Milton, here&#39;s a hint. Peter is not my dad and Malaysia was fun.  Must catch up some time.   The git suffix seems to be required on private github servers."}], "tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": false, "score": 1, "last_activity_date": 1516763770, "creation_date": 1516763770, "answer_id": 48414284, "question_id": 48414157, "link": "https://stackoverflow.com/questions/48414157/how-do-i-use-go-get-with-a-private-github-enterprise-server/48414284#48414284", "title": "How do I use go get with a private github enterprise server?", "body": "<p>The get command supports using http by using the <code>-insecure</code> flag as shown below:</p>\n\n<pre><code>go get -insecure privateserver.com/path/to/myproject.git\n</code></pre>\n\n<p>The default is secure HTTPS in order to prevent man in the middle attacks as described in <a href=\"https://github.com/golang/go/issues/9637\" rel=\"nofollow noreferrer\">Git Issue</a>.</p>\n"}], "owner": {"reputation": 30596, "user_id": 134702, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/7c1594304f3515b88e31bc8888f0f593?s=128&d=identicon&r=PG", "display_name": "Matt Hook", "link": "https://stackoverflow.com/users/134702/matt-hook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1987, "favorite_count": 1, "answer_count": 1, "score": 3, "last_activity_date": 1516765973, "creation_date": 1516762882, "last_edit_date": 1516765973, "question_id": 48414157, "link": "https://stackoverflow.com/questions/48414157/how-do-i-use-go-get-with-a-private-github-enterprise-server", "title": "How do I use go get with a private github enterprise server?", "body": "<p>We use github enterprise server over a VPN.</p>\n\n<p>If I type:</p>\n\n<pre><code>go get privateserver.com/path/to/myproject.git\n</code></pre>\n\n<p>I get this result:  </p>\n\n<pre><code>package privateserver.com/path/to/myproject.git: cannot download, privateserver.com/path/to/myproject uses insecure protocol\n</code></pre>\n\n<p>Or removing the .git suffix I get:</p>\n\n<pre><code>package privateserver.com/path/to/myproject: unrecognized import path \"privateserver.com/path/to/myproject\" (parse https://privateserver.com/path/to/myproject?go-get=1: no go-import meta tags ())\n</code></pre>\n\n<p>It seems there are many similar questions on google searches but have found no answers that actually work. </p>\n\n<p>What I really want to end up with is automation of docker builds.\nInside my docker file I require a go get.  But I can't store the credentials inside the docker file.</p>\n\n<p>Note: --insecure doesn't work. See bottom of question.</p>\n\n<hr>\n\n<p>Just tried go get with -insecure -v options.\nI get the following output:</p>\n\n<pre><code>matthewh@xen:~/go/src/$ go get -insecure -v privateserver.com/path/to/myproject.git\n# cd .; git ls-remote git://privateserver.com/path/to/myproject\nfatal: remote error: \n  GitHub private mode is enabled. Git protocol is disabled. Use authenticated http or ssh access instead.\n# cd .; git ls-remote https://privateserver.com/path/to/myproject\nfatal: could not read Username for 'https://privateserver.com': terminal prompts disabled\n# cd .; git ls-remote http://privateserver.com/path/to/myproject\nfatal: could not read Username for 'https://privateserver.com': terminal prompts disabled\n# cd .; git ls-remote git+ssh://privateserver.com/path/to/myproject\nPermission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\n# cd .; git ls-remote ssh://privateserver.com/path/to/myproject\nPermission denied (publickey).\nfatal: Could not read from remote repository.\n\nPlease make sure you have the correct access rights\nand the repository exists.\nprivateserver.com/path/to/myproject.git (download)\n# cd .; git clone privateserver.com/path/to/myproject /home/matthewh/go/src/privateserver.com/path/to/myproject.git\nfatal: repository 'privateserver.com/path/to/myproject' does not exist\npackage privateserver.com/path/to/myproject.git: exit status 128\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 5143, "user_id": 216764, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/363035cc5a9f1f7b45c0ef750dac1076?s=128&d=identicon&r=PG", "display_name": "uthark", "link": "https://stackoverflow.com/users/216764/uthark"}, "edited": false, "score": 7, "creation_date": 1516761634, "post_id": 48414001, "comment_id": 83817911, "body": "Indexing starts with 0"}], "answers": [{"comments": [{"owner": {"reputation": 31, "user_id": 6089784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ppk0ofO1xHY/AAAAAAAAAAI/AAAAAAAABSM/KyuRcyeTwT0/photo.jpg?sz=128", "display_name": "ibigpapa", "link": "https://stackoverflow.com/users/6089784/ibigpapa"}, "edited": false, "score": 0, "creation_date": 1516835370, "post_id": 48414060, "comment_id": 83857712, "body": "Totally make sense!  Thanks"}], "tags": [], "owner": {"reputation": 5268, "user_id": 302164, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XucHp.png?s=128&g=1", "display_name": "miltonb", "link": "https://stackoverflow.com/users/302164/miltonb"}, "is_accepted": false, "score": 4, "last_activity_date": 1516761987, "creation_date": 1516761987, "answer_id": 48414060, "question_id": 48414001, "link": "https://stackoverflow.com/questions/48414001/why-does-slicing-decrease-capacity-by-one/48414060#48414060", "title": "Why does slicing decrease capacity by one", "body": "<p>By changing your code to the following (starting at index 0), then the capacity is unchanged inline with what you expected.  By using index 1 in the slice you have lost the first item (item at 0) which is why there is an apparent capacity change.</p>\n\n<pre><code>  name2 := name[0:500]\n  fmt.Printf(\"%d | %d\\n\", cap(name2), len(name2))\n</code></pre>\n\n<p>Producing the output:</p>\n\n<pre><code>100000000 | 500\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 3, "last_activity_date": 1516810224, "creation_date": 1516810224, "answer_id": 48426898, "question_id": 48414001, "link": "https://stackoverflow.com/questions/48414001/why-does-slicing-decrease-capacity-by-one/48426898#48426898", "title": "Why does slicing decrease capacity by one", "body": "<p>When you shrink a slice from the left (increasing the slice's start index in the underlying array), you reduce its capacity, because it can never grow to the left. When you shrink a slice from the right (reducing the slice's length), the capacity is unchanged, because a slice <em>can</em> grow to the right. For example:</p>\n\n<pre><code>name := make([]int, 100)\nfmt.Printf(\"%d | %d\\n\", cap(name), len(name))\nname2 := name[:50]  // Won't shrink because left side is unchanged\nfmt.Printf(\"%d | %d\\n\", cap(name2), len(name2))\nname2 = name[50:]   // WILL shrink because left side is moved up\nfmt.Printf(\"%d | %d\\n\", cap(name2), len(name2))\n</code></pre>\n\n<p>Outputs:</p>\n\n<pre><code>cap 100 | len 100\ncap 100 | len 50\ncap 50 | len 50\n</code></pre>\n\n<p>Playground demo: <a href=\"https://play.golang.org/p/jbGRmexV5d-\" rel=\"nofollow noreferrer\">https://play.golang.org/p/jbGRmexV5d-</a></p>\n"}], "owner": {"reputation": 31, "user_id": 6089784, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-ppk0ofO1xHY/AAAAAAAAAAI/AAAAAAAABSM/KyuRcyeTwT0/photo.jpg?sz=128", "display_name": "ibigpapa", "link": "https://stackoverflow.com/users/6089784/ibigpapa"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 213, "favorite_count": 0, "accepted_answer_id": 48426898, "answer_count": 2, "score": 1, "last_activity_date": 1516810224, "creation_date": 1516761539, "question_id": 48414001, "link": "https://stackoverflow.com/questions/48414001/why-does-slicing-decrease-capacity-by-one", "title": "Why does slicing decrease capacity by one", "body": "<p>So I was testing slices and thought that go won't decrease the capacity.  But from what i see it does.  Does anyone know the reason for the drop in capacity of 1?   <code>(go version go1.8 linux/amd64)</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    name := make([]int, 0, 100000000)\n    fmt.Printf(\"%d | %d\\n\", cap(name), len(name))\n    for x:= 0; x &lt; 1000; x++ {\n        name = append(name, x)\n    }\n    fmt.Printf(\"%d | %d\\n\", cap(name), len(name))\n    name2 := name[1:500]\n    fmt.Printf(\"%d | %d\\n\", cap(name2), len(name2))\n}\n</code></pre>\n\n<p>The output is </p>\n\n<pre><code>100000000 | 0\n100000000 | 1000\n99999999 | 499\n</code></pre>\n\n<p>Changing the size to 1000 changes the output to this</p>\n\n<pre><code>1000 | 0\n1000 | 1000\n999 | 499\n</code></pre>\n"}, {"tags": ["go", "channel", "goroutine"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516768708, "post_id": 48413839, "comment_id": 83819585, "body": "Use a mutex to prevent the race described in the question."}, {"owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "edited": false, "score": 0, "creation_date": 1516794428, "post_id": 48413839, "comment_id": 83832866, "body": "You need to have a way to figure out if the writer goroutine is at work and time out if needed - you can retry sending the message till the timeout."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516810351, "post_id": 48413839, "comment_id": 83844035, "body": "There is no simple answer because this isn&#39;t a simple problem. You need to work through <i>exactly</i> what you want to happen in each scenario, including how long you&#39;re willing to buffer pending sends for, how much memory you&#39;re willing to consume on pending sends, etc."}], "owner": {"reputation": 340, "user_id": 1087576, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cc0840f7fd22073389276d85120e0884?s=128&d=identicon&r=PG", "display_name": "Tom K", "link": "https://stackoverflow.com/users/1087576/tom-k"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1516764202, "creation_date": 1516760276, "last_edit_date": 1516764202, "question_id": 48413839, "link": "https://stackoverflow.com/questions/48413839/making-a-goroutine-channel-that-drops-data-when-no-connection-available", "title": "Making a goroutine/channel that drops data when no connection available", "body": "<p>I'm new to goroutines and trying to work out the idiomatic way to organise this code. My program will generate async status events that I want to transmit to a server over a websocket. Right now I have a global channel <code>messagesToServer</code> to receive the status messages. The idea is it that will send the data if we currently have a websocket open, or quietly drop it if the connection to the server is currently closed or unavailable.</p>\n\n<p>Relevant snippets are below. I don't really like the non-blocking send - if for some reason my writer goroutine took a while to process a message I think it could end up dropping a quick second message for no reason?</p>\n\n<p>But if I use a blocking send, <code>sendStatusToServer</code> could block something that shouldn't be blocked if the connection is offline. I could try to track connected/disconnected state but if a message was sent at the same time as the disconnection occurred I think there would be a race condition.</p>\n\n<p>Is there a tidy way I can write this?</p>\n\n<pre><code>var (\n    messagesToServer chan common.StationStatus\n)\n\n// ...\nfunc sendStatusToServer(msg common.StationStatus) {\n    // Must be non-blocking in case we're not connected\n    select {\n    case messagesToServer &lt;- msg:\n        break\n    default:\n        break\n    }\n}\n// ...\n\n// after making websocket connection\n            log.Println(\"Connected to central server\");\n            finished := make(chan struct{})\n\n            // Writer\n            go func() {\n                for {\n                    select {\n                    case msg := &lt;-messagesToServer:\n                        var buff bytes.Buffer\n                        enc := gob.NewEncoder(&amp;buff)\n                        err = enc.Encode(msg)\n                        conn.WriteMessage(websocket.BinaryMessage, buff.Bytes()); // ignore errors by design\n                    case &lt;-finished:\n                        return;\n                    }\n                }\n            }()\n\n            // Reader as busy loop on this goroutine\n            for {\n                messageType, p, err := conn.ReadMessage()\n</code></pre>\n"}, {"tags": ["go", "concurrency", "rabbitmq"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1516753674, "post_id": 48412791, "comment_id": 83815957, "body": "I\u2019m not sure what the rabbitmq settings correlate to, but fundamentally you can\u2019t have \u201cexactly once\u201d delivery in a distributed system."}], "answers": [{"comments": [{"owner": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 0, "creation_date": 1517315509, "post_id": 48417102, "comment_id": 84037564, "body": "So the point here is that RabbitMQ don&#39;t sent the same message twice  unless your consumer has notified RabbitMQ that failed then RabbitMQ will sent it again depending your configurations. Anyway using message brokers every consumer must be prepared to receive the same message twice  by definition"}, {"owner": {"reputation": 2126, "user_id": 3864737, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Lozpu.jpg?s=128&g=1", "display_name": "Olivier", "link": "https://stackoverflow.com/users/3864737/olivier"}, "reply_to_user": {"reputation": 3071, "user_id": 2979435, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/c3fac4fcf2b4ae7f3f5a96164b34958e?s=128&d=identicon&r=PG", "display_name": "deFreitas", "link": "https://stackoverflow.com/users/2979435/defreitas"}, "edited": false, "score": 0, "creation_date": 1517349369, "post_id": 48417102, "comment_id": 84057798, "body": "Well, taking an extract of <a href=\"https://www.rabbitmq.com/reliability.html\" rel=\"nofollow noreferrer\">rabbitmq reliability documentation</a>, <code>Use of acknowledgements guarantees at-least-once delivery. Without acknowledgements, message loss is possible during publish and consume operations and only at-most-once delivery is guaranteed.</code> I don&#39;t agree with @deFreitas statement. The way you set things up combined with what you&#39;re trying to achieve and what you can live with will determine whether you&#39;ll have at-least-once, at-most-once or neither. Now what I&#39;ll agree with is that indeed most setups will target at-least once. :)"}], "tags": [], "owner": {"reputation": 2126, "user_id": 3864737, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/Lozpu.jpg?s=128&g=1", "display_name": "Olivier", "link": "https://stackoverflow.com/users/3864737/olivier"}, "is_accepted": false, "score": 1, "last_activity_date": 1516785486, "last_edit_date": 1516785486, "creation_date": 1516779352, "answer_id": 48417102, "question_id": 48412791, "link": "https://stackoverflow.com/questions/48412791/is-it-possible-that-multiple-consumers-of-a-rabbitmq-queue-get-the-same-message/48417102#48417102", "title": "Is it possible that multiple consumers of a Rabbitmq queue get the same message?", "body": "<p>The one case I could see with your setup where a message would be processed more than once is if one of the consumers has an issue at some point.\nThe situation would follow such a scenario:</p>\n\n<ol>\n<li>Consumer gets a bunch of messages from the queue</li>\n<li>Consumer starts processing a message</li>\n<li>Consumer commits the message to mongodb</li>\n<li>either due to rabbitmq channel/connection issue, or other type of issue consumer side, the consumer never acknowledges the message</li>\n<li>the message as it hasn't been acknowledged is requeued at the top of the queue</li>\n<li>same message is processed again, causing the duplication</li>\n</ol>\n\n<p>Such cases should show some errors in your consumers logs.</p>\n"}], "owner": {"reputation": 471, "user_id": 2210282, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/997edbdae64652689b581c9a57ccfac7?s=128&d=identicon&r=PG", "display_name": "Sam", "link": "https://stackoverflow.com/users/2210282/sam"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1717, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1516785486, "creation_date": 1516751844, "last_edit_date": 1516752519, "question_id": 48412791, "link": "https://stackoverflow.com/questions/48412791/is-it-possible-that-multiple-consumers-of-a-rabbitmq-queue-get-the-same-message", "title": "Is it possible that multiple consumers of a Rabbitmq queue get the same message?", "body": "<p>I am in charge maintaining a production software written in Golang which uses RabbitMq as its message queue.<br>\nConsider the following situation:   </p>\n\n<ol>\n<li><p>A number of goroutines are publishing to a queue name <em>logs</em>.   </p></li>\n<li><p>Another set goroutines read from the queue and write the messages to a MongoDB collection. </p></li>\n<li>Each publisher or consumer has its <em>Own</em> connection, and its own channel respectively, they are working in an infinite loop and never die. (The connections and channels are established when the program starts.)   </li>\n<li><code>autoAck</code>, <code>exclusive</code> and <code>noWait</code> are all set to false and <code>prefetch</code> is set to 20 with <code>global</code> set to false for all\nchannels.    All queues are durable with <code>autoDelete</code>, <code>exclusive</code>\nand <code>noWait</code> all set to false.</li>\n</ol>\n\n<p>The basic assumption was that each message in the queue will be delivered to <em>one and only one</em> consumer, so each message would be inserted in the database exactly once.<br>\nThe problem is that there are duplicate messages in the MongoDB collection.<br>\nI would like to know if it is possible that more than one consumer gets the same message causing them to insert duplicates?   </p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 535, "user_id": 546757, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3e1a3747e45df2c6e79c5029b4947c24?s=128&d=identicon&r=PG", "display_name": "Alan Cabrera", "link": "https://stackoverflow.com/users/546757/alan-cabrera"}, "edited": false, "score": 0, "creation_date": 1516804283, "post_id": 48412231, "comment_id": 83839377, "body": "Thanks, that certainly works.  The annoying bit is that when I use <code>YourStruct</code> with &quot;older&quot; code, I have to pass <code>instance.ImportedStruct</code>."}, {"owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "reply_to_user": {"reputation": 535, "user_id": 546757, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3e1a3747e45df2c6e79c5029b4947c24?s=128&d=identicon&r=PG", "display_name": "Alan Cabrera", "link": "https://stackoverflow.com/users/546757/alan-cabrera"}, "edited": false, "score": 0, "creation_date": 1516868947, "post_id": 48412231, "comment_id": 83868071, "body": "Yeah, I know but this is how Go embedding works: <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#embedding</a>"}], "tags": [], "owner": {"reputation": 2624, "user_id": 3310285, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FaFcy.png?s=128&g=1", "display_name": "Alex Efimov", "link": "https://stackoverflow.com/users/3310285/alex-efimov"}, "is_accepted": true, "score": 6, "last_activity_date": 1516748256, "creation_date": 1516748256, "answer_id": 48412231, "question_id": 48412154, "link": "https://stackoverflow.com/questions/48412154/custom-json-marshaling-for-external-packages/48412231#48412231", "title": "Custom JSON marshaling for external packages", "body": "<p>You could add that struct to one defined by you. Then add the functions <code>MarshalJSON</code> and <code>UnmarshalYAML</code> to your struct:</p>\n\n<pre><code>type YourStruct struct {\n    ImportedStruct\n}\n\nfunc (s *YourStruct) MarshalJSON() ([]byte, error) {\n    ...\n}\n</code></pre>\n"}], "owner": {"reputation": 535, "user_id": 546757, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/3e1a3747e45df2c6e79c5029b4947c24?s=128&d=identicon&r=PG", "display_name": "Alan Cabrera", "link": "https://stackoverflow.com/users/546757/alan-cabrera"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 48412231, "answer_count": 1, "score": 1, "last_activity_date": 1585120232, "creation_date": 1516747855, "last_edit_date": 1585120232, "question_id": 48412154, "link": "https://stackoverflow.com/questions/48412154/custom-json-marshaling-for-external-packages", "title": "Custom JSON marshaling for external packages", "body": "<p>How can I add custom JSON marshaling to structs from external packages?  I am unable to add the <code>MarshalJSON</code> and <code>UnmarshalYAML</code> to these structs.</p>\n"}, {"tags": ["json", "go", "dynamic", "unmarshalling"], "answers": [{"comments": [{"owner": {"reputation": 15, "user_id": 2138298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa3ea27bec592dc86ad0762eee377e4?s=128&d=identicon&r=PG", "display_name": "t0dbld", "link": "https://stackoverflow.com/users/2138298/t0dbld"}, "edited": false, "score": 0, "creation_date": 1516748670, "post_id": 48411730, "comment_id": 83814416, "body": "Thank you so much, as expected someone better could make it look so easy!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 0, "last_activity_date": 1516745709, "creation_date": 1516745709, "answer_id": 48411730, "question_id": 48411657, "link": "https://stackoverflow.com/questions/48411657/golang-consume-json-with-dynamic-relevant-keys/48411730#48411730", "title": "Golang consume json with dynamic relevant keys", "body": "<p>You're halfway there already, you just need to unmarshal into your struct and then massage the data a little:</p>\n\n<pre><code>type Market struct {\n    Name string\n    Last       string \n    HighestBid string \n}\n\nfunc main() {\n    // Unmarshal using a generic interface\n    var f map[string]Market\n    err := json.Unmarshal(jsonBytes, &amp;f)\n    if err != nil {\n        fmt.Println(\"Error parsing JSON: \", err)\n        return\n    }\n    markets := make([]Market, 0, len(f))\n    for k,v := range f {\n        v.Name = k\n        markets = append(markets,v)\n    }\n    fmt.Println(markets)\n}\n</code></pre>\n\n<p>Working example here: <a href=\"https://play.golang.org/p/iagx8RWFfx_k\" rel=\"nofollow noreferrer\">https://play.golang.org/p/iagx8RWFfx_k</a></p>\n"}, {"tags": [], "owner": {"reputation": 5243, "user_id": 173277, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/98bb270ad14fde81c6d16583a9939f39?s=128&d=identicon&r=PG", "display_name": "nickgrim", "link": "https://stackoverflow.com/users/173277/nickgrim"}, "is_accepted": false, "score": 0, "last_activity_date": 1516805395, "creation_date": 1516805395, "answer_id": 48425296, "question_id": 48411657, "link": "https://stackoverflow.com/questions/48411657/golang-consume-json-with-dynamic-relevant-keys/48425296#48425296", "title": "Golang consume json with dynamic relevant keys", "body": "<p>If a slice of Markets is a data structure that's going to be useful to you, you might wish to alias it and implement <code>MarketList.UnmarshalJSON([]byte)</code>, like so:</p>\n\n<pre><code>type Market struct {\n    MarketName string\n    Last       string\n    HighestBid string\n}\n\ntype MarketList []Market\n\nfunc (ml *MarketList) UnmarshalJSON(b []byte) error {\n    tmp := map[string]Market{}\n    err := json.Unmarshal(b, &amp;tmp)\n    if err != nil {\n        return err\n    }\n\n    var l MarketList\n    for k, v := range tmp {\n        v.MarketName = k\n        l = append(l, v)\n    }\n\n    *ml = l\n    return nil\n}\n\nfunc main() {\n    ml := MarketList{}\n    // Unmarshal directly into a []Market alias\n    _ = json.Unmarshal(jsonBytes, &amp;ml)\n\n    fmt.Printf(\"%+v\\n\", ml)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/7s79Nzybzfn\" rel=\"nofollow noreferrer\">Runnable version here</a>.</p>\n"}], "owner": {"reputation": 15, "user_id": 2138298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffa3ea27bec592dc86ad0762eee377e4?s=128&d=identicon&r=PG", "display_name": "t0dbld", "link": "https://stackoverflow.com/users/2138298/t0dbld"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 726, "favorite_count": 0, "accepted_answer_id": 48411730, "answer_count": 2, "score": 0, "last_activity_date": 1516805395, "creation_date": 1516745437, "question_id": 48411657, "link": "https://stackoverflow.com/questions/48411657/golang-consume-json-with-dynamic-relevant-keys", "title": "Golang consume json with dynamic relevant keys", "body": "<p>I am new to GO and I am trying to consume json data from a variety of API's using GO and place them in struct's one of them Formats the data like so </p>\n\n<pre><code>{\"MS\": {\n   \"last\":\"25\",\n\"highestBid\":\"20\"},\n\"GE\": {        \n    \"last\": \"24\",        \n    \"highestBid\": \"22\"}\n}\n</code></pre>\n\n<p>While I can find information on Consuming with dynamic keys, all the examples I found throw away the Outer most key as arbitrary and irrelevant. I need to use it as a key value pair like bellow:</p>\n\n<pre><code>{\"MarketName\": \"GE\", \"last\":\"24\",\"higestBid\":\"22\"}\n</code></pre>\n\n<p>I understand Using Interface map but I cant figure out how to map the dynamic key to the struct as a key : value pair like above.  My Code example to map leaving out the need key can be found at play ground <a href=\"https://play.golang.org/p/GP-8yD0knku\" rel=\"nofollow noreferrer\">Relevant Code</a> </p>\n\n<pre><code>  package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n\n)\n\nvar jsonBytes = []byte(`\n    {\"MS\": {\n       \"last\":\"25\",\n    \"highestBid\":\"20\"},\n    \"GE\": {        \n        \"last\": \"24\",        \n        \"highestBid\": \"22\"}\n    }`)\n\ntype Market struct {\n    Last       string \n    HighestBid string \n}\n\nfunc main() {\n    // Unmarshal using a generic interface\n    var f interface{}\n    err := json.Unmarshal(jsonBytes, &amp;f)\n    if err != nil {\n        fmt.Println(\"Error parsing JSON: \", err)\n    }\n    fmt.Println(f)\n\n\n\n}\n</code></pre>\n\n<p>as it stands it outputs </p>\n\n<pre><code>map[MS:map[last:25 highestBid:20] GE:map[highestBid:22 last:24]]\n</code></pre>\n\n<p>As I stated I am new to GO and as much help and explanation that i can get would be very appreciated</p>\n"}, {"tags": ["ssl", "go"], "answers": [{"comments": [{"owner": {"reputation": 1081, "user_id": 1294230, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/95a29bd0a0c5363ed72737057c6db2a2?s=128&d=identicon&r=PG", "display_name": "zedix", "link": "https://stackoverflow.com/users/1294230/zedix"}, "edited": false, "score": 0, "creation_date": 1516739566, "post_id": 48409745, "comment_id": 83810260, "body": "Yes! That&#39;s exactly what I was looking for. I&#39;ve got it implemented and it works perfectly. Thank you so much! :)"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 1081, "user_id": 1294230, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/95a29bd0a0c5363ed72737057c6db2a2?s=128&d=identicon&r=PG", "display_name": "zedix", "link": "https://stackoverflow.com/users/1294230/zedix"}, "edited": false, "score": 0, "creation_date": 1516739749, "post_id": 48409745, "comment_id": 83810344, "body": "Glad to hear it. Be careful though: I edited my answer a few times and originally mentioned looking at <code>rawCerts</code>. That was wrong, you definitely need to look at <code>verifiedChains</code>."}, {"owner": {"reputation": 1081, "user_id": 1294230, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/95a29bd0a0c5363ed72737057c6db2a2?s=128&d=identicon&r=PG", "display_name": "zedix", "link": "https://stackoverflow.com/users/1294230/zedix"}, "edited": false, "score": 0, "creation_date": 1516741476, "post_id": 48409745, "comment_id": 83811249, "body": "Correct, thanks for the edits. I&#39;m iterating through verifiedChains to compare certificates against a specific cert I&#39;m looking for."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 4, "last_activity_date": 1516739107, "last_edit_date": 1516739107, "creation_date": 1516737108, "answer_id": 48409745, "question_id": 48409589, "link": "https://stackoverflow.com/questions/48409589/trusting-a-specific-client-with-golang-mutual-tls-auth/48409745#48409745", "title": "Trusting a specific client with golang mutual TLS auth", "body": "<p>There is no mechanism to do this for you, but starting with <a href=\"https://golang.org/doc/go1.8#crypto_tls\" rel=\"nofollow noreferrer\">go 1.8</a> you can specify your own callback using the <code>VerifyPeerCertificate</code> field in the <a href=\"https://golang.org/pkg/crypto/tls/#Config\" rel=\"nofollow noreferrer\">tls.Config</a> object (this works both on the server and client side).</p>\n\n<p>This takes a method with the following signature:</p>\n\n<pre><code>func(rawCerts [][]byte, verifiedChains [][]*x509.Certificate) error\n</code></pre>\n\n<p>Per the docs:</p>\n\n<blockquote>\n  <p>It receives the raw ASN.1 certificates provided by the peer and also\n  any verified chains that normal processing found.</p>\n</blockquote>\n\n<p>The certificate validation has already run, so you only need to apply your specific logic: examine the leaf certificates (first in each chain) in <code>verifiedChains</code> and check that the certificate is in the list of allowed certificates (just <code>A</code> in your case). If it is not: return an error and the handshake will fail.</p>\n"}], "owner": {"reputation": 1081, "user_id": 1294230, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/95a29bd0a0c5363ed72737057c6db2a2?s=128&d=identicon&r=PG", "display_name": "zedix", "link": "https://stackoverflow.com/users/1294230/zedix"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1300, "favorite_count": 1, "accepted_answer_id": 48409745, "answer_count": 1, "score": 2, "last_activity_date": 1516739376, "creation_date": 1516736478, "last_edit_date": 1516739376, "question_id": 48409589, "link": "https://stackoverflow.com/questions/48409589/trusting-a-specific-client-with-golang-mutual-tls-auth", "title": "Trusting a specific client with golang mutual TLS auth", "body": "<p>I've had a successful TLS mutual authentication client/server setup in Go for a while, but now looking to make some small tweaks.</p>\n\n<p>Specifically, I'm wondering if there is a way to require only a specific client certificate for mutual auth. </p>\n\n<p>I'm currently using something like this:</p>\n\n<pre><code>    // Load cert and build pool\n    caCert, _ := ioutil.ReadFile(caPath)        \n    caCertPool := x509.NewCertPool()\n    caCertPool.AppendCertsFromPEM(caCert)\n\n    // Require client authentication\n    tlsConfig := &amp;tls.Config{\n        ClientAuth: tls.RequireAndVerifyClientCert,\n        ClientCAs: caCertPool,\n    }\n</code></pre>\n\n<p>Which works fine, however if the PEM file I'm reading in is actually a certificate chain (A issued by B, and B is a root CA), this will actually end up trusting any certificate issued by B, which I don't want.</p>\n\n<p>Is there any way I can tweak this code to ONLY trust the specific A certificate?</p>\n\n<p>It seems that if I only include A in the loaded PEM file, the <a href=\"https://golang.org/src/crypto/tls/handshake_server.go#L424\" rel=\"nofollow noreferrer\">server handshake code</a> tells the client \"send me all your certs signed by A\", which of course is not what I want, as cert A is not signed by A. </p>\n\n<p>Ideally I'd want to say \"you require specifically certificate A\" to connect successfully. Is there such a mechanism?</p>\n"}, {"tags": ["arrays", "go", "bit-manipulation", "bit", "shift"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1516727298, "post_id": 48407199, "comment_id": 83803399, "body": "I&#39;m not sure I understand the question. You shift by multiples of 8, because bytes are 8 bits. Can you clarify what you&#39;re asking?"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516728247, "post_id": 48407199, "comment_id": 83803989, "body": "This seems pretty trivial despite the <code>len(a)-i-1</code> bit is a little annoying (you are calling len O(n) times! though n&lt;=4). The bitwise shifting is exactly how you deal it on paper, move <code>0</code> 16 bits and you get the leading 8 zeroes, <code>85</code> 8 bits and get the middle <code>01010101</code>. If you haven&#39;t notice, 256 = <code>1&lt;&lt;8</code>."}], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1516728451, "post_id": 48407423, "comment_id": 83804096, "body": "You forgot type convertion."}, {"owner": {"reputation": 1701, "user_id": 788887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68a54ea809de360f7049f5c970df1d7?s=128&d=identicon&r=PG", "display_name": "ReyCharles", "link": "https://stackoverflow.com/users/788887/reycharles"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516732219, "post_id": 48407423, "comment_id": 83806170, "body": "Thank you. Can you add it for me? I don&#39;t write Go, and forgot the details."}, {"owner": {"reputation": 33, "user_id": 2216564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d1b3fc1d4e7051d98b25fe71882fed?s=128&d=identicon&r=PG", "display_name": "Kasay Mardis", "link": "https://stackoverflow.com/users/2216564/kasay-mardis"}, "edited": false, "score": 0, "creation_date": 1516757940, "post_id": 48407423, "comment_id": 83817064, "body": "I would like to mark your answer as a solution also.  I chose the following answer because it was broken down a bit more and written in go (which i feel can help future readers who have the same problem).  I appreciate your response."}], "tags": [], "owner": {"reputation": 1701, "user_id": 788887, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f68a54ea809de360f7049f5c970df1d7?s=128&d=identicon&r=PG", "display_name": "ReyCharles", "link": "https://stackoverflow.com/users/788887/reycharles"}, "is_accepted": false, "score": 1, "last_activity_date": 1516784057, "last_edit_date": 1516784057, "creation_date": 1516727936, "answer_id": 48407423, "question_id": 48407199, "link": "https://stackoverflow.com/questions/48407199/bitwise-bit-shifting-and-why-this-solution-works/48407423#48407423", "title": "Bitwise bit shifting and why this solution works", "body": "<p>the bitshifting by multiples of 8 is the same as muliplying by multiples of 256, e.g. <code>x &lt;&lt; 0*8 == x * 256\u2070</code>, <code>x &lt;&lt; 1*8 == x * 256\u00b9</code>, <code>x &lt;&lt; 2*8 == x * 256\u00b2</code> etc., so the code can be rewritten like this, using <code>math.Pow</code>:</p>\n\n<pre><code>func arrayPacking(a []int) (sum int) {\n  for i := range a {\n    sum += a[len(a) - i - 1] * int(math.Pow(256, (len(a) - i - 1)))\n  }\n  return\n}\n</code></pre>\n\n<p>Or is your question why this sort of packing works?</p>\n"}, {"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 1, "last_activity_date": 1516738291, "last_edit_date": 1516738291, "creation_date": 1516735929, "answer_id": 48409457, "question_id": 48407199, "link": "https://stackoverflow.com/questions/48407199/bitwise-bit-shifting-and-why-this-solution-works/48409457#48409457", "title": "Bitwise bit shifting and why this solution works", "body": "<p>First, write the solution in Go. We convert little-endian, base-256 digits to a base-2 (binary) number. Shifting left by 8 bits multiplies by 256.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc pack(digits []int) (number int) {\n    // digits are little-endian, base-256 (1 &lt;&lt; 8 = 256)\n    for i, digit := range digits {\n        number += digit &lt;&lt; uint(i*8)\n    }\n    return number\n}\n\nfunc main() {\n    a := []int{24, 85, 0}\n    m := pack(a)\n    fmt.Println(m)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/oo_n7CiAHwG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/oo_n7CiAHwG</a></p>\n\n<p>Output:</p>\n\n<pre><code>21784\n</code></pre>\n\n<p>Now you should be able to figure out their ugly looking answer:</p>\n\n<pre><code>func arrayPacking(a []int) (sum int) {\n    for i := range a {\n        sum += a[len(a) - i - 1] &lt;&lt; uint((len(a) - i - 1) * 8)\n    }\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 33, "user_id": 2216564, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c6d1b3fc1d4e7051d98b25fe71882fed?s=128&d=identicon&r=PG", "display_name": "Kasay Mardis", "link": "https://stackoverflow.com/users/2216564/kasay-mardis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1099, "favorite_count": 1, "accepted_answer_id": 48409457, "answer_count": 2, "score": 0, "last_activity_date": 1516784057, "creation_date": 1516727118, "last_edit_date": 1516734587, "question_id": 48407199, "link": "https://stackoverflow.com/questions/48407199/bitwise-bit-shifting-and-why-this-solution-works", "title": "Bitwise bit shifting and why this solution works", "body": "<p>I've been doing code fights on codefights.com and I came upon this problem below.  I have figured out the problem on my own, but when i researched other peoples solutions I found one that was much shorter than mine, but I cant seem to understand why they did what they did.</p>\n\n<p>The question goes:</p>\n\n<blockquote>\n  <p>You are given an array of up to four non-negative integers, each less than 256.\n  Your task is to pack these integers into one number M in the following way:</p>\n  \n  <p>The first element of the array occupies the first 8 bits of M;\n  The second element occupies next 8 bits, and so on.\n  Return the obtained integer M.</p>\n  \n  <p>Note: the phrase \"first bits of M\" refers to the least significant bits of M - the right-most bits of an integer. For further clarification see the following example.</p>\n  \n  <p>Example</p>\n  \n  <p>For a = [24, 85, 0], the output should be\n  arrayPacking(a) = 21784.</p>\n  \n  <p>An array [24, 85, 0] looks like [00011000, 01010101, 00000000] in binary.\n  After packing these into one number we get 00000000 01010101 00011000 (spaces are placed for convenience), which equals to 21784.</p>\n</blockquote>\n\n<p>Their answer was:</p>\n\n<pre><code>func arrayPacking(a []int) (sum int) {\n    for i := range a {\n        sum += a[len(a) - i - 1] &lt;&lt; uint((len(a) - i - 1) * 8)\n    }\n    return\n}\n</code></pre>\n\n<p>How is this code returning the right amount of shift just by using 0, 8, 16, etc. intervals?  I've been researching bitwise a lot lately, but I still can't seem to reason why this works.</p>\n"}, {"tags": ["go", "websocket", "stdout", "stderr", "gorilla"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1516726244, "post_id": 48406751, "comment_id": 83802678, "body": "You cannot upgrade a connection after serving and HTTP request.  Create a separate endpoint for the websocket connection.   The <a href=\"https://github.com/gorilla/websocket/tree/master/examples/command\" rel=\"nofollow noreferrer\">command example</a>  shows how to connect a websocket to stdin / stdout."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516726469, "post_id": 48406751, "comment_id": 83802848, "body": "You&#39;ll need javascript to handle the &quot;render complete&quot; logic and then send a web socket upgrade request to server."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516727557, "post_id": 48406751, "comment_id": 83803549, "body": "@leafbebop How?"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516727883, "post_id": 48406751, "comment_id": 83803754, "body": "That would be a javascript question and pretty common one. Google it will likely generate results."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516729072, "post_id": 48406751, "comment_id": 83804455, "body": "@NathanielFredericks The Gorilla command example linked from my previous comment includes the client javascript code and Go server code to do what you are asking."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516731506, "post_id": 48406751, "comment_id": 83805770, "body": "@CeriseLim&#243;n I will take a closer look at that code..."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "edited": false, "score": 0, "creation_date": 1521459963, "post_id": 48410800, "comment_id": 85724330, "body": "Thank you, this looks like it is what I am looking for. :)"}], "tags": [], "owner": {"reputation": 98, "user_id": 9211161, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-KfvgIfhrYRY/AAAAAAAAAAI/AAAAAAAAAA8/zVe7BuvTBIk/photo.jpg?sz=128", "display_name": "Jean de Klerk", "link": "https://stackoverflow.com/users/9211161/jean-de-klerk"}, "is_accepted": true, "score": 0, "last_activity_date": 1516741540, "creation_date": 1516741540, "answer_id": 48410800, "question_id": 48406751, "link": "https://stackoverflow.com/questions/48406751/how-do-you-send-websocket-data-after-a-page-is-rendered-in-golang/48410800#48410800", "title": "How do you send websocket data after a page is rendered in Golang?", "body": "<p>So, as some of the comments mentioned, you can't upgrade a connection that has already been served html. The simple way to do this is just have one endpoint for your websockets, and one endpoint for your html.</p>\n\n<p>So in your example, you might do:</p>\n\n<p><code>\nhttp.HandleFunc(\"/\", serveHtml)\nhttp.HandleFunc(\"/somethingElse\", serveWebsocket)\n</code></p>\n\n<p>Where serveHtml has your <code>http.ServeFile</code> call, and <code>serveWebsocket</code> has the upgrading and wotnot.</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 955, "favorite_count": 0, "accepted_answer_id": 48410800, "answer_count": 1, "score": 0, "last_activity_date": 1516741540, "creation_date": 1516725578, "last_edit_date": 1516725949, "question_id": 48406751, "link": "https://stackoverflow.com/questions/48406751/how-do-you-send-websocket-data-after-a-page-is-rendered-in-golang", "title": "How do you send websocket data after a page is rendered in Golang?", "body": "<p><br/>\nI am new to Golang and am trying to send data using web-sockets to a page. I have a handler and I want to be able to serve a file and after it is rendered send it a message. This is some code that I have now.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/gorilla/websocket\"\n    \"log\"\n    \"fmt\"\n    \"net/http\"\n)\n\nvar upgrader = websocket.Upgrader{\n    ReadBufferSize:  1024,\n    WriteBufferSize: 1024,\n}\n\nfunc serveRoot(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, \"views/index.html\")\n    _, err := upgrader.Upgrade(w, r, nil)\n    if err != nil {\n        log.Println(err)\n        return\n    }\n}\n\nfunc main() {\n    http.HandleFunc(\"/\", serveRoot)\n    fmt.Println(\"Started\")\n    if err := http.ListenAndServe(\":9090\", nil); err != nil {\n        log.Fatal(\"ListenAndServe:\", err)\n    }\n}\n</code></pre>\n\n<p>The problem is that using the <code>gorilla</code> library I have no idea how to send data and I am getting some output when I load the page.</p>\n\n<pre><code>2018/01/23 08:35:24 http: multiple response.WriteHeader calls\n2018/01/23 08:35:24 websocket: the client is not using the websocket protocol: 'upgrade' token not found in 'Connection' header\n2018/01/23 08:35:24 http: multiple response.WriteHeader calls\n2018/01/23 08:35:24 websocket: 'Origin' header value not allowed\n</code></pre>\n\n<p><strong>Intention:</strong> Send some data after the page is rendered, then <em>(later)</em> hook it up to <code>stdin</code>/<code>stderr</code><br/>\n<strong>Disclaimer:</strong> I am just learning to code, so it would be a great help is you could take that into consideration and not be too vague.</p>\n"}, {"tags": ["dictionary", "go", "hash", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516725417, "post_id": 48406631, "comment_id": 83802129, "body": "The hash table compares the value directly within buckets, the problem is you keep adding the same string: <code>&quot;[TestUuidIsUnique|\ufffd]&quot;</code>"}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516725841, "post_id": 48406631, "comment_id": 83802388, "body": "@JimB sure, but why am I getting that same string? Why does it stop at that exact rune? It&#39;s even reproducible on the playground: <a href=\"https://play.golang.org/p/85KHbc4X9jV\" rel=\"nofollow noreferrer\">play.golang.org/p/85KHbc4X9jV</a>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1516725845, "post_id": 48406631, "comment_id": 83802390, "body": "String conversion of invalid rune returns a string containing the unicode replacement character: &quot;\ufffd&quot;"}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516725892, "post_id": 48406631, "comment_id": 83802420, "body": "@CeriseLim&#243;n Ah, that has to be it! Would you like to write that as an answer?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516725906, "post_id": 48406631, "comment_id": 83802430, "body": "@FilipHaglund: converting a invalid rune to a string always returns <code>&quot;\\ufffd&quot;</code> or <code>&quot;\\xef\\xbf\\xbd&quot;</code>"}, {"owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "edited": false, "score": 0, "creation_date": 1516735347, "post_id": 48406631, "comment_id": 83807984, "body": "I just assumed that the replacement character was because the font couldn&#39;t display those odd characters (that probably aren&#39;t even defined yet). That&#39;s the problem with in-band errors, I guess."}], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 8, "last_activity_date": 1516725917, "creation_date": 1516725917, "answer_id": 48406849, "question_id": 48406631, "link": "https://stackoverflow.com/questions/48406631/hash-collisions-for-golang-built-in-map-and-string-keys/48406849#48406849", "title": "Hash collisions for golang built-in map and string keys?", "body": "<p>String conversion of an invalid rune returns a string containing the unicode replacement character: \"\ufffd\".  </p>\n\n<p>Use the strconv package to convert an integer to text.</p>\n"}], "owner": {"reputation": 12289, "user_id": 596041, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/9eb6a78f4a48d143d59966fceec3c655?s=128&d=identicon&r=PG", "display_name": "Filip Haglund", "link": "https://stackoverflow.com/users/596041/filip-haglund"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 1, "accepted_answer_id": 48406849, "answer_count": 1, "score": 2, "last_activity_date": 1516725917, "creation_date": 1516725161, "question_id": 48406631, "link": "https://stackoverflow.com/questions/48406631/hash-collisions-for-golang-built-in-map-and-string-keys", "title": "Hash collisions for golang built-in map and string keys?", "body": "<p>I wrote this function to generate random unique id's for my test cases:</p>\n\n<pre><code>func uuid(t *testing.T) string {\n    uidCounterLock.Lock()\n    defer uidCounterLock.Unlock()\n\n    uidCounter++\n    //return \"[\" + t.Name() + \"|\" + strconv.FormatInt(uidCounter, 10) + \"]\"\n    return \"[\" + t.Name() + \"|\" + string(uidCounter) + \"]\"\n}\n\nvar uidCounter int64 = 1\nvar uidCounterLock sync.Mutex\n</code></pre>\n\n<p>In order to test it, I generate a bunch of values from it in different goroutines, send them to the main thread, which puts the result in a <code>map[string]int</code> by doing <code>map[v] = map[v] + 1</code>. There is no concurrent access to this map, it's private to the main thread.</p>\n\n<pre><code>var seen = make(map[string]int)\nfor v := range ch {\n    seen[v] = seen[v] + 1\n    if count := seen[v]; count &gt; 1 {\n        fmt.Printf(\"Generated the same uuid %d times: %#v\\n\", count, v)\n    }\n}\n</code></pre>\n\n<p>When I just cast the <code>uidCounter</code> to a string, I get a ton of collisions on a single key. When I use <code>strconv.FormatInt</code>, I get no collisions at all. </p>\n\n<p>When I say a ton, I mean I just got <code>1115919</code> collisions for the value <code>[TestUuidIsUnique|\ufffd]</code> out of <code>2227980</code> generated values, i.e. 50% of the values collide on the same key. The values are not equal. I do always get the same number of collisions for the same source code, so at least it's somewhat deterministic, i.e. probably not related to race conditions.</p>\n\n<p>I'm not surprised integer overflow in a <code>rune</code> would be an issue, but I'm nowhere near 2^31, and that wouldn't explain why the map thinks 50% of the values have the same key. Also, I wouldn't expect a hash collision to impact correctness, just performance, since I can iterate over the keys in a map, so the values are stored there somewhere. </p>\n\n<p>In the output, all runes printed are <code>0xEFBFBD</code>. It's the same number of bits as the highest valid unicode code point, but that doesn't really match either. </p>\n\n<pre><code>Generated the same uuid 2 times: \"[TestUuidIsUnique|\ufffd]\"\nGenerated the same uuid 3 times: \"[TestUuidIsUnique|\ufffd]\"\nGenerated the same uuid 4 times: \"[TestUuidIsUnique|\ufffd]\"\nGenerated the same uuid 5 times: \"[TestUuidIsUnique|\ufffd]\"\n...\nGenerated the same uuid 2047 times: \"[TestUuidIsUnique|\ufffd]\"\nGenerated the same uuid 2048 times: \"[TestUuidIsUnique|\ufffd]\"\nGenerated the same uuid 2049 times: \"[TestUuidIsUnique|\ufffd]\"\n...\n</code></pre>\n\n<p>What's going on here? Did the go authors assume that <code>hash(a) == hash(b)</code> implies <code>a == b</code> for strings? Or am I just missing something silly? <code>go test -race</code> isn't complaining either.</p>\n\n<p>I'm on macOS <code>10.13.2</code>, and <code>go version go1.9.2 darwin/amd64</code>.</p>\n"}, {"tags": ["json", "dictionary", "go", "glide-golang"], "answers": [{"comments": [{"owner": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "edited": false, "score": 0, "creation_date": 1516819905, "post_id": 48409622, "comment_id": 83849884, "body": "But it is not considering field name &quot;current&quot;.I have type &quot;past&quot; also.I have modified the json.How to do on this???"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "edited": false, "score": 0, "creation_date": 1516819989, "post_id": 48409622, "comment_id": 83849926, "body": "Either use the first solution, or add a <code>Current</code> field to the second solution. The examples given in the answer should get you started, a complete implementation is up to you."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "reply_to_user": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "edited": false, "score": 0, "creation_date": 1516820900, "post_id": 48409622, "comment_id": 83850364, "body": "SO is not a code writing service. There should be more than enough information here for you to make the minor customisations needed on your own."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1516736638, "creation_date": 1516736638, "answer_id": 48409622, "question_id": 48406615, "link": "https://stackoverflow.com/questions/48406615/how-to-print-all-the-elements-stored-in-the-field-current-under-org-in-json-do/48409622#48409622", "title": "How to print all the elements stored in the field current under &quot;org&quot; in json document in using golang?", "body": "<p>The contents of <code>phone</code> and <code>org</code> are completely different data structures, and you won't be able to cleanly deserialize both into a homogenous format like you've got in the example. The best option is to at least partially deserialize into a <code>struct</code>:</p>\n\n<pre><code>type data struct {\n    Phone []map[string]string\n    Org []map[string]map[string]string\n}\n</code></pre>\n\n<p>This will at least deserialize all of the data, but it's still a bit messy; a slice of maps of maps is not a great data structure to work with. It's not clear from the question, but if any of the fields are fixed, you might want to codify those in types as well, for example:</p>\n\n<pre><code>type data struct {\n    Phone []map[string]string\n    Org []struct{\n        Current map[string]string\n    }\n}\n</code></pre>\n\n<p>You can then deserialize to this type and use it much more easily:</p>\n\n<pre><code>var person data\njson.Unmarshal([]byte(ii), &amp;person)\nfmt.Printf(\"%v\", person.Phone)\nfmt.Printf(\"%v\", person.Org[0].Current)\n</code></pre>\n\n<p>Working playground example here: <a href=\"https://play.golang.org/p/5W-7RzPimZj\" rel=\"nofollow noreferrer\">https://play.golang.org/p/5W-7RzPimZj</a></p>\n\n<p>Note that I had to correct an error in the JSON, it is invalid due to a missing comma before <code>\"org\"</code>.</p>\n"}], "owner": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 65, "favorite_count": 1, "accepted_answer_id": 48409622, "answer_count": 1, "score": 0, "last_activity_date": 1516819778, "creation_date": 1516725103, "last_edit_date": 1516819778, "question_id": 48406615, "link": "https://stackoverflow.com/questions/48406615/how-to-print-all-the-elements-stored-in-the-field-current-under-org-in-json-do", "title": "How to print all the elements stored in the field current under &quot;org&quot; in json document in using golang?", "body": "<p>The updated json is as follows:</p>\n\n<pre><code>    {\n     \"phone\":[\n                {\"home\":\"58878767\"},\n                {\"mobile\":\"32453543\"}\n              ],\n     \"org\": [\n    {\n        \"current\": {\n            \"org_dept\": \"Hr\",\n            \"org_eptime\": \"1516354574432\",\n            \"org_name\": \"Uejsjak\",\n            \"org_title\": \"Hakosklaks\"\n        }\n    },\n    {\n        \"current\": {\n            \"org_dept\": \"Accounts\",\n            \"org_eptime\": \"1516354561184\",\n            \"org_name\": \"Abcd\",\n            \"org_title\": \"Hakahkshsjs\"\n        },\n    {\n        \"past\": {\n            \"org_dept\": \"Backend\",\n            \"org_eptime\": \"15163545\",\n            \"org_name\": \"Ab\",\n            \"org_title\": \"Hakah\"\n        }\n    }\n    ]\n    }\n</code></pre>\n\n<p>I am using the following code to print on the key and values:</p>\n\n<pre><code>    personMap := make(map[string][]map[string]string)\n\n    json.Unmarshal([]byte(ii), &amp;personMap)\n\n\n    for key, value := range personMap {\n    fmt.Println(\"index : \", key, \" value : \", value){\n\n     }\n</code></pre>\n\n<p>The output I am getting is:</p>\n\n<pre><code>    index: org value: [map[\"current\":\"\"],map[\"current\":\"\"]\n</code></pre>\n\n<p>How I can print every value of fields under field \"current\"?????</p>\n\n<p>Now I am doing this:</p>\n\n<pre><code>    personMap := make(map[string][]struct{Current map[string]string})\n    json.Unmarshal([]byte(ii), &amp;personMap)\n    for key, value := range personMap {\n    fmt.Println(\"index : \", key, \" value : \", value)\n\n    }\n</code></pre>\n\n<p>The output I am getting is:</p>\n\n<pre><code>    index :  org  value :  [{map[org_dept:Hr org_eptime:1516354574432 org_name:Uejsjak org_title:Hakosklaks]} {map[org_dept:Accounts org_eptime:1516354561184 org_name:Abcd org_title:Hakahkshsjs]}]\n    index :  phone  value :  [{map[]} {map[]}]\n</code></pre>\n"}, {"tags": ["json", "dictionary", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1516712216, "post_id": 48402325, "comment_id": 83792643, "body": "What have you tried? What problems did you run into?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1516714101, "post_id": 48402325, "comment_id": 83793933, "body": "Thank you for including the code. So what is the question? Your description seems to describe the expected behavior."}, {"owner": {"reputation": 188, "user_id": 1619419, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/12029d94faa0c11ef1bce35bb6fab559?s=128&d=identicon&r=PG", "display_name": "nitin jain", "link": "https://stackoverflow.com/users/1619419/nitin-jain"}, "edited": false, "score": 0, "creation_date": 1586436268, "post_id": 48402325, "comment_id": 108130780, "body": "Please Write Problem Statement Correctly. There is not understanding with this."}], "answers": [{"tags": [], "owner": {"reputation": 3312, "user_id": 4175960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QbvYc.png?s=128&g=1", "display_name": "Eddy Hernandez", "link": "https://stackoverflow.com/users/4175960/eddy-hernandez"}, "is_accepted": true, "score": 4, "last_activity_date": 1516717647, "last_edit_date": 1516717647, "creation_date": 1516714210, "answer_id": 48402944, "question_id": 48402325, "link": "https://stackoverflow.com/questions/48402325/how-to-unmarshal-struct-into-map-in-golang/48402944#48402944", "title": "How to unmarshal struct into map in golang", "body": "<p>Here is an example with marshal and unmarshal using your object definition</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n)\n\ntype MyObject struct {\n    ID      string         `json:\"id\"`\n    Name    string         `json:\"name\"`\n    Planets map[string]int `json:\"planets\"`\n}\n\nfunc main() {\n    aa := &amp;MyObject{\n        ID:   \"123\",\n        Name: \"pepe\",\n        Planets: map[string]int{\n            \"EARTH\": 3,\n            \"MARS\":  4,\n        },\n    }\n    // Marshal\n    out, err := json.Marshal(aa)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    fmt.Println(string(out))\n\n    // Unmarshal\n    bb := &amp;MyObject{}\n    err = json.Unmarshal(out, bb)\n    fmt.Println(bb.ID, bb.Name, bb.Planets)\n\n}\n</code></pre>\n\n\n\n<p>and you can get an element of the map with <code>bb.Planets[\"EARTH\"]</code></p>\n\n<p>I hope you can find this useful.</p>\n"}], "owner": {"reputation": 331, "user_id": 5951115, "user_type": "registered", "accept_rate": 75, "profile_image": "https://graph.facebook.com/1663324523956240/picture?type=large", "display_name": "oceankit", "link": "https://stackoverflow.com/users/5951115/oceankit"}, "delete_vote_count": 1, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4691, "favorite_count": 0, "closed_date": 1516714841, "accepted_answer_id": 48402944, "answer_count": 1, "score": -6, "last_activity_date": 1516717647, "creation_date": 1516712152, "last_edit_date": 1516713841, "question_id": 48402325, "link": "https://stackoverflow.com/questions/48402325/how-to-unmarshal-struct-into-map-in-golang", "closed_reason": "Not suitable for this site", "title": "How to unmarshal struct into map in golang", "body": "<p>I have a Json: </p>\n\n<pre><code>{\n  \"id\": \"me\",\n  \"name\": \"myname\",\n  \"planets\": {\n      \"EARTH\": 3,\n      \"MARS\": 4\n  }\n}\n</code></pre>\n\n<p>I don't know how to unmarshal planets field into map[string]int, so I'll get access to the elements without unmarshaling them too like in this example: <a href=\"https://stackoverflow.com/questions/11066946/partly-json-unmarshal-into-a-map-in-go\">json to map Golang</a></p>\n\n<p>Here is the code: </p>\n\n<pre><code>package main\n\nimport (\n   \"encoding/json\"\n   \"fmt\"\n  )\n\ntype User struct {\n   ID      string `json:\"id\"`\n   Name    string `json:\"name\"`\n   Planets struct {\n       Planet map[string]*json.RawMessage\n    } `json:\"planets\"`\n}\n\n func main() {\n    data := `{\n      \"id\": \"me\",\n      \"name\": \"myname\",\n      \"planets\": {\n      \"EARTH\": 3,\n       \"MARS\": 4\n      }\n    }`\n\n   user := &amp;User{}\n   err := json.Unmarshal([]byte(data), user)\n   if err != nil {\n       fmt.Println(\"ERROR \" + err.Error())\n   }\n    fmt.Println(user.ID)\n    fmt.Println(user.Planets.Planet[\"EARTH\"])\n  }\n</code></pre>\n\n<p>fmt.Println(user.Planets.Planet[\"EARTH\"]) - returns </p>\n\n<p>fmt.Println(user.Planets[\"EARTH\"]) - does not support indexing</p>\n"}, {"tags": ["database", "go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1516711720, "post_id": 48402047, "comment_id": 83792340, "body": "You can&#39;t commit the same transaction multiple times. You need to start new transaction, then commit/rollback. What is your intention of doing <i>timely commit</i>?"}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1516714147, "post_id": 48402047, "comment_id": 83793971, "body": "Hmmm, yeah that is what I saw. I would like to optimize http post requests as much as possible. In fact, manually grouping inserts by batches of 500 lead me to 200.000 inserts/seconds, while sequential  one-by-one inserts only reached 25.000 inserts/seconds... It&#39;s day Vs night. So I&#39;d like to have this grouping mechanism but I can&#39;t wait for 500 transactions to happen before commit, I need a timely mechanism like commiting every 10ms or so. Do you see another way around this ?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1516776912, "post_id": 48402047, "comment_id": 83822486, "body": "I summarized the idea in an additional answer."}], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516717621, "post_id": 48403976, "comment_id": 83796430, "body": "Why don&#39;t use a <code>time.Timer</code>? It has stop and reset so <code>tx.Commit</code> takes too long won&#39;t be a problem."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516718132, "post_id": 48403976, "comment_id": 83796793, "body": "Thanks, I forgot about <code>time.Timer</code>."}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "edited": false, "score": 0, "creation_date": 1516744746, "post_id": 48403976, "comment_id": 83812785, "body": "Sorry for late reply here, I was without internet access. I need to have this mechanism as a general rule for all my backend since the goal is to call the DB as few times as possible: eventually inserts should group more than 1 connected client ! Say I have 100 clients connected to the same API endpoint, I need to group all 100 clients insert values and make only one DB insert."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516745028, "post_id": 48403976, "comment_id": 83812895, "body": "Then instead of inserting individual data points, accumulate them and build a single insert at the end of the 10ms. Same overall logic, slightly different statements."}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "edited": false, "score": 0, "creation_date": 1516745349, "post_id": 48403976, "comment_id": 83813033, "body": "I may not see how to &quot;catch&quot; API calls and generally &quot;rate limit&quot; the inserts I guess. Let me throw an example: in a period of 1 second, say I receive 100.000 requests from 50.000 simultaneous users. I understand the code posted above will be instantiated 100.000 times, right ?"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516745479, "post_id": 48403976, "comment_id": 83813078, "body": "If you increase the timeout to 1s, it will do 100K requests, but the timeout is currently at the 10ms you mentioned above. The timeout is not between two incoming client requests, but the time from &quot;initialize transaction&quot; to &quot;commit transaction&quot;."}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "edited": false, "score": 0, "creation_date": 1516745667, "post_id": 48403976, "comment_id": 83813178, "body": "I think I got what you mean. Then the channel will be the central gateway for all incoming requests, passing jobs down to <code>transactionLoop()</code>, right ? The code above is called only once for the whole app, correct ?"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516745745, "post_id": 48403976, "comment_id": 83813215, "body": "That&#39;s correct. There&#39;s only one call to <code>go transactionLoop(inputChan)</code> in your entire app, and the request handlers all have access to <code>inputChan</code> and write data into it. This is exactly what channels are good for as they do their own synchronization."}, {"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "edited": false, "score": 0, "creation_date": 1516745875, "post_id": 48403976, "comment_id": 83813278, "body": "Cool, I&#39;ll test the code and see if i get the desired effect on insert perfs and post my findings here. Thanks for your assistance and patience :)"}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 0, "last_activity_date": 1516718107, "last_edit_date": 1516718107, "creation_date": 1516717272, "answer_id": 48403976, "question_id": 48402047, "link": "https://stackoverflow.com/questions/48402047/timely-commit-to-db-using-golang/48403976#48403976", "title": "Timely commit to DB using Golang", "body": "<p>You can do this using a goroutine that does the following:</p>\n\n<ul>\n<li>creates a new transaction and prepares statements</li>\n<li>continuously reads from an input channel (this receives the data from other parts of your program)</li>\n<li>times out after 10ms and commits the transaction, then creates a new one to accumulate more data</li>\n</ul>\n\n<p>This function could look something like:</p>\n\n<pre><code>func transactionLoop(input chan Data) {\n    tx := CreateNewTransaction() // This creates a new TX and prepares statements\n    timeout := time.NewTimer(time.Millisecond * 10)\n    for {\n        select {\n        case newData &lt;- input:\n            tx.Insert(newData)\n        case &lt;- timeout.C:\n            // Too much time has passed: commit and create new tx.\n            tx.Commit()\n            // Create new transaction and launch timer.\n            tx = CreateNewTransaction()\n            timeout.Reset(time.Millisecond * 10)\n        }\n    }\n}\n</code></pre>\n\n<p>This may do what you want, though there are quite a few details/problems left:</p>\n\n<ul>\n<li>there's absolutely no concept of passing errors back to the callers: <strong>this is a terrible idea</strong></li>\n<li>shouldn't commit empty transactions</li>\n<li>if both channels are ready at the same time, the order is random (should be fine)</li>\n<li>you may want to commit in another goroutine, though you could then run into trouble if your commits take longer than 10ms.</li>\n<li>I haven't tested this, just jotting things down</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "edited": false, "score": 0, "creation_date": 1516828532, "post_id": 48416449, "comment_id": 83854496, "body": "Just perfect. That is exactly what I needed and works like a charm after tweaking it to my use case. 1.000 thanks to you :)"}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 1, "last_activity_date": 1516776728, "creation_date": 1516776728, "answer_id": 48416449, "question_id": 48402047, "link": "https://stackoverflow.com/questions/48402047/timely-commit-to-db-using-golang/48416449#48416449", "title": "Timely commit to DB using Golang", "body": "<p>Optimization is not a trivial task and may also involving database tuning, etc. Without detail knowledge about the system that you're trying to implement, it is difficult to give a proper advice. In addition to what already suggested in the answer, you may need to implement a kind of <em>buffering</em>, e.g. with channel which has fixed capacity. Then when <em>buffer</em> is <code>FULL</code> or timer <code>EXPIRED</code>, build the query then perform BULK INSERT in transaction. Try it at <a href=\"https://play.golang.org/p/PrctKDXjM0-\" rel=\"nofollow noreferrer\">The Go Playground</a>.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype DataBuffer struct {\n    capacity int\n    duration time.Duration\n\n    incomingData chan interface{}\n    full chan bool\n    mustExit chan bool\n    done chan bool\n\n    query string\n    args []interface{}\n}\n\nfunc NewDataBuffer(capacity int, dur time.Duration) *DataBuffer {\n    buf := &amp;DataBuffer {\n        incomingData: make(chan interface{}, capacity),\n        full: make(chan bool),\n        args: make([]interface{}, capacity),\n        duration: dur,\n        mustExit: make(chan bool, 1),\n        done: make(chan bool, 1),\n    }\n    return buf\n}\n\nfunc (b *DataBuffer) Append(d interface{}) {\n    if !b.put(d) {\n        //Notify that buffer is full\n        //&lt;- will wait until space available\n        b.full &lt;- true\n        b.incomingData &lt;- d\n    }\n}\n\nfunc (b *DataBuffer) put(d interface{}) bool {\n    //Try to append the data\n    //If channel is full, do nothing, then return false\n    select {\n    case b.incomingData &lt;- d:\n        return true\n    default:\n        //channel is full\n        return false\n    }\n}\n\nfunc (b *DataBuffer) execTransaction() error {\n    /*\n        Begin transaction\n        Insert Data Group \n        Commit/rollback\n    */\n\n    fmt.Print(time.Now())\n    fmt.Println(b.query)\n    fmt.Println(b.args)\n\n    return nil\n}\n\nfunc (b *DataBuffer) clear() {\n    //clear args\n    nOldArg := len(b.args)\n    for k := 0; k &lt; nOldArg; k++ {\n        b.args[k] = nil\n    }\n    b.args = b.args[:0]\n    b.query = \"\"\n}\n\nfunc (b *DataBuffer) buildQuery() bool {\n    ndata := len(b.incomingData)\n    if ndata == 0 {\n        return false\n    }\n\n    k := 0\n    b.clear()\n\n    //Build the query, adjust as needed\n    b.query = \"QUERY:\"\n    for data := range b.incomingData {\n        b.query += fmt.Sprintf(\" q%d\", k) //build the query\n        b.args = append(b.args, data)\n\n        k++\n        if k &gt;= ndata {\n            break\n        }\n\n    }\n    return true\n}\n\nfunc (b *DataBuffer) doInsert() {\n    if b.buildQuery() {\n        b.execTransaction()\n    }\n}\n\nfunc (b *DataBuffer) runAsync() {\n    defer func() {\n        b.doInsert()\n        fmt.Println(\"Last insert\")\n        close(b.done)\n    }()\n\n    timer := time.NewTimer(b.duration)\n    for {\n        select {\n        case &lt;- timer.C:\n            b.doInsert()\n            fmt.Println(\"Timer Expired\")\n            timer.Reset(b.duration)\n        case &lt;- b.full:\n            if !timer.Stop() {\n                &lt;-timer.C\n            }\n            b.doInsert()\n            fmt.Println(\"Full\")\n            timer.Reset(b.duration)\n        case &lt;- b.mustExit:\n            if !timer.Stop() {\n                &lt;-timer.C\n            }\n            return  \n        }\n    }\n}\n\nfunc (b *DataBuffer) Run() {\n    go b.runAsync()\n}\nfunc (b *DataBuffer) Stop() {\n    b.mustExit &lt;- true\n}\n\nfunc (b *DataBuffer) WaitDone() {\n    &lt;- b.done\n}\n\nfunc main() {\n    buf := NewDataBuffer(5, 1*time.Second)\n    buf.Run()\n\n    //simulate incoming data\n    for k := 0; k &lt; 30; k++ {\n        buf.Append(k)\n        time.Sleep(time.Duration(10*k)*time.Millisecond)\n    }\n    buf.Stop()\n    buf.WaitDone()  \n}\n</code></pre>\n\n<p><strong>Note:</strong></p>\n\n<ul>\n<li>You need to implement proper error handling.</li>\n<li>The type of <code>incomingData</code> may be adjusted to your need</li>\n</ul>\n"}], "owner": {"reputation": 720, "user_id": 7959116, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/2747f6445647591a7a5ec9b45f58e33d?s=128&d=identicon&r=PG&f=1", "display_name": "Jona Rodrigues", "link": "https://stackoverflow.com/users/7959116/jona-rodrigues"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 265, "favorite_count": 0, "accepted_answer_id": 48416449, "answer_count": 2, "score": 0, "last_activity_date": 1516776728, "creation_date": 1516711326, "question_id": 48402047, "link": "https://stackoverflow.com/questions/48402047/timely-commit-to-db-using-golang", "title": "Timely commit to DB using Golang", "body": "<p>I successfully \"batched\" many statements in lots of 500-1000 rows to be Inserted at once. However this was using simple <code>for</code> loop and manually setting it to 500-1000 loops. Something like:</p>\n\n<pre><code>for i:=0;i&lt;500;i++ {\n   // Create a string of 500 values to be inserted at once\n}\n// Insert the 500 values\n</code></pre>\n\n<p>Is there a way I could timely <code>commit()</code> like: \"commit each seconds\" ?</p>\n\n<p>Conceptually, I'd like to have something like;</p>\n\n<pre><code>// Create connection to DB\n// Begin a transaction\n// Prepare a statement\n\ngo timelyCommits(tx)  // spawn a commit ticker\nfor {\n   // Constantly create string of values to be inserted like:\n   // Values (1, \"one\"),(2,\"two\"),(3,\"three\")...(1000,\"thousand\")...\n   // Insert without commit\n}\n\nfunc timelyCommits(tx){\n   for {\n      time.Sleep(1 * time.Second)\n      tx.Commit()\n   }\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-sqs", "aws-regions"], "comments": [{"owner": {"reputation": 31092, "user_id": 1715121, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/6nEEr.jpg?s=128&g=1", "display_name": "Ele", "link": "https://stackoverflow.com/users/1715121/ele"}, "edited": false, "score": 0, "creation_date": 1516702256, "post_id": 48398312, "comment_id": 83785839, "body": "No, it\u2019s not ok.  Try to put it into the SQS\u2019s message."}], "answers": [{"tags": [], "owner": {"reputation": 5466, "user_id": 2913439, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DsUu6.jpg?s=128&g=1", "display_name": "dkasipovic", "link": "https://stackoverflow.com/users/2913439/dkasipovic"}, "is_accepted": true, "score": 4, "last_activity_date": 1516700385, "creation_date": 1516700385, "answer_id": 48398452, "question_id": 48398312, "link": "https://stackoverflow.com/questions/48398312/is-it-okay-to-fetch-aws-region-from-sqs-url/48398452#48398452", "title": "Is it okay to fetch AWS region from SQS url?", "body": "<p>Cited from here: <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-queue-message-identifiers.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-queue-message-identifiers.html</a></p>\n\n<blockquote>\n  <p><strong>Important</strong></p>\n  \n  <p>In your system, always store the entire queue URL exactly as Amazon\n  SQS returns it to you when you create the queue (for example,\n  <a href=\"http://sqs.us-east-2.amazonaws.com/123456789012/queue2\" rel=\"nofollow noreferrer\">http://sqs.us-east-2.amazonaws.com/123456789012/queue2</a>). Don't build\n  the queue URL from its separate components each time you need to\n  specify the queue URL in a request because Amazon SQS can change the\n  components that make up the queue URL.</p>\n</blockquote>\n\n<p>As explained, they can change the structure of the URL sometimes in the future for whatever reason. Queue region will probably still stay <em>somewhere</em> in the url, but not necessarily in the spot that you expect it to be.</p>\n\n<p>So, all thinks considered, I think that introducing new environment variable is the right way to go.</p>\n"}, {"tags": [], "owner": {"reputation": 138098, "user_id": 1695906, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/638d2ec6b52f3db1583890be23d74cc6?s=128&d=identicon&r=PG", "display_name": "Michael - sqlbot", "link": "https://stackoverflow.com/users/1695906/michael-sqlbot"}, "is_accepted": false, "score": 3, "last_activity_date": 1516750965, "creation_date": 1516750965, "answer_id": 48412657, "question_id": 48398312, "link": "https://stackoverflow.com/questions/48398312/is-it-okay-to-fetch-aws-region-from-sqs-url/48412657#48412657", "title": "Is it okay to fetch AWS region from SQS url?", "body": "<p>Yes, it should be perfectly safe to extract the region from the queue URL.</p>\n\n<p>The <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/latest/SQSDeveloperGuide/sqs-queue-message-identifiers.html\" rel=\"nofollow noreferrer\">documented recommendation</a> cited elsewhere <strong>does not</strong> say that it isn't safe to <em>deconstruct</em> a queue URL into its components, but rather recommends against <em>constructing</em> a queue URL from its component parts.  The admonition is to store the entire URL.  There is no recommendation not to parse it at all.</p>\n\n<blockquote>\n  <p>In your system, always store the entire queue URL exactly as Amazon SQS returns it to you when you create the queue </p>\n</blockquote>\n\n<p>The hostname portion of the URL is quite deterministic, and the <a href=\"https://docs.aws.amazon.com/general/latest/gr/rande.html#sqs_region\" rel=\"nofollow noreferrer\">regional endpoints for SQS</a> are very consistently <code>sqs.${region}.amazonaws.com</code>.</p>\n\n<p>There is no obvious reason <em>not</em> to rely on the hostname for determining the region.  AWS <em>rarely</em> changes endpoint hostnames and in the few instances that they have, it has been to make them more predictable.  Meanwhile, the old ones are still quietly there -- for example, <a href=\"https://docs.aws.amazon.com/AWSSimpleQueueService/2009-02-01/SQSDeveloperGuide/index.html?endpoints.html\" rel=\"nofollow noreferrer\">the original endpoints</a>, such as <code>queue.amazonaws.com</code> and <code>us-west-1.queue.amazonaws.com</code> are still active and appear to be fully functional even though these were officially replaced by <code>sqs.us-[east | west]-1.amazonaws.com</code>.   AWS has more recently been more consistent and hierarchical with endpoint conventions, but in doing so, they have not broken older clients where these values are hard-coded.</p>\n"}, {"tags": [], "owner": {"reputation": 4161, "user_id": 4388776, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Nj4WL.jpg?s=128&g=1", "display_name": "Keet Sugathadasa", "link": "https://stackoverflow.com/users/4388776/keet-sugathadasa"}, "is_accepted": false, "score": 1, "last_activity_date": 1536683873, "creation_date": 1536683873, "answer_id": 52280536, "question_id": 48398312, "link": "https://stackoverflow.com/questions/48398312/is-it-okay-to-fetch-aws-region-from-sqs-url/52280536#52280536", "title": "Is it okay to fetch AWS region from SQS url?", "body": "<p>If I understand this correctly, the question asks whether it is okay to extract the AWS Region from the SQS URL...</p>\n\n<p>An Easy answer would be YES. But I <strong>DO NOT Recommend</strong> this. </p>\n\n<p><strong>Firstly</strong>, extracting the Region from a fixed SQS URL which is saved in the config file is just an additional processing. Since it is already stored in the Config file, we can specify the AWS-region in the Config file as well, because the region that we work in won't change dynamically unless we decide to change it manually. If you look at <a href=\"https://docs.aws.amazon.com/cli/latest/userguide/cli-config-files.html\" rel=\"nofollow noreferrer\">this documentation</a>, the AWS Region is generally saved in the config file for better maintainability.</p>\n\n<p><strong>Second</strong>, using a split to extract the region from a String is implausible. It is like trying to hack things around to get what you need. This is not a good coding practice.</p>\n\n<p><strong>Third</strong>, what you have given above is the AWS SQS Endpoint for a specific queue. Read <a href=\"https://docs.aws.amazon.com/general/latest/gr/rande.html\" rel=\"nofollow noreferrer\">this documentation</a> and understand the structure of AWS endpoints. The AWS endpoints don't always contain the region in it, within the Sting structure. It's always a best practice to maintain a separate parameter in the config file for the AWS Region.</p>\n\n<blockquote>\n  <p>Some services, such as IAM, do not support regions; therefore, their\n  endpoints do not include a region. Some services, such as Amazon EC2,\n  let you specify an endpoint that does not include a specific region,\n  for example, <a href=\"https://ec2.amazonaws.com\" rel=\"nofollow noreferrer\">https://ec2.amazonaws.com</a>. In that case, AWS routes the\n  endpoint to us-east-1.</p>\n</blockquote>\n"}], "owner": {"reputation": 6265, "user_id": 3387925, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/mtLre.jpg?s=128&g=1", "display_name": "Mayank Patel", "link": "https://stackoverflow.com/users/3387925/mayank-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1335, "favorite_count": 1, "accepted_answer_id": 48398452, "answer_count": 3, "score": 4, "last_activity_date": 1547925112, "creation_date": 1516699990, "last_edit_date": 1547925112, "question_id": 48398312, "link": "https://stackoverflow.com/questions/48398312/is-it-okay-to-fetch-aws-region-from-sqs-url", "title": "Is it okay to fetch AWS region from SQS url?", "body": "<p>I have an SQS URL which includes region as well. I am using official Go SDK to perform operations on this SQS which require AWS region to initialize the session. Currently, I have written a utility function to parse the URL and return AWS region.</p>\n\n<p>Sample URL: <code>https://sqs.us-east-1.amazonaws.com/774557911234/my_sqs_name</code></p>\n\n<p>Sample Initialization code:</p>\n\n<pre><code>sess, err := session.NewSession()\nif err != nil {\n    return\n}\n\ns := sqs.New(sess, aws.NewConfig().WithRegion(getRegionFromSQSURL(config.SQSURL))\n</code></pre>\n\n<p>Sample function to get region from URL</p>\n\n<pre><code>func getRegionFromSQSURL(url string) string {\n    return strings.Split(url, \".\")[1]\n}\n</code></pre>\n\n<p>Just wondering if this is the correct approach. </p>\n\n<p>Would there be any case where SQS URL will have a different region in URL than the region in which SQS exists? </p>\n\n<p>Should I just add one more environment variable to be set in the service?</p>\n"}, {"tags": ["go", "amazon-dynamodb"], "answers": [{"comments": [{"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1516812743, "post_id": 48399860, "comment_id": 83845736, "body": "&quot;With&quot;. Tell it to delete from the main-table using a hash/hash-and-range lookup against one of its GSIs."}], "tags": [], "owner": {"reputation": 6340, "user_id": 2811189, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/Pf5Ka.png?s=128&g=1", "display_name": "Harshal Bulsara", "link": "https://stackoverflow.com/users/2811189/harshal-bulsara"}, "is_accepted": false, "score": -1, "last_activity_date": 1516704668, "creation_date": 1516704668, "answer_id": 48399860, "question_id": 48397008, "link": "https://stackoverflow.com/questions/48397008/possible-to-delete-with-a-global-secondary-index/48399860#48399860", "title": "Possible to delete with a global secondary index?", "body": "<p>As of now, you cannot delete items from GSI, In order to remove an item from the GSI it needs to be removed from the main table.</p>\n\n<p>By default, the keys(hash or hash &amp; range) are always projected into your index so you have to collect and pass those attributes in order to delete it.</p>\n\n<p>If you look the indexes are just the images of the table which are just read-only.</p>\n\n<p>To conclude, You cannot delete from an index and reflect in the main table.  </p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1302, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516704668, "creation_date": 1516695462, "last_edit_date": 1516697503, "question_id": 48397008, "link": "https://stackoverflow.com/questions/48397008/possible-to-delete-with-a-global-secondary-index", "title": "Possible to delete with a global secondary index?", "body": "<p>If I don't have the key-attribute values but can hit a global secondary index, must I project the key-values <em>into</em> the GSI and <em>then use</em> that/those with the normal key-based delete (DeleteItem) afterward?</p>\n\n<p>Clearly pruning an item from the table will induce any corresponding records to be removed from any secondary indices, so my [faulty?] assumption was the delete could work in reverse (delete in the GSI induces a delete on the table).</p>\n"}, {"tags": ["mysql", "go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6185061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08753fb5426d563495063581b3569aca?s=128&d=identicon&r=PG&f=1", "display_name": "Adhithya K R", "link": "https://stackoverflow.com/users/6185061/adhithya-k-r"}, "edited": false, "score": 0, "creation_date": 1516775960, "post_id": 48397085, "comment_id": 83822034, "body": "Also necessary to modify the second argument to sqlx.Open as &quot;tx81:@tcp(127.0.0.1:3306)/policies?parseTime=true&quot;. The manager object needs to be declared outside the warden object initialization to call CreateSchemas."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 0, "last_activity_date": 1516695742, "creation_date": 1516695742, "answer_id": 48397085, "question_id": 48396854, "link": "https://stackoverflow.com/questions/48396854/ory-ladon-manager-with-golang-tables-not-created/48397085#48397085", "title": "ory/ladon manager with golang - Tables not created", "body": "<p>You need to call <a href=\"https://godoc.org/github.com/ory/ladon/manager/sql#SQLManager.CreateSchemas\" rel=\"nofollow noreferrer\">manager.CreateSchemas</a>, which is never done by the manager itself.</p>\n\n<p>You provide it with the schema name (postgresql only I believe) and table name to keep track of migration info.</p>\n\n<p>eg:</p>\n\n<pre><code>if num, err := m.CreateSchemas(\"\", \"my_migration_table\"); err != nil {\n  panic(err)\n} else {\n  log.Infof(\"ran %d migrations\", num)\n}\n</code></pre>\n\n<p>It could probably use more documentation, you may want to file an issue with the author.</p>\n"}], "owner": {"reputation": 1, "user_id": 6185061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/08753fb5426d563495063581b3569aca?s=128&d=identicon&r=PG&f=1", "display_name": "Adhithya K R", "link": "https://stackoverflow.com/users/6185061/adhithya-k-r"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 0, "accepted_answer_id": 48397085, "answer_count": 1, "score": 0, "last_activity_date": 1516702685, "creation_date": 1516694811, "last_edit_date": 1516702685, "question_id": 48396854, "link": "https://stackoverflow.com/questions/48396854/ory-ladon-manager-with-golang-tables-not-created", "title": "ory/ladon manager with golang - Tables not created", "body": "<p>github.com/ory/ladon is a library to manage role based access, written in golang. It contains a manager that is supposed to persist policies in the database and work with the database. The manager works fine for the in-memory case. When I use the manager to interface with sql, the required tables are not getting created.</p>\n\n<pre><code>db, err := sqlx.Open(\"mysql\", \"tx81:@tcp(127.0.0.1:3306)/policies\")\n......\nerr=db.Ping()\nif err == nil {\n    fmt.Printf(\"Database is up\")\n}\n\nwarden := ladon.Ladon{\n    Manager: manager.NewSQLManager(db, nil),\n}\n\nvar pol = &amp;ladon.DefaultPolicy{\n    ......\n}\nerr = warden.Manager.Create(pol)\nfmt.Printf(\"%s\", err)\n</code></pre>\n\n<p>The error is printed as:</p>\n\n<blockquote>\n  <p>Table 'policies.ladon_policy' doesn't exist.</p>\n</blockquote>\n\n<p>Why aren't the tables getting created?</p>\n\n<p>Resources: <a href=\"https://github.com/ory/ladon#persistence\" rel=\"nofollow noreferrer\">https://github.com/ory/ladon#persistence</a></p>\n"}, {"tags": ["go", "client", "grpc"], "comments": [{"owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "edited": false, "score": 1, "creation_date": 1516683534, "post_id": 48394447, "comment_id": 83776555, "body": "gRPC starts every request in a goroutine. if the number of incoming rpc requests increases, so is the goroutines. I would suggest you take a look at your rpc function to minimise your latency."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1516693350, "post_id": 48394447, "comment_id": 83780432, "body": "This sounds like an XY problem. Why are you concerned about the number of go routines? What is your <i>actual</i> problem?"}, {"owner": {"reputation": 346, "user_id": 7401775, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/79fae12e436469518f605824de67925b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Lin", "link": "https://stackoverflow.com/users/7401775/joe-lin"}, "edited": false, "score": 0, "creation_date": 1516743816, "post_id": 48394447, "comment_id": 83812337, "body": "The actual problem is that as  vedhavyas described, gRPC starts a new goroutine for every request. When the latency is high my goroutine number just keeps piling up. I guess the real problem is in the latency of the rpc call itself. Just out of curiosity, I wonder what is the behavior on C++ gRPC client. Does it have some sort of thread pooling?"}], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": false, "score": 1, "last_activity_date": 1516693971, "creation_date": 1516693971, "answer_id": 48396665, "question_id": 48394447, "link": "https://stackoverflow.com/questions/48394447/how-to-constrain-gos-grpc-go-routine-number/48396665#48396665", "title": "How to constrain Go&#39;s grpc go routine number", "body": "<p>If your question is how to limit grpc goroutines, there is no way, but I doubt there is any point in limiting goroutine number. What if you reached your limit and another request come? </p>\n\n<p>You could use a semaphore like pattern at the beginning of your handler so you limit to N concurrent requests. Additional requests will wait for other requests to finish before they start processing (But there is more that N goroutines, only N of them are working).</p>\n\n<p><a href=\"http://www.golangpatterns.info/concurrency/semaphores\" rel=\"nofollow noreferrer\">Here</a> is an implementation of semaphores using channel.</p>\n"}], "owner": {"reputation": 346, "user_id": 7401775, "user_type": "registered", "accept_rate": 9, "profile_image": "https://www.gravatar.com/avatar/79fae12e436469518f605824de67925b?s=128&d=identicon&r=PG&f=1", "display_name": "Joe Lin", "link": "https://stackoverflow.com/users/7401775/joe-lin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 810, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1516693971, "creation_date": 1516683026, "question_id": 48394447, "link": "https://stackoverflow.com/questions/48394447/how-to-constrain-gos-grpc-go-routine-number", "title": "How to constrain Go&#39;s grpc go routine number", "body": "<p>Is there anyway that I can constrain the number of go routines in grpc client? I have a go application that uses grpc client and I found that there are quite a few amount of go routines being created and kept growing.\nThanks for any help.</p>\n"}, {"tags": ["docker", "go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 0, "creation_date": 1516690026, "post_id": 48393899, "comment_id": 83778907, "body": "you can always compile the binary outside of the container and COPY it, I prefer this way, your docker images will get very small if you use <b>alpine</b> and it saves you from a lot of time and configurations"}], "answers": [{"comments": [{"owner": {"reputation": 1242, "user_id": 804707, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/af86b492c2772884b20791e8298595d9?s=128&d=identicon&r=PG", "display_name": "The Puma", "link": "https://stackoverflow.com/users/804707/the-puma"}, "edited": false, "score": 0, "creation_date": 1516707040, "post_id": 48399042, "comment_id": 83789153, "body": "Good call, that seems obvious now that I&#39;m looking at it. Thanks!"}], "tags": [], "owner": {"reputation": 3095, "user_id": 178597, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/13148e76e55c7429e663480dc900bf77?s=128&d=identicon&r=PG", "display_name": "Christian", "link": "https://stackoverflow.com/users/178597/christian"}, "is_accepted": true, "score": 2, "last_activity_date": 1516702148, "creation_date": 1516702148, "answer_id": 48399042, "question_id": 48393899, "link": "https://stackoverflow.com/questions/48393899/os-lstat-is-failing-in-a-mounted-volume-on-an-ubuntu-based-docker-container/48399042#48399042", "title": "os.Lstat is failing in a mounted volume on an ubuntu-based Docker container", "body": "<p>It looks like you have the bindata call declared in your Dockerfile. With the RUN prefix it's executed during build of the container when there is no volume yet mounted. If you use the CMD prefix it will run during execution of the container, then the volume is mounted and it should work.</p>\n"}], "owner": {"reputation": 1242, "user_id": 804707, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/af86b492c2772884b20791e8298595d9?s=128&d=identicon&r=PG", "display_name": "The Puma", "link": "https://stackoverflow.com/users/804707/the-puma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 153, "favorite_count": 0, "accepted_answer_id": 48399042, "answer_count": 1, "score": 0, "last_activity_date": 1516702148, "creation_date": 1516679321, "last_edit_date": 1516681050, "question_id": 48393899, "link": "https://stackoverflow.com/questions/48393899/os-lstat-is-failing-in-a-mounted-volume-on-an-ubuntu-based-docker-container", "title": "os.Lstat is failing in a mounted volume on an ubuntu-based Docker container", "body": "<p>I have a docker container that uses <code>go-bindata</code> to compile a config. I run the docker container with</p>\n\n<pre><code>docker run -id \\\n    -v conf:/conf \\\n    -e CONF=\"/conf\" \\\n    my-container\n</code></pre>\n\n<p>Then in the docker container, I install go-bindata, and run</p>\n\n<pre><code>RUN go-bindata -prefix $CONF -o $GOPATH/src/github.com/my/repo/dir/conf_generated.go $CW_CONF/config\n</code></pre>\n\n<p>And the output is </p>\n\n<pre><code>bindata: Failed to stat input path '/conf/config': lstat /conf/config: no such file or directory\n</code></pre>\n\n<p><a href=\"https://github.com/jteeuwen/go-bindata/blob/master/config.go#L165\" rel=\"nofollow noreferrer\">This</a> is the line that is causing the error. It is odd because when I enter the container and run the same command, it works. <code>stat /conf/config</code> also works (it knows the file is there). What is going on here? Why doesn't the install line work when the container is building?</p>\n"}, {"tags": ["go", "tensorflow", "tensorflow-serving"], "comments": [{"owner": {"reputation": 3984, "user_id": 4121573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kxnXk.png?s=128&g=1", "display_name": "Adonis", "link": "https://stackoverflow.com/users/4121573/adonis"}, "edited": false, "score": 0, "creation_date": 1516714981, "post_id": 48393098, "comment_id": 83794547, "body": "The best I see from the doc is <a href=\"https://godoc.org/github.com/tensorflow/tensorflow/tensorflow/go#Tensor.WriteContentsTo\" rel=\"nofollow noreferrer\">this</a>"}, {"owner": {"reputation": 61, "user_id": 2559675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4038db3a6129e26dab92aa1d475dc35?s=128&d=identicon&r=PG", "display_name": "Roy J.Swagger", "link": "https://stackoverflow.com/users/2559675/roy-j-swagger"}, "reply_to_user": {"reputation": 3984, "user_id": 4121573, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kxnXk.png?s=128&g=1", "display_name": "Adonis", "link": "https://stackoverflow.com/users/4121573/adonis"}, "edited": false, "score": 0, "creation_date": 1516759343, "post_id": 48393098, "comment_id": 83817405, "body": "@Adonis thanks for you reply. It seems the <code>WriteContentsTo</code> api just writes the serialized contents of tensor to an <code>io.Writer</code>, but not in a <a href=\"https://github.com/tensorflow/tensorflow/blob/r1.4/tensorflow/core/example/example.proto\" rel=\"nofollow noreferrer\">tf.train.Example</a> format."}], "answers": [{"comments": [{"owner": {"reputation": 61, "user_id": 2559675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4038db3a6129e26dab92aa1d475dc35?s=128&d=identicon&r=PG", "display_name": "Roy J.Swagger", "link": "https://stackoverflow.com/users/2559675/roy-j-swagger"}, "edited": false, "score": 0, "creation_date": 1516842267, "post_id": 48430883, "comment_id": 83859688, "body": "hi ash, thanks for your reply. i get your point. that is exactly what i need."}], "tags": [], "owner": {"reputation": 5655, "user_id": 6708503, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b6830ee25bc34994df9835cc17b64aa?s=128&d=identicon&r=PG&f=1", "display_name": "ash", "link": "https://stackoverflow.com/users/6708503/ash"}, "is_accepted": false, "score": 2, "last_activity_date": 1516824938, "creation_date": 1516824938, "answer_id": 48430883, "question_id": 48393098, "link": "https://stackoverflow.com/questions/48393098/how-to-convert-data-to-a-serialized-tf-exampletensorflow-tfrecords-using-golan/48430883#48430883", "title": "How to convert data to a serialized tf.Example(tensorflow tfrecords) using Golang", "body": "<p><code>tf.Example</code> refers to a protocol buffer, while <code>tfrecords</code> typically refers to a file format which stores \"records\" in the form of strings (which is why <a href=\"https://www.tensorflow.org/api_docs/python/tf/python_io/TFRecordWriter#write\" rel=\"nofollow noreferrer\"><code>tf.python_io.TFRecordWriter.write()</code></a> takes a string). So the two are separate things, not technically related. Though often one serializes <code>tf.Example</code> protocol buffers into a strings, one each per records in a <code>TFRecordWriter</code>.</p>\n\n<p>That said, it is common for models to take as input a serialized <code>tf.Example</code> protocol buffer as input in the form of a <code>STRING</code> tensor. If that is the case, then you'd want to construct the <code>tf.Example</code> protocol buffer in Go and then use <a href=\"https://godoc.org/github.com/golang/protobuf/proto#Marshal\" rel=\"nofollow noreferrer\"><code>proto.Marshal</code></a> to construct the <code>tf.Tensor</code> object to feed.</p>\n\n<p>Unfortunately, as of January 2018, you have to generate the Go files for the <code>tf.Example</code> protos yourself. That can be done with something like:</p>\n\n<pre><code># Fetch the tools\nGOPATH=$(go env GOPATH)\ngo get github.com/golang/protobuf/proto\ngo get github.com/golang/protobuf/protoc-gen-go\n\n# Create a directory to generate the files\nmkdir -p /tmp/protos/out\ncd /tmp/protos\n\n# Clone the TensorFlow sources to get the source .proto files\ngit clone https://github.com/tensorflow/tensorflow ./src\nPATH=$PATH:${GOPATH}/bin\n\n# Generate Go source files from the .proto files.\n# Assuming protoc is installed.\n# See https://github.com/google/protobuf/releases\nprotoc \\\n  -I ./src \\\n  --go_out ./out \\\n  ./src/tensorflow/core/framework/*.proto ./src/tensorflow/core/example/*.proto\nrm -rf ./src\n</code></pre>\n\n<p>This will generate a bunch of <code>.pb.go</code> files in <code>/tmp/protos/out</code> which can be used to build the <code>tf.Example</code> protocol buffer structures to marshal.</p>\n\n<p>Hope that gives you enough information to get going.</p>\n"}, {"tags": [], "owner": {"reputation": 301, "user_id": 4747748, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6edc7cc963d233773c30d81b360143c?s=128&d=identicon&r=PG&f=1", "display_name": "Tomek", "link": "https://stackoverflow.com/users/4747748/tomek"}, "is_accepted": false, "score": 0, "last_activity_date": 1602842278, "creation_date": 1602842278, "answer_id": 64386961, "question_id": 48393098, "link": "https://stackoverflow.com/questions/48393098/how-to-convert-data-to-a-serialized-tf-exampletensorflow-tfrecords-using-golan/64386961#64386961", "title": "How to convert data to a serialized tf.Example(tensorflow tfrecords) using Golang", "body": "<p>For anyone still interested in interacting with <code>TFRecords</code> and <code>tf.data.Example</code>, there exists a library, created by NVIDIA, with MIT licence, called <em>go-tfdata</em>: <a href=\"https://github.com/NVIDIA/go-tfdata\" rel=\"nofollow noreferrer\">https://github.com/NVIDIA/go-tfdata</a></p>\n<p>It can transform any source of records/samples into set of <code>tf.data.Example</code> - <code>TFRecord</code> file.</p>\n<p>Additionally, it natively supports TAR archives to TFRecord conversion.</p>\n<p>From examples - converting TAR to TFRecord is as simple as:</p>\n<pre><code>pipeline := NewPipeline().FromTar(inFile).SampleToTFExample().ToTFRecord(outFile)\npipeline.Do()\n</code></pre>\n"}], "owner": {"reputation": 61, "user_id": 2559675, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4038db3a6129e26dab92aa1d475dc35?s=128&d=identicon&r=PG", "display_name": "Roy J.Swagger", "link": "https://stackoverflow.com/users/2559675/roy-j-swagger"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1422, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1602842278, "creation_date": 1516673038, "question_id": 48393098, "link": "https://stackoverflow.com/questions/48393098/how-to-convert-data-to-a-serialized-tf-exampletensorflow-tfrecords-using-golan", "title": "How to convert data to a serialized tf.Example(tensorflow tfrecords) using Golang", "body": "<p>Is there a Golang API to convert data to a serialized tf.Example, also known as tensorflow tfrecords.</p>\n\n<p>I can find a Python api <code>tf.python_io.TFRecordWriter()</code> to achieve this. </p>\n\n<p>But examples with golang can not be found.</p>\n\n<p>I want do this coz i use a golang client to call the tensorflow serving and my input feature for nn is a SparseTensor.</p>\n"}, {"tags": ["go", "ecdsa"], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 1, "last_activity_date": 1516703617, "last_edit_date": 1516703617, "creation_date": 1516693577, "answer_id": 48396570, "question_id": 48392334, "link": "https://stackoverflow.com/questions/48392334/how-to-sign-a-message-with-an-ecdsa-string-privatekey/48396570#48396570", "title": "How to sign a message with an ECDSA string privateKey", "body": "<p>You can parse DER-encoded elliptic curve private keys using the standard library's <a href=\"https://golang.org/pkg/crypto/x509/#ParseECPrivateKey\" rel=\"nofollow noreferrer\">x509.ParseECPrivateKey</a>.</p>\n\n<pre><code>derKey := []byte(keyString)\nprivKey, err := x509.ParseECPrivateKey(derKey)\nif err != nil {\n  panic(err)\n}\nsignedMsg, err := privKey.Sign(randReader, msg, otps)\n</code></pre>\n\n<p>If your key is in PEM format, you must first decode it using <a href=\"https://golang.org/pkg/encoding/pem/#Decode\" rel=\"nofollow noreferrer\">pem.Decode</a>:</p>\n\n<pre><code>var block *pem.Block\nif block, _ = pem.Decode([]byte(keyString)); block == nil {\n    panic(\"expected pem block\")\n}\nprivKey, err := x509.ParseECPrivateKey(block.Bytes)\n// etc... the rest is the same\n</code></pre>\n"}], "owner": {"reputation": 147, "user_id": 4318016, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/892416dd8cea26aed3ddf8157a91e095?s=128&d=identicon&r=PG&f=1", "display_name": "xikimay", "link": "https://stackoverflow.com/users/4318016/xikimay"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1126, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1516703617, "creation_date": 1516666895, "last_edit_date": 1516702754, "question_id": 48392334, "link": "https://stackoverflow.com/questions/48392334/how-to-sign-a-message-with-an-ecdsa-string-privatekey", "title": "How to sign a message with an ECDSA string privateKey", "body": "<p>I'm trying to sign a message with an ECDSA <code>privateKey</code> but with a type string.\nThe problem is in order to sign the message I need to use the \"Sign\" method from the <code>ecdsa</code> package.</p>\n\n<pre><code>func (priv *PrivateKey) Sign(rand io.Reader, msg []byte, opts crypto.SignerOpts) ([]byte, error)\n</code></pre>\n\n<p>This method can only take a <code>PrivateKey</code> type.\nHow can I convert my string private key to this type? Or is another method available ?</p>\n"}, {"tags": ["docker", "go", "stdout"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516664777, "post_id": 48391998, "comment_id": 83771966, "body": "What exactly do you intend to do with <code>fmt</code>? If you want to stream the log output in &quot;real time&quot;, you need to copy the stream to an <code>io.Writer</code>, just like you already are."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516664868, "post_id": 48391998, "comment_id": 83771982, "body": "I do not want to do anything, I just want the data to come in and for me to have the ability to send the message through a websocket"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516665329, "post_id": 48391998, "comment_id": 83772093, "body": "Why does it need to be printed with <code>fmt</code>? You&#39;ve already shown the correct way using <code>io.Copy</code>. I don&#39;t understand what goal here when you start by asking &quot;how can I print the output with <code>fmt</code>?&quot;,  and then say &quot;I do not want to do anything [with fmt]&quot;."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516665478, "post_id": 48391998, "comment_id": 83772141, "body": "I just want to receive the output as it comes and send it using a websocket not to the console. What I have now just sends it to the console, but I want it going through a websocket. The first step is to get the output data as a string. (that is my issue)"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1516665674, "post_id": 48391998, "comment_id": 83772183, "body": "I don&#39;t see any websocket code.  What have you tried so far?   How do you want to map the stream of bytes from the container to the websocket messages?  Do you want one line per message, or something else?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "edited": false, "score": 0, "creation_date": 1516665846, "post_id": 48391998, "comment_id": 83772240, "body": "I want one line per message, I have not done the websocket stuff yet. My goal is to get the message to come across as a string. Kind of like this in node.js` *.stdout.on(&#39;data&#39;, data =&gt; {     console.log(data);  });`"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516666007, "post_id": 48391998, "comment_id": 83772293, "body": "Read lines from the container and write to the websocket using conn.WriteMessage."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516666083, "post_id": 48391998, "comment_id": 83772314, "body": "@CeriseLim&#243;n The issue is that I do not know how to get the logs line by line... I am quite new to Golang."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1516666189, "post_id": 48391998, "comment_id": 83772341, "body": "Use a <a href=\"https://godoc.org/bufio#Scanner\" rel=\"nofollow noreferrer\">Scanner</a> to read line by line."}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "edited": false, "score": 0, "creation_date": 1516715399, "post_id": 48397628, "comment_id": 83794884, "body": "This is what I got: <code>&amp;{body:0xc0422b4580 mu:{state:0 sema:0} closed:false rerr:&lt;nil&gt; fn:0x641660 earlyCloseFn:0x641600}</code>"}], "tags": [], "owner": {"reputation": 1509, "user_id": 1093694, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4hdHu.jpg?s=128&g=1", "display_name": "Lupus", "link": "https://stackoverflow.com/users/1093694/lupus"}, "is_accepted": false, "score": 0, "last_activity_date": 1516697760, "creation_date": 1516697760, "answer_id": 48397628, "question_id": 48391998, "link": "https://stackoverflow.com/questions/48391998/how-can-i-get-docker-container-output-through-a-websocket/48397628#48397628", "title": "How can I get Docker container output through a websocket?", "body": "<p><code>&amp;{0xc0422a65c0 {0 0} false &lt;nil&gt; 0x6415a0 0x641540}</code> is not a bad output. This is a perfectly fine struct output. I think the the main problem is here just your lack of golang experience. </p>\n\n<p>I'm a beginner as well and I can imagine that when you see an output like above you thought that \"I made a mistake\"</p>\n\n<p>No you didn't. It's default <code>fmt</code> behavior when u try to print out a struct which contains pointers.</p>\n\n<p>Checkout this instead of your <code>fmt.Println</code>:</p>\n\n<pre><code>fmt.Printf(\"%+v\\n\", out)\n</code></pre>\n\n<p>Well this answer stands on my assumptions but if this is the case just ping me for more info.</p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516718108, "post_id": 48403385, "comment_id": 83796773, "body": "<code>bufio.ScanLines</code> is the default, you don&#39;t need to set it."}, {"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516718879, "post_id": 48403385, "comment_id": 83797331, "body": "Oh, i&#39;ll fix that."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "is_accepted": true, "score": 1, "last_activity_date": 1516715525, "creation_date": 1516715525, "answer_id": 48403385, "question_id": 48391998, "link": "https://stackoverflow.com/questions/48391998/how-can-i-get-docker-container-output-through-a-websocket/48403385#48403385", "title": "How can I get Docker container output through a websocket?", "body": "<p>This seems to be the answer to my question, I did some searching about scanners as Cerise Lim\u00f3n commented. Anyone else who seems to be having the issue that I did can use this code. Thanks to all that helped.</p>\n\n<pre><code>scanner := bufio.NewScanner(out)\nscanner.Split(bufio.ScanLines)\nfor scanner.Scan() {\n    fmt.Println(scanner.Text())\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 1, "accepted_answer_id": 48403385, "answer_count": 2, "score": 0, "last_activity_date": 1516715525, "creation_date": 1516664563, "last_edit_date": 1516665500, "question_id": 48391998, "link": "https://stackoverflow.com/questions/48391998/how-can-i-get-docker-container-output-through-a-websocket", "title": "How can I get Docker container output through a websocket?", "body": "<p><br/>\nI am trying to send output from a docker container to the console using <code>fmt</code>, but when trying to do it i get this.<br/></p>\n\n<pre><code>&amp;{0xc0422a65c0 {0 0} false &lt;nil&gt; 0x6415a0 0x641540}\n</code></pre>\n\n<p>How do I do this? This is my full code.</p>\n\n<pre><code>func main() {\n    imageName := \"hidden/hidden\"\n\nctx := context.Background()\n\ncli, err := client.NewClient(\"tcp://0.0.0.0:0000\", \"v0.00\", nil, nil)\nif err != nil {\n    panic(err)\n}\n\nfmt.Println(\"Pulling \\\"\" + imageName + \"\\\"\")\n_, err = cli.ImagePull(ctx, imageName, types.ImagePullOptions{})\nif err != nil {\n    panic(err)\n}\n\ncontainerConfig := &amp;container.Config{\n    Image: imageName,\n    Cmd: []string{\"./app/start.sh\", \"--no-wizard\"},\n}\n\nresp, err := cli.ContainerCreate(ctx, containerConfig, nil, nil, \"\")\nif err != nil {\n    panic(err)\n}\n\nif err := cli.ContainerStart(ctx, resp.ID, types.ContainerStartOptions{}); err != nil {\n    panic(err)\n}\n\ntimer := time.NewTimer(time.Minute)\ngo func() {\n    &lt;-timer.C\n    if err := cli.ContainerStop(ctx, resp.ID, nil); err != nil {\n        panic(err)\n    }\n}()\n\nout, err := cli.ContainerLogs(ctx, resp.ID, types.ContainerLogsOptions{ShowStdout: true, ShowStderr: true, Follow: true})\nif err != nil {\n    panic(err)\n}\n\nio.Copy(os.Stdout, out) // This is what I want to change to print with \"fmt\".\n}\n</code></pre>\n\n<p>Tried: (but does not display until container is done.)</p>\n\n<pre><code>buf := new(bytes.Buffer)\nbuf.ReadFrom(out)\nfmt.Println(buf.String())\n</code></pre>\n\n<p><strong>Intention:</strong> Allow real-time console output to the web.</p>\n"}, {"tags": ["sorting", "go"], "comments": [{"owner": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "edited": false, "score": 0, "creation_date": 1516652549, "post_id": 48389585, "comment_id": 83766987, "body": "If this is working code, it would be better suited to <a href=\"https://codereview.stackexchange.com/\">codereview.stackexchange.com</a>"}, {"owner": {"reputation": 1011, "user_id": 722955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20f47acfd4f247064e5ec44fc15dd9dc?s=128&d=identicon&r=PG", "display_name": "Devin", "link": "https://stackoverflow.com/users/722955/devin"}, "reply_to_user": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "edited": false, "score": 0, "creation_date": 1516652660, "post_id": 48389585, "comment_id": 83767046, "body": "Thanks  @JRLambert. I&#39;m embarrassed to say I didn&#39;t think of that, I will keep it in mind for future."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1516653063, "post_id": 48389585, "comment_id": 83767260, "body": "Note that the quoted code will sort 192.168.1.0 and 192.168.0.255, for example, as if they are equal. It should multiply by 256, not 255 (really, it should left-shift 1 byte). But, see my answer for an easier-to-read approach."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 12, "last_activity_date": 1516652652, "creation_date": 1516652652, "answer_id": 48389676, "question_id": 48389585, "link": "https://stackoverflow.com/questions/48389585/golang-sorting-slice-of-ip-addresses-as-strings/48389676#48389676", "title": "golang sorting slice of IP addresses as strings", "body": "<p>There are lots of possible ways to do it, but the easiest that comes quickly to mind would be to parse them into <code>net.IP</code>s (which are just byte slices, a more accurate representation of an IP), and then sort those:</p>\n\n<pre><code>realIPs := make([]net.IP, 0, len(ips))\n\nfor _, ip := range ips {\n    realIPs = append(realIPs, net.ParseIP(ip))\n}\n\nsort.Slice(realIPs, func(i, j int) bool {\n    return bytes.Compare(realIPs[i], realIPs[j]) &lt; 0\n})\n</code></pre>\n\n<p>Working example here: <a href=\"https://play.golang.org/p/UtuvVz44_c8\" rel=\"noreferrer\">https://play.golang.org/p/UtuvVz44_c8</a></p>\n\n<p>This has the added advantage of working equally well with IPv6 addresses with no modifications.</p>\n"}], "owner": {"reputation": 1011, "user_id": 722955, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/20f47acfd4f247064e5ec44fc15dd9dc?s=128&d=identicon&r=PG", "display_name": "Devin", "link": "https://stackoverflow.com/users/722955/devin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2551, "favorite_count": 1, "accepted_answer_id": 48389676, "answer_count": 1, "score": 5, "last_activity_date": 1516652652, "creation_date": 1516652212, "question_id": 48389585, "link": "https://stackoverflow.com/questions/48389585/golang-sorting-slice-of-ip-addresses-as-strings", "title": "golang sorting slice of IP addresses as strings", "body": "<p>I'm looking to sort a slice of IP addresses (only IPV4) in Golang.</p>\n\n<p>Using the native <code>sort</code> package using <code>sort.Strings()</code> doesn't work for obvious reasons since naturally <code>192.168.4.41</code> would be sorted in front of <code>192.168.4.5</code></p>\n\n<p>By sorting the numerical value of an IP alongside the IP string in a map I came up with a way to achieve it, but it feels too manual. Is this the most efficient way to break up the IP string and sort the addresses? </p>\n\n<p><a href=\"https://play.golang.org/p/FUYQKuhgUq8\" rel=\"noreferrer\">https://play.golang.org/p/FUYQKuhgUq8</a></p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"strconv\"\n  \"strings\"\n  \"sort\"\n)\n\nfunc main() {\n  ips := []string{\n    \"192.168.1.5\",\n    \"69.52.220.44\",\n    \"10.152.16.23\",\n    \"192.168.3.10\",\n    \"192.168.1.4\",\n    \"192.168.1.41\",\n    }\n\nipsWithInt := make(map[string]int64)\n\nfor _, ip := range ips {\n    ipStr := strings.Split(ip, \".\")\n\n    oct0, _ := strconv.ParseInt(ipStr[0], 10, 64)\n    ipInt0 := oct0 * 255 * 255 * 255\n\n    oct1, _ := strconv.ParseInt(ipStr[1], 10, 64)\n    ipInt1 := oct1 * 255 * 255\n\n    oct2, _ := strconv.ParseInt(ipStr[2], 10, 64)\n    ipInt2 := oct2 * 255\n\n    oct3, _ := strconv.ParseInt(ipStr[3], 10, 64)\n    ipInt3 := oct3\n\n    ipInt := ipInt0 + ipInt1 + ipInt2 + ipInt3\n\n    ipsWithInt[ip] = ipInt\n  }\n\n\n  type kv struct {\n    Key   string\n    Value int64\n  }\n\n  var ss []kv\n  for k, v := range ipsWithInt {\n    ss = append(ss, kv{k, v})\n  }\n\n  sort.Slice(ss, func(i, j int) bool {\n    return ss[i].Value &lt; ss[j].Value\n  })\n\n\n  for _, kv := range ss {\n    fmt.Printf(\"%s\\n\", kv.Key)\n  }\n}\n</code></pre>\n\n<p>Results:</p>\n\n<pre><code>10.152.16.23\n69.52.220.44\n192.168.1.4\n192.168.1.5\n192.168.1.41\n192.168.3.10\n</code></pre>\n"}, {"tags": ["go", "antivirus"], "answers": [{"tags": [], "owner": {"reputation": 1796, "user_id": 5763327, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/051c8032c315fd540790929f1d6a6510?s=128&d=identicon&r=PG&f=1", "display_name": "Setop", "link": "https://stackoverflow.com/users/5763327/setop"}, "is_accepted": true, "score": 0, "last_activity_date": 1516652329, "creation_date": 1516652329, "answer_id": 48389613, "question_id": 48389045, "link": "https://stackoverflow.com/questions/48389045/how-do-i-prevent-avg-from-pausing-my-golang-execution/48389613#48389613", "title": "How do I prevent AVG from pausing my goLang execution?", "body": "<p>You can add <code>C:\\User\\Kevin\\Desktop\\go</code> to AVG exclusion list.</p>\n"}, {"tags": [], "owner": {"reputation": 61, "user_id": 10521942, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2ad4d9220a2c2ed9cf91b7e9a892d2f9?s=128&d=identicon&r=PG&f=1", "display_name": "Sahil H. Mobidien", "link": "https://stackoverflow.com/users/10521942/sahil-h-mobidien"}, "is_accepted": false, "score": 0, "last_activity_date": 1598392027, "creation_date": 1598392027, "answer_id": 63587566, "question_id": 48389045, "link": "https://stackoverflow.com/questions/48389045/how-do-i-prevent-avg-from-pausing-my-golang-execution/63587566#63587566", "title": "How do I prevent AVG from pausing my goLang execution?", "body": "<p>You have to exclude <code>C:\\Users\\{user}\\AppData\\Local\\Temp\\go-*</code>.</p>\n"}], "owner": {"reputation": 7796, "user_id": 2334254, "user_type": "registered", "accept_rate": 57, "profile_image": "https://lh4.googleusercontent.com/-6e2XuTZAjgM/AAAAAAAAAAI/AAAAAAAAABU/JpF2-AkHsH4/photo.jpg?sz=128", "display_name": "kpie", "link": "https://stackoverflow.com/users/2334254/kpie"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "accepted_answer_id": 48389613, "answer_count": 2, "score": -2, "last_activity_date": 1598392027, "creation_date": 1516649863, "question_id": 48389045, "link": "https://stackoverflow.com/questions/48389045/how-do-i-prevent-avg-from-pausing-my-golang-execution", "title": "How do I prevent AVG from pausing my goLang execution?", "body": "<p>Disclaimer: Isn't necessarily a programming question, more like a how to use avg whilst programming question...</p>\n\n<p>So I don't just want to turn my antivirus off, but I don't want to have to click abort every time I run something.</p>\n\n<p>Quick aside I just got golang setup on windows for the first time after using Ubuntu for a while (thinking I'll get on debian when I stand up my Linux partition again, at least that's what I ear all the cool kids are doing...) but yeah...</p>\n\n<p>Any advice would be appreciated!</p>\n\n<p><a href=\"https://i.stack.imgur.com/5kiHD.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/5kiHD.png\" alt=\"go run helloworld.go\"></a>\n<a href=\"https://i.stack.imgur.com/aql4E.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/aql4E.png\" alt=\"\"></a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1516650395, "post_id": 48388836, "comment_id": 83765953, "body": "Please show the raw JSON, and the definition of Iapp. If you know the JSON structure in advance, it&#39;s more common to unmarshal directly into a structure. See <a href=\"https://blog.golang.org/json-and-go\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"comments": [{"owner": {"reputation": 71, "user_id": 7119673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JH7nCKTA30/AAAAAAAAAAI/AAAAAAAAAsc/8OPHZh_KUIM/photo.jpg?sz=128", "display_name": "Sanjay Shitole", "link": "https://stackoverflow.com/users/7119673/sanjay-shitole"}, "edited": false, "score": 0, "creation_date": 1516650580, "post_id": 48389106, "comment_id": 83766051, "body": "thanks I tried this  ---&gt;    r.Name := m[&quot;tables&quot;][&quot;name&quot;]      but when I compile it gives error  invalid operation: m[&quot;tables&quot;][&quot;name&quot;] (type interface {} does not support indexing)"}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": false, "score": 0, "last_activity_date": 1516661924, "last_edit_date": 1516661924, "creation_date": 1516650173, "answer_id": 48389106, "question_id": 48388836, "link": "https://stackoverflow.com/questions/48388836/how-to-access-nested-json-key-values-in-golang/48389106#48389106", "title": "how to access nested Json key values in Golang", "body": "<p>All you have to do is repeatedly accessing the map via type-switching or assertion:</p>\n\n<pre><code>for _, table := range m[\"tables\"] {\n    switch val := table {\n        case string:\n                fmt.Println(\"table is string\")\n        case int:\n                fmt.Println(\"table is integer\")\n\n        // This is your case, since JSON is unmarshaled to type []interface{} and map[string]interface{}\n        case []interface{}:\n                fmt.Println(\"table is a slice of interface{}\")\n                for _, tb := range value {\n                        if m, ok := tb.(map[string]interface{}); ok {\n                                // Now it's accessible\n                                fmt.Println(m[\"name\"])\n\n                        }\n                }\n        default:\n                fmt.Println(\"unknown type\")\n        }\n}\n</code></pre>\n\n<p>You might want to handle errors better than this.</p>\n\n<p>To read more, check out my writing from a while ago <a href=\"https://medium.com/code-zen/dynamically-creating-instances-from-key-value-pair-map-and-json-in-go-feef83ab9db2\" rel=\"nofollow noreferrer\">https://medium.com/code-zen/dynamically-creating-instances-from-key-value-pair-map-and-json-in-go-feef83ab9db2</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "is_accepted": true, "score": 0, "last_activity_date": 1516652232, "creation_date": 1516652232, "answer_id": 48389590, "question_id": 48388836, "link": "https://stackoverflow.com/questions/48388836/how-to-access-nested-json-key-values-in-golang/48389590#48389590", "title": "how to access nested Json key values in Golang", "body": "<p>Note: This may not work with your JSON structure. I inferred what it would be based on your question but without the actual structure, I cannot guarantee this to work without modification.</p>\n\n<p>If you want to access them in a map, you need to assert that the interface pulled from the first map is actually a map. So you would need to do this:</p>\n\n<pre><code>tmp := m[\"tables\"]\ntables, ok := tmp.(map[string]string)\nif !ok {\n    //error handling here\n}\n\nr.Name = tables[\"name\"].(string)\n</code></pre>\n\n<p>But instead of accessing the unmarshaled JSON as a <code>map[string]interface{}</code>, why don't you create structs that match your JSON output?</p>\n\n<pre><code>type JSONRoot struct {\n    Name string `json:\"name\"`\n    Partition string `json:\"partition\"`\n    InheritedDevicegroup string `json:\"inherited_devicegroup\"`\n    Tables map[string]string `json:\"tables\"` //Ideally, this would be a map of structs\n}\n</code></pre>\n\n<p>Then in your code:</p>\n\n<pre><code>func dataToIapp(name string, d *schema.ResourceData) bigip.Iapp {\n    var p bigip.Iapp\n\n    var obj &amp;JSONRoot{}\n\n    jsonblob := []byte(d.Get(\"jsonfile\").(string))\n    err := json.Unmarshal(jsonblob, &amp;obj)\n    if err != nil {\n            fmt.Println(\"error\", err)\n    }\n\n    p.Name = obj.Name\n    p.Partition = obj.Partition\n\n    p.InheritedDevicegroup = obj.InheritedDevicegroup\n\n    p.Name = obj.Tables[\"name\"]\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1516655363, "creation_date": 1516655363, "answer_id": 48390307, "question_id": 48388836, "link": "https://stackoverflow.com/questions/48388836/how-to-access-nested-json-key-values-in-golang/48390307#48390307", "title": "how to access nested Json key values in Golang", "body": "<p>JSON objects are unmarshaled into <code>map[string]interface{}</code>, JSON arrays into <code>[]interface{}</code>, same applies for nested objects/arrays.</p>\n\n<p>So for example if a key/index maps to a nested object you need to type assert the value to <code>map[string]interface{}</code> and if the key/index maps to an array of objects you first need to assert the value to <code>[]interface{}</code> and then each element to <code>map[string]interface{}</code>.</p>\n\n<p>e.g. <em>(for brevity this code is not guarding against panic)</em></p>\n\n<pre><code>tables := obj.(map[string]interface{})[\"tables\"]\ntable1 := tables.([]interface{})[0]\nname := table1.(map[string]interface{})[\"name\"]\nnamestr := name.(string)\n</code></pre>\n\n<p>However, if it's the case that the json you are parsing is not dynamic but instead has a specific <em>structure</em> you should define a <code>struct</code> type that mirrors that structure and unmarshal the json into that.</p>\n"}], "owner": {"reputation": 71, "user_id": 7119673, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--JH7nCKTA30/AAAAAAAAAAI/AAAAAAAAAsc/8OPHZh_KUIM/photo.jpg?sz=128", "display_name": "Sanjay Shitole", "link": "https://stackoverflow.com/users/7119673/sanjay-shitole"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3664, "favorite_count": 1, "accepted_answer_id": 48389590, "answer_count": 3, "score": 1, "last_activity_date": 1516661924, "creation_date": 1516648949, "last_edit_date": 1516649446, "question_id": 48388836, "link": "https://stackoverflow.com/questions/48388836/how-to-access-nested-json-key-values-in-golang", "title": "how to access nested Json key values in Golang", "body": "<p>Team,\nnew to Programming.\nI have data available after unmarshaling the Json as shown below, which has nested Key values. flat key values I am able to access, how do I access nested key values.\nHere is the byte slice data shown below after unmarshaling \u2014></p>\n\n<pre><code>tables:[map[name:basic__snatpool_members] map[name:net__snatpool_members] map[name:optimizations__hosts] map[columnNames:[name] name:pool__hosts rows:[map[row:[ry.hj.com]]]] traffic_group:/Common/traffic-group-1\n</code></pre>\n\n<p>Flat key values I am able to access by using the following code</p>\n\n<pre><code>p.TrafficGroup = m[\u201ctraffic_group\u201d].(string)\n</code></pre>\n\n<p>here is the complete function</p>\n\n<pre><code>func dataToIapp(name string, d *schema.ResourceData) bigip.Iapp {\n        var p bigip.Iapp\n\n        var obj interface{}\n\n        jsonblob := []byte(d.Get(\"jsonfile\").(string))\n        err := json.Unmarshal(jsonblob, &amp;obj)\n        if err != nil {\n                fmt.Println(\"error\", err)\n        }\n        m := obj.(map[string]interface{}) // Important: to access property\n        p.Name = m[\u201cname\u201d].(string)\n        p.Partition = m[\u201cpartition\u201d].(string)\n\n        p.InheritedDevicegroup = m[\u201cinherited_devicegroup\u201d].(string)\n\n}\n</code></pre>\n"}, {"tags": ["go", "kubernetes"], "answers": [{"comments": [{"owner": {"reputation": 3223, "user_id": 702912, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9e25ee94fc81a18d3207befd8aa7837?s=128&d=identicon&r=PG", "display_name": "Charles Holbrow", "link": "https://stackoverflow.com/users/702912/charles-holbrow"}, "edited": false, "score": 0, "creation_date": 1516652811, "post_id": 48389454, "comment_id": 83767125, "body": "Thank you! What is the difference between the <code>clientset</code> in the <code>kubernetes</code> package and the <code>clientset</code> in the <code>client-go</code> package?"}, {"owner": {"reputation": 9163, "user_id": 563072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/87897775ae66733545b7eae7128e2e8f?s=128&d=identicon&r=PG", "display_name": "Jose Armesto", "link": "https://stackoverflow.com/users/563072/jose-armesto"}, "reply_to_user": {"reputation": 3223, "user_id": 702912, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9e25ee94fc81a18d3207befd8aa7837?s=128&d=identicon&r=PG", "display_name": "Charles Holbrow", "link": "https://stackoverflow.com/users/702912/charles-holbrow"}, "edited": false, "score": 0, "creation_date": 1516696568, "post_id": 48389454, "comment_id": 83782143, "body": "I don&#39;t really know if there is any difference"}, {"owner": {"reputation": 702, "user_id": 4763788, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1198fc0b5df4d03d7be86092b8182192?s=128&d=identicon&r=PG", "display_name": "slintes", "link": "https://stackoverflow.com/users/4763788/slintes"}, "edited": false, "score": 4, "creation_date": 1516874678, "post_id": 48389454, "comment_id": 83871529, "body": "development is made in the kubernetes repository, changes are &quot;mirrored&quot; once a day to the client-go repository. The last paragraph &quot;Contributing&quot; in the readme of client-go gives a hint about that. Reason is afaik that client-go has always been in the k8s repo, but this way you can use it without needing to download/import all the k8s code.  <a href=\"https://github.com/kubernetes/client-go/blob/master/README.md\" rel=\"nofollow noreferrer\">github.com/kubernetes/client-go/blob/master/README.md</a>"}], "tags": [], "owner": {"reputation": 9163, "user_id": 563072, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/87897775ae66733545b7eae7128e2e8f?s=128&d=identicon&r=PG", "display_name": "Jose Armesto", "link": "https://stackoverflow.com/users/563072/jose-armesto"}, "is_accepted": true, "score": 18, "last_activity_date": 1516651582, "creation_date": 1516651582, "answer_id": 48389454, "question_id": 48388077, "link": "https://stackoverflow.com/questions/48388077/what-is-a-kubernetes-client-go-clientset/48389454#48389454", "title": "What is a Kubernetes client-go &quot;clientset&quot;?", "body": "<p>Every resource type in Kubernetes (Pods, Deployments, Services and so on) is a member of an <a href=\"https://kubernetes.io/docs/concepts/overview/kubernetes-api/#api-groups\" rel=\"noreferrer\">API group</a>. These logically \"group\" the different types. Some examples of groups are</p>\n\n<ul>\n<li><code>core</code></li>\n<li><code>extensions</code></li>\n<li><code>batch</code></li>\n<li><code>apps</code></li>\n<li><code>authentication</code></li>\n<li><code>autoscaling</code></li>\n</ul>\n\n<p><a href=\"https://kubernetes.io/docs/concepts/overview/kubernetes-api/#api-versioning\" rel=\"noreferrer\">Groups also contain versions</a>. Versions allow developers to introduce breaking changes to APIs, and manage them as they do. Some examples of versions inside a group</p>\n\n<ul>\n<li><code>core/v1</code></li>\n<li><code>extensions/v1beta</code></li>\n<li><code>apps/v1beta1</code></li>\n<li><code>batch/v1</code>, <code>batch/v2alpha1</code> (notice the two versions inside the same group)</li>\n<li><code>authentication/v1</code>, <code>authentication/v1beta1</code></li>\n<li><code>autoscaling/v1</code>, <code>autoscaling/v2alpha1</code></li>\n</ul>\n\n<p>So the client documentation is saying that it's creating a different client for every group.</p>\n"}, {"tags": [], "owner": {"reputation": 73, "user_id": 5612481, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jb91U.jpg?s=128&g=1", "display_name": "jack_t", "link": "https://stackoverflow.com/users/5612481/jack-t"}, "is_accepted": false, "score": 0, "last_activity_date": 1613409413, "last_edit_date": 1613409413, "creation_date": 1613407378, "answer_id": 66211984, "question_id": 48388077, "link": "https://stackoverflow.com/questions/48388077/what-is-a-kubernetes-client-go-clientset/66211984#66211984", "title": "What is a Kubernetes client-go &quot;clientset&quot;?", "body": "<p>The description given by @Jose Armesto is correct, I would like to support it with a snippet.</p>\n<pre><code>package main \nimport (\n    metav1 &quot;k8s.io/apimachinery/pkg/apis/meta/v1&quot;\n    &quot;k8s.io/client-go/tools/clientcmd&quot;\n    &quot;k8s.io/client-go/kubernetes&quot;\n)\n\nvar kubeconfig string\n\nfunc init() {\n   // kubeconfig file parsing\n   flag.StringVar(&amp;kubeconfig, &quot;kubeconfig&quot;, &quot;&quot;, &quot;path to Kubernetes config file&quot;)\n   flag.Parse()\n}\n\nfunc main() {\n   // create the config object from kubeconfig\n   config, err := clientcmd.BuildConfigFromFlags(&quot;&quot;, *kubeconfig)\n\n   // create clientset (set of muliple clients) for each Group (e.g. Core), \n   // the Version (V1) of Group and Kind (e.g. Pods) so GVK.\n   clientset, err := kubernetes.NewForConfig(config)\n\n   // executes GET request to K8s API to get pods 'cart' from 'prepayment' namespace\n   pod, err := clientset.CoreV1().Pods(&quot;prepayment&quot;).Get(&quot;cart&quot;, metav1.GetOptions{})\n}\n</code></pre>\n"}], "owner": {"reputation": 3223, "user_id": 702912, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/b9e25ee94fc81a18d3207befd8aa7837?s=128&d=identicon&r=PG", "display_name": "Charles Holbrow", "link": "https://stackoverflow.com/users/702912/charles-holbrow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4310, "favorite_count": 1, "accepted_answer_id": 48389454, "answer_count": 2, "score": 12, "last_activity_date": 1613414776, "creation_date": 1516645825, "last_edit_date": 1613414776, "question_id": 48388077, "link": "https://stackoverflow.com/questions/48388077/what-is-a-kubernetes-client-go-clientset", "title": "What is a Kubernetes client-go &quot;clientset&quot;?", "body": "<p>In the kubernetes go client, what is a <code>clientset</code>?</p>\n\n<p>It is defined in multiple places. </p>\n\n<ol>\n<li><p>In the <code>client-go</code> package. <a href=\"https://github.com/kubernetes/client-go/blob/62b2cb756b8cea8fba00764ff123993eb44dbd48/kubernetes/clientset.go#L120\" rel=\"noreferrer\">https://github.com/kubernetes/client-go/blob/62b2cb756b8cea8fba00764ff123993eb44dbd48/kubernetes/clientset.go#L120</a></p></li>\n<li><p>In the <code>kubernetes</code> package <a href=\"https://github.com/kubernetes/kubernetes/blob/80e344644e2b6222296f2f03551a8d0273c7cbce/pkg/client/clientset_generated/internalclientset/clientset.go#L64\" rel=\"noreferrer\">https://github.com/kubernetes/kubernetes/blob/80e344644e2b6222296f2f03551a8d0273c7cbce/pkg/client/clientset_generated/internalclientset/clientset.go#L64</a></p></li>\n</ol>\n\n<p>The documentation says the same thing for both of them:</p>\n\n<blockquote>\n  <p>Clientset contains the clients for groups. Each group has exactly\n  one version included in a Clientset.</p>\n</blockquote>\n\n<p>This is confusing. What is a group?</p>\n"}, {"tags": ["json", "go", "iris-go"], "comments": [{"owner": {"reputation": 3837, "user_id": 1227008, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/KFxYT.jpg?s=128&g=1", "display_name": "Yandry Pozo", "link": "https://stackoverflow.com/users/1227008/yandry-pozo"}, "edited": false, "score": 1, "creation_date": 1516690228, "post_id": 48386687, "comment_id": 83779001, "body": "a little bit of context around iris: <a href=\"https://github.com/julienschmidt/httprouter/issues/160\" rel=\"nofollow noreferrer\">github.com/julienschmidt/httprouter/issues/160</a> and <a href=\"http://www.florinpatan.ro/2016/10/why-you-should-not-use-iris-for-your-go.html\" rel=\"nofollow noreferrer\">florinpatan.ro/2016/10/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 6660, "user_id": 1347435, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EC7Qo.png?s=128&g=1", "display_name": "SoldierCorp", "link": "https://stackoverflow.com/users/1347435/soldiercorp"}, "edited": false, "score": 0, "creation_date": 1516642967, "post_id": 48386713, "comment_id": 83762152, "body": "@SoldierCorp note that you can omit the 3rd <code>iris.Map</code> from the provided example to reduce stutter as is explained <a href=\"https://golang.org/ref/spec#Composite_literals\" rel=\"nofollow noreferrer\">here</a>. Mainly this part: <i>&quot;Within a composite literal of array, slice, or map type T, elements or map keys that are themselves composite literals may elide the respective literal type if it is identical to the element or key type of T.&quot;</i>"}, {"owner": {"reputation": 6660, "user_id": 1347435, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EC7Qo.png?s=128&g=1", "display_name": "SoldierCorp", "link": "https://stackoverflow.com/users/1347435/soldiercorp"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516645177, "post_id": 48386713, "comment_id": 83763375, "body": "@mkopriva Didn&#39;t know that, I will check that article. Thanks!"}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 1, "last_activity_date": 1516640523, "creation_date": 1516640523, "answer_id": 48386713, "question_id": 48386687, "link": "https://stackoverflow.com/questions/48386687/error-sending-an-array-within-a-json-object/48386713#48386713", "title": "Error sending an array within a JSON object", "body": "<p>In your Go code, you don't specify a type for the array or its element. Assuming you want it to be <code>iris.Map</code>:</p>\n\n<pre><code>ctx.JSON(iris.Map{\n    \"text\": \"It's 80 degrees right now.\",\n    \"response_type\": \"in_channel\",\n    \"attachments\": []iris.Map{iris.Map{ \"text\": \"Partly cloudy today and tomorrow\" }},\n})\n</code></pre>\n"}], "owner": {"reputation": 6660, "user_id": 1347435, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EC7Qo.png?s=128&g=1", "display_name": "SoldierCorp", "link": "https://stackoverflow.com/users/1347435/soldiercorp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 227, "favorite_count": 0, "accepted_answer_id": 48386713, "answer_count": 1, "score": -1, "last_activity_date": 1516693577, "creation_date": 1516640425, "last_edit_date": 1516693577, "question_id": 48386687, "link": "https://stackoverflow.com/questions/48386687/error-sending-an-array-within-a-json-object", "title": "Error sending an array within a JSON object", "body": "<p>In order to send this JSON with Iris Go</p>\n\n<pre><code>{\n  \"response_type\": \"in_channel\",\n  \"text\": \"It's 80 degrees right now.\",\n  \"attachments\": [\n    {\n        \"text\":\"Partly cloudy today and tomorrow\"\n    }\n  ]\n}\n</code></pre>\n\n<p>I'm trying with this but is not working</p>\n\n<pre><code>ctx.JSON(iris.Map{\n    \"text\": \"It's 80 degrees right now.\",\n    \"response_type\": \"in_channel\",\n    \"attachments\":[{ \"text\": \"Partly cloudy today and tomorrow\" }],\n})\n</code></pre>\n\n<p>Because the following error appear in the <strong>attachments line</strong></p>\n\n<pre><code>syntax error: unexpected {, expecting expression\n</code></pre>\n\n<p>Do you know how to fix it?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1516635685, "post_id": 48385214, "comment_id": 83757701, "body": "Does your program wait till the go routines finish?"}, {"owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "edited": false, "score": 0, "creation_date": 1516635730, "post_id": 48385214, "comment_id": 83757728, "body": "Could you post how are you calling the function - getServerStatus ?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516635737, "post_id": 48385214, "comment_id": 83757737, "body": "For example this program doesn&#39;t wait for the go routine therefore you don&#39;t see nothing: <a href=\"https://play.golang.org/p/qKFq15T19oV\" rel=\"nofollow noreferrer\">play.golang.org/p/qKFq15T19oV</a>"}, {"owner": {"reputation": 211, "user_id": 1146047, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/456defebcb01b2a38cbe2a8f0a3a4026?s=128&d=identicon&r=PG", "display_name": "hedrick", "link": "https://stackoverflow.com/users/1146047/hedrick"}, "edited": false, "score": 0, "creation_date": 1516635738, "post_id": 48385214, "comment_id": 83757739, "body": "I experimented with a goroutine for this but the outcome was the same.  It shouldn&#39;t require concurrent execution AFAIK since the http.Get is completed before the call."}, {"owner": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "edited": false, "score": 0, "creation_date": 1516635868, "post_id": 48385214, "comment_id": 83757826, "body": "Are you shure that your statment turned <code>true</code>?"}, {"owner": {"reputation": 211, "user_id": 1146047, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/456defebcb01b2a38cbe2a8f0a3a4026?s=128&d=identicon&r=PG", "display_name": "hedrick", "link": "https://stackoverflow.com/users/1146047/hedrick"}, "reply_to_user": {"reputation": 1761, "user_id": 8944610, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/a07tQ.jpg?s=128&g=1", "display_name": "Mikhail Katrin", "link": "https://stackoverflow.com/users/8944610/mikhail-katrin"}, "edited": false, "score": 0, "creation_date": 1516635976, "post_id": 48385214, "comment_id": 83757898, "body": "@MikhailKatrin yes, it evaluates correctly"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516636190, "post_id": 48385214, "comment_id": 83758043, "body": "Your if condition is false. Please show the output with the prinfs uncommented (but just print <code>server.Name</code> and <code>name</code>). Also add an <code>else</code> with a print, and finally a printf after the if block."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1516636194, "post_id": 48385214, "comment_id": 83758047, "body": "Don&#39;t switch the ToLower conversion arbitrarily <a href=\"https://play.golang.org/p/PzbhvXce-Gh\" rel=\"nofollow noreferrer\">play.golang.org/p/PzbhvXce-Gh</a>"}, {"owner": {"reputation": 211, "user_id": 1146047, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/456defebcb01b2a38cbe2a8f0a3a4026?s=128&d=identicon&r=PG", "display_name": "hedrick", "link": "https://stackoverflow.com/users/1146047/hedrick"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516636670, "post_id": 48385214, "comment_id": 83758428, "body": "@mkopriva that was it! wasn&#39;t downcasing both instances (<code>server.Name</code> and <code>name</code>)  /facepalm"}], "answers": [{"tags": [], "owner": {"reputation": 211, "user_id": 1146047, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/456defebcb01b2a38cbe2a8f0a3a4026?s=128&d=identicon&r=PG", "display_name": "hedrick", "link": "https://stackoverflow.com/users/1146047/hedrick"}, "is_accepted": false, "score": 1, "last_activity_date": 1516641057, "creation_date": 1516641057, "answer_id": 48386854, "question_id": 48385214, "link": "https://stackoverflow.com/questions/48385214/fmt-printf-not-executing-inside-loop/48386854#48386854", "title": "fmt.Printf not executing inside loop", "body": "<p>Turns out the evaluation was incorrect as I was not using <code>strings.ToLower()</code> on both causing the statement to always be false as the data was not sanitized before hand or at execution.</p>\n\n<p>Credit to @mkopriva</p>\n"}], "owner": {"reputation": 211, "user_id": 1146047, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/456defebcb01b2a38cbe2a8f0a3a4026?s=128&d=identicon&r=PG", "display_name": "hedrick", "link": "https://stackoverflow.com/users/1146047/hedrick"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": -3, "last_activity_date": 1516641057, "creation_date": 1516635545, "last_edit_date": 1516636727, "question_id": 48385214, "link": "https://stackoverflow.com/questions/48385214/fmt-printf-not-executing-inside-loop", "title": "fmt.Printf not executing inside loop", "body": "<p>I'm writing a small program in Go to check a server's status is up (out of a list of servers) by hostname. I have a function that iterates over a server type once they're all retrieved and stored from an http.GET into slice of type server. </p>\n\n<p>I can log (commented out below) and see that both of these evaluate correctly:</p>\n\n<pre><code>// fmt.Printf(\"Server: %s - Status: %s\\n\", server.Name, status)\n// fmt.Printf(\"%t\\n\", name == strings.ToLower(server.Name))\n</code></pre>\n\n<p>Both have the expected outcome but when I run the program, the <code>fmt.Printf()</code> call inside the if statement does not print to the console.</p>\n\n<pre><code>    func getServerStatus(name string) {\n      servers := getAllServers()\n      for _, server := range servers {\n        status := boolToStatusString(server.Status)\n        // fmt.Printf(\"Server: %s - Status: %s\\n\", server.Name, status)\n        // fmt.Printf(\"%t\\n\", name == strings.ToLower(server.Name))\n        if server.Name == strings.ToLower(name) {\n          fmt.Printf(\"%s is %s\", name, status)\n        }\n      }\n    }\n</code></pre>\n\n<p>I've tried running this function as a <code>goroutine</code> with a <code>channel</code> of type <code>string</code> to store the result and call the <code>Printf</code> outside this function but anytime I <code>go run main.go</code> it just executes and prints nothing.</p>\n\n<p>Solved: evaluating both as strings.ToLower in the if statement resolved the issue.</p>\n"}, {"tags": ["python", "go", "anaconda", "virtualenv"], "comments": [{"owner": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 0, "creation_date": 1516627103, "post_id": 48382330, "comment_id": 83751707, "body": "How about using <a href=\"https://github.com/GetStream/vg\" rel=\"nofollow noreferrer\">github.com/GetStream/vg</a>?"}, {"owner": {"reputation": 10306, "user_id": 658497, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/AiHJI.jpg?s=128&g=1", "display_name": "Noam Manos", "link": "https://stackoverflow.com/users/658497/noam-manos"}, "reply_to_user": {"reputation": 10112, "user_id": 396567, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/XKKMJ.jpg?s=128&g=1", "display_name": "Michael Hausenblas", "link": "https://stackoverflow.com/users/396567/michael-hausenblas"}, "edited": false, "score": 1, "creation_date": 1585729627, "post_id": 48382330, "comment_id": 107861262, "body": "@MichaelHausenblas note that <a href=\"https://github.com/GetStream/vg#installation\" rel=\"nofollow noreferrer\">vg installation</a> requires an existing GO env, i.e. with <code>sudo</code> user. Anaconda on the other hand, can create GO env <b>without sudo</b> privileges."}], "answers": [{"tags": [], "owner": {"reputation": 25463, "user_id": 5003756, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8BUMb.jpg?s=128&g=1", "display_name": "James", "link": "https://stackoverflow.com/users/5003756/james"}, "is_accepted": true, "score": 5, "last_activity_date": 1516626963, "creation_date": 1516626963, "answer_id": 48382468, "question_id": 48382330, "link": "https://stackoverflow.com/questions/48382330/can-anaconda-be-used-to-create-virtual-environments-for-go/48382468#48382468", "title": "Can Anaconda be used to create virtual environments for Go?", "body": "<blockquote>\n  <p>I also get the feeling all dependencies-solving power of Anaconda is probably made thinking of Python only. </p>\n</blockquote>\n\n<p>Absolutely not.  Anaconda installs Conda.  Conda is a package and environment manager, and not just for Python, but also for R, Julia, Perl, Scala, etc... including Go.  </p>\n\n<p>You will need to create a new environment if you want to run Go:</p>\n\n<pre><code>conda create --name go --channel-name conda-forge go\n</code></pre>\n\n<p>Then move to the new environment to run go using:</p>\n\n<pre><code>activate go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 107, "user_id": 1794868, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d38735ace6812249cebf3bcc4605b9f?s=128&d=identicon&r=PG", "display_name": "itscaro", "link": "https://stackoverflow.com/users/1794868/itscaro"}, "is_accepted": false, "score": 2, "last_activity_date": 1516632679, "creation_date": 1516632679, "answer_id": 48384275, "question_id": 48382330, "link": "https://stackoverflow.com/questions/48382330/can-anaconda-be-used-to-create-virtual-environments-for-go/48384275#48384275", "title": "Can Anaconda be used to create virtual environments for Go?", "body": "<p>Since Go supports vendoring, you can use an utility like <a href=\"https://github.com/golang/dep\" rel=\"nofollow noreferrer\">https://github.com/golang/dep</a> to have all dependencies in the project.</p>\n"}], "owner": {"reputation": 778, "user_id": 1844776, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/e496aa67695e799b11bc23bda4b92faf?s=128&d=identicon&r=PG", "display_name": "raggot", "link": "https://stackoverflow.com/users/1844776/raggot"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1561, "favorite_count": 0, "accepted_answer_id": 48382468, "answer_count": 2, "score": 2, "last_activity_date": 1516704508, "creation_date": 1516626519, "last_edit_date": 1516704508, "question_id": 48382330, "link": "https://stackoverflow.com/questions/48382330/can-anaconda-be-used-to-create-virtual-environments-for-go", "title": "Can Anaconda be used to create virtual environments for Go?", "body": "<p>Anaconda is a powerful and popular toolkit normally associated to Python development. Its snake-name is probably chosen to remind of Python, but the feeling I get using it, is that all it does is handling virtual environments, pre-installing useful Python libraries, tools and packages, and then (and probably most importantly) dealing with dependencies and installations.</p>\n\n<p>Can I set Anaconda up to create virtual environments for Go, too?</p>\n\n<p>From the fact <a href=\"https://anaconda.org/conda-forge/go\" rel=\"nofollow noreferrer\">Anaconda can install Go</a>, I get to think it's actually possible, but then I also get the feeling all dependencies-solving power of Anaconda is probably made thinking of Python only. </p>\n\n<p>...Can it be done?</p>\n"}, {"tags": ["go", "visual-studio-code", "goimports"], "answers": [{"tags": [], "owner": {"reputation": 6405, "user_id": 3166160, "user_type": "registered", "accept_rate": 68, "profile_image": "https://www.gravatar.com/avatar/9054f030b0058573a8338340e6347da8?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Lambert", "link": "https://stackoverflow.com/users/3166160/jacob-lambert"}, "is_accepted": true, "score": 1, "last_activity_date": 1516652733, "creation_date": 1516652733, "answer_id": 48389697, "question_id": 48381598, "link": "https://stackoverflow.com/questions/48381598/how-to-force-vscode-to-require-manual-choice-where-goimports-match-multiple-pack/48389697#48389697", "title": "How to force VSCode to require manual choice where goimports match multiple packages with same name?", "body": "<p>If you start typing in the <code>import ()</code> declaration, it will give you suggestions that match. So if you were to type <code>logger</code> it would give you the suggestion of:</p>\n\n<pre><code>github.com/kataras/iris/middleware/logger\n</code></pre>\n\n<p>and</p>\n\n<pre><code>github.com/hashicorp/consul/logger\n</code></pre>\n\n<p>Just put the <code>\"\"</code> in the <code>import</code> and start typing the package you want.</p>\n"}], "owner": {"reputation": 7629, "user_id": 2335820, "user_type": "registered", "accept_rate": 90, "profile_image": "https://i.stack.imgur.com/sLTHB.jpg?s=128&g=1", "display_name": "Kimmo Hintikka", "link": "https://stackoverflow.com/users/2335820/kimmo-hintikka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 157, "favorite_count": 0, "accepted_answer_id": 48389697, "answer_count": 1, "score": 0, "last_activity_date": 1516652733, "creation_date": 1516623964, "question_id": 48381598, "link": "https://stackoverflow.com/questions/48381598/how-to-force-vscode-to-require-manual-choice-where-goimports-match-multiple-pack", "title": "How to force VSCode to require manual choice where goimports match multiple packages with same name?", "body": "<p>I just ran into issues where I am writing small web service with Go Iris framework. Iris has few useful packages for HTTP request error handling.</p>\n\n<p>Namely, I wanted to use <strong><em>\"github.com/kataras/iris/middleware/logger\"</em></strong> and\n   <strong><em>\"github.com/kataras/iris/middleware/recover\"</em></strong> however when I start typing app.Use(logger....) VSCode auto imported \"<strong><em>github.com/hashicorp/consul/logger</em></strong>\" which is also in my path. </p>\n\n<p>Simply copy-pasting right path will solve the issue, but is there a way to force VSCode to make a manual choice where multiple packages names are matched or even fully disable goimports for these cases.</p>\n\n<p>Example below:  </p>\n\n<pre><code>package main\n\nimport (\n    // \"github.com/hashicorp/consul/logger\" ! incorrect package\n\n    \"github.com/kataras/iris\"\n    \"github.com/kataras/iris/middleware/logger\"\n    \"github.com/kataras/iris/middleware/recover\"\n)\n\nfunc main() {\n    app := iris.New()\n    app.Logger().SetLevel(\"debug\")\n    // Optionally, add 2 built'n handlers\n    // that can recover from any http-related error\n    // and log the requests in terminal\n    app.Use(recover.New())\n    app.Use(logger.New())\n}\n</code></pre>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1516623039, "post_id": 48381241, "comment_id": 83749088, "body": "Unkeyed literals means this: <code>SomeType{&quot;foo&quot;, true}</code> as opposed to <code>SomeType{Field1:&quot;foo&quot;, Field2: true}</code> the <code>_ struct{}</code> field prevents the former."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 3, "creation_date": 1516623188, "post_id": 48381241, "comment_id": 83749174, "body": "<a href=\"https://groups.google.com/forum/#!msg/Golang-Nuts/NSjVW82i0mY/qSshj0qIYxQJ\" rel=\"nofollow noreferrer\">groups.google.com/forum/#!msg/Golang-Nuts/NSjVW82i0mY/&hellip;</a> There is an exactly same question, but on golang-nuts."}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1516623200, "post_id": 48381241, "comment_id": 83749183, "body": "Just try to create an unkeyed literal and you&#39;ll see."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516623478, "post_id": 48381241, "comment_id": 83749355, "body": "I got the link by searching the code &quot;ProgInfo&quot;. Hope this trick help you."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1516623489, "post_id": 48381241, "comment_id": 83749362, "body": "... also please note that the prevention works only for client packages since the <code>_</code> is unexported, while inside the package that defines the type you can still do <code>SomeType{&quot;foo&quot;, true, struct{}{}}</code>"}], "answers": [{"comments": [{"owner": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1588119358, "post_id": 48384185, "comment_id": 108776705, "body": "would you mind to explain what is &quot;keyed&quot; field now, and why do we need it?"}, {"owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "reply_to_user": {"reputation": 4733, "user_id": 922445, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a469120d35647d9aa50646cb4d778c71?s=128&d=identicon&r=PG&f=1", "display_name": "Nulik", "link": "https://stackoverflow.com/users/922445/nulik"}, "edited": false, "score": 0, "creation_date": 1588356948, "post_id": 48384185, "comment_id": 108873126, "body": "@Nulik When you declare a struct with keyed fields, it looks like this: <code>SomeType{Field1: &quot;hello&quot;, Field2: &quot;true&quot;}</code>. The <code>Field1</code> and <code>Field2</code> are the keys. Unless you use the technique described in this Q&amp;A, Go will let you omit the keys when declaring the struct: <code>SomeType{&quot;hello&quot;, true}</code>."}], "tags": [], "owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "is_accepted": true, "score": 32, "last_activity_date": 1612396262, "last_edit_date": 1612396262, "creation_date": 1516632435, "answer_id": 48384185, "question_id": 48381241, "link": "https://stackoverflow.com/questions/48381241/what-is-the-purpose-of-a-field-named-underscore-containing-an-empty-struct/48384185#48384185", "title": "What is the purpose of a field named &quot;_&quot; (underscore) containing an empty struct?", "body": "<p>This technique enforces keyed fields when declaring a struct.</p>\n<p>For example, the struct:</p>\n<pre><code>type SomeType struct {\n  Field1 string\n  Field2 bool\n  _      struct{}\n}\n</code></pre>\n<p>can only be declared with keyed fields:</p>\n<pre><code>// ALLOWED:\nbar := SomeType{Field1: &quot;hello&quot;, Field2: true}\n\n// COMPILE ERROR:\nfoo := SomeType{&quot;hello&quot;, true}\n</code></pre>\n<p>One reason for doing this is to allow additional fields to be added to the struct in the future without breaking existing code.</p>\n"}], "owner": {"reputation": 58775, "user_id": 474189, "user_type": "registered", "accept_rate": 72, "profile_image": "https://i.stack.imgur.com/jzXIJ.jpg?s=128&g=1", "display_name": "Duncan Jones", "link": "https://stackoverflow.com/users/474189/duncan-jones"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1850, "favorite_count": 5, "accepted_answer_id": 48384185, "answer_count": 1, "score": 21, "last_activity_date": 1612396262, "creation_date": 1516622770, "last_edit_date": 1517387253, "question_id": 48381241, "link": "https://stackoverflow.com/questions/48381241/what-is-the-purpose-of-a-field-named-underscore-containing-an-empty-struct", "title": "What is the purpose of a field named &quot;_&quot; (underscore) containing an empty struct?", "body": "<p>I've seen two pieces of Go code using this pattern:</p>\n\n<pre><code>type SomeType struct{\n  Field1 string\n  Field2 bool\n  _      struct{}    // &lt;-- what is this?\n}\n</code></pre>\n\n<p>Can anyone explain what this code accomplishes?</p>\n"}, {"tags": ["go", "tcp", "netcat"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516632960, "post_id": 48379953, "comment_id": 83755740, "body": "For future reference, you have other issues here too. When using an <code>io.Reader</code> you need to check the bytes read before the error, because you may get <code>io.EOF</code> from a valid Read (a one-size-fits-all error check function is usually a Go anti-pattern). The bytes read isn&#39;t the <code>reqLen</code>, it&#39;s just the number bytes read -- TCP doesn&#39;t have message framing."}], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1516619158, "last_edit_date": 1516619158, "creation_date": 1516618747, "answer_id": 48380003, "question_id": 48379953, "link": "https://stackoverflow.com/questions/48379953/how-to-print-tcp-message-from-netcat-in-go/48380003#48380003", "title": "How to print TCP Message from netcat in Go?", "body": "<p>To print the message in quotes, you can use the <code>%q</code> format specifier (see the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\">fmt docs</a>).</p>\n\n<p>You'll want to convert your buffer to a string and make sure you only use the part of the buffer that contains data (up to <code>reqLen</code>):</p>\n\n<pre><code>// buf[:reqLen] is a slice of the first reqLen bytes of buf.\n// string(...) creates a string from a slice of bytes.\nfmt.Printf(\"Message contents: %q\\n\", string(buf[:reqLen]))\n</code></pre>\n\n<p>This will print:</p>\n\n<pre><code>Message contents: \"message\\n\"\n</code></pre>\n\n<p>The <code>\\n</code> is inserted by <code>echo</code>. If you don't want it, run <code>echo -n ...</code>, or strip surrounding whitespace/newlines using <a href=\"https://golang.org/pkg/strings/#TrimSpace\" rel=\"nofollow noreferrer\">strings.TrimSpace</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 7383029, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PNkcj.png?s=128&g=1", "display_name": "maverigz", "link": "https://stackoverflow.com/users/7383029/maverigz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 732, "favorite_count": 0, "accepted_answer_id": 48380003, "answer_count": 1, "score": -3, "last_activity_date": 1516619158, "creation_date": 1516618567, "question_id": 48379953, "link": "https://stackoverflow.com/questions/48379953/how-to-print-tcp-message-from-netcat-in-go", "title": "How to print TCP Message from netcat in Go?", "body": "<p>So I need to write a server in Go that prints messages from the following command: </p>\n\n<pre><code>echo \"MESSAGE\" | nc localhost 8080\n</code></pre>\n\n<p>It just has to print \"MESSAGE\" as a string on stdout. I can not use something else, it has to be this command. This is what I have so far: </p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"net\"\n  \"os\"\n)\n\nfunc main() {\n  ln, err := net.Listen(\"tcp\", \":8080\")\n  check(err)\n  for {\n    conn, err := ln.Accept()\n    check(err)\n    go handleConnection(conn)\n  }\n}\n\nfunc handleConnection(conn net.Conn) {\n  buf := make([]byte, 1024)\n  reqLen, err := conn.Read(buf)\n  fmt.Println(reqLen)\n  check(err)\n  // PRINT MESSAGE HERE\n  conn.Write([]byte(\"Message received.\"))\n  fmt.Println(conn.RemoteAddr().String())\n  conn.Close()\n}\n\n\nfunc check(err error) {\n  if err != nil {\n    fmt.Println(\"Error:\" + err.Error())\n    os.Exit(1)\n  }\n}\n</code></pre>\n\n<p>I need a fmt.Println(???) where the comment // PRINT MESSAGE HERE is. How can I do this? Thanks.</p>\n"}, {"tags": ["go", "xml-parsing"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1516618830, "post_id": 48379837, "comment_id": 83746520, "body": "... And you actually don&#39;t need the <code>serverInstance</code> type inbetween (<a href=\"https://play.golang.org/p/roGyLMocTwJ\" rel=\"nofollow noreferrer\">play.golang.org/p/roGyLMocTwJ</a>) This: <code>ServerList []serverInfo `xml:&quot;serverList&gt;server&quot;`</code> is enough."}, {"owner": {"reputation": 92, "user_id": 2131647, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HcC92.jpg?s=128&g=1", "display_name": "TheROX", "link": "https://stackoverflow.com/users/2131647/therox"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516619093, "post_id": 48379837, "comment_id": 83746695, "body": "@mkopriva Thank you for your help, but first example returns list with null values. Second one is ok."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516619190, "post_id": 48379837, "comment_id": 83746784, "body": "You&#39;re right, my bad, deleting it now."}], "answers": [{"comments": [{"owner": {"reputation": 92, "user_id": 2131647, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HcC92.jpg?s=128&g=1", "display_name": "TheROX", "link": "https://stackoverflow.com/users/2131647/therox"}, "edited": false, "score": 0, "creation_date": 1516618619, "post_id": 48379881, "comment_id": 83746388, "body": "Thanks a lot. I&#39;ve misunderstands xml arrays. That is the right answer."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 1, "last_activity_date": 1516703720, "last_edit_date": 1516703720, "creation_date": 1516618376, "answer_id": 48379881, "question_id": 48379837, "link": "https://stackoverflow.com/questions/48379837/go-xml-unmarshal-get-only-last-item-of-list/48379881#48379881", "title": "Go xml.Unmarshal get only last item of list", "body": "<p>The XML does not have a list of <code>ServerList</code>, instead <code>ServerList</code> contains a list of <code>Server</code>.</p>\n\n<p>You need to change your structs to the following:</p>\n\n<pre><code>type serverInstance struct {\n    Server []serverInfo `xml:\"server\"`\n}\n\ntype operationGetServerListResponce struct {\n    ReturnCode int              `xml:\"returnCode\"`\n    Message    string           `xml:\"message\"`\n    ServerList serverInstance   `xml:\"serverList\"`\n}\n</code></pre>\n\n<p>This will properly output all servers:</p>\n\n<pre><code> {ReturnCode:0 Message: ServerList:{Server:[{ServerID:1 NauServer:Main\n ServerIP:1.1.1.1 ServerPort:8080 ServerPortFtp:25 ServerHome:true\n ServerIsOnline:true} {ServerID:2 NauServer:Reg1 ServerIP:1.1.1.2\n ServerPort:8080 ServerPortFtp:25 ServerHome:false\n ServerIsOnline:false} {ServerID:3 NauServer:Res1 ServerIP:1.1.1.3\n ServerPort:8080 ServerPortFtp:25 ServerHome:false\n ServerIsOnline:false} {ServerID:4 NauServer:Res2 ServerIP:1.1.1.4\n ServerPort:8080 ServerPortFtp:25 ServerHome:false\n ServerIsOnline:true}]}}\n</code></pre>\n"}], "owner": {"reputation": 92, "user_id": 2131647, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/HcC92.jpg?s=128&g=1", "display_name": "TheROX", "link": "https://stackoverflow.com/users/2131647/therox"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 0, "accepted_answer_id": 48379881, "answer_count": 1, "score": 0, "last_activity_date": 1516703720, "creation_date": 1516618252, "last_edit_date": 1516618464, "question_id": 48379837, "link": "https://stackoverflow.com/questions/48379837/go-xml-unmarshal-get-only-last-item-of-list", "title": "Go xml.Unmarshal get only last item of list", "body": "<p>there!</p>\n\n<p>I'm parsing xml document and unmarshal it's contents to the struct, but it returns only last item from the list instead of full list.</p>\n\n<p>The list is <code>serverList</code> and after unmarshalling it returns only last <code>server</code> instance. Need help.</p>\n\n<pre><code>func main() {\n    xmlFile := `&lt;?xml version=\"1.0\" encoding=\"UTF-8\" standalone=\"yes\"?&gt;\n    &lt;operationGetServerList&gt;\n      &lt;returnCode&gt;0&lt;/returnCode&gt;\n      &lt;message&gt;&lt;/message&gt;\n      &lt;serverList&gt;\n      &lt;server&gt;\n          &lt;serverId&gt;1&lt;/serverId&gt;\n          &lt;nauServer&gt;Main&lt;/nauServer&gt;\n          &lt;serverIp&gt;1.1.1.1&lt;/serverIp&gt;\n          &lt;serverPort&gt;8080&lt;/serverPort&gt;\n          &lt;serverPortFtp&gt;25&lt;/serverPortFtp&gt;\n          &lt;serverHome&gt;true&lt;/serverHome&gt;\n          &lt;serverIsOnline&gt;true&lt;/serverIsOnline&gt;\n        &lt;/server&gt;\n        &lt;server&gt;\n          &lt;serverId&gt;2&lt;/serverId&gt;\n          &lt;nauServer&gt;Reg1&lt;/nauServer&gt;\n          &lt;serverIp&gt;1.1.1.2&lt;/serverIp&gt;\n          &lt;serverPort&gt;8080&lt;/serverPort&gt;\n          &lt;serverPortFtp&gt;25&lt;/serverPortFtp&gt;\n          &lt;serverHome&gt;false&lt;/serverHome&gt;\n          &lt;serverIsOnline&gt;false&lt;/serverIsOnline&gt;\n        &lt;/server&gt;\n      &lt;/serverList&gt;\n    &lt;/operationGetServerList&gt;`\n\n    type serverInfo struct {\n        ServerID       string `xml:\"serverId\"`\n        NauServer      string `xml:\"nauServer\"`\n        ServerIP       string `xml:\"serverIp\"`\n        ServerPort     int    `xml:\"serverPort\"`\n        ServerPortFtp  int    `xml:\"serverPortFtp\"`\n        ServerHome     bool   `xml:\"serverHome\"`\n        ServerIsOnline bool   `xml:\"serverIsOnline\"`\n    }\n\n    type serverInstance struct {\n        Server serverInfo `xml:\"server\"`\n    }\n\n    type operationGetServerListResponce struct {\n        ReturnCode int              `xml:\"returnCode\"`\n        Message    string           `xml:\"message\"`\n        ServerList []serverInstance `xml:\"serverList\"`\n    }\n\n    var sL operationGetServerListResponce\n    err := xml.Unmarshal([]byte(xmlFile), &amp;sL)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Printf(\"%+v\", sL)\n\n}\n</code></pre>\n\n<p>Prints:</p>\n\n<pre><code>{ReturnCode:0 Message: ServerList:[{Server:{ServerID:4 NauServer:Res2 ServerIP:1.1.1.4 ServerPort:8080 ServerPortFtp:25 ServerHome:false ServerIsOnline:true}}]}\n</code></pre>\n"}, {"tags": ["json", "dictionary", "go", "slice"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516610452, "post_id": 48377503, "comment_id": 83741727, "body": "If you don&#39;t know the model (and for some reason don&#39;t want to know?), then no you don&#39;t have a choice: you have to reflect over it. However, you&#39;re saying this is a json response from a webserver, I&#39;m sure the model is described somewhere."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1516610479, "post_id": 48377503, "comment_id": 83741742, "body": "If your type assertion works, then you obviously <i>do</i> know the data structure."}, {"owner": {"reputation": 313, "user_id": 9239185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3586d9a7d60fc4007416053c1e3e73f7?s=128&d=identicon&r=PG&f=1", "display_name": "MengCheng Wei", "link": "https://stackoverflow.com/users/9239185/mengcheng-wei"}, "edited": false, "score": 0, "creation_date": 1516611026, "post_id": 48377503, "comment_id": 83741984, "body": "In fact I can model it, but it is a very complex format and it is not a public API which changes a lot. So I monitor the http request/response and write code to automate it"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1516614904, "last_edit_date": 1516614904, "creation_date": 1516610479, "answer_id": 48377560, "question_id": 48377503, "link": "https://stackoverflow.com/questions/48377503/is-there-any-convenient-way-to-get-json-element-without-type-assertion/48377560#48377560", "title": "Is there any convenient way to get JSON element without type assertion?", "body": "<p>If you model your JSON object with a struct and you unmarshal into a value of that, then you don't need those ugly indices and type assertions, you can simply refer to struct fields.<br>\nNote that you don't have to be afraid of the response being complex, you only need to model the parts you intend to use. E.g. if the response is an object with a hundred fields but you only need 2, then create a struct containing only those 2 fields.</p>\n\n<p>If you don't want to model your JSON object (or can't because it's dynamic), then you may write a general utility function which gets a value based on the <em>path</em> (series of map keys and slice indices), which you can see in this answer: <a href=\"https://stackoverflow.com/questions/28877512/taking-a-json-string-unmarshaling-it-into-a-mapstringinterface-editing-an/28878037#28878037\">Taking a JSON string, unmarshaling it into a map[string]interface{}, editing, and marshaling it into a []byte seems more complicated then it should be</a></p>\n\n<p>And last you may use 3rd party libs which already contain this helper functionality, such as <a href=\"https://github.com/icza/dyno\" rel=\"nofollow noreferrer\">https://github.com/icza/dyno</a> (disclosure: I'm the author).</p>\n\n<p>Using <a href=\"https://godoc.org/github.com/icza/dyno\" rel=\"nofollow noreferrer\"><code>github.com/icza/dyno</code></a>, it would look like this:</p>\n\n<pre><code>value, err := dyno.Get(response, \"body\", 4, \"data\", \"uid\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1516615812, "creation_date": 1516615812, "answer_id": 48379053, "question_id": 48377503, "link": "https://stackoverflow.com/questions/48377503/is-there-any-convenient-way-to-get-json-element-without-type-assertion/48379053#48379053", "title": "Is there any convenient way to get JSON element without type assertion?", "body": "<p>As per icza you can create struct for JSON object. But in case you are getting JSON structure you don't know from start. Then you can create a dynamic parsing using reflections for interface which will be a recursive function to parse JSON data. </p>\n\n<pre><code>func main(){\n    var data interface{}\n    err := json.Unmarshal([]bytes(file.json), &amp;data)\n    if err != nil {\n        panic(err)\n    }\n    var itemData map[string]interface{}\n    itemsMap := data.(map[string]interface{})\n    jsonParsedObject := interate(itemsMap)  \n    log.Println(jsonParsedObject)  \n}\n\nfunc iterate(data interface{}) interface{} {\n    if reflect.ValueOf(data).Kind() == reflect.Slice {\n        d := reflect.ValueOf(data)\n        tmpData := make([]interface{}, d.Len())\n        returnSlice := make([]interface{}, d.Len())\n        for i := 0; i &lt; d.Len(); i++ {\n            tmpData[i] = d.Index(i).Interface()\n        }\n        for i, v := range tmpData {\n            returnSlice[i] = iterate(v)\n        }\n        return returnSlice\n    } else if reflect.ValueOf(data).Kind() == reflect.Map {\n        d := reflect.ValueOf(data)\n        tmpData := make(map[string]interface{})\n        for _, k := range d.MapKeys() {\n            typeOfValue := reflect.TypeOf(d.MapIndex(k).Interface()).Kind()\n            if typeOfValue == reflect.Map || typeOfValue == reflect.Slice {\n                tmpData[k.String()] = iterate(d.MapIndex(k).Interface())\n            } else {\n                tmpData[k.String()] = d.MapIndex(k).Interface()\n            }\n        }\n        return tmpData\n    }\n    return data\n}\n</code></pre>\n"}], "owner": {"reputation": 313, "user_id": 9239185, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3586d9a7d60fc4007416053c1e3e73f7?s=128&d=identicon&r=PG&f=1", "display_name": "MengCheng Wei", "link": "https://stackoverflow.com/users/9239185/mengcheng-wei"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 313, "favorite_count": 0, "accepted_answer_id": 48377560, "answer_count": 2, "score": -4, "last_activity_date": 1536075975, "creation_date": 1516610290, "last_edit_date": 1536075975, "question_id": 48377503, "link": "https://stackoverflow.com/questions/48377503/is-there-any-convenient-way-to-get-json-element-without-type-assertion", "title": "Is there any convenient way to get JSON element without type assertion?", "body": "<p>There is some inconvenience while processing JSON response from a web server.</p>\n\n<p>For example, I don't know the data structure (and don't want to model it) of the JSON in advance, and just want to get the value from it!</p>\n\n<p>So, for Python, I can just write</p>\n\n<pre><code>value = response[\"body\"][4][\"data\"][\"uid\"]  //response is a dictionary\n</code></pre>\n\n<p>But for Golang, I need to do the assertion for every element!</p>\n\n<pre><code>value := response[\"body\"].([]interface{})[4].(map[string]interface{})[\"data\"].(map[string]interface{})[\"uid\"]\n//response is a map[string]interface{}\n</code></pre>\n\n<p>This is what I write in golang to get the value I need. Do you have any suggestion on it? It there any useful tips for this kind of case?</p>\n"}, {"tags": ["go", "redis"], "answers": [{"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1516610255, "creation_date": 1516610255, "answer_id": 48377491, "question_id": 48377448, "link": "https://stackoverflow.com/questions/48377448/get-queue-length-of-redis-golang/48377491#48377491", "title": "Get queue length of redis golang", "body": "<p>Use the <a href=\"https://godoc.org/github.com/go-redis/redis#IntCmd.Result\" rel=\"nofollow noreferrer\">Result</a> or <a href=\"https://godoc.org/github.com/go-redis/redis#IntCmd.Val\" rel=\"nofollow noreferrer\">Val</a> method. As documented, these return the <code>int64</code> value returned from the command.</p>\n"}, {"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": false, "score": 2, "last_activity_date": 1516610674, "last_edit_date": 1516610674, "creation_date": 1516610285, "answer_id": 48377500, "question_id": 48377448, "link": "https://stackoverflow.com/questions/48377448/get-queue-length-of-redis-golang/48377500#48377500", "title": "Get queue length of redis golang", "body": "<p>The <a href=\"https://godoc.org/github.com/go-redis/redis#IntCmd\" rel=\"nofollow noreferrer\">documentation for IntCmd</a> shows the following:</p>\n\n<pre><code>func (cmd *IntCmd) Result() (int64, error)\n\nfunc (cmd *IntCmd) Val() int64\n</code></pre>\n\n<p>So it seems you can either get the int64 value and any error to check, or just the int64 value. Is there a reason this is not sufficient?</p>\n\n<p>You can call them as follows:</p>\n\n<pre><code>// Get the value and check the error.\nif val, err := res.Result(); err != nil {\n  panic(err)\n} else {\n  fmt.Println(\"Queue length: \", val)\n}\n\n// Get the value, but ignore errors (probably a bad idea).\nfmt.Println(\"Queue length: \", res.Val())\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 206047, "user_id": 126769, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/zBsgn.png?s=128&g=1", "display_name": "nos", "link": "https://stackoverflow.com/users/126769/nos"}, "is_accepted": true, "score": 3, "last_activity_date": 1516610386, "creation_date": 1516610386, "answer_id": 48377531, "question_id": 48377448, "link": "https://stackoverflow.com/questions/48377448/get-queue-length-of-redis-golang/48377531#48377531", "title": "Get queue length of redis golang", "body": "<p>the <code>LLen</code> func looks like: <code>func (c *cmdable) LLen(key string) *IntCmd</code></p>\n\n<p>So it returns an <code>IntCmd</code> type.  <code>IntCmd</code> provides this function: <code>func (cmd *IntCmd) Val() int64</code></p>\n\n<p>So you can do e.g.</p>\n\n<pre><code>cmd := rd.LLen(\"queue_1\")\ni := cmd.Val() //i will be an int64 type\n</code></pre>\n"}], "owner": {"reputation": 1104, "user_id": 6438430, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-5VRc3dZXdns/AAAAAAAAAAI/AAAAAAAAAeI/nemPXRtg3JU/photo.jpg?sz=128", "display_name": "Ashish Tiwari", "link": "https://stackoverflow.com/users/6438430/ashish-tiwari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1613, "favorite_count": 0, "accepted_answer_id": 48377531, "answer_count": 3, "score": -4, "last_activity_date": 1516610764, "creation_date": 1516610109, "last_edit_date": 1516610764, "question_id": 48377448, "link": "https://stackoverflow.com/questions/48377448/get-queue-length-of-redis-golang", "title": "Get queue length of redis golang", "body": "<p>I am using <a href=\"https://github.com/go-redis/redis\" rel=\"nofollow noreferrer\">go-redis</a> package. I fired below query:</p>\n\n<pre><code>rd.LLen(\"queue_1\")\n</code></pre>\n\n<p>Which returning me below result with type <code>*redis.IntCmd</code>:</p>\n\n<pre><code>llen queue_1: 100001\n</code></pre>\n\n<p>Count is perfect but I want only count with type of <code>int</code>. Can anyone help? </p>\n"}, {"tags": ["if-statement", "go"], "comments": [{"owner": {"reputation": 209014, "user_id": 125816, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7f5aa40b1e7a95599c7a19451f88ff3a?s=128&d=identicon&r=PG", "display_name": "Sergio Tulentsev", "link": "https://stackoverflow.com/users/125816/sergio-tulentsev"}, "edited": false, "score": 1, "creation_date": 1516608960, "post_id": 48377128, "comment_id": 83740995, "body": "Why don&#39;t you simply extract the bodies of if/else into their own functions?"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516609256, "post_id": 48377128, "comment_id": 83741154, "body": "This is too much about personal opinion, there&#39;s no best way to do it. But Sergio is correct, just have a combined <code>countLines</code> and <code>printCounts</code> function that only takes a file."}, {"owner": {"reputation": 71, "user_id": 7265332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYaM7.jpg?s=128&g=1", "display_name": "Jason Yu", "link": "https://stackoverflow.com/users/7265332/jason-yu"}, "edited": false, "score": 0, "creation_date": 1516610319, "post_id": 48377128, "comment_id": 83741668, "body": "Thanks, I tried and it&#39;s really make a compact code."}], "answers": [{"tags": [], "owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "is_accepted": true, "score": 1, "last_activity_date": 1516609253, "creation_date": 1516609253, "answer_id": 48377249, "question_id": 48377128, "link": "https://stackoverflow.com/questions/48377128/how-to-write-dry-and-effective-if-statement-in-golang/48377249#48377249", "title": "How to write DRY and effective if-statement in golang?", "body": "<p>I don't see much repetition in your code. You could somehow merge both if and else part but I'm not a fan of.</p>\n\n<p>A simple refactor is moving <code>counts</code> initialization into your <code>countLines</code> function and make it return it.</p>\n\n<pre><code>func countLines(f *os.File, counts map[string]int)\n</code></pre>\n\n<p>-></p>\n\n<pre><code>func countLines(f *os.File) map[string]int\n</code></pre>\n\n<p>And don't think much about allocations until you are doing a lot (let's say at least 100K allocations) and profile your code before doing little optimizations. Maps will allocate memory not only on <code>make</code> but also when you append to them and their hash table is full.</p>\n"}], "owner": {"reputation": 71, "user_id": 7265332, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/DYaM7.jpg?s=128&g=1", "display_name": "Jason Yu", "link": "https://stackoverflow.com/users/7265332/jason-yu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 132, "favorite_count": 1, "accepted_answer_id": 48377249, "answer_count": 1, "score": -1, "last_activity_date": 1516609583, "creation_date": 1516608685, "last_edit_date": 1516609583, "question_id": 48377128, "link": "https://stackoverflow.com/questions/48377128/how-to-write-dry-and-effective-if-statement-in-golang", "title": "How to write DRY and effective if-statement in golang?", "body": "<p>I have following code:</p>\n\n<pre><code>func main() {\n    // counts := make(map[string]int)\n    files := os.Args[1:]\n    if len(files) == 0 {\n        counts := make(map[string]int)\n        countLines(os.Stdin, counts)\n        fmt.Println(\"os.Stdin\")\n        printCounts(counts)\n    } else {\n        for _, arg := range files {\n            counts := make(map[string]int)\n\n            f, err := os.Open(arg)\n            if err != nil {\n                fmt.Fprintf(os.Stderr, \"dup2: %v\\n\", err)\n                continue\n            }\n            countLines(f, counts)\n            f.Close()\n            // print counts of each file\n            printCounts(counts)\n        }\n    }\n}\nfunc printCounts(counts map[string]int) {\n    //...\n}\nfunc countLines(f *os.File, counts map[string]int){\n    //...\n}\n</code></pre>\n\n<p>where i repeat myself in if-else statement by initiating counts dict twice,\n(<code>counts := make(map[string]int)</code>) both in if and else.</p>\n\n<p>My question is what is the gopher-way of writing this?</p>\n\n<p>Is that better to do the allocation outside the if-else statment with <code>new</code> and do initiation in every block?</p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 8235, "user_id": 1284760, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/2f0d151197270b75a2c5e5bf6a2a6583?s=128&d=identicon&r=PG", "display_name": "see sharper", "link": "https://stackoverflow.com/users/1284760/see-sharper"}, "is_accepted": false, "score": 4, "last_activity_date": 1516591381, "creation_date": 1516591381, "answer_id": 48374278, "question_id": 48374170, "link": "https://stackoverflow.com/questions/48374170/difference-between-plain-go-func-and-for-loop-in-go-func/48374278#48374278", "title": "Difference between plain go func and for loop in go func", "body": "<p>In nearly any case, performance is not the thing to think about in choosing which pattern to use (both will be fine), but which usage makes sense in your specific use case. If you use pattern (1), then you are not guaranteed the sequential processing of (2). That is the essential difference between your two examples. So for an http server for example, you would use the former pattern (<code>go handleRequest(r HttpRequest)</code> say) to process requests in parallel, but use the latter to ensure that certain operations are processed sequentially. I hope this is answering your question!</p>\n"}, {"tags": [], "owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "is_accepted": true, "score": 1, "last_activity_date": 1516596274, "creation_date": 1516596274, "answer_id": 48374803, "question_id": 48374170, "link": "https://stackoverflow.com/questions/48374170/difference-between-plain-go-func-and-for-loop-in-go-func/48374803#48374803", "title": "Difference between plain go func and for loop in go func", "body": "<p>You can use model #1 with WaitGroups when you have goroutines for which you need to account for and are bothered only about their exit and as such otherwise don't need to manage etc. </p>\n\n<p>You can use model #2 when you need explicit management / control / communication. Channel communication is NOT free - sending and receiving routines need synchronization/channels need locking when values are sent, lot of things will have to happen under the hood. </p>\n\n<p>Unless the need be, definitely option #1 is the way to go. See what's the simplest possible solution for your problem - I know it's easy to preach, but simplicity may take some time to come by.</p>\n"}, {"tags": [], "owner": {"reputation": 1193, "user_id": 3168185, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/iWFTu.jpg?s=128&g=1", "display_name": "Bayu", "link": "https://stackoverflow.com/users/3168185/bayu"}, "is_accepted": false, "score": 1, "last_activity_date": 1516623787, "last_edit_date": 1516623787, "creation_date": 1516619804, "answer_id": 48380330, "question_id": 48374170, "link": "https://stackoverflow.com/questions/48374170/difference-between-plain-go-func-and-for-loop-in-go-func/48380330#48380330", "title": "Difference between plain go func and for loop in go func", "body": "<p>In short, from that what i know, 2 pattern you mentioned above is not something to really compare which one to use or which one is better. Both of them just have different use case with different necessity.</p>\n\n<p><strong>From what i know, it is not about</strong> </p>\n\n<blockquote>\n  <p>plain go func and for loop in go func</p>\n</blockquote>\n\n<p>It is more to different usage.</p>\n\n<p>Before answering your question, i like to try give short explanation about two pattern you mentioned. </p>\n\n<ol>\n<li>The first pattern is a very basic <code>go</code> statement usage. Which just will execute function outside its main thread. As <strong>basic</strong> usage of concurrency in go, this pattern design doesn't have a way to get data from executed function with <code>go</code> statement. Can't be from <code>main()</code> thread or any other function. In order to <strong>communicate</strong> with any other function / thread its needs <code>channel</code>. You already mention <strong>one</strong> pattern form several <code>go</code> with <code>channel</code> pattern available.</li>\n<li><p>Just like what i mentioned earlier, this second pattern is just one of several <code>go</code> with <code>channel</code> pattern in Golang in usage with <code>go</code> statement. Actually this one is quite complex pattern which main usage is for <strong>selecting from multiple channels</strong> and will do further things with those channels. I will give some slight explanation about this pattern as folow: </p>\n\n<ul>\n<li>The <code>for</code> loop there has no conditional statement which will work similarly like <code>while</code> loop at any other language like C or Java. It is mean an endless loop.</li>\n<li>Since it is endless loop, it is need a condition which usually check from the available channels to check. For example, something like when a channel is closed it will be end.</li>\n<li><p>Regarding <code>select</code> and <code>case</code> statement, if two or more communication cases happen to be ready at the same time, one will be selected at random</p></li>\n<li><p>Even you need to communicate between concurrent/asynchronous functions running, i guess you not need it in general. Generally there is more simple pattern to communicate the threads by using channel.</p></li>\n</ul></li>\n</ol>\n\n<p><strong>In summary to answer your questions:</strong></p>\n\n<ol>\n<li>Which method is better to do asynchronous task is really depend on your necessity. There are several pattern which not limited to you have mentioned above. If you need just do execute function asynchronously first pattern will be fine otherwise you need one from <code>channel</code> pattern way available. But again, not limited to 2nd pattern you mentioned above</li>\n<li>Both pattern you mentioned looks as common practices for me. But i guess usually we often need at least a <code>channel</code> in order to communicate an asynchronous task with <code>main()</code> thread or any other thread. And the pattern it self really depend on how you will communicate (send/receive) the data/values sources (Database, slices variables etc.) and more other aspect. I suggest you learn more about the usage of <code>channel</code> there are lot patterns to do with that. I suggest to check this first <a href=\"https://gobyexample.com/goroutines\" rel=\"nofollow noreferrer\">https://gobyexample.com/goroutines</a>. Start from there you see at the bottom of page the \"Next Example\" which will getting deeper about go concurrency things. </li>\n</ol>\n\n<p><strong>As addition:</strong></p>\n\n<p><code>go</code> statement is simple, the complex things is about the usage with <code>channel</code>. Here is i make list you better to learn in order to have better understanding about concurrency communication.</p>\n\n<ul>\n<li>goroutine</li>\n<li>Channel direction ( Send / Receive / unidirectional )</li>\n<li>Channel concept / behavior which is <strong>communicating sequential\nprocesses (CSP)</strong> . It is some kind about \"block\" and \"proceed\" behavior of send/receive behavior.</li>\n<li>Buffered channel</li>\n<li>Unbuffered channel</li>\n<li>And more about channel :)</li>\n</ul>\n\n<p>Hope this helps you or some one to start with goroutine and channel to works with concurrency in Golang. Please feel free if some one like to give corrections to my answer or ask further explanation about it. Thank you.</p>\n"}], "owner": {"reputation": 127, "user_id": 2640254, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d1d2cfb9ebec74fb56ae6d4ebeea3dec?s=128&d=identicon&r=PG", "display_name": "user2640254", "link": "https://stackoverflow.com/users/2640254/user2640254"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 386, "favorite_count": 0, "accepted_answer_id": 48374803, "answer_count": 3, "score": 0, "last_activity_date": 1516623787, "creation_date": 1516590320, "last_edit_date": 1516607475, "question_id": 48374170, "link": "https://stackoverflow.com/questions/48374170/difference-between-plain-go-func-and-for-loop-in-go-func", "title": "Difference between plain go func and for loop in go func", "body": "<p>I have some question regarding difference between plain go func and for loop in go func:</p>\n\n<ol>\n<li><p>Plain go Func:</p>\n\n<pre><code>func asyncTask(){\n    //...something\n}\n</code></pre>\n\n<p>in order to trigger asyncTask, we can simply:</p>\n\n<pre><code>func main(){\n    go asyncTask()\n}\n</code></pre></li>\n<li><p>make a for loop to monitor channel:</p>\n\n<pre><code>func (c *Container) asyncTask(){\n    go func(){\n        for {\n            select {\n                case &lt;- c.someChan:\n                    //...do something\n                case &lt;-c.ctx.Done():\n                    //...prevent leaking\n            }\n        }\n    }()\n}\n</code></pre>\n\n<p>to trigger:</p>\n\n<pre><code>func (c *Container) trigger(){\n    c.someChan &lt;- val\n}\n</code></pre></li>\n</ol>\n\n<p>My questions are:</p>\n\n<ol>\n<li><p>I understand second scenario most fit the case when we wish to manage async task in a queue.\nBut speaking for performance out of frequently triggered async task (which cannot be block), which method is better?</p></li>\n<li><p>Is there any best practice in general to handle async task in GoLang?</p></li>\n</ol>\n"}, {"tags": ["go", "logging", "kubernetes"], "comments": [{"owner": {"reputation": 7134, "user_id": 1078969, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1ee458f0818af1b8669af687c277c6a1?s=128&d=identicon&r=PG", "display_name": "whites11", "link": "https://stackoverflow.com/users/1078969/whites11"}, "edited": false, "score": 0, "creation_date": 1516604183, "post_id": 48373638, "comment_id": 83739017, "body": "Please show the manifest that runs your pod and the output of <code>kubectl describe po &lt;podname&gt;</code>"}, {"owner": {"reputation": 2951, "user_id": 2736817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38f596a60d51c899ee86eaec38ec8efe?s=128&d=identicon&r=PG&f=1", "display_name": "tom10271", "link": "https://stackoverflow.com/users/2736817/tom10271"}, "reply_to_user": {"reputation": 7134, "user_id": 1078969, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1ee458f0818af1b8669af687c277c6a1?s=128&d=identicon&r=PG", "display_name": "whites11", "link": "https://stackoverflow.com/users/1078969/whites11"}, "edited": false, "score": 0, "creation_date": 1516611342, "post_id": 48373638, "comment_id": 83742131, "body": "<code>Please show the manifest that runs your pod</code> &lt;= my deployment config or what?"}, {"owner": {"reputation": 7134, "user_id": 1078969, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/1ee458f0818af1b8669af687c277c6a1?s=128&d=identicon&r=PG", "display_name": "whites11", "link": "https://stackoverflow.com/users/1078969/whites11"}, "edited": false, "score": 0, "creation_date": 1516611391, "post_id": 48373638, "comment_id": 83742149, "body": "you deployment, yes"}], "answers": [{"comments": [{"owner": {"reputation": 2951, "user_id": 2736817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38f596a60d51c899ee86eaec38ec8efe?s=128&d=identicon&r=PG&f=1", "display_name": "tom10271", "link": "https://stackoverflow.com/users/2736817/tom10271"}, "edited": false, "score": 0, "creation_date": 1516611295, "post_id": 48377658, "comment_id": 83742112, "body": "Assuming <code>app-deployment</code> is the pod name, when I <code>kubectl describe deployments app-deployment</code>, it returns <code>Error from server (NotFound): deployments.extensions &quot;app-deployment&quot; not found</code>"}, {"owner": {"reputation": 1759, "user_id": 218846, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e60e4b1e05b2c325da8a5d296fef5779?s=128&d=identicon&r=PG", "display_name": "tex", "link": "https://stackoverflow.com/users/218846/tex"}, "reply_to_user": {"reputation": 2951, "user_id": 2736817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38f596a60d51c899ee86eaec38ec8efe?s=128&d=identicon&r=PG&f=1", "display_name": "tom10271", "link": "https://stackoverflow.com/users/2736817/tom10271"}, "edited": false, "score": 0, "creation_date": 1516611715, "post_id": 48377658, "comment_id": 83742320, "body": "The deployment won&#39;t contain any errors (or at least it shouldn&#39;t). You should describe the pod to see any errors, not the deployment. A deployment is just an object the creates pods (through ReplicaSets). These pods run and may fail. So the pods contain the errors (if any)."}, {"owner": {"reputation": 2951, "user_id": 2736817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38f596a60d51c899ee86eaec38ec8efe?s=128&d=identicon&r=PG&f=1", "display_name": "tom10271", "link": "https://stackoverflow.com/users/2736817/tom10271"}, "edited": false, "score": 0, "creation_date": 1516612130, "post_id": 48377658, "comment_id": 83742559, "body": "Nothing special when I describe the pod. When I <code>kubectl logs --previous my-pod</code> it returns <code>Error from server (BadRequest): the server rejected our request for an unknown reason (get pods my-pod)</code>"}], "tags": [], "owner": {"reputation": 1759, "user_id": 218846, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/e60e4b1e05b2c325da8a5d296fef5779?s=128&d=identicon&r=PG", "display_name": "tex", "link": "https://stackoverflow.com/users/218846/tex"}, "is_accepted": false, "score": 0, "last_activity_date": 1516610909, "creation_date": 1516610909, "answer_id": 48377658, "question_id": 48373638, "link": "https://stackoverflow.com/questions/48373638/i-have-a-golang-application-running-on-kubernetes-but-when-the-pod-dies-there-a/48377658#48377658", "title": "I have a Golang application running on Kubernetes, but when the pod dies there are no error message at all. What should I do?", "body": "<p>First you should inspect the pod to see the reason why it died and if it was restarted.</p>\n\n<pre><code>kubectl describe pod my-go-app-deployment-1967699436-yxxn7\n</code></pre>\n\n<p>Look for entries in <em>Containers -> your container -> Last State</em>.</p>\n\n<p>If it was restarted you might want to check the previous logs as well:</p>\n\n<pre><code>kubectl logs --previous pod my-go-app-deployment-1967699436-yxxn7\n</code></pre>\n"}], "owner": {"reputation": 2951, "user_id": 2736817, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/38f596a60d51c899ee86eaec38ec8efe?s=128&d=identicon&r=PG&f=1", "display_name": "tom10271", "link": "https://stackoverflow.com/users/2736817/tom10271"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 396, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516610909, "creation_date": 1516585029, "question_id": 48373638, "link": "https://stackoverflow.com/questions/48373638/i-have-a-golang-application-running-on-kubernetes-but-when-the-pod-dies-there-a", "title": "I have a Golang application running on Kubernetes, but when the pod dies there are no error message at all. What should I do?", "body": "<p>As titled.</p>\n\n<p>When I run <code>kubectl logs my-go-app-deployment-1967699436-yxxn7</code> or <code>kubectl logs my-go-app-deployment-1967699436-yxxn7 -p</code>, there are no error log print out at all.</p>\n\n<p>What should I do? What makes a Golang pods crashes?</p>\n"}, {"tags": ["go", "build", "command", "temp", "corrupted-state-exception"], "comments": [{"owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1516582889, "post_id": 48373170, "comment_id": 83733878, "body": "truncating and appending <code>~1</code>, <code>~2</code>, etc was how late versions of DOS truncated long file names from Windows 9x, but that shouldn&#39;t be happening here. What is the value of <code>%TEMP%</code>?"}, {"owner": {"reputation": 81, "user_id": 6736782, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-PIPrywRRpMY/AAAAAAAAAAI/AAAAAAAAAF8/Tw3hL099Llo/photo.jpg?sz=128", "display_name": "Lucas A.", "link": "https://stackoverflow.com/users/6736782/lucas-a"}, "reply_to_user": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1516582943, "post_id": 48373170, "comment_id": 83733892, "body": "Well I have Windows 8, if that helps at all"}, {"owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1516583272, "post_id": 48373170, "comment_id": 83733978, "body": "Can you try <code>echo %TEMP%</code> (or <code>echo $Env:TEMP</code> in powershell)? It could be something screwed up the value of your <code>TEMP</code> environment variable."}, {"owner": {"reputation": 81, "user_id": 6736782, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-PIPrywRRpMY/AAAAAAAAAAI/AAAAAAAAAF8/Tw3hL099Llo/photo.jpg?sz=128", "display_name": "Lucas A.", "link": "https://stackoverflow.com/users/6736782/lucas-a"}, "reply_to_user": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1516583367, "post_id": 48373170, "comment_id": 83734001, "body": "<code>echo %TEMP%</code> outputs <code>C:\\Users\\LUCAS_~1\\AppData\\Local\\Temp</code>   <code>echo $Env:TEMP</code> outputs <code>$Env:TEMP</code>"}, {"owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1516583404, "post_id": 48373170, "comment_id": 83734007, "body": "Well, there is your problem. Reset <code>TEMP</code> to the real path, and it should work."}, {"owner": {"reputation": 81, "user_id": 6736782, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-PIPrywRRpMY/AAAAAAAAAAI/AAAAAAAAAF8/Tw3hL099Llo/photo.jpg?sz=128", "display_name": "Lucas A.", "link": "https://stackoverflow.com/users/6736782/lucas-a"}, "reply_to_user": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1516584442, "post_id": 48373170, "comment_id": 83734240, "body": "Even after resetting <code>TEMP</code>, <code>echo %TEMP%</code> outputs:  <code>C:\\Users\\LUCAS_~1\\AppData\\Local\\Temp</code>   I changed <code>TEMP</code> in the Environment variables and I used:   <code>setx TEMP C:\\Users\\LUCAS_000\\AppData\\Local\\Temp</code>  And so when I try <code>go version</code>, again it outputs:  <code>mkdir C:\\Users\\LUCAS_~1\\AppData\\Local\\Temp\\go-build407496999: The file or directory is corrupted and unreadable.</code>"}, {"owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1516584523, "post_id": 48373170, "comment_id": 83734264, "body": "You may need to restart your computer, at a minimum you need to restart your command interpreter."}, {"owner": {"reputation": 81, "user_id": 6736782, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-PIPrywRRpMY/AAAAAAAAAAI/AAAAAAAAAF8/Tw3hL099Llo/photo.jpg?sz=128", "display_name": "Lucas A.", "link": "https://stackoverflow.com/users/6736782/lucas-a"}, "reply_to_user": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "edited": false, "score": 0, "creation_date": 1516584638, "post_id": 48373170, "comment_id": 83734304, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/163606/discussion-between-lucas-a-and-milo-christiansen\">continue this discussion in chat</a>."}], "answers": [{"comments": [{"owner": {"reputation": 81, "user_id": 6736782, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-PIPrywRRpMY/AAAAAAAAAAI/AAAAAAAAAF8/Tw3hL099Llo/photo.jpg?sz=128", "display_name": "Lucas A.", "link": "https://stackoverflow.com/users/6736782/lucas-a"}, "edited": false, "score": 0, "creation_date": 1516584500, "post_id": 48373511, "comment_id": 83734255, "body": "Even after resetting <code>TEMP</code>, <code>echo %TEMP%</code> outputs:  <code>C:\\Users\\LUCAS_~1\\AppData\\Local\\Temp</code>   I changed <code>TEMP</code> in the Environment variables and I used:   <code>setx TEMP C:\\Users\\LUCAS_000\\AppData\\Local\\Temp</code>  And so when I try <code>go version</code>, again it outputs:  <code>mkdir C:\\Users\\LUCAS_~1\\AppData\\Local\\Temp\\go-build407496999: The file or directory is corrupted and unreadable.</code>"}], "tags": [], "owner": {"reputation": 2776, "user_id": 1094529, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/glcan.png?s=128&g=1", "display_name": "Milo Christiansen", "link": "https://stackoverflow.com/users/1094529/milo-christiansen"}, "is_accepted": false, "score": 0, "last_activity_date": 1516583863, "creation_date": 1516583863, "answer_id": 48373511, "question_id": 48373170, "link": "https://stackoverflow.com/questions/48373170/whenever-i-try-any-command-using-go-the-output-says-that-my-go-build-is-corrupt/48373511#48373511", "title": "Whenever I try any command using go, the output says that my go-build is corrupted and unreadable", "body": "<p>My first guess (confirmed in the comments) is that the <code>TEMP</code> environment variable is set to a DOS 8.3 path, truncating the user name using the DOS rules. How this came to be, I have no idea.</p>\n\n<p>Fixing the problem is simple: Change <code>TEMP</code> to the full path.</p>\n\n<p>The easy way is to open a command prompt and run the following:</p>\n\n<pre><code>setx TEMP C:\\Users\\LUCAS_000\\AppData\\Local\\Temp\n</code></pre>\n\n<p>The slightly harder (but clearer) way (for Windows 8) is to follow the following sequence:</p>\n\n<pre><code>Start -&gt; All Apps -&gt; Control panel -&gt; System -&gt;\nAdvanced System Settings -&gt; Advanced -&gt; Environment variables\n</code></pre>\n"}], "owner": {"reputation": 81, "user_id": 6736782, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh4.googleusercontent.com/-PIPrywRRpMY/AAAAAAAAAAI/AAAAAAAAAF8/Tw3hL099Llo/photo.jpg?sz=128", "display_name": "Lucas A.", "link": "https://stackoverflow.com/users/6736782/lucas-a"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 79, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516583863, "creation_date": 1516580782, "question_id": 48373170, "link": "https://stackoverflow.com/questions/48373170/whenever-i-try-any-command-using-go-the-output-says-that-my-go-build-is-corrupt", "title": "Whenever I try any command using go, the output says that my go-build is corrupted and unreadable", "body": "<p>Whenever I run any go command at all (other than <code>go help</code>) the output is this:</p>\n\n<pre><code>mkdir C:\\Users\\LUCAS_~1\\AppData\\Local\\Temp\\go-build268335003: The file or \ndirectory is corrupted and unreadable.\n</code></pre>\n\n<p>I'm not sure why this is happening, I've tried restarting, and that temporarily fixes it, but then after a couple of commands are executed, this starts happening again. I'm not sure if this will help, but my username is not <code>LUCAS_~1</code> it's <code>Lucas_000</code>. Also, I've checked my <code>Temp</code> folder, and there doesn't seem to be anything named \"go-build268335003\".</p>\n\n<p>Any help would be  appreciated, thanks!</p>\n"}, {"tags": ["datetime", "go"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 1, "creation_date": 1516581218, "post_id": 48372947, "comment_id": 83733537, "body": "You have a typo in your <code>IsDate</code> function: <code>date.Day() == date.Day()</code> should be <code>date.Day() == today.Day()</code>."}, {"owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "reply_to_user": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1516581360, "post_id": 48372947, "comment_id": 83733561, "body": "@muistooshort Can&#39;t believe I did that, spent way too much time debugging. Thank you for the catch"}, {"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 2, "creation_date": 1516581445, "post_id": 48372947, "comment_id": 83733580, "body": "The trickiest bugs are often hiding right out in the open, hence the &quot;fresh eyes&quot; and &quot;talking to the wall&quot; debugging techniques."}], "answers": [{"comments": [{"owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "edited": false, "score": 0, "creation_date": 1516581725, "post_id": 48373205, "comment_id": 83733625, "body": "This is better, I&#39;ll switch to it. Wouldn&#39;t you be able to simplify tommorow to <code>tommorow := time.Now().AddDate(0,0,1)</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "edited": false, "score": 1, "creation_date": 1516582208, "post_id": 48373205, "comment_id": 83733713, "body": "The goal is to calculate the time af beginning of the day.  The expression <code>time.Now().AddDate(0,0,1)</code> evaluates to the current time tomorrow."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1516581682, "last_edit_date": 1516581682, "creation_date": 1516581157, "answer_id": 48373205, "question_id": 48372947, "link": "https://stackoverflow.com/questions/48372947/cannot-iterate-through-days-past-the-end-of-year-in-golangs-time-package/48373205#48373205", "title": "Cannot iterate through days past the end of year in Golang&#39;s Time package", "body": "<p>Calculate tomorrow's date and iterate while <code>curr</code> is before that date:</p>\n\n<pre><code>now := time.Now()\ntomorrow := time.Date(now.Year(), now.Month(), now.Day(), 0, 0, 0, 0, now.Location()).AddDate(0, 0, 1)\nfor curr := t1; curr.Before(tomorrow); curr = curr.AddDate(0, 0, 1) {\n    fmt.Println(curr)\n}\n</code></pre>\n\n<p>Iterating while <code>!IsToday(curr)</code> (with typo corrected) is fragile because it will loop forever if the starting time is after the current time.</p>\n"}], "owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 420, "favorite_count": 0, "accepted_answer_id": 48373205, "answer_count": 1, "score": 0, "last_activity_date": 1516581682, "creation_date": 1516578534, "question_id": 48372947, "link": "https://stackoverflow.com/questions/48372947/cannot-iterate-through-days-past-the-end-of-year-in-golangs-time-package", "title": "Cannot iterate through days past the end of year in Golang&#39;s Time package", "body": "<p>I'm trying to iterate through days between 2 dates. One date is <code>time.Parse(\"2006-01-02\", \"2017-08-24\")</code> another is <code>time.Now()</code> but my loop seems to be stopping at the turn of the year and I can't figure out why.</p>\n\n<pre><code>func IsToday(date time.Time) bool {\n    today := time.Now()\n    return date.Year() == today.Year() &amp;&amp;\n           date.Month() == today.Month() &amp;&amp;\n           date.Day() == date.Day()\n}\n\nt1, _ := time.Parse(\"2006-01-02\", \"2017-08-24\")\n\nfor curr := t1; !IsToday(curr); curr = curr.AddDate(0,0,1) {\n        fmt.Println(curr)\n}\n</code></pre>\n\n<p>The loop prints out:</p>\n\n<pre><code>2017-08-24 00:00:00 +0000 UTC\n2017-08-25 00:00:00 +0000 UTC\n2017-08-26 00:00:00 +0000 UTC\n2017-08-27 00:00:00 +0000 UTC\n2017-08-28 00:00:00 +0000 UTC\n2017-08-29 00:00:00 +0000 UTC\n2017-08-30 00:00:00 +0000 UTC\n2017-08-31 00:00:00 +0000 UTC\n2017-09-01 00:00:00 +0000 UTC\n2017-09-02 00:00:00 +0000 UTC\n...\n2017-12-18 00:00:00 +0000 UTC\n2017-12-19 00:00:00 +0000 UTC\n2017-12-20 00:00:00 +0000 UTC\n2017-12-21 00:00:00 +0000 UTC\n2017-12-22 00:00:00 +0000 UTC\n2017-12-23 00:00:00 +0000 UTC\n2017-12-24 00:00:00 +0000 UTC\n2017-12-25 00:00:00 +0000 UTC\n2017-12-26 00:00:00 +0000 UTC\n2017-12-27 00:00:00 +0000 UTC\n2017-12-28 00:00:00 +0000 UTC\n2017-12-29 00:00:00 +0000 UTC\n2017-12-30 00:00:00 +0000 UTC\n2017-12-31 00:00:00 +0000 UTC\n</code></pre>\n\n<p>Notice how it does not iterate till today's date. Testing the AddDate individually as <code>time.Parse(\"2006-01-02\", \"2017-12-31\").AddDate(0,0,1)</code> does result in <code>2018-01-01</code>. </p>\n"}, {"tags": ["go", "cgo", "cflags", "ldflags"], "comments": [{"owner": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 1, "creation_date": 1516578487, "post_id": 48372518, "comment_id": 83732987, "body": "Is the example correct? Where is <code>C.loadConfigDirectory</code> defined?"}, {"owner": {"reputation": 3, "user_id": 1541290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d74f824e270ebf417810f3dfec9de4e?s=128&d=identicon&r=PG", "display_name": "thylong", "link": "https://stackoverflow.com/users/1541290/thylong"}, "reply_to_user": {"reputation": 5565, "user_id": 3915, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ccd658bdf42cb1145386e10bf3da116a?s=128&d=identicon&r=PG", "display_name": "Mark", "link": "https://stackoverflow.com/users/3915/mark"}, "edited": false, "score": 0, "creation_date": 1516611806, "post_id": 48372518, "comment_id": 83742375, "body": "I amended the walker.h, I made a typo sorry"}], "answers": [{"comments": [{"owner": {"reputation": 2364, "user_id": 4206629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ea9a378d5409478f2717aae6354396?s=128&d=identicon&r=PG", "display_name": "YongHao Hu", "link": "https://stackoverflow.com/users/4206629/yonghao-hu"}, "reply_to_user": {"reputation": 3, "user_id": 1541290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d74f824e270ebf417810f3dfec9de4e?s=128&d=identicon&r=PG", "display_name": "thylong", "link": "https://stackoverflow.com/users/1541290/thylong"}, "edited": false, "score": 0, "creation_date": 1516682508, "post_id": 48374349, "comment_id": 83776239, "body": "@thylong Can you give the implementation? I doubt that you don&#39;t implement <code>loadConfig</code>."}], "tags": [], "owner": {"reputation": 2364, "user_id": 4206629, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ea9a378d5409478f2717aae6354396?s=128&d=identicon&r=PG", "display_name": "YongHao Hu", "link": "https://stackoverflow.com/users/4206629/yonghao-hu"}, "is_accepted": false, "score": 0, "last_activity_date": 1516592214, "creation_date": 1516592214, "answer_id": 48374349, "question_id": 48372518, "link": "https://stackoverflow.com/questions/48372518/undefined-reference-to-error-only-for-certain-functions/48374349#48374349", "title": "undefined reference to error only for certain functions", "body": "<p>In <code>walker.h</code> , the export function is \n<code>void* loadConfig(const char *filePath, char* errorMessageBuffer, int bufferLen);</code></p>\n\n<p>And you used <code>C.loadConfigDirectory(pathPtr, errorMessageBuffer, bufferLen)</code>.</p>\n\n<p>The function <code>loadConfigDirectory</code> is not defined.</p>\n\n<p>Maybe it is a typo?</p>\n\n<p>Working version works because <code>versionString</code> is already defined.</p>\n"}], "owner": {"reputation": 3, "user_id": 1541290, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d74f824e270ebf417810f3dfec9de4e?s=128&d=identicon&r=PG", "display_name": "thylong", "link": "https://stackoverflow.com/users/1541290/thylong"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 235, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516611771, "creation_date": 1516574984, "last_edit_date": 1516611771, "question_id": 48372518, "link": "https://stackoverflow.com/questions/48372518/undefined-reference-to-error-only-for-certain-functions", "title": "undefined reference to error only for certain functions", "body": "<p>I have a library and a C interface built for it.\nMy program compiles just fine with <code>versionString()</code> but not with <code>loadConfig()</code>. How is that possible?</p>\n\n<p><strong>walker.h</strong> :</p>\n\n<pre><code>#ifndef WFE_C_H\n#define WFE_C_H\n\n#ifdef __cplusplus\nextern \"C\" {\n#endif\n\n  const char* versionString();\n\n  void* loadConfig(const char *filePath, char* errorMessageBuffer, int bufferLen);\n\n#ifdef __cplusplus\n}\n#endif\n\n#endif\n</code></pre>\n\n<p><strong>Working version</strong>:</p>\n\n<pre><code>package main\n\n/*\n#cgo CFLAGS: -Isrc/walker\n#cgo LDFLAGS: -L${SRCDIR}/lib -lwalker\n#include \"walker.h\"\n*/\nimport (\n    \"C\"\n)\nfunc main() {\n    p := C.versionString()\n    version := C.GoString(p)\n    fmt.Println(version)\n}\n// output: v1.94\n</code></pre>\n\n<p><strong>Not working version</strong>:</p>\n\n<pre><code>package main\n\n/*\n#cgo CFLAGS: -Isrc/walker\n#cgo LDFLAGS: -L${SRCDIR}/lib -lwalker\n#include \"walker.h\"\n*/\nimport (\n    \"C\"\n)\nfunc main() {\n    errorMessageBuffer := C.CString(\"\")\n    pathPtr := C.CString(\"/src/vali/config\")\n    bufferLen := C.int(len(4000))\n\n    C.loadConfig(pathPtr, errorMessageBuffer, bufferLen)\n}\n</code></pre>\n\n<p><strong>Traceback</strong>:</p>\n\n<pre><code>/tmp/go-build056292810/github.com/testong/vali/_obj/main.cgo2.o: In \nfunction `_cgo_b2bd1c9e3dda_Cfunc_loadConfig':\n/tmp/go-build/github.com/testong/vali/_obj/cgo-gcc-prolog:43: undefined \nreference to `loadConfig'\ncollect2: error: ld returned 1 exit status\n</code></pre>\n"}, {"tags": ["docker", "go", "timestamp"], "comments": [{"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1516570895, "post_id": 48371903, "comment_id": 83730958, "body": "You could use a ticker, start the ticker in a gorountine above everything. Set the ticker to tick every 5 minutes. On the first tick. Os.Exit(0), <a href=\"https://gobyexample.com/tickers\" rel=\"nofollow noreferrer\">gobyexample.com/tickers</a>. That should allow you to stop the long running process in 5 minutes"}, {"owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "reply_to_user": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1516570928, "post_id": 48371903, "comment_id": 83730968, "body": "@reticentroot Can you give me an example?"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1516570955, "post_id": 48371903, "comment_id": 83730977, "body": "check out the Go example link above on how to use tickers.  The example has the gist on how to start one. Mod it to your needs"}], "answers": [{"tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": true, "score": 0, "last_activity_date": 1516571644, "last_edit_date": 1516571644, "creation_date": 1516571336, "answer_id": 48372048, "question_id": 48371903, "link": "https://stackoverflow.com/questions/48371903/how-do-i-add-five-minutes-to-a-timestamp-in-golang/48372048#48372048", "title": "How do I add five minutes to a timestamp in Golang?", "body": "<p>Here's another example of how to use a Timer in Go. You could spin up your timer. Set it <code>time.Minute * 5</code> then run your long running process.  When the timer ticks send the quit signal to exit the program. It's important to use os.Exit() vs return as return will exit the gorountine not the program.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"time\"\n)\n\nfunc main() {\n    timer := time.NewTimer(time.Second)\n    go func() {\n        &lt;-timer.C\n        fmt.Println(\"Quiting\")\n        os.Exit(0)\n    }()\n\n    // long running proccess\n    for {\n\n    }\n\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user7885981"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 632, "favorite_count": 0, "accepted_answer_id": 48372048, "answer_count": 1, "score": 2, "last_activity_date": 1516571644, "creation_date": 1516570117, "question_id": 48371903, "link": "https://stackoverflow.com/questions/48371903/how-do-i-add-five-minutes-to-a-timestamp-in-golang", "title": "How do I add five minutes to a timestamp in Golang?", "body": "<p>I am wondering how to add time to a timestamp. The intention is to be able to get the current timestamp, add five minutes to it, then show the new one. I am trying to stop the output after five minutes then stop the docker container. I am doing this because I am running a process that never stops in the container and I want it to stop after five minutes of running.</p>\n\n<pre><code>out, err := cli.ContainerLogs(ctx, resp.ID, types.ContainerLogsOptions{ShowStdout: true, ShowStderr: true, Follow: true, Until: /* Code Here */})\nif err != nil {\n    panic(err)\n}\n\nio.Copy(os.Stdout, out)\n\nif err := cli.ContainerStop(ctx, resp.ID, nil); err != nil {\n    panic(err)\n}\n</code></pre>\n"}, {"tags": ["json", "api", "go", "vcf-vcard"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516565525, "post_id": 48371222, "comment_id": 83729275, "body": "Add a comment to the code indicating the line that panics."}, {"owner": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516565935, "post_id": 48371222, "comment_id": 83729429, "body": "commented the line where panic is occurring"}, {"owner": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516569086, "post_id": 48371222, "comment_id": 83730486, "body": "&quot;card vcard.Card&quot; card is a map. And card.SetValue is assigning the value"}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "edited": false, "score": 0, "creation_date": 1516570234, "post_id": 48371222, "comment_id": 83730777, "body": "<code>var card vcard.Card</code> you have created this as a global but you haven&#39;t initialized it. <code>var card = make(vcard.Card)</code>"}], "answers": [{"tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": true, "score": 1, "last_activity_date": 1516570342, "creation_date": 1516570342, "answer_id": 48371941, "question_id": 48371222, "link": "https://stackoverflow.com/questions/48371222/http-panic-serving-157685-assignment-to-entry-in-nil-map/48371941#48371941", "title": "http: panic serving [::1]:57685: assignment to entry in nil map", "body": "<p>You haven't initialized your map. I suggest you read up on how maps work in Go <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow noreferrer\">https://blog.golang.org/go-maps-in-action</a></p>\n\n<p>In the meantime </p>\n\n<pre><code>var card vcard.Card\n</code></pre>\n\n<p>should be </p>\n\n<pre><code>var card = make(vcard.Card)\n</code></pre>\n\n<p>I'm not familiar with the vcard data structure. But you mention that it should be a map -> string][]*vcard.Field.. If the above make fails change it to</p>\n\n<pre><code>var card = make(map[string][]*vcard.Field)\n</code></pre>\n"}], "owner": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 699, "favorite_count": 1, "accepted_answer_id": 48371941, "answer_count": 1, "score": 2, "last_activity_date": 1516570342, "creation_date": 1516565361, "last_edit_date": 1516565793, "question_id": 48371222, "link": "https://stackoverflow.com/questions/48371222/http-panic-serving-157685-assignment-to-entry-in-nil-map", "title": "http: panic serving [::1]:57685: assignment to entry in nil map", "body": "<p>I am trying to make a vcard using golang.My code is:</p>\n\n<pre><code>    var (\n    // card is a map of strings to []*vcard.Field objects\n    card vcard.Card\n\n    // destination where the vcard will be encoded to\n    enc = vcard.NewEncoder(destFile) \n)\nvar str []string\n\n\nfor i, entry := range k {\n\n\n    if i!=2{\n        str=append(str,k[i])\n\n\n        card.SetValue(vcard.FieldFormattedName, strings.Join(str[:i],\"\"))//panic occurs here\n        fmt.Println(str)\n\n    }else if i==2{\n        card.SetValue(vcard.FieldTelephone, entry)\n    }else{\n        card.SetValue(vcard.FieldOrganization, entry)\n    }\n\n\n\n\n    // set the value of a field and other parameters by using card.Set\n    card.Set(vcard.FieldName, &amp;vcard.Field{\n        Value: strings.Join(str[:2], \";\"),\n        Params: map[string][]string{\n            vcard.ParamSortAs: []string{\n                k[0] + \" \" + k[1],\n            },\n        },\n    })\n</code></pre>\n\n<p>The json document which has to be stored in vcf is:</p>\n\n<pre><code>      {\"firstname\":\"Vilas\",\"lastname\":\"Prakash\",\"mobile\":\"8732647482\",\"organisation\":\"Dbjb\"}\n</code></pre>\n\n<p>I have marshalled the json to []string.On executing I am getting the following error:</p>\n\n<pre><code>    http: panic serving [::1]:57685: assignment to entry in nil map\n</code></pre>\n\n<p>Can anyone help me???Or Is there any other way of creating .vcf or vcard in golang using json document as input???</p>\n"}, {"tags": ["go", "append"], "answers": [{"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 4, "last_activity_date": 1516558586, "last_edit_date": 1516558586, "creation_date": 1516556062, "answer_id": 48369714, "question_id": 48369508, "link": "https://stackoverflow.com/questions/48369508/trying-to-delete-successive-items-in-string-array-using-append/48369714#48369714", "title": "Trying to delete successive items in string array using append", "body": "<p>As the spec say:</p>\n\n<blockquote>\n  <p>The append built-in function appends elements to the end of a slice. If it has sufficient capacity, the destination is resliced to accommodate the new elements. If it does not, a new underlying array will be allocated. Append returns the updated slice. </p>\n</blockquote>\n\n<p>In your case, the underlying slice is always sufficient, so it modifies it every time. The result is expectable according to the spec.</p>\n\n<p>The s/fruit of each loop:</p>\n\n<pre><code>[banana orange kiwi ananas] [banana orange kiwi ananas ananas]\n[banana kiwi ananas ananas] [banana kiwi ananas ananas ananas]\n[banana kiwi ananas ananas] [banana kiwi ananas ananas ananas]\n[banana kiwi ananas ananas] [banana kiwi ananas ananas ananas]\n[banana kiwi ananas ananas] [banana kiwi ananas ananas ananas]\n</code></pre>\n"}], "owner": {"reputation": 3, "user_id": 9248052, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d5001cb600f9e92a443f6bd93654add0?s=128&d=identicon&r=PG&f=1", "display_name": "V. Kovaks", "link": "https://stackoverflow.com/users/9248052/v-kovaks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 43, "favorite_count": 0, "accepted_answer_id": 48369714, "answer_count": 1, "score": 0, "last_activity_date": 1516607551, "creation_date": 1516554888, "last_edit_date": 1516607551, "question_id": 48369508, "link": "https://stackoverflow.com/questions/48369508/trying-to-delete-successive-items-in-string-array-using-append", "title": "Trying to delete successive items in string array using append", "body": "<p>I have trouble understanding the following result. I am expecting the code  </p>\n\n<pre><code>package main\nimport \"fmt\"\n\nfunc main() {\n    fruits := []string{\"apple\", \"banana\", \"orange\", \"kiwi\", \"ananas\"}\n    for i, _ := range fruits {\n        s := append(fruits[:i], fruits[i+1:]...)\n        fmt.Println(s)\n    }\n}\n</code></pre>\n\n<p>to return : </p>\n\n<pre><code>[banana orange kiwi ananas]\n[apple orange kiwi ananas]\n[apple banana kiwi ananas]\n[apple banana orange ananas]\n[apple banana orange kiwi]\n</code></pre>\n\n<p>instead it returns : </p>\n\n<pre><code>[banana orange kiwi ananas]\n[banana kiwi ananas ananas]\n[banana kiwi ananas ananas]\n[banana kiwi ananas ananas]\n[banana kiwi ananas ananas]\n</code></pre>\n\n<p>what am i missing?\nNote: I am note looking for code that returns the expected behavior, just trying to understand what the code does. \nPlayground : <a href=\"https://play.golang.org/p/CB73GYvY7aW\" rel=\"nofollow noreferrer\">https://play.golang.org/p/CB73GYvY7aW</a></p>\n"}, {"tags": ["go", "redis", "cron", "synchronization"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516556443, "post_id": 48369069, "comment_id": 83726180, "body": "Use a <a href=\"https://redis.io/topics/transactions\" rel=\"nofollow noreferrer\">transaction</a> to ensure the operations are atomic."}], "owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 248, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516552448, "creation_date": 1516552448, "question_id": 48369069, "link": "https://stackoverflow.com/questions/48369069/synchronize-separate-processes-with-using-redis", "title": "Synchronize separate processes with using redis", "body": "<p>I have four separate instances of a server running and I want only one of them to run a query every 5 seconds. The problem I am having is that they seem to be able to check the redis key that i have set for the last time the query was run so quickly that multiple instances run my query at the same time.</p>\n\n<p>Im using a package cron for go:</p>\n\n<pre><code>c.AddFunc(config.CronInterval, func() {\n    KeyExpired(redisClient, cronInterval)\n})\nc.Start()\n</code></pre>\n\n<p>Here is my KeyExpired func</p>\n\n<pre><code>var CronInterval = \"@every 5s\"\nfunc KeyExpired(redisClient *redis.Client, cronInterval time.Duration) bool {\n    //Convert the duration in the config to seconds\n    cronIntervalSeconds := int64(cronInterval.Seconds())\n    //Get the last value that was set as reporting time\n    rval := redisClient.Get(\"StatReporting\")\n    if rval.Err() != nil {\n        redisClient.Set(\"StatReporting\", time.Now().UTC().Format(timeFormat), 0)\n        return false\n    }\n    lastRun, err := time.Parse(timeFormat, rval.Val())\n    if err != nil {\n        log.Error(err.Error())\n        redisClient.Set(\"StatReporting\", time.Now().UTC().Format(timeFormat), 0)\n        return false\n    }\n\n    if (time.Now().UTC().Unix() - lastRun.UTC().Unix()) &gt;= cronIntervalSeconds {\n        fmt.Println(config.Port, time.Now().UTC().Unix())\n        redisClient.Set(\"StatReporting\", time.Now().Add(time.Second).UTC().Format(timeFormat), 0)\n        return true\n    } else {\n        fmt.Println(config.Port, \"WAITING\")\n        return false\n    }\n}\n</code></pre>\n\n<p>And here is the output with 4 instances running:</p>\n\n<pre><code>5559 1516551859\n5558 1516551859\n5777 WAITING\n9999 WAITING\n5559 WAITING\n5558 WAITING\n5777 1516551865\n9999 WAITING\n5559 WAITING\n5558 WAITING\n5777 WAITING\n9999 1516551872\n5559 WAITING\n5558 WAITING\n5777 WAITING\n9999 WAITING\n5558 1516551879\n5559 1516551879\n5777 WAITING\n9999 WAITING\n5559 WAITING\n5558 WAITING\n5777 1516551885\n9999 WAITING\n5558 WAITING\n5559 WAITING\n5777 WAITING\n</code></pre>\n"}, {"tags": ["go", "gomock"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516537215, "post_id": 48366328, "comment_id": 83719911, "body": "I don&#39;t think mockgen can be used to mock a global scope function."}], "answers": [{"comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1516619608, "post_id": 48372347, "comment_id": 83747043, "body": "Looks good, I&#39;ll have to inform the owners of the function being checked.  Once I&#39;ve implemented the test I&#39;ll accept the answer, upvote etc etc"}], "tags": [], "owner": {"reputation": 9701, "user_id": 5165332, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/93c5b8f16dce739cd7e4336034e1f76c?s=128&d=identicon&r=PG&f=1", "display_name": "Eugene Lisitsky", "link": "https://stackoverflow.com/users/5165332/eugene-lisitsky"}, "is_accepted": true, "score": 2, "last_activity_date": 1516573534, "creation_date": 1516573534, "answer_id": 48372347, "question_id": 48366328, "link": "https://stackoverflow.com/questions/48366328/using-mockgen-in-reflect-mode/48372347#48372347", "title": "Using mockgen in reflect mode", "body": "<p>I\u2019ve had the same task recently. Also tried to mock, but finally make in another way. </p>\n\n<p>You can make a function accepting <code>Read</code> function and returning your target function <code>GetRandomBytes</code>. Like:</p>\n\n<pre><code>func MakeRandomBytesGetter(fn func([]byte) (int,error)) func(int)([]bute,error) {\n    return func(n int) ([]byte, error) {\n\n        b := make([]byte, n)\n        _, err := fn(b)\n\n        if err != nil {\n            log.Error(\"Failed to get entropy from system\", err)\n            return nil, err\n        }\n\n        return b, nil\n    }\n}\n\nvar (\n    GetRamdomBytes = MakeRandomBytesGetter(rand.Read)\n)\n</code></pre>\n\n<p>For tests you can use different functions with the same signature but another behavior. Like:</p>\n\n<pre><code>func FailRead(n int) ([]byte, error) {\n    return []byte{}, fmt.Errorf(\"Read failed\")\n}\n</code></pre>\n\n<p>And check you function behavior when it gets such errors. </p>\n"}], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 937, "favorite_count": 1, "accepted_answer_id": 48372347, "answer_count": 1, "score": 2, "last_activity_date": 1516573534, "creation_date": 1516534601, "question_id": 48366328, "link": "https://stackoverflow.com/questions/48366328/using-mockgen-in-reflect-mode", "title": "Using mockgen in reflect mode", "body": "<p>I am trying to write some tests for an existing library but cannot get gomock to work</p>\n\n<p>I would like to test behaviour if rand.Read fails.  Here is an example of what I would like to test.  I would like to see the log.Error line executing in test </p>\n\n<pre><code>import (\n     \"crypto/rand\"\n)\n    func GetRandomBytes(n int) ([]byte, error) {\n\n        b := make([]byte, n)\n        _, err := rand.Read(b)\n\n        if err != nil {\n            log.Error(\"Failed to get entropy from system\", err)\n            return nil, err\n        }\n\n        return b, nil\n    }\n</code></pre>\n\n<p>The gomock system should let me force the \"rand.Read\" call to do the right thing</p>\n\n<p>However, I cannot get the mockgen tool to work in \"reflect\" mode</p>\n\n<pre><code>$ $GOPATH/bin/mockgen 'crypto/rand' Read\n# command-line-arguments\n./prog.go:22:28: invalid indirect of \"crypto/rand\".Read (type func([]byte) (int, error))\n2018/01/21 11:20:30 Loading input failed: exit status 2\n</code></pre>\n\n<p>I'm using \ngo version go1.9.2 linux/amd64 on Ubuntu 14.04</p>\n\n<p><code>genmock -prog_only 'crypto/rand' Read</code>   works fine, but the code it generates doesn't look useful for what I need to do</p>\n"}, {"tags": ["database", "go", "go-gorm"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1516603038, "post_id": 48366245, "comment_id": 83738641, "body": "The <a href=\"http://jinzhu.me/gorm/crud.html#preloading-eager-loading\" rel=\"nofollow noreferrer\">doc</a> stated that <code>Preload</code> is other name for <i>eager loading</i> (the opposite of <i>lazy loading</i>). Using <code>Preload</code> only make sense for JOIN query, e.g. joining <code>person</code> and <code>occupation</code>. In this case, you can <code>Preload</code> the <code>occupation</code> (load all the occupation records) while finding for certain person(s)."}], "owner": {"reputation": 18004, "user_id": 675100, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/jTqPB.png?s=128&g=1", "display_name": "Patryk", "link": "https://stackoverflow.com/users/675100/patryk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1578, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516533903, "creation_date": 1516533903, "question_id": 48366245, "link": "https://stackoverflow.com/questions/48366245/gorm-db-cant-preload-field-currencies-for-model-currency", "title": "gorm.DB can&#39;t preload field currencies for model.Currency", "body": "<p>I was looking through <code>gorm.DB</code>'s docs and sources but can't seem to understand the purpose of <code>Preload</code>.</p>\n\n<p>I thought that is the \"preloaded schema/tables/rows\" that you can use afterwards\" but cannot somehow use it that way.</p>\n\n<p>For instance I have the following <code>struct</code></p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>package model\n\ntype Currency struct {\n  ID           uint64 `gorm:\"primary_key\"`\n  CurrencyCode string `gorm:\"size:3\"`\n}\n</code></pre>\n\n<p>but when I do something like this to compare <code>Find</code> and <code>Preload</code></p>\n\n<pre><code>logger.Info(\"Preload\")\nvar preloadCurrencies []model.Currency\ndbMySQL.Preload(\"currencies\").Find(&amp;preloadCurrencies)\nfor i, curr := range preloadCurrencies {\n    // stuff\n}\n\nlogger.Info(\"find\")\nvar currencies []model.Currency\ndbMySQL.Find(&amp;currencies)\nfor i, curr := range currencies {\n    // stuff\n}\n</code></pre>\n\n<p>I get the following (with ):</p>\n\n<pre><code>INFO[0000] Preload\n(/go/src/SOMESOURCES/main.go:28)\n[2018-01-21 11:08:47]  [1.02ms]  SELECT * FROM `currencies`\n[168 rows affected or returned ]\n(/go/src/SOMESOURCES/main.go:28)\n[2018-01-21 11:08:47]  can't preload field currencies for model.Currency\nINFO[0000] find\n(/go/src/SOMESOURCES/main.go:37)\n[2018-01-21 11:08:47]  [0.90ms]  SELECT * FROM `currencies`\n[168 rows affected or returned ]\n</code></pre>\n\n<p>DB schema:</p>\n\n<pre><code>show columns from currencies;\n+---------------+---------------------+------+-----+---------+----------------+\n| Field         | Type                | Null | Key | Default | Extra          |\n+---------------+---------------------+------+-----+---------+----------------+\n| id            | bigint(20) unsigned | NO   | PRI | NULL    | auto_increment |\n| currency_code | char(3)             | NO   |     | NULL    |                |\n+---------------+---------------------+------+-----+---------+----------------+\n2 rows in set (0.00 sec)\n</code></pre>\n"}, {"tags": ["docker", "go", "alpine"], "answers": [{"comments": [{"owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "edited": false, "score": 2, "creation_date": 1516569603, "post_id": 48366359, "comment_id": 83730614, "body": "The first link helped a lot. This seems sufficient <code>env GOOS=linux GARCH=amd64 CGO_ENABLED=0 go install -v -a -installsuffix cgo</code>. The Github issue at <a href=\"https://github.com/golang/go/issues/9344#issuecomment-69944514\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/9344#issuecomment-69944514</a> shows the solution also."}, {"owner": {"reputation": 8398, "user_id": 2217862, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/061bdb74aa4a543108658b277a257b4b?s=128&d=identicon&r=PG", "display_name": "Jakub Jirutka", "link": "https://stackoverflow.com/users/2217862/jakub-jirutka"}, "edited": false, "score": 0, "creation_date": 1516633482, "post_id": 48366359, "comment_id": 83756135, "body": "Alpine v3.3 is three years old and not supported anymore. You should link the recent version, which is <a href=\"https://pkgs.alpinelinux.org/package/v3.7/main/x86/ca-certificates\" rel=\"nofollow noreferrer\">pkgs.alpinelinux.org/package/v3.7/main/x86/ca-certificates</a>."}], "tags": [], "owner": {"reputation": 2476, "user_id": 5788720, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-tkE-8jM--HE/AAAAAAAAAAI/AAAAAAAAAEw/g51C7_m9JWU/photo.jpg?sz=128", "display_name": "Iain Duncan", "link": "https://stackoverflow.com/users/5788720/iain-duncan"}, "is_accepted": true, "score": 5, "last_activity_date": 1516717573, "last_edit_date": 1516717573, "creation_date": 1516534797, "answer_id": 48366359, "question_id": 48366173, "link": "https://stackoverflow.com/questions/48366173/how-do-i-build-a-static-go-binary-for-the-docker-alpine-image/48366359#48366359", "title": "How do I build a static Go binary for the Docker Alpine image?", "body": "<p>Yes, you often need to add extra resource files like certificates especially when using a minimal distribution like alpine but the fact that you can run go applications on such small distributions is often also seen as an advantage.</p>\n\n<p>To add the certificates this is a really good explanation outlining how to do it on a scratch container:</p>\n\n<p><a href=\"https://blog.codeship.com/building-minimal-docker-containers-for-go-applications/\" rel=\"noreferrer\">https://blog.codeship.com/building-minimal-docker-containers-for-go-applications/</a></p>\n\n<p>If you would rather stick with alpine then you can install this package to get them:</p>\n\n<p><a href=\"https://pkgs.alpinelinux.org/package/v3.7/main/x86/ca-certificates\" rel=\"noreferrer\">https://pkgs.alpinelinux.org/package/v3.7/main/x86/ca-certificates</a></p>\n"}], "owner": {"reputation": 3946, "user_id": 736070, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/2ffe94c53681b5b72e448cd8a575e687?s=128&d=identicon&r=PG", "display_name": "Dan", "link": "https://stackoverflow.com/users/736070/dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10421, "favorite_count": 2, "accepted_answer_id": 48366359, "answer_count": 1, "score": 6, "last_activity_date": 1516717573, "creation_date": 1516533360, "question_id": 48366173, "link": "https://stackoverflow.com/questions/48366173/how-do-i-build-a-static-go-binary-for-the-docker-alpine-image", "title": "How do I build a static Go binary for the Docker Alpine image?", "body": "<p>I want to build a Go 1.9.2 binary and run it on the Docker Alpine image. The Go code I wrote doesn't call any C code. It also uses the <code>net</code> package. Unfortunately it hasn't been as simple as it sounds as Go doesn't seem to quite build static binaries all the time. When I try to execute the binary I often get cryptic messages for why the binary didn't execute. There's quite a bit of information on the internet about this but most of it ends up with people using trial an error to make their binaries work.</p>\n\n<p>So far I have found the following works, however I don't know why, if it is optimal or if it could be simplified.</p>\n\n<pre><code>env GOOS=linux GARCH=amd64 go install -v -a -tags netgo -installsuffix netgo -ldflags \"-linkmode external -extldflags -static\"\n</code></pre>\n\n<p>What is the canonical way (if it exists) to build a Go binary that will run on the Alpine 3.7 docker image? I am happy to use <code>apk</code> to install packages to the Alpine image if that would make things more efficient/easier. (Believe I need to install <code>ca-certificates</code> anyway.)</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1516490172, "post_id": 48362043, "comment_id": 83710978, "body": "It&#39;s not possible in the same <i>scope</i>, but you can create arbitrary scopes with curly braces <a href=\"https://play.golang.org/p/M47wcq2cCZO\" rel=\"nofollow noreferrer\">play.golang.org/p/M47wcq2cCZO</a>."}, {"owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516490230, "post_id": 48362043, "comment_id": 83710995, "body": "@mkopriva is this bad practice?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1516490280, "post_id": 48362043, "comment_id": 83711006, "body": "Not sure if it&#39;s bad, but it most certainly isn&#39;t good. The proper way would be the one you don&#39;t want to take."}, {"owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1516490359, "post_id": 48362043, "comment_id": 83711021, "body": "@mkopriva yeah didn&#39;t think so either. Thanks, I&#39;ll go stick to the second approach."}], "answers": [{"comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516492170, "post_id": 48362230, "comment_id": 83711425, "body": "What&#39;s the point of <code>var curr string</code> if you&#39;re redeclaring it in the <code>if</code>&#39;s scope? Or did you mean to use <code>=</code> and have <code>err</code> also declared outside?"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516492985, "post_id": 48362230, "comment_id": 83711591, "body": "that was <code>err</code> being defined. In multiple assignments, either one of the left-hand tokens that&#39;s being declared/defined needs a <code>:=</code> and <code>err</code> was never declared elsewhere. If we wanted to throw away <code>err</code> like <code>curr, _ = ...</code> then <code>=</code> makes sense."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1516494146, "post_id": 48362230, "comment_id": 83711822, "body": "Not really true, at least not if the redeclaration is happening in a new scope, even if it&#39;s a subscope <a href=\"https://play.golang.org/p/o6pN0R13RQM\" rel=\"nofollow noreferrer\">play.golang.org/p/o6pN0R13RQM</a>"}, {"owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516501206, "post_id": 48362230, "comment_id": 83713020, "body": "@mkopriva you&#39;re right. Both variables were defined and <code>curr</code> shadowed over the global one."}], "tags": [], "owner": {"reputation": 5586, "user_id": 1965774, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/e7KDB.gif?s=128&g=1", "display_name": "Pie &#39;Oh&#39; Pah", "link": "https://stackoverflow.com/users/1965774/pie-oh-pah"}, "is_accepted": true, "score": 2, "last_activity_date": 1516501267, "last_edit_date": 1516501267, "creation_date": 1516491587, "answer_id": 48362230, "question_id": 48362043, "link": "https://stackoverflow.com/questions/48362043/reassigning-different-type-to-variables-in-go/48362230#48362230", "title": "Reassigning different type to variables in Go", "body": "<p>You are trying to force duck-typing here, and Go is statically-typed so that's going to be hairy or impossible. This justifies having another variable:</p>\n\n<pre><code>if temp, ok := foo()[\"blah\"].(string); ok {\n        curr, err := strconv.ParseFloat(temp, 64)\n        if err != nil {\n                panic(err)\n        }\n}\n</code></pre>\n\n<p>Go garbage collector is pretty sick. Having an extra variable <code>temp</code> for a few lines isn't that bad. Also don't forget guarding over type assertion.</p>\n"}], "owner": {"reputation": 987, "user_id": 4107796, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/04f749980bc28bc2f23547d739b38d85?s=128&d=identicon&r=PG&f=1", "display_name": "jack sexton", "link": "https://stackoverflow.com/users/4107796/jack-sexton"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 949, "favorite_count": 0, "accepted_answer_id": 48362230, "answer_count": 1, "score": -1, "last_activity_date": 1516501267, "creation_date": 1516490015, "question_id": 48362043, "link": "https://stackoverflow.com/questions/48362043/reassigning-different-type-to-variables-in-go", "title": "Reassigning different type to variables in Go", "body": "<p>Looking to do something like this</p>\n\n<pre><code>curr := foo()[\"blah\"].(string)\ncurr, err := strconv.ParseFloat(curr, 64)\n</code></pre>\n\n<p><code>ERROR: cannot assign float64 to curr (type string) in multiple assignment</code></p>\n\n<p>I dont want to make another temporary variable that I won't use after the conversion. I'm fairly new to Go so is there an approach that will help me avoid</p>\n\n<pre><code>temp := foo()[\"blah\"].(string)\ncurr, err := strconv.ParseFloat(temp, 64)\n</code></pre>\n"}, {"tags": ["bash", "go", "environment-variables"], "comments": [{"owner": {"reputation": 11092, "user_id": 8794221, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/81e2de0a8497383ad1889e87d91adc91?s=128&d=identicon&r=PG&f=1", "display_name": "Allan", "link": "https://stackoverflow.com/users/8794221/allan"}, "edited": false, "score": 2, "creation_date": 1516511605, "post_id": 48361893, "comment_id": 83714588, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/13046624/how-to-permanently-export-a-variable-in-linux\">How to permanently export a variable in Linux?</a>"}, {"owner": {"reputation": 9303, "user_id": 2767626, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/5f74cbf47c5fa12d9a045cabb5c2e0e2?s=128&d=identicon&r=PG&f=1", "display_name": "Tobias Gassmann", "link": "https://stackoverflow.com/users/2767626/tobias-gassmann"}, "edited": false, "score": 0, "creation_date": 1516701599, "post_id": 48361893, "comment_id": 83785439, "body": "why was this quesiton put on hold? It is a valid question on how to make environment variables permanant. This is not a question limited to Super User since it is a daily task for developers also."}, {"owner": {"reputation": 962, "user_id": 5208088, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0b9ad0a35608d37b10dd4d08352ad70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mnemosyne", "link": "https://stackoverflow.com/users/5208088/mnemosyne"}, "edited": false, "score": 0, "creation_date": 1516833169, "post_id": 48361893, "comment_id": 83856833, "body": "I know how to make variables permanent and setting the path. The problem is Go variables do not seem to persist whatever I do."}, {"owner": {"reputation": 378, "user_id": 1485415, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0e5be08a8fff700b794336f44c2a5216?s=128&d=identicon&r=PG&f=1", "display_name": "philoj", "link": "https://stackoverflow.com/users/1485415/philoj"}, "edited": false, "score": 1, "creation_date": 1605688325, "post_id": 48361893, "comment_id": 114724860, "body": "Actually, you can run <code>$ go env -w GOROOT=&#47;usr&#47;lib&#47;go-1.9&#47;</code> theses days to make the value permanent. I think this question would be useful since it is the best way to set the go environment"}], "answers": [{"comments": [{"owner": {"reputation": 962, "user_id": 5208088, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0b9ad0a35608d37b10dd4d08352ad70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mnemosyne", "link": "https://stackoverflow.com/users/5208088/mnemosyne"}, "edited": false, "score": 0, "creation_date": 1516833114, "post_id": 48362192, "comment_id": 83856810, "body": "I did that but the change did not persist for new terminals."}, {"owner": {"reputation": 66, "user_id": 6010135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e2a110a464491041a6fffb99450427?s=128&d=identicon&r=PG&f=1", "display_name": "Pastello", "link": "https://stackoverflow.com/users/6010135/pastello"}, "reply_to_user": {"reputation": 962, "user_id": 5208088, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0b9ad0a35608d37b10dd4d08352ad70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mnemosyne", "link": "https://stackoverflow.com/users/5208088/mnemosyne"}, "edited": false, "score": 1, "creation_date": 1549487606, "post_id": 48362192, "comment_id": 95924136, "body": "Try adding those two lines also at the bottom of ~/.bashrc"}], "tags": [], "owner": {"reputation": 66, "user_id": 6010135, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/72e2a110a464491041a6fffb99450427?s=128&d=identicon&r=PG&f=1", "display_name": "Pastello", "link": "https://stackoverflow.com/users/6010135/pastello"}, "is_accepted": true, "score": 3, "last_activity_date": 1516491294, "creation_date": 1516491294, "answer_id": 48362192, "question_id": 48361893, "link": "https://stackoverflow.com/questions/48361893/how-to-set-go-environment-variables-globally/48362192#48362192", "title": "How to set Go environment variables globally", "body": "<p>As explained <a href=\"https://unix.stackexchange.com/questions/117467/how-to-permanently-set-environmental-variables\">here</a> you just need to include exports \n<code>export GOROOT=/usr/lib/go-1.9/</code>\n<code>export GOPATH=/my/workspace/go</code>\nat the bottom of the file ~/.profile in your home directory</p>\n"}], "owner": {"reputation": 962, "user_id": 5208088, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/0b9ad0a35608d37b10dd4d08352ad70c?s=128&d=identicon&r=PG&f=1", "display_name": "Mnemosyne", "link": "https://stackoverflow.com/users/5208088/mnemosyne"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10807, "favorite_count": 1, "closed_date": 1516525467, "accepted_answer_id": 48362192, "answer_count": 1, "score": -3, "last_activity_date": 1605694030, "creation_date": 1516488629, "last_edit_date": 1605694030, "question_id": 48361893, "link": "https://stackoverflow.com/questions/48361893/how-to-set-go-environment-variables-globally", "closed_reason": "Not suitable for this site", "title": "How to set Go environment variables globally", "body": "<p>when I declare my Go environment (namely GOPATH and GOROOT using simple export):</p>\n<pre><code>export GOROOT=/usr/lib/go-1.9/\nexport GOPATH=/my/workspace/go\n</code></pre>\n<p>The current terminal recognizes the variables normally, but if I open another terminal window, these variables are not set and they need to be reconfigured from scratch.</p>\n<p>Is there a go-specific way to set default values for go environment variables other than common ways like editing the .bashrc file?</p>\n"}, {"tags": ["mysql", "http", "go", "cookies"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516492746, "post_id": 48361801, "comment_id": 83711544, "body": "One possible approach could be something like this: <a href=\"https://play.golang.org/p/ij5Li7Pf7vc\" rel=\"nofollow noreferrer\">play.golang.org/p/ij5Li7Pf7vc</a>"}, {"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516493572, "post_id": 48361801, "comment_id": 83711709, "body": "Thank you @mkopriva, if you could add it as an answer, I will accept it."}, {"owner": {"reputation": 1338, "user_id": 2969090, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e44eb8fd2813c441b354f051042ea4e3?s=128&d=identicon&r=PG&f=1", "display_name": "Ravi", "link": "https://stackoverflow.com/users/2969090/ravi"}, "edited": false, "score": 0, "creation_date": 1516528261, "post_id": 48361801, "comment_id": 83717725, "body": "You may look at it like this - each user could possibly have a different environment, and each environment has only connection type. So there are three types here that you could be dealing with - user, environment and connection. An environment could have a connection pool too, depending on what your problem complexity is."}], "answers": [{"comments": [{"owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "edited": false, "score": 0, "creation_date": 1516513952, "post_id": 48362668, "comment_id": 83714963, "body": "Thank you. Since the said method can possibly result in a handler having 50+ methods, what else can be a good way? Is using a <code>&#47;update</code> route with an <code>EnvMaster</code> handler that accepts POST requests only considered a good practice?"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "edited": false, "score": 0, "creation_date": 1516524785, "post_id": 48362668, "comment_id": 83716871, "body": "Personally, I would define handler types that better represent the &quot;thing&quot; that they are supposed to do, e.g. a <code>loginHandler</code> with just a single <code>ServeHTTP</code> method, or a <code>userHandler</code> with a set of <code>CRUD</code> methods that only deal with the <code>user</code> resource. Then these handler types would each have a field of type <code>*Env</code> to get access to the environment."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "edited": false, "score": 1, "creation_date": 1516525318, "post_id": 48362668, "comment_id": 83716995, "body": "As far as the api design of the urls, I prefer to use HTTP methods to determine what action to take. Say you have the <code>userHandler</code> which implements the <code>http.Handler</code> interface with a <code>ServeHTTP</code> method and you&#39;ve registered it under a single path, the <code>&#47;users&#47;</code> path. Now <code>ServeHTTP</code> would check an incoming request&#39;s HTTP method, whether it&#39;s GET, POST, PATCH, DELETE and based on that decide whether to retrieve a user(s), create a user, update a user, or delete a user."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1516496389, "creation_date": 1516496389, "answer_id": 48362668, "question_id": 48361801, "link": "https://stackoverflow.com/questions/48361801/how-to-use-gos-net-http-to-distribute-requests-to-master-slave-databases-based/48362668#48362668", "title": "How to use Go&#39;s net/http to distribute requests to Master-slave Databases based on Authentication?", "body": "<p>One approach could be something like this:</p>\n\n<pre><code>type Env struct {\n    master *sql.DB\n    slave *sql.DB\n}\n\nfunc (e *Env) DB(r *http.Request) *sql.DB {\n    if _, err := r.Cookie(\"session\"); err == http.ErrNoCookie {\n            return e.slave\n        }\n        return e.master\n}\n\nfunc (e *Env) Home(w http.ResponseWriter, r *http.Request) {\n    db := e.DB(r)\n\n    // ...\n}\n</code></pre>\n\n<hr>\n\n<p><strong>NOTE:</strong> <em>The following is a presonal opinion and therefore not really SO material.</em></p>\n\n<p>Although the example above may work for you, personally I think that tacking handlers on the <code>Env</code> type is a poor design decision. If you have a tiny app with 3, 5, or 10 routes it may be ok, but if you need to scale to more than that, say 50 routes, you end up with a single type that has 50+ methods and while the methods may depend on the environment it's not really obvious, at least to me, why the environment itself should have behaviour defined on it.</p>\n\n<p>Then there's also the possibility of different handlers requiring different configuration types, or same configuration types but with different values, not only does <code>Env</code> now have 50+ methods it also has a multitude of fields that have little to nothing in common with each other. This also then allows a handler to touch stuff that it has no business touching.</p>\n\n<p>In my opinion the <code>Env</code> type should at most comprise a set of values that represent the environment in which the application is gonna run and that's it, no behaviour, or at least no more than mere predicates and getters that actually make sense as being part of the environment.</p>\n"}], "owner": {"reputation": 2755, "user_id": 3244776, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/a3E89.jpg?s=128&g=1", "display_name": "nohup", "link": "https://stackoverflow.com/users/3244776/nohup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 484, "favorite_count": 1, "accepted_answer_id": 48362668, "answer_count": 1, "score": 3, "last_activity_date": 1516496389, "creation_date": 1516487858, "question_id": 48361801, "link": "https://stackoverflow.com/questions/48361801/how-to-use-gos-net-http-to-distribute-requests-to-master-slave-databases-based", "title": "How to use Go&#39;s net/http to distribute requests to Master-slave Databases based on Authentication?", "body": "<p>Hello awesome Stackoverflow Community,</p>\n\n<p>Apologies for the lame question. I was trying to find an answer to this question for some time, and googling didn't help me much.</p>\n\n<p>I was playing around with Go's <code>net/http</code> package and was following <a href=\"http://www.alexedwards.net/blog/organising-database-access\" rel=\"nofollow noreferrer\">an article</a> on organising <code>*sql.Db</code></p>\n\n<p>After going through it, I was trying to get two <code>*sql.Db</code>types, one for master and one for slave. My intention was, for a simple route <code>/home</code>, if the <code>session</code>cookie is already set, use the master connection and let the connection go to the master server and use an RW user, and if not, use the slave connection with an RO user. I already have a wrapper struct <code>DB</code> over <code>*sql.DB</code> and a CheckSessionCookie method attached to it.</p>\n\n<pre><code>func (d *DB) CheckSessionCookie(w http.ResponseWriter, r *http.Request) (*http.Cookie) {\n    c, err := r.Cookie(\"session\")\n    if err != nil {\n    return nil\n    }\n    return c\n}\n</code></pre>\n\n<p>My routes looks like</p>\n\n<pre><code>http.HandleFunc(\"/admin\", envMaster.Admin) // Master connection's method\nhttp.HandleFunc(\"/home\", envSlave.Home) // Slave connection's method\n</code></pre>\n\n<p>However, I cannot think of an elegant way to use a different handler func if the request has a cookie already set. I was thinking, if I could read the cookie with a javascript and pass the cookie as a parameter, and use the route as </p>\n\n<pre><code>http.HandleFunc(\"/home\", envMaster.Home)\nhttp.HandleFunc(\"/home/:session\", envSlave.Home)\n</code></pre>\n\n<p>But I am not sure if that is a good way to do it, especially if <code>http only</code> flag is set to the cookie.</p>\n\n<p>How do I use a master connection if the request to \"/home\" has a session cookie already set?</p>\n\n<p>Thank you.</p>\n"}, {"tags": ["go", "dependencies", "dependency-management"], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 4602392, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ada7d6bff96c8dbed0bc6ce18800a32?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/4602392/christian"}, "edited": false, "score": 0, "creation_date": 1516549797, "post_id": 48364765, "comment_id": 83723852, "body": "Worked exactly as you described. Thank you."}], "tags": [], "owner": {"reputation": 14588, "user_id": 244393, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/55eb813499c0cf9fd47e95690782bf83?s=128&d=identicon&r=PG", "display_name": "Crast", "link": "https://stackoverflow.com/users/244393/crast"}, "is_accepted": true, "score": 12, "last_activity_date": 1516521154, "creation_date": 1516521154, "answer_id": 48364765, "question_id": 48360951, "link": "https://stackoverflow.com/questions/48360951/force-a-specific-version-for-a-dependency-when-using-dep/48364765#48364765", "title": "Force a specific version for a dependency when using dep", "body": "<p>If you are trying to control the version of a transient dependency (not one directly used by your package, you should use the <a href=\"https://github.com/golang/dep/blob/master/docs/Gopkg.toml.md#override\" rel=\"noreferrer\"><code>[[override]]</code> directive</a></p>\n\n<p>It looks exactly the same as a constraint, but it will constrain dependencies even when not directly inherited by your package.</p>\n\n<pre><code>[[override]]\n  branch = \"master\"\n  name = \"github.com/chzyer/readline\"\n</code></pre>\n\n<p>Note that this is also useful for when the dependency solver finds conflicting dependencies, e.g. your package P makes use of packages A and B, and both depend on different versions of package X... you can use an override on package X inside of your package P</p>\n"}], "owner": {"reputation": 155, "user_id": 4602392, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/8ada7d6bff96c8dbed0bc6ce18800a32?s=128&d=identicon&r=PG&f=1", "display_name": "Christian", "link": "https://stackoverflow.com/users/4602392/christian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5999, "favorite_count": 1, "accepted_answer_id": 48364765, "answer_count": 1, "score": 5, "last_activity_date": 1516521154, "creation_date": 1516481277, "question_id": 48360951, "link": "https://stackoverflow.com/questions/48360951/force-a-specific-version-for-a-dependency-when-using-dep", "title": "Force a specific version for a dependency when using dep", "body": "<p>I am using <em>dep</em> to manage the dependencies of a Go tool I'm writing.</p>\n\n<p>This tool uses <a href=\"https://github.com/desertbit/grumble\" rel=\"noreferrer\">https://github.com/desertbit/grumble</a> as an dependency. This in turn uses <a href=\"https://github.com/chzyer/readline\" rel=\"noreferrer\">https://github.com/chzyer/readline</a> as a dependency. The problem is that when trying to run my tool I get the following error:\n<code>\nvendor/github.com/desertbit/grumble/app.go:295:20: unknown field 'HistorySearchFold' in struct literal of type readline.Config\n</code></p>\n\n<p>I know why this is happending. <em>grumble</em> uses the <em>master</em> branch of <em>readline</em> as a dependency. In this the field <code>HistorySearchFold</code> is available.\nWhen using <code>dep init</code>/<code>dep ensure</code> not the <em>master</em> but the <em>1.4</em> tag is pulled into the vendor folder. </p>\n\n<p>My question therefore is: How can I force <em>dep</em> to pull the <em>master</em> branch instead?</p>\n\n<p>I tried adding the following in my Gopkg.toml file:</p>\n\n<pre><code>[[constraint]]\n  branch = \"master\"\n  name = \"github.com/chzyer/readline\"\n</code></pre>\n\n<p>Sadly this is not working. When I check the version pulled into the vendor folder it is still <em>1.4</em>.</p>\n"}, {"tags": ["unit-testing", "go", "random"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1516477678, "post_id": 48360260, "comment_id": 83707497, "body": "What is the purpose of mocking random numbers? (Changing underlying generator? Using third party packages? Or getting a specific sequence for tests?)"}, {"owner": {"reputation": 123, "user_id": 3868625, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ude25.jpg?s=128&g=1", "display_name": "Sofiane Cherchalli", "link": "https://stackoverflow.com/users/3868625/sofiane-cherchalli"}, "reply_to_user": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1516478005, "post_id": 48360260, "comment_id": 83707582, "body": "It&#39;s for testing purpose. All my structs have a random id in the implementation."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1516478009, "post_id": 48360260, "comment_id": 83707585, "body": "One of the reasons for using a PRNG is so that the output is repeatable. What is the goal of the mock if the output is already the same each time?"}, {"owner": {"reputation": 123, "user_id": 3868625, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ude25.jpg?s=128&g=1", "display_name": "Sofiane Cherchalli", "link": "https://stackoverflow.com/users/3868625/sofiane-cherchalli"}, "edited": false, "score": 0, "creation_date": 1516478188, "post_id": 48360260, "comment_id": 83707634, "body": "IT&#39;s not the same since I use an identity function where I pass as argument the output I want"}, {"owner": {"reputation": 123, "user_id": 3868625, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ude25.jpg?s=128&g=1", "display_name": "Sofiane Cherchalli", "link": "https://stackoverflow.com/users/3868625/sofiane-cherchalli"}, "edited": false, "score": 0, "creation_date": 1516478539, "post_id": 48360260, "comment_id": 83707746, "body": "See Go Playground for output examples: <a href=\"https://play.golang.org/p/bibNnmY2t1g\" rel=\"nofollow noreferrer\">play.golang.org/p/bibNnmY2t1g</a>"}, {"owner": {"reputation": 9898, "user_id": 116546, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/967bbcaf95419a577f2443cd31658216?s=128&d=identicon&r=PG", "display_name": "drdaeman", "link": "https://stackoverflow.com/users/116546/drdaeman"}, "edited": false, "score": 0, "creation_date": 1516500277, "post_id": 48360260, "comment_id": 83712851, "body": "They are the same for me. Subsequent runs of that example consistently print 961355788 and 217248211. Go Playground always runs the code with the same time (2009-11-10T23:00:00Z), so <code>rand.Seed</code> argument is a constant there. So if you don&#39;t need a specific sequence but just a deterministic one - there is no real reason to mock."}, {"owner": {"reputation": 123, "user_id": 3868625, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ude25.jpg?s=128&g=1", "display_name": "Sofiane Cherchalli", "link": "https://stackoverflow.com/users/3868625/sofiane-cherchalli"}, "edited": false, "score": 0, "creation_date": 1516583981, "post_id": 48360260, "comment_id": 83734132, "body": "play.golang isn&#39;t a good place to try things with random numbers. It caches the result of runs, so if you type the same program twice there is a possibility that the response will be fetched from cache instead of being compiled and runned."}], "answers": [{"comments": [{"owner": {"reputation": 123, "user_id": 3868625, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ude25.jpg?s=128&g=1", "display_name": "Sofiane Cherchalli", "link": "https://stackoverflow.com/users/3868625/sofiane-cherchalli"}, "edited": false, "score": 1, "creation_date": 1516584639, "post_id": 48363022, "comment_id": 83734305, "body": "Many Thanks. I borrowed your code and changed the Random method signature to get rid of the function argument: <a href=\"https://play.golang.org/p/w2iKC1Dz0Ek\" rel=\"nofollow noreferrer\">play.golang.org/p/w2iKC1Dz0Ek</a> ."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 123, "user_id": 3868625, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ude25.jpg?s=128&g=1", "display_name": "Sofiane Cherchalli", "link": "https://stackoverflow.com/users/3868625/sofiane-cherchalli"}, "edited": false, "score": 0, "creation_date": 1516610934, "post_id": 48363022, "comment_id": 83741952, "body": "@SofianeCherchalli it&#39;s better to have your <code>StudentManager</code> depend on the interface <code>Random</code> instead of the concrete type <code>Randomizer</code>, that way when you write tests for <code>NewStudent</code> you can mock <code>rnd</code>. <a href=\"https://play.golang.org/p/vibEizUH7Bg\" rel=\"nofollow noreferrer\">play.golang.org/p/vibEizUH7Bg</a>"}, {"owner": {"reputation": 123, "user_id": 3868625, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ude25.jpg?s=128&g=1", "display_name": "Sofiane Cherchalli", "link": "https://stackoverflow.com/users/3868625/sofiane-cherchalli"}, "edited": false, "score": 0, "creation_date": 1516618824, "post_id": 48363022, "comment_id": 83746516, "body": "Sorry it was a typo error at midnight. I meant Random :)"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 0, "last_activity_date": 1516525495, "last_edit_date": 1516525495, "creation_date": 1516500529, "answer_id": 48363022, "question_id": 48360260, "link": "https://stackoverflow.com/questions/48360260/mock-random-generator-in-go/48363022#48363022", "title": "Mock random generator in Go", "body": "<p>Your example makes no real use of the <code>Random</code> interface since the mocking is being done at the function field level of the <code>Randomizer</code> type.</p>\n\n<p>I would recommend, if possible, to ditch the function field as well as the functions and instead define two separate implementations of the <code>Random</code> interface. You can use empty structs for this, they may look weird at first but they have the nice property of taking up 0 bytes of memory.</p>\n\n<p>The main reason for the recommendation is that when you use function fields you lose the ability to compare your struct type values with <code>reflect.DeepEqual</code>. This is because two function values are only equal if they have the same type <em>and both are nil</em>.</p>\n\n<p>As an example let's first look at your <code>TestNewRandomizer</code> which is a symptom of the issue stated above. In the test you're just comparing the type of the return value which is something already ensured by the compiler, so the test is absolutely pointless.</p>\n\n<p>Now, let's say you drop the test, since it's useless, but for some reason you keep the function field. Because of this any struct type that depends on <code>*Randomizer</code> will also be untestable with <code>DeepEqual</code> and you'll have the same difficulties when trying to come up with a test for that type.</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n    \"math/rand\"\n    \"fmt\"\n)\n\nfunc init() {\n    rand.Seed(time.Now().UnixNano())\n}\n\ntype Random interface {\n    Uint(_ uint) uint\n}\n\ntype Randomizer struct {}\n\nfunc NewRandomizer() Randomizer {\n    return Randomizer{}\n}\n\nfunc (r Randomizer) Uint(n uint) uint {\n    return uint(rand.Uint64())\n}\n\ntype FakeRandomizer struct {}\n\nfunc NewFakeRandomizer() FakeRandomizer {\n    return FakeRandomizer{}\n}\n\nfunc (r FakeRandomizer) Uint(n uint) uint {\n    return n\n}\n\nfunc main() {\n    fakeRnd := NewFakeRandomizer().Uint\n    fmt.Println(fakeRnd(1))\n    fmt.Println(fakeRnd(2))\n\n    realRnd := NewRandomizer().Uint\n    fmt.Println(realRnd(0))\n    fmt.Println(realRnd(0))\n}\n</code></pre>\n\n<p>Note that i'm intentionally returning values instead of pointers since empty structs are smaller than pointers.</p>\n"}, {"tags": [], "owner": {"reputation": 378, "user_id": 5950472, "user_type": "registered", "accept_rate": 76, "profile_image": "https://lh6.googleusercontent.com/-HQx21UJoPf4/AAAAAAAAAAI/AAAAAAAABeo/xJjZvaonmjQ/photo.jpg?sz=128", "display_name": "Nagarajan Shanmuganathan", "link": "https://stackoverflow.com/users/5950472/nagarajan-shanmuganathan"}, "is_accepted": false, "score": 0, "last_activity_date": 1564689655, "creation_date": 1564689655, "answer_id": 57316227, "question_id": 48360260, "link": "https://stackoverflow.com/questions/48360260/mock-random-generator-in-go/57316227#57316227", "title": "Mock random generator in Go", "body": "<p>I have a method which generates a random integer and returns <code>true</code> if the integer is less than or equal to 50 and <code>false</code> if the integer is greater than 50 in the range [0, 100).</p>\n\n<p>This is how I have created my structures to mock the functionality:</p>\n\n<pre><code>type Decider struct {\n    RandImpl func(int) int\n}\n\nfunc (d *Decider) Decide(randRange int) bool {\n    randVal := d.RandImpl(randRange)\n    log.Info(\"RandVal: \", randVal)\n    if randVal &lt;= 50 {\n        return true\n    }\n    return false\n}\n</code></pre>\n\n<p>I'm calling this method in this manner: </p>\n\n<pre><code>rand.Seed(time.Now().UnixNano())\ndecider := decide.Decider{\n    RandImpl: func(x int) int { return rand.Intn(x) },\n}\ndecider.Decide(100)\n</code></pre>\n\n<p>In my <code>_test.go</code> file, I have this:</p>\n\n<pre><code>decider := Decider{\n    RandImpl: func(x int) int { return 42 },\n}\nret := decider.Decide(100)\nassert.True(t, ret)\n</code></pre>\n\n<p>This way you can mock the functionality of the random number generator.</p>\n"}], "owner": {"reputation": 123, "user_id": 3868625, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/ude25.jpg?s=128&g=1", "display_name": "Sofiane Cherchalli", "link": "https://stackoverflow.com/users/3868625/sofiane-cherchalli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2473, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1564689655, "creation_date": 1516476545, "last_edit_date": 1516486504, "question_id": 48360260, "link": "https://stackoverflow.com/questions/48360260/mock-random-generator-in-go", "title": "Mock random generator in Go", "body": "<p>For my tests purpose, I would like to mock random numbers in Go. So I created the Random interface. During unit testing I return the identity function, while for implementation I generate a random number with rand package.</p>\n\n<p>It is the right way for mocking random numbers in Go? Any help appreciated.</p>\n\n<p>Go Playground: <a href=\"https://play.golang.org/p/bibNnmY2t1g\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bibNnmY2t1g</a></p>\n\n<p>main:</p>\n\n<pre><code>package main\n\nimport (\n    \"time\"\n    \"math/rand\"\n    \"fmt\"\n)\n\nfunc init() {\n    rand.Seed(time.Now().UnixNano())\n}\n\ntype Random interface {\n    Uint(_ uint) uint\n}\n\ntype rndGenerator func(n uint) uint\n\ntype Randomizer struct {\n    fn rndGenerator\n}\n\nfunc NewRandomizer(fn rndGenerator) *Randomizer {\n    return &amp;Randomizer{fn: fn}\n}\n\nfunc (r *Randomizer) Uint(n uint) uint {\n    return r.fn(n)\n}\n\nfunc fakeRand(n uint) uint { return n }\nfunc realRand(_ uint) uint { return uint(rand.Uint64()) }\n\nfunc main() {\n    fakeRnd := NewRandomizer(fakeRand).Uint\n    fmt.Println(fakeRnd(1))\n    fmt.Println(fakeRnd(2))\n\n    realRnd := NewRandomizer(realRand).Uint\n    fmt.Println(realRnd(0))\n    fmt.Println(realRnd(0))\n}\n</code></pre>\n\n<p>test:</p>\n\n<pre><code>package main\n\nimport (\n    \"testing\"\n    \"math/rand\"\n    \"reflect\"\n)\n\nfunc TestNewRandomizer(t *testing.T) {\n    fn := func(n uint) uint { return n }\n\n    type args struct {\n        fn rndGenerator\n    }\n    tests := []struct {\n        name string\n        args args\n        want *Randomizer\n    }{\n        {\n            \"test\",\n            args{fn},\n            &amp;Randomizer{fn},\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := NewRandomizer(tt.args.fn); reflect.TypeOf(got) != reflect.TypeOf(tt.want) {\n                t.Errorf(\"NewRandomizer() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n\nfunc TestRandomer_Uint(t *testing.T) {\n    rnd := uint(rand.Uint64())\n\n    type fields struct {\n        fn rndGenerator\n    }\n    type args struct {\n        n uint\n    }\n    tests := []struct {\n        name   string\n        fields fields\n        args   args\n        want   uint\n    }{\n        {\n            \"test\",\n            fields{func(n uint) uint { return n }},\n            args{rnd},\n            rnd,\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            r := &amp;Randomizer{\n                fn: tt.fields.fn,\n            }\n            if got := r.Uint(tt.args.n); got != tt.want {\n                t.Errorf(\"Randomizer.Uint() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n\nfunc Test_fakeRand(t *testing.T) {\n    rnd := uint(rand.Uint64())\n\n    type args struct {\n        n uint\n    }\n    tests := []struct {\n        name string\n        args args\n        want uint\n    }{\n        {\n            \"test\",\n            args{rnd},\n            rnd,\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := fakeRand(tt.args.n); got != tt.want {\n                t.Errorf(\"fakeRand() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n\nfunc Test_realRand(t *testing.T) {\n    type args struct {\n        in0 uint\n    }\n    tests := []struct {\n        name string\n        args args\n        want bool\n    }{\n        {\n            \"test\",\n            args{0},\n            true,\n        },\n    }\n    for _, tt := range tests {\n        t.Run(tt.name, func(t *testing.T) {\n            if got := realRand(tt.args.in0); got &lt; 1 {\n                t.Errorf(\"realRand() = %v, want %v\", got, tt.want)\n            }\n        })\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "edited": false, "score": 0, "creation_date": 1516476534, "post_id": 48359992, "comment_id": 83707178, "body": "AFAIK, there are no back references in Go regexes so <code>${char}</code>, <code>\\k&lt;char&gt;</code>, ... won&#39;t work in the pattern itself."}], "answers": [{"tags": [], "owner": {"reputation": 911, "user_id": 3563197, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/563e4185281840ef1792eda5d6391440?s=128&d=identicon&r=PG", "display_name": "vedhavyas", "link": "https://stackoverflow.com/users/3563197/vedhavyas"}, "is_accepted": false, "score": 0, "last_activity_date": 1516478543, "last_edit_date": 1516478543, "creation_date": 1516475620, "answer_id": 48360085, "question_id": 48359992, "link": "https://stackoverflow.com/questions/48359992/remove-duplicate-characters-immediately-following-one-another/48360085#48360085", "title": "remove duplicate characters immediately following one another", "body": "<p>Try this:</p>\n\n<pre><code>str := \"Whyyyy sooo ssserioooouuussss \u65e5\u672c\u8a9e\u8a9e\u8a9e\"\nfmt.Println(str)\nvar buf bytes.Buffer\nvar pc rune\nfor i, c := range str {\n    if i ==  0{\n        pc = c\n        buf.WriteRune(c)\n    }\n\n    if pc == c {\n        continue\n    }\n\n    pc = c\n    buf.WriteRune(c)\n}\nfmt.Println(buf.String())\n</code></pre>\n\n<p>Result:</p>\n\n<pre><code>Whyyyy sooo ssserioooouuussss \u65e5\u672c\u8a9e\u8a9e\u8a9e\nWhy so serious \u65e5\u672c\u8a9e\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 2, "last_activity_date": 1516476847, "last_edit_date": 1516476847, "creation_date": 1516476654, "answer_id": 48360273, "question_id": 48359992, "link": "https://stackoverflow.com/questions/48359992/remove-duplicate-characters-immediately-following-one-another/48360273#48360273", "title": "remove duplicate characters immediately following one another", "body": "<p>Try the following code. It ranges over the string rune by rune. If the rune is different from the last or it's the first rune, then add the rune to the result.</p>\n\n<pre><code>func removeDups(s string) string {\n    var buf bytes.Buffer\n    var last rune\n    for i, r := range s {\n        if r != last || i == 0 {\n            buf.WriteRune(r)\n            last = r\n        }\n    }\n    return buf.String()\n}\n</code></pre>\n\n<p>In Go 1.10, the <a href=\"http://godoc.org/bytes#Buffer\" rel=\"nofollow noreferrer\">bytes.Buffer</a> can be replaced with <a href=\"https://tip.golang.org/pkg/strings/#Builder\" rel=\"nofollow noreferrer\">strings.Builder</a> to minimize allocations.</p>\n"}], "owner": {"reputation": 126, "user_id": 947494, "user_type": "registered", "profile_image": "https://graph.facebook.com/1649531108/picture?type=large", "display_name": "Marek Vavre\u010dan", "link": "https://stackoverflow.com/users/947494/marek-vavre%c4%8dan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1112, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1516478543, "creation_date": 1516475019, "last_edit_date": 1516475881, "question_id": 48359992, "link": "https://stackoverflow.com/questions/48359992/remove-duplicate-characters-immediately-following-one-another", "title": "remove duplicate characters immediately following one another", "body": "<p>I am trying to remove duplicate characters that are immediately following each other. </p>\n\n<p>E.g. \"Whyyyy sooo ssserioooouuussss\" should translate to \"Why so serious\"</p>\n\n<p>In PHP PCRE this is possible like this </p>\n\n<pre><code>$text = preg_replace(\"/(.)\\\\1+/\", \"$1\", $text);\n</code></pre>\n\n<p>I tried to do following </p>\n\n<pre><code>var duplicateRegex = regexp.MustCompile(`(?P&lt;char&gt;.)${char}+`)\ntext = duplicateRegex.ReplaceAllString(text, `${char}`)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/aXoYCFLdr4O\" rel=\"nofollow noreferrer\">Test on play.golang.com</a></p>\n\n<p>but it does not seems to work in go. Any ideas?\nThank you</p>\n"}, {"tags": ["json", "api", "go"], "comments": [{"owner": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "edited": false, "score": 0, "creation_date": 1516539921, "post_id": 48359486, "comment_id": 83720682, "body": "Structure is:          type message struct{        Student []details <code>json:&quot;student,omitempty&quot;</code>        College string <code>json:&quot;college,omitempty&quot;</code>        CollegeId string <code>json:&quot;collegeid,omitempty&quot;</code>        Hobbies []string <code>json:&quot;hobbies,omitempty&quot;</code>        Firstname string <code>json:&quot;firstname,omitempty&quot;</code>        Address string <code>json:address,omitempty&quot;</code>        Mobile string <code>json:mobile,omiempty&quot;</code>        }"}, {"owner": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "edited": false, "score": 0, "creation_date": 1516539987, "post_id": 48359486, "comment_id": 83720705, "body": "The fields &quot;address&quot; and &quot;mobile&quot; is not present currently in the document.The client is sending request to insert these new fields in the document.All other fields are already present in the document.How to do this???"}, {"owner": {"reputation": 1536, "user_id": 6691722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8e0d7ea4dc27c23764c2ec07207f08d?s=128&d=identicon&r=PG", "display_name": "0rka", "link": "https://stackoverflow.com/users/6691722/0rka"}, "edited": false, "score": 0, "creation_date": 1516547867, "post_id": 48359486, "comment_id": 83723160, "body": "Edit your post rather then providing information in the comment section. This way we can see your question in the broader sense."}], "answers": [{"tags": [], "owner": {"reputation": 1536, "user_id": 6691722, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/d8e0d7ea4dc27c23764c2ec07207f08d?s=128&d=identicon&r=PG", "display_name": "0rka", "link": "https://stackoverflow.com/users/6691722/0rka"}, "is_accepted": false, "score": 0, "last_activity_date": 1516531339, "last_edit_date": 1516531339, "creation_date": 1516516662, "answer_id": 48364316, "question_id": 48359486, "link": "https://stackoverflow.com/questions/48359486/how-to-add-a-new-field-to-existing-data-in-the-json-document/48364316#48364316", "title": "How to add a new field to existing data in the json document?", "body": "<p>A few things to notice since the code you provided is not fully available (what about providing code for the <code>message</code> struct?):</p>\n\n<p>When getting a request from the client, you unmarshal it into a <code>map[string]{}interface</code> object. From there, you construct manually a <code>message</code> object. Why don't you construct the <code>message</code> object without having to work with type assertions? You could try doing something like so:</p>\n\n<pre><code>type Message struct {\n    Student []Student `json:\"student\"`\n    College String `json:\"college\"`\n    CollegeId String `json:\"collegeid\"`\n    Hobbies []String `json:\"hobbies\"`\n    FirstName String `json:\"firstname\"`\n    Address String `json:\"address\"`\n    Mobile String `json:\"mobile\"`\n}\n\ntype Student struct {\n    Name String `json:\"name\"`\n    Qualifications []String `json:\"qualifications\"`\n    Email String `json:\"email\"`\n}\n\nvar data Message\nif err := json.NewDecoder(req.Body).Decode(&amp;data); err != nil {\n    fmt.Println(err)\n    return\n}\n\nfmt.Println(data)\n</code></pre>\n\n<p>This would also take care of the <code>student</code> struct you were having difficulties with. </p>\n\n<p>I would recommend reading <a href=\"https://eager.io/blog/go-and-json/\" rel=\"nofollow noreferrer\">this article</a> to get you started with JSON and Go.</p>\n"}], "owner": {"reputation": 53, "user_id": 7026738, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh6.googleusercontent.com/-STmShyO0LPs/AAAAAAAAAAI/AAAAAAAAAFk/VYSZiZio5Ag/photo.jpg?sz=128", "display_name": "Vikas", "link": "https://stackoverflow.com/users/7026738/vikas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 194, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1516618663, "creation_date": 1516471709, "last_edit_date": 1516618663, "question_id": 48359486, "link": "https://stackoverflow.com/questions/48359486/how-to-add-a-new-field-to-existing-data-in-the-json-document", "title": "How to add a new field to existing data in the json document?", "body": "<p>I am a beginner in Golang..I have created an API which is reading the data from couchbase well but I am not able to write new fields in the json document..The code of writing new data is below:</p>\n\n<pre><code>func appendDataEndpoint(w http.ResponseWriter,req *http.Request){\n    var data map[string]interface{}\n    _ = json.NewDecoder(req.Body).Decode(&amp;data)\n    fmt.Println(data)\n    params := mux.Vars(req)\n    str := params[\"id\"]\n\n    message := message{ Student :data[\"student\"].([]struct),//Here is another problem.How to write type of Student since it is referring to another structure.\"struct\" is throwing type error.\n                        College :data[\"college\"].(string),\n                        CollegeId: data[\"collegeid\"].(string),\n                        Hobbies :data[\"hobbies\"].([]string),\n                        Firstname: data[\"firstname\"].(string),\n                        Address: data[\"address\"].(string),//New field to be inserted\n                        Mobile: data[\"mobile\"].(string),//New field to be inserted\n    }\n    fmt.Println(message.Address)\n    _,err:=bucket.Insert(str, message, 0)\n\n    if err!=nil{\n        fmt.Println(\"Error in inserting\")\n        w.WriteHeader(401)\n        w.Write([]byte(err.Error()))\n        return\n    }\n    json.NewEncoder(w).Encode(message)\n}\n</code></pre>\n\n<p>Still having problems.Now the updated code snippet is:</p>\n\n<pre><code>    message:=message{\n    Student :data[\"student\"].([]Student),//Error still exists here\n    College :data[\"college\"].(string),\n    CollegeId :data[\"collegeid\"].(string),\n    Hobbies :data[\"hobbies\"].([]string),\n    Firstname :data[\"firstname\"].(string),\n    Add: data[\"a\"].(string),\n    Mo: data[\"m\"].(string),\n    }\n    _,err:=bucket.Insert(str, message, 0)\n</code></pre>\n\n<p>The error is:</p>\n\n<pre><code>    panic serving [::1]:63648: interface conversion: interface {} is nil, not []main.Student\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "owner": {"reputation": 2884, "user_id": 1430476, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cf9e49064895c6b498e936d2a2b80bf3?s=128&d=identicon&r=PG", "display_name": "Tino", "link": "https://stackoverflow.com/users/1430476/tino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 106, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1516471642, "creation_date": 1516471642, "question_id": 48359475, "link": "https://stackoverflow.com/questions/48359475/gorm-and-associations", "title": "Gorm and associations", "body": "<p>I'm trying to figure out how to load associations with <code>gorm</code>. The documentation is not that great. </p>\n\n<p>I have to models:</p>\n\n<pre><code>type Account struct {\n    gorm.Model\n    Name          string `gorm:\"column:name;unique_index;not null;size:255\"`\n    AccountTypeID uint   `gorm:\"not null\"`\n    UserID        uint   `gorm:\"not null\"`\n    AccountType   accounttypes.AccountType\n}\n</code></pre>\n\n<p>and</p>\n\n<pre><code>type AccountType struct {\n    gorm.Model\n    Name string `gorm:\"column:name;unique_index;not null;size:255\"`\n    Type string `gorm:\"column:type;unique_index;not null;size:255\"`\n}\n</code></pre>\n\n<p>So every <code>Account</code> has a <code>Account Type</code> associated with it. </p>\n\n<p>When I try loading the data via: </p>\n\n<pre><code>func GetAccounts(userId uint) ([]Account, error) {\n    db := common.GetDB()\n    var model []Account\n    db.LogMode(true)\n    err := db.Model(&amp;Account{}).Where(\"accounts.user_id =?\", userId).Related(&amp;accounttypes.AccountType{}, \"AccountTypes\").Error\n    return model, err\n}\n</code></pre>\n\n<p>This is the output:\n<a href=\"https://i.stack.imgur.com/yuPs3.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/yuPs3.png\" alt=\"enter image description here\"></a></p>\n\n<p>Could someone please explain how to do this properly the 'gorm way'?</p>\n"}, {"tags": ["multithreading", "go", "goroutine"], "answers": [{"tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 2, "last_activity_date": 1516465273, "last_edit_date": 1516465273, "creation_date": 1516464368, "answer_id": 48358191, "question_id": 48358137, "link": "https://stackoverflow.com/questions/48358137/how-to-schedule-running-non-blocking-functions/48358191#48358191", "title": "How to schedule running non-blocking functions", "body": "<p>You are calling both <code>computeX</code> and <code>computeY</code> every iteration of the loop.</p>\n\n<p>Since <code>computeX</code> takes 1s, the <code>for</code> loop iterates once per second and an extra time when <code>yC</code> gets a value.</p>\n\n<p>This means that you're running <code>go computeY</code> at <code>t=0s</code>, <code>t=1s</code>, <code>t=2s</code>, etc....\nThe first one terminates at <code>t=10s</code>, the second at <code>t=11s</code>, etc...</p>\n\n<p>If you want to make sure you only schedule one <code>computeX</code> and <code>computeY</code> at a time, you need to change your main to something along the lines of:</p>\n\n<pre><code>    go computeX(xC)\n    go computeY(yC)\n    for {\n        select {\n        case x = &lt;-xC:\n            fmt.Printf(\"Finished computeX: X: %v, Y: %v\\n\", x, y)\n            go computeX(xC)\n        case y = &lt;-yC:\n            fmt.Printf(\"Finished computeY: X: %v, Y: %v\\n\", x, y)\n            go computeY(yC)\n        }\n    } \n</code></pre>\n\n<p>A few other things to note about your code:</p>\n\n<ul>\n<li><code>x</code> and <code>y</code> are global and assigned in <code>computeX</code> and <code>computeY</code></li>\n<li>your channel reads shadow <code>x</code> and <code>y</code></li>\n<li><code>fmt.Println(fmt.Sprintf(\"...\"))</code> is just <code>fmt.Printf(\"...\\n\")</code></li>\n<li>you don't need to initialize strings to <code>\"\"</code>, that's the default value</li>\n</ul>\n"}, {"tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": false, "score": 1, "last_activity_date": 1516466626, "creation_date": 1516466626, "answer_id": 48358613, "question_id": 48358137, "link": "https://stackoverflow.com/questions/48358137/how-to-schedule-running-non-blocking-functions/48358613#48358613", "title": "How to schedule running non-blocking functions", "body": "<p>While @Marc's answer explains your code's problem and shows how to fix it, I will try to give you some patterns on scheduling functions.</p>\n\n<p>Pattern 1: <code>time.Ticker</code></p>\n\n<blockquote>\n  <p>A Ticker holds a channel that delivers `ticks' of a clock at intervals. </p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>func Schedule(interval time.Duration,f func()) {\n    t:=time.NewTimer(interval)\n    go func() {\n        for {\n            &lt;-t.C\n            f()\n        }\n    }()\n }\n</code></pre>\n\n<p>Pattern 2: <code>time.AfterFunc</code></p>\n\n<blockquote>\n  <p>AfterFunc waits for the duration to elapse and then calls f in its own goroutine. It returns a Timer that can be used to cancel the call using its Stop method. </p>\n</blockquote>\n\n<p>Example:</p>\n\n<pre><code>func Schedule(interval time.Duration,f func()) {\n    var wrap func()\n    wrap = func() {\n        f()\n        time.AfterFunc(wrap)\n    }\n    time.AfterFunc(f)\n}\n</code></pre>\n\n<p>Pattern 1 is more readable and expressive while pattern 2 is more efficient on memory. </p>\n"}], "owner": {"reputation": 189, "user_id": 4352712, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/h58Q5.png?s=128&g=1", "display_name": "aonemd", "link": "https://stackoverflow.com/users/4352712/aonemd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 294, "favorite_count": 1, "accepted_answer_id": 48358191, "answer_count": 2, "score": 0, "last_activity_date": 1516466626, "creation_date": 1516464044, "question_id": 48358137, "link": "https://stackoverflow.com/questions/48358137/how-to-schedule-running-non-blocking-functions", "title": "How to schedule running non-blocking functions", "body": "<p>My questions is how to schedule running independent non-blocking functions every interval N. </p>\n\n<p>My initial approach is to use go channels within a select statement to receive the values in a non-blocking manner and use <code>time.Sleep(N)</code> in each function to schedule the call.</p>\n\n<p>In the code snippet below, this only for the first run; however, after the first call, it keeps calling <code>computeY()</code> repeatedly without respecting the <code>time.Sleep()</code> call.</p>\n\n<pre><code>    package main\n\n    import (\n        \"fmt\"\n        \"time\"\n    )\n\n    var (\n        x string = \"\"\n        y string = \"\"\n    )\n\n    func computeY(c chan string) {\n        time.Sleep(10 * time.Second)\n        fmt.Println(\"I'm in Y\")\n\n        y = \"this is Y value\"\n        c &lt;- y\n    }\n\n    func computeX(c chan string) {\n        time.Sleep(1 * time.Second)\n\n        x = \"this is X value\"\n        c &lt;- x\n    }\n\n    func main() {\n        xC := make(chan string)\n        yC := make(chan string)\n\n        for {\n            go computeX(xC)\n            go computeY(yC)\n\n            select {\n            case x := &lt;-xC:\n                fmt.Println(fmt.Sprintf(\"X: %v, Y: %v\", x, y))\n            case y := &lt;-yC:\n                fmt.Println(fmt.Sprintf(\"X: %v, Y: %v\", x, y))\n            }\n\n        }\n    }\n</code></pre>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516459868, "post_id": 48357278, "comment_id": 83701604, "body": "You&#39;re not checking for errors on <code>db.First</code>. What happens if your struct doesn&#39;t match your schema?"}, {"owner": {"reputation": 2884, "user_id": 1430476, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cf9e49064895c6b498e936d2a2b80bf3?s=128&d=identicon&r=PG", "display_name": "Tino", "link": "https://stackoverflow.com/users/1430476/tino"}, "reply_to_user": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516464843, "post_id": 48357278, "comment_id": 83703231, "body": "It doesn&#39;t throw any errors. I also checked with &#39;.GetErrors()&#39; nothing happens."}], "answers": [{"tags": [], "owner": {"reputation": 2884, "user_id": 1430476, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cf9e49064895c6b498e936d2a2b80bf3?s=128&d=identicon&r=PG", "display_name": "Tino", "link": "https://stackoverflow.com/users/1430476/tino"}, "is_accepted": false, "score": 0, "last_activity_date": 1516467250, "creation_date": 1516467250, "answer_id": 48358702, "question_id": 48357278, "link": "https://stackoverflow.com/questions/48357278/gorm-not-creating-entries/48358702#48358702", "title": "Gorm not creating entries", "body": "<p>Ok after logging out the queries I found the mistake. It was querying all of the entries without any conditions. After adding <code>.Where()</code> it worked. </p>\n\n<pre><code>if db.Where(&amp;acccountTypeModelExchange).First(&amp;accounttypes.AccountType{}).RecordNotFound()\n</code></pre>\n"}], "owner": {"reputation": 2884, "user_id": 1430476, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/cf9e49064895c6b498e936d2a2b80bf3?s=128&d=identicon&r=PG", "display_name": "Tino", "link": "https://stackoverflow.com/users/1430476/tino"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 83, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1527756800, "creation_date": 1516458448, "last_edit_date": 1527756800, "question_id": 48357278, "link": "https://stackoverflow.com/questions/48357278/gorm-not-creating-entries", "title": "Gorm not creating entries", "body": "<p>I'm new to go and I'm a little confused, why the following:</p>\n\n<pre><code>acccountTypeModelWallet := accounttypes.AccountType{Type: \"wallet\", Name: \"Wallet\"}\nif db.First(&amp;acccountTypeModelWallet).RecordNotFound() {\n    fmt.Println(\"Account Type `Wallet` not found. Creating..\")\n    err := db.Create(&amp;acccountTypeModelWallet).Error\n    if err != nil {\n        return false, err\n    }\n}\n\nacccountTypeModelBankAccount := accounttypes.AccountType{Type: \"bankaccount\", Name: \"Bank Account\"}\nif db.First(&amp;acccountTypeModelBankAccount).RecordNotFound() {\n    fmt.Println(\"Account Type `Bank Account` not found. Creating..\")\n    err := db.Create(&amp;acccountTypeModelBankAccount).Error\n    if err != nil {\n        fmt.Println(err)\n        return false, err\n    }\n}\n\nacccountTypeModelExchange := accounttypes.AccountType{Type: \"exchange\", Name: \"Exchange Account\"}\nif db.First(&amp;acccountTypeModelExchange).RecordNotFound() {\n    fmt.Println(\"Account Type `Exchange Account` not found. Creating..\")\n    err := db.Create(&amp;acccountTypeModelExchange).Error\n    if err != nil {\n        return false, err\n    }\n}\n</code></pre>\n\n<p>Only inserts \"Wallet\" into the database, but not \"Bank Account\" and \"Exchange\"? None of the entries exist at the time of execution so all of them should be created. </p>\n\n<p>What am I missing here?</p>\n"}, {"tags": ["linux", "go", "mount", "fstab"], "comments": [{"owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "edited": false, "score": 0, "creation_date": 1516450760, "post_id": 48355060, "comment_id": 83698636, "body": "I run it as suid. When I run it as root i get <code>invalid argument</code>. Running it as root is not an option if I can avoid it as I want to have the file permissions for the user. My attempt to use  <code>os&#47;exec</code> and <code>syscall.Exec</code>  failed also."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516450956, "post_id": 48355060, "comment_id": 83698688, "body": "Can you show those attempts as well, including code and output. And the output of a normal <code>mount</code> command you want to run."}], "answers": [{"comments": [{"owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "edited": false, "score": 0, "creation_date": 1516451022, "post_id": 48355975, "comment_id": 83698714, "body": "As mentioned in my comment above, I also failed to use os/exec for some reason. Most probably because of me. I&#39;ll keep on trying. Thanks for your input."}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "reply_to_user": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "edited": false, "score": 0, "creation_date": 1516451716, "post_id": 48355975, "comment_id": 83698950, "body": "I think there are oddities when using <code>mount (2)</code> with fuse. I suggest trying <code>strace mount ....</code> and seeing how it invokes <code>mount</code>. But yes, getting the <code>mount (8)</code> command to work first would be good."}, {"owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "edited": false, "score": 0, "creation_date": 1516481280, "post_id": 48355975, "comment_id": 83708591, "body": "Working fine now  with <code>os&#47;exec</code> calling the mount(8) command."}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 1, "last_activity_date": 1516450762, "last_edit_date": 1516450762, "creation_date": 1516450206, "answer_id": 48355975, "question_id": 48355060, "link": "https://stackoverflow.com/questions/48355060/mount-entry-in-fstab-with-go/48355975#48355975", "title": "Mount entry in fstab with go", "body": "<p>You need to run your binary either as <code>root</code>, or owned by <code>root</code> and with the <a href=\"https://en.wikipedia.org/wiki/Setuid\" rel=\"nofollow noreferrer\">setuid</a> bit.</p>\n\n<p>This is because <code>/etc/fstab</code> is used by <a href=\"https://linux.die.net/man/8/mount\" rel=\"nofollow noreferrer\"><code>mount (8)</code></a> (the command), not <a href=\"https://linux.die.net/man/2/mount\" rel=\"nofollow noreferrer\"><code>mount (2)</code></a>, so the <code>user</code> attribute in your fstab entry does nothing (nor does the rest of the entry).</p>\n\n<p>Indeed, the <code>mount (2)</code> man page clearly states:</p>\n\n<blockquote>\n  <p>Appropriate privilege (Linux: the CAP_SYS_ADMIN capability) is\n  required to mount file systems.</p>\n</blockquote>\n\n<p>If you cannot run as a privileged user or want to make use of the <code>/etc/fstab</code> entry, you could always <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">exec</a> the actual mount command.</p>\n"}], "owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 718, "favorite_count": 0, "accepted_answer_id": 48355975, "answer_count": 1, "score": 2, "last_activity_date": 1516482613, "creation_date": 1516444531, "last_edit_date": 1516482613, "question_id": 48355060, "link": "https://stackoverflow.com/questions/48355060/mount-entry-in-fstab-with-go", "title": "Mount entry in fstab with go", "body": "<p>Is there a way to mount a ssh device with Go using an entry in fstab where the mount options are defined. I have been trying syscall.Mount without success.</p>\n\n<pre><code>func main() {\n\n    src := \"jeanluc@&lt;remote IP&gt;:/home/jeanluc\"\n    target := \"/home/jeanluc/my-mnt/ursule_jeanluc\"\n    fs := \"fuse.sshfs\"\n\n    err := syscall.Mount(src, target, fs, 0, \"rw\")\n\n    if err != nil {\n        log.Fatal(err)\n    }\n}\n</code></pre>\n\n<p><code>2018/01/20 11:31:07 operation not permitted exit status 1</code></p>\n\n<p>A user mount using the fstab entry works fine.</p>\n\n<p><code>sshfs#jeanluc@&lt;remote IP&gt;:/home/jeanluc /home/jeanluc/my-mnt/ursule_jeanluc fuse user,noauto,uid=1000,gid=1000,follow_symlinks,defaults 0 0</code></p>\n\n<p><strong>Edit:</strong></p>\n\n<p>Following Marc's advise below here is what worked for me:</p>\n\n<pre><code>cmd := exec.Command(\"mount /home/jeanluc/my-mnt/ursule_jeanluc\")\n\n// capture STDOUT\nvar out bytes.Buffer\ncmd.Stdout = &amp;out\n\n// run cmd\nerr := cmd.Run()\nif err != nil {\n    log.Fatal(err)\n}\n\n// print STDOUT\nfmt.Printf(\"%s\", out.String())\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 1, "creation_date": 1516443526, "post_id": 48353768, "comment_id": 83696375, "body": "You need to change <code>reboot</code> to launch a goroutine that launches the command. You can pass something like a channel or simply a <code>io.Reader</code> (eg: the output of <a href=\"https://golang.org/pkg/os/exec/#Cmd.StdoutPipe\" rel=\"nofollow noreferrer\">StdoutPipe</a>). That should be enough to get you started."}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1516659774, "post_id": 48353768, "comment_id": 83770361, "body": "I deleted my answer since it didn&#39;t solve your problem. I&#39;ve tried to solve it in several ways but all that don&#39;t write directly to stdout seem to buffer the output."}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1516780793, "post_id": 48353768, "comment_id": 83824486, "body": "Try running <code>python -u test.py</code>. Python output is buffered by default and may cause problems in your case (specially if you output is short)."}, {"owner": {"reputation": 787, "user_id": 6726990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/25b10afe9155203945628b1dfbfb2b70?s=128&d=identicon&r=PG&f=1", "display_name": "Blooze", "link": "https://stackoverflow.com/users/6726990/blooze"}, "reply_to_user": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1517109901, "post_id": 48353768, "comment_id": 83958704, "body": "@ArmanOrdookhani That worked! Thank you!"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1517123533, "post_id": 48353768, "comment_id": 83960782, "body": "@Blooze You&#39;re welcome :)"}], "answers": [{"tags": [], "owner": {"reputation": 1369, "user_id": 4152353, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-2Rq_kZLlr9o/AAAAAAAAAAI/AAAAAAAAABM/CpxBSHiRMOs/photo.jpg?sz=128", "display_name": "gushitong", "link": "https://stackoverflow.com/users/4152353/gushitong"}, "is_accepted": false, "score": 8, "last_activity_date": 1516622141, "creation_date": 1516622141, "answer_id": 48381051, "question_id": 48353768, "link": "https://stackoverflow.com/questions/48353768/capture-stdout-from-command-exec-in-real-time/48381051#48381051", "title": "Capture stdout from command exec in real time", "body": "<p>A real time command pipe for redis.log. (you can call <code>bgsave</code> to test it.)</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n    \"fmt\"\n    \"bufio\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"tail\", \"-f\",  \"/usr/local/var/log/redis.log\")\n\n    // create a pipe for the output of the script\n    cmdReader, err := cmd.StdoutPipe()\n    if err != nil {\n        fmt.Fprintln(os.Stderr, \"Error creating StdoutPipe for Cmd\", err)\n        return\n    }\n\n    scanner := bufio.NewScanner(cmdReader)\n    go func() {\n        for scanner.Scan() {\n            fmt.Printf(\"\\t &gt; %s\\n\", scanner.Text())\n        }\n    }()\n\n    err = cmd.Start()\n    if err != nil {\n        fmt.Fprintln(os.Stderr, \"Error starting Cmd\", err)\n        return\n    }\n\n    err = cmd.Wait()\n    if err != nil {\n        fmt.Fprintln(os.Stderr, \"Error waiting for Cmd\", err)\n        return\n    }\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "edited": false, "score": 0, "creation_date": 1516738080, "post_id": 48407825, "comment_id": 83809522, "body": "If your Python script is small and easy to rewrite in Go, then perhaps it will work doing that."}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 1, "creation_date": 1516780664, "post_id": 48407825, "comment_id": 83824410, "body": "Python stdout if buffered by default. Use <code>python -u talker.py</code> to run unbuffered version."}, {"owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "reply_to_user": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1516805457, "post_id": 48407825, "comment_id": 83840278, "body": "@ArmanOrdookhani. Thanks, that worked. But why doesn&#39;t it seem buffered when writing directly to the consol? Does Python detect if stdout is connected to the consol?"}, {"owner": {"reputation": 4780, "user_id": 2133484, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5b491cf2d331464c4655247dc43e3d89?s=128&d=identicon&r=PG", "display_name": "Arman Ordookhani", "link": "https://stackoverflow.com/users/2133484/arman-ordookhani"}, "edited": false, "score": 0, "creation_date": 1516807992, "post_id": 48407825, "comment_id": 83842213, "body": "I don&#39;t know a definite answer. I think Python line buffers stdout if it&#39;s connected to a tty (console). I think C <code>printf</code> is the same, you used <code>write</code> syscall that don&#39;t use C buffering system. Go chose to be unbuffered by default in all places."}], "tags": [], "owner": {"reputation": 1767, "user_id": 1412534, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/459e618cf38006bdc543e535c854f163?s=128&d=identicon&r=PG", "display_name": "md2perpe", "link": "https://stackoverflow.com/users/1412534/md2perpe"}, "is_accepted": false, "score": -1, "last_activity_date": 1516729449, "creation_date": 1516729449, "answer_id": 48407825, "question_id": 48353768, "link": "https://stackoverflow.com/questions/48353768/capture-stdout-from-command-exec-in-real-time/48407825#48407825", "title": "Capture stdout from command exec in real time", "body": "<p>I haven't found a solution to your problem, but I have found something strange.</p>\n\n<p>I wrote three versions of a program that repeatingly output a short string with one second interval, one in Python, one in C, and one in Go:</p>\n\n<h2>talker.py</h2>\n\n<pre><code>import time\n\nwhile True:\n        print(\"Now!\")\n        time.sleep(1)\n</code></pre>\n\n<h2>talker.c</h2>\n\n<pre><code>#include &lt;unistd.h&gt;\n\nmain() {\n        for(;;) {\n                write(1, \"Now!\\n\", 5);\n                sleep(1);\n        }\n}\n</code></pre>\n\n<h2>talker.go</h2>\n\n<pre><code>package main\n\nimport (\n        \"fmt\"\n        \"time\"\n)\n\nfunc main() {\n        for {\n                fmt.Println(\"Now!\")\n                time.Sleep(time.Second)\n        }\n}\n</code></pre>\n\n<p>When I run them by themselves (e.g. <code>python ./talker.py</code>) they seem to work exactly the same. But when I pipe the output to <code>cat</code> I see a difference; the C and Go version gets their output through to the screen immediately, but not so the Python version. Its output gets buffered and doesn't show up on screen until enough data has been collected.</p>\n\n<p>I even tried with a simple Go version of <code>cat</code>, and that doesn't change the behaviour:</p>\n\n<pre><code>package main\n\nimport (\n        \"io\"\n        \"os\"\n)\n\nfunc main() {\n        io.Copy(os.Stdout, os.Stdin)\n}\n</code></pre>\n"}], "owner": {"reputation": 787, "user_id": 6726990, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/25b10afe9155203945628b1dfbfb2b70?s=128&d=identicon&r=PG&f=1", "display_name": "Blooze", "link": "https://stackoverflow.com/users/6726990/blooze"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4891, "favorite_count": 5, "answer_count": 2, "score": 3, "last_activity_date": 1516729449, "creation_date": 1516433563, "last_edit_date": 1516438562, "question_id": 48353768, "link": "https://stackoverflow.com/questions/48353768/capture-stdout-from-command-exec-in-real-time", "title": "Capture stdout from command exec in real time", "body": "<p>I'm currently working on a chat bot that will perform commands. One thing I want it to do is be able to run scripts and output the stdout of the script into the chat.</p>\n\n<p>The issue I am having is that the function collects all of the stdout of the script and returns them all at the end, I'd like to try and modify it to write in real time and have had issues doing so. </p>\n\n<p>What I think the issue might involve is that there is only one way for it to return text to the chat channel and that is via the return function of reboot. However I'd like to iterate over the exec command and output that if possible.</p>\n\n<p>Here's my code:</p>\n\n<pre><code>func reboot(command *bot.Cmd) (string, error) {\n    n := command.Args[0]\n    // this return is what all gets sent into chat channel\n    return runcommand(n), nil\n  }\n\n\nfunc runcommand(server string) string {\n    cmd := exec.Command(\"/bin/bash\", \"-c\", \"python test.py %s\", server)\n    cmdOutput := &amp;bytes.Buffer{}\n    cmd.Stdout = cmdOutput\n    err := cmd.Run()\n    if err !=nil {\n        os.Stderr.WriteString(err.Error())\n    }\n        return fmt.Sprintf(string(cmdOutput.Bytes()))\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": false, "score": 5, "last_activity_date": 1516426304, "last_edit_date": 1516426304, "creation_date": 1516425187, "answer_id": 48352850, "question_id": 48352767, "link": "https://stackoverflow.com/questions/48352767/properly-unmarshal-uncertain-json-with-proper-return-type/48352850#48352850", "title": "Properly unmarshal uncertain JSON with proper return type", "body": "<p>I suggest you to follow the Go way, and return both error and Quotes, here is an example:</p>\n\n<pre><code>func GetQuotes(symbols []string, api_key string) ([]Quote, error) {        \n    quotes := []Quote{}\n    // A better would be if the fetch \n    // fuction also returns both \n    // result and error\n    result := fetch(\"quotes?pairs=\" + strings.Join(symbols, \",\"), api_key)\n\n    e := json.Unmarshal(result, &amp;quotes)\n\n    if e != nil {\n        return quotes, e\n    }\n\n    return quotes, nil\n}\n</code></pre>\n\n<p>Now you can check if request or marshaling returns an error.</p>\n\n<pre><code>quotes, err := GetQuotes(symbols, apiKey)\nif err != nil {\n  // handle errors here\n}\n</code></pre>\n\n<p>You can also return the <code>ErrorMessage</code> type your custom struct instead of <code>error</code>.</p>\n\n<p><sub><a href=\"https://blog.golang.org/error-handling-and-go\" rel=\"noreferrer\">Error handling and Go</a>\n</sub></p>\n\n<p>In order to returns different types, you must use an interface in the return statement, here is an <a href=\"https://play.golang.org/p/sLXlt2EXm4i\" rel=\"noreferrer\">example</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype Foo struct {}\n\ntype Bar struct {}\n\nfunc Baz(w string) interface{} {\n  if w == \"Foo\" {\n    return Foo{}\n  }\n  return Bar{}\n}\n\nfunc main() {\n    fmt.Printf(\"%T\", Baz(\"Bar\"))\n}\n=&gt; main.Bar\n</code></pre>\n\n<p>The <code>Baz</code> function able to returns both <code>Foo</code> and <code>Bar</code> structs.</p>\n"}], "owner": {"reputation": 1, "user_id": 8386251, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ea5352be4ee094883e2ac9595e057dda?s=128&d=identicon&r=PG&f=1", "display_name": "Jacob Davis", "link": "https://stackoverflow.com/users/8386251/jacob-davis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1516426304, "creation_date": 1516424339, "question_id": 48352767, "link": "https://stackoverflow.com/questions/48352767/properly-unmarshal-uncertain-json-with-proper-return-type", "title": "Properly unmarshal uncertain JSON with proper return type", "body": "<p>I am working with a JSON API to pull forex quotes.  </p>\n\n<p>I am unmarshaling to a <code>struct</code> like so:</p>\n\n<pre><code>type Quote struct {\n    Symbol string\n    Bid float32\n    Ask float32\n    Price float32\n    Timestamp int\n}\n</code></pre>\n\n<p>Using a <code>function</code> like so:</p>\n\n<pre><code>func GetQuotes(symbols []string, api_key string) []Quote {\n    result := fetch(\"quotes?pairs=\" + strings.Join(symbols, \",\"), api_key)\n\n    quotes := []Quote{}\n\n    e := json.Unmarshal(result, &amp;quotes)\n\n    if e != nil {\n        log.Fatal(e)\n    }\n\n    return quotes\n}\n</code></pre>\n\n<p>My issue is: If I get back an error such as \"The data you've requested is not available\", <strong>how do I properly return the correct type from <code>GetQuotes</code>?</strong></p>\n\n<p>If I unmarshal using <code>json.RawMessage</code> I can use a switch to chose the proper struct, such as <code>Quote</code> or <code>ErrorMessage</code>, however, then I cannot set a proper return type from <code>GetQuotes</code></p>\n"}, {"tags": ["http", "go"], "answers": [{"comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516427645, "post_id": 48352967, "comment_id": 83692783, "body": "An additional piece of the puzzle: the <code>request.Body.Close()</code> read the remaining request. If you want to discard during the reading, use <code>panci</code>."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1516428434, "post_id": 48352967, "comment_id": 83692929, "body": "Yeah. I ran across <code>MaxBytesReader</code> in the server implementation (in the OPTIONS support, to mitigate overconsumption). Per <code>multipart.Reader</code>: &quot;Reader is an iterator over parts in a MIME multipart body. Reader&#39;s underlying parser consumes its input as needed. Seeking isn&#39;t supported.&quot; However, the implementation is a <code>map</code>. How are you supposed to iterate over parts if all you have is a <code>map</code>? <a href=\"https://golang.org/pkg/mime/multipart/#Form\" rel=\"nofollow noreferrer\">golang.org/pkg/mime/multipart/#Form</a>"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1516428904, "post_id": 48352967, "comment_id": 83693004, "body": "I overlooked the multipart-reader part. Ordinarily the whole thing is parsed into memory/disk, but the multipart-reader produces one <code>multipart.Part</code> after another. Thanks."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1516428962, "post_id": 48352967, "comment_id": 83693015, "body": "The <a href=\"https://godoc.org/mime/multipart#example-NewReader\" rel=\"nofollow noreferrer\">multipart.Reader example</a> shows how to iterate through the parts (you can ignore everything through to the NewReader call)."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 3, "last_activity_date": 1516426861, "last_edit_date": 1516426861, "creation_date": 1516426557, "answer_id": 48352967, "question_id": 48352584, "link": "https://stackoverflow.com/questions/48352584/efficiently-handling-http-uploads-of-many-large-files-in-go/48352967#48352967", "title": "Efficiently handling HTTP uploads of many large files in Go", "body": "<p>An application's <a href=\"https://godoc.org/net/http#Handler\" rel=\"nofollow noreferrer\">handler</a> is called after the headers are parsed and before the request body is read. The handler can read the <a href=\"https://godoc.org/net/http#Request.Body\" rel=\"nofollow noreferrer\">request body</a> as soon as the handler is called. The server does not buffer the entire request body.</p>\n\n<p>An application can read file uploads without buffering the entire request by <a href=\"https://godoc.org/net/http#Request.MultipartReader\" rel=\"nofollow noreferrer\">getting a multipart reader</a> and iterating through the parts.</p>\n\n<p>An application can replace the request body with a <a href=\"https://godoc.org/net/http#MaxBytesReader\" rel=\"nofollow noreferrer\">MaxBytesReader</a> to force close the connection after a specified limit is breached.</p>\n\n<p>The above comments are about the net/http server included in the standard library. The comments may not apply to other servers.</p>\n"}, {"tags": [], "owner": {"reputation": 799, "user_id": 2980967, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ecQ8D.jpg?s=128&g=1", "display_name": "dustinevan", "link": "https://stackoverflow.com/users/2980967/dustinevan"}, "is_accepted": false, "score": 0, "last_activity_date": 1516426590, "creation_date": 1516426590, "answer_id": 48352973, "question_id": 48352584, "link": "https://stackoverflow.com/questions/48352584/efficiently-handling-http-uploads-of-many-large-files-in-go/48352973#48352973", "title": "Efficiently handling HTTP uploads of many large files in Go", "body": "<p>While I haven't done this with GB size files, my strategy with file processing (mostly stuff I read from and write to S3) is to use <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/os/exec/</a> with a cmd line utility that handles chunking a way you like. Then read and process by tailing the file as explained here: <a href=\"https://stackoverflow.com/questions/10135738/reading-log-files-as-theyre-updated-in-go\">Reading log files as they&#39;re updated in Go</a></p>\n\n<p>In my situations, network utilities can download the data far faster than my code can process it, so it makes sense to send it to disk and pick it up as fast as I can, that way I'm not holding some connection open while I process. </p>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1340, "favorite_count": 2, "accepted_answer_id": 48352967, "answer_count": 2, "score": 1, "last_activity_date": 1516426861, "creation_date": 1516422445, "question_id": 48352584, "link": "https://stackoverflow.com/questions/48352584/efficiently-handling-http-uploads-of-many-large-files-in-go", "title": "Efficiently handling HTTP uploads of many large files in Go", "body": "<p>There is probably an answer within reach, but most of the search results are \"handling large file uploads\" where the user does not know what they're doing or \"handing many uploads\" where the answer consistently is just an explanation of how to work with multipart requests and/or Flash uploader widgets.</p>\n\n<p>I haven't had time to sift through Go's HTTP implementation, yet, but when does the application have the first chance to see the incoming body? Not until it has been completely received?</p>\n\n<p>If I were to [poorly] decide to use HTTP to transfer a large amount of data and posted a single request with several 10-gigabyte parts, would I have to wait for the whole thing to be received before processing it or does the <code>io.Reader</code> with the body iteratively process it?</p>\n\n<p>This is only tangentially related, but I also haven't been able to get a clear answer about whether I can choose to forcibly close the connection in the middle; whether or not, even if I close it, it will just keep receiving it on the port.</p>\n\n<p>Thanks so much.</p>\n"}, {"tags": ["go", "slack"], "answers": [{"comments": [{"owner": {"reputation": 6660, "user_id": 1347435, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EC7Qo.png?s=128&g=1", "display_name": "SoldierCorp", "link": "https://stackoverflow.com/users/1347435/soldiercorp"}, "edited": false, "score": 0, "creation_date": 1516422896, "post_id": 48352602, "comment_id": 83691990, "body": "But the fields from slack are coming in that way, do you know if there is function or similar to parse those underscore variables and use the Capitalized ones?"}], "tags": [], "owner": {"reputation": 107, "user_id": 4496563, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/518dc1f193b026c3b6d4ed70425c7e30?s=128&d=identicon&r=PG", "display_name": "Simon So", "link": "https://stackoverflow.com/users/4496563/simon-so"}, "is_accepted": false, "score": 0, "last_activity_date": 1516422648, "creation_date": 1516422648, "answer_id": 48352602, "question_id": 48352537, "link": "https://stackoverflow.com/questions/48352537/iris-go-get-form-urlencoded-data-not-working/48352602#48352602", "title": "Iris GO: Get form urlencoded data not working", "body": "<p>I'm also a newbie at Go, but the error seems to be indicating that it's trying to read an unexported field - and I see that your <code>Student</code> struct has all UNexported fields (Go treats Capitalized fields as exported and uncapitalized fields as the opposite)</p>\n"}, {"tags": [], "owner": {"reputation": 83665, "user_id": 2998271, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/B7vUA.png?s=128&g=1", "display_name": "har07", "link": "https://stackoverflow.com/users/2998271/har07"}, "is_accepted": true, "score": 1, "last_activity_date": 1516428341, "creation_date": 1516428341, "answer_id": 48353154, "question_id": 48352537, "link": "https://stackoverflow.com/questions/48352537/iris-go-get-form-urlencoded-data-not-working/48353154#48353154", "title": "Iris GO: Get form urlencoded data not working", "body": "<p>Example in <a href=\"https://iris-go.com/v10/recipe#Read%20Form90\" rel=\"nofollow noreferrer\">the documentation</a> you linked to suggests to use <em>tag/annotation</em> to map field to form key, and to keep your field name as needed i.e follows Go naming convention and exported :</p>\n\n<pre><code>type Student struct {\n    ChannelID string `form:\"channel_id\"`\n    ChannelName string `form:\"channel_name\"`\n    ...\n}\n</code></pre>\n\n<p>Field tag is common in Go and it is also used in some places within standard Go package, such us, <a href=\"https://golang.org/pkg/encoding/json\" rel=\"nofollow noreferrer\"><code>encoding/json</code></a> and <a href=\"https://golang.org/pkg/encoding/xml\" rel=\"nofollow noreferrer\"><code>encoding/xml</code></a> for serialization/deserialization of JSON and XML data, respectively.</p>\n"}], "owner": {"reputation": 6660, "user_id": 1347435, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/EC7Qo.png?s=128&g=1", "display_name": "SoldierCorp", "link": "https://stackoverflow.com/users/1347435/soldiercorp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 303, "favorite_count": 0, "accepted_answer_id": 48353154, "answer_count": 2, "score": -1, "last_activity_date": 1516428341, "creation_date": 1516421850, "question_id": 48352537, "link": "https://stackoverflow.com/questions/48352537/iris-go-get-form-urlencoded-data-not-working", "title": "Iris GO: Get form urlencoded data not working", "body": "<p>I'm trying with something very simple, get the information from a slack command of an app I'm building, and since I'm very new with Go I found that Iris is a very good framework so I decided to use it and the example from the website it's actually working <a href=\"https://iris-go.com/v10/recipe#Read\" rel=\"nofollow noreferrer\">https://iris-go.com/v10/recipe#Read</a> Form90 but when I receive data from slack, is not and this error always appear.</p>\n\n<pre><code>\u279c  slack-app go run iris.go\n[DBUG] 2018/01/19 22:10 POST: /prices -&gt; main.main.func1() and 2 more\n[DBUG] 2018/01/19 22:10 Application: running using 1 host(s)\n[DBUG] 2018/01/19 22:10 Host: addr is :8080\n[DBUG] 2018/01/19 22:10 Host: virtual host is localhost:8080\n[DBUG] 2018/01/19 22:10 Host: register startup notifier\n[DBUG] 2018/01/19 22:10 Host: register server shutdown on interrupt(CTRL+C/CMD+C)\nNow listening on: http://localhost:8080\nApplication started. Press CMD+C to shut down.\n[WARN] 2018/01/19 22:10 Recovered from a route's Handler('main.main.func1')\nAt Request: 200 /prices POST ::1\nTrace: reflect.Value.Interface: cannot return value obtained from unexported field or method\n\n/usr/local/go/src/runtime/asm_amd64.s:509\n/usr/local/go/src/runtime/panic.go:491\n/usr/local/go/src/reflect/value.go:942\n/usr/local/go/src/reflect/value.go:931\n/Users/myuser/go/src/github.com/kataras/iris/vendor/github.com/iris-contrib/formBinder/utils.go:18\n/Users/myuser/go/src/github.com/kataras/iris/vendor/github.com/iris-contrib/formBinder/binder.go:371\n/Users/myuser/go/src/github.com/kataras/iris/vendor/github.com/iris-contrib/formBinder/binder.go:361\n/Users/myuser/go/src/github.com/kataras/iris/vendor/github.com/iris-contrib/formBinder/binder.go:271\n/Users/myuser/go/src/github.com/kataras/iris/vendor/github.com/iris-contrib/formBinder/binder.go:165\n/Users/myuser/go/src/github.com/kataras/iris/vendor/github.com/iris-contrib/formBinder/binder.go:153\n/Users/myuser/go/src/github.com/kataras/iris/context/context.go:1972\n/Users/myuser/go/src/slack-app/iris.go:32\n/Users/myuser/go/src/github.com/kataras/iris/context/context.go:900\n/Users/myuser/go/src/github.com/kataras/iris/context/context.go:1172\n/Users/myuser/go/src/github.com/kataras/iris/middleware/logger/logger.go:50\n/Users/myuser/go/src/github.com/kataras/iris/middleware/logger/logger.go:31\n/Users/myuser/go/src/github.com/kataras/iris/context/context.go:900\n/Users/myuser/go/src/github.com/kataras/iris/context/context.go:1172\n/Users/myuser/go/src/github.com/kataras/iris/middleware/recover/recover.go:56\n/Users/myuser/go/src/github.com/kataras/iris/context/context.go:913\n/Users/myuser/go/src/github.com/kataras/iris/context/context.go:1070\n/Users/myuser/go/src/github.com/kataras/iris/core/router/handler.go:219\n/Users/myuser/go/src/github.com/kataras/iris/core/router/router.go:70\n/Users/myuser/go/src/github.com/kataras/iris/core/router/router.go:147\n/usr/local/go/src/net/http/server.go:2619\n/usr/local/go/src/net/http/server.go:1801\n/usr/local/go/src/runtime/asm_amd64.s:2337\n</code></pre>\n\n<p><strong>code</strong></p>\n\n<pre><code>    package main\n\nimport (\n  \"github.com/kataras/iris\"\n\n  \"github.com/kataras/iris/middleware/logger\"\n  \"github.com/kataras/iris/middleware/recover\"\n)\n\ntype Student struct {\n  channel_id string\n  channel_name string\n  command string\n  response_url string\n  team_domain string\n  team_id string\n  text string\n  token string\n  trigger_id string\n  user_id string\n  user_name string\n}\n\nfunc main() {\n  app := iris.New()\n  app.Logger().SetLevel(\"debug\")\n  app.Use(recover.New())\n  app.Use(logger.New())\n\n  app.Post(\"/prices\", func(ctx iris.Context) {\n    student := Student{}\n    err := ctx.ReadForm(&amp;student)\n    if err != nil {\n      ctx.StatusCode(iris.StatusInternalServerError)\n      ctx.WriteString(err.Error())\n    }\n\n    ctx.Writef(\"Student: %#v\", student)\n  })\n\n  app.Run(iris.Addr(\":8080\"))\n}\n</code></pre>\n"}, {"tags": ["rest", "go", "encryption", "hmac", "sha"], "comments": [{"owner": {"reputation": 36469, "user_id": 238704, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VgOZI.png?s=128&g=1", "display_name": "President James K. Polk", "link": "https://stackoverflow.com/users/238704/president-james-k-polk"}, "edited": false, "score": 0, "creation_date": 1516419807, "post_id": 48352311, "comment_id": 83691509, "body": "The output from the docs is displayed in hex, but you are displaying your output in base64. Try the <code>encoding&#47;hex</code> package."}], "answers": [{"tags": [], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "is_accepted": false, "score": 0, "last_activity_date": 1516421045, "creation_date": 1516421045, "answer_id": 48352465, "question_id": 48352311, "link": "https://stackoverflow.com/questions/48352311/trouble-getting-hmacsha256-to-produce-expected-results/48352465#48352465", "title": "Trouble getting HMACsha256 to produce expected results", "body": "<p>Result is displayed in hex not in base64. Here is the <a href=\"https://play.golang.org/p/EszhPA2H46Q\" rel=\"nofollow noreferrer\">play ground</a> link to the modified code</p>\n"}, {"tags": [], "owner": {"reputation": 28120, "user_id": 492773, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b4c30dea4ed3e1c2efc5e877f1f3c971?s=128&d=identicon&r=PG", "display_name": "kichik", "link": "https://stackoverflow.com/users/492773/kichik"}, "is_accepted": true, "score": 2, "last_activity_date": 1516422118, "creation_date": 1516422118, "answer_id": 48352559, "question_id": 48352311, "link": "https://stackoverflow.com/questions/48352311/trouble-getting-hmacsha256-to-produce-expected-results/48352559#48352559", "title": "Trouble getting HMACsha256 to produce expected results", "body": "<p>You got the same result in both cases. It's just encoded differently. The <code>openssl</code> command encodes it as hex and your function uses <code>base64.StdEncoding.EncodeToString()</code> to encode it as base64.</p>\n\n<p>Here's a small Python 2 snippet showing this:</p>\n\n<pre><code>&gt;&gt;&gt; x = \"c8db56825ae71d6d79447849e617115f4a920fa2acdcab2b053c4b2838bd6b71\"\n&gt;&gt;&gt; y = \"yNtWglrnHW15RHhJ5hcRX0qSD6Ks3KsrBTxLKDi9a3E=\".decode('base64').encode('hex')\n&gt;&gt;&gt; y\n'c8db56825ae71d6d79447849e617115f4a920fa2acdcab2b053c4b2838bd6b71'\n&gt;&gt;&gt; x == y\nTrue\n</code></pre>\n\n<p>To get the exact same result as the command line use <code>hex.EncodeToString()</code> as @Anuruddha suggested.</p>\n\n<pre><code>import \"encoding/hex\"\n\nfunc hmacify(message string, secret string) string {\n    key := []byte(secret)\n    h := hmac.New(sha256.New, key)\n    h.Write([]byte(message))\n    return hex.EncodeToString(h.Sum(nil))  // &lt;--- change is HERE\n}\n</code></pre>\n"}], "owner": {"reputation": 161, "user_id": 7111995, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/362b2d03c7413977184f18ff5bfd302a?s=128&d=identicon&r=PG&f=1", "display_name": "K. Rhoda", "link": "https://stackoverflow.com/users/7111995/k-rhoda"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 48352559, "answer_count": 2, "score": 1, "last_activity_date": 1516422118, "creation_date": 1516418936, "question_id": 48352311, "link": "https://stackoverflow.com/questions/48352311/trouble-getting-hmacsha256-to-produce-expected-results", "title": "Trouble getting HMACsha256 to produce expected results", "body": "<p>I'm trying to hook into the Binance API and have discovered that my implementation of HMACsha256 isn't producing the results that the sample documentation (and doing it in the command line) can. I'm trying to improve my knowledge of Go, but can't seem to crack this one.</p>\n\n<p>Here's the documentation (Relevant Sample at \"SIGNED Endpoint Examples for POST /api/v1/order\"): <a href=\"https://github.com/binance-exchange/binance-official-api-docs/blob/master/rest-api.md\" rel=\"nofollow noreferrer\">https://github.com/binance-exchange/binance-official-api-docs/blob/master/rest-api.md</a></p>\n\n<p>Without looking at the doc, here is the gist, my key is the following:</p>\n\n<pre><code>NhqPtmdSJYdKjVHjA7PZj4Mge3R5YNiP1e3UZjInClVN65XAbvqqM6A7H5fATj0j\n</code></pre>\n\n<p>my value is the following:</p>\n\n<pre><code>symbol=LTCBTC&amp;side=BUY&amp;type=LIMIT&amp;timeInForce=GTC&amp;quantity=1&amp;price=0.1&amp;recvWindow=5000&amp;timestamp=1499827319559\n</code></pre>\n\n<p>When I use the terminal with the following command:</p>\n\n<pre><code>echo -n \"symbol=LTCBTC&amp;side=BUY&amp;type=LIMIT&amp;timeInForce=GTC&amp;quantity=1&amp;price=0.1&amp;recvWindow=5000&amp;timestamp=1499827319559\" | openssl dgst -sha256 -hmac \"NhqPtmdSJYdKjVHjA7PZj4Mge3R5YNiP1e3UZjInClVN65XAbvqqM6A7H5fATj0j\"\n</code></pre>\n\n<p>I receive the result</p>\n\n<pre><code>c8db56825ae71d6d79447849e617115f4a920fa2acdcab2b053c4b2838bd6b71\n</code></pre>\n\n<p>Which is what the documentation suggests. But when I use the following go program: </p>\n\n<pre><code>package main\n\nimport (\n    \"crypto/hmac\"\n    \"crypto/sha256\"\n    \"encoding/base64\"\n    \"fmt\"\n)\n\nfunc main() {\n    docSecret := \"NhqPtmdSJYdKjVHjA7PZj4Mge3R5YNiP1e3UZjInClVN65XAbvqqM6A7H5fATj0j\"\n    docQuery := \"symbol=LTCBTC&amp;side=BUY&amp;type=LIMIT&amp;timeInForce=GTC&amp;quantity=1&amp;price=0.1&amp;recvWindow=5000&amp;timestamp=1499827319559\"\n    result := hmacify(docQuery, docSecret)\n    fmt.Println(result)\n}\n\nfunc hmacify(message string, secret string) string {\n    key := []byte(secret)\n    h := hmac.New(sha256.New, key)\n    h.Write([]byte(message))\n    return base64.StdEncoding.EncodeToString(h.Sum(nil))\n}\n</code></pre>\n\n<p>produces the result:</p>\n\n<pre><code>yNtWglrnHW15RHhJ5hcRX0qSD6Ks3KsrBTxLKDi9a3E=\n</code></pre>\n\n<p>What am I misunderstanding that's causing such a massive difference from the sample and command line?</p>\n"}, {"tags": ["go", "wait", "race-condition"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1516413339, "post_id": 48351816, "comment_id": 83690470, "body": "I don\u2019t understand what you\u2019re trying to do with WaitGroup here. You should <code>Add</code> before dispatching a goroutine, defer <code>Done</code> in the goroutine, and call <code>Wait</code> <i>once</i>."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1516413579, "post_id": 48351816, "comment_id": 83690515, "body": "I think what you are looking for is <code>sync.Mutex</code> instead of <code>WaitGroup</code>. Change all your <code>Add(1)</code> to <code>Lock()</code> and <code>Done()</code> to <code>Unlock()</code> makes more sense"}, {"owner": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516413893, "post_id": 48351816, "comment_id": 83690567, "body": "@JimB: I want to pause the calling of <code>proxyProvider.receivingProxyBC.In() &lt;- proxy</code> when <code>proxySource.GetProxies()</code> or <code>for _, proxy := range proxies</code> is called."}, {"owner": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516413940, "post_id": 48351816, "comment_id": 83690577, "body": "@leafbebop: Does <code>sync.Mutex</code> touch the root problem here :)"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 2, "creation_date": 1516414166, "post_id": 48351816, "comment_id": 83690617, "body": "I think it is the exact tool for the need you describe."}], "answers": [{"comments": [{"owner": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "edited": false, "score": 0, "creation_date": 1516421482, "post_id": 48352212, "comment_id": 83691769, "body": "I see the main point is that:  - Adds must not happen concurrently with Wait - <a href=\"https://github.com/coreos/etcd/issues/6534\" rel=\"nofollow noreferrer\">github.com/coreos/etcd/issues/6534</a>"}, {"owner": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "edited": false, "score": 0, "creation_date": 1516421774, "post_id": 48352212, "comment_id": 83691820, "body": "It seem that mutex locked all <code>localSources</code>; I need <code>localSources</code> to run in concurrent; when there is one of <code>localSources</code> working then lock all <code>remoteSources</code> --&gt; Need array of lock len(localSources) lock? :)"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "reply_to_user": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "edited": false, "score": 1, "creation_date": 1516422981, "post_id": 48352212, "comment_id": 83691998, "body": "@o0omycomputero0o Use <code>mutex.RWMutex</code>. use <code>rw.RLock()</code> for <code>localSources</code> and <code>rw.Loc()</code> for <code>recivingProxyBC.In()</code>."}, {"owner": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "edited": false, "score": 0, "creation_date": 1516424845, "post_id": 48352212, "comment_id": 83692306, "body": "I&#39;ve used (in new updated code) <code>mutex.RWMutex</code>, <code>localSources</code> locked all <code>remoteSources</code> but each <code>remoteSources</code> locked each other <code>remoteSources</code>. <code>mutex.RWMutex</code> seem not totally adapt to what I need."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "reply_to_user": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "edited": false, "score": 1, "creation_date": 1516427493, "post_id": 48352212, "comment_id": 83692766, "body": "@o0omycomputero0o then you need to use <code>sync.Cond</code>. Maintain a counter, and change <code>RLock</code> to add one to the counter and change <code>RUnlock</code> to decrease one to the counter. Both should be atomic or use a mutex. Change <code>Lock</code> to <code>Wait()</code> loop in the example. Documents: <a href=\"https://golang.org/pkg/sync/#Cond\" rel=\"nofollow noreferrer\">golang.org/pkg/sync/#Cond</a>"}], "tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 2, "last_activity_date": 1516417558, "creation_date": 1516417558, "answer_id": 48352212, "question_id": 48351816, "link": "https://stackoverflow.com/questions/48351816/waitgroup-is-reused-before-previous-wait-unknown-reason/48352212#48352212", "title": "WaitGroup is reused before previous Wait unknown reason", "body": "<p>From <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"nofollow noreferrer\">document</a>:</p>\n\n<blockquote>\n  <p>A WaitGroup waits for a collection of goroutines to finish. The main\n  goroutine calls Add to set the number of goroutines to wait for. Then\n  each of the goroutines runs and calls Done when finished. At the same\n  time, Wait can be used to block until all goroutines have finished.</p>\n</blockquote>\n\n<p>and for <code>Wait()</code> :</p>\n\n<blockquote>\n  <p>Wait blocks until the WaitGroup counter is zero.</p>\n</blockquote>\n\n<p>You can also see examples there. The thing is, <code>WaitGroup</code> is used for blocing until the counter gets to zero. So in orignal code, assume no runtime error, every goroutine in the second for loop will block until goroutines in the first is done. And in the first part, the <code>Add(1)</code> and <code>Done()</code> would not block at all. Data race would remain.</p>\n\n<p>The the error is documented in <code>Add()</code> methods:\n Add adds delta, which may be negative, to the WaitGroup counter. If the counter becomes zero, all goroutines blocked on Wait are released. If the counter goes negative, Add panics.</p>\n\n<blockquote>\n  <p>Note that calls with a positive delta that occur when the counter is\n  zero must happen before a Wait. Calls with a negative delta, or calls\n  with a positive delta that start when the counter is greater than\n  zero, may happen at any time. Typically this means the calls to Add\n  should execute before the statement creating the goroutine or other\n  event to be waited for. If a WaitGroup is reused to wait for several\n  independent sets of events, new Add calls must happen after all\n  previous Wait calls have returned. See the WaitGroup example.</p>\n</blockquote>\n\n<p>However, You are not waiting for <strong>independent</strong> sets of groups either.</p>\n\n<p>The tool fitting for your code is <code>sync.Mutex</code>. Document, again:</p>\n\n<blockquote>\n  <p>A Mutex is a mutual exclusion lock. The zero value for a Mutex is an\n  unlocked mutex.</p>\n  \n  <p>A Mutex must not be copied after first use.</p>\n  \n  <p>type Mutex struct {\n          // contains filtered or unexported fields }</p>\n  \n  <p>func (*Mutex) Lock</p>\n  \n  <p>func (m *Mutex) Lock()</p>\n  \n  <p>Lock locks m. If the lock is already in use, the calling goroutine\n  blocks until the mutex is available. func (*Mutex) Unlock</p>\n  \n  <p>func (m *Mutex) Unlock()</p>\n  \n  <p>Unlock unlocks m. It is a run-time error if m is not locked on entry\n  to Unlock.</p>\n</blockquote>\n\n<p>So as you describe, you want \"pause the calling of <code>proxyProvider.receivingProxyBC.In() &lt;- proxy</code> when <code>proxySource.GetProxies()</code> or <code>for _, proxy := range proxies</code> is called\". Pause is better described by the term <em>block</em>, and that is a textbook mutex lock problem: Guard all three \"calls\" (as for loop is not a call) with locks and it is done.</p>\n\n<p>It might be a little tricky on how to guard a for loop with mutex, it should look like this:</p>\n\n<pre><code>lock.Lock\nfor ... {\n    lock.Unlock()\n    ...\n    lock.Lock()\n}\n</code></pre>\n\n<p>So I changed you code and hopefully it should work as expected:</p>\n\n<pre><code>lock := sync.Mutex{}\nlock.Lock()\nfor _, proxySource := range localSources {\n    lock.Unlock()\n    go func(proxySource *ProxySource) {\n        lock.Lock()\n        lastTimeGet := time.Now()\n        firstTimeLoad := true\n        lock.Unlock()\n        for {\n            currentTimeGet := time.Now()\n            totalProxy := proxyProvider.receivingProxyBC.Len() + proxyProvider.workingProxyBC.Len()\n            if totalProxy &gt; 200 &amp;&amp; currentTimeGet.Sub(lastTimeGet) &lt; DURATION_FORCE_UPDATE &amp;&amp; !firstTimeLoad {\n                time.Sleep(proxySource.WatchWait)\n                continue\n            }\n            firstTimeLoad = false\n            lock.Lock()\n            proxies, err := proxySource.GetProxies()\n            lock.Unlock()\n            LogInfo(\"Get proxy from source \", proxySource.Id)\n            if err != nil {\n                time.Sleep(5 * time.Second)\n                continue\n            }\n            lock.Lock()\n            for _, proxy := range proxies {\n                proxyProvider.receivingProxyBC.In() &lt;- proxy\n            }\n            lock.Unlock()\n            lastTimeGet = time.Now()\n            time.Sleep(20 * time.Second)\n        }\n    }(proxySource)\n    lock.Lock()\n}\nfor _, proxySource := range remoteSources {\n    go func(proxySource *ProxySource) {\n        time.Sleep(2 * time.Second)\n        lastTimeGet := time.Now()\n        firstTimeLoad := true\n        for {\n            currentTimeGet := time.Now()\n            totalProxy := proxyProvider.receivingProxyBC.Len() + proxyProvider.workingProxyBC.Len()\n            if totalProxy &gt; 100 &amp;&amp; currentTimeGet.Sub(lastTimeGet) &lt; DURATION_FORCE_UPDATE &amp;&amp; !firstTimeLoad {\n                time.Sleep(proxySource.WatchWait)\n                continue\n            }\n            firstTimeLoad = false\n            proxies, err := proxySource.GetProxies()\n            if err != nil {\n                time.Sleep(5 * time.Second)\n                continue\n            }\n            for _, proxy := range proxies {\n                lock.Lock()\n                proxyProvider.receivingProxyBC.In() &lt;- proxy\n                lock.Unlock()\n            }\n            lastTimeGet = time.Now()\n            time.Sleep(20 * time.Second)\n        }\n    }(proxySource)\n}\n</code></pre>\n\n<p>Note 1: You may be tempted to use <code>defer</code>. Don't. <code>defer</code> is for function, not blocks.</p>\n\n<p>Note 2: When using mutex in golang, it often raise a question of designing. One shall always look if it is better to use channel and refactor the code, though in many cases mutex is not a bad idea. But here I can read nothing about the design so I will just let it go.</p>\n\n<p>Note 3: The code auctually has a problem of pausing <code>proxySource.GetProxies()</code> and the for loop when calling <code>proxyProvider.receivingProxyBC.In() &lt;- proxy</code>. Whether this is desired or not depends. If it is not desired, you should look at <code>sync.RWMutex</code>, and change it according to it. I will leave it to you.</p>\n"}], "owner": {"reputation": 2564, "user_id": 1125621, "user_type": "registered", "accept_rate": 53, "profile_image": "https://www.gravatar.com/avatar/c1b3328f06ea4ab079677388658dae10?s=128&d=identicon&r=PG", "display_name": "o0omycomputero0o", "link": "https://stackoverflow.com/users/1125621/o0omycomputero0o"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 804, "favorite_count": 0, "accepted_answer_id": 48352212, "answer_count": 1, "score": 0, "last_activity_date": 1516424737, "creation_date": 1516412456, "last_edit_date": 1516424737, "question_id": 48351816, "link": "https://stackoverflow.com/questions/48351816/waitgroup-is-reused-before-previous-wait-unknown-reason", "title": "WaitGroup is reused before previous Wait unknown reason", "body": "<p>I use the following code but don't know why it crash with error <strong>(WaitGroup is reused before previous Wait)</strong> at line:</p>\n\n<pre><code>for _, proxy := range proxies {\n                    wgGroup.Wait()\n</code></pre>\n\n<p>I want to ensure that when calling <code>proxySource.GetProxies()</code>, and <code>proxyProvider.receivingProxyBC.In() &lt;- proxy</code> then not allow <code>remoteSources</code> to call <code>proxyProvider.receivingProxyBC.In() &lt;- proxy</code></p>\n\n<p>Detail code here:</p>\n\n<pre><code>    wgGroup := sync.WaitGroup{}\n    wgGroup.Add(len(localSources))\n    for _, proxySource := range localSources {\n        go func(proxySource *ProxySource) {\n            lastTimeGet := time.Now()\n            firstTimeLoad := true\n            wgGroup.Done()\n            for {\n                currentTimeGet := time.Now()\n                totalProxy := proxyProvider.receivingProxyBC.Len() + proxyProvider.workingProxyBC.Len()\n                if totalProxy &gt; 200 &amp;&amp; currentTimeGet.Sub(lastTimeGet) &lt; DURATION_FORCE_UPDATE &amp;&amp; !firstTimeLoad {\n                    time.Sleep(proxySource.WatchWait)\n                    continue\n                }\n                firstTimeLoad = false\n                wgGroup.Add(1)\n                proxies, err := proxySource.GetProxies()\n                wgGroup.Done()\n                LogInfo(\"Get proxy from source \", proxySource.Id)\n                if err != nil {\n                    time.Sleep(5 * time.Second)\n                    continue\n                }\n                wgGroup.Add(1)\n                for _, proxy := range proxies {\n                    proxyProvider.receivingProxyBC.In() &lt;- proxy\n                }\n                wgGroup.Done()\n                lastTimeGet = time.Now()\n                time.Sleep(20 * time.Second)\n            }\n        }(proxySource)\n    }\n    for _, proxySource := range remoteSources {\n        go func(proxySource *ProxySource) {\n            time.Sleep(2 * time.Second)\n            lastTimeGet := time.Now()\n            firstTimeLoad := true\n            for {\n                currentTimeGet := time.Now()\n                totalProxy := proxyProvider.receivingProxyBC.Len() + proxyProvider.workingProxyBC.Len()\n                if totalProxy &gt; 100 &amp;&amp; currentTimeGet.Sub(lastTimeGet) &lt; DURATION_FORCE_UPDATE &amp;&amp; !firstTimeLoad {\n                    time.Sleep(proxySource.WatchWait)\n                    continue\n                }\n                firstTimeLoad = false\n                proxies, err := proxySource.GetProxies()\n                if err != nil {\n                    time.Sleep(5 * time.Second)\n                    continue\n                }\n                for _, proxy := range proxies {\n                    wgGroup.Wait()\n                    proxyProvider.receivingProxyBC.In() &lt;- proxy\n                }\n                lastTimeGet = time.Now()\n                time.Sleep(20 * time.Second)\n            }\n        }(proxySource)\n    }\n</code></pre>\n\n<p><strong>UPDATE RWLOCK</strong></p>\n\n<p>Using these code I can lock <code>localSources</code> but it seem not optimized; I need when any <code>localSources</code> getting then lock all <code>remoteSources</code>; when there is no <code>localSources</code> getting, all <code>remoteSources</code> are allowed to get. Currently, only one <code>remoteSources</code> is allow to get at the same time.</p>\n\n<pre><code>wgGroup := sync.WaitGroup{}\nwgGroup.Add(len(localSources))\nlocalGroupRwLock := sync.RWMutex{}\nfor _, proxySource := range localSources {\n  go func(proxySource *ProxySource) {\n    lastTimeGet := time.Now()\n    firstTimeLoad := true\n    wgGroup.Done()\n    for {\n      currentTimeGet := time.Now()\n      totalProxy := proxyProvider.receivingProxyBC.Len() + proxyProvider.workingProxyBC.Len()\n      LogInfo(\"Total proxies \", totalProxy)\n      if totalProxy &gt; 100 &amp;&amp; currentTimeGet.Sub(lastTimeGet) &lt; DURATION_FORCE_UPDATE &amp;&amp; !firstTimeLoad {\n        LogInfo(\"Enough proxy &amp; proxy are not new sleep \", proxySource.Id, \" for \", proxySource.WatchWait.Seconds())\n        time.Sleep(proxySource.WatchWait)\n        continue\n      }\n      firstTimeLoad = false\n      LogInfo(\"Not enough proxy or proxies are new \", proxySource.Id)\n      localGroupRwLock.RLock()\n      proxies, err := proxySource.GetProxies()\n      localGroupRwLock.RUnlock()\n      LogInfo(\"Get proxy from source \", proxySource.Id)\n      if err != nil {\n        LogError(\"Error when get proxies from \", proxySource.Id)\n        time.Sleep(5 * time.Second)\n        continue\n      }\n      LogInfo(\"Add proxy from source \", proxySource.Id)\n      localGroupRwLock.RLock()\n      for _, proxy := range proxies {\n        proxyProvider.receivingProxyBC.In() &lt;- proxy\n      }\n      localGroupRwLock.RUnlock()\n      LogInfo(\"Done add proxy from source \", proxySource.Id)\n      //LogInfo(\"Gotten proxy source \", proxySource.Id, \" done now sleep \", proxySource.Cooldown.String())\n      lastTimeGet = time.Now()\n      time.Sleep(20 * time.Second) // 20 seconds for loading new proxies\n      LogInfo(\"Watch for proxy source\", proxySource.Id)\n    }\n  }(proxySource)\n}\nfor _, proxySource := range remoteSources {\n  go func(proxySource *ProxySource) {\n    time.Sleep(2 * time.Second)\n    lastTimeGet := time.Now()\n    firstTimeLoad := true\n    for {\n      currentTimeGet := time.Now()\n      totalProxy := proxyProvider.receivingProxyBC.Len() + proxyProvider.workingProxyBC.Len()\n      LogInfo(\"Total proxies \", totalProxy)\n      if totalProxy &gt; 100 &amp;&amp; currentTimeGet.Sub(lastTimeGet) &lt; DURATION_FORCE_UPDATE &amp;&amp; !firstTimeLoad {\n        LogInfo(\"Enough proxy &amp; proxy are not new sleep \", proxySource.Id, \" for \", proxySource.WatchWait.Seconds())\n        time.Sleep(proxySource.WatchWait)\n        continue\n      }\n      firstTimeLoad = false\n      LogInfo(\"Not enough proxy or proxies are new \", proxySource.Id)\n      LogInfo(\"Get proxy from source \", proxySource.Id)\n      localGroupRwLock.Lock()\n      proxies, err := proxySource.GetProxies()\n      localGroupRwLock.Unlock()\n      if err != nil {\n        LogError(\"Error when get proxies from \", proxySource.Id)\n        time.Sleep(5 * time.Second)\n        continue\n      }\n      LogInfo(\"Add proxy from source \", proxySource.Id)\n      wgGroup.Wait()\n      localGroupRwLock.Lock()\n      for _, proxy := range proxies {\n        proxyProvider.receivingProxyBC.In() &lt;- proxy\n      }\n      localGroupRwLock.Unlock()\n      LogInfo(\"Done add proxy from source \", proxySource.Id)\n      //LogInfo(\"Gotten proxy source \", proxySource.Id, \" done now sleep \", proxySource.Cooldown.String())\n      lastTimeGet = time.Now()\n      time.Sleep(20 * time.Second) // 20 seconds for loading new proxies\n      LogInfo(\"Watch for proxy source\", proxySource.Id)\n    }\n  }(proxySource)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "edited": false, "score": 0, "creation_date": 1516398180, "post_id": 48349927, "comment_id": 83686366, "body": "Provide the code, please"}, {"owner": {"reputation": 122, "user_id": 7627403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fdaccc0da50884c34018c1aaef79db?s=128&d=identicon&r=PG&f=1", "display_name": "Krish Bhanushali", "link": "https://stackoverflow.com/users/7627403/krish-bhanushali"}, "reply_to_user": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "edited": false, "score": 0, "creation_date": 1516399029, "post_id": 48349927, "comment_id": 83686761, "body": "Please see the code @Rudzianko\u016d"}, {"owner": {"reputation": 8341, "user_id": 3014866, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/epfow.jpg?s=128&g=1", "display_name": "Rudzianko\u016d", "link": "https://stackoverflow.com/users/3014866/rudzianko%c5%ad"}, "edited": false, "score": 0, "creation_date": 1516399858, "post_id": 48349927, "comment_id": 83687106, "body": "if <code>abs</code> is <code>&#47;dir1&#47;dir2&#47;</code> than you concatenate extra <code>&#47;</code> when creating file with <code>os.Create</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1516401643, "post_id": 48349927, "comment_id": 83687744, "body": "This may not be the problem, but replace <code>abs+&quot;&#47;&quot;+file.Filename</code> with <code>filepath.Join(abs, file.Filename)</code>.  Separately, using a client supplied filename like this is dangerous."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516403809, "post_id": 48349927, "comment_id": 83688396, "body": "Any errors does the program give?"}, {"owner": {"reputation": 122, "user_id": 7627403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fdaccc0da50884c34018c1aaef79db?s=128&d=identicon&r=PG&f=1", "display_name": "Krish Bhanushali", "link": "https://stackoverflow.com/users/7627403/krish-bhanushali"}, "edited": false, "score": 0, "creation_date": 1516404358, "post_id": 48349927, "comment_id": 83688550, "body": "Yes!! Never knew we cannot join the strings that way in Go. You have to use strings.Join(). I simply solved this problem using, os.Create(strings.Join([]string{path,file.FileName},&quot;/&quot;)) where my path is simply a string of my directory path."}], "answers": [{"comments": [{"owner": {"reputation": 325, "user_id": 8618438, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TfmU3we5fjg/AAAAAAAAAAI/AAAAAAAAAEc/h_kTa9TmWIY/photo.jpg?sz=128", "display_name": "stand alone", "link": "https://stackoverflow.com/users/8618438/stand-alone"}, "edited": false, "score": 0, "creation_date": 1543144522, "post_id": 48351004, "comment_id": 93804485, "body": "It&#39;s not obvious what is <code>checkErr(err)</code> I have no such function in the scope and quick googling don&#39;t get the answer. Is it just &quot;some user defined function&quot; which checks error?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 325, "user_id": 8618438, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-TfmU3we5fjg/AAAAAAAAAAI/AAAAAAAAAEc/h_kTa9TmWIY/photo.jpg?sz=128", "display_name": "stand alone", "link": "https://stackoverflow.com/users/8618438/stand-alone"}, "edited": false, "score": 0, "creation_date": 1543149616, "post_id": 48351004, "comment_id": 93805687, "body": "@standalone The function <code>checkErr</code> comes from the question. It&#39;s an application supplied function for handling the error. There are other ways to handle errors than as is done in the question and this answer, but that&#39;s outside the scope of what was asked."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": false, "score": 7, "last_activity_date": 1516405205, "last_edit_date": 1516405205, "creation_date": 1516404801, "answer_id": 48351004, "question_id": 48349927, "link": "https://stackoverflow.com/questions/48349927/how-to-write-a-directory-with-a-file-in-golang/48351004#48351004", "title": "How to write a directory with a file in golang?", "body": "<p>Use <a href=\"https://godoc.org/path/filepath#Join\" rel=\"noreferrer\">filepath.Join</a> to create the path from the directory <code>dir</code> and the file name.  </p>\n\n<p>To protect against a write to an arbitrary location in the file system, clean the path with <a href=\"https://godoc.org/path/filepath#Base\" rel=\"noreferrer\">filepath.Base</a>.</p>\n\n<pre><code>file, err := c.FormFile(\"file\")\nif err != nil {\n    checkErr(err)\n    return\n}\nsrc, err := file.Open()\nif err != nil {\n    checkErr(err)\n    return\n}\ndefer src.Close()\n\ndst, err := os.Create(filepath.Join(dir, filepath.Base(file.Filename))) // dir is directory where you want to save file.\nif err != nil {\n    checkErr(err)\n    return\n}\ndefer dst.Close()\nif _, err = io.Copy(dst, src); err != nil {\n    checkErr(err)\n    return\n}\n</code></pre>\n"}], "owner": {"reputation": 122, "user_id": 7627403, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/76fdaccc0da50884c34018c1aaef79db?s=128&d=identicon&r=PG&f=1", "display_name": "Krish Bhanushali", "link": "https://stackoverflow.com/users/7627403/krish-bhanushali"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7156, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1516405205, "creation_date": 1516397973, "last_edit_date": 1516399015, "question_id": 48349927, "link": "https://stackoverflow.com/questions/48349927/how-to-write-a-directory-with-a-file-in-golang", "title": "How to write a directory with a file in golang?", "body": "<p>Right now, I am trying to use os.Create but it gives me an error while specifying the path of the file. I have to upload my file from HTML to my file system in a specific directory.</p>\n\n<pre><code>file,err:= c.FormFile(\"file\")\nif err!=nil{\n    checkErr(err)\n}\nsrc, err := file.Open()\nif err!=nil{\n    checkErr(err)\n}\ndefer src.Close()\n\nabs,err :=filepath.Abs(\"/dir1/dir2/\")\nif err!=nil{\n    checkErr(err)\n}\n\ndst,err := os.Create(abs+\"/\"+file.Filename)\nif err !=nil{\n    checkErr(err)\n}\ndefer dst.Close()\nif _,err = io.Copy(dst,src); err!=nil{\n    checkErr(err)\n}\n</code></pre>\n\n<p>I have to upload the file to dir2. Please help me out. Thank you.</p>\n"}, {"tags": ["linux", "go", "installation", "raspbian"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1516390406, "post_id": 48348262, "comment_id": 83682694, "body": "<i>Never</i> build using <code>sudo</code>. just use <code>go get</code>, <code>go build</code>, <code>go install</code>, etc."}, {"owner": {"reputation": 1346, "user_id": 684128, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/P0DUS.jpg?s=128&g=1", "display_name": "artberri", "link": "https://stackoverflow.com/users/684128/artberri"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516390760, "post_id": 48348262, "comment_id": 83682871, "body": "As @JimB said don&#39;t use sudo to run the go command. You just need it to install it and your already did it with <code>sudo apt-get</code>.  Just to let you know, you have set the GOPATH to your user when doing that export. But when you run somethin with <code>sudo</code> you are running a command as the <code>root</code> user which has not set the GOPATH. <code>sudo</code> -&gt; &quot;Do as super user&quot;"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516391318, "post_id": 48348262, "comment_id": 83683152, "body": "Also, of you&#39;re getting a <code>$GOPATH not set</code> error, you&#39;re using an old version of Go. You may want to use the binary install directly from golang.org. if it&#39;s available for your os/arch."}, {"owner": {"reputation": 187, "user_id": 9241816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a752034806840e8961870466844a10e4?s=128&d=identicon&r=PG&f=1", "display_name": "heiko", "link": "https://stackoverflow.com/users/9241816/heiko"}, "edited": false, "score": 0, "creation_date": 1516537845, "post_id": 48348262, "comment_id": 83720077, "body": "How to make go working:  download the latest version of go in a new folder (like download)  go1.9.linux-armv6l.tar.gz    in a new directory like download    install with   sudo apt-get install golang      an older version of go (golang)  in my case it was 1.7.4   then use  sudo tar -C /home/pi -xzf go1.9.linux-armv6l.tar.gz"}, {"owner": {"reputation": 187, "user_id": 9241816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a752034806840e8961870466844a10e4?s=128&d=identicon&r=PG&f=1", "display_name": "heiko", "link": "https://stackoverflow.com/users/9241816/heiko"}, "edited": false, "score": 0, "creation_date": 1516537892, "post_id": 48348262, "comment_id": 83720089, "body": "to install go version 1.9  in a new directory  in my case   home/pi/go   with   sudo apt remove golang  and  sudo apt-get autoremove  remove the older version of go  to check unse   go version  which give you the actual version of go  it should be go1.9 linux/arm   please check with   go env  or  go env GOPATH  the GOPATH direction"}, {"owner": {"reputation": 187, "user_id": 9241816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a752034806840e8961870466844a10e4?s=128&d=identicon&r=PG&f=1", "display_name": "heiko", "link": "https://stackoverflow.com/users/9241816/heiko"}, "edited": false, "score": 0, "creation_date": 1516537914, "post_id": 48348262, "comment_id": 83720095, "body": "with   ls -a   (used in /home/pi/ )  give you a list of all files and also shows you ~/.profile  with   sudo nano ~/.profile  you can open that file an add the recomanded code for the go directory     export GOROOT=/home/pi/go  export GOPATH=/home/pi/go/bin    close with STRG + O  and ENTER  and STRG + X  check with   go env GOPATH  then use  source ~/.profile   Now go should be running on the latest version and should have the correct GOPATH directory   For me helpful was <a href=\"https://tecadmin.net/install-go-on-debian/#\" rel=\"nofollow noreferrer\">tecadmin.net/install-go-on-debian/#</a>"}], "answers": [{"comments": [{"owner": {"reputation": 187, "user_id": 9241816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a752034806840e8961870466844a10e4?s=128&d=identicon&r=PG&f=1", "display_name": "heiko", "link": "https://stackoverflow.com/users/9241816/heiko"}, "edited": false, "score": 0, "creation_date": 1516546689, "post_id": 48366822, "comment_id": 83722782, "body": "ok, one more comment on that       export GOPATH =/home/pi/go  export PATH=$PATH:/home/pi/go/bin  in the ~/.profile   document  otherwise i got an error wenn trying to run go but now it works perfectly, no errors or anything even with the older version 1.7.4 of golang.  so i really hope this helps others  or me later on, when setting up again"}], "tags": [], "owner": {"reputation": 187, "user_id": 9241816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a752034806840e8961870466844a10e4?s=128&d=identicon&r=PG&f=1", "display_name": "heiko", "link": "https://stackoverflow.com/users/9241816/heiko"}, "is_accepted": false, "score": -1, "last_activity_date": 1587925453, "last_edit_date": 1587925453, "creation_date": 1516538102, "answer_id": 48366822, "question_id": 48348262, "link": "https://stackoverflow.com/questions/48348262/install-go-golang-on-raspbian/48366822#48366822", "title": "Install go (golang) on Raspbian", "body": "<p>How to install golang:</p>\n\n<p>Download the latest tarball, <em>go1.9.linux-armv6l.tar.gz</em>, to a directory such as <em>/home/pi/downloads</em>.</p>\n\n<p>Then use:</p>\n\n<p><code>sudo tar -C /home/pi -xzf go1.9.linux-armv6l.tar.gz</code></p>\n\n<p>to extract the go installation to the directory</p>\n\n<p><em>/home/pi</em></p>\n\n<p>creating <em>/home/pi/go</em></p>\n\n<p>to check use</p>\n\n<p><code>go version</code></p>\n\n<p>Which will give you the actual version of go.</p>\n\n<p>It should be go1.9 linux/arm.</p>\n\n<p>Please check with: </p>\n\n<p><code>go env</code></p>\n\n<p>or</p>\n\n<p><code>go env GOPATH</code></p>\n\n<p>the <strong>GOPATH</strong> direction</p>\n\n<p>with </p>\n\n<p><code>ls -a #  (used in /home/pi/ )</code></p>\n\n<p>give you a list of all files and also shows you <em>~/.profile</em></p>\n\n<p>with </p>\n\n<p><code>sudo nano ~/.profile</code></p>\n\n<p>you can open that file an add the reccommended code for the go directory</p>\n\n<pre><code> export GOROOT=/home/pi/go\n export GOPATH=/home/pi/go/bin\n</code></pre>\n\n<p>close with STRG + O  and ENTER  and STRG + X</p>\n\n<p>check with </p>\n\n<p><code>go env GOPATH</code></p>\n\n<p>then use</p>\n\n<p><code>source ~/.profile</code></p>\n\n<p>then you can check again with</p>\n\n<p><code>go env</code></p>\n\n<p>Now go should be running on the latest version and should have the correct <strong>GOPATH</strong> directory</p>\n\n<p>For me helpful was this link: <a href=\"https://tecadmin.net/install-go-on-debian/#\" rel=\"nofollow noreferrer\">https://tecadmin.net/install-go-on-debian/#</a></p>\n\n<p>I really hope some others also give detailed descriptions of how to install a program in a brief and detailed way. Instead of 3 lines of single code.</p>\n"}, {"comments": [{"owner": {"reputation": 8672, "user_id": 555946, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OTX0B.jpg?s=128&g=1", "display_name": "Mohammed Swillam", "link": "https://stackoverflow.com/users/555946/mohammed-swillam"}, "edited": false, "score": 2, "creation_date": 1537716850, "post_id": 48525875, "comment_id": 91877007, "body": "Thank you @Peter. I&#39;ve followed your well-written steps and everything works! this should be the accepted answer."}, {"owner": {"reputation": 3431, "user_id": 708807, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/42e591ae5892aec3d16fac571d48cd45?s=128&d=identicon&r=PG", "display_name": "ipatch", "link": "https://stackoverflow.com/users/708807/ipatch"}, "edited": false, "score": 0, "creation_date": 1588101946, "post_id": 48525875, "comment_id": 108770276, "body": "as awesome as the instructions are, and their great for testing out a new install of the go lang tooling, putting that helloworld directory within the <code>$HOME&#47;go&#47;src</code> directory will prevent packages from updating using <code>go get -u [github.com&#47;user&#47;go-pkg]</code> the <code>go get</code> cmd will complain about having a directory within the <code>src</code> dir that hasn&#39;t been initialized with a VCS. see <a href=\"https://github.com/tools/godep/issues/116\" rel=\"nofollow noreferrer\">this</a>"}], "tags": [], "owner": {"reputation": 804, "user_id": 7171834, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9r1VB.png?s=128&g=1", "display_name": "Peter Gloor", "link": "https://stackoverflow.com/users/7171834/peter-gloor"}, "is_accepted": false, "score": 33, "last_activity_date": 1517328674, "creation_date": 1517328674, "answer_id": 48525875, "question_id": 48348262, "link": "https://stackoverflow.com/questions/48348262/install-go-golang-on-raspbian/48525875#48525875", "title": "Install go (golang) on Raspbian", "body": "<p>This are detailed instructions about how to install Go on Raspbian Stretch from the repositories.</p>\n\n<p>As of today, 2018-01-30, this will install Go 1.7. The most actual version for manual installation from the downloads is Go 1.9.3. </p>\n\n<p>I. Login to your user on the Raspberry Pi (I'm using the default user pi).</p>\n\n<p>II. Install Go (golang)</p>\n\n<pre><code>pi@pi3-2:~ $ sudo apt update \npi@pi3-2:~ $ sudo apt install golang\n</code></pre>\n\n<p>III. Create a working directory for all your go projects in your $HOME directory. It's best to name it go, as this defaults to the GOPATH in future Go versions (starting with Go 1.8).</p>\n\n<pre><code>pi@pi3-2:~ $ mkdir go\n</code></pre>\n\n<p>IV. Append the $GOPATH environment variable and modified PATH settings to your .profile</p>\n\n<pre><code>pi@pi3-2:~ $ echo 'export GOPATH=$HOME/go' &gt;&gt; ~/.profile\npi@pi3-2:~ $ echo 'PATH=\"$HOME/go/bin:$PATH\"' &gt;&gt; ~/.profile\n</code></pre>\n\n<p>V. Logout and Relog with the new settings then check your settings</p>\n\n<pre><code>pi@pi3-2:~ $ go env\n\nGOARCH=\"arm\"\nGOBIN=\"\"\nGOEXE=\"\"\nGOHOSTARCH=\"arm\"\nGOHOSTOS=\"linux\"\nGOOS=\"linux\"\nGOPATH=\"/home/pi/go\"\nGORACE=\"\"\nGOROOT=\"/usr/lib/go-1.7\"\nGOTOOLDIR=\"/usr/lib/go-1.7/pkg/tool/linux_arm\"\nCC=\"gcc\"\nGOGCCFLAGS=\"-fPIC -marm -pthread -fmessage-length=0 -fdebug-prefix-map=/tmp/go-build187598155=/tmp/go-build -gno-record-gcc-switches\"\nCXX=\"g++\"\nCGO_ENABLED=\"1\"\n</code></pre>\n\n<p>Especially make sure GOPATH points to your previously created Go working directory. Don't care about setting GOBIN as mentioned in some documentation. It's usually not necessary and Go will automatically use $GOPATH/bin/ for your Go installs.</p>\n\n<p>However, you might also want to check the path settings (/home/pi/go/bin should be included) to make sure you can run the code you installed with go install. </p>\n\n<pre><code>pi@pi3-2:~ $ echo $PATH\n/home/pi/go/bin:/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/local/games:/usr/games\n</code></pre>\n\n<p>VI. A few words about the Go working directory structure</p>\n\n<p>Over time, the Go working directory will contain three sub-directories: bin, src and pkg. Except src they will be automatically created, when needed the first time. The structure for user pi will look like this:</p>\n\n<pre><code>/home\n  /pi\n    /go\n      /src\n      /pkg\n      /bin\n</code></pre>\n\n<p><strong>bin</strong> will contain all Go executable's you have installed using go install command.</p>\n\n<p><strong>pkg</strong> will contain all compiled packages that can be imported into your projects.</p>\n\n<p><strong>src</strong> will contain all your source files, either your own or sources downloaded from external repositories. </p>\n\n<p>For eksample the command <code>go get github.com/petergloor/hello-go</code> will automatically fetch and place the source files from the corresponding external Github repository into the local directory <em>$HOME/go/src/github.com/petergloor/hello-go</em>. </p>\n\n<p>As it's rather common to fetch external repositories either for reference or contribution it becomes important to keep your directory structure always well organized and clean.</p>\n\n<p>Apart from that you are free to organize your projects as long they are hierarchically structured below the $HOME/go/src/ directory and follow the rules mentioned in the documentation.</p>\n\n<p>However, to clearly organize my projects I personally always place my projects into $HOME/go/src/github.com/my-github-account even if I don't have an external repository for it. </p>\n\n<p>If you don't have a github account you can likewise use any other external repository account. </p>\n\n<p>As I mentioned, even it's not needed at all I prefere to use my Github account to clearly identify my projects. And even it's not needed I will use the username pi to distinct the user from other project maintainers in the following example.</p>\n\n<p>VII. So let's add a \"hello world\" project to test our installation.</p>\n\n<p>a) First let's create the project folder and cd into its directory.</p>\n\n<pre><code>pi@pi3-2:~ $ mkdir -p $HOME/go/src/pi/helloworld\npi@pi3-2:~ $ cd $HOME/go/src/pi/helloworld\npi@pi3-2:~/go/src/pi/helloworld $\n</code></pre>\n\n<p>b) With an editor of your choice create a file main.go with the following content</p>\n\n<pre><code>// helloworld project main.go.\npackage main\n\nimport (\"fmt\")\n\n// main is the entrypoint of the application.\nfunc main() {\n  fmt.Println(\"Hello world! Greetings from Raspberry Pi\")\n}\n</code></pre>\n\n<p>Spacing doesn't matter at this point. Go provides a nice tool to do this for you.</p>\n\n<p>c) Now try to run the program.</p>\n\n<pre><code>pi@pi3-2:~/go/src/pi/helloworld $ go run main.go\nHello world! Greetings from Raspberry Pi\npi@pi3-2:~/go/src/pi/helloworld $\n</code></pre>\n\n<p>In case you get an error, fix it! Carefully, check the spelling and cases  (Go is case-sensitive).</p>\n\n<p>d) Next lets format the code:</p>\n\n<pre><code>pi@pi3-2:~/go/src/pi/helloworld $ go fmt\n</code></pre>\n\n<p>Without a file name this will properly (re-)format all source files within this directory and below.</p>\n\n<p>e) Next let's build helloworld as an executable procram, within this directory.</p>\n\n<pre><code>pi@pi3-2:~/go/src/pi/helloworld $ go build\npi@pi3-2:~/go/src/pi/helloworld $ ls\nhelloworld  main.go\npi@pi3-2:~/go/src/pi/helloworld $\n</code></pre>\n\n<p>f) Now you can run it.</p>\n\n<pre><code>pi@pi3-2:~/go/src/pi/helloworld $ ./helloworld\nHello world! Greetings from Raspberry Pi\npi@pi3-2:~/go/src/pi/helloworld $\n</code></pre>\n\n<p>g) Finally let's install the program into the $HOME/go/bin/ directory.</p>\n\n<pre><code>pi@pi3-2:~/go/src/pi/helloworld $ go install\npi@pi3-2:~/go/src/pi/helloworld $ ls $HOME/go/bin\nhello-go  helloworld\npi@pi3-2:~/go/src/pi/helloworld $\n</code></pre>\n\n<p>h) If everything is done right it can be run by our pi user from anywhere by just entering the name of the command.</p>\n\n<pre><code>pi@pi3-2:~/go/src/pi/helloworld $ helloworld\nHello world! Greetings from Raspberry Pi\npi@pi3-2:~/go/src/pi/helloworld $ cd ~\npi@pi3-2:~ $ helloworld\nHello world! Greetings from Raspberry Pi\npi@pi3-2:~ $\n</code></pre>\n\n<p>Congratulations!</p>\n"}, {"tags": [], "owner": {"reputation": 5450, "user_id": 942317, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/SY5ID.jpg?s=128&g=1", "display_name": "STEEL", "link": "https://stackoverflow.com/users/942317/steel"}, "is_accepted": false, "score": 2, "last_activity_date": 1575370396, "last_edit_date": 1575370396, "creation_date": 1575113532, "answer_id": 59115745, "question_id": 48348262, "link": "https://stackoverflow.com/questions/48348262/install-go-golang-on-raspbian/59115745#59115745", "title": "Install go (golang) on Raspbian", "body": "<p>as of Nov 2019. (Please note if you need version 1.13+ please wget <code>go1.13.3.linux-amd64.tar.gz</code> manually)\nOR <code>sudo apt-get install golang-go</code> - <a href=\"https://github.com/golang/go/wiki/Ubuntu\" rel=\"nofollow noreferrer\">source</a></p>\n\n<p>You just have to type following commands on your RPi</p>\n\n<pre><code>sudo apt-get update\nsudo apt-get install golang --fix-missing\n</code></pre>\n\n<p>and when you type now <code>go version</code> following should be your output</p>\n\n<pre><code>pi@rpi1:~ $ go version\ngo version go1.11.6 linux/arm\n</code></pre>\n\n<p>Additionally, I also had the following installed before running everything\n<code>sudo apt-get install make gcc g++</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/3bDRz.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/3bDRz.png\" alt=\"enter image description here\"></a></p>\n"}], "owner": {"reputation": 187, "user_id": 9241816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a752034806840e8961870466844a10e4?s=128&d=identicon&r=PG&f=1", "display_name": "heiko", "link": "https://stackoverflow.com/users/9241816/heiko"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20492, "favorite_count": 9, "answer_count": 3, "score": 15, "last_activity_date": 1587925453, "creation_date": 1516390247, "last_edit_date": 1530175885, "question_id": 48348262, "link": "https://stackoverflow.com/questions/48348262/install-go-golang-on-raspbian", "title": "Install go (golang) on Raspbian", "body": "<p>I checked diverse forums but I still did not make it working.\nI like to install go (golang) on my Raspberry PI - Raspbian:</p>\n\n<p>With </p>\n\n<pre><code>sudo apt-get install golang\n</code></pre>\n\n<p>I installed go and with</p>\n\n<pre><code>export GOPATH=$home/pi/gocode\n</code></pre>\n\n<p>i set the GOPATH so i tryed to install from a homepage a new program with (<code>sudo go get -u github.com/....</code>) but, I only get \"<code>cannot download, $GOPATH not set. For more details see: go help gopath</code>\".</p>\n\n<p>I really get crazy for my studip simple mistake that i do not see.</p>\n\n<p>I would be pleased if i get a very detailed \"how to do\" discription since I am new to Linux and Raspbian, so everything which is made for real dummys should be good enough for me. \nThank you for your help.  </p>\n"}, {"tags": ["go", "vue.js"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1516389169, "post_id": 48347771, "comment_id": 83682109, "body": "Have you tried <a href=\"https://godoc.org/github.com/julienschmidt/httprouter#Router.ServeFiles\" rel=\"nofollow noreferrer\">godoc.org/github.com/julienschmidt/httprouter#Router.ServeFi&zwnj;&#8203;les</a>?"}, {"owner": {"reputation": 881, "user_id": 926823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/XyiYN.jpg?s=128&g=1", "display_name": "amirhosseinab", "link": "https://stackoverflow.com/users/926823/amirhosseinab"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516389799, "post_id": 48347771, "comment_id": 83682366, "body": "@mkopriva As the documentation said: &quot;Internally a http.FileServer is used, therefore http.NotFound is used instead of the Router&#39;s NotFound handler.&quot;  So it will return <code>404</code> error code in my case."}], "answers": [{"comments": [{"owner": {"reputation": 881, "user_id": 926823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/XyiYN.jpg?s=128&g=1", "display_name": "amirhosseinab", "link": "https://stackoverflow.com/users/926823/amirhosseinab"}, "edited": false, "score": 0, "creation_date": 1516549107, "post_id": 48351114, "comment_id": 83723600, "body": "Thank\u2019s, is there any workaround to do this without using gorilla package?"}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "reply_to_user": {"reputation": 881, "user_id": 926823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/XyiYN.jpg?s=128&g=1", "display_name": "amirhosseinab", "link": "https://stackoverflow.com/users/926823/amirhosseinab"}, "edited": false, "score": 0, "creation_date": 1516576579, "post_id": 48351114, "comment_id": 83732527, "body": "@amirhosseinab which package do you want to use in this case?"}, {"owner": {"reputation": 881, "user_id": 926823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/XyiYN.jpg?s=128&g=1", "display_name": "amirhosseinab", "link": "https://stackoverflow.com/users/926823/amirhosseinab"}, "edited": false, "score": 0, "creation_date": 1516590551, "post_id": 48351114, "comment_id": 83735471, "body": "httprouter or no third party packages, and use net/http package. Is it possible at all?"}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "reply_to_user": {"reputation": 881, "user_id": 926823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/XyiYN.jpg?s=128&g=1", "display_name": "amirhosseinab", "link": "https://stackoverflow.com/users/926823/amirhosseinab"}, "edited": false, "score": 0, "creation_date": 1516782923, "post_id": 48351114, "comment_id": 83825526, "body": "httprouter is a third party library"}, {"owner": {"reputation": 881, "user_id": 926823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/XyiYN.jpg?s=128&g=1", "display_name": "amirhosseinab", "link": "https://stackoverflow.com/users/926823/amirhosseinab"}, "edited": false, "score": 0, "creation_date": 1516785447, "post_id": 48351114, "comment_id": 83827113, "body": "Yes, I know that. I\u2019m ok with that package."}, {"owner": {"reputation": 449, "user_id": 1914351, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3d268c84819e83e2f62b5f9db34cebfb?s=128&d=identicon&r=PG", "display_name": "Jeff Collier", "link": "https://stackoverflow.com/users/1914351/jeff-collier"}, "edited": false, "score": 0, "creation_date": 1550332886, "post_id": 48351114, "comment_id": 96233908, "body": "The missing link that is unique to Vue is solved by this line: r.PathPrefix(&quot;/static&quot;)... Nice help."}], "tags": [], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "is_accepted": false, "score": 7, "last_activity_date": 1516405639, "creation_date": 1516405639, "answer_id": 48351114, "question_id": 48347771, "link": "https://stackoverflow.com/questions/48347771/static-file-server-by-golang-for-serving-vue-js-app/48351114#48351114", "title": "Static file server by Golang for serving Vue.js app", "body": "<p>Assuming a folder structure like below</p>\n\n<p><a href=\"https://i.stack.imgur.com/9rsRs.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/9rsRs.png\" alt=\"enter image description here\"></a></p>\n\n<p>You can use the following golang code to serve the static files. I've added an extra api to show how we could have that as well. <a href=\"https://github.com/gorilla/mux\" rel=\"noreferrer\">gorilla-mux</a> is used for URL routing.</p>\n\n<p>I've taken the built distribution to serve via golang. And <code>index.html</code>looks like this</p>\n\n<pre><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n\n&lt;head&gt;\n  &lt;meta charset=utf-8&gt;\n  &lt;link rel=stylesheet href=static/normalize.css&gt;\n  &lt;title&gt;vue-spa&lt;/title&gt;\n  &lt;link href=./static/css/app.6fde27bf4e24b3395514fd5ee0329156.css rel=stylesheet&gt;\n&lt;/head&gt;\n\n&lt;body&gt;\n  &lt;div id=app&gt;&lt;/div&gt;\n  &lt;script type=text/javascript src=./static/js/manifest.6fd2c38fc83e93a893ff.js&gt;&lt;/script&gt;\n  &lt;script type=text/javascript src=./static/js/vendor.bc5a61acb9e2b4c6e037.js&gt;&lt;/script&gt;\n  &lt;script type=text/javascript src=./static/js/app.c8f0b049292d256d1e93.js&gt;&lt;/script&gt;\n&lt;/body&gt;\n\n&lt;/html&gt;\n</code></pre>\n\n<p>Note that it's base for static files is <code>./static</code></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"net/http\"\n    \"os\"\n    \"time\"\n    \"log\"\n    \"github.com/gorilla/handlers\"\n    \"github.com/gorilla/mux\"\n)\n\nfunc main() {\n    r := mux.NewRouter()\n    // It's important that this is before your catch-all route (\"/\")\n    api := r.PathPrefix(\"/api/\").Subrouter()\n    api.HandleFunc(\"/users\", GetUsersHandler).Methods(\"GET\")\n    // Serve static assets directly.\n    r.PathPrefix(\"/static\").Handler(http.FileServer(http.Dir(\"dist/\")))\n    // Catch-all: Serve our JavaScript application's entry-point (index.html).\n    r.PathPrefix(\"/\").HandlerFunc(IndexHandler(\"dist/index.html\"))\n\n\nsrv := &amp;http.Server{\n        Handler: handlers.LoggingHandler(os.Stdout, r),\n        Addr:    \"127.0.0.1:8088\",\n        WriteTimeout: 15 * time.Second,\n        ReadTimeout:  15 * time.Second,\n    }\n    log.Fatal(srv.ListenAndServe())\n}\n\nfunc IndexHandler(entrypoint string) func(w http.ResponseWriter, r *http.Request) {\n    fn := func(w http.ResponseWriter, r *http.Request) {\n        http.ServeFile(w, r, entrypoint)\n    }\n    return http.HandlerFunc(fn)\n}\n\nfunc GetUsersHandler(w http.ResponseWriter, r *http.Request) {\n    data := map[string]interface{}{\n        \"id\": \"123\",\n        \"timeStamp\": time.Now().Format(time.RFC3339),\n    }\n    b, err := json.Marshal(data)\n    if err != nil {\n        http.Error(w, err.Error(), 400)\n        return\n    }\n    w.Write(b)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 881, "user_id": 926823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/XyiYN.jpg?s=128&g=1", "display_name": "amirhosseinab", "link": "https://stackoverflow.com/users/926823/amirhosseinab"}, "is_accepted": false, "score": 1, "last_activity_date": 1520023180, "last_edit_date": 1520023180, "creation_date": 1516996725, "answer_id": 48468679, "question_id": 48347771, "link": "https://stackoverflow.com/questions/48347771/static-file-server-by-golang-for-serving-vue-js-app/48468679#48468679", "title": "Static file server by Golang for serving Vue.js app", "body": "<p>I wrote this little package that mimics parts of the standard <code>fs.go</code> functionality and use it.</p>\n\n<p><a href=\"https://github.com/amirhosseinab/sfs\" rel=\"nofollow noreferrer\">https://github.com/amirhosseinab/sfs</a></p>\n"}, {"tags": [], "owner": {"reputation": 1388, "user_id": 4566989, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/297ed68785ef48dca20e154033d787f5?s=128&d=identicon&r=PG", "display_name": "leonardo", "link": "https://stackoverflow.com/users/4566989/leonardo"}, "is_accepted": false, "score": 2, "last_activity_date": 1551094857, "last_edit_date": 1551094857, "creation_date": 1542706861, "answer_id": 53390104, "question_id": 48347771, "link": "https://stackoverflow.com/questions/48347771/static-file-server-by-golang-for-serving-vue-js-app/53390104#53390104", "title": "Static file server by Golang for serving Vue.js app", "body": "<p><strong>This is how I serve our Vue.js single page app</strong></p>\n\n<pre><code>router := mux.NewRouter()\n// we have a single page application\n// we need to catch all routes and redirect them to the app's entrypoing (index.html)\nwwwFiles := http.Dir(\"./static/www\")\nwwwPath := \"/\"\nwwwHandler := http.FileServer(wwwFiles)\nwwwRouter := router.PathPrefix(wwwPath).Handler(http.StripPrefix(wwwPath, wwwHandler))\n// define a Matcher host in case you want to use the '/' path to serve other content\n// the regex is for eventual dev/qa/... environments\nwwwRouter.Host(\"www{_:|[a-z]*}.my.app\")\n// redirect all requests starting with '/' to the 'www' path which index.html will catch\nwwwRouter.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n    http.ServeFile(w, r, wwwFiles)\n})\n</code></pre>\n"}], "owner": {"reputation": 881, "user_id": 926823, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/XyiYN.jpg?s=128&g=1", "display_name": "amirhosseinab", "link": "https://stackoverflow.com/users/926823/amirhosseinab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4837, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1551094857, "creation_date": 1516387978, "question_id": 48347771, "link": "https://stackoverflow.com/questions/48347771/static-file-server-by-golang-for-serving-vue-js-app", "title": "Static file server by Golang for serving Vue.js app", "body": "<p>I want to create a simple file server in <code>Go</code> for serving static files of a <code>Vue.js</code> app.</p>\n\n<p>By default <code>Vue.js</code> has its own runner using <code>npm run dev</code> or <code>npm run build</code>.</p>\n\n<p>The point is when I run <code>Vue.js</code> app by its own tooling system, it falls back <code>404 error</code> to <code>index.html</code>. So <code>Vue-router</code> can handle the rest.</p>\n\n<p>How can I handle that in <code>Go</code>?</p>\n\n<p>I tried <code>httprouter</code> and its <code>NotFound</code> method as the documentation mentioned, but it only serves static files if there is no defined route on the <code>Router</code>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516385239, "post_id": 48346994, "comment_id": 83679968, "body": "Resolution is done through the <code>Dial</code> functions, and the <code>Resolver</code> has a <code>Dial</code> field. Can you not get what you want by hooking into that function?"}, {"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1516385445, "post_id": 48346994, "comment_id": 83680081, "body": "No, the <code>Dial</code> function returns the connection that will be used to talk to the DNS server, I want metrics on the DNS operations separately, not on how long it takes to connect to the DNS server."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516385920, "post_id": 48346994, "comment_id": 83680368, "body": "&quot;connect to the DNS server&quot;? Are you always trying to use dns over tcp or https? Still, the <code>Dial</code>/<code>DialContext</code> functions are how pretty much everything hooks into resolution. Can you provide whatever is making calls you want to instrument with a custom Dialer, which could use your own resolver? A lot of projects also use external package when they need more control over dns operation, like <code>https:&#47;&#47;github.com&#47;miekg&#47;dns</code>."}, {"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516386040, "post_id": 48346994, "comment_id": 83680448, "body": "Again, the <code>Dial</code> function at <code>*net.Resolver</code> is used to create a connection to the DNS server. I want to collect metrics on how long methods like <code>*net.Dialer.LookupHost</code> take, hence I need to wrap <code>*net.Dialer</code> in some way."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516386611, "post_id": 48346994, "comment_id": 83680774, "body": "yes, but the entrypoint for almost everything is a <code>Dial</code> or <code>DialContext</code> function, so that&#39;s your hook. Since it&#39;s a function type, you can supply whatever you want there, including a function that uses your resolver for name name resolution. As you&#39;ve seen, <code>*net.Resolver</code> isn&#39;t an interface, so to hook into its internals, you need to use your own Dialer+Resolver implementation entirely."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516387075, "post_id": 48346994, "comment_id": 83681040, "body": "Record start time in <code>Dial</code> and finish time in wrapped <code>Conn.Close</code> will mostly do the job."}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1516410232, "post_id": 48346994, "comment_id": 83689927, "body": "See <a href=\"https://golang.org/issue/12503\" rel=\"nofollow noreferrer\">golang.org/issue/12503</a>"}, {"owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "edited": false, "score": 0, "creation_date": 1516673561, "post_id": 48346994, "comment_id": 83774146, "body": "Yeah, looks like it&#39;s either use miekg/dns or just wait for them to come up with a better solution."}], "owner": {"reputation": 37807, "user_id": 293686, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/1426a9fd5267e73d9e30ebaac1bde144?s=128&d=identicon&r=PG", "display_name": "Maur&#237;cio Linhares", "link": "https://stackoverflow.com/users/293686/maur%c3%adcio-linhares"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 87, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1517779355, "creation_date": 1516384898, "last_edit_date": 1517779355, "question_id": 48346994, "link": "https://stackoverflow.com/questions/48346994/instrument-existing-golang-struct", "title": "Instrument existing golang struct", "body": "<p>Go's standard library has the <code>*net.Resolver</code> type, that is a struct, and I'd like to wrap it in some way because I want to collect metrics on DNS lookups for my application.</p>\n\n<p>I tried wrapping <code>*net.Resolver</code>:</p>\n\n<pre><code>func WrapResolver(resolver *net.Resolver) *net.Resolver {\n    return &amp;instrumentedResolver{\n        Resolver: resolver,\n    }\n}\n\ntype instrumentedResolver struct {\n    *net.Resolver\n}\n</code></pre>\n\n<p>But this doesn't work as <code>*instrumentedResolver</code> is not compatible with <code>*net.Resolver</code>. So, question is, is this possible? If it isn't is there any other way for me to collect these metrics?</p>\n"}, {"tags": ["arrays", "go", "types", "interface", "type-assertion"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 5, "creation_date": 1516381868, "post_id": 48346116, "comment_id": 83678179, "body": "You need to first type assert that the word is actually a string. One, prone-to-panic, way would be <code>s[0] = word.(string)</code>."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1516382129, "post_id": 48346116, "comment_id": 83678320, "body": "... more <a href=\"https://tour.golang.org/methods/15\" rel=\"nofollow noreferrer\">here</a> and <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">here</a>."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 4, "last_activity_date": 1516384701, "creation_date": 1516384701, "answer_id": 48346940, "question_id": 48346116, "link": "https://stackoverflow.com/questions/48346116/cannot-use-word-type-interface-as-type-string-in-assignment-need-type-asse/48346940#48346940", "title": "Cannot use word (type interface {}) as type string in assignment: need type assertion", "body": "<p>The prescribed way to ensure that a value has some type is to use a <a href=\"https://golang.org/ref/spec#Type_assertions\" rel=\"nofollow noreferrer\">type assertion</a>, which has two flavors:</p>\n\n<pre><code>s := x.(string) // panics if \"x\" is not really a string.\ns, ok := x.(string) // the \"ok\" boolean will flag success.\n</code></pre>\n\n<p>Your code should probably do something like this:</p>\n\n<pre><code>str, ok := word.(string)\nif !ok {\n  fmt.Printf(\"ERROR: not a string -&gt; %#v\\n\", word)\n  continue\n}\ns[0] = str\n</code></pre>\n"}], "owner": {"reputation": 497, "user_id": 8032784, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/121caf69992063447bf70cf6688e6a1c?s=128&d=identicon&r=PG", "display_name": "Naji", "link": "https://stackoverflow.com/users/8032784/naji"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3158, "favorite_count": 0, "accepted_answer_id": 48346940, "answer_count": 1, "score": -1, "last_activity_date": 1516384701, "creation_date": 1516381489, "question_id": 48346116, "link": "https://stackoverflow.com/questions/48346116/cannot-use-word-type-interface-as-type-string-in-assignment-need-type-asse", "title": "Cannot use word (type interface {}) as type string in assignment: need type assertion", "body": "<p>I'm new to Go and what i'm doing for some reason doesn't seem very straight-forward to me.</p>\n\n<p>Here is my code:</p>\n\n<pre><code>for _, column := range resp.Values {\n  for _, word := range column {\n\n    s := make([]string, 1)\n    s[0] = word\n    fmt.Print(s, \"\\n\")\n  }\n}\n</code></pre>\n\n<p>and I get the error:</p>\n\n<p><code>Cannot use word (type interface {}) as type string in assignment: need type assertion</code></p>\n\n<p><code>resp.Values</code> is an array of arrays, all of which are populated with strings.</p>\n\n<p><code>reflect.TypeOf(resp.Values)</code> returns <code>[][]interface {}</code>,</p>\n\n<p><code>reflect.TypeOf(resp.Values[0])</code> (which is <code>column</code>) returns <code>[]interface {}</code>, </p>\n\n<p><code>reflect.TypeOf(resp.Values[0][0])</code> (which is <code>word</code>) returns <code>string</code>.</p>\n\n<p>My end goal here is to make each word its own array, so instead of having:</p>\n\n<p><code>[[Hello, Stack], [Overflow, Team]]</code>, I would have:\n<code>[[[Hello], [Stack]], [[Overflow], [Team]]]</code></p>\n"}, {"tags": ["google-app-engine", "go", "http-headers", "google-cloud-platform", "google-app-engine-go"], "answers": [{"comments": [{"owner": {"reputation": 3, "user_id": 8308308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f652e933a0183af8f14cb30b4ea2241c?s=128&d=identicon&r=PG&f=1", "display_name": "J. Wynn", "link": "https://stackoverflow.com/users/8308308/j-wynn"}, "edited": false, "score": 0, "creation_date": 1516489173, "post_id": 48353265, "comment_id": 83710728, "body": "Thanks.  I tried using the x-forwarded-for header originally but that was returning blank as well.  Regardless, this has clarified my question regarding any necessary configuration as it appears there is none additionally required."}], "tags": [], "owner": {"reputation": 16, "user_id": 7768001, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77b00aabb4d8d061096bc7e6d22ae67b?s=128&d=identicon&r=PG", "display_name": "shindakun", "link": "https://stackoverflow.com/users/7768001/shindakun"}, "is_accepted": true, "score": 0, "last_activity_date": 1516429321, "creation_date": 1516429321, "answer_id": 48353265, "question_id": 48345409, "link": "https://stackoverflow.com/questions/48345409/how-do-i-get-output-from-request-remoteaddr-and-x-appengine-country-region-etc/48353265#48353265", "title": "How do I get output from request.RemoteAddr and X-AppEngine-Country, Region, etc. in Google App Engine Standard Env for Go?", "body": "<p>One thing to note is that req.RemoteAddr is going to end up with the IP address of the last proxy in the chain to your app. On App Engine that's probably going to end up being 127.0.0.1. <code>net.SplitHostPort</code> is likely erroring since the IP may not actually have a Port number.</p>\n\n<p>The Region, City, and CityLatLong data are going to come from your IP, if that information is available, it may not be as it's not strictly required. What you can try is to pull the IP address from the X-Forwarded-For header. This will typically give you the full list of proxies and the originating IP address (IPv4 or IPv6, see example results below).</p>\n\n<p>If you were to use:\npackage hello</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net\"\n    \"net/http\"\n)\n\nfunc init() {\n    http.HandleFunc(\"/\", handler)\n}\n\nfunc handler(w http.ResponseWriter, r *http.Request) {\n    clientIPAddress, _, err := net.SplitHostPort(r.RemoteAddr)\n    if err != nil {\n        clientIPAddress = err.Error()\n    }\n    rAddr := r.RemoteAddr\n    forward := r.Header.Get(\"x-forwarded-for\")\n    country := r.Header.Get(\"X-AppEngineCountry\")\n    region := r.Header.Get(\"X-AppEngine-Region\")\n    city := r.Header.Get(\"X-AppEngine-City\")\n    cityLatLong := r.Header.Get(\"X-AppEngine-CityLatLong\")\n    fullHeader := r.Header\n    fmt.Fprintf(w, \"Hello, world!\\n %v\\n %v\\n %v\\n %v\\n %v\\n %v\\n %v\\n %v\",\n        clientIPAddress,\n        rAddr,\n        forward,\n        country,\n        region,\n        city,\n        cityLatLong,\n        fullHeader\n    )\n}\n</code></pre>\n\n<p>You should see something similar to (as long as Region City, CityLatLong are avaliable otherwise those will be blank):</p>\n\n<pre><code>Hello, world!\n missing port in address 127.0.0.1\n 127.0.0.1\n 2601:1c2:600:17b0::::, 2607:f8b0:400a:::2014\n ZZ\n or\n portland\n 45.523452,-122.676207\n map[Accept-Encoding:[identity] X-Appengine-Default-Version-Hostname:\n[127.0.0.1:8080] X-Appengine-User-Organization:[] X-Appengine-Citylatlong:\n[45.523452,-122.676207] X-Appengine-Request-Log-Id:\n[48f03baada92bbb3872a8b3a5baa3f8b0dfff413f64fbcfa] X-\nAppengine-City:[portland] X-Forwarded-Proto:[https] X-Appengine-Server-Name:\n[127.0.0.1] Via:[1.1 google] X-Appengine-Server-Software:[Development/2.0] \nX-Appengine-User-Id:[] X-Forwarded-For:\n[2601:1c2:600:17b0:::: 2607:f8b0:400a:::2014] X-Goog-\nCloud-Shell-Target-Host:[127.0.0.1] X-Appengine-Country:[ZZ] Accept:\netc\netc\n</code></pre>\n\n<p>Hope that helps.</p>\n"}], "owner": {"reputation": 3, "user_id": 8308308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f652e933a0183af8f14cb30b4ea2241c?s=128&d=identicon&r=PG&f=1", "display_name": "J. Wynn", "link": "https://stackoverflow.com/users/8308308/j-wynn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 801, "favorite_count": 0, "accepted_answer_id": 48353265, "answer_count": 1, "score": 0, "last_activity_date": 1516429321, "creation_date": 1516378967, "question_id": 48345409, "link": "https://stackoverflow.com/questions/48345409/how-do-i-get-output-from-request-remoteaddr-and-x-appengine-country-region-etc", "title": "How do I get output from request.RemoteAddr and X-AppEngine-Country, Region, etc. in Google App Engine Standard Env for Go?", "body": "<p>I have a service running in the Google App Engine Standard Environment written in Go that is configured to use the latest runtime at deployment (api_version: go1 - which is currently Go 1.8).</p>\n\n<p>In this service I inspect the request headers for various purposes.  </p>\n\n<pre><code>func extractHeaders(res http.ResponseWriter, req *http.Request) {\n    ctx := appengine.NewContext(req)\n    clientIPAddress, _, _ := net.SplitHostPort(req.RemoteAddr) // Output is blank\n    country := req.Header.Get(\"X-AppEngine-Country\") // Output: US\n    region := req.Header.Get(\"X-AppEngine-Region\") // Output: ?\n    city := req.Header.Get(\"X-AppEngine-City\") // Output: ?\n    cityLatLong := req.Header.Get(\"X-AppEngine-CityLatLong\") // Output 0.000000,0.000000\n    ...\n}\n</code></pre>\n\n<p>As seen in the inline comment for the lines beginning where I read the RemoteAddr field, I am not getting the output I expected per the AppEngine Standard documentation found <a href=\"https://cloud.google.com/appengine/docs/standard/go/how-requests-are-handled\" rel=\"nofollow noreferrer\">here</a> (How Requests are Handled | App Engine standard environment for Go | Google Cloud Platform).</p>\n\n<p>While the documentation states the that X-AppEngine-* may not always be able to be filled in based on the IP address of the client request, I am never seeing them filled in with data other than that which I listed.</p>\n\n<p>Is there any configuration required to get these headers (and the RemoteAddr field) populated in the App Engine Standard Environment for Go?  Am I simply misunderstanding the documentation?</p>\n"}, {"tags": ["go", "apache-kafka", "sarama"], "comments": [{"owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "edited": false, "score": 0, "creation_date": 1516384608, "post_id": 48345326, "comment_id": 83679672, "body": "Are you able to connect with TLS turned off?  That is the first thing I would try."}], "answers": [{"comments": [{"owner": {"reputation": 1227, "user_id": 418772, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/812e307892de3240c2b50a3e66295f84?s=128&d=identicon&r=PG", "display_name": "Rob", "link": "https://stackoverflow.com/users/418772/rob"}, "edited": false, "score": 2, "creation_date": 1567644830, "post_id": 48349712, "comment_id": 102027261, "body": "InsecureSkipVerify doesn&#39;t disable the hostname check.  It literally does not check the certificate at all.  Generally, you need to set tls.Config.ServerName to match the CN expected in the server cert you are connected to.  This inane advice to disable cert checks is a widespread vulnerability in Go code that uses TLS.  InsecureSkipVerify only has a few legitimate uses where the cert is actually validated with custom algorithm, or if this is only used to grab the server cert and disconnect immediately; generally to learn the CN in the server."}], "tags": [], "owner": {"reputation": 524, "user_id": 4695952, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ddbb13b83fa0193327392265d2b94963?s=128&d=identicon&r=PG&f=1", "display_name": "Dikshant Adhikari", "link": "https://stackoverflow.com/users/4695952/dikshant-adhikari"}, "is_accepted": true, "score": 1, "last_activity_date": 1516396853, "creation_date": 1516396853, "answer_id": 48349712, "question_id": 48345326, "link": "https://stackoverflow.com/questions/48345326/sarama-cannot-talk-to-the-kafka-server/48349712#48349712", "title": "Sarama cannot talk to the Kafka server", "body": "<p>So I found my issue. Turns out the subdomain for the kafka deployment had a self signed cert so I had to set <code>InsecureSkipVerify: true</code> in the config.Net.Tls.Config struct for the client. So the code looks like:</p>\n\n<pre><code> config.Net.TLS.Config = &amp;tls.Config{\n    Certificates: []tls.Certificate{crt},\n    InsecureSkipVerify: true,\n}\n</code></pre>\n\n<p>There is no need to include the cipher-suite as well.</p>\n"}], "owner": {"reputation": 524, "user_id": 4695952, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/ddbb13b83fa0193327392265d2b94963?s=128&d=identicon&r=PG&f=1", "display_name": "Dikshant Adhikari", "link": "https://stackoverflow.com/users/4695952/dikshant-adhikari"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2020, "favorite_count": 0, "accepted_answer_id": 48349712, "answer_count": 1, "score": 3, "last_activity_date": 1519707318, "creation_date": 1516378691, "last_edit_date": 1519707318, "question_id": 48345326, "link": "https://stackoverflow.com/questions/48345326/sarama-cannot-talk-to-the-kafka-server", "title": "Sarama cannot talk to the Kafka server", "body": "<p>So I am trying to configure a Sarama (a native go client for kafka) producer client. I have configured my TLS accordingly making sure the client certs were generated using proper ciphers. My Go code to init the client looks like this:</p>\n\n<pre><code>import (\n    \"crypto/tls\"\n    \"crypto/x509\"\n    \"encoding/pem\"\n    \"io/ioutil\"\n    \"net\"\n    \"path/filepath\"\n\n    \"github.com/Shopify/sarama\"\n    log \"github.com/sirupsen/logrus\"\n)\n\nconst (\n    certFile = \"client_ingestion_client.pem\"\n    keyFile  = \"client_ingestion_client.key\"\n)\n\nfunc InitKafkaClient(host string, port string, certPath string) (sarama.AsyncProducer, error) {\n\n    cf := filepath.Join(certPath, certFile)\n    kf := filepath.Join(certPath, keyFile)\n\n    // Log cert and key path\n    log.Debugln(cf)\n    log.Debugln(kf)\n\n    // Read the cert in\n    certIn, err := ioutil.ReadFile(cf)\n\n    if err != nil {\n        log.Error(\"cannot read cert\", err)\n        return nil, err\n    }\n\n    // Read &amp; decode the encrypted key file with the pass to make tls work\n    keyIn, err := ioutil.ReadFile(kf)\n    if err != nil {\n        log.Error(\"cannot read key\", err)\n        return nil, err\n    }\n\n    // Decode and decrypt our PEM block as DER\n    decodedPEM, _ := pem.Decode([]byte(keyIn))\n    decrypedPemBlock, err := x509.DecryptPEMBlock(decodedPEM, []byte(\"m4d3ups3curity4k4fka?\"))\n    if err != nil {\n        log.Error(\"cannot decrypt pem block\", err)\n        return nil, err\n    }\n\n    // Parse the DER encoded block as PEM\n    rsaKey, err := x509.ParsePKCS1ParrivateKey(decrypedPemBlock)\n    if err != nil {\n       log.Error(\"failed to parse rsa as pem\", err)\n       return nil, err\n    }\n\n    // Marshal the pem encoded RSA key to bytes in memory\n    pemdata := pem.EncodeToMemory(\n       &amp;pem.Block{\n            Type:  \"RSA PRIVATE KEY\",\n            Bytes: x509.MarshalPKCS1PrivateKey(rsaKey),\n        },\n    )\n    if err != nil {\n        log.Error(\"cannot marshal rsa as pem in memory\", err)\n        return nil, err\n    }\n\n    // Load our decrypted key pair\n    crt, err := tls.X509KeyPair(certIn, pemdata)\n    if err != nil {\n        log.Error(\"cannot load key pair\", err)\n        return nil, err\n    }\n    config := sarama.NewConfig()\n    config.Net.TLS.Enable = true\n    config.Net.TLS.Config = &amp;tls.Config{\n        Certificates: []tls.Certificate{crt},\n        CipherSuites: []uint16{\n           tls.TLS_RSA_WITH_AES_128_GCM_SHA256,\n        },\n    }\n\n    // Setting this allows us not to read from successes channel\n    config.Producer.Return.Successes = false\n    // Setting this allows us not to read from errors channel\n    config.Producer.Return.Errors = false\n    client, err := sarama.NewClient([]string{net.JoinHostPort(host, port)}, config)\n    if err != nil {\n        return nil, err\n    }\n    return sarama.NewAsyncProducerFromClient(client)\n}\n</code></pre>\n\n<p>When I initialize the code I get an error saying:</p>\n\n<p><code>time=\"2018-01-19T15:31:38Z\" level=error msg=\"Error trying to setup kafka: kafka: client has run out of available brokers to talk to (Is your cluster reachable?)\"</code></p>\n\n<p>I have verified that the Kafka host is reachable and can be connected to. See below.</p>\n\n<p>I verified that the key gets decrypted correctly by checking the output from the go code to the output generated from the <code>openssl rsa -in client_ingestion_client.key -out decrypted.key</code> command. I also made sure that the key was generated properly using keytool with the correct flags including -keylag RSA flag as suggested in <a href=\"https://github.com/Shopify/sarama/wiki/Frequently-Asked-Questions#why-cant-sarama-connect-to-my-kafka-cluster-using-ssl\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>I also ran <code>openssl s_client -connect $KAFKA_HOST:$KAFKA_PORT</code> and got the following response</p>\n\n<pre><code>verify error:num=19:self signed certificate in certificate chain\n139901934057376:error:1408E0F4:SSL routines:ssl3_get_message:unexpected message:s3_both.c:408:\n</code></pre>\n\n<p>The verify error is fine since I am using a self signed cert but I don't know what the error that follows is about. Maybe thats the cause of my problem?</p>\n\n<p>Further I get the following information:</p>\n\n<pre><code>Requested Signature Algorithms: ECDSA+SHA512:RSA+SHA512:ECDSA+SHA384:RSA+SHA384:ECDSA+SHA256:RSA+SHA256:DSA+SHA256:ECDSA+SHA224:RSA+SHA224:DSA+SHA224:ECDSA+SHA1:RSA+SHA1:DSA+SHA1\nShared Requested Signature Algorithms: ECDSA+SHA512:RSA+SHA512:ECDSA+SHA384:RSA+SHA384:ECDSA+SHA256:RSA+SHA256:DSA+SHA256:ECDSA+SHA224:RSA+SHA224:DSA+SHA224:ECDSA+SHA1:RSA+SHA1:DSA+SHA1\n    Peer signing digest: SHA512\n    Server Temp Key: ECDH, P-256, 256 bits\n    ---\n    SSL handshake has read 4668 bytes and written 169 bytes\n    ---\n    New, TLSv1/SSLv3, Cipher is ECDHE-RSA-AES128-GCM-SHA256\n    Server public key is 2048 bit\n    Secure Renegotiation IS supported\n    Compression: NONE\n    Expansion: NONE\n    No ALPN negotiated\n    SSL-Session:\n        Protocol  : TLSv1.2\n        Cipher    : ECDHE-RSA-AES128-GCM-SHA256\n        Session-ID: 5A6216C765EF33BC85FACE82B01BC506358F4D62C77817A1F7EEFB50941DAEC9\n        Session-ID-ctx:\n        Master-Key: F8641FBF63A0AC7AB2D6D941C421DCA44550448524DADF4F0A7943F7928E65D5773E60A45212A7F320B250595AA6737B\n        Key-Arg   : None\n        Krb5 Principal: None\n        PSK identity: None\n        PSK identity hint: None\n        Start Time: 1516377799\n        Timeout   : 300 (sec)\n        Verify return code: 19 (self signed certificate in certificate chain)\n    ---  \n</code></pre>\n\n<p>Since this cipher is referenced in the openssl conenction:</p>\n\n<p><code>ECDHE-RSA-AES128-GCM-SHA256</code></p>\n\n<p>I tried adding this <code>tls.TLS_RSA_WITH_AES_128_GCM_SHA256</code> to my go code which seemed like a close match but I get the same error message in go with it saying that it has run out of available brokers to talk to.</p>\n"}, {"tags": ["debugging", "go", "gdb"], "comments": [{"owner": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "edited": false, "score": 0, "creation_date": 1516378001, "post_id": 48345045, "comment_id": 83675802, "body": "Just out of curiosity, what happens when you try <code>print w.data</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1516378015, "post_id": 48345045, "comment_id": 83675808, "body": "That is what is inside the variable <code>w</code>. GDB requires some low level knowledge of Go, and can&#39;t handle all parts of the runtime. I would start with <a href=\"https://github.com/derekparker/delve/\" rel=\"nofollow noreferrer\">delve</a> rather than gdb."}, {"owner": {"reputation": 11, "user_id": 9237997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09216d41c7ae6fa3010063080d9df639?s=128&d=identicon&r=PG&f=1", "display_name": "Ronacaodo", "link": "https://stackoverflow.com/users/9237997/ronacaodo"}, "reply_to_user": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "edited": false, "score": 0, "creation_date": 1516379726, "post_id": 48345045, "comment_id": 83676867, "body": "@Gab print w.data is also displaying an address.It seems like can\u2019t check what insider is."}, {"owner": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "edited": false, "score": 0, "creation_date": 1516379795, "post_id": 48345045, "comment_id": 83676906, "body": "can you try <code>print *(w.data)</code>? I have only used gdb for C, so i&#39;m just trying to see if that works"}, {"owner": {"reputation": 11, "user_id": 9237997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09216d41c7ae6fa3010063080d9df639?s=128&d=identicon&r=PG&f=1", "display_name": "Ronacaodo", "link": "https://stackoverflow.com/users/9237997/ronacaodo"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516380188, "post_id": 48345045, "comment_id": 83677154, "body": "@JimB Thanks.Could delve achieve my requirement?"}, {"owner": {"reputation": 11, "user_id": 9237997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09216d41c7ae6fa3010063080d9df639?s=128&d=identicon&r=PG&f=1", "display_name": "Ronacaodo", "link": "https://stackoverflow.com/users/9237997/ronacaodo"}, "reply_to_user": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "edited": false, "score": 0, "creation_date": 1516381276, "post_id": 48345045, "comment_id": 83677872, "body": "@Gab It doesn\u2019t work and hit \u201cAttempt to dereference a generic pointer\u201d,but print *(w.tab) goes well.So messy.How do you check a complex object(or variable or struct) when debugging by GDB?"}, {"owner": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "edited": false, "score": 0, "creation_date": 1516381538, "post_id": 48345045, "comment_id": 83678021, "body": "When it comes to C, you access the data the same way you would in your program. So if you have <code>char *sentence</code>, you could access the first letter like this: <code>print *sentence</code> or <code>print sentence[0]</code>. I would imagine that the same applies to Go (but obviously not using Go syntax)"}, {"owner": {"reputation": 11, "user_id": 9237997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09216d41c7ae6fa3010063080d9df639?s=128&d=identicon&r=PG&f=1", "display_name": "Ronacaodo", "link": "https://stackoverflow.com/users/9237997/ronacaodo"}, "reply_to_user": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "edited": false, "score": 0, "creation_date": 1516381950, "post_id": 48345045, "comment_id": 83678225, "body": "@Gab Thanks, it seems not so convenient for some multilevel-complex object \ud83d\ude2d\ud83d\ude2d\ud83d\ude2d"}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1516397586, "post_id": 48345045, "comment_id": 83686092, "body": "http.ResponseWriter is an interface. What concrete type did you use for it in this particular call?"}, {"owner": {"reputation": 11, "user_id": 9237997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09216d41c7ae6fa3010063080d9df639?s=128&d=identicon&r=PG&f=1", "display_name": "Ronacaodo", "link": "https://stackoverflow.com/users/9237997/ronacaodo"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1516410834, "post_id": 48345045, "comment_id": 83690012, "body": "@MarkPlotnick Of cause it\u2019s an interface.And w is a variable which implemented this interface,I\u2019d like to check inner of w .In java, when debugging, I can check a variable in detail even I didn\u2019t know the struct of this variable."}, {"owner": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1516441770, "post_id": 48345045, "comment_id": 83695873, "body": "I asked what concrete type is used so that I can check whether <code>{tab = 0x81c2e0, data = 0x11156990}</code> is the correct struct or not."}, {"owner": {"reputation": 11, "user_id": 9237997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09216d41c7ae6fa3010063080d9df639?s=128&d=identicon&r=PG&f=1", "display_name": "Ronacaodo", "link": "https://stackoverflow.com/users/9237997/ronacaodo"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1516445139, "post_id": 48345045, "comment_id": 83696842, "body": "@Mark Plotnick Using command &#39;whatis w&#39; could get this &#39;type = net/http.ResponseWriter&#39;"}, {"owner": {"reputation": 11, "user_id": 9237997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09216d41c7ae6fa3010063080d9df639?s=128&d=identicon&r=PG&f=1", "display_name": "Ronacaodo", "link": "https://stackoverflow.com/users/9237997/ronacaodo"}, "reply_to_user": {"reputation": 7668, "user_id": 2554472, "user_type": "registered", "profile_image": "https://graph.facebook.com/1119155584/picture?type=large", "display_name": "Mark Plotnick", "link": "https://stackoverflow.com/users/2554472/mark-plotnick"}, "edited": false, "score": 0, "creation_date": 1516453784, "post_id": 48345045, "comment_id": 83699526, "body": "@MarkPlotnick I\u2019m using delve,it is working well."}], "owner": {"reputation": 11, "user_id": 9237997, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/09216d41c7ae6fa3010063080d9df639?s=128&d=identicon&r=PG&f=1", "display_name": "Ronacaodo", "link": "https://stackoverflow.com/users/9237997/ronacaodo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 65, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1516378190, "creation_date": 1516377782, "last_edit_date": 1516378190, "question_id": 48345045, "link": "https://stackoverflow.com/questions/48345045/confusion-about-go-debug-by-gdb", "title": "Confusion about Go debug by GDB", "body": "<p>I'm a java programer and I'm learning Go. Now I can use GDB simply and I have a doubt, when I debugging a Go program ,I can't check an object(or variable) what it exactly is.\ne.g. when I debug a java program,I can check everything in an object(or variable).</p>\n\n<pre><code>    public void catTest() {\n      Cat cat1=new Cat(\"Kitty\", 2, \"white\");\n      /*AnyThing*/\n      cat1.jump();\n    }\n</code></pre>\n\n<p>When I debug this java method using eclipse-debug mode,what in cat1 are obviously in the whole process. \n<a href=\"https://i.stack.imgur.com/QxZB6.png\" rel=\"nofollow noreferrer\">Details of Variable cat1</a></p>\n\n<p>When I debug a go program,I try to check variable w by using command <code>print w</code> or <code>info args</code>.</p>\n\n<pre><code>    func sayhelloName(w http.ResponseWriter, r *http.Request) {\n    r.ParseForm()    \n    fmt.Println(r.Form)  \n    fmt.Println(\"path\", r.URL.Path)    \n    fmt.Println(\"scheme\", r.URL.Scheme)    \n    fmt.Println(r.Form[\"url_long\"])    \n    for k, v := range r.Form {\n        fmt.Println(\"key:\", k)        \n        fmt.Println(\"val:\", strings.Join(v, \"\"))    \n    }    \n    fmt.Fprintf(w, \"Hello astaxie!\")\n}  \n</code></pre>\n\n<p>I can just get this but not what inside about variable w.</p>\n\n<pre><code>$2 = {tab = 0x81c2e0, data = 0x11156990}\n</code></pre>\n"}, {"tags": ["function", "go"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 5, "creation_date": 1516375358, "post_id": 48344262, "comment_id": 83674196, "body": "Please take the <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">go tour</a>."}, {"owner": {"reputation": 907, "user_id": 4561908, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5b818103f77149ade01b9c9b0f49a6d?s=128&d=identicon&r=PG&f=1", "display_name": "Gab", "link": "https://stackoverflow.com/users/4561908/gab"}, "edited": false, "score": 0, "creation_date": 1516375426, "post_id": 48344262, "comment_id": 83674233, "body": "Just wanna say, I&#39;ve never used Golang but this feature looks pretty cool"}, {"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516375611, "post_id": 48344262, "comment_id": 83674362, "body": "<code>Equal</code> is a method on <code>T</code>. Please take the tour (the whole thing), but specifically <a href=\"https://tour.golang.org/methods/1\" rel=\"nofollow noreferrer\">tour.golang.org/methods/1</a>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1516376737, "post_id": 48344262, "comment_id": 83675032, "body": "your question is too wide. For your question on methods see method with receiver <a href=\"https://tour.golang.org/methods/3\" rel=\"nofollow noreferrer\">tour.golang.org/methods/3</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 5357085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f3932b2d28ceaf80ca02372647b1b5?s=128&d=identicon&r=PG&f=1", "display_name": "heretolearn", "link": "https://stackoverflow.com/users/5357085/heretolearn"}, "edited": false, "score": 0, "creation_date": 1516379890, "post_id": 48345289, "comment_id": 83676958, "body": "Is the purpose of the receiver to allow a method to take on multiple variables of the same type? I see so it reduces typing.  We can now input just a &#39;receiver&#39;  rather than inputting many arguments."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "reply_to_user": {"reputation": 1, "user_id": 5357085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f3932b2d28ceaf80ca02372647b1b5?s=128&d=identicon&r=PG&f=1", "display_name": "heretolearn", "link": "https://stackoverflow.com/users/5357085/heretolearn"}, "edited": false, "score": 1, "creation_date": 1516380302, "post_id": 48345289, "comment_id": 83677216, "body": "@heretolearn No, its purpose is not to allow a method to take on multiple variable of the same type. Why having methods to a type is a very wide and interesting question. However, it requires you to understand what methods and receiver is. Really, please take the go tour or other turtorials towards programing and go."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1516380303, "post_id": 48345289, "comment_id": 83677217, "body": "No, the purpose of the receiver is that you can define a set of methods on a particular type with which then, among other things, you can implement interfaces."}, {"owner": {"reputation": 1, "user_id": 5357085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f3932b2d28ceaf80ca02372647b1b5?s=128&d=identicon&r=PG&f=1", "display_name": "heretolearn", "link": "https://stackoverflow.com/users/5357085/heretolearn"}, "edited": false, "score": 0, "creation_date": 1516380476, "post_id": 48345289, "comment_id": 83677326, "body": "So the purpose of the receiver is to restrict methods from only taking on a particular type"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 1, "creation_date": 1516380620, "post_id": 48345289, "comment_id": 83677411, "body": "No, the purpose of the receiver is to restrict what type the methods is of. In this example, the <code>Equal</code> is <code>T</code>&#39;s method and other type, let&#39;s say <code>float64</code>, can&#39;t use it."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "reply_to_user": {"reputation": 1, "user_id": 5357085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f3932b2d28ceaf80ca02372647b1b5?s=128&d=identicon&r=PG&f=1", "display_name": "heretolearn", "link": "https://stackoverflow.com/users/5357085/heretolearn"}, "edited": false, "score": 0, "creation_date": 1516380644, "post_id": 48345289, "comment_id": 83677420, "body": "@heretolearn No, I don&#39;t think that that&#39;s what I said."}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": false, "score": 2, "last_activity_date": 1516378572, "creation_date": 1516378572, "answer_id": 48345289, "question_id": 48344262, "link": "https://stackoverflow.com/questions/48344262/whats-going-on-in-this-function/48345289#48345289", "title": "Whats going on in this function?", "body": "<p>That's a <a href=\"https://golang.org/ref/spec#Method_declarations\" rel=\"nofollow noreferrer\">method declaration</a>, and since methods in Go are just functions with a <em>receiver</em> they are declared using the keyword <code>func</code>.</p>\n\n<pre><code>func (t T) Equal (u T) bool {return t==u}\n1     2 3  4      5 6  7     8\n</code></pre>\n\n<ol>\n<li>the keyword used to declare functions and methods.</li>\n<li>the method receiver's identifier, using this you can access the receiver inside the body of the method.</li>\n<li>the method receiver's type.</li>\n<li>the name of the method.</li>\n<li>the name of the method's argument, using this you can access the argument inside the body of the method.</li>\n<li>the type of the method's argument.</li>\n<li>the return type of the method argument.</li>\n<li>the body of the method.</li>\n</ol>\n\n<hr>\n\n<p>For comparison, a function that does the same thing would be declared as such:</p>\n\n<pre><code>func Equal (t T, u T) bool {return t==u}\n</code></pre>\n\n<p>(no reciever, but takes two arguments)</p>\n"}], "owner": {"reputation": 1, "user_id": 5357085, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c0f3932b2d28ceaf80ca02372647b1b5?s=128&d=identicon&r=PG&f=1", "display_name": "heretolearn", "link": "https://stackoverflow.com/users/5357085/heretolearn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "closed_date": 1516398914, "answer_count": 1, "score": -5, "last_activity_date": 1516378572, "creation_date": 1516375181, "question_id": 48344262, "link": "https://stackoverflow.com/questions/48344262/whats-going-on-in-this-function", "closed_reason": "Needs more focus", "title": "Whats going on in this function?", "body": "<p>I am failing to understand whats happening with Equal (u T) bool.  Is it a method within a function?    Also what is the difference of a method and a function.  I understand that this function is taking in t of type T and return true or false if t=u. </p>\n\n<pre><code> type T int \n func (t T) Equal (u T) bool {return t==u}\n</code></pre>\n"}, {"tags": ["postgresql", "go", "sqlx"], "answers": [{"tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 1, "last_activity_date": 1516369799, "creation_date": 1516369799, "answer_id": 48342598, "question_id": 48342063, "link": "https://stackoverflow.com/questions/48342063/store-recursive-go-structs-in-postgresql-database/48342598#48342598", "title": "Store recursive go structs in Postgresql database", "body": "<p><strong><em>NOTE:</strong> This is not a real answer, just a longer comment on the SQL part of the question. Unfortunately I have no experience with sqlx so I cannot help you with that.</em></p>\n\n<hr>\n\n<p>What you have there seems to be a many-to-many relationship. A Person can belong to multiple Tenants and a Tenant can have multiple Persons.</p>\n\n<p>In SQL this is usually handled by, what's sometimes called, a linking or junction table.</p>\n\n<pre><code>-- postgresql flavor of SQL\n\nCREATE TABLE IF NOT EXISTS person (\n    id serial PRIMARY KEY,\n    username text NOT NULL\n);\n\nCREATE TABLE IF NOT EXISTS tenant (\n    id serial PRIMARY KEY,\n    name text NOT NULL\n);\n\n-- the linking table\nCREATE TABLE IF NOT EXISTS person_tenant (\n    person_id integer NOT NULL REFERENCES person (id),\n    tenant_id integer NOT NULL REFERENCES tenant (id),\n    PRIMARY KEY(person_id, tenant_id)\n);\n</code></pre>\n"}], "owner": {"reputation": 245, "user_id": 7360695, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5ba260c91ea10f26485623058a28e4fc?s=128&d=identicon&r=PG&f=1", "display_name": "Battalgazi", "link": "https://stackoverflow.com/users/7360695/battalgazi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 244, "favorite_count": 0, "accepted_answer_id": 48342598, "answer_count": 1, "score": 0, "last_activity_date": 1516369799, "creation_date": 1516367971, "last_edit_date": 1516368414, "question_id": 48342063, "link": "https://stackoverflow.com/questions/48342063/store-recursive-go-structs-in-postgresql-database", "title": "Store recursive go structs in Postgresql database", "body": "<p>I have two structs (Person and Tenant) that reference each other recursively.</p>\n\n<p>I have no experience with 'SQL' and Im trying to use the <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">https://github.com/jmoiron/sqlx</a> library to store these structs in a way that they keep referencing each other, so that I can retrieve them again as structs.</p>\n\n<p>I don't know which type should the tables be created with or how I am supposed to insert the objects to get it work.</p>\n\n<p>Also If there is any other go library that can handle this case easily i'm open to any suggestions.</p>\n\n<p>Thanks in advance.</p>\n\n<pre><code>type Tenant struct {\n    Id     int      `db:\"id\"`\n    Name   string   `db:\"name\"`\n    Person []Person `db:\"person\"`\n}\ntype Person struct {\n    Id       int       `db:\"id\"`\n    Username string    `db:\"username\"`\n    Tenants  *[]Tenant `db:\"tenants\"`\n}\nfunc main() {\n\n    var schema = `\n                       CREATE TABLE IF NOT EXISTS person (\n                           id int,\n                           username text\n                           tenants []text //-&gt; type????\n                       );\n\n                       CREATE TABLE IF NOT EXISTS tenant (\n                           id int,\n                           name text,\n                           person []text //-&gt; type????\n                       )`\n\n    psqlInfo := fmt.Sprintf(\"host=%s port=%d user=%s \"+\n        \"password=%s dbname=%s sslmode=%s\",\n        host, port, user, password, dbname, sslmode)\n\n    db, err := sqlx.Open(\"postgres\", psqlInfo)\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    defer db.Close()\n\n    err = db.Ping()\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(\"Successfully connected!\")\n\n    db.MustExec(schema)\n\n    var tenant1 Tenant\n    var person1 Person\n    tenant1 = Tenant{1, \"newtenant\", []Person{person1}}\n    person1 = Person{1, \"newuser\", &amp;[]Tenant{tenant1}}\n\n    tx := db.MustBegin()\n\n    tx.NamedExec(\"INSERT INTO tenant (id,name,person) VALUES (:id,:name, :person)\", &amp;tenant1)\n    tx.Commit()\n    out := []Tenant{}\n    db.Select(&amp;out, \"SELECT * FROM tenant ORDER BY name ASC\")\n\n    fmt.Println(out)\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "edited": false, "score": 0, "creation_date": 1516370670, "post_id": 48340687, "comment_id": 83670956, "body": "Done, and adjusted my answer based on your updated question."}], "answers": [{"comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1516367747, "post_id": 48340978, "comment_id": 83669150, "body": "That was exactly I am asking only thing is that I wants to extract the underlying value of interface which I did using type assertion"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1516383633, "post_id": 48340978, "comment_id": 83679141, "body": "stackoverflow has banned me from asking questions how to lift that ban"}, {"owner": {"reputation": 5446, "user_id": 4687348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8de53eca1206063d96d2c309b362fc8b?s=128&d=identicon&r=PG&f=1", "display_name": "FelixSFD", "link": "https://stackoverflow.com/users/4687348/felixsfd"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1516383774, "post_id": 48340978, "comment_id": 83679222, "body": "@Himanshu <a href=\"https://meta.stackexchange.com/questions/86997/what-can-i-do-when-getting-we-are-no-longer-accepting-questions-answers-from-th\">What can I do when getting \u201cWe are no longer accepting questions/answers from this account\u201d?</a>"}], "tags": [], "owner": {"reputation": 14194, "user_id": 4966953, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dl696.png?s=128&g=1", "display_name": "Marc", "link": "https://stackoverflow.com/users/4966953/marc"}, "is_accepted": true, "score": 3, "last_activity_date": 1516370619, "last_edit_date": 1516370619, "creation_date": 1516364397, "answer_id": 48340978, "question_id": 48340687, "link": "https://stackoverflow.com/questions/48340687/golang-assign-a-map-to-an-interface/48340978#48340978", "title": "Golang assign a map to an interface", "body": "<p>To be able to treat an interface as a map, you need to type check it as a map first.</p>\n\n<p>I've modified your sample code a bit to make it clearer, with inline comments explaining what it does:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    // Data struct containing an interface field.\n    type Data struct {\n        internal interface{}\n    }\n\n    // Assign a map to the field.\n    type myMap map[string]interface{}\n    data := Data{\n        internal: make(myMap),\n    }\n\n    // Now, we want to access the field again, but as a map:\n    // check that it matches the type we want.\n    internalMap, ok := data.internal.(myMap)\n    if !ok {\n        panic(\"data.internal is not a map\")\n    }\n\n    // Now what we have the correct type, we can treat it as a map.\n    internalMap[\"CreatedFor\"] = \"dfasfasdf\"\n    internalMap[\"OwnedBy\"] = \"fasfsad\"\n\n    // Print the overall struct.\n    fmt.Println(data)\n}\n</code></pre>\n\n<p>This outputs:</p>\n\n<pre><code>{map[CreatedFor:dfasfasdf OwnedBy:fasfsad]}\n</code></pre>\n"}], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3848, "favorite_count": 1, "accepted_answer_id": 48340978, "answer_count": 1, "score": 1, "last_activity_date": 1516370619, "creation_date": 1516363350, "last_edit_date": 1516368005, "question_id": 48340687, "link": "https://stackoverflow.com/questions/48340687/golang-assign-a-map-to-an-interface", "title": "Golang assign a map to an interface", "body": "<p>I wants to assign a map to an interface where underlying value is of type <code>map[string]interface</code>. </p>\n\n<pre><code>type Data struct{\n  data interface{}\n}\n\nresult := make(map[string]interface{})\ndata := Data{\n   data:result\n}\n\ndetails := make(map[string]interface{})\ndetails[\"CreatedFor\"] = \"dfasfasdf\"\ndetails[\"OwnedBy\"] = \"fasfsad\"\n</code></pre>\n\n<p>How can I insert details value to <code>data</code> interface inside <code>Data</code> struct ?</p>\n"}, {"tags": ["go", "cron"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1516359478, "post_id": 48339485, "comment_id": 83664139, "body": "You can&#39;t refer to functions given by their names. Possible duplicate of <a href=\"https://stackoverflow.com/questions/37384473/call-all-functions-with-special-prefix-or-suffix-in-golang/37384665#37384665\">Call all functions with special prefix or suffix in Golang</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1283, "user_id": 9079863, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8e9c7362282ac6c2b944cb216fa2ab4c?s=128&d=identicon&r=PG&f=1", "display_name": "Ilayaraja", "link": "https://stackoverflow.com/users/9079863/ilayaraja"}, "is_accepted": true, "score": 0, "last_activity_date": 1516369492, "creation_date": 1516369492, "answer_id": 48342527, "question_id": 48339485, "link": "https://stackoverflow.com/questions/48339485/how-to-add-function-to-cron-using-go-reflect/48342527#48342527", "title": "How to add function to cron using Go reflect?", "body": "<p>Cannot cast <code>string</code> to <code>func()</code> type. Instead use <code>switch</code> or <code>map</code> to find the actual function.</p>\n\n<pre><code>for k, v := range masterJobDetails {\n    var jobFunc func()\n    switch v.JobName {\n    case \"job1\":\n        jobFunc = job1\n    case \"job2\":\n        jobFunc = job2      \n\n    }\n    c.AddFunc(v.CronExpression, jobFunc)\n}\n</code></pre>\n"}], "owner": {"reputation": 554, "user_id": 2641878, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/944ae88b2b2d75a63c64834fb716f913?s=128&d=identicon&r=PG", "display_name": "Gan", "link": "https://stackoverflow.com/users/2641878/gan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 223, "favorite_count": 0, "accepted_answer_id": 48342527, "answer_count": 1, "score": 1, "last_activity_date": 1516369492, "creation_date": 1516359325, "last_edit_date": 1516362745, "question_id": 48339485, "link": "https://stackoverflow.com/questions/48339485/how-to-add-function-to-cron-using-go-reflect", "title": "How to add function to cron using Go reflect?", "body": "<p>I am trying to schedule few jobs dynamically by reading configuration from file like below</p>\n\n<pre><code>import (\n   \"github.com/robfig/cron\" \n   \"fmt\"\n)\n    masterJobDetails :=// this is array of job from file\n\n    c := cron.New()\n        for k, v := range masterJobDetails {\n\n            fmt.Println(k, v.JobName)\n            c.AddFunc(v.CronExpression, v.JobName)//JobName is function name in string format which need to call on specific interval\n\n        }\n\n        c.Start()\n</code></pre>\n\n<p>c.AddFunc() expect cron expression and func() as input,Can i get second argument using reflect with  v.JobName string value</p>\n"}, {"tags": ["go", "kubernetes"], "comments": [{"owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "edited": false, "score": 0, "creation_date": 1516357615, "post_id": 48338872, "comment_id": 83662978, "body": "I think I know where <code>10.0.0.1</code> comes from. That is simply the IP for the <code>kubernetes</code> service. And the cause of all my problems seems to be that this IP is outside of the subnet I have on <code>cbr0</code> interface, which is <code>10.1.0.1&#47;24</code>. My question about the source code pointers still stands."}], "answers": [{"comments": [{"owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "edited": false, "score": 0, "creation_date": 1516440731, "post_id": 48353087, "comment_id": 83695590, "body": "Right. I was grepping for the full variable name. It is now obvious I have to grep for the suffix only."}, {"owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "edited": false, "score": 0, "creation_date": 1516447429, "post_id": 48353087, "comment_id": 83697568, "body": "I did sort it out by now. I did have too many misconfigurations to list them all here. Beginner errors, all, I guess, both with K8s and the provisioning system I used (NixOS package). Then I had to deal with the fact that I was setting the cluster on my laptop, where dns resolution changes as I move it between networks, so I had to install dnsmasq to isolate Kubernetes from it. And somehow it took me long time to realize i need to set NAT to be able to go from my pods into employers VPN network, something like <code>iptables -t nat -A POSTROUTING -o vpntun0 -s 10.1.0.0&#47;25 -j MASQUERADE</code>"}], "tags": [], "owner": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "is_accepted": true, "score": 1, "last_activity_date": 1516427738, "creation_date": 1516427738, "answer_id": 48353087, "question_id": 48338872, "link": "https://stackoverflow.com/questions/48338872/how-is-kubernetes-port-443-tcp-addr-being-set-any-pointers-to-kubernetes-sour/48353087#48353087", "title": "How is `KUBERNETES_PORT_443_TCP_ADDR` being set? Any pointers to Kubernetes source code?", "body": "<p><a href=\"https://github.com/kubernetes/kubernetes/blob/v1.9.0/pkg/kubelet/envvars/envvars.go#L45-L48\" rel=\"nofollow noreferrer\">https://github.com/kubernetes/kubernetes/blob/v1.9.0/pkg/kubelet/envvars/envvars.go#L45-L48</a> which I found via <code>git grep SERVICE_PORT</code></p>\n\n<p>It's possible that if your <code>kubernetes.default.svc.cluster.local</code> is pointing to the wrong IP, then <code>kubectl --namespace=kube-system edit svc kubernetes</code> and changing the <code>ClusterIP</code> would sort that out; I don't have a cluster in front of me to test it, though</p>\n"}], "owner": {"reputation": 16928, "user_id": 1047788, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/xA1rW.png?s=128&g=1", "display_name": "user7610", "link": "https://stackoverflow.com/users/1047788/user7610"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1230, "favorite_count": 0, "accepted_answer_id": 48353087, "answer_count": 1, "score": 1, "last_activity_date": 1516427738, "creation_date": 1516357490, "last_edit_date": 1516365469, "question_id": 48338872, "link": "https://stackoverflow.com/questions/48338872/how-is-kubernetes-port-443-tcp-addr-being-set-any-pointers-to-kubernetes-sour", "title": "How is `KUBERNETES_PORT_443_TCP_ADDR` being set? Any pointers to Kubernetes source code?", "body": "<p>When I run an image in Kubernetes with <code>kubectl run</code>, environment variables are injected into the container.</p>\n\n<p>My problem is that the values are wrong. I do not have anything running at <code>10.0.0.1</code>. I believe the correct value there would be <code>10.1.0.1</code>. This misconfiguration causes, as far as I know, among other things, the error from kube-dns reproduced below.</p>\n\n<p>I would like to ask how are these variables injected into the container, preferably for a link into the code which takes care of this (I could not find anything). Also, some hints where the value 10.0.0.1 could be coming from.</p>\n\n<p>pod variables:</p>\n\n<pre><code>$ kubectl run -i --image=busybox --restart=Never -t busybox\nIf you don't see a command prompt, try pressing enter.\n/ # env\nKUBERNETES_SERVICE_PORT=443\nKUBERNETES_PORT=tcp://10.0.0.1:443\nHOSTNAME=busybox\nSHLVL=1\nHOME=/root\nTERM=xterm\nKUBERNETES_PORT_443_TCP_ADDR=10.0.0.1\nPATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin\nKUBERNETES_PORT_443_TCP_PORT=443\nKUBERNETES_PORT_443_TCP_PROTO=tcp\nKUBERNETES_SERVICE_PORT_HTTPS=443\nKUBERNETES_PORT_443_TCP=tcp://10.0.0.1:443\nKUBERNETES_SERVICE_HOST=10.0.0.1\nPWD=/\n</code></pre>\n\n<p>kube-dns error:</p>\n\n<pre><code>$ kubectl --namespace kube-system logs kube-dns-2190035132-gxf80 kubedns\n[...]\nE0119 10:04:05.271499      55 reflector.go:199] k8s.io/dns/vendor/k8s.io/client-go/tools/cache/reflector.go:94: Failed to list *v1.Service: Get https://10.0.0.1:443/api/v1/services?resourceVersion=0: dial tcp 10.0.0.1:443: i/o timeout\nI0119 10:04:05.771477      55 dns.go:174] Waiting for services and endpoints to be initialized from apiserver...\n</code></pre>\n\n<p>The closest thing to <code>10.0.0.1</code> that I have in my config is <code>--service-cluster-ip-range=10.0.0.0/24</code> parameter I am giving to <code>kube-apiserver</code>.</p>\n\n<p>I have the IP <code>10.0.0.1</code> in my etcd, in</p>\n\n<pre><code># ETCDCTL_API=3 etcdctl get \"\" --from-key\n[...]\n/registry/services/specs/default/kubernetes\nk8s\n\nv1Service\n\n\nkubernetes\u2592default\"*$b198bc22-fcff-11e7-83a9-185e0fec8ce528B\n                                                           \ue0c7Z\n        component       apiserverZ\nprovider\nkuberneteszC\n\u2592\nhttpsTCP\u2592\u2592(10.0.0.1\"    ClusterIPClientIPBRZ`\u2592\n\u2592\"\n/registry/services/specs/kube-system/kubernetes-dashboard\nk8s\n\nv1Service\n\nkubernetes-dashboard\u2592\n                     kube-system\"*$b9f0daef-fcff-11e7-83a9-185e0fec8ce528B\n                                                                         \u053eZ,\naddonmanager.kubernetes.io/mode ReconcileZ\nppkubernetes-dashboardZ*\nkubernetes.io/minikube-addons   dashboardZ3\n&amp;kubernetes.io/minikube-addons-endpoint dashboardb\n0kubectl.kubernetes.io/last-applied-configuration{\"apiVersion\":\"v1\",\"kind\":\"Service\",\"metadata\":{\"annotations\":{},\"labels\":{\"addonmanager.kubernetes.io/mode\":\"Reconcile\",\"app\":\"kubernetes-dashboard\",\"kubernetes.io/minikube-addons\":\"dashboard\",\"kubernetes.io/minikube-addons-endpoint\":\"dashboard\"},\"name\":\"kubernetes-dashboard\",\"namespace\":\"kube-system\"},\"spec\":{\"ports\":[{\"nodePort\":30000,\"port\":80,\"targetPort\":9090}],\"selector\":{\"app\":\"kubernetes-dashboard\"},\"type\":\"NodePort\"}}\nz_\n\nTCP\u2592PG\u2592(\nppkubernetes-dashboard\u2592 10.0.0.82NodePort:NoneBRZCluster`\u2592\n\u2592\"\n</code></pre>\n"}, {"tags": ["go", "struct", "interface", "abstraction"], "comments": [{"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516357481, "post_id": 48338704, "comment_id": 83662907, "body": "If I understand you right, you may want to look how standard lib <code>image</code> and <code>image&#47;jpeg</code> and `image/png&quot; work together. Sorry I am on mobile, if you wish, I can elaborate later."}, {"owner": {"reputation": 1707, "user_id": 1127809, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/swoRv.jpg?s=128&g=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/1127809/florian"}, "reply_to_user": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "edited": false, "score": 0, "creation_date": 1516357974, "post_id": 48338704, "comment_id": 83663205, "body": "not exactly, as I later want to range over the slice of vehicles. in this example I would want to let all vehicles drive. image and image/jpeg work the way, that I import image/jpeg explicitly. In my case the the developer shouldn&#39;t even know what vehicle implementaions are there he should just call vehicles and work with them genericaly"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1516363110, "post_id": 48338704, "comment_id": 83666336, "body": "Are you looking for <a href=\"https://golang.org/pkg/plugin/\" rel=\"nofollow noreferrer\">plugins</a>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516369084, "post_id": 48338704, "comment_id": 83669979, "body": "What do you mean exactly by &quot;Depending on what implementations are available&quot;? The implementations must be supplied by the programmer, and must conform to some api. Where else are they coming from?"}, {"owner": {"reputation": 1707, "user_id": 1127809, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/swoRv.jpg?s=128&g=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/1127809/florian"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1516370759, "post_id": 48338704, "comment_id": 83671019, "body": "@JimB in a real world scenario, their would be hardware drivers, and you don&#39;t know what drivers area available. so you just want to use something like hardware.start() but you don&#39;t know which driver for which hardware will execute the start() function."}], "answers": [{"comments": [{"owner": {"reputation": 1707, "user_id": 1127809, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/swoRv.jpg?s=128&g=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/1127809/florian"}, "edited": false, "score": 0, "creation_date": 1516368699, "post_id": 48340644, "comment_id": 83669749, "body": "as you say, the design of image/jpeg is more idiomatic. This approach doesn&#39;t fit my needs, no? I want the developer just (in an image example) say: I want a new image, create it with whatever format you have. This is not as image/jpeg works in my understanding. image/jpeg works more like give me a new jpeg image. right?"}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "reply_to_user": {"reputation": 1707, "user_id": 1127809, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/swoRv.jpg?s=128&g=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/1127809/florian"}, "edited": false, "score": 0, "creation_date": 1516369038, "post_id": 48340644, "comment_id": 83669950, "body": "@Florian You made your point and I am not going to argue against it. Though If I am a developer using the lib, I would like myself being the one control the components. But this might be personal, I can&#39;t say for every scenero. And does the code beneath that comment satisfy your requirement?"}, {"owner": {"reputation": 1707, "user_id": 1127809, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/swoRv.jpg?s=128&g=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/1127809/florian"}, "edited": false, "score": 0, "creation_date": 1516370637, "post_id": 48340644, "comment_id": 83670935, "body": "yes it does. I totaly agree with you. But in this case of course I&#39;m not really coding cars, it&#39;s about hardware drivers, and the system should automatically use the driver that fits for the hardware. So the developer himself has no idea which driver is used in production later."}, {"owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "reply_to_user": {"reputation": 1707, "user_id": 1127809, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/swoRv.jpg?s=128&g=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/1127809/florian"}, "edited": false, "score": 0, "creation_date": 1516371090, "post_id": 48340644, "comment_id": 83671262, "body": "I only have one time programing with hardware and it was like 5 years ago so I really did not take hardware into consideration. It seems makes perfect sense. I will keep looking if there are more idomatic way of doint this. I will let you know If I find one."}], "tags": [], "owner": {"reputation": 5521, "user_id": 9143962, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/488e46850036ab6203c41bf5f9c2c31d?s=128&d=identicon&r=PG&f=1", "display_name": "leaf bebop", "link": "https://stackoverflow.com/users/9143962/leaf-bebop"}, "is_accepted": true, "score": 0, "last_activity_date": 1516363228, "creation_date": 1516363228, "answer_id": 48340644, "question_id": 48338704, "link": "https://stackoverflow.com/questions/48338704/open-design-and-expandability-in-go/48340644#48340644", "title": "Open Design and expandability in GO", "body": "<p>I would think the design of <code>image</code> and <code>database/sql</code> and how they co-operate with other libs more idomatic, but if you really need to implent this kind of design, I have come up with some thing hack-y.</p>\n\n<p>The trick is, golang can do function calls during declaration of global vars and that happens before calling any of <code>init</code>. So we can do the register job during that.</p>\n\n<pre><code>//vehicle.go\nimport (\n    \"fmt\"\n)\n\nvar _ = register(\"3\",4)\n\ntype constructor func() *Vehicle\n\nvar reg = make(map[string]consturctor)\n\nfunc register(name string, cons) bool {\n    _,ok:=reg[name]\n    if ok {\n        return false\n    }\n    reg[name] = cons\n    return true\n}\n\nvar chosen string\n\nfunc init() {\n    //turn that map into a slice if you want\n    //Chose one \"implentation\" from the slice/map if you wish\n    for chosen = range reg {\n        break // Take the first, it is dirty, I know.\n    }\n    if Chosen==\"\" {\n        panic(\"No Implentation!\")\n    }\n}\n\nfunc NewVehicle() *Vehicle {\n    return reg[chosen]() \n}\n\nfunc main() {\n    fmt.Println(\"Hello, playground\")\n}\n\n//car.go\n\nvar carsucc = register(\"car\",constructor(NewCar))\n\nfunc init() {\n    if !carsucc {\n        panic(\"car: multiple implentation!\")\n    }\n    //off course you can fail silently\n}\n\nfunc NewCar() Vehicle {\n    return &amp;Car{}\n}\n</code></pre>\n"}], "owner": {"reputation": 1707, "user_id": 1127809, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/swoRv.jpg?s=128&g=1", "display_name": "Florian", "link": "https://stackoverflow.com/users/1127809/florian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 52, "favorite_count": 0, "accepted_answer_id": 48340644, "answer_count": 1, "score": 0, "last_activity_date": 1516363228, "creation_date": 1516356931, "last_edit_date": 1516358252, "question_id": 48338704, "link": "https://stackoverflow.com/questions/48338704/open-design-and-expandability-in-go", "title": "Open Design and expandability in GO", "body": "<p>I try to implement some kind of open design paradigm with expandability in go, but wonder what would be the gopher way of doing this. </p>\n\n<p>For example I have a vehicle package. Depending on what implementations are available, I want to create an array of all possible vehicles. In this example if just bike is available I want an array [bike] if there is another car implementation I want to have [bike,car] </p>\n\n<p>I don't really get how to do this in go. I thought for an interface in the vehicle package, but I don't really get how to create the array depending on which package is available. And this should be open design, so that if somebody decides to write another vehicle, a truck i.e. it would automatically work upstream.</p>\n\n<p>So this is some example code for the explained issue:\nIf it's not necessary, that they are devided into packages, they could also be in the same package (vehicles)</p>\n\n<p>vehicle.go</p>\n\n<pre><code>package vehicle\n\ntype vehicle interface {\n    drive() string\n}\n</code></pre>\n\n<p>bike.go</p>\n\n<pre><code>package bike\n\ntype bike struct {\n    name string\n}\n\nfunc (b *bike) drive() string {\n    return \"drive bike drive\"\n}\n\nfunc NewVehicle() bike {\n    return &amp;bike{\n        name: \"bike\",\n    }\n}\n</code></pre>\n\n<p>car.go</p>\n\n<pre><code>package car\n\ntype carstruct {\n    name string\n}\n\nfunc (b *car) drive() string {\n    return \"drive cardrive\"\n}\n\nfunc NewVehicle() car{\n    return &amp;car{\n        name: \"car\",\n    }\n}\n</code></pre>\n"}]