[{"tags": ["go"], "owner": {"reputation": 8069, "user_id": 296923, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/cb7b3af2d2d967711454dc8d9c21798f?s=128&d=identicon&r=PG", "display_name": "Ziffusion", "link": "https://stackoverflow.com/users/296923/ziffusion"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 110, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501717983, "creation_date": 1501717504, "last_edit_date": 1501717983, "question_id": 45472652, "link": "https://stackoverflow.com/questions/45472652/how-does-hijackconnect-work-in-goproxy", "title": "How does HijackConnect work in goproxy?", "body": "<p>From the documentation, it seems like <code>HijackConnect</code> is for hijacking HTTPS connections. But there is an <a href=\"https://github.com/elazarl/goproxy/blob/master/examples/goproxy-eavesdropper/main.go#L28\" rel=\"nofollow noreferrer\">example</a> in the code where <code>HijackConnect</code> is called as follows (for HTTP connections, port 80).</p>\n\n<pre><code>proxy.OnRequest(goproxy.ReqHostMatches(regexp.MustCompile(\"^.*:80$\"))).\n    HijackConnect(func(req *http.Request, client net.Conn, ctx *goproxy.ProxyCtx) {\n</code></pre>\n\n<p>Can anyone explain what is going on here?</p>\n"}, {"tags": ["multithreading", "http", "go", "chunks"], "comments": [{"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1501735940, "post_id": 45472324, "comment_id": 77910536, "body": "If server supports range request then that your way. Learn more about <a href=\"https://developer.mozilla.org/en-US/docs/Web/HTTP/Range_requests\" rel=\"nofollow noreferrer\">Range Requests</a>. And then you have properly write the file data in the order."}, {"owner": {"reputation": 63, "user_id": 8408306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7af59c80c1649c21a153580034208f?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/8408306/bobby"}, "reply_to_user": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 0, "creation_date": 1501754118, "post_id": 45472324, "comment_id": 77922037, "body": "Hi, it doesn&#39;t support range requests. I have a link on each chunk."}, {"owner": {"reputation": 3701, "user_id": 1343356, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f7f97690d8ae261766c333e8742473e6?s=128&d=identicon&r=PG", "display_name": "jeevatkm", "link": "https://stackoverflow.com/users/1343356/jeevatkm"}, "edited": false, "score": 1, "creation_date": 1501783367, "post_id": 45472324, "comment_id": 77944410, "body": "Okay, so you have set of links. Then you can create method called download than call that method via goroutine with each chuck link. Also use <code>sync.WaitGroup</code> for wait to finish download."}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 8408306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7af59c80c1649c21a153580034208f?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/8408306/bobby"}, "edited": false, "score": 0, "creation_date": 1502833866, "post_id": 45494634, "comment_id": 78362538, "body": "Thanks! Yep, i want to implement an additional logic in order to keep track of the order.  One more question, about Go lang, in general. What if len(links) == 1000, does it mean that i will instantly create 1000 threads and only 4 of them will be active for the first time and the others will be zombie threads for a while?  I am asking, because i am a bit confused and have no idea how it affects my stack and ram."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 63, "user_id": 8408306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7af59c80c1649c21a153580034208f?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/8408306/bobby"}, "edited": false, "score": 0, "creation_date": 1502834173, "post_id": 45494634, "comment_id": 78362663, "body": "The semaphore is blocking, so if you have 1000 links, only 4 will be processed at a time because only 4 goroutines will be running at any given time."}, {"owner": {"reputation": 63, "user_id": 8408306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7af59c80c1649c21a153580034208f?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/8408306/bobby"}, "edited": false, "score": 0, "creation_date": 1502834362, "post_id": 45494634, "comment_id": 78362740, "body": "Yep, i understand it, but anyway, the function will be called 996 times. And each call takes at least 5*4 bytes(in this case) on the stack(x86) isn&#39;t it? it&#39;s not a big deal to allocate 5*4*1000 bytes, just want to make sure that it&#39;s fine."}, {"owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "reply_to_user": {"reputation": 63, "user_id": 8408306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7af59c80c1649c21a153580034208f?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/8408306/bobby"}, "edited": false, "score": 0, "creation_date": 1502834598, "post_id": 45494634, "comment_id": 78362826, "body": "You&#39;ll be fine, 4 is a really low number in production I&#39;d probably be in the thousands. The garage collection will clean up as goroutines complete. Your real challenge filling up memory from the stored res.Body. You also probably don&#39;t want to write to file to often as it will kill the life on the drive."}, {"owner": {"reputation": 63, "user_id": 8408306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7af59c80c1649c21a153580034208f?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/8408306/bobby"}, "edited": false, "score": 0, "creation_date": 1502834812, "post_id": 45494634, "comment_id": 78362915, "body": "Yeah, also don&#39;t like to seek too often 8)"}], "tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": true, "score": 5, "last_activity_date": 1519685770, "last_edit_date": 1519685770, "creation_date": 1501794925, "answer_id": 45494634, "question_id": 45472324, "link": "https://stackoverflow.com/questions/45472324/download-files-by-chunks-in-multiple-threads-in-golang/45494634#45494634", "title": "Download files by chunks in multiple threads in Golang", "body": "<p>This is an example of how to set up a concurrent downloader. Things to be aware of are bandwidth, memory, and disk space.  You can kill your bandwidth by trying to do to much at once, the same goes for memory.  Your downloading pretty big files so memory can be an issue.  Another thing to note is that by using gorountines you are losing request order. So if the order of the returned bytes matter, then this will not work because you will have to know the byte order to assemble the file in the end, which would mean that a downloading one at a time is best, unless you implement a way to keep track of the order (maybe some kind of global map[order int][]bytes with mutex to prevent race conditions).  An alternative that doesn't involve <code>Go</code> (assuming you have a unix machine for ease) is to use <code>Curl</code> see here <a href=\"http://osxdaily.com/2014/02/13/download-with-curl/\" rel=\"nofollow noreferrer\">http://osxdaily.com/2014/02/13/download-with-curl/</a></p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"io\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"sync\"\n)\n\n// now your going to have to be careful because you can potentially run out of memory downloading to many files at once..\n// however here is an example that can be modded\nfunc downloader(wg *sync.WaitGroup, sema chan struct{}, fileNum int, URL string) {\n    sema &lt;- struct{}{}\n    defer func() {\n        &lt;-sema\n        wg.Done()\n    }()\n\n    client := &amp;http.Client{Timeout: 10}\n    res, err := client.Get(URL)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer res.Body.Close()\n    var buf bytes.Buffer\n    // I'm copying to a buffer before writing it to file\n    // I could also just use IO copy to write it to the file\n    // directly and save memory by dumping to the disk directly.\n    io.Copy(&amp;buf, res.Body)\n    // write the bytes to file\n    ioutil.WriteFile(fmt.Sprintf(\"file%d.txt\", fileNum), buf.Bytes(), 0644)\n    return\n}\n\nfunc main() {\n    links := []string{\n        \"url1\",\n        \"url2\", // etc...\n    }\n    var wg sync.WaitGroup\n    // limit to four downloads at a time, this is called a semaphore\n    limiter := make(chan struct{}, 4)\n    for i, link := range links {\n        wg.Add(1)\n        go downloader(&amp;wg, limiter, i, link)\n    }\n    wg.Wait()\n\n}\n</code></pre>\n"}], "owner": {"reputation": 63, "user_id": 8408306, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1d7af59c80c1649c21a153580034208f?s=128&d=identicon&r=PG&f=1", "display_name": "Bobby", "link": "https://stackoverflow.com/users/8408306/bobby"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2493, "favorite_count": 2, "accepted_answer_id": 45494634, "answer_count": 1, "score": 4, "last_activity_date": 1519685770, "creation_date": 1501715002, "last_edit_date": 1501723565, "question_id": 45472324, "link": "https://stackoverflow.com/questions/45472324/download-files-by-chunks-in-multiple-threads-in-golang", "title": "Download files by chunks in multiple threads in Golang", "body": "<p>I need to download files, chunk by chunk in multiple threads.\nFor example, I have 1k files, each file ~100Mb-1Gb and I can download these files only by chunks 4096Kb(each http get request gives me only 4kb).</p>\n\n<p>It might be to long to download it in one thread, so I want to download them, let's say in 20 threads(one thread for one file) and I also need to download a few chunks in each of these threads, simultaneously.</p>\n\n<p>Is there any example that shows such logic?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 144, "user_id": 8075949, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/UeTbN.png?s=128&g=1", "display_name": "nk2ge5k", "link": "https://stackoverflow.com/users/8075949/nk2ge5k"}, "is_accepted": true, "score": 2, "last_activity_date": 1501713450, "creation_date": 1501713450, "answer_id": 45472101, "question_id": 45471843, "link": "https://stackoverflow.com/questions/45471843/golang-how-can-i-check-for-errors-using-the-sql-query-row/45472101#45472101", "title": "Golang how can I check for errors using the sql query row", "body": "<p>You should just check return value of Row.Scan method, just like this:</p>\n\n<pre><code>row := db.QueryRow(\n    `SELECT \n        json_build_object('Profile', array_to_json(array_agg(t))) \n    FROM\n        (\n            SELECT \n                p.id,\n                p.fullname,\n                z.thirtylatmin as latmin,\n                z.thirtylatmax as latmax,\n                z.thirtylonmin as lonmin,\n                z.thirtylonmax as lonmax,\n                p.latitudes,\n                p.longitudes,\n                p.location as location,\n                p.picture,\n                p.is_gold \n            FROM \n                profiles p \n            JOIN zips z on (z.city='Boston'AND z.state='MA') \n            WHERE \n                email=$1\n        ) t`,\n    email,\n)\n\nvar result string\nif err := Scan(&amp;result); err != nil {\n    log.Fatal(err)\n}\n\nfmt.Fprint(w, result)\n</code></pre>\n"}], "owner": {"reputation": 2015, "user_id": 1591668, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/cb658beece55f9525bd4cbb682fadc44?s=128&d=identicon&r=PG", "display_name": "user1591668", "link": "https://stackoverflow.com/users/1591668/user1591668"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1559, "favorite_count": 0, "accepted_answer_id": 45472101, "answer_count": 1, "score": 1, "last_activity_date": 1501713450, "creation_date": 1501711805, "question_id": 45471843, "link": "https://stackoverflow.com/questions/45471843/golang-how-can-i-check-for-errors-using-the-sql-query-row", "title": "Golang how can I check for errors using the sql query row", "body": "<p>I am using postgres database and am returning a Json response from the database in the form of a string which is used for an API . My problem is that I do not know how to check for errors using the QueryRow Method . This right here is my code and it works correctly. That just shows a Json response . However I have a custom function that I would like to use if there is some error with the code and QueryRow does not let me check for errors any suggestions ? </p>\n\n<pre><code> var result string\n db.QueryRowContext(ctx,\"select json_build_object('Profile', array_to_json(array_agg(t))) from\" +\n                    \" (select p.id,p.fullname,z.thirtylatmin as latmin,z.thirtylatmax as latmax,z.thirtylonmin as lonmin,\" +\n                          \"z.thirtylonmax as lonmax,p.latitudes,p.longitudes,p.location as location\" +\n                    \",p.picture,p.is_gold from profiles p join zips z on (z.city='Boston' \" +\n                 \"and z.state='MA') where email=$1) t;\",email).Scan(&amp;result)\n\nio.writestring(w, result)\n</code></pre>\n\n<p>If I change the above code to this then it works with the error message however how can I return that in a String</p>\n\n<pre><code>SqlStatement,err := db.QueryContext(ctx,\"select json_build_object('Profile', array_to_json(array_agg(t))) from\" +\n                \" (select p.id,p.fullname,z.thirtylatmin as latmin,z.thirtylatmax as latmax,z.thirtylonmin as lonmin,\" +\n                      \"z.thirtylonmax as lonmax,p.latitudes,p.longitudes,p.location as location\" +\n                \",p.picture,p.is_gold from profiles p join zips z on (z.city='Boston' \" +\n             \"and z.state='MA') where email=$1) t;\",email)\n\n            if err != nil {\n                log_errors(\"sql statement error\",err.Error(),w)\n            }\n            io.WriteString(w, \"How can I get SqlStatement as 1 whole String ??\")\n</code></pre>\n\n<p>The statement above lets me log any errors and insert it into the database, now how can I get SqlStatement to return as 1 whole string ? The SQL statement returns perfectly now I just need to get it into io.WriteString in a String format</p>\n"}, {"tags": ["azure", "go", "azure-storage-blobs"], "comments": [{"owner": {"reputation": 64493, "user_id": 272109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32170c62eb744820e8afdd023379a95a?s=128&d=identicon&r=PG", "display_name": "David Makogon", "link": "https://stackoverflow.com/users/272109/david-makogon"}, "edited": false, "score": 0, "creation_date": 1501724746, "post_id": 45470989, "comment_id": 77907812, "body": "Why are you uploading individual blocks? This seems unnecessarily painful. That SDK has a <code>createBlockBlobFromReader()</code> method that takes care of all the blob operations for you. (see <a href=\"https://github.com/Azure/azure-sdk-for-go/blob/master/storage/blockblob.go\" rel=\"nofollow noreferrer\">the source</a>)"}, {"owner": {"reputation": 11, "user_id": 7606867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc4975f662f660e5825b203085155ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kennya42", "link": "https://stackoverflow.com/users/7606867/kennya42"}, "reply_to_user": {"reputation": 64493, "user_id": 272109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/32170c62eb744820e8afdd023379a95a?s=128&d=identicon&r=PG", "display_name": "David Makogon", "link": "https://stackoverflow.com/users/272109/david-makogon"}, "edited": false, "score": 0, "creation_date": 1501772795, "post_id": 45470989, "comment_id": 77937216, "body": "I&#39;m not sure how createBlockBlobFromReader() is different from CreateBlockBlob(). Are you saying i should create one block and upload all my blobs to it to avoid making a new block each time? Not sure how to do this. Also the azure I&#39;m uploading to is private so do i need to set the metadata and properties of the blob before upload?"}], "answers": [{"tags": [], "owner": {"reputation": 20467, "user_id": 4989676, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jP8H6.jpg?s=128&g=1", "display_name": "Peter Pan", "link": "https://stackoverflow.com/users/4989676/peter-pan"}, "is_accepted": false, "score": 1, "last_activity_date": 1501830790, "creation_date": 1501830790, "answer_id": 45500393, "question_id": 45470989, "link": "https://stackoverflow.com/questions/45470989/golang-azure-blob-store-0b-blobs-and-overwrites-downloaded-blobs-data/45500393#45500393", "title": "Golang azure blob store, 0b blobs and overwrites downloaded blobs data", "body": "<p>As @DavidMakogon said, you can use the API <a href=\"http://godoc.org/github.com/Azure/azure-sdk-for-go/storage#Blob.CreateBlockBlobFromReader\" rel=\"nofollow noreferrer\"><code>CreateBlockBlobFromReader</code></a> of Azure Storage SDK for Go to upload from any reader implements the interface <code>io.Reader</code> to Azure Blob Storage.</p>\n\n<p>Here are my sample code as below.</p>\n\n<pre><code>accountName := \"&lt;your-storage-account-name&gt;\"\naccountKey := \"&lt;your-storage-account-key&gt;\"\nclient, _ := storage.NewBasicClient(accountName, accountKey)\nblobClinet := client.GetBlobService()\ncontainerName := \"mycontainer\"\ncontainer := blobClinet.GetContainerReference(containerName)\n\n// Two sample ways for uploading\n// 1. Upload a text blob from string reader\nblobName := \"upload.txt\"\nblob := container.GetBlobReference(blobName)\nstrReader := strings.NewReader(\"upload text to blob from string reader\")\nblob.CreateBlockBlobFromReader(strReader, nil)\n\n// 2. Upload a file from file reader\nfileName := \"hello.png\"\nfile, _ := os.Open(fileName)\nblobName := \"hello.png\"\nblob := container.GetBlobReference(blobName)\nblob.CreateBlockBlobFromReader(file, nil)\n</code></pre>\n\n<p>Hope it helps.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 7606867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc4975f662f660e5825b203085155ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kennya42", "link": "https://stackoverflow.com/users/7606867/kennya42"}, "is_accepted": false, "score": 0, "last_activity_date": 1501861711, "creation_date": 1501861711, "answer_id": 45510922, "question_id": 45470989, "link": "https://stackoverflow.com/questions/45470989/golang-azure-blob-store-0b-blobs-and-overwrites-downloaded-blobs-data/45510922#45510922", "title": "Golang azure blob store, 0b blobs and overwrites downloaded blobs data", "body": "<pre><code>    compressedData := buffout.Bytes()\n    //push block blob to azure\n    fmt.Println(\"uploading: \",filestr)\n    blockID := base64.StdEncoding.EncodeToString([]byte(\"00001\"))\n    newblob := cnt.GetBlobReference(filestr)\n    err = newblob.CreateBlockBlobFromReader(bytes.NewReader(compressedData),nil)\n    check(err)\n    err = newblob.PutBlock(blockID, compressedData, nil)\n    check(err)\n    list, err := newblob.GetBlockList(storage.BlockListTypeUncommitted, nil)\n    check(err)\n    uncommittedBlocksList := make([]storage.Block, len(list.UncommittedBlocks))\n    for i := range list.UncommittedBlocks {\n        uncommittedBlocksList[i].ID = list.UncommittedBlocks[i].Name\n        uncommittedBlocksList[i].Status = storage.BlockStatusUncommitted\n    }\n    err = newblob.PutBlockList(uncommittedBlocksList, nil)\n    check(err)\n</code></pre>\n\n<p>This fixed my problem looking at the original i had a typo calling.</p>\n\n<pre><code>list, err := b.GetBlockList(storage.BlockListTypeUncommitted, nil)\n</code></pre>\n\n<p>This caused azure to get both a new blob called filestr and to overwrite the original blob.</p>\n"}], "owner": {"reputation": 11, "user_id": 7606867, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5fc4975f662f660e5825b203085155ae?s=128&d=identicon&r=PG&f=1", "display_name": "Kennya42", "link": "https://stackoverflow.com/users/7606867/kennya42"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1166, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1501861711, "creation_date": 1501707957, "last_edit_date": 1501770220, "question_id": 45470989, "link": "https://stackoverflow.com/questions/45470989/golang-azure-blob-store-0b-blobs-and-overwrites-downloaded-blobs-data", "title": "Golang azure blob store, 0b blobs and overwrites downloaded blobs data", "body": "<p>Currently using: <a href=\"https://github.com/Azure/azure-sdk-for-go\" rel=\"nofollow noreferrer\">https://github.com/Azure/azure-sdk-for-go</a></p>\n\n<p>overview: I'm currently downloading a blob from the azure blob store, parsing the blob and uploading a transcribed blob back to the store in another folder called filtered. </p>\n\n<p>Problem: The blob uploaded is not in the folder filtered but in the root directory and the blob is 0B with no data. The blob upload also seems to destroy the blob i just downloaded resulting in the blob being 0B with no data. Downloading the blob works fine and i'm able to get the []byte array of the data.</p>\n\n<p>Code:</p>\n\n<pre><code>import (\n\"bufio\"\n\"fmt\"\n\"os\"\n\"strings\"\n\"strconv\"\n\"math/big\"\n\"bytes\"\n\"io/ioutil\"\n\"github.com/Azure/azure-sdk-for-go/storage\"\n\"compress/gzip\"\n\"encoding/base64\"\n\"crypto/md5\"\n)\n\nfunc main() {\n    var filter bool = true                                                  //check smart filter\n    test := 0\n    configfile, err := os.Open(\"config.txt\")                                //open configfile\n    check(err)                                                              //check file opened\n    ConfigScanner := bufio.NewScanner(configfile)                           //open buffer\n    ConfigScanner.Scan()                                                    //get serial number\n    serialnum := ConfigScanner.Text()\n    configfile.Close()                                                      //close the config file\n    CanLUT := ParseDBC(\"file.dbc\")                                          //parse the associated DBC file\n    check(err)                                                              //check file opened\n    m := make(map[int64]string)                                             //map of last seen message\n    //Azure API\n    client, err := storage.NewBasicClient(accountName, accountKey)          //get client from azure\n    check(err)\n    bsc := client.GetBlobService()                                          //access blob service\n    cnt := bsc.GetContainerReference(\"containerblob\")                           //get container of the blob\n    LBP := storage.ListBlobsParameters{}                                    \n    LBP.Prefix = \"dev4/dev4\"                                                //only get blobs with dev4/dev4 prefix\n    list, err := cnt.ListBlobs(LBP)                                         //get list of all matching blobs\n    check(err)\n    for _, b := range list.Blobs {                                          //read all blobs from azure with prefix dev4/dev4\n        oa := make([]byte,0)\n        fmt.Println(\"getting blob: \",b.Name)\n        readCloser, err := b.Get(nil)                                       //get blob data\n        check(err)\n        bytesRead, err := ioutil.ReadAll(readCloser)                        //read blob data to byte[]\n        check(err)\n        if len(bytesRead) &lt; 1 {\n            continue\n        }\n        br := bytes.NewReader(bytesRead)\n        zr, err := gzip.NewReader(br)                                       //use gzip reader for zipped data\n        check(err)\n        uz, err := ioutil.ReadAll(zr)                                       //uz byte[] of unzipped file\n        check(err)\n        readCloser.Close()                                                  //close the reader\n        zr.Close()                                                          //close gzip reader\n        r := bytes.NewReader(uz)\n        scanner := bufio.NewScanner(r)\n        for scanner.Scan() {                                                //loop on each line in the input file\n            temp := ParseToFrame(scanner.Text())                            //parse the line into a usable struct\n            _, exists := m[temp.nodeid]                                     //check if the frame has alread been seen and is stored in the hashmap\n            if exists {                                                     //if exists in the map\n                if ChkDuplicate(m, temp) {                                  //is the msg a duplicate? if true the message isnt so add it\n                    m[temp.nodeid] = temp.data                              //update the data to the hashmap\n                    DecodeFrame(temp, &amp;oa, CanLUT, filter, serialnum)       //decode the frame and output it to another file\n                }\n            } else {                                                        //DNE in map so add it\n                m[temp.nodeid] = temp.data\n                DecodeFrame(temp, &amp;oa, CanLUT,filter, serialnum)            //decode the frame and output it to another file\n            }\n        }//end blob file\n        filestr := strings.Split(b.Name, \"_\")[1]\n        filestr = \"filtered/filtered_\" + filestr\n        var buffout bytes.Buffer\n        gz := gzip.NewWriter(&amp;buffout)\n        _, err = gz.Write(oa)\n        check(err)\n        gz.Flush()\n        gz.Close()\n        compressedData := buffout.Bytes()\n        //push block blob to azure\n        fmt.Println(\"uploading: \",filestr)\n        clientnew, err := storage.NewBasicClient(accountName, accountKey)           //get client from azure\n        check(err)\n        senderbsc := clientnew.GetBlobService()                                         //access blob service\n        sendercnt := senderbsc.GetContainerReference(\"storeblob\")                           //get container of store blob\n        bblob := sendercnt.GetBlobReference(\"filtered_\" + strings.Split(b.Name, \"/\")[1])\n        err = bblob.CreateBlockBlob(nil)\n        check(err)\n        blockID := base64.StdEncoding.EncodeToString([]byte(\"00000\"))\n        err = bblob.PutBlock(blockID, compressedData, nil)\n        check(err)\n        list, err := b.GetBlockList(storage.BlockListTypeUncommitted, nil)\n        check(err)\n        uncommittedBlocksList := make([]storage.Block, len(list.UncommittedBlocks))\n        for i := range list.UncommittedBlocks {\n            uncommittedBlocksList[i].ID = list.UncommittedBlocks[i].Name\n            uncommittedBlocksList[i].Status = storage.BlockStatusUncommitted\n        }\n        err = b.PutBlockList(uncommittedBlocksList, nil)\n        //check if upload was good.\n        CheckHash(&amp;compressedData,filestr,sendercnt)\n        check(err)\n        if(test == 0){\n            break       //test only read one file\n        }\n        test++\n    }//end for blobs     \n}//end main\n</code></pre>\n"}, {"tags": ["unit-testing", "go"], "owner": {"reputation": 853, "user_id": 4963334, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/35454f0f8a31948bbdaccefdc8dd1f6c?s=128&d=identicon&r=PG&f=1", "display_name": "immrsteel", "link": "https://stackoverflow.com/users/4963334/immrsteel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1496, "favorite_count": 0, "answer_count": 0, "score": 4, "last_activity_date": 1501715568, "creation_date": 1501707424, "last_edit_date": 1501715568, "question_id": 45470862, "link": "https://stackoverflow.com/questions/45470862/golang-mock-a-multiple-http-requests-using-gock", "title": "Golang: Mock a multiple http requests using gock", "body": "<p>I am trying to mock a multiple http requests using gock for unit testing but I am getting this error:</p>\n\n<pre><code>    Error:  Get https://192.64.23.33/q1/status: gock: cannot match any request\n    Error:  Get https://194.55.5.6/q1/status: gock: cannot match any request\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>func GetEmployee(url string, cli *http.Client) *Response {\n    //Do something\n    return Response\n}\n\nfunc company(url []string, cli *http.Client) []string {\n\n    for employee := range url {\n        resultList := GetEmployee(employee, cli)\n        //Process and return an array\n        return resultList\n    }\n}\n</code></pre>\n\n<p>Unittest:</p>\n\n<pre><code>func TestCompany(t *Testing.t){\n  Convey(\"testing function company\",t,func() {\n  expected := &amp;Response: {\n                Name:     \"xyz\",\n                ID:       1\",\n                Status:   \"active\",\n\n            }\n  MockCli := &amp;http.Client{}\n  testemployees := []string{\"192.64.23.33\",\"194.55.5.6\"}\n  for _, testempl := range testemployees {\n        gock.New(fmt.Sprintf(\"https://%s\", testempl)).\n            Get(\"/q1/status\").\n            Reply(200).\n            JSON(expected) \n        gock.InterceptClient(MockCli)\n        response, err = company(testemployees, MockCli)\n\n        //some assertions\n       }\n    })\n\n  }\n</code></pre>\n\n<p>Unit tests failed when I am passing testemployees := []string{\"192.64.23.33\",\"194.55.5.6\"} more than one element in a list otherwise if there is only one element then it  passes as expected.</p>\n\n<p>How to mock a multiple URLs here so that gock can match a request?</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501709453, "post_id": 45470637, "comment_id": 77903745, "body": "Just a note, when you do get it set up correctly, it is still accessible at the default URL. This can be useful if you happen to be deploying different modules and/or versions at the same time. You are able to access them specifically by URL. My app rollout phase doesn&#39;t hit users all at once, so I can have the new version and old serving until everyone has migrated over. See here for how the URLs are set up <a href=\"https://cloud.google.com/appengine/docs/standard/go/how-requests-are-routed\" rel=\"nofollow noreferrer\">cloud.google.com/appengine/docs/standard/go/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 8133391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499df8d51133fa9b33ba050aa242ce4c?s=128&d=identicon&r=PG&f=1", "display_name": "CRCX001", "link": "https://stackoverflow.com/users/8133391/crcx001"}, "edited": false, "score": 0, "creation_date": 1501707555, "post_id": 45470753, "comment_id": 77902789, "body": "I&#39;m not using python"}, {"owner": {"reputation": 37127, "user_id": 4495081, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/OuWYd.jpg?s=128&g=1", "display_name": "Dan Cornilescu", "link": "https://stackoverflow.com/users/4495081/dan-cornilescu"}, "reply_to_user": {"reputation": 11, "user_id": 8133391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499df8d51133fa9b33ba050aa242ce4c?s=128&d=identicon&r=PG&f=1", "display_name": "CRCX001", "link": "https://stackoverflow.com/users/8133391/crcx001"}, "edited": false, "score": 0, "creation_date": 1501708371, "post_id": 45470753, "comment_id": 77903194, "body": "@CRCX001 : just replace &quot;python&quot; with &quot;go&quot; in that url. Instructions are pretty much the same regardless of the language."}, {"owner": {"reputation": 11, "user_id": 8133391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499df8d51133fa9b33ba050aa242ce4c?s=128&d=identicon&r=PG&f=1", "display_name": "CRCX001", "link": "https://stackoverflow.com/users/8133391/crcx001"}, "edited": false, "score": 0, "creation_date": 1501708922, "post_id": 45470753, "comment_id": 77903482, "body": "and this will send to my domain, yes?"}, {"owner": {"reputation": 6363, "user_id": 1666569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJxtP.jpg?s=128&g=1", "display_name": "Cameron Roberts", "link": "https://stackoverflow.com/users/1666569/cameron-roberts"}, "edited": false, "score": 0, "creation_date": 1501767097, "post_id": 45470753, "comment_id": 77932066, "body": "Yes, but you have the logic reversed, it will send traffic to your domain to the App Engine application, so you still deploy to your APPID.appspot.com location and you can always access your application on the appspot domain."}], "tags": [], "owner": {"reputation": 6363, "user_id": 1666569, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/lJxtP.jpg?s=128&g=1", "display_name": "Cameron Roberts", "link": "https://stackoverflow.com/users/1666569/cameron-roberts"}, "is_accepted": false, "score": 2, "last_activity_date": 1501767028, "last_edit_date": 1501767028, "creation_date": 1501706981, "answer_id": 45470753, "question_id": 45470637, "link": "https://stackoverflow.com/questions/45470637/app-engine-deploy-to-somewhere-that-is-not-project-id-appspot-com/45470753#45470753", "title": "App Engine deploy to somewhere that is not project_id.appspot.com", "body": "<p>You need to set up your domain to direct traffic to the appspot location, rather than deploy the code \"to\" your domain.</p>\n\n<p><a href=\"https://cloud.google.com/appengine/docs/standard/go/using-custom-domains-and-ssl#adding_a_custom_domain_for_your_application\" rel=\"nofollow noreferrer\">https://cloud.google.com/appengine/docs/standard/go/using-custom-domains-and-ssl#adding_a_custom_domain_for_your_application</a></p>\n"}], "owner": {"reputation": 11, "user_id": 8133391, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/499df8d51133fa9b33ba050aa242ce4c?s=128&d=identicon&r=PG&f=1", "display_name": "CRCX001", "link": "https://stackoverflow.com/users/8133391/crcx001"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 45, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501767028, "creation_date": 1501706509, "last_edit_date": 1501708260, "question_id": 45470637, "link": "https://stackoverflow.com/questions/45470637/app-engine-deploy-to-somewhere-that-is-not-project-id-appspot-com", "title": "App Engine deploy to somewhere that is not project_id.appspot.com", "body": "<p>Exactly as title says, am trying to deploy project to App Engine but whenever try always says deploying to project_id.appspot.com</p>\n\n<p>I have domain recently transferred from original registrar to Google Domains, how deploy to my domain instead of project_id.appspot.com because nobody will go there? I have been working for months on project and need to get online within next couple of weeks before end of month</p>\n"}, {"tags": ["json", "go", "marshalling", "unmarshalling"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501705628, "post_id": 45470368, "comment_id": 77901745, "body": "Welcome to a statically typed language. With the <code>json</code> package, you can always Unmarshal into a <code>map[string]interface{}</code> but this usually isn&#39;t what you really want."}], "answers": [{"tags": [], "owner": {"reputation": 1569, "user_id": 6011068, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gE9IM.jpg?s=128&g=1", "display_name": "twils0", "link": "https://stackoverflow.com/users/6011068/twils0"}, "is_accepted": false, "score": 1, "last_activity_date": 1509594071, "last_edit_date": 1509594071, "creation_date": 1501710716, "answer_id": 45471607, "question_id": 45470368, "link": "https://stackoverflow.com/questions/45470368/convert-complex-json-to-map-in-golang/45471607#45471607", "title": "Convert complex JSON to map in Golang", "body": "<p>You could build a recursive function with a type assertion switch to type assert the JSON array into a multi-dimensional map or a flattened map. Unfortunately, your multi-dimensional map is going to get complicated really quickly.</p>\n\n<p>What I mean is, you often need to map at least a few dimensions (for example: map[string]map[string]map[string]string), when you've got a nested JSON array such as \"people\" above.</p>\n\n<p>If you tried to flatten a nested JSON array, your keys would end up overlapping (i.e. you can only use the \"name\" key once). You could tag the keys - something like \"name_1\" : \"Nick\", but this solution may not work for your use case.</p>\n\n<p>If you want to go the multi-dimensional route, this package may work well for your needs:\n<a href=\"http://github.com/Jeffail/gabs\" rel=\"nofollow noreferrer\">http://github.com/Jeffail/gabs</a></p>\n\n<p>I'll give you a tailored example, and then two examples from the link to gabs's github page:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/Jeffail/gabs\"\n)\n\nfunc main() {\n\n    jsonS := `{\n        \"people\": [\n            {\n                \"diffs\": [\n                    77\n                ],\n                \"original\": {\n                    \"name\": \"Nick\",\n                    \"active\": \"Active\",\n                    \"email\": \"nick@example.com\"\n                },\n                \"id\": \"21\"\n            }\n        ]\n    }`\n\n    gabsCon, err := gabs.ParseJSON([]byte(jsonS))\n\n    if err != nil {\n        fmt.Println(\"gabs ParseJSON failed\")\n    }\n\n    n1, ok := gabsCon.Path(\"people.original.name\").Data().(string)\n\n    if !ok {\n        fmt.Println(\"gabs path failed\")\n    }\n\n    fmt.Println(n1)\n}\n</code></pre>\n\n<p>Here's a non-tailored example, which would print - first, second, third):</p>\n\n<pre><code>jsonParsed, _ := gabs.ParseJSON([]byte(`{\"array\":[ \"first\", \"second\", \"third\" ]}`))\n\n// S is shorthand for Search\nchildren, _ := jsonParsed.S(\"array\").Children()\nfor _, child := range children {\n    fmt.Println(child.Data().(string))\n}\n</code></pre>\n\n<p>And, another example, which would print - 1, 2, 3:</p>\n\n<pre><code>jsonParsed, _ := gabs.ParseJSON([]byte(`{\"array\":[ {\"value\":1}, {\"value\":2}, {\"value\":3} ]}`))\n\nfmt.Println(jsonParsed.Path(\"array.value\").String())\n</code></pre>\n"}], "owner": {"reputation": 2449, "user_id": 4313927, "user_type": "registered", "accept_rate": 64, "profile_image": "https://graph.facebook.com/568720341/picture?type=large", "display_name": "Nicky Feller", "link": "https://stackoverflow.com/users/4313927/nicky-feller"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1807, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1509594071, "creation_date": 1501705556, "question_id": 45470368, "link": "https://stackoverflow.com/questions/45470368/convert-complex-json-to-map-in-golang", "title": "Convert complex JSON to map in Golang", "body": "<p>How can I convert a complex JSON object to a map with all the right types in golang. Do I absolutely have to do the typical Golang thing where I create a struct with the fields that I know will be present or is there a generalized way of getting the fields in all the right types?</p>\n\n<p>Here is an example of a JSON that I want to turn into a map:</p>\n\n<pre><code>{\n    \"people\": [\n        {\n            \"diffs\": [\n                77\n            ],\n            \"original\": {\n                \"name\": \"Nick\",\n                \"active\": \"Active\",\n                \"email\": \"nick@example.com\"\n            },\n            \"id\": \"21\"\n        }\n    ]\n}\n</code></pre>\n"}, {"tags": ["go", "go-templates"], "comments": [{"owner": {"reputation": 3040, "user_id": 3158312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gv23q.jpg?s=128&g=1", "display_name": "Albert221", "link": "https://stackoverflow.com/users/3158312/albert221"}, "edited": false, "score": 0, "creation_date": 1501702064, "post_id": 45469353, "comment_id": 77899696, "body": "what if you replace <code>index.gohtml</code> with <code>app&#47;templates&#47;index.gohtml</code>?"}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 3040, "user_id": 3158312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gv23q.jpg?s=128&g=1", "display_name": "Albert221", "link": "https://stackoverflow.com/users/3158312/albert221"}, "edited": false, "score": 0, "creation_date": 1501702148, "post_id": 45469353, "comment_id": 77899749, "body": "@Albert221 the same, at first I had in that way but I get the same"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501702428, "post_id": 45469353, "comment_id": 77899933, "body": "I&#39;ve only ever used <code>template.ParseFiles</code>, but it should work the same. If it is printing the html, then I guess it is parsing. Strange"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1501702909, "post_id": 45469353, "comment_id": 77900211, "body": "Are you using the route that <code>Index()</code> is registered as the handler for? You may just be serving the template file instead of executing the handler."}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "edited": false, "score": 1, "creation_date": 1501703742, "post_id": 45469353, "comment_id": 77900723, "body": "I added the header  &quot;Content-Type&quot;, &quot;text/html&quot; and now it&#39;s rendering pretty well. However, I don&#39;t think that it should be the solution. As I know, this is somethings that is infered by Go"}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501703778, "post_id": 45469353, "comment_id": 77900744, "body": "@Adrian I get your idea, but no, I am not serving the file"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501703930, "post_id": 45469353, "comment_id": 77900833, "body": "@SrednyMCasanova inferred from what? When you render a template, you&#39;re writing raw bytes to the response. It would have to parse the body to infer the type, which would be terrible for performance."}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501704308, "post_id": 45469353, "comment_id": 77901053, "body": "@Adrian ok, I just read this post <a href=\"https://stackoverflow.com/questions/25066071/golang-html-output-is-being-interpreted-as-plain-text-instead-of-being-received\">look at the answer that says:</a>  You actually don&#39;t need to do that (it&#39;s just helpful): Go and/or your browser will infer that for you."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1501704578, "post_id": 45469353, "comment_id": 77901187, "body": "They will do their best but won&#39;t necessarily be correct, and will be far, far less efficient and accurate trying to read and parse the content and guess the content type than if you just provide the correct content type since you already know it."}], "answers": [{"tags": [], "owner": {"reputation": 7537, "user_id": 4263818, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/AzSa2.jpg?s=128&g=1", "display_name": "R Menke", "link": "https://stackoverflow.com/users/4263818/r-menke"}, "is_accepted": false, "score": 0, "last_activity_date": 1501780991, "creation_date": 1501780991, "answer_id": 45490883, "question_id": 45469353, "link": "https://stackoverflow.com/questions/45469353/templates-in-golang-are-not-being-rendered/45490883#45490883", "title": "templates in golang are not being rendered", "body": "<p>checkout <a href=\"https://golang.org/src/net/http/sniff.go?s=645:687#L54\" rel=\"nofollow noreferrer\">net/http/sniff.go</a>. It shows how net/http infers MIME types. </p>\n\n<p>For Html your content can start with :</p>\n\n<ul>\n<li><code>&lt;!DOCTYPE HTML</code></li>\n<li><code>&lt;HTML</code></li>\n<li><code>&lt;HEAD</code></li>\n<li><code>&lt;SCRIPT</code></li>\n<li><code>&lt;IFRAME</code></li>\n<li><code>&lt;H1</code></li>\n<li><code>&lt;DIV</code></li>\n<li><code>&lt;FONT</code></li>\n<li><code>&lt;TABLE</code></li>\n<li><code>&lt;A</code></li>\n<li><code>&lt;STYLE</code></li>\n<li><code>&lt;TITLE</code></li>\n<li><code>&lt;B</code></li>\n<li><code>&lt;BODY</code></li>\n<li><code>&lt;BR</code></li>\n<li><code>&lt;P</code></li>\n<li><code>&lt;!--</code></li>\n</ul>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 574, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501780991, "creation_date": 1501701828, "question_id": 45469353, "link": "https://stackoverflow.com/questions/45469353/templates-in-golang-are-not-being-rendered", "title": "templates in golang are not being rendered", "body": "<p>I am working in a Golang project, currently am trying to render some templates but the HTML code of the template is being printed in the browser. My project structure is:</p>\n\n<pre><code>|-app\n|---models\n|---controller\n|---templates\n|------index.gohtml\n|-main.go\n</code></pre>\n\n<p>Then, the code that I have in one controller, to render the template is:</p>\n\n<pre><code>func Index(w http.ResponseWriter, req *http.Request, ps httprouter.Params){\n    var tpl *template.Template\n    tpl = template.Must(template.ParseGlob(\"app/templates/*.gohtml\"))\n\n    err := tpl.ExecuteTemplate(w, \"index.gohtml\", nil)\n\n    if(err!=nil){\n        fmt.Println(\"error:\",err.Error())\n    }\n</code></pre>\n\n<p>However I am not getting any error. But in the browser the code that I have inside <code>index.gohtml</code> is being printed and not rendered\n}</p>\n"}, {"tags": ["go", "gomobile"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501872790, "post_id": 45468778, "comment_id": 77988558, "body": "Where did you read that you need to patch Go Mobile? Which procedure did you follow? Please include <i>full</i> information."}], "answers": [{"tags": [], "owner": {"reputation": 1595, "user_id": 5276890, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/VfQC8.jpg?s=128&g=1", "display_name": "Roy Falk", "link": "https://stackoverflow.com/users/5276890/roy-falk"}, "is_accepted": false, "score": 0, "last_activity_date": 1511196952, "creation_date": 1511196952, "answer_id": 47397178, "question_id": 45468778, "link": "https://stackoverflow.com/questions/45468778/gomobile-bind-unsupported-basic-type-uint64/47397178#47397178", "title": "Gomobile bind: unsupported basic type: uint64", "body": "<p>I think the issue here is that Java does not have unsigned. Therefore interfaces to Java cannot have uint64 (and uint32 IIRC) file types as either global variables, function return values or function parameters.</p>\n\n<p><strong>You can use uint64 within Go mobile.</strong></p>\n\n<p>Two solutions based on the above:</p>\n\n<ol>\n<li>Limit the exposure of illegal types to Java to a minimum</li>\n<li>Convert uint64 to int64 in Go and convert from long to BigInteger in Java.</li>\n</ol>\n"}, {"comments": [{"owner": {"reputation": 170, "user_id": 2859891, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/aea1cbf521eb982eb9ab0c3b4db06b3b?s=128&d=identicon&r=PG&f=1", "display_name": "nicwhitts", "link": "https://stackoverflow.com/users/2859891/nicwhitts"}, "edited": false, "score": 0, "creation_date": 1516829194, "post_id": 48351700, "comment_id": 83854830, "body": "Hey, i did eventually patch this, i changed the gen.go file and I had to recompile by &quot;go install... &quot;"}], "tags": [], "owner": {"reputation": 598, "user_id": 3712278, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6106f4bafd6c8d71b9a6415a12909976?s=128&d=identicon&r=PG&f=1", "display_name": "Sidetalker", "link": "https://stackoverflow.com/users/3712278/sidetalker"}, "is_accepted": false, "score": 0, "last_activity_date": 1516411214, "creation_date": 1516411214, "answer_id": 48351700, "question_id": 45468778, "link": "https://stackoverflow.com/questions/45468778/gomobile-bind-unsupported-basic-type-uint64/48351700#48351700", "title": "Gomobile bind: unsupported basic type: uint64", "body": "<p>I solved this by patching Go mobile, inspired by this very StackOverflow post! I use \"patch\" very loosely, I don't encourage anyone to use this code as it is very purpose-specific. </p>\n\n<p>I simply short-circuited the <code>default</code> case to return <code>uint64</code> - you can see exactly what I did here: <a href=\"https://github.com/Sidetalker/mobile/commit/01eb11be69a781e71c7f00df6fc17b35f828f7a2\" rel=\"nofollow noreferrer\">https://github.com/Sidetalker/mobile/commit/01eb11be69a781e71c7f00df6fc17b35f828f7a2</a></p>\n\n<p>I needed to make a handful of other find/replace changes you can see on that branch to get it building properly, and I also had to fix what I'm pretty sure is a Go mobile bug with the <code>byte</code> type. All of this can be see on the branch.</p>\n\n<p>Also, critically, I had to fully <code>go get</code> this project - making my changes and running <code>gomobile init</code> was not sufficient.</p>\n\n<p>Don't use this code. Do mark this answered.</p>\n"}], "owner": {"reputation": 170, "user_id": 2859891, "user_type": "registered", "accept_rate": 37, "profile_image": "https://www.gravatar.com/avatar/aea1cbf521eb982eb9ab0c3b4db06b3b?s=128&d=identicon&r=PG&f=1", "display_name": "nicwhitts", "link": "https://stackoverflow.com/users/2859891/nicwhitts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 538, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1516411214, "creation_date": 1501699749, "question_id": 45468778, "link": "https://stackoverflow.com/questions/45468778/gomobile-bind-unsupported-basic-type-uint64", "title": "Gomobile bind: unsupported basic type: uint64", "body": "<p>The documentation says that it should be supported.\nIt seems that its not implemented in the gen.go file:</p>\n\n<pre><code>case types.Uint8: // types.Byte\n        return \"uint8_t\"\n    // TODO(crawshaw): case types.Uint, types.Uint16, types.Uint32, types.Uint64:\n</code></pre>\n\n<p>I read that i need to patch go mobile to support\nBut after changing the file to support Uint64, (go/src/golang.org/x/mobile/bind/gen.go)\nAnd re init go mobile: gomobile init</p>\n\n<p>The same error still appears, am i missing something obvious here?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501698376, "post_id": 45468253, "comment_id": 77897609, "body": "This is one of the reasons I just always prepend <code>&amp;</code> when I create structs. No weird headache cases like this arise. I&#39;ll create a struct value every now and again only if I&#39;m sure I want it on the stack."}, {"owner": {"reputation": 85, "user_id": 4130999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca1b6219c0b03ba1468722199b3c80b?s=128&d=identicon&r=PG&f=1", "display_name": "eblood", "link": "https://stackoverflow.com/users/4130999/eblood"}, "edited": false, "score": 0, "creation_date": 1501698434, "post_id": 45468253, "comment_id": 77897640, "body": "Ah, that makes sense.  Thanks!"}, {"owner": {"reputation": 3663, "user_id": 1659790, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/sS2uf.png?s=128&g=1", "display_name": "Jimmy T.", "link": "https://stackoverflow.com/users/1659790/jimmy-t"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1608933712, "post_id": 45468253, "comment_id": 115716241, "body": "@RayfenWindspear I think it&#39;s more reasonable to try to understand something and it&#39;s implications in different scenarios rather than just using a generic try to catch all solution because always using pointers also has its drawbacks, not only performance wise but logically"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 3663, "user_id": 1659790, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/sS2uf.png?s=128&g=1", "display_name": "Jimmy T.", "link": "https://stackoverflow.com/users/1659790/jimmy-t"}, "edited": false, "score": 0, "creation_date": 1609207658, "post_id": 45468253, "comment_id": 115777382, "body": "@jimmy-t Very true. I wrote that comment 3 years ago and have learned a lot since. The nuances and considerations you are referring to warrant a blog post sized response, which isn&#39;t appropriate for this type of question. But ultimately, no, I shouldn&#39;t have made a blanket statement like that. The only way to know is to understand the mechanics enough to make an educated decision. In short, Go is copy by value, so copying large structs without pointers isn&#39;t ideal, nor is allocating a million tiny throwaway structs on the heap using pointers that have to be garbage collected."}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 8, "last_activity_date": 1605329118, "last_edit_date": 1605329118, "creation_date": 1501697897, "answer_id": 45468253, "question_id": 45468089, "link": "https://stackoverflow.com/questions/45468089/slice-of-structs-vs-a-slice-of-pointers-to-structs/45468253#45468253", "title": "Slice of structs vs a slice of pointers to structs", "body": "<p>That's because when you use the pointers you are adding <code>&amp;w</code> to the array.</p>\n<p>Note that <code>w</code> is actually the local variable used in the loop, so that's not the address you want to add to the <code>matches</code> array.</p>\n<p>(even though the <em>value</em> of the variable <code>w</code> changes through the loop, its <em>address</em> stays the same)</p>\n<p>When the loop ends, <code>w</code> ends up with the last value so that's why it prints <code>12</code> two times.</p>\n<p>You need to add the address of the element that matched instead.</p>\n<p>If you do this:</p>\n<pre><code>matches = append(matches, &amp;widgets[i])\n</code></pre>\n<p>Then it'd work fine with pointers as well.</p>\n<p>Modified Go playground for you to test it:</p>\n<p><a href=\"https://play.golang.org/p/YE-cokyEHu\" rel=\"nofollow noreferrer\">https://play.golang.org/p/YE-cokyEHu</a></p>\n"}], "owner": {"reputation": 85, "user_id": 4130999, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ca1b6219c0b03ba1468722199b3c80b?s=128&d=identicon&r=PG&f=1", "display_name": "eblood", "link": "https://stackoverflow.com/users/4130999/eblood"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3294, "favorite_count": 0, "accepted_answer_id": 45468253, "answer_count": 1, "score": 4, "last_activity_date": 1605329118, "creation_date": 1501697322, "question_id": 45468089, "link": "https://stackoverflow.com/questions/45468089/slice-of-structs-vs-a-slice-of-pointers-to-structs", "title": "Slice of structs vs a slice of pointers to structs", "body": "<p>I don't understand the behavior of the following piece of <a href=\"https://play.golang.org/p/PF781SZX4U\" rel=\"nofollow noreferrer\">code</a>.  In creating a list of matching structs as a slice of struct pointers, the code always prints the last element of original array (which actually wasn't a match)\u2014it prints 12 and 12.  However, if I change matches to be []Widget instead of []*Widget, then it will print 10 and 11.</p>\n\n<p>Why is this?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n\n    type Widget struct {\n        id    int\n        attrs []string\n    }\n\n    widgets := []Widget{\n        Widget{\n            id:    10,\n            attrs: []string{\"blah\", \"foo\"},\n        },\n        Widget{\n            id:    11,\n            attrs: []string{\"foo\", \"bar\"},\n        },\n        Widget{\n            id:    12,\n            attrs: []string{\"xyz\"},\n        },\n    }\n\n    var matches []*Widget\n    for _, w := range widgets {\n        for _, a := range w.attrs {\n            if a == \"foo\" {\n                matches = append(matches, &amp;w)\n                break\n            }\n        }\n    }\n\n    for _, m := range matches {\n        fmt.Println(m.id)\n    }\n\n}\n</code></pre>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1501692625, "post_id": 45466614, "comment_id": 77894110, "body": "Return <code>container</code> from <code>appendStruct</code>."}, {"owner": {"reputation": 1006, "user_id": 4666785, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/YXCzR.png?s=128&g=1", "display_name": "elcomendante", "link": "https://stackoverflow.com/users/4666785/elcomendante"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501693035, "post_id": 45466614, "comment_id": 77894370, "body": "Could you hind the solution please? I am new to <code>golang</code>. I will have multiple <code>appendStruct</code> threads writing data to <code>container</code>, so it needs to be accessed when they are all completed."}], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1501693159, "creation_date": 1501693159, "answer_id": 45466847, "question_id": 45466614, "link": "https://stackoverflow.com/questions/45466614/accessing-struct-data-in-inner-scope-from-main-and-save-to-csv-in-golang/45466847#45466847", "title": "Accessing Struct Data in Inner Scope from main and save to csv in Golang", "body": "<p>In <code>appendStruct</code>, <code>container</code> is a local variable, so it's not accessible outside that function call. You could return it, which would make it accessible from the caller (in this case, <code>main</code>):</p>\n\n<pre><code>func appendStruct() DataContainer {\n    //...\n    return container\n}\n\nfunc main() {\n    container := appendStruct()\n}\n</code></pre>\n\n<p>The answer you linked is an excellent starting point. A code example shouldn't really be necessary - they're basically recommending that you create a helper method/function that takes all the fields of the struct and puts them into a slice in whatever order you want them to appear in the CSV, e.g.:</p>\n\n<pre><code>func (c DataItem) ToSlice() []string {\n    row := make([]string, 1, 1) // Since you only have 1 field in the struct\n    row[0] = c.name\n    return row\n}\n</code></pre>\n\n<p>Then you can loop over these to write them to a CSV file.</p>\n\n<p>The error output you're getting is because you're using <code>Sprintf</code>, which expects a format string as the first parameter with a reference for each other argument. You're passing an empty format string, which would only work with no other arguments (and be pointless). Perhaps you meant <code>Sprintf(\"%v\", container)</code> or just <code>Sprint(container)</code>?</p>\n"}, {"tags": [], "owner": {"reputation": 1006, "user_id": 4666785, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/YXCzR.png?s=128&g=1", "display_name": "elcomendante", "link": "https://stackoverflow.com/users/4666785/elcomendante"}, "is_accepted": false, "score": 0, "last_activity_date": 1501757384, "creation_date": 1501757384, "answer_id": 45482073, "question_id": 45466614, "link": "https://stackoverflow.com/questions/45466614/accessing-struct-data-in-inner-scope-from-main-and-save-to-csv-in-golang/45482073#45482073", "title": "Accessing Struct Data in Inner Scope from main and save to csv in Golang", "body": "<p>Thank you @Adrian, your answer was very helpful. Below is working code:</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n   \"os\"\n   \"encoding/csv\"\n   \"log\"\n)\n\ntype DataItem struct {\n     name string\n}\n\ntype DataContainer struct {\n     Items []DataItem\n}\n\nfunc (box *DataContainer) AddItem(item DataItem) []DataItem {\n     box.Items = append(box.Items, item)\n     return box.Items\n}\n\nfunc appendStruct() DataContainer{\n      items := []DataItem{}\n      container := DataContainer{items}\n\n      item1 := DataItem{name: fmt.Sprintf(\"Item1\")}\n      item2 := DataItem{name: fmt.Sprintf(\"Item2\")}\n\n       container.AddItem(item1)\n       container.AddItem(item2)\n\nreturn container\n}\n\n\nfunc (c DataItem) ToSlice() []string {\n     row := make([]string, 1, 1)\n     row[0] = c.name\n return row\n}\n\nfunc checkError(message string, err error) {\n    if err != nil {\n    log.Fatal(message, err)\n     }\n}\n\n\nfunc main() {\n\ncontainer := appendStruct()\n\nvar ss = fmt.Sprint(container)\nprintln(ss)\n\n\nfile, err := os.Create(\"result.csv\")\ncheckError(\"Cannot create file\", err)\ndefer file.Close()\n\nw := csv.NewWriter(file)\n\nfor _, record := range container.Items {\n    values := record.ToSlice()\n    if err := w.Write(values); err != nil {\n        log.Fatalln(\"error writing record to csv:\", err)\n    }\n}\n\nw.Flush()\n\nif err := w.Error(); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n"}], "owner": {"reputation": 1006, "user_id": 4666785, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/YXCzR.png?s=128&g=1", "display_name": "elcomendante", "link": "https://stackoverflow.com/users/4666785/elcomendante"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 204, "favorite_count": 0, "accepted_answer_id": 45466847, "answer_count": 2, "score": 0, "last_activity_date": 1501757384, "creation_date": 1501692409, "last_edit_date": 1501693203, "question_id": 45466614, "link": "https://stackoverflow.com/questions/45466614/accessing-struct-data-in-inner-scope-from-main-and-save-to-csv-in-golang", "title": "Accessing Struct Data in Inner Scope from main and save to csv in Golang", "body": "<p><code>appendStruct</code> function is designed to run in multiple threads in order to collect and append <code>DataItem</code> into <code>DataContainer</code>. So far I can print the result from inner <code>appendStruct</code> Q1: how to access and print <code>container</code> from <code>main</code>, Q2: save that struct data type to <code>csv</code> from <code>main</code> ?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype DataItem struct {\n    name string\n}\n\ntype DataContainer struct {\n    Items []DataItem\n}\n\nfunc (box *DataContainer) AddItem(item DataItem) []DataItem {\n    box.Items = append(box.Items, item)\n    return box.Items\n}\n\nfunc appendStruct() {\n    items := []DataItem{}\n    container := DataContainer{items}\n\n    item1 := DataItem{name: fmt.Sprintf(\"Item1\")}\n    item2 := DataItem{name: fmt.Sprintf(\"Item2\")}\n\n    container.AddItem(item1)\n    container.AddItem(item2)\n\n    var ss = fmt.Sprintf(\"\", container)\n    fmt.Println(ss)\n}\n\nfunc main() {\n\n    appendStruct()\n\n}\n</code></pre>\n\n<p>OUTPUT from <code>go run test.go</code> is: </p>\n\n<pre><code>%!(EXTRA main.DataContainer={[{Item1} {Item2}]})\n</code></pre>\n\n<p>re Q1. <code>\"encoding/csv\"</code> has to implement string interface <code>[][]string</code> there is a hint how to approach it in <a href=\"https://stackoverflow.com/questions/33357156/write-struct-to-csv-file\">Write struct to csv file\n</a> but lacks implementation example. </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501692008, "post_id": 45466440, "comment_id": 77893739, "body": "What information do you want? Can the functions return better errors? Can you use something like: <a href=\"https://godoc.org/github.com/pkg/errors\" rel=\"nofollow noreferrer\">godoc.org/github.com/pkg/errors</a>?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1501692249, "post_id": 45466440, "comment_id": 77893889, "body": "You can do whatever you want. error is an interface, so you can put any data you want into it."}, {"owner": {"reputation": 1509, "user_id": 1093694, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4hdHu.jpg?s=128&g=1", "display_name": "Lupus", "link": "https://stackoverflow.com/users/1093694/lupus"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501692539, "post_id": 45466440, "comment_id": 77894062, "body": "@JimB Anything that make same ease at debuging an error. I mean for example can I find the source file of function which returned not nil error. This could sounds like silly to you but if I can it could really helpful while debuging."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1501693307, "post_id": 45466440, "comment_id": 77894557, "body": "It sounds like the problem is more that the handler functions aren&#39;t returning sufficiently useful errors. If the handlers return good error messages, you shouldn&#39;t need to add much (if any) context to them."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501694218, "post_id": 45466440, "comment_id": 77895132, "body": "@Lupus: you can&#39;t tell the path that the error value has taken after execution, context has to be added at the error site."}, {"owner": {"reputation": 1509, "user_id": 1093694, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4hdHu.jpg?s=128&g=1", "display_name": "Lupus", "link": "https://stackoverflow.com/users/1093694/lupus"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501742627, "post_id": 45466440, "comment_id": 77913762, "body": "@Adrian The problem is I do not have full control on handler functions. This going to be a public API which handler functions are optional add-ons to main package. They are going to be located in third persons&#39; packages. I only place restrictions over interfaces and types. I can&#39;t force them to return useful errors."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501766919, "post_id": 45466440, "comment_id": 77931895, "body": "But it&#39;s in their own best interest to do so, if they want to be able to troubleshoot their own handlers."}], "answers": [{"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": true, "score": 1, "last_activity_date": 1501696613, "last_edit_date": 1501696613, "creation_date": 1501692188, "answer_id": 45466540, "question_id": 45466440, "link": "https://stackoverflow.com/questions/45466440/error-handling-of-executed-slice-of-functions-in-go/45466540#45466540", "title": "Error handling of executed slice of functions in Go", "body": "<p>Use a struct that contains the func and any metadata instead of just a func. Something like this.</p>\n\n<pre><code>type NewHandler struct {\n    Handler func(*indexer.Document) error\n    Data string // or whatever data\n}\n</code></pre>\n\n<p>Also make sure your slice holds pointers because go is pass-by-value.</p>\n\n<pre><code>var NewHandlers []*NewHandler\n</code></pre>\n\n<p>Then when you for loop, it goes like this.</p>\n\n<pre><code>for i, handler := range NewHandlers {\n        err = handler.Handler(document)\n        ....\n</code></pre>\n\n<p>And you can include your Data in the error.</p>\n"}], "owner": {"reputation": 1509, "user_id": 1093694, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/4hdHu.jpg?s=128&g=1", "display_name": "Lupus", "link": "https://stackoverflow.com/users/1093694/lupus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 331, "favorite_count": 0, "accepted_answer_id": 45466540, "answer_count": 1, "score": 0, "last_activity_date": 1501696613, "creation_date": 1501691861, "last_edit_date": 1501692091, "question_id": 45466440, "link": "https://stackoverflow.com/questions/45466440/error-handling-of-executed-slice-of-functions-in-go", "title": "Error handling of executed slice of functions in Go", "body": "<p>I must run an unknown number of functions in a for cycle and I want to create meaningful errors when something goes wrong (when error returns from one of them)</p>\n\n<p>Here some code:</p>\n\n<pre><code>package storage\n\nimport (\n    \"github.com/attilasatan/ankara/engine/indexer\"\n)\n\ntype NewHandler func(*indexer.Document) error\n\nvar NewHandlers []NewHandler\n\n\nfunc AppendNewHandler(handler NewHandler) {\n    NewHandlers = append(NewHandlers, handler)\n}\n\n\nfunc New(document *indexer.Document) (err error) {\n    for i, handler := range NewHandlers {\n        err = handler(document)\n        if err != nil {\n            err = errors.New(`New Handler error at index ` + string(i) + `\n            original: \n            ` + err.Error())\n            return\n        }\n    }\n    return\n}\n</code></pre>\n\n<p>This is my solution for error handling but i don't feel comfortable with it because I only return the index of the function that I executed. </p>\n\n<p>My question is. Can I collect more information about the function that returned not nil <code>error</code>.</p>\n\n<p>Also any kind of advises would be appreciated.</p>\n"}, {"tags": ["pdf", "go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501692121, "post_id": 45466430, "comment_id": 77893824, "body": "So your question is whether the docconv library has built-in file downloading? What did the documentation tell you?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501692406, "post_id": 45466430, "comment_id": 77893979, "body": "In the docs, <code>client.New()</code> says it &quot;Create a new client, using the default endpoint (localhost:8888)&quot;"}], "answers": [{"tags": [], "owner": {"reputation": 491, "user_id": 4699030, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-PtpXlAvuawc/AAAAAAAAAAI/AAAAAAAABgA/eeoUql28GSs/photo.jpg?sz=128", "display_name": "Juan Carlos Garcia", "link": "https://stackoverflow.com/users/4699030/juan-carlos-garcia"}, "is_accepted": false, "score": 0, "last_activity_date": 1501696671, "creation_date": 1501696671, "answer_id": 45467898, "question_id": 45466430, "link": "https://stackoverflow.com/questions/45466430/is-there-a-way-to-reach-pdf-files-over-the-network-with-docconv/45467898#45467898", "title": "Is there a way to reach .pdf files over the network with docconv?", "body": "<p>Checking the <a href=\"https://sourcegraph.com/github.com/sajari/docconv/-/blob/client/client.go\" rel=\"nofollow noreferrer\">code</a> of the client package seems like it is trying to comunicate with a remote docconv server. For your purpose, you have to download a the file in your local, and then use the library as you have been doing. <a href=\"https://stackoverflow.com/questions/33845770/how-do-i-download-a-file-with-a-http-request-in-go-language\">Here</a> you can see an example of how to download the file with an http client.</p>\n"}], "owner": {"reputation": 27, "user_id": 7712412, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-aekSYkwKKZQ/AAAAAAAAAAI/AAAAAAAAAA4/e95lvzcaPh8/photo.jpg?sz=128", "display_name": "Juan Carlos Le&#243;n", "link": "https://stackoverflow.com/users/7712412/juan-carlos-le%c3%b3n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 1, "score": -2, "last_activity_date": 1501696671, "creation_date": 1501691837, "last_edit_date": 1501691992, "question_id": 45466430, "link": "https://stackoverflow.com/questions/45466430/is-there-a-way-to-reach-pdf-files-over-the-network-with-docconv", "title": "Is there a way to reach .pdf files over the network with docconv?", "body": "<p>I'm starting to use Golang and I'm wondering if there is a way to get an online <em><strong>.pdf</strong></em> file and extract all the text that is inside it. At this moment I was making some tests with the library <a href=\"https://github.com/sajari/docconv\" rel=\"nofollow noreferrer\">docconv</a> and it works beautiful with local files but when I try to reach an online file I just can't get it, here is what I had tried</p>\n\n<p><strong>First Try</strong></p>\n\n<pre><code>package main\n\nimport(\n    \"fmt\"\n    \"github.com/sajari/docconv\"\n    \"github.com/sajari/docconv/client\"\n)\n\nfunc main(){\n    c := client.New()\n    res, err := client.ConvertPath(c, \"some online url\")        \n\n    if err != nil {\n        fmt.Println(err)\n        return nil\n    }\n\n    fmt.Println(res)\n}\n</code></pre>\n\n<p>I'm also look up to other libraries like <a href=\"https://github.com/yob/pdfreader\" rel=\"nofollow noreferrer\">yob/pdfreader</a> and <a href=\"https://github.com/rsc/pdf\" rel=\"nofollow noreferrer\">rsc/pdf</a> but still not working, and locally the best of that libraries is <strong>docconv</strong></p>\n\n<p>Any ideas or help to reach the goal is truly welcome.</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go", "reflection", "struct", "anonymous"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1501690692, "post_id": 45466015, "comment_id": 77892958, "body": "The type of <code>Timestamp</code> is <code>CustomTime</code>. Embedding is not inheritance."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 3, "creation_date": 1501691193, "post_id": 45466015, "comment_id": 77893241, "body": "What do you want to accomplish?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 3, "creation_date": 1501691665, "post_id": 45466015, "comment_id": 77893518, "body": "XY problem perhaps?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1501691751, "post_id": 45466015, "comment_id": 77893575, "body": "The question sounds very much like it, yes."}], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501691578, "post_id": 45466228, "comment_id": 77893457, "body": "There&#39;s the type cast I was looking for ;)"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 2, "creation_date": 1501691672, "post_id": 45466228, "comment_id": 77893525, "body": "As this is the right answer to the question I still wonder if the question is the right one..."}], "tags": [], "owner": {"reputation": 350, "user_id": 1480906, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/5f54b576c9d6c524b000b55114ac700b?s=128&d=identicon&r=PG", "display_name": "Andy McCall", "link": "https://stackoverflow.com/users/1480906/andy-mccall"}, "is_accepted": false, "score": 1, "last_activity_date": 1501691494, "last_edit_date": 1501691494, "creation_date": 1501691220, "answer_id": 45466228, "question_id": 45466015, "link": "https://stackoverflow.com/questions/45466015/find-underlying-anonymous-field-type-for-struct-in-go/45466228#45466228", "title": "Find underlying anonymous field type for struct in Go", "body": "<p>Here is a go playground example showing how you can access the anonymous field.</p>\n\n<p><a href=\"https://play.golang.org/p/yQULMVaQK0\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yQULMVaQK0</a></p>\n\n<p>Basically, once you have the value of the struct you should be able to get the Time value from field 0</p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user1529891"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 326, "favorite_count": 0, "answer_count": 1, "score": -4, "last_activity_date": 1501691494, "creation_date": 1501690557, "question_id": 45466015, "link": "https://stackoverflow.com/questions/45466015/find-underlying-anonymous-field-type-for-struct-in-go", "title": "Find underlying anonymous field type for struct in Go", "body": "<p>I have these two structs:</p>\n\n<pre><code>type CustomTime struct {\n    time.Time\n}\n\ntype Events struct {\n    Timestamp CustomTime\n}\n</code></pre>\n\n<p>When I <code>reflect</code> the field for <code>Events.Timestamp</code>, I get <code>CustomTime</code>; how can I get the actual underlying type which is <code>time.Time</code>?</p>\n"}, {"tags": ["go", "multidimensional-array", "slice"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1501688762, "post_id": 45465368, "comment_id": 77891632, "body": "You can eliminate the inner for loop using <a href=\"https://golang.org/pkg/builtin/#copy\" rel=\"nofollow noreferrer\">golang.org/pkg/builtin/#copy</a> but I&#39;m not sure if it is more efficient or not. I&#39;d guess that a builtin would be."}, {"owner": {"reputation": 131, "user_id": 3202994, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100000413030325/picture?type=large", "display_name": "Serghei Luchianenco", "link": "https://stackoverflow.com/users/3202994/serghei-luchianenco"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501689243, "post_id": 45465368, "comment_id": 77891977, "body": "thanks, working ;) at least less to write"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501689922, "post_id": 45465368, "comment_id": 77892452, "body": "I may benchmark it later too as I am curious to see how it compares."}, {"owner": {"reputation": 131, "user_id": 3202994, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100000413030325/picture?type=large", "display_name": "Serghei Luchianenco", "link": "https://stackoverflow.com/users/3202994/serghei-luchianenco"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501690380, "post_id": 45465368, "comment_id": 77892755, "body": "looking forward for your benchmark ;) would be nice if you can give me a hint how can I benchmark by myself...thanks"}], "answers": [{"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501691082, "post_id": 45465853, "comment_id": 77893182, "body": "Hah, if I&#39;d known I&#39;d get that much easy rep, I&#39;d have done a full answer myself. Kudos though because this really is a very good answer."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501691237, "post_id": 45465853, "comment_id": 77893266, "body": "BTW, a warning comment on using a single slice. If you happen to ever be modifying the <code>x</code> or <code>y</code> length of the matrix, it is a bad idea to try using a flat matrix."}, {"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "edited": false, "score": 0, "creation_date": 1501696393, "post_id": 45465853, "comment_id": 77896377, "body": "Good point, just fixed that by adding a cap. Still, it means that any of those slices can prevent the entire thing from being garbage collected. While that leads to less work for the collector, it can also lead to inaccessible data not being collected."}], "tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": true, "score": 14, "last_activity_date": 1501696283, "last_edit_date": 1501696283, "creation_date": 1501690019, "answer_id": 45465853, "question_id": 45465368, "link": "https://stackoverflow.com/questions/45465368/golang-multidimensional-slice-copy/45465853#45465853", "title": "Golang multidimensional slice copy", "body": "<p>You can use copy for the inner loop (which should be more efficient) and range for the outer loop (which results in nicer code).</p>\n\n<p>Result:</p>\n\n<pre><code>duplicate := make([][]int, len(matrix))\nfor i := range matrix {\n    duplicate[i] = make([]int, len(matrix[i]))\n    copy(duplicate[i], matrix[i])\n}\n</code></pre>\n\n<hr>\n\n<p>If your goal is efficiency, it may make sense to do more allocation up front. This doesn't lead to more readable code but will lead to more efficient code if you are doing this often. This code assumes you have at least one row and that all rows are of the same length. You will need to add tests for that.</p>\n\n<pre><code>n := len(matrix)\nm := len(matrix[0])\nduplicate := make([][]int, n)\ndata := make([]int, n*m)\nfor i := range matrix {\n    start := i*m\n    end := start + m\n    duplicate[i] = data[start:end:end]\n    copy(duplicate[i], matrix[i])\n}\n</code></pre>\n\n<p>Depending on what you are doing, it may make sense to make a \"matrix type\" that is implemented using only a single slice. A slice of slices is not the most efficient data structure, even if it is simpler to work with.</p>\n\n<hr>\n\n<p>Before deciding if you need to be efficient, make sure that you are spending a lot of time doing copying using profiling. Then, after you have determined this is in fact a hotspot, start running benchmarks. See <a href=\"https://golang.org/pkg/testing/#hdr-Benchmarks\" rel=\"noreferrer\">https://golang.org/pkg/testing/#hdr-Benchmarks</a> for details.</p>\n"}], "owner": {"reputation": 131, "user_id": 3202994, "user_type": "registered", "accept_rate": 40, "profile_image": "https://graph.facebook.com/100000413030325/picture?type=large", "display_name": "Serghei Luchianenco", "link": "https://stackoverflow.com/users/3202994/serghei-luchianenco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3886, "favorite_count": 2, "accepted_answer_id": 45465853, "answer_count": 1, "score": 5, "last_activity_date": 1586467031, "creation_date": 1501688653, "last_edit_date": 1586467031, "question_id": 45465368, "link": "https://stackoverflow.com/questions/45465368/golang-multidimensional-slice-copy", "title": "Golang multidimensional slice copy", "body": "<p>I was trying to make a clone of multidimensional slice, because when I have changed elements in the duplicated slice, the elements in the original one were overwritten also.</p>\n\n<p>The only method that worked for me was:</p>\n\n<pre><code>duplicate := make([][]int, len(matrix))\nfor i := 0; i &lt; len(matrix); i++ {\n    duplicate[i] = make([]int, len(matrix[0]))\n    for j := 0; j &lt; len(matrix[0]); j++ {\n        duplicate[i][j] = matrix[i][j]\n    }\n}\n</code></pre>\n\n<p>is there any other way - shorter or more efficient to achieve the same result? thanks</p>\n"}, {"tags": ["google-app-engine", "go"], "comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1501686058, "post_id": 45464021, "comment_id": 77889542, "body": "It works exactly the same way. I just have templates in a folder exactly like what you show. One verbatim is <code>templates&#47;users.html</code>. What have you tried, and what errors are you getting?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501686793, "post_id": 45464021, "comment_id": 77890111, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/9573644/go-appengine-how-to-structure-templates-for-application\">Go, AppEngine: How to structure templates for application</a>"}], "owner": {"reputation": 10027, "user_id": 95869, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/ce214a59fb5f2334169c43cbaab74326?s=128&d=identicon&r=PG", "display_name": "Wesley", "link": "https://stackoverflow.com/users/95869/wesley"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 366, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1501685072, "creation_date": 1501685072, "question_id": 45464021, "link": "https://stackoverflow.com/questions/45464021/how-do-i-use-html-templates-in-app-engine-standard-environment-for-go", "title": "How do I use HTML templates in App Engine standard environment for Go?", "body": "<p>I'd like to write an Go App Engine app that responds to a request by rendering a template. Outside of App Engine, the code might look like this:</p>\n\n<pre><code>var templates = template.Must(template.ParseFiles(\"templates/index.html\"))\n\nfunc index(w http.ResponseWriter, r *http.Request) {\n    data := ...\n    err := templates.ExecuteTemplate(w, \"index.html\", data)\n    if err != nil {\n        ...\n    }\n}\n</code></pre>\n\n<p><strong>What is the App Engine standard environment equivalent to the first line?</strong></p>\n\n<p>In the example linked from the App Engine standard environment docs, the template is included inline: <a href=\"https://github.com/GoogleCloudPlatform/appengine-guestbook-go/blob/part4-usingdatastore/hello.go#L56\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/appengine-guestbook-go/blob/part4-usingdatastore/hello.go#L56</a></p>\n\n<p>In an example I found elsewhere for the flexible environment, there is a templates directory like I'm familiar with: <a href=\"https://github.com/golang/appengine/tree/master/demos/guestbook\" rel=\"nofollow noreferrer\">https://github.com/golang/appengine/tree/master/demos/guestbook</a></p>\n\n<p>Is there a way to have templates exist outside of source files in go in the standard environment? Alternatively, is including the template inline (regardless of size) always the suggested approach in the standard environment?</p>\n"}, {"tags": ["go", "split"], "answers": [{"comments": [{"owner": {"reputation": 7265, "user_id": 3457177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bae2e85ed6794ece744ee124d9ac7842?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/3457177/vitalii"}, "edited": false, "score": 0, "creation_date": 1501668902, "post_id": 45457468, "comment_id": 77876056, "body": "I should complete my question &quot;nil or zero length slice&quot; If I run <code>strings.Split(&quot;&quot;, &quot;,&quot;)</code> the length is 1 <a href=\"https://play.golang.org/p/Kaddfg9CiF\" rel=\"nofollow noreferrer\">play.golang.org/p/Kaddfg9CiF</a>"}, {"owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "edited": false, "score": 1, "creation_date": 1501669775, "post_id": 45457468, "comment_id": 77876683, "body": "Output slice always has at least one element. It makes sense, even when you try to split empty string, function will return slice with one element - empty string."}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 3, "last_activity_date": 1501672198, "last_edit_date": 1501672198, "creation_date": 1501667657, "answer_id": 45457468, "question_id": 45457397, "link": "https://stackoverflow.com/questions/45457397/strings-split-never-returns-nil-or-zero-length-slice/45457468#45457468", "title": "strings.Split never returns nil or zero length slice?", "body": "<p>You are right: <code>strings.Spit()</code> will never return a nil value. The result will be of type <code>[]string</code> with at least one element containing the given string.</p>\n\n<p>Whether you can remove the if block depends: Does your code have a problem if <code>len(ips) &lt; 2</code>? If it does not you can safely remove the if block.</p>\n\n<p>If however e.g. you are only interested in <code>ips[1]</code> then you definitely need to check first.</p>\n"}], "owner": {"reputation": 7265, "user_id": 3457177, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/bae2e85ed6794ece744ee124d9ac7842?s=128&d=identicon&r=PG&f=1", "display_name": "Vitalii", "link": "https://stackoverflow.com/users/3457177/vitalii"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 594, "favorite_count": 0, "accepted_answer_id": 45457468, "answer_count": 1, "score": 0, "last_activity_date": 1501672198, "creation_date": 1501667445, "last_edit_date": 1501668954, "question_id": 45457397, "link": "https://stackoverflow.com/questions/45457397/strings-split-never-returns-nil-or-zero-length-slice", "title": "strings.Split never returns nil or zero length slice?", "body": "<p>Here is a piece of my code in Go </p>\n\n<pre><code>ips := strings.Split(IP, \",\")\nif len(ips) &lt; 1 {\n    return fmt.Errorf(\"'%v' ip is wrong\", ips)\n}\n</code></pre>\n\n<p>I tested this and it seems that <code>ips</code> variable can never be nil. For example, an empty string produces a slice of empty string (length 1). </p>\n\n<p>Do you think I can remove the <code>if</code> block?</p>\n"}, {"tags": ["xml", "go", "soap", "wsdl"], "answers": [{"comments": [{"owner": {"reputation": 1122, "user_id": 636300, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6a53dc5201ccdfdbfa6bd3c18ba701c6?s=128&d=identicon&r=PG", "display_name": "otezz", "link": "https://stackoverflow.com/users/636300/otezz"}, "edited": false, "score": 0, "creation_date": 1501667870, "post_id": 45456829, "comment_id": 77875295, "body": "It&#39;s works. Is there any explanation why I can omit <code>wsse:</code> part?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 1122, "user_id": 636300, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6a53dc5201ccdfdbfa6bd3c18ba701c6?s=128&d=identicon&r=PG", "display_name": "otezz", "link": "https://stackoverflow.com/users/636300/otezz"}, "edited": false, "score": 1, "creation_date": 1501677831, "post_id": 45456829, "comment_id": 77882645, "body": "@otezz: <code>wsse:</code> is a <a href=\"https://en.wikipedia.org/wiki/XML_namespace\" rel=\"nofollow noreferrer\">namespace prefix</a>, it&#39;s not part of the element name."}, {"owner": {"reputation": 1122, "user_id": 636300, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6a53dc5201ccdfdbfa6bd3c18ba701c6?s=128&d=identicon&r=PG", "display_name": "otezz", "link": "https://stackoverflow.com/users/636300/otezz"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501733166, "post_id": 45456829, "comment_id": 77909615, "body": "@JimB now I get it. Thanks."}], "tags": [], "owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "is_accepted": true, "score": 5, "last_activity_date": 1501666096, "creation_date": 1501666096, "answer_id": 45456829, "question_id": 45456344, "link": "https://stackoverflow.com/questions/45456344/parse-soap-in-go/45456829#45456829", "title": "Parse SOAP in Go", "body": "<p>Just use <code>xml:\"UsernameToken\"</code> instead of <code>xml:\"wsse:UsernameToken\"</code>, <code>xml:\"wsse:Security\"</code> -> <code>xml:\"Security\"</code>, etc.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/xml\"\n)\n\ntype Envelope struct {\n    XMLName xml.Name\n    Header  Header\n}\n\ntype Header struct {\n    XMLName  xml.Name `xml:\"Header\"`\n    Security Security `xml:\"Security\"`\n}\n\ntype Security struct {\n    XMLName        xml.Name `xml:\"Security\"`\n    MustUnderstand string `xml:\"mustUnderstand,attr\"`\n    WSSE           string `xml:\"wsse,attr\"`\n    SOAP           string `xml:\"soap,attr\"`\n    UsernameToken struct {\n        XMLName  xml.Name `xml:\"UsernameToken\"`\n        Username string `xml:\"Username\"`\n        Password string `xml:\"Password\"`\n    }\n}\n\nfunc main() {\n\n    Soap := []byte(`&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n\n  &lt;SOAP-ENV:Header xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n    &lt;wsse:Security soap:mustUnderstand=\"1\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n      &lt;wsse:UsernameToken&gt;\n        &lt;wsse:Username&gt;USERNAME&lt;/wsse:Username&gt;\n        &lt;wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\"&gt;SECRET&lt;/wsse:Password&gt;\n      &lt;/wsse:UsernameToken&gt;\n    &lt;/wsse:Security&gt;\n  &lt;/SOAP-ENV:Header&gt;\n\n  &lt;SOAP-ENV:Body xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n    &lt;OTA_HotelAvailNotifRQ xmlns=\"http://www.opentravel.org/OTA/2003/05\" EchoToken=\"abc123\" Version=\"1.0\" TimeStamp=\"2005-08-01T09:30:47+08:00\"&gt;\n      &lt;AvailStatusMessages HotelCode=\"HOTEL\"&gt;\n        &lt;AvailStatusMessage BookingLimit=\"10\"&gt;\n          &lt;StatusApplicationControl Start=\"2010-01-01\" End=\"2010-01-14\" InvTypeCode=\"A1K\" RatePlanCode=\"GLD\"/&gt;\n        &lt;/AvailStatusMessage&gt;\n      &lt;/AvailStatusMessages&gt;\n    &lt;/OTA_HotelAvailNotifRQ&gt;\n  &lt;/SOAP-ENV:Body&gt;\n\n&lt;/SOAP-ENV:Envelope&gt;`)\n\n    res := &amp;Envelope{}\n    err := xml.Unmarshal(Soap, res)\n\n    fmt.Println(res.Header.Security.UsernameToken.Username, err)\n}\n</code></pre>\n\n<p>Output: <code>USERNAME &lt;nil&gt;</code></p>\n"}, {"tags": [], "owner": {"reputation": 4897, "user_id": 1188357, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/cKQ6S.png?s=128&g=1", "display_name": "Kiril", "link": "https://stackoverflow.com/users/1188357/kiril"}, "is_accepted": false, "score": 0, "last_activity_date": 1501666524, "creation_date": 1501666524, "answer_id": 45457024, "question_id": 45456344, "link": "https://stackoverflow.com/questions/45456344/parse-soap-in-go/45457024#45457024", "title": "Parse SOAP in Go", "body": "<p>That seems like an XML problem. BayRinat's answer addresses this issue. Generally, you could try a SOAP library: <a href=\"https://golanglibs.com/top?q=soap\" rel=\"nofollow noreferrer\">https://golanglibs.com/top?q=soap</a></p>\n\n<p><a href=\"https://github.com/mfenniak/go-soap\" rel=\"nofollow noreferrer\">https://github.com/mfenniak/go-soap</a></p>\n\n<p><a href=\"https://github.com/justwatchcom/goat\" rel=\"nofollow noreferrer\">https://github.com/justwatchcom/goat</a></p>\n\n<p><a href=\"https://github.com/fiorix/wsdl2go\" rel=\"nofollow noreferrer\">https://github.com/fiorix/wsdl2go</a></p>\n"}], "owner": {"reputation": 1122, "user_id": 636300, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/6a53dc5201ccdfdbfa6bd3c18ba701c6?s=128&d=identicon&r=PG", "display_name": "otezz", "link": "https://stackoverflow.com/users/636300/otezz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1735, "favorite_count": 1, "accepted_answer_id": 45456829, "answer_count": 2, "score": 3, "last_activity_date": 1501666524, "creation_date": 1501664826, "question_id": 45456344, "link": "https://stackoverflow.com/questions/45456344/parse-soap-in-go", "title": "Parse SOAP in Go", "body": "<p>I just started learning Go. I want to parse a SOAP service. I have difficulty parsing the XML. Here's the XML:</p>\n\n<pre><code>&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n\n  &lt;SOAP-ENV:Header xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n    &lt;wsse:Security soap:mustUnderstand=\"1\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n      &lt;wsse:UsernameToken&gt;\n        &lt;wsse:Username&gt;USERNAME&lt;/wsse:Username&gt;\n        &lt;wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\"&gt;SECRET&lt;/wsse:Password&gt;\n      &lt;/wsse:UsernameToken&gt;\n    &lt;/wsse:Security&gt;\n  &lt;/SOAP-ENV:Header&gt;\n\n  &lt;SOAP-ENV:Body xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n    &lt;OTA_HotelAvailNotifRQ xmlns=\"http://www.opentravel.org/OTA/2003/05\" EchoToken=\"abc123\" Version=\"1.0\" TimeStamp=\"2005-08-01T09:30:47+08:00\"&gt;\n      &lt;AvailStatusMessages HotelCode=\"HOTEL\"&gt;\n        &lt;AvailStatusMessage BookingLimit=\"10\"&gt;\n          &lt;StatusApplicationControl Start=\"2010-01-01\" End=\"2010-01-14\" InvTypeCode=\"A1K\" RatePlanCode=\"GLD\"/&gt;\n        &lt;/AvailStatusMessage&gt;\n      &lt;/AvailStatusMessages&gt;\n    &lt;/OTA_HotelAvailNotifRQ&gt;\n  &lt;/SOAP-ENV:Body&gt;\n\n&lt;/SOAP-ENV:Envelope&gt;\n</code></pre>\n\n<p>And here's the code I write to parse the XML:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/xml\"\n)\n\ntype Envelope struct {\n    XMLName xml.Name\n    SOAPENV string   `xml:\"xmlns:SOAP-ENV,attr\"`\n    XSD     string   `xml:\"xmlns:xsd,attr\"`\n    XSI     string   `xml:\"xmlns:xsi,attr\"`\n    SOAPENC string   `xml:\"xmlns:SOAP-ENC,attr\"`\n    NS9132  string   `xml:\"xmlns:ns9132,attr\"`\n    Header  Header   `xml:\"SOAP-ENV:Header\"`\n}\n\ntype Header struct {\n    XMLName  xml.Name `xml:\"SOAP-ENV:Header\"`\n    Security Security `xml:\"wsse:Security\"`\n}\n\ntype Security struct {\n    XMLName        xml.Name `xml:\"wsse:Security\"`\n    MustUnderstand string `xml:\"soap:mustUnderstand,attr\"`\n    WSSE           string `xml:\"xmlns:wsse,attr\"`\n    SOAP           string `xml:\"xmlns:soap,attr\"`\n    UsernameToken struct {\n        XMLName  xml.Name `xml:\"wsse:UsernameToken\"`\n        Username string `xml:\"wsse:Username\"`\n        Password string `xml:\"wsse:Password\"`\n    }\n}\n\nfunc main() {\n\n    Soap := []byte(`&lt;SOAP-ENV:Envelope xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n\n  &lt;SOAP-ENV:Header xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n    &lt;wsse:Security soap:mustUnderstand=\"1\" xmlns:wsse=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n      &lt;wsse:UsernameToken&gt;\n        &lt;wsse:Username&gt;USERNAME&lt;/wsse:Username&gt;\n        &lt;wsse:Password Type=\"http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-username-token-profile-1.0#PasswordText\"&gt;SECRET&lt;/wsse:Password&gt;\n      &lt;/wsse:UsernameToken&gt;\n    &lt;/wsse:Security&gt;\n  &lt;/SOAP-ENV:Header&gt;\n\n  &lt;SOAP-ENV:Body xmlns:SOAP-ENV=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n    &lt;OTA_HotelAvailNotifRQ xmlns=\"http://www.opentravel.org/OTA/2003/05\" EchoToken=\"abc123\" Version=\"1.0\" TimeStamp=\"2005-08-01T09:30:47+08:00\"&gt;\n      &lt;AvailStatusMessages HotelCode=\"HOTEL\"&gt;\n        &lt;AvailStatusMessage BookingLimit=\"10\"&gt;\n          &lt;StatusApplicationControl Start=\"2010-01-01\" End=\"2010-01-14\" InvTypeCode=\"A1K\" RatePlanCode=\"GLD\"/&gt;\n        &lt;/AvailStatusMessage&gt;\n      &lt;/AvailStatusMessages&gt;\n    &lt;/OTA_HotelAvailNotifRQ&gt;\n  &lt;/SOAP-ENV:Body&gt;\n\n&lt;/SOAP-ENV:Envelope&gt;`)\n\n    res := &amp;Envelope{}\n    err := xml.Unmarshal(Soap, res)\n\n    fmt.Println(res.Header.Security.UsernameToken.Username, err)\n}\n</code></pre>\n\n<p>Why is it returns <code>nil</code>. I expect to get the username value from it. Also why can't I use <code>xml:\"SOAP-ENV:Envelope\"</code> for XMLName on Envelop struct? The error message is <code>expected element type &lt;SOAP-ENV:Envelope&gt; but have &lt;Envelope&gt;</code></p>\n\n<p>My Go version is 1.8.3</p>\n"}, {"tags": ["http", "go", "grpc", "protoc"], "answers": [{"comments": [{"owner": {"reputation": 341, "user_id": 3078262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f1c1d3fc4fdf55b6b13eae375b3a46da?s=128&d=identicon&r=PG", "display_name": "own3dh2so4", "link": "https://stackoverflow.com/users/3078262/own3dh2so4"}, "edited": false, "score": 2, "creation_date": 1501669549, "post_id": 45457928, "comment_id": 77876499, "body": "Thanks you, now it&#39;s working.  I would like to add as a comment that the codes to be used are not directly http (200, 300, 400 ...) if not the ones that come in grpc/codes package"}], "tags": [], "owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "is_accepted": true, "score": 5, "last_activity_date": 1501668762, "creation_date": 1501668762, "answer_id": 45457928, "question_id": 45455144, "link": "https://stackoverflow.com/questions/45455144/grpc-server-error-handler-golang/45457928#45457928", "title": "gRPC server error handler golang", "body": "<p>You need to return empty <code>model.Model</code> object in order for protobufs to be able to properly serialise the message.</p>\n\n<p>Try</p>\n\n<pre><code>import \"google.golang.org/grpc/status\"\n\nfunc (Abcd) Dosomethink(c context.Context, sessionRequest *model.MyModel) (*model.Model, error) {\n\n   return &amp;model.Model{}, status.New(400,\"Default error message for 400\")\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 444, "user_id": 7918749, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/r9BIg.jpg?s=128&g=1", "display_name": "Black_Dreams", "link": "https://stackoverflow.com/users/7918749/black-dreams"}, "is_accepted": false, "score": 7, "last_activity_date": 1548408237, "creation_date": 1548408237, "answer_id": 54362263, "question_id": 45455144, "link": "https://stackoverflow.com/questions/45455144/grpc-server-error-handler-golang/54362263#54362263", "title": "gRPC server error handler golang", "body": "<p>Error Handler:</p>\n\n<pre><code>\"google.golang.org/grpc/codes\"\n\"google.golang.org/grpc/status\"\n</code></pre>\n\n<pre><code>return data, status.Errorf(\n            codes.InvalidArgument,\n            fmt.Sprintf(\"Your message\", req.data),\n        )\n</code></pre>\n\n<p>For need more info about the error handling take a look below links.</p>\n\n<p><a href=\"https://grpc.io/docs/guides/error.html\" rel=\"noreferrer\">https://grpc.io/docs/guides/error.html</a></p>\n\n<p><a href=\"http://avi.im/grpc-errors/\" rel=\"noreferrer\">http://avi.im/grpc-errors/</a></p>\n"}], "owner": {"reputation": 341, "user_id": 3078262, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/f1c1d3fc4fdf55b6b13eae375b3a46da?s=128&d=identicon&r=PG", "display_name": "own3dh2so4", "link": "https://stackoverflow.com/users/3078262/own3dh2so4"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5974, "favorite_count": 2, "accepted_answer_id": 45457928, "answer_count": 2, "score": 7, "last_activity_date": 1548408237, "creation_date": 1501661595, "question_id": 45455144, "link": "https://stackoverflow.com/questions/45455144/grpc-server-error-handler-golang", "title": "gRPC server error handler golang", "body": "<p>I want know about good practices with golang and gRPC and protobuf.</p>\n\n<p>I am implementing the following gRPC service</p>\n\n<pre><code>service MyService {\n   rpc dosomethink(model.MyModel) returns (model.Model) {\n     option (google.api.http) = { post: \"/my/path\" body: \"\" };\n   }\n}\n</code></pre>\n\n<p>I compiled the protobufs. In fact, the protobuf give us a httpproxy from http to grpc. </p>\n\n<p>The code to implement this service:</p>\n\n<pre><code>import \"google.golang.org/grpc/status\"\n\nfunc (Abcd) Dosomethink(c context.Context, sessionRequest *model.MyModel) (*model.Model, error) {\n\n   return nil, status.New(400,\"Default error message for 400\")\n}\n</code></pre>\n\n<p>I want a 400 http error (in the http proxy) with the message \"Default error message for 400\", the message works, but the http error always is 500.</p>\n\n<p>Do you know any post or doc about this?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 420, "user_id": 4430124, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d6f7c5918cd8781ac56c628e152221ea?s=128&d=identicon&r=PG", "display_name": "schrej", "link": "https://stackoverflow.com/users/4430124/schrej"}, "edited": false, "score": 0, "creation_date": 1501660676, "post_id": 45453890, "comment_id": 77870176, "body": "Shouldn&#39;t it be <code>&amp;username</code> in the <code>rows.Scan()</code>?"}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1501776921, "post_id": 45453890, "comment_id": 77940273, "body": "I submitted an edit for that. Turns out I made 2k rep today so I could directly edit it now, but that effectively bumps it in the lists, so it wouldn&#39;t be productive."}], "answers": [{"comments": [{"owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1501661635, "post_id": 45455089, "comment_id": 77870828, "body": "Yet, it is better. But instead of just declare each variables for each fields you just suggest to create a struct. Is this the common way you use each time you scan rows?"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1501661767, "post_id": 45455089, "comment_id": 77870913, "body": "Yes I think so. You could try to generalise using reflect but then you kind of go around the type system of go -- making it slower and prone to errors."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "edited": false, "score": 0, "creation_date": 1501661956, "post_id": 45455089, "comment_id": 77871032, "body": "You can also have a look at <a href=\"http://jinzhu.me/gorm/\" rel=\"nofollow noreferrer\">gorm</a>. I have not used it but it seems to pup up everywhere. That way you avoid doing the database layer yourself."}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 2, "last_activity_date": 1501661418, "creation_date": 1501661418, "answer_id": 45455089, "question_id": 45453890, "link": "https://stackoverflow.com/questions/45453890/replace-variables-with-structs-queriing-with-golang/45455089#45455089", "title": "replace variables with structs queriing with golang", "body": "<p>You can do something like this:</p>\n\n<pre><code>type user struct {\n    Name  string\n    Pass  string\n    Email string\n    Age   int\n}\n\nfunc main() {\n    db, err := sql.Open(\"mysql\", \"pwd@tcp(ip:port)/db\")\n    if err != nil {\n        panic(err.Error())\n    }\n    rows, err := db.Query(\"select user, pass, email, age from users\")\n    if err != nil {\n        panic(err.Error())\n    }\n    var (\n        users []user\n    )\n    for rows.Next() {\n        u := user{}\n        err = rows.Scan(\n            &amp;u.Name, &amp;u.Pass, &amp;u.Email, &amp;u.Age,\n        )\n        if err != nil {\n            panic(err)\n        }\n\n        users = append(users, u)\n    }\n    fmt.Println(users)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 1, "last_activity_date": 1501666763, "last_edit_date": 1501666763, "creation_date": 1501666438, "answer_id": 45456986, "question_id": 45453890, "link": "https://stackoverflow.com/questions/45453890/replace-variables-with-structs-queriing-with-golang/45456986#45456986", "title": "replace variables with structs queriing with golang", "body": "<p>If you are willing to use a library, <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">https://github.com/jmoiron/sqlx</a> is perfect for the job.</p>\n\n<pre><code>place := Place{}\nrows, err := db.Queryx(\"SELECT * FROM place\")\nfor rows.Next() {\n    err := rows.StructScan(&amp;place)\n    if err != nil {\n        log.Fatalln(err)\n    } \n    fmt.Printf(\"%#v\\n\", place)\n}\n</code></pre>\n\n<p>There is some basic usage in the github readme <a href=\"https://github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">https://github.com/jmoiron/sqlx</a> as well as some \"standard\" documentation the maintainer has written <a href=\"http://jmoiron.github.io/sqlx/\" rel=\"nofollow noreferrer\">http://jmoiron.github.io/sqlx/</a> and finally, the godoc <a href=\"http://godoc.org/github.com/jmoiron/sqlx\" rel=\"nofollow noreferrer\">http://godoc.org/github.com/jmoiron/sqlx</a></p>\n\n<p>One thing to note, is that <code>sqlx</code> made the design choice similar to the way the go compiler forces you to use variables that you have created. So if you select a column that isn't in your struct, it throws an error. The reasons for this are sound and promote good <code>sql</code> practices. <code>Select *</code> when you only need one column is crazy expensive. See his notes here <a href=\"http://jmoiron.github.io/sqlx/#safety\" rel=\"nofollow noreferrer\">http://jmoiron.github.io/sqlx/#safety</a></p>\n"}], "owner": {"reputation": 15582, "user_id": 1420625, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/wJ6T0.png?s=128&g=1", "display_name": "sensorario", "link": "https://stackoverflow.com/users/1420625/sensorario"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 885, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501666763, "creation_date": 1501657881, "question_id": 45453890, "link": "https://stackoverflow.com/questions/45453890/replace-variables-with-structs-queriing-with-golang", "title": "replace variables with structs queriing with golang", "body": "<p>I've this snippet of code that works:</p>\n\n<pre><code>db, err := sql.Open(\"mysql\", \"pwd@tcp(ip:port)/db\")\nif err != nil {\n    panic(err.Error())\n}\nrows, err := db.Query(\"select username from users\")\nif err != nil {\n    panic(err.Error())\n}\nvar (\n    username string\n)\nfor rows.Next() {\n    err = rows.Scan(\n        &amp;name,\n    )\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(username)\n}\n</code></pre>\n\n<p>But, ... is it possible to substitute</p>\n\n<pre><code>var (\n    username string\n)\n</code></pre>\n\n<p>and \n    err = rows.Scan(\n        &amp;name,\n    )</p>\n\n<p>with a struct?</p>\n\n<p>I ask this because every time I want to add new field I need to</p>\n\n<ul>\n<li>add field inside the query</li>\n<li>create new variable in \"var\" block</li>\n<li>add variable to scan </li>\n</ul>\n\n<p>May I define a struct and update fields in just one place? Or, ... are there some best practice to build queries and fetch them?</p>\n"}, {"tags": ["go", "kubernetes", "ubuntu-16.04", "openid-connect"], "comments": [{"owner": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1501655699, "post_id": 45452729, "comment_id": 77867125, "body": "Is there a reason you asked <a href=\"https://stackoverflow.com/questions/45451539/go-get-not-installing-package-k8s-oidc-helper\">the same question twice</a>?"}, {"owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "reply_to_user": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1501656470, "post_id": 45452729, "comment_id": 77867585, "body": "Yes. I made this question more K8S specific unlike the previous one which i assume is some error happening due to <code>go</code>"}, {"owner": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1501656854, "post_id": 45452729, "comment_id": 77867793, "body": "Well, the text of this question says &quot;I have installed k8s-oidc-helper&quot;, so does that mean you are now able to execute <code>k8s-oidc-helper</code> and now have questions on how to use that command with kubernetes? Because the questions and answers on your other post make it seem as though you are unable to install <code>k8s-oidc-helper</code>"}, {"owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "reply_to_user": {"reputation": 22353, "user_id": 225016, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/77d3c3ab5ddcf93a8ca1bfe1b481be1c?s=128&d=identicon&r=PG", "display_name": "mdaniel", "link": "https://stackoverflow.com/users/225016/mdaniel"}, "edited": false, "score": 0, "creation_date": 1501657799, "post_id": 45452729, "comment_id": 77868405, "body": "@MatthewLDaniel i have restructured my question. I am not able to run any commands using k8s-oidc-helper package installed with go. As i am new to this, i am not even able to ascertain if its an error caused due to go or k8s package itself."}], "answers": [{"tags": [], "owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "is_accepted": true, "score": 0, "last_activity_date": 1501664063, "creation_date": 1501664063, "answer_id": 45456046, "question_id": 45452729, "link": "https://stackoverflow.com/questions/45452729/k8s-oidc-issues-with-helper-package-k8s-oidc-helper-command-not-found/45456046#45456046", "title": "k8s oidc issues with helper package (k8s-oidc-helper: command not found)", "body": "<p>I have resolved this issue. The path set was incorrect for `go'\nI checked the environment of go and accordingly set the path.</p>\n\n<pre><code>export GOPATH=/usr/lib/go\nexport PATH=$PATH:$GOPATH/bin\nsudo go get -u github.com/micahhausler/k8s-oidc-helper\n</code></pre>\n\n<p>now the helper package works</p>\n"}], "owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 222, "favorite_count": 0, "accepted_answer_id": 45456046, "answer_count": 1, "score": -2, "last_activity_date": 1501664063, "creation_date": 1501654245, "last_edit_date": 1501657690, "question_id": 45452729, "link": "https://stackoverflow.com/questions/45452729/k8s-oidc-issues-with-helper-package-k8s-oidc-helper-command-not-found", "title": "k8s oidc issues with helper package (k8s-oidc-helper: command not found)", "body": "<p>I am facing issues with k8s-oidc-helper package installed with go. However when i run any of the commands with it it gives command not found error. I am running this on ubuntu 16.04 VM. How can i resolve this?</p>\n"}, {"tags": ["go", "kubernetes", "openid-connect"], "answers": [{"comments": [{"owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "edited": false, "score": 0, "creation_date": 1501651573, "post_id": 45451737, "comment_id": 77865163, "body": "actually it is present under /usr/share/go/src/github.com/micahhausler/k8s-oidc-helper. Could you please help. There is no bin directory"}, {"owner": {"reputation": 435, "user_id": 7377118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-clIrEj4sYIs/AAAAAAAAAAI/AAAAAAAAAAo/NXvjTMs01BM/photo.jpg?sz=128", "display_name": "Razon Yang", "link": "https://stackoverflow.com/users/7377118/razon-yang"}, "reply_to_user": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "edited": false, "score": 0, "creation_date": 1501653296, "post_id": 45451737, "comment_id": 77865908, "body": "@NSP try <code>sudo -E go install github.com&#47;micahhausler&#47;k8s-oidc-helper</code>, and then <code>ls &#47;usr&#47;share&#47;go&#47;bin | grep k8s-oidc-helper</code>."}, {"owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "edited": false, "score": 0, "creation_date": 1501653401, "post_id": 45451737, "comment_id": 77865959, "body": "<code>sudo -E go install github.com&#47;micahhausler&#47;k8s-oidc-helper, can&#39;t load package: package github.com&#47;micahhausler&#47;k8s-oidc-helper,: cannot find package &quot;github.com&#47;micahhausler&#47;k8s-oidc-helper,&quot; in any of: \t&#47;usr&#47;lib&#47;go-1.6&#47;src&#47;github.com&#47;micahhausler&#47;k8s-oidc-helper&zwnj;&#8203;, (from $GOROOT) \t&#47;usr&#47;share&#47;go&#47;src&#47;github.com&#47;micahhausler&#47;k8s-oidc-helper, (from $GOPATH)</code>"}, {"owner": {"reputation": 435, "user_id": 7377118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-clIrEj4sYIs/AAAAAAAAAAI/AAAAAAAAAAo/NXvjTMs01BM/photo.jpg?sz=128", "display_name": "Razon Yang", "link": "https://stackoverflow.com/users/7377118/razon-yang"}, "reply_to_user": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "edited": false, "score": 0, "creation_date": 1501653860, "post_id": 45451737, "comment_id": 77866175, "body": "Um, I don&#39;t know how to fix it, I install this package correctly on my Linux desktop. You can take a try, remove this package: <code>sudo rm -rf $GOPATH&#47;src&#47;github.com&#47;micahhausler&#47;k8s-oidc-helper</code>, and then reinstall: <code>sudo -E go get -v github.com&#47;micahhausler&#47;k8s-oidc-helper</code>, <code>-v</code> means that it will print the install details."}, {"owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "edited": false, "score": 0, "creation_date": 1501654005, "post_id": 45451737, "comment_id": 77866233, "body": "Thanks but that didn&#39;t help :( -v only shows details of download. <code>sudo -E go get -v github.com&#47;micahhausler&#47;k8s-oidc-helper github.com&#47;micahhausler&#47;k8s-oidc-helper (download) github.com&#47;micahhausler&#47;k8s-oidc-helper </code>"}, {"owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "edited": false, "score": 0, "creation_date": 1501664217, "post_id": 45451737, "comment_id": 77872632, "body": "The issue was with the path. I set the path to /usr/lib/go and it worked. Thanks for you help"}], "tags": [], "owner": {"reputation": 435, "user_id": 7377118, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-clIrEj4sYIs/AAAAAAAAAAI/AAAAAAAAAAo/NXvjTMs01BM/photo.jpg?sz=128", "display_name": "Razon Yang", "link": "https://stackoverflow.com/users/7377118/razon-yang"}, "is_accepted": true, "score": 1, "last_activity_date": 1501649649, "creation_date": 1501649649, "answer_id": 45451737, "question_id": 45451539, "link": "https://stackoverflow.com/questions/45451539/go-get-not-installing-package-k8s-oidc-helper/45451737#45451737", "title": "go get not installing package k8s-oidc-helper", "body": "<p>Please make sure that the <code>k8s-oidc-helper</code> is exists in <code>/usr/share/go/bin</code>, and <code>/usr/share/go/bin</code> has been added into PATH environment variable.</p>\n\n<p>Check:</p>\n\n<pre><code>ls /usr/share/go/bin | grep k8s-oidc-helper\n\necho $PATH | grep /usr/share/go/bin\n</code></pre>\n"}], "owner": {"reputation": 943, "user_id": 6380294, "user_type": "registered", "accept_rate": 48, "profile_image": "https://www.gravatar.com/avatar/644e42c516a5ddb752f8235a36d8ddfb?s=128&d=identicon&r=PG&f=1", "display_name": "NSP", "link": "https://stackoverflow.com/users/6380294/nsp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 324, "favorite_count": 0, "accepted_answer_id": 45451737, "answer_count": 1, "score": -1, "last_activity_date": 1501656533, "creation_date": 1501648421, "last_edit_date": 1501656533, "question_id": 45451539, "link": "https://stackoverflow.com/questions/45451539/go-get-not-installing-package-k8s-oidc-helper", "title": "go get not installing package k8s-oidc-helper", "body": "<p>Unable to install package with go.\nI want to install the k8s-oidc-helper package. As per the install guide i had to install go and run the k8s-oidc-helper command. But when i try it, it says command k8s-oidc-helper not found. Below are the commands I tried</p>\n\n<pre><code>sudo apt install golang-go\nexport $GOPATH=/usr/share/go\nsudo -E go get github.com/micahhausler/k8s-oidc-helper\n</code></pre>\n\n<p>But after this if i try <strong><code>k8s-oidc-helper command it says error command not found.</code></strong>\nI assume it is some error with <code>go</code> package</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "edited": false, "score": 0, "creation_date": 1501649761, "post_id": 45451560, "comment_id": 77864482, "body": "Thanks, it worked.But why we need to add &amp; before array element as it represent poisition of memory only."}, {"owner": {"reputation": 207, "user_id": 8284461, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nmtfDD56sSE/AAAAAAAAAAI/AAAAAAAAAAk/ERWBZaVyw5U/photo.jpg?sz=128", "display_name": "azisuazusa", "link": "https://stackoverflow.com/users/8284461/azisuazusa"}, "reply_to_user": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "edited": false, "score": 0, "creation_date": 1501651859, "post_id": 45451560, "comment_id": 77865287, "body": "&#39;&amp;&#39; operator was used in the function to store the user inputted value in the address of arr <a href=\"https://stackoverflow.com/a/3440480/8284461\">stackoverflow.com/a/3440480/8284461</a>"}], "tags": [], "owner": {"reputation": 207, "user_id": 8284461, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-nmtfDD56sSE/AAAAAAAAAAI/AAAAAAAAAAk/ERWBZaVyw5U/photo.jpg?sz=128", "display_name": "azisuazusa", "link": "https://stackoverflow.com/users/8284461/azisuazusa"}, "is_accepted": true, "score": 4, "last_activity_date": 1501648553, "creation_date": 1501648553, "answer_id": 45451560, "question_id": 45451402, "link": "https://stackoverflow.com/questions/45451402/golang-array-input-not-working-as-expected/45451560#45451560", "title": "Golang array input not working as expected", "body": "<p>You should add '&amp;' before arr[i]</p>\n\n<pre><code>func main(){\n  var n int\n  fmt.Scanf(\"%d\", &amp;n)\n  var arr [200] int\n\n  for i := 0; i &lt; n; i++ {\n    fmt.Printf(\"\\nEnter %d:\", i)\n    fmt.Scanf(\"%d\", &amp;arr[i])\n  }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 5614, "user_id": 1177790, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/tjFKT.jpg?s=128&g=1", "display_name": "Paritosh Singh", "link": "https://stackoverflow.com/users/1177790/paritosh-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 190, "favorite_count": 0, "accepted_answer_id": 45451560, "answer_count": 1, "score": 1, "last_activity_date": 1501648553, "creation_date": 1501647504, "question_id": 45451402, "link": "https://stackoverflow.com/questions/45451402/golang-array-input-not-working-as-expected", "title": "Golang array input not working as expected", "body": "<p>I have a written a simple piece of code to read array in golang</p>\n\n<pre><code>func main(){\n  var n int\n  fmt.Scanf(\"%d\", &amp;n)\n  var arr [200] int\n\n  for i := 0; i &lt; n; i++ {\n    fmt.Printf(\"\\nEnter %d:\", i)\n    fmt.Scanf(\"%d\", arr[i])\n  }\n\n}\n</code></pre>\n\n<p>It is generating below output:</p>\n\n<pre><code>go run array_input.go \n5\n\nEnter 0:1\n\nEnter 1:\nEnter 2:2\n\nEnter 3:\nEnter 4:4\n</code></pre>\n\n<p>Here when I enter value for array location 0, it automatically jumps to array location 2 without taking any value for array location 1. I am not able to understand why it is happening.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["mongodb", "go", "ssh", "portforwarding", "mgo"], "comments": [{"owner": {"reputation": 11165, "user_id": 5619724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bxwzV.jpg?s=128&g=1", "display_name": "kevinadi", "link": "https://stackoverflow.com/users/5619724/kevinadi"}, "edited": false, "score": 0, "creation_date": 1501650946, "post_id": 45450931, "comment_id": 77864929, "body": "Why not use <code>scp</code> or <code>sftp</code> to transfer the <code>mongodump</code> files from the remote server to local directly?"}, {"owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "reply_to_user": {"reputation": 11165, "user_id": 5619724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bxwzV.jpg?s=128&g=1", "display_name": "kevinadi", "link": "https://stackoverflow.com/users/5619724/kevinadi"}, "edited": false, "score": 0, "creation_date": 1501652498, "post_id": 45450931, "comment_id": 77865538, "body": "I want to automate that process using go program. So my go prog, when installed, has to connect to the remote server and do the mongodump and bring it to the local machine and create a database here"}, {"owner": {"reputation": 11165, "user_id": 5619724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bxwzV.jpg?s=128&g=1", "display_name": "kevinadi", "link": "https://stackoverflow.com/users/5619724/kevinadi"}, "edited": false, "score": 0, "creation_date": 1501658106, "post_id": 45450931, "comment_id": 77868595, "body": "I&#39;m confused, let me try to get this straight. You wrote a go program that can connect to a remote MongoDB server using SSH tunnel. Now you want that same program to copy some collections to your local database and query the local database instead. Is this what you want?"}, {"owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "reply_to_user": {"reputation": 11165, "user_id": 5619724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bxwzV.jpg?s=128&g=1", "display_name": "kevinadi", "link": "https://stackoverflow.com/users/5619724/kevinadi"}, "edited": false, "score": 0, "creation_date": 1501686032, "post_id": 45450931, "comment_id": 77889514, "body": "@kevin yes,exactly"}, {"owner": {"reputation": 11165, "user_id": 5619724, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bxwzV.jpg?s=128&g=1", "display_name": "kevinadi", "link": "https://stackoverflow.com/users/5619724/kevinadi"}, "edited": false, "score": 0, "creation_date": 1501752957, "post_id": 45450931, "comment_id": 77921137, "body": "You would have to connect to the two MongoDB servers, query from the remote, and insert into the local. Drop the local databases first if required. Once the local database is populated, do further queries from the local database. Optionally disconnect from the remote database. However, as the answer below pointed out, this may not be the best thing to do, since your code is now doing two different things simultaneously, which could be hard to maintain. However if you&#39;re happy to maintain it, the method I described above <i>could</i> work."}], "answers": [{"comments": [{"owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1501712340, "post_id": 45470527, "comment_id": 77904822, "body": "what you are suggesting is creating the tunnel and doing mongodump MANUALLY. I am trying to automate that using golang so that if a user runs that golang code, it should get the job done and the user need not fire those commands.   To make it clear, how can I do what you suggested using golang ?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "edited": false, "score": 0, "creation_date": 1501741906, "post_id": 45470527, "comment_id": 77913336, "body": "As said: use those two lines of code. Add them to a shell script, if you must. If you really want to do it in Go, have a look at <a href=\"https://github.com/mongodb/mongo-tools/tree/master/mongodump\" rel=\"nofollow noreferrer\">the sources of <code>mongodump</code></a>. Quite complex, hence there is no simple answer to your question."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 2, "last_activity_date": 1501706138, "creation_date": 1501706138, "answer_id": 45470527, "question_id": 45450931, "link": "https://stackoverflow.com/questions/45450931/how-do-i-do-mongodump-on-a-server-and-transfer-that-to-my-local-machine-using-go/45470527#45470527", "title": "How do I do mongodump on a server and transfer that to my local machine using golang?", "body": "<p>You are reinventing the wheel. Use cron to create an ssh tunnel to the destination and then use a local mongodump to connect against your local tunnel endpoint</p>\n\n<pre><code>ssh -f user@mongodb.example.com -L 27017:mongodb.example.com:27017 -N\nmongodump localhost:27017 &lt;your opts here&gt;\n</code></pre>\n"}], "owner": {"reputation": 155, "user_id": 1851006, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/ef2638964d83d7357ab3d089b409279d?s=128&d=identicon&r=PG", "display_name": "user1851006", "link": "https://stackoverflow.com/users/1851006/user1851006"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1065, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501706138, "creation_date": 1501644296, "question_id": 45450931, "link": "https://stackoverflow.com/questions/45450931/how-do-i-do-mongodump-on-a-server-and-transfer-that-to-my-local-machine-using-go", "title": "How do I do mongodump on a server and transfer that to my local machine using golang?", "body": "<p>I wrote a go program ( which is basically the code in this example, <a href=\"https://stackoverflow.com/questions/21417223/simple-ssh-port-forward-in-golang\">Simple SSH port forward in Golang</a> )  that connects to a remote  mongodb server by creating an ssh tunnel. I can query the server using mgo api. Now, instead of querying the server everytime, I want to copy a few collections of the database to my local machine and query locally. It is important to note that I cannot copy it directly to my local machine as there is port forwarding involved. How can I achieve this ?</p>\n"}, {"tags": ["go", "undefined"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1501644262, "post_id": 45450569, "comment_id": 77862840, "body": "Perhaps you the version of the package on your workstation is before <a href=\"https://github.com/google/gopacket/commit/454403b95996efc4a90560627766832b8f1de151\" rel=\"nofollow noreferrer\">this commit</a>.  Run <code>go get -u github.com&#47;google&#47;gopacket&#47;pcap</code> and see if it fixes the problem."}, {"owner": {"reputation": 901, "user_id": 216212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d97f111919acb6094edf9cf8b9f231a3?s=128&d=identicon&r=PG", "display_name": "Arthur Corenzan", "link": "https://stackoverflow.com/users/216212/arthur-corenzan"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1501644457, "post_id": 45450569, "comment_id": 77862893, "body": "@CeriseLim&#243;n I just installed go and the package on this machine, so I doubt it&#39;s the case. But hey, I appreciate your observation, thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 901, "user_id": 216212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d97f111919acb6094edf9cf8b9f231a3?s=128&d=identicon&r=PG", "display_name": "Arthur Corenzan", "link": "https://stackoverflow.com/users/216212/arthur-corenzan"}, "is_accepted": true, "score": 0, "last_activity_date": 1501644785, "creation_date": 1501644785, "answer_id": 45450994, "question_id": 45450569, "link": "https://stackoverflow.com/questions/45450569/go-reports-undefined-for-external-package-exported-constant/45450994#45450994", "title": "Go reports &quot;undefined&quot; for external package exported constant", "body": "<p>It seems I was missing <code>libpcap-dev</code>. Now why Go or the package didn't throw a proper error message is beyond me.</p>\n"}], "owner": {"reputation": 901, "user_id": 216212, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/d97f111919acb6094edf9cf8b9f231a3?s=128&d=identicon&r=PG", "display_name": "Arthur Corenzan", "link": "https://stackoverflow.com/users/216212/arthur-corenzan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 100, "favorite_count": 0, "accepted_answer_id": 45450994, "answer_count": 1, "score": 0, "last_activity_date": 1501645644, "creation_date": 1501641458, "last_edit_date": 1501645644, "question_id": 45450569, "link": "https://stackoverflow.com/questions/45450569/go-reports-undefined-for-external-package-exported-constant", "title": "Go reports &quot;undefined&quot; for external package exported constant", "body": "<p>Here's the code:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"github.com/google/gopacket\"\n    \"github.com/google/gopacket/pcap\"\n)\n\nfunc main() {\n    log.Print(gopacket.MaxEndpointSize)\n    log.Print(pcap.MaxBpfInstructions)\n}\n</code></pre>\n\n<p>When I run <code>go build</code> I get this:</p>\n\n<pre><code>./main.go:11: undefined: pcap.MaxBpfInstructions\n</code></pre>\n\n<p>But you can see <code>MaxBpfInstructions</code> right here: <a href=\"https://godoc.org/github.com/google/gopacket/pcap#pkg-constants\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/google/gopacket/pcap#pkg-constants</a></p>\n\n<p>I feel this must be a stupid mistake, but I can't find it. Help?</p>\n"}, {"tags": ["elasticsearch", "go", "elasticsearch-plugin", "elasticsearch-query"], "comments": [{"owner": {"reputation": 2070, "user_id": 378704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5318a95a23ff8a67c0edc171412c83a?s=128&d=identicon&r=PG", "display_name": "kiran.koduru", "link": "https://stackoverflow.com/users/378704/kiran-koduru"}, "edited": false, "score": 0, "creation_date": 1501636870, "post_id": 45448787, "comment_id": 77861097, "body": "Are you sure returning <code>nil</code> for for condition <code>err != nil</code> is a good idea? I think there might be errors you can&#39;t see. You could use <code>panic(err)</code> to print the stack trace."}], "answers": [{"comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1502272241, "post_id": 45456160, "comment_id": 78133176, "body": "Was this helpful or are you stuck on something else?"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1501664383, "creation_date": 1501664383, "answer_id": 45456160, "question_id": 45448787, "link": "https://stackoverflow.com/questions/45448787/how-to-construct-elasticsearch-query-with-go/45456160#45456160", "title": "How to construct Elasticsearch query with Go?", "body": "<p>Your go script is just fine and it works. The problem is with the query itself. This is what you are executing against elasticsearch. Try it directly against elasticsearch (via Sense, Kibana or similar tool) and check if it returns what you expect:</p>\n\n<pre><code>POST someIndex/node/_search\n{\n    \"query\": {\n        \"term\": {\n           \"hash\": \"hashedID\"\n        }\n    }\n}\n</code></pre>\n\n<h3>Solution:</h3>\n\n<p>I suspect that hash is of type <code>text</code> (using elasticsearch 5). Then you need to query for <code>hash.keyword</code> on a term query instead.</p>\n"}], "owner": {"reputation": 1811, "user_id": 3004041, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/e9c675dd9408721a8e8e1106774a9d11?s=128&d=identicon&r=PG&f=1", "display_name": "covfefe", "link": "https://stackoverflow.com/users/3004041/covfefe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 570, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501664383, "creation_date": 1501627659, "last_edit_date": 1501631936, "question_id": 45448787, "link": "https://stackoverflow.com/questions/45448787/how-to-construct-elasticsearch-query-with-go", "title": "How to construct Elasticsearch query with Go?", "body": "<p>I'm using olivere's Elasticsearch library for Go - <a href=\"https://github.com/olivere/elastic\" rel=\"nofollow noreferrer\">https://github.com/olivere/elastic</a></p>\n\n<p>I'm not able to properly construct the search query, it keeps returning 0 hits.</p>\n\n<pre><code>termQuery := elasticClient.NewTermQuery(\"hash\", \"hashedID\")\nfmt.Println(termQuery)\nsearchResult, err := qs.client.Search().Index(\"someIndex\").\n    Type(\"node\").\n    Query(termQuery).\n    Pretty(true).\n    Do(ctx)\nif err != nil {\n    return nil\n}\n</code></pre>\n\n<p><code>searchResult.Hits.TotalHits</code> gives 0 hits even though there is data. \nThe data is in an Elasticsearch server running on my local machine which I can see if I run a REST API call:</p>\n\n<pre><code>{\n   \"_index\": \"someIndex\",\n   \"_type\": \"node\",\n   \"_id\": \"hashedID\",\n   \"_score\": 1,\n   \"_source\": {\n   \"node\": \"test\",\n   \"hash\": \"hashedID\",\n   \"active\": true\n}\n</code></pre>\n\n<p>How can I fix my Search query?</p>\n"}, {"tags": ["asynchronous", "go", "tcp", "polling", "gob"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501621589, "post_id": 45447643, "comment_id": 77856497, "body": "Redialing for every message is almost certainly the least efficient option. I&#39;m not sure what you mean &quot;it&#39;s still doing a whole lot of checking for new data with the Decode(p) call&quot; - it will read until it gets a whole object, then return. It&#39;s not repeatedly polling or anything."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501621721, "post_id": 45447643, "comment_id": 77856557, "body": "As far as your two options - (1) all read calls block without using CPU, and (2) not sure what you mean &quot;I could not find that&quot;, you&#39;d have to write your code as you described."}, {"owner": {"reputation": 773, "user_id": 2593312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c4c902ffb259359ad607fc4497297c04?s=128&d=identicon&r=PG", "display_name": "Rick Giuly", "link": "https://stackoverflow.com/users/2593312/rick-giuly"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501629346, "post_id": 45447643, "comment_id": 77859223, "body": "Sorry posted wrong code, now it should demonstrate the problem. Note that the connection is just open forever and it&#39;s waiting for objects to arrive. When there&#39;s nothing available, the err results tells me. When something is available, then it gets read. However it&#39;s always checking over and over to see if something is available."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501629793, "post_id": 45447643, "comment_id": 77859336, "body": "What is the measured performance of your code? Have you actually observed a problem, or are you trying to solve a hypothetical?"}], "answers": [{"comments": [{"owner": {"reputation": 773, "user_id": 2593312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c4c902ffb259359ad607fc4497297c04?s=128&d=identicon&r=PG", "display_name": "Rick Giuly", "link": "https://stackoverflow.com/users/2593312/rick-giuly"}, "edited": false, "score": 0, "creation_date": 1501629577, "post_id": 45447707, "comment_id": 77859282, "body": "Sorry posted wrong code. Now it should demonstrate the issue. I can&#39;t just break out when an object is received because I want the connection to stay open. So what I&#39;m doing (with updated code to what I meant to post) is running Decode a lot to check if there&#39;s another object ready to read. Decode doesn&#39;t really block. It just returns an EOF if there&#39;s nothing new ready to read."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 773, "user_id": 2593312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c4c902ffb259359ad607fc4497297c04?s=128&d=identicon&r=PG", "display_name": "Rick Giuly", "link": "https://stackoverflow.com/users/2593312/rick-giuly"}, "edited": false, "score": 0, "creation_date": 1501634109, "post_id": 45447707, "comment_id": 77860467, "body": "How long does it take to return EOF? Do you ever get valid data after that? EOF usually means the connection closed."}, {"owner": {"reputation": 773, "user_id": 2593312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c4c902ffb259359ad607fc4497297c04?s=128&d=identicon&r=PG", "display_name": "Rick Giuly", "link": "https://stackoverflow.com/users/2593312/rick-giuly"}, "edited": false, "score": 0, "creation_date": 1501634958, "post_id": 45447707, "comment_id": 77860654, "body": "Actually it looks like Decode does in fact block. I must have had a brain fart at some point and accidentally closed the connection after sending each object or something. This explains everything. Should be fine now."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 0, "last_activity_date": 1501621890, "last_edit_date": 1501621890, "creation_date": 1501621557, "answer_id": 45447707, "question_id": 45447643, "link": "https://stackoverflow.com/questions/45447643/how-to-efficiently-decode-gobs-and-wait-for-more-to-arrive-via-tcp-connection/45447707#45447707", "title": "How to efficiently decode gobs and wait for more to arrive via tcp connection", "body": "<p>You say:</p>\n\n<blockquote>\n  <p>So I came up with code below, but it's still doing a whole lot of checking for new data with the Decode(p) call.</p>\n</blockquote>\n\n<p>Why do you think that? The gob decoder will issue a <code>Read</code> to the conn and wait for it to return data before figuring out what it is and decoding it. This is a blocking operation, and will be handled asynchronously by the runtime behind the scenes. The goroutine will sleep until the appropriate io signal comes in. You should not have to do anything fancy to make that more performant.</p>\n\n<p>You can trace this yourself in the code for <a href=\"https://github.com/golang/go/blob/19f73a786bbded4c0e6bd5c6a640320b532d0b87/src/encoding/gob/decoder.go#L178\" rel=\"nofollow noreferrer\"><code>decoder.Decode</code></a>.</p>\n\n<p>I think your code will work just fine. CPU will be idle until it receives more data.</p>\n\n<p>Go is not node. Every api is \"blocking\" for the most part, but that is not as much as a problem as in other platforms. The runtime manages goroutines very efficiently and delegates appropriate signals to sleeping goroutines as needed.</p>\n"}], "owner": {"reputation": 773, "user_id": 2593312, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/c4c902ffb259359ad607fc4497297c04?s=128&d=identicon&r=PG", "display_name": "Rick Giuly", "link": "https://stackoverflow.com/users/2593312/rick-giuly"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 323, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1501629717, "creation_date": 1501621270, "last_edit_date": 1501629717, "question_id": 45447643, "link": "https://stackoverflow.com/questions/45447643/how-to-efficiently-decode-gobs-and-wait-for-more-to-arrive-via-tcp-connection", "title": "How to efficiently decode gobs and wait for more to arrive via tcp connection", "body": "<p>I'd like to have a TCP connection for a gaming application. It's important to be time efficient. I want to receive many objects efficiently. It's also important to be CPU efficient because of the load.</p>\n\n<p>So far, I can make sure handleConnection is called every time a connection is dialed using go's net library. However once the connection is created, I have to poll (check over and over again to see if new data is ready on the connection). This seems inefficient. I don't want to run that check to see if new data is ready if it's needlessly sucking up CPU. </p>\n\n<p>I was looking for something such as the following two options but didn't find what I was looking for.</p>\n\n<p>(1) Do a read operation that somehow blocks (without sucking CPU) and then unblocks when new stuff is ready on the connection stream. I could not find that.</p>\n\n<p>(2) Do an async approach where a function is called when new data arrives on the connection stream (not just when a new connection is dialed). I could not find that.</p>\n\n<p>I don't want to put any sleep calls in here because that will increase the latency of responding to singles messages.</p>\n\n<p>I also considered dialing out for every single message, but I'm not sure if that's efficient or not.</p>\n\n<p>So I came up with code below, but it's still doing a whole lot of checking for new data with the Decode(p) call, which does not seem optimal.</p>\n\n<p>How can I do this more efficiently?</p>\n\n<pre><code>func handleConnection(conn net.Conn) {\n        dec := gob.NewDecoder(conn)\n        p := &amp;P{}\n\n        for {\n                result := dec.Decode(p)\n                if result != nil {\n                        // do nothing\n                } else {\n                        fmt.Printf(\"Received : %+v\", p)\n                        fmt.Println(\"result\", result, \"\\n\")\n                }\n\n        }\n\n        conn.Close()\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "type-conversion", "go-reflect"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1501621232, "post_id": 45447571, "comment_id": 77856343, "body": "This may be an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a> - what are you actually trying to achieve?"}, {"owner": {"reputation": 69, "user_id": 3994010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16509cdc752dc609b8b5e4c6cae4a6e9?s=128&d=identicon&r=PG", "display_name": "Mehrdad Dadkhah", "link": "https://stackoverflow.com/users/3994010/mehrdad-dadkhah"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501660124, "post_id": 45447571, "comment_id": 77869821, "body": "No I think it&#39;s not. I update my question to explain my use case and my actually target @Adrian"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501675041, "post_id": 45447571, "comment_id": 77880397, "body": "What are you going to do with it once you get it out of gorm? A slice you can&#39;t reference is still useless."}, {"owner": {"reputation": 69, "user_id": 3994010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16509cdc752dc609b8b5e4c6cae4a6e9?s=128&d=identicon&r=PG", "display_name": "Mehrdad Dadkhah", "link": "https://stackoverflow.com/users/3994010/mehrdad-dadkhah"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501675367, "post_id": 45447571, "comment_id": 77880657, "body": "I convert it to map and return to use it ..."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501675676, "post_id": 45447571, "comment_id": 77880902, "body": "It doesn&#39;t matter if it&#39;s a map or a slice, if you can&#39;t reference a meaningful type you can&#39;t do much useful with it without doing a ton of reflection."}, {"owner": {"reputation": 69, "user_id": 3994010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16509cdc752dc609b8b5e4c6cae4a6e9?s=128&d=identicon&r=PG", "display_name": "Mehrdad Dadkhah", "link": "https://stackoverflow.com/users/3994010/mehrdad-dadkhah"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501676930, "post_id": 45447571, "comment_id": 77881899, "body": "Yes, you&#39;r right. I should change my design."}], "answers": [{"comments": [{"owner": {"reputation": 69, "user_id": 3994010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16509cdc752dc609b8b5e4c6cae4a6e9?s=128&d=identicon&r=PG", "display_name": "Mehrdad Dadkhah", "link": "https://stackoverflow.com/users/3994010/mehrdad-dadkhah"}, "edited": false, "score": 0, "creation_date": 1501659252, "post_id": 45447627, "comment_id": 77869275, "body": "Thank you @Adrian I had already tried all of them! and as you said with no good result. I think should describe my use case and discuss about new approach."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": true, "score": 2, "last_activity_date": 1501621213, "creation_date": 1501621213, "answer_id": 45447627, "question_id": 45447571, "link": "https://stackoverflow.com/questions/45447571/make-slice-of-a-struct-with-a-variable-of-it/45447627#45447627", "title": "Make slice of a struct with a variable of it", "body": "<p>You can do this using <a href=\"https://golang.org/pkg/reflect/\" rel=\"nofollow noreferrer\">reflection</a>, in particular <code>TypeOf</code>, <code>SliceOf</code>, and <code>MakeSlice</code>, <em>however</em>, it won't be very useful because you can only get a reference to it as an <code>interface{}</code>, which you can't use like a slice. Alternatively, you could assign it to a slice of type <code>[]interface{}</code>, which would let you work with the slice, but again, without being able to reference the underlying type, you can't really do anything with the values. You might need to reconsider your design.</p>\n"}, {"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501621651, "post_id": 45447670, "comment_id": 77856526, "body": "Question states &quot;I have not access to Product struct&quot;, which I believe means they can&#39;t reference it - i.e. they cannot just create a <code>[]Product</code>. But maybe the asker can explain."}, {"owner": {"reputation": 69, "user_id": 3994010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16509cdc752dc609b8b5e4c6cae4a6e9?s=128&d=identicon&r=PG", "display_name": "Mehrdad Dadkhah", "link": "https://stackoverflow.com/users/3994010/mehrdad-dadkhah"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501658961, "post_id": 45447670, "comment_id": 77869101, "body": "@eXMooR @Adrian  Yes, I have no straight access to Product type so I can&#39;t use:  ``` test2 := []Product{} ```"}], "tags": [], "owner": {"reputation": 30, "user_id": 8030922, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fe8da6a6052a17cbafd927946a9cb6e1?s=128&d=identicon&r=PG&f=1", "display_name": "eXMooR", "link": "https://stackoverflow.com/users/8030922/exmoor"}, "is_accepted": false, "score": 0, "last_activity_date": 1501621392, "creation_date": 1501621392, "answer_id": 45447670, "question_id": 45447571, "link": "https://stackoverflow.com/questions/45447571/make-slice-of-a-struct-with-a-variable-of-it/45447670#45447670", "title": "Make slice of a struct with a variable of it", "body": "<p>You want slice of Product with test1 element?</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Product struct{\n    Price float64\n}\n\nfunc main() {\n   test1 := Product{Price: 1.00}\n\n   test2 := []Product{test1}\n   fmt.Println(test2)\n}\n</code></pre>\n"}], "owner": {"reputation": 69, "user_id": 3994010, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/16509cdc752dc609b8b5e4c6cae4a6e9?s=128&d=identicon&r=PG", "display_name": "Mehrdad Dadkhah", "link": "https://stackoverflow.com/users/3994010/mehrdad-dadkhah"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 146, "favorite_count": 0, "accepted_answer_id": 45447627, "answer_count": 2, "score": 0, "last_activity_date": 1501660070, "creation_date": 1501620963, "last_edit_date": 1501660070, "question_id": 45447571, "link": "https://stackoverflow.com/questions/45447571/make-slice-of-a-struct-with-a-variable-of-it", "title": "Make slice of a struct with a variable of it", "body": "<p>In my func I have a variable of Product struct but I have not access to Product struct and I want make a slice of Product from it's variable for example:</p>\n\n<pre><code>test1 := Product{}\n\n....\n....\n....\n\ntest2 := []TypeOf(test1)\n</code></pre>\n\n<p>how can I do that?</p>\n\n<p><strong>Update</strong>:\nwhat I want to actually achieve?</p>\n\n<p>I have some structs that want to use in a adapter for gorm.</p>\n\n<p>In my adapter for example  I have a FindAll method that need slice of one of my struct.</p>\n\n<p>All my structs is in a package named Domains and I don't want send needed variable from where use(call) FindAll function.</p>\n\n<p>Now I registered all my structs to a Map and fetch them in adapter with struct name\nbut the result is a variable of that struct not type of that struct so I can't make another variable from it or make a slice of that.</p>\n"}, {"tags": ["select", "go", "channels"], "answers": [{"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 2, "last_activity_date": 1501616768, "creation_date": 1501616768, "answer_id": 45446468, "question_id": 45446429, "link": "https://stackoverflow.com/questions/45446429/why-does-this-select-always-run-the-default-case-when-the-first-case-actually-is/45446468#45446468", "title": "Why does this select always run the default case when the first case actually is executed?", "body": "<p>It only executes the default case, because the for loop runs 5 times before anything starts reading from the channel. Each time through, because nothing can read from the channel, it goes to the default case. If something could read from the channel, it would execute that case.</p>\n"}, {"comments": [{"owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "edited": false, "score": 0, "creation_date": 1501617873, "post_id": 45446477, "comment_id": 77854588, "body": "So the <code>0</code> my example prints is the zero value of <code>int</code>, not the value I think I would be sending?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "edited": false, "score": 0, "creation_date": 1501617915, "post_id": 45446477, "comment_id": 77854609, "body": "@m90: yes, the unbuffered channel is already closed, so there was nothing received."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 4, "last_activity_date": 1501618081, "last_edit_date": 1501618081, "creation_date": 1501616819, "answer_id": 45446477, "question_id": 45446429, "link": "https://stackoverflow.com/questions/45446429/why-does-this-select-always-run-the-default-case-when-the-first-case-actually-is/45446477#45446477", "title": "Why does this select always run the default case when the first case actually is executed?", "body": "<p>You never send any values to <code>stuff</code>, you execute all the default cases before you get to any of the receive operations in the <code>fmt.Println</code> statements. The <code>default</code> case is taken immediately if there is no other operation than can proceed, which means that your loop will execute and return as quickly as possible.</p>\n\n<p>You want to block the loop, so you don't need the <code>default</code> case. You don't need the <code>close</code> at the end either, because you're not relying on the closed channel unblocking a receive or breaking from a <code>range</code> clause. </p>\n\n<pre><code>stuff := make(chan int)\ngo func() {\n    for i := 0; i &lt; 5; i++ {\n        select {\n        case stuff &lt;- i:\n            fmt.Printf(\"Sent %v\\n\", i)\n        }\n    }\n    println(\"Closing\")\n}()\ntime.Sleep(time.Second)\nfmt.Println(&lt;-stuff)\nfmt.Println(&lt;-stuff)\nfmt.Println(&lt;-stuff)\nfmt.Println(&lt;-stuff)\nfmt.Println(&lt;-stuff)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/k2rmRDP38f\" rel=\"nofollow noreferrer\">https://play.golang.org/p/k2rmRDP38f</a></p>\n\n<p>Notice also that the last \"Sent\" and the \"Closing\" line aren't printed, because you have no other synchronization waiting for the goroutine to finish, however that doesn't effect the outcome of this example. </p>\n"}, {"comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501618014, "post_id": 45446485, "comment_id": 77854672, "body": "I don&#39;t think the first send is actually succeeding. <a href=\"https://play.golang.org/p/AN7c7SS98w\" rel=\"nofollow noreferrer\">play.golang.org/p/AN7c7SS98w</a>"}], "tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 2, "last_activity_date": 1501618150, "last_edit_date": 1501618150, "creation_date": 1501616850, "answer_id": 45446485, "question_id": 45446429, "link": "https://stackoverflow.com/questions/45446429/why-does-this-select-always-run-the-default-case-when-the-first-case-actually-is/45446485#45446485", "title": "Why does this select always run the default case when the first case actually is executed?", "body": "<p>Your first case isn't executing.</p>\n\n<p>Here's what your program does:</p>\n\n<ol>\n<li>Start a goroutine.</li>\n<li>Attempt to send <code>0</code> through <code>4</code> on the channel, which all block, because there is nothing reading the channel, so fall through to the default.</li>\n<li>Meanwhile, in the main goroutine, you're sleeping for one second...</li>\n<li>Then after the second has elapsed, attempt to read from the channel, but it is closed, so you get <code>0</code> every time.</li>\n</ol>\n\n<p>To get your desired behavior, you have two choices:</p>\n\n<ol>\n<li><p>Use a buffered channel, which can hold all of the data you send:</p>\n\n<pre><code>stuff := make(chan int, 5)\n</code></pre></li>\n<li><p>Don't use <code>default</code> in your select statement, which will cause each send to wait until it can succeed.</p></li>\n</ol>\n\n<p>Which is preferred depends on your goals. For a minimal example like this, either is probably no better or worse.</p>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 1, "creation_date": 1501627543, "post_id": 45446612, "comment_id": 77858731, "body": "+1 for being the only one to very explicitly point out that there needs to be a reader already waiting for the handoff. The others imply this, but don&#39;t actually explain it this way so that it can&#39;t be misunderstood."}, {"owner": {"reputation": 101, "user_id": 2768641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9761eb9177dd32c24cd5b07b394931?s=128&d=identicon&r=PG&f=1", "display_name": "PleaseHelp", "link": "https://stackoverflow.com/users/2768641/pleasehelp"}, "reply_to_user": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1545760396, "post_id": 45446612, "comment_id": 94690592, "body": "@Ray Wrong. The send is blocking but the select is non-blocking. Huge difference."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "reply_to_user": {"reputation": 101, "user_id": 2768641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9761eb9177dd32c24cd5b07b394931?s=128&d=identicon&r=PG&f=1", "display_name": "PleaseHelp", "link": "https://stackoverflow.com/users/2768641/pleasehelp"}, "edited": false, "score": 1, "creation_date": 1545845148, "post_id": 45446612, "comment_id": 94710385, "body": "@PleaseHelp Uh, unless I am not understanding your comment correctly, I think you are confusing the term &quot;send&quot; in the context of this Q/A. The term &quot;send&quot; here encompasses the <code>select</code> statement and everything inside. It&#39;s the <code>select</code> with <code>default</code> that makes <code>stuff &lt;- i</code> a &quot;non-blocking send&quot;."}, {"owner": {"reputation": 101, "user_id": 2768641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5c9761eb9177dd32c24cd5b07b394931?s=128&d=identicon&r=PG&f=1", "display_name": "PleaseHelp", "link": "https://stackoverflow.com/users/2768641/pleasehelp"}, "edited": false, "score": 0, "creation_date": 1545901019, "post_id": 45446612, "comment_id": 94723437, "body": "My point is using the term &quot;send&quot; in the context of this Q/A is misleading."}], "tags": [], "owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "is_accepted": false, "score": 2, "last_activity_date": 1501617281, "creation_date": 1501617281, "answer_id": 45446612, "question_id": 45446429, "link": "https://stackoverflow.com/questions/45446429/why-does-this-select-always-run-the-default-case-when-the-first-case-actually-is/45446612#45446612", "title": "Why does this select always run the default case when the first case actually is executed?", "body": "<p>Since you're using a non-blocking 'send', the <code>stuff &lt;- i</code> will really only be executed if there's a reader already waiting to read things on the channel, or if the channel has some buffer. If not, the 'send' would have to block.</p>\n\n<p>Now since you have a <code>time.Sleep(time.Second)</code> before the print statements that read from the channel, there are no readers for the channel till after 1 second has passed. The goroutine on the other hand finishes executing within that time and doesn't send anything.</p>\n\n<p>You're seeing all zeroes in the output because the <code>fmt.Println(...)</code> statements are reading from a closed channel.</p>\n"}], "owner": {"reputation": 10244, "user_id": 797194, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3728c41e604024f375043551a59b41df?s=128&d=identicon&r=PG", "display_name": "m90", "link": "https://stackoverflow.com/users/797194/m90"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1237, "favorite_count": 1, "accepted_answer_id": 45446477, "answer_count": 4, "score": 4, "last_activity_date": 1501618150, "creation_date": 1501616619, "question_id": 45446429, "link": "https://stackoverflow.com/questions/45446429/why-does-this-select-always-run-the-default-case-when-the-first-case-actually-is", "title": "Why does this select always run the default case when the first case actually is executed?", "body": "<p>I'm trying to get a better understanding of golang channels. While reading <a href=\"http://www.jtolds.com/writing/2016/03/go-channels-are-bad-and-you-should-feel-bad/\" rel=\"nofollow noreferrer\">this article</a> I'm toying with non-blocking sends and have come up with the following code:</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    stuff := make(chan int)\n    go func(){\n        for i := 0; i &lt; 5; i ++{\n            select {\n            case stuff &lt;- i:\n                fmt.Printf(\"Sent %v\\n\", i)\n            default:\n                fmt.Printf(\"Default on %v\\n\", i)\n            }\n        }\n        println(\"Closing\")\n        close(stuff)\n    }()\n    time.Sleep(time.Second)\n    fmt.Println(&lt;-stuff)\n    fmt.Println(&lt;-stuff)\n    fmt.Println(&lt;-stuff)\n    fmt.Println(&lt;-stuff)\n    fmt.Println(&lt;-stuff)\n}\n</code></pre>\n\n<p>This will print:</p>\n\n<pre><code>Default on 0\nDefault on 1\nDefault on 2\nDefault on 3\nDefault on 4\nClosing\n0\n0\n0\n0\n0\n</code></pre>\n\n<p>While I do understand that only <code>0</code>s will get printed I do not really understand why the first send does still trigger the <code>default</code> branch of the select?</p>\n\n<p>What is the logic behind the behavior of a select in this case?</p>\n\n<p><a href=\"https://play.golang.org/p/t7O0T45Y-Z\" rel=\"nofollow noreferrer\">Example at the Go Playground</a></p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": true, "score": 6, "last_activity_date": 1501612490, "creation_date": 1501612490, "answer_id": 45445313, "question_id": 45445263, "link": "https://stackoverflow.com/questions/45445263/infinite-loop-with-function-call-in-post/45445313#45445313", "title": "Infinite loop with function call in post", "body": "<p>You should do <code>i = increment(i)</code>.</p>\n\n<p>Otherwise, the <code>i</code> used in the loop is not modified.</p>\n\n<pre><code>for i := 1; condition_true(i); i = increment(i) {\n    fmt.Println(i)\n}\n</code></pre>\n\n<p>That one works as you'd expect.</p>\n\n<p><a href=\"https://play.golang.org/p/dwHbV1iY0_\" rel=\"noreferrer\">https://play.golang.org/p/dwHbV1iY0_</a></p>\n\n<p>Alternatively, allow <code>increment</code> to modify <code>i</code> by receiving a pointer to it:</p>\n\n<pre><code>func increment(i *int) {\n   *i++\n}\n</code></pre>\n\n<p>And then use it like this in the loop:</p>\n\n<pre><code>for i := 1; condition_true(i); increment(&amp;i) {\n    fmt.Println(i)\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 127, "user_id": 2062695, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/29cd5257b391fe0f8826e4a21fe8aa87?s=128&d=identicon&r=PG", "display_name": "ITDerrickH", "link": "https://stackoverflow.com/users/2062695/itderrickh"}, "is_accepted": false, "score": 3, "last_activity_date": 1501612529, "creation_date": 1501612529, "answer_id": 45445322, "question_id": 45445263, "link": "https://stackoverflow.com/questions/45445263/infinite-loop-with-function-call-in-post/45445322#45445322", "title": "Infinite loop with function call in post", "body": "<p>This is happening because the increment function isn't actually changing the i value because the i is passed by value into the function.</p>\n\n<p>Simply remove the increment in the for loop and replace it with i++</p>\n"}], "owner": {"reputation": 53, "user_id": 6875314, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/EnggW.jpg?s=128&g=1", "display_name": "NLis", "link": "https://stackoverflow.com/users/6875314/nlis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "accepted_answer_id": 45445313, "answer_count": 2, "score": 0, "last_activity_date": 1501612529, "creation_date": 1501612301, "question_id": 45445263, "link": "https://stackoverflow.com/questions/45445263/infinite-loop-with-function-call-in-post", "title": "Infinite loop with function call in post", "body": "<p>Cycle loops, when I increment <code>i</code> by the function, but no via <code>i++</code>. </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc increment(i int) (int) {\n    i++\n    return i\n}\n\nfunc condition_true(i int) (bool) {\n    if i &lt; 10 {\n        return true\n    } else {\n        return false\n    }\n}\n\nfunc main() {\n    for i := 1; condition_true(i); increment(i) {\n        fmt.Println(i)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://repl.it/Js55/1\" rel=\"nofollow noreferrer\">compiler to play around</a></p>\n"}, {"tags": ["sql-server", "go"], "comments": [{"owner": {"reputation": 930, "user_id": 411860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B455u.jpg?s=128&g=1", "display_name": "MWillemse", "link": "https://stackoverflow.com/users/411860/mwillemse"}, "edited": false, "score": 0, "creation_date": 1501612680, "post_id": 45445205, "comment_id": 77851638, "body": "If string1 contains a table name it seems to me you need put the table name in the string before passing it to Sql Server. Sql server has let you know it was given a string where it expected a table variable. It is talking about @LRU you&#39;ve put in the FROM clause of your query."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1501613386, "post_id": 45445205, "comment_id": 77851984, "body": "<code>QueryContext</code> is not hyper complex at all. It only takes one additional argument, and it can be effectively ignored by using <code>context.TODO()</code>."}, {"owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "reply_to_user": {"reputation": 930, "user_id": 411860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B455u.jpg?s=128&g=1", "display_name": "MWillemse", "link": "https://stackoverflow.com/users/411860/mwillemse"}, "edited": false, "score": 0, "creation_date": 1501613528, "post_id": 45445205, "comment_id": 77852062, "body": "@MWillemse - see the meager documentation for this at  <a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\">github.com/denisenkom/go-mssqldb</a>"}, {"owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501613712, "post_id": 45445205, "comment_id": 77852166, "body": "@Flimzy - heh - I thought that TODO line was a typo in the Go docs ;-). Tried it with QueryContext, still the same error as posted above."}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1501638351, "post_id": 45445205, "comment_id": 77861443, "body": "How if you change the query to <code>var checkQuery = &quot;DECLARE @LRU VARCHAR(255), @ENVVAR VARCHAR(255); select SigCode from @LRU where LRUEmu=@ENVVAR;&quot;</code>?"}, {"owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1501761341, "post_id": 45445205, "comment_id": 77927340, "body": "@putu: recall that these queries are being assembled in source code. In your example above, where does one enter the variable values?"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1501822929, "post_id": 45445205, "comment_id": 77958065, "body": "The variable value is assigned when you call the <code>db.Query</code>, i.e. <code>db.Query(checkQuery, sql.Named(&quot;LRU&quot;, string1), sql.Named(&quot;ENVVAR&quot;, string2))</code>"}, {"owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1501853524, "post_id": 45445205, "comment_id": 77977091, "body": "@putu thanks - tried it but no joy - see my edit above..."}], "answers": [{"comments": [{"owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "edited": false, "score": 0, "creation_date": 1501760531, "post_id": 45472278, "comment_id": 77926677, "body": "I use variables as tables names all the time. See my edit above for  a python sample in production code which uses pymssql."}, {"owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "edited": false, "score": 0, "creation_date": 1501761933, "post_id": 45472278, "comment_id": 77927789, "body": "Also, I tried your very last last code suggestion above and &#39;+&#39; signs generate run-time errors, and without them I get the usual LRU undefined errors. The plus sign errors are probably driver issues, I&#39;ve used that syntax before in SQLS Mgmt Studio..."}, {"owner": {"reputation": 930, "user_id": 411860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B455u.jpg?s=128&g=1", "display_name": "MWillemse", "link": "https://stackoverflow.com/users/411860/mwillemse"}, "reply_to_user": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "edited": false, "score": 0, "creation_date": 1501764958, "post_id": 45472278, "comment_id": 77930191, "body": "That variable is resolved by the phython code before sending it off to the sql server. About the + sign, I assumed you&#39;d know how to concatenate 3 strings together which I (again) assumed you&#39;d understand was the purpose of that line of code. Anyway, please reread my awnser and try to understand what I&#39;m saying about what is happing where when you execute those 2 lines of code. If possible start a debug session and step into db.Query method to see what it does with your query before sending it off to SQL Server."}, {"owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "edited": false, "score": 0, "creation_date": 1501765891, "post_id": 45472278, "comment_id": 77931010, "body": "I can do it using plus signs but there&#39;s no real way to let the db driver sanitize the inputs that way.  By using  parametric insertion both the compiler and the db driver help to sanitize the inputs. I stopped assembling SQL strings in that manner 3 years (and 2 languages) ago. Simple brute force string assembly is not the way to go imo. If you look at the way this is done with other RDMBS drivers in python/perl/go parametric insertion is the way to go.  And yes, I missed the plus signs. Sorry, pre-coffee."}, {"owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "edited": false, "score": 0, "creation_date": 1501766014, "post_id": 45472278, "comment_id": 77931111, "body": "Again - this all works like a charm in python. I will stick with p3 for now and see if I can help with the go driver in some way. Ironically I was trying to use this little project as a way to introduce golang into our dev org..."}], "tags": [], "owner": {"reputation": 930, "user_id": 411860, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/B455u.jpg?s=128&g=1", "display_name": "MWillemse", "link": "https://stackoverflow.com/users/411860/mwillemse"}, "is_accepted": false, "score": 1, "last_activity_date": 1501714702, "creation_date": 1501714702, "answer_id": 45472278, "question_id": 45445205, "link": "https://stackoverflow.com/questions/45445205/golang-sqlserver-positional-parameters-in-select-statements/45472278#45472278", "title": "golang/sqlserver positional parameters in select statements", "body": "<p>I don't know golang but i do know sql server. </p>\n\n<pre><code>var checkQuery = \"select SigCode from @LRU where LRUEmu=@ENVVAR\"\nrows, err := db.Query(checkQuery, sql.Named(\"LRU\", string1), sql.Named(\"ENVVAR\", string2))\n</code></pre>\n\n<p>These lines must be getting translated into SQL code and send to SQL server. The resulting SQL code probably looks something like this:</p>\n\n<pre><code>DECLARE @LRU   NVARCHAR(MAX) = '&lt;contents of string 1&gt;';\nDECLARE @ENVAR NVARCHAR(MAX) = '&lt;contents of string 2&gt;';\nselect SigCode from @LRU where LRUEmu=@ENVVAR\n</code></pre>\n\n<p>When this is executed SQL Server will raise the error</p>\n\n<pre><code>Must declare the table variable \"@LRU\"\n</code></pre>\n\n<p>Which is caught and rethrown by your QueryContext. </p>\n\n<p>The reason for SQL server to raise the error is an syntax error in the query. SQL server does not (and afaik neither do other rdbms) allow you to put table names in a variable and run a select against it.</p>\n\n<p>So you either to this:</p>\n\n<pre><code>var checkQuery = \"select SigCode from \" + string1 + \" where LRUEmu=@ENVVAR\"\nrows, err := db.Query(checkQuery, sql.Named(\"ENVVAR\", string2))\n</code></pre>\n\n<p>or use dynamic sql like this:</p>\n\n<pre><code>var checkQuery = \n       \"DECLARE @SQL NVARCHAR(MAX) = \n           'select SigCode from '+@LRU+' where LRUEmu=@ENVVAR';\n        EXEC(@SQL);\"\nrows, err := db.Query(checkQuery, sql.Named(\"LRU\", string1), sql.Named(\"ENVVAR\", string2))\n</code></pre>\n"}], "owner": {"reputation": 978, "user_id": 3212967, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/K14XW.png?s=128&g=1", "display_name": "Omortis", "link": "https://stackoverflow.com/users/3212967/omortis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1189, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501853712, "creation_date": 1501612058, "last_edit_date": 1501853712, "question_id": 45445205, "link": "https://stackoverflow.com/questions/45445205/golang-sqlserver-positional-parameters-in-select-statements", "title": "golang/sqlserver positional parameters in select statements", "body": "<p>Can anyone provide a working example of a Query or QueryRow (not QueryContext) with a simple select and 2 (or more) positional parameters using the golang sqlserver driver?</p>\n\n<p>There's some churn, apparently: <a href=\"https://github.com/denisenkom/go-mssqldb/issues/260\" rel=\"nofollow noreferrer\">https://github.com/denisenkom/go-mssqldb/issues/260</a></p>\n\n<p>The only sample code given is for QueryContext which is hypercomplex for a simple cli data transition program. This is brain-dead simple with postgres or mysql but I'm dead in the water with sql server.</p>\n\n<p>Using:</p>\n\n<pre><code>var checkQuery = \"select SigCode from @LRU where LRUEmu=@ENVVAR\"\n...\nrows, err := db.Query(checkQuery, sql.Named(\"LRU\", string1), sql.Named(\"ENVVAR\", string2))\n</code></pre>\n\n<p>yields:</p>\n\n<p><code>application() rows.Query() failed:mssql: Must declare the table variable \"@LRU\".</code></p>\n\n<p>Edit. Per @Flimzy below, retried with QueryContext:</p>\n\n<p><code>rows, err := db.QueryContext(context.TODO(), checkQuery,sql.Named(\"LRU\", string1), sql.Named(\"ENVVAR\", string2))</code></p>\n\n<p>Same error.</p>\n\n<p>@MWillemse: Here is some sample code (pymssql) which uses a variable to specify the target table:</p>\n\n<pre><code>slice_cursor.execute(\n    \"select distinct Subsystem, Field from [%(dlog)s] \"\n    \"where Subsystem not like 'STRING1' \"\n    \"order by Subsystem, Field\"\n    % {\n        'dlog' : datelog\n    }\n)\n</code></pre>\n\n<p>I do it all the time. In golang/pg as well, works like a charm.</p>\n\n<p>@putu: I tried your suggestion but no joy. New error, though...</p>\n\n<pre><code>var checkQuery = \"DECLARE @LRU VARCHAR(255), @ENVVAR VARCHAR(255); select SigCode from @LRU where LRUEmu=@ENVVAR;\"\n\n// ...\n\nrows, err := db.Query(checkQuery, sql.Named(\"LRU\", string1), sql.Named(\"ENVVAR\", string2))\n</code></pre>\n\n<p>Yields:</p>\n\n<p><code>mssql: The variable name '@LRU' has already been declared. Variable names must be unique within a query batch or stored procedure.</code></p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 6, "creation_date": 1501610882, "post_id": 45444880, "comment_id": 77850561, "body": "goroutines offer no guarantees as to what order different goroutines will execute which lines of code."}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1501611206, "creation_date": 1501611206, "answer_id": 45444981, "question_id": 45444880, "link": "https://stackoverflow.com/questions/45444880/goroutine-causes-interchangable-actions-in-for-loop/45444981#45444981", "title": "Goroutine causes interchangable actions in for loop", "body": "<blockquote>\n  <p>I understand that sleep will cause the new goroutine to start the other thread for the specified amount of time</p>\n</blockquote>\n\n<p>This is partly incorrect!</p>\n\n<p>This would be correct on a machine with only one core where only one thread can be executed at a time.</p>\n\n<p>On a machine with multiple cores go can execute as many goroutines parallel as there are cores. With parallel executed goroutines there is no guarantee at all, what will be executed before or after.</p>\n"}, {"tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1501611213, "creation_date": 1501611213, "answer_id": 45444985, "question_id": 45444880, "link": "https://stackoverflow.com/questions/45444880/goroutine-causes-interchangable-actions-in-for-loop/45444985#45444985", "title": "Goroutine causes interchangable actions in for loop", "body": "<p>You cannot say with any certainty what order <em>concurrent operations</em> will \"always\" execute in. That's how concurrency works. If you want to control the order of execution, either don't execute concurrently, or use synchronization constructs (e.g. mutex, channel) to control the order of operations.</p>\n"}, {"tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 0, "last_activity_date": 1501612079, "creation_date": 1501612079, "answer_id": 45445211, "question_id": 45444880, "link": "https://stackoverflow.com/questions/45444880/goroutine-causes-interchangable-actions-in-for-loop/45445211#45445211", "title": "Goroutine causes interchangable actions in for loop", "body": "<p>As others have said, there are no guarantees you can assume about the order of execution.</p>\n\n<p>The Go scheduler has an internal algorithm that decides how to allocate the processor and there is little you can do to control this without resorting to synchronization (which would be the right approach to take here).</p>\n\n<p>If you are interested in learning how to control synchronization between tasks, take a look at the <code>sync</code> package, and also at how <code>channels</code> work:</p>\n\n<p><a href=\"https://golang.org/pkg/sync/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/sync/</a></p>\n\n<p><a href=\"https://tour.golang.org/concurrency/2\" rel=\"nofollow noreferrer\">https://tour.golang.org/concurrency/2</a></p>\n\n<p>However, I want to add something that others have not mentioned, and while it does not allow you to control execution order, it might be worth commenting due to the nature of the question.</p>\n\n<p>There is a <code>runtime.Gosched</code> function that you can use to hint the scheduler. It would yield the processor so it is likely that other threads will execute.</p>\n\n<p><a href=\"https://golang.org/pkg/runtime/#Gosched\" rel=\"nofollow noreferrer\">https://golang.org/pkg/runtime/#Gosched</a></p>\n\n<p>If you add a call to <code>Gosched</code> instead of sleeping, in my tests it is much more likely that \"hello\" and \"world\" would output in order (though again, there is no guarantee and they will appear in random order at times).</p>\n\n<p>Try it like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"runtime\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 5; i++ {\n        fmt.Println(s, i)\n        runtime.Gosched()\n    }\n}\n\nfunc main() {\n    go say(\"world\")\n    say(\"hello\")\n}\n</code></pre>\n\n<p>Lastly, take a look at this article which you might find interesting as well:</p>\n\n<p><a href=\"http://container-solutions.com/surprise-golang-thread-scheduling/\" rel=\"nofollow noreferrer\">http://container-solutions.com/surprise-golang-thread-scheduling/</a></p>\n"}], "owner": {"reputation": 11, "user_id": 5232914, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/e9c227d0381efe544dc2a7d8f558e6e4?s=128&d=identicon&r=PG&f=1", "display_name": "theBigDream", "link": "https://stackoverflow.com/users/5232914/thebigdream"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "answer_count": 3, "score": 0, "last_activity_date": 1501612113, "creation_date": 1501610794, "last_edit_date": 1501612113, "question_id": 45444880, "link": "https://stackoverflow.com/questions/45444880/goroutine-causes-interchangable-actions-in-for-loop", "title": "Goroutine causes interchangable actions in for loop", "body": "<p>I'm very new to go and I'm not sure why this code has this output.  I understand that sleep will cause the new goroutine to start the other thread for the specified amount of time.  I'm trying to sequentially map out the logic and it looks like \"world\" should always print before \"hello\".  </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc say(s string) {\n    for i := 0; i &lt; 5; i++ {\n        time.Sleep(1 * time.Millisecond)\n        fmt.Println(s, i)\n    }\n}\n\nfunc main() {\n    go say(\"world\")\n    say(\"hello\")\n}\n</code></pre>\n\n<p>Actual Output:</p>\n\n<pre><code>world 0\nhello 0\nhello 1\nworld 1\nworld 2\nhello 2\nhello 3\nworld 3\nworld 4\nhello 4\n</code></pre>\n\n<p>Expected Output:</p>\n\n<pre><code>world 0\nhello 0\nworld 1\nhello 1\nworld 2\nhello 2\n</code></pre>\n\n<p>...etc</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "edited": false, "score": 0, "creation_date": 1503341731, "post_id": 45593907, "comment_id": 78565539, "body": "sorry but it doesn&#39;t <code>db.Where sql: converting Exec argument $1 type: unsupported type main.Name, a struct</code>"}], "tags": [], "owner": {"reputation": 65, "user_id": 495248, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/a9fb4472e72bc751362964b0fa813d49?s=128&d=identicon&r=PG", "display_name": "Scott", "link": "https://stackoverflow.com/users/495248/scott"}, "is_accepted": false, "score": 0, "last_activity_date": 1502289871, "creation_date": 1502289871, "answer_id": 45593907, "question_id": 45444788, "link": "https://stackoverflow.com/questions/45444788/gormgopg-query-for-related/45593907#45593907", "title": "gorm+go+pg: query for related", "body": "<p>Remove the pointer and it will work</p>\n\n<p>Reference: \n<a href=\"http://jinzhu.me/gorm/associations.html\" rel=\"nofollow noreferrer\">http://jinzhu.me/gorm/associations.html</a></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 377, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1502289871, "creation_date": 1501610467, "question_id": 45444788, "link": "https://stackoverflow.com/questions/45444788/gormgopg-query-for-related", "title": "gorm+go+pg: query for related", "body": "<p>So we have a Person with a Name. A First and Last name.\nLet's insert the Person with the First and Last name and query for the Person by Name.First again. How?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n\n    \"github.com/jinzhu/gorm\"\n)\n\nvar (\n    pgHost     string\n    pgUser     string\n    pgDatabase string\n    pgPass     string\n)\n\ntype Person struct {\n    gorm.Model\n    Name   *Name\n    NameID uint\n}\n\ntype Name struct {\n    gorm.Model\n    PersonID uint\n    First    string\n    Last     string\n}\n\nfunc main() {\n    // let's assume they're set\n    db, e := gorm.Open(\"postgres\", fmt.Sprintf(\"host=%s user=%s dbname=%s password=%s sslmode=disable\", pgHost, pgUser, pgDatabase, pgPass))\n    if e != nil {\n        log.Fatal(e)\n    }\n    defer db.Close()\n\n    db.AutoMigrate(&amp;Person{}, &amp;Name{})\n\n    p := &amp;Person{\n        Name: &amp;Name{First: \"First\", Last: \"Last\"},\n    }\n\n    tx := db.Begin()\n    if c := tx.Create(p); c.Error != nil {\n        log.Fatal(\"tx.create\", c.Error)\n    }\n    tx.Commit()\n\n    // let's find it\n\n    pq := &amp;Person{Name: &amp;Name{First: \"First\"}}\n    pr := new(Person)\n\n    if c := db.Where(pq).First(pr); c.Error != nil {\n        log.Fatal(\"db.Where\", c.Error)\n    }\n}\n</code></pre>\n\n<p>Error Message</p>\n\n<p><code>converting Exec argument $1 type: unsupported type Name, a struct</code></p>\n\n<p>Feel free to suggest alternatives, change structs, etc.\nNo, adding <code>NameFirst</code> and <code>NameLast</code> fields isn't acceptable. The 2 structs should remain intact.</p>\n"}, {"tags": ["go", "ssh", "socks"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501609505, "post_id": 45444513, "comment_id": 77849785, "body": "LD_PRELOAD and LD_LIBRARY_PATH have nothing to do with ssh itself, that is injecting some shared libraries into your openssh process. If you don&#39;t use the openssh binary, you can&#39;t preload a different shared library into it."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501625302, "post_id": 45446360, "comment_id": 77857997, "body": "No, this won&#39;t have the desired effect, because Go doesn&#39;t use the C library socket calls to be overridden. Chances are that the Go program doesn&#39;t use any C shared libraries at runtime (though the std lib uses cgo for the resolver and user db when enabled), and may be completely statically linked"}, {"owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501628565, "post_id": 45446360, "comment_id": 77859020, "body": "@JimB thanks for pointing that out! I have updated my answer based on your comment, after a quick verification that it was indeed the case."}, {"owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501630090, "post_id": 45446360, "comment_id": 77859413, "body": "Are you sure about that? The <code>Dial()</code> function in the <code>ssh</code> package uses <code>DialTimeout()</code> from the <code>net</code> package. I wrote a simple program that used <code>DialTimeout()</code> and I was able to use <code>LD_PRELOAD</code> to tunnel through a <code>SOCKS</code> proxy. (This was on Linux with <code>CGO_ENABLED</code> set to true / undefined. <code>go build</code> generated a dynamically linked executable which I tested..)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501630725, "post_id": 45446360, "comment_id": 77859603, "body": "Oh yes, I forgot that it only needs to intercept Dial. However I thought current versions of Go had started defaulting to the native Dialer unless required by the local config files. What version of Go are you using? (even so, you could still <code>export GODEBUG=netdns=cgo</code> to force the cgo resolver)"}, {"owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501631304, "post_id": 45446360, "comment_id": 77859775, "body": "I used go1.8.3 linux/amd64. With my setup, the <code>cgo</code> resolver is used by default and I have to explicitly force it to use the Go resolver. Looks like there are a bunch of <a href=\"https://golang.org/pkg/net/#hdr-Name_Resolution\" rel=\"nofollow noreferrer\">conditions</a> when that might be the case."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501677979, "post_id": 45446360, "comment_id": 77882800, "body": "OK, that&#39;s what I thought. So if you want to rely on LD_PRELOAD, you will need to force the host resolver in <i>all</i> cases, which you can do with <code>GODEBUG=netdns=cgo</code> or building with the <code>netcgo</code> tag."}], "tags": [], "owner": {"reputation": 1671, "user_id": 4600983, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/37d236a59e7d7e6871716bc25752dae6?s=128&d=identicon&r=PG&f=1", "display_name": "svsd", "link": "https://stackoverflow.com/users/4600983/svsd"}, "is_accepted": false, "score": 1, "last_activity_date": 1501631415, "last_edit_date": 1501631415, "creation_date": 1501616374, "answer_id": 45446360, "question_id": 45444513, "link": "https://stackoverflow.com/questions/45444513/golang-ssh-load-ld-preload-and-ld-library-path-environment-variables/45446360#45446360", "title": "Golang SSH load LD_PRELOAD and LD_LIBRARY_PATH environment variables", "body": "<p>(Edit: This answer does not necessarily apply to Go 1.8 and above. See comments for discussion)</p>\n\n<p><code>LD_PRELOAD</code> and <code>LD_LIBRARY_PATH</code> are environment variables processed by the <a href=\"https://www.cs.virginia.edu/~dww4s/articles/ld_linux.html\" rel=\"nofollow noreferrer\">dynamic linker</a> when a program is starting up. If you set those environment variables inside the program, they don't have an effect on the program itself since the linker didn't see them.</p>\n\n<p>On the other hand, the environment variables will affect external applications that you run (the <code>ssh</code> command for example) from within the program, since the linker is given control to resolve the shared libraries that the application uses.</p>\n\n<p><s>If you instead set those environment variables before running the Go program, I think you'll have the desired effect.</s> (This is only applicable if the compiled program is linked to the shared standard C library. See @JimB's comments below for more details.)</p>\n"}], "owner": {"reputation": 11, "user_id": 6482282, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iEdvO.jpg?s=128&g=1", "display_name": "Felipe Siqueira", "link": "https://stackoverflow.com/users/6482282/felipe-siqueira"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1232, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501631415, "creation_date": 1501609348, "question_id": 45444513, "link": "https://stackoverflow.com/questions/45444513/golang-ssh-load-ld-preload-and-ld-library-path-environment-variables", "title": "Golang SSH load LD_PRELOAD and LD_LIBRARY_PATH environment variables", "body": "<p>I'm trying to connect to a remote server using <a href=\"https://godoc.org/golang.org/x/crypto/ssh\" rel=\"nofollow noreferrer\">Golang SSH package</a>, but there's a SOCKS between my workstation and this remote server.</p>\n\n<p>I'm able to connect to the server by simply setting a LD_PRELOAD and LD_LIBRARY_PATH and then running:</p>\n\n<pre><code>$ export LD_PRELOAD=\"/path/to/lib\"\n$ export LD_LIBRARY_PATH=\"/path/to/lib\"\n$ ssh user@hostname\n</code></pre>\n\n<p>But when I set these variables within the Go code, it doesn't work:</p>\n\n<pre><code>os.Setenv(\"LD_PRELOAD\", \"/path/to/file\")\nos.Setenv(\"LD_LIBRARY_PATH\", \"/path/to/file\")\n</code></pre>\n\n<p>If I set these variables within the Go code and try the following, it works:</p>\n\n<pre><code>ssh := exec.Command(\"ssh\", \"hostname\")\noutput, _ := ssh.Output()\nfmt.Println(string(output))\n</code></pre>\n\n<p>The ssh PermitUserEnvironment is set as yes</p>\n\n<p>Is there any way to \"force\" the Golang SSH to use these environment variables?</p>\n"}, {"tags": ["performance", "go", "goroutine"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 6, "creation_date": 1501608138, "post_id": 45444108, "comment_id": 77849014, "body": "I think you are vastly overestimating how fast your cpu can count to 1 million. That is not enough work to even show up at millisecond scales. That 5ms is almost all process startup, and printing to the console."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501608260, "post_id": 45444108, "comment_id": 77849095, "body": "Also, what go version are you running. <code>go version</code>?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501608430, "post_id": 45444108, "comment_id": 77849191, "body": "Use a <code>go test</code> benchmark if you want to benchmark something like this. It will at least get you to a reasonable input number, and average the results of many execution."}, {"owner": {"reputation": 51, "user_id": 8401083, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--nAdRKc7UcE/AAAAAAAAAAI/AAAAAAAAAAA/SfxsnIWW0Lg/photo.jpg?sz=128", "display_name": "Pedro Mota Gonz&#225;lez", "link": "https://stackoverflow.com/users/8401083/pedro-mota-gonz%c3%a1lez"}, "edited": false, "score": 0, "creation_date": 1501608758, "post_id": 45444108, "comment_id": 77849380, "body": "I see improvements if I start using 100,000,000 million numbers (500 ms sequentially vs 300 ms with goroutines)"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1501610999, "post_id": 45444108, "comment_id": 77850627, "body": "This is way, way too simple a test to get a benefit from concurrency. It&#39;s not a magic trick to give you more performance out of thin air; it has to be used appropriately to reap any real benefit."}], "answers": [{"comments": [{"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 0, "creation_date": 1502576688, "post_id": 45446255, "comment_id": 78269083, "body": "@Pedro: are you missing something in my answer. If not, can you mark it as correct?"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 3, "last_activity_date": 1501660799, "last_edit_date": 1501660799, "creation_date": 1501615951, "answer_id": 45446255, "question_id": 45444108, "link": "https://stackoverflow.com/questions/45444108/goroutine-performance/45446255#45446255", "title": "Goroutine performance", "body": "<p>Here how you can test this with the golangs own benchmark tool:</p>\n\n<p>Create a test go file (e.g. <code>main_test.go</code>).</p>\n\n<blockquote>\n  <p>Note: <code>_test.go</code> has to be the file ending!</p>\n</blockquote>\n\n<p>Copy the following code there or create your own Benchmarks:</p>\n\n<pre><code>package main\n\nimport (\n    \"sync\"\n    \"testing\"\n)\n\nvar GlobalInt int\n\nfunc BenchmarkCount(b *testing.B) {\n    var a, c int\n    count(&amp;a, b.N)\n    count(&amp;c, b.N)\n    GlobalInt = a + c // make sure the result is actually used\n}\n\nfunc count(a *int, max int) {\n    for i := 0; i &lt; max; i++ {\n        *a += i\n    }\n}\n\nvar wg sync.WaitGroup\n\nfunc BenchmarkCountConcurrent(b *testing.B) {\n    var a, c int\n    wg.Add(2)\n    go countCon(&amp;a, b.N)\n    go countCon(&amp;c, b.N)\n    wg.Wait()\n\n    GlobalInt = a + c // make sure the result is actually used\n}\n\nfunc countCon(a *int, max int) {\n    for i := 0; i &lt; max; i++ {\n        *a += i\n    }\n    wg.Done()\n}\n</code></pre>\n\n<p>Run with:</p>\n\n<pre><code>go test -bench .\n</code></pre>\n\n<p>Result on my Mac:</p>\n\n<pre><code>$ go test -bench .\nBenchmarkCount-8                500000000            3.50 ns/op\nBenchmarkCountConcurrent-8      2000000000           1.98 ns/op\nPASS\nok      MyPath/MyPackage        6.309s\n</code></pre>\n\n<p>Most important value is the time/op. The smaller the better. Here 3.5 ns/op for normal counting, 1.98 ns/op for concurrent counting.</p>\n\n<p>EDIT:\nHere you can read up on golang <a href=\"https://golang.org/pkg/testing/\" rel=\"nofollow noreferrer\">Testing and Benchmark</a>.</p>\n"}], "owner": {"reputation": 51, "user_id": 8401083, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/--nAdRKc7UcE/AAAAAAAAAAI/AAAAAAAAAAA/SfxsnIWW0Lg/photo.jpg?sz=128", "display_name": "Pedro Mota Gonz&#225;lez", "link": "https://stackoverflow.com/users/8401083/pedro-mota-gonz%c3%a1lez"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1373, "favorite_count": 0, "accepted_answer_id": 45446255, "answer_count": 1, "score": -2, "last_activity_date": 1501660799, "creation_date": 1501608031, "last_edit_date": 1501617503, "question_id": 45444108, "link": "https://stackoverflow.com/questions/45444108/goroutine-performance", "title": "Goroutine performance", "body": "<p>I have started to learn Go, it's fun and easy. But working with goroutines I have seen little benefit in performance.</p>\n\n<p>If I try to sequentially add 1 million numbers two times in 2 functions:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nvar sumA int\nvar sumB int\n\nfunc fSumA() {\n    for i := 0; i &lt; 1000000; i++ {\n        sumA += i\n    }\n}\n\nfunc fSumB() {\n    for i := 0; i &lt; 1000000; i++ {\n        sumB += i\n    }\n}\n\nfunc main() {\n    start := time.Now()\n    fSumA()\n    fSumB()\n    sum := sumA + sumB\n    fmt.Println(\"Elapsed time\", time.Since(start))\n    fmt.Println(\"Sum\", sum)\n}\n</code></pre>\n\n<p>It takes 5 ms.</p>\n\n<pre><code>MacBook-Pro-de-Pedro:hello pedro$ ./bin/hello\nElapsed time 5.724406ms\nSuma total 999999000000\nMacBook-Pro-de-Pedro:hello pedro$ ./bin/hello\nElapsed time 5.358165ms\nSuma total 999999000000\nMacBook-Pro-de-Pedro:hello pedro$ ./bin/hello\nElapsed time 5.042528ms\nSuma total 999999000000\nMacBook-Pro-de-Pedro:hello pedro$ ./bin/hello\nElapsed time 5.469628ms\nSuma total 999999000000\n</code></pre>\n\n<p>When I try to do the same thing with 2 goroutines:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n    \"time\"\n)\n\nvar wg sync.WaitGroup\n\nvar sumA int\nvar sumB int\n\nfunc fSumA() {\n    for i := 0; i &lt; 1000000; i++ {\n        sumA += i\n    }\n    wg.Done()\n}\n\nfunc fSumB() {\n    for i := 0; i &lt; 1000000; i++ {\n        sumB += i\n    }\n    wg.Done()\n}\n\nfunc main() {\n    start := time.Now()\n    wg.Add(2)\n    go fSumA()\n    go fSumB()\n    wg.Wait()\n    sum := sumA + sumB\n    fmt.Println(\"Elapsed time\", time.Since(start))\n    fmt.Println(\"Sum\", sum)\n}\n</code></pre>\n\n<p>I get more or less the same result, 5 ms. My computer is a MacBook pro (Core 2 Duo). I don't see any performance improvement. Maybe is the processor?</p>\n\n<pre><code>MacBook-Pro-de-Pedro:hello pedro$ ./bin/hello\nElapsed time 5.258415ms\nSuma total 999999000000\nMacBook-Pro-de-Pedro:hello pedro$ ./bin/hello\nElapsed time 5.528498ms\nSuma total 999999000000\nMacBook-Pro-de-Pedro:hello pedro$ ./bin/hello\nElapsed time 5.273565ms\nSuma total 999999000000\nMacBook-Pro-de-Pedro:hello pedro$ ./bin/hello\nElapsed time 5.539224ms\nSuma total 999999000000\n</code></pre>\n"}, {"tags": ["http", "networking", "go"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501607257, "post_id": 45443848, "comment_id": 77848480, "body": "Are you downloading in parallel, or one after another? Are they all from the same host?"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501607322, "post_id": 45443848, "comment_id": 77848529, "body": "<a href=\"https://stackoverflow.com/a/17961593/121660\">stackoverflow.com/a/17961593/121660</a> might help"}, {"owner": {"reputation": 1, "user_id": 1502245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2375d35c30b9b65ce4a2396fad4c78?s=128&d=identicon&r=PG", "display_name": "zcreative", "link": "https://stackoverflow.com/users/1502245/zcreative"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501607500, "post_id": 45443848, "comment_id": 77848626, "body": "@captncraig parallel. I&#39;ve edited my question to clarify. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501609315, "post_id": 45443981, "comment_id": 77849678, "body": "note that unless you set <code>MaxIdleConnsPerHost</code> on the transport, or change <code>http.DefaultMaxIdleConnsPerHost</code>, the transport isn&#39;t going to be reusing most of the connections."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501609740, "post_id": 45443981, "comment_id": 77849893, "body": "@JimB according to <a href=\"https://golang.org/pkg/net/http/#RoundTripper\" rel=\"nofollow noreferrer\">godoc</a>, it looks like http.DefaultTransport has a default value of 100."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501609808, "post_id": 45443981, "comment_id": 77849931, "body": "nvm, I read wrong. Editing post slightly. <code>http.DefaultMaxIdleConnsPerHost</code> is a const. Gotta set it on <code>http.DefaultTransport</code>."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501609966, "post_id": 45443981, "comment_id": 77850033, "body": "You were entirely correct. Will default to 2 per host if you don&#39;t override. At high concurrency though, I would expect a small pool of idle hosts at any given time though. Each goroutine will return one and immediately take it."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501610003, "post_id": 45443981, "comment_id": 77850055, "body": "Oh yes, forgot that&#39;s a const. Also, <code>http.DefaultTransport</code> is an interface, you need a type assertion."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501610290, "post_id": 45443981, "comment_id": 77850242, "body": "At high concurrency is exactly where this falls over. The pool of idle connections doesn&#39;t have any elasticity, so as soon as you have more than 2 per host in the pool you can end up cycling through new connections very quickly, slowing things down, leaving more connections unserviced, and can easily exhaust the ephemeral port range."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501610732, "post_id": 45443981, "comment_id": 77850475, "body": "Yes, that&#39;s why I recommend 10-20 workers max. Number of opened connections shouldn&#39;t really exceed number of workers will it?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1501610898, "post_id": 45443981, "comment_id": 77850568, "body": "That shouldn&#39;t be a problem in general; as soon as a goroutine releases a connection, it will take it back up for the next request in the queue, so the number of <i>idle</i> connections should never be very high. It shouldn&#39;t be cycling through new connections at all."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501610904, "post_id": 45443981, "comment_id": 77850572, "body": "Yes. Each concurrent Get request will have its own connection, and if they hit the idle pool concurrently all extras get closed, causing that worker to Dial again for the next request. The rule of thumb is to set <code>MaxIdleConnsPerHost</code> equal to your expected concurrency."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501611308, "post_id": 45443981, "comment_id": 77850803, "body": "@Adrian: that would be true in a perfect world, but in practice multiple connections hit the idle pool concurrently quite frequently, and once you have to start dialing new connection things slow down even further causing more connections to hit the idle pool. This isn&#39;t some rare issue, it come up all the time for busy http clients, and been referenced here on SO many time as well as the mailing list."}, {"owner": {"reputation": 187, "user_id": 1327092, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/510fc4b6490e3db4588f7129be31097b?s=128&d=identicon&r=PG", "display_name": "ZiggidyCreative", "link": "https://stackoverflow.com/users/1327092/ziggidycreative"}, "edited": false, "score": 0, "creation_date": 1501654864, "post_id": 45443981, "comment_id": 77866626, "body": "Thanks all. I&#39;m going to work on understanding everything above more deeply. Will implement this and see how it works for me."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": false, "score": 3, "last_activity_date": 1501610659, "last_edit_date": 1501610659, "creation_date": 1501607583, "answer_id": 45443981, "question_id": 45443848, "link": "https://stackoverflow.com/questions/45443848/how-to-avoid-running-into-max-open-files-limit/45443981#45443981", "title": "How to avoid running into max open files limit", "body": "<p>You probably want to limit active concurrent requests to a more sensible number than 5000. Possibly spin up 10/20 workers and send individual files to them over a channel.</p>\n\n<p>The http client <em>should</em> reuse connections for requests, assuming you <em>always</em> read the entire request body, and close it.</p>\n\n<p>Something like this:</p>\n\n<pre><code>func main() {\n    http.DefaultTransport.(*http.Transport).MaxIdleConnsPerHost = 100\n    for i := 0; i &lt; 10; i++ {\n        wg.Add(1)\n        go worker()\n    }\n    var csvs = []string{\"http://example.com/a.csv\", \"http://example.com/b.csv\"}\n    for _, u := range csvs {\n        ch &lt;- u\n    }\n    close(ch)\n    wg.Wait()\n}\n\nvar ch = make(chan string)\nvar wg sync.WaitGroup\n\nfunc worker() {\n    defer wg.Done()\n    for u := range ch {\n        get(u)\n    }\n}\n\nfunc get(u string) {\n    resp, err := http.Get(u)\n    //check err here\n\n    // make sure we always read rest of body, and close\n    defer resp.Body.Close()\n    defer io.Copy(ioutil.Discard, resp.Body)\n\n    //read and decode / handle it. Make sure to read all of body.\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 1502245, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a2375d35c30b9b65ce4a2396fad4c78?s=128&d=identicon&r=PG", "display_name": "zcreative", "link": "https://stackoverflow.com/users/1502245/zcreative"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 92, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1501610659, "creation_date": 1501607194, "last_edit_date": 1501607453, "question_id": 45443848, "link": "https://stackoverflow.com/questions/45443848/how-to-avoid-running-into-max-open-files-limit", "title": "How to avoid running into max open files limit", "body": "<p>I'm building an application that will be downloading roughly 5000 CSV files concurrently using go routines and plain ol http get requests. Downloading the files in parallel.</p>\n\n<p>I'm currently running into open file limits imposed by OS X.</p>\n\n<p>The CSV files are served over http. Are there any other network protocols that I can use to batch each request into one? I don't have access to the server, so I can't zip them. I'd also prefer not to change the ulimit because once in production, I probably won't have access to that configuration.</p>\n"}, {"tags": ["go", "named-pipes"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1501605967, "post_id": 45443414, "comment_id": 77847710, "body": "<code>io.Copy</code> &quot;reads continuously&quot;, don&#39;t put it in a loop."}, {"owner": {"reputation": 5, "user_id": 8325777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MC8fp.png?s=128&g=1", "display_name": "Benjamin.E", "link": "https://stackoverflow.com/users/8325777/benjamin-e"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501606158, "post_id": 45443414, "comment_id": 77847831, "body": "@JimB I guess I should mention that the writing side is not writing to the named pipe continuously. If I rely solely on io.Copy, the goroutine will terminate once EOF is reached."}, {"owner": {"reputation": 111, "user_id": 2679859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a062ae8b00195f37d7d070d2fa29eb08?s=128&d=identicon&r=PG&f=1", "display_name": "user2679859", "link": "https://stackoverflow.com/users/2679859/user2679859"}, "edited": false, "score": 0, "creation_date": 1576944897, "post_id": 45443414, "comment_id": 105059647, "body": "See my solution below. Just add <i>another</i> open() on the pipe to open it os.O_WRONLY. Dont close it. Your loop will then work just fine."}], "answers": [{"comments": [{"owner": {"reputation": 5, "user_id": 8325777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MC8fp.png?s=128&g=1", "display_name": "Benjamin.E", "link": "https://stackoverflow.com/users/8325777/benjamin-e"}, "edited": false, "score": 0, "creation_date": 1501612376, "post_id": 45443906, "comment_id": 77851439, "body": "Out of curiosity, why runtime.Gosched doesn&#39;t do the job?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 5, "user_id": 8325777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MC8fp.png?s=128&g=1", "display_name": "Benjamin.E", "link": "https://stackoverflow.com/users/8325777/benjamin-e"}, "edited": false, "score": 0, "creation_date": 1501615653, "post_id": 45443906, "comment_id": 77853381, "body": "@Benjamin.E: You don&#39;t need <code>runtime.GoSched</code> because you&#39;re already yielding to other goroutines. Function/method calls and channel operations will yield, so <code>io.Copy</code> is completely sufficient. The problem is just that you&#39;re spinning as fast as possible when there&#39;s nothing there. Readers aren&#39;t going to be coming and going in sub-millisecond timeframes, so there&#39;s no reason to retry that quickly."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1501620420, "post_id": 45443906, "comment_id": 77855899, "body": "@JimB Please see my critique of your solution in my answer."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1501620762, "post_id": 45443906, "comment_id": 77856076, "body": "@MarkusWMahlberg: while your&#39;s is somewhat more optimal, that condition os <i>only</i> going to happen the moment a new writer connects since the <code>io.Copy</code> will block until that writer is gone. The maximum 100ms window of loss doesn&#39;t mean much for reliability since you can&#39;t guarantee your application is responsive in that time period anyway. Much simpler and more reliable is the first solution I mentioned, of simply just opening the named pipe for writing -- no need to poll, or watch the file descriptor at all."}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 2, "last_activity_date": 1501607360, "creation_date": 1501607360, "answer_id": 45443906, "question_id": 45443414, "link": "https://stackoverflow.com/questions/45443414/read-continuously-from-a-named-pipe/45443906#45443906", "title": "Read continuously from a named pipe", "body": "<p>A named pipe reader will receive EOF when there are no writers left. The solution outside of this code is to make sure there is always one writer process holding the file descriptor, though it doesn't need to write anything. </p>\n\n<p>Within the Go program, if you want to wait for a new writer, you will have to poll the <code>io.Reader</code> in your for loop. Your current code does this with a busy loop, which will consume 100% of 1 cpu core. Adding a sleep and a way to return on other errors will work around the issue:</p>\n\n<pre><code>for {\n    err := io.Copy(&amp;buff, fpipe)\n    if buff.Len() &gt; 0 {\n        buff.WriteTo(f)\n    }\n\n    if err != nil {\n        // something other than EOF happened\n        return\n    }\n\n    time.Sleep(100 * time.Millisecond)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501621070, "post_id": 45447384, "comment_id": 77856256, "body": "Just to reiterate from above, the pipe&#39;s buffer is just that, a buffer, and it will accept data no matter the state of the reading process. There is no guarantee that the buffer will have been read at all in the event of failure, and telling yourself otherwise is just tempting fate. You have to accept that there is always the possibility of data loss when there&#39;s no acknowledgement. This does make a more responsive implementation however (at the cost of added complexity)."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501621362, "post_id": 45447384, "comment_id": 77856410, "body": "@JimB Off, you can loose data, however, it is less likely, and this solution is less prone to blocking the writers."}, {"owner": {"reputation": 5, "user_id": 8325777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MC8fp.png?s=128&g=1", "display_name": "Benjamin.E", "link": "https://stackoverflow.com/users/8325777/benjamin-e"}, "edited": false, "score": 0, "creation_date": 1501633361, "post_id": 45447384, "comment_id": 77860286, "body": "I was thinking as well to rely on a notification mechanism in order to avoid cluttered data."}, {"owner": {"reputation": 696, "user_id": 1126722, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8421dc16b450b3b287fa75c86352b99e?s=128&d=identicon&r=PG&f=1", "display_name": "Cyberlurk", "link": "https://stackoverflow.com/users/1126722/cyberlurk"}, "edited": false, "score": 0, "creation_date": 1529167597, "post_id": 45447384, "comment_id": 88780777, "body": "Why does &quot;  if p, err = os.Open(pipePath); os.IsNotExist(err)&quot; block until the first write to the named pipe?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 696, "user_id": 1126722, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/8421dc16b450b3b287fa75c86352b99e?s=128&d=identicon&r=PG&f=1", "display_name": "Cyberlurk", "link": "https://stackoverflow.com/users/1126722/cyberlurk"}, "edited": false, "score": 0, "creation_date": 1529225845, "post_id": 45447384, "comment_id": 88790299, "body": "@AndyCini Digging down a bit, non-surprisingly I ended <a href=\"https://github.com/golang/go/blob/4a778cdf3375d418062b3c3e9f6891cc9162e3d0/src/os/file_unix.go#L190\" rel=\"nofollow noreferrer\">finding a syscall</a>. I assume that this blocks until the pipe is actually active. However, I do not see a problem with the block -  we only want to continue in case at least one entry was written to the pipe."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1501620299, "creation_date": 1501620299, "answer_id": 45447384, "question_id": 45443414, "link": "https://stackoverflow.com/questions/45443414/read-continuously-from-a-named-pipe/45447384#45447384", "title": "Read continuously from a named pipe", "body": "<h1>Intro</h1>\n\n<p>As already written, a named pipe reader will receive an EOF if no writers are left.</p>\n\n<p>However I find @JimB's solution less than optimal:</p>\n\n<ol>\n<li>A named pipe has a maximum capacity (65kB, iirc), which may well get filled within the 100msec sleep period. When the buffer is filled, all writers would block for no good reason.</li>\n<li>If a reboot happens, you will loose 50ms worth of data on average. Again, for no good reason.</li>\n<li>If you want to use a static buffer for copying, <a href=\"https://golang.org/pkg/io/#CopyBuffer\" rel=\"nofollow noreferrer\"><strong><code>io.CopyBuffer(dst Writer, src Reader, buf []byte) (written int64, err error)</code></strong></a> would be the better solution, imho. But this is not even necessary, as <a href=\"https://golang.org/src/io/io.go?s=12490:12550#L349\" rel=\"nofollow noreferrer\"><strong><code>io.Copy</code></strong></a> (or the underlying implementation) actually allocates a buffer of 32kB.</li>\n</ol>\n\n<h1>My approach</h1>\n\n<p>A better solution would be to wait for a write to happen and the immediately copy the contents of the named pipe to the destination file. On most systems, there is some sort of notification on file system events. The package <a href=\"https://github.com/rjeczalik/notify\" rel=\"nofollow noreferrer\">github.com/rjeczalik/notify</a> can be used to access the events we are interested in, as write events work cross platform on most of the important OSes. The other event which would be interesting for us is the removal of the named pipe, since we would not have anything to read from.</p>\n\n<p>Hence, my solution would be:</p>\n\n<pre><code>package main\n\nimport (\n    \"flag\"\n    \"io\"\n    \"log\"\n    \"os\"\n\n    \"github.com/rjeczalik/notify\"\n)\n\nconst (\n    MAX_CONCURRENT_WRITERS = 5\n)\n\nvar (\n    pipePath string\n    filePath string\n)\n\nfunc init() {\n    flag.StringVar(&amp;pipePath, \"pipe\", \"\", \"/path/to/named_pipe to read from\")\n    flag.StringVar(&amp;filePath, \"file\", \"out.txt\", \"/path/to/output file\")\n    log.SetOutput(os.Stderr)\n}\n\nfunc main() {\n    flag.Parse()\n\n    var p, f *os.File\n    var err error\n    var e notify.EventInfo\n\n    // The usual stuff: checking wether the named pipe exists etc\n    if p, err = os.Open(pipePath); os.IsNotExist(err) {\n        log.Fatalf(\"Named pipe '%s' does not exist\", pipePath)\n    } else if os.IsPermission(err) {\n        log.Fatalf(\"Insufficient permissions to read named pipe '%s': %s\", pipePath, err)\n    } else if err != nil {\n        log.Fatalf(\"Error while opening named pipe '%s': %s\", pipePath, err)\n    }\n    // Yep, there and readable. Close the file handle on exit\n    defer p.Close()\n\n    // Do the same for the output file\n    if f, err = os.OpenFile(filePath, os.O_CREATE|os.O_APPEND|os.O_WRONLY, 0600); os.IsNotExist(err) {\n        log.Fatalf(\"File '%s' does not exist\", filePath)\n    } else if os.IsPermission(err) {\n        log.Fatalf(\"Insufficient permissions to open/create file '%s' for appending: %s\", filePath, err)\n    } else if err != nil {\n        log.Fatalf(\"Error while opening file '%s' for writing: %err\", filePath, err)\n    }\n    // Again, close the filehandle on exit\n    defer f.Close()\n\n    // Here is where it happens. We create a buffered channel for events which might happen\n    // on the file. The reason why we make it buffered to the number of expected concurrent writers\n    // is that if all writers would (theoretically) write at once or at least pretty close\n    // to each other, it might happen that we loose event. This is due to the underlying implementations\n    // not because of go.\n    c := make(chan notify.EventInfo, MAX_CONCURRENT_WRITERS)\n\n    // Here we tell notify to watch out named pipe for events, Write and Remove events\n    // specifically. We watch for remove events, too, as this removes the file handle we\n    // read from, making reads impossible\n    notify.Watch(pipePath, c, notify.Write|notify.Remove)\n\n    // We start an infinite loop...\n    for {\n        // ...waiting for an event to be passed.\n        e = &lt;-c\n\n        switch e.Event() {\n\n        case notify.Write:\n            // If it a a write event, we copy the content of the named pipe to\n            // our output file and wait for the next event to happen.\n            // Note that this is idempotent: Even if we have huge writes by multiple\n            // writers on the named pipe, the first call to Copy will copy the contents.\n            // The time to copy that data may well be longer than it takes to generate the events.\n            // However, subsequent calls may copy nothing, but that does not do any harm.\n            io.Copy(f, p)\n\n        case notify.Remove:\n            // Some user or process has removed the named pipe,\n            // so we have nothing left to read from.\n            // We should inform the user and quit.\n            log.Fatalf(\"Named pipe '%s' was removed. Quitting\", pipePath)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 111, "user_id": 2679859, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a062ae8b00195f37d7d070d2fa29eb08?s=128&d=identicon&r=PG&f=1", "display_name": "user2679859", "link": "https://stackoverflow.com/users/2679859/user2679859"}, "is_accepted": false, "score": 0, "last_activity_date": 1576944767, "creation_date": 1576944767, "answer_id": 59437816, "question_id": 45443414, "link": "https://stackoverflow.com/questions/45443414/read-continuously-from-a-named-pipe/59437816#59437816", "title": "Read continuously from a named pipe", "body": "<p>Problem: when the 'last writer' closes the pipe, you get an EOF even though there may be new writers that appear later.</p>\n\n<p>Solution: open the pipe yourself for write and dont close it. Now you can treat the read side as a never ending read without ever getting EOF. Put the following directly after where you open your pipe for read:</p>\n\n<pre><code>nullWriter, err := os.OpenFile(pipePath, os.O_WRONLY, os.ModeNamedPipe)\nif err != nil {\n  logger.Crit(\"Error opening pipe for (placeholder) write\", \"err\", err)\n}\ndefer nullWriter.Close()\n</code></pre>\n"}], "owner": {"reputation": 5, "user_id": 8325777, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MC8fp.png?s=128&g=1", "display_name": "Benjamin.E", "link": "https://stackoverflow.com/users/8325777/benjamin-e"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3197, "favorite_count": 0, "accepted_answer_id": 45443906, "answer_count": 3, "score": 0, "last_activity_date": 1576944767, "creation_date": 1501605862, "last_edit_date": 1501612637, "question_id": 45443414, "link": "https://stackoverflow.com/questions/45443414/read-continuously-from-a-named-pipe", "title": "Read continuously from a named pipe", "body": "<p>I would like to know what other options I have in order to read continuously from a named pipe using golang. My current code relies on a infinite for loop running inside a gorutine; but hat keeps one CPU at 100% usage.</p>\n\n<pre><code>func main() {\n....\n\nvar wg sync.WaitGroup\nfpipe, _ := os.OpenFile(namedPipe, os.O_RDONLY, 0600)\ndefer fpipe.Close()\n\nf, _ := os.Create(\"dump.txt\")\ndefer f.Close()\nvar buff bytes.Buffer\n\nwg.Add(1)\ngo func() {\n        for {\n          io.Copy(&amp;buff, fpipe)\n          if buff.Len() &gt; 0 {\n              buff.WriteTo(f)\n           }\n         }\n    }()\n\n    wg.Wait()\n}\n</code></pre>\n"}, {"tags": ["go", "installation", "packages", "libvirt"], "comments": [{"owner": {"reputation": 466, "user_id": 8307258, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/L8i2o.jpg?s=128&g=1", "display_name": "Rados\u0142aw Za\u0142uska", "link": "https://stackoverflow.com/users/8307258/rados%c5%82aw-za%c5%82uska"}, "edited": false, "score": 0, "creation_date": 1501602541, "post_id": 45442034, "comment_id": 77845637, "body": "What Linux distribution are you using?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501603405, "post_id": 45442034, "comment_id": 77846207, "body": "Most linux packages have a separate &quot;-dev&quot; package with the headers and pkgconfig data."}, {"owner": {"reputation": 3, "user_id": 8298674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ce239c27c2256dd0002b77941960ae?s=128&d=identicon&r=PG&f=1", "display_name": "D. More", "link": "https://stackoverflow.com/users/8298674/d-more"}, "edited": false, "score": 0, "creation_date": 1501603422, "post_id": 45442034, "comment_id": 77846215, "body": "Linux - Fedora 25"}], "answers": [{"tags": [], "owner": {"reputation": 1792, "user_id": 7126113, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ffadd47897c7708095d65a6813375dfa?s=128&d=identicon&r=PG&f=1", "display_name": "DanielB", "link": "https://stackoverflow.com/users/7126113/danielb"}, "is_accepted": true, "score": 2, "last_activity_date": 1501665023, "creation_date": 1501665023, "answer_id": 45456407, "question_id": 45442034, "link": "https://stackoverflow.com/questions/45442034/how-to-install-libvirt-go-pkg-config/45456407#45456407", "title": "How to install libvirt-go? (pkg-config)", "body": "<p>You need to install the libvirt development package, eg libvirt-devel on Fedora/RHEL/Centos, or libvirt-dev on Debian/Ubuntu.</p>\n\n<p>The libvirt-go build process will just query 'pkg-config' to find out where it is installed, so if you did have it installed in a non-standard location (eg /opt/libvirt), then you would do   'export PKG_CONFIG_PATH=/opt/libvirt/lib/pkgconfig' and then libvirt-go would find that.</p>\n"}], "owner": {"reputation": 3, "user_id": 8298674, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b1ce239c27c2256dd0002b77941960ae?s=128&d=identicon&r=PG&f=1", "display_name": "D. More", "link": "https://stackoverflow.com/users/8298674/d-more"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 757, "favorite_count": 0, "accepted_answer_id": 45456407, "answer_count": 1, "score": -3, "last_activity_date": 1501665023, "creation_date": 1501601708, "question_id": 45442034, "link": "https://stackoverflow.com/questions/45442034/how-to-install-libvirt-go-pkg-config", "title": "How to install libvirt-go? (pkg-config)", "body": "<p>Libvirt was installed with \"dnf install\". For libvirt-go - $ go get github.com/libvirt/libvirt-go.\nAs a result:\n<a href=\"https://i.stack.imgur.com/UX2NU.png\" rel=\"nofollow noreferrer\">enter image description here</a></p>\n\n<p>How I can change PKG_CONFIG_PATH? Or how to install libvirt-go right?</p>\n"}, {"tags": ["postgresql", "go", "go-gorm"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 1, "last_activity_date": 1501601784, "creation_date": 1501601784, "answer_id": 45442065, "question_id": 45441783, "link": "https://stackoverflow.com/questions/45441783/go-gorm-postgres-simple-inserts-return-error/45442065#45442065", "title": "go-gorm, postgres: simple inserts return error", "body": "<p>According to the <a href=\"https://godoc.org/github.com/jinzhu/gorm#DB.Create\" rel=\"nofollow noreferrer\">docs</a>, <code>Create</code> returns a <code>*DB</code>, not an error. So your code should be more like</p>\n\n<pre><code>if tx = tx.Create(name); tx.Error != nil { /* ... */ }\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501603012, "post_id": 45442268, "comment_id": 77845936, "body": "I&#39;m glad you solved your problem, this doesn&#39;t provide enough explanation for anyone but you to get any value out of it. Can you detail this so that the broader community might find some use in it?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "edited": false, "score": 0, "creation_date": 1501776240, "post_id": 45442268, "comment_id": 77939775, "body": "pay me and I will consider it"}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "is_accepted": false, "score": 0, "last_activity_date": 1501602325, "creation_date": 1501602325, "answer_id": 45442268, "question_id": 45441783, "link": "https://stackoverflow.com/questions/45441783/go-gorm-postgres-simple-inserts-return-error/45442268#45442268", "title": "go-gorm, postgres: simple inserts return error", "body": "<p>Also, additionally,</p>\n\n<pre><code>db, e := gorm.Open(\"postgres\", fmt.Sprintf(\"host=%s user=%s dbname=%s password=%s sslmode=disable\", pgHost, pgUser, pgDatabase, pgPass))\nif e != nil {\n    log.Fatal(e.Error())\n}\ndefer db.Close()\ndb.AutoMigrate(&amp;model.Customer{}, &amp;model.Email{}, &amp;model.Address{}, &amp;model.Name{}, &amp;model.Logindata{})\n\nname := new(model.Name)\nemail := new(model.Email)\ncustomer := &amp;model.Customer{\n    Name:         name,\n    PrimaryEmail: email,\n}\ncustomer.Name.First = \"Darko\"\ncustomer.Name.Last = \"Luketic\"\ncustomer.Name.Middle = \"\"\ncustomer.PrimaryEmail.Address = \"my@mail.come\"\ncustomer.PrimaryEmail.Verified = true\ntx := db.Begin()\n\nif e := tx.Create(customer).Error; e != nil {\n    tx.Rollback()\n    log.Fatal(\"create customer\", e)\n}\ntx.Commit()\n</code></pre>\n\n<p>I need to change the structs so they have a related field. I did expect more from an orm. That's why it's an ORM object relationship manager.\ngorm doesn't manage much there ;)</p>\n\n<pre><code>package model\n\nimport \"github.com/jinzhu/gorm\"\n\ntype Customer struct {\n    gorm.Model\n    Name            *Name\n    BillingAddress  *Address\n    ShippingAddress *Address\n    PrimaryEmail    *Email\n    AlternateEmails []*Email\n    Logindata       *Logindata\n}\n\ntype Name struct {\n    gorm.Model\n    CustomerID uint\n    First      string `json:\"first\"`\n    Middle     string `json:\"middle\"`\n    Last       string `json:\"last\"`\n}\n\ntype Logindata struct {\n    gorm.Model\n    CustomerID uint\n    Username   string\n    Password   []byte\n}\n\ntype Email struct {\n    gorm.Model\n    CustomerID uint\n    Address    string\n    Verified   bool\n}\n\ntype Address struct {\n    gorm.Model\n    CustomerID uint\n    Address1   string\n    Address2   string\n    City       string\n    Code       string\n    Country    string\n}\n</code></pre>\n\n<p>note the <code>CustomerID uint</code></p>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user2312578"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 353, "favorite_count": 0, "accepted_answer_id": 45442065, "answer_count": 2, "score": 0, "last_activity_date": 1501602325, "creation_date": 1501600965, "question_id": 45441783, "link": "https://stackoverflow.com/questions/45441783/go-gorm-postgres-simple-inserts-return-error", "title": "go-gorm, postgres: simple inserts return error", "body": "<p>I'm trying to do simple inserts, trying to evaluate the usefulness of Postgres because of this recent hype. I'm a mongoDB guy. And this is what I'm trying to do:</p>\n\n<pre><code>db, e := gorm.Open(\"postgres\", fmt.Sprintf(\"host=%s user=%s dbname=%s password=%s sslmode=disable\", pgHost, pgUser, pgDatabase, pgPass))\nif e != nil {\n    log.Fatal(e.Error())\n}\ndefer db.Close()\ndb.AutoMigrate(&amp;model.Customer{}, &amp;model.Email{}, &amp;model.Address{}, &amp;model.Name{}, &amp;model.Logindata{})\n\nname := new(model.Name)\nemail := new(model.Email)\ncustomer := &amp;model.Customer{\n    Name:         name,\n    PrimaryEmail: email,\n}\ncustomer.Name.First = \"Darko\"\ncustomer.Name.Last = \"Luketic\"\ncustomer.Name.Middle = \"\" // also tried without this line\ncustomer.PrimaryEmail.Address = \"my@mail.come\"\ncustomer.PrimaryEmail.Verified = true\ntx := db.Begin()\n\nif e := tx.Create(name); e != nil {\n    tx.Rollback()\n    log.Fatal(\"create name\", e.Error)\n}\n\nif e := tx.Create(email); e != nil {\n    tx.Rollback()\n    log.Fatal(\"create email\", e.Error)\n}\n\nif e := tx.Create(customer); e != nil {\n    tx.Rollback()\n    log.Fatal(\"create customer\", e.Error)\n}\n\ntx.Commit()\n</code></pre>\n\n<p>with the models being</p>\n\n<pre><code>package model\n\nimport \"github.com/jinzhu/gorm\"\n\ntype Customer struct {\n    gorm.Model\n    Name            *Name\n    BillingAddress  *Address\n    ShippingAddress *Address\n    PrimaryEmail    *Email\n    AlternateEmails []*Email\n    Logindata       *Logindata\n}\n\ntype Name struct {\n    gorm.Model\n    First  string `json:\"first\"`\n    Middle string `json:\"middle\"`\n    Last   string `json:\"last\"`\n}\n\ntype Logindata struct {\n    gorm.Model\n    Username string\n    Password []byte\n}\n\ntype Email struct {\n    gorm.Model\n    Address  string\n    Verified bool\n}\n\ntype Address struct {\n    gorm.Model\n    Address1 string\n    Address2 string\n    City     string\n    Code     string\n    Country  string\n}\n</code></pre>\n\n<p>The output:</p>\n\n<pre><code>go run main.go migrate\nmigrate called\n2017/08/01 17:10:26 create name&lt;nil&gt;\nexit status 1\n</code></pre>\n\n<p>What am I doing wrong?\nWhy is there no error message?\nHow do I fix it?</p>\n"}, {"tags": ["go", "ssh"], "comments": [{"owner": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "edited": false, "score": 1, "creation_date": 1501603292, "post_id": 45441735, "comment_id": 77846129, "body": "Your hostKey is empty on      ssh.FixedHostKey(hostKey) I think      hostKey = signer.PublicKey() probably could help."}, {"owner": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "reply_to_user": {"reputation": 1124, "user_id": 3805062, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/nIUyW.jpg?s=128&g=1", "display_name": "bayrinat", "link": "https://stackoverflow.com/users/3805062/bayrinat"}, "edited": false, "score": 0, "creation_date": 1501604227, "post_id": 45441735, "comment_id": 77846690, "body": "@BayRinat There is a progress, now I get a mismatch &quot;2017/08/01 19:15:47 unable to connect: ssh: handshake failed: ssh: host key mismatch&quot; while I&#39;m 100% sure that my key is correct as I&#39;m able to SSH with that same key via terminal"}], "answers": [{"comments": [{"owner": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "edited": false, "score": 0, "creation_date": 1501604589, "post_id": 45442842, "comment_id": 77846921, "body": "Thanks, now it throw an error that my hostname doesn&#39;t have hostkey"}, {"owner": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "edited": false, "score": 0, "creation_date": 1501662844, "post_id": 45442842, "comment_id": 77871618, "body": "I&#39;ve deleted the known_hosts file and than run on my terminal an SSH to the server and confirmed the fingerprint - so it&#39;s the only server in my known_hosts at the moment and it still complains..."}, {"owner": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "edited": false, "score": 0, "creation_date": 1501670981, "post_id": 45442842, "comment_id": 77877548, "body": "I&#39;m pretty new to coding and go so debuging can be interpreted differently :) what I&#39;ve done is reading the file and than with a reader I&#39;ve printed it out (just to make sure that it contain the fingerprint [and it does]) next I&#39;ve added several fmt.Println inside the for scanner.Scan() that print out the fields and the len of the fields and found that fields contain the fingerprint and it&#39;s len is 3"}, {"owner": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "edited": false, "score": 0, "creation_date": 1501672675, "post_id": 45442842, "comment_id": 77878751, "body": "I&#39;ve changed my code to use the ssh.InsecureIgnoreHostKey and now I&#39;m able to connect, however we all know that it&#39;s not recommended"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "edited": false, "score": 1, "creation_date": 1501673407, "post_id": 45442842, "comment_id": 77879260, "body": "Let us <a href=\"http://chat.stackoverflow.com/rooms/150817/discussion-between-tehsphinx-and-y-eliash\">continue this discussion in chat</a>."}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 6, "last_activity_date": 1554293402, "last_edit_date": 1554293402, "creation_date": 1501604105, "answer_id": 45442842, "question_id": 45441735, "link": "https://stackoverflow.com/questions/45441735/ssh-handshake-complains-about-missing-host-key/45442842#45442842", "title": "SSH Handshake complains about missing host key", "body": "<p>Here what you are looking for:</p>\n\n<pre><code>func getHostKey(host string) (ssh.PublicKey, error) {\n    file, err := os.Open(filepath.Join(os.Getenv(\"HOME\"), \".ssh\", \"known_hosts\"))\n    if err != nil {\n        return nil, err\n    }\n    defer file.Close()\n\n    scanner := bufio.NewScanner(file)\n    var hostKey ssh.PublicKey\n    for scanner.Scan() {\n        fields := strings.Split(scanner.Text(), \" \")\n        if len(fields) != 3 {\n            continue\n        }\n        if strings.Contains(fields[0], host) {\n            var err error\n            hostKey, _, _, _, err = ssh.ParseAuthorizedKey(scanner.Bytes())\n            if err != nil {\n                return nil, errors.New(fmt.Sprintf(\"error parsing %q: %v\", fields[2], err))\n            }\n            break\n        }\n    }\n\n    if hostKey == nil {\n        return nil, errors.New(fmt.Sprintf(\"no hostkey for %s\", host))\n    }\n    return hostKey, nil\n}\n</code></pre>\n\n<p>Then replace your hostKey definition line with</p>\n\n<pre><code>hostKey, err := getHostKey(\"host.com\")\nif err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>For more information on the subject:</p>\n\n<ul>\n<li><a href=\"https://github.com/golang/crypto/blob/master/ssh/example_test.go\" rel=\"nofollow noreferrer\">official sample</a> where I took parts of the code from</li>\n<li><a href=\"https://github.com/golang/go/issues/19767\" rel=\"nofollow noreferrer\">why a hostKey is necessary now</a></li>\n</ul>\n\n<p>EDIT:\nAlso check out <code>Anton</code>'s answer below about the <code>golang.org/x/crypto/ssh/knownhosts</code> package.</p>\n"}, {"comments": [{"owner": {"reputation": 315, "user_id": 1926351, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/101a618d128a23b36b1052a52be1e8d1?s=128&d=identicon&r=PG", "display_name": "kargirwar", "link": "https://stackoverflow.com/users/1926351/kargirwar"}, "edited": false, "score": 0, "creation_date": 1554269151, "post_id": 55041375, "comment_id": 97683588, "body": "Certainly better than parsing ourselves."}], "tags": [], "owner": {"reputation": 828, "user_id": 1125963, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/99544996c8824cac229e0bca9448021c?s=128&d=identicon&r=PG&f=1", "display_name": "Anton", "link": "https://stackoverflow.com/users/1125963/anton"}, "is_accepted": false, "score": 4, "last_activity_date": 1551954114, "creation_date": 1551954114, "answer_id": 55041375, "question_id": 45441735, "link": "https://stackoverflow.com/questions/45441735/ssh-handshake-complains-about-missing-host-key/55041375#55041375", "title": "SSH Handshake complains about missing host key", "body": "<p>I would suggest to use knownhosts subpackage</p>\n\n<pre><code>import knownhosts \"golang.org/x/crypto/ssh/knownhosts\"\n\n...\n\nhostKeyCallback, err := knownhosts.New(\"/Users/user/.ssh/known_hosts\")\nif err != nil {\n    log.Fatal(err)\n}\n\n...\n\nconfig := &amp;ssh.ClientConfig{\n    User: \"user\",\n    Auth: []ssh.AuthMethod{\n        // Use the PublicKeys method for remote authentication.\n        ssh.PublicKeys(signer),\n    },\n    HostKeyCallback: hostKeyCallback,\n}\n</code></pre>\n\n<p>So that you avoid parsing known_hosts yourself...</p>\n\n<p>hth,</p>\n"}], "owner": {"reputation": 1070, "user_id": 5722950, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/5f8584e00a884f270ceb1c90f43122d0?s=128&d=identicon&r=PG&f=1", "display_name": "Y. Eliash", "link": "https://stackoverflow.com/users/5722950/y-eliash"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5629, "favorite_count": 2, "accepted_answer_id": 45442842, "answer_count": 2, "score": 4, "last_activity_date": 1554293402, "creation_date": 1501600854, "question_id": 45441735, "link": "https://stackoverflow.com/questions/45441735/ssh-handshake-complains-about-missing-host-key", "title": "SSH Handshake complains about missing host key", "body": "<p>I'm trying to connect to a remote host and check if a file exist\nAt this stage I'm trying just to connect but I'm getting an error:</p>\n\n<pre><code>2017/08/01 18:16:39 unable to connect: ssh: handshake failed: ssh: required host key was nil\n</code></pre>\n\n<p>I've tried to find out if others had issues as mine but I just couldn't find.</p>\n\n<p>I understand that I need to check the knowns_hosts somehow in the process but I just can't figure out how...</p>\n\n<pre><code>    var hostKey ssh.PublicKey\n    // A public key may be used to authenticate against the remote\n    // server by using an unencrypted PEM-encoded private key file.\n    //\n    // If you have an encrypted private key, the crypto/x509 package\n    // can be used to decrypt it.\n    key, err := ioutil.ReadFile(\"/home/user/.ssh/id_rsa\")\n    if err != nil {\n        log.Fatalf(\"unable to read private key: %v\", err)\n    }\n\n    // Create the Signer for this private key.\n    signer, err := ssh.ParsePrivateKey(key)\n    if err != nil {\n        log.Fatalf(\"unable to parse private key: %v\", err)\n    }\n\n    config := &amp;ssh.ClientConfig{\n        User: \"user\",\n        Auth: []ssh.AuthMethod{\n            // Use the PublicKeys method for remote authentication.\n            ssh.PublicKeys(signer),\n        },\n        HostKeyCallback: ssh.FixedHostKey(hostKey),\n    }\n\n    // Connect to the remote server and perform the SSH handshake.\n    client, err := ssh.Dial(\"tcp\", \"host.com:22\", config)\n    if err != nil {\n        log.Fatalf(\"unable to connect: %v\", err)\n    }\n    defer client.Close()\n}\n</code></pre>\n"}, {"tags": ["function", "generics", "go"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501600919, "post_id": 45441611, "comment_id": 77844572, "body": "Go has no generics. You can either use <code>interface{}</code> or create a function per type you need to execute this particular function against."}], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 3, "last_activity_date": 1501601327, "last_edit_date": 1501601327, "creation_date": 1501600989, "answer_id": 45441790, "question_id": 45441611, "link": "https://stackoverflow.com/questions/45441611/make-helper-function-generic/45441790#45441790", "title": "Make helper function generic", "body": "<p>It is pretty hard to make a generic function to handle this well. You will often spend as much code converting <code>[]int</code> to <code>[]interface{}</code> and back, as it is to just copy the snippet. I do have a slightly nicer way to do it though:</p>\n\n<p><a href=\"https://play.golang.org/p/0GXb-p2kMh\" rel=\"nofollow noreferrer\">playground link</a></p>\n\n<pre><code>func splitInts(src []int, n int) (p [][]int){\n    for len(src) &gt; n{\n        p = append(p,src[:n])\n        src = src[n:]\n    }\n    if(len(src) &gt; 0){\n        p = append(p,src)\n    }\n    return p\n}\n</code></pre>\n\n<p>Nothing in the function changes because of types, it can easily be copied to:</p>\n\n<pre><code>func splitStrings(src []string, n int) (p [][]string){\n    for len(src) &gt; n{\n        p = append(p,src[:n])\n        src = src[n:]\n    }\n    if(len(src) &gt; 0){\n        p = append(p,src)\n    }\n    return p\n}\n</code></pre>\n\n<p>By only changing the first line.</p>\n"}, {"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": false, "score": 0, "last_activity_date": 1501614280, "creation_date": 1501614280, "answer_id": 45445799, "question_id": 45441611, "link": "https://stackoverflow.com/questions/45441611/make-helper-function-generic/45445799#45445799", "title": "Make helper function generic", "body": "<p>Generally it is a good idea to just write the function for every type you need it for. This is also a matter of speed: if you use reflect to write a generic function it will not be as fast.</p>\n\n<p>If you still want a generic function here it is:</p>\n\n<pre><code>func genToPackages(e interface{}, n int) interface{} {\n    t := reflect.TypeOf(e)\n    if t.Kind() != reflect.Slice {\n        log.Println(\"e has to be a slice\")\n    }\n    v := reflect.ValueOf(e)\n\n    packets := int(math.Ceil(float64(v.Len()) / float64(n)))\n    p := reflect.MakeSlice(reflect.SliceOf(t), packets, packets)\n    for i := 0; i &lt; packets; i++ {\n        s := reflect.MakeSlice(t, n, n)\n        start := i * n\n        for j := 0; j &lt; n; j++ {\n            s.Index(j).Set(v.Index(j+start))\n        }\n\n        p.Index(i).Set(s)\n    }\n\n    return p.Interface()\n}\n</code></pre>\n\n<p>You will have to cast the result to the type you expect. For example:</p>\n\n<pre><code>res := genToPackages([]int{1, 2, 3, 4, 5, 6, 7, 8, 9, 10}, 5).([][]int)\n</code></pre>\n"}], "owner": {"reputation": 305, "user_id": 8131948, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sX40L.png?s=128&g=1", "display_name": "Tobias Meyer", "link": "https://stackoverflow.com/users/8131948/tobias-meyer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 45441790, "answer_count": 2, "score": 0, "last_activity_date": 1501614280, "creation_date": 1501600467, "question_id": 45441611, "link": "https://stackoverflow.com/questions/45441611/make-helper-function-generic", "title": "Make helper function generic", "body": "<p>I created a small helper function to split a large array of items into smaller arrays with a maximum size of <code>n</code>.</p>\n\n<pre><code>func toPackages(e []int, n int) [][]int {\n    var p [][]int\n    packets := int(math.Ceil(float64(len(e)) / float64(n)))\n    for i := 0; i &lt; packets; i++ {\n        start := i * n\n        end := n * (i + 1)\n        if len(e) &lt; end {\n            end = len(e)\n        }\n        p = append(p, e[start:end])\n    }\n    return p\n}\n</code></pre>\n\n<p>Working example at <a href=\"https://play.golang.org/p/_O3WDIfn2A\" rel=\"nofollow noreferrer\">Golang Playground</a>.<br>\nIn the program I have several different types of arrays I would like to split. I have tried converting it to using interfaces with <code>interface{}</code>.</p>\n"}, {"tags": ["logging", "go", "filesystems"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501598113, "post_id": 45440491, "comment_id": 77842696, "body": "What os are you on? How is your app running? How are you logging now?"}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501598160, "post_id": 45440491, "comment_id": 77842731, "body": "I generally recommend apps log to stdout/stderr and have syslog or some other tool redirect that to rotating log files."}], "answers": [{"tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 3, "last_activity_date": 1501654738, "last_edit_date": 1501654738, "creation_date": 1501607898, "answer_id": 45444068, "question_id": 45440491, "link": "https://stackoverflow.com/questions/45440491/how-to-configure-uber-zap-logger-for-rolling-filesystem-log/45444068#45444068", "title": "How to configure uber/zap logger for rolling filesystem log", "body": "<p>A hook can be added to the zap logger which writes the entries to <a href=\"https://github.com/natefinch/lumberjack\" rel=\"nofollow noreferrer\">lumberjack</a>, a rolling log for Go.</p>\n\n<p>A simple usage would look like this:</p>\n\n<p>The rolling log:</p>\n\n<pre><code>// remember to call this at app (or scope) exit:\n// logger.Close()\nvar lumlog = &amp;lumberjack.Logger{\n    Filename:   \"/tmp/my-zap.log\",\n    MaxSize:    10, // megabytes\n    MaxBackups: 3,  // number of log files\n    MaxAge:     3,  // days\n}\n</code></pre>\n\n<p>The <code>zap</code> compatible hook:</p>\n\n<pre><code>func lumberjackZapHook(e zapcore.Entry) error {\n    lumlog.Write([]byte(fmt.Sprintf(\"%+v\", e)))\n    return nil\n}\n</code></pre>\n\n<p>And use it like:</p>\n\n<pre><code>logger, _ := zap.NewProduction(zap.Hooks(lumberjackZapHook))\n</code></pre>\n\n<p><strong>Edit 1:</strong> I'm not sure if this meets your requirement in terms of performance. There are many factors there. For example using SSD hards make a big difference, or even logging into some timeseries databases with batch writes.</p>\n\n<p><strong>Edit 2:</strong> In zap <a href=\"https://github.com/uber-go/zap/blob/master/FAQ.md#does-zap-support-log-rotation\" rel=\"nofollow noreferrer\">documentation</a> too, it uses lumberjack (but not as a hook).</p>\n"}], "owner": {"reputation": 91, "user_id": 5657450, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f6aa9b5a61ad40c112a5543e790e7044?s=128&d=identicon&r=PG&f=1", "display_name": "johndoe", "link": "https://stackoverflow.com/users/5657450/johndoe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5328, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1501654738, "creation_date": 1501597399, "question_id": 45440491, "link": "https://stackoverflow.com/questions/45440491/how-to-configure-uber-zap-logger-for-rolling-filesystem-log", "title": "How to configure uber/zap logger for rolling filesystem log", "body": "<p>How to configure uber/zap logger api to append logs to a specified file-path. Can it be made to work like rolling file-appender (based on file-size or date) without affecting performance?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501595891, "post_id": 45439883, "comment_id": 77840837, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/26372227/go-conversion-between-struct-and-byte-array\">Go conversion between struct and byte array</a>"}], "answers": [{"comments": [{"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501597025, "post_id": 45439931, "comment_id": 77841846, "body": "<code>unsafe.Pointer</code> is probably not needed for this. <code>encoding&#47;binary</code> can do it. <a href=\"https://stackoverflow.com/questions/26372227/go-conversion-between-struct-and-byte-array\" title=\"go conversion between struct and byte array\">stackoverflow.com/questions/26372227/&hellip;</a>. But I do agree with your general warnings."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 0, "last_activity_date": 1501595852, "creation_date": 1501595852, "answer_id": 45439931, "question_id": 45439883, "link": "https://stackoverflow.com/questions/45439883/casting-overlapping-structs-in-golang/45439931#45439931", "title": "casting overlapping structs in golang", "body": "<p>Go generally tries to discourage C-like memory fiddling as it leads to memory leaks, incorrect behavior, and security vulnerabilities unless extraordinary caution and testing are applied. That doesn't mean it's impossible though; in fact, the aptly-named <a href=\"https://golang.org/pkg/unsafe/#Pointer\" rel=\"nofollow noreferrer\"><code>unsafe.Pointer</code></a> is exposed for exactly this purpose. Use it with caution.</p>\n"}, {"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 0, "last_activity_date": 1501596614, "creation_date": 1501596614, "answer_id": 45440202, "question_id": 45439883, "link": "https://stackoverflow.com/questions/45439883/casting-overlapping-structs-in-golang/45440202#45440202", "title": "casting overlapping structs in golang", "body": "<p>Here's my solution. It involves a few different tips:</p>\n\n<ol>\n<li><strong>Embed</strong> the shared struct in the individual structs.</li>\n<li>Use <code>encoding/binary</code> package to load bytes into structs.</li>\n<li>Fill header struct with first two bytes, then make a decision on which subtype to make and fill.</li>\n<li>Always use fixed length int types for this kind of thing.</li>\n<li>Your field names must be <code>UpperCase</code> to be fillable from <code>encoding/binary</code></li>\n<li>This is a pretty brittle way to manage marshalling.unmarshalling of data, but I'm sure you know that.</li>\n</ol>\n\n<p>Here's my solution:</p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"encoding/binary\"\n    \"fmt\"\n    \"log\"\n)\n\ntype A struct {\n    X\n    Data1 int32\n    Data2 int32\n    Data3 int32\n}\n\ntype B struct {\n    X\n    Data1 int32\n}\n\ntype X struct {\n    Tag byte\n    Ver byte\n}\n\nfunc main() {\n    var err error\n    data := []byte{1, 1, 0, 0, 0, 42}\n    hdr := X{}\n\n    err = binary.Read(bytes.NewReader(data[:2]), binary.BigEndian, &amp;hdr)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(hdr.Tag, hdr.Ver)\n\n    if hdr.Tag == 1 {\n        b := B{}\n        err = binary.Read(bytes.NewReader(data), binary.BigEndian, &amp;b)\n        if err != nil {\n            log.Fatal(err)\n        }\n        fmt.Println(b.Data1)\n    }\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/4Djx9UYTLF\" rel=\"nofollow noreferrer\">playground link</a></p>\n"}], "owner": {"reputation": 3, "user_id": 8400042, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1f31858eaf999132131452662b6438e1?s=128&d=identicon&r=PG&f=1", "display_name": "pluffmud_xyz", "link": "https://stackoverflow.com/users/8400042/pluffmud-xyz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 588, "favorite_count": 0, "accepted_answer_id": 45440202, "answer_count": 2, "score": 0, "last_activity_date": 1501596614, "creation_date": 1501595728, "last_edit_date": 1501596002, "question_id": 45439883, "link": "https://stackoverflow.com/questions/45439883/casting-overlapping-structs-in-golang", "title": "casting overlapping structs in golang", "body": "<p>I'm new to golang and trying to figure out the correct way of casting a block of bytes to the correct struct. All structs start with two bytes that dictate the layout of the remaining bytes. In C I would point to the beginning of the block of memory and cast it as a simple struct that only contained those two bytes (X below) but here I get an invalid type assertion. I'm probably way off base here any help you be appreciated. </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype A struct {\n    tag   byte\n    ver   byte\n    data1 int\n    data2 int\n    data3 int\n}\n\ntype B struct {\n    tag   byte\n    ver   byte\n    data1 float32\n}\n\ntype X struct {\n    tag byte\n    ver byte\n}\n\nfunc main() {\n    var a A\n    a.tag = 1\n    a.ver = 1\n    x := a.(X)\n\n    fmt.Printf(\"%d,%d\", x.tag, x.ver)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/jDMXrmNESa\" rel=\"nofollow noreferrer\">playground link</a></p>\n"}, {"tags": ["java", "go"], "comments": [{"owner": {"reputation": 185247, "user_id": 135589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbd98f264c64096af168747c3ae71a7d?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/135589/jesper"}, "edited": false, "score": 0, "creation_date": 1501594658, "post_id": 45439343, "comment_id": 77839767, "body": "It converts a day number in the current year to a string with month and day number; for example, today is day 213 of the year 2017, when you pass 213 to this method it returns a string <code>&quot;0801&quot;</code> (August 1)."}, {"owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "reply_to_user": {"reputation": 185247, "user_id": 135589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbd98f264c64096af168747c3ae71a7d?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/135589/jesper"}, "edited": false, "score": 0, "creation_date": 1501595103, "post_id": 45439343, "comment_id": 77840129, "body": "@Jesper yeah, it seems pretty broken though. Doesn&#39;t accept the year as input, so there is really no way to handle leap years appropriately."}, {"owner": {"reputation": 185247, "user_id": 135589, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/dbd98f264c64096af168747c3ae71a7d?s=128&d=identicon&r=PG", "display_name": "Jesper", "link": "https://stackoverflow.com/users/135589/jesper"}, "reply_to_user": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "edited": false, "score": 0, "creation_date": 1501595457, "post_id": 45439343, "comment_id": 77840430, "body": "@captncraig indeed, it always uses the current year, so if you call this method in a leap year after Feb 29 it will give a different result than in a non-leap year for the same input value."}], "answers": [{"tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 0, "last_activity_date": 1501595038, "last_edit_date": 1501595038, "creation_date": 1501594635, "answer_id": 45439443, "question_id": 45439343, "link": "https://stackoverflow.com/questions/45439343/getqauntdate-method-explanation/45439443#45439443", "title": "getQauntdate() method explanation", "body": "<p>Annotated:</p>\n\n<pre><code>   // format string. This returns MMdd\n    final SimpleDateFormat sdf = new SimpleDateFormat(\"MMdd\");\n\n    //redundant re-declaration of function parameter\n    final int dayOfYear = quant;\n\n    // make a date and set DAY_OF_YEAR to quant\n    final Calendar calendar = Calendar.getInstance();\n    calendar.set(Calendar.DAY_OF_YEAR, dayOfYear);\n\n    // get date and return it in the correct format\n    final Date dat = calendar.getTime();\n    return sdf.format(dat);\n</code></pre>\n\n<p>Looks like the funtion takes a number, converts it to a date, and formats it.</p>\n\n<p><code>1</code> would yield <code>0101</code></p>\n\n<p><code>13</code> would give <code>0113</code></p>\n\n<p><code>32</code> would give <code>0201</code></p>\n\n<p>and so forth.</p>\n\n<p>It is not clear though, how this handles leap years and other variables like that. It does not seem like very high quality code, and I'd recommend analyzing your problem, and coming up with a good spec.</p>\n"}], "owner": {"reputation": 23, "user_id": 7560407, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8f634ea6fd3f2d6f1073ea99d808855?s=128&d=identicon&r=PG&f=1", "display_name": "boubker elamri", "link": "https://stackoverflow.com/users/7560407/boubker-elamri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 21, "favorite_count": 0, "accepted_answer_id": 45439443, "answer_count": 1, "score": -2, "last_activity_date": 1501595807, "creation_date": 1501594373, "last_edit_date": 1501595807, "question_id": 45439343, "link": "https://stackoverflow.com/questions/45439343/getqauntdate-method-explanation", "title": "getQauntdate() method explanation", "body": "<p>can someone explain to me the function of this methode that i found in a script:</p>\n\n<pre><code>public static String getQuantDate(final int quant) {\n        final SimpleDateFormat sdf = new SimpleDateFormat(\"MMdd\");\n        final int dayOfYear = quant;\n        final Calendar calendar = Calendar.getInstance();\n        calendar.set(Calendar.DAY_OF_YEAR, dayOfYear);\n        final Date dat = calendar.getTime();\n        return sdf.format(dat);\n    }\n</code></pre>\n\n<p>i need to traslate it to golang but i didn't understand the functionalities to translate it!</p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1501592407, "post_id": 45438526, "comment_id": 77837984, "body": "When &quot;sorting&quot; on a value that is not actually &quot;unique&quot; you need to keep track of something that &quot;is unique&quot; and then make sure you exclude those results by each &quot;ranged&quot; page. <a href=\"https://stackoverflow.com/questions/28105009/implementing-pagination-in-mongodb\">All explained in the linked answer.</a>"}, {"owner": {"reputation": 11, "user_id": 3863487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3718617eeb8de5fdfe9dd504fb1e142?s=128&d=identicon&r=PG&f=1", "display_name": "user3863487", "link": "https://stackoverflow.com/users/3863487/user3863487"}, "reply_to_user": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1501593088, "post_id": 45438526, "comment_id": 77838499, "body": "@NeilLunn I edited my query and added also <code>bson.DocElem{Name: &quot;slug&quot;, Value: 1},</code>  Now I see that I am getting no duplicates, is this correct approach?"}, {"owner": {"reputation": 129250, "user_id": 2313887, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/259593de18972d36e25f230c2be19d9f?s=128&d=identicon&r=PG", "display_name": "Neil Lunn", "link": "https://stackoverflow.com/users/2313887/neil-lunn"}, "edited": false, "score": 0, "creation_date": 1501593266, "post_id": 45438526, "comment_id": 77838636, "body": "How was <a href=\"https://stackoverflow.com/questions/28105009/implementing-pagination-in-mongodb\">&quot;read the linked duplicate question and answer&quot;&#39;</a> an unclear statement here? Your question has been asked before. Your question has been solved before. You &quot;exclude&quot; the same sort values from each page using <code>$nin</code> and an list of &quot;seen _id values&quot;. All <b>explained at length already</b>."}], "owner": {"reputation": 11, "user_id": 3863487, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b3718617eeb8de5fdfe9dd504fb1e142?s=128&d=identicon&r=PG&f=1", "display_name": "user3863487", "link": "https://stackoverflow.com/users/3863487/user3863487"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 44, "favorite_count": 0, "closed_date": 1501592319, "answer_count": 0, "score": 0, "last_activity_date": 1501593060, "creation_date": 1501592242, "last_edit_date": 1501593060, "question_id": 45438526, "link": "https://stackoverflow.com/questions/45438526/mongodb-pagination-duplicated-results", "closed_reason": "Duplicate", "title": "MongoDB pagination - Duplicated results", "body": "<p>So I have the following documents:</p>\n\n<pre><code>{\n    _id:596fc7d71aa95179315b27ea\n    check:1\n    pro:1\n    slug:\"ediloc.com marinescu\"\n}\n\n{\n    _id:596fd4661aa9517c7709475e\n    check:0\n    pro:1\n    slug:\"ediloc.com2\"\n}\n\n{\n    _id:5971ea3d1aa9515dcfee30ed\n    check:0\n    pro:0\n    slug:\"asirom\"\n}\n\n{\n    _id:5971f8871aa9516112e2e997\n    slug:\"aesirom2\"\n    check:0\n    pro:0\n}\n\n{\n    _id:597b9d741aa951452b8e6028\n    user_id:596fc73b1aa9517908b8a2f9\n    slug:\"bridgeway\"\n    check:0\n    pro:0\n}\n\n{\n    _id:597bb6d11aa951452b8e6029\n    slug:\"rca\"\n    check:1\n    pro:0\n}\n\n{\n    _id:597bce141aa9515587b821ad\n    slug:\"anabella\"\n    check:0\n    pro:0\n}\n\n{\n    _id:597bceaa1aa9515587b821ae\n    slug:\"diana\"\n    check:0\n    pro:0\n}\n\n{\n    _id:597bcee31aa9515587b821af\n    slug:\"ananas\"\n    check:0\n    pro:0\n}\n\n{\n    _id:597bd2a31aa95156f22e24f6\n    slug:\"plaza mall\"\n    check:0\n    pro:0\n}\n\n{\n    _id:597c63161aa95171192c54fd\n    slug:\"ediloc.com23423fg\"\n    check:1\n    pro:0\n}\n</code></pre>\n\n<p>And this is my MongoDB query in GO Language, I am retrieving all the documents that contain the string \"a\" and I sort them by PRO and CHECK fields:</p>\n\n<pre><code>var business []bson.M\n\noe := bson.M{\n    \"$match\": bson.M{\"slug\": bson.M{\"$regex\": \"a\"}},\n}\noa := bson.M{\n    \"$project\": bson.M {\"pro\": 1, \"check\": 1, \"slug\":1},\n}\nol := bson.M{\n    \"$limit\" :3,\n}\nos := bson.M{\n    \"$skip\" :skips, //this is 0,3,6,9 etc depending on the page number\n}\nor := bson.M{\n   \"$sort\": bson.D{\n        bson.DocElem{Name: \"pro\", Value: -1},\n        bson.DocElem{Name: \"check\", Value: -1},\n        bson.DocElem{Name: \"slug\", Value: 1},\n },\n}\n\n\npipe := c.Pipe([]bson.M{oe, or, oa, os, ol })\nif err := pipe.All(&amp;business); err != nil { \n    log.Printf(err.Error())\n}\n</code></pre>\n\n<p>Now these are the results that I am getting back for each page.</p>\n\n<p>Page 1:</p>\n\n<pre><code>{\n    _id:596fc7d71aa95179315b27ea\n    check:1\n    pro:1\n    slug:\"ediloc.com marinescu\"\n}\n\n{\n    _id:597bb6d11aa951452b8e6029\n    slug:\"rca\"\n    check:1\n    pro:0\n}\n\n{\n    _id:5971ea3d1aa9515dcfee30ed\n    check:0\n    pro:0\n    slug:\"asirom\"\n}\n</code></pre>\n\n<p>Page 2:</p>\n\n<pre><code>{\n    _id:597b9d741aa951452b8e6028\n    user_id:596fc73b1aa9517908b8a2f9\n    slug:\"bridgeway\"\n    check:0\n    pro:0\n}\n\n{\n    _id:5971f8871aa9516112e2e997\n    name:\"aesirom2\"\n    check:0\n    pro:0\n}\n\n{\n    _id:597bce141aa9515587b821ad\n    slug:\"anabella\"\n    check:0\n    pro:0\n}\n</code></pre>\n\n<p>Page 3:</p>\n\n<pre><code>{\n    _id:597bce141aa9515587b821ad\n    slug:\"anabella\"\n    check:0\n    pro:0\n}\n\n{\n    _id:5971f8871aa9516112e2e997\n    name:\"aesirom2\"\n    check:0\n    pro:0\n}\n\n{\n    _id:597bceaa1aa9515587b821ae\n    slug:\"diana\"\n    check:0\n    pro:0\n}\n</code></pre>\n\n<p>As you can see there are duplicated results on the second the third page.</p>\n\n<p>Any thoughts how I can write this query so it doesn't retrieve duplicated documents when you go to a different page?</p>\n"}, {"tags": ["windows", "hibernate", "go", "sleep"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1501585847, "post_id": 45436158, "comment_id": 77833013, "body": "I&#39;m not sure there is a simple cross platform solution, and yes, of course unix has power management."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1501586090, "post_id": 45436158, "comment_id": 77833182, "body": "well the cross-platform is an ideal, as i say windows is the initial target (and i suspect will present the biggest hurdle) so windows specific guidance would be much appreciated - FYI i was aware nix had power management but want sure if &quot;hibernate&quot; was an MS coined term"}], "answers": [{"comments": [{"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1501768920, "post_id": 45462051, "comment_id": 77933785, "body": "Thanks for the tips @Anders, upvoted for now - I was coming to the conclusions that the only way to do this was by calling kernel32.dll - I&#39;ve not done much CGO but I&#39;ve managed to gather a few examples and I will have a go at this in the coming days to confirm"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1502371978, "post_id": 45462051, "comment_id": 78189077, "body": "Thanks @anders SetThreadExecutionState seems to have done the trick, for anyone looking for a go specific example i have provided in second answer"}], "tags": [], "owner": {"reputation": 82917, "user_id": 3501, "user_type": "registered", "accept_rate": 30, "profile_image": "https://www.gravatar.com/avatar/1fd5f5cc203c393634379a3b3b7e7a87?s=128&d=identicon&r=PG", "display_name": "Anders", "link": "https://stackoverflow.com/users/3501/anders"}, "is_accepted": true, "score": 1, "last_activity_date": 1501679979, "last_edit_date": 1592644375, "creation_date": 1501679979, "answer_id": 45462051, "question_id": 45436158, "link": "https://stackoverflow.com/questions/45436158/how-to-to-stop-a-machine-from-sleeping-hibernating-for-execution-period/45462051#45462051", "title": "How to to stop a machine from sleeping/hibernating for execution period", "body": "<p>On Windows, your first step is to try <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa373208(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>SetThreadExecutionState</code></a>:</p>\n<blockquote>\n<p>Enables an application to inform the system that it is in use, thereby preventing the system from entering sleep or turning off the display while the application is running</p>\n</blockquote>\n<p>This is not a perfect solution but I assume this is not an issue for you:</p>\n<blockquote>\n<p>The SetThreadExecutionState function cannot be used to prevent the user from putting the computer to sleep. Applications should respect that the user expects a certain behavior when they close the lid on their laptop or press the power button</p>\n</blockquote>\n<p>The Windows 8 connected standby feature is also something you might need to consider. Looking at the power related APIs we find this description of <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd405534(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>PowerRequestSystemRequired</code></a>:</p>\n<blockquote>\n<p>The system continues to run instead of entering sleep after a period of user inactivity.</p>\n<p>This request type is not honored on systems capable of connected standby. Applications should use PowerRequestExecutionRequired requests instead.</p>\n</blockquote>\n<p>If you are dealing with tablets and other small devices then you can try to call <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/dd405534(v=vs.85).aspx\" rel=\"nofollow noreferrer\"><code>PowerSetRequest</code></a> with <code>PowerRequestExecutionRequired</code> to prevent this although the description of that is also not ideal:</p>\n<blockquote>\n<p>The calling process continues to run instead of being suspended or terminated by process lifetime management mechanisms. When and how long the process is allowed to run depends on the operating system and power policy settings.</p>\n</blockquote>\n<p>You might also want to use <code>ShutdownBlockReasonCreate</code> but I'm not sure if it blocks sleep/hibernate.</p>\n"}, {"tags": [], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "is_accepted": false, "score": 1, "last_activity_date": 1503151604, "last_edit_date": 1503151604, "creation_date": 1502371811, "answer_id": 45615169, "question_id": 45436158, "link": "https://stackoverflow.com/questions/45436158/how-to-to-stop-a-machine-from-sleeping-hibernating-for-execution-period/45615169#45615169", "title": "How to to stop a machine from sleeping/hibernating for execution period", "body": "<p>Thanks to Anders for pointing me in the right direction - I put together a minimal example in golang (see below).</p>\n\n<p>Note: polling to reset the timer seems to be the only reliable method, I found that when trying to combine with the continuous flag it would only take effect for approx 30 seconds (no idea why), having said that polling on this example is excessive and could probably be increased to 10 mins (since min hibernation time is 15 mins)</p>\n\n<p>Also FYI this is a windows specific example:</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"syscall\"\n    \"time\"\n)\n\n// Execution States\nconst (\n    EsSystemRequired = 0x00000001\n    EsContinuous     = 0x80000000\n)\n\nvar pulseTime = 10 * time.Second\n\nfunc main() {\n    kernel32 := syscall.NewLazyDLL(\"kernel32.dll\")\n    setThreadExecStateProc := kernel32.NewProc(\"SetThreadExecutionState\")\n\n    pulse := time.NewTicker(pulseTime)\n\n    log.Println(\"Starting keep alive poll... (silence)\")\n    for {\n        select {\n        case &lt;-pulse.C:\n            setThreadExecStateProc.Call(uintptr(EsSystemRequired))\n        }\n    }\n}\n</code></pre>\n\n<p>The above is tested on win 7 and 10 (not tested on Win 8 yet - presumed to work there too).</p>\n\n<p>Any user request to sleep will override this method, this includes actions such as shutting the lid on a laptop (unless power management settings are altered from defaults)</p>\n\n<p>The above were sensible behaviors for my application.</p>\n"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 945, "favorite_count": 0, "accepted_answer_id": 45462051, "answer_count": 2, "score": 1, "last_activity_date": 1503151604, "creation_date": 1501585771, "last_edit_date": 1501612655, "question_id": 45436158, "link": "https://stackoverflow.com/questions/45436158/how-to-to-stop-a-machine-from-sleeping-hibernating-for-execution-period", "title": "How to to stop a machine from sleeping/hibernating for execution period", "body": "<p>I have an app written in golang (partially), as part of its operation it will spawn an external process (written in c) and begin monitoring. This external process can take many hours to complete so I am looking for a way to prevent the machine from sleeping or hibernating whilst processing.</p>\n\n<p>I would like to be able to then relinquish this lock so that when the process is finished the machine is allowed to sleep/hibernate</p>\n\n<p>I am initially targeting windows, but a cross-platform solution would be ideal (does nix even hibernate?).</p>\n"}, {"tags": ["api", "go", "sharepoint", "sharepoint-2013"], "answers": [{"tags": [], "owner": {"reputation": 1610, "user_id": 1842261, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/0e47affe0b5b8143a52c6cd694abe6e8?s=128&d=identicon&r=PG", "display_name": "hbulens", "link": "https://stackoverflow.com/users/1842261/hbulens"}, "is_accepted": false, "score": 2, "last_activity_date": 1501589185, "creation_date": 1501589185, "answer_id": 45437376, "question_id": 45435105, "link": "https://stackoverflow.com/questions/45435105/sharepoint-api-using-golang/45437376#45437376", "title": "sharepoint API using Golang?", "body": "<p>As far as I know there aren't any libraries yet, but SharePoint 2013 and later version(s) have powerful <a href=\"https://dev.office.com/sharepoint/docs/sp-add-ins/get-to-know-the-sharepoint-rest-service\" rel=\"nofollow noreferrer\">REST APIs</a> you can use to interact with SharePoint objects. If there were libraries for Golang, I'd assume they were nothing more than a wrapper around the REST apis.</p>\n\n<p>There's plenty of <a href=\"https://dev.office.com/sharepoint/docs/sp-add-ins/complete-basic-operations-using-sharepoint-rest-endpoints\" rel=\"nofollow noreferrer\">documentation</a> and <a href=\"https://dev.office.com/sharepoint/docs/sp-add-ins/complete-basic-operations-using-sharepoint-rest-endpoints\" rel=\"nofollow noreferrer\">examples</a> that will help you with that. I answered a similar question here for <a href=\"https://stackoverflow.com/questions/30299629/sharepoint-api-for-java/30365510#30365510\">Java</a> a while ago.</p>\n"}], "owner": {"reputation": 577, "user_id": 4869236, "user_type": "registered", "accept_rate": 68, "profile_image": "https://graph.facebook.com/100002451204060/picture?type=large", "display_name": "Vijay Kumar", "link": "https://stackoverflow.com/users/4869236/vijay-kumar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1147, "favorite_count": 0, "closed_date": 1549271514, "answer_count": 1, "score": 0, "last_activity_date": 1501589185, "creation_date": 1501582585, "question_id": 45435105, "link": "https://stackoverflow.com/questions/45435105/sharepoint-api-using-golang", "closed_reason": "Not suitable for this site", "title": "sharepoint API using Golang?", "body": "<p>i want to know is there any example or package of golang developed for SHAREPOINT,\nPlease suggest,\nauthenticate sharepoint using golang api,\nlisting all the documents in sharepoint,\ngetting document from sharepoint to local using api.\nabove are some of the basic operations that an be done.</p>\n"}, {"tags": ["unit-testing", "http", "go", "ginkgo"], "answers": [{"comments": [{"owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "edited": false, "score": 0, "creation_date": 1501825317, "post_id": 45493871, "comment_id": 77958817, "body": "Thanks @Onsi , there are lot of issues in this code, which will be resolved later."}, {"owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "edited": false, "score": 0, "creation_date": 1501927503, "post_id": 45493871, "comment_id": 78001754, "body": "this throws <code>parse 127.0.0.1:45023&#47;path&#47;to&#47;somepage&#47;VOLUME: first path segment in URL cannot contain colon</code> error, what is the possibility."}], "tags": [], "owner": {"reputation": 71, "user_id": 4006400, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/353cad9585b53e8252da98cb55e9672e?s=128&d=identicon&r=PG&f=1", "display_name": "Onsi Fakhouri", "link": "https://stackoverflow.com/users/4006400/onsi-fakhouri"}, "is_accepted": false, "score": 3, "last_activity_date": 1577298437, "last_edit_date": 1577298437, "creation_date": 1501791673, "answer_id": 45493871, "question_id": 45434849, "link": "https://stackoverflow.com/questions/45434849/how-to-do-unit-testing-of-http-requests-using-ginkgo/45493871#45493871", "title": "How to do unit testing of HTTP requests using Ginkgo?", "body": "<p>Take a look at <code>ghttp</code> package:\n<a href=\"http://onsi.github.io/gomega/#ghttp-testing-http-clients\" rel=\"nofollow noreferrer\">http://onsi.github.io/gomega/#ghttp-testing-http-clients</a>\n<a href=\"https://godoc.org/github.com/onsi/gomega/ghttp\" rel=\"nofollow noreferrer\">https://godoc.org/github.com/onsi/gomega/ghttp</a></p>\n\n<p>A rough sketch might look like:</p>\n\n<pre><code>import (\n    \"os\"\n\n    . \"github.com/onsi/ginkgo/tmp\"\n    \"github.com/onsi/gomega/ghttp\"\n\n    . \"github.com/onsi/ginkgo\"\n    . \"github.com/onsi/gomega\"\n)\n\nvar _ = Describe(\"GetVolAnnotations\", func() {\n    var server *ghttp.Server\n    var returnedVolume Volume\n    var statusCode int\n\n    BeforeEach(func() {\n        server = ghttp.NewServer()\n        os.Setenv(\"SOME_ADDR\", server.Addr())\n\n        server.AppendHandlers(\n            ghttp.CombineHandlers(\n                ghttp.VerifyRequest(\"GET\", \"/path/to/somepage/VOLUME\"),\n                ghttp.RespondWithJSONEncodedPtr(&amp;statusCode, &amp;returnedVolume),\n            )\n        )\n    })\n\n    AfterEach(func() {\n        server.Close()\n    })\n\n    Context(\"When when the server returns a volume\", func() {\n        BeforeEach(func() {\n            returnedVolume = Volume{\n                Metadata: Metadata{\n                    Annotations: []string{\"foo\"}\n                }\n            }\n            statusCode = 200\n        })\n\n        It(\"returns the annotations associated with the volume\", func() {\n            Expect(GetVolAnnotations(\"VOLUME\")).To(Equal([]string{\"foo\"}))\n        })\n    })\n\n    Context(\"when the server returns 500\", func() {\n        BeforEach(func() {\n            statusCode = 500\n        })\n\n        It(\"errors\", func() {\n            value, err := GetVolAnnotations(\"VOLUME\")\n            Expect(value).To(BeNil())\n            Expect(err).To(HaveOccurred())\n        })\n    })\n\n    Context(\"when the server returns 503\", func() {\n        BeforEach(func() {\n            statusCode = 503\n        })\n\n        It(\"errors\", func() {\n            value, err := GetVolAnnotations(\"VOLUME\")\n            Expect(value).To(BeNil())\n            Expect(err).To(HaveOccurred())\n        })\n    })\n})\n</code></pre>\n\n<p>I think you've got a few issues with your code though.  If you get a 500 or 503 status code you won't necessarily have an <code>err</code> so you'll need to create and send back a custom error from your server.</p>\n"}], "owner": {"reputation": 113, "user_id": 6103729, "user_type": "registered", "accept_rate": 50, "profile_image": "https://graph.facebook.com/829073687198218/picture?type=large", "display_name": "Utkarsh Mani Tripathi", "link": "https://stackoverflow.com/users/6103729/utkarsh-mani-tripathi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2534, "favorite_count": 1, "answer_count": 1, "score": 1, "last_activity_date": 1577298437, "creation_date": 1501581857, "last_edit_date": 1576356993, "question_id": 45434849, "link": "https://stackoverflow.com/questions/45434849/how-to-do-unit-testing-of-http-requests-using-ginkgo", "title": "How to do unit testing of HTTP requests using Ginkgo?", "body": "<p>i have just started learning to write unit tests for the http requests, i went through several blogs but i didn't understood how to write tests for this using Ginkgo.</p>\n\n<pre><code>func getVolDetails(volName string, obj interface{}) error {\n    addr := os.Getenv(\"SOME_ADDR\")\n    if addr == \"\" {\n        err := errors.New(\"SOME_ADDR environment variable not set\")\n        fmt.Println(err)\n        return err\n    }\n    url := addr + \"/path/to/somepage/\" + volName\n    client := &amp;http.Client{\n        Timeout: timeout,\n    }\n    resp, err := client.Get(url)\n    if resp != nil {\n        if resp.StatusCode == 500 {\n            fmt.Printf(\"VSM %s not found\\n\", volName)\n            return err\n        } else if resp.StatusCode == 503 {\n            fmt.Println(\"server not reachable\")\n            return err\n        }\n    } else {\n        fmt.Println(\"server not reachable\")\n        return err\n    }\n\n    if err != nil {\n        fmt.Println(err)\n        return err\n    }\n    defer resp.Body.Close()\n\n    return json.NewDecoder(resp.Body).Decode(obj)\n}\n\n// GetVolAnnotations gets annotations of volume\nfunc GetVolAnnotations(volName string) (*Annotations, error) {\n    var volume Volume\n    var annotations Annotations\n    err := getVolDetails(volName, &amp;volume)\n    if err != nil || volume.Metadata.Annotations == nil {\n        if volume.Status.Reason == \"pending\" {\n            fmt.Println(\"VSM status Unknown to server\")\n        }\n        return nil, err\n    }\n    // Skipped some part,not required\n}\n</code></pre>\n\n<p>I went through this <a href=\"https://nathanleclaire.com/blog/2015/10/10/interfaces-and-composition-for-effective-unit-testing-in-golang/\" rel=\"nofollow noreferrer\">blog</a> and it exactly explains what my code requires but it uses Testing package and i want to implement this using ginkgo.</p>\n"}, {"tags": ["go", "beego"], "comments": [{"owner": {"reputation": 409, "user_id": 3152168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32de182081b9b54fd383d40fef3e079b?s=128&d=identicon&r=PG", "display_name": "AniSkywalker", "link": "https://stackoverflow.com/users/3152168/aniskywalker"}, "edited": false, "score": 0, "creation_date": 1501601985, "post_id": 45434675, "comment_id": 77845292, "body": "Instead of having an init() function, you should really do that in the main function. If you want to reduce the amount of stuff in main, make a function like NewController(Logger) that returns the controller, so that you can initialize the router in the main function--just a general idea for structure."}, {"owner": {"reputation": 409, "user_id": 3152168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32de182081b9b54fd383d40fef3e079b?s=128&d=identicon&r=PG", "display_name": "AniSkywalker", "link": "https://stackoverflow.com/users/3152168/aniskywalker"}, "edited": false, "score": 0, "creation_date": 1501602259, "post_id": 45434675, "comment_id": 77845464, "body": "Are you checking for errors when creating the logger? Go best practices for error returns are to return a nil pointer to the expected value and an error (i.e. return nil, err), so if it&#39;s failing to create the logger you would encounter this problem."}, {"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "reply_to_user": {"reputation": 409, "user_id": 3152168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32de182081b9b54fd383d40fef3e079b?s=128&d=identicon&r=PG", "display_name": "AniSkywalker", "link": "https://stackoverflow.com/users/3152168/aniskywalker"}, "edited": false, "score": 0, "creation_date": 1501635827, "post_id": 45434675, "comment_id": 77860842, "body": "@AniSkywalker Ofcourse I checked errors. just put the whole thing in the simplest possible way. Question is simple why o.Logger is nil?"}, {"owner": {"reputation": 409, "user_id": 3152168, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/32de182081b9b54fd383d40fef3e079b?s=128&d=identicon&r=PG", "display_name": "AniSkywalker", "link": "https://stackoverflow.com/users/3152168/aniskywalker"}, "edited": false, "score": 0, "creation_date": 1501636768, "post_id": 45434675, "comment_id": 77861082, "body": "I can&#39;t see why this is happening from the provided code. Could you make a minimal playground example?"}], "answers": [{"comments": [{"owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1510192110, "post_id": 47184952, "comment_id": 81334463, "body": "I&#39;m aware of the prepare method. Idea here is to use a single logger instance across all the controllers and the prepare method doesn&#39;t allow that. I do not think Go encourage factories or any design patterns which defeat the simplicity of the design."}, {"owner": {"reputation": 555, "user_id": 2253232, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/9MpKt.jpg?s=128&g=1", "display_name": "Matan Hafuta", "link": "https://stackoverflow.com/users/2253232/matan-hafuta"}, "reply_to_user": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "edited": false, "score": 0, "creation_date": 1510217329, "post_id": 47184952, "comment_id": 81343529, "body": "Go encourages working with interfaces, factory method allows you to do so very easily, I don&#39;t see any bad practice here. Additionally, until you will have solution to passing params in controller instance you need a way to populate the struct dependency, working with some sort of IoC container or factory to create the instances seems like a good solution, it can use the same Logger instance, it all depends on your implementation."}, {"owner": {"reputation": 61, "user_id": 8727628, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n0wt11wLfYk/AAAAAAAAAAI/AAAAAAAAAoo/2XMtvPTNpuo/photo.jpg?sz=128", "display_name": "ABAA", "link": "https://stackoverflow.com/users/8727628/abaa"}, "edited": false, "score": 0, "creation_date": 1584554439, "post_id": 47184952, "comment_id": 107474909, "body": "Is this allowed now?"}, {"owner": {"reputation": 555, "user_id": 2253232, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/9MpKt.jpg?s=128&g=1", "display_name": "Matan Hafuta", "link": "https://stackoverflow.com/users/2253232/matan-hafuta"}, "reply_to_user": {"reputation": 61, "user_id": 8727628, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-n0wt11wLfYk/AAAAAAAAAAI/AAAAAAAAAoo/2XMtvPTNpuo/photo.jpg?sz=128", "display_name": "ABAA", "link": "https://stackoverflow.com/users/8727628/abaa"}, "edited": false, "score": 0, "creation_date": 1585965373, "post_id": 47184952, "comment_id": 107958960, "body": "@ABAA in latest Beego versions you can pass dependencies when creating controller instance."}], "tags": [], "owner": {"reputation": 555, "user_id": 2253232, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/9MpKt.jpg?s=128&g=1", "display_name": "Matan Hafuta", "link": "https://stackoverflow.com/users/2253232/matan-hafuta"}, "is_accepted": false, "score": 0, "last_activity_date": 1510158819, "creation_date": 1510158819, "answer_id": 47184952, "question_id": 45434675, "link": "https://stackoverflow.com/questions/45434675/passing-a-global-reference-to-beego-controllers/47184952#47184952", "title": "Passing a global reference to beego controllers", "body": "<p>Beego uses reflection to create a controller instance for each request, it doesn't use the actual instance you pass in and it doesn't passes the params to the new instances. You can define \"Prepare\" method on your controller which will be called by Beego in runtime before invoking the matched controller method, there you can initialize the required struct fields (e.g. service layer) by calling a factory method or some sort of IoC container (Not sure if this is the best practice for Go)</p>\n\n<p>I also looked for an option to pass dependencies when initializing the struct but it's not possible at the moment.</p>\n\n<p>Take a look on the request handling logic: <a href=\"https://beego.me/docs/mvc/\" rel=\"nofollow noreferrer\">https://beego.me/docs/mvc/</a></p>\n\n<p>Prepare method is documented here:\n<a href=\"https://beego.me/docs/mvc/controller/controller.md\" rel=\"nofollow noreferrer\">https://beego.me/docs/mvc/controller/controller.md</a></p>\n"}], "owner": {"reputation": 2626, "user_id": 1400204, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/T8OEV.jpg?s=128&g=1", "display_name": "Anuruddha", "link": "https://stackoverflow.com/users/1400204/anuruddha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 888, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1510158819, "creation_date": 1501581385, "question_id": 45434675, "link": "https://stackoverflow.com/questions/45434675/passing-a-global-reference-to-beego-controllers", "title": "Passing a global reference to beego controllers", "body": "<p>I'm trying to pass a logger reference initialised inside main.go to Controller layer via the router like bellow</p>\n\n<p>main.go</p>\n\n<pre><code>logger, _ := zap.NewProduction()\ndefer logger.Sync() // flushes buffer, if any\nsugar := logger.Sugar()\nrouters.Init(sugar)\n</code></pre>\n\n<p>routers.go</p>\n\n<pre><code>func Init(l *zap.SugaredLogger) {\n   nsMgt := beego.NewNamespace(\"/api\",\n    beego.NSNamespace(\"/account\",\n        beego.NSInclude(\n            &amp;controllers.AccountController{\n                Logger: l,\n            },\n        ),\n    ),\n   )\n)\n</code></pre>\n\n<p>controller.go</p>\n\n<pre><code>type AccountController struct {\n   beego.Controller\n   Logger *zap.SugaredLogger\n}\n\n// @Title Get account details.\n// @Summary Get account details\n// @Param   filterKey query string  true \"possible values 'id' or 'username'\"\n// @Param   filterValue query string  true \"value of the filter key\"\n// @Success 200 {object} models.User\n// @router / [get]\nfunc (o *AccountController) Get() {\n     o.Logger.Info(\"this is cool\")\n}\n</code></pre>\n\n<p>It throws a null pointer error at the controller function. Is there a way to pass a global logger variable to controller layer?. It's important to initialise the logger at the main function 'cause it requires a defered close.</p>\n"}, {"tags": ["go", "types"], "answers": [{"comments": [{"owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1501651359, "post_id": 45434916, "comment_id": 77865067, "body": "Thanks! It&#39;s not exactly what I went with (my real application is also more complex than the example I have), but it got me on the right track. Especially creating <code>Fill</code> methods and sth like a <code>ChangesetTyped</code> helped cutting down the complexity a lot. I still feel (just my personal opinion) that Go has no optimal solution to offer here, but within the limits of the language I achieved something maintainable. :-)"}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "reply_to_user": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "edited": false, "score": 0, "creation_date": 1501660423, "post_id": 45434916, "comment_id": 77870023, "body": "I know the feeling. Coming from python I was used to generalise a lot and that seemed like the goal of good coding. With go this is not the case and it took some time and to adjust my thinking -- and still adjusting..."}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 0, "last_activity_date": 1501582044, "creation_date": 1501582044, "answer_id": 45434916, "question_id": 45433986, "link": "https://stackoverflow.com/questions/45433986/how-to-model-this-composite-type-hierarchy-without-generics/45434916#45434916", "title": "How to model this composite type hierarchy without generics", "body": "<p>have a look at <a href=\"https://play.golang.org/p/T-8l0voCDC\" rel=\"nofollow noreferrer\">this solution</a>. It is one possible solution.</p>\n\n<p>Generally: you want to work with interfaces here. In the sample I use the interface <code>DataRow</code> to store data of a row of any table. All table structs have to implement 2 functions as you can see in my example. (Also see my note about a general function in a base class with generics)</p>\n\n<p>Here the code again:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Foo struct {\n    Id string\n}\n\nfunc (s *Foo) Fill(m map[string]string) {\n    // If you want to build a general Fill you can build a base struct for Foo, Bar, etc. that works with reflect. \n    // Note that it will be slower than implementing the function here! Ask me if you want one I built recently.\n\n    s.Id = m[\"id\"]\n}\n\nfunc (s *Foo) GetRow() interface{} {\n    return nil\n}\n\ntype Bar struct {\n    Id string\n}\n\nfunc (s *Bar) Fill(m map[string]string) {\n    s.Id = m[\"id\"]\n}\n\nfunc (s *Bar) GetRow() interface{} {\n    return nil\n}\n\ntype DataRow interface {\n    Fill(m map[string]string)\n    GetRow() interface{}\n}\n\ntype Changeset struct {\n    Table   string\n    Type    string\n    OldData map[string]string\n    NewData map[string]string\n}\n\ntype ChangesetTyped struct {\n    Table   string\n    Type    string\n    OldData DataRow\n    NewData DataRow\n}\n\nfunc doMap(c Changeset) ChangesetTyped {\n    ct := ChangesetTyped{\n        Table:   c.Table,\n        Type:    c.Type,\n        OldData: parseRow(c.Table, c.OldData),\n    }\n\n    if c.Type == \"UPDATE\" {\n        ct.NewData = parseRow(c.Table, c.NewData)\n    }\n\n    return ct\n}\n\nfunc parseRow(table string, data map[string]string) (row DataRow) {\n    if table == \"foo\" {\n        row = &amp;Foo{}\n    } else if table == \"bar\" {\n        row = &amp;Bar{}\n    }\n\n    row.Fill(data)\n    return\n}\n\nfunc main() {\n    i := Changeset{\n        Table:   \"foo\",\n        Type:    \"INSERT\",\n        NewData: map[string]string{\"id\": \"1\"},\n    }\n\n    u1 := Changeset{\n        Table:   \"foo\",\n        Type:    \"UPDATE\",\n        OldData: map[string]string{\"id\": \"20\"},\n        NewData: map[string]string{\"id\": \"21\"},\n    }\n\n    u2 := Changeset{\n        Table:   \"bar\",\n        Type:    \"UPDATE\",\n        OldData: map[string]string{\"id\": \"30\"},\n        NewData: map[string]string{\"id\": \"31\"},\n    }\n\n    m1 := doMap(i)\n    m2 := doMap(u1)\n    m3 := doMap(u2)\n\n    fmt.Println(m1, m1.OldData)\n    fmt.Println(m2, m2.OldData, m2.NewData)\n    fmt.Println(m3, m3.OldData, m3.NewData)\n}\n</code></pre>\n\n<p>If you want to get the actual row from <code>DataRow</code> cast to the correct type use (of type Foo in this example):</p>\n\n<pre><code>foo, ok := dt.GetRow().(Foo)\nif !ok {\n    fmt.Println(\"it wasn't of type Foo after all\")\n}\n</code></pre>\n\n<p>Hope this helps you in you golang quest!</p>\n"}], "owner": {"reputation": 14748, "user_id": 132728, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/3e932264fb24dfdfd63dc467bfb1e957?s=128&d=identicon&r=PG", "display_name": "Max", "link": "https://stackoverflow.com/users/132728/max"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 45434916, "answer_count": 1, "score": 2, "last_activity_date": 1501582044, "creation_date": 1501579622, "question_id": 45433986, "link": "https://stackoverflow.com/questions/45433986/how-to-model-this-composite-type-hierarchy-without-generics", "title": "How to model this composite type hierarchy without generics", "body": "<p>I have a system that parses a logfile which contains changesets of mysql tables, think of something like a binlog. There can be updates and inserts, deletes we ignore for now. The function of my module gets an input like this:</p>\n\n<pre><code>type Changeset struct {\n    Table string // which table was affected\n    Type string // INSERT or UPDATE\n    OldData map[string]string // these 2 fields contain all columns of a table row\n    NewData map[string]string\n}\n</code></pre>\n\n<p><code>OldData</code> is empty when it's an <code>INSERT</code> changeset, when it's an <code>UPDATE</code> changeset, <code>OldData</code> and <code>NewData</code> are filled (the data before and after the update).</p>\n\n<p>Now I don't want to work with untyped data like this in my module, as I need to model some domain and it would be nicer to have some type safety. However, I need to still retain the knowledge if a change was an insert or an update for that domain logic (like, if it's an update, I will validate that some fields didn't change, as an example). </p>\n\n<p>Assume I have two tables (let's say they only have one field named Id, but in reality they have more and different ones). So I modeled these objects like so:</p>\n\n<pre><code>type Foo struct { // foo table\n    Id string\n    // ... imagine more fields  here ...\n}\n\ntype Bar struct { // bar table\n    Id string\n    // ... imagine more fields  here ...\n}\n</code></pre>\n\n<p>Now I can map the <code>map[string][string]</code> from <code>Changeset.OldData</code> and <code>Changeset.NewData</code>, but then I don't know anymore if the change was an insert or an update. I was thinking a bit back and forth, but the best I came up with was:</p>\n\n<pre><code>type FooInsert struct {\n    New Foo\n}\n\ntype FooUpdate struct {\n    New Foo\n    Old Foo\n}\n\ntype BarInsert struct {\n    New Bar\n}\n\ntype BarUpdate struct {\n    New Bar\n    Old Bar\n}\n</code></pre>\n\n<p>And the mapping code looks like this:</p>\n\n<pre><code>func doMap(c Changeset) interface{} {\n    if c.Table == \"foo\" {\n        switch c.Type {\n            case \"UPDATE\":\n                return FooUpdate{Old: Foo{Id: c.OldData[\"id\"]}, New: Foo{Id: c.NewData[\"id\"]}}\n\n            case \"INSERT\":\n                return FooInsert{New: Foo{Id: c.NewData[\"id\"]}}\n        }\n    }\n\n    if c.Table == \"bar\" {\n        switch c.Type {\n                // ... almost same as above, but return BarUpdate/BarInsert ...\n        }\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>The upside is, it enables me to write do do a typeswitch on the result of this mapping function like so:</p>\n\n<pre><code>insertChangeset := Changeset{\n    Table: \"foo\",\n    Type: \"INSERT\",\n    NewData: map[string]string{\"id\": \"1\"},\n}\n\no := doMap(insertChangeset)\n\nswitch o.(type) {\n    case BarUpdate:\n        println(\"Got an update of table bar\")\n\n    case FooUpdate:\n        println(\"Got an update of table foo\")\n\n    case BarInsert:\n        println(\"Got an insert to table bar\")\n\n    case FooInsert:\n        println(\"Got an insert to table foo\")           \n}\n</code></pre>\n\n<p>The typeswitch is what I would need to have in the end (different types per change changeset type and per entity.) But:</p>\n\n<ul>\n<li>the mapping code as seen in <code>doMap</code> is very ugly and repetitive.</li>\n<li>for every new entity <code>X</code> I introduce, I need to create two more types <code>XInsert</code> and <code>XUpdate</code>.</li>\n</ul>\n\n<p>Is there any way around this mess? In other programming languages I might have thought of something like:</p>\n\n<pre><code>type Update&lt;T&gt; {\n    T Old\n    T New\n}\n\ntype Insert&lt;T&gt; {\n    T New\n}\n</code></pre>\n\n<p>But not sure how to model this in Go. I created also a playground sample that shows the whole code in one program: <a href=\"https://play.golang.org/p/ZMnB5K7RaI\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ZMnB5K7RaI</a></p>\n"}, {"tags": ["go", "bit-shift"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1501578403, "post_id": 45433505, "comment_id": 77827867, "body": "Why should it be zero? Any number shifted by zero bits equals to itself."}, {"owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "edited": false, "score": 3, "creation_date": 1501578429, "post_id": 45433505, "comment_id": 77827884, "body": "You are shifting it with 0: meaning no shift at all."}, {"owner": {"reputation": 1571, "user_id": 5536005, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/91e3d5aa2f1aa02b6d96c7cd85ec14a9?s=128&d=identicon&r=PG&f=1", "display_name": "radbrawler", "link": "https://stackoverflow.com/users/5536005/radbrawler"}, "edited": false, "score": 1, "creation_date": 1501578486, "post_id": 45433505, "comment_id": 77827919, "body": "Well, in any languange you&#39;ll get the same.!"}, {"owner": {"reputation": 4946, "user_id": 2656614, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/rJz0Z.png?s=128&g=1", "display_name": "Addison", "link": "https://stackoverflow.com/users/2656614/addison"}, "edited": false, "score": 0, "creation_date": 1501630929, "post_id": 45433505, "comment_id": 77859670, "body": "Please consider accepting the answer, if it helped resolve your problem."}], "answers": [{"comments": [{"owner": {"reputation": 468, "user_id": 1419699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2206636f865bb23f39ead67c6d820098?s=128&d=identicon&r=PG", "display_name": "Ticks", "link": "https://stackoverflow.com/users/1419699/ticks"}, "edited": false, "score": 0, "creation_date": 1501581420, "post_id": 45433618, "comment_id": 77830013, "body": "I just think it means taking 0 and left shifting 1 bit, my mistake!"}], "tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 4, "last_activity_date": 1501578606, "creation_date": 1501578606, "answer_id": 45433618, "question_id": 45433505, "link": "https://stackoverflow.com/questions/45433505/in-go-language-why-the-0-operation-will-get-1/45433618#45433618", "title": "In Go language, why the &quot;&lt;&lt;0&quot; operation will get 1?", "body": "<p>1 &lt;&lt; 0 means:</p>\n\n<p>Take 1 and don't shift it. The result should be the original number: 1</p>\n"}], "owner": {"reputation": 468, "user_id": 1419699, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2206636f865bb23f39ead67c6d820098?s=128&d=identicon&r=PG", "display_name": "Ticks", "link": "https://stackoverflow.com/users/1419699/ticks"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 62, "favorite_count": 0, "accepted_answer_id": 45433618, "answer_count": 1, "score": -2, "last_activity_date": 1531343152, "creation_date": 1501578314, "last_edit_date": 1531343152, "question_id": 45433505, "link": "https://stackoverflow.com/questions/45433505/in-go-language-why-the-0-operation-will-get-1", "title": "In Go language, why the &quot;&lt;&lt;0&quot; operation will get 1?", "body": "<p>I am quite confused about the go left shift operator. I run the following code:</p>\n\n<pre><code>package main\n\nfunc main(){\n    var x = 1 &lt;&lt; 0\n    println(x)\n}\n</code></pre>\n\n<p>And I get 1. But I think the result should be zero.  </p>\n"}, {"tags": ["go", "time"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1501586439, "last_edit_date": 1501586439, "creation_date": 1501577261, "answer_id": 45433106, "question_id": 45432924, "link": "https://stackoverflow.com/questions/45432924/operation-on-seconds-in-function/45433106#45433106", "title": "Operation on seconds in function", "body": "<p><a href=\"https://golang.org/pkg/time/#Time\" rel=\"nofollow noreferrer\"><code>time.Time</code></a> has no exported field <code>Second</code>, so <code>startTime.Second</code> is invalid.</p>\n\n<p>There is a <a href=\"https://golang.org/pkg/time/#Time.Add\" rel=\"nofollow noreferrer\"><code>Time.Add()</code></a> method which you may use to add a <a href=\"https://golang.org/pkg/time/#Duration\" rel=\"nofollow noreferrer\"><code>time.Duration</code></a> value to a <code>time.Time</code> value. And to subtract a duration from it, simply multiply the value you add with <code>-1</code>.</p>\n\n<pre><code>func (bt *Hc34) getStartDate(endTime time.Time, duration int) time.Time {\n    return endTime.Add(time.Duration(-duration) * time.Second)\n}\n</code></pre>\n\n<p>Example with a <code>getStartDate()</code> function (not method):</p>\n\n<pre><code>now := time.Now()\nfmt.Println(now)\nfmt.Println(getStartDate(now, 60))\n</code></pre>\n\n<p>Output on the <a href=\"https://play.golang.org/p/4sBbetvX92\" rel=\"nofollow noreferrer\">Go Playground</a>:</p>\n\n<pre><code>2009-11-10 23:00:00 +0000 UTC\n2009-11-10 22:59:00 +0000 UTC\n</code></pre>\n\n<p>I also recommend to read this answer about using <code>time.Duration</code> values constructed from integers: <a href=\"https://stackoverflow.com/questions/41503758/conversion-of-time-duration-type-microseconds-value-to-milliseconds-in-golang/41503910#41503910\">Conversion of time.Duration type microseconds value to milliseconds</a></p>\n"}], "owner": {"reputation": 23, "user_id": 7560407, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8f634ea6fd3f2d6f1073ea99d808855?s=128&d=identicon&r=PG&f=1", "display_name": "boubker elamri", "link": "https://stackoverflow.com/users/7560407/boubker-elamri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 56, "favorite_count": 0, "accepted_answer_id": 45433106, "answer_count": 1, "score": 1, "last_activity_date": 1501586439, "creation_date": 1501576771, "last_edit_date": 1501586318, "question_id": 45432924, "link": "https://stackoverflow.com/questions/45432924/operation-on-seconds-in-function", "title": "Operation on seconds in function", "body": "<p>I'm currently working on a project and I face a problem in a function that returns the <code>startTime</code> of a call. Here is my code:</p>\n\n<pre><code>func (bt *Hc34) getStartDate(endTime time.Time, duration int) time.Time {\n     startTime := endTime\n     startTime.Second = endTime.Second - duration\n\n     return startTime\n}\n</code></pre>\n\n<p>And I get this error:</p>\n\n<pre><code>beater/hc34.go:268: invalid operation: endTime.Second - duration (mismatched types func() int and int)\nbeater/hc34.go:268: cannot assign to startTime.Second\n</code></pre>\n"}, {"tags": ["go", "casting"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1501577483, "post_id": 45432904, "comment_id": 77827229, "body": "<a href=\"https://stackoverflow.com/questions/12753805/type-converting-slices-of-interfaces-in-go\" title=\"type converting slices of interfaces in go\">stackoverflow.com/questions/12753805/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501617875, "post_id": 45432904, "comment_id": 77854590, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/12753805/type-converting-slices-of-interfaces-in-go\">Type converting slices of interfaces in go</a>"}], "answers": [{"tags": [], "owner": {"reputation": 5467, "user_id": 6220193, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5ce5723ea1716955e1f492c59d5cb5cb?s=128&d=identicon&r=PG", "display_name": "TehSphinX", "link": "https://stackoverflow.com/users/6220193/tehsphinx"}, "is_accepted": true, "score": 2, "last_activity_date": 1501579574, "creation_date": 1501579574, "answer_id": 45433958, "question_id": 45432904, "link": "https://stackoverflow.com/questions/45432904/golang-type-cast-rule/45433958#45433958", "title": "golang type cast rule", "body": "<p>For \"why\" see the <a href=\"https://stackoverflow.com/questions/12753805/type-converting-slices-of-interfaces-in-go\">link posted by mkopriva</a>. The following answer is regarding your original case.</p>\n\n<p>In the first case you could cast each <code>map[string]interface{}</code> individually (looping over them) and then cast <code>[]Row</code> to <code>Rows</code>. You cannot cast the whole thing at once. The cast from []Row to Rows can be done implicitly.</p>\n\n<p>Here your <a href=\"https://play.golang.org/p/WDWl7W070I\" rel=\"nofollow noreferrer\">test snippet</a> with the described ways to cast it.</p>\n\n<pre><code>package main\n\ntype (\n    Row  map[string]interface{}\n    Rows []Row\n)\n\nfunc do(data Rows) {}\n\nfunc main() {\n    var (\n        data []map[string]interface{}\n        rws []Row\n        rows Rows\n    )\n    for _, r := range data {\n        rws = append(rws, Row(r))\n        rows = append(rows, Row(r))\n    }\n    do(Rows(rws))  // possible but not necessary\n    do(rws)        // this works just fine\n    do(rows)\n}\n</code></pre>\n"}], "owner": {"reputation": 604, "user_id": 2265106, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/IKHQK.png?s=128&g=1", "display_name": "xrfang", "link": "https://stackoverflow.com/users/2265106/xrfang"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 346, "favorite_count": 0, "accepted_answer_id": 45433958, "answer_count": 1, "score": 2, "last_activity_date": 1501579574, "creation_date": 1501576731, "question_id": 45432904, "link": "https://stackoverflow.com/questions/45432904/golang-type-cast-rule", "title": "golang type cast rule", "body": "<p>The following code generated an error:</p>\n\n<p><code>./main.go:12: cannot use data (type []map[string]interface {}) as type Rows in argument to do</code></p>\n\n<pre><code>package main\n\ntype (\n    Row  map[string]interface{}\n    Rows []Row\n)\n\nfunc do(data Rows) {}\n\nfunc main() {\n    var data []map[string]interface{}\n    do(data)\n}\n</code></pre>\n\n<p>If I try to do a type cast, e.g. <code>do(Rows(data))</code>, go said:</p>\n\n<p><code>./main.go:12: cannot convert data (type []map[string]interface {}) to type Rows</code></p>\n\n<p>However, the following version compiles OK:</p>\n\n<pre><code>package main\n\ntype Rows []map[string]interface{}\n\nfunc do(data Rows) {}\n\nfunc main() {\n    var data []map[string]interface{}\n    do(data)\n}\n</code></pre>\n\n<p>Could anyone explain why? In the first case, is there any proper way to do the typecast?</p>\n"}, {"tags": ["go", "mgo"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1501576898, "post_id": 45432483, "comment_id": 77826822, "body": "In Go you can&#39;t <b>inherit</b> stuff a la classical OOP. What you have there is an <b>embedded</b> type. <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow noreferrer\">golang.org/doc/effective_go.html#embedding</a>"}, {"owner": {"reputation": 4704, "user_id": 390230, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4efcd03d549475bd6138a98543b241bf?s=128&d=identicon&r=PG", "display_name": "Shwetanka", "link": "https://stackoverflow.com/users/390230/shwetanka"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1501579887, "post_id": 45432483, "comment_id": 77828902, "body": "I missed this earlier. Thanks."}], "answers": [{"comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 1, "creation_date": 1501576107, "post_id": 45432623, "comment_id": 77826329, "body": "A conversion is not needed, just call the embedded struct by <code>mgo.DialWithInfo(mongoConfig.DialInfo)</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1501580435, "post_id": 45432623, "comment_id": 77829302, "body": "@Vadyus you can&#39;t convert the embedding type <code>MongoDBConfig</code> into the embedded type <code>mgo.DialInfo</code>. Your code example is not even gonna compile."}], "tags": [], "owner": {"reputation": 1169, "user_id": 498109, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/100036fbeed75b1abf5bf0161d1fb560?s=128&d=identicon&r=PG", "display_name": "Vadyus", "link": "https://stackoverflow.com/users/498109/vadyus"}, "is_accepted": true, "score": -1, "last_activity_date": 1501582118, "last_edit_date": 1501582118, "creation_date": 1501575894, "answer_id": 45432623, "question_id": 45432483, "link": "https://stackoverflow.com/questions/45432483/golang-type-mismatch-when-using-inherited-struct/45432623#45432623", "title": "golang type mismatch when using inherited struct", "body": "<p>Access embeded field explicitly:</p>\n\n<pre><code> session, mongoerr := mgo.DialWithInfo(mongoConfig.DialInfo)\n</code></pre>\n"}], "owner": {"reputation": 4704, "user_id": 390230, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/4efcd03d549475bd6138a98543b241bf?s=128&d=identicon&r=PG", "display_name": "Shwetanka", "link": "https://stackoverflow.com/users/390230/shwetanka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 477, "favorite_count": 0, "accepted_answer_id": 45432623, "answer_count": 1, "score": 0, "last_activity_date": 1501582118, "creation_date": 1501575457, "question_id": 45432483, "link": "https://stackoverflow.com/questions/45432483/golang-type-mismatch-when-using-inherited-struct", "title": "golang type mismatch when using inherited struct", "body": "<pre><code>    type MongoDBConfig struct {\n    *mgo.DialInfo\n}\n\nfunc ConfigureMongoDB() (*MongoDBConfig, error) {\n    //Get gopath\n\n    GOPATH := os.Getenv(\"GOPATH\")\n\n    file, err := os.Open(GOPATH+RESOURCE_PATH)\n\n    if err != nil {\n        return nil, err\n    }\n    decoder := json.NewDecoder(file)\n\n    mongoConfig := MongoDBConfig{}\n\n    er := decoder.Decode(&amp;mongoConfig)\n\n    if er != nil {\n        return nil, er\n    }\n    return &amp;mongoConfig, nil\n}\n\nfunc InitMongoDB() (*Session, error){\n\n    mongoConfig, err := ConfigureMongoDB()\n\n    if err != nil {\n        return nil, err\n    }\n\n    session, mongoerr := mgo.DialWithInfo(mongoConfig)\n\n}\n</code></pre>\n\n<p>Getting error in the last line while passing mongoConfig. I created the struct type of MongoDBConfig using DialInfo type.</p>\n\n<blockquote>\n  <p>Cannot use mongoConfig (type * MongoDBConfig) as type *DialInfo</p>\n</blockquote>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": true, "score": 2, "last_activity_date": 1501571006, "creation_date": 1501571006, "answer_id": 45431068, "question_id": 45430207, "link": "https://stackoverflow.com/questions/45430207/function-signatures-as-type/45431068#45431068", "title": "Function signatures as type", "body": "<p>Because the function is a reference you do not need to use any pointers or try to take an address of the function.<br>\nJust declare    </p>\n\n<pre><code>func (wm *WM) AddListener(listener MessageListener) error {\n...\n}\n// and get rid of taken address of function\nwm.AddListener(service.receiveMessage)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 1, "last_activity_date": 1501576419, "last_edit_date": 1501576419, "creation_date": 1501572595, "answer_id": 45431544, "question_id": 45430207, "link": "https://stackoverflow.com/questions/45430207/function-signatures-as-type/45431544#45431544", "title": "Function signatures as type", "body": "<p><code>MessageListener</code> is already a <em>function pointer</em> so you can simply define <code>AddListener</code> as </p>\n\n<pre><code>func (wm *WM) AddListener(listener MessageListener) error {\n    //...\n}\n</code></pre>\n\n<p>A listener then can be registered by calling <code>wm.AddListener(service.receiveMessage)</code>. </p>\n\n<p>From specifications of <a href=\"https://golang.org/ref/spec#Address_operators\" rel=\"nofollow noreferrer\">Address operator</a>:</p>\n\n<blockquote>\n  <p>For an operand x of type T, the address operation &amp;x generates a pointer of type *T to x. The operand must be addressable, that is, either a variable, pointer indirection, or slice indexing operation; or a field selector of an addressable struct operand; or an array indexing operation of an addressable array. As an exception to the addressability requirement, x may also be a (possibly parenthesized) composite literal. If the evaluation of x would cause a run-time panic, then the evaluation of &amp;x does too. </p>\n</blockquote>\n\n<p>So you can't takes the address of a function/method. However, you can takes the address of a variable that stores function/method. It is valid to declare the listener as </p>\n\n<pre><code>func (wm *WM) AddListener(listener *MessageListener) error {\n    //...\n}\n</code></pre>\n\n<p>but then when registering a listener, do the following:</p>\n\n<pre><code>var fn MessageListener = service.receiveMessage\nwm.AddListener(&amp;fn)\n</code></pre>\n\n<p>and when calling the listener:</p>\n\n<pre><code>msg := Message{//...}\n(*wm.listener)(&amp;msg)\n</code></pre>\n\n<p>which adds unnecessary codes for converting function variable to pointer then converting back to function variable. </p>\n"}], "owner": {"reputation": 22172, "user_id": 1263942, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/b272a5e1d5d3589192d942552e51e2a8?s=128&d=identicon&r=PG", "display_name": "Bruno Grieder", "link": "https://stackoverflow.com/users/1263942/bruno-grieder"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 99, "favorite_count": 0, "accepted_answer_id": 45431068, "answer_count": 2, "score": 0, "last_activity_date": 1501576419, "creation_date": 1501568151, "question_id": 45430207, "link": "https://stackoverflow.com/questions/45430207/function-signatures-as-type", "title": "Function signatures as type", "body": "<p>I have a type for a function signature defined as</p>\n\n<pre><code>type MessageListener func(msg *Message) bool\n</code></pre>\n\n<p>In a struct, I have the following function defined which basically registers a Listener with the function signature defined by the type above</p>\n\n<pre><code>func (wm *WM) AddListener(listener *MessageListener) error {\n...\n}\n</code></pre>\n\n<p>My service struct</p>\n\n<pre><code>type Service struct {\n     ...\n}\n\nfunc (service *Service) receiveMessage(msg *Message) bool {\n    ...\n}\n</code></pre>\n\n<p>Why am I getting an incompatible type error when I do </p>\n\n<pre><code>wm.AddListener(&amp;service.receiveMessage)\n</code></pre>\n\n<p>Doesn't <code>service.receiveMessage</code> have the type <code>MessageListener</code> ?</p>\n"}, {"tags": ["string", "go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1501568363, "post_id": 45430126, "comment_id": 77821469, "body": "How did you send it? Code snippet please."}, {"owner": {"reputation": 387, "user_id": 5467006, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5dac0b49b659331a68dd3476a8055839?s=128&d=identicon&r=PG&f=1", "display_name": "space earth", "link": "https://stackoverflow.com/users/5467006/space-earth"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1501568534, "post_id": 45430126, "comment_id": 77821562, "body": "Code snippet added in question"}, {"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1501570221, "post_id": 45430126, "comment_id": 77822484, "body": "What is <code>common.MapStr</code>? Did you send the <code>event</code> using JSON format? If yes, then when marshalling <code>event</code> to JSON, the <i>double quote</i> will be escaped, i.e. <code>&quot;</code> will be converted to <code>\\&quot;</code>. In your case, how the data should be received at server side (the expected JSON for <code>event</code>)?"}, {"owner": {"reputation": 387, "user_id": 5467006, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5dac0b49b659331a68dd3476a8055839?s=128&d=identicon&r=PG&f=1", "display_name": "space earth", "link": "https://stackoverflow.com/users/5467006/space-earth"}, "reply_to_user": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 0, "creation_date": 1501570566, "post_id": 45430126, "comment_id": 77822692, "body": "Yes.I am sending data as json..But sever side also it get like same only"}, {"owner": {"reputation": 40328, "user_id": 86967, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/624a9d99ab6293522102feab52c61f36?s=128&d=identicon&r=PG&f=1", "display_name": "Brent Bradburn", "link": "https://stackoverflow.com/users/86967/brent-bradburn"}, "edited": false, "score": 0, "creation_date": 1575612135, "post_id": 45430126, "comment_id": 104632675, "body": "FYI: Go let&#39;s you use <code>`...`</code> to quote your strings to that you won&#39;t have to escape your regular quotes."}], "answers": [{"tags": [], "owner": {"reputation": 8123, "user_id": 7616, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/65200fa240ec9fd105e5aae657d22dbb?s=128&d=identicon&r=PG", "display_name": "shyam", "link": "https://stackoverflow.com/users/7616/shyam"}, "is_accepted": true, "score": 1, "last_activity_date": 1501571801, "creation_date": 1501571801, "answer_id": 45431290, "question_id": 45430126, "link": "https://stackoverflow.com/questions/45430126/remove-backslash-from-the-string/45431290#45431290", "title": "Remove backslash from the string", "body": "<p>You are sending the content of summary as a string so, instead you need to send it as a slice of maps</p>\n\n<pre><code>k := [...]common.MapStr{\n    {\"name\": \"cpu\", \"status\": m.cpu_status},\n    {\"name\": \"LTE\", \"status\": m.lte_status},\n    {\"name\": \"Network\", \"status\": m.network_status},\n    {\"name\": \"Memory\", \"status\": m.memory_status},\n}\nevent := common.MapStr{\n    \"cpu_status\":     (m.cpu_status % 4),\n    \"memory_status\":  (m.memory_status % 4),\n    \"lte_status\":     (m.lte_status % 4),\n    \"network_status\": (m.network_status % 4),\n    \"summary\":        k,\n}\n</code></pre>\n\n<p>See <a href=\"https://play.golang.org/p/yTSXnNKclG\" rel=\"nofollow noreferrer\">https://play.golang.org/p/yTSXnNKclG</a></p>\n"}, {"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 1, "last_activity_date": 1501571855, "creation_date": 1501571855, "answer_id": 45431308, "question_id": 45430126, "link": "https://stackoverflow.com/questions/45430126/remove-backslash-from-the-string/45431308#45431308", "title": "Remove backslash from the string", "body": "<p>When <code>event</code> is marshalled into JSON, the value of <code>summary</code> will be escaped if it contains a double quote. <strong>The quick and dirty solution</strong> will be defined the <code>event</code> as <code>map[string]interface{}</code> to be able to store arbitrary type as map value, and store the <code>summary</code> value as <a href=\"https://golang.org/pkg/encoding/json/#RawMessage\" rel=\"nofollow noreferrer\"><code>json.RawMessage</code></a> e.g. </p>\n\n<pre><code>event := map[string]interface{}{\n    \"cpu_status\": (m.cpu_status%4),\n    \"memory_status\" : (m.memory_status%4),\n    \"lte_status\" : (m.lte_status%4),\n    \"network_status\" : (m.network_status%4),\n    \"summary\": json.RawMessage(x),\n}\n</code></pre>\n\n<p>However, you need to make sure that the value of <code>x</code> is <strong>a valid JSON object</strong> (which is error prone). More robust solution is by defining the items in <code>summary</code> as a struct type, e.g.</p>\n\n<pre><code>type Status struct {\n    Name string `json:\"name\"`\n    Status string `json:\"status\"`\n}\nsummary := []*Status{\n    &amp;Status{\"cpu\", \"17\"},\n    &amp;Status{\"LTE\", \"26\"},\n    &amp;Status{\"Network\", \"34\"},\n    &amp;Status{\"Memory\", \"33\"},\n}\n\nevent := map[string]interface{}{\n    \"cpu_status\": (m.cpu_status%4),\n    \"memory_status\" : (m.memory_status%4),\n    \"lte_status\" : (m.lte_status%4),\n    \"network_status\" : (m.network_status%4),\n    \"summary\": summary,\n}\n</code></pre>\n"}], "owner": {"reputation": 387, "user_id": 5467006, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/5dac0b49b659331a68dd3476a8055839?s=128&d=identicon&r=PG&f=1", "display_name": "space earth", "link": "https://stackoverflow.com/users/5467006/space-earth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2022, "favorite_count": 0, "accepted_answer_id": 45431290, "answer_count": 2, "score": 1, "last_activity_date": 1501572744, "creation_date": 1501567804, "last_edit_date": 1501572744, "question_id": 45430126, "link": "https://stackoverflow.com/questions/45430126/remove-backslash-from-the-string", "title": "Remove backslash from the string", "body": "<p>I want to send the string to the server.My string is like as below,</p>\n\n<pre><code>  str := \"[{\\\"name\\\":\\\"cpu\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"LTE\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"Network\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"Memory\\\",\\\"status\\\":\\\"%d\\\"}]\"\n</code></pre>\n\n<p>When I print it using \"fmt.Println(str)\",it gives desired output as below,</p>\n\n<pre><code>[{\"name\":\"cpu\",\"status\":\"%d\"}, {\"name\":\"LTE\",\"status\":\"%d\"}, {\"name\":\"Network\",\"status\":\"%d\"}, {\"name\":\"Memory\",\"status\":\"%d\"}]\n</code></pre>\n\n<p>But when I am sending same string to server,server receives string as below,</p>\n\n<pre><code>\"[{\\\"name\\\":\\\"cpu\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"LTE\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"Network\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"Memory\\\",\\\"status\\\":\\\"%d\\\"}]\"\n</code></pre>\n\n<p>Please find my code snippet as below:</p>\n\n<pre><code>func (m *MetricSet) Fetch() (common.MapStr, error) {\n        var x string\n        x =fmt.Sprintf(\"[{\\\"name\\\":\\\"cpu\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"LTE\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"Network\\\",\\\"status\\\":\\\"%d\\\"}, {\\\"name\\\":\\\"Memory\\\",\\\"status\\\":\\\"%d\\\"}]\", 17,26,34,33)\n        fmt.Println(x)\n        event := common.MapStr{\n                \"cpu_status\": (m.cpu_status%4),\n                \"memory_status\" : (m.memory_status%4),\n                \"lte_status\" : (m.lte_status%4),\n                \"network_status\" : (m.network_status%4),\n                \"summary\": x,\n        }\n\n        m.cpu_status++\n        m.memory_status = m.memory_status + 2\n        m.lte_status = m.lte_status + 7\n        m.network_status = m.network_status + 13\n\n        return event, nil\n}\n</code></pre>\n\n<p>How to solve it?Please help me.</p>\n"}, {"tags": ["docker", "go"], "answers": [{"comments": [{"owner": {"reputation": 2645, "user_id": 2094670, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/MXiyg.jpg?s=128&g=1", "display_name": "ajayramesh", "link": "https://stackoverflow.com/users/2094670/ajayramesh"}, "edited": false, "score": 0, "creation_date": 1501594981, "post_id": 45431649, "comment_id": 77840033, "body": "yes, the container is started in daemon mode.  It would be helpful if you provide the example code."}, {"owner": {"reputation": 2645, "user_id": 2094670, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/MXiyg.jpg?s=128&g=1", "display_name": "ajayramesh", "link": "https://stackoverflow.com/users/2094670/ajayramesh"}, "edited": false, "score": 0, "creation_date": 1501606594, "post_id": 45431649, "comment_id": 77848095, "body": "<code>resp, err := cli.ContainerCreate(ctx, &amp;container.Config{     Image: imageName,   },  &amp;container.HostConfig{ \t  PortBindings: {&quot;9300:80&quot;},   }, nil, &quot;&quot;)   if err != nil {     panic(err)   }</code>  I am trying this, but not working"}], "tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": true, "score": 6, "last_activity_date": 1501609050, "last_edit_date": 1501609050, "creation_date": 1501572905, "answer_id": 45431649, "question_id": 45429276, "link": "https://stackoverflow.com/questions/45429276/how-to-run-docker-run-using-go-sdk-for-docker/45431649#45431649", "title": "how to run docker run using Go Sdk for docker?", "body": "<p>In the method <code>ContainerCreate</code> the third parameter is <a href=\"https://godoc.org/github.com/moby/moby/api/types/container#HostConfig\" rel=\"noreferrer\">HostConfig</a> that you need to use. If you are interested in setting ports then you should take a look at <code>PortBindings</code> field. Also you need to specify exposed ports for container. You can do this by providing <code>ExposedPorts</code> into <a href=\"https://godoc.org/github.com/moby/moby/api/types/container#Config\" rel=\"noreferrer\">container configuration</a> (second parameter).<br>\nAnd I assume that you container will be started in a <code>daemon</code> mode by default because you are using API instead of <code>cli</code> tool.</p>\n\n<p>Here is a working example:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n\n    \"github.com/docker/docker/api/types\"\n    \"github.com/docker/docker/api/types/container\"\n    \"github.com/docker/docker/client\"\n    \"github.com/docker/go-connections/nat\"\n)\n\nfunc main() {\n    cli, err := client.NewEnvClient()\n    if err != nil {\n        panic(err)\n    }\n\n    ctx := context.Background()\n    resp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n        Image:        \"mongo\",\n        ExposedPorts: nat.PortSet{\"8080\": struct{}{}},\n    }, &amp;container.HostConfig{\n        PortBindings: map[nat.Port][]nat.PortBinding{nat.Port(\"8080\"): {{HostIP: \"127.0.0.1\", HostPort: \"8080\"}}},\n    }, nil, \"mongo-go-cli\")\n    if err != nil {\n        panic(err)\n    }\n\n    if err := cli.ContainerStart(ctx, resp.ID, types.ContainerStartOptions{}); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>And in the output for <code>docker ps --all</code> I can see my port: <code>PORTS 127.0.0.1:8080-&gt;8080/tcp, 27017/tcp</code></p>\n"}], "owner": {"reputation": 2645, "user_id": 2094670, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/MXiyg.jpg?s=128&g=1", "display_name": "ajayramesh", "link": "https://stackoverflow.com/users/2094670/ajayramesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3552, "favorite_count": 4, "accepted_answer_id": 45431649, "answer_count": 1, "score": 3, "last_activity_date": 1501609050, "creation_date": 1501563653, "question_id": 45429276, "link": "https://stackoverflow.com/questions/45429276/how-to-run-docker-run-using-go-sdk-for-docker", "title": "how to run docker run using Go Sdk for docker?", "body": "<p>I want to run the below docker command \n<code>docker run ajaycs14/hello-world -p 1527:80 -d</code>. </p>\n\n<p>How to achieve above using <a href=\"https://godoc.org/github.com/moby/moby/api/types\" rel=\"nofollow noreferrer\">Docker Go SDK</a>?  </p>\n\n<p>Sample code to run an image is below, which from official document, how to modify below code to take the options for port and detached mode etc. Please help me in modifying below code to work for above command(<code>docker run ajaycs14/hello-world -p 1527:80 -d</code>) ? </p>\n\n<pre><code>package main\n\nimport (\n  \"fmt\"\n  \"io\"\n  \"os\"\n\n  \"github.com/docker/docker/api/types\"\n  \"github.com/docker/docker/api/types/container\"\n  \"github.com/docker/docker/client\"\n  \"golang.org/x/net/context\"\n)\n\nfunc main() {\n  ctx := context.Background()\n  cli, err := client.NewEnvClient()\n  if err != nil {\n    panic(err)\n  }\n\n  imageName := \"bfirsh/reticulate-splines\"\n\n  out, err := cli.ImagePull(ctx, imageName, types.ImagePullOptions{})\n  if err != nil {\n    panic(err)\n  }\n  io.Copy(os.Stdout, out)\n\n  resp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n    Image: imageName,\n  }, nil, nil, \"\")\n  if err != nil {\n    panic(err)\n  }\n\n  if err := cli.ContainerStart(ctx, resp.ID, types.ContainerStartOptions{}); err != nil {\n    panic(err)\n  }\n\n  fmt.Println(resp.ID)\n}\n</code></pre>\n"}, {"tags": ["linux", "go"], "answers": [{"comments": [{"owner": {"reputation": 89, "user_id": 5457058, "user_type": "registered", "profile_image": "https://graph.facebook.com/478472475646746/picture?type=large", "display_name": "Hack_Hut", "link": "https://stackoverflow.com/users/5457058/hack-hut"}, "edited": false, "score": 3, "creation_date": 1582656476, "post_id": 45430141, "comment_id": 106850363, "body": "Could you elaborate on how the bit shift works or at least the syntax?"}, {"owner": {"reputation": 1036, "user_id": 5647659, "user_type": "registered", "accept_rate": 54, "profile_image": "https://lh6.googleusercontent.com/-7FQBxsH9yws/AAAAAAAAAAI/AAAAAAAAABk/R3uBF5DmtC4/photo.jpg?sz=128", "display_name": "Elie G.", "link": "https://stackoverflow.com/users/5647659/elie-g"}, "edited": false, "score": 0, "creation_date": 1608517265, "post_id": 45430141, "comment_id": 115600180, "body": "Does this also work on Windows?"}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": false, "score": 7, "last_activity_date": 1501567860, "creation_date": 1501567860, "answer_id": 45430141, "question_id": 45429210, "link": "https://stackoverflow.com/questions/45429210/how-do-i-check-a-files-permissions-in-linux-using-go/45430141#45430141", "title": "How do I check a file&#39;s permissions in linux using Go", "body": "<p>In <code>go</code> the file permission is defined in <a href=\"https://golang.org/pkg/os/#FileMode\" rel=\"noreferrer\"><code>os.FileMode</code></a> in which the underlying type is an <code>uint32</code>. From documentation:</p>\n\n<blockquote>\n  <p>A FileMode represents a file's mode and permission bits...<br>\n  ...<br>\n  The defined file mode bits are the most significant bits of the FileMode. The nine least-significant bits are the standard Unix rwxrwxrwx permissions. The values of these bits should be considered part of the public API and may be used in wire protocols or disk representations: they must not be changed, although new bits might be added. </p>\n</blockquote>\n\n<p>You can retrieve the <code>FileMode</code> through <a href=\"https://golang.org/pkg/os/#Stat\" rel=\"noreferrer\"><code>os.Stat</code></a> or <a href=\"https://golang.org/pkg/os/#Lstat\" rel=\"noreferrer\"><code>os.LStat</code></a> function which returns a <a href=\"https://golang.org/pkg/os/#FileInfo\" rel=\"noreferrer\"><code>FileInfo</code></a>, e.g.</p>\n\n<pre><code>info, err := os.Stat(\"file/directory name\")\n</code></pre>\n\n<p>then the <code>FileMode</code> can be obtained by calling <code>info.Mode()</code>. To check the permission, performs <em>bitwise</em> operation to the mode bits, e.g. </p>\n\n<pre><code>//Check 'others' permission\nm := info.Mode()\nif m&amp;(1&lt;&lt;2) != 0 {\n    //other users have read permission\n} else {\n    //other users don't have read permission\n}\n</code></pre>\n\n<p>If you're visiting directory/file(s) using <code>filepath.Walk</code> function, since the <code>WalkFunc</code> (the second argument of <code>Walk</code>) is defined as</p>\n\n<pre><code>type WalkFunc func(path string, info os.FileInfo, err error) error\n</code></pre>\n\n<p>the <code>FileInfo</code> for certain <em>path</em> is available as the second argument of <code>WalkFunc</code>, thus you can check the permission directly inside the function body without calling <code>os.Stat</code> or <code>os.Lstat</code>. </p>\n"}, {"tags": [], "owner": {"reputation": 56, "user_id": 8489048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/de3e8600281414b8510904ccd08585e4?s=128&d=identicon&r=PG&f=1", "display_name": "CarlThePerson", "link": "https://stackoverflow.com/users/8489048/carltheperson"}, "is_accepted": false, "score": 0, "last_activity_date": 1609248997, "creation_date": 1609248997, "answer_id": 65493032, "question_id": 45429210, "link": "https://stackoverflow.com/questions/45429210/how-do-i-check-a-files-permissions-in-linux-using-go/65493032#65493032", "title": "How do I check a file&#39;s permissions in linux using Go", "body": "<p>You can retrieve the permissions in string form e.i: <em>r, w, x</em>. Like this:</p>\n<pre><code>func printPermissions(filename string) {\n    info, err := os.Stat(filename)\n    if err != nil {\n        panic(err)\n    }\n\n    mode := info.Mode()\n\n    fmt.Print(&quot;Owner: &quot;)\n    for i := 1; i &lt; 4; i++ {\n        fmt.Print(string(mode.String()[i]))\n    }\n\n    fmt.Print(&quot;\\nGroup: &quot;)\n    for i := 4; i &lt; 7; i++ {\n        fmt.Print(string(mode.String()[i]))\n    }\n\n    fmt.Print(&quot;\\nOther: &quot;)\n    for i := 7; i &lt; 10; i++ {\n        fmt.Print(string(mode.String()[i]))\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 2675, "user_id": 2433063, "user_type": "registered", "accept_rate": 24, "profile_image": "https://i.stack.imgur.com/uU1mK.jpg?s=128&g=1", "display_name": "Ricky Wilson", "link": "https://stackoverflow.com/users/2433063/ricky-wilson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6812, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1609248997, "creation_date": 1501563276, "last_edit_date": 1501617895, "question_id": 45429210, "link": "https://stackoverflow.com/questions/45429210/how-do-i-check-a-files-permissions-in-linux-using-go", "title": "How do I check a file&#39;s permissions in linux using Go", "body": "<p>I'm learning Go and the first project I want to do is to write a replacement for the Linux find shell program. I wrote a replacement for it in python in less than an hour. This is a much bigger challenge.</p>\n\n<p>The problem I'm having is as Goes <code>filepath.Walk</code> traverses my file system it spits out a bunch of permission denied messages to the screen.\nI need a way of checking the files permissions before <code>filepath.Walk</code> touches them.</p>\n"}, {"tags": ["go", "goland"], "answers": [{"comments": [{"owner": {"reputation": 9004, "user_id": 4422128, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9161e358d4d5ebac8c6d1bcf346a9465?s=128&d=identicon&r=PG", "display_name": "Wingzero", "link": "https://stackoverflow.com/users/4422128/wingzero"}, "edited": false, "score": 0, "creation_date": 1501569652, "post_id": 45429321, "comment_id": 77822146, "body": "Thank you for your reply. But I am new to go and still unclear how to fix it.. you said I should have <code>src&#47;github.com&#47;minio&#47;minio</code>, but minio I have is the source code directly, not downloaded bo <code>go get</code>"}, {"owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "reply_to_user": {"reputation": 9004, "user_id": 4422128, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9161e358d4d5ebac8c6d1bcf346a9465?s=128&d=identicon&r=PG", "display_name": "Wingzero", "link": "https://stackoverflow.com/users/4422128/wingzero"}, "edited": false, "score": 1, "creation_date": 1501569770, "post_id": 45429321, "comment_id": 77822214, "body": "@Wingzero create <code>GOPATH&#47;src&#47;github.com&#47;minio</code>, then clone your repo inside that folder: that will give you <code>GOPATH&#47;src&#47;github.com&#47;minio&#47;minio</code>, and <code>go build</code> will work then. Or, simply try a <code>go get github.com&#47;minio&#47;minio</code>: that should do the same (clone + build)"}, {"owner": {"reputation": 9004, "user_id": 4422128, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9161e358d4d5ebac8c6d1bcf346a9465?s=128&d=identicon&r=PG", "display_name": "Wingzero", "link": "https://stackoverflow.com/users/4422128/wingzero"}, "edited": false, "score": 0, "creation_date": 1501641551, "post_id": 45429321, "comment_id": 77862218, "body": "Amazing, it&#39;s working. Thanks a lot! One pity is Gogland still fails to debug break at my breakpoint. Anyway"}, {"owner": {"reputation": 5861, "user_id": 951414, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/82155035c493a583d2d92aa1d13eaf7e?s=128&d=identicon&r=PG", "display_name": "dlsniper", "link": "https://stackoverflow.com/users/951414/dlsniper"}, "edited": false, "score": 0, "creation_date": 1501661717, "post_id": 45429321, "comment_id": 77870890, "body": "If you tell me where to set the breakpoints I&#39;ll follow up with an issue here <a href=\"https://youtrack.jetbrains.com/issues/Go\" rel=\"nofollow noreferrer\">youtrack.jetbrains.com/issues/Go</a> and hopefully fix it."}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 8, "last_activity_date": 1501563937, "creation_date": 1501563937, "answer_id": 45429321, "question_id": 45428744, "link": "https://stackoverflow.com/questions/45428744/golang-unexpected-directory-layout/45429321#45429321", "title": "golang unexpected directory layout", "body": "<p>See <a href=\"https://github.com/golang/go/wiki/GithubCodeLayout\" rel=\"noreferrer\">GitHub code layout</a></p>\n\n<blockquote>\n  <p><code>$GOPATH</code> is the root of the project - each of your Github repos will be checked out several folders below <code>$GOPATH</code>.<br>\n  Your <code>$GOPATH</code> variable will point to the root of your Go workspace, as described in <a href=\"http://golang.org/doc/code.html\" rel=\"noreferrer\">How to Write Go Code</a>.</p>\n</blockquote>\n\n<p>In your case, below your <code>GOPATH</code> folder, you should have</p>\n\n<pre><code>src/github.com/minio/minio\n</code></pre>\n\n<p>Anf only <em>then</em> \"all minio directories, including vendor\"</p>\n"}, {"tags": [], "owner": {"reputation": 3343, "user_id": 442396, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/2c7ec89489bfcad5a94119f7bd9a1abf?s=128&d=identicon&r=PG", "display_name": "Sentinel", "link": "https://stackoverflow.com/users/442396/sentinel"}, "is_accepted": false, "score": 6, "last_activity_date": 1559117136, "creation_date": 1559117136, "answer_id": 56355794, "question_id": 45428744, "link": "https://stackoverflow.com/questions/45428744/golang-unexpected-directory-layout/56355794#56355794", "title": "golang unexpected directory layout", "body": "<p>This can happen if you have duplicate repos under goroot AND gopath. Delete the goroot one.</p>\n"}, {"comments": [{"owner": {"reputation": 366, "user_id": 5473004, "user_type": "registered", "profile_image": "https://graph.facebook.com/923112464409335/picture?type=large", "display_name": "Philippe Thomassigny", "link": "https://stackoverflow.com/users/5473004/philippe-thomassigny"}, "edited": false, "score": 0, "creation_date": 1611597049, "post_id": 58403349, "comment_id": 116497818, "body": "Addendum: Now the best way is to use modules. create a module from your code with go mod init, then insert the reference to your directories as a &#39;replace&#39; directive. See <a href=\"https://blog.golang.org/using-go-modules\" rel=\"nofollow noreferrer\">blog.golang.org/using-go-modules</a> for more info"}], "tags": [], "owner": {"reputation": 366, "user_id": 5473004, "user_type": "registered", "profile_image": "https://graph.facebook.com/923112464409335/picture?type=large", "display_name": "Philippe Thomassigny", "link": "https://stackoverflow.com/users/5473004/philippe-thomassigny"}, "is_accepted": false, "score": 24, "last_activity_date": 1571178271, "creation_date": 1571178271, "answer_id": 58403349, "question_id": 45428744, "link": "https://stackoverflow.com/questions/45428744/golang-unexpected-directory-layout/58403349#58403349", "title": "golang unexpected directory layout", "body": "<p>On Golang 1.13 it suddenly happened to me on all my code after upgrading from 1.11 to 1.13.</p>\n\n<p>It seems golang 1.13 does not like anymore imports like \"./something\". </p>\n\n<p>I had to develop any import like \"myapp/something\"</p>\n"}, {"tags": [], "owner": {"reputation": 2400, "user_id": 1103700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/365175c40356861c03385615db1adfdd?s=128&d=identicon&r=PG", "display_name": "WeakPointer", "link": "https://stackoverflow.com/users/1103700/weakpointer"}, "is_accepted": false, "score": 3, "last_activity_date": 1584815456, "creation_date": 1584815456, "answer_id": 60791754, "question_id": 45428744, "link": "https://stackoverflow.com/questions/45428744/golang-unexpected-directory-layout/60791754#60791754", "title": "golang unexpected directory layout", "body": "<p>Also with go1.13 (with the move to go mod), I found if I moved my project out from under my $GOPATH, I could use the <strong>import \"./mypackage\"</strong> statement. The same project under $GOPATH wouldn't build with the errors given by the OP above. I'm not ready to give up my $GOPATH environment variable just yet but I do like to keep small packages local to their project when possible, without committing to a go.mod file when it's not necessary.</p>\n"}, {"tags": [], "owner": {"reputation": 11, "user_id": 11119202, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/1ab04ec7d961b17a3655349da8011c6b?s=128&d=identicon&r=PG&f=1", "display_name": "Kakjens91", "link": "https://stackoverflow.com/users/11119202/kakjens91"}, "is_accepted": false, "score": 0, "last_activity_date": 1589990058, "creation_date": 1589990058, "answer_id": 61917449, "question_id": 45428744, "link": "https://stackoverflow.com/questions/45428744/golang-unexpected-directory-layout/61917449#61917449", "title": "golang unexpected directory layout", "body": "<p>I had this issue after I realised that I can't import correctly local packages, due to my project location. \nMy project was not in the GOPATH location, so I moved my project there. Before moving </p>\n\n<p>I imported packages via ./package name and after I moved my project in the GOPATH, I imported packages correctly via projectname/packagename.</p>\n\n<p>So what I've done was to import packages the correct way \"projectname/packagename\", so I corrected my import \"./packagename\" to \"\"projectname/packagename.\nHopefully it's not too confusing. It seems that this error can appear from different situations.</p>\n"}], "owner": {"reputation": 9004, "user_id": 4422128, "user_type": "registered", "accept_rate": 74, "profile_image": "https://www.gravatar.com/avatar/9161e358d4d5ebac8c6d1bcf346a9465?s=128&d=identicon&r=PG", "display_name": "Wingzero", "link": "https://stackoverflow.com/users/4422128/wingzero"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 20410, "favorite_count": 4, "accepted_answer_id": 45429321, "answer_count": 5, "score": 8, "last_activity_date": 1589990058, "creation_date": 1501559991, "question_id": 45428744, "link": "https://stackoverflow.com/questions/45428744/golang-unexpected-directory-layout", "title": "golang unexpected directory layout", "body": "<p>So I downloaded minio from github.com/minio/minio</p>\n\n<p>I want to run it from the source,</p>\n\n<p>I create my directory like:</p>\n\n<pre><code>~/Downloads/minio-RELEASE.2017-06-13T19-01-01Z\n|\n src\n   |\n    all minio directories, including vendor, like the image below\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/Lhgr0.jpg\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Lhgr0.jpg\" alt=\"enter image description here\"></a></p>\n\n<p>I also use <code>godep</code> resolve other dependencies under GOPATH.</p>\n\n<p>Now I run it from Gogland(go IDE)</p>\n\n<p>It shows:</p>\n\n<pre><code>GOROOT=/usr/local/Cellar/go/1.8.3/libexec\nGOPATH=/Users/xl/Downloads/minio-RELEASE.2017-06-13T19-01-01Z:/Users/xl/go\n/usr/local/Cellar/go/1.8.3/libexec/bin/go build -i -o /private/var/folders/8v/6dg7d6mx2850sv1gp8ts9thm0000gn/T/go_run_main_gogo /Users/xl/Downloads/minio-RELEASE.2017-06-13T19-01-01Z/src/main.go\nunexpected directory layout:\n    import path: github.com/Azure/azure-sdk-for-go/storage\n    root: /Users/xl/Downloads/minio-RELEASE.2017-06-13T19-01-01Z/src\n    dir: /Users/xl/Downloads/minio-RELEASE.2017-06-13T19-01-01Z/src/vendor/github.com/Azure/azure-sdk-for-go/storage\n    expand root: /Users/xl/Downloads/minio-RELEASE.2017-06-13T19-01-01Z/src\n    expand dir: /Users/xl/Downloads/minio-RELEASE.2017-06-13T19-01-01Z/src/vendor/github.com/Azure/azure-sdk-for-go/storage\n    separator: /\n</code></pre>\n\n<p>Now I am confused that, what's the problem? The files are all there and the directories are just like what's it's printing. How do I fix it? Thanks.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 405, "user_id": 5978133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/396576ed3ae974588c36a437c12691eb?s=128&d=identicon&r=PG&f=1", "display_name": "Liu Weibo", "link": "https://stackoverflow.com/users/5978133/liu-weibo"}, "edited": false, "score": 0, "creation_date": 1501641402, "post_id": 45433315, "comment_id": 77862188, "body": "How would select perform when one case return while another case is still running. Would that case function call be terminated? in what way?"}, {"owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "reply_to_user": {"reputation": 405, "user_id": 5978133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/396576ed3ae974588c36a437c12691eb?s=128&d=identicon&r=PG&f=1", "display_name": "Liu Weibo", "link": "https://stackoverflow.com/users/5978133/liu-weibo"}, "edited": false, "score": 0, "creation_date": 1501668527, "post_id": 45433315, "comment_id": 77875790, "body": "Select runs cases sequentially to have &quot;ready&quot; channels waiting for messages, but if the channel which is already returned gets the message select statement selects this case and runs it. I am not sure how this works internally, but my guess is that any already running cases are finished and any further ones are not run because the select statement is already finished."}], "tags": [], "owner": {"reputation": 2610, "user_id": 563158, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/4b4b8b7fa59c8b18038b56613e342a82?s=128&d=identicon&r=PG", "display_name": "Nebril", "link": "https://stackoverflow.com/users/563158/nebril"}, "is_accepted": false, "score": 1, "last_activity_date": 1501668550, "last_edit_date": 1501668550, "creation_date": 1501577837, "answer_id": 45433315, "question_id": 45428402, "link": "https://stackoverflow.com/questions/45428402/what-will-happen-to-a-golang-blocking-function-if-the-invoker-of-this-function-h/45433315#45433315", "title": "What will happen to a golang blocking function if the invoker of this function has done?", "body": "<p>I am not sure what you mean by \"synchronisation problem\", since there is no synchronization here.. You need to synchronise your goroutines using channels, waitgroups or any other means if you want to be sure that your spawned goroutines performed their task.</p>\n\n<p>It doesn't really matter what happens in the goroutine - if it's not synchronised with main gouroutine it will cease to exist after main exits.</p>\n\n<p>Return value from function called asynchronously in goroutine won't be available to you anyway.</p>\n\n<p>You can check out how blocking calls work for yourself:</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n)\n\nfunc interruptable_call(sleep time.Duration) &lt;-chan time.Time {\n    fmt.Println(\"sleeping for \", sleep*time.Second)\n    time.Sleep(sleep * time.Second)\n    return time.After(0 * time.Second)\n}\n\nfunc A(ctx context.Context) int {\n    for {\n        select {\n        case &lt;-ctx.Done():\n            fmt.Println(\"func done\")\n            return 1\n        case &lt;-interruptable_call(2):\n            fmt.Println(\"blocking\")\n        case &lt;-interruptable_call(3):\n            fmt.Println(\"blocking\")\n        case &lt;-interruptable_call(4):\n            fmt.Println(\"blocking\")\n        case &lt;-interruptable_call(5):\n            fmt.Println(\"blocking\")\n        }\n    }\n    return 0\n}\n\nfunc main() {\n    ctx, cancel := context.WithTimeout(context.Background(), 2*time.Second)\n    defer cancel()\n    fmt.Println(\"go A\")\n    go A(ctx)\n    fmt.Println(\"go A done\")\n    select {\n    case &lt;-ctx.Done():\n        fmt.Println(\"main done\")\n        break\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 405, "user_id": 5978133, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/396576ed3ae974588c36a437c12691eb?s=128&d=identicon&r=PG&f=1", "display_name": "Liu Weibo", "link": "https://stackoverflow.com/users/5978133/liu-weibo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 877, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501668550, "creation_date": 1501557547, "last_edit_date": 1501641378, "question_id": 45428402, "link": "https://stackoverflow.com/questions/45428402/what-will-happen-to-a-golang-blocking-function-if-the-invoker-of-this-function-h", "title": "What will happen to a golang blocking function if the invoker of this function has done?", "body": "<p>I wonder what will happen if the interruptable_call is uninterruptable and return after the context is done. The call stack would have been already destroyed. What would the return action perform? How would <code>select</code> perform when one case return while another case is still running. Would that case function call be terminated? in what way?</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"time\"\n)\n\nfunc interruptable_call() &lt;-chan time.Time {\n    return time.After(1 * time.Second)\n}\n\nfunc A(ctx context.Context) int {\n    for {\n        select {\n        case &lt;-ctx.Done():\n            fmt.Println(\"func done\")\n            return 1\n        case &lt;-interruptable_call():\n            fmt.Println(\"blocking\")\n        }\n    }\n    return 0\n}\n\nfunc main() {\n    ctx, cancel := context.WithTimeout(context.Background(), 5*time.Second)\n    defer cancel()\n    fmt.Println(\"go A\")\n    go A(ctx)\n    fmt.Println(\"go A done\")\n    select {\n    case &lt;-ctx.Done():\n        fmt.Println(\"main done\")\n        break\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "amadeus"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 3, "last_activity_date": 1501568011, "last_edit_date": 1501568011, "creation_date": 1501560048, "answer_id": 45428754, "question_id": 45428126, "link": "https://stackoverflow.com/questions/45428126/how-to-create-a-big-int-with-a-secure-random/45428754#45428754", "title": "How to create a big int with a secure random", "body": "<p>Use package <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\"><code>math/big</code></a> and <a href=\"https://golang.org/pkg/crypto/rand/\" rel=\"nofollow noreferrer\"><code>crypto/rand</code></a>. The snippet looks like:</p>\n\n<pre><code>//Max random value, a 130-bits integer, i.e 2^130 - 1\nmax := new(big.Int)\nmax.Exp(big.NewInt(2), big.NewInt(130), nil).Sub(max, big.NewInt(1))\n\n//Generate cryptographically strong pseudo-random between 0 - max\nn, err := rand.Int(rand.Reader, max)\nif err != nil {\n    //error handling\n}\n\n//String representation of n in base 32\nnonce := n.Text(32)\n</code></pre>\n\n<p>A working example can be found at <a href=\"https://play.golang.org/p/ssET5KZQuj\" rel=\"nofollow noreferrer\">The Go Playground</a>.</p>\n"}], "owner": {"reputation": 63, "user_id": 8397052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/pIb5m.jpg?s=128&g=1", "display_name": "Mat&#237;as Sueiro", "link": "https://stackoverflow.com/users/8397052/mat%c3%adas-sueiro"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2244, "favorite_count": 0, "accepted_answer_id": 45428754, "answer_count": 1, "score": 2, "last_activity_date": 1501572795, "creation_date": 1501555392, "last_edit_date": 1501572795, "question_id": 45428126, "link": "https://stackoverflow.com/questions/45428126/how-to-create-a-big-int-with-a-secure-random", "title": "How to create a big int with a secure random", "body": "<p>I have this code in java and I need to reproduce in Go.</p>\n\n<pre><code>String nonce = new BigInteger(130, new SecureRandom()).toString(32);\n</code></pre>\n\n<p>Is the only way to generate a nonce for GDS amadeus soap header 4.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "channel", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 41, "user_id": 4938079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rM5xb.jpg?s=128&g=1", "display_name": "Luis Felipe Moura Pereira De S", "link": "https://stackoverflow.com/users/4938079/luis-felipe-moura-pereira-de-s"}, "edited": false, "score": 0, "creation_date": 1501605276, "post_id": 45428021, "comment_id": 77847297, "body": "Thank you +1, I appreciate the answer"}], "tags": [], "owner": {"reputation": 10159, "user_id": 4907630, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b96aeab7486cd88da186e9c52eb7d7c7?s=128&d=identicon&r=PG&f=1", "display_name": "eugenioy", "link": "https://stackoverflow.com/users/4907630/eugenioy"}, "is_accepted": false, "score": 8, "last_activity_date": 1501554605, "creation_date": 1501554605, "answer_id": 45428021, "question_id": 45427963, "link": "https://stackoverflow.com/questions/45427963/what-happens-if-you-read-a-channel-to-nothing/45428021#45428021", "title": "What happens if you read a channel to nothing?", "body": "<p>Yes, you can do that.</p>\n\n<p>It does not need to go anywhere.</p>\n\n<p>Purpose of the <code>Done</code> channel usually is just to signal the done event, so the value is not relevant and can be ignored.</p>\n\n<p>It is the same as when you call a function and don't assign the return values to variables.</p>\n\n<p>Consider this:</p>\n\n<pre><code>func getInt() int {\n    return 1\n}\n\nfunc main() {\n    getInt()  // does not \"go anywhere\"\n}\n</code></pre>\n\n<p>See this playground showing those examples:</p>\n\n<p><a href=\"https://play.golang.org/p/CA8P7gYpok\" rel=\"noreferrer\">https://play.golang.org/p/CA8P7gYpok</a></p>\n"}], "owner": {"reputation": 41, "user_id": 4938079, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/rM5xb.jpg?s=128&g=1", "display_name": "Luis Felipe Moura Pereira De S", "link": "https://stackoverflow.com/users/4938079/luis-felipe-moura-pereira-de-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 401, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1501605245, "creation_date": 1501554128, "last_edit_date": 1501605245, "question_id": 45427963, "link": "https://stackoverflow.com/questions/45427963/what-happens-if-you-read-a-channel-to-nothing", "title": "What happens if you read a channel to nothing?", "body": "<p>Can you read a goroutine channel into nothing?  where does this channel read go to in this statement?</p>\n\n<pre><code>go func() {\n  &lt;-ctx.Done()\n  logger.Errorf(\"canceled: %v\", ctx.Err())\n}()\n</code></pre>\n\n<p>Addition:</p>\n\n<p>Would this code be any different than if I used the blank identifier</p>\n\n<pre><code>go func() {\n  _ = &lt;-ctx.Done()\n  logger.Errorf(\"canceled: %v\", ctx.Err())\n}()\n</code></pre>\n"}, {"tags": ["docker", "go"], "answers": [{"comments": [{"owner": {"reputation": 2645, "user_id": 2094670, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/MXiyg.jpg?s=128&g=1", "display_name": "ajayramesh", "link": "https://stackoverflow.com/users/2094670/ajayramesh"}, "edited": false, "score": 0, "creation_date": 1501546892, "post_id": 45427032, "comment_id": 77815544, "body": "It worked, thank you. If you provide a little theoretical explanation command would be helpful. or reference."}, {"owner": {"reputation": 2645, "user_id": 2094670, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/MXiyg.jpg?s=128&g=1", "display_name": "ajayramesh", "link": "https://stackoverflow.com/users/2094670/ajayramesh"}, "edited": false, "score": 0, "creation_date": 1501546925, "post_id": 45427032, "comment_id": 77815548, "body": "<code>.&#47;...</code> - what it does?"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 2645, "user_id": 2094670, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/MXiyg.jpg?s=128&g=1", "display_name": "ajayramesh", "link": "https://stackoverflow.com/users/2094670/ajayramesh"}, "edited": false, "score": 1, "creation_date": 1501563939, "post_id": 45427032, "comment_id": 77819583, "body": "@Sam &quot;Get all imports references in this directory and the expanded slice consisting of all subdirectories, recursively&quot;"}], "tags": [], "owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "is_accepted": true, "score": 3, "last_activity_date": 1611245866, "last_edit_date": 1611245866, "creation_date": 1501545803, "answer_id": 45427032, "question_id": 45426891, "link": "https://stackoverflow.com/questions/45426891/why-i-am-not-able-to-fetch-go-sdk-for-docker/45427032#45427032", "title": "Why I am not able to fetch go sdk for docker ?", "body": "<p>if you have golang installed correctly just issue this in the dir where your golang code lives</p>\n<pre><code>go get -v -t ./...\n</code></pre>\n<p>which will install the upstream libraries ...  then you can compile your code ... for details issue</p>\n<pre><code>go help packages\n</code></pre>\n<p>the short of it is <code>./...</code> will install all packages [ and recursively its upstream packages, etc, etc.] mentioned in any go file's <code>import </code> in your current dir</p>\n<p>If you have ever spent days manually installing upstream libraries for any other language you will appreciate how much of a lifesaver this really is ... Yes I'm looking at you c, c++, java and especially python which has the roughest most disjoint library import machination incantation alchemy</p>\n"}], "owner": {"reputation": 2645, "user_id": 2094670, "user_type": "registered", "accept_rate": 87, "profile_image": "https://i.stack.imgur.com/MXiyg.jpg?s=128&g=1", "display_name": "ajayramesh", "link": "https://stackoverflow.com/users/2094670/ajayramesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 246, "favorite_count": 1, "accepted_answer_id": 45427032, "answer_count": 1, "score": 2, "last_activity_date": 1611245866, "creation_date": 1501544816, "question_id": 45426891, "link": "https://stackoverflow.com/questions/45426891/why-i-am-not-able-to-fetch-go-sdk-for-docker", "title": "Why I am not able to fetch go sdk for docker ?", "body": "<p>I am trying to run docker go SDK example file. I am quite new to Go language; I am not sure how to run below docker SDK API code. But I tried somehow; please help me with below error. </p>\n\n<p>When I tried to run this <code>go run example-ps.go</code></p>\n\n<p><a href=\"https://godoc.org/github.com/moby/moby/client\" rel=\"nofollow noreferrer\">example-ps.go</a> - content is below</p>\n\n<pre><code>package main\n\nimport (\n  \"io\"\n  \"os\"\n\n  \"github.com/docker/docker/client\"\n  \"github.com/docker/docker/api/types\"\n  \"github.com/docker/docker/api/types/container\"\n  \"golang.org/x/net/context\"\n)\n\nfunc main() {\n  ctx := context.Background()\n  cli, err := client.NewEnvClient()\n  if err != nil {\n    panic(err)\n  }\n\n  _, err = cli.ImagePull(ctx, \"docker.io/library/alpine\", types.ImagePullOptions{})\n  if err != nil {\n    panic(err)\n  }\n\n  resp, err := cli.ContainerCreate(ctx, &amp;container.Config{\n    Image: \"alpine\",\n    Cmd:   []string{\"echo\", \"hello world\"},\n  }, nil, nil, \"\")\n  if err != nil {\n    panic(err)\n  }\n\n  if err := cli.ContainerStart(ctx, resp.ID, types.ContainerStartOptions{}); err != nil {\n    panic(err)\n  }\n\n  if _, err = cli.ContainerWait(ctx, resp.ID); err != nil {\n    panic(err)\n  }\n\n  out, err := cli.ContainerLogs(ctx, resp.ID, types.ContainerLogsOptions{ShowStdout: true})\n  if err != nil {\n    panic(err)\n  }\n\n  io.Copy(os.Stdout, out)\n}\n</code></pre>\n\n<p>I am getting below error. How do I import those library files?</p>\n\n<pre><code>example-ps.go:8:3: cannot find package \"github.com/docker/docker/api/types\" in any of:\n        /usr/local/go/src/github.com/docker/docker/api/types (from $GOROOT)\n        /Users/air/go/src/github.com/docker/docker/api/types (from $GOPATH)\nexample-ps.go:9:3: cannot find package \"github.com/docker/docker/api/types/container\" in any of:\n        /usr/local/go/src/github.com/docker/docker/api/types/container (from $GOROOT)\n        /Users/air/go/src/github.com/docker/docker/api/types/container (from $GOPATH)\nexample-ps.go:7:3: cannot find package \"github.com/docker/docker/client\" in any of:\n        /usr/local/go/src/github.com/docker/docker/client (from $GOROOT)\n        /Users/air/go/src/github.com/docker/docker/client (from $GOPATH)\nexample-ps.go:10:3: cannot find package \"golang.org/x/net/context\" in any of:\n        /usr/local/go/src/golang.org/x/net/context (from $GOROOT)\n        /Users/air/go/src/golang.org/x/net/context (from $GOPATH)\n</code></pre>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 2, "creation_date": 1501555325, "post_id": 45426137, "comment_id": 77817399, "body": "Perhaps you need to set <code>Content-Type</code> explicitly, i.e by <code>req.Header.Set(&quot;Content-Type&quot;, &quot;application&#47;json&quot;)</code>. Try to examine and compare the request performed by <code>Python</code> and <code>go</code> implementation`. Use a tool like <i>HTTP Fiddler</i>, <a href=\"https://github.com/kdzwinel/betwixt\" rel=\"nofollow noreferrer\">betwixt</a>."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1501595718, "post_id": 45426137, "comment_id": 77840675, "body": "Also, <i>don&#39;t disregard the errors</i>. You&#39;re ignoring the errors from <code>json.Marshal</code>, <code>cookiejar.New</code>, and <code>ioutil.ReadAll</code>. When you&#39;re troubleshooting an issue, you want all the info you can get, and discarding errors is throwing away potentially valuable troubleshooting details."}], "answers": [{"tags": [], "owner": {"reputation": 221, "user_id": 3643490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f405bc85181f222359fb902a7f3c4787?s=128&d=identicon&r=PG", "display_name": "Arith", "link": "https://stackoverflow.com/users/3643490/arith"}, "is_accepted": false, "score": 1, "last_activity_date": 1595385008, "creation_date": 1595385008, "answer_id": 63025892, "question_id": 45426137, "link": "https://stackoverflow.com/questions/45426137/golang-struct-as-payload-for-post-request/63025892#63025892", "title": "Golang Struct as Payload for POST Request", "body": "<p>As <code>http.Client</code> is relatively a low-level abstraction, <code>gorequest</code>(<a href=\"https://github.com/parnurzeal/gorequest\" rel=\"nofollow noreferrer\">https://github.com/parnurzeal/gorequest</a>) as an alternative is strongly recommended.</p>\n<p>headers, queries, and body can be posted in any type, which is a bit more like what we often do in Python.</p>\n"}, {"tags": [], "owner": {"reputation": 15, "user_id": 6745062, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9c68c48ae4cb3f0b71d5898411e7d57?s=128&d=identicon&r=PG&f=1", "display_name": "Ryan Alex Martin", "link": "https://stackoverflow.com/users/6745062/ryan-alex-martin"}, "is_accepted": false, "score": 0, "last_activity_date": 1614132977, "creation_date": 1614132977, "answer_id": 66343744, "question_id": 45426137, "link": "https://stackoverflow.com/questions/45426137/golang-struct-as-payload-for-post-request/66343744#66343744", "title": "Golang Struct as Payload for POST Request", "body": "<p>While this does not resolve your issue directly, I think somebody who is searching for an answer to the topic referenced in your title, <strong>Golang Struct as Payload for Post Request</strong>, may find the below answer helpful.</p>\n<p>Here's a minimum viable example of using <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow noreferrer\"><code>json.Marshal</code></a> to convert a Struct to a JSON object in the context of a POST request.</p>\n<p>Go's standard libraries are fantastic, there is no need to pull in external dependencies to do such a mundane thing.</p>\n<pre><code>func TestPostRequest(t *testing.T) {\n\n    // Create a new instance of Person\n    person := Person{\n        Name: &quot;Ryan Alex Martin&quot;,\n        Age:  27,\n    }\n\n    // Marshal it into JSON prior to requesting\n    personJSON, err := json.Marshal(person)\n\n    // Make request with marshalled JSON as the POST body\n    resp, err := http.Post(&quot;https://httpbin.org/anything&quot;, &quot;application/json&quot;,\n        bytes.NewBuffer(personJSON))\n\n    if err != nil {\n        t.Error(&quot;Could not make POST request to httpbin&quot;)\n    }\n\n    // That's it!\n\n    // But for good measure, let's look at the response body.\n    body, err := ioutil.ReadAll(resp.Body)\n\n    var result PersonResponse\n    err = json.Unmarshal([]byte(body), &amp;result)\n    if err != nil {\n        t.Error(&quot;Error unmarshaling data from request.&quot;)\n    }\n\n    if result.NestedPerson.Name != &quot;Ryan Alex Martin&quot; {\n        t.Error(&quot;Incorrect or nil name field returned from server: &quot;, result.NestedPerson.Name)\n    }\n\n    fmt.Println(&quot;Response from server:&quot;, result.NestedPerson.Name)\n    fmt.Println(&quot;Response from server:&quot;, result.NestedPerson.Age)\n\n}\n\ntype Person struct {\n    Name string `json:&quot;name&quot;`\n    Age  int    `json:&quot;age&quot;`\n}\n\n// NestedPerson is the 'json' field of the response, what we originally sent to httpbin\ntype PersonResponse struct {\n    NestedPerson Person `json:&quot;json&quot;` // Nested Person{} in 'json' field\n}\n\n\n</code></pre>\n"}], "owner": {"reputation": 1229, "user_id": 2297299, "user_type": "registered", "accept_rate": 47, "profile_image": "https://www.gravatar.com/avatar/15e68675eca887dc61ae08814905cdc4?s=128&d=identicon&r=PG", "display_name": "HectorOfTroy407", "link": "https://stackoverflow.com/users/2297299/hectoroftroy407"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7144, "favorite_count": 0, "answer_count": 2, "score": 6, "last_activity_date": 1614132977, "creation_date": 1501539500, "last_edit_date": 1501553321, "question_id": 45426137, "link": "https://stackoverflow.com/questions/45426137/golang-struct-as-payload-for-post-request", "title": "Golang Struct as Payload for POST Request", "body": "<p>New to golang. I'm trying to make a POST request to an auth endpoint to get back a token for authing further requests. Currently the error I'm getting is <code>missing \"credentials\"</code>. I've written the same logic in Python so I know what I am trying to do is what the system is expecting.</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"bytes\"\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n    \"log\"\n    \"net/http\"\n    \"net/http/cookiejar\"\n    \"os\"\n)\n\ntype Auth struct {\n    Method   string `json:\"credentials\"`\n    Email    string `json:\"email\"`\n    Password string `json:\"password\"`\n    Mfa      string `json:\"mfa_token\"`\n}\n\nfunc main() {\n    reader := bufio.NewReader(os.Stdin)\n\n    fmt.Print(\"Enter Email: \")\n    e, _ := reader.ReadString('\\n')\n    fmt.Print(\"Enter Password: \")\n    p, _ := reader.ReadString('\\n')\n    fmt.Print(\"Enter 2FA Token: \")\n    authy, _ := reader.ReadString('\\n')\n\n    auth := Auth{\"manual\", e, p, authy}\n    j, _ := json.Marshal(auth)\n    jar, _ := cookiejar.New(nil)\n    client := &amp;http.Client{\n        Jar: jar,\n    }\n\n    req, err := http.NewRequest(\"POST\", \"https://internaltool.com/v3/sessions\", bytes.NewBuffer(j))\n    if err != nil {\n        log.Fatal(err)\n    }\n    req.Header.Add(\"Accept-Encoding\", \"gzip, deflate, br\")\n    res, err := client.Do(req)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer res.Body.Close()\n\n    body, _ := ioutil.ReadAll(res.Body)\n    s := string(body)\n    if res.StatusCode == 400 {\n        fmt.Println(\"Bad Credentials\")\n        fmt.Println(s)\n        return\n    }\n}\n</code></pre>\n\n<p>The question is - am I properly marshalling the AUTH struct into JSON and adding it appropriately to the POST request? As the API is not even seeing the <code>credentials</code> key in the JSON I think I must be doing something wrong. Anything helps.</p>\n"}, {"tags": ["docker", "go", "gradle"], "comments": [{"owner": {"reputation": 38794, "user_id": 25066, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bca89ff7612c074bbe1a77d2cf0a4fb0?s=128&d=identicon&r=PG", "display_name": "Eric Wendelin", "link": "https://stackoverflow.com/users/25066/eric-wendelin"}, "edited": false, "score": 0, "creation_date": 1501538671, "post_id": 45425749, "comment_id": 77813387, "body": "Some good recent work here on GoGradle (<a href=\"https://github.com/gogradle/gogradle\" rel=\"nofollow noreferrer\">github.com/gogradle/gogradle</a>) and a blog post by Ben Muschko that I think may get you started: <a href=\"http://bmuschko.com/blog/golang-with-gradle/\" rel=\"nofollow noreferrer\">bmuschko.com/blog/golang-with-gradle</a>"}, {"owner": {"reputation": 91, "user_id": 1481288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bbd0052d553046ddc64daddfffb474?s=128&d=identicon&r=PG", "display_name": "MBru", "link": "https://stackoverflow.com/users/1481288/mbru"}, "reply_to_user": {"reputation": 38794, "user_id": 25066, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/bca89ff7612c074bbe1a77d2cf0a4fb0?s=128&d=identicon&r=PG", "display_name": "Eric Wendelin", "link": "https://stackoverflow.com/users/25066/eric-wendelin"}, "edited": false, "score": 0, "creation_date": 1501542507, "post_id": 45425749, "comment_id": 77814483, "body": "I have been trying to use the gogradle plugin, and it claims to work outside of the $GOPATH, but apparently when you try to do this, it attempts to create some symbolic links, which fail to be created for me. What I am trying to do is set up a project structure that can be cloned from Git and run anywhere.  But I can&#39;t get this to work with gogradle because the .go files are not in a $GOPATH type of structure and the plugin can&#39;t create the symbolic links it wants to."}], "answers": [{"comments": [{"owner": {"reputation": 91, "user_id": 1481288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bbd0052d553046ddc64daddfffb474?s=128&d=identicon&r=PG", "display_name": "MBru", "link": "https://stackoverflow.com/users/1481288/mbru"}, "edited": false, "score": 0, "creation_date": 1502376186, "post_id": 45448659, "comment_id": 78192713, "body": "Thanks for the reply.  Although this doesn&#39;t include Gradle, I could look at what might be necessary to adapt your approach to my needs."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 91, "user_id": 1481288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bbd0052d553046ddc64daddfffb474?s=128&d=identicon&r=PG", "display_name": "MBru", "link": "https://stackoverflow.com/users/1481288/mbru"}, "edited": false, "score": 1, "creation_date": 1502390908, "post_id": 45448659, "comment_id": 78202265, "body": "@MBru That was exactly my point - get rid of the dependency on the JVM and gradle in exchange for more ubiquitous tools."}, {"owner": {"reputation": 91, "user_id": 1481288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bbd0052d553046ddc64daddfffb474?s=128&d=identicon&r=PG", "display_name": "MBru", "link": "https://stackoverflow.com/users/1481288/mbru"}, "edited": false, "score": 0, "creation_date": 1502408340, "post_id": 45448659, "comment_id": 78209503, "body": "But in the end, you are using &#39;make&#39;.  And if you are going to use make, I&#39;m not sure I see the advantage of also using go generate as those commands could be in the makefile just as easily.  Anyway, I appreciate your input here.  I may end up going in a similar direction."}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "reply_to_user": {"reputation": 91, "user_id": 1481288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bbd0052d553046ddc64daddfffb474?s=128&d=identicon&r=PG", "display_name": "MBru", "link": "https://stackoverflow.com/users/1481288/mbru"}, "edited": false, "score": 0, "creation_date": 1502436758, "post_id": 45448659, "comment_id": 78218045, "body": "@MBru Make is available out of the box on all but the most special Linux Distributions and UNIX derivates. The general idea here is the to use only tools from the Go ecosystem to provide everything needed to be able to get the program running. This way, somebody who only has Go installed can still use your program. The Makefile for additional stuff like packaging, containerization and alike - things you would only need under certain circumstances. And when it is there, <i>you</i> can use it for additional convenience."}], "tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": false, "score": 3, "last_activity_date": 1501626657, "creation_date": 1501626657, "answer_id": 45448659, "question_id": 45425749, "link": "https://stackoverflow.com/questions/45425749/project-structure-for-golang-docker-gradle/45448659#45448659", "title": "Project structure for golang, docker, gradle", "body": "<p>When I started with Go, I fiddled with a rather wide variety of build tools, from <a href=\"http://maven.apache.org\" rel=\"nofollow noreferrer\">maven</a> to <a href=\"https://gulpjs.com\" rel=\"nofollow noreferrer\">gulp</a>.</p>\n\n<p>It turned out that at least for me, they were doing more harm than good, so I started to use Go's seemingly unimposing, but really well thought out features. One of them is<a href=\"https://blog.golang.org/generate\" rel=\"nofollow noreferrer\"><strong><code>go generate</code></strong></a>. Add simple shell scripts or occasionally Makefiles for automation.</p>\n\n<h1>Sample project</h1>\n\n<p>I have put together a sample project to make this more clear</p>\n\n<pre><code>/Users/you/go/src/bitbucket.org/you/hello/\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 _templates\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.html\n\u2514\u2500\u2500 main.go\n</code></pre>\n\n<h2>main.go</h2>\n\n<p>This is a simple web server which serves \"Hello, World!\" using a template which is embedded into the binary using the excellent <a href=\"https://github.com/GeertJohan/go.rice\" rel=\"nofollow noreferrer\">go.rice</a> tool:</p>\n\n<pre><code>//go:generate rice embed-go\n\npackage main\n\nimport (\n    \"html/template\"\n    \"log\"\n    \"net/http\"\n\n    rice \"github.com/GeertJohan/go.rice\"\n)\n\nfunc main() {\n\n    templateBox, err := rice.FindBox(\"_templates\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    // get file contents as string\n    templateString, err := templateBox.String(\"main.html\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    // parse and execute the template\n    tmplMessage, err := template.New(\"message\").Parse(templateString)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    http.HandleFunc(\"/\", func(w http.ResponseWriter, r *http.Request) {\n        if err := tmplMessage.Execute(w, map[string]string{\"Greeting\": \"Hello, world!\"}); err != nil {\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n        }\n    })\n\n    log.Fatal(http.ListenAndServe(\"127.0.0.1:8080\", nil))\n}\n</code></pre>\n\n<p>Note the line</p>\n\n<pre><code>//go:generate rice embed-go\n</code></pre>\n\n<p>When you call <code>go generate</code> your source file will be scanned for such lines and the according commands will be executed. In this case, a file called rice-embed.go will be generated and your directory will look like this:</p>\n\n<pre><code>/Users/you/go/src/bitbucket.org/you/hello/\n\u251c\u2500\u2500 Dockerfile\n\u251c\u2500\u2500 Makefile\n\u251c\u2500\u2500 _templates\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 main.html\n\u251c\u2500\u2500 main.go\n\u2514\u2500\u2500 rice-box.go\n</code></pre>\n\n<p>You could call webpack in a <code>//go generate</code> for example, to get your stuff together and another generate to create a <code>rice-box.go</code> from the result. This way, all your stuff would be embedded in your binary and would become a breeze to deploy.</p>\n\n<h2>Dockerfile</h2>\n\n<p>I have used a rather simple Dockerfile for this example:</p>\n\n<pre><code>FROM alpine:latest\nMAINTAINER You &lt;you@example.com&gt;\nCOPY hello /usr/bin\nEXPOSE 8080\nCMD [\"/usr/bin/hello\"]\n</code></pre>\n\n<p>However this brings us to a problem: We can not use <code>go:generate</code> to produce the docker image, as of the time when we need to call <code>go:generate</code>, the new binary is not build yet. This would make us do ugly things like</p>\n\n<pre><code>go generate &amp;&amp; go build &amp;&amp; go generate\n</code></pre>\n\n<p>leading to the docker image build twice and whatnot. So, we need a different solution</p>\n\n<h2>Solution A: A shell script</h2>\n\n<p>We could of course come up with something like:</p>\n\n<pre><code>#!/bin/bash\n# Checks for existence omitted for brevity\nGO=$(which go)\nDOCKER=$(which docker)\n$GO generate\n$GO test\n$GO build\n$DOCKER -t you/hello .\n</code></pre>\n\n<p>However, this comes with a problem: you will always do the whole sequence using the shell script. Even when you just want to run the tests, you would end up building the docker image. Over time, this adds up. In such situations I tend to use</p>\n\n<h2>Solution B: a Makefile</h2>\n\n<p>A Makefile is a configuration file for <a href=\"https://www.gnu.org/software/make/\" rel=\"nofollow noreferrer\">GNU make</a></p>\n\n<pre><code>    CC = $(shell which go 2&gt;/dev/null)\n    DOCKER = $(shell which docker 2&gt;/dev/null)\n\n    ifeq ($(CC),)\n    $(error \"go is not in your system PATH\")\n    else\n    $(info \"go found\")\n    endif\n\n    ifeq ($(DOCKER),)\n    $(error \"docker not in your system path\")\n    else\n    $(info \"docker found\")\n    endif\n\n    .PHONY: clean generate tests docker all\n\n    all: clean generate tests hello docker\n\n    clean:\n        $(RM) hello rice-box.go cover.out\n    generate:\n        $(CC) generate\n    tests: generate\n        $(CC) test -coverprofile=cover.out\n    hello: tests\n        $(CC) build\n    docker: hello\n        $(DOCKER) build -t sosample/hello .\n</code></pre>\n\n<p>A full explanation is beyond the scope of this answer, but what you can basically do here is that you can call <code>make</code> and the <code>all</code> target will be built: files from the old build are removed (<code>clean</code>), a new <code>rice-box.go</code> is generated (<code>generate</code>) and so on. But in case you only want to run the tests for example, calling <code>make test</code> would only execute the targets <code>clean</code>, <code>generate</code> and <code>tests</code>.</p>\n"}, {"comments": [{"owner": {"reputation": 91, "user_id": 1481288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bbd0052d553046ddc64daddfffb474?s=128&d=identicon&r=PG", "display_name": "MBru", "link": "https://stackoverflow.com/users/1481288/mbru"}, "edited": false, "score": 0, "creation_date": 1502376347, "post_id": 45611923, "comment_id": 78192848, "body": "Thanks for the reply.  Not sure this addresses my question though.  I wasn&#39;t seeking a web application framework structure.  I&#39;m really looking for a way I can build Go language code, deploy it in Docker, and test the code, all from a Gradle build environment."}, {"owner": {"reputation": 675, "user_id": 959303, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1825e0d6fb7e50d58f10f5ee21c3a045?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/959303/alex"}, "reply_to_user": {"reputation": 91, "user_id": 1481288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bbd0052d553046ddc64daddfffb474?s=128&d=identicon&r=PG", "display_name": "MBru", "link": "https://stackoverflow.com/users/1481288/mbru"}, "edited": false, "score": 0, "creation_date": 1502466497, "post_id": 45611923, "comment_id": 78237696, "body": "Yeah, it&#39;s suitable for your needs. Instead of Docker integration. But it&#39;s not so hard."}], "tags": [], "owner": {"reputation": 675, "user_id": 959303, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/1825e0d6fb7e50d58f10f5ee21c3a045?s=128&d=identicon&r=PG", "display_name": "Alex", "link": "https://stackoverflow.com/users/959303/alex"}, "is_accepted": false, "score": 0, "last_activity_date": 1502362965, "creation_date": 1502362965, "answer_id": 45611923, "question_id": 45425749, "link": "https://stackoverflow.com/questions/45425749/project-structure-for-golang-docker-gradle/45611923#45611923", "title": "Project structure for golang, docker, gradle", "body": "<p>You can take a look to my approach to structure your project <a href=\"https://github.com/alehano/gobootstrap\" rel=\"nofollow noreferrer\">https://github.com/alehano/gobootstrap</a>\nIt's a web framework.</p>\n"}], "owner": {"reputation": 91, "user_id": 1481288, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f1bbd0052d553046ddc64daddfffb474?s=128&d=identicon&r=PG", "display_name": "MBru", "link": "https://stackoverflow.com/users/1481288/mbru"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 964, "favorite_count": 2, "answer_count": 2, "score": 3, "last_activity_date": 1502362965, "creation_date": 1501537298, "question_id": 45425749, "link": "https://stackoverflow.com/questions/45425749/project-structure-for-golang-docker-gradle", "title": "Project structure for golang, docker, gradle", "body": "<p>I am just starting with Go (golang) and want to get a new project folder structure set up for a project that will be built with Gradle and deployed to a Docker image.  I'm struggling to determine what this project structure might look like, primarily because of the GOPATH structure and the fact that the Go language tooling seems to be antithetical to using Gradle or to configuring a project that can be cloned (Git).</p>\n\n<p>The project will eventually contain various server-side code written in Go, client side code written in HTML and JavaScript, so I need a project structure that works well for Gradle to build and package all of these kinds of pieces.</p>\n\n<p>Does anyone have a good working structure and tooling recommendations for this?</p>\n"}, {"tags": ["go", "slice"], "answers": [{"comments": [{"owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "edited": false, "score": 4, "creation_date": 1501531681, "post_id": 45423692, "comment_id": 77810206, "body": "At a certain point, it stops doubling and starts increasing in 25% increments. I think that happens after 1024 elements."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 2, "creation_date": 1501531853, "post_id": 45423692, "comment_id": 77810292, "body": "It&#39;s not just the copy op that takes time, it&#39;s also the alloc."}, {"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1609208201, "post_id": 45423692, "comment_id": 115777472, "body": "As Stephen mentioned, it&#39;s not as simple as doubling, but here&#39;s an interesting case study. I ran some benchmarks recently (1.15.x). Nil slices are an absolute worst case scenario. Until it reaches <code>cap: 10</code> it only adds a single element, then begins doubling (until 1000 or so). So if you begin with a nil slice, or make with 0 cap, then add 10 elements, it has to alloc and copy EVERY iteration. I personally encourage always set cap. You can usually derive the exact n from another value, or at the very least can set it initially to 10 to avoid those first 10 alloc/copy. The benchmarks were bad."}], "tags": [], "owner": {"reputation": 19300, "user_id": 121660, "user_type": "registered", "accept_rate": 89, "profile_image": "https://www.gravatar.com/avatar/39396b815c9a804b8b99000ee9ea50e8?s=128&d=identicon&r=PG", "display_name": "captncraig", "link": "https://stackoverflow.com/users/121660/captncraig"}, "is_accepted": true, "score": 24, "last_activity_date": 1570466296, "last_edit_date": 1570466296, "creation_date": 1501528699, "answer_id": 45423692, "question_id": 45423667, "link": "https://stackoverflow.com/questions/45423667/what-is-the-point-in-setting-a-slices-capacity/45423692#45423692", "title": "What is the point in setting a slice&#39;s capacity?", "body": "<p>A slice is really just a fancy way to manage an underlying array. It automatically tracks size, and re-allocates new space as needed.</p>\n\n<p>As you append to a slice, the runtime doubles its capacity every time it exceeds its current capacity. It has to copy all of the elements to do that. If you know how big it will be before you start, you can avoid a few copy operations and memory allocations by grabbing it all up front.</p>\n\n<p>When you <code>make</code> a slice providing capacity, you set tht <strong>initial capacity</strong>, not any kind of <strong>limit</strong>.</p>\n\n<p>See <a href=\"https://blog.golang.org/go-slices-usage-and-internals#TOC_5.\" rel=\"noreferrer\">this blog post on slices</a> for some interesting internal details of slices.</p>\n"}, {"tags": [], "owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "is_accepted": false, "score": 13, "last_activity_date": 1501547827, "last_edit_date": 1501547827, "creation_date": 1501530737, "answer_id": 45424230, "question_id": 45423667, "link": "https://stackoverflow.com/questions/45423667/what-is-the-point-in-setting-a-slices-capacity/45424230#45424230", "title": "What is the point in setting a slice&#39;s capacity?", "body": "<p>A <code>slice</code> is a wonderful abstraction of a simple <code>array</code>. You get all sorts of nice features, but deep down at its core, lies an <code>array</code>. (I explain the following in reverse order for a reason). Therefore, if/when you specify a <code>capacity</code> of <code>3</code>, deep down, an array of length <code>3</code> is allocated in memory, which you can <code>append</code> up to without having it need to reallocate memory. This attribute is optional in the <code>make</code> command, but note that a <code>slice</code> will always have a <code>capacity</code> whether or not you choose to specify one. If you specify a <code>length</code> (which always exists as well), the <code>slice</code> be indexable up to that length. The rest of the <code>capacity</code> is hidden away behind the scenes so it does not have to allocate <strong>an entirely new array</strong> when <code>append</code> is used.</p>\n\n<p>Here is an example to better explain the mechanics.</p>\n\n<p><code>s := make([]int, 1, 3)</code></p>\n\n<p>The underlying <code>array</code> will be allocated with <code>3</code> of the zero value of <code>int</code> (which is <code>0</code>):</p>\n\n<p><code>[0,0,0]</code></p>\n\n<p>However, the <code>length</code> is set to <code>1</code>, so the slice itself will only print <code>[0]</code>, and if you try to index the second or third value, it will <code>panic</code>, as the <code>slice</code>'s mechanics do not allow it. If you <code>s = append(s, 1)</code> to it, you will find that it has actually been created to contain <code>zero</code> values up to the <code>length</code>, and you will end up with <code>[0,1]</code>. At this point, you can <code>append</code> once more before the entire underlying <code>array</code> is filled, and another <code>append</code> will force it to allocate a new one and copy all the values over with a doubled capacity. This is actually a rather expensive operation.</p>\n\n<p><strong>Therefore</strong> the short answer to your question is that preallocating the <code>capacity</code> can be used to vastly improve the efficiency of your code. Especially so if the <code>slice</code> is either going to end up very large, or contains complex <code>structs</code> (or both), as the <code>zero</code> value of a <code>struct</code> is effectively the <code>zero</code> values of every single one of its <code>fields</code>. This is not because it would avoid allocating those values, as it has to anyway, but because <code>append</code> would have to reallocate new <code>array</code>s full of these zero values each time it would need to resize the underlying array.</p>\n\n<p>Short playground example: <a href=\"https://play.golang.org/p/LGAYVlw-jr\" rel=\"noreferrer\">https://play.golang.org/p/LGAYVlw-jr</a></p>\n"}, {"comments": [{"owner": {"reputation": 5044, "user_id": 1276480, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/v8UB8.jpg?s=128&g=1", "display_name": "RayfenWindspear", "link": "https://stackoverflow.com/users/1276480/rayfenwindspear"}, "edited": false, "score": 0, "creation_date": 1609208894, "post_id": 61859406, "comment_id": 115777593, "body": "I really like your answer here. I&#39;m curious what version of go you used for these benchmarks. I recently found that <code>n=10</code> is a subtly nefarious worst case (when <code>cap</code> starts at 0), but it didn&#39;t show as such in your benchmark. I found that a slice with <code>cap &lt; 10</code> only adds a single element when <code>makeslice</code> is called. But your benchmark only showed 3 allocs with <code>n=10</code>. I&#39;ll have to read the changelogs again."}], "tags": [], "owner": {"reputation": 2186, "user_id": 6515647, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e2cec9665b47aae5620d387bf95d2f15?s=128&d=identicon&r=PG&f=1", "display_name": "Dave Fort", "link": "https://stackoverflow.com/users/6515647/dave-fort"}, "is_accepted": false, "score": 4, "last_activity_date": 1589752977, "creation_date": 1589752977, "answer_id": 61859406, "question_id": 45423667, "link": "https://stackoverflow.com/questions/45423667/what-is-the-point-in-setting-a-slices-capacity/61859406#61859406", "title": "What is the point in setting a slice&#39;s capacity?", "body": "<p>As others have already said, using the <code>cap</code> parameter can avoid unnecessary allocations. To give a sense of the performance difference, imagine you have a <code>[]float64</code> of random values and want a new slice that filters out values that are not above, say, <code>0.5</code>.</p>\n\n<p><strong>Naive approach - no len or cap param</strong></p>\n\n<pre><code>func filter(input []float64) []float64 {\n    ret := make([]float64, 0)\n    for _, el := range input {\n        if el &gt; .5 {\n            ret = append(ret, el)\n        }\n    }\n    return ret\n}\n</code></pre>\n\n<p><strong>Better approach - using cap param</strong></p>\n\n<pre><code>func filterCap(input []float64) []float64 {\n    ret := make([]float64, 0, len(input))\n    for _, el := range input {\n        if el &gt; .5 {\n            ret = append(ret, el)\n        }\n    }\n    return ret\n}\n</code></pre>\n\n<p><strong>Benchmarks (n=10)</strong></p>\n\n<pre><code>filter     131 ns/op    56 B/op  3 allocs/op\nfilterCap   56 ns/op    80 B/op  1 allocs/op\n</code></pre>\n\n<p>Using <code>cap</code> made the program 2x+ faster and reduced the number of allocations from 3 to 1. Now what happens at scale?</p>\n\n<p><strong>Benchmarks (n=1,000,000)</strong></p>\n\n<pre><code>filter     9630341 ns/op    23004421 B/op    37 allocs/op\nfilterCap  6906778 ns/op     8003584 B/op     1 allocs/op\n</code></pre>\n\n<p>The speed difference is still significant (~1.4x) thanks to 36 fewer calls to <code>runtime.makeslice</code>. However, the bigger difference is the memory allocation (~4x less). </p>\n\n<p><strong>Even better - calibrating the cap</strong></p>\n\n<p>You may have noticed in the first benchmark that <code>cap</code> makes the overall memory allocation worse (<code>80B vs 56B</code>). This is because you allocate 10 slots but only need, on average, 5 of them. This is why you don't want to set <code>cap</code> unnecessarily high. Given what you know about your program, you may be able to calibrate the capacity. In this case, we can estimate that our filtered slice will need 50% as many slots as the original slice. </p>\n\n<pre><code>func filterCalibratedCap(input []float64) []float64 {\n    ret := make([]float64, 0, len(input)/2)\n    for _, el := range input {\n        if el &gt; .5 {\n            ret = append(ret, el)\n        }\n    }\n    return ret\n}\n</code></pre>\n\n<p>Unsurprisingly, this calibrated <code>cap</code> allocates 50% as much memory as its predecessor, so that's ~8x improvement on the naive implementation at 1m elements.</p>\n\n<p><strong>Another option - using direct access instead of append</strong></p>\n\n<p>If you are looking to shave even more time off a program like this, initialize with the <code>len</code> parameter (and ignore the cap parameter), access the new slice directly instead of using append, then throw away all the slots you don't need. </p>\n\n<pre><code>func filterLen(input []float64) []float64 {\n    ret := make([]float64, len(input))\n    var counter int\n    for _, el := range input {\n        if el &gt; .5 {\n            ret[counter] = el\n            counter++\n        }\n    }\n    return ret[:counter]\n}\n</code></pre>\n\n<p>This is ~10% faster than <code>filterCap</code> at scale. However, in addition to being more complicated, this pattern does not provide the same safety as <code>cap</code> if you try and calibrate the memory requirement. </p>\n\n<ul>\n<li>With <code>cap</code> calibration, if you underestimate the total capacity required, then the program will automatically allocate more when it needs it. </li>\n<li>With this approach, if you underestimate the total <code>len</code> required, the program will fail. In this example, if you initialize as <code>ret := make([]float64, len(input)/2)</code>, and it turns out that <code>len(output) &gt; len(input)/2</code>, then at some point the program will try to access a non-existent slot and panic.</li>\n</ul>\n"}], "owner": {"reputation": 3690, "user_id": 3960852, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/FhcvT.png?s=128&g=1", "display_name": "Kenny Worden", "link": "https://stackoverflow.com/users/3960852/kenny-worden"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4830, "favorite_count": 4, "accepted_answer_id": 45423692, "answer_count": 3, "score": 17, "last_activity_date": 1589752977, "creation_date": 1501528600, "question_id": 45423667, "link": "https://stackoverflow.com/questions/45423667/what-is-the-point-in-setting-a-slices-capacity", "title": "What is the point in setting a slice&#39;s capacity?", "body": "<p>In Golang, we can use the builtin <code>make()</code> function to create a slice with a given initial length and capacity.</p>\n\n<p>Consider the following lines, the slice's length is set to 1, and its capacity 3:</p>\n\n<pre><code>func main() {\n    var slice = make([]int, 1, 3)\n    slice[0] = 1\n    slice = append(slice, 6, 0, 2, 4, 3, 1)\n    fmt.Println(slice)\n}\n</code></pre>\n\n<p>I was surprised to see that this program prints:</p>\n\n<blockquote>\n  <p>[1\u00a06\u00a00\u00a02\u00a04\u00a03\u00a01]</p>\n</blockquote>\n\n<p>This got me wondering- what is the point of initially defining a slice's capacity if <code>append()</code> can simply blow past it? Are there performance gains for setting a sufficiently large capacity?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501526547, "post_id": 45422960, "comment_id": 77807512, "body": "So <code>&amp;a{}</code> is assignable to <code>b</code> because they have the same underlying type (<code>*a</code>), but <code>a{}</code> is not assignable to <code>c</code> because they don&#39;t have the same underlying type? Don&#39;t <code>c</code> and <code>a{}</code> share the same underlying type (<code>a</code>)?"}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 1, "creation_date": 1501526686, "post_id": 45422960, "comment_id": 77807585, "body": "And both <code>c</code> and <code>a</code> are named types. But a value of <code>*a</code> has not a named type, it&#39;s just a pointer to <code>a</code>. One of them (the value or the variable that we are assign the value to) must be an unnamed type (like <code>*a</code>). It goes both ways too: <code>var vb b; var vpa *a; vb = vpa; vpa = vb</code> (pseudo Go)."}, {"owner": {"reputation": 5163, "user_id": 1435461, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/05f6236ee5ec04b27e27f504ebdd3744?s=128&d=identicon&r=PG", "display_name": "rcorre", "link": "https://stackoverflow.com/users/1435461/rcorre"}, "edited": false, "score": 0, "creation_date": 1501552058, "post_id": 45422960, "comment_id": 77816719, "body": "Any idea what the motivation for this specific behavior is? I understand the general concept is keeping named types distinct by disallowing implicit conversion, but I don&#39;t see why pointer/value should matter in that context."}, {"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 0, "creation_date": 1501576277, "post_id": 45422960, "comment_id": 77826439, "body": "A named type implies the presence of a specific behavior/semantic, strictly. A value of a specific named type, does present that behavior. An unnamed type does not present a strict behavior of it&#39;s own, only maybe an implicit behavior, like an interface, or what it inherits from the underlying type."}], "tags": [], "owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "is_accepted": false, "score": 3, "last_activity_date": 1501525942, "creation_date": 1501525942, "answer_id": 45422960, "question_id": 45422271, "link": "https://stackoverflow.com/questions/45422271/why-can-i-directly-assign-an-alias-only-when-it-is-to-a-pointer/45422960#45422960", "title": "Why can I directly assign an alias only when it is to a pointer?", "body": "<p>According to the spec, in the <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"nofollow noreferrer\">assignability</a> part, <code>a value x is assignable to a variable of type T (\"x is assignable to T\") ... x's type V and T have identical underlying types and at least one of V or T is not a named type</code>.</p>\n\n<p>Value <code>&amp;a{}</code> is not a named type. It's a pointer to <code>a</code>, means <code>*a</code>. The underlying type of both value <code>&amp;a{}</code> and type <code>b</code> is <code>*a</code>, pointer to <code>a</code>. Hence we can assign value <code>&amp;a{}</code> to a variable of type <code>b</code>.</p>\n\n<p>But value <code>a{}</code> which type's is <code>a</code>, can not be assigned to a variable of type <code>c</code> because it does not fulfill any of those conditions and their underlying types (<code>a</code> and <code>c</code>) are not the same.</p>\n"}, {"tags": [], "owner": {"reputation": 43554, "user_id": 727643, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/RIm6q.jpg?s=128&g=1", "display_name": "Stephen Weinberg", "link": "https://stackoverflow.com/users/727643/stephen-weinberg"}, "is_accepted": false, "score": 5, "last_activity_date": 1501526789, "last_edit_date": 1592644375, "creation_date": 1501526789, "answer_id": 45423195, "question_id": 45422271, "link": "https://stackoverflow.com/questions/45422271/why-can-i-directly-assign-an-alias-only-when-it-is-to-a-pointer/45423195#45423195", "title": "Why can I directly assign an alias only when it is to a pointer?", "body": "<p>According to the <a href=\"https://golang.org/ref/spec#Assignability\" rel=\"noreferrer\">go spec</a>:</p>\n<blockquote>\n<p>A value x is assignable to a variable of type T (&quot;x is assignable to T&quot;) in any of these cases:</p>\n<ul>\n<li>...</li>\n<li>x's type V and T have identical underlying types and at least one of V or T is not a named type.</li>\n<li>...</li>\n</ul>\n</blockquote>\n<p>Also, on the definition of &quot;unnamed&quot;:</p>\n<blockquote>\n<p>A type determines the set of values and operations specific to values of that type. Types may be named or unnamed. Named types are specified by a (possibly qualified) type name; unnamed types are specified using a type literal, which composes a new type from existing types.</p>\n</blockquote>\n<p>Essentially, you can think of a named type as any type that can be represented as just an identifier or identifiers separated by dots. For example, <code>foo</code> or <code>Foo.Bar</code>.</p>\n<hr />\n<p>In your example, you are always assigning between variables with the same underlying type. The issue is whether at least one of the types involved is &quot;unnamed&quot;.</p>\n<p>In this case, you are assigning <code>&amp;a{}</code>, which is a <code>*a</code> (unnamed) to a variable of named type <code>b</code>. This works. However when you assign <code>a{}</code> (named type <code>a</code>) to a variable of type <code>c</code>, neither is unnamed and you get an error.</p>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 0, "last_activity_date": 1501529589, "creation_date": 1501529589, "answer_id": 45423928, "question_id": 45422271, "link": "https://stackoverflow.com/questions/45422271/why-can-i-directly-assign-an-alias-only-when-it-is-to-a-pointer/45423928#45423928", "title": "Why can I directly assign an alias only when it is to a pointer?", "body": "<p>As already mentioned it's about assignability of unnamed types, not about a pointers.</p>\n\n<pre><code>var _ c = struct{}{} //same as a{} but unnamed\n</code></pre>\n\n<p>compiles.</p>\n"}], "owner": {"reputation": 5163, "user_id": 1435461, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/05f6236ee5ec04b27e27f504ebdd3744?s=128&d=identicon&r=PG", "display_name": "rcorre", "link": "https://stackoverflow.com/users/1435461/rcorre"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 116, "favorite_count": 0, "answer_count": 3, "score": 8, "last_activity_date": 1501529589, "creation_date": 1501523383, "question_id": 45422271, "link": "https://stackoverflow.com/questions/45422271/why-can-i-directly-assign-an-alias-only-when-it-is-to-a-pointer", "title": "Why can I directly assign an alias only when it is to a pointer?", "body": "<pre><code>type a struct{}\n\ntype b *a\ntype c a\n\nfunc main() {\n    var _ b = &amp;a{}\n    var _ c = a{}\n}\n</code></pre>\n\n<p>Why is the <code>b</code> assignment valid but not the <code>c</code> assignment? I realize the latter is possible with a cast, but I'm wondering what the reasoning for this restriction is.</p>\n"}, {"tags": ["go", "etcd", "etcd3"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1501522918, "post_id": 45422109, "comment_id": 77805466, "body": "You&#39;re using the old <code>golang.org&#47;x&#47;net&#47;context</code> package when you should be using the <code>context</code> package in the std library."}, {"owner": {"reputation": 3246, "user_id": 477505, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1673a2d1e5a9106191b8c753a6e0b133?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/477505/miguel"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501524574, "post_id": 45422109, "comment_id": 77806431, "body": "It&#39;s not me, in fact, but <code>etcd</code> :-( I tried switching to the old package and I got a similar error (please check my edit)."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1501525427, "post_id": 45422109, "comment_id": 77806891, "body": "That&#39;s because you&#39;re using a &quot;method expression&quot;, which means that you&#39;re calling a method without the implied receiver. I&#39;m not familiar with their client package, and I&#39;m not sure why the client has a <code>KV</code> field at all, but the Txn example under <a href=\"https://godoc.org/github.com/coreos/etcd/clientv3#KV\" rel=\"nofollow noreferrer\"><code>KV</code></a> at least shows you need to need to use <code>NewKv</code> to be able to call <code>Txn</code>"}, {"owner": {"reputation": 3246, "user_id": 477505, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1673a2d1e5a9106191b8c753a6e0b133?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/477505/miguel"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501525721, "post_id": 45422109, "comment_id": 77807052, "body": "Thank you very much JimB. I wish I could approve your comment as an answer. It works now :-)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501525851, "post_id": 45422109, "comment_id": 77807121, "body": "no prob. I was going to try and look to see <i>what</i> the KV field is to explain the behavior when I have a moment. If someone more familiar with that package know, they can certainly write up a complete answer first."}], "owner": {"reputation": 3246, "user_id": 477505, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/1673a2d1e5a9106191b8c753a6e0b133?s=128&d=identicon&r=PG&f=1", "display_name": "Miguel", "link": "https://stackoverflow.com/users/477505/miguel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1482, "favorite_count": 1, "answer_count": 0, "score": 1, "last_activity_date": 1501524714, "creation_date": 1501522749, "last_edit_date": 1501524714, "question_id": 45422109, "link": "https://stackoverflow.com/questions/45422109/compare-and-swap-in-etcd-v3", "title": "Compare-and-swap in etcd v3?", "body": "<p>I'm trying to do a compare-and-store operation on a given key using etcd's Go client for the <code>v3</code> API. Seeing that <code>--swap-with-value</code> seems to be gone from <code>etcdctl put</code>, I suspect there's no corresponding method or argument in the client library either. Thus, I'm attempting my own implementation:</p>\n\n<pre><code>res, err := etcdv3.KV.Txn(context.Background()).If(\n    etcdv3.Compare(etcdv3.ModRevision(c.path), \"=\", c.modRevision),\n).Then(\n    etcdv3.OpPut(c.path, string(data)),\n    etcdv3.OpGet(c.path),\n).Commit()\n\nif err != nil {\n    return err\n}\nif !res.Succeeded {\n    return fmt.Errorf(\"A newer revision exists.\")\n}\n\n// Return the current `ModRevision` on success.\nreturn res.Responses[1].GetResponseRange().Kvs[0].ModRevision\n</code></pre>\n\n<p>However, Go refuses to compile with this message:</p>\n\n<pre><code>main.go:55: not enough arguments in call to method expression clientv3.KV.Txn\n    have (\"context\".Context)\n    want (clientv3.KV, \"github.com/miguel/myproject/vendor/golang.org/x/net/context\".Context)\n</code></pre>\n\n<p>What's wrong with this approach? Why does Go refuse to compile this snippet?</p>\n\n<p><strong>Edit:</strong> Thanks to JimB I found out that <code>etcdv3</code> is importing the old <code>golang/x/net/context</code> packages. I switched the <code>import</code> statements, but I still get something similar:</p>\n\n<pre><code>main.go:55: not enough arguments in call to method expression clientv3.KV.Txn\n    have (\"github.com/miguel/myproject/vendor/golang.org/x/net/context\".Context)\n    want (clientv3.KV, \"github.com/miguel/myproject/vendor/golang.org/x/net/context\".Context)\n</code></pre>\n"}, {"tags": ["selenium", "go", "saucelabs", "ginkgo", "agouti"], "comments": [{"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1501524515, "post_id": 45421439, "comment_id": 77806391, "body": "Are you saying that you don&#39;t know how to parse Output to get Desired Output?"}, {"owner": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "reply_to_user": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1501525115, "post_id": 45421439, "comment_id": 77806720, "body": "Yes, I am unable to parse the output or any other alternative to just retrieve the Session ID."}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1501525558, "post_id": 45421439, "comment_id": 77806966, "body": "Just convert the <code>sessionId</code> to a string, split it by space, and take the first part."}, {"owner": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "reply_to_user": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1501526922, "post_id": 45421439, "comment_id": 77807697, "body": "I tried following that approach, but I was unable to convert the variable &quot;sessionId&quot; to string, as the return type of page.Session() is *api.Session"}, {"owner": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1501529375, "post_id": 45421439, "comment_id": 77809010, "body": "The fact that the logs contain the sessionId as a string, clearly it&#39;s possible. What have you tried to convert it to string? Please add that code to your question."}, {"owner": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "reply_to_user": {"reputation": 18005, "user_id": 2386774, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea7da142cb7e85d5d5a8576e2625431?s=128&d=identicon&r=PG", "display_name": "JeffC", "link": "https://stackoverflow.com/users/2386774/jeffc"}, "edited": false, "score": 0, "creation_date": 1501532034, "post_id": 45421439, "comment_id": 77810388, "body": "I used : sessionId, _ = json.Marshal(sessionId)  But i get the error message as &quot;cannot assign [] byte to session id (type *api.Session in multiple assignment&quot;"}], "answers": [{"comments": [{"owner": {"reputation": 9968, "user_id": 114900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZGjf9.jpg?s=128&g=1", "display_name": "msanford", "link": "https://stackoverflow.com/users/114900/msanford"}, "edited": false, "score": 0, "creation_date": 1501521075, "post_id": 45421698, "comment_id": 77804349, "body": "OP&#39;s &quot;Desired Output&quot; is the one <i>without</i> <code>0x1707a60</code>."}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "reply_to_user": {"reputation": 9968, "user_id": 114900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZGjf9.jpg?s=128&g=1", "display_name": "msanford", "link": "https://stackoverflow.com/users/114900/msanford"}, "edited": false, "score": 0, "creation_date": 1501521123, "post_id": 45421698, "comment_id": 77804382, "body": "Ya I got the desired output and output confused. Just updated it @msanford"}, {"owner": {"reputation": 9968, "user_id": 114900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZGjf9.jpg?s=128&g=1", "display_name": "msanford", "link": "https://stackoverflow.com/users/114900/msanford"}, "edited": false, "score": 0, "creation_date": 1501521164, "post_id": 45421698, "comment_id": 77804410, "body": "Also not correct, this only prints the first 10 characters; OP wants to truncate the <i>final</i> 10 characters."}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "reply_to_user": {"reputation": 9968, "user_id": 114900, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ZGjf9.jpg?s=128&g=1", "display_name": "msanford", "link": "https://stackoverflow.com/users/114900/msanford"}, "edited": false, "score": 1, "creation_date": 1501521703, "post_id": 45421698, "comment_id": 77804753, "body": "Yup. Yours is good. Just want to save as much code as possible!"}, {"owner": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "edited": false, "score": 1, "creation_date": 1501521726, "post_id": 45421698, "comment_id": 77804764, "body": "I tried with the sessionId[:32] but as its not a string variable cannot slice it I suppose.   Error: cannot slice sessionId (type *api.Session)"}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501521745, "post_id": 45421698, "comment_id": 77804784, "body": "What language are you using?"}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "edited": false, "score": 0, "creation_date": 1501521927, "post_id": 45421698, "comment_id": 77804870, "body": "Try <code>fmt.Println(TrimRight(sessionId, 10))</code>"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501521986, "post_id": 45421698, "comment_id": 77804900, "body": "@Brendan It&#39;s not a string. You would need something like <code>fmt.Println(fmt.Sprintf(&quot;%s&quot;, sessionId)[:32])</code>."}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "reply_to_user": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "edited": false, "score": 0, "creation_date": 1501522116, "post_id": 45421698, "comment_id": 77804980, "body": "So try that @Anvesh"}, {"owner": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "edited": false, "score": 0, "creation_date": 1501522577, "post_id": 45421698, "comment_id": 77805282, "body": "I think we need to first convert the *api.session to string type only then it would work.   I tried fmt.Println(fmt.Sprintf(&quot;%s&quot;, sessionId)[:32]) but received a weird output - &amp;{%!s(*bus.Client=&amp;{<a href=\"http://amalh\" rel=\"nofollow noreferrer\">amalh</a>"}, {"owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "reply_to_user": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "edited": false, "score": 0, "creation_date": 1505589907, "post_id": 45421698, "comment_id": 79478773, "body": "@Anvesh did you get it working? If so please mark my answer as correct so people in the future can fix this issue!"}], "tags": [], "owner": {"reputation": 1843, "user_id": 6689050, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fca72591557480c5d59e90f947a7b9d?s=128&d=identicon&r=PG&f=1", "display_name": "James", "link": "https://stackoverflow.com/users/6689050/james"}, "is_accepted": false, "score": 0, "last_activity_date": 1501522144, "last_edit_date": 1501522144, "creation_date": 1501521018, "answer_id": 45421698, "question_id": 45421439, "link": "https://stackoverflow.com/questions/45421439/retrieve-the-session-id-in-agouti-webdriver-for-golang/45421698#45421698", "title": "Retrieve the session ID in *agouti.webdriver for Golang", "body": "<p><code>fmt.Println(fmt.Sprintf(\"%s\", sessionId)[:32])</code> thanks to Gavin!</p>\n\n<p>Good luck!</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "is_accepted": false, "score": 1, "last_activity_date": 1505743153, "creation_date": 1505743153, "answer_id": 46281193, "question_id": 45421439, "link": "https://stackoverflow.com/questions/45421439/retrieve-the-session-id-in-agouti-webdriver-for-golang/46281193#46281193", "title": "Retrieve the session ID in *agouti.webdriver for Golang", "body": "<p>The page.Session().Bus returns a type *apiSession to extract the session ID. Use of Indirect can help us return the value that *apiSession points to in this case page.Session().Bus from there we can extract the sessionID. </p>\n\n<pre><code>sessionBus := reflect.ValueOf(page.Session().Bus)\nsessionURL := reflect.Indirect(sessionBus)\nsessionField := sessionURL.FieldByName(`SessionURL`)\nsessionString := sessionField.String()\nsessionSplit := strings.SplitN(sessionString, \"/\", 7)\nsessionID := sessionSplit[len(sessionSplit)-1]\n</code></pre>\n"}], "owner": {"reputation": 149, "user_id": 8383855, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f4051308206bcb96048ec6646da25685?s=128&d=identicon&r=PG&f=1", "display_name": "Anvesh", "link": "https://stackoverflow.com/users/8383855/anvesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 506, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1505743153, "creation_date": 1501520045, "last_edit_date": 1501692665, "question_id": 45421439, "link": "https://stackoverflow.com/questions/45421439/retrieve-the-session-id-in-agouti-webdriver-for-golang", "title": "Retrieve the session ID in *agouti.webdriver for Golang", "body": "<p>I want to use the session id while creating a new WebDriver with Agouti to pass it to SauceLabs for status update.</p>\n\n<p>Commands Used:</p>\n\n<pre><code>url := fmt.Sprintf(\"http://%s:%s@ondemand.saucelabs.com/wd/hub\", username, accesskey)\npage,err :=agouti.NewPage(url, options)\nExpect(err).NotTo(HaveOccurred())\npage.Navigate(`https://qiita.com/login`)\n</code></pre>\n\n<p>I tried to retrieve the session ID from <code>page.Session()</code> but the return type is a Bus Interface and result is Session with the <code>*http.client</code> variable.</p>\n\n<p>Is there any other alternative to it?, to just retrieve the session id.</p>\n"}, {"tags": ["testing", "go", "functional-testing", "fixtures"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501515609, "post_id": 45419928, "comment_id": 77801114, "body": "Why do you need to embed <code>package_with-types.User</code> is another struct for testing, instead of just using <code>package_with-types.User</code>?"}, {"owner": {"reputation": 11, "user_id": 4940633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNrvq.png?s=128&g=1", "display_name": "timrose", "link": "https://stackoverflow.com/users/4940633/timrose"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501515671, "post_id": 45419928, "comment_id": 77801152, "body": "i add the valid field in the test project. the package_with-types.User is used in different packages in my project. i tried to decouple packages from each other and have only one dependency that is my package_with-types."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501515886, "post_id": 45419928, "comment_id": 77801271, "body": "The json you output doesn&#39;t exactly reflect the way you an access those properties. With embedded types, you can access the fields from that embedded type like you normally would i.e. even though your json shows you would have to do something like <code>user.User.Field</code>, you can actually just use <code>user.Field</code> in code."}, {"owner": {"reputation": 11, "user_id": 4940633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNrvq.png?s=128&g=1", "display_name": "timrose", "link": "https://stackoverflow.com/users/4940633/timrose"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501516113, "post_id": 45419928, "comment_id": 77801417, "body": "uups! Thank you Gavin! I should first try and ask later."}, {"owner": {"reputation": 11, "user_id": 4940633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNrvq.png?s=128&g=1", "display_name": "timrose", "link": "https://stackoverflow.com/users/4940633/timrose"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501532132, "post_id": 45419928, "comment_id": 77810427, "body": "i found the next Problem, the valid field from my json file dosnt get parsed into the extended struct. Thats a bigger Problem, maybe i update my post."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501532726, "post_id": 45419928, "comment_id": 77810745, "body": "Just glancing at your code, I&#39;m guessing it&#39;s because the field isn&#39;t exported, so the json package can&#39;t see it."}, {"owner": {"reputation": 11, "user_id": 4940633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNrvq.png?s=128&g=1", "display_name": "timrose", "link": "https://stackoverflow.com/users/4940633/timrose"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1501533069, "post_id": 45419928, "comment_id": 77810920, "body": "yes that was the Problem, thank you again."}], "owner": {"reputation": 11, "user_id": 4940633, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/VNrvq.png?s=128&g=1", "display_name": "timrose", "link": "https://stackoverflow.com/users/4940633/timrose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 183, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501571742, "creation_date": 1501515167, "last_edit_date": 1501571742, "question_id": 45419928, "link": "https://stackoverflow.com/questions/45419928/trying-to-extend-a-struct-type-but-dont-want-it-nested", "title": "trying to extend a struct type, but dont want it nested", "body": "<p>i am trying to write some integration tests for me RESTAPI. I am at the point where i need\nsome testdata. I thought it would be cool to use my Type: User in my Tests from my\nown package.</p>\n\n<pre><code>type User struct {\n    ID        string `db:\"id\" json:\"id\"`\n    AccountID string `db:\"account_id\" json:\"account_id,omitempty\"`\n    Email     string `db:\"email\" json:\"email\"`\n    Password  string `db:\"password\" json:\"password,omitempty\"`\n}\n</code></pre>\n\n<p>I have defined a new field called valid in the fixtures/users.json. </p>\n\n<pre><code>[\n{\n    \"AccountID\": \"19b849bd-f3db-4a92-8968-603e5473a9e2\",\n    \"Email\": \"mail@domain.tld\",\n    \"Password\": \"test116\",\n    \"valid\": false\n},\n{\n    \"AccountID\": \"19b849bd-f3db-4a92-8968-603e5473a9e2\",\n    \"Email\": \"mail1@domain.tld\",\n    \"Password\": \"test147\",\n    \"valid\": false\n},\n{\n    \"AccountID\": \"403fd0d1-cca1-4a7b-80fb-1a51c85fbde0\",\n    \"Email\": \"mail2@domain.tld\",\n    \"Password\": \"test2617\",\n    \"valid\": true\n}\n]\n</code></pre>\n\n<p>now i have this little helper method to load the json into a my struct.</p>\n\n<pre><code>func loadJSONtoStruct(target interface{}, filename string) error {\n\n    file, err := ioutil.ReadFile(filename)\n    if err != nil {\n        fmt.Printf(\"Cant read file: %v\\n\", err)\n        return err\n    }\n\n    err = json.Unmarshal(file, &amp;target)\n    if err != nil {\n        fmt.Printf(\"Cant unmarshal: %v\\n\", err)\n        return err\n    }\n\n    return nil\n}\n\npackage main_test\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n\n    . \"github.com/onsi/ginkgo\"\n    . \"github.com/onsi/gomega\"\n    \"github.com/parnurzeal/gorequest\"\n    \"domain.tld/project/backend/package_with-types\"\n)\n\ntype user struct {\n    package_with-types.User\n    valid bool\n}\n\nvar _ = BeforeSuite(func() {\n    request = gorequest.New()\n    err := loadJSONtoStruct(&amp;users, \"fixtures/users.json\")\n    if err != nil {\n        fmt.Printf(\"%+v\", err)\n    }\n\n    fmt.Printf(\"%+v\\n\", users)\n})\n</code></pre>\n\n<p>but i get this nested struct back</p>\n\n<pre><code>[{\nUser: {\n    ID: AccountID: \n    Email:mail@domain.tld \n    Password:test116\n} \nvalid:false\n},\n{\nUser:  {\n    ID: AccountID: \n    Email:mail1@domain.tld \n    Password:test147\n} \nvalid:false\n},\n{\nUser: {\n    ID: AccountID: \n    Email:mail2@domain.tld \n    Password:test2617\n} \nvalid:false\n}]\n</code></pre>\n\n<p>and i want this:</p>\n\n<pre><code>[{\n    ID: AccountID: \n    Email:mail@domain.tld \n    Password:test116\n    valid:false\n},\n{\n    ID: AccountID: \n    Email:mail1@domain.tld \n    Password:test147\n    valid:false\n},\n{\n    ID: AccountID: \n    Email:mail2@domain.tld \n    Password:test2617\n    valid:false\n}]\n</code></pre>\n\n<p>what do you think? should i live with it, and use user.user.ID, user.valid ... in my tests? any hints are welcome i am learning.</p>\n\n<p>thank you\nTim</p>\n\n<p><strong>Update</strong></p>\n\n<p>The valid field in my fixtures/users.json dosnt get parsed into the\nextended struct.I think that Problem is much bigger.</p>\n\n<p><strong>Update 2</strong></p>\n\n<p>Thanks to gavin, this time it was the unexported field:</p>\n\n<pre><code>type user struct {\n    package_with-types.User\n    valid bool `json:\"valid\"`\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 782, "user_id": 7071577, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8b816a812978bc140df497f0fbdd49c0?s=128&d=identicon&r=PG&f=1", "display_name": "Carlos Gonzalez", "link": "https://stackoverflow.com/users/7071577/carlos-gonzalez"}, "edited": false, "score": 0, "creation_date": 1501512989, "post_id": 45419003, "comment_id": 77799189, "body": "If the resource folder is inside your project you can use relative paths instead of absolute paths. I do recommend you have a look at <a href=\"https://github.com/kardianos/govendor\" rel=\"nofollow noreferrer\">govendor</a> to install dependencies."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501513504, "post_id": 45419003, "comment_id": 77799581, "body": "Your binary has no knowledge of the source directory, and in most deployments there won&#39;t even be a source directory. It&#39;s up to the user deploying the application to supply required external resources separately from <code>go get</code> or <code>go install</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1501514382, "post_id": 45419003, "comment_id": 77800241, "body": "@vonaka: normally a program has some flexible method of finding resources, be it either a default search path, a flag, an environment variable, or a combination of the three. It&#39;s is up to you to document how your program works."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501515724, "post_id": 45419003, "comment_id": 77801176, "body": "@vonaka: I&#39;m not sure what you mean by that. Libraries that you want to share should always be <code>go get</code>-able to install the source, but there&#39;s no reason you shouldn&#39;t have to read the docs to learn how to use the package. Simple binary tools may work completely via <code>go get</code> (<code>go install</code> is run as part of the <code>go get</code> process), but larger go projects often include Makefiles or build scripts once the basic build tools no longer suffice."}], "owner": {"reputation": 800, "user_id": 8208981, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9eeb707bfd44f3aac336e6da2a2954b7?s=128&d=identicon&r=PG&f=1", "display_name": "vonaka", "link": "https://stackoverflow.com/users/8208981/vonaka"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 173, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501512369, "creation_date": 1501512369, "question_id": 45419003, "link": "https://stackoverflow.com/questions/45419003/go-install-and-resources-folder", "title": "Go install and resources folder", "body": "<p>I have a programme with some resources in separate folder, I'd like to encourage potential users to use  <code>go get</code> + <code>go install</code> (in spirit of golang and without makefile), so binary must to know absolute path to my resources directory, for now I have something like this:</p>\n\n<pre><code>data := os.Getenv(\"GOPATH\") + \"/src/project_name/path_to_resources/\"\n</code></pre>\n\n<p>Is there any other (proper) way to do this?</p>\n"}, {"tags": ["go", "etcd"], "answers": [{"comments": [{"owner": {"reputation": 191, "user_id": 8225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etcEc.jpg?s=128&g=1", "display_name": "bunoi", "link": "https://stackoverflow.com/users/8225565/bunoi"}, "edited": false, "score": 0, "creation_date": 1501515823, "post_id": 45418129, "comment_id": 77801235, "body": "Thank you, that makes sense and works great in my code, I really appreciate the help.  I&#39;ve voted it up but as I am new round here and have less than a 15 reputation it doesn&#39;t show yet."}], "tags": [], "owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "is_accepted": false, "score": 1, "last_activity_date": 1501509974, "creation_date": 1501509974, "answer_id": 45418129, "question_id": 45417781, "link": "https://stackoverflow.com/questions/45417781/etcd-go-clientv3-why-cant-i-get-a-value-without-looping-through-the-result/45418129#45418129", "title": "etcd go clientv3 - why can&#39;t I get a value without looping through the result", "body": "<p>The response object is the same whether you're getting a single key or many keys, so it must provide for multiple results, even when the total count returned is 1. If you know there's only one result, you're not obliged to loop over it, you can just reference the first result:</p>\n\n<pre><code>resp.Kvs[0].Value\n</code></pre>\n\n<p>Of course, you should make sure there was a result first (<code>len(resp.Kvs) &gt; 0</code>) or it will panic.</p>\n"}], "owner": {"reputation": 191, "user_id": 8225565, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/etcEc.jpg?s=128&g=1", "display_name": "bunoi", "link": "https://stackoverflow.com/users/8225565/bunoi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 300, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1501509974, "creation_date": 1501509032, "question_id": 45417781, "link": "https://stackoverflow.com/questions/45417781/etcd-go-clientv3-why-cant-i-get-a-value-without-looping-through-the-result", "title": "etcd go clientv3 - why can&#39;t I get a value without looping through the result", "body": "<p>I'm trying to learn go and have been doing ok but I have come across behaviour that I can't understand. I guess it is not really to do with etcd?</p>\n\n<p>So, I have etcd v3 setup with a key/value.  When I retrieve it with 'get' (see <a href=\"https://godoc.org/github.com/coreos/etcd/clientv3#example-KV--Get\" rel=\"nofollow noreferrer\" title=\"get\">here</a>) I would have expected to be able to retrieve my value using:</p>\n\n<pre><code>fmt.Println(resp.Kvs.Value)\n</code></pre>\n\n<p>however, this doesn't work and I have to do it as per the example (in the link above) and loop through the single result to expose it:</p>\n\n<pre><code>for _, ev := range resp.Kvs {\nfmt.Printf(\"%s : %s\\n\", ev.Key, ev.Value)\n}\n</code></pre>\n\n<p>Please could you help me understand why retrieving the value directly isn't possible and what is going on that makes the loop necessary?</p>\n"}, {"tags": ["windows", "go", "process", "child-process"], "comments": [{"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1501509746, "post_id": 45417403, "comment_id": 77796785, "body": "windows nothing do with child process if parent exit (by any reason). but of course child process can communicate with parent, and if parent exit - terminate self. this already depend on specific child process."}, {"owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "reply_to_user": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1501517942, "post_id": 45417403, "comment_id": 77802611, "body": "I added code to capture any Signal the, child process receives if I terminate the Parent Process, It seems that every time i terminate the parent process the child receives an interrupt signal."}, {"owner": {"reputation": 25518, "user_id": 6401656, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jtwou.jpg?s=128&g=1", "display_name": "RbMm", "link": "https://stackoverflow.com/users/6401656/rbmm"}, "edited": false, "score": 0, "creation_date": 1501518078, "post_id": 45417403, "comment_id": 77802691, "body": "what is <i>signal</i> ? i don know this. this is not windows related. and of course windows nothing send to child process when parent terminated"}, {"owner": {"reputation": 33265, "user_id": 886887, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/1616c7e4fab23f6e014ee11d75408bba?s=128&d=identicon&r=PG", "display_name": "Harry Johnston", "link": "https://stackoverflow.com/users/886887/harry-johnston"}, "edited": false, "score": 1, "creation_date": 1501554935, "post_id": 45417403, "comment_id": 77817331, "body": "Best guess: you&#39;re pressing control-C or control-break.  By default, this will affect all processes in the same console."}, {"owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "edited": false, "score": 0, "creation_date": 1501578121, "post_id": 45417403, "comment_id": 77827689, "body": "Thanks, Yes i was running the Parent Process from Command Window, I looked at the process hierarchy in the SystInternals, Process Explorer tool. It seems when we run a new Process from the command window, they become child process of that Command Windows Process, and doing a Ctrl-C terminates all the child processes."}], "owner": {"reputation": 622, "user_id": 5604249, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/7bed34ebe08c34a10addbea1bf85ff17?s=128&d=identicon&r=PG&f=1", "display_name": "Pharaoh", "link": "https://stackoverflow.com/users/5604249/pharaoh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 605, "favorite_count": 1, "answer_count": 0, "score": 0, "last_activity_date": 1501517993, "creation_date": 1501507973, "last_edit_date": 1501517993, "question_id": 45417403, "link": "https://stackoverflow.com/questions/45417403/child-process-termination-in-windows", "title": "Child Process Termination in windows", "body": "<p>I have .exe application in GO that spawns a child process in windows.\nWhen i terminate my parent process for some reason the child process terminates too.\nHowever when my parent.exe panics and crashed, the child process continue to execute and does not shutdown.</p>\n\n<p>Ideally I was expecting the child process to keep on living if the parent process shuts down(normally or forcefully)</p>\n\n<p>Is the the default behavior of processes in windows?</p>\n\n<p>In addition to above.\nI added code to capture any Signal the child process receives if I terminate the Parent Process, It seems that every time i terminate the parent process the child receives an interrupt signal.</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501508056, "post_id": 45416999, "comment_id": 77795493, "body": "Is Mongo on the same machine as the Go application? Same local network? This sounds like a network issue so I&#39;d rule that out first."}, {"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501509234, "post_id": 45416999, "comment_id": 77796387, "body": "@Adrian yes, it is the same (virtual) machine."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1501509391, "post_id": 45416999, "comment_id": 77796527, "body": "Are these processes running many concurrent requests? Are you closing your sessions when you&#39;re done with them? It could be you&#39;re over taxing the connection pool."}, {"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501512904, "post_id": 45416999, "comment_id": 77799127, "body": "@Adrian I am using mongodb to log events. There are only two concurrent sessions in one Go process. Both are created via session.Copy() from a single &quot;origin&quot; session. These session.Copy() calls happen concurrently during startup. Normally I use these two sessions throughout the lifetime of the process. Access to each single session is serialized. I realize now that my reconnection logic (shown in the post above) does not close the old session before overwriting it with a new (copy). Other than that there is not really a need to close my sessions."}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501514528, "post_id": 45416999, "comment_id": 77800339, "body": "If you can observe it happening live, can you try connecting to mongo from the shell client when the app is having issues? Could be probative. I&#39;d make sure you&#39;re closing dead sessions in your reconnect logic but you&#39;re right, it&#39;s probably not your issue here."}, {"owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501525101, "post_id": 45416999, "comment_id": 77806707, "body": "Observing it live is challenging, since it may happen after as long as 24 hours of running time (of my processes). And whenever I notice it, everything is back to normal (no need to restart mongod). But maybe I can write some code to run the mongo client with some query."}], "owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 81, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1501506916, "creation_date": 1501506916, "question_id": 45416999, "link": "https://stackoverflow.com/questions/45416999/mongodb-error-using-mgo-net-operror-net-timeouterror", "title": "mongodb error using mgo: net.OpError (net.timeoutError)", "body": "<p>I keep getting errors when writing to mongo at unpredictable times and would like to find out the reason.\nI am using the mgo driver for Go. The error is of type <code>net.OpError</code>. Some of its relevant fields:</p>\n\n<pre><code>net.OpError{\n  Err: net.timeoutError,\n  Op: \"read\",\n  Net: \"tcp\",\n}\n</code></pre>\n\n<p>Currently I handle this error by reconnecting:</p>\n\n<pre><code>err := myType.mgoCollection.Insert(msg)\nif err != nil {\n    myType.mgoSession = myType.mgoSession.Copy()\n    myType.mgoCollection = myType.mgoSession.DB(\"my_db_name\").C(\"my_collection_name\")\n}\n</code></pre>\n\n<p>and re-submit. Sometimes this is enough, sometimes several retries are needed. And sometimes even after 10 retries (each around 1 minute) the error is still there (currently I break up after 10 retries).</p>\n\n<p>I could not find anything suspicious in the mongodb logs and do not know where to look further.</p>\n\n<p>Most of my writes to mongo are rather small, but twice a second there are somewhat larger writes (maybe 1 or 10 kb when represented as JSON string).</p>\n\n<p>I have two separate processes and this error occurs for both of them at the same time.</p>\n"}, {"tags": ["mongodb", "go", "gridfs", "mgo"], "comments": [{"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1501504251, "post_id": 45415962, "comment_id": 77792667, "body": "Since you&#39;re not unlocking a mutex in any of the posted code, can you post the code the error you get refers to? It should include the file &amp; line where the error is being triggered."}, {"owner": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501504409, "post_id": 45415962, "comment_id": 77792782, "body": "I am getting the error when trying to write on file , after 3rd request"}, {"owner": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "reply_to_user": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 0, "creation_date": 1501505578, "post_id": 45415962, "comment_id": 77793609, "body": "how can I unlock the mutex ?"}, {"owner": {"reputation": 32095, "user_id": 7426, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5a562698800b535e47b68590f63c402a?s=128&d=identicon&r=PG", "display_name": "Adrian", "link": "https://stackoverflow.com/users/7426/adrian"}, "edited": false, "score": 1, "creation_date": 1501507784, "post_id": 45415962, "comment_id": 77795291, "body": "OK, but writing a file won&#39;t cause that error; unlocking an unlocked mutex will. The error is being triggered by a call to <code>Mutex.Unlock</code>, which isn&#39;t present in your code. Can you show the line and file the error points to?"}], "answers": [{"comments": [{"owner": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "edited": false, "score": 0, "creation_date": 1501513582, "post_id": 45418648, "comment_id": 77799633, "body": "can you send me a code please.? what I need to do instead of copy?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "edited": false, "score": 0, "creation_date": 1501513638, "post_id": 45418648, "comment_id": 77799697, "body": "@YuriGasparyan: don&#39;t do anything, just return the same pointer."}, {"owner": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "edited": false, "score": 0, "creation_date": 1501514372, "post_id": 45418648, "comment_id": 77800234, "body": "do you mean like this ? <code>if(!file_created) { \t\tFile,err:= db.GridFS(&quot;fs&quot;).Create(&quot;112233&quot;) \t\tif err != nil { \t\t\tpanic(err) \t\t} \t\tfile_created = true \t\treturn File \t} \treturn File</code>"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "edited": false, "score": 0, "creation_date": 1501514626, "post_id": 45418648, "comment_id": 77800402, "body": "@YuriGasparyan: it&#39;s hard to read code pasted in a comment, but I think that looks right. You need to get rid of the unnecessary copy, which is the line: <code>File = *_File</code>."}, {"owner": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "edited": false, "score": 0, "creation_date": 1501514884, "post_id": 45418648, "comment_id": 77800582, "body": "Ok. But than I am getting error. After 1st request the File is null , and I am getting the following error  &gt;runtime error: invalid memory address or nil pointer dereference"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "edited": false, "score": 0, "creation_date": 1501515282, "post_id": 45418648, "comment_id": 77800890, "body": "@YuriGasparyan: You&#39;re using a nil pointer somewhere, I assume because of your <code>file_created</code> flag. If you&#39;re going to return a nil pointer after the file is created, you need to check if that pointer is nil before you try to use it. (You also can&#39;t read and write a global value without synchronization from an http handler, because it can be accessed concurrently, so you should probably just fix the logic here to begin with)"}], "tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 2, "last_activity_date": 1501511361, "creation_date": 1501511361, "answer_id": 45418648, "question_id": 45415962, "link": "https://stackoverflow.com/questions/45415962/sending-chunked-files-to-save-in-mongodb/45418648#45418648", "title": "Sending chunked files to save in mongodb", "body": "<p>You are making a copy of the <a href=\"http://godoc.org/gopkg.in/mgo.v2#GridFile\" rel=\"nofollow noreferrer\"><code>GridFile</code></a> returned by <a href=\"http://godoc.org/gopkg.in/mgo.v2#GridFS.Create\" rel=\"nofollow noreferrer\"><code>GridFS.Create</code></a> for no reason. Don't copy the struct, just return the pointer you are given.</p>\n\n<p><code>GridFile</code> contains private fields which cannot be copied, like a <code>sync.Mutex</code> and a <code>sync.Cond</code>. Running <code>go vet</code> on your code should catch these errors for you. </p>\n"}], "owner": {"reputation": 77, "user_id": 8375461, "user_type": "registered", "accept_rate": 43, "profile_image": "https://www.gravatar.com/avatar/e1107778f0c7e4e33c27b8d8ffe358b0?s=128&d=identicon&r=PG&f=1", "display_name": "Khazar Amjer", "link": "https://stackoverflow.com/users/8375461/khazar-amjer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 205, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1501511361, "creation_date": 1501504094, "last_edit_date": 1501509486, "question_id": 45415962, "link": "https://stackoverflow.com/questions/45415962/sending-chunked-files-to-save-in-mongodb", "title": "Sending chunked files to save in mongodb", "body": "<p>I have 2 different servers for example (Server 1 , Server 2), In the first server I have golang app which splits files and sending to  second server which should save in <code>mongodb</code> via <code>mgo.v2</code></p>\n\n<p><strong><em>Server 1:</em></strong> </p>\n\n<pre><code>func mainHandle(rw http.ResponseWriter, rq *http.Request) {\n\n    fileToBeChunked := \"/Users/IT/Desktop/4k.jpg\"\n\n    file, err := os.Open(fileToBeChunked)\n\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    defer file.Close()\n\n    fileInfo, _ := file.Stat()\n\n    var fileSize int64 = fileInfo.Size()\n\n    const fileChunk = 0.25 * (1 &lt;&lt; 20) // 1 MB, change this to your requirement\n\n    // calculate total number of parts the file will be chunked into\n\n    totalPartsNum := uint64(math.Ceil(float64(fileSize) / float64(fileChunk)))\n\n    fmt.Printf(\"Splitting to %d pieces.\\n\", totalPartsNum)\n\n    var sent int\n    prev_part := 0\n\n    for i := uint64(0); i &lt; totalPartsNum; i++ {\n\n        partSize := int(math.Min(fileChunk, float64(fileSize-int64(i*fileChunk))))\n\n        sent = sent + partSize\n        partBuffer := make([]byte, partSize)\n        //fileBuffer := make([]byte, fileSize)\n\n        //fmt.Printf(\"File size is %d \\n\",fileBuffer)\n        fmt.Printf(\"Part size is %d \\n\",partSize)\n\n        file.Read(partBuffer)\n\n\n        client := &amp;http.Client{}\n        req, _ := http.NewRequest(\"PUT\", \"http://localhost:8011/upload/23\", bytes.NewReader(partBuffer))\n        req.Header.Set(\"Content-Range\", \"bytes \"+strconv.Itoa(prev_part) + \"-\"+strconv.Itoa(sent-1)+\"/\"+strconv.FormatInt(fileSize,10))\n        req.Header.Set(\"Content-Length\", strconv.Itoa(partSize))\n        res, _ := client.Do(req)\n        prev_part = sent\n        fmt.Println(res)\n\n    }\n\n\n}\n</code></pre>\n\n<p><strong><em>Server 2</em></strong></p>\n\n<pre><code>func UploadFileChunk(rw http.ResponseWriter,rq *http.Request) {\n\n    fmt.Println(rq.Header[\"Content-Range\"])\n    cnt_range:=rq.Header[\"Content-Range\"]\n    file:=createFileByName(\"asd\")\n    if(checkFileChunkIndex(cnt_range[0])) {\n        buf, err := ioutil.ReadAll(rq.Body)\n        if err!=nil {log.Fatal(\"request\",err)}\n\n        file.Write(buf)\n    } else {\n        file.Close()\n    }\n}\n\n\n\nfunc checkFileChunkIndex(cnt_r string ) bool {\n\n    re := regexp.MustCompile(`([a-z]+) ([[:alnum:]]+)-([[:alnum:]]+)/([[:alnum:]]+)`)\n\n    component:= re.FindStringSubmatch(cnt_r)\n\n    filesize,_:= strconv.Atoi(component[4])\n    last_chunk,_:= strconv.Atoi(component[3])\n    return filesize - last_chunk - 1 &gt; 0\n}\n\n\nfunc createFileByName(fname string ) *mgo.GridFile {\n    if(!file_created) {\n        _File,err:= db.GridFS(\"fs\").Create(\"112233\")\n        File = *_File\n        if err != nil {\n            panic(err)\n        }\n        file_created = true\n        return &amp;File\n    }\n    return &amp;File\n}\n</code></pre>\n\n<p>For testing I have send a file with size 4mb, but after 3rd request , as a response I have got the following error</p>\n\n<blockquote>\n  <p>fatal error: sync: unlock of unlocked mutex</p>\n</blockquote>\n\n<p>Here is the full error response </p>\n\n<pre><code>fatal error: sync: unlock of unlocked mutex\n\ngoroutine 7 [running]:\nruntime.throw(0x144de3d, 0x1e)\n    /usr/local/go/src/runtime/panic.go:596 +0x95 fp=0xc42004b8c0 sp=0xc42004b8a0\nsync.throw(0x144de3d, 0x1e)\n    /usr/local/go/src/runtime/panic.go:585 +0x35 fp=0xc42004b8e0 sp=0xc42004b8c0\nsync.(*Mutex).Unlock(0xc4200ca8c0)\n    /usr/local/go/src/sync/mutex.go:113 +0xa4 fp=0xc42004b908 sp=0xc42004b8e0\nsync.(*Cond).Wait(0x162c4e8)\n    /usr/local/go/src/sync/cond.go:56 +0x6c fp=0xc42004b938 sp=0xc42004b908\ngopkg.in/mgo%2ev2.(*GridFile).insertChunk(0x162c4e0, 0xc42018a000, 0x3fc00, 0x40000)\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:623 +0x1b3 fp=0xc42004ba48 sp=0xc42004b938\ngopkg.in/mgo%2ev2.(*GridFile).Write(0x162c4e0, 0xc420678000, 0x40000, 0x7fe00, 0x40000, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:595 +0x2d6 fp=0xc42004baf0 sp=0xc42004ba48\ngo_storage/files.UploadFileChunk(0x15faf80, 0xc4202e4380, 0xc42000b000)\n    /Users/IT/go/src/go_storage/files/files.go:249 +0x23b fp=0xc42004bba8 sp=0xc42004baf0\nnet/http.HandlerFunc.ServeHTTP(0x1459710, 0x15faf80, 0xc4202e4380, 0xc42000b000)\n    /usr/local/go/src/net/http/server.go:1942 +0x44 fp=0xc42004bbd0 sp=0xc42004bba8\ngithub.com/gorilla/mux.(*Router).ServeHTTP(0xc42001a320, 0x15faf80, 0xc4202e4380, 0xc42000b000)\n    /Users/IT/go/src/github.com/gorilla/mux/mux.go:114 +0x10c fp=0xc42004bcd0 sp=0xc42004bbd0\nnet/http.(*ServeMux).ServeHTTP(0x162bee0, 0x15faf80, 0xc4202e4380, 0xc42000ae00)\n    /usr/local/go/src/net/http/server.go:2238 +0x130 fp=0xc42004bd10 sp=0xc42004bcd0\nnet/http.serverHandler.ServeHTTP(0xc420096dc0, 0x15faf80, 0xc4202e4380, 0xc42000ae00)\n    /usr/local/go/src/net/http/server.go:2568 +0x92 fp=0xc42004bd58 sp=0xc42004bd10\nnet/http.(*conn).serve(0xc4200cd2c0, 0x15fb7c0, 0xc420016ac0)\n    /usr/local/go/src/net/http/server.go:1825 +0x612 fp=0xc42004bfc8 sp=0xc42004bd58\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:2197 +0x1 fp=0xc42004bfd0 sp=0xc42004bfc8\ncreated by net/http.(*Server).Serve\n    /usr/local/go/src/net/http/server.go:2668 +0x2ce\n\ngoroutine 1 [IO wait]:\nnet.runtime_pollWait(0x23a0e40, 0x72, 0x0)\n    /usr/local/go/src/runtime/netpoll.go:164 +0x59\nnet.(*pollDesc).wait(0xc4200556b8, 0x72, 0x0, 0xc4200bcee0)\n    /usr/local/go/src/net/fd_poll_runtime.go:75 +0x38\nnet.(*pollDesc).waitRead(0xc4200556b8, 0xffffffffffffffff, 0x0)\n    /usr/local/go/src/net/fd_poll_runtime.go:80 +0x34\nnet.(*netFD).accept(0xc420055650, 0x0, 0x15f6ec0, 0xc4200bcee0)\n    /usr/local/go/src/net/fd_unix.go:430 +0x1e5\nnet.(*TCPListener).accept(0xc42000e0a0, 0xc4200cd340, 0x13c96c0, 0xffffffffffffffff)\n    /usr/local/go/src/net/tcpsock_posix.go:136 +0x2e\nnet.(*TCPListener).AcceptTCP(0xc42000e0a0, 0xc420049df0, 0xc420049df8, 0xc420049de8)\n    /usr/local/go/src/net/tcpsock.go:215 +0x49\nnet/http.tcpKeepAliveListener.Accept(0xc42000e0a0, 0x1459ca8, 0xc4200cd2c0, 0x15fb880, 0xc420019c80)\n    /usr/local/go/src/net/http/server.go:3044 +0x2f\nnet/http.(*Server).Serve(0xc420096dc0, 0x15fb280, 0xc42000e0a0, 0x0, 0x0)\n    /usr/local/go/src/net/http/server.go:2643 +0x228\nnet/http.(*Server).ListenAndServe(0xc420096dc0, 0xc420096dc0, 0x15f60c0)\n    /usr/local/go/src/net/http/server.go:2585 +0xb0\nnet/http.ListenAndServe(0x143fbf7, 0x5, 0x0, 0x0, 0xc420110360, 0xc420019230)\n    /usr/local/go/src/net/http/server.go:2787 +0x7f\nmain.main()\n    /Users/IT/go/src/go_storage/main.go:24 +0x358\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:2197 +0x1\n\ngoroutine 5 [select]:\ngopkg.in/mgo%2ev2.(*mongoCluster).syncServersLoop(0xc42000a800)\n    /Users/IT/go/src/gopkg.in/mgo.v2/cluster.go:394 +0x3a3\ncreated by gopkg.in/mgo%2ev2.newCluster\n    /Users/IT/go/src/gopkg.in/mgo.v2/cluster.go:78 +0x188\n\ngoroutine 22 [semacquire]:\nsync.runtime_SemacquireMutex(0xc4200f20e4)\n    /usr/local/go/src/runtime/sema.go:62 +0x34\nsync.(*Mutex).Lock(0xc4200f20e0)\n    /usr/local/go/src/sync/mutex.go:87 +0x9d\ngopkg.in/mgo%2ev2.(*mongoSocket).Acquire(0xc4200f20e0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/socket.go:242 +0x31\ngopkg.in/mgo%2ev2.(*Session).acquireSocket(0xc4200e04e0, 0x0, 0x0, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4419 +0x475\ngopkg.in/mgo%2ev2.(*Collection).writeOp(0xc420019f20, 0x139efa0, 0xc4200e8000, 0x100e501, 0x0, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4603 +0xd6\ngopkg.in/mgo%2ev2.(*Collection).Insert(0xc420019f20, 0xc420010070, 0x1, 0x1, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:2437 +0xac\ngopkg.in/mgo%2ev2.(*GridFile).insertChunk.func1(0x162c4e0, 0xc42033c000, 0x3fc3e, 0x40000)\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:642 +0xe8\ncreated by gopkg.in/mgo%2ev2.(*GridFile).insertChunk\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:650 +0x460\n\ngoroutine 19 [sleep]:\ntime.Sleep(0x37e11d600)\n    /usr/local/go/src/runtime/time.go:59 +0xf9\ngopkg.in/mgo%2ev2.(*mongoServer).pinger(0xc4200f2000, 0x1)\n    /Users/IT/go/src/gopkg.in/mgo.v2/server.go:301 +0x293\ncreated by gopkg.in/mgo%2ev2.newServer\n    /Users/IT/go/src/gopkg.in/mgo.v2/server.go:89 +0x166\n\ngoroutine 21 [semacquire]:\nsync.runtime_SemacquireMutex(0xc4200f20e4)\n    /usr/local/go/src/runtime/sema.go:62 +0x34\nsync.(*Mutex).Lock(0xc4200f20e0)\n    /usr/local/go/src/sync/mutex.go:87 +0x9d\ngopkg.in/mgo%2ev2.(*mongoSocket).readLoop(0xc4200f20e0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/socket.go:582 +0x40a\ncreated by gopkg.in/mgo%2ev2.newSocket\n    /Users/IT/go/src/gopkg.in/mgo.v2/socket.go:194 +0x259\n\ngoroutine 9 [semacquire]:\nsync.runtime_SemacquireMutex(0xc4202d2044)\n    /usr/local/go/src/runtime/sema.go:62 +0x34\nsync.(*Mutex).Lock(0xc4202d2040)\n    /usr/local/go/src/sync/mutex.go:87 +0x9d\ngopkg.in/mgo%2ev2.(*mongoSocket).SimpleQuery(0xc4200f20e0, 0xc4202e4000, 0x6, 0x143fbe3, 0x5, 0xc4202d2031, 0xb)\n    /Users/IT/go/src/gopkg.in/mgo.v2/socket.go:367 +0x28b\ngopkg.in/mgo%2ev2.(*Database).run(0xc4200bc8e0, 0xc4200f20e0, 0x13d0f00, 0xc4202d4040, 0x13cbb00, 0xc4202e2000, 0xc4200f2000, 0xc4200f20e0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:3261 +0x1b3\ngopkg.in/mgo%2ev2.(*Collection).writeOpCommand(0xc420019f20, 0xc4200f20e0, 0xc4200e2000, 0x139efa0, 0xc4202d6000, 0x1010001, 0x23685a8, 0x0, 0x100c420028638)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4786 +0x1db\ngopkg.in/mgo%2ev2.(*Collection).writeOp(0xc420019f20, 0x139efa0, 0xc4202d6000, 0x100e501, 0x0, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4645 +0x6dc\ngopkg.in/mgo%2ev2.(*Collection).Insert(0xc420019f20, 0xc4202d2000, 0x1, 0x1, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:2437 +0xac\ngopkg.in/mgo%2ev2.(*GridFile).insertChunk.func1(0x162c4e0, 0xc420290000, 0x3fc3e, 0x40000)\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:642 +0xe8\ncreated by gopkg.in/mgo%2ev2.(*GridFile).insertChunk\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:650 +0x460\n\ngoroutine 12 [semacquire]:\nsync.runtime_SemacquireMutex(0xc4200e6074)\n    /usr/local/go/src/runtime/sema.go:62 +0x34\nsync.(*Mutex).Lock(0xc4200e6070)\n    /usr/local/go/src/sync/mutex.go:87 +0x9d\ngopkg.in/mgo%2ev2.(*mongoSocket).SimpleQuery(0xc4200f20e0, 0xc4202e40e0, 0x6, 0x143fbe3, 0x5, 0xc4200e6060, 0xb)\n    /Users/IT/go/src/gopkg.in/mgo.v2/socket.go:367 +0x28b\ngopkg.in/mgo%2ev2.(*Database).run(0xc4200bc8e0, 0xc4200f20e0, 0x13d0f00, 0xc4200ee080, 0x13cbb00, 0xc4202e2060, 0x2, 0xc42005e400)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:3261 +0x1b3\ngopkg.in/mgo%2ev2.(*Collection).writeOpCommand(0xc420019f20, 0xc4200f20e0, 0xc4200e2000, 0x139efa0, 0xc420018d20, 0x1010001, 0x2304558, 0x46, 0x8700c420023638)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4786 +0x1db\ngopkg.in/mgo%2ev2.(*Collection).writeOp(0xc420019f20, 0x139efa0, 0xc420018d20, 0x100e501, 0x0, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4645 +0x6dc\ngopkg.in/mgo%2ev2.(*Collection).Insert(0xc420019f20, 0xc420010060, 0x1, 0x1, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:2437 +0xac\ngopkg.in/mgo%2ev2.(*GridFile).insertChunk.func1(0x162c4e0, 0xc42013a000, 0x3fc3e, 0x40000)\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:642 +0xe8\ncreated by gopkg.in/mgo%2ev2.(*GridFile).insertChunk\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:650 +0x460\n\ngoroutine 38 [IO wait]:\nnet.runtime_pollWait(0x23a0f00, 0x77, 0x4)\n    /usr/local/go/src/runtime/netpoll.go:164 +0x59\nnet.(*pollDesc).wait(0xc4200fa068, 0x77, 0x15f84c0, 0x15f4540)\n    /usr/local/go/src/net/fd_poll_runtime.go:75 +0x38\nnet.(*pollDesc).waitWrite(0xc4200fa068, 0xc420392ef2, 0x2edd1)\n    /usr/local/go/src/net/fd_poll_runtime.go:84 +0x34\nnet.(*netFD).Write(0xc4200fa000, 0xc420382000, 0x3fcc3, 0x40000, 0x10ef2, 0x15f84c0, 0x15f4540)\n    /usr/local/go/src/net/fd_unix.go:340 +0x34d\nnet.(*conn).Write(0xc4200ea008, 0xc420382000, 0x3fcc3, 0x40000, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/net.go:193 +0x70\ngopkg.in/mgo%2ev2.(*mongoSocket).Query(0xc4200f20e0, 0xc420181878, 0x1, 0x1, 0x0, 0x2)\n    /Users/IT/go/src/gopkg.in/mgo.v2/socket.go:525 +0x2ad1\ngopkg.in/mgo%2ev2.(*mongoSocket).SimpleQuery(0xc4200f20e0, 0xc4200f21c0, 0x6, 0x143fbe3, 0x5, 0xc420010631, 0xb)\n    /Users/IT/go/src/gopkg.in/mgo.v2/socket.go:363 +0x22a\ngopkg.in/mgo%2ev2.(*Database).run(0xc4200bc8e0, 0xc4200f20e0, 0x13d0f00, 0xc4202d4140, 0x13cbb00, 0xc4200f6000, 0x1444391, 0xc42002a800)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:3261 +0x1b3\ngopkg.in/mgo%2ev2.(*Collection).writeOpCommand(0xc420019f20, 0xc4200f20e0, 0xc4200e2000, 0x139efa0, 0xc4200e8000, 0x1010001, 0x2306a28, 0x0, 0x800c4204a3e38)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4786 +0x1db\ngopkg.in/mgo%2ev2.(*Collection).writeOp(0xc420019f20, 0x139efa0, 0xc4200e8000, 0xc4200e6001, 0x0, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4645 +0x6dc\ngopkg.in/mgo%2ev2.(*Collection).Insert(0xc420019f20, 0xc4200e6000, 0x1, 0x1, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:2437 +0xac\ngopkg.in/mgo%2ev2.(*GridFile).insertChunk.func1(0x162c4e0, 0xc4204d8000, 0x3fc3e, 0x40000)\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:642 +0xe8\ncreated by gopkg.in/mgo%2ev2.(*GridFile).insertChunk\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:650 +0x460\n\ngoroutine 24 [semacquire]:\nsync.runtime_SemacquireMutex(0xc4200f20e4)\n    /usr/local/go/src/runtime/sema.go:62 +0x34\nsync.(*Mutex).Lock(0xc4200f20e0)\n    /usr/local/go/src/sync/mutex.go:87 +0x9d\ngopkg.in/mgo%2ev2.(*mongoSocket).Acquire(0xc4200f20e0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/socket.go:242 +0x31\ngopkg.in/mgo%2ev2.(*Session).acquireSocket(0xc4200e04e0, 0x0, 0x0, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4419 +0x475\ngopkg.in/mgo%2ev2.(*Collection).writeOp(0xc420019f20, 0x139efa0, 0xc4202d6000, 0x100e501, 0x0, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:4603 +0xd6\ngopkg.in/mgo%2ev2.(*Collection).Insert(0xc420019f20, 0xc4202d2010, 0x1, 0x1, 0x0, 0x0)\n    /Users/IT/go/src/gopkg.in/mgo.v2/session.go:2437 +0xac\ngopkg.in/mgo%2ev2.(*GridFile).insertChunk.func1(0x162c4e0, 0xc4205f8000, 0x3fc3e, 0x40000)\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:642 +0xe8\ncreated by gopkg.in/mgo%2ev2.(*GridFile).insertChunk\n    /Users/IT/go/src/gopkg.in/mgo.v2/gridfs.go:650 +0x460\n\ngoroutine 14 [IO wait]:\nnet.runtime_pollWait(0x23a0d80, 0x72, 0x7)\n    /usr/local/go/src/runtime/netpoll.go:164 +0x59\nnet.(*pollDesc).wait(0xc420055728, 0x72, 0x15f84c0, 0x15f4540)\n    /usr/local/go/src/net/fd_poll_runtime.go:75 +0x38\nnet.(*pollDesc).waitRead(0xc420055728, 0xc420016b11, 0x1)\n    /usr/local/go/src/net/fd_poll_runtime.go:80 +0x34\nnet.(*netFD).Read(0xc4200556c0, 0xc420016b11, 0x1, 0x1, 0x0, 0x15f84c0, 0x15f4540)\n    /usr/local/go/src/net/fd_unix.go:250 +0x1b7\nnet.(*conn).Read(0xc42000e0a8, 0xc420016b11, 0x1, 0x1, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/net.go:181 +0x70\nnet/http.(*connReader).backgroundRead(0xc420016b00)\n    /usr/local/go/src/net/http/server.go:656 +0x58\ncreated by net/http.(*connReader).startBackgroundRead\n    /usr/local/go/src/net/http/server.go:652 +0xdf\n\nProcess finished with exit code 2\n</code></pre>\n\n<p>I have found that in the write  function there is a code look like this</p>\n\n<pre><code>file.assertMode(gfsWriting)\n    file.m.Lock()\n    debugf(\"GridFile %p: writing %d bytes\", file, len(data))\n    defer file.m.Unlock()\n\n    if file.err != nil {\n        return 0, file.err\n    }\n</code></pre>\n"}, {"tags": ["string", "go", "encoding", "base64"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1501493869, "post_id": 45412089, "comment_id": 77784945, "body": "A loop and slicing operations <code>[0:76]</code>"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1501497539, "last_edit_date": 1501497539, "creation_date": 1501494055, "answer_id": 45412336, "question_id": 45412089, "link": "https://stackoverflow.com/questions/45412089/split-a-base64-line-into-chunks/45412336#45412336", "title": "Split a base64 line into chunks", "body": "<p>There is no support for this in the standard lib. You have to make one yourself.</p>\n\n<p>A simple implementation can be like this:</p>\n\n<pre><code>func split(s string, size int) []string {\n    ss := make([]string, 0, len(s)/size+1)\n    for len(s) &gt; 0 {\n        if len(s) &lt; size {\n            size = len(s)\n        }\n        ss, s = append(ss, s[:size]), s[size:]\n\n    }\n    return ss\n}\n</code></pre>\n\n<p>This loops until the string is consumed, and in each iteration cuts of <code>size</code> chars (bytes) from the beginning.</p>\n\n<p>Note that this works on base64 texts as that only uses characters which map 1-to-1 to bytes in the UTF-8 encoded form (which is how Go stores strings in memory). If you would want to use this on arbitrary strings, slicing could break valid UTF-8 sequences, and also chunks would not necessarily be <code>size</code> characters.</p>\n\n<p>Testing it:</p>\n\n<pre><code>s := strings.Repeat(\"1\", 2*76+3)\nfor _, chunk := range split(s, 76) {\n    fmt.Println(chunk)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/lsGRJn3B92\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>1111111111111111111111111111111111111111111111111111111111111111111111111111\n1111111111111111111111111111111111111111111111111111111111111111111111111111\n111\n</code></pre>\n"}], "owner": {"reputation": 119, "user_id": 8226831, "user_type": "registered", "profile_image": "https://graph.facebook.com/1072421991/picture?type=large", "display_name": "Zhivko Angelov", "link": "https://stackoverflow.com/users/8226831/zhivko-angelov"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2072, "favorite_count": 0, "accepted_answer_id": 45412336, "answer_count": 1, "score": 1, "last_activity_date": 1501505872, "creation_date": 1501493304, "last_edit_date": 1501505872, "question_id": 45412089, "link": "https://stackoverflow.com/questions/45412089/split-a-base64-line-into-chunks", "title": "Split a base64 line into chunks", "body": "<p>What is the best way to split a one line base64 into multiple lines by 76 chars. Currently I use <code>encoding/base64</code> package as this:</p>\n\n<pre><code>encoded := base64.StdEncoding.EncodeToString(data)\n</code></pre>\n\n<p>Thank you in advance!</p>\n"}, {"tags": ["go", "glide-golang"], "comments": [{"owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "edited": false, "score": 0, "creation_date": 1501489857, "post_id": 45410422, "comment_id": 77782061, "body": "Can you show the line where you do import of your <code>long</code> package? Is it looks like <code>import &quot;go_test&#47;long&quot;</code>?"}, {"owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "reply_to_user": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "edited": false, "score": 0, "creation_date": 1501490840, "post_id": 45410422, "comment_id": 77782722, "body": "in the main.go file."}, {"owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "reply_to_user": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "edited": false, "score": 0, "creation_date": 1501491213, "post_id": 45410422, "comment_id": 77782979, "body": "as above you see ,  in the main.go file ,  if put in vendor , it can run . but the glide will say can not detect vcs about long package."}, {"owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "edited": false, "score": 0, "creation_date": 1501492172, "post_id": 45410422, "comment_id": 77783666, "body": "So you should use <code>&quot;go_test&#47;long&quot;</code> instead on just <code>&quot;long&quot;</code>"}, {"owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "edited": false, "score": 0, "creation_date": 1501492590, "post_id": 45410422, "comment_id": 77783969, "body": "And it must not be in your vendor directory"}, {"owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "reply_to_user": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "edited": false, "score": 0, "creation_date": 1501493225, "post_id": 45410422, "comment_id": 77784476, "body": "ye,  when I add &quot;go_test/long&quot; and it can find the path of long package. even  when I execute  <b>glide up</b> .  very thanks. and please  write as a answer that  I can  select as correct answer.  thanks again"}, {"owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "edited": false, "score": 0, "creation_date": 1501494769, "post_id": 45410422, "comment_id": 77785636, "body": "You are welcome @Long!"}], "answers": [{"comments": [{"owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "edited": false, "score": 0, "creation_date": 1501496805, "post_id": 45412604, "comment_id": 77787071, "body": "very complete instruction!"}], "tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": true, "score": 0, "last_activity_date": 1501494739, "creation_date": 1501494739, "answer_id": 45412604, "question_id": 45410422, "link": "https://stackoverflow.com/questions/45410422/how-to-use-custom-package-with-glide/45412604#45412604", "title": "How to use custom package with glide", "body": "<p>Because the correct package name is a full path starting from <code>/src</code> directory in you project you should use <code>\"go_test/long\"</code> instead on just <code>\"long\"</code> in you <code>import</code> statement. And because it is your own code and not a vendor dependency it must not be under <code>vendor</code> directory.</p>\n"}], "owner": {"reputation": 49, "user_id": 6612455, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dpYHO.png?s=128&g=1", "display_name": "Long", "link": "https://stackoverflow.com/users/6612455/long"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 630, "favorite_count": 0, "accepted_answer_id": 45412604, "answer_count": 1, "score": 0, "last_activity_date": 1553445620, "creation_date": 1501488367, "last_edit_date": 1553445620, "question_id": 45410422, "link": "https://stackoverflow.com/questions/45410422/how-to-use-custom-package-with-glide", "title": "How to use custom package with glide", "body": "<p>I use golang Masterminds/glide to manage package. here is my project:  </p>\n\n<pre><code>$GOPATH/    \n      bin/  \n      pkg/\n      src/\n         go_test/\n            long(own custom package: just print a \"hello\")  \n            main.go  \n            glide.yaml  \n            vendor/  \n                github.com/lib/pq   \n</code></pre>\n\n<p>the long package is used in main.go like :  </p>\n\n<pre><code> package main \n   import(\n    \"database/sql\"\n    \"github.com/lib/pq\"\n    \"long\"\n  )\n  func main(\n    ...\n  }\n</code></pre>\n\n<p>the glide.yaml is:  </p>\n\n<pre><code>package:  go_test\nimport:   \n- package: github.com/lib/pq \n</code></pre>\n\n<p>&emsp; when go run main.go  the error is: can not found package long .\nif I put the long package into the vendor/ and then <strong>glide up</strong><br>\n&emsp;it will show can not detect vcs about the \"long\" dependencies. but can run with project.<br>\n&emsp;so  I want to know how to set that glide will skip the long package detect and the project can run .   </p>\n\n<p>note: I use the ignore: in the yaml. if add long to ignore .the project will can run because can't find long package.   </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 213390, "user_id": 642706, "user_type": "registered", "accept_rate": 58, "profile_image": "https://i.stack.imgur.com/ZWEI3.jpg?s=128&g=1", "display_name": "Basil Bourque", "link": "https://stackoverflow.com/users/642706/basil-bourque"}, "edited": false, "score": 0, "creation_date": 1501518118, "post_id": 45410178, "comment_id": 77802723, "body": "By the way, the troublesome <code>Calendar</code> class is now legacy, supplanted by the java.time classes such as <code>ZonedDateTime</code>."}], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 7560407, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8f634ea6fd3f2d6f1073ea99d808855?s=128&d=identicon&r=PG&f=1", "display_name": "boubker elamri", "link": "https://stackoverflow.com/users/7560407/boubker-elamri"}, "edited": false, "score": 0, "creation_date": 1501488994, "post_id": 45410401, "comment_id": 77781496, "body": "but i want the code in golang not java"}, {"owner": {"reputation": 913, "user_id": 6683533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AyhMt.jpg?s=128&g=1", "display_name": "Indrit Kello", "link": "https://stackoverflow.com/users/6683533/indrit-kello"}, "reply_to_user": {"reputation": 23, "user_id": 7560407, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8f634ea6fd3f2d6f1073ea99d808855?s=128&d=identicon&r=PG&f=1", "display_name": "boubker elamri", "link": "https://stackoverflow.com/users/7560407/boubker-elamri"}, "edited": false, "score": 0, "creation_date": 1501489120, "post_id": 45410401, "comment_id": 77781581, "body": "You can use the Time.String() method to convert a time.Time to a string. t := time.Now() fmt.Println(t.String())"}, {"owner": {"reputation": 23, "user_id": 7560407, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8f634ea6fd3f2d6f1073ea99d808855?s=128&d=identicon&r=PG&f=1", "display_name": "boubker elamri", "link": "https://stackoverflow.com/users/7560407/boubker-elamri"}, "edited": false, "score": 0, "creation_date": 1501489191, "post_id": 45410401, "comment_id": 77781628, "body": "and it will show as a simpleDate???"}, {"owner": {"reputation": 913, "user_id": 6683533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AyhMt.jpg?s=128&g=1", "display_name": "Indrit Kello", "link": "https://stackoverflow.com/users/6683533/indrit-kello"}, "reply_to_user": {"reputation": 23, "user_id": 7560407, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8f634ea6fd3f2d6f1073ea99d808855?s=128&d=identicon&r=PG&f=1", "display_name": "boubker elamri", "link": "https://stackoverflow.com/users/7560407/boubker-elamri"}, "edited": false, "score": 1, "creation_date": 1501489316, "post_id": 45410401, "comment_id": 77781704, "body": "fmt.Println(t.Format(&quot;2006-01-02 15:04:05&quot;))"}], "tags": [], "owner": {"reputation": 913, "user_id": 6683533, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AyhMt.jpg?s=128&g=1", "display_name": "Indrit Kello", "link": "https://stackoverflow.com/users/6683533/indrit-kello"}, "is_accepted": true, "score": 0, "last_activity_date": 1501488276, "creation_date": 1501488276, "answer_id": 45410401, "question_id": 45410178, "link": "https://stackoverflow.com/questions/45410178/gregorian-calendars-package-on-golang/45410401#45410401", "title": "gregorian calendars package on golang", "body": "<p>You can make it as a string variable and than parse it.</p>\n\n<pre><code>string strDate = \"07 31 2017\"; //example\nDateFormat df = new SimpleDateFormat(\"dd MM yyyy\");\nDate date = df.parse(strDate);\nCalendar cal =  new GregorianCalendar();\ncal.setTime(date);\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 4231, "user_id": 1343321, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/20d625be6a7f95fd700dd975e4167848?s=128&d=identicon&r=PG", "display_name": "Depado", "link": "https://stackoverflow.com/users/1343321/depado"}, "is_accepted": false, "score": 0, "last_activity_date": 1501489437, "creation_date": 1501489437, "answer_id": 45410738, "question_id": 45410178, "link": "https://stackoverflow.com/questions/45410178/gregorian-calendars-package-on-golang/45410738#45410738", "title": "gregorian calendars package on golang", "body": "<p>The time package always assumes you're working with a Gregorian calendar, <a href=\"https://golang.org/pkg/time/\" rel=\"nofollow noreferrer\" title=\"See here\">as shown in the documentation</a></p>\n\n<p>Now if you want to parse a date time in golang it's rather simple but you have to keep in mind that the date parser isn't using the \"standard\" way of defining date formats.</p>\n\n<p>You can see an example of how to use the time parser in <a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow noreferrer\">the official documentation</a></p>\n\n<pre><code>const longForm = \"Jan 2, 2006 at 3:04pm (MST)\"\nt, _ := time.Parse(longForm, \"Feb 3, 2013 at 7:54pm (PST)\")\nfmt.Println(t)\n</code></pre>\n\n<p>That's how you parse a string into a date in go. Converting a date to a string is even simpler :</p>\n\n<pre><code>t.Format(\"2006-01-02\")\n</code></pre>\n\n<p>See the <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"nofollow noreferrer\">documentation</a> for more information</p>\n"}], "owner": {"reputation": 23, "user_id": 7560407, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e8f634ea6fd3f2d6f1073ea99d808855?s=128&d=identicon&r=PG&f=1", "display_name": "boubker elamri", "link": "https://stackoverflow.com/users/7560407/boubker-elamri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 861, "favorite_count": 0, "closed_date": 1501501095, "accepted_answer_id": 45410401, "answer_count": 2, "score": 0, "last_activity_date": 1501489437, "creation_date": 1501487463, "question_id": 45410178, "link": "https://stackoverflow.com/questions/45410178/gregorian-calendars-package-on-golang", "closed_reason": "Needs details or clarity", "title": "gregorian calendars package on golang", "body": "<p>I m wrking on a project, and I want to make a date variable with the gregorian calendar in goLang, I've searched about it, but i didn't found an answer\nhere is what i want to do with in golang in a java type code</p>\n\n<pre><code>try {\n                final Calendar gc = new GregorianCalendar();\n                gc.setTime(simpleDateFormat.parse(callEndDateTime));\n                gc.add(Calendar.SECOND, -1 * duration);\n                callStartDateTime = simpleDateFormat.format(gc.getTime());\n            } catch (final ParseException parseException) {\n                LOGGER.error(\"Couldn't parse the given date: \" + callEndDateTime, parseException);\n                callStartDateTime = null;\n            }\n</code></pre>\n\n<p>thanks for helping me!</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1501487637, "post_id": 45410176, "comment_id": 77780606, "body": "what is the current behaviour of the code snippet that is shared ?"}, {"owner": {"reputation": 67, "user_id": 8137568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466e59ea45260f8fce4cdb5bc6c49d6f?s=128&d=identicon&r=PG&f=1", "display_name": "tery", "link": "https://stackoverflow.com/users/8137568/tery"}, "reply_to_user": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1501488377, "post_id": 45410176, "comment_id": 77781106, "body": "i&#39;m getting this: multiple registrations for /"}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1501488732, "post_id": 45410176, "comment_id": 77781332, "body": "for <code>&#47;</code> :  Looks like your route is   not correct . Try printing/logging the formdata and see what is coming."}, {"owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "edited": false, "score": 0, "creation_date": 1501491023, "post_id": 45410176, "comment_id": 77782849, "body": "i have added answer assuming your problem is only with the  <code>Execute</code> function . Please update the question  clarifying your isuue"}], "answers": [{"tags": [], "owner": {"reputation": 5524, "user_id": 1898494, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/lvyaa.jpg?s=128&g=1", "display_name": "Sarath Sadasivan Pillai", "link": "https://stackoverflow.com/users/1898494/sarath-sadasivan-pillai"}, "is_accepted": true, "score": 1, "last_activity_date": 1501490748, "creation_date": 1501490748, "answer_id": 45411203, "question_id": 45410176, "link": "https://stackoverflow.com/questions/45410176/golang-cant-execute-t-execute/45411203#45411203", "title": "golang: can&#39;t execute t.execute", "body": "<p>Here instead of following </p>\n\n<pre><code>err = t.Execute(res, \"/city_update\")\n</code></pre>\n\n<p>pass data to be used to fill your template as send arguement to <code>Execute</code> not string. <a href=\"https://golang.org/pkg/html/template/#Template.Execute\" rel=\"nofollow noreferrer\">link to doc</a></p>\n\n<p>For example .</p>\n\n<pre><code>err = t.Execute(res,struct{ID string}{Person_id})\n</code></pre>\n"}], "owner": {"reputation": 67, "user_id": 8137568, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/466e59ea45260f8fce4cdb5bc6c49d6f?s=128&d=identicon&r=PG&f=1", "display_name": "tery", "link": "https://stackoverflow.com/users/8137568/tery"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 45411203, "answer_count": 1, "score": 0, "last_activity_date": 1501500427, "creation_date": 1501487460, "last_edit_date": 1501500427, "question_id": 45410176, "link": "https://stackoverflow.com/questions/45410176/golang-cant-execute-t-execute", "title": "golang: can&#39;t execute t.execute", "body": "<p>I'm trying to make an Handler to update one row each time getting data from a submitt button,\nhere is my code:  </p>\n\n<pre><code>func RowHandler(res http.ResponseWriter, req *http.Request) {\n    if req.Method != \"POST\" {\n        http.ServeFile(res, req, \"homepage.html\")\n        return\n    }\n    Person_id := req.FormValue(\"Person_id\")\n\n    stmt, err := db.Prepare(\"update Cityes set Status='right' where  Person_id=?\")\n\n    if err != nil {\n\n        log.Print(\"error \", err)\n    }\n    _, err = stmt.Exec(&amp;Person_id)\n\n    t, err := template.ParseFiles(\"city_update.html\") //hier i just want to show a text in html Page\n\n    if err != nil {\n        log.Fatal(err)\n    }\n    err = t.Execute(res, \"/city_update\")\n\n}\n</code></pre>\n"}, {"tags": ["docker", "go", "signals", "sigint"], "answers": [{"comments": [{"owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1501480993, "post_id": 45407483, "comment_id": 77777145, "body": "I wrote the script that builds and runs the program. How do I pass the signal to the child process?"}, {"owner": {"reputation": 610, "user_id": 2998542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jLQeB.jpg?s=128&g=1", "display_name": "Sreeni", "link": "https://stackoverflow.com/users/2998542/sreeni"}, "reply_to_user": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "edited": false, "score": 0, "creation_date": 1501481615, "post_id": 45407483, "comment_id": 77777401, "body": "This is 1 approach I have seen for handling signals in script and passing to another process(<a href=\"https://medium.com/@gchudnov/trapping-signals-in-docker-containers-7a57fdda7d86\" rel=\"nofollow noreferrer\">medium.com/@gchudnov/&hellip;</a>). If you can avoid the script and have only 1 process, thats even better."}], "tags": [], "owner": {"reputation": 610, "user_id": 2998542, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jLQeB.jpg?s=128&g=1", "display_name": "Sreeni", "link": "https://stackoverflow.com/users/2998542/sreeni"}, "is_accepted": true, "score": 0, "last_activity_date": 1501475506, "creation_date": 1501475506, "answer_id": 45407483, "question_id": 45407283, "link": "https://stackoverflow.com/questions/45407283/cant-trap-sigint-in-docker-container/45407483#45407483", "title": "Can&#39;t trap SIGINT in Docker container", "body": "<p>Docker passes signals to PID 1 process. In your case, since you are spawning a child process, you are not getting the signal.\nIf there is only 1 processing in CMD, you can do something like:</p>\n\n<pre><code>CMD [\"/bin/ping\",\"localhost\"]\n</code></pre>\n\n<p>If you are doing multiple operations like what you have put above, you can run a script in CMD and have signal processing in the script and pass it to your background process. The other option is to have only 1 command processing in CMD. You can do \"go install\" in previous step and just run executable in CMD. </p>\n"}], "owner": {"reputation": 4382, "user_id": 2251437, "user_type": "registered", "accept_rate": 94, "profile_image": "https://www.gravatar.com/avatar/9a594b33bf5eb20ec4e69b63f787e5c4?s=128&d=identicon&r=PG", "display_name": "sargas", "link": "https://stackoverflow.com/users/2251437/sargas"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1045, "favorite_count": 0, "accepted_answer_id": 45407483, "answer_count": 1, "score": 0, "last_activity_date": 1501475506, "creation_date": 1501473786, "last_edit_date": 1501475153, "question_id": 45407283, "link": "https://stackoverflow.com/questions/45407283/cant-trap-sigint-in-docker-container", "title": "Can&#39;t trap SIGINT in Docker container", "body": "<p>I have the following image</p>\n\n<pre><code>FROM golang:1.8.3\nWORKDIR /go/src/x/x/program\nRUN mkdir /logs\nVOLUME [\"/go/src/x/x/program\", \"/logs\"]\nCMD [\"sh\", \"-c\", \"go install &amp;&amp; program\"]\n</code></pre>\n\n<p>My Go server listens to SIGINT in the following way</p>\n\n<pre><code>// ... Other stuff\n\nc := make(chan os.Signal, 1)\nsignal.Notify(c, os.Interrupt)\n\ngo func() {\n    &lt;-c\n    signal.Stop(c)\n\n    // Server graceful shutdown\n    err := s.Shutdown(context.Background())\n    if err != nil {\n        fileLogger.Printf(\"could not shutdown server: %v\", err)\n    } else {\n        fileLogger.Print(\"server successfully shutdown\")\n    }\n\n// ... Start server\n</code></pre>\n\n<p>But I'm failing to trap and handle SIGINT. I tried the following:</p>\n\n<ul>\n<li><code>docker kill -s SIGINT &lt;my_container&gt;</code></li>\n<li>(with compose) <code>docker-compose down/kill</code></li>\n<li><code>docker exec -ti &lt;my_container&gt; /bin/bash</code>\n\n<ul>\n<li>(followed by) <code>kill -SIGINT &lt;go program PID&gt;</code></li>\n</ul></li>\n</ul>\n\n<p>Nothing gets logged, so I assume SIGINT wasn't handled by my program at all.</p>\n\n<hr>\n\n<p>When testing, I managed to do it by doing the following (which isn't fit for production)</p>\n\n<ul>\n<li><code>docker run -ti -v &lt;local_path_to_log&gt;:/logs &lt;my_image&gt; /bin/bash</code>\n\n<ul>\n<li><code>go run *.go</code></li>\n<li><code>CTRL + C</code> to interrupt process</li>\n</ul></li>\n</ul>\n\n<p>I see the logs in my file.</p>\n\n<p>I also just figured out that the way my image is set up, it ends up having two processes running:</p>\n\n<pre><code>docker exec -ti &lt;my_container&gt; /bin/bash\nroot@xxx:/go/src/x/x/x# ps aux | grep program\nroot         1  0.0  0.0   4332   716 ?        Ss   03:47   0:00 sh -c go install &amp;&amp; program\nroot        32  0.0  0.3 335132  6624 ?        Sl   03:47   0:00 program\nroot@xxx:/go/src/x/x/x# kill -SIGINT 32\n</code></pre>\n\n<p>So as shown above, killing the second process (and not PID 1) sends SIGINT to the program, which can than trap and handle it.</p>\n\n<hr>\n\n<p>I know I'm close to a solution to sending SIGINT from outside of the container. But I can't grasp it yet.</p>\n\n<p>What is the correct approach here to have a container that can receive a SIGINT to the correct process?</p>\n"}, {"tags": ["go", "jwt", "jwt-go"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1501456841, "post_id": 45405626, "comment_id": 77771667, "body": "<a href=\"https://github.com/dgrijalva/jwt-go/blob/master/example_test.go\" rel=\"nofollow noreferrer\">github.com/dgrijalva/jwt-go/blob/master/example_test.go</a>"}, {"owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1501457202, "post_id": 45405626, "comment_id": 77771732, "body": "@zerkms I already saw it, but in that example I should have the struct with of the data that I will going to receive, in this case MyCustomClaims, but that can easily change from the other side and I don&#39;t want to be reestructuring that anytime that something is added or deleted"}, {"owner": {"reputation": 143292, "user_id": 142162, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/F5xn2.png?s=128&g=1", "display_name": "Tim Cooper", "link": "https://stackoverflow.com/users/142162/tim-cooper"}, "edited": false, "score": 0, "creation_date": 1501457348, "post_id": 45405626, "comment_id": 77771761, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/41077953/go-language-and-verify-jwt\">Go Language and Verify JWT</a>"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1501457364, "post_id": 45405626, "comment_id": 77771766, "body": "Then check all the unit tests. If it&#39;s not there - they don&#39;t support it."}, {"owner": {"reputation": 4763, "user_id": 2285935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d22f61c3ceec6d3add64d5eaa161d52a?s=128&d=identicon&r=PG", "display_name": "John S Perayil", "link": "https://stackoverflow.com/users/2285935/john-s-perayil"}, "edited": false, "score": 0, "creation_date": 1501476440, "post_id": 45405626, "comment_id": 77775580, "body": "@SrednyMCasanova Can you update the question with more information about your specific usecase."}, {"owner": {"reputation": 444, "user_id": 9996080, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/FoRKR.jpg?s=128&g=1", "display_name": "James South", "link": "https://stackoverflow.com/users/9996080/james-south"}, "edited": false, "score": 0, "creation_date": 1611880936, "post_id": 45405626, "comment_id": 116599977, "body": "See <a href=\"https://stackoverflow.com/questions/56905995/how-to-verify-a-jwt-token-from-aws-cognito-in-go#answer-65947083\">my answer</a> to a similar question. <code>github.com&#47;dgrijalva&#47;jwt-go</code> doesn&#39;t seem to be maintained anymore."}], "answers": [{"comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "reply_to_user": {"reputation": 96298, "user_id": 213269, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/894e4c1f3bc33e5f9a5008d355287830?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/213269/jonas"}, "edited": false, "score": 0, "creation_date": 1542887549, "post_id": 45408538, "comment_id": 93734723, "body": "@Jonas, it refers to HMAC shared key or PEM certificate or public key, depend on the algorithm being used when signing the token. For example, it&#39;s the value of <code>mySigningKey</code> in <a href=\"https://godoc.org/github.com/dgrijalva/jwt-go#NewWithClaims\" rel=\"nofollow noreferrer\">this example</a>"}, {"owner": {"reputation": 5733, "user_id": 923642, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/97fd3a7a287d40121c459c611c40a443?s=128&d=identicon&r=PG", "display_name": "JakubKnejzlik", "link": "https://stackoverflow.com/users/923642/jakubknejzlik"}, "edited": false, "score": 2, "creation_date": 1555407394, "post_id": 45408538, "comment_id": 98090952, "body": "Be aware that if you are using custom claim based on <code>jwt.StandardClaims</code> (or standard claims directly), you should pass reference of the claims (<code>jwt.ParseWithClaims(tokenString, &amp;claims, ...)</code>. Maybe it saves someone else&#39;s  couple minutes :)"}, {"owner": {"reputation": 779, "user_id": 10160865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VDix.jpg?s=128&g=1", "display_name": "Dennis Glot", "link": "https://stackoverflow.com/users/10160865/dennis-glot"}, "edited": false, "score": 0, "creation_date": 1587294995, "post_id": 45408538, "comment_id": 108449236, "body": "You can pass <code>nil</code> as third param <code>KeyFunc</code> if you don&#39;t need to verify token."}], "tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 32, "last_activity_date": 1501481303, "creation_date": 1501481303, "answer_id": 45408538, "question_id": 45405626, "link": "https://stackoverflow.com/questions/45405626/decoding-jwt-token-in-golang/45408538#45408538", "title": "decoding JWT token in Golang", "body": "<p>Function <a href=\"https://godoc.org/github.com/dgrijalva/jwt-go#ParseWithClaims\" rel=\"noreferrer\"><code>jwt.ParseWithClaims</code></a> accept an interface of <code>jwt.Claims</code> as the second argument. Besides struct-based custom claims, the package also provides <code>map</code>-based claims, i.e. <a href=\"https://godoc.org/github.com/dgrijalva/jwt-go#MapClaims\" rel=\"noreferrer\"><code>jwt.MapClaims</code></a>. \nSo, you can simply decode the token into a <code>MapClaims</code>, e.g.</p>\n\n<pre><code>tokenString := \"&lt;YOUR TOKEN STRING&gt;\"    \nclaims := jwt.MapClaims{}\ntoken, err := jwt.ParseWithClaims(tokenString, claims, func(token *jwt.Token) (interface{}, error) {\n    return []byte(\"&lt;YOUR VERIFICATION KEY&gt;\"), nil\n})\n// ... error handling\n\n// do something with decoded claims\nfor key, val := range claims {\n    fmt.Printf(\"Key: %v, value: %v\\n\", key, val)\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 96298, "user_id": 213269, "user_type": "registered", "accept_rate": 98, "profile_image": "https://www.gravatar.com/avatar/894e4c1f3bc33e5f9a5008d355287830?s=128&d=identicon&r=PG", "display_name": "Jonas", "link": "https://stackoverflow.com/users/213269/jonas"}, "edited": false, "score": 1, "creation_date": 1542814014, "post_id": 45409670, "comment_id": 93705066, "body": "And if I dont have any VERIFICATION.PublicKey?"}, {"owner": {"reputation": 4262, "user_id": 1890512, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/fjJBP.jpg?s=128&g=1", "display_name": "Curtis Mattoon", "link": "https://stackoverflow.com/users/1890512/curtis-mattoon"}, "edited": false, "score": 2, "creation_date": 1580845523, "post_id": 45409670, "comment_id": 106229913, "body": "You might be able to find the Public/VerifyingKey on your server at an endpoint ending with <code>.well-known&#47;jwks.json</code>"}], "tags": [], "owner": {"reputation": 594, "user_id": 2303808, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/cNIwW.jpg?s=128&g=1", "display_name": "Sandun Priyanka", "link": "https://stackoverflow.com/users/2303808/sandun-priyanka"}, "is_accepted": false, "score": 3, "last_activity_date": 1501485677, "creation_date": 1501485677, "answer_id": 45409670, "question_id": 45405626, "link": "https://stackoverflow.com/questions/45405626/decoding-jwt-token-in-golang/45409670#45409670", "title": "decoding JWT token in Golang", "body": "<p>Use <code>github.com/dgrijalva/jwt-go</code> go liabary for the implementation. we can extract JWT token information from the api request according to the following way.</p>\n\n<p>When post the JWT token from the using post request. you must extract JWT information in routing section.</p>\n\n<pre><code>  func RequireTokenAuthentication(inner http.Handler) http.Handler {\n        return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n            token, err := jwt.ParseFromRequest(\n                r,\n                func(token *jwt.Token) (interface{}, error) {\n                    return VERIFICATION.PublicKey, nil\n                })\n            if err != nil || !token.Valid) {\n                log.Debug(\"Authentication failed \" + err.Error())\n                w.WriteHeader(http.StatusForbidden)\n                return\n            } else {\n                r.Header.Set(\"username\", token.Claims[\"username\"].(string))\n                r.Header.Set(\"userid\", strconv.FormatFloat((token.Claims[\"userid\"]).(float64), 'f', 0, 64))\n            }\n            inner.ServeHTTP(w, r)\n        })\n    }\n</code></pre>\n\n<p>VERIFICATION.PublicKey :  The key for verification(get public key from public.key file in your system)</p>\n\n<p>Any Issue happen.Please let me know. I can give you help.</p>\n"}, {"comments": [{"owner": {"reputation": 127019, "user_id": 59303, "user_type": "moderator", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/gIt1g.png?s=128&g=1", "display_name": "ChrisF", "link": "https://stackoverflow.com/users/59303/chrisf"}, "edited": false, "score": 1, "creation_date": 1560536059, "post_id": 56600389, "comment_id": 99782584, "body": "I didn&#39;t down vote, but the person who did might have because you didn&#39;t say and suspected you were trying to promote your own library which is frowned upon."}, {"owner": {"reputation": 1108, "user_id": 1356472, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5d0ee816d272a19a793a3f2192545c84?s=128&d=identicon&r=PG", "display_name": "Sue Spence", "link": "https://stackoverflow.com/users/1356472/sue-spence"}, "edited": false, "score": 4, "creation_date": 1562670247, "post_id": 56600389, "comment_id": 100440824, "body": "StackOverflow is a great resource but this kind of metadiscussion is demotivating for people who are only trying to help."}, {"owner": {"reputation": 361, "user_id": 9920156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4ac2bc5c7c6136831e7429601198890f?s=128&d=identicon&r=PG&f=1", "display_name": "Amjad Hussain Syed", "link": "https://stackoverflow.com/users/9920156/amjad-hussain-syed"}, "edited": false, "score": 0, "creation_date": 1613375662, "post_id": 56600389, "comment_id": 117045757, "body": "I have install this cli and I like it. It works like charm. Thanks @trung"}], "tags": [], "owner": {"reputation": 906, "user_id": 497300, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/68c8cc3daf6dde73ad11a7e27cf3bc20?s=128&d=identicon&r=PG", "display_name": "trung", "link": "https://stackoverflow.com/users/497300/trung"}, "is_accepted": false, "score": 12, "last_activity_date": 1560599853, "last_edit_date": 1560599853, "creation_date": 1560523216, "answer_id": 56600389, "question_id": 45405626, "link": "https://stackoverflow.com/questions/45405626/decoding-jwt-token-in-golang/56600389#56600389", "title": "decoding JWT token in Golang", "body": "<p><strong>Disclaimer: I am not affiliated to the library. I'm just a user, find it useful and would like to share.</strong></p>\n\n<p>It's 2019. I would like to suggest an <a href=\"https://github.com/square/go-jose/\" rel=\"noreferrer\">alternate library</a> that does pretty good job on JWT using JWS and/or JWE.</p>\n\n<p>Here is the few examples on how to use the library:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"gopkg.in/square/go-jose.v2/jwt\"\n    \"gopkg.in/square/go-jose.v2\"\n)\n...\n\nvar claims map[string]interface{} // generic map to store parsed token\n\n// decode JWT token without verifying the signature\ntoken, _ := jwt.ParseSigned(tokenString)\n_ = token.UnsafeClaimsWithoutVerification(&amp;claims)\n\n// decode JWT token and verify signature using JSON Web Keyset\ntoken, _ := jwt.ParseSigned(tokenString)\njwks := &amp;jose.JSONWebKeySet { // normally you can obtain this from an endpoint exposed by authorization server\n            Keys: []jose.JSONWebKey { // just an example\n                {\n                    Key: publicKey, \n                    Algorithm: jose.RS256, // should be the same as in the JWT token header\n                    KeyID: \"kid\", // should be the same as in the JWT token header\n                },\n            },\n        }\n_ = jwt.Claims(jwks, &amp;claims)\n</code></pre>\n\n<p>Noted that, <code>claims</code> can be a struct that contains default JWT fields and also customized fields that are inside the token\nE.g.:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>import (\n    \"github.com/mitchellh/mapstructure\"\n    \"gopkg.in/square/go-jose.v2/jwt\"\n)\n...\ntype CustomClaims struct {\n    *jwt.Claims\n    // additional claims apart from standard claims\n    extra map[string]interface{}\n}\n\nfunc (cc *CustomClaims) UnmarshalJSON(b []byte) error {\n    var rawClaims map[string]interface{}\n    if err := json.Unmarshal(b, &amp;rawClaims); err != nil {\n        return nil\n    }\n    var claims jwt.Claims\n    var decoderResult mapstructure.Metadata\n    decoder, err := mapstructure.NewDecoder(&amp;mapstructure.DecoderConfig{\n        Result:   &amp;claims,\n        Metadata: &amp;decoderResult,\n        TagName:  \"json\",\n    })\n    if err != nil {\n        return err\n    }\n    if err := decoder.Decode(rawClaims); err != nil {\n        return err\n    }\n    cc.Claims = &amp;claims\n    cc.extra = make(map[string]interface{})\n    for _, k := range decoderResult.Unused {\n        cc.extra[k] = rawClaims[k]\n    }\n    return nil\n}\n</code></pre>\n\n<p>I also built <a href=\"https://github.com/trung/jwt-tools/\" rel=\"noreferrer\">a command line tool</a> that uses the <a href=\"https://github.com/square/go-jose/\" rel=\"noreferrer\">library</a> to perform various encoding/decoding activities. It might be a useful reference on the usage of the library too.</p>\n"}, {"comments": [{"owner": {"reputation": 179, "user_id": 5637613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xMWRn.jpg?s=128&g=1", "display_name": "You&#39;re awesome", "link": "https://stackoverflow.com/users/5637613/youre-awesome"}, "edited": false, "score": 0, "creation_date": 1607676023, "post_id": 63650998, "comment_id": 115352137, "body": "doen&#39;t work in version 3.2.0, the error is <code>keyFunc can&#39;t be nil</code>"}, {"owner": {"reputation": 779, "user_id": 10160865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VDix.jpg?s=128&g=1", "display_name": "Dennis Glot", "link": "https://stackoverflow.com/users/10160865/dennis-glot"}, "reply_to_user": {"reputation": 179, "user_id": 5637613, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/xMWRn.jpg?s=128&g=1", "display_name": "You&#39;re awesome", "link": "https://stackoverflow.com/users/5637613/youre-awesome"}, "edited": false, "score": 0, "creation_date": 1608137165, "post_id": 63650998, "comment_id": 115492474, "body": "@You&#39;reawesome that&#39;s the error, but the code doesn&#39;t compare <code>err</code> with <code>nil</code>, it compares the <code>token</code>."}], "tags": [], "owner": {"reputation": 779, "user_id": 10160865, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/9VDix.jpg?s=128&g=1", "display_name": "Dennis Glot", "link": "https://stackoverflow.com/users/10160865/dennis-glot"}, "is_accepted": false, "score": 2, "last_activity_date": 1598729509, "creation_date": 1598729509, "answer_id": 63650998, "question_id": 45405626, "link": "https://stackoverflow.com/questions/45405626/decoding-jwt-token-in-golang/63650998#63650998", "title": "decoding JWT token in Golang", "body": "<p>If you want to get claims from jwt token <strong>without validation</strong></p>\n<pre><code>import &quot;github.com/dgrijalva/jwt-go&quot;\n...\n    token, err := jwt.Parse(tokenStr, nil)\n    if token == nil {\n        return nil, err\n    }\n    claims, _ := token.Claims.(jwt.MapClaims)\n    // claims are actually a map[string]interface{}\n\n</code></pre>\n"}], "owner": {"reputation": 3528, "user_id": 5170722, "user_type": "registered", "accept_rate": 51, "profile_image": "https://graph.facebook.com/10206583885691224/picture?type=large", "display_name": "Sredny M Casanova", "link": "https://stackoverflow.com/users/5170722/sredny-m-casanova"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29429, "favorite_count": 1, "accepted_answer_id": 45408538, "answer_count": 4, "score": 20, "last_activity_date": 1598729509, "creation_date": 1501456726, "last_edit_date": 1588055926, "question_id": 45405626, "link": "https://stackoverflow.com/questions/45405626/decoding-jwt-token-in-golang", "title": "decoding JWT token in Golang", "body": "<p>I am currently working on a Golang application.I receive a JWT token from the client side and, in Go I need to decode that token and get the information: user, name, etc. I was checking the libraries that are available to handle JWT tokens and I came down to <a href=\"https://github.com/dgrijalva/jwt-go\" rel=\"noreferrer\">https://github.com/dgrijalva/jwt-go</a>, but I don't see how to simply make what I need.</p>\n\n<p>I have the token and I need to decode the info into a map or at least a json. Where can I find a guide of how to do it?\nThank you!</p>\n"}, {"tags": ["go", "vim"], "comments": [{"owner": {"reputation": 139, "user_id": 4301733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gpmFe.png?s=128&g=1", "display_name": "adelowo", "link": "https://stackoverflow.com/users/4301733/adelowo"}, "edited": false, "score": 2, "creation_date": 1501466384, "post_id": 45405468, "comment_id": 77773629, "body": "As an aside, why don&#39;t you use <code>vim-go</code>. It does this already"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "edited": false, "score": 1, "creation_date": 1501470372, "post_id": 45405468, "comment_id": 77774320, "body": "And run <code>goimports</code> instead of <code>gofmt</code>."}, {"owner": {"reputation": 41009, "user_id": 450989, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/YGjdr.jpg?s=128&g=1", "display_name": "Grzegorz \u017bur", "link": "https://stackoverflow.com/users/450989/grzegorz-%c5%bbur"}, "edited": false, "score": 1, "creation_date": 1501493336, "post_id": 45405468, "comment_id": 77784550, "body": "If you don&#39;t want to use vim-go and automate formatting on save, add the following line to the <code>.vimrc</code> file. <code>:autocmd BufWritePost *.go silent ! go fmt % 2&gt;&amp;1 &gt;&#47;dev&#47;null</code>"}], "answers": [{"tags": [], "owner": {"reputation": 84, "user_id": 8387443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0edabe8b735c970d9677eb3362c2b7?s=128&d=identicon&r=PG", "display_name": "IanS5", "link": "https://stackoverflow.com/users/8387443/ians5"}, "is_accepted": false, "score": 4, "last_activity_date": 1501493159, "last_edit_date": 1501493159, "creation_date": 1501459876, "answer_id": 45405938, "question_id": 45405468, "link": "https://stackoverflow.com/questions/45405468/vim-replace-content-from-file-with-output-from-external-command/45405938#45405938", "title": "Vim replace content from file with output from external command", "body": "<p>The <code>gofmt flag -w</code> will overwrite the contents of the file it's fixing</p>\n"}, {"tags": [], "owner": {"reputation": 153428, "user_id": 813602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1844cebf36374d83a83c0e69003cd42?s=128&d=identicon&r=PG", "display_name": "Ingo Karkat", "link": "https://stackoverflow.com/users/813602/ingo-karkat"}, "is_accepted": true, "score": 3, "last_activity_date": 1501493514, "creation_date": 1501493514, "answer_id": 45412153, "question_id": 45405468, "link": "https://stackoverflow.com/questions/45405468/vim-replace-content-from-file-with-output-from-external-command/45412153#45412153", "title": "Vim replace content from file with output from external command", "body": "<p>You're using the wrong command: <code>:read</code> <em>appends</em> lines to the buffer (with <code>! {cmd}</code>: from an external command). Instead, you want to <em>filter</em> the current buffer contents through an external command. This is done via <code>:help :range!</code>. The <code>gofmt</code> command reads from stdin when no file is passed (some other commands take a special <code>-</code> argument for that. Ergo:</p>\n\n<pre><code>:nnoremap &lt;C-r&gt; :%! gofmt&lt;CR&gt;\n</code></pre>\n\n<h3>Notes</h3>\n\n<ul>\n<li><a href=\"http://learnvimscriptthehardway.stevelosh.com/chapters/05.html\" rel=\"nofollow noreferrer\">You should use <code>:noremap</code></a>; it makes the mapping immune to remapping and recursion.</li>\n<li>I've limited the mapping to <em>normal mode</em>; I don't think is necessary to directly launch this from visual mode or operator-pending mode.</li>\n<li>As mentioned in the comments, there's probably a plugin that already provides this out of the box.</li>\n</ul>\n"}], "owner": {"reputation": 786, "user_id": 2393256, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/171c5497271ae6531326680ade33a88f?s=128&d=identicon&r=PG", "display_name": "user2393256", "link": "https://stackoverflow.com/users/2393256/user2393256"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 335, "favorite_count": 0, "accepted_answer_id": 45412153, "answer_count": 2, "score": 2, "last_activity_date": 1501493514, "creation_date": 1501455013, "last_edit_date": 1501455679, "question_id": 45405468, "link": "https://stackoverflow.com/questions/45405468/vim-replace-content-from-file-with-output-from-external-command", "title": "Vim replace content from file with output from external command", "body": "<p>I am programming go and I want to run <code>gofmt</code> with a shortcut and replace the content of the current source file with the output of <code>gofmt</code>.</p>\n\n<p>I have the following mapping defined in my vimrc:\n<code>map &lt;C-r&gt; :r ! gofmt %&lt;CR&gt;</code> but this does simply append the output to the current file. Is there a way to override it?</p>\n"}, {"tags": ["mysql", "go"], "comments": [{"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501452279, "post_id": 45405137, "comment_id": 77770584, "body": "The id has to exist in the <code>tax</code> table before you can add the foreign key to the <code>item</code> table."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1501452400, "post_id": 45405137, "comment_id": 77770611, "body": "What <code>tax_id</code> are you trying to assign in the <code>item</code> table? Is there a row in the <code>tax</code> table with that <code>id</code>?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501452400, "post_id": 45405137, "comment_id": 77770612, "body": "Okay, that makes sense. But in this case the ID <i>does</i> exist, because I am selecting from a list of pre-existing taxes so it must exist, I don&#39;t understand why it&#39;s throwing the error."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 1, "creation_date": 1501452474, "post_id": 45405137, "comment_id": 77770628, "body": "if you&#39;re using a placeholder that gets replaced with a bound parameter, check the variable that you&#39;re binding. Maybe you made a mistake there."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501452565, "post_id": 45405137, "comment_id": 77770654, "body": "I think it is because the specific update selects no tax (since a tax is optional), which means I set the tax_id to <code>NULL</code>. That is probably why it&#39;s throwing the error... am I not allowed to set it to <code>NULL</code>?"}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501452663, "post_id": 45405137, "comment_id": 77770674, "body": "You should be able to set it to null. How are you assigning the null value? If you&#39;re using the string <code>&#39;NULL&#39;</code> that won&#39;t work, it has to be an actual <code>null</code> value."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501452728, "post_id": 45405137, "comment_id": 77770687, "body": "Show your actual code that binds the variables."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501452799, "post_id": 45405137, "comment_id": 77770705, "body": "Ah that was it! I was using a string <code>&quot;NULL&quot;</code>, and since I&#39;m using Go I changed it to <code>nil</code> and it works now. Good to know... I figured I could just use NULL."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501452855, "post_id": 45405137, "comment_id": 77770728, "body": "When a string is converted to a number, it becomes <code>0</code> if it doesn&#39;t begin with digits."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501453022, "post_id": 45405137, "comment_id": 77770766, "body": "Thanks for the help. Updated answer with the code in question."}, {"owner": {"reputation": 589605, "user_id": 1491895, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/82f9e178a16364bf561d0ed4da09a35d?s=128&d=identicon&r=PG", "display_name": "Barmar", "link": "https://stackoverflow.com/users/1491895/barmar"}, "edited": false, "score": 0, "creation_date": 1501453080, "post_id": 45405137, "comment_id": 77770779, "body": "The question should contain the incorrect code, the solution should be in an <b>Answer</b>."}], "answers": [{"tags": [], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "is_accepted": false, "score": 0, "last_activity_date": 1501453124, "creation_date": 1501453124, "answer_id": 45405266, "question_id": 45405137, "link": "https://stackoverflow.com/questions/45405137/mysql-update-foreign-key-constraint-fails/45405266#45405266", "title": "MySQL UPDATE foreign key constraint fails", "body": "<p>Fixed thanks to @Barmar. Had to change <code>\"NULL\"</code> to <code>nil</code>. \" \nWhen a string is converted to a number, it becomes 0 if it doesn't begin with digits\".</p>\n\n<pre><code>func (r *ItemRepository) UpdateByID(itemId int, item *domain.Item) error {\n    var err error\n\n    if item.Tax == nil {\n        _, err = r.db.Exec(`\n            UPDATE item\n            SET tax_id = ?, name = ?, description = ?, price = ?\n            WHERE id = ?\n            LIMIT 1\n        `, nil, item.Name, item.Description, item.Price, itemId)\n    } else {\n        _, err = r.db.Exec(`\n            UPDATE item\n            SET tax_id = ?, name = ?, description = ?, price = ?\n            WHERE id = ?\n            LIMIT 1\n        `, item.Tax.ID, item.Name, item.Description, item.Price, itemId)\n    }\n    if err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 64, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501453124, "creation_date": 1501452189, "last_edit_date": 1501453111, "question_id": 45405137, "link": "https://stackoverflow.com/questions/45405137/mysql-update-foreign-key-constraint-fails", "title": "MySQL UPDATE foreign key constraint fails", "body": "<p>For starters, I have seen other answers, and they solve the problem of the other similar questions, but I don't understand the reason for the failure or how to solve it, because other answers say things like \"check if the record exists in another table to insert their correct relationship, otherwise this error occurs\". That has no relevance to what I'm trying to do (I think); I simply want to update the data of a particular item in a table, I don't want to update any relationships, just the foreign key ID.</p>\n\n<p>This is my error:</p>\n\n<blockquote>\n  <p>Error 1452: Cannot add or update a child row: a foreign key constraint fails (<code>app</code>.<code>item</code>, CONSTRAINT <code>item_tax_fk</code> FOREIGN KEY (<code>tax_id</code>) REFERENCES <code>tax</code> (<code>id</code>))</p>\n</blockquote>\n\n<p>This is my query (the question marks will be converted to values):</p>\n\n<pre><code>UPDATE item\nSET tax_id = ?, name = ?, description = ?, price = ?\nWHERE id = ?\nLIMIT 1\n</code></pre>\n\n<p>This is the relevant schema:</p>\n\n<pre><code>CREATE TABLE tax (\n    id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,\n\n    name VARCHAR(255) NOT NULL,\n    rate FLOAT NOT NULL,\n\n    created_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP,\n    deleted_at TIMESTAMP NULL DEFAULT NULL,\n\n    PRIMARY KEY (id)\n);\n\nCREATE TABLE item (\n    id INT(10) UNSIGNED NOT NULL AUTO_INCREMENT,\n\n    tax_id INT(10) UNSIGNED NULL DEFAULT NULL,\n    name VARCHAR(255) NOT NULL,\n    description VARCHAR(1000) NOT NULL,\n    price FLOAT NOT NULL,\n\n    created_at TIMESTAMP NULL DEFAULT CURRENT_TIMESTAMP,\n    updated_at TIMESTAMP NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP,\n    deleted_at TIMESTAMP NULL DEFAULT NULL,\n\n    CONSTRAINT `item_tax_fk` FOREIGN KEY (`tax_id`) REFERENCES `tax` (`id`),\n\n    PRIMARY KEY (id)\n);\n</code></pre>\n\n<p>This is my function:</p>\n\n<pre><code>func (r *ItemRepository) UpdateByID(itemId int, item *domain.Item) error {\n    var err error\n\n    if item.Tax == nil {\n        _, err = r.db.Exec(`\n            UPDATE item\n            SET tax_id = ?, name = ?, description = ?, price = ?\n            WHERE id = ?\n            LIMIT 1\n        `, \"NULL\", item.Name, item.Description, item.Price, itemId)\n    } else {\n        _, err = r.db.Exec(`\n            UPDATE item\n            SET tax_id = ?, name = ?, description = ?, price = ?\n            WHERE id = ?\n            LIMIT 1\n        `, item.Tax.ID, item.Name, item.Description, item.Price, itemId)\n    }\n    if err != nil {\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n\n<p>Why do I get this error? How can I resolve it?</p>\n"}, {"tags": ["go", "ufw"], "answers": [{"tags": [], "owner": {"reputation": 2175, "user_id": 817571, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/3eb3aee0450c2c335756206fe6ab70ed?s=128&d=identicon&r=PG", "display_name": "MIkCode", "link": "https://stackoverflow.com/users/817571/mikcode"}, "is_accepted": false, "score": 0, "last_activity_date": 1501497585, "last_edit_date": 1501497585, "creation_date": 1501487923, "answer_id": 45410312, "question_id": 45404282, "link": "https://stackoverflow.com/questions/45404282/go-to-ban-an-ip-using-ufw/45410312#45410312", "title": ".go to ban an ip using ufw", "body": "<p>You can  execute the command by using  <a href=\"https://golang.org/pkg/os/exec/\" rel=\"nofollow noreferrer\">exec</a></p>\n\n<pre><code>if err != nil {\n    s.policy.ApplyMalformedPolicy(cs.ip)\n\n    out, err := exec.Command(fmt.Sprintf(\"ufw deny from {%d} to any\",cs.ip).Output()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    log.Printf(\"Malformed stratum request from %s: %v\", cs.ip, err)\n    return err\n}\n</code></pre>\n"}], "owner": {"reputation": 21, "user_id": 8387316, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9d30bbe4437483f98d5a2ba294209a9b?s=128&d=identicon&r=PG&f=1", "display_name": "Danx", "link": "https://stackoverflow.com/users/8387316/danx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 187, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1501497585, "creation_date": 1501445847, "last_edit_date": 1501450636, "question_id": 45404282, "link": "https://stackoverflow.com/questions/45404282/go-to-ban-an-ip-using-ufw", "title": ".go to ban an ip using ufw", "body": "<p>Okay, so here is the original code, which works fine.  </p>\n\n<pre><code>if len(data) &gt; 1 {\n  var req StratumReq\n  err = json.Unmarshal(data, &amp;req)\n  if err != nil {\n    s.policy.ApplyMalformedPolicy(cs.ip)\n    log.Printf(\"Malformed stratum request from %s: %v\", cs.ip, err)\n    return err\n  }\n}\n</code></pre>\n\n<p>However instead of just printing the error I want to use ufw in Ubuntu 16.04 to ban the ip.  However I'm not too familiar with this type of coding to get the correct syntax to do that.  Any help would be appreciated.  It's written in .go</p>\n"}, {"tags": ["math", "go"], "comments": [{"owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 1, "creation_date": 1501441287, "post_id": 45402834, "comment_id": 77767326, "body": "Very interesting. Are you sure <code>python</code> gives you the right answer? I tried: <code>math.sin(4e20)</code> and <code>math.sin(4e20 + 1)</code> and I get the same result: <code>-0.3298871424318473</code>. My feeling here is that with with floats that large, the precision is really low, and it is impossible to calculate <code>sin</code> accurately. I would almost think that <code>go</code> deliberately gave you large value on purpose, so you would know that something is wrong, but according to the source code: <a href=\"https://golang.org/src/math/sin.go?s=5085:5112#L164\" rel=\"nofollow noreferrer\">golang.org/src/math/sin.go?s=5085:5112#L164</a>, it might have been on accident."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501443285, "post_id": 45402834, "comment_id": 77768008, "body": "It appears to be a <a href=\"https://github.com/golang/go/issues/6794\" rel=\"nofollow noreferrer\">known bug</a>.  Not sure what the best work-around is."}, {"owner": {"reputation": 2675, "user_id": 875192, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/JNiqS.jpg?s=128&g=1", "display_name": "Moe Far", "link": "https://stackoverflow.com/users/875192/moe-far"}, "reply_to_user": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "edited": false, "score": 0, "creation_date": 1501474323, "post_id": 45402834, "comment_id": 77775088, "body": "Yeah @Akavall , it was right in python 2 and 3"}], "answers": [{"comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1501443259, "post_id": 45403337, "comment_id": 77768000, "body": "That bug has been closed as a duplicate of <a href=\"https://github.com/golang/go/issues/6794\" rel=\"nofollow noreferrer\">this much more complete one</a>."}], "tags": [], "owner": {"reputation": 84, "user_id": 8387443, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c0edabe8b735c970d9677eb3362c2b7?s=128&d=identicon&r=PG", "display_name": "IanS5", "link": "https://stackoverflow.com/users/8387443/ians5"}, "is_accepted": false, "score": 2, "last_activity_date": 1501439779, "creation_date": 1501439779, "answer_id": 45403337, "question_id": 45402834, "link": "https://stackoverflow.com/questions/45402834/go-math-package-has-invalid-result/45403337#45403337", "title": "Go math package has invalid result", "body": "<p>It seems like it's just an issue with the implementation, if the input is more than 2**49 it causes issues. Found a <em>really</em> old issue <a href=\"https://github.com/golang/go/issues/7110\" rel=\"nofollow noreferrer\">here</a></p>\n"}], "owner": {"reputation": 2675, "user_id": 875192, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/JNiqS.jpg?s=128&g=1", "display_name": "Moe Far", "link": "https://stackoverflow.com/users/875192/moe-far"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 1, "answer_count": 1, "score": 7, "last_activity_date": 1501439779, "creation_date": 1501436712, "question_id": 45402834, "link": "https://stackoverflow.com/questions/45402834/go-math-package-has-invalid-result", "title": "Go math package has invalid result", "body": "<p>I just ran this code on my pc:</p>\n\n<pre><code>package main\n\nimport (\n   \"fmt\"\n   \"math\"\n)\n\nfunc main() {\n   const ali = 4e20\n   fmt.Println(math.Sin(ali))\n}\n</code></pre>\n\n<p>and got this result:</p>\n\n<pre><code>1.3471173831553043e+258\n</code></pre>\n\n<p>Why Sin result goes more than 1?</p>\n\n<p>Python and some other languages have correct result</p>\n"}, {"tags": ["database", "testing", "go", "database-migration"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501420960, "post_id": 45400203, "comment_id": 77761024, "body": "Do not post images of text. They are not searchable, or always even readable.  Please copy-and-paste all text content."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501421027, "post_id": 45400203, "comment_id": 77761040, "body": "To address your question: <code>is it possible to trigger migration (up&#47;down&#47;reset) from inside Go Code?</code> It&#39;s possible to do anything you want. What have you tried? What problems have you encountered?"}, {"owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501468311, "post_id": 45400203, "comment_id": 77773965, "body": "@Flimzy just like I&#39;ve said before, I need to migrate up all migrations before Testing is running and then migrate reset after Testing is done."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501490126, "post_id": 45400203, "comment_id": 77782233, "body": "You didn&#39;t answer my questions. What have you tried? What problems have you encountered?"}, {"owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501497208, "post_id": 45400203, "comment_id": 77787407, "body": "I am trying to test my Rest API code which is requiring my  database tables to be prepared before testing is running. and my problem is I can&#39;t setup goose migration to migrate up all tables before unit test"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501505139, "post_id": 45400203, "comment_id": 77793276, "body": "I understand what you are trying to do. But I asked <i>what have you tried</i>. This means: Show us your code, or explain your attempt. And when you tried that, what happened differently than you expected?"}, {"owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501561218, "post_id": 45400203, "comment_id": 77818763, "body": "I am trying to execute following bash command: <code>goose postgres &quot;user=postgres dbname=teahrm_test sslmode=disable&quot; up</code> using exec.Command(&quot;goose&quot;, args...) but still not working, it keeps return status code 1"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501572659, "post_id": 45400203, "comment_id": 77824005, "body": "Please read, and answer my ENTIRE QUESTION. What happened when you tried that? What were you expecting instead?  &quot;it doesn&#39;t work&quot; is <i>not</i> a problem statement."}, {"owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501574595, "post_id": 45400203, "comment_id": 77825312, "body": "I have answered all of your questions, I said that I have tried to execute the goose shell command and the shell command that I executed from Go code was returned status code 1 (error). what I expecting ? of course I want the goose migrate command to generate the tables for me before my testing code being executed."}], "answers": [{"tags": [], "owner": {"reputation": 2070, "user_id": 378704, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e5318a95a23ff8a67c0edc171412c83a?s=128&d=identicon&r=PG", "display_name": "kiran.koduru", "link": "https://stackoverflow.com/users/378704/kiran-koduru"}, "is_accepted": false, "score": 1, "last_activity_date": 1501421569, "creation_date": 1501421569, "answer_id": 45400347, "question_id": 45400203, "link": "https://stackoverflow.com/questions/45400203/cannot-make-goose-db-migration-working-for-go-testing/45400347#45400347", "title": "Cannot make Goose DB Migration working for Go testing", "body": "<p>I am new to <code>go</code> as well, so my analysis may be totally wrong but since <code>goose</code> seems to be an open source package itself, I took a look at the <a href=\"https://github.com/pressly/goose/blob/master/cmd/goose/main.go#L78-L80\" rel=\"nofollow noreferrer\">cmd/goose/main.go</a> file that refers to how the commands are called internally:</p>\n\n<pre><code>if err := goose.Run(command, db, *dir, arguments...); err != nil {\n    log.Fatalf(\"goose run: %v\", err)\n}\n</code></pre>\n\n<p>Which calls the <code>Run</code>func that is defined in the <a href=\"https://github.com/pressly/goose/blob/master/goose.go#L17\" rel=\"nofollow noreferrer\">goose.go</a> </p>\n\n<pre><code>func Run(command string, db *sql.DB, dir string, args ...string) error {\n</code></pre>\n\n<p>That takes argument <code>command</code> string argument with db strings as well.</p>\n\n<p>But if you would like to still work with the <code>execCommand</code> then maybe you could take a look at <a href=\"https://github.com/pressly/goose/blob/master/goose_test.go\" rel=\"nofollow noreferrer\">goose_test.go</a> file which which passes arguments <code>dir</code> where the migrations are to be run perhaps.</p>\n"}, {"tags": [], "owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "is_accepted": false, "score": 0, "last_activity_date": 1501660292, "creation_date": 1501660292, "answer_id": 45454704, "question_id": 45400203, "link": "https://stackoverflow.com/questions/45400203/cannot-make-goose-db-migration-working-for-go-testing/45454704#45454704", "title": "Cannot make Goose DB Migration working for Go testing", "body": "<p>Finally I got this issue solved by changing this following line on my code:</p>\n\n<pre><code>\"\\\"user=\" + os.Getenv(\"DB_USERNAME\") + \" dbname=\" + os.Getenv(\"DB_TEST_NAME\") + \" sslmode=disable\\\"\",\n</code></pre>\n\n<p>to:</p>\n\n<pre><code>\"user=\" + os.Getenv(\"DB_USERNAME\") + \" dbname=\" + os.Getenv(\"DB_TEST_NAME\") + \" sslmode=disable\",\n</code></pre>\n"}], "owner": {"reputation": 1411, "user_id": 2674072, "user_type": "registered", "accept_rate": 61, "profile_image": "https://i.stack.imgur.com/6B3uG.jpg?s=128&g=1", "display_name": "Yusuf Ibrahim", "link": "https://stackoverflow.com/users/2674072/yusuf-ibrahim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1067, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1501660292, "creation_date": 1501420495, "last_edit_date": 1501468587, "question_id": 45400203, "link": "https://stackoverflow.com/questions/45400203/cannot-make-goose-db-migration-working-for-go-testing", "title": "Cannot make Goose DB Migration working for Go testing", "body": "<p>I am currently learning Golang for web programming and now I continue by learning about database,Rest API and testing in Golang.  </p>\n\n<p>and now I got an issue with <em><a href=\"https://github.com/pressly/goose\" rel=\"nofollow noreferrer\">Goose</a></em> database Migration and <em>Go Testing</em> integration.</p>\n\n<p>I want to integrate goose migration to my Go testing code, my scenario is to up all migrations before test and then reset all database once testing is done.</p>\n\n<p>my problem is I can't find any documentation/sample code to do it with <a href=\"https://github.com/pressly/goose\" rel=\"nofollow noreferrer\">Goose</a>.</p>\n\n<p>I also have tried to execute the <a href=\"https://github.com/pressly/goose\" rel=\"nofollow noreferrer\">goose</a> command using <strong>exec.Command()</strong> but it always returns <em>exit status 1</em></p>\n\n<p>this is my existing code to trigger the migration up before testing being executed:</p>\n\n<pre><code>func pretest() {\n      var args = []string{\n          os.Getenv(\"DB_SERVER\"),\n          \"\\\"user=\" + os.Getenv(\"DB_USERNAME\") + \" dbname=\" + os.Getenv(\"DB_TEST_NAME\") + \" sslmode=disable\\\"\",\n          \"up\",\n      }   \n\n      exe := exec.Command(\"goose\", args...)\n      exe.Dir = os.Getenv(\"DB_MIGRATION\")\n      /* result, err := exe.Output()*/\n      //fmt.Println(string(result))\n      /*fmt.Println(err)*/\n\n      output := exe.Run()\n      fmt.Println(output)\n  }\n</code></pre>\n\n<p><a href=\"https://i.stack.imgur.com/ztU9R.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ztU9R.png\" alt=\"enter image description here\"></a></p>\n\n<pre><code>$ go test -v\nexit status 1\ntesting: warning: no tests to run\nPASS\nok\n</code></pre>\n\n<p>my question is it possible to trigger migration (up/down/reset) from inside Go Code (in this case is testing code) ?</p>\n\n<p>Why <strong>exec.Command()</strong> keep returning <em>code status 1</em> but it work well when I execute another linux command (ls, pwd, mkdir are work well in the same way) ?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1501420838, "post_id": 45400092, "comment_id": 77760988, "body": "What is your question?"}], "answers": [{"comments": [{"owner": {"reputation": 9, "user_id": 6829581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITx39.jpg?s=128&g=1", "display_name": "Daxad", "link": "https://stackoverflow.com/users/6829581/daxad"}, "edited": false, "score": 0, "creation_date": 1501565184, "post_id": 45400300, "comment_id": 77820031, "body": "Because Go is a compiled language, it processes the code accordingly, I suppose ?"}], "tags": [], "owner": {"reputation": 1103, "user_id": 6156340, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hQfBBXrnbpI/AAAAAAAAAAI/AAAAAAAABP4/BK5aW9CX7S4/photo.jpg?sz=128", "display_name": "Wassim Dhif", "link": "https://stackoverflow.com/users/6156340/wassim-dhif"}, "is_accepted": false, "score": 0, "last_activity_date": 1501421223, "creation_date": 1501421223, "answer_id": 45400300, "question_id": 45400092, "link": "https://stackoverflow.com/questions/45400092/beginner-golang-sequence-clarification/45400300#45400300", "title": "Beginner Golang sequence clarification", "body": "<p>The value you enter is allocated at the input memory space (using the &amp;). The input variable is created before the scanf (line 2) so there is no problem at all with the order of your instruction. Maybe you can clarify ?</p>\n"}], "owner": {"reputation": 9, "user_id": 6829581, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/ITx39.jpg?s=128&g=1", "display_name": "Daxad", "link": "https://stackoverflow.com/users/6829581/daxad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 72, "favorite_count": 0, "answer_count": 1, "score": -1, "last_activity_date": 1501574480, "creation_date": 1501419638, "question_id": 45400092, "link": "https://stackoverflow.com/questions/45400092/beginner-golang-sequence-clarification", "title": "Beginner Golang sequence clarification", "body": "<p>I am trying GO as a complete newbie to programming. I have a doubt in sequence inside the following code. This code scans for user input.</p>\n\n<pre><code>func main() {\n  fmt.Print(\"Enter a number: \\n\")\n  var input float64\n  fmt.Scanf(\"%f\", &amp;input)\n  output := input * 2\n  fmt.Println(output)\n</code></pre>\n\n<p>But, after the string display, at the new line when I enter any number, it should just go into a buffer of some sort or become junk value. I say so, because the allocation of scanned input starts after the first line. Had it been the first or prior step, it would perfectly make sense. </p>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 3058, "user_id": 2776473, "user_type": "registered", "accept_rate": 25, "profile_image": "https://i.stack.imgur.com/JvVL6.jpg?s=128&g=1", "display_name": "Shmulik Klein", "link": "https://stackoverflow.com/users/2776473/shmulik-klein"}, "edited": false, "score": 0, "creation_date": 1501417507, "post_id": 45399758, "comment_id": 77760085, "body": "Look at the great answer at <a href=\"https://stackoverflow.com/questions/26857582/in-a-go-slice-why-does-slohi-end-at-element-hi-1\" title=\"in a go slice why does slohi end at element hi 1\">stackoverflow.com/questions/26857582/&hellip;</a>"}, {"owner": {"reputation": 14155, "user_id": 632088, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/4b02313659bcb668d49a0075c2de0bc1?s=128&d=identicon&r=PG", "display_name": "robert king", "link": "https://stackoverflow.com/users/632088/robert-king"}, "edited": false, "score": 1, "creation_date": 1501417549, "post_id": 45399758, "comment_id": 77760101, "body": "see: <a href=\"https://www.quora.com/Why-are-Python-ranges-half-open-exclusive-instead-of-closed-inclusive\" rel=\"nofollow noreferrer\">quora.com/&hellip;</a> also"}], "owner": {"reputation": 630, "user_id": 5485232, "user_type": "registered", "accept_rate": 33, "profile_image": "https://i.stack.imgur.com/cz2UJ.jpg?s=128&g=1", "display_name": "Bryon", "link": "https://stackoverflow.com/users/5485232/bryon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "closed_date": 1501417448, "answer_count": 0, "score": 0, "last_activity_date": 1501417601, "creation_date": 1501417198, "last_edit_date": 1501417601, "question_id": 45399758, "link": "https://stackoverflow.com/questions/45399758/why-is-the-upper-value-of-a-slices-range-one-more-than-returned", "closed_reason": "Duplicate", "title": "Why is the upper value of a slice&#39;s range one more than returned?", "body": "<p>Can someone please help me understand why the upper value of a slice's range in GO is one more than what is actually in the slice?\nE.g.</p>\n\n<pre><code>var slice []byte = buffer[100:150]\n</code></pre>\n\n<p>This slice is 50 elements long and references elements 100 through 149 in the array.</p>\n\n<p>I understand the math behind it; it slices elements from 100 with length (150-100); but I don't think it reads clearly and will cause lots of silly programming errors. Maybe if I understand their thinking behind the choice it won't urk me so much...  :-)\nThanks\nBryon</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1501401538, "post_id": 45397625, "comment_id": 77755902, "body": "Hi, and welcome to Stack Overflow. Your question doesn&#39;t have enough information to understand the problem, we&#39;d need to see what you&#39;ve tried so far. If you&#39;re new to Go, you&#39;ll probably want to read <a href=\"https://tour.golang.org/list\" rel=\"nofollow noreferrer\">A Tour Of Go</a>, <a href=\"https://golang.org/doc/effective_go.html\" rel=\"nofollow noreferrer\">Effective Go</a> and <a href=\"https://gobyexample.com/\" rel=\"nofollow noreferrer\">Go By Example</a>."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1501421541, "post_id": 45397625, "comment_id": 77761186, "body": "What do you mean by &quot;handle a URL&quot;?  What have you tried? Are you using a router? Which one?"}, {"owner": {"reputation": 543, "user_id": 3418791, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/eeb7d9f08fec68db1f5b0c823bf70e1e?s=128&d=identicon&r=PG&f=1", "display_name": "Warrior", "link": "https://stackoverflow.com/users/3418791/warrior"}, "edited": false, "score": 0, "creation_date": 1501435396, "post_id": 45397625, "comment_id": 77765504, "body": "Please read the official documentation before asking any questions like this."}], "answers": [{"tags": [], "owner": {"reputation": 131, "user_id": 8386275, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c3a0a1bcc1d93433e70e653d2f682161?s=128&d=identicon&r=PG&f=1", "display_name": "nauman", "link": "https://stackoverflow.com/users/8386275/nauman"}, "is_accepted": false, "score": 3, "last_activity_date": 1501402937, "creation_date": 1501402937, "answer_id": 45397828, "question_id": 45397625, "link": "https://stackoverflow.com/questions/45397625/how-to-handle-dynamic-url-in-golang/45397828#45397828", "title": "How to Handle dynamic URL in Golang", "body": "<p>If you take a look at this page <a href=\"https://golang.org/doc/articles/wiki/\" rel=\"nofollow noreferrer\">https://golang.org/doc/articles/wiki/</a> there are examples of what I think you are after.  </p>\n\n<p>You want a handler with name person and then extract (any_name) and handle it accordingly to each person. One of the examples shows how to do it with title which is the same principle.</p>\n\n<pre><code>func viewHandler(w http.ResponseWriter, r *http.Request) {\n    title := r.URL.Path[len(\"/view/\"):]\n    p, _ := loadPage(title)\n    t, _ := template.ParseFiles(\"view.html\")\n    t.Execute(w, p)\n}\n</code></pre>\n\n<p>Instead of /view/ you got /person/ and title is what (any_name) is in your case.</p>\n\n<p><code>r.URL.Path[len(\"/view/\"):]</code> will take everything from <code>r.URL.Path</code> but start <code>len(\"/view/\")</code> bytes into the slice.</p>\n"}, {"tags": [], "owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "is_accepted": false, "score": 3, "last_activity_date": 1501435212, "creation_date": 1501435212, "answer_id": 45402602, "question_id": 45397625, "link": "https://stackoverflow.com/questions/45397625/how-to-handle-dynamic-url-in-golang/45402602#45402602", "title": "How to Handle dynamic URL in Golang", "body": "<p>You should look into using gorilla/mux package for what you are trying to do.\nAn excerpt from the package github shows <a href=\"https://github.com/gorilla/mux\" rel=\"nofollow noreferrer\">https://github.com/gorilla/mux</a> </p>\n\n<pre><code>r := mux.NewRouter()\nr.HandleFunc(\"/products/{key}\", ProductHandler)\nr.HandleFunc(\"/articles/{category}/\", ArticlesCategoryHandler)\nr.HandleFunc(\"/articles/{category}/{id:[0-9]+}\", ArticleHandler)\n</code></pre>\n"}], "owner": {"reputation": 310, "user_id": 5763301, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/9b18f314b1e9d2b6a0dd1e5cf218c61c?s=128&d=identicon&r=PG", "display_name": "Tavinder Singh", "link": "https://stackoverflow.com/users/5763301/tavinder-singh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4369, "favorite_count": 1, "closed_date": 1501464610, "answer_count": 2, "score": 0, "last_activity_date": 1501435212, "creation_date": 1501401232, "question_id": 45397625, "link": "https://stackoverflow.com/questions/45397625/how-to-handle-dynamic-url-in-golang", "closed_reason": "Needs more focus", "title": "How to Handle dynamic URL in Golang", "body": "<p>I am creating a Go web app in which I need to handle a URL like /person/(any_name). As a newbie in Golang, I don't know how to do so. Please help me.</p>\n"}, {"tags": ["go", "idioms"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 1, "creation_date": 1501398229, "post_id": 45395982, "comment_id": 77755190, "body": "It&#39;s okay, but 10 methods just seems wrong. The standard library itself has cases of 2-3 methods (sync.Locker, sort.Interface) that are not composed, and I do that in my code as well some time. but in your case it seems like something is off in the way you&#39;re thinking of interfaces."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "edited": false, "score": 0, "creation_date": 1501415830, "post_id": 45395982, "comment_id": 77759662, "body": "Your code looks remarkably similar to <a href=\"https://youtu.be/ltqV6pDKZD8?t=29m13s\" rel=\"nofollow noreferrer\">this example</a>\u2026 Watch about 3 minutes of it to understand why it&#39;s considered an anti-pattern. That doesn&#39;t mean it&#39;s wrong. It&#39;s just a lot of methods required for a type to implement a single interface, which might beg questions like: Is this an interface just to have an interface to pass around to avoid relying on concrete types? Do all the methods of this interface really need to be in this interface?"}, {"owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1501431005, "post_id": 45395982, "comment_id": 77764153, "body": "@ChronoKitsune its more from the aspect of interchangeability. Its more on the lines of implementing the proxy pattern. My applications to know only about the methods mentioned above in the interface. These methods should never change. What changes is how they are implemented (think 3rd party libraries)."}], "answers": [{"tags": [], "owner": {"reputation": 3589, "user_id": 70603, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/7881f3cacd278fb65ca3342307e4275b?s=128&d=identicon&r=PG", "display_name": "jdizzle", "link": "https://stackoverflow.com/users/70603/jdizzle"}, "is_accepted": false, "score": 6, "last_activity_date": 1501385576, "creation_date": 1501385576, "answer_id": 45396085, "question_id": 45395982, "link": "https://stackoverflow.com/questions/45395982/go-interfaces-with-more-than-one-method-acceptable-or-unacceptable/45396085#45396085", "title": "Go Interfaces with more than one method - Acceptable or unacceptable?", "body": "<p>There's nothing wrong with it, in that the language supports it just fine. </p>\n\n<p>I believe the authors are offering architectural advice based on experience.  Specifically, if your interface has many methods, you likely have the wrong abstraction somewhere.</p>\n\n<p>You can ask yourself some clarifying questions:</p>\n\n<ul>\n<li>How many different implementations of this interface will there be?</li>\n<li>How many of them will have identical method implementations?</li>\n<li>How are the Foos/Bars attached to the implementor?  Would it be simpler to reverse it somehow? eg something like <code>NewFoo(owner FooMgrInterface) *Foo</code></li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1501426587, "post_id": 45400830, "comment_id": 77762725, "body": "You&#39;re right. I am considering breaking it into two interface and one composed interface for them. Thanks for your suggestion."}], "tags": [], "owner": {"reputation": 2301, "user_id": 1168212, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oayHK.jpg?s=128&g=1", "display_name": "Alex Yu", "link": "https://stackoverflow.com/users/1168212/alex-yu"}, "is_accepted": true, "score": 2, "last_activity_date": 1501424697, "creation_date": 1501424697, "answer_id": 45400830, "question_id": 45395982, "link": "https://stackoverflow.com/questions/45395982/go-interfaces-with-more-than-one-method-acceptable-or-unacceptable/45400830#45400830", "title": "Go Interfaces with more than one method - Acceptable or unacceptable?", "body": "<p>Look for inspiration in <a href=\"https://golang.org/src/io/io.go\" rel=\"nofollow noreferrer\">https://golang.org/src/io/io.go</a></p>\n\n<p>You will see: </p>\n\n<p>a. \"Atomic\" interfaces: <code>Reader</code>, <code>Writer</code>, <code>Closer</code>, <code>Seeker</code></p>\n\n<p>b. Composed interfaces: <code>ReaderWriter</code>, <code>ReaderWriterSeeker</code>, <code>ReaderSeekerCloser</code> etc.</p>\n\n<p>Golang will not complaint about gigantic interfaces, it's you and your collegues will have complaints about big monolithic interfaces. </p>\n\n<p>I recomend  divide your interface to 4 (maybe 2) interfaces: <code>FooOps</code>, <code>FoosOps</code>, <code>BarOps</code>, <code>BarsOps</code> and then define composed interfaces from them.</p>\n"}], "owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 367, "favorite_count": 0, "accepted_answer_id": 45400830, "answer_count": 2, "score": 3, "last_activity_date": 1501424697, "creation_date": 1501384181, "question_id": 45395982, "link": "https://stackoverflow.com/questions/45395982/go-interfaces-with-more-than-one-method-acceptable-or-unacceptable", "title": "Go Interfaces with more than one method - Acceptable or unacceptable?", "body": "<p>Is there anything wrong with an interface with more that one function assigned to it ?</p>\n\n<p>Everywhere I read, an interface should ideally have only one method (which is what the interface should be named after). But are there any pit falls to having more than one method for an interface ?\nEx.</p>\n\n<pre><code>type FooMgrInterface interface {\n    CreateFoo(hostname string, fooConfig interface{}) (uuid string, err error)\n    DeleteFoo(hostname string, fooID string) (err error)\n    CreateBar(hostname string, barID string, barConfig interface{}) (uuid string, err error)\n    DeleteBar(hostname string, barID string) (err error)\n    AttachBar(hostname string, fooID string, bars []string) (err error)\n    DetachBar(hostname string, barID string) (err error)\n    GetBars(hostname string) (bars []Bar, err error)\n    GetBar(hostname string, barID string) (bar Bar, err error)\n    GetFoo(hostname string, fooID string) (foo Foo, err error)\n    GetFoos(hostname string) (foos []Foo, err error)\n}\n</code></pre>\n\n<p>If so how could the above interface be simplified or (maybe) split into multiple interfaces ?</p>\n"}, {"tags": ["go", "decorator"], "answers": [{"comments": [{"owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1501383683, "post_id": 45395923, "comment_id": 77752688, "body": "So this would require the type assertion everytime I want to use the decorator ? Seems a little clunky. Is there a way to do something by creating some kind of decorator for <code>func(args...interface{}) (interface{},error)</code> ? I am looking for a generic logging decorator not tied to a specific function signature."}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1501417448, "post_id": 45395923, "comment_id": 77760073, "body": "@nitimalh You can create a function that accepts an arbitrary number of <code>interface{}</code> values, but can you do it for returning 1, 2, 10, etc. values, some also returning <code>bool</code>, <code>error</code>, <code>int</code>, etc.? The gist assumes a single value is returned, but multiple values may be returned by another function. This requires essentially the same code, except the return signature of the function will differ. There&#39;s no way I&#39;m aware of to fix this currently. That doesn&#39;t mean it can&#39;t be done of course. I just can&#39;t conceive a viable implementation."}, {"owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1501426690, "post_id": 45395923, "comment_id": 77762754, "body": "Yea I agree. That is the dilemma. I need to implement a generic logging decorator. Maybe there are some other patterns/tricks to acheive this ?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user539810"}, "reply_to_user": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "edited": false, "score": 0, "creation_date": 1501427961, "post_id": 45395923, "comment_id": 77763215, "body": "@nitimalh Code generation, as is the norm in Go for things like this? It&#39;s like the preprocessor in C: you&#39;re basically metaprogramming to create another part of your program. The Go equivalent of the C preprocessor is you, which is why many continue to argue for generics in Go 2. Perhaps if you can answer why you need such a function, you&#39;ll get more useful responses sans generics. :("}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 1, "last_activity_date": 1501383430, "creation_date": 1501383430, "answer_id": 45395923, "question_id": 45395861, "link": "https://stackoverflow.com/questions/45395861/a-generic-golang-decorator-clarification-needed-for-a-gist/45395923#45395923", "title": "A generic golang decorator (clarification needed for a gist)", "body": "<p>The variable <code>inner</code> is declared using a <a href=\"https://golang.org/ref/spec#Short_variable_declarations\" rel=\"nofollow noreferrer\">short variable declaration</a>.  The variable <code>inner</code> has type <code>func(in []reflect.Value) []reflect.Value</code>. The value is the function literal in the code.</p>\n\n<p>The type  <code>func(in []reflect.Value) []reflect.Value</code> represents a generic function implemented by reflection. The function takes a possibly empty slice of arguments and returns a possibly empty slice of results.</p>\n\n<p>The <code>reflect.Value</code> for a function is not directly callable. The <code>Call</code> method is used to call the function in the value.</p>\n\n<p>The <code>.(func(a, b int) int)</code> is a type assertion.</p>\n"}], "owner": {"reputation": 751, "user_id": 3657373, "user_type": "registered", "accept_rate": 70, "profile_image": "https://i.stack.imgur.com/baHlx.jpg?s=128&g=1", "display_name": "nitimalh", "link": "https://stackoverflow.com/users/3657373/nitimalh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1266, "favorite_count": 0, "accepted_answer_id": 45395923, "answer_count": 1, "score": 0, "last_activity_date": 1501383430, "creation_date": 1501382440, "last_edit_date": 1501383118, "question_id": 45395861, "link": "https://stackoverflow.com/questions/45395861/a-generic-golang-decorator-clarification-needed-for-a-gist", "title": "A generic golang decorator (clarification needed for a gist)", "body": "<p>Can someone explain what is happening in this gist ? I understand the concept of decorators and how this implementation lets one create a generic decorator, but I am little lost in a few sections (commented inline). Would really appreciate if someone could break it down for me.\nAlso if this isnt the best way to write a generic decorator, what is ? I am looking for a decorator that can decorate a function of type func(args...interface{}) (interface{},error) without throwing away type safety.</p>\n\n<p><a href=\"https://gist.github.com/saelo/4190b75724adc06b1c5a\" rel=\"nofollow noreferrer\">https://gist.github.com/saelo/4190b75724adc06b1c5a</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc Decorate(impl interface{}) interface{} {\n        fn := reflect.ValueOf(impl)\n        //What does inner do ? What is this codeblock ?\n        inner := func(in []reflect.Value) []reflect.Value { //Why does this return the same type as the parameters passed to the function ? Does this mean this decorator only works for fns with signature func (arg TypeA) TypeA and not func (arg TypeA) TypeB ?\n            f := reflect.ValueOf(impl)\n\n            fmt.Println(\"Stuff before\")\n            // ...\n\n            ret := f.Call(in) //What does call do ? Why cant we just use f(in) ?\n\n            fmt.Println(\"Stuff after\")\n            // ...\n\n            return ret\n        }\n\n        v := reflect.MakeFunc(fn.Type(), inner)\n\n        return v.Interface()\n}\n\nvar Add = Decorate(\n    func (a, b int) int {\n        return a + b\n    },\n).(func(a, b int) int) //Is this a type assertion ?\n\n\n\nfunc main() {\n    fmt.Println(Add(1, 2))\n}\n</code></pre>\n"}, {"tags": ["go", "random"], "comments": [{"owner": {"reputation": 11590, "user_id": 54467, "user_type": "registered", "accept_rate": 82, "profile_image": "https://i.stack.imgur.com/RnwJd.jpg?s=128&g=1", "display_name": "Kaveh Shahbazian", "link": "https://stackoverflow.com/users/54467/kaveh-shahbazian"}, "edited": false, "score": 1, "creation_date": 1501416237, "post_id": 45394684, "comment_id": 77759770, "body": "Default random number generators in all programming languages, produce the same sequence with a specific seed number. Because these packages are meant to be used mainly for testing algorithms (when we need to check the result against the same input) or just as a semi-random number when used with time element. If you want a real random number, you should use the one from crypto package."}], "answers": [{"comments": [{"owner": {"reputation": 1413, "user_id": 7474529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10154971830248249/picture?type=large", "display_name": "&#214;zg&#252;r Yal&#231;\u0131n", "link": "https://stackoverflow.com/users/7474529/%c3%96zg%c3%bcr-yal%c3%a7%c4%b1n"}, "edited": false, "score": 0, "creation_date": 1501368314, "post_id": 45394743, "comment_id": 77750199, "body": "<a href=\"https://play.golang.org/p/E_Wfm5tOdH\" rel=\"nofollow noreferrer\">play.golang.org/p/E_Wfm5tOdH</a> -  <a href=\"https://play.golang.org/p/aVWIN1Eb84\" rel=\"nofollow noreferrer\">play.golang.org/p/aVWIN1Eb84</a> there is no change. now both of links always returns 452000"}, {"owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "reply_to_user": {"reputation": 1413, "user_id": 7474529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10154971830248249/picture?type=large", "display_name": "&#214;zg&#252;r Yal&#231;\u0131n", "link": "https://stackoverflow.com/users/7474529/%c3%96zg%c3%bcr-yal%c3%a7%c4%b1n"}, "edited": false, "score": 1, "creation_date": 1501368878, "post_id": 45394743, "comment_id": 77750308, "body": "Correct, because <code>time.Now()</code> will always return the same value in every playground to make it deterministic. Try printing that value out and you&#39;ll see why. You have to try it from your machine."}, {"owner": {"reputation": 1413, "user_id": 7474529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10154971830248249/picture?type=large", "display_name": "&#214;zg&#252;r Yal&#231;\u0131n", "link": "https://stackoverflow.com/users/7474529/%c3%96zg%c3%bcr-yal%c3%a7%c4%b1n"}, "edited": false, "score": 0, "creation_date": 1501369142, "post_id": 45394743, "comment_id": 77750362, "body": "Ok, i got it. The problem is resolved. Thanks for your answer."}, {"owner": {"reputation": 156, "user_id": 2072030, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/hAv1U.jpg?s=128&g=1", "display_name": "Vishwa", "link": "https://stackoverflow.com/users/2072030/vishwa"}, "edited": false, "score": 0, "creation_date": 1575972219, "post_id": 45394743, "comment_id": 104737233, "body": "Despite of using <code>rand.Seed(time.Now().UnixNano())</code> it gives the same result even if  I hit &quot;<b>Run</b>&quot; multiple times. In the playground, it also says <i>&quot;Time is constant in the playground&quot;</i> so I assume <code>rand.Seed(time.Now().UnixNano())</code> will give same value everytime."}, {"owner": {"reputation": 765, "user_id": 803990, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/a3ac59c0c88ed76f18d96488ac9cd9a5?s=128&d=identicon&r=PG", "display_name": "Bj&#248;rn Kjos-Hanssen", "link": "https://stackoverflow.com/users/803990/bj%c3%b8rn-kjos-hanssen"}, "edited": false, "score": 0, "creation_date": 1589417384, "post_id": 45394743, "comment_id": 109289510, "body": "Interestingly, on Google App Engine there is no problem (the random numbers are different every time) even without doing this."}], "tags": [], "owner": {"reputation": 16564, "user_id": 1261399, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/679444399bbf92e3a5d3f16347809f3f?s=128&d=identicon&r=PG", "display_name": "Leo Correa", "link": "https://stackoverflow.com/users/1261399/leo-correa"}, "is_accepted": true, "score": 16, "last_activity_date": 1501368893, "last_edit_date": 1501368893, "creation_date": 1501368202, "answer_id": 45394743, "question_id": 45394684, "link": "https://stackoverflow.com/questions/45394684/random-number-issue-in-golang/45394743#45394743", "title": "Random number issue in golang", "body": "<p>A couple of reasons why you'll see the same result in the playground</p>\n\n<ol>\n<li>Golang playground will cache the results </li>\n<li>The time in the playground always starts at the same time to make the playground deterministic. </li>\n</ol>\n\n<p>Last but not least, the <code>rand</code> package default seed is <code>1</code> which will make the result deterministic. If you place a <code>rand.Seed(time.Now().UnixNano())</code> you'll receive different results at each execution. Note that this won't work on the playground for the second reason above. </p>\n"}], "owner": {"reputation": 1413, "user_id": 7474529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10154971830248249/picture?type=large", "display_name": "&#214;zg&#252;r Yal&#231;\u0131n", "link": "https://stackoverflow.com/users/7474529/%c3%96zg%c3%bcr-yal%c3%a7%c4%b1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2523, "favorite_count": 0, "accepted_answer_id": 45394743, "answer_count": 1, "score": 6, "last_activity_date": 1501400705, "creation_date": 1501367648, "last_edit_date": 1501400705, "question_id": 45394684, "link": "https://stackoverflow.com/questions/45394684/random-number-issue-in-golang", "title": "Random number issue in golang", "body": "<p>This is the code I'm working with:</p>\n\n<pre><code>package main\nimport \"fmt\"\nimport \"math/rand\"\n\nfunc main() {\n    code := rand.Intn(900000)\n    fmt.Println(code)\n}\n</code></pre>\n\n<p>It always returns <code>698081</code>. I don't understand, what the is problem?</p>\n\n<blockquote>\n  <p><a href=\"https://play.golang.org/p/XisNbqCZls\" rel=\"noreferrer\">https://play.golang.org/p/XisNbqCZls</a></p>\n</blockquote>\n\n<p><strong>Edit</strong>:</p>\n\n<p>I tried <code>rand.Seed</code></p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"time\"\nimport \"math/rand\"\n\nfunc main() {\n    rand.Seed(time.Now().UnixNano())\n    code := rand.Intn(900000)\n    fmt.Println(code)\n}\n</code></pre>\n\n<p>There is no change. Now it always returns <code>452000</code></p>\n\n<blockquote>\n  <p><a href=\"https://play.golang.org/p/E_Wfm5tOdH\" rel=\"noreferrer\">https://play.golang.org/p/E_Wfm5tOdH</a></p>\n  \n  <p><a href=\"https://play.golang.org/p/aVWIN1Eb84\" rel=\"noreferrer\">https://play.golang.org/p/aVWIN1Eb84</a></p>\n</blockquote>\n"}, {"tags": ["go", "command-line"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1501347274, "post_id": 45391686, "comment_id": 77744142, "body": "You&#39;re importing the &quot;testing&quot; package."}, {"owner": {"reputation": 1815, "user_id": 820520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d83b63db79b42978fe35e120550ca180?s=128&d=identicon&r=PG", "display_name": "melekes", "link": "https://stackoverflow.com/users/820520/melekes"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1501347762, "post_id": 45391686, "comment_id": 77744304, "body": "<a href=\"https://github.com/tendermint/tools/blob/develop/tm-bench/main.go\" rel=\"nofollow noreferrer\">github.com/tendermint/tools/blob/develop/tm-bench/main.go</a> don&#39;t think so... but it certainly looks like the testing package is messing things up"}, {"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1501348065, "post_id": 45391686, "comment_id": 77744407, "body": "What is the exact command line you build your binary with?"}, {"owner": {"reputation": 1815, "user_id": 820520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d83b63db79b42978fe35e120550ca180?s=128&d=identicon&r=PG", "display_name": "melekes", "link": "https://stackoverflow.com/users/820520/melekes"}, "edited": false, "score": 0, "creation_date": 1501350324, "post_id": 45391686, "comment_id": 77745145, "body": "I am using <code>go build</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 1, "creation_date": 1501357085, "post_id": 45391686, "comment_id": 77747193, "body": "The program indirectly imports <code>github.com&#47;tendermint&#47;tmlibs&#47;log</code>  which imports the <code>testing</code> package.  Find a way to break the dependency on the the <code>testing</code> package."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1501359096, "post_id": 45391686, "comment_id": 77747866, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/42243919/using-go-build-but-i-also-see-the-test-flags/42244265#42244265\">Using go build but I also see the -test flags</a>."}], "answers": [{"tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": true, "score": 1, "last_activity_date": 1501364322, "creation_date": 1501364322, "answer_id": 45394312, "question_id": 45391686, "link": "https://stackoverflow.com/questions/45391686/flag-printdefaults-includes-test-flags/45394312#45394312", "title": "flag.PrintDefaults includes `-test` flags", "body": "<p>As I can see you have a bunch f dependencies in your code. I have found that library <code>github.com/tendermint/tmlibs/log</code> has a dependency to a package <code>testing</code> from standard library: <a href=\"https://github.com/tendermint/tmlibs/search?utf8=%E2%9C%93&amp;q=testing&amp;type=\" rel=\"nofollow noreferrer\">searches for testing</a>. And this standard library has all flags you are wondered about: <a href=\"https://golang.org/src/testing/testing.go\" rel=\"nofollow noreferrer\">testing package</a></p>\n"}], "owner": {"reputation": 1815, "user_id": 820520, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/d83b63db79b42978fe35e120550ca180?s=128&d=identicon&r=PG", "display_name": "melekes", "link": "https://stackoverflow.com/users/820520/melekes"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 500, "favorite_count": 0, "accepted_answer_id": 45394312, "answer_count": 1, "score": 2, "last_activity_date": 1501364322, "creation_date": 1501346613, "last_edit_date": 1501347841, "question_id": 45391686, "link": "https://stackoverflow.com/questions/45391686/flag-printdefaults-includes-test-flags", "title": "flag.PrintDefaults includes `-test` flags", "body": "<p>I am building a CLI application in Go.</p>\n\n<pre><code>flag.IntVar(&amp;connections, \"c\", 1, \"Connections to keep open per endpoint\")\nflag.IntVar(&amp;duration, \"T\", 10, \"Exit after the specified amount of time in seconds\")\nflag.IntVar(&amp;txsRate, \"r\", 1000, \"Txs per second to send in a connection\")\nflag.BoolVar(&amp;verbose, \"v\", false, \"Verbose output\")\n\nflag.Usage = func() {\n    fmt.Println(`....`)\n    fmt.Println(\"Flags:\")\n    flag.PrintDefaults()\n}\n\nflag.Parse()\n\nif flag.NArg() == 0 {\n    flag.Usage()\n    os.Exit(1)\n}\n</code></pre>\n\n<p>(<a href=\"https://github.com/tendermint/tools/blob/develop/tm-bench/main.go\" rel=\"nofollow noreferrer\">Full listing on Github</a>)</p>\n\n<p>For some strange reason, the above snippet produces:</p>\n\n<pre><code>Flags:\n\n\n-T int\n        Exit after the specified amount of time in seconds (default 10)\n  -c int\n        Connections to keep open per endpoint (default 1)\n  -r int\n        Txs per second to send in a connection (default 1000)\n  -test.bench regexp\n        run only benchmarks matching regexp\n  -test.benchmem\n        print memory allocations for benchmarks\n  -test.benchtime d\n        run each benchmark for duration d (default 1s)\n  -test.blockprofile file\n        write a goroutine blocking profile to file\n  -test.blockprofilerate rate\n        set blocking profile rate (see runtime.SetBlockProfileRate) (default 1)\n  -test.count n\n        run tests and benchmarks n times (default 1)\n  -test.coverprofile file\n        write a coverage profile to file\n  -test.cpu list\n        comma-separated list of cpu counts to run each test with\n  -test.cpuprofile file\n        write a cpu profile to file\n  -test.memprofile file\n        write a memory profile to file\n  -test.memprofilerate rate\n        set memory profiling rate (see runtime.MemProfileRate)\n  -test.mutexprofile string\n        write a mutex contention profile to the named file after execution\n  -test.mutexprofilefraction int\n        if &gt;= 0, calls runtime.SetMutexProfileFraction() (default 1)\n  -test.outputdir dir\n        write profiles to dir\n  -test.parallel n\n        run at most n tests in parallel (default 2)\n  -test.run regexp\n        run only tests and examples matching regexp\n  -test.short\n        run smaller test suite to save time\n  -test.timeout d\n        fail test binary execution after duration d (0 means unlimited)\n  -test.trace file\n        write an execution trace to file\n  -test.v\n        verbose: print additional output\n  -v    Verbose output\n</code></pre>\n\n<p>Any ideas why Go includes <code>-test</code> flags? Thanks!</p>\n"}, {"tags": ["go", "concatenation", "go-templates"], "answers": [{"comments": [{"owner": {"reputation": 7876, "user_id": 2777965, "user_type": "registered", "accept_rate": 89, "profile_image": "https://i.stack.imgur.com/tQaGa.png?s=128&g=1", "display_name": "030", "link": "https://stackoverflow.com/users/2777965/030"}, "edited": false, "score": 0, "creation_date": 1584995510, "post_id": 45390194, "comment_id": 107608600, "body": "see also @gyoza <a href=\"https://github.com/hashicorp/consul-template/issues/267#issuecomment-386416693\" rel=\"nofollow noreferrer\">github.com/hashicorp/consul-template/issues/&hellip;</a>"}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 17, "last_activity_date": 1501337576, "last_edit_date": 1501337576, "creation_date": 1501337288, "answer_id": 45390194, "question_id": 45389802, "link": "https://stackoverflow.com/questions/45389802/is-there-an-efficient-way-to-concatenate-strings/45390194#45390194", "title": "Is there an efficient way to concatenate strings", "body": "<p>There is not a way to concatenate strings with an operator because Go templates do not have operators.</p>\n\n<p>Use the <code>printf</code> function as shown in the question or combine the calls in a single template expression:</p>\n\n<pre><code>{{ TestFunc (printf \"%s%s\" \"x\" \"y\") }}\n</code></pre>\n\n<p>If you always need to concatenate strings for the TestFunc argument, then write TestFunc to handle the concatenation:</p>\n\n<pre><code>func TestFunc(strs ...string) string {\n   return strings.Trim(strings.Join(strs, \"\"), \" \")\n}\n\n{{ TestFunc \"x\"  $var }}\n</code></pre>\n"}], "owner": {"reputation": 1413, "user_id": 7474529, "user_type": "registered", "accept_rate": 100, "profile_image": "https://graph.facebook.com/10154971830248249/picture?type=large", "display_name": "&#214;zg&#252;r Yal&#231;\u0131n", "link": "https://stackoverflow.com/users/7474529/%c3%96zg%c3%bcr-yal%c3%a7%c4%b1n"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 12224, "favorite_count": 8, "accepted_answer_id": 45390194, "answer_count": 1, "score": 11, "last_activity_date": 1608301826, "creation_date": 1501334728, "last_edit_date": 1608301826, "question_id": 45389802, "link": "https://stackoverflow.com/questions/45389802/is-there-an-efficient-way-to-concatenate-strings", "title": "Is there an efficient way to concatenate strings", "body": "<p>For example, there is a function like that:</p>\n\n<pre><code> func TestFunc(str string) string {\n return strings.Trim(str,\" \")\n }\n</code></pre>\n\n<p>It runs in the example below:</p>\n\n<pre><code> {{ $var := printf \"%s%s\" \"x\" \"y\" }}\n {{ TestFunc $var }}\n</code></pre>\n\n<p>Is there anyway to concatenate strings with operators in template ?</p>\n\n<pre><code> {{ $var := \"y\" }}\n {{ TestFunc \"x\" + $var }}\n</code></pre>\n\n<p>or</p>\n\n<pre><code> {{ $var := \"y\" }}\n {{ TestFunc \"x\" + {$var} }}\n</code></pre>\n\n<p>It gives unexpected \"+\" in operand error.</p>\n\n<p>I couldnt find it in documentation (<a href=\"https://golang.org/pkg/text/template/\" rel=\"noreferrer\">https://golang.org/pkg/text/template/</a>) </p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 1, "creation_date": 1501348180, "post_id": 45389410, "comment_id": 77744434, "body": "And I need free beer for the rest of my life. ;) I save money. What have you tried so far?"}, {"owner": {"reputation": 1177, "user_id": 4564156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff0db7eb380f134a95557e70d57e582?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsenasm", "link": "https://stackoverflow.com/users/4564156/mohsenasm"}, "reply_to_user": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "edited": false, "score": 0, "creation_date": 1501350025, "post_id": 45389410, "comment_id": 77745044, "body": "@markus-w-mahlberg I have tried using runCommand but there is only &quot;createIndexes&quot; command that want a list of &quot;index specs&quot;. And I have no idea what is that.."}], "answers": [{"tags": [], "owner": {"reputation": 17024, "user_id": 1296707, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/cc4319dbdd4adbb6d25f1eb2309eec20?s=128&d=identicon&r=PG", "display_name": "Markus W Mahlberg", "link": "https://stackoverflow.com/users/1296707/markus-w-mahlberg"}, "is_accepted": true, "score": 3, "last_activity_date": 1501415592, "creation_date": 1501415592, "answer_id": 45399504, "question_id": 45389410, "link": "https://stackoverflow.com/questions/45389410/how-to-create-hashed-index-by-mgo-golang/45399504#45399504", "title": "How to create hashed index by mgo (golang)", "body": "<p>You can do it as documented at <a href=\"https://godoc.org/labix.org/v2/mgo#Collection.EnsureIndex\" rel=\"nofollow noreferrer\"><strong><code>Collection.EnsureIndex</code></strong></a>:</p>\n\n<blockquote>\n  <p>Other kinds of indexes are also supported through that API. Here is an example:</p>\n</blockquote>\n\n<pre><code>index := Index{\n    Key: []string{\"$2d:loc\"},\n    Bits: 26,\n}\nerr := collection.EnsureIndex(index)\n</code></pre>\n\n<blockquote>\n  <p>The example above requests the creation of a \"2d\" index for the \"loc\" field.</p>\n</blockquote>\n\n<p>So basically, you have the format <strong><code>$&lt;indexType&gt;:&lt;indexedField&gt;</code></strong>, as shown below:</p>\n\n<pre><code>package main\n\nimport mgo \"gopkg.in/mgo.v2\"\n\nconst (\n    db   = \"so_hashed_idx\"\n    coll = \"testcoll\"\n)\n\nfunc main() {\n    var s *mgo.Session\n    var err error\n\n    if s, err = mgo.Dial(\"127.0.0.1:27017\"); err != nil {\n        panic(err)\n    }\n\n    // An index spec is nothing more than a fancy word for the keys\n    // or the key/value pairs handed over to the Key slice of the\n    // Index type.\n    idx := mgo.Index{\n        Key: []string{\"$hashed:_id\"},\n    }\n\n    if err := s.DB(db).C(coll).EnsureIndex(idx); err != nil {\n        panic(err)\n    }\n}\n</code></pre>\n\n<p>Building and running the above results in <code>so_hashed_idx.testcoll</code> showing its indices as follows</p>\n\n<pre><code>&gt; db.testcoll.getIndices()\n[\n    {\n        \"v\" : 1,\n        \"key\" : {\n            \"_id\" : 1\n        },\n        \"name\" : \"_id_\",\n        \"ns\" : \"so_hashed_idx.testcoll\"\n    },\n    {\n        \"v\" : 1,\n        \"key\" : {\n            \"_id\" : \"hashed\"\n        },\n        \"name\" : \"_id_hashed\",\n        \"ns\" : \"so_hashed_idx.testcoll\"\n    }\n]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1177, "user_id": 4564156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff0db7eb380f134a95557e70d57e582?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsenasm", "link": "https://stackoverflow.com/users/4564156/mohsenasm"}, "is_accepted": false, "score": 2, "last_activity_date": 1501417066, "last_edit_date": 1501417066, "creation_date": 1501416133, "answer_id": 45399598, "question_id": 45389410, "link": "https://stackoverflow.com/questions/45389410/how-to-create-hashed-index-by-mgo-golang/45399598#45399598", "title": "How to create hashed index by mgo (golang)", "body": "<p>An answer with <code>runCommand</code>:</p>\n\n<pre><code>func createHashedIndex(session *mgo.Session, collectionName string, indexKey string){\n    var result interface{}\n    if err := session.Run(bson.D{\n        {\"createIndexes\", collectionName},\n        {\"indexes\", []bson.M{bson.M{\"name\": indexKey+\"_hashed_index\", \"key\": bson.M{indexKey: \"hashed\"}}}}}, &amp;result); err != nil {\n        fmt.Println(\"Create Index Error:\", err.Error())\n    } else {\n        fmt.Println(\"Create Index:\", result)\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 1177, "user_id": 4564156, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff0db7eb380f134a95557e70d57e582?s=128&d=identicon&r=PG&f=1", "display_name": "Mohsenasm", "link": "https://stackoverflow.com/users/4564156/mohsenasm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1333, "favorite_count": 0, "accepted_answer_id": 45399504, "answer_count": 2, "score": 2, "last_activity_date": 1501516359, "creation_date": 1501332077, "last_edit_date": 1501516359, "question_id": 45389410, "link": "https://stackoverflow.com/questions/45389410/how-to-create-hashed-index-by-mgo-golang", "title": "How to create hashed index by mgo (golang)", "body": "<p>How can I create (or ensure) hashed index with <a href=\"https://github.com/go-mgo/mgo\" rel=\"nofollow noreferrer\">mgo</a> package?</p>\n\n<p>I need a go code to be equivalent with this:</p>\n\n<pre><code>&gt;&gt; db.collection.createIndex( { _id: \"hashed\" } )\n</code></pre>\n\n<p>I have tried using runCommand but there is only \u200d<code>createIndexes</code> command that want a list of <code>index specs</code>. And I have no idea what is that and how I can create <code>index specs</code>.</p>\n"}, {"tags": ["mysql", "sql", "go"], "comments": [{"owner": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 1, "creation_date": 1501329317, "post_id": 45388963, "comment_id": 77738471, "body": "Your interface only allows one query to be passed in.  I would suggest that you learn to use proper parameters for the interface you are using."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1501329463, "post_id": 45388963, "comment_id": 77738500, "body": "Oh good catch, I meant to put a <code>?</code> in the place of the <code>%s</code>. Just updated in my code as well as the question. Still getting the same error."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "reply_to_user": {"reputation": 1106495, "user_id": 1144035, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e514b017977ebf742a418cac697d8996?s=128&d=identicon&r=PG", "display_name": "Gordon Linoff", "link": "https://stackoverflow.com/users/1144035/gordon-linoff"}, "edited": false, "score": 0, "creation_date": 1501329553, "post_id": 45388963, "comment_id": 77738521, "body": "Also changed <code>@query</code> to <code>@searchString</code> as that may confuse things, I was not trying to put a query into a query."}, {"owner": {"reputation": 887, "user_id": 4725687, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/q13D7.jpg?s=128&g=1", "display_name": "Kamesh", "link": "https://stackoverflow.com/users/4725687/kamesh"}, "edited": false, "score": 0, "creation_date": 1501329570, "post_id": 45388963, "comment_id": 77738531, "body": "WHERE user_tax.user_id = ? What does this &#39;?&#39; signifies?"}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 0, "creation_date": 1501329604, "post_id": 45388963, "comment_id": 77738543, "body": "why You&#39;re using <code>?</code> are You using php pdo or something else to query db?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501329605, "post_id": 45388963, "comment_id": 77738544, "body": "The ? will be converted to a value, it represents an integer."}, {"owner": {"reputation": 4163, "user_id": 6401403, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5e6e113b3335b200f4d4946e1bcaff84?s=128&d=identicon&r=PG&f=1", "display_name": "Michael O.", "link": "https://stackoverflow.com/users/6401403/michael-o"}, "edited": false, "score": 0, "creation_date": 1501329624, "post_id": 45388963, "comment_id": 77738553, "body": "What language are you using to bind values?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501329659, "post_id": 45388963, "comment_id": 77738564, "body": "Updated question with comment on the <code>?</code>"}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 0, "creation_date": 1501329694, "post_id": 45388963, "comment_id": 77738572, "body": "simpy do <code>(tax.name LIKE ? OR tax.rate LIKE ?)</code> and pass Your <code>%s%</code> as bind parameter"}, {"owner": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "edited": false, "score": 0, "creation_date": 1501329759, "post_id": 45388963, "comment_id": 77738596, "body": "The <code>?</code> will not be converted to a value if it is part of a string. You need to use it as <code>tax.name LIKE ?</code> and then bind <code>&#39;%yourSearchString%&#39;</code>."}], "answers": [{"comments": [{"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501330059, "post_id": 45389058, "comment_id": 77738683, "body": "Yes, this will work... but is there not a way to not have to pass in <code>query</code> N times? What if I have like 30 columns... this is why I was trying to set the variable in the query so I only have to bind to one thing and then re-use it."}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 1, "creation_date": 1501330135, "post_id": 45389058, "comment_id": 77738706, "body": "@Lansana are You joking? When You have strict sql query why to think about dynamical moments?"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501330201, "post_id": 45389058, "comment_id": 77738728, "body": "Well this is coming from someone with minimal SQL experience, but typically in programming I can memoize a value and use that to keep things DRY. I guess that is not how it works in SQL?"}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 1, "creation_date": 1501330295, "post_id": 45389058, "comment_id": 77738754, "body": "@Lansana sql query is simple think. You can do DRY in <code>go</code> part, but query must be strict formed to avoid unexpectedness"}, {"owner": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 1, "creation_date": 1501330376, "post_id": 45389058, "comment_id": 77738771, "body": "@Lansana you can bind it once in a cross joined subquery and then reuse it."}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501330436, "post_id": 45389058, "comment_id": 77738794, "body": "@Lansana I&#39;m writing from phone, so please check my second example, hope it will work"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501330499, "post_id": 45389058, "comment_id": 77738812, "body": "Yes your first example works, I am testing out the second one now. Will accept answer after tests. Thanks for explanation. I am still learning SQL, I suppose I shouldn&#39;t bring other programming concepts to it."}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 0, "creation_date": 1501330552, "post_id": 45389058, "comment_id": 77738829, "body": "For situations when You need complex things to be DRY there are <code>stored procedures, stored functions, views</code> in mysql (;  but it&#39;s not recommended to use them everywhere - because it hides business logic from code, so need to care to keep them in easily readable place"}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "edited": false, "score": 0, "creation_date": 1501330805, "post_id": 45389058, "comment_id": 77738909, "body": "btw for DRY and etc there are ORM&#39;s that may have models which can keep repeating things"}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501331197, "post_id": 45389058, "comment_id": 77739028, "body": "Yes, I&#39;m not a fan of ORM&#39;s because they can be limiting. <a href=\"http://jmoiron.github.io/sqlx/#namedParams\" rel=\"nofollow noreferrer\">This is the SQL driver</a> I am using, apparently there is a way for named parameters. Going to look into that, accepting answer though cause leads me in right direction."}, {"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501331317, "post_id": 45389058, "comment_id": 77739065, "body": "@Lansana (: <code>it can be limiting</code>- not always, also ORM&#39;s have ability to pass sql query into model method. But nevermind, as You wish (:"}], "tags": [], "owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "is_accepted": true, "score": 1, "last_activity_date": 1501330755, "last_edit_date": 1501330755, "creation_date": 1501329827, "answer_id": 45389058, "question_id": 45388963, "link": "https://stackoverflow.com/questions/45388963/mysql-error-1064-search-query-not-working-as-expected/45389058#45389058", "title": "MySQL error 1064: search query not working as expected", "body": "<p>I don't understand why to do <code>SET @query</code> and pass it inside of it when You can do it by using bind parameter using <code>?</code>.</p>\n\n<p>So here is solution (I'm not familiar with <code>go</code> so please sorry if something wrong with <code>go</code> code):</p>\n\n<pre><code>var taxes []Tax\nquery := \"%something%youre%looking%for%\"\nerr := r.db.Select(&amp;taxes, `\n\n    SELECT tax.*\n    FROM tax\n    JOIN user_tax\n        ON user_tax.tax_id = tax.id\n    WHERE user_tax.user_id = ?\n        AND tax.deleted_at IS NULL\n        AND user_tax.deleted_at IS NULL\n        AND (\n              tax.name LIKE ? \n              OR \n              tax.rate LIKE ?\n            )\n\n`, q, userId, query, query)\n</code></pre>\n\n<p>OR try this (I'm not sure if it will work) :</p>\n\n<pre><code>var taxes []Tax\nquery := \"something\"\nerr := r.db.Select(&amp;taxes, `\n    SET @query = CONCAT('%', ?, '%');\n\n    SELECT tax.*\n    FROM tax\n    JOIN user_tax\n        ON user_tax.tax_id = tax.id\n    WHERE user_tax.user_id = ?\n        AND tax.deleted_at IS NULL\n        AND user_tax.deleted_at IS NULL\n        AND (\n              tax.name LIKE @query\n              OR \n              tax.rate LIKE @query\n            )\n\n`, q, query, userId)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 56338, "user_id": 4265352, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lzAUc5pYb24/AAAAAAAAAAI/AAAAAAAAAGQ/q3h7bZUnqrs/photo.jpg?sz=128", "display_name": "axiac", "link": "https://stackoverflow.com/users/4265352/axiac"}, "is_accepted": false, "score": 1, "last_activity_date": 1501330948, "creation_date": 1501330948, "answer_id": 45389244, "question_id": 45388963, "link": "https://stackoverflow.com/questions/45388963/mysql-error-1064-search-query-not-working-as-expected/45389244#45389244", "title": "MySQL error 1064: search query not working as expected", "body": "<p>The syntax errors reported by MySQL contain the magic words <strong>\"check the manual that corresponds to your MySQL server version for the right syntax to use near '\"</strong> followed by the trailing part of the query that doesn't fit with the leading part that was already parsed and found as correct.</p>\n\n<p>When the part of the query reported in the error message doesn't look incorrect, something is usually missing just before it.</p>\n\n<p>In your case it seems nothing is missing and this leads to a single conclusion: you try to run two queries (correctly separated by <code>;</code>) but the library you use to send queries to the server doesn't know that and thinks it is only one query. The same happens on the other side of the connection and the MySQL server simply reports as \"Syntax error\" everything it founds after the first query (and its terminating <code>;</code>).</p>\n\n<p>Don't send two queries in a single call or use a call that allows multiple queries in the same string (if such a call is provided by the library).</p>\n"}, {"comments": [{"owner": {"reputation": 15778, "user_id": 3706693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c23cb4348804fbc993d70df4cab71fc?s=128&d=identicon&r=PG", "display_name": "num8er", "link": "https://stackoverflow.com/users/3706693/num8er"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501331413, "post_id": 45389288, "comment_id": 77739096, "body": "@Lansana I see simple solution that You want. Nice!"}, {"owner": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "reply_to_user": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501331807, "post_id": 45389288, "comment_id": 77739199, "body": "@Lansana - I don&#39;t expect any performance issues. The subquery should be executed only once."}, {"owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "edited": false, "score": 0, "creation_date": 1501331845, "post_id": 45389288, "comment_id": 77739206, "body": "@PaulSpiegel This query gives me an error. <code>Error 1267: Illegal mix of collations (latin1_swedish_ci,IMPLICIT) and (utf8mb4_general_ci,COERCIBLE) for operation &#39;like&#39;</code> -- using same exact query as you."}, {"owner": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "edited": false, "score": 0, "creation_date": 1501332805, "post_id": 45389288, "comment_id": 77739512, "body": "This is bad. Looks like the collation of your connection doesn&#39;t match that of the column. I&#39;m not sure what to do in this case, since I always try to use UTF-8 everywhere."}], "tags": [], "owner": {"reputation": 27828, "user_id": 5563083, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab25f269dc3fd3b4a657ddd27cf8f349?s=128&d=identicon&r=PG&f=1", "display_name": "Paul Spiegel", "link": "https://stackoverflow.com/users/5563083/paul-spiegel"}, "is_accepted": false, "score": 2, "last_activity_date": 1501331239, "creation_date": 1501331239, "answer_id": 45389288, "question_id": 45388963, "link": "https://stackoverflow.com/questions/45388963/mysql-error-1064-search-query-not-working-as-expected/45389288#45389288", "title": "MySQL error 1064: search query not working as expected", "body": "<p>If you want to avoid binding the same value multiple times, you can bind it in a cross joined subquery once and reuse the value:</p>\n\n<pre><code>SELECT tax.*\nFROM tax\nJOIN user_tax\n    ON user_tax.tax_id = tax.id\nCROSS JOIN (SELECT ? as q) sub\nWHERE user_tax.user_id = ?\n    AND tax.deleted_at IS NULL\n    AND user_tax.deleted_at IS NULL\n    AND (tax.name LIKE sub.q\n         OR tax.rate LIKE sub.q)\n</code></pre>\n\n<p>Now just bind <code>%s%</code> as the first parameter.</p>\n"}], "owner": {"reputation": 8115, "user_id": 4749297, "user_type": "registered", "accept_rate": 66, "profile_image": "https://i.stack.imgur.com/LXTZX.jpg?s=128&g=1", "display_name": "Lansana Camara", "link": "https://stackoverflow.com/users/4749297/lansana-camara"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 186, "favorite_count": 0, "accepted_answer_id": 45389058, "answer_count": 3, "score": 0, "last_activity_date": 1501331239, "creation_date": 1501329170, "last_edit_date": 1501329641, "question_id": 45388963, "link": "https://stackoverflow.com/questions/45388963/mysql-error-1064-search-query-not-working-as-expected", "title": "MySQL error 1064: search query not working as expected", "body": "<p>I am attempting to write a query for searching on a table, but I am getting the generic 1064 MySQL syntax error. I don't see anything wrong with my query... in fact, I have another query just like it that works fine.</p>\n\n<p>The queries are using an SQL driver in Go, all of the <code>?</code> will be converted to values before the query is ran.</p>\n\n<p>This is my error:</p>\n\n<blockquote>\n  <p>Error 1064: You have an error in your SQL syntax; check the manual that corresponds to your MySQL server version for the right syntax to use near 'SELECT tax.*\n          FROM tax\n          JOIN user_tax\n              ON user_tax.tax_id = tax.id\n          WHERE u' at line 3</p>\n</blockquote>\n\n<p>For instance, this is the working query:</p>\n\n<pre><code>SELECT tax.*\nFROM tax\nJOIN user_tax\n    ON user_tax.tax_id = tax.id\nWHERE user_tax.user_id = ?\n    AND tax.deleted_at IS NULL\n    AND user_tax.deleted_at IS NULL\n</code></pre>\n\n<p>The query above will find all tax records for a given user. </p>\n\n<p>Now I am trying to make the same exact query, except now it is a \"search\" query. It takes in a search string and looks for it on the <code>name</code> and <code>rate</code> column of the tax table. This is it:</p>\n\n<pre><code>SET @searchString = '%?%';\n\nSELECT tax.*\nFROM tax\nJOIN user_tax\n    ON user_tax.tax_id = tax.id\nWHERE user_tax.user_id = ?\n    AND tax.deleted_at IS NULL\n    AND user_tax.deleted_at IS NULL\n    AND tax.name LIKE @searchString\n        OR tax.rate LIKE @searchString\n</code></pre>\n\n<p>This is the query in code:</p>\n\n<pre><code>var taxes []Tax\nerr := r.db.Select(&amp;taxes, `\n    SET @query = '%?%';\n\n    SELECT tax.*\n    FROM tax\n    JOIN user_tax\n        ON user_tax.tax_id = tax.id\n    WHERE user_tax.user_id = ?\n        AND tax.deleted_at IS NULL\n        AND user_tax.deleted_at IS NULL\n        AND tax.name LIKE @query\n            OR tax.rate LIKE @query\n`, q, userId)\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 5761, "user_id": 2095676, "user_type": "registered", "accept_rate": 5, "profile_image": "https://i.stack.imgur.com/6D5Af.jpg?s=128&g=1", "display_name": "Lukasz Dynowski", "link": "https://stackoverflow.com/users/2095676/lukasz-dynowski"}, "edited": false, "score": 1, "creation_date": 1501329061, "post_id": 45388814, "comment_id": 77738406, "body": "@TehSphinX Thanks for voting me down base on your assumptionn, and yes it is possible <a href=\"https://play.golang.org/p/AjFvfGDjRI\" rel=\"nofollow noreferrer\">play.golang.org/p/AjFvfGDjRI</a>"}], "answers": [{"comments": [{"owner": {"reputation": 5761, "user_id": 2095676, "user_type": "registered", "accept_rate": 5, "profile_image": "https://i.stack.imgur.com/6D5Af.jpg?s=128&g=1", "display_name": "Lukasz Dynowski", "link": "https://stackoverflow.com/users/2095676/lukasz-dynowski"}, "edited": false, "score": 1, "creation_date": 1501330508, "post_id": 45388909, "comment_id": 77738813, "body": "<b>&quot;Function properties are a delegates of custom behavior&quot;</b>. You nailed it there! I dig deeper into implementation of <b>checkRedirect</b> in <a href=\"https://github.com/golang/go/blob/master/src/net/http/client.go\" rel=\"nofollow noreferrer\">client.go</a>. When you declare a function withing a structure us do two things. First, you implement default behavior for declared function. Second you give a user freedom to override behavior of declared function. Thanks!"}, {"owner": {"reputation": 3040, "user_id": 3158312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gv23q.jpg?s=128&g=1", "display_name": "Albert221", "link": "https://stackoverflow.com/users/3158312/albert221"}, "reply_to_user": {"reputation": 5761, "user_id": 2095676, "user_type": "registered", "accept_rate": 5, "profile_image": "https://i.stack.imgur.com/6D5Af.jpg?s=128&g=1", "display_name": "Lukasz Dynowski", "link": "https://stackoverflow.com/users/2095676/lukasz-dynowski"}, "edited": false, "score": 0, "creation_date": 1501330604, "post_id": 45388909, "comment_id": 77738844, "body": "I&#39;m glad I could help :)"}, {"owner": {"reputation": 3040, "user_id": 3158312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gv23q.jpg?s=128&g=1", "display_name": "Albert221", "link": "https://stackoverflow.com/users/3158312/albert221"}, "reply_to_user": {"reputation": 5761, "user_id": 2095676, "user_type": "registered", "accept_rate": 5, "profile_image": "https://i.stack.imgur.com/6D5Af.jpg?s=128&g=1", "display_name": "Lukasz Dynowski", "link": "https://stackoverflow.com/users/2095676/lukasz-dynowski"}, "edited": false, "score": 0, "creation_date": 1527950330, "post_id": 45388909, "comment_id": 88325971, "body": "@LukaszDynowski would you consider accepting this answer?"}], "tags": [], "owner": {"reputation": 3040, "user_id": 3158312, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/gv23q.jpg?s=128&g=1", "display_name": "Albert221", "link": "https://stackoverflow.com/users/3158312/albert221"}, "is_accepted": false, "score": 6, "last_activity_date": 1501328867, "creation_date": 1501328867, "answer_id": 45388909, "question_id": 45388814, "link": "https://stackoverflow.com/questions/45388814/a-function-within-a-structure-why/45388909#45388909", "title": "A function within a structure. Why?", "body": "<p>I think that the best answer would be an example.</p>\n\n<p>Look at <a href=\"https://golang.org/pkg/net/http/#Client.CheckRedirect\" rel=\"noreferrer\"><code>Client.CheckRedirect</code></a> in the documentation.</p>\n\n<pre><code>type Client struct {\n    // (...)\n    CheckRedirect func(req *Request, via []*Request) error\n}\n</code></pre>\n\n<p>This is a function that is being invoked whenever a <code>http.Client</code> has a redirect response. By the fact, that this function is a public property, you can set this when creating the <code>Client</code> object or afterwards and thus you can define custom behaviour on such case.</p>\n\n<pre><code>client := &amp;http.Client{\n    CheckRedirect: func(req *http.Request, via []*http.Request) error {\n        return http.ErrUseLastResponse\n    }\n}\n</code></pre>\n\n<p>Function properties are just a delegates of custom behaviour (and not only!).</p>\n\n<p>Another example would be creating an object which has an event.</p>\n\n<pre><code>type Example struct {\n    EventHandler func(params []interface{})\n}\n</code></pre>\n\n<p>You can specify a behaviour on that event by setting the <code>Example.EventHandler</code> property.</p>\n"}, {"tags": [], "owner": {"reputation": 19, "user_id": 1096633, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/f9dcbfad8b59d50a0d005d60048388da?s=128&d=identicon&r=PG", "display_name": "pandapirate", "link": "https://stackoverflow.com/users/1096633/pandapirate"}, "is_accepted": false, "score": -1, "last_activity_date": 1501377278, "creation_date": 1501377278, "answer_id": 45395478, "question_id": 45388814, "link": "https://stackoverflow.com/questions/45388814/a-function-within-a-structure-why/45395478#45395478", "title": "A function within a structure. Why?", "body": "<p>It allows you to customize the function for a type without making it be from that type. </p>\n"}], "owner": {"reputation": 5761, "user_id": 2095676, "user_type": "registered", "accept_rate": 5, "profile_image": "https://i.stack.imgur.com/6D5Af.jpg?s=128&g=1", "display_name": "Lukasz Dynowski", "link": "https://stackoverflow.com/users/2095676/lukasz-dynowski"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 133, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1501408119, "creation_date": 1501328224, "last_edit_date": 1501408119, "question_id": 45388814, "link": "https://stackoverflow.com/questions/45388814/a-function-within-a-structure-why", "title": "A function within a structure. Why?", "body": "<p>What is the use case/advantage of defining a function within a structure in go?</p>\n\n<pre><code>type demo struct {\n    F func()\n}\n</code></pre>\n"}, {"tags": ["curl", "go", "ntlm"], "answers": [{"comments": [{"owner": {"reputation": 21, "user_id": 6824031, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tkyaJhDyC10/AAAAAAAAAAI/AAAAAAAABHE/LTxzKCR4y_E/photo.jpg?sz=128", "display_name": "potato", "link": "https://stackoverflow.com/users/6824031/potato"}, "edited": false, "score": 0, "creation_date": 1501327509, "post_id": 45387452, "comment_id": 77737986, "body": "Thank you so much!"}], "tags": [], "owner": {"reputation": 1477, "user_id": 8279560, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/af2d53514074e4972b6049a3b35729ec?s=128&d=identicon&r=PG", "display_name": "Pavlo Strokov", "link": "https://stackoverflow.com/users/8279560/pavlo-strokov"}, "is_accepted": true, "score": 5, "last_activity_date": 1501318964, "creation_date": 1501318964, "answer_id": 45387452, "question_id": 45387108, "link": "https://stackoverflow.com/questions/45387108/ntlm-and-golang/45387452#45387452", "title": "NTLM and Golang", "body": "<p>NTLM Authentication and Basic Authentication are not the same. NTLM is a protocol which is more complicated than just user:password string in header.<br>\nIf you want to make a request from Golang code to authenticate you should use one of existing libraries, like: <a href=\"https://github.com/Azure/go-ntlmssp\" rel=\"noreferrer\">go-ntlmssp</a></p>\n\n<p>Also you can read more about NTLM protocol itself <a href=\"https://msdn.microsoft.com/en-us/library/cc236621.aspx\" rel=\"noreferrer\">here</a></p>\n"}], "owner": {"reputation": 21, "user_id": 6824031, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-tkyaJhDyC10/AAAAAAAAAAI/AAAAAAAABHE/LTxzKCR4y_E/photo.jpg?sz=128", "display_name": "potato", "link": "https://stackoverflow.com/users/6824031/potato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1844, "favorite_count": 1, "accepted_answer_id": 45387452, "answer_count": 1, "score": 0, "last_activity_date": 1501327672, "creation_date": 1501316660, "last_edit_date": 1501327672, "question_id": 45387108, "link": "https://stackoverflow.com/questions/45387108/ntlm-and-golang", "title": "NTLM and Golang", "body": "<p>I have recently learnt Go and I am experimenting with the <code>net/http</code> library. I have been trying to authenticate into a site using the <code>http.SetBasicAuth</code> function but it never seems to work. It works fine with <code>cURL</code> but not with Go. I know this has something to do with <code>NTLM</code> but I don't know how to fix the problem</p>\n\n<p>cURL: </p>\n\n<p><code>curl -v \"http://server_that_im_trying_to_auth_with\" --ntlm -u user:pass</code></p>\n\n<p>Go: </p>\n\n<pre><code> req, _ := http.NewRequest(\"GET\", \"url\", nil)\n req.SetBasicAuth(user, pass)\n resp, _ := http.DefaultClient.Do(req)\n body, _ := ioutil.ReadAll(resp.Body)\n</code></pre>\n\n<p>The body keeps on returning the sites 401 Page.</p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"comments": [{"owner": {"reputation": 714, "user_id": 2384760, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a45b59d0d6bb073951364081ee1bf41b?s=128&d=identicon&r=PG", "display_name": "nadim", "link": "https://stackoverflow.com/users/2384760/nadim"}, "edited": false, "score": 0, "creation_date": 1501319861, "post_id": 45386720, "comment_id": 77735823, "body": "Thank u for your answer."}, {"owner": {"reputation": 841, "user_id": 1274890, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/36bb1f2b6bd55ffb4ec3524b0e00d23f?s=128&d=identicon&r=PG", "display_name": "R Sun", "link": "https://stackoverflow.com/users/1274890/r-sun"}, "edited": false, "score": 1, "creation_date": 1562228574, "post_id": 45386720, "comment_id": 100314676, "body": "Instead of having a struct each time for converting json, you can use   <code>var data map[string]interface{} \tif err := json.Unmarshal([]byte(body), &amp;data); err != nil { \t\tpanic(err) \t}  \tfmt.Println(data)</code>  Here <code>body</code> is string"}], "tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": true, "score": 11, "last_activity_date": 1501315062, "last_edit_date": 1501315062, "creation_date": 1501313900, "answer_id": 45386720, "question_id": 45386644, "link": "https://stackoverflow.com/questions/45386644/how-to-convert-json-string-to-struct/45386720#45386720", "title": "How to convert JSON string to struct", "body": "<p>The fields in <code>pingDataFormat</code> need to be exported (start with a capital letter)</p>\n\n<pre><code>type pingDataFormat struct {\n    UserAccessToken          string `json:\"userAccessToken\"`\n    UploadStartTimeInSeconds int    `json:\"uploadStartTimeInSeconds\"`\n    UploadEndTimeInSeconds   int    `json:\"uploadEndTimeInSeconds\"`\n    CallbackURL              string `json:\"callbackURL\"`\n}\n</code></pre>\n\n<p>That should solve your problem</p>\n\n<p><a href=\"https://play.golang.org/p/Z3yszFl01L\" rel=\"noreferrer\">https://play.golang.org/p/Z3yszFl01L</a></p>\n"}], "owner": {"reputation": 714, "user_id": 2384760, "user_type": "registered", "accept_rate": 59, "profile_image": "https://www.gravatar.com/avatar/a45b59d0d6bb073951364081ee1bf41b?s=128&d=identicon&r=PG", "display_name": "nadim", "link": "https://stackoverflow.com/users/2384760/nadim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 18944, "favorite_count": 0, "accepted_answer_id": 45386720, "answer_count": 1, "score": 7, "last_activity_date": 1587036774, "creation_date": 1501313430, "last_edit_date": 1587036774, "question_id": 45386644, "link": "https://stackoverflow.com/questions/45386644/how-to-convert-json-string-to-struct", "title": "How to convert JSON string to struct", "body": "<p>I have start working in golang, I am trying to parse JSON string to struct but its not working.</p>\n\n<p><strong>JSON String:</strong></p>\n\n<blockquote>\n  <p>dailies\":[{\"userAccessToken\":\"acessToken\",\"uploadStartTimeInSeconds\":1499744832,\"uploadEndTimeInSeconds\":1499744832,\"callbackURL\":\"callbackurl\"}]}</p>\n</blockquote>\n\n<pre><code>type pingDataFormat struct {\n    userAccessToken          string\n    uploadStartTimeInSeconds int\n    uploadEndTimeInSeconds   int\n    callbackURL              string \n}\n</code></pre>\n\n<p>Below is code which convert JSON String to structs</p>\n\n<pre><code>pingJSON := make(map[string][]pingDataFormat)\n\nerr := json.Unmarshal([]byte(pingData), &amp;pingJSON)\n\nif err != nil {\n    panic(err)\n}\n\nfmt.Printf(\"\\n\\n json object:::: %v\", pingJSON)\n</code></pre>\n\n<p><strong>output is:</strong></p>\n\n<blockquote>\n  <p>json object:::: map[dailies:[{ 0 0 }]]</p>\n</blockquote>\n\n<p>Here \"dailies\" dont have data, So do i following right approach to parse and how to get data after parse?</p>\n"}, {"tags": ["string", "go", "error-handling"], "answers": [{"tags": [], "owner": {"reputation": 113073, "user_id": 141555, "user_type": "registered", "accept_rate": 91, "profile_image": "https://i.stack.imgur.com/oOW8R.jpg?s=128&g=1", "display_name": "sberry", "link": "https://stackoverflow.com/users/141555/sberry"}, "is_accepted": false, "score": 3, "last_activity_date": 1501314576, "creation_date": 1501314576, "answer_id": 45386810, "question_id": 45386093, "link": "https://stackoverflow.com/questions/45386093/what-is-the-idiomatic-way-to-include-data-in-error-messages/45386810#45386810", "title": "What is the idiomatic way to include data in error messages?", "body": "<p>Unless you have very little memory, or are going to be generating a HUGE amount of these errors I wouldn't worry about it.  As far as idiomatic Go, I would opt for the <code>h()</code> option because it is easier to read.  </p>\n\n<p>The nice thing here is that allocations, memory used, and speed can be tested with some simple benchmarks</p>\n\n<pre><code>func BenchmarkF(b *testing.B) {\n    for i := 0; i &lt;= b.N; i++ {\n        f()\n    }\n}\n\nfunc BenchmarkG(b *testing.B) {\n    for i := 0; i &lt;= b.N; i++ {\n        g()\n    }\n}\n\nfunc BenchmarkH(b *testing.B) {\n    for i := 0; i &lt;= b.N; i++ {\n        h()\n    }\n}\n</code></pre>\n\n<p>Output of `go test -bench . -benchmem</p>\n\n<pre><code>BenchmarkF-8    10000000           169 ns/op          72 B/op          4 allocs/op\nBenchmarkG-8    10000000           204 ns/op         120 B/op          5 allocs/op\nBenchmarkH-8     5000000           237 ns/op          80 B/op          4 allocs/op\n</code></pre>\n\n<p>As you can see, <code>f()</code> is the fastest, uses the least memory, and is tied for the fewest allocations.  It is also, not worth (in my opinion) the additional cost of readability.</p>\n"}], "owner": {"reputation": 1449, "user_id": 480147, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/9214b8bfba6ff7da2da6b3da84965e2f?s=128&d=identicon&r=PG", "display_name": "Till Ulen", "link": "https://stackoverflow.com/users/480147/till-ulen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 54, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1501314576, "creation_date": 1501309560, "question_id": 45386093, "link": "https://stackoverflow.com/questions/45386093/what-is-the-idiomatic-way-to-include-data-in-error-messages", "title": "What is the idiomatic way to include data in error messages?", "body": "<p>I\u2019ve encountered different ways to incorporate variables into error messages in Go. In the following example, which way is the idiomatic one? Is there a better alternative?</p>\n\n<p>Which is safer when things start to break? For example, when there is very little memory left available, the option that allocates fewer bytes would be preferable.</p>\n\n<p>Which is faster, in case we need to generate a lot of errors?</p>\n\n<p>The full runnable code can be seen in the <a href=\"https://goplay.space/#_jQXIj6hZq\" rel=\"nofollow noreferrer\">Go Play Space</a> or in the official <a href=\"https://play.golang.org/p/_jQXIj6hZq\" rel=\"nofollow noreferrer\">Go Playground</a>.</p>\n\n<pre><code>func f() error {\n    return SepError(\"Sepuled \" + strconv.Itoa(n) + \" sepulcas \" + strconv.Itoa(t) +\n        \" times each\")\n}\n\nfunc g() error {\n    return SepError(strings.Join([]string{\n        \"Sepuled\", strconv.Itoa(n), \"sepulcas\", strconv.Itoa(t), \"times each\"}, \" \"))\n}\n\nfunc h() error {\n    return SepError(fmt.Sprintf(\"Sepuled %d sepulcas %d times each\", n, t))\n}\n</code></pre>\n"}]