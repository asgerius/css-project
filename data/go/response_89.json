[{"tags": ["windows", "go", "terminal"], "comments": [{"owner": {"reputation": 12250, "user_id": 70930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8e7e117b5fb845cfe93ae42f43b244a?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/70930/paul"}, "edited": false, "score": 0, "creation_date": 1474496561, "post_id": 39627348, "comment_id": 66560464, "body": "If you need it just for yourself, install ConEmu (<a href=\"https://conemu.github.io/\" rel=\"nofollow noreferrer\">conemu.github.io</a>) terminal emulator that understands ANSI escape sequences. It&#39;ll work on any Windows version where ConEmu works."}, {"owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "reply_to_user": {"reputation": 12250, "user_id": 70930, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/c8e7e117b5fb845cfe93ae42f43b244a?s=128&d=identicon&r=PG", "display_name": "Paul", "link": "https://stackoverflow.com/users/70930/paul"}, "edited": false, "score": 0, "creation_date": 1474496894, "post_id": 39627348, "comment_id": 66560562, "body": "I have used this and other similar terminals but stopped once windows 10 nativly supported keyboard copy/paste and ANSI control codes (or at least some of the colours). I may have a copy to try and see if it leads anywhere. Thanks Paul."}, {"owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1474506408, "post_id": 39627348, "comment_id": 66562678, "body": "see also <a href=\"https://github.com/danielchatfield/go-chalk\" rel=\"nofollow noreferrer\">github.com/danielchatfield/go-chalk</a>"}, {"owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "reply_to_user": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "edited": false, "score": 0, "creation_date": 1474525015, "post_id": 39627348, "comment_id": 66567861, "body": "@Plato, this library <i>very specifically</i> states <i>noop on Windows</i> . On non-Windows builds it does exactly what I do. As I&#39;ve said my program used to work (I&#39;ve not changed it) but some other local  system change has caused it to no longer work. Thanks for your idea though."}], "answers": [{"tags": [], "owner": {"reputation": 452, "user_id": 4334369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/164mz.jpg?s=128&g=1", "display_name": "sieberts", "link": "https://stackoverflow.com/users/4334369/sieberts"}, "is_accepted": false, "score": 3, "last_activity_date": 1538319078, "creation_date": 1538319078, "answer_id": 52579002, "question_id": 39627348, "link": "https://stackoverflow.com/questions/39627348/ansi-colours-on-windows-10-sort-of-not-working/52579002#52579002", "title": "Ansi colours on Windows 10, sort of not working", "body": "<p>You have to enable virtual terminal processing on Windows since that update.</p>\n\n<p>I usually add a file <code>init_windows.go</code> which sets this in windows but is also compatible with other OS:</p>\n\n<pre><code>// +build windows\n\npackage main\n\nimport (\n    \"os\"\n\n    \"golang.org/x/sys/windows\"\n)\n\nfunc init() {\n    stdout := windows.Handle(os.Stdout.Fd())\n    var originalMode uint32\n\n    windows.GetConsoleMode(stdout, &amp;originalMode)\n    windows.SetConsoleMode(stdout, originalMode|windows.ENABLE_VIRTUAL_TERMINAL_PROCESSING)\n}\n</code></pre>\n\n<p>as copied from: <a href=\"https://github.com/sirupsen/logrus/issues/172#issuecomment-353724264\" rel=\"nofollow noreferrer\">https://github.com/sirupsen/logrus/issues/172#issuecomment-353724264</a> </p>\n"}], "owner": {"reputation": 2696, "user_id": 14019, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/5e4654adc0a8cf62d437e014fd9f8435?s=128&d=identicon&r=PG", "display_name": "Adam Straughan", "link": "https://stackoverflow.com/users/14019/adam-straughan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 981, "favorite_count": 1, "answer_count": 1, "score": 5, "last_activity_date": 1538319078, "creation_date": 1474495890, "question_id": 39627348, "link": "https://stackoverflow.com/questions/39627348/ansi-colours-on-windows-10-sort-of-not-working", "title": "Ansi colours on Windows 10, sort of not working", "body": "<p>Console with colours is fairly new and exciting for Windows :-)</p>\n\n<p><code>I wrote some programs that printed using the ansi colour escapes and all was good</code> ...</p>\n\n<p>... then suddenly it stopped working. Or at least stopped on my laptop, Windows 10.0.14393</p>\n\n<p>The app that fails on my machine does so in a console that a nodejs app has displayed colour in, the same binary runs with the correct colour on another laptop.</p>\n\n<p>golang\n<code>\n    fmt.Println(\"\\033[31mSome Text\\033[0m\")\n</code></p>\n\n<p><a href=\"https://i.stack.imgur.com/Ocu2S.png\" rel=\"noreferrer\"><img src=\"https://i.stack.imgur.com/Ocu2S.png\" alt=\"It looks like this\"></a></p>\n\n<p><em>left-top, console node output, left-bottom, my app failing, right vscode</em></p>\n\n<p><em>httpDump.exe is the name of this demo (in case it was confusing)</em></p>\n\n<p>It does display correctly in the vscode integrated terminal window.</p>\n\n<p>I've tried deleting the <code>HKLM\\Console</code> registry entry and restarting (several times). I deleted the short-cut that may have settings in it. I've tried running as another user on this machine (does not work)</p>\n\n<p>I'd welcome any hints.</p>\n"}, {"tags": ["go", "environment-variables"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474479416, "post_id": 39623052, "comment_id": 66551753, "body": "restarting your IDE probably isn&#39;t going to spawn a new shell with the new environment variables, depending on how you start it, you may need to log out and log back in again. Run your program from the the command line in a new shell."}, {"owner": {"reputation": 3577, "user_id": 3278063, "user_type": "registered", "accept_rate": 79, "profile_image": "https://i.stack.imgur.com/zJLUV.jpg?s=128&g=1", "display_name": "Jeon", "link": "https://stackoverflow.com/users/3278063/jeon"}, "edited": false, "score": 1, "creation_date": 1474479583, "post_id": 39623052, "comment_id": 66551839, "body": "Did you restart your PC?"}, {"owner": {"reputation": 36931, "user_id": 225757, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/e7140b12949e4652885f6bb02b435f42?s=128&d=identicon&r=PG", "display_name": "Roland Illig", "link": "https://stackoverflow.com/users/225757/roland-illig"}, "edited": false, "score": 0, "creation_date": 1474479684, "post_id": 39623052, "comment_id": 66551898, "body": "Did you check for typos? Setting <code>ADD</code> and reading <code>ADDR</code> don&#39;t influence each other."}, {"owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "edited": false, "score": 0, "creation_date": 1474480204, "post_id": 39623052, "comment_id": 66552183, "body": "Restart PC was be neccessary. I thought that if I set env in system via termnal evrythings should be works."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474480482, "post_id": 39623052, "comment_id": 66552302, "body": "<code>env</code> doesn&#39;t <i>set</i> anything, it either prints the variables, or alters a new environment. All your <code>env</code> command does is echo the variable you set with the rest of the environment variables. You should also only set these  <code>.profile</code>, not <code>.bashrc</code>"}, {"owner": {"reputation": 13632, "user_id": 1071383, "user_type": "registered", "accept_rate": 67, "profile_image": "https://www.gravatar.com/avatar/4f4bf0fbd4cc6de6159d78f9f9fb3aa6?s=128&d=identicon&r=PG", "display_name": "jabclab", "link": "https://stackoverflow.com/users/1071383/jabclab"}, "edited": false, "score": 1, "creation_date": 1474481192, "post_id": 39623052, "comment_id": 66552651, "body": "You may be missing an <code>export</code> in your <code>~&#47;.bashrc</code>, i.e. it should be <code>export ADDR=192.168.1.100</code> if you want the variable to be available in your Go app."}], "answers": [{"comments": [{"owner": {"reputation": 408, "user_id": 2234099, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/678915aaa580bada8ed32e01000274c2?s=128&d=identicon&r=PG", "display_name": "gngchrs", "link": "https://stackoverflow.com/users/2234099/gngchrs"}, "edited": false, "score": 0, "creation_date": 1548089199, "post_id": 39638443, "comment_id": 95409242, "body": "I had a similar problem, but this is particular to have zsh or bash script environment variables. One of my zsh files had <code>ADD=&#39;192.168.1.100&#39;</code> instead of <code>export ADD=&#39;192.168.1.100&#39;. </code>"}, {"owner": {"reputation": 109, "user_id": 7813852, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/704a797753e7a970d2311cf98a97569c?s=128&d=identicon&r=PG&f=1", "display_name": "SFin", "link": "https://stackoverflow.com/users/7813852/sfin"}, "edited": false, "score": 0, "creation_date": 1559038025, "post_id": 39638443, "comment_id": 99284841, "body": "If using GoLand, one can add an environment variable in run/debug configuration (Environment field)."}], "tags": [], "owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "is_accepted": false, "score": 8, "last_activity_date": 1474545532, "creation_date": 1474545532, "answer_id": 39638443, "question_id": 39623052, "link": "https://stackoverflow.com/questions/39623052/os-getenv-dosent-work-after-set-env-variable/39638443#39638443", "title": "os.GetEnv() dosen&#39;t work after set env variable", "body": "<p>I think the problem is likely that you are not exporting the variable, so the sub process (i.e. you ide, shell, is not getting it).</p>\n\n<pre><code>ADDR=\"192.168.1.100\" go run main.go\n</code></pre>\n\n<p>or </p>\n\n<pre><code>export ADD=\"192.168.1.100\"\ngo run main.go\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 302, "user_id": 3856170, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/664c9879e1edc98551398dee37f3276f?s=128&d=identicon&r=PG&f=1", "display_name": "VikasPushkar", "link": "https://stackoverflow.com/users/3856170/vikaspushkar"}, "is_accepted": false, "score": 0, "last_activity_date": 1536153660, "creation_date": 1536153660, "answer_id": 52186196, "question_id": 39623052, "link": "https://stackoverflow.com/questions/39623052/os-getenv-dosent-work-after-set-env-variable/52186196#52186196", "title": "os.GetEnv() dosen&#39;t work after set env variable", "body": "<p>if you go program is another app like program in Mac, then use following to set it:</p>\n\n<pre><code>sudo launchctl setenv &lt;env var&gt; &lt;env var value&gt;\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 176, "user_id": 4469888, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/qvshv.png?s=128&g=1", "display_name": "Gabo", "link": "https://stackoverflow.com/users/4469888/gabo"}, "is_accepted": false, "score": 0, "last_activity_date": 1536340754, "creation_date": 1536340754, "answer_id": 52227045, "question_id": 39623052, "link": "https://stackoverflow.com/questions/39623052/os-getenv-dosent-work-after-set-env-variable/52227045#52227045", "title": "os.GetEnv() dosen&#39;t work after set env variable", "body": "<p>you can have your env variables in a .env file and export them when you run it like this:</p>\n\n<p>export <code>less .env | xargs</code>; go run cmd/main.go</p>\n"}, {"tags": [], "owner": {"reputation": 21, "user_id": 11922940, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/9edc284aa69dd72dee4d4bbed900a637?s=128&d=identicon&r=PG", "display_name": "Ethan", "link": "https://stackoverflow.com/users/11922940/ethan"}, "is_accepted": false, "score": 0, "last_activity_date": 1565706252, "creation_date": 1565706252, "answer_id": 57479828, "question_id": 39623052, "link": "https://stackoverflow.com/questions/39623052/os-getenv-dosent-work-after-set-env-variable/57479828#57479828", "title": "os.GetEnv() dosen&#39;t work after set env variable", "body": "<p>I just had this issue and I solved it by not running the program as root. I'm not sure of the cause, but it works now!</p>\n"}, {"tags": [], "owner": {"reputation": 149, "user_id": 1932530, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0c9ae537b98eb788d1b0524bb7597755?s=128&d=identicon&r=PG", "display_name": "kim yong bin", "link": "https://stackoverflow.com/users/1932530/kim-yong-bin"}, "is_accepted": false, "score": 1, "last_activity_date": 1579330716, "creation_date": 1579330716, "answer_id": 59798274, "question_id": 39623052, "link": "https://stackoverflow.com/questions/39623052/os-getenv-dosent-work-after-set-env-variable/59798274#59798274", "title": "os.GetEnv() dosen&#39;t work after set env variable", "body": "<p>I had same problem and for me it's because I run the program with sudo.</p>\n\n<p>I checked the environment variable as a normal user. But run the program as root. So their environment could not be the same.</p>\n"}], "owner": {"reputation": 1366, "user_id": 4931643, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/702807200eaef92e4d1c6896893d7888?s=128&d=identicon&r=PG&f=1", "display_name": "Mbded", "link": "https://stackoverflow.com/users/4931643/mbded"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 9868, "favorite_count": 0, "answer_count": 5, "score": 7, "last_activity_date": 1579330716, "creation_date": 1474479248, "last_edit_date": 1474480269, "question_id": 39623052, "link": "https://stackoverflow.com/questions/39623052/os-getenv-dosent-work-after-set-env-variable", "title": "os.GetEnv() dosen&#39;t work after set env variable", "body": "<p>I have the case dosen't work function </p>\n\n<blockquote>\n  <p>os.GetEnv()</p>\n</blockquote>\n\n<p>I have set a variable in my system ADDR=\"192.168.1.100\" trought file <strong>.bashrc</strong> and <strong>.profile</strong>. So if I open terminal and type below command, I get good result</p>\n\n<blockquote>\n  <p>$ echo $ADDR</p>\n  \n  <p>192.168.1.100</p>\n</blockquote>\n\n<p>Why in below very simply program I get Error if variable is correct set in system ?</p>\n\n<pre><code>func main(){\n    addr := os.Getenv(\"ADDR\")\n    if addr == \"\" {\n        return errors.New(\"missing addres\")\n    }\n}\n</code></pre>\n\n<p>I also restarted IDE a many times. Tried write in terminal again </p>\n\n<blockquote>\n  <p>$ env ADDR=\"192.168.1.100\"</p>\n</blockquote>\n\n<p>but still this same effect.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 3, "creation_date": 1474471514, "post_id": 39620497, "comment_id": 66547065, "body": "the &quot;from:&quot; should be &quot;from&quot; in your <code>ranges.json</code>"}, {"owner": {"reputation": 185, "user_id": 4396517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d20a12a0638586b073d44e2fe1ba41?s=128&d=identicon&r=PG&f=1", "display_name": "user44168", "link": "https://stackoverflow.com/users/4396517/user44168"}, "reply_to_user": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1474471828, "post_id": 39620497, "comment_id": 66547271, "body": "@simon_xia Wow! Thank you for your sharp eyes! This solves my problem, at least for now. Please, make an answer of your comment. Do you know of any tool that would help me find mistakes like this (like the &quot;verbose mode&quot; that I imagined above)?"}, {"owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "edited": false, "score": 0, "creation_date": 1474472322, "post_id": 39620497, "comment_id": 66547594, "body": "this is not syntax error, sorry for my limited knowledge to find a tool out there to avoid this :(  @user44168"}], "answers": [{"tags": [], "owner": {"reputation": 1834, "user_id": 2791115, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/chocR.gif?s=128&g=1", "display_name": "simon_xia", "link": "https://stackoverflow.com/users/2791115/simon-xia"}, "is_accepted": true, "score": 2, "last_activity_date": 1474472065, "creation_date": 1474472065, "answer_id": 39620888, "question_id": 39620497, "link": "https://stackoverflow.com/questions/39620497/golang-json-unmarshal-fails-to-unpack-simple-example/39620888#39620888", "title": "Golang: json Unmarshal fails to unpack simple example", "body": "<p>note that:</p>\n\n<p>the <strong>\"from:\"</strong> should be \"from\" in your <code>ranges.json</code></p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 6860386, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-rzHeRxTBkaU/AAAAAAAAAAI/AAAAAAAAAO8/iXoMLCfPsO0/photo.jpg?sz=128", "display_name": "Juan Vicente", "link": "https://stackoverflow.com/users/6860386/juan-vicente"}, "is_accepted": false, "score": -1, "last_activity_date": 1474486341, "creation_date": 1474486341, "answer_id": 39625095, "question_id": 39620497, "link": "https://stackoverflow.com/questions/39620497/golang-json-unmarshal-fails-to-unpack-simple-example/39625095#39625095", "title": "Golang: json Unmarshal fails to unpack simple example", "body": "<p>The json has bad formatted, \nlook the colon afer from : \n{\n\"from:\": {\n   .....</p>\n"}], "owner": {"reputation": 185, "user_id": 4396517, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6d20a12a0638586b073d44e2fe1ba41?s=128&d=identicon&r=PG&f=1", "display_name": "user44168", "link": "https://stackoverflow.com/users/4396517/user44168"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 307, "favorite_count": 0, "closed_date": 1474502416, "accepted_answer_id": 39620888, "answer_count": 2, "score": -2, "last_activity_date": 1474486341, "creation_date": 1474471028, "question_id": 39620497, "link": "https://stackoverflow.com/questions/39620497/golang-json-unmarshal-fails-to-unpack-simple-example", "closed_reason": "Not suitable for this site", "title": "Golang: json Unmarshal fails to unpack simple example", "body": "<p>I cannot get my head around this problem. I have a simple struct, and another struct that uses it twice:</p>\n\n<pre><code>type Range struct {\n    Position int `json:\"position\"`\n    Length   int `json:\"length\"`\n}\n\ntype TwoRanges struct {\n    From Range `json:\"from\"`\n    To   Range `json:\"to\"`\n}\n</code></pre>\n\n<p>and the following json sample in file \"ranges.json\":</p>\n\n<pre><code>{\n\"from:\": {\n    \"position\": 348,\n    \"length\": 15\n},\n\"to\": {\n    \"position\": 737,\n    \"length\" : 10\n}\n}\n</code></pre>\n\n<p>I try unmarshalling the sample in the following code:</p>\n\n<pre><code>func main() {\n    buffer, err := ioutil.ReadFile(\"ranges.json\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    var sample TwoRanges\n    if err = json.Unmarshal(buffer, &amp;sample); err != nil {\n        log.Fatal(err)\n    }\n\n    fmt.Printf(\"%v\\n\", sample)\n}\n</code></pre>\n\n<p>The output is</p>\n\n<pre><code>{{0 0} {737 10}}\n</code></pre>\n\n<p>Somehow, only the half of the struct is unpacked.</p>\n\n<ol>\n<li>Is it a bug, or am I doing something wrong?</li>\n<li>Is there a \"verbose mode\" for the encoding/json package which would tell me what went wrong with the unmarshaller? It's not the first time that I've had mysterious problems with that package. </li>\n</ol>\n"}, {"tags": ["inheritance", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 4, "last_activity_date": 1474467369, "creation_date": 1474467369, "answer_id": 39619149, "question_id": 39618959, "link": "https://stackoverflow.com/questions/39618959/go-how-to-reference-a-field-in-an-inherited-struct/39619149#39619149", "title": "Go : How to reference a field in an inherited struct", "body": "<p><code>CreatorId</code> (which, by the way should be called <code>CreatorID</code>) is a part of <code>\u0421ommon</code>, so the only way to initialize it in struct literal is:</p>\n\n<pre><code>post1 := &amp;Post{\n    Common: Common{CreatorID: 1},\n    // ...\n}\n</code></pre>\n\n<p>Alternatively,</p>\n\n<pre><code>post1 := &amp;Post{\n    // ...\n}\npost1.CreatorID = 1\n</code></pre>\n"}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 41, "favorite_count": 0, "accepted_answer_id": 39619149, "answer_count": 1, "score": 0, "last_activity_date": 1474467369, "creation_date": 1474466872, "question_id": 39618959, "link": "https://stackoverflow.com/questions/39618959/go-how-to-reference-a-field-in-an-inherited-struct", "title": "Go : How to reference a field in an inherited struct", "body": "<p>I have 2 structs whereby one inherits values that are common amongst all stucts denoted by <code>type Common struct {...}</code></p>\n\n<pre><code>type Common struct{\n    Id int\n    CreatedAt time.Time\n    UpdatedAt time.Time\n    CreatorId int\n}\n\ntype Post struct{\n  type Post struct{\n  Common\n  Status\n  Title string\n  ShortDescription string\n  Content string\n  CategoryIds []int\n  TagIds []int\n  Url string\n  MainImageId int\n  Keywords []string\n}\n</code></pre>\n\n<p>However when I try to create a new instance of the Post struct as in the following.  </p>\n\n<pre><code>post1 := &amp;Post{\n    CreatorId:   1,\n    Status: 1,\n    Title: \"this is the title of the first post\",\n    ShortDescription: \"this is the short description of this post\",\n    Content: \"\",\n    Url: \"first-post\",\n    MainImageId: 1,\n}\n</code></pre>\n\n<p>It does not recognise the <code>CreatorId</code> field.\nHow would I reference this field in the new instance or modify the struct so that it registers <code>CreatorID</code> as part of the <code>Post</code> struct?\nThanks</p>\n"}, {"tags": ["go", "build", "shared-libraries"], "answers": [{"tags": [], "owner": {"reputation": 71, "user_id": 8418712, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ec5e3b1d9473514c1720f216a63a467b?s=128&d=identicon&r=PG", "display_name": "Patrick", "link": "https://stackoverflow.com/users/8418712/patrick"}, "is_accepted": false, "score": 2, "last_activity_date": 1501867920, "creation_date": 1501867920, "answer_id": 45512527, "question_id": 39616236, "link": "https://stackoverflow.com/questions/39616236/cannot-implicitly-include-runtime-cgo-in-a-shared-library/45512527#45512527", "title": "cannot implicitly include runtime/cgo in a shared library", "body": "<p>The only way I've been able to make working DLLs is to use buildmode=c-archive and write C stubs for all the go functions I want to export.  But I was working on Windows for this, I haven't had to mess with this on Linux.  It is a path to investigate.</p>\n"}], "owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1622, "favorite_count": 0, "answer_count": 1, "score": 6, "last_activity_date": 1501867920, "creation_date": 1474459915, "last_edit_date": 1495535654, "question_id": 39616236, "link": "https://stackoverflow.com/questions/39616236/cannot-implicitly-include-runtime-cgo-in-a-shared-library", "title": "cannot implicitly include runtime/cgo in a shared library", "body": "<p>Following my <a href=\"https://stackoverflow.com/q/39577936/5691066\">earlier question</a>, now I'm getting this error when trying to perform all the same steps from this <a href=\"http://blog.ralch.com/tutorial/golang-sharing-libraries/\" rel=\"nofollow noreferrer\">article</a>, since I've upgraded from Go 1.6.1 to Go 1.7.1 (I cannot go back to Go 1.6.1 because the linker crashes when tries to compile some shared libraries).</p>\n\n<p>What I did:</p>\n\n<ol>\n<li>Installed go in <code>~/.go/go</code> (this is later referred to as <code>GOROOT</code>).</li>\n<li><p>Compiled <code>libstd.so</code>:</p>\n\n<pre><code>GOROOT=~/.go/go GOPATH=~/tests go install -buildmode=shared -linkshared std\n</code></pre></li>\n<li><p>Compiled <code>calc</code> library:</p>\n\n<pre><code>GOROOT=~/.go/go GOPATH=~/tests go install -a -x -buildmode=shared -linkshared calc\n</code></pre></li>\n<li><p>Tried to compile <code>app</code>:</p>\n\n<pre><code>GOROOT=~/.go/go GOPATH=~/tests go build -a -x -linkshared -o app cashier\n</code></pre>\n\n<p>and received this error:</p>\n\n<pre><code>~/.go/go/pkg/tool/linux_amd64/link: cannot implicitly include runtime/cgo in a shared library\n</code></pre></li>\n</ol>\n\n<p>I tried to repeat the steps with <code>CGO_ENABLED=0</code> prepended to the environment, but nothing would build this way.  Giving me this error:</p>\n\n<pre><code>imports runtime/cgo: C source files not allowed when not using cgo or SWIG: gcc_fatalf.c gcc_linux_amd64.c gcc_mmap.c gcc_util.c\n</code></pre>\n\n<p>Is this a known bug?  Is making shared libraries meant to be supported?</p>\n"}, {"tags": ["javascript", "encryption", "go", "jwe", "jose"], "owner": {"reputation": 3164, "user_id": 514329, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/6YdMT.jpg?s=128&g=1", "display_name": "Mohsen", "link": "https://stackoverflow.com/users/514329/mohsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 380, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474461075, "creation_date": 1474459440, "last_edit_date": 1474461075, "question_id": 39616087, "link": "https://stackoverflow.com/questions/39616087/jose-js-jwe-the-data-that-encrypted-by-javascript-wont-decrypt-by-go", "title": "JOSE_JS JWE The data that encrypted by javascript won&#39;t decrypt by go", "body": "<p>Server side code for generating public key is:</p>\n\n<pre><code>privateKey, err := rsa.GenerateKey(rand.Reader, 2048)\nif err != nil {\n    return nil\n}\npublicKey := &amp;privateKey.PublicKey\npublicKeyBytes, err := json.Marshal(publicKey)\nprivateKeyBytes,err:=json.Marshal(privateKey)\n</code></pre>\n\n<p>The private key is a singleton stored in memory at server side and the public key is another singleton which is being returned to the clients requesting it.</p>\n\n<p>Then the client which is a web browser here encrypts the data by server's public key:</p>\n\n<pre><code>cookieParts=document.cookie.split('pk=')\nif(cookieParts.length==1)\n{\n     serverPublicKey= unescape(cookieParts[0].split(';')[0].toString())\n}\nelse\n{\n    serverPublicKey= unescape(cookieParts[1].split(';')[0].toString())\n}\nserverPublicKey =serverPublicKey.replace(/([\\[\ud83d\ude0f)?(\\d+)([,\\}\\]])/g, \"$1\\\"$2\\\"$3\");\nserverPublicKey = JSON.parse(serverPublicKey)\nvar rsa_key = {\n     \"n\":btoa(serverPublicKey.N).replace(/=/g, ''),\n      //Maybe the above line causes the problem.But I couldn't find any other way.\n         \"e\": 65537,\n    };\n    var cryptographer = new Jose.WebCryptographer();\n    cryptographer.setKeyEncryptionAlgorithm(\"RSA-OAEP\");\n    cryptographer.setContentEncryptionAlgorithm(\"A128GCM\");\n    cryptographer.setContentEncryptionAlgorithm(\"A128CBC-HS256\");\n    var public_rsa_key = Jose.Utils.importRsaPublicKey(rsa_key, \"RSA-OAEP\");\n    var encrypter = new JoseJWE.Encrypter(cryptographer, public_rsa_key);\n    str=\"test\"\n    encrypter.encrypt(\"sara\").then(function(data) {\n    $scope.params.Param1=data\n    TestService.SendParamToServer($scope.params).then(function(result){\n         console.log(\"success\")\n    }).catch(function(error){\n         console.log(\"error\")\n    })\n</code></pre>\n\n<p>And then the server tires to decrypt the data just encrypted by the code above:</p>\n\n<pre><code>jweString = string(p.Param1)\njwe, err = jose.ParseEncrypted(jweString)\nif err != nil {\n    panic(err.Error())\n}\ndata, err := jwe.Decrypt(services.NewSecurityService().GetPrivateKey())\nif err != nil {\n   // The error is not nil:\n   // square/go-jose: error in cryptographic primitive\n   panic(err.Error())\n\n}\n</code></pre>\n\n<p>But unfortunately we get the following error:</p>\n\n<pre><code>square/go-jose: error in cryptographic primitive\n</code></pre>\n"}, {"tags": ["go", "smpp"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474462554, "post_id": 39615776, "comment_id": 66540740, "body": "What does it mean you are &quot;unable to set the user_message_reference optional parameter&quot;? Please show an example of what you tried, what you expect to happen, and what you actually saw."}, {"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474522804, "post_id": 39615776, "comment_id": 66566890, "body": "I supplied values tag=0516(int equivalent of 0x0204 user_message_reference) length=02 and value=&quot;91&quot; in the setTVLField function.  I could see &quot;tag=516,len=2,value=0x3931&quot; appear in the SMSC simulator , but the value doesn&#39;t seem appropriate to me; and the message_id in the response still continues its sequence by adding 1 with the last message_id."}, {"owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474605967, "post_id": 39615776, "comment_id": 66608456, "body": "@JimB did that help?"}], "answers": [{"tags": [], "owner": {"reputation": 341, "user_id": 5170621, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-eV_pBcYJai8/AAAAAAAAAAI/AAAAAAAAAAA/N0q9MrkHOOs/photo.jpg?sz=128", "display_name": "joe mwirigi", "link": "https://stackoverflow.com/users/5170621/joe-mwirigi"}, "is_accepted": false, "score": 0, "last_activity_date": 1508952828, "creation_date": 1508952828, "answer_id": 46938681, "question_id": 39615776, "link": "https://stackoverflow.com/questions/39615776/unable-to-set-smpp-optional-parameter-in-go-code/46938681#46938681", "title": "Unable to set SMPP optional parameter in go code", "body": "<p>You don't have edit the function in the transmitter.go</p>\n\n<p>just set your tlv fields after your submit_sm</p>\n\n<p>example</p>\n\n<pre><code>pdu, err        := trx.Smpp.SubmitSm(\"+254720000000\", \npdu.GetField(\"source_addr\").String(), msg, &amp;smpp.Params{})\n\npdu.SetTLVField(0x0501, 1, []byte{2}) #eg a ussd_service_op\n</code></pre>\n\n<p>This is the proper way to add your tlv values if you are using kevin's package\nSee <a href=\"https://github.com/CodeMonkeyKevin/smpp34/issues/9\" rel=\"nofollow noreferrer\">https://github.com/CodeMonkeyKevin/smpp34/issues/9</a>\n<a href=\"https://github.com/CodeMonkeyKevin/smpp34/issues/9\" rel=\"nofollow noreferrer\">Additional parameters</a></p>\n"}], "owner": {"reputation": 215, "user_id": 5962248, "user_type": "registered", "accept_rate": 64, "profile_image": "https://i.stack.imgur.com/NbGq8.jpg?s=128&g=1", "display_name": "Hardy", "link": "https://stackoverflow.com/users/5962248/hardy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 420, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1508952828, "creation_date": 1474458603, "last_edit_date": 1474528815, "question_id": 39615776, "link": "https://stackoverflow.com/questions/39615776/unable-to-set-smpp-optional-parameter-in-go-code", "title": "Unable to set SMPP optional parameter in go code", "body": "<p>Iam studying SMPP protocol and tried to implement a simple transmitter with a golang code and <strong>selenium smpp simulator</strong>. I found a package \"<strong>CodeMonkeyKevin/smpp34</strong>\" from github. \nBut Iam unable to set the \"user_message_reference\" optional parameter.</p>\n\n<p>I slightly modified the \"SubmitSm\" function inside the \"transmitter.go\" file by adding these lines (just before the write operation):</p>\n\n<pre><code>err = p.SetTLVField(tag, length, []byte(value))\n    if err != nil {\n        fmt.Println(\"Set TLV failed\")\n        return 0, err\n    }\n</code></pre>\n\n<p>But this is not working. </p>\n\n<p>I supplied values <strong>tag=0516</strong>(int equivalent of 0x0204 user_message_reference) <strong>length=02</strong> and <strong>value=\"91\"</strong>. </p>\n\n<p>In the response i could see \"<strong>tag=516,len=2,value=0x3931</strong>\" in the SMSC simulator , the value field doesn't seem appropriate to me; also the \"<strong>message_id</strong>\" in the response still continues its sequence by adding 1 with the last message_id</p>\n\n<p>can some one help me in setting the \"user_message_reference\" optional parameter to the \"<strong>submit_sm</strong>\" request?</p>\n\n<p>Thanks in advance.</p>\n"}, {"tags": ["go", "packages", "libraries"], "comments": [{"owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "edited": false, "score": 2, "creation_date": 1474491535, "post_id": 39615419, "comment_id": 66558255, "body": "You use 64-bit Go, so you have to install 64-bit (mingw-w64) for cgo."}], "owner": {"reputation": 563, "user_id": 6345027, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3ee7df5d6dd1ce4a7e9b10ad203e333a?s=128&d=identicon&r=PG&f=1", "display_name": "Colleen Larsen", "link": "https://stackoverflow.com/users/6345027/colleen-larsen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 781, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474457582, "creation_date": 1474457582, "question_id": 39615419, "link": "https://stackoverflow.com/questions/39615419/go-get-error-cc1-exe-sorry-unimplemented-64-bit-mode-not-compiled-in", "title": "Go get error: cc1.exe: sorry, unimplemented: 64-bit mode not compiled in", "body": "<p>I have been receiving a strange error when trying to import external libraries/packages in Go when running any go get command I get the forllowing error</p>\n\n<pre><code>    # github.com/mattn/go-sqlite3\ncc1.exe: sorry, unimplemented: 64-bit mode not compiled in\n</code></pre>\n\n<p>I have tried updating mingw</p>\n\n<pre><code> mingw-get update\n</code></pre>\n\n<p>but I still get the same error, what can I do to fix this issue?\nThanks</p>\n"}, {"tags": ["string", "go"], "answers": [{"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 3, "last_activity_date": 1474450470, "creation_date": 1474450470, "answer_id": 39612749, "question_id": 39612634, "link": "https://stackoverflow.com/questions/39612634/pass-an-explicit-string-to-fmt-sprint-in-golang/39612749#39612749", "title": "Pass an explicit string to fmt.Sprint in Golang", "body": "<p>Yes, <code>Sprint</code> is pretty much useless for a single string, it should be used if you have a bunch of objects, Stringers or not. It just concatenates the string representations of them. from TFM:</p>\n\n<blockquote>\n  <p>Sprint formats using the default formats for its operands and returns\n  the resulting string. Spaces are added between operands when neither\n  is a string.</p>\n</blockquote>\n\n<p>So if you have just one string it's useless. If you have many arguments, especially variadic, it sure beats doing something like <code>fmt.Sprintf(\"%v %v %v\", foo, bar, baz)</code>, especially if you don't know how many elements you have.</p>\n"}], "owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 328, "favorite_count": 0, "accepted_answer_id": 39612749, "answer_count": 1, "score": 2, "last_activity_date": 1474450665, "creation_date": 1474450180, "last_edit_date": 1474450665, "question_id": 39612634, "link": "https://stackoverflow.com/questions/39612634/pass-an-explicit-string-to-fmt-sprint-in-golang", "title": "Pass an explicit string to fmt.Sprint in Golang", "body": "<p>After reading the docs and having a look through the source code, I'm a little unsure if there are any benefits of passing an explicit string to the <code>fmt.Sprint</code> function?</p>\n\n<p>For example, will this:</p>\n\n<pre><code>return fmt.Sprint(\"this is a string\")\n</code></pre>\n\n<p>be more beneficial than doing this:</p>\n\n<pre><code>return \"this is a string\"\n</code></pre>\n\n<p>Am I correct in thinking that this function works better with types that conform to the Stringer interface?</p>\n"}, {"tags": ["postgresql", "go"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474452252, "post_id": 39612043, "comment_id": 66533804, "body": "What does <code>dtime = dtime</code> even mean? Show the actual code please."}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474458990, "post_id": 39612043, "comment_id": 66538312, "body": "editted the question."}, {"owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "edited": false, "score": 0, "creation_date": 1474482787, "post_id": 39612043, "comment_id": 66553469, "body": "How do you define row?"}, {"owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "edited": false, "score": 0, "creation_date": 1474863446, "post_id": 39612043, "comment_id": 66688148, "body": "Define a row? You mean columns in a row?"}, {"owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "edited": false, "score": 0, "creation_date": 1474930949, "post_id": 39612043, "comment_id": 66725350, "body": "Are you actually checking that error? It looks like it should work.. What does all of the surrounding code look like?"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2273, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474458968, "creation_date": 1474448642, "last_edit_date": 1474458968, "question_id": 39612043, "link": "https://stackoverflow.com/questions/39612043/scan-error-on-column-index-1-unsupported-scan-storing-driver-value-type-nil", "title": "Scan error on column index 1: unsupported Scan, storing driver.Value type &lt;nil&gt; into type *string", "body": "<p>I have a column in postgres which is blank initially       </p>\n\n<pre><code>var dtime sql.NullString\n\nerr = rows.Scan(&amp;dtime)\n\nif dtime.Valid {\n    dtimeString = dtime.String\n} else {\n    dtime = sql.NullString{}\n}\n</code></pre>\n\n<p>rows are are a result set of a sql query from my table. </p>\n\n<pre><code>select dtime from mytable;  // returns 5 rows.\n</code></pre>\n\n<p>But I keep getting</p>\n\n<pre><code>Scan error on column index 1: unsupported Scan, storing driver.Value type &lt;nil&gt; into type *string. \n</code></pre>\n\n<p>I have tried whats given here - <a href=\"https://golang.org/pkg/database/sql/#NullString\" rel=\"nofollow\">https://golang.org/pkg/database/sql/#NullString</a></p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-platform"], "comments": [{"owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 1, "creation_date": 1474446120, "post_id": 39609357, "comment_id": 66529656, "body": "Is the issue with authentication or with filling the required fields? If it is the second, that should be more or less independent from the client library, just follow the format specified on the rest API call documentation. Before trying it on the client library, I would recommend to try the request on the APIs Explorer: <a href=\"https://developers.google.com/apis-explorer/#p/cloudresourcemanager/v1beta1/cloudresourcemanager.projects.create\" rel=\"nofollow noreferrer\">developers.google.com/apis-explorer/#p/cloudresourcemanager/&zwnj;&#8203;&hellip;</a>"}, {"owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "reply_to_user": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "edited": false, "score": 0, "creation_date": 1474448332, "post_id": 39609357, "comment_id": 66531083, "body": "I&#39;ve tested through API explorer before and it works fine. I just don&#39;t know how to implement this authentication on my app. That&#39;s the bit I don&#39;t understand."}], "answers": [{"comments": [{"owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "edited": false, "score": 0, "creation_date": 1475203351, "post_id": 39613094, "comment_id": 66859692, "body": "None of the above will work. I&#39;ve set the application-default account before and still getting error: Error context googleapi: Error 403: The caller does not have permission, forbidden. The second method can&#39;t work because credentials are set at project level, since a project is exactly what I&#39;m trying to create I can create credentials beforehand"}, {"owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "reply_to_user": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "edited": false, "score": 0, "creation_date": 1475272495, "post_id": 39613094, "comment_id": 66893748, "body": "I am able to run create on v1 of the API on APIs Explorer, but not v1beta1. The create method is marked as alpha on the new version. Maybe it is not generally available yet?"}, {"owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "edited": false, "score": 0, "creation_date": 1475273659, "post_id": 39613094, "comment_id": 66894105, "body": "Yep. I&#39;m now focusing on the V1 api. I got in touch with the Cloud Platform Support team and the v1 is actually the recommended method to do so. The problem now is that I can&#39;t get v1 to work outside of the API explorer due to some authentication issue. I&#39;ve posted a new question for this issue. <a href=\"http://stackoverflow.com/questions/39800765/create-google-cloud-project-with-cloud-resource-manager-api\" title=\"create google cloud project with cloud resource manager api\">stackoverflow.com/questions/39800765/&hellip;</a>"}], "tags": [], "owner": {"reputation": 978, "user_id": 1319541, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/679e79757e837289c9e14a270caa3b8a?s=128&d=identicon&r=PG", "display_name": "dyeray", "link": "https://stackoverflow.com/users/1319541/dyeray"}, "is_accepted": false, "score": 1, "last_activity_date": 1474451362, "creation_date": 1474451362, "answer_id": 39613094, "question_id": 39609357, "link": "https://stackoverflow.com/questions/39609357/create-a-google-app-engine-project-programatically-in-go/39613094#39613094", "title": "Create a Google App Engine Project Programatically in Go", "body": "<p>When you initialize the API by calling cloudresourcemanager.New(hc), you pass an http client, that in the case of this example is authenticated by using the default credentials from the system. These credentials come from the default service account of App Engine or Compute Engine (not sure about the second though), depending on the environment you are in. If you are outside of Google Cloud, you can follow the instructions on the example:</p>\n\n<pre><code>// 2. This sample uses Application Default Credentials for authentication.\n//    If not already done, install the gcloud CLI from\n//    https://cloud.google.com/sdk/ and run\n//    'gcloud beta auth application-default login'\n</code></pre>\n\n<p>If you do this, the default credentials will be taken from the user you used to log in on the command gcloud beta auth application-default login. Another possibility would be changing the code to generate the credentials by calling JWTConfigFromJson<a href=\"https://godoc.org/golang.org/x/oauth2/google#JWTConfigFromJSON\" rel=\"nofollow\">1</a>, that would explicitly load your credentials from a json file. Here<a href=\"https://github.com/golang/oauth2/blob/master/google/example_test.go#L58\" rel=\"nofollow\">2</a> you can see an example of how to initialize an http client using this method.</p>\n"}], "owner": {"reputation": 1278, "user_id": 2036231, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/nYM74.png?s=128&g=1", "display_name": "Jose Bagatelli", "link": "https://stackoverflow.com/users/2036231/jose-bagatelli"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 119, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474451362, "creation_date": 1474440723, "last_edit_date": 1474441632, "question_id": 39609357, "link": "https://stackoverflow.com/questions/39609357/create-a-google-app-engine-project-programatically-in-go", "title": "Create a Google App Engine Project Programatically in Go", "body": "<p>I'm trying to find a way to dynamically create a project on Google App Engine using Go following <a href=\"https://cloud.google.com/resource-manager/reference/rest/v1beta1/projects/create\" rel=\"nofollow\">this example</a>.\nHowever, the documentation isn't very clear (at least for me) in how to proceed to authenticate the user and the Go example goes as far as saying: </p>\n\n<pre><code>// TODO: Fill required fields.\n</code></pre>\n\n<p>I also had a look at the <a href=\"https://github.com/google/google-api-go-client\" rel=\"nofollow\">Go Client Library Documentation</a> which made things even more confusing to me.</p>\n\n<p>Has anyone used this API before or have found a way to programatically create a project in App Engine?</p>\n"}, {"tags": ["xml", "go", "character-encoding", "xml-parsing"], "comments": [{"owner": {"reputation": 153428, "user_id": 813602, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/e1844cebf36374d83a83c0e69003cd42?s=128&d=identicon&r=PG", "display_name": "Ingo Karkat", "link": "https://stackoverflow.com/users/813602/ingo-karkat"}, "edited": false, "score": 0, "creation_date": 1474442042, "post_id": 39607090, "comment_id": 66527235, "body": "In Vim, that&#39;s the effect of the <code>&#39;synmaxcol&#39;</code> option; which is an optimization to avoid slow screen updates. I&#39;m afraid that has nothing to do with your Golang problem, though."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474452445, "post_id": 39607090, "comment_id": 66533938, "body": "Define &quot;really large&quot; please. Are we talking megabytes, gigabytes?"}, {"owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "edited": false, "score": 0, "creation_date": 1474484838, "post_id": 39607090, "comment_id": 66554570, "body": "Large as in the example, where an element is possibly a few hundred coordinate points."}], "owner": {"reputation": 293, "user_id": 5225081, "user_type": "registered", "accept_rate": 6, "profile_image": "https://www.gravatar.com/avatar/88eacba7df7f23affd7a197753f2696b?s=128&d=identicon&r=PG&f=1", "display_name": "J.Doe", "link": "https://stackoverflow.com/users/5225081/j-doe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 153, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474442061, "creation_date": 1474428802, "last_edit_date": 1474442061, "question_id": 39607090, "link": "https://stackoverflow.com/questions/39607090/xml-closing-tag-of-large-element-golang", "title": "XML Closing Tag of large element (Golang)", "body": "<p>Is there some type of special encoding behaviour that happens to the closing tag of an element that is really large? </p>\n\n<p>I have a Golang function (simplified) like this:</p>\n\n<pre><code>xmlDec := xml.NewReader(xmlFile)\nif tok, err := xmlDec.Token(); err != nil {\n    switch case := tok.(type) {\n    case xml.StartElement:\n    //do things\n    case xml.CharData:\n    //do things\n    case xml.EndElement:\n    //do things\n    default:\n    //do things\n    }\n}\n</code></pre>\n\n<p>For xml files of with \"reasonably\" sized text elements, it does what it's supposed to do. However, if I encounter something like this:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;gml:LinearRing&gt;\n&lt;gml:coordinates decimal=\".\" cs=\",\" ts=\" \"&gt;1,1 1,2 1,3 (continues for hundreds of points)&lt;/gml:coordinates&gt;\n&lt;/gml:LinearRing&gt;\n</code></pre>\n\n<p>The golang xml decoder won't recognize the closing <code>&lt;/gml:LinearRing&gt;</code> tag as an EndElement. Of course, this is reproducable on any element type not just gml. Is this a known issue with Golang's xml decoder or perhaps some t? I have noticed that on Vim, if a xml file has a really long element text, Vim seems to not recognize it as a closing tag, color-coding wise.  </p>\n"}, {"tags": ["image-processing", "go", "jpeg", "libjpeg"], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": false, "score": 1, "last_activity_date": 1474496503, "last_edit_date": 1474496503, "creation_date": 1474464688, "answer_id": 39618039, "question_id": 39606196, "link": "https://stackoverflow.com/questions/39606196/how-can-i-get-golang-read-jpegs-and-get-the-same-unit8-values-as-python-c/39618039#39618039", "title": "How can I get golang read jpegs and get the same unit8 values as Python/C?", "body": "<p>The JPEG specification doesn't have a pixel exact definition for a decoder, so different implementations will have slightly different output. Even libjpeg on it's own has 4 different Discrete Cosine Transform implementations, using integer or floating point math.</p>\n\n<p>As for your code, if <code>img</code> is already an <a href=\"https://golang.org/pkg/image/#RGBA\" rel=\"nofollow\"><code>image.RGBA</code></a>, the values are all stored as <code>uint8</code> and you're just shifting the bits back and forth doing nothing. If the image is an <a href=\"https://golang.org/pkg/image/#YCbCr\" rel=\"nofollow\"><code>image.YCbCr</code></a>, then you also depend on the color conversion algorithm, and the <a href=\"https://golang.org/pkg/image/color/#YCbCr.RGBA\" rel=\"nofollow\"><code>YCbCr.RGBA()</code></a> method differs slightly from the <a href=\"https://golang.org/pkg/image/color/#YCbCrToRGB\" rel=\"nofollow\"><code>color.YCbCrToRGB</code></a> function. The former tries to maintain more precision, and you need to properly round the values rather than truncating them with a simple right shift. The latter is closer to the spec recommendation, but doesn't use floating point constants which again may differ from other implementations. </p>\n\n<p>Finally, the image itself may have an embedded ICC profile, and depending on the software used to decode the image, the profile may or may not have been applied when viewing the raw pixel data.</p>\n"}], "owner": {"reputation": 4478, "user_id": 557406, "user_type": "registered", "accept_rate": 90, "profile_image": "https://www.gravatar.com/avatar/99836456ec6d87389df32d2cdcf8d825?s=128&d=identicon&r=PG", "display_name": "Charles L.", "link": "https://stackoverflow.com/users/557406/charles-l"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 377, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474496503, "creation_date": 1474421702, "last_edit_date": 1474476479, "question_id": 39606196, "link": "https://stackoverflow.com/questions/39606196/how-can-i-get-golang-read-jpegs-and-get-the-same-unit8-values-as-python-c", "title": "How can I get golang read jpegs and get the same unit8 values as Python/C?", "body": "<p>I have a test jpeg I'm using for some image processing code &amp; I'm trying to get the same array of uint8 values that opencv in python and C and Pillow (via scipy) in Python, which all match the values I get when I open the jpeg using gimp.</p>\n\n<p>I tried shifting the color values 8 bits, but this does not convert the values accurately - it looks like there's some rounding that I don't quite understand.  I know gimp and opencv and Pillow/scipy all use libjpeg, so I tried using <a href=\"https://github.com/pixiv/go-libjpeg\" rel=\"nofollow\">https://github.com/pixiv/go-libjpeg</a> and converting the images to 8 bits using</p>\n\n<pre><code>func Convert(img image.Image) *image.RGBA {\n   b := img.Bounds()\n    rgba := image.NewRGBA(b)\n    for y := b.Min.Y; y &lt; b.Max.Y; y++ {\n        for x := b.Min.X; x &lt; b.Max.X; x++ {\n            r32, g32, b32, _ := img.At(x, y).RGBA()\n            c := color.RGBA{uint8(r32&gt;&gt;8), uint8(g32&gt;&gt;8), uint8(b32&gt;&gt;8), 255}\n            rgba.SetRGBA(x, y, c)\n        }\n    }\n    return rgba\n}\n</code></pre>\n\n<p>but this still does not match.  How can I get the same results?</p>\n"}, {"tags": ["go", "function-parameter", "go-interface"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1474421641, "post_id": 39606037, "comment_id": 66520714, "body": "See the <a href=\"https://golang.org/doc/faq#nil_error\" rel=\"nofollow noreferrer\">FAQ: Why is my nil error value not equal to nil?</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 4, "creation_date": 1474421763, "post_id": 39606037, "comment_id": 66520735, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/29138591/hiding-nil-values-understanding-why-golang-fails-here\">Hiding nil values, understanding why golang fails here</a>"}, {"owner": {"reputation": 48, "user_id": 2662987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48573ad74037ba9bda4fe73fe7707dd3?s=128&d=identicon&r=PG", "display_name": "soluwalana", "link": "https://stackoverflow.com/users/2662987/soluwalana"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474423172, "post_id": 39606037, "comment_id": 66521059, "body": "Thanks for the link @JimB, That does indeed explain it. When it gets passed between the createRequest function it gains a type in the interface and that is passed through to the next function as (*bytes.Buffer, nil) instead of (nil, nil).   Is the value of <code>data</code> before the call to NewRequest (nil, nil) or (*bytes.Buffer, nil). I&#39;m not really sure when it becomes (*bytes.Buffer, nil) is the problem."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1474423456, "post_id": 39606037, "comment_id": 66521124, "body": "<code>data</code> is <code>nil</code>, but has the type <code>*bytes.Buffer</code>"}], "answers": [{"tags": [], "owner": {"reputation": 48, "user_id": 2662987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48573ad74037ba9bda4fe73fe7707dd3?s=128&d=identicon&r=PG", "display_name": "soluwalana", "link": "https://stackoverflow.com/users/2662987/soluwalana"}, "is_accepted": false, "score": 0, "last_activity_date": 1474564958, "creation_date": 1474564958, "answer_id": 39645232, "question_id": 39606037, "link": "https://stackoverflow.com/questions/39606037/golang-passing-nil-to-function-that-accepts-an-interface/39645232#39645232", "title": "GoLang - Passing nil to function that accepts an interface", "body": "<p>@JimB was correct in his comment. This snippet of code below shows that the type of the object is indeed (*bytes.Buffer, nil) </p>\n\n<pre><code>package main\n\nimport (\n    \"bytes\"\n    \"fmt\"\n    \"reflect\"\n    \"errors\"\n    \"io\"\n)\nfunc NewRequest(method, urlStr string, body io.Reader) (error) {\n    if body == nil {\n       fmt.Println(\"Body Is Nil\")\n       return nil\n    }\n    fmt.Println(reflect.TypeOf(body).Elem())\n    return errors.New(\"NOT NIL\")\n}\n\nfunc createRequest(method, uri string, data *bytes.Buffer) string {\n    fmt.Println(\"Type Of data is \", reflect.TypeOf(data).Elem())\n\n    if data == nil {\n       fmt.Println(\"data is nil\")\n    }\n    err := NewRequest(method, uri, data)\n    if err != nil {\n       return err.Error()\n    }\n    return \"OK\"\n}\n\nfunc createRequestNoBody(method, uri string) string {\n    err := NewRequest(method, uri, nil)\n    if err != nil {\n       return err.Error()\n    }\n    return \"OK\"\n}\n\nfunc main() {\n   data := createRequestNoBody(\"GET\", \"http://google.com\")\n   if len(data) != 0 {\n      fmt.Println(\"First Request Ok\")\n   }\n   data = createRequest(\"GET\", \"https://google.com\", nil)\n   if len(data) != 0 {\n      fmt.Println(\"Second Request Not OK\")\n   }\n}\n</code></pre>\n\n<p>The output of the run looks like: </p>\n\n<pre><code>Body Is Nil\nFirst Request Ok\nType Of data is  bytes.Buffer\ndata is nil\nbytes.Buffer\nSecond Request Not OK\n</code></pre>\n\n<p>Since <code>body io.Reader</code> is an interface and not a pointer to a particular type when you pass in a <code>nil</code> pointer of type <code>bytes.Buffer</code> it will be a non <code>nil</code> interface.  </p>\n"}], "owner": {"reputation": 48, "user_id": 2662987, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/48573ad74037ba9bda4fe73fe7707dd3?s=128&d=identicon&r=PG", "display_name": "soluwalana", "link": "https://stackoverflow.com/users/2662987/soluwalana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1177, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474564958, "creation_date": 1474420211, "last_edit_date": 1474421026, "question_id": 39606037, "link": "https://stackoverflow.com/questions/39606037/golang-passing-nil-to-function-that-accepts-an-interface", "title": "GoLang - Passing nil to function that accepts an interface", "body": "<p>I stumbled accross something that threw me for a loop in golang recently.</p>\n\n<pre><code>package main\n\nimport (\n    \"net/http\"\n    \"bytes\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc createRequest(method, uri string, data *bytes.Buffer) string {\n    req, err := http.NewRequest(method, uri, data)\n    if err != nil {\n       return \"\"\n    }\n    req.Close = true\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\n       return \"\"\n    }\n    defer resp.Body.Close()\n    respBody, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return \"\"\n    }\n    return string(respBody)\n}\n\nfunc createRequestNoBody(method, uri string) string {\n    req, err := http.NewRequest(method, uri, nil)\n    if err != nil {\n       return \"\"\n    }\n    req.Close = true\n    client := &amp;http.Client{}\n    resp, err := client.Do(req)\n    if err != nil {\n       return \"\"\n    }\n    defer resp.Body.Close()\n    respBody, err := ioutil.ReadAll(resp.Body)\n    if err != nil {\n        return \"\"\n    }\n    return string(respBody)\n}\n\nfunc main() {\n   data := createRequestNoBody(\"GET\", \"http://google.com\")\n   if len(data) != 0 {\n      fmt.Println(\"First Request Ok\")\n   }\n   data = createRequest(\"GET\", \"https://google.com\", nil)\n   if len(data) != 0 {\n      fmt.Println(\"Second Request OK\")\n   }\n}\n</code></pre>\n\n<p>This code works in the <code>createRequestNoBody</code> function when nil is passed directly to <code>http.NewRequest</code> but it produces a panic when calling <code>createRequest</code> with the <code>*bytes.Buffer</code> set to <code>nil</code> in the calling function.</p>\n\n<p>The NewRequest function in the http library has the following prototype:</p>\n\n<p><code>func NewRequest(method, urlStr string, body io.Reader) (*Request, error)</code></p>\n\n<p>Where <code>io.Reader</code> is an interface. </p>\n\n<p>I'm not sure why the nil being passed through a variable would cause <code>body</code> in NewRequest to become non nil.</p>\n\n<p>Can anyone explain why <code>createRequest</code> method results in a panic? How is the nil parameter at <code>data = createRequest(\"GET\", \"https://google.com\", nil)</code> becoming non nil inside of the <code>NewRequest</code> method?</p>\n"}, {"tags": ["dictionary", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 4, "last_activity_date": 1474417026, "last_edit_date": 1474417026, "creation_date": 1474416490, "answer_id": 39605565, "question_id": 39605295, "link": "https://stackoverflow.com/questions/39605295/why-is-a-map-value-in-one-function-affected-by-an-entry-to-the-map-in-another-fu/39605565#39605565", "title": "Why is a map value in one function affected by an entry to the map in another function?", "body": "<p>You are right in that when you pass something to a function, a copy will be made. But maps are some kind of descriptors to an underlying data structure. So when you pass a map value to a function, only the descriptor will be copied which will denote / point to the same data structures where the map data (entries) are stored.</p>\n\n<p>This means if the function does any modification to the entries of the map (add, delete, modify entries), that is observed from the caller.</p>\n\n<p>Read <a href=\"https://blog.golang.org/go-maps-in-action\" rel=\"nofollow\">The Go Blog: Go maps in action</a> for details.</p>\n\n<p>Note that the same applies to <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"nofollow\">slices</a> and <a href=\"https://golang.org/ref/spec#Channel_types\" rel=\"nofollow\">channels</a> too; generally speaking the types that you can create using the built-in <a href=\"https://golang.org/pkg/builtin/#make\" rel=\"nofollow\"><code>make()</code></a> function. That's why the <a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow\">zero value</a> of these types is <code>nil</code>, because a value of these types need some extra initialization which is done when calling <code>make()</code>.</p>\n\n<p>In your other example you are using a <code>struct</code> value, they are not descriptors. When you pass a <code>struct</code> value to another function, that creates a complete copy of the struct value (copying values of all its fields), which \u2013when modified inside the function\u2013 will not have any effect on the original, as the memory of the copy will be modified \u2013 which is distinct.</p>\n"}], "owner": {"reputation": 6079, "user_id": 907186, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/409d9fd7356a2876a35dcd461713d749?s=128&d=identicon&r=PG", "display_name": "daltonclaybrook", "link": "https://stackoverflow.com/users/907186/daltonclaybrook"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 60, "favorite_count": 0, "accepted_answer_id": 39605565, "answer_count": 1, "score": 2, "last_activity_date": 1474417026, "creation_date": 1474414412, "last_edit_date": 1474416906, "question_id": 39605295, "link": "https://stackoverflow.com/questions/39605295/why-is-a-map-value-in-one-function-affected-by-an-entry-to-the-map-in-another-fu", "title": "Why is a map value in one function affected by an entry to the map in another function?", "body": "<p>Here's my code:</p>\n\n<pre><code>func test(v map[string]string) {\n    v[\"foo\"] = \"bar\"\n}\n\nfunc main() {\n    v := make(map[string]string)\n    test(v)\n    fmt.Printf(\"%v\\n\", v) // prints map[foo:bar]\n}\n</code></pre>\n\n<p>I'm pretty new to Go, but as far as I was aware, since I'm passing the map value to <code>test()</code> and not a pointer to the map, the <code>test()</code> function should modify a different variable of the map, and thus, not affect the value of the variable in <code>main()</code>. I would have expected it to print <code>map[]</code>. I tested a different scenario:</p>\n\n<pre><code>type myStruct struct {\n    foo int\n}\n\nfunc test2(v myStruct) {\n    v.foo = 5\n}\n\nfunc main() {\n    v := myStruct{1}\n    test2(v)\n    fmt.Printf(\"%v\\n\", v) // prints {1}\n}\n</code></pre>\n\n<p>In this scenario, the code behaves as I would expect. The <code>v</code> variable in the <code>main()</code> function is not affected by the changes to the variable in <code>test2()</code>. So why is map different?</p>\n"}, {"tags": ["go", "deadlock"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474406293, "post_id": 39603770, "comment_id": 66516308, "body": "You&#39;re copying the WaitGroup value. <code>go vet</code> will catch these errors."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474408559, "post_id": 39603770, "comment_id": 66517217, "body": "@JimB: I&#39;ll need to update the code, because I&#39;m actually using a global <code>WaitGroup</code>. That, and I&#39;ve looked at the question you linked as duplicate: Like I mentioned in the question itself: <i>I am <b>not</b> getting the all goroutines are asleep</i> error message. I&#39;m not getting any errors, it just looks like an infinite loop somewhere, somehow..."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474408876, "post_id": 39603770, "comment_id": 66517328, "body": "It is possible to create yourself a deadlock like this and not see the <code>all goroutines are asleep</code> error message, so that in itself is not an indicator of what the issue is. Now with the global WaitGroup however, your problem is that you&#39;re not receiving from the channels until after you call <code>Wait()</code>, and all the goroutines are blocked sending on the channels."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474409155, "post_id": 39603770, "comment_id": 66517422, "body": "@JimB FFS, I just fixed that... didn&#39;t stop to think that my channels aren&#39;t buffering... Added a length to the make clause, now both approaches are working. I think adding the routine worked at first, because it actually caused the <code>range</code> loop on the channel to kick in, unblocking the channels, having the channels buffer all the results is better though, so I&#39;ll use that instead"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474409754, "post_id": 39603770, "comment_id": 66517578, "body": "Yes, and if you wanted the channels unbuffered, your attempt at Wait() in a goroutine itself is still a good pattern to use: <a href=\"https://stackoverflow.com/questions/34519546/all-go-routines-are-asleep-deadlock\" title=\"all go routines are asleep deadlock\">stackoverflow.com/questions/34519546/&hellip;</a>"}], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 40, "favorite_count": 0, "closed_date": 1474406389, "answer_count": 0, "score": 1, "last_activity_date": 1474408617, "creation_date": 1474405820, "last_edit_date": 1474408617, "question_id": 39603770, "link": "https://stackoverflow.com/questions/39603770/waitgroup-deadlock-without-error-message", "closed_reason": "Duplicate", "title": "WaitGroup deadlock (without error message)", "body": "<p>I encountered an issue when creating a couple of goroutines, using a <code>sync.WaitGroup</code> to bring everything together at the right moment.</p>\n\n<p>Basically, I tried writing something like this:</p>\n\n<pre><code>//global var\nvar wg sync.WaitGroup\n\n//say inside main:\nch1 := make(chan *MyStruct) // data we're after\nch2 := make(chan string) // only used for warnings\nresult := []*MyStruct{}\nfor p := range data {\n    wg.Add(1)\n    go processData(p, ch1, ch2)\n}\nwg.Wait()\nclose(ch1)\nclose(ch2)\nfor elem := range(ch1) {\n    result = append(result, elem)\n}\nfor warn := range(ch2) {\n    log.Printf(\"%s\" warn)\n}\n</code></pre>\n\n<p>The goroutine function(s) would then look something like this:</p>\n\n<pre><code>//processData\nfunc processData(p interface{}, ch1 chan *MyStruct, ch2 chan string) {\n    defer wg.Done()\n    data := &amp;MyStruct{}\n    data.raw = p\n    //based on certain conditions, this can happen:\n    if data.NeedsMoreProcessing() {\n        wg.Add(1)\n        go additionalProcessing(data, ch2)\n    }\n    ch1 &lt;- data\n}\n\nfunc additionalProcessing(data *MyStruct, ch chan&lt;- string) {\n    defer wg.Done()\n    if err := data.ExtraStuff(); err != nil {\n        ch &lt;- fmt.Sprintf(\n            \"Additional processing on element %d failed: %s\",\n            data.Id,\n            err.Error(),\n        )\n        return\n    }\n    data.SetAdditionalInfo()\n}\n</code></pre>\n\n<p>AFAIK, I call <code>wg.Add</code> correctly (before the start of the goroutine), and I know the routines will take a while (they use <code>http.get</code> calls etc...). I did not get the common <em>\"fatal error: all goroutines are asleep - deadlock!\"</em> error message at all.</p>\n\n<p>Instead, it seemed that the <code>Wait</code> call never returned. The issue was resolved when I wrapped that call in a routine of its own, though:</p>\n\n<pre><code>go func() {\n    wg.Wait()\n    close(ch1)\n    close(ch2)\n}()\n</code></pre>\n\n<p>But other than that, everything was left as-is. Why is this, that it seems like we need to call <code>Wait</code> in a goroutine? In this case, I really don't see much of a difference. The routines in my particular case take a couple of seconds to complete, surely there's no risk of the routines completing before the <code>Wait</code> call, is there?</p>\n"}, {"tags": ["go", "int"], "answers": [{"tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 5, "last_activity_date": 1474417579, "last_edit_date": 1474417579, "creation_date": 1474405623, "answer_id": 39603725, "question_id": 39603037, "link": "https://stackoverflow.com/questions/39603037/how-do-you-get-errors-from-overflowing-int-conversions-in-go/39603725#39603725", "title": "How do you get errors from overflowing int conversions in Go?", "body": "<p>The conversions do not report overflow.</p>\n\n<p>Here's a function that handles positive and negative numbers:</p>\n\n<pre><code>func narrow(x int64) (int32, error) {\n   y := int32(x)\n   if int64(y) != x {\n      return 0, errors.New(\"overflow\")\n   }\n   return y, nil\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/eTGmFmo9Jw\" rel=\"nofollow\">playground example</a></p>\n"}], "owner": {"reputation": 28488, "user_id": 402884, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35583fe46c2cde92467710cc7ceff266?s=128&d=identicon&r=PG", "display_name": "Chris Martin", "link": "https://stackoverflow.com/users/402884/chris-martin"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 58, "favorite_count": 1, "accepted_answer_id": 39603725, "answer_count": 1, "score": 1, "last_activity_date": 1474417579, "creation_date": 1474402520, "last_edit_date": 1474402843, "question_id": 39603037, "link": "https://stackoverflow.com/questions/39603037/how-do-you-get-errors-from-overflowing-int-conversions-in-go", "title": "How do you get errors from overflowing int conversions in Go?", "body": "<p>I'm looking for integer conversion functions resembling this:</p>\n\n<pre><code>func narrow(x int64) (int32, error) { ... }\n</code></pre>\n\n<p>In this example, the function would return <code>((int32)(x), nil)</code> if <code>x</code> fits into an <code>int32</code>, and <code>(nil, someError)</code> if it doesn't.</p>\n\n<p>There seem to be a lot of <a href=\"https://golang.org/ref/spec#Conversions\" rel=\"nofollow\">conversions</a> built into the language, but they all silently swallow overflows, rather than providing a reified error. Am I missing something?</p>\n"}, {"tags": ["go", "distributed-computing", "biginteger"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474400038, "post_id": 39602001, "comment_id": 66513180, "body": "Whatever you try to accomplish: Seek a specialised algorithm. Naive algorithms with general purpose data structures won&#39;t work for such insanely big numbers, no matter how well you spread your computation horizontally."}], "answers": [{"comments": [{"owner": {"reputation": 589, "user_id": 4520017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-w04YXUYu3J8/AAAAAAAAAAI/AAAAAAAAOJU/_2vsGU9vq4Q/photo.jpg?sz=128", "display_name": "snapo", "link": "https://stackoverflow.com/users/4520017/snapo"}, "edited": false, "score": 0, "creation_date": 1474407529, "post_id": 39602367, "comment_id": 66516800, "body": "thanks very much, i (not expirienced with math) didnt know that there is even a formula for this kind of job :-) FFT will help for sure. Thanks a thousand times!!!"}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 1, "creation_date": 1474547806, "post_id": 39602367, "comment_id": 66582144, "body": "FWIW, instead of FFT and propagating carry, there are other ways that are pretty fast, e.g. Toom-Cook (3 way or one of the more complicated versions) or even something as simple as Karatsuba. These will give you a proper speed gain too, for large numbers."}, {"owner": {"reputation": 27437, "user_id": 95954, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/iD0qO.png?s=128&g=1", "display_name": "Rudy Velthuis", "link": "https://stackoverflow.com/users/95954/rudy-velthuis"}, "edited": false, "score": 0, "creation_date": 1474547935, "post_id": 39602367, "comment_id": 66582253, "body": "@Ha.: It is &quot;carry&quot;, not &quot;curry&quot;."}], "tags": [], "owner": {"reputation": 3308, "user_id": 289684, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2e0cf554b2f6c7b75ded2918fcb3d74f?s=128&d=identicon&r=PG", "display_name": "Ha.", "link": "https://stackoverflow.com/users/289684/ha"}, "is_accepted": true, "score": 3, "last_activity_date": 1474547692, "last_edit_date": 1474547692, "creation_date": 1474399819, "answer_id": 39602367, "question_id": 39602001, "link": "https://stackoverflow.com/questions/39602001/slow-int-big-calculation-and-only-on-one-thread/39602367#39602367", "title": "slow int.big calculation and only on one thread", "body": "<p>If your number is more than 100000 digits long, you need to use Fast Fourier Transform for multiplication and division: <a href=\"https://en.wikipedia.org/wiki/Multiplication_algorithm#Fourier_transform_methods\" rel=\"nofollow\">https://en.wikipedia.org/wiki/Multiplication_algorithm#Fourier_transform_methods</a> . The basic idea is to treat numbers as polynomials with x being power of 10 (or power of 2 if you want binary system). Multiply polynomials using Fast Fourier Transform and then propagate carry to get a number from a polynomial. I.e. if we need to multiply 19 by 19 and we use x = 10<sup>1</sup>, we will have (1 * x + 9) * (1 * x + 9) = x<sup>2</sup> + 18 * x + 81. Now we propagate carry to convert polynomial back to number: x<sup>2</sup> + 18 * x + 81 = x<sup>2</sup> + (18 + 8) * x + 1 = x<sup>2</sup> + 26 * x + 1 = (1 + 2) * x<sup>2</sup> + 6 * x + 1 = 3 * x<sup>2</sup> + 6 * x + 1 = 361. The trick is that polynomials can be multiplied efficiently (O(N*log(N) time) using Fast Fourier Transform. The coefficients of the product polynomial are larger than digits, so you need to choose x carefully in order to avoid integer overflow or precision problems.</p>\n\n<p>There unlikely to be a golang library for that so you will need to write it yourself. Here are a few short FFT implementations you can use as a starting point: </p>\n\n<p><a href=\"http://codeforces.com/contest/632/submission/16449753\" rel=\"nofollow\">http://codeforces.com/contest/632/submission/16449753</a> <a href=\"http://codeforces.com/contest/632/submission/16445979\" rel=\"nofollow\">http://codeforces.com/contest/632/submission/16445979</a> <a href=\"http://codeforces.com/contest/632/submission/16449040\" rel=\"nofollow\">http://codeforces.com/contest/632/submission/16449040</a> \n<a href=\"http://codeforces.com/contest/632/submission/16448169\" rel=\"nofollow\">http://codeforces.com/contest/632/submission/16448169</a></p>\n\n<p>If you decide to use FFT modulo prime, see this post for a good choice of the modulo: <a href=\"http://petr-mitrichev.blogspot.com/2015/04/this-week-in-competitive-programming.html\" rel=\"nofollow\">http://petr-mitrichev.blogspot.com/2015/04/this-week-in-competitive-programming.html</a></p>\n"}], "owner": {"reputation": 589, "user_id": 4520017, "user_type": "registered", "accept_rate": 100, "profile_image": "https://lh3.googleusercontent.com/-w04YXUYu3J8/AAAAAAAAAAI/AAAAAAAAOJU/_2vsGU9vq4Q/photo.jpg?sz=128", "display_name": "snapo", "link": "https://stackoverflow.com/users/4520017/snapo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 68, "favorite_count": 0, "accepted_answer_id": 39602367, "answer_count": 1, "score": 1, "last_activity_date": 1474547692, "creation_date": 1474398458, "question_id": 39602001, "link": "https://stackoverflow.com/questions/39602001/slow-int-big-calculation-and-only-on-one-thread", "title": "slow int.big calculation and only on one thread", "body": "<p>I use the following code in my test:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"math/big\"\n\nfunc main() {\n    input := \"3333333333333333333.......tested with 100'000x3 , tested with 1'000'0000x3, tested with 10'000'000x3\"\n    bi := big.NewInt(0)\n    if _, ok := bi.SetString(input, 10); ok {\n        fmt.Printf(\"number = %v\\n\", bi)\n\n        testval := new(big.Int)\n        testval.SetString(\"3\", 10)\n\n        resultat, isGanzzahl := myDiv(bi, testval)\n        fmt.Printf(\"isGanzzahl = %v, resultat = %v\\n\", isGanzzahl, resultat)\n    } else {\n        fmt.Printf(\"error parsing line %#v\\n\", input)\n    }\n}\n\nfunc myDiv(minuend *big.Int, subtrahend *big.Int) (*big.Int, bool) {\n    zerotest := big.NewInt(0)\n\n    modulus := new(big.Int)\n    modulus = modulus.Mod(minuend, subtrahend)\n\n    if zerotest.Cmp(modulus) == 0 {\n        res := big.NewInt(0)\n        res.Quo(minuend, subtrahend)\n        return res, true\n    } else {\n        return big.NewInt(0), false\n    }\n}\n</code></pre>\n\n<ul>\n<li>100'000 x 3 / 3 == not even a quater second </li>\n<li>1'000'000 x 3 / 3 == 9.45 seconds</li>\n<li>10'000'000 x 3 / 3 == 16.1 minute</li>\n</ul>\n\n<p>Im looking for a way to make this happens much much faster. If i would like to do this multithreaded in go how do i do this with go-routines? Is there a faster way to do a division with larger numbers?</p>\n\n<p>As this is just for testing i planned to use Numbers in the range of 100'000'000 - 1'000'000'000 digits (which would then be 1GB of ram usage). But 1 billion digits would not work because it would take years to complete.</p>\n\n<p>What would then happen if it is N / M ? Where N=1billion digit, M=10million digit. Is this even possible on a powerful home computer?</p>\n\n<p>How would it look / or what do i have to change to being able to distribute this work to multiple small computer (for example AWS)?</p>\n"}, {"tags": ["go", "closures"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474396335, "post_id": 39601230, "comment_id": 66511055, "body": "You can&#39;t at runtime. The compiler probably won&#39;t even include variables in the scope if there&#39;s no references to them."}, {"owner": {"reputation": 53, "user_id": 2788522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/174cea960a3c6dc83f53e42a6a333f95?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2788522/steve"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474396606, "post_id": 39601230, "comment_id": 66511190, "body": "@JimB That makes sense. Thank you!"}], "answers": [{"tags": [], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "is_accepted": false, "score": 0, "last_activity_date": 1474931102, "creation_date": 1474931102, "answer_id": 39713687, "question_id": 39601230, "link": "https://stackoverflow.com/questions/39601230/print-all-variables-captured-by-closure/39713687#39713687", "title": "Print all variables captured by closure", "body": "<p>This is impossible in Go. You can't ask for your surrounding environment in a closure. It's there to use, but you can't view/read it. You could do something weird like have them in a struct and view your struct, but depending on what you do, that could get very messy and non-idiomatic.</p>\n"}], "owner": {"reputation": 53, "user_id": 2788522, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/174cea960a3c6dc83f53e42a6a333f95?s=128&d=identicon&r=PG&f=1", "display_name": "Steve", "link": "https://stackoverflow.com/users/2788522/steve"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474931102, "creation_date": 1474395893, "question_id": 39601230, "link": "https://stackoverflow.com/questions/39601230/print-all-variables-captured-by-closure", "title": "Print all variables captured by closure", "body": "<p>How do I print out all variables that are captured by a closure? For example:</p>\n\n<pre><code>func myScope() {\n  users := GetUsers(\"John\")\n  services := GetServices(\"Movies\")\n  allVariablesString := func() string {\n    return PrintAllCapturesWithoutSpecified()\n  }()\n}\n</code></pre>\n\n<p>I plan to utilize this idea if possible to log any involved values within the scope of an error without manually specify each variable.</p>\n"}, {"tags": ["go", "rethinkdb"], "answers": [{"tags": [], "owner": {"reputation": 554, "user_id": 595810, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/3772bef568ee12d860832bb2fa113745?s=128&d=identicon&r=PG", "display_name": "Daniel Cannon", "link": "https://stackoverflow.com/users/595810/daniel-cannon"}, "is_accepted": true, "score": 1, "last_activity_date": 1474398018, "creation_date": 1474398018, "answer_id": 39601879, "question_id": 39601018, "link": "https://stackoverflow.com/questions/39601018/update-certain-values-in-update-request/39601879#39601879", "title": "Update certain values in update request", "body": "<p>You should be able to use the following query to update all of a users posts to read:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>r.Table(\"Notifications\").Filter(r.Row.Field(\"UserId\").Eq(userId)).Update(map[string]interface{}{\"read\": false})\n</code></pre>\n\n<p>I hope this helps! </p>\n"}], "owner": {"reputation": 770, "user_id": 5347945, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/314fa7f57283b7ee9f1a207bb9d44828?s=128&d=identicon&r=PG&f=1", "display_name": "Fantasim", "link": "https://stackoverflow.com/users/5347945/fantasim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 40, "favorite_count": 0, "accepted_answer_id": 39601879, "answer_count": 1, "score": 0, "last_activity_date": 1474398018, "creation_date": 1474395178, "question_id": 39601018, "link": "https://stackoverflow.com/questions/39601018/update-certain-values-in-update-request", "title": "Update certain values in update request", "body": "<p>i've a notification list, i would like update their status as read</p>\n\n<p><strong>Notification struct</strong> :</p>\n\n<pre><code>type Notification struct {\n    Id string `gorethink:\"id,omitempty\"`\n    UserId string\n    Content string\n    Read bool\n    CreatedAt time.Time\n}\n</code></pre>\n\n<p>in my handle function to get notification i put something like this :</p>\n\n<pre><code>func getLastNotifications(w http.ResponseWriter, r *http.Request){\n     ret := notification.getLastNotification()\n     userId := getCurrentUserId()\n\n         go func(){\n            r.Table(\"Notifications\").Filter(r.Row.Field(\"UserId\").Eq(userId)).Update(func(term r.Term) r.Term{\n        //And here i would like only update each Notification with {Read: true}\n    })\n}()\n\n\n     RenderJSON(http.StatusOK, ret)\n}\n</code></pre>\n\n<p>As explained in the code I will wish to update <strong>Read</strong> to <strong>true</strong> in each <strong>Notification</strong> belonging to the user.</p>\n\n<p>So how can i do that ?\nThanks</p>\n"}, {"tags": ["json", "xml", "go"], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 1, "last_activity_date": 1474431214, "creation_date": 1474431214, "answer_id": 39607444, "question_id": 39599738, "link": "https://stackoverflow.com/questions/39599738/xml-to-json-with-transform/39607444#39607444", "title": "XML to json with transform", "body": "<p>Field tags in Go allow specifying any number of distinct values \u2014 separated by spaces.\nSo in your simple case just add <code>json:\"value\"</code> after <code>xml:\"...\"</code> and then marshal\nthe unmarshaled value to JSON.</p>\n\n<p>Note that I mean spaces inside a single tag, not a space-separated tags:</p>\n\n<pre><code>Field string `xml:\"myns Xyzzy\" json:\"Blorb\"`\n</code></pre>\n\n<p>In more complex cases it might be needed to have distinct types for unmarshaling\nand marshaling, and shovel data with required intermediate conversions\nbetween the values of these types.</p>\n"}], "owner": {"reputation": 10120, "user_id": 625242, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1389db52960d25b641fbe4ef92346de7?s=128&d=identicon&r=PG", "display_name": "Elad Lachmi", "link": "https://stackoverflow.com/users/625242/elad-lachmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 77, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474431214, "creation_date": 1474390352, "question_id": 39599738, "link": "https://stackoverflow.com/questions/39599738/xml-to-json-with-transform", "title": "XML to json with transform", "body": "<p>I have the following XML:</p>\n\n<pre><code>&lt;ArrayOfAnyType xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n    &lt;anyType xsi:type=\"xsd:dateTime\"&gt;2016-09-14T13:58:30Z&lt;/anyType&gt;\n    &lt;anyType xsi:type=\"xsd:decimal\"&gt;1.2&lt;/anyType&gt;\n&lt;/ArrayOfAnyType&gt;\n</code></pre>\n\n<p>And I am unmarshaling it to the following structs:</p>\n\n<pre><code>type Value struct {\n    Data []Data `xml:\"anyType\"`\n}\n\ntype Data struct {\n    Key string `xml:\"http://www.w3.org/2001/XMLSchema-instance type,attr\"`\n    Value string `xml:\",chardata\"`\n}\n</code></pre>\n\n<p>I would ultimately like to marshal them to json of this structure:</p>\n\n<pre><code>{\n   timestamp: [the value of xsi:type=\"xsd:dateTime\"]\n   value: [the value of xsi:type=\"xsd:decimal\"]\n}\n</code></pre>\n\n<p>I'm new to Go, so I'm not sure if this is even possible.</p>\n"}, {"tags": ["go", "consul", "consul-template"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474390851, "post_id": 39599136, "comment_id": 66508160, "body": "I know Go templates, but I don&#39;t know consul. Maybe something like <code>{{range $i := loop 2}}{{$service := (index (service &quot;foo&quot; &quot;passing&quot;))}}{{$service.Address}}{{end}}</code>? This will fail if there are less than two though."}, {"owner": {"reputation": 73, "user_id": 4457514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/418e43fd72adea50527f9af349235722?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus", "link": "https://stackoverflow.com/users/4457514/magnus"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474639806, "post_id": 39599136, "comment_id": 66627556, "body": "From what I have gathered, it seems like $service is an array so <code>{{$service.Address}}</code> threw an error as there is not .Address element in the $service. On top of that, how did we restrict the number of Addresses we print? I tried to work in this direction and tried to do a <code>{{$x := service &quot;foo&quot; &quot;passing&quot;}}{{range $i := loop 2}}{{$y := (index $x $i)}}{{$y.Address}}{{end}}</code>, but it gave &#39;index out of bound:0&#39; error. Perhaps I am not using the index function right."}], "answers": [{"tags": [], "owner": {"reputation": 73, "user_id": 4457514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/418e43fd72adea50527f9af349235722?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus", "link": "https://stackoverflow.com/users/4457514/magnus"}, "is_accepted": false, "score": 0, "last_activity_date": 1474639226, "creation_date": 1474639226, "answer_id": 39662700, "question_id": 39599136, "link": "https://stackoverflow.com/questions/39599136/in-consul-template-how-to-limit-the-number-of-elements-over-which-i-am-ranging/39662700#39662700", "title": "In consul-template, how to limit the number of elements over which I am ranging?", "body": "<p>Found a solution to limit the number of array elements that can be rendered using consul-template.</p>\n\n<pre><code>    {{$x := service \"service@datacenter\" \"passing\"}}{{range $index, $element := $x}}{{if lt $index 2}}{{$element.Address}},{{end}}{{end}}\n</code></pre>\n\n<p>The range function provides an index variable along with the array element that can be used to check for the limit using the if block. Here the only two Addresses would be rendered.</p>\n"}], "owner": {"reputation": 73, "user_id": 4457514, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/418e43fd72adea50527f9af349235722?s=128&d=identicon&r=PG&f=1", "display_name": "Magnus", "link": "https://stackoverflow.com/users/4457514/magnus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 914, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474639226, "creation_date": 1474388255, "last_edit_date": 1474447866, "question_id": 39599136, "link": "https://stackoverflow.com/questions/39599136/in-consul-template-how-to-limit-the-number-of-elements-over-which-i-am-ranging", "title": "In consul-template, how to limit the number of elements over which I am ranging?", "body": "<p>Following is my code to render the Addresses of the nodes with a service:</p>\n\n<pre><code>    {{range \"service@datacenter\" \"passing\"}}{{.Address}} {{end}}\n</code></pre>\n\n<p>What I want to do is limit the number of addresses that are rendered. For example, if there are 5 nodes registered as providers of \"service\", I would like is to print addresses of 2 of them only. What I think I should be doing is slicing the array, but I am not able to get the GO syntax right. This is something that I want but is not syntactically correct:</p>\n\n<pre><code>    {{range \"service@datacenter\" \"passing\" [0:2]}}{{.Address}} {{end}}\n</code></pre>\n\n<p>What is the correct way to do this?</p>\n"}, {"tags": ["go", "firebase", "oauth-2.0", "jwt", "firebase-authentication"], "answers": [{"tags": [], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "is_accepted": true, "score": 1, "last_activity_date": 1474388704, "creation_date": 1474388704, "answer_id": 39599278, "question_id": 39598696, "link": "https://stackoverflow.com/questions/39598696/authenticating-a-service-account-for-firebase-realtime-database-in-go/39599278#39599278", "title": "Authenticating a service account for Firebase Realtime Database in Go", "body": "<p>Ugh, I found the <strong>undocumented</strong> answer <a href=\"https://groups.google.com/forum/?utm_medium=email&amp;utm_source=footer#!msg/firebase-talk/s0wtW8wCwl8/59tAn0SOAwAJ\" rel=\"nofollow\">here</a>. Currently you also need this scope:</p>\n\n<pre><code>https://www.googleapis.com/auth/userinfo.email\n</code></pre>\n"}], "owner": {"reputation": 67096, "user_id": 265521, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/34a66330977044d70165288c56740d4b?s=128&d=identicon&r=PG", "display_name": "Timmmm", "link": "https://stackoverflow.com/users/265521/timmmm"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 983, "favorite_count": 0, "accepted_answer_id": 39599278, "answer_count": 1, "score": 0, "last_activity_date": 1474395318, "creation_date": 1474386885, "last_edit_date": 1474395318, "question_id": 39598696, "link": "https://stackoverflow.com/questions/39598696/authenticating-a-service-account-for-firebase-realtime-database-in-go", "title": "Authenticating a service account for Firebase Realtime Database in Go", "body": "<p>I'm trying to use the new Firebase Realtime Database for a simple logging application. All interraction with the database will be from my server, so I only need one account that can read/write anything.</p>\n\n<p>As far as I can tell (the documentation is awful - there's plenty of it but it contradicts itself and half of it is for the 'old' Firebase, and often it is in some random language that you aren't using), I need to create a service account and then create a JWT token using OAuth. Fortunately Go has some nice built in libraries for this. Here is my code:</p>\n\n<pre><code>const firebasePostUrl = \"https://my-product-logging.firebaseio.com/tests.json\"\n\n// Obtained from the Google Cloud API Console\nvar firebaseServiceAccount map[string]string = map[string]string{\n    \"type\":                        \"service_account\",\n    \"project_id\":                  \"my-product-logging\",\n    \"private_key_id\":              \"1c35ac0c501617b8f1610113c492a5d3321f4318\",\n    \"private_key\":                 \"-----BEGIN PRIVATE KEY-----\\nMIIEvQIBADANBgkqhkiG9w0BAQEFAASCBKcwggSjAgEAAoblahblahhwWlteuRDrsxmRq+8\\ncDGMKcXyDHl3nWdIrWqJcDw=\\n-----END PRIVATE KEY-----\\n\",\n    \"client_email\":                \"log-user@my-product-logging.iam.gserviceaccount.com\",\n    \"client_id\":                   \"101403085113430683797\",\n    \"auth_uri\":                    \"https://accounts.google.com/o/oauth2/auth\",\n    \"token_uri\":                   \"https://accounts.google.com/o/oauth2/token\",\n    \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\n    \"client_x509_cert_url\":        \"https://www.googleapis.com/robot/v1/metadata/x509/log-user%40my-product-logging.iam.gserviceaccount.com\",\n}\n\nfunc firebaseClient() *http.Client {\n    jwtConfig := jwt.Config{\n        // Email is the OAuth client identifier used when communicating with\n        // the configured OAuth provider.\n        Email: firebaseServiceAccount[\"client_email\"],\n\n        // PrivateKey contains the contents of an RSA private key or the\n        // contents of a PEM file that contains a private key. The provided\n        // private key is used to sign JWT payloads.\n        // PEM containers with a passphrase are not supported.\n        // Use the following command to convert a PKCS 12 file into a PEM.\n        //\n        //    $ openssl pkcs12 -in key.p12 -out key.pem -nodes\n        //\n        PrivateKey: []byte(firebaseServiceAccount[\"private_key\"]),\n\n        // PrivateKeyID contains an optional hint indicating which key is being\n        // used.\n        PrivateKeyID: firebaseServiceAccount[\"private_key_id\"],\n\n        // Subject is the optional user to impersonate.\n        Subject: \"\",\n\n        // Scopes optionally specifies a list of requested permission scopes.\n        Scopes: []string{\n            \"https://www.googleapis.com/auth/devstorage.readonly\",\n        },\n\n        // TokenURL is the endpoint required to complete the 2-legged JWT flow.\n        TokenURL: firebaseServiceAccount[\"token_uri\"],\n\n        // Expires optionally specifies how long the token is valid for.\n        Expires: 0,\n    }\n\n    ctx := context.Background()\n    return jwtConfig.Client(ctx)\n}\n\nfunc firebaseFunc() {\n\n    authedClient := firebaseClient()\n\n    msg := map[string]string{\n        \"hello\": \"there\",\n        \"every\": \"one\",\n    }\n\n    data, err := json.Marshal(msg)\n    if err != nil {\n        log.Fatal(\"JSON Marshall Error: \", err)\n        continue\n    }\n\n    resp, err := authedClient.Post(firebasePostUrl, \"application/json\", bytes.NewReader(data))\n    if err != nil {\n        log.Fatal(\"Firebase Error: \", err)\n        continue\n    }\n\n    log.Print(\"Firebase Response Code: \", resp.StatusCode)\n}\n</code></pre>\n\n<p>The problem is, I always get this error:</p>\n\n<pre><code>{\n  \"error\" : \"invalid_scope\",\n  \"error_description\" : \"https://www.googleapis.com/auth/devstorage.readonly is not a valid audience string.\"\n}\n</code></pre>\n\n<p>I assume it is a type that the error is <code>invalid_</code><strong><code>scope</code></strong>, and the description says it is an invalid <strong><code>audience</code></strong> (I assume the JWT <code>aud</code> parameter).</p>\n\n<p>What do I use as my scope to allow me to read/write the Firebase Database (using the default <code>\"auth != null\"</code> rules)?</p>\n\n<p>Edit: I found the answer <a href=\"https://developers.google.com/identity/protocols/googlescopes#firebaserulesv1\" rel=\"nofollow\">here</a> finally:</p>\n\n<pre><code>https://www.googleapis.com/auth/firebase\n</code></pre>\n\n<p>However now it gives me a 403 response when actually doing the post.</p>\n\n<pre><code>{\n  \"error\" : \"Permission denied.\"\n}\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 5533, "user_id": 6392939, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e4e950198a9f8742974cf43adc2ac18a?s=128&d=identicon&r=PG&f=1", "display_name": "RamenChef", "link": "https://stackoverflow.com/users/6392939/ramenchef"}, "edited": false, "score": 2, "creation_date": 1474384929, "post_id": 39597616, "comment_id": 66504302, "body": "Try <code>c.JSON(200, string(y))</code>. <code>y</code> shouldn&#39;t need <code>json.Marshal</code>."}, {"owner": {"reputation": 24240, "user_id": 495935, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d310e51ac60b2a54b68b96e90593277b?s=128&d=identicon&r=PG", "display_name": "Surreal Dreams", "link": "https://stackoverflow.com/users/495935/surreal-dreams"}, "edited": false, "score": 0, "creation_date": 1474395014, "post_id": 39597616, "comment_id": 66510261, "body": "You can make the JSON string a lot more readable by wrapping it in backticks <code>`</code> - then you don&#39;t need to escape all the quotes.  Much cleaner."}], "answers": [{"tags": [], "owner": {"reputation": 3079, "user_id": 689424, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/05ffd09ae496b61db8fce4e1aaaf50f5?s=128&d=identicon&r=PG", "display_name": "onetwopunch", "link": "https://stackoverflow.com/users/689424/onetwopunch"}, "is_accepted": true, "score": 4, "last_activity_date": 1474384989, "creation_date": 1474384989, "answer_id": 39597988, "question_id": 39597616, "link": "https://stackoverflow.com/questions/39597616/how-to-send-a-hardcoded-complex-json-respnse-in-golang/39597988#39597988", "title": "How to send a hardcoded complex json respnse in Golang", "body": "<p>If you already have the JSON encoded string, you do not need Marshal, you just need to send down the string. By Marshalling here you are encoding your JSON string into a JSON string so Go is escaping it. Just send down the string if you have it.</p>\n"}, {"tags": [], "owner": {"reputation": 735, "user_id": 6697038, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Eqwd8.jpg?s=128&g=1", "display_name": "nosequeldeebee", "link": "https://stackoverflow.com/users/6697038/nosequeldeebee"}, "is_accepted": false, "score": 0, "last_activity_date": 1474408421, "creation_date": 1474408421, "answer_id": 39604306, "question_id": 39597616, "link": "https://stackoverflow.com/questions/39597616/how-to-send-a-hardcoded-complex-json-respnse-in-golang/39604306#39604306", "title": "How to send a hardcoded complex json respnse in Golang", "body": "<p>I think the OP is more concerned about the backslashes in his JSON string than the unnecessary <code>json.Marshal</code> (more on that below)</p>\n\n<p><strong><em>You can use <code>strconv.Unquote</code> on your JSON string to clean up the back slashes</em></strong>.</p>\n\n<p><code>s, _ := strconv.Unquote(y)\nfmt.Println(s)</code></p>\n\n<p>You don't need to Marshal <code>y</code>, which turns it into bytes then convert it back into a string. You can pass <code>y</code> right down to <code>c.JSON</code></p>\n\n<p>You want to use Marshal when you have a <code>struct</code> that you want to bundle into JSON.</p>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 662, "favorite_count": 0, "accepted_answer_id": 39597988, "answer_count": 2, "score": 0, "last_activity_date": 1474408421, "creation_date": 1474383938, "last_edit_date": 1474394920, "question_id": 39597616, "link": "https://stackoverflow.com/questions/39597616/how-to-send-a-hardcoded-complex-json-respnse-in-golang", "title": "How to send a hardcoded complex json respnse in Golang", "body": "<p>I am trying to send some complex data as JSON response to one of my rest APIs as follows:</p>\n\n<pre><code>   y := \"[ { \\\"region\\\":\\\"North America\\\", \\\"countries\\\":[{\\\"country\\\" : \\\"United States of America\\\",\\\"states\\\"\" +\n    \":[\\\"California\\\", \\\"New York\\\", ], }, {\\\"country\\\" : \\\"Canada\\\",\\\"states\\\" : [\\\"Ontario\\\", \\\"Quebec\\\",], }] },\" +\n    \"{\\\"region\\\": \\\"Asia\\\",\\\"countries\\\": [{\\\"country\\\" :\\\"China\\\",\\\"states\\\" : [\\\"Fujian\\\", \\\"Guangzhou\\\" ]}, {\" +\n    \"\\\"country\\\" : \\\"Japan\\\", \\\"states\\\" : [ \\\"Kyushu\\\", \\\"Hokaido\\\" ] }  ]  }]\"\n\n    x, err := json.Marshal(y)\n    fmt.Println(err)\n\n    c.JSON(200, string(x))\n</code></pre>\n\n<p>In response I get:</p>\n\n<pre><code>\"\\\"[ { \\\"region\\\":\\\"North America\\\", \\\"countries\\\":[{\\\"country\\\" : \\\"United States of America\\\",\\\"states\\\":[\\\"California\\\", \\\"New York\\\", ], }, {\\\"country\\\" : \\\"Canada\\\",\\\"states\\\" : [\\\"Ontario\\\", \\\"Quebec\\\",], }] },{\\\"region\\\": \\\"Asia\\\",\\\"countries\\\": [{\\\"country\\\" :\\\"China\\\",\\\"states\\\" : [\\\"Fujian\\\", \\\"Guangzhou\\\" ]}, {\\\"country\\\" : \\\"Japan\\\", \\\"states\\\" : [ \\\"Kyushu\\\", \\\"Hokaido\\\" ] }  ]  }]\\\"\"\n</code></pre>\n\n<p>How do I get rid of these trailing <code>\\</code> in the response? If I remove them from <code>y</code>, the code does not compile.</p>\n"}, {"tags": ["xml", "go"], "comments": [{"owner": {"reputation": 11736, "user_id": 1987838, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/2tIuS.jpg?s=128&g=1", "display_name": "Hackerman", "link": "https://stackoverflow.com/users/1987838/hackerman"}, "edited": false, "score": 0, "creation_date": 1474385438, "post_id": 39597342, "comment_id": 66504644, "body": "My first attempt using go, change to utf-8:   <a href=\"https://play.golang.org/p/nLrdzuUSo0\" rel=\"nofollow noreferrer\">play.golang.org/p/nLrdzuUSo0</a>"}], "answers": [{"comments": [{"owner": {"reputation": 10120, "user_id": 625242, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1389db52960d25b641fbe4ef92346de7?s=128&d=identicon&r=PG", "display_name": "Elad Lachmi", "link": "https://stackoverflow.com/users/625242/elad-lachmi"}, "edited": false, "score": 0, "creation_date": 1474387837, "post_id": 39597752, "comment_id": 66506297, "body": "Works like a charm. Thank you!"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 5, "last_activity_date": 1474384319, "creation_date": 1474384319, "answer_id": 39597752, "question_id": 39597342, "link": "https://stackoverflow.com/questions/39597342/parse-xml-in-go/39597752#39597752", "title": "Parse XML in Go", "body": "<p>Firstly, your document states that it's encoded in UTF-16, which means you need to either set decoder's <code>CharsetReader</code>, or remove it and interpret the document as UTF-8.</p>\n\n<p>Secondly, your <code>xsi:type,attr</code> should use the namespace URL, so it's <code>http://www.w3.org/2001/XMLSchema-instance type,attr</code>.</p>\n\n<p>With those two in mind, your thing works: <a href=\"https://play.golang.org/p/Nu3wyEQ_dO\" rel=\"noreferrer\">https://play.golang.org/p/Nu3wyEQ_dO</a>.</p>\n"}], "owner": {"reputation": 10120, "user_id": 625242, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/1389db52960d25b641fbe4ef92346de7?s=128&d=identicon&r=PG", "display_name": "Elad Lachmi", "link": "https://stackoverflow.com/users/625242/elad-lachmi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 657, "favorite_count": 0, "accepted_answer_id": 39597752, "answer_count": 1, "score": 2, "last_activity_date": 1474384319, "creation_date": 1474383194, "question_id": 39597342, "link": "https://stackoverflow.com/questions/39597342/parse-xml-in-go", "title": "Parse XML in Go", "body": "<p>I have the following XML:</p>\n\n<pre><code>&lt;?xml version=\"1.0\" encoding=\"utf-16\"?&gt;\n&lt;ArrayOfAnyType xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"&gt;\n    &lt;anyType xsi:type=\"xsd:dateTime\"&gt;2016-09-14T13:58:30Z&lt;/anyType&gt;\n    &lt;anyType xsi:type=\"xsd:decimal\"&gt;1.2&lt;/anyType&gt;\n&lt;/ArrayOfAnyType&gt;\n</code></pre>\n\n<p>I'm trying to unmarshal it to this struct:</p>\n\n<pre><code>type Value struct {\n    XMLName xml.Name `xml:\"ArrayOfAnyType\"`\n    Data []Data `xml:\"anyType\"`\n}\n\ntype Data struct {\n    Key string `xml:\"xsi:type,attr\"`\n    Value string `xml:\",chardata\"`\n}\n</code></pre>\n\n<p>There is no error thrown, but the values of the resulting struct are empty. I tried following several examples I found online, but I'm new to Go, so I might be missing something obvious.</p>\n"}, {"tags": ["rest", "reactjs", "go", "gorilla"], "answers": [{"tags": [], "owner": {"reputation": 107, "user_id": 1869534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5423984a83f2ca43134bc1f3284c5e8?s=128&d=identicon&r=PG", "display_name": "lukashambsch", "link": "https://stackoverflow.com/users/1869534/lukashambsch"}, "is_accepted": true, "score": 1, "last_activity_date": 1474402415, "creation_date": 1474402415, "answer_id": 39603015, "question_id": 39597109, "link": "https://stackoverflow.com/questions/39597109/how-do-i-make-a-put-request-from-fetch-to-my-go-api/39603015#39603015", "title": "How do I make a PUT request from fetch to my go API?", "body": "<p>In case someone else comes across a similar issue, I was able to get this working by adding the JSON header to my CORS function(instead of the WriteJSON function) like this:</p>\n\n<pre><code>func CORS(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        w.Header().Set(\"Content-Type\", \"application/json; charset=UTF-8\")\n        w.Header().Set(\"Access-Control-Allow-Origin\", r.Header.Get(\"Origin\"))\n        w.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS, PUT, DELETE\")\n        w.Header().Set(\n            \"Access-Control-Allow-Headers\",\n            \"Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization\",\n        )\n        w.Header().Set(\"Access-Control-Allow-Credentials\", \"true\")\n\n        if r.Method == \"OPTIONS\" {\n            return\n        }\n        h.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>After I added that, the request was still not working with fetch. So, I switched tried it with axios again and it worked. Here is what the new request code looks like with axios.</p>\n\n<pre><code>export function putVisit(visit) {\n  return function(dispatch) {\n    return axios.put(`http://localhost:8080/api/v1/visits/${visit.visit_id}/`, visit)\n      .then(response =&gt;\n        dispatch(updateVisit(response.data))\n      )\n      .catch(err =&gt;\n        console.log(err)\n      )\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 1869534, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/c5423984a83f2ca43134bc1f3284c5e8?s=128&d=identicon&r=PG", "display_name": "lukashambsch", "link": "https://stackoverflow.com/users/1869534/lukashambsch"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3105, "favorite_count": 0, "accepted_answer_id": 39603015, "answer_count": 1, "score": 3, "last_activity_date": 1474402415, "creation_date": 1474382534, "question_id": 39597109, "link": "https://stackoverflow.com/questions/39597109/how-do-i-make-a-put-request-from-fetch-to-my-go-api", "title": "How do I make a PUT request from fetch to my go API?", "body": "<p>I am creating a REST API with Go (using Gorilla mux) and a frontend app with React. The GET requests work fine, but I'm having trouble getting the PUT request to work correctly. It makes the OPTIONS preflight request successfully, but never the PUT request. I may be handling it incorrectly on the backend or making the request incorrectly. I'm created a middleware that will add the CORS headers because the gorilla toolkit's CORS handlers weren't allowing the OPTIONS request at all. I have also tried using axios instead of fetch to make sure it wasn't something I was doing incorrectly in the request. I was getting the exact same behavior with axios.</p>\n\n<p>Here is the router:</p>\n\n<pre><code>var V1URLBase string = \"/api/v1\"\n\nfunc Load() http.Handler {\n\n    r := mux.NewRouter().StrictSlash(true)\n\n    // Status endpoints\n    s := r.PathPrefix(fmt.Sprintf(\"%s%s\", V1URLBase, \"/statuses\")).Subrouter()\n\n    s.HandleFunc(\"/\", handlers.GetStatuses).\n        Methods(\"GET\")\n    s.HandleFunc(\"/{status_id}/\", handlers.GetStatus).\n        Methods(\"GET\")\n    s.HandleFunc(\"/\", handlers.PostStatus).\n        Methods(\"POST\")\n    s.HandleFunc(\"/{status_id}/\", handlers.PutStatus).\n        Methods(\"PUT\")\n    s.HandleFunc(\"/{status_id}/\", handlers.DeleteStatus).\n        Methods(\"DELETE\")\n\n    // Visit endpoints\n    v := r.PathPrefix(fmt.Sprintf(\"%s%s\", V1URLBase, \"/visits\")).Subrouter()\n\n    v.HandleFunc(\"/\", handlers.GetVisits).\n        Methods(\"GET\")\n    v.HandleFunc(\"/{visit_id}/\", handlers.GetVisit).\n        Methods(\"GET\")\n    v.HandleFunc(\"/\", handlers.PostVisit).\n        Methods(\"POST\")\n    v.HandleFunc(\"/{visit_id}/\", handlers.PutVisit).\n        Methods(\"PUT\")\n    v.HandleFunc(\"/{visit_id}/\", handlers.DeleteVisit).\n        Methods(\"DELETE\")\n\n    // Member endpoints\n    m := r.PathPrefix(fmt.Sprintf(\"%s%s\", V1URLBase, \"/members\")).Subrouter()\n\n    m.HandleFunc(\"/\", handlers.GetMembers).\n        Methods(\"GET\")\n    m.HandleFunc(\"/{member_id}/\", handlers.GetMember).\n        Methods(\"GET\")\n    m.HandleFunc(\"/\", handlers.PostMember).\n        Methods(\"POST\")\n    m.HandleFunc(\"/{member_id}/\", handlers.PutMember).\n        Methods(\"PUT\")\n    m.HandleFunc(\"/{member_id}/\", handlers.DeleteMember).\n        Methods(\"DELETE\")\n\n    // GymLocation endpoints\n    gl := r.PathPrefix(fmt.Sprintf(\"%s%s\", V1URLBase, \"/gym_locations\")).Subrouter()\n\n    gl.HandleFunc(\"/\", handlers.GetGymLocations).\n        Methods(\"GET\")\n    gl.HandleFunc(\"/{gym_location_id}/\", handlers.GetGymLocation).\n        Methods(\"GET\")\n    gl.HandleFunc(\"/\", handlers.PostGymLocation).\n        Methods(\"POST\")\n    gl.HandleFunc(\"/{gym_location_id}/\", handlers.PutGymLocation).\n        Methods(\"PUT\")\n    gl.HandleFunc(\"/{gym_location_id}/\", handlers.DeleteGymLocation).\n        Methods(\"DELETE\")\n\n    router := ghandlers.LoggingHandler(os.Stdout, r)\n    router = handlers.WriteCORSHeaders(r)\n\n    return router\n}\n</code></pre>\n\n<p>Here is the CORS handler:</p>\n\n<pre><code>func WriteCORSHeaders(h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        fmt.Println(\"HIT\")\n        w.Header().Set(\"Access-Control-Allow-Origin\", r.Header.Get(\"Origin\"))\n        w.Header().Set(\"Access-Control-Allow-Methods\", \"POST, GET, OPTIONS, PUT, DELETE\")\n        w.Header().Set(\n            \"Access-Control-Allow-Headers\",\n            \"Accept, Content-Type, Content-Length, Accept-Encoding, X-CSRF-Token, Authorization\",\n        )\n        //w.Header().Set(\"Access-Control-Allow-Credentials\", \"true\")\n\n        if r.Method == \"OPTIONS\" {\n            return\n        }\n\n        h.ServeHTTP(w, r)\n    })\n}\n</code></pre>\n\n<p>Here is the PUT handler:</p>\n\n<pre><code>func PutVisit(w http.ResponseWriter, r *http.Request) {\n    body, _ := ioutil.ReadAll(r.Body)\n    r.Body.Close()\n\n    visitId, err := strconv.ParseInt(mux.Vars(r)[VisitId], 10, 64)\n    if err != nil {\n        WriteJSON(w, http.StatusBadRequest, APIErrorMessage{Message: InvalidVisitId})\n        return\n    }\n\n    visit := &amp;models.Visit{}\n    err = json.Unmarshal(body, visit)\n    if err != nil {\n        WriteJSON(w, http.StatusBadRequest, APIErrorMessage{Message: err.Error()})\n        return\n    }\n\n    updated, err := datastore.UpdateVisit(visitId, *visit)\n    if err != nil {\n        WriteJSON(w, http.StatusInternalServerError, APIErrorMessage{Message: err.Error()})\n        return\n    }\n\n    WriteJSON(w, http.StatusOK, updated)\n}\n\nfunc WriteJSON(w http.ResponseWriter, statusCode int, response interface{}) {\n    encoder := json.NewEncoder(w)\n    w.Header().Set(\"Content-Type\", \"application/json; charset=UTF-8\")\n    w.WriteHeader(statusCode)\n    encoder.Encode(response)\n}\n</code></pre>\n\n<p>Here is the main that starts the server:</p>\n\n<pre><code>func main() {\n    r := router.Load()\n\n    http.ListenAndServe(\":8080\", r)\n}\n</code></pre>\n\n<p>Here is my request from Reactjs:</p>\n\n<pre><code>export function putVisit(visit) {\n  return function(dispatch) {\n    return fetch(`http://localhost:8080/api/v1/visits/${visit.visit_id}/`, {\n      method: 'PUT',\n      headers: {\n        'Accept': 'application/json; charset=UTF-8',\n        'Content-Type': 'application/json; charset=UTF-8'\n      },\n      body: JSON.stringify(visit)\n    })\n      .then(response =&gt; response.json())\n      .then(json =&gt;\n        dispatch(updateVisit(json))\n      )\n      .catch(err =&gt;\n        console.log(err)\n      )\n  }\n}\n</code></pre>\n"}, {"tags": ["windows", "go", "shutdown"], "comments": [{"owner": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 1, "creation_date": 1474378592, "post_id": 39595252, "comment_id": 66499876, "body": "<a href=\"https://golang.org/pkg/syscall/#Shutdown\" rel=\"nofollow noreferrer\">golang.org/pkg/syscall/#Shutdown</a>?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 51399, "user_id": 1553888, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/01ac05cf8db6f338aef3c2f65e348f5d?s=128&d=identicon&r=PG", "display_name": "u_mulder", "link": "https://stackoverflow.com/users/1553888/u-mulder"}, "edited": false, "score": 1, "creation_date": 1474386417, "post_id": 39595252, "comment_id": 66505369, "body": "@u_mulder I don&#39;t think so. <a href=\"https://golang.org/pkg/syscall/#Shutdown\" rel=\"nofollow noreferrer\"><code>syscall.Shutdown()</code></a> is to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740481(v=vs.85).aspx\" rel=\"nofollow noreferrer\">shutdown a socket</a>, not the operating system."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 10, "last_activity_date": 1474527033, "last_edit_date": 1474527033, "creation_date": 1474386034, "answer_id": 39598382, "question_id": 39595252, "link": "https://stackoverflow.com/questions/39595252/shutting-down-windows-using-golang-code/39598382#39598382", "title": "Shutting down windows using golang code", "body": "<p>There is no \"Shutdown OS\" function in the <a href=\"https://golang.org/pkg/syscall/\" rel=\"noreferrer\"><code>syscall</code></a> package, because there is no common interface provided for that by all operating systems.</p>\n\n<p><sup>Note: there is a <a href=\"https://golang.org/pkg/syscall/#Shutdown\" rel=\"noreferrer\"><code>syscall.Shutdown()</code></a> function, but that is to <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/ms740481(v=vs.85).aspx\" rel=\"noreferrer\">shutdown a socket</a>, and not to shutdown the operating system.</sup></p>\n\n<p>The easiest would be to just execute the <a href=\"https://technet.microsoft.com/en-us/library/bb491003.aspx\" rel=\"noreferrer\"><code>shutdown</code></a> command using the <a href=\"https://golang.org/pkg/os/exec/\" rel=\"noreferrer\"><code>os/exec</code></a> package, e.g.</p>\n\n<pre><code>if err := exec.Command(\"cmd\", \"/C\", \"shutdown\", \"/s\").Run(); err != nil {\n    fmt.Println(\"Failed to initiate shutdown:\", err)\n}\n</code></pre>\n\n<p>The above command initiates a shutdown sequence which usually takes 1 minute to really shut down the system (and there's room to abort it with <code>shutdown /a</code>). You may provide different arguments to the <code>shutdown</code> command to not wait 1 minute but proceed immediately: <code>shutdown /t 0 /s</code> (execute <code>shutdown /?</code> to get a list of all options).</p>\n\n<p>There is also a Windows API call to shutdown the system: <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa376868.aspx\" rel=\"noreferrer\"><code>ExitWindowsEx()</code></a>. It has 2 parameters, first is the flags to define the shutdown type (<code>0x08</code> means <code>Shuts down the system and turns off the power.</code>), second is to provide a reason for the shutdown. To call this from Go, you can do that like this:</p>\n\n<pre><code>user32 := syscall.MustLoadDLL(\"user32\")\ndefer user32.Release()\n\nexitwin := user32.MustFindProc(\"ExitWindowsEx\")\n\nr1, _, err := exitwin.Call(0x08, 0)\nif r1 != 1 {\n    fmt.Println(\"Failed to initiate shutdown:\", err)\n}\n</code></pre>\n\n<p>But know that you need <code>SE_SHUTDOWN_NAME</code> privilege to call <code>ExitWindowsEx()</code>, else you get an error message like:</p>\n\n<pre><code>Failed to initiate shutdown: A required privilege is not held by the client.\n</code></pre>\n\n<p>See this example <a href=\"https://msdn.microsoft.com/en-us/library/aa376871(VS.85).aspx\" rel=\"noreferrer\">how to acquire the required privilege</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 51, "user_id": 11244228, "user_type": "registered", "profile_image": "https://lh3.googleusercontent.com/-XNREj1Tmm9I/AAAAAAAAAAI/AAAAAAAAABo/5w6dJsj6yeA/photo.jpg?sz=128", "display_name": "flyinggorilla", "link": "https://stackoverflow.com/users/11244228/flyinggorilla"}, "is_accepted": false, "score": 5, "last_activity_date": 1553275151, "creation_date": 1553275151, "answer_id": 55304787, "question_id": 39595252, "link": "https://stackoverflow.com/questions/39595252/shutting-down-windows-using-golang-code/55304787#55304787", "title": "Shutting down windows using golang code", "body": "<p>Thanks for the post, very helpful. \nhere is a complete function that performs a reboot. It follows exactly the Microsoft example as noted before. should help saving time in figuring out the structs:</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"syscall\"\n    \"unsafe\"\n)\n\n// error is nil on success\nfunc reboot() error {\n\n    user32 := syscall.MustLoadDLL(\"user32\")\n    defer user32.Release()\n\n    kernel32 := syscall.MustLoadDLL(\"kernel32\")\n    defer user32.Release()\n\n    advapi32 := syscall.MustLoadDLL(\"advapi32\")\n    defer advapi32.Release()\n\n    ExitWindowsEx := user32.MustFindProc(\"ExitWindowsEx\")\n    GetCurrentProcess := kernel32.MustFindProc(\"GetCurrentProcess\")\n    GetLastError := kernel32.MustFindProc(\"GetLastError\")\n    OpenProdcessToken := advapi32.MustFindProc(\"OpenProcessToken\")\n    LookupPrivilegeValue := advapi32.MustFindProc(\"LookupPrivilegeValueW\")\n    AdjustTokenPrivileges := advapi32.MustFindProc(\"AdjustTokenPrivileges\")\n\n    currentProcess, _, _ := GetCurrentProcess.Call()\n\n    const tokenAdjustPrivileges = 0x0020\n    const tokenQuery = 0x0008\n    var hToken uintptr\n\n    result, _, err := OpenProdcessToken.Call(currentProcess, tokenAdjustPrivileges|tokenQuery, uintptr(unsafe.Pointer(&amp;hToken)))\n    if result != 1 {\n        fmt.Println(\"OpenProcessToken(): \", result, \" err: \", err)\n        return err\n    }\n    //fmt.Println(\"hToken: \", hToken)\n\n    const SeShutdownName = \"SeShutdownPrivilege\"\n\n    type Luid struct {\n        lowPart  uint32 // DWORD\n        highPart int32  // long\n    }\n    type LuidAndAttributes struct {\n        luid       Luid   // LUID\n        attributes uint32 // DWORD\n    }\n\n    type TokenPrivileges struct {\n        privilegeCount uint32 // DWORD\n        privileges     [1]LuidAndAttributes\n    }\n\n    var tkp TokenPrivileges\n\n    result, _, err = LookupPrivilegeValue.Call(uintptr(0), uintptr(unsafe.Pointer(syscall.StringToUTF16Ptr(SeShutdownName))), uintptr(unsafe.Pointer(&amp;(tkp.privileges[0].luid))))\n    if result != 1 {\n        fmt.Println(\"LookupPrivilegeValue(): \", result, \" err: \", err)\n        return err\n    }\n    //fmt.Println(\"LookupPrivilegeValue luid: \", tkp.privileges[0].luid)\n\n    const SePrivilegeEnabled uint32 = 0x00000002\n\n    tkp.privilegeCount = 1\n    tkp.privileges[0].attributes = SePrivilegeEnabled\n\n    result, _, err = AdjustTokenPrivileges.Call(hToken, 0, uintptr(unsafe.Pointer(&amp;tkp)), 0, uintptr(0), 0)\n    if result != 1 {\n        fmt.Println(\"AdjustTokenPrivileges() \", result, \" err: \", err)\n        return err\n    }\n\n    result, _, _ = GetLastError.Call()\n    if result != 0 {\n        fmt.Println(\"GetLastError() \", result)\n        return err\n    }\n\n    const ewxForceIfHung = 0x00000010\n    const ewxReboot = 0x00000002\n    const shutdownReasonMajorSoftware = 0x00030000\n\n    result, _, err = ExitWindowsEx.Call(ewxReboot|ewxForceIfHung, shutdownReasonMajorSoftware)\n    if result != 1 {\n        fmt.Println(\"Failed to initiate reboot:\", err)\n        return err\n    }\n\n    return nil\n}\n</code></pre>\n"}], "owner": {"reputation": 3168, "user_id": 5558126, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/222b3385ea809d92778c8d79a0498115?s=128&d=identicon&r=PG&f=1", "display_name": "Pim verleg", "link": "https://stackoverflow.com/users/5558126/pim-verleg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3892, "favorite_count": 2, "accepted_answer_id": 39598382, "answer_count": 2, "score": 4, "last_activity_date": 1553275151, "creation_date": 1474377549, "question_id": 39595252, "link": "https://stackoverflow.com/questions/39595252/shutting-down-windows-using-golang-code", "title": "Shutting down windows using golang code", "body": "<p>I am making a program that automates some tedious tasks for me, after the program is done I want to shutdown windows. I know this can be done in for example C#</p>\n\n<p>How can I shutdown window using golang?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "edited": false, "score": 0, "creation_date": 1476360387, "post_id": 39595045, "comment_id": 67317692, "body": "Why would anyone downvote this question. Atleast tell me what is the mistake and help me improve."}], "answers": [{"tags": [], "owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "is_accepted": true, "score": 7, "last_activity_date": 1474377213, "creation_date": 1474377213, "answer_id": 39595115, "question_id": 39595045, "link": "https://stackoverflow.com/questions/39595045/convert-int-array-to-string-separated-by/39595115#39595115", "title": "Convert int array to string separated by &#39;,&#39;", "body": "<p>Make <code>IDs</code> a <code>[]string</code> and convert the integers when you append them</p>\n\n<pre><code>var IDs []string\nfor _, i := range []int{1, 2, 3, 4} {\n    IDs = append(IDs, strconv.Itoa(i))\n}\n\nfmt.Println(strings.Join(IDs, \", \"))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/xrfuMRjgiI\" rel=\"noreferrer\">https://play.golang.org/p/xrfuMRjgiI</a></p>\n"}, {"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474381819, "post_id": 39596583, "comment_id": 66502236, "body": "Ah <code>AppendInt</code> is a little nicer. Small nit, I would stick to the official style recommendation of starting with an a nil/empty slice. It makes beginner examples like this easier to understand, and I highly doubt that <i>one</i> extra stack alloc&amp;copy is going to make a difference during this string manipulation ;)"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474382168, "post_id": 39596583, "comment_id": 66502510, "body": "@JimB I added your suggestion as a comment, but I still like my &quot;smartass&quot; version more :P"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": false, "score": 1, "last_activity_date": 1474382139, "last_edit_date": 1474382139, "creation_date": 1474381109, "answer_id": 39596583, "question_id": 39595045, "link": "https://stackoverflow.com/questions/39595045/convert-int-array-to-string-separated-by/39596583#39596583", "title": "Convert int array to string separated by &#39;,&#39;", "body": "<p>Here is an efficient way to do that:</p>\n\n<pre><code>func sqlIntSeq(ns []int) string {\n    if len(ns) == 0 {\n        return \"\"\n    }\n\n    // Appr. 3 chars per num plus the comma.\n    estimate := len(ns) * 4\n    b := make([]byte, 0, estimate)\n    // Or simply\n    //   b := []byte{}\n    for _, n := range ns {\n        b = strconv.AppendInt(b, int64(n), 10)\n        b = append(b, ',')\n    }\n    b = b[:len(b)-1]\n    return string(b)\n}\n</code></pre>\n\n<p>You can use it in the SQL queries like that:</p>\n\n<pre><code>query := `SELECT * FROM table WHERE id IN (` + sqlIntSeq(ids) + `)`\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/zi7YYetGu7\" rel=\"nofollow\">https://play.golang.org/p/zi7YYetGu7</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 379, "user_id": 6097285, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/caed10d0c712a106142e2bb79a8cd665?s=128&d=identicon&r=PG&f=1", "display_name": "yogesh_desai", "link": "https://stackoverflow.com/users/6097285/yogesh-desai"}, "is_accepted": false, "score": 4, "last_activity_date": 1547116732, "creation_date": 1547116732, "answer_id": 54126847, "question_id": 39595045, "link": "https://stackoverflow.com/questions/39595045/convert-int-array-to-string-separated-by/54126847#54126847", "title": "Convert int array to string separated by &#39;,&#39;", "body": "<p>I would prefer to use <code>json.Marshal</code>. It is much simple and easy to use.</p>\n\n<pre><code>data := []int{100, 200, 300}\ns, _ := json.Marshal(data)\n\nfmt.Println(strings.Trim(string(s), \"[]\"))\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/k9w-dkxNNhI\" rel=\"nofollow noreferrer\">GoPlaygroundLink</a></p>\n\n<p>I hope this helps you. Please feel free to ask in case of doubts. <a href=\"http://www.cstechera.com/\" rel=\"nofollow noreferrer\">WebsiteLink</a></p>\n"}], "owner": {"reputation": 8720, "user_id": 6149787, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/edf1a61aa50a231d521d940d60928292?s=128&d=identicon&r=PG&f=1", "display_name": "Jagrati", "link": "https://stackoverflow.com/users/6149787/jagrati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 10589, "favorite_count": 0, "accepted_answer_id": 39595115, "answer_count": 3, "score": 6, "last_activity_date": 1547116732, "creation_date": 1474377016, "last_edit_date": 1525012267, "question_id": 39595045, "link": "https://stackoverflow.com/questions/39595045/convert-int-array-to-string-separated-by", "title": "Convert int array to string separated by &#39;,&#39;", "body": "<p>I know that for string array <code>[]string</code> I can use <code>strings.Join(a []string, ',')</code> but I want to do the same thing for an integer array <code>[]int</code>.</p>\n\n<p>My usecase is something like this for a query where <code>variants</code> is <code>[]map[string]int</code> </p>\n\n<pre><code> var Ids []int\n    sqlStr := \"select id from mapping where my_id in (\"\n    for _, mp := range variants {\n       sqlStr += \"?,\"\n       Ids = append(Ids, mp[\"id\"])\n    }\n    sqlStr = strings.TrimRight(sqlStr, \",\")\n    rows, err := db.Query(sqlStr+\")\", strings.Join(Ids, ',')) // I can't do this because Join needs String array\n</code></pre>\n\n<p>How to achieve this?</p>\n"}, {"tags": ["json", "serialization", "go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1474378622, "post_id": 39594959, "comment_id": 66499916, "body": "What is your definition of &quot;not be serialised&quot;? Circular data structures are problematic, channels are basically impossible, interface values might by tricky. It really depends on what you consider serialisable (and in which form)."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474380820, "post_id": 39594959, "comment_id": 66501501, "body": "I don&#39;t get the question at all. What are you trying to achieve?"}, {"owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "edited": false, "score": 0, "creation_date": 1474380961, "post_id": 39594959, "comment_id": 66501621, "body": "please see updated Q."}, {"owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474381045, "post_id": 39594959, "comment_id": 66501673, "body": "@Ainar-G I would like to be able to serialise any structure to json. Where the structure has field that can not be serialised it is simply ignored rather than causing the json.Marshal function to terminate the serialisation process and return an error."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474381235, "post_id": 39594959, "comment_id": 66501806, "body": "@MylesMcDonnell won&#39;t making the field unexported or using the <code>json:&quot;-&quot;</code> struct tag solve that?"}, {"owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474382435, "post_id": 39594959, "comment_id": 66502700, "body": "@Ainar-G yes it would, but I don&#39;t define the types I&#39;m trying to serialise (some are in fact auto generated by go-swagger) so that&#39;s not an option One technique that works is to copy the type instance and set all non serialisable fields to null, but that in my scenario would be laborious so I&#39;m looking for a marshaller that just skips fields it can&#39;t serialise."}], "owner": {"reputation": 11533, "user_id": 1022177, "user_type": "registered", "accept_rate": 57, "profile_image": "https://i.stack.imgur.com/BDTjr.jpg?s=128&g=1", "display_name": "Myles McDonnell", "link": "https://stackoverflow.com/users/1022177/myles-mcdonnell"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 149, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1474387850, "creation_date": 1474376776, "last_edit_date": 1474387850, "question_id": 39594959, "link": "https://stackoverflow.com/questions/39594959/safe-struct-to-json-marshalling-in-go", "title": "&#39;Safe&#39; struct to JSON marshalling in Go", "body": "<p>Is there a way to marshall a struct to JSON that skips any fields that can not be serialised?</p>\n\n<p>E.G. if I marshal </p>\n\n<pre><code>type aStruct struct {\n  request *http.Request\n  name    string\n}\n</code></pre>\n\n<p>the JSON representation of</p>\n\n<pre><code>type aStruct struct {\n  name    string\n}\n</code></pre>\n\n<p>would result?</p>\n\n<p>By 'fields that can not be serialised' I mean any field that would cause json.Marshal(..) to return an 'error serializing json: unsupported type' error.  Having a look through the json package now with a mind to create another Marshal function that will skip a field it fails to serialise rather than abort and return the error.</p>\n\n<p>==== UPDATE ====</p>\n\n<p>I have created this <a href=\"https://github.com/myles-mcdonnell/jsonx\" rel=\"nofollow\">https://github.com/myles-mcdonnell/jsonx</a> which satisfies my use case.  At first I thought this is a terrible way to extend the base json package (it's a copy from 1.6.2 with new behaviour added) but the consensus among my colleagues is that this is the idiomatic way to do this.</p>\n"}, {"tags": ["parsing", "go", "connection-string"], "comments": [{"owner": {"reputation": 2084, "user_id": 1093710, "user_type": "registered", "accept_rate": 95, "profile_image": "https://www.gravatar.com/avatar/0c2c2a8067de0b33d2733bc4225568af?s=128&d=identicon&r=PG", "display_name": "Sridhar", "link": "https://stackoverflow.com/users/1093710/sridhar"}, "edited": false, "score": 0, "creation_date": 1474376318, "post_id": 39594630, "comment_id": 66498177, "body": "<a href=\"https://golang.org/pkg/encoding/csv\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/csv</a>"}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 2740788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVmIJ.png?s=128&g=1", "display_name": "Jackson Santana", "link": "https://stackoverflow.com/users/2740788/jackson-santana"}, "is_accepted": false, "score": 0, "last_activity_date": 1474386481, "creation_date": 1474386481, "answer_id": 39598541, "question_id": 39594630, "link": "https://stackoverflow.com/questions/39594630/parse-connection-string-into-struct-in-golang/39598541#39598541", "title": "Parse Connection String into Struct in golang", "body": "<p>Well, I did the following to solve my problem (I know its not perfect, but fits my needs very well)</p>\n\n<pre><code>func ConnectionStringBuilder(connectionstring string) ConnectionString {\n\n    splittedcs := strings.Split(connectionstring, \";\")\n\n    csstruct := ConnectionString{}\n\n    for i := 0; i &lt; len(splittedcs); i++ {\n\n        actualitem := splittedcs[i]\n        splitteditem := strings.Split(actualitem, \"=\")\n\n        fieldname := strings.ToUpper(strings.Replace(splitteditem[0], \" \", \"\", -1))\n        value := splitteditem[1]\n\n        if fieldname == \"DATASOURCE\" || fieldname == \"SERVER\" {\n            splittedport := strings.Split(value, \",\")\n\n            val := reflect.ValueOf(&amp;csstruct)\n            (val.Elem()).FieldByName(fieldname).SetString(splittedport[0])\n\n            if len(splittedport) &gt; 1 {\n                (val.Elem()).FieldByName(\"PORT\").SetString(splittedport[1])\n            }\n\n        } else {\n\n            val := reflect.ValueOf(&amp;csstruct)\n            (val.Elem()).FieldByName(fieldname).SetString(value)\n        }\n\n        if csstruct.DATASOURCE != \"\" {\n            csstruct.HOST = csstruct.DATASOURCE\n        }\n\n        if csstruct.SERVER != \"\" {\n            csstruct.HOST = csstruct.SERVER\n        }\n    }\n\n    return csstruct, nil\n}\n\ntype ConnectionString struct {\n    HOST                   string `json:\"Host,omitempty\"`\n    DATASOURCE             string `json:\"DataSource,omitempty\"`\n    SERVER                 string `json:\"Server,omitempty\"`\n    INITIALCATALOG         string `json:\"InitialCatalog,omitempty\"`\n    USERID                 string `json:\"UserID,omitempty\"`\n    ASYNCHRONOUSPROCESSING string `json:\"AsynchronousProcessing,omitempty\"`\n    PASSWORD               string `json:\"Password,omitempty\"`\n    DATABASE               string `json:\"Database,omitempty\"`\n    PORT                   string `json:\"Port,omitempty\"`\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 2740788, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uVmIJ.png?s=128&g=1", "display_name": "Jackson Santana", "link": "https://stackoverflow.com/users/2740788/jackson-santana"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 904, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474386481, "creation_date": 1474375872, "question_id": 39594630, "link": "https://stackoverflow.com/questions/39594630/parse-connection-string-into-struct-in-golang", "title": "Parse Connection String into Struct in golang", "body": "<p>I'm new at golang and I need to parse a connection string into a struct to get specific elements of that. Example:</p>\n\n<p>I have this:</p>\n\n<pre><code>\"Data Source=mysqlserver.local,37001;Initial Catalog=mydatabase;User ID=usertest;Asynchronous Processing=True\"\n</code></pre>\n\n<p>And I need to put that data on a struct that looks more or less like...</p>\n\n<pre><code>type ConnectionString struct {\n    DataSource             string\n    InitialCatalog         string\n    UserID                 string\n    AsynchronousProcessing string\n}\n</code></pre>\n\n<p>I need to do something like the class <code>SqlConnectionStringBuilder</code> on .NET does.</p>\n\n<p>Thanks!!</p>\n"}, {"tags": ["go", "struct", "interface"], "answers": [{"comments": [{"owner": {"reputation": 5492, "user_id": 1720344, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TYlxm.png?s=128&g=1", "display_name": "damoiser", "link": "https://stackoverflow.com/users/1720344/damoiser"}, "edited": false, "score": 0, "creation_date": 1474376473, "post_id": 39594511, "comment_id": 66498308, "body": "+1 thanks for your response and for displaying another possible resolution of what I asked. I&#39;ve just accepted the other answer of @Not_a_Golfer because it follows a little better my &#39;code-style&#39;. But as said, this would be another great solution, if I can choose two answer I would choose both ;-)"}], "tags": [], "owner": {"reputation": 23028, "user_id": 107156, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/mSIVv.jpg?s=128&g=1", "display_name": "Kyle Brandt", "link": "https://stackoverflow.com/users/107156/kyle-brandt"}, "is_accepted": false, "score": 1, "last_activity_date": 1474375577, "creation_date": 1474375577, "answer_id": 39594511, "question_id": 39594229, "link": "https://stackoverflow.com/questions/39594229/golang-add-inheritance-to-structs/39594511#39594511", "title": "Golang - add &quot;inheritance&quot; to structs", "body": "<p>Struct embedding is the main thing you are looking for I think:</p>\n\n<pre><code>type Cache struct {\n  name             string\n  mutex            *sync.Mutex\n}\n\ntype CacheA struct {\n   Cache\n   memory_cache map[string]ElementA{}\n}  \n</code></pre>\n\n<p>Then you make a type of interface, say \"Cacher\" that has a set of methods for the things you need to do with your various caches (cacheA, CacheB). Create those methods for CacheA, CacheB, and assertions are only needed only for the return type:</p>\n\n<pre><code>type Cacher interface {\n    GetItem(string) (interface{}, error)\n}\n</code></pre>\n\n<p>If all your CacheFor types have that GetItem method, the interface will be fulfilled. </p>\n\n<p>Still a fair amount of boilerplate, but this reduces the problem with redundancy in struct definitions. There are code generation tools if you don't want to type the boiler plate.</p>\n"}, {"tags": [], "owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "is_accepted": true, "score": 1, "last_activity_date": 1474375578, "creation_date": 1474375578, "answer_id": 39594513, "question_id": 39594229, "link": "https://stackoverflow.com/questions/39594229/golang-add-inheritance-to-structs/39594513#39594513", "title": "Golang - add &quot;inheritance&quot; to structs", "body": "<p>Go doesn't have generics, so there's no simple way of doing this, like you would in Java for instance (<code>class Cache&lt;T&gt;()....</code>). </p>\n\n<p>One thing you can do is wrap your cache with a small typed function that just fetches objects from a generic cache and converts the interface to the right type. This just saves you from writing the interface conversion over and over in your code. </p>\n\n<pre><code>type ElemACache struct { \n   Cache\n}\n\nfunc (c *ElemeACache)Get(key string) ElemeA {\n    return c.Cache.Get(key).(ElemeA) //of course add checks here\n}\n</code></pre>\n"}], "owner": {"reputation": 5492, "user_id": 1720344, "user_type": "registered", "accept_rate": 84, "profile_image": "https://i.stack.imgur.com/TYlxm.png?s=128&g=1", "display_name": "damoiser", "link": "https://stackoverflow.com/users/1720344/damoiser"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 1, "accepted_answer_id": 39594513, "answer_count": 2, "score": 1, "last_activity_date": 1474375578, "creation_date": 1474374791, "question_id": 39594229, "link": "https://stackoverflow.com/questions/39594229/golang-add-inheritance-to-structs", "title": "Golang - add &quot;inheritance&quot; to structs", "body": "<p>I would like to optimize my code, I have then the following situation:</p>\n\n<p>I have a general <code>struct</code> where only one field gives the specification, let say a cache struct example:</p>\n\n<pre><code># the main cache struct\ntype Cache struct {\n  name             string\n  memory_cache     map[string]interface{}\n  mutex            *sync.Mutex\n  ...              ...\n  # common fields\n}\n\n# an element stored in the Cache.memory_cache map\ntype ElementA {\n  name  string\n  count int64\n}\n\n# an element stored in the Cache.memory_cache map\ntype ElementB {\n  name  string\n  tags  []string\n}\n</code></pre>\n\n<p>My current solution follow the previously definition and I create a cache for each element (it must be so: one cache per element):</p>\n\n<pre><code>var cache_for_element_A Cache{}\nvar cache_for_element_B Cache{}\n</code></pre>\n\n<p>But in this way I must always cast the <code>memory_cache</code> when reading, even if I know already what is the content (then no cast-case should be needed).</p>\n\n<hr>\n\n<p>The following code do what I would like to have, but it defines twice a lot of redundants/commons fields, for this reason I would like to find another solution.</p>\n\n<pre><code>type CacheForA struct {\n  name             string\n  memory_cache     map[string]ElementA{}\n  mutex            *sync.Mutex\n  ...              ...\n  # common fields\n}\n\ntype CacheForB struct\u00a0{\n  name             string\n  memory_cache     map[string]ElementB{}\n  mutex            *sync.Mutex\n  ...              ...\n  # common fields\n}\n</code></pre>\n\n<p>Then, is it possible to define a field in the struct (more precisely <code>Cache.memory_cache</code>) that can be further defined when the declaration occurs and without using <code>interface</code>?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 20787, "user_id": 1251660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UaQAA.jpg?s=128&g=1", "display_name": "slayedbylucifer", "link": "https://stackoverflow.com/users/1251660/slayedbylucifer"}, "edited": false, "score": 0, "creation_date": 1474377593, "post_id": 39594269, "comment_id": 66499115, "body": "Thanks. If I declare <code>var err error</code> before the <b>outer</b> <code>resp</code> then code fails with error <code>err redeclared in this block</code>. If I declare <code>var err error</code> before <b>inner</b> <code>resp</code>, then there is no change in behavior."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 20787, "user_id": 1251660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UaQAA.jpg?s=128&g=1", "display_name": "slayedbylucifer", "link": "https://stackoverflow.com/users/1251660/slayedbylucifer"}, "edited": false, "score": 0, "creation_date": 1474379808, "post_id": 39594269, "comment_id": 66500774, "body": "@slayedbylucifer So this doesn&#39;t help? What if you simply replace <code>:=</code> with <code>=</code> in the loop?"}, {"owner": {"reputation": 20787, "user_id": 1251660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UaQAA.jpg?s=128&g=1", "display_name": "slayedbylucifer", "link": "https://stackoverflow.com/users/1251660/slayedbylucifer"}, "edited": false, "score": 0, "creation_date": 1474388733, "post_id": 39594269, "comment_id": 66506854, "body": "Hi @Ainar-G, Replacing <code>:=</code> with <code>=</code> errors out saying <code>undefined: resp</code>."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 20787, "user_id": 1251660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UaQAA.jpg?s=128&g=1", "display_name": "slayedbylucifer", "link": "https://stackoverflow.com/users/1251660/slayedbylucifer"}, "edited": false, "score": 1, "creation_date": 1474388822, "post_id": 39594269, "comment_id": 66506901, "body": "@slayedbylucifer Are you sure you&#39;re replacing <code>:=</code> in the <b>inner</b> resp?"}, {"owner": {"reputation": 20787, "user_id": 1251660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UaQAA.jpg?s=128&g=1", "display_name": "slayedbylucifer", "link": "https://stackoverflow.com/users/1251660/slayedbylucifer"}, "edited": false, "score": 0, "creation_date": 1474389610, "post_id": 39594269, "comment_id": 66507369, "body": "Oh. Sorry. My Bad. Yes, It is working. In <b>inner</b> loop I replaced <code>:=</code> to <code>=</code> and it worked. Many Thanks. Does <code>:=</code> in inner loop means I am defining same <code>resp</code> variable (which is already defined earlier) one more time and hence it was misbehaving ? Would you mind explaining this in brief words or point me to any documentation. Thank you !!"}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 20787, "user_id": 1251660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UaQAA.jpg?s=128&g=1", "display_name": "slayedbylucifer", "link": "https://stackoverflow.com/users/1251660/slayedbylucifer"}, "edited": false, "score": 1, "creation_date": 1474389758, "post_id": 39594269, "comment_id": 66507462, "body": "@slayedbylucifer Yes, writing <code>a, b := foo()</code> is basically the same as <code>var a, b = foo()</code>. So you&#39;re defining new variables with it. In this case you defined a new variable <code>resp</code>, which is different from <code>resp</code> that you checked in the <code>if</code> above it. It&#39;s a common gotcha with <code>:=</code>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1474390318, "last_edit_date": 1474390318, "creation_date": 1474374934, "answer_id": 39594269, "question_id": 39594169, "link": "https://stackoverflow.com/questions/39594169/go-lang-while-loop/39594269#39594269", "title": "Go lang While loop", "body": "<p>Your inner <code>resp</code> seems to <a href=\"https://en.wikipedia.org/wiki/Variable_shadowing\" rel=\"nofollow\">shadow</a> your original <code>resp</code>. Try this inside the <strong>inner</strong> <code>for</code> loop (<code>:=</code> replaced with <code>=</code>):</p>\n\n<pre><code>resp, err = svc.DescribeAutoScalingGroups(params)\n</code></pre>\n"}], "owner": {"reputation": 20787, "user_id": 1251660, "user_type": "registered", "accept_rate": 78, "profile_image": "https://i.stack.imgur.com/UaQAA.jpg?s=128&g=1", "display_name": "slayedbylucifer", "link": "https://stackoverflow.com/users/1251660/slayedbylucifer"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1165, "favorite_count": 0, "accepted_answer_id": 39594269, "answer_count": 1, "score": 1, "last_activity_date": 1474390318, "creation_date": 1474374635, "question_id": 39594169, "link": "https://stackoverflow.com/questions/39594169/go-lang-while-loop", "title": "Go lang While loop", "body": "<ul>\n<li>I want to extract all the autoscaling groups from AWS</li>\n<li>AWS provides response in multiple pages with <code>NextToken</code> pointing to next page. So need keep looking for <code>NextToken</code> and pull the group names</li>\n<li>If there is no <code>NextToken</code>, then quit.</li>\n</ul>\n\n<p>In python, I do:</p>\n\n<pre><code>import boto3\nimport pprint\n\nsession = boto3.session.Session(region_name='us-west-2')\nclient = session.client('autoscaling')\n\nresp = client.describe_auto_scaling_groups()\npprint.pprint(resp)\n\nwhile 'NextToken' in resp:\n    resp = client.describe_auto_scaling_groups(NextToken=resp['NextToken'])          \n    pprint.pprint(resp)\n</code></pre>\n\n<p>I followed similar logic in <a href=\"/questions/tagged/go\" class=\"post-tag\" title=\"show questions tagged &#39;go&#39;\" rel=\"tag\"><img src=\"//i.stack.imgur.com/sawHl.png\" height=\"16\" width=\"18\" alt=\"\" class=\"sponsor-tag-img\">go</a> and came up with below code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/service/autoscaling\"\n)\n\nfunc main() {\n    sess, err := session.NewSession(&amp;aws.Config{Region: aws.String(\"us-west-2\")})\n\n    if err != nil {\n        fmt.Println(\"Failed to create session: \", sess)\n        return\n    }\n\n    svc := autoscaling.New(sess)\n    params := &amp;autoscaling.DescribeAutoScalingGroupsInput{}\n    resp, err := svc.DescribeAutoScalingGroups(params)\n\n    if err != nil {\n        fmt.Println(\"Something Went wrong\")\n        return\n    }\n\n    fmt.Println(resp)\n\n    for {\n        if resp.NextToken == nil {\n            fmt.Println(\"No more pages left\")\n            break\n        }\n\n        params := &amp;autoscaling.DescribeAutoScalingGroupsInput{\n            NextToken: aws.String(*resp.NextToken),\n        }\n        resp, err := svc.DescribeAutoScalingGroups(params)\n\n        if err != nil {\n            fmt.Println(\"Something Went wrong\")\n            return\n        }\n\n        fmt.Println(resp)\n    }\n}\n</code></pre>\n\n<p><strong>QUESTION:</strong> My <a href=\"/questions/tagged/go\" class=\"post-tag\" title=\"show questions tagged &#39;go&#39;\" rel=\"tag\"><img src=\"//i.stack.imgur.com/sawHl.png\" height=\"16\" width=\"18\" alt=\"\" class=\"sponsor-tag-img\">go</a> code goes to the 2nd page and then keep looping over the same 2nd page. It does not proceed to 3rd page (when there is <code>NextToken</code> in <code>resp</code>) or it does not quit (when there is no <code>NextToken</code> in <code>resp</code>).</p>\n\n<p>Seeking help on my <a href=\"/questions/tagged/go\" class=\"post-tag\" title=\"show questions tagged &#39;go&#39;\" rel=\"tag\"><img src=\"//i.stack.imgur.com/sawHl.png\" height=\"16\" width=\"18\" alt=\"\" class=\"sponsor-tag-img\">go</a> code. I am learning <a href=\"/questions/tagged/go\" class=\"post-tag\" title=\"show questions tagged &#39;go&#39;\" rel=\"tag\"><img src=\"//i.stack.imgur.com/sawHl.png\" height=\"16\" width=\"18\" alt=\"\" class=\"sponsor-tag-img\">go</a></p>\n"}, {"tags": ["networking", "go", "wifi", "ssid"], "answers": [{"tags": [], "owner": {"reputation": 1790, "user_id": 1370397, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/4cd00d196b2f9bef669ce212eec963b1?s=128&d=identicon&r=PG", "display_name": "alex", "link": "https://stackoverflow.com/users/1370397/alex"}, "is_accepted": false, "score": 3, "last_activity_date": 1474897720, "last_edit_date": 1495542846, "creation_date": 1474897010, "answer_id": 39704397, "question_id": 39592607, "link": "https://stackoverflow.com/questions/39592607/get-ssid-other-network-information-in-golang/39704397#39704397", "title": "Get SSID/ other network information in golang", "body": "<p>There does not seem to be a native Go command to do this. You might instead execute system-specific tools from within your Go code and check their output. Examples are</p>\n\n<p><a href=\"https://github.com/yelinaung/wifi-name\" rel=\"nofollow noreferrer\">https://github.com/yelinaung/wifi-name</a> (Linux and OS X)</p>\n\n<p>or</p>\n\n<p><a href=\"https://stackoverflow.com/questions/38427250/list-of-available-wireless-networks-with-golang-under-linux\">List of available wireless networks with golang (under Linux)</a></p>\n\n<p>or</p>\n\n<p><a href=\"https://github.com/skycoin/skycoin/tree/master/src/aether/wifi\" rel=\"nofollow noreferrer\">https://github.com/skycoin/skycoin/tree/master/src/aether/wifi</a> (Linux)</p>\n\n<p>This seems to be the same for Java:</p>\n\n<p><a href=\"https://stackoverflow.com/a/12785503/1370397\">https://stackoverflow.com/a/12785503/1370397</a></p>\n"}], "owner": {"reputation": 3168, "user_id": 5558126, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/222b3385ea809d92778c8d79a0498115?s=128&d=identicon&r=PG&f=1", "display_name": "Pim verleg", "link": "https://stackoverflow.com/users/5558126/pim-verleg"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3391, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1608154880, "creation_date": 1474370027, "last_edit_date": 1608154880, "question_id": 39592607, "link": "https://stackoverflow.com/questions/39592607/get-ssid-other-network-information-in-golang", "title": "Get SSID/ other network information in golang", "body": "<p>How can I get the SSID and other network information in golang?</p>\n<p>For example the network to which I am currently connected.</p>\n"}, {"tags": ["testing", "go", "timer"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474365540, "post_id": 39591037, "comment_id": 66490994, "body": "Use an explicit parameter which represent wall time. During test you can fast-forward this wall time. Take a look at how package net/http/cookiejar does it."}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474366008, "post_id": 39591037, "comment_id": 66491310, "body": "This approach requires modifying the function itself though, which I am kinda reluctant to do. Also brings up the problem of if I were to be testing something involving a function that I do not have code of, I would be helpless"}, {"owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474366165, "post_id": 39591037, "comment_id": 66491402, "body": "May be that these kind of objects should always have an explicit parameter representing time. Might do that in the end but I do consider that as a final resort"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1474369549, "post_id": 39591636, "comment_id": 66493615, "body": "Also worth noting that the anonymous function / closure that the test function sets to the <code>timeNow</code> variable (of function time) may keep track of how many times it was called, and it may return different values based on # of call. E.g. <code>timeNow</code> may first return <code>00:00</code>, on next call it may return <code>00:01</code> etc. See this example on the <a href=\"https://play.golang.org/p/Ac7PcaTJ_Z\" rel=\"nofollow noreferrer\">Go Playground</a>."}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 9, "last_activity_date": 1474366961, "creation_date": 1474366961, "answer_id": 39591636, "question_id": 39591037, "link": "https://stackoverflow.com/questions/39591037/golang-testing-programs-that-involves-time/39591636#39591636", "title": "Golang testing programs that involves time", "body": "<p>This was actually answered in Andrew Gerrand's <a href=\"https://www.youtube.com/watch?v=ndmB0bj7eyw\" rel=\"noreferrer\">Testing Techniques talk</a>. In your code do</p>\n\n<pre><code>var (\n    timeNow   = time.Now\n    timeAfter = time.After\n)\n\n// ...\n\ntype Obj struct{}\nfunc (o Obj) TimeCriticalFunc(d time.Duration) bool {\n    // Call timeAfter and timeNow.\n}\n</code></pre>\n\n<p>And in your tests do</p>\n\n<pre><code>func TestTimeCriticalFunc(t *testing.T) {\n    timeNow = func() time.Time {\n        return myTime // Some time that you need\n    }\n    // \"Redefine\" timeAfter etc.\n    if !Obj{}.TimeCriticalFunc(10 * 24 * time.Hour) {\n        t.Fail()\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 16907, "user_id": 4832499, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/76532994f6efa8d7dc8a3bb5b7b262a8?s=128&d=identicon&r=PG&f=1", "display_name": "Passer By", "link": "https://stackoverflow.com/users/4832499/passer-by"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2897, "favorite_count": 0, "accepted_answer_id": 39591636, "answer_count": 1, "score": 5, "last_activity_date": 1474366961, "creation_date": 1474365371, "question_id": 39591037, "link": "https://stackoverflow.com/questions/39591037/golang-testing-programs-that-involves-time", "title": "Golang testing programs that involves time", "body": "<p>There is an object that relies on timing to function correctly. Unfortunately the timing duration itself is too long to realistically test it in real time and shortening the duration defeats the purpose of the testing due to the nature of the object.</p>\n\n<p>What is the best way to test such an object? Ideally, there would be some virtual clock that runs arbitrarily fast that can be used.</p>\n\n<pre><code>type Obj struct{}\nfunc (o Obj) TimeCriticalFunc(d time.Duration) bool {\n    //do stuff\n    //possibly calling multiple times time.Now() or other real time related functions\n}\n\nfunc TestTimeCriticalFunc(t *testing.T) {\n    if !Obj{}.TimeCriticalFunc(10 * 24 * time.Hour) {\n        t.Fail()\n    }\n}\n</code></pre>\n"}, {"tags": ["math", "go", "structure"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 1, "creation_date": 1474365597, "post_id": 39590974, "comment_id": 66491026, "body": "No there is not and there won&#39;t be any."}], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 5778483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/530ecad826cab806010c68d4a5c7e605?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/5778483/marcos"}, "edited": false, "score": 0, "creation_date": 1474366938, "post_id": 39591129, "comment_id": 66491929, "body": "That&#39;s a shame... I loved the Decimal type in .NET"}], "tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1474365610, "last_edit_date": 1592644375, "creation_date": 1474365610, "answer_id": 39591129, "question_id": 39590974, "link": "https://stackoverflow.com/questions/39590974/golang-arithmetic-operators-on-structs/39591129#39591129", "title": "Golang: arithmetic operators on structs", "body": "<p>No, you can't overload operators in Go. There is a FAQ entry about it:</p>\n<blockquote>\n<p><strong>Why does Go not support overloading of methods and operators?</strong></p>\n<p>Method dispatch is simplified if it doesn't need to do type matching as well. Experience with other languages told us that having a variety of methods with the same name but different signatures was occasionally useful but that it could also be confusing and fragile in practice. Matching only by name and requiring consistency in the types was a major simplifying decision in Go's type system.</p>\n<p>Regarding operator overloading, it seems more a convenience than an absolute requirement. Again, things are simpler without it.</p>\n</blockquote>\n<p><a href=\"https://golang.org/doc/faq#overloading\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#overloading</a></p>\n<p>If you need a working solution, look at how package <a href=\"https://golang.org/pkg/math/big/\" rel=\"nofollow noreferrer\"><code>math/big</code></a> deals with arithmetic sans operator overloading.</p>\n"}], "owner": {"reputation": 195, "user_id": 5778483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/530ecad826cab806010c68d4a5c7e605?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/5778483/marcos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2182, "favorite_count": 0, "accepted_answer_id": 39591129, "answer_count": 1, "score": 0, "last_activity_date": 1474365610, "creation_date": 1474365142, "question_id": 39590974, "link": "https://stackoverflow.com/questions/39590974/golang-arithmetic-operators-on-structs", "title": "Golang: arithmetic operators on structs", "body": "<p>Is there a way to define artihmetic ooerators between structs?\nIm using a decimal package to work with fixed decimal positions and avoid floats rounding erre ta. Ir defines operations cAlling functions like mul, add, sub, etc.\nId like to use that structure like i do with floats: 6 / 2, not decimal.newfromfloat(6).div(newfromfloat(2))\nI was hoping to find something interface to implement which alouds me to do that kind of operations, or maybe some kind of getter setter to work with the underlying val\u00faes... Any ideas?</p>\n"}, {"tags": ["date", "go"], "answers": [{"tags": [], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "is_accepted": true, "score": 2, "last_activity_date": 1474365044, "creation_date": 1474365044, "answer_id": 39590941, "question_id": 39590841, "link": "https://stackoverflow.com/questions/39590841/how-to-convert-date-from-one-format-to-another-golang/39590941#39590941", "title": "How to convert date from one format to another golang", "body": "<p>Use <a href=\"https://golang.org/pkg/time/#Time.Format\" rel=\"nofollow\"><code>Format</code></a> method with the appropriate format:</p>\n\n<pre><code>fmt.Println(tm.Format(\"02-Jan-06\")) // Prints \"01-Aug-16\".\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/uYDYzPwnbJ\" rel=\"nofollow\">https://play.golang.org/p/uYDYzPwnbJ</a>.</p>\n"}], "owner": {"reputation": 5193, "user_id": 5996587, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/d15f53deb1b5f2cab3534565c91c5394?s=128&d=identicon&r=PG&f=1", "display_name": "codec", "link": "https://stackoverflow.com/users/5996587/codec"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1525, "favorite_count": 0, "accepted_answer_id": 39590941, "answer_count": 1, "score": 0, "last_activity_date": 1474365044, "creation_date": 1474364793, "question_id": 39590841, "link": "https://stackoverflow.com/questions/39590841/how-to-convert-date-from-one-format-to-another-golang", "title": "How to convert date from one format to another golang", "body": "<p>I am converting a date into unix timestamp and fetching the date using split as follows</p>\n\n<pre><code>tm := time.Unix(1470009600, 0).UTC()\ndateString := strings.Split(tm.String(), \" \")\n</code></pre>\n\n<p>The output of dateString is <code>2016-07-15</code> i.e. YYYY-MM-DD format. How can I convert this into DD-MMM-YY format? eg: 15-Jul-16?</p>\n"}, {"tags": ["go", "naming-conventions", "assert", "naming"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474365223, "post_id": 39590458, "comment_id": 66490809, "body": "Well, this example is a bit strange as it does exactly what it would do without the <code>mustNotBeZero</code> guard/assertion: panic."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1474367125, "last_edit_date": 1474367125, "creation_date": 1474364724, "answer_id": 39590815, "question_id": 39590458, "link": "https://stackoverflow.com/questions/39590458/golang-guard-assert-functions-naming-convention/39590815#39590815", "title": "Golang guard (assert) functions naming convention", "body": "<p>This isn't \"part\" of any convention, but the <a href=\"https://golang.org/pkg/\" rel=\"nofollow\">standard library</a> also uses <code>MustXX()</code> functions, so it's a good pattern to follow, if you really need this.</p>\n\n<p>Examples:</p>\n\n<p>Exported:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/regexp/#MustCompile\" rel=\"nofollow\"><code>func MustCompile(str string) *Regexp</code></a></li>\n<li><a href=\"https://golang.org/pkg/text/template/#Must\" rel=\"nofollow\"><code>func Must(t *Template, err error) *Template</code></a></li>\n<li><a href=\"https://golang.org/src/syscall/dll_windows.go\" rel=\"nofollow\"><code>src/syscall/dll_windows.go</code></a>: (on Windows)\n\n<ul>\n<li><code>func MustLoadDLL(name string) *DLL</code></li>\n<li><code>func (d *DLL) MustFindProc(name string) *Proc</code></li>\n</ul></li>\n</ul>\n\n<p>Unexported:</p>\n\n<ul>\n<li><a href=\"https://golang.org/src/cmd/go/go_test.go\" rel=\"nofollow\"><code>src/cmd/go/go_test.go</code></a>:\n\n<ul>\n<li><code>func (tg *testgoData) must(err error)</code></li>\n<li><code>func (tg *testgoData) mustExist(path string)</code></li>\n<li><code>func (tg *testgoData) mustNotExist(path string)</code></li>\n</ul></li>\n<li><a href=\"https://golang.org/src/encoding/xml/xml.go\" rel=\"nofollow\"><code>src/encoding/xml/xml.go</code></a>:\n\n<ul>\n<li><code>func (d *Decoder) mustgetc() (b byte, ok bool)</code></li>\n</ul></li>\n<li><a href=\"https://golang.org/src/fmt/scan.go\" rel=\"nofollow\"><code>src/fmt/scan.go</code></a>:\n\n<ul>\n<li><code>func (s *ss) mustReadRune() (r rune)</code></li>\n</ul></li>\n<li><a href=\"https://golang.org/src/reflect/value.go\" rel=\"nofollow\"><code>src/reflect/value.go</code></a>:\n\n<ul>\n<li><code>func (f flag) mustBe(expected Kind)</code></li>\n<li><code>func (f flag) mustBeExported()</code></li>\n<li><code>func (f flag) mustBeAssignable()</code></li>\n</ul></li>\n<li><a href=\"https://golang.org/src/syscall/dll_windows.go\" rel=\"nofollow\"><code>src/syscall/dll_windows.go</code></a>:\n\n<ul>\n<li><code>func (d *LazyDLL) mustLoad()</code></li>\n<li><code>func (p *LazyProc) mustFind()</code></li>\n</ul></li>\n</ul>\n"}], "owner": {"reputation": 1164, "user_id": 168755, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/9e619994cf01ea5fc0718f3875d525b6?s=128&d=identicon&r=PG", "display_name": "synepis", "link": "https://stackoverflow.com/users/168755/synepis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1032, "favorite_count": 0, "accepted_answer_id": 39590815, "answer_count": 1, "score": 2, "last_activity_date": 1474367125, "creation_date": 1474363755, "question_id": 39590458, "link": "https://stackoverflow.com/questions/39590458/golang-guard-assert-functions-naming-convention", "title": "Golang guard (assert) functions naming convention", "body": "<p>I'm wondering if there is a golang naming convention for guard (assert) functions? I've googled a bit but couldn't find anything definitive. I've read in \"The Go Programming Language\" book that using 'must' prefix is a common practice.</p>\n\n<p>Example of the function I need:</p>\n\n<pre><code>package main\n\nfunc divide(a, b int) int {\n    mustNotBeZero(b)\n    return a / b\n}\n\nfunc mustNotBeZero(n int) {\n    if n == 0 {\n        panic(\"cannot divide by zero\")\n    }\n}\n\nfunc main() {\n    println(divide(5, 0))\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 1, "last_activity_date": 1474363802, "last_edit_date": 1474363802, "creation_date": 1474363466, "answer_id": 39590347, "question_id": 39589594, "link": "https://stackoverflow.com/questions/39589594/golang-time-error-month-out-of-range/39590347#39590347", "title": "Golang time error: month out of range", "body": "<p>First param is layout, see:</p>\n\n<pre><code>func Parse(layout, value string) (Time, error) {\n    return parse(layout, value, UTC, Local)\n}\n</code></pre>\n\n<p>Docs:</p>\n\n<blockquote>\n<pre><code>// Parse parses a formatted string and returns the time value it represents.\n// The layout  defines the format by showing how the reference time,\n// defined to be\n//    Mon Jan 2 15:04:05 -0700 MST 2006\n// would be interpreted if it were the value; it serves as an example of\n// the input format. The same interpretation will then be made to the\n// input string.\n//\n// Predefined layouts ANSIC, UnixDate, RFC3339 and others describe standard\n// and convenient representations of the reference time. For more information\n// about the formats and the definition of the reference time, see the\n// documentation for ANSIC and the other constants defined by this package.\n// Also, the executable example for time.Format demonstrates the working\n// of the layout string in detail and is a good reference.\n//\n// Elements omitted from the value are assumed to be zero or, when\n// zero is impossible, one, so parsing \"3:04pm\" returns the time\n// corresponding to Jan 1, year 0, 15:04:00 UTC (note that because the year is\n// 0, this time is before the zero Time).\n// Years must be in the range 0000..9999. The day of the week is checked\n// for syntax but it is otherwise ignored.\n//\n// In the absence of a time zone indicator, Parse returns a time in UTC.\n//\n// When parsing a time with a zone offset like -0700, if the offset corresponds\n// to a time zone used by the current location (Local), then Parse uses that\n// location and zone in the returned time. Otherwise it records the time as\n// being in a fabricated location with time fixed at the given zone offset.\n//\n// No checking is done that the day of the month is within the month's\n// valid dates; any one- or two-digit value is accepted. For example\n// February 31 and even February 99 are valid dates, specifying dates\n// in March and May. This behavior is consistent with time.Date.\n//\n// When parsing a time with a zone abbreviation like MST, if the zone abbreviation\n// has a defined offset in the current location, then that offset is used.\n// The zone abbreviation \"UTC\" is recognized as UTC regardless of location.\n// If the zone abbreviation is unknown, Parse records the time as being\n// in a fabricated location with the given zone abbreviation and a zero offset.\n// This choice means that such a time can be parsed and reformatted with the\n// same layout losslessly, but the exact instant used in the representation will\n// differ by the actual zone offset. To avoid such problems, prefer time layouts\n// that use a numeric zone offset, or use ParseInLocation.\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>You may use </p>\n\n<pre><code>t, err := time.Parse(\"2006-01-02 15:04:05\", time.Now().String()[:19])\n</code></pre>\n\n<p>Try on <a href=\"https://play.golang.org/p/zDGYkRucKF\" rel=\"nofollow\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    t, err := time.Parse(\"2006-01-02 15:04:05\", time.Now().String()[:19])\n    if err != nil {\n        panic(err)\n    }\n    fmt.Println(t)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>2009-11-10 23:00:00 +0000 UTC\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1693, "user_id": 5731861, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iKaMT.png?s=128&g=1", "display_name": "Felipe Valdes", "link": "https://stackoverflow.com/users/5731861/felipe-valdes"}, "is_accepted": false, "score": 0, "last_activity_date": 1572871962, "creation_date": 1572871962, "answer_id": 58693850, "question_id": 39589594, "link": "https://stackoverflow.com/questions/39589594/golang-time-error-month-out-of-range/58693850#58693850", "title": "Golang time error: month out of range", "body": "<p>I had the same problem, so I came here to say golang will some times mean \"month\" they meant \"DAY OF THE MONTH\", the error message is wrong, here is an example:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n\ndateAsString:= \"31/Oct/2019\"\n\nlayout := \"01/Jan/2006\" // BAD BAD BAD SHOULD BE 02 INSTEAD OF 01\nfmt.Println(\"INPUT:\" + dateAsString)\n\nt, err := time.Parse(layout, dateAsString)\nif err != nil {\n    fmt.Println(\"DATE UNPARSEABLE:3\", err)\n\n}\nfmt.Println(t)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 9, "user_id": 5816064, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-IRdaZfH--Ws/AAAAAAAAAAI/AAAAAAAAAHQ/RWZLKeeSkz8/photo.jpg?sz=128", "display_name": "li peng", "link": "https://stackoverflow.com/users/5816064/li-peng"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3508, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1572871962, "creation_date": 1474361355, "last_edit_date": 1474363932, "question_id": 39589594, "link": "https://stackoverflow.com/questions/39589594/golang-time-error-month-out-of-range", "title": "Golang time error: month out of range", "body": "<p>Here is my code:</p>\n\n<pre><code>time.Parse(time.Now().String()[0:19],time.Now().String()[0:19])\n</code></pre>\n\n<p>error:</p>\n\n<pre><code>parsing time \"2016-09-20 16:50:08\": month out of range\n</code></pre>\n\n<p>How to parse time string?</p>\n"}, {"tags": ["java", "string", "mongodb", "sqlite", "go"], "comments": [{"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1474354791, "post_id": 39587591, "comment_id": 66484542, "body": "Something in the chain is configured to treat numeric strings as floating point numbers. Does golang do that?"}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "reply_to_user": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1474354912, "post_id": 39587591, "comment_id": 66484627, "body": "Golang&#39;s response surprisingly &#39;looks&#39; like an integer but being in JSON, I&#39;m assuming it can be fetched in Java as both an integer and a string. I&#39;m fetching it using JSONObject.getString() method.."}, {"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1474355134, "post_id": 39587591, "comment_id": 66484759, "body": "Assuming the column in the DB is a string, then somewhere in the chain between the DB and your code it was converted to floating point, which is not good.  You&#39;ll have to figure out where."}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "reply_to_user": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1474355235, "post_id": 39587591, "comment_id": 66484825, "body": "I know! I need to try more and find out where this confusion happened. Thank you for point out the direction to look in!"}, {"owner": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1474355774, "post_id": 39587591, "comment_id": 66485128, "body": "Actually, your title says <i>&quot;Android SQL Lite int value...&quot;</i> are you <i>sure</i> it&#39;s stored in the DB as a string?"}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "reply_to_user": {"reputation": 80882, "user_id": 18157, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/4d3de78b198076dd5a5006abd17cb0f8?s=128&d=identicon&r=PG&f=1", "display_name": "Jim Garrison", "link": "https://stackoverflow.com/users/18157/jim-garrison"}, "edited": false, "score": 0, "creation_date": 1474359331, "post_id": 39587591, "comment_id": 66487134, "body": "Not really sure because the database scheme defines the field as &#39;TEXT&#39;."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 1, "creation_date": 1474360344, "post_id": 39587591, "comment_id": 66487750, "body": "When you <code>.put()</code> the float appears to be stringified, via: <code>String.valueOf(180010000001.0)</code> - which encodes to scientific notation; as does Go: <a href=\"https://play.golang.org/p/4XAQYgX5aT\" rel=\"nofollow noreferrer\">play.golang.org/p/4XAQYgX5aT</a>"}, {"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "reply_to_user": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1474362594, "post_id": 39587591, "comment_id": 66489085, "body": "Thank you for the response @MartinGallagher !"}], "answers": [{"comments": [{"owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "edited": false, "score": 0, "creation_date": 1474366446, "post_id": 39590586, "comment_id": 66491574, "body": "Thank you so much for the detailed answer! I did the last thing - saved all my values as strings."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1474366704, "last_edit_date": 1474366704, "creation_date": 1474364055, "answer_id": 39590586, "question_id": 39587591, "link": "https://stackoverflow.com/questions/39587591/android-sql-lite-int-value-stored-as-string-shows-extra-characters-when-retrieve/39590586#39590586", "title": "Android SQL Lite int value stored as string shows extra characters when retrieved", "body": "<p>This JSON text:</p>\n\n<pre><code>{\n\"phoneNumber\": 180010000001\n}\n</code></pre>\n\n<p>Defines a JSON object with a property <code>\"phoneNumber\"</code> whose value is a <a href=\"http://www.tutorialspoint.com/json/json_data_types.htm\" rel=\"nofollow\">JSON number</a>: <code>180010000001</code>. Note: the value is not a JSON string as if it would be, it would be in quotes and would look like this:</p>\n\n<pre><code>{\"phoneNumber\": \"180010000001\"}\n</code></pre>\n\n<p>Back to the original: it's a JSON number, so when the JSON text is parsed and converted back to either a Java or a Go value, it will be a floating point number. And when a floating point number is printed, often (when the number is too \"big\" or too \"small\") the <a href=\"https://en.wikipedia.org/wiki/Scientific_notation\" rel=\"nofollow\">scientific notation</a> is used which in your case is:</p>\n\n<pre><code>180010000001 = 1.80010000001E11\n</code></pre>\n\n<p>If you want to avoid this (you should), you must declare your phone number to be either a <code>long</code> type (in Java) or <code>uint64</code> (in Go), or preferaly simply declare it to be of <code>string</code> type, so no \"mysterious\" formatting for rounding errors will come up.</p>\n\n<p>If you already have it saved in MongoDB as a double, either load all and re-save them as <code>string</code> (preferable), or if you don't want to do that, convert it to <code>string</code> before sending it to your clients.</p>\n"}], "owner": {"reputation": 996, "user_id": 4720042, "user_type": "registered", "accept_rate": 95, "profile_image": "https://lh4.googleusercontent.com/-HJtrEmnS3s8/AAAAAAAAAAI/AAAAAAAABUo/w4vFRFBUbqE/photo.jpg?sz=128", "display_name": "Gaurav Ojha", "link": "https://stackoverflow.com/users/4720042/gaurav-ojha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 49, "favorite_count": 0, "accepted_answer_id": 39590586, "answer_count": 1, "score": 1, "last_activity_date": 1474366704, "creation_date": 1474354658, "question_id": 39587591, "link": "https://stackoverflow.com/questions/39587591/android-sql-lite-int-value-stored-as-string-shows-extra-characters-when-retrieve", "title": "Android SQL Lite int value stored as string shows extra characters when retrieved", "body": "<p>I have phone numbers stored in a MongoDB database as Double (mistakenly). So numbers appear somewhat like this in the database -</p>\n\n<pre><code>180010000001.0\n</code></pre>\n\n<p>I fetch this through a golang backend and the response it gives is surprisingly this -</p>\n\n<pre><code>{\n\"phoneNumber\": 180010000001\n}\n</code></pre>\n\n<p>I am not passing this data through any structs, its just a simple <code>mgo</code> query </p>\n\n<pre><code>MgoSession.DB(Dbname).C(collectionName).Find(query).All(&amp;result)\n</code></pre>\n\n<p>which returns an array of interfaces <code>[]interface{}</code></p>\n\n<p>Now I consume this web service on my Android app and store these values internally in SQL Lite for using throughout the app, like this -</p>\n\n<pre><code>phoneNumber TEXT\n</code></pre>\n\n<p>Then I store it like this,</p>\n\n<pre><code>contentValues.put(\"phoneNumber\", phoneNumber);\n</code></pre>\n\n<p>And fetch it like this -</p>\n\n<pre><code>cursor.getColumnIndex(\"phoneNumber\")\n</code></pre>\n\n<p>and assign it to a variable I have declared as <code>String</code></p>\n\n<p>Now when I print this out, it shows -</p>\n\n<pre><code>1.80010000001E11\n</code></pre>\n\n<p>Where did this transition happen?!</p>\n"}, {"tags": ["templates", "go", "server", "mime-types", "mime"], "answers": [{"comments": [{"owner": {"reputation": 83, "user_id": 3751962, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/9w7pF.gif?s=128&g=1", "display_name": "Scorpio750", "link": "https://stackoverflow.com/users/3751962/scorpio750"}, "edited": false, "score": 0, "creation_date": 1474346474, "post_id": 39585345, "comment_id": 66481260, "body": "How do I handle the asset requests? Not sure how to route that."}, {"owner": {"reputation": 547, "user_id": 4036946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wMtQe.gif?s=128&g=1", "display_name": "jsxqf", "link": "https://stackoverflow.com/users/4036946/jsxqf"}, "reply_to_user": {"reputation": 83, "user_id": 3751962, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/9w7pF.gif?s=128&g=1", "display_name": "Scorpio750", "link": "https://stackoverflow.com/users/3751962/scorpio750"}, "edited": false, "score": 0, "creation_date": 1474349074, "post_id": 39585345, "comment_id": 66482057, "body": "add an example to my answer."}, {"owner": {"reputation": 479, "user_id": 2763060, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/yBb54.png?s=128&g=1", "display_name": "ranu", "link": "https://stackoverflow.com/users/2763060/ranu"}, "edited": false, "score": 1, "creation_date": 1566327119, "post_id": 39585345, "comment_id": 101619504, "body": "What does <code>{ path:\\S+}</code> means? It looks like a regex but how does it work with gorilla mux?"}], "tags": [], "owner": {"reputation": 547, "user_id": 4036946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wMtQe.gif?s=128&g=1", "display_name": "jsxqf", "link": "https://stackoverflow.com/users/4036946/jsxqf"}, "is_accepted": false, "score": 2, "last_activity_date": 1474349030, "last_edit_date": 1474349030, "creation_date": 1474342832, "answer_id": 39585345, "question_id": 39585208, "link": "https://stackoverflow.com/questions/39585208/error-rendering-mime-types-of-assets-in-golang-server/39585345#39585345", "title": "Error rendering MIME Types of assets in Golang server", "body": "<p>create an assetsHandler to deal with static assets requests.</p>\n\n<pre><code>// if you are using grilla/mux\nrouter := mux.NewRouter()\nrouter.HandleFunc(\"/static/\"+`{path:\\S+}`, AssetsHandler)\n</code></pre>\n\n<p>add <code>Content-Type Header</code> based on assets' suffix:</p>\n\n<pre><code>w.Header().Set(\"Content-Type\", \"text/css\")\n</code></pre>\n\n<p><code>.css</code> -> <code>text/css</code></p>\n\n<p><code>.js</code> -> <code>text/javascript</code></p>\n\n<p>...</p>\n"}], "owner": {"reputation": 83, "user_id": 3751962, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/9w7pF.gif?s=128&g=1", "display_name": "Scorpio750", "link": "https://stackoverflow.com/users/3751962/scorpio750"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 959, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474349030, "creation_date": 1474341680, "question_id": 39585208, "link": "https://stackoverflow.com/questions/39585208/error-rendering-mime-types-of-assets-in-golang-server", "title": "Error rendering MIME Types of assets in Golang server", "body": "<p>I've got a basic Go server rendering a single page. However, when the page loads, it can't retrieve static assets (style.css, app.js) because they keep being rendered with MIME type 'text/html' instead of their respective types. </p>\n\n<p>I get this error when I load the page:</p>\n\n<blockquote>\n  <p>Resource interpreted as Stylesheet but transferred with MIME type text/html: \"<a href=\"http://localhost:8080/static/style.css\" rel=\"nofollow\">http://localhost:8080/static/style.css</a>\"</p>\n</blockquote>\n\n<p>I know the issue has to do with the HTTP Headers and setting the appropriate Content-Type. However, I'm not sure how to do that for assets that the page itself retrieves. Can anyone help me out with this?</p>\n\n<pre><code>func renderTemplate(w http.ResponseWriter, r *http.Request, msg *Message, path string) {\n    t, err := template.ParseFiles(path)\n    if err != nil {\n        http.NotFound(w, r)\n    }\n    // problem is here I think\n    err = t.Execute(w, msg)\n    if err != nil {\n        fmt.Println(\"Error writing to response writer\\n\\b\", err)\n    }\n    return\n }\n\nfunc mainHandler(w http.ResponseWriter, r *http.Request) {\n    renderTemplate(w, r, &amp;Message{Title: \"What the Fuck is Open?\", Text: \"Would you like to sort by prominence or distance?\"}, HOME)\n    return\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 2, "creation_date": 1474347264, "post_id": 39585071, "comment_id": 66481488, "body": "The problem here is the problem description itself: &quot;check if parameter being passed to func is nil&quot;. The only things which <i>can</i> be nil are pointers, interfaces, and slices/maps/channels. If <code>bean.Request</code> is none of them the question itself is not well formed. Reformulate the question to be explicit which condition on <code>bean.Request</code> you want to check; beeing nil is impossible,"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 6, "last_activity_date": 1474367108, "last_edit_date": 1495542818, "creation_date": 1474341520, "answer_id": 39585183, "question_id": 39585071, "link": "https://stackoverflow.com/questions/39585071/how-to-check-if-parameter-passed-into-function-is-nil-in-go/39585183#39585183", "title": "How to check if parameter passed into function is nil in Go?", "body": "<p>Short answer: Yes, here is the working version:</p>\n\n<pre><code>func (t *Transaction) GetOperationCount(input *bean.Request) (int, error) {\n    var result int = 0\n    if input == nil {\n        return result, nil\n    }\n    // Other code here\n    return result, nil\n}\n</code></pre>\n\n<hr>\n\n<p>You have some options (depending to your use case, see: <a href=\"https://stackoverflow.com/questions/23542989/pointers-vs-values-in-parameters-and-return-values\">Pointers vs. values in parameters and return values</a>):  </p>\n\n<p>1- You may use pointer (<code>input *bean.Request</code>) and compare it with <code>nil</code><br>\n2- you may use another struct and compare it with <code>reflect.DeepEqual(r, zero)</code><br>\n3- You may write your own <code>compare</code> function (or method with pointer or value receiver)</p>\n\n<p>See this sample (try it on <a href=\"https://play.golang.org/p/HYi6DlLedZ\" rel=\"nofollow noreferrer\">The Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"reflect\"\n)\n\nfunc (t *Transaction) GetOperationCount(input *Request) (int, error) {\n    var result int = 0\n    if input == nil {\n        return result, nil\n    }\n    // Other code here\n    return result, nil\n}\n\nfunc main() {\n    var input *Request\n    if input == nil {\n        fmt.Println(\"input is nil.\") //input is nil.\n    }\n\n    input = &amp;Request{}\n    if input != nil {\n        fmt.Println(\"input is not nil.\") //input is not nil.\n    }\n    r := Request{}\n    fmt.Printf(\"Zero value: %#v\\n\", r) //Zero value: main.Request{I:0}\n\n    zero := Request{}\n    fmt.Println(\"r == zero :\", r == zero) //r == zero : true\n\n    fmt.Println(\"DeepEqual :\", reflect.DeepEqual(r, zero)) //DeepEqual : true\n    fmt.Println(\"compare   :\", compare(&amp;r, &amp;zero))         //compare   : true\n\n}\nfunc compare(r, zero *Request) bool {\n    return r.I == zero.I\n}\n\ntype Request struct {\n    I int\n}\ntype Transaction struct{}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>input is nil.\ninput is not nil.\nZero value: main.Request{I:0}\nr == zero : true\nDeepEqual : true\ncompare   : true\n</code></pre>\n\n<hr>\n\n<p><a href=\"https://golang.org/ref/spec#Comparison_operators\" rel=\"nofollow noreferrer\">Comparison operators</a>:</p>\n\n<p>4- You may compare it with its zero value (nil for pointers, and if it is <code>struct</code> it's zero value is Empty struct if it is like <code>struct{}</code> (not <code>nil</code>), or struct with all fields initialized to their zero values):  </p>\n\n<p><a href=\"https://golang.org/ref/spec#The_zero_value\" rel=\"nofollow noreferrer\">The zero value</a>:</p>\n\n<blockquote>\n  <p>When storage is allocated for a variable, either through a declaration\n  or a call of new, or when a new value is created, either through a\n  composite literal or a call of make, and no explicit initialization is\n  provided, the variable or value is given a default value. Each element\n  of such a variable or value is set to the zero value for its type:\n  false for booleans, 0 for integers, 0.0 for floats, \"\" for strings,\n  and nil for pointers, functions, interfaces, slices, channels, and\n  maps. This initialization is done recursively, so for instance each\n  element of an array of structs will have its fields zeroed if no value\n  is specified.\n  These two simple declarations are equivalent:</p>\n\n<pre><code>var i int\nvar i int = 0\n</code></pre>\n  \n  <p>After</p>\n\n<pre><code>type T struct { i int; f float64; next *T }\nt := new(T)\n</code></pre>\n  \n  <p>the following holds:</p>\n\n<pre><code>t.i == 0\nt.f == 0.0\nt.next == nil\n</code></pre>\n  \n  <p>The same would also be true after</p>\n\n<pre><code>var t T\n</code></pre>\n</blockquote>\n\n<hr>\n\n<p>See \"reflect.DeepEqual\": <a href=\"https://stackoverflow.com/questions/24534072/how-to-compare-struct-slice-map-are-equal\">How to compare struct, slice, map are equal?</a></p>\n\n<pre><code>func DeepEqual(x, y interface{}) bool\n</code></pre>\n\n<p>Docs:</p>\n\n<blockquote>\n<pre><code> DeepEqual reports whether x and y are ``deeply equal,'' defined as follows.\n Two values of identical type are deeply equal if one of the following cases applies.\n Values of distinct types are never deeply equal.\n\n Array values are deeply equal when their corresponding elements are deeply equal.\n\n Struct values are deeply equal if their corresponding fields,\n both exported and unexported, are deeply equal.\n\n Func values are deeply equal if both are nil; otherwise they are not deeply equal.\n\n Interface values are deeply equal if they hold deeply equal concrete values.\n\n Map values are deeply equal if they are the same map object\n or if they have the same length and their corresponding keys\n (matched using Go equality) map to deeply equal values.\n\n Pointer values are deeply equal if they are equal using Go's == operator\n or if they point to deeply equal values.\n\n Slice values are deeply equal when all of the following are true:\n they are both nil or both non-nil, they have the same length,\n and either they point to the same initial entry of the same underlying array\n (that is, &amp;x[0] == &amp;y[0]) or their corresponding elements (up to length) are deeply equal.\n Note that a non-nil empty slice and a nil slice (for example, []byte{} and []byte(nil))\n are not deeply equal.\n\n Other values - numbers, bools, strings, and channels - are deeply equal\n if they are equal using Go's == operator.\n\n In general DeepEqual is a recursive relaxation of Go's == operator.\n However, this idea is impossible to implement without some inconsistency.\n Specifically, it is possible for a value to be unequal to itself,\n either because it is of func type (uncomparable in general)\n or because it is a floating-point NaN value (not equal to itself in floating-point comparison),\n or because it is an array, struct, or interface containing\n such a value.\n On the other hand, pointer values are always equal to themselves,\n even if they point at or contain such problematic values,\n because they compare equal using Go's == operator, and that\n is a sufficient condition to be deeply equal, regardless of content.\n DeepEqual has been defined so that the same short-cut applies\n to slices and maps: if x and y are the same slice or the same map,\n they are deeply equal regardless of content.\n</code></pre>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 116, "user_id": 6559048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd934e39469f78fbf51808f698c75917?s=128&d=identicon&r=PG&f=1", "display_name": "ganesh kumar", "link": "https://stackoverflow.com/users/6559048/ganesh-kumar"}, "is_accepted": false, "score": 0, "last_activity_date": 1474353017, "creation_date": 1474353017, "answer_id": 39587150, "question_id": 39585071, "link": "https://stackoverflow.com/questions/39585071/how-to-check-if-parameter-passed-into-function-is-nil-in-go/39587150#39587150", "title": "How to check if parameter passed into function is nil in Go?", "body": "<p>Yes..The error itself mentions that it cannot compare both. You can use pointer to compare with nil or create an empty struct to compare.</p>\n"}], "owner": {"reputation": 6338, "user_id": 641170, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/mc98F.jpg?s=128&g=1", "display_name": "Rudy", "link": "https://stackoverflow.com/users/641170/rudy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6119, "favorite_count": 1, "accepted_answer_id": 39585183, "answer_count": 2, "score": 3, "last_activity_date": 1474367108, "creation_date": 1474340691, "last_edit_date": 1474366927, "question_id": 39585071, "link": "https://stackoverflow.com/questions/39585071/how-to-check-if-parameter-passed-into-function-is-nil-in-go", "title": "How to check if parameter passed into function is nil in Go?", "body": "<p>Need to check if parameter being passed to func is nil and return 0.</p>\n\n<p>Below is my intended code </p>\n\n<pre><code>func (t *Transaction) GetOperationCount(input bean.Request) (int, error) {\n    var result int = 0\n    if input == nil { //error here\n        return result, nil\n    }\n    // Other code here!!!!\n    return result, nil\n}\n</code></pre>\n\n<p><code>bean.Reques</code> is a struct. \nHowever it had issue: \"cannot convert nil to type bean.Request input Request\". I have trying </p>\n\n<pre><code>if (bean.Request{})== input\n</code></pre>\n\n<p>But it gives :  </p>\n\n<pre><code>\"json:\\\"MV_STATUS\\\"\"; NDFNFFP string \"json:\\\"NDF_NFFP\\\"\"; NDFNFMV string \"json:\\\"NDF_NFMV\\\"\" } \"json:\\\"attr\\\"\" } \"json:\\\"marke\nt_value\\\"\" } \"json:\\\"market_values\\\"\" } \"json:\\\"tick\\\"\" } \"json:\\\"insertion\\\"\" } \"json:\\\"operation\\\"\" } \"json:\\\"transaction\\\"\" \n} cannot be compared)\n</code></pre>\n\n<p>Should I change the parameter to \"input *bean.Request\" ?</p>\n"}, {"tags": ["google-app-engine", "go", "google-cloud-datastore"], "answers": [{"comments": [{"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474352698, "post_id": 39586884, "comment_id": 66483528, "body": "That&#39;s what I&#39;m confirming. So, if your hierarchy is comprised of many ancestral levels, you&#39;ll need to construct a key with an ID and no ancestor, another key with its ID and the first key for this ancestor, another key with its ID and the second key for this ancestor, etc.., all of the way down until you&#39;re at the right level to access your principal record, correct? In other words, if you have a record at level N, then you&#39;ll have to construct a chain of N keys in order to retrieve it with strong consistency, correct?"}, {"owner": {"reputation": 37598, "user_id": 153407, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zoFYE.png?s=128&g=1", "display_name": "Dan McGrath", "link": "https://stackoverflow.com/users/153407/dan-mcgrath"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474380953, "post_id": 39586884, "comment_id": 66501615, "body": "@DustinOprea, that is correct. Your comment on strong consistency is misleading though, all lookups (explicit gets by key) are strongly consistent, it has nothing to do with key ancestor which must be present. Eventual consistency comes in to play when you do a query (0-n entities returned) without bounding the query to a single ancestor (entity-group)."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "reply_to_user": {"reputation": 37598, "user_id": 153407, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zoFYE.png?s=128&g=1", "display_name": "Dan McGrath", "link": "https://stackoverflow.com/users/153407/dan-mcgrath"}, "edited": false, "score": 0, "creation_date": 1474382191, "post_id": 39586884, "comment_id": 66502531, "body": "@DanMcGrath Yes.. It&#39;s the presence of ancestors that make it SC, but you&#39;d need the full chain to descend far enough. Thanks, Dan."}, {"owner": {"reputation": 37598, "user_id": 153407, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/zoFYE.png?s=128&g=1", "display_name": "Dan McGrath", "link": "https://stackoverflow.com/users/153407/dan-mcgrath"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474384065, "post_id": 39586884, "comment_id": 66503750, "body": "@DustinOprea for lookups/gets it is <i>not</i> the presence of ancestors that make it strongly consistent - they all SC, ancestor or not. I just want to make that clear. It&#39;s an important distinction."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474384481, "post_id": 39586884, "comment_id": 66503999, "body": "I&#39;m referring to the retrieval, on this side of the API. If no ancestor is used then retrieval may not get the latest version. Please confirm."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474387456, "post_id": 39586884, "comment_id": 66506060, "body": "@tx802 Also, just to clarify, can you search over a key without specifying an ancestor and potentially just have to deal with multiple results (one for every entity-group that contains a key that matching the ID), or, as you said, you can only fallback on the entities-by-kind index?"}], "tags": [], "owner": {"reputation": 3386, "user_id": 1668204, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/0bc95f5cf4f7a5da0f8c3d9bd745ab45?s=128&d=identicon&r=PG", "display_name": "tx802", "link": "https://stackoverflow.com/users/1668204/tx802"}, "is_accepted": false, "score": 2, "last_activity_date": 1474351945, "creation_date": 1474351945, "answer_id": 39586884, "question_id": 39585053, "link": "https://stackoverflow.com/questions/39585053/appengine-datastore-hierarchical-queries/39586884#39586884", "title": "AppEngine Datastore: Hierarchical queries", "body": "<p>In order to get an individual entity, its key must be globally unique - this is enforced through each entity key being unique within its entity group. The ancestor path forms an intrinsic part of the entity key for this reason.</p>\n\n<p>So, the only way to get a single entity <em>with strong consistency</em> is to specify its ancestor path. This can be done either with a get-by-key or with an ancestor query.</p>\n\n<p>If you don't know the full ancestor path, your only option is to query on a property of the entity, but bear in mind that:</p>\n\n<ul>\n<li>this may not be unique within your application</li>\n<li>you will be subject to eventual consistency.</li>\n</ul>\n"}, {"comments": [{"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474361661, "post_id": 39588605, "comment_id": 66488487, "body": "Thank you for the further clarification. It seems like this model doesn&#39;t really accommodate homogenous/recursive trees of the same entity-type. For example, in my case I have a large tree of classifiers (where the ancestor of all children in a row is the parent), but there&#39;s no practical way to 1) store an identifier that represents the parent as a key on the record, nor 2) to reference one of these classifiers from another record (because the IDs are only unique to the ancestor, so the recursive/nested ancestor/parent key would also have to be stored as a property). (Continued...)"}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474362031, "post_id": 39588605, "comment_id": 66488719, "body": "...In the interest of being immediately consistent, of course. Naturally, I could create a globally unique key and use that for lookups/references, but then  it&#39;s just eventually consistent. It seems like this model is most convenient for when you have several discrete ancestors readily at hand with which to build the compound key (a dynamic number of levels isn&#39;t as feasible) and/or you only just have a handful of heterogenous, nested entity types, e.g. company-&gt;user-&gt;invoice. Thoughts? I appreciate your insights. I&#39;m trying to figure out the patterns here."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474362712, "post_id": 39588605, "comment_id": 66489170, "body": "@DustinOprea There are multiple &quot;practical&quot; ways to store key information. One option would be to have a property of <code>Key</code> type, and the value of that property can be any <code>Key</code> value, including keys which have parents. Another option would be to store the list of IDs in a property (given you only use IDs and not string names); you could even choose to store them in a single string like <code>&quot;id1,id2&quot;</code>, or as a multi-value property (slice), like <code>[id1, id2]</code>; and having these IDs only, you can reconstruct the <code>Key</code> should you need that, e.g. with the <code>createKey()</code> function posted in the answer."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474363162, "post_id": 39588605, "comment_id": 66489474, "body": "I&#39;ve previously tried a &quot;Key&quot;-type property, but I had issues. I figured it was just inconsistency in the documentation (like where the website says Datastore can support the whole spectrum of integer sizes but the code only support int64). I&#39;ll have to give it another shot."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474363493, "post_id": 39588605, "comment_id": 66489708, "body": "@DustinOprea See <a href=\"https://cloud.google.com/appengine/docs/go/datastore/reference\" rel=\"nofollow noreferrer\">Datastore reference</a>: <i>&quot;Valid value types are: ... <code>*Key</code>, ...&quot;</i>. I assume you forgot the <code>*</code> to make it a pointer type."}, {"owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "edited": false, "score": 0, "creation_date": 1474363541, "post_id": 39588605, "comment_id": 66489733, "body": "I tried both, but I can go back to it now with fresh eyes."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1474360945, "last_edit_date": 1474360945, "creation_date": 1474358174, "answer_id": 39588605, "question_id": 39585053, "link": "https://stackoverflow.com/questions/39585053/appengine-datastore-hierarchical-queries/39588605#39588605", "title": "AppEngine Datastore: Hierarchical queries", "body": "<p>To supplement tx802's answer:</p>\n\n<p>If you want to load an entity by key, you <em>need</em> its key. If the key is such a key that has a parent, in order to form / create the key, you also need the parent key to be created prior. The parent key <em>is</em> part of the key, just like the numeric ID or the string name.</p>\n\n<p>Looking from the implementation perspective: <a href=\"https://godoc.org/google.golang.org/appengine/datastore#Key\" rel=\"nofollow\">datastore.Key</a> is a struct:</p>\n\n<pre><code>type Key struct {\n    kind      string\n    stringID  string\n    intID     int64\n    parent    *Key\n    appID     string\n    namespace string\n}\n</code></pre>\n\n<p>In order to construct a <code>Key</code> which has a parent, you must construct the parent key too, recursively. If you're finding it too verbose to always create the key hierarchy, you can create a helper function for it.</p>\n\n<p>For the sake of simplicity, let's assume all keys use the same entity name, and we only use numeric IDs. It may look like this:</p>\n\n<pre><code>func createKey(ctx context.Context, entity string, ids ...int) (k *datastore.Key) {\n    for _, id := range ids {\n        k = datastore.NewKey(ctx, entity, \"\", id, k)\n    }\n    return\n}\n</code></pre>\n\n<p>With this helper function, your example is reduced to this:</p>\n\n<pre><code>k2 := createKey(ctx, \"EntityType\", id1, id2)\nk3 := createKey(ctx, \"EntityType\", id1, id3)\n</code></pre>\n"}], "owner": {"reputation": 8363, "user_id": 706421, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/bb7e85832e0110214043a8726ad70a76?s=128&d=identicon&r=PG", "display_name": "Dustin Oprea", "link": "https://stackoverflow.com/users/706421/dustin-oprea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 2, "score": 1, "last_activity_date": 1474380978, "creation_date": 1474340577, "last_edit_date": 1474380978, "question_id": 39585053, "link": "https://stackoverflow.com/questions/39585053/appengine-datastore-hierarchical-queries", "title": "AppEngine Datastore: Hierarchical queries", "body": "<p>If you're dealing with a hierarchy of records, where most of the keys have ancestors, will you have to create a chain of all of the keys before you can retrieve a leaf?</p>\n\n<p>Example (in Go):</p>\n\n<p><code>\nrootKey = datastore.NewKey(ctx, \"EntityType\", \"\", id1, nil)\nsecondGenKey = datastore.NewKey(ctx, \"EntityType\", \"\", id2, rootKey)\nthirdGenKey = datastore.NewKey(ctx, \"EntityType\", \"\", id3, rootKey)\n</code></p>\n\n<p>How do you get the record described by <code>thirdGenKey</code> without having to declare the keys for all of the levels of the hierarchy above it?</p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1474374487, "post_id": 39584791, "comment_id": 66496838, "body": "Maybe you put a prencent <i>%</i> in the format string <i>&quot;%Y%m%d%&quot;</i>, that invalidate it. Another fast check on <i>fromDay</i> and <i>toDay</i> values."}, {"owner": {"reputation": 11, "user_id": 6851210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5495ded34ad369dc74bd6c44be239489?s=128&d=identicon&r=PG&f=1", "display_name": "laeshiny", "link": "https://stackoverflow.com/users/6851210/laeshiny"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1474432734, "post_id": 39584791, "comment_id": 66523324, "body": "I changed format string and fromDay, to Day, but it doesn&#39;t work."}, {"owner": {"reputation": 11, "user_id": 6851210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5495ded34ad369dc74bd6c44be239489?s=128&d=identicon&r=PG&f=1", "display_name": "laeshiny", "link": "https://stackoverflow.com/users/6851210/laeshiny"}, "reply_to_user": {"reputation": 2536, "user_id": 6452829, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-YQenITiE8GQ/AAAAAAAAAAI/AAAAAAAAAEE/x6XN5G1_FWA/photo.jpg?sz=128", "display_name": "Mario Santini", "link": "https://stackoverflow.com/users/6452829/mario-santini"}, "edited": false, "score": 0, "creation_date": 1474436693, "post_id": 39584791, "comment_id": 66524646, "body": "If pass &quot;date&quot;: &quot;$date&quot; instead of &quot;date&quot;: &quot;$dateToString&quot; : .... of proejct query to mongodb, It works."}], "answers": [{"tags": [], "owner": {"reputation": 11, "user_id": 6851210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5495ded34ad369dc74bd6c44be239489?s=128&d=identicon&r=PG&f=1", "display_name": "laeshiny", "link": "https://stackoverflow.com/users/6851210/laeshiny"}, "is_accepted": false, "score": 0, "last_activity_date": 1474593344, "creation_date": 1474593344, "answer_id": 39651109, "question_id": 39584791, "link": "https://stackoverflow.com/questions/39584791/datetostring-in-mgo-does-not-work/39651109#39651109", "title": "$dateToString in mgo does not work", "body": "<p>I solved it. It was my mistake. I post the answer so that anyone does not make a mistake like me. I didn't change variable type from \"time.Time\" to \"string\" like below.</p>\n\n<pre><code>//Old\ntype content struct {\n    Date  time.Time `bson:\"date\" json:\"date\"`\n}\n\n//New\ntype content struct {\n    Date  string `bson:\"date\" json:\"date\"`\n}\n</code></pre>\n\n<p>Thanks :)</p>\n"}], "owner": {"reputation": 11, "user_id": 6851210, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5495ded34ad369dc74bd6c44be239489?s=128&d=identicon&r=PG&f=1", "display_name": "laeshiny", "link": "https://stackoverflow.com/users/6851210/laeshiny"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474593344, "creation_date": 1474338333, "last_edit_date": 1474432679, "question_id": 39584791, "link": "https://stackoverflow.com/questions/39584791/datetostring-in-mgo-does-not-work", "title": "$dateToString in mgo does not work", "body": "<p>I wrote the code in Go. I have a mongodb query in mgo that has made me busy for 3 days and still fighting with it. </p>\n\n<p>Though a query with mongo shell works, mongodb query with mgo does not work.</p>\n\n<p>Below query and result are made with mongo shell.</p>\n\n<pre><code>// Query\ndb.getCollection(\"TEST\").aggregate([\n{\n    \"$match\": {\n        \"date\": {\"$gte\": new Date(\"2016-06-28\"), \"$lte\": new Date(\"2016-06-29\")},\n    }\n},\n{\n    \"$project\": {\n        \"_id\": false,\n        \"date\": {\"$dateToString\": {\"format\": \"%Y%m%d\", \"date\":\"$date\"}},\n    },\n},\n]);\n\n\n// Result\n{\n\"date\" : \"20160628\",\n}\n{\n\"date\" : \"20160629\",\n}\n</code></pre>\n\n<p>Below query and result are made with mgo. It doesn't work.</p>\n\n<pre><code>// Query\nmatchQuery := bson.M{}\nmatchQuery[\"date\"] = bson.M{\n    \"$gte\": time.Date(2016, 6, 28, 0, 0, 0, 0, time.UTC),\n    \"$lte\": time.Date(2016, 6, 29, 23, 59, 59, 0, time.UTC),\n}\nprojectQuery := bson.M{\n    \"_id\": false,\n    \"date\": bson.M{\n        \"$dateToString\": bson.M{\"format\": \"%Y%m%d\", \"date\": \"$date\"},\n    },\n}\npipeline := []bson.M{\n    {\"$match\": matchQuery},\n    {\"$project\": projectQuery},\n}\n\n\n// Result\n{\n    \"date\": \"0001-01-01T00:00:00Z\",\n},\n\n{\n    \"date\": \"0001-01-01T00:00:00Z\",\n}\n</code></pre>\n\n<p>How can I work $dateToString correctly?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 18805, "user_id": 34771, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/7c1a3f9227c0cb408f8831d27d611ab2?s=128&d=identicon&r=PG", "display_name": "Vatine", "link": "https://stackoverflow.com/users/34771/vatine"}, "is_accepted": false, "score": 2, "last_activity_date": 1474361680, "creation_date": 1474361680, "answer_id": 39589713, "question_id": 39583522, "link": "https://stackoverflow.com/questions/39583522/how-do-i-use-seekdir-telldir-in-golang/39589713#39589713", "title": "How do I use seekdir/telldir in Golang?", "body": "<p>The signature for <code>filepath.walk</code> is:</p>\n\n<pre><code>func Walk(root string, walkFn WalkFunc) error\n</code></pre>\n\n<p>The documentation states that it starts at the directory specified by <code>root</code> and the signature of the callback function (<code>walkFn</code>) is:</p>\n\n<pre><code>type WalkFunc func(path string, info os.FileInfo, err error) error\n</code></pre>\n\n<p>So you can start your scan at any given directory and walk the filesystem with that as the root. You cannot start part-way through a directory, but you can selectively prune the tree that you are walking.  </p>\n\n<p>There's also a \"magic\" return value, <code>filepath.SkipDir</code>, which skips either walking a directory (if returned when the callback is invoked on a directory) or the remaining files i the directory (if returned when the callback is invoked on a file).</p>\n\n<p>This MAY be enough to get the behaviour that you want, but it is a little hard to tell from your question. You cannot break out of a <code>filepath.Walk</code> invocation, then resume it later on. However, you may be able to work around that limitation by spawning goroutines from within your <code>walkFn</code> callback, if you're mainly concerned with the callback taking time to complete.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 0, "last_activity_date": 1474370139, "last_edit_date": 1474370139, "creation_date": 1474365011, "answer_id": 39590926, "question_id": 39583522, "link": "https://stackoverflow.com/questions/39583522/how-do-i-use-seekdir-telldir-in-golang/39590926#39590926", "title": "How do I use seekdir/telldir in Golang?", "body": "<p>You may write your own state machine:<br>\n1- Walk all the way through using <code>filepath.Walk()</code> and buffer the result, then use this buffer with state (fast).  </p>\n\n<p>2- save the <code>root string</code> for the paused state, then scan from the ground up until you reach the saved path (slow).  </p>\n\n<p>3- You may use channels, like this working sample:<br>\n(try on <a href=\"https://play.golang.org/p/wzygCwtyU2\" rel=\"nofollow\">The Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"os\"\n    \"path/filepath\"\n    \"sync\"\n    \"time\"\n)\n\nvar dirs = make(chan string, 10)\nvar wg sync.WaitGroup\n\nfunc main() {\n    wg.Add(1)\n    go GetDirectories(`../`, `*`)\n    fmt.Println()\n\n    fmt.Println(&lt;-dirs)\n    fmt.Println(&lt;-dirs)\n\n    fmt.Println()\n    time.Sleep(1 * time.Second) // pause\n\n    for dir := range dirs {\n        fmt.Println(dir)\n    }\n    wg.Wait()\n    fmt.Println(`Done.`)\n}\n\n// Returns the names of the subdirectories (including their paths)\n// that match the specified search pattern in the specified directory.\nfunc GetDirectories(root, pattern string) {\n    defer wg.Done()\n    defer close(dirs)\n    filepath.Walk(root, func(path string, fi os.FileInfo, err error) error {\n        if !fi.IsDir() {\n            return nil\n        }\n        matched, err := filepath.Match(pattern, fi.Name())\n        if err != nil {\n            return err\n        }\n        if !matched {\n            return nil\n        }\n        dirs &lt;- path //dirs = append(dirs, path)\n        return nil\n    })\n}\n</code></pre>\n"}], "owner": {"reputation": 1579, "user_id": 1354514, "user_type": "registered", "accept_rate": 55, "profile_image": "https://www.gravatar.com/avatar/e83e6f559891e7489995dfa43e010fa3?s=128&d=identicon&r=PG", "display_name": "steve landiss", "link": "https://stackoverflow.com/users/1354514/steve-landiss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 171, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1474370139, "creation_date": 1474327484, "last_edit_date": 1474365851, "question_id": 39583522, "link": "https://stackoverflow.com/questions/39583522/how-do-i-use-seekdir-telldir-in-golang", "title": "How do I use seekdir/telldir in Golang?", "body": "<p>I need to walk a filesystem in Golang and need to be able to resume scanning after restarting.</p>\n\n<p>In C, I can do this via <code>telldir()</code> and then a <code>seekdir()</code> while resuming.</p>\n\n<p>Golang only offers a <code>filepath.Walk()</code> function but that provides no way to start walking  the filesystem from a specific path or point.</p>\n\n<p>This makes it inefficient for large filesystems</p>\n\n<p>Any way around it?</p>\n"}, {"tags": ["go", "timeout", "channel"], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474321227, "post_id": 39582555, "comment_id": 66474903, "body": "that <code>break</code> only breaks from the <code>select</code>. You need a label or a return to break from the for loop."}, {"owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474321946, "post_id": 39582555, "comment_id": 66475196, "body": "Thanks, I wrote that up too quickly. I added a label, but I guess usually this would be inside a func and a return would be much more readable."}], "tags": [], "owner": {"reputation": 4040, "user_id": 457278, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/53932837788d45d6947b7a8e4da90b09?s=128&d=identicon&r=PG", "display_name": "djd", "link": "https://stackoverflow.com/users/457278/djd"}, "is_accepted": true, "score": 3, "last_activity_date": 1474321904, "last_edit_date": 1474321904, "creation_date": 1474321171, "answer_id": 39582555, "question_id": 39582403, "link": "https://stackoverflow.com/questions/39582403/golang-timing-out-reading-from-channel-using-range/39582555#39582555", "title": "golang timing out reading from channel using range", "body": "<p>You want to do something similar, but use single timeout channel for the whole loop:</p>\n\n<pre><code>const timeout = 30 * time.Second\noutc := make(chan struct{})\ntimec := time.After(timeout)\n\nRangeLoop:\nfor {\n    select {\n    case &lt;-timec:\n        break RangeLoop // timed out\n    case out, ok := &lt;-outc:\n        if !ok {\n            break RangeLoop // Channel closed\n        }\n        // do something with out\n    }\n}\n</code></pre>\n"}], "owner": {"reputation": 8339, "user_id": 1581069, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/53f781d013b1bdba5b7356908a82d356?s=128&d=identicon&r=PG", "display_name": "Peter Butkovic", "link": "https://stackoverflow.com/users/1581069/peter-butkovic"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 619, "favorite_count": 0, "accepted_answer_id": 39582555, "answer_count": 1, "score": 1, "last_activity_date": 1474321904, "creation_date": 1474320462, "question_id": 39582403, "link": "https://stackoverflow.com/questions/39582403/golang-timing-out-reading-from-channel-using-range", "title": "golang timing out reading from channel using range", "body": "<p>My code looks like this:</p>\n\n<pre><code>outChannel := make(chan struct{})\n...\nfor out := range outChannel {\n   ...\n}\n</code></pre>\n\n<p>I have a producer writing to <code>outChannel</code> and would like to timeout on reading from it (if overall processing takes more than XX seconds). \nWhat would be the proper way to do so? </p>\n\n<p>As I've only seen construct (at: <a href=\"https://github.com/golang/go/wiki/Timeouts\" rel=\"nofollow\">https://github.com/golang/go/wiki/Timeouts</a>) using <code>select</code> with multiple <code>case</code>s reading from the channels, however, this seems not applicable once using <code>range</code>.</p>\n"}, {"tags": ["templates", "dictionary", "web", "go"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 6, "last_activity_date": 1474316982, "last_edit_date": 1592644375, "creation_date": 1474316982, "answer_id": 39581591, "question_id": 39581413, "link": "https://stackoverflow.com/questions/39581413/iterate-map-dictionary-in-golang-template/39581591#39581591", "title": "iterate Map / Dictionary in golang template", "body": "<p>You can &quot;range&quot; over a map in templates just like you can &quot;range-loop&quot; over map values in Go. You can also assign the map key and value to a temporary variable during the iteration.</p>\n<p>Quoting from package doc of <a href=\"https://golang.org/pkg/text/template/\" rel=\"nofollow noreferrer\"><code>text/template</code></a>:</p>\n<blockquote>\n<p>If a &quot;range&quot; action initializes a variable, the variable is set to the successive elements of the iteration. Also, a &quot;range&quot; may declare two variables, separated by a comma:</p>\n<pre><code>range $index, $element := pipeline\n</code></pre>\n<p>in which case $index and $element are set to the successive values of the array/slice index or map key and element, respectively.</p>\n</blockquote>\n<p>Everything in <code>text/template</code> also applies to <a href=\"https://golang.org/pkg/html/template/\" rel=\"nofollow noreferrer\"><code>html/template</code></a>.</p>\n<p>See this working example:</p>\n<pre><code>templ := `{{range $k, $v := .ArchiveList}}Key: {{$k}}, Value: {{$v}}\n{{end}}`\nt := template.Must(template.New(&quot;&quot;).Parse(templ))\np := indexPageStruct{\n    ArchiveList: map[string]int{&quot;one&quot;: 1, &quot;two&quot;: 2},\n}\nif err := t.Execute(os.Stdout, p); err != nil {\n    panic(err)\n}\n</code></pre>\n<p>Output (try it on the <a href=\"https://play.golang.org/p/Oe2N3dPfZt\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n<pre><code>Key: one, Value: 1\nKey: two, Value: 2\n</code></pre>\n"}], "owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 6110, "favorite_count": 1, "accepted_answer_id": 39581591, "answer_count": 1, "score": 2, "last_activity_date": 1485261520, "creation_date": 1474316323, "last_edit_date": 1485261520, "question_id": 39581413, "link": "https://stackoverflow.com/questions/39581413/iterate-map-dictionary-in-golang-template", "title": "iterate Map / Dictionary in golang template", "body": "<p>I'm a beginner at Go and am teaching myself some web dev. I'm trying to loop over a map in a template file and cant find any documentation on how to do it. Here is my struct i pass in:</p>\n\n<pre><code>type indexPageStruct struct {\nBlogPosts   []post\nArchiveList map[string]int\n}\n</code></pre>\n\n<p>I can loop over BlogPosts just fine using: </p>\n\n<pre><code>{{range .BlogPosts}}\n                &lt;article&gt;\n                    &lt;h2&gt;&lt;a href=\"/\"&gt;{{.Title}}&lt;/a&gt;&lt;/h2&gt;\n...\n</code></pre>\n\n<p>But i cant seem to figure out how to do something like :</p>\n\n<pre><code>{{range .ArchiveList}}\n                &lt;article&gt;\n                    &lt;h2&gt;&lt;a href=\"/\"&gt;{{.Key}}  {{.Value}}&lt;/a&gt;&lt;/h2&gt;\n....\n</code></pre>\n"}, {"tags": ["session", "go", "session-cookies"], "answers": [{"tags": [], "owner": {"reputation": 671, "user_id": 8027157, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-4Y5L-llxerk/AAAAAAAAAAI/AAAAAAAAKPQ/XT9OPmmLZqU/photo.jpg?sz=128", "display_name": "Manasseh", "link": "https://stackoverflow.com/users/8027157/manasseh"}, "is_accepted": false, "score": 0, "last_activity_date": 1533478047, "creation_date": 1533478047, "answer_id": 51695051, "question_id": 39581257, "link": "https://stackoverflow.com/questions/39581257/golang-iris-sessions-are-not-persistent/51695051#51695051", "title": "Golang iris sessions are not persistent", "body": "<p>You should import the session package first <code>go get \"github.com/kataras/iris/sessions\"</code>\nthen create a session with <code>var sess = sessions.New(sessions.Config{Cookie: \"cookie-name\" })</code><a href=\"https://docs.iris-go.com/sessions.html\" rel=\"nofollow noreferrer\">read this documentation to see how this work</a></p>\n"}], "owner": {"reputation": 673, "user_id": 518047, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/a72cb1c4104cad38167bacd614c26a49?s=128&d=identicon&r=PG", "display_name": "Chris", "link": "https://stackoverflow.com/users/518047/chris"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 596, "favorite_count": 1, "answer_count": 1, "score": 2, "last_activity_date": 1533478047, "creation_date": 1474315698, "question_id": 39581257, "link": "https://stackoverflow.com/questions/39581257/golang-iris-sessions-are-not-persistent", "title": "Golang iris sessions are not persistent", "body": "<p>I'm stuck on getting sessions to work in GoLang.  Specifically within Iris.</p>\n\n<p>Calling a route with \"Login\" will print out a token; then when I call a route with Restricted, the token is empty.  Am I doing something wrong or do I misunderstand the concept behind sessions in GoLang?</p>\n\n<pre><code>func Login(c *iris.Context) {\n    username := c.FormValueString(\"email\")\n    password := c.FormValueString(\"password\")\n    test := \"unauthorized\"\n    if username == \"jon@snow.com\" &amp;&amp; password == \"123abc!@#\" {\n        token := jwt.NewWithClaims(jwt.SigningMethodHS256, jwt.MapClaims{\n            \"name\": \"Jon Snow\",\n            \"exp\": time.Now().Add(time.Hour * 72).Unix(),\n        })\n\n        t, err := token.SignedString([]byte(\"SecretKey\"))\n        if err != nil {\n            panic(err)\n        }\n\n        c.Session().Set(\"token\", t)\n        test = c.Session().GetString(\"token\")\n    }\n\n    c.Text(200, test)\n}\n\n\n\nfunc Restricted(c *iris.Context) {  \n    tokenString := c.Session().GetString(\"token\")\n    if tokenString != \"\" {\n        c.Text(iris.StatusOK, tokenString)\n    } else {\n        c.Text(iris.StatusOK, \"no Token\")\n    }\n}\n</code></pre>\n"}, {"tags": ["amazon-web-services", "go", "amazon-s3"], "comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 1, "creation_date": 1474311172, "post_id": 39579250, "comment_id": 66470217, "body": "Don&#39;t ignore errors. You&#39;re ignoring it on <code>svc.ListObjects(params)</code>"}, {"owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1474311486, "post_id": 39579250, "comment_id": 66470352, "body": "thanks @jcbwlkr. I figured it out already. <a href=\"http://docs.aws.amazon.com/general/latest/gr/rande.html\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/general/latest/gr/rande.html</a> I can list the files now, but havent been able to download them yet"}], "answers": [{"tags": [], "owner": {"reputation": 26668, "user_id": 134484, "user_type": "registered", "accept_rate": 60, "profile_image": "https://www.gravatar.com/avatar/a7263d0aad8f750b83d52b6a58a44b4b?s=128&d=identicon&r=PG", "display_name": "Mark Richman", "link": "https://stackoverflow.com/users/134484/mark-richman"}, "is_accepted": false, "score": 2, "last_activity_date": 1496684533, "creation_date": 1496684533, "answer_id": 44374649, "question_id": 39579250, "link": "https://stackoverflow.com/questions/39579250/get-file-from-an-image-hosted-at-aws-with-golang/44374649#44374649", "title": "Get *File from an image hosted at AWS with Golang", "body": "<p>Try something like this:</p>\n\n<pre><code>log.Printf(\"Fetching s3://%v/%v\", bucket, key)\n\nbuff := &amp;aws.WriteAtBuffer{}\ns3dl := s3manager.NewDownloader(sess)\n_, err := s3dl.Download(buff, &amp;s3.GetObjectInput{\n    Bucket: aws.String(bucket),\n    Key:    aws.String(key),\n})\n\nif err != nil {\n    log.Printf(\"Could not download from S3: %v\", err)\n}\n</code></pre>\n\n<p>Then you can get the contents as <code>buff.Bytes()</code></p>\n"}], "owner": {"reputation": 5278, "user_id": 3074508, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/6bbb9b3baf8440bc7a00e3147378bcf2?s=128&d=identicon&r=PG", "display_name": "CESCO", "link": "https://stackoverflow.com/users/3074508/cesco"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1470, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1496684533, "creation_date": 1474307502, "last_edit_date": 1474313214, "question_id": 39579250, "link": "https://stackoverflow.com/questions/39579250/get-file-from-an-image-hosted-at-aws-with-golang", "title": "Get *File from an image hosted at AWS with Golang", "body": "<p>I can succeffully list all files(jpg photos) inside a S3 Bucket and make an []s3.Objects with it. Now I want to get a pointer to file from one of those photos, but I still cannot download them.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"github.com/aws/aws-sdk-go/aws/credentials\"\n    \"os\"\n    \"github.com/aws/aws-sdk-go/aws/session\"\n    \"github.com/aws/aws-sdk-go/aws\"\n    \"github.com/aws/aws-sdk-go/service/s3\"\n    //\"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n    \"github.com/aws/aws-sdk-go/service/s3/s3manager\"\n)\n\nfunc main() {\n    acess := \"***********\"\n    secret := \"******\"\n    log.Println(acess + secret)\n    creds := credentials.NewStaticCredentials(acess, secret, \"\")\n    _, err := creds.Get()\n\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    sess := s3.New(session.New(), &amp;aws.Config{\n        Credentials: creds,\n        Region: aws.String(\"sa-east-1\"),\n        //LogLevel:    aws.LogLevel(aws.LogDebug),\n    })\n\n    params := &amp;s3.ListObjectsInput{\n        Bucket: aws.String(\"cescocats\"),\n    }\n    //\n\n    resp, err := sess.ListObjects(params)\n    if err != nil {\n        fmt.Println(err)\n        os.Exit(1)\n    }\n\n    var allPhotos []s3.Object\n\n    //log.Println(resp.String())\n    for _, key := range resp.Contents {\n        allPhotos = append(allPhotos, *key)\n    }\n\n    log.Println(allPhotos)\n    // Set up a new s3manager client\n\n    manager := s3manager.NewDownloader(session.New(), func(d *s3manager.Downloader) {\n        d.PartSize = 1 * 1024 * 1024 // 64MB per part\n    })\n    log.Println(manager)\n    buff := new([]byte)\n\n\n    hehe := s3.GetObjectInput{Key:allPhotos[0].Key}\n    manager.Download(aws.WriteAtBuffer{}, hehe)\n\n}\n</code></pre>\n\n<p>How do download a file from S3 using github.com/aws/aws-sdk-go ? Is there any other way? Do I really need to download the file to get its content?</p>\n"}, {"tags": ["go", "build", "shared-libraries"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474303639, "post_id": 39577936, "comment_id": 66466252, "body": "You can&#39;t use <code>go install --ldflags &quot;-o foo&quot;</code> because the install step won&#39;t know what the linker named the file (and that crash has been fixed for a while now, unless you can show a new repro on the current master)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474307148, "post_id": 39577936, "comment_id": 66468137, "body": "The output from the Go toolchain seems quite clear <code>-buildmode=shared and -o not supported together</code>. Would it be possible to build the shared libs separately? If the naming scheme is a problem for you, I would bring it up on the mailing list or open an issue."}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474314522, "post_id": 39577936, "comment_id": 66471951, "body": "@JimB possible? - Kind of. Comfortable? - Absolutely not. Wrt crash: well, it&#39;s in Go 1.6.1. So, &quot;a while&quot; would be like... five months or so? I understand it that Go developers don&#39;t backport anything, even if the bug leads to a total dysfunction? Wrt the explanation: that&#39;s kind of lame... seriously, that&#39;s not even an actual problem.  Anyways, it&#39;s good to know there isn&#39;t a way to do it, so I don&#39;t have to spend time trying to find one."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474317855, "post_id": 39577936, "comment_id": 66473552, "body": "WRT what explanation? I only pointed out that the the go tool is clear that the combination of options is not supported. If you would like to discuss why, or open an issue to change the behavior, StackOverflow is not the place to do that. AFAIK, the primary consumers and proponents of <code>-buildmode=shared</code> are linux distros so that dependencies can be packaged individually. I personally haven&#39;t seen anyone try this particular use case (combined with your other SO questions), which doesn&#39;t seem unreasonable; it&#39;s just likely that no one has encountered this issue before."}, {"owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474347943, "post_id": 39577936, "comment_id": 66481680, "body": "@JimB What I&#39;m saying is that wasn&#39;t an actual reason. This is just an oversight. No sane person would intentionally do something like that."}], "owner": {"reputation": 4742, "user_id": 5691066, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/e5ab5db401198485d4569199f9994a7d?s=128&d=identicon&r=PG", "display_name": "wvxvw", "link": "https://stackoverflow.com/users/5691066/wvxvw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 223, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474302851, "creation_date": 1474302851, "question_id": 39577936, "link": "https://stackoverflow.com/questions/39577936/specify-name-of-shared-object-shared-library", "title": "Specify name of shared object (shared library)", "body": "<p>The names Go compiler generates for shared objects are bad.  Example:</p>\n\n<pre><code>go install -buildmode=shared -linkshared github.com/apache/thrift/lib/go/thrift code.google.com/p/go-uuid/uuid\n</code></pre>\n\n<p>Produces shared object named: <code>libgithub.com-apache-thrift-lib-go-thrift,code.google.com-p-go-uuid-uuid.so</code> (I need to link together about thirty packages, and this would create a file name several KB large).  Reading through <code>go help build</code> and related documentation I don't see anywhere any options for specifying the shared object name.  I tried <code>-o</code> but it's not supported.  As an interesting aside, if you call <code>go install --ldflags \"-o foo\"</code>, then Go compiler crashes with an NPE...</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 6849619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x13BNNuKVz8/AAAAAAAAAAI/AAAAAAAAAIY/KDjWbE8QQAs/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6849619/jonathan"}, "edited": false, "score": 0, "creation_date": 1474390630, "post_id": 39587136, "comment_id": 66508016, "body": "This will not work, because <code>request.Header</code> will won&#39;t setup to <b>CONNECT</b>  request."}, {"owner": {"reputation": 547, "user_id": 4036946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wMtQe.gif?s=128&g=1", "display_name": "jsxqf", "link": "https://stackoverflow.com/users/4036946/jsxqf"}, "reply_to_user": {"reputation": 1, "user_id": 6849619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x13BNNuKVz8/AAAAAAAAAAI/AAAAAAAAAIY/KDjWbE8QQAs/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6849619/jonathan"}, "edited": false, "score": 0, "creation_date": 1474423882, "post_id": 39587136, "comment_id": 66521216, "body": "I think proxy server can&#39;t &#39;see&#39; the request header when you are using <code>CONNECT</code>, check here: <a href=\"https://stackoverflow.com/questions/10369679/do-http-proxy-servers-modify-request-packets\" title=\"do http proxy servers modify request packets\">stackoverflow.com/questions/10369679/&hellip;</a>"}], "tags": [], "owner": {"reputation": 547, "user_id": 4036946, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/wMtQe.gif?s=128&g=1", "display_name": "jsxqf", "link": "https://stackoverflow.com/users/4036946/jsxqf"}, "is_accepted": false, "score": 0, "last_activity_date": 1474352942, "creation_date": 1474352942, "answer_id": 39587136, "question_id": 39577378, "link": "https://stackoverflow.com/questions/39577378/golang-net-http-transport-proxy-connect-method-header-supporting/39587136#39587136", "title": "Golang net/http/transport proxy CONNECT method header supporting", "body": "<p>how about this:</p>\n\n<pre><code>// ...\nrequest, err := http.NewRequest(\"GET\", \"https://www.google.com\", nil)\nif err != nil {\n  // do something\n}\n// add header here.\nrequest.Header.Add(\"X-Header\", \"xxx\")\n\nresponse, err := client.Do(request)\nif err != nil {\n  // do something\n}\n// ...\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 6849619, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-x13BNNuKVz8/AAAAAAAAAAI/AAAAAAAAAIY/KDjWbE8QQAs/photo.jpg?sz=128", "display_name": "Jonathan", "link": "https://stackoverflow.com/users/6849619/jonathan"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1388, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474352942, "creation_date": 1474300854, "question_id": 39577378, "link": "https://stackoverflow.com/questions/39577378/golang-net-http-transport-proxy-connect-method-header-supporting", "title": "Golang net/http/transport proxy CONNECT method header supporting", "body": "<p>Golang's package net/http/transport can automatic setup <code>Proxy-Authorization</code> header in </p>\n\n<pre><code>func (t *Transport) dialConn(ctx context.Context, cm connectMethod) (*persistConn, error)\n</code></pre>\n\n<p>like</p>\n\n<pre><code>proxyURL, _ := url.Parse(\"http://username:password@example.com\")\nclient      := http.Client{Transport: &amp;http.Transport{Proxy:http.ProxyURL(proxyURL)}}\n</code></pre>\n\n<p>But I need submit X-Header to proxy server. How Can I custom transport CONNECT method request header?</p>\n\n<p><a href=\"https://golang.org/src/net/http/transport.go\" rel=\"nofollow\">net/http/transport</a></p>\n"}, {"tags": ["go", "jpeg", "imaging"], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": false, "score": 0, "last_activity_date": 1474301806, "last_edit_date": 1474301806, "creation_date": 1474301301, "answer_id": 39577526, "question_id": 39577318, "link": "https://stackoverflow.com/questions/39577318/encoding-an-image-to-jpeg-in-go/39577526#39577526", "title": "Encoding an Image to JPEG in Go", "body": "<p>Maybe something to check: The <code>image: unknown format</code> is a common error when you don't include the <code>image/jpeg</code> lib  and specifically decode it with it:</p>\n\n<pre><code>import (\n  \"image/jpeg\"\n  \"io\"\n)\n\n...    \n  img, err := jpeg.Decode(r)\n  if err != nil {\n     return err\n  }\n...\n</code></pre>\n\n<p>Some try to use <code>image.Decode</code>, but you still need to include the <code>image/jpeg</code> lib.</p>\n\n<p>I believe it works with a blind include:</p>\n\n<pre><code>import (\n  _ \"image/jpeg\"\n  \"image\"\n  \"io\"\n)\n\n...    \n  img, err := image.Decode(r)\n  if err != nil {\n     return err\n  }\n...\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "is_accepted": false, "score": 2, "last_activity_date": 1474302155, "creation_date": 1474302155, "answer_id": 39577739, "question_id": 39577318, "link": "https://stackoverflow.com/questions/39577318/encoding-an-image-to-jpeg-in-go/39577739#39577739", "title": "Encoding an Image to JPEG in Go", "body": "<p>So, it looks like this may be an issue with the <code>github.com/disintegration/imaging</code> lib. I posted an issue about it in the repo's page. </p>\n\n<p>If I change my <code>GetBytes()</code> function to this, I get valid JPEG:</p>\n\n<pre><code>func (s SpriteImage) GetBytes() ([]byte, error) {\n    var b bytes.Buffer\n    w := bufio.NewWriter(&amp;b)\n\n    if s.sprite == nil {\n        return nil, fmt.Errorf(\"sprite is nil\")\n    }\n\n    im := s.sprite\n    err := jpeg.Encode(w, im, &amp;jpeg.Options{jpegCompression})\n\n    if err != nil {\n        fmt.Println(err)\n    }\n\n    return b.Bytes(), nil\n}\n</code></pre>\n"}], "owner": {"reputation": 5183, "user_id": 2534777, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/f9d1450403b864d6b17f30ba0ce0aee3?s=128&d=identicon&r=PG", "display_name": "orcaman", "link": "https://stackoverflow.com/users/2534777/orcaman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4940, "favorite_count": 0, "answer_count": 2, "score": 3, "last_activity_date": 1474302155, "creation_date": 1474300659, "question_id": 39577318, "link": "https://stackoverflow.com/questions/39577318/encoding-an-image-to-jpeg-in-go", "title": "Encoding an Image to JPEG in Go", "body": "<p>I have a struct called SpriteImage which is defined like this:</p>\n\n<pre><code>type SpriteImage struct {\n    dimentions      image.Point\n    lastImgPosition image.Point\n    sprite          *image.NRGBA\n}\n</code></pre>\n\n<p>In my flow, I first initiate a new such struct:</p>\n\n<pre><code>func NewSpriteImage(width, height int) SpriteImage {\n    c := color.RGBA{0xff, 0xff, 0xff, 0xff}\n    blankImage := imaging.New(width, height, c)\n\n    return SpriteImage{\n        dimentions:      image.Point{X: width, Y: height},\n        lastImgPosition: image.Point{X: 0, Y: 0},\n        sprite:          blankImage,\n    }\n}\n</code></pre>\n\n<p>And then I add images to this SpriteImage like so:</p>\n\n<pre><code>func (s *SpriteImage) AddImage(img image.Image) error {\n    imgWidth := img.Bounds().Dx()\n    imgHeight := img.Bounds().Dy()\n\n    // Make sure new image will fit into the sprite.\n    if imgWidth != s.dimentions.X {\n        return fmt.Errorf(\"image width %d mismatch sprite width %d\", imgWidth, s.dimentions.X)\n    }\n\n    spriteHeightLeft := s.dimentions.Y - s.lastImgPosition.Y\n    if imgHeight &gt; spriteHeightLeft {\n        return fmt.Errorf(\"image height %d won't fit into sprite, sprite free space %d \", imgHeight, s.dimentions.Y)\n    }\n\n    // add image to sprite\n    s.sprite = imaging.Paste(s.sprite, img, s.lastImgPosition)\n\n    // update next image position within sprite\n    s.lastImgPosition = s.lastImgPosition.Add(image.Point{X: 0, Y: imgHeight})\n\n    return nil\n}\n</code></pre>\n\n<p>Eventually, I want to take this <code>SpriteImage</code> and encode it as <code>JPEG</code>. But it doesn't seem to work. The <a href=\"https://golang.org/src/image/jpeg/writer_test.go\" rel=\"nofollow\">native JPEG Encode function</a> takes up an image, but I have an image.NRGBA. So I'm using <code>github.com/disintegration/imaging</code> lib like so:</p>\n\n<pre><code>func (s SpriteImage) GetBytes() ([]byte, error) {\n    var b bytes.Buffer\n    w := bufio.NewWriter(&amp;b)\n\n    if s.sprite == nil {\n        return nil, fmt.Errorf(\"sprite is nil\")\n    }\n\n    if err := imaging.Encode(w, s.sprite, imaging.JPEG); err != nil {\n        return nil, err\n    }\n\n    return b.Bytes(), nil\n}\n</code></pre>\n\n<p>However is seems that the bytes returned are not in fact <code>JPEG</code>. The native Go JPEG lib will not decode those bytes to a Go image struct. If I try to decode those bytes to image like so:</p>\n\n<pre><code>     m, _, err := image.Decode(reader)\n     if err != nil {\n        log.Fatal(err)\n     }\n</code></pre>\n\n<p>I'm getting err:</p>\n\n<p><code>image: unknown format</code></p>\n\n<p>Any ideas?  </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1474299273, "post_id": 39576657, "comment_id": 66463618, "body": "Start by reading <a href=\"https://golang.org/doc/code.html\" rel=\"nofollow noreferrer\">How to Write Go Code</a>."}, {"owner": {"reputation": 1391, "user_id": 787774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/U6xHY.jpg?s=128&g=1", "display_name": "Khaled Garbaya", "link": "https://stackoverflow.com/users/787774/khaled-garbaya"}, "reply_to_user": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1474300239, "post_id": 39576657, "comment_id": 66464225, "body": "I did read all of that, my question is about workflow more than the language"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 2, "creation_date": 1474309782, "post_id": 39576657, "comment_id": 66469473, "body": "The document shows the commands to use to build, test and fetch Go packages.  It does leave pushing a package to a repo as an exercise for the user."}], "answers": [{"comments": [{"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1474303790, "post_id": 39576965, "comment_id": 66466343, "body": "Have a look at <a href=\"https://github.com/tockins/realize\" rel=\"nofollow noreferrer\">github.com/tockins/realize</a> too"}, {"owner": {"reputation": 3312, "user_id": 4175960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QbvYc.png?s=128&g=1", "display_name": "Eddy Hernandez", "link": "https://stackoverflow.com/users/4175960/eddy-hernandez"}, "reply_to_user": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1474305333, "post_id": 39576965, "comment_id": 66467210, "body": "@AJPennster Thanks for share. It looks interesting. I&#39;ll check it."}], "tags": [], "owner": {"reputation": 3312, "user_id": 4175960, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QbvYc.png?s=128&g=1", "display_name": "Eddy Hernandez", "link": "https://stackoverflow.com/users/4175960/eddy-hernandez"}, "is_accepted": true, "score": 0, "last_activity_date": 1474476497, "last_edit_date": 1474476497, "creation_date": 1474299370, "answer_id": 39576965, "question_id": 39576657, "link": "https://stackoverflow.com/questions/39576657/go-library-automation/39576965#39576965", "title": "Go Library automation", "body": "<p>Here some useful links</p>\n\n<ul>\n<li>Here you have a link for best practice for coding </li>\n</ul>\n\n<p><a href=\"https://peter.bourgon.org/go-best-practices-2016/\" rel=\"nofollow\">https://peter.bourgon.org/go-best-practices-2016/</a></p>\n\n<p><a href=\"https://golang.org/doc/code.html\" rel=\"nofollow\">https://golang.org/doc/code.html</a></p>\n\n<ul>\n<li>Working with packages, useful links.</li>\n</ul>\n\n<p><a href=\"http://thenewstack.io/understanding-golang-packages/\" rel=\"nofollow\">http://thenewstack.io/understanding-golang-packages/</a></p>\n\n<p><a href=\"https://www.goinggo.net/2013/07/how-packages-work-in-go-language.html\" rel=\"nofollow\">https://www.goinggo.net/2013/07/how-packages-work-in-go-language.html</a></p>\n\n<ul>\n<li>I recommend to review the open source libraries to get an idea.(there are tons of them)</li>\n</ul>\n\n<p><a href=\"https://github.com/urfave/cli\" rel=\"nofollow\">https://github.com/urfave/cli</a></p>\n\n<p><a href=\"https://github.com/boltdb/raw\" rel=\"nofollow\">https://github.com/boltdb/raw</a></p>\n\n<p><a href=\"https://github.com/matryer/try\" rel=\"nofollow\">https://github.com/matryer/try</a></p>\n\n<ul>\n<li>To automate your project. I recommend to see projects like Drone</li>\n</ul>\n\n<p><a href=\"https://github.com/drone/drone\" rel=\"nofollow\">https://github.com/drone/drone</a></p>\n"}], "owner": {"reputation": 1391, "user_id": 787774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/U6xHY.jpg?s=128&g=1", "display_name": "Khaled Garbaya", "link": "https://stackoverflow.com/users/787774/khaled-garbaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 67, "favorite_count": 0, "closed_date": 1474359727, "accepted_answer_id": 39576965, "answer_count": 1, "score": -2, "last_activity_date": 1474476497, "creation_date": 1474298276, "question_id": 39576657, "link": "https://stackoverflow.com/questions/39576657/go-library-automation", "closed_reason": "Opinion-based", "title": "Go Library automation", "body": "<p>To learn go I am trying to build an open source library, I like the language but since I am still a bit new I can't find good direction on how to automate building, testing and releasing.\nI had the idea to use Makefiles etc.. am I in the right direction or there is better tools to do that.</p>\n\n<p>Best,\nKhaled</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474298457, "post_id": 39576593, "comment_id": 66463125, "body": "Which version of what?"}, {"owner": {"reputation": 1391, "user_id": 787774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/U6xHY.jpg?s=128&g=1", "display_name": "Khaled Garbaya", "link": "https://stackoverflow.com/users/787774/khaled-garbaya"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474298509, "post_id": 39576593, "comment_id": 66463168, "body": "The version of the library"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474298906, "post_id": 39576593, "comment_id": 66463395, "body": "If you&#39;re building the library, then you can do whatever you want, i.e. use a &quot;Version&quot; variable or function."}, {"owner": {"reputation": 1391, "user_id": 787774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/U6xHY.jpg?s=128&g=1", "display_name": "Khaled Garbaya", "link": "https://stackoverflow.com/users/787774/khaled-garbaya"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474298981, "post_id": 39576593, "comment_id": 66463438, "body": "But that will include changing the version variable every time i publish a new version"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474299234, "post_id": 39576593, "comment_id": 66463598, "body": "You need to change the version <i>somewhere</i>, do you mean you want to set a variable at build time rather than in the source?"}, {"owner": {"reputation": 1391, "user_id": 787774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/U6xHY.jpg?s=128&g=1", "display_name": "Khaled Garbaya", "link": "https://stackoverflow.com/users/787774/khaled-garbaya"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474299298, "post_id": 39576593, "comment_id": 66463642, "body": "Yes something like that if possible"}], "owner": {"reputation": 1391, "user_id": 787774, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/U6xHY.jpg?s=128&g=1", "display_name": "Khaled Garbaya", "link": "https://stackoverflow.com/users/787774/khaled-garbaya"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 43, "favorite_count": 0, "closed_date": 1474299313, "answer_count": 0, "score": 1, "last_activity_date": 1474314912, "creation_date": 1474298066, "last_edit_date": 1474314912, "question_id": 39576593, "link": "https://stackoverflow.com/questions/39576593/get-the-current-version-of-the-package-in-go", "closed_reason": "Duplicate", "title": "Get the current version of the package in GO", "body": "<p>I am building a library and I need to check at runtime which version the user is using, for example to pass the version to a User agent etc...\nIs there a way to do that in go?</p>\n"}, {"tags": ["go", "goroutine"], "answers": [{"comments": [{"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1474297667, "post_id": 39576328, "comment_id": 66462618, "body": "im not sure why the channel &lt;- val will block forever? isnt it inside a goroutine?  when i called  go addStuff(mynums)?  i thought the for loop would run until all elements are added to the channel. Then , wg.Done() would execute. causing wg.Wait() to return?"}, {"owner": {"reputation": 14648, "user_id": 858366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd0f37b6d356a8149db01cd8ca21f1c?s=128&d=identicon&r=PG", "display_name": "c.P.u1", "link": "https://stackoverflow.com/users/858366/c-p-u1"}, "reply_to_user": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1474297951, "post_id": 39576328, "comment_id": 66462800, "body": "The channel you&#39;re writing to is unbuffered and writing to an unbuffered channel blocks until another goroutine has received from that channel. You&#39;re calling <code>wg.Wait()</code>, which blocks until <code>wg.Done()</code> is called, so <code>receiveStuff()</code> never runs to drain the channel."}, {"owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 0, "creation_date": 1474298044, "post_id": 39576328, "comment_id": 66462862, "body": "so draining the channel needs to happen instantaneously in an unbuffered channel?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "edited": false, "score": 1, "creation_date": 1474298358, "post_id": 39576328, "comment_id": 66463047, "body": "@user1232726: You need concurrent send and receive on an unbuffered channel. That&#39;s the entire point of using an unbuffered channel, to communicate and synchronize concurrent processes -- <a href=\"https://en.wikipedia.org/wiki/Communicating_sequential_processes\" rel=\"nofollow noreferrer\">Communicating Sequential Processes</a>"}], "tags": [], "owner": {"reputation": 14648, "user_id": 858366, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ddd0f37b6d356a8149db01cd8ca21f1c?s=128&d=identicon&r=PG", "display_name": "c.P.u1", "link": "https://stackoverflow.com/users/858366/c-p-u1"}, "is_accepted": true, "score": 1, "last_activity_date": 1474299053, "last_edit_date": 1474299053, "creation_date": 1474297268, "answer_id": 39576328, "question_id": 39576130, "link": "https://stackoverflow.com/questions/39576130/using-golang-channels-getting-all-goroutines-are-asleep-deadlock/39576328#39576328", "title": "using golang channels. GETTING &quot;all goroutines are asleep - deadlock!&quot;", "body": "<p>The call to <code>wg.Wait()</code> wouldn't return until <code>wg.Done()</code> has been called once.</p>\n\n<p>In <code>addStuff()</code>, you're writing values to a channel when there's no other goroutine to drain those values. Since the channel is unbuffered, the first call to <code>channel &lt;- val</code> would block forever, resulting in a deadlock.</p>\n\n<p>Moreover, the channel in <code>addStuff()</code> remains nil since you're creating a new variable binding inside main, instead of assigning to the package-level variable. Writing to a <code>nil</code> channel blocks forever:</p>\n\n<p><code>channel := make(chan int) //doesn't affect the package-level variable</code></p>\n\n<p>Here's a modified example that runs to completion by consuming all values from the channel:</p>\n\n<p><a href=\"https://play.golang.org/p/6gcyDWxov7\" rel=\"nofollow\">https://play.golang.org/p/6gcyDWxov7</a></p>\n"}], "owner": {"reputation": 711, "user_id": 1232726, "user_type": "registered", "accept_rate": 55, "profile_image": "https://i.stack.imgur.com/Bg5nq.jpg?s=128&g=1", "display_name": "filthy_wizard", "link": "https://stackoverflow.com/users/1232726/filthy-wizard"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 316, "favorite_count": 0, "accepted_answer_id": 39576328, "answer_count": 1, "score": 0, "last_activity_date": 1481879537, "creation_date": 1474296712, "last_edit_date": 1481879537, "question_id": 39576130, "link": "https://stackoverflow.com/questions/39576130/using-golang-channels-getting-all-goroutines-are-asleep-deadlock", "title": "using golang channels. GETTING &quot;all goroutines are asleep - deadlock!&quot;", "body": "<p>iam currently playing around with go routines, channels and sync.WaitGroup. I know waitgroup is used to wait for all go routines to complete based on weather wg.Done()  has been called enough times to derement the value set in wg.Add(). \ni wrote a small bit of code to try to test this in golang playground. show below</p>\n\n<pre><code>var channel chan int\nvar wg sync.WaitGroup\n\n\nfunc main() {\n\n  channel := make(chan int)\n  mynums := []int{1,2,3,4,5,6,7,8,9} \n  wg.Add(1)\n\n  go addStuff(mynums)\n  wg.Wait()\n  close(channel)\n  recieveStuff(channel)\n }\n\n func addStuff(mynums []int) {\n\n   for _, val := range mynums {\n       channel &lt;- val\n   }\n   wg.Done()\n }\n\n func recieveStuff(channel chan int) {\n    for val := range channel{\n    fmt.Println(val)\n }\n} \n</code></pre>\n\n<p>Iam getting a deadlock error. iam trying to wait on the routing to return with wg.Wait()? then, close the channel. Afterwards, send the channel to the recievestuff method to output the values in the slice? but it doesnt work. Ive tried moving the close() method inside the go routine after the loop also as i thought i may of been trying to close on the wrong routine in main(). ive found this stuff relatively confusing so far coming from java and c#. Any help is appreciated. </p>\n"}, {"tags": ["regex", "go", "emoji"], "comments": [{"owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1474296827, "post_id": 39575798, "comment_id": 66462047, "body": "What kind of emojis are you looking to support? Do you know the Unicode range? Try <a href=\"https://play.golang.org/p/ty5K2JG4kx\" rel=\"nofollow noreferrer\">this one</a>"}, {"owner": {"reputation": 315, "user_id": 6559250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4ed53de34f736f2196ac1a26c36dc8d?s=128&d=identicon&r=PG", "display_name": "ahmdrz", "link": "https://stackoverflow.com/users/6559250/ahmdrz"}, "reply_to_user": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "edited": false, "score": 1, "creation_date": 1474299200, "post_id": 39575798, "comment_id": 66463577, "body": "@WiktorStribi\u017cew special thx. that was what i want,"}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 4, "last_activity_date": 1474303406, "last_edit_date": 1474303406, "creation_date": 1474301822, "answer_id": 39577651, "question_id": 39575798, "link": "https://stackoverflow.com/questions/39575798/how-to-replace-emoji-characters-in-string-using-regex-in-golang/39577651#39577651", "title": "How to replace emoji characters in string using regex in golang", "body": "<p>You seem to want to match a specific set of emojis. </p>\n\n<p>Use</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"regexp\"\n)\n\nfunc main() {\n    var emojiRx = regexp.MustCompile(`[\\x{1F600}-\\x{1F6FF}|[\\x{2600}-\\x{26FF}]`)\n    var s = emojiRx.ReplaceAllString(\"Thats a nice joke \ud83d\ude06\ud83d\ude06\ud83d\ude06 \ud83d\ude1b\", `[e]`)\n    fmt.Println(s)    \n}\n</code></pre>\n\n<p>See the <a href=\"https://play.golang.org/p/ty5K2JG4kx\" rel=\"nofollow noreferrer\">Go demo</a>.</p>\n\n<p>Note that:</p>\n\n<ul>\n<li><code>[\\x{1F600}-\\x{1F64F}]</code> - matches smilies</li>\n<li><code>[\\x{1F680}-\\x{1F6FF}]</code> - matches transport emojis, etc.</li>\n</ul>\n"}], "owner": {"reputation": 315, "user_id": 6559250, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/f4ed53de34f736f2196ac1a26c36dc8d?s=128&d=identicon&r=PG", "display_name": "ahmdrz", "link": "https://stackoverflow.com/users/6559250/ahmdrz"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3036, "favorite_count": 0, "accepted_answer_id": 39577651, "answer_count": 1, "score": 3, "last_activity_date": 1586245265, "creation_date": 1474295752, "question_id": 39575798, "link": "https://stackoverflow.com/questions/39575798/how-to-replace-emoji-characters-in-string-using-regex-in-golang", "title": "How to replace emoji characters in string using regex in golang", "body": "<p>I want to replace all of emoji s in string by regex in golang.</p>\n\n<p>Like this :</p>\n\n<p>Thats a nice joke \ud83d\ude06\ud83d\ude06\ud83d\ude06 \ud83d\ude1b -> Thats a nice joke [e][e][e] [e]</p>\n"}, {"tags": ["json", "parsing", "go", "nested"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474295886, "post_id": 39575677, "comment_id": 66461418, "body": "Your example code is a reasonable start read arbitrary json. What exactly is the question with what you&#39;ve got?"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1474295976, "post_id": 39575677, "comment_id": 66461465, "body": "You can cut down on the mess from  json2GoStructs by deleting all fields you are not interested in.  The resulting struct definition should be less than 10 lines."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1474295985, "post_id": 39575677, "comment_id": 66461470, "body": "See example how to deal with this in this answer: <a href=\"http://stackoverflow.com/a/28878037/1705598\">Taking a JSON string, unmarshaling it into a map</a>"}, {"owner": {"reputation": 31, "user_id": 6843743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a10a0657632f7601933a02942edf3c?s=128&d=identicon&r=PG&f=1", "display_name": "andi", "link": "https://stackoverflow.com/users/6843743/andi"}, "edited": false, "score": 0, "creation_date": 1474296112, "post_id": 39575677, "comment_id": 66461559, "body": "Hi, I want to end up with a struct like this:  type apiResp struct { \tName string \tGuid string \tErrMsg string }  But I have no idea how to get the value from this json field:  Task -&gt; Property -&gt; Name: Error"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474296440, "post_id": 39575677, "comment_id": 66461801, "body": "You could try <a href=\"https://github.com/nytlabs/gojsonexplode\" rel=\"nofollow noreferrer\">github.com/nytlabs/gojsonexplode</a>"}], "answers": [{"tags": [], "owner": {"reputation": 2375, "user_id": 4383715, "user_type": "registered", "accept_rate": 94, "profile_image": "https://i.stack.imgur.com/xUzxb.png?s=128&g=1", "display_name": "PumpkinSeed", "link": "https://stackoverflow.com/users/4383715/pumpkinseed"}, "is_accepted": true, "score": 5, "last_activity_date": 1474299580, "creation_date": 1474299580, "answer_id": 39577024, "question_id": 39575677, "link": "https://stackoverflow.com/questions/39575677/golang-parse-complex-json/39577024#39577024", "title": "Golang parse complex json", "body": "<p>I can offer you <a href=\"https://github.com/tidwall/gjson\" rel=\"noreferrer\">this easy way</a> to using JSON in Golang. With this tool you don't need to parse the whole json file, and you can use it without struct. </p>\n"}, {"tags": [], "owner": {"reputation": 2246, "user_id": 274937, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d848784d081501a5cba4a2fa7856e965?s=128&d=identicon&r=PG", "display_name": "valyala", "link": "https://stackoverflow.com/users/274937/valyala"}, "is_accepted": false, "score": 1, "last_activity_date": 1527703452, "creation_date": 1527703452, "answer_id": 50610960, "question_id": 39575677, "link": "https://stackoverflow.com/questions/39575677/golang-parse-complex-json/50610960#50610960", "title": "Golang parse complex json", "body": "<p><a href=\"https://github.com/tidwall/gjson\" rel=\"nofollow noreferrer\">Gjson</a> is a great solution for fetching a few fields from JSON string. But it may become slow when many (more than 2) fields must be fetched from distinct parts of the JSON, since it re-parses the JSON on each <code>Get</code> call. Additionally, it requires calling <a href=\"https://godoc.org/github.com/tidwall/gjson#Valid\" rel=\"nofollow noreferrer\">gjson.Valid</a> for validating the incoming JSON, since other methods assume the caller provides valid JSON.</p>\n\n<p>There is an alternative package - <a href=\"https://github.com/valyala/fastjson\" rel=\"nofollow noreferrer\">fastjson</a>. Like <code>gsjon</code>, it is fast and has nice API. Unlike <code>gjson</code> it validates the input JSON and works faster when many unrelated fields must be obtained from the JSON. Here is a sample code for obtaining fields from the original question:</p>\n\n<pre><code>var p fastjson.Parser\nv, err := p.ParseBytes(data)\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Printf(\"Name: %s\", v.GetStringBytes(\"Name\"))\nfmt.Printf(\"Guid: %s\", v.GetStringBytes(\"Guid\"))\nfmt.Printf(\"Error: %s\", v.GetStringBytes(\"Task\", \"Property\", \"Name\"))\n</code></pre>\n"}], "owner": {"reputation": 31, "user_id": 6843743, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/62a10a0657632f7601933a02942edf3c?s=128&d=identicon&r=PG&f=1", "display_name": "andi", "link": "https://stackoverflow.com/users/6843743/andi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2718, "favorite_count": 0, "accepted_answer_id": 39577024, "answer_count": 2, "score": 2, "last_activity_date": 1527703452, "creation_date": 1474295404, "last_edit_date": 1474376257, "question_id": 39575677, "link": "https://stackoverflow.com/questions/39575677/golang-parse-complex-json", "title": "Golang parse complex json", "body": "<p>I am new to golang and json and currently struggle to parse the json out from a system. </p>\n\n<p>I've read a couple of blog posts on dynamic json in go and also tried the tools like <a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow\">json2GoStructs</a>\nParsing my json file with this tools just gave me a huge structs which I found a bit messy. Also I had no idea how to get the info im interested in.</p>\n\n<p>So, here are my <strong>problems</strong>:</p>\n\n<ol>\n<li>How do I get to the info I am interested in?</li>\n<li>What is the best approach to parse complex json?</li>\n</ol>\n\n<p>I am only <strong>interested</strong> into the following 3 json fields:</p>\n\n<pre><code>Name\nGuid\nTask -&gt; Property -&gt; Name: Error\n</code></pre>\n\n<p>I'm thankful for every tip, code snippet or explanation!</p>\n\n<p><strong>This is what I got so far (mostly from a tutorial):</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"io/ioutil\"\n)\n\nfunc checkErr(err error) {\n    if err != nil {\n        panic(err)\n    }\n}\n\nfunc readFile(filePath string) []byte {\n    data, err := ioutil.ReadFile(filePath)\n    checkErr(err)\n    return data\n}\n\nfunc main() {\n    path := \"/Users/andi/Documents/tmp/wfsJob.json\"\n    data := readFile(path)\n\n    var f interface{}\n\n    err := json.Unmarshal(data, &amp;f)\n    checkErr(err)\n\n    m := f.(map[string]interface{})\n\n    for k, v := range m {\n        switch vv := v.(type) {\n        case string:\n            fmt.Println(k, \"is string\", vv)\n        case int:\n            fmt.Println(k, \"is int\", vv)\n        case []interface{}:\n            fmt.Println(k, \"is an array:\")\n            for i, u := range vv {\n                fmt.Println(i, u)\n            }\n        default:\n            fmt.Println(k, \"is of a type I don't know how to handle\")\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "tcp", "chat"], "comments": [{"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 2, "creation_date": 1474294412, "post_id": 39575223, "comment_id": 66460452, "body": "You get an error when connecting the third client? What is that error?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 3, "creation_date": 1474294785, "post_id": 39575223, "comment_id": 66460718, "body": "You can&#39;t use a map concurrently. Check your code with the race detector."}, {"owner": {"reputation": 587, "user_id": 2976657, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3451ecaa5f55b0cb3debc4251cad0f0e?s=128&d=identicon&r=PG&f=1", "display_name": "shubham003", "link": "https://stackoverflow.com/users/2976657/shubham003"}, "reply_to_user": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 0, "creation_date": 1474300726, "post_id": 39575223, "comment_id": 66464511, "body": "@AJPennster I am getting  GetFileAttributesEx client.go: The system cannot find the file specified. Error on the client side on the server side I am not seeing anything. I am running on windows."}, {"owner": {"reputation": 1275, "user_id": 3044418, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af7f92727ba68dfe3edd434be8ecb309?s=128&d=identicon&r=PG&f=1", "display_name": "Anfernee", "link": "https://stackoverflow.com/users/3044418/anfernee"}, "edited": false, "score": 2, "creation_date": 1474303019, "post_id": 39575223, "comment_id": 66465899, "body": "You should add the full error to your question, along with the code for the client.  If it panics, add the traceback as well."}, {"owner": {"reputation": 1126, "user_id": 4595674, "user_type": "registered", "accept_rate": 80, "profile_image": "https://lh5.googleusercontent.com/-sZKhhu4m_Eo/AAAAAAAAAAI/AAAAAAAAAN0/wjo2wquXsXU/photo.jpg?sz=128", "display_name": "Albi", "link": "https://stackoverflow.com/users/4595674/albi"}, "edited": false, "score": 0, "creation_date": 1552077621, "post_id": 39575223, "comment_id": 96888955, "body": "@shubham003 What is the max no of TCP client you are able to get?"}, {"owner": {"reputation": 288867, "user_id": 207421, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/5cfe5f7d64f44be04f147295f5c7b88e?s=128&d=identicon&r=PG", "display_name": "user207421", "link": "https://stackoverflow.com/users/207421/user207421"}, "edited": false, "score": 0, "creation_date": 1566255990, "post_id": 39575223, "comment_id": 101591336, "body": "Your problem is in the client but you&#39;ve only posted server code? Your problem is with a file but you are blaming TCP connections?"}], "answers": [{"comments": [{"owner": {"reputation": 587, "user_id": 2976657, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3451ecaa5f55b0cb3debc4251cad0f0e?s=128&d=identicon&r=PG&f=1", "display_name": "shubham003", "link": "https://stackoverflow.com/users/2976657/shubham003"}, "edited": false, "score": 0, "creation_date": 1474606463, "post_id": 39651201, "comment_id": 66608570, "body": "So can it be OS specific issue. I&#39;ll try on Linux. Thanks"}], "tags": [], "owner": {"reputation": 404, "user_id": 6692196, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vV1ew.png?s=128&g=1", "display_name": "Gene S", "link": "https://stackoverflow.com/users/6692196/gene-s"}, "is_accepted": false, "score": 0, "last_activity_date": 1474594143, "creation_date": 1474594143, "answer_id": 39651201, "question_id": 39575223, "link": "https://stackoverflow.com/questions/39575223/multiple-connections-to-a-tcp-server/39651201#39651201", "title": "Multiple connections to a TCP server", "body": "<p>Your code is fine. I compiled in on Linux, tried with 4 connections. Everything worked as expected.</p>\n"}], "owner": {"reputation": 587, "user_id": 2976657, "user_type": "registered", "accept_rate": 42, "profile_image": "https://www.gravatar.com/avatar/3451ecaa5f55b0cb3debc4251cad0f0e?s=128&d=identicon&r=PG&f=1", "display_name": "shubham003", "link": "https://stackoverflow.com/users/2976657/shubham003"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 9226, "favorite_count": 5, "answer_count": 1, "score": 5, "last_activity_date": 1610744785, "creation_date": 1474294055, "last_edit_date": 1566241996, "question_id": 39575223, "link": "https://stackoverflow.com/questions/39575223/multiple-connections-to-a-tcp-server", "title": "Multiple connections to a TCP server", "body": "<p>I've developed a small Go TCP server to make a chat application. But when I try to connect clients to it, the server works fine with two clients, but whenever I tried to connect the third client it is not connected to the server. I am running on Windows. What could be the issue?</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"net\"\n)\n\nvar allClients map[*Client]int\n\ntype Client struct {\n    // incoming chan string\n    outgoing   chan string\n    reader     *bufio.Reader\n    writer     *bufio.Writer\n    conn       net.Conn\n    connection *Client\n}\n\nfunc (client *Client) Read() {\n    for {\n        line, err := client.reader.ReadString('\\n')\n        if err == nil {\n            if client.connection != nil {\n                client.connection.outgoing &lt;- line\n            }\n            fmt.Println(line)\n        } else {\n            break\n        }\n\n    }\n\n    client.conn.Close()\n    delete(allClients, client)\n    if client.connection != nil {\n        client.connection.connection = nil\n    }\n    client = nil\n}\n\nfunc (client *Client) Write() {\n    for data := range client.outgoing {\n        client.writer.WriteString(data)\n        client.writer.Flush()\n    }\n}\n\nfunc (client *Client) Listen() {\n    go client.Read()\n    go client.Write()\n}\n\nfunc NewClient(connection net.Conn) *Client {\n    writer := bufio.NewWriter(connection)\n    reader := bufio.NewReader(connection)\n\n    client := &amp;Client{\n        // incoming: make(chan string),\n        outgoing: make(chan string),\n        conn:     connection,\n        reader:   reader,\n        writer:   writer,\n    }\n    client.Listen()\n\n    return client\n}\n\nfunc main() {\n    allClients = make(map[*Client]int)\n    listener, _ := net.Listen(\"tcp\", \":8080\")\n    for {\n        conn, err := listener.Accept()\n        if err != nil {\n            fmt.Println(err.Error())\n        }\n        client := NewClient(conn)\n        for clientList, _ := range allClients {\n            if clientList.connection == nil {\n                client.connection = clientList\n                clientList.connection = client\n                fmt.Println(\"Connected\")\n            }\n        }\n        allClients[client] = 1\n        fmt.Println(len(allClients))\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "deadlock", "channel", "goroutine", "blockchain"], "comments": [{"owner": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 1, "creation_date": 1474288449, "post_id": 39573137, "comment_id": 66456238, "body": "It would help if you could isolate the issue and create a reproducible snippet (even better would be a test) without connecting to various resources(i.e. database).  It&#39;s also not clear to me what the issue is. Do you run into a specific error (i.e. deadlock) ? If so can you post the error?"}, {"owner": {"reputation": 1, "user_id": 4269793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a8561c82c5900318e6b18f0b24fea5?s=128&d=identicon&r=PG", "display_name": "Jacob Gadikian", "link": "https://stackoverflow.com/users/4269793/jacob-gadikian"}, "reply_to_user": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1474288759, "post_id": 39573137, "comment_id": 66456450, "body": "Hm.  So, no I do not-- I did not know that deadlock returns an error.  And, you got it, let me hammer at that code block some to isolate the screwiness.  Thanks!"}, {"owner": {"reputation": 1, "user_id": 4269793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a8561c82c5900318e6b18f0b24fea5?s=128&d=identicon&r=PG", "display_name": "Jacob Gadikian", "link": "https://stackoverflow.com/users/4269793/jacob-gadikian"}, "reply_to_user": {"reputation": 6519, "user_id": 613453, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/0c744d4e2bee639d69f3e78f7daeba6d?s=128&d=identicon&r=PG", "display_name": "themihai", "link": "https://stackoverflow.com/users/613453/themihai"}, "edited": false, "score": 0, "creation_date": 1474289045, "post_id": 39573137, "comment_id": 66456658, "body": "In 5 minutes or so I&#39;ll post a &quot;cut to the bone (no blockaw) version of the same code.  Thanks."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474289069, "post_id": 39573137, "comment_id": 66456673, "body": "If you program is blocked, set <code>GOTRACEBACK=all</code> and get a stack trace to see where everything is blocked. You also have goroutines dispatching more goroutines for no discernible reason, so I can be sure what your concurrency plan is here."}, {"owner": {"reputation": 1, "user_id": 4269793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a8561c82c5900318e6b18f0b24fea5?s=128&d=identicon&r=PG", "display_name": "Jacob Gadikian", "link": "https://stackoverflow.com/users/4269793/jacob-gadikian"}, "edited": false, "score": 0, "creation_date": 1474289581, "post_id": 39573137, "comment_id": 66457023, "body": "Better to put them both in the iterator, then?"}, {"owner": {"reputation": 1, "user_id": 4269793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a8561c82c5900318e6b18f0b24fea5?s=128&d=identicon&r=PG", "display_name": "Jacob Gadikian", "link": "https://stackoverflow.com/users/4269793/jacob-gadikian"}, "edited": false, "score": 0, "creation_date": 1474289732, "post_id": 39573137, "comment_id": 66457146, "body": "Let me describe what I think should be happening, but really don&#39;t know if is happening:  getblock (this is the performance-limiter-- the blockchain that this connects to reads at about 400 blocks per second, meaning that its ~5m blocks takes about 24 hours with all things left to themselves) should now be able to run more quickly because it&#39;s running in paralell, and each time it gets a block, it will feed it to writeblock (writes to rethinkdb)"}, {"owner": {"reputation": 1, "user_id": 4269793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a8561c82c5900318e6b18f0b24fea5?s=128&d=identicon&r=PG", "display_name": "Jacob Gadikian", "link": "https://stackoverflow.com/users/4269793/jacob-gadikian"}, "edited": false, "score": 0, "creation_date": 1474289856, "post_id": 39573137, "comment_id": 66457237, "body": "And by verbailzing it, something does sound wrong."}], "answers": [{"tags": [], "owner": {"reputation": 1, "user_id": 4269793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a8561c82c5900318e6b18f0b24fea5?s=128&d=identicon&r=PG", "display_name": "Jacob Gadikian", "link": "https://stackoverflow.com/users/4269793/jacob-gadikian"}, "is_accepted": false, "score": 0, "last_activity_date": 1474291538, "creation_date": 1474291538, "answer_id": 39574367, "question_id": 39573137, "link": "https://stackoverflow.com/questions/39573137/goroutine-deadlock-in-an-app-that-reads-from-a-blockchain-and-writes-to-rethink/39574367#39574367", "title": "goroutine deadlock: In an app that reads from a blockchain and writes to rethinkdb, have", "body": "<p>Okay, so that is now resolved, but this is going to spawn another question, unfortunatley.  </p>\n\n<p>I've got the application working with the goroutine, however it hasn't increased performance any.  </p>\n\n<p>The way that I got it to work was by not spawning a goroutine from a goroutine and instead calling a plain function, writeBlock from the goroutine \"getblock\":</p>\n\n<pre><code>    fmt.Println(\"---&gt; Entering the block processing loop\")\n    for {\n        // Get current properties.\n        props, err := Client.Database.GetDynamicGlobalProperties()\n        if err != nil {\n            fmt.Println(err)\n        }\n\n        // Process blocks.\n        for I := uint32(1); I &lt;= props.LastIrreversibleBlockNum; I++ {\n            go getblock(I, Client, Rsession)\n        }\n        if err != nil {\n            fmt.Println(err)\n        }\n\n    }\n\n}\n\nfunc getblock(I uint32, Client *rpc.Client, Rsession *r.Session) {\n    block, err := Client.Database.GetBlock(I)\n    fmt.Println(I)\n    writeBlock(block, Rsession)\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n\nfunc writeBlock(block *d.Block, Rsession *r.Session) {\n    //rethinkdb writes\n    r.Table(\"transactions\").\n        Insert(block.Transactions).\n        Exec(Rsession)\n    r.Table(\"blocks\").\n        Insert(block).\n        Exec(Rsession)\n}\n</code></pre>\n"}], "owner": {"reputation": 1, "user_id": 4269793, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a3a8561c82c5900318e6b18f0b24fea5?s=128&d=identicon&r=PG", "display_name": "Jacob Gadikian", "link": "https://stackoverflow.com/users/4269793/jacob-gadikian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1474291538, "creation_date": 1474287956, "last_edit_date": 1474290350, "question_id": 39573137, "link": "https://stackoverflow.com/questions/39573137/goroutine-deadlock-in-an-app-that-reads-from-a-blockchain-and-writes-to-rethink", "title": "goroutine deadlock: In an app that reads from a blockchain and writes to rethinkdb, have", "body": "<p><strong>Okay, so</strong></p>\n\n<p>My situation is this:  It's been three weeks and some-odd hours since I've become entranced by golang.  I'm working on a blockchain dump tool for steem, and I'm probably going to give a touch of gjson to github.com/go-steem/rpc, the library I currently rely on.  Now, with this said, this question is about the goroutines for my current blockchain reader.  Here it is (sorry a tad on the beefy side, but you'll see the part that I want to pull back into the library, too):</p>\n\n<pre><code>    // Keep processing incoming blocks forever.\n    fmt.Println(\"---&gt; Entering the block processing loop\")\n    for {\n        // Get current properties.\n        props, err := Client.Database.GetDynamicGlobalProperties()\n        if err != nil {\n            fmt.Println(err)\n        }\n\n        // Process blocks.\n        for I := uint32(1); I &lt;= props.LastIrreversibleBlockNum; I++ {\n            go getblock(I, Client, Rsession)\n        }\n        if err != nil {\n            fmt.Println(err)\n        }\n\n    }\n\n}\n\nfunc getblock(I uint32, Client *rpc.Client, Rsession *r.Session) {\n    block, err := Client.Database.GetBlock(I)\n    fmt.Println(I)\n    writeBlock(block, Rsession)\n    if err != nil {\n        fmt.Println(err)\n    }\n}\n\nfunc writeBlock(block *d.Block, Rsession *r.Session) {\n    //rethinkdb writes\n    r.Table(\"transactions\").\n        Insert(block.Transactions).\n        Exec(Rsession)\n    r.Table(\"blocks\").\n        Insert(block).\n        Exec(Rsession)\n}\n</code></pre>\n\n<p>I just made a third edit to this, which was to call the function writeBlock from goroutine getBlock instead of the way I was doing things before.  I'</p>\n"}, {"tags": ["recursion", "go", "concurrency", "deadlock"], "comments": [{"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1474287640, "post_id": 39572848, "comment_id": 66455692, "body": "The way you wait for go-routines to finish in <code>concurrentSearch</code> seems a bit strange (using <code>done</code> channel), usually this is done using <code>WaitGroup</code>."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474289284, "post_id": 39572848, "comment_id": 66456830, "body": "Use a <code>WaitGroup</code>. You have paths in your function that can return without sending a value on the channel, so it&#39;s possible to have fewer results than inputs."}, {"owner": {"reputation": 43, "user_id": 4940673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwvRj.png?s=128&g=1", "display_name": "JackMordaunt", "link": "https://stackoverflow.com/users/4940673/jackmordaunt"}, "reply_to_user": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1474292140, "post_id": 39572848, "comment_id": 66458841, "body": "Thanks for your comments @ain and @JimB. Updated to use a <code>WaitGroup</code>, which was exactly the construct I needed for waiting on go-routines, however the problem remains. I believe the logic in <code>concurrentSearch</code> is flawed, any suggestions on how to restructure my code so that I can guarantee the chan gets the proper inputs vs outputs. Thanks a lot :)"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474294300, "post_id": 39572848, "comment_id": 66460357, "body": "You only added a WaitGroup around the recursive call of concurrentSearch. You&#39;re still waiting for the same number of outputs as goroutines in the Test function."}, {"owner": {"reputation": 7358, "user_id": 4551301, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/d1kFH.jpg?s=128&g=1", "display_name": "Kaedys", "link": "https://stackoverflow.com/users/4551301/kaedys"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474316858, "post_id": 39572848, "comment_id": 66473101, "body": "You don&#39;t need to do a select with only a single case, just read off the channel normally.  Still, your logic seems sound.  @JimB, he&#39;s only waiting for the number of initial calls to concurrentSearch, which is the number of keys being searched for.  The test will hang indefinitely if a key can&#39;t be found, of course, because there&#39;s no provision for a &quot;not found&quot; case, but he&#39;s not waiting on the full list of goroutines in his test.  He&#39;s not even waiting for the first one to return (which he could do with a buffered channel and a non-<code>go</code> call), he&#39;s just waiting for a result for each test."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474318281, "post_id": 39572848, "comment_id": 66473716, "body": "Just saying that the code should be structured correctly first (I&#39;d write an answer if I saw the actual problem while skimming the code ;) ). Once the obvious bugs are eliminated, look at a stack trace to see where each goroutine is blocked."}], "owner": {"reputation": 43, "user_id": 4940673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/AwvRj.png?s=128&g=1", "display_name": "JackMordaunt", "link": "https://stackoverflow.com/users/4940673/jackmordaunt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 157, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474292655, "creation_date": 1474287010, "last_edit_date": 1474292655, "question_id": 39572848, "link": "https://stackoverflow.com/questions/39572848/deadlock-with-recursive-concurrent-code-using-go-routines", "title": "Deadlock with recursive, concurrent code using go-routines", "body": "<p>I'm trying to implement a generic search algorithm that will traverse any arbitrary tree-like data structure concurrently (spinning up a go routine for each level of the tree).</p>\n\n<p>The issue I have is when search fails (it completes walking the entire tree and finds no match) I end up with a deadlock and I don't understand why.</p>\n\n<p>The code works when correctly when search succeeds.</p>\n\n<p>I added the helper functions for your context, however my issue is with the way I'm using go-routines and channels which is all in the concurrentSearch() function.</p>\n\n<p>I apoligize in advance if you find the code messy. I've been going back and forth all day trying out different ideas.</p>\n\n<p>Thanks for any feedback!</p>\n\n<p>Here's my code:</p>\n\n<pre><code>package search\n\nimport \"reflect\"\n\n// Search an arbitrary tree / map like data structure.\nfunc concurrentSearch(output chan interface{}, data interface{}, key string) {\n    // search() is your search algorithm.\n    result := search(data, key)\n    if result != nil {\n        // Found something, so put it on the chan.\n        // This is the point of the function.\n        output &lt;- result\n        return // Success.\n    }\n\n    // Since we didn't find a match we will get a slice of the next level of values.\n    iterableType := listValues(data)\n    if len(iterableType) == 0 {\n        return\n    }\n\n    var wg sync.WaitGroup\n    for _, value := range iterableType {\n        wg.Add(1)\n\n        go func(next interface{}) {\n            defer wg.Done()\n            concurrentSearch(output, next, key)\n        }(value)\n\n    }\n    wg.Wait()\n    // Wait never finishes, so the function never returns\n} \n\n// Returns a slice of values based on Type.\nfunc listValues(data interface{}) []interface{} {\n    value := reflect.ValueOf(data)\n    values := []interface{}{}\n\n    switch value.Kind() {\n    case reflect.Map:\n        for _, key := range value.MapKeys() {\n            values = append(values, value.MapIndex(key).Interface())\n        }\n\n    case reflect.Slice:\n        for ii := 0; ii &lt; value.Len(); ii++ {\n            values = append(values, value.Index(ii).Interface())\n        }\n\n    case reflect.Struct:\n        for ii := 0; ii &lt; value.NumField(); ii++ {\n            if value.Field(ii).CanSet() {\n                values = append(values, value.Field(ii).Interface())\n            }\n        }\n\n    case reflect.Ptr:\n        rawValue := value.Elem()\n        if !rawValue.IsValid() {\n            return nil\n        }\n        values = listValues(rawValue)\n\n    case reflect.Interface:\n        rawValue := value.Elem()\n        values = listValues(rawValue)\n    }\n\n    return values\n}\n\n// search just checks the value for an index of key, otherwise returns nil.\nfunc search(data interface{}, key string) interface{} {\n    value := reflect.ValueOf(data)\n    switch value.Kind() {\n\n    // If the type is indexable, check the index.\n    // Default to returning nil\n    case reflect.Struct:\n        for ii := 0; ii &lt; value.NumField(); ii++ {\n            field := value.Field(ii)\n            // Without CanSet() reflect panics about Unexported fields.\n            if field.CanSet() {\n                if field.Type().Name() == key {\n                    return field.Elem().Interface()\n                }\n            }\n        }\n        return nil\n\n    case reflect.Map:\n        for _, mapkey := range value.MapKeys() {\n            if key == mapkey.String() {\n                return value.MapIndex(mapkey).Elem().Interface()\n            }\n        }\n        return nil\n\n    case reflect.Slice:\n        return nil\n\n        // For pointer types we just unwrap and call again.\n    case reflect.Ptr:\n        rawValue := value.Elem()\n        if !rawValue.IsValid() {\n            return nil\n        }\n        return search(rawValue, key)\n\n    case reflect.Interface:\n        rawValue := value.Elem()\n        return search(rawValue, key)\n\n    case reflect.String:\n        return nil\n\n    default:\n        return nil\n    }\n\n}\n</code></pre>\n\n<p>Here's my test code, unfortunately I can't share the test data. It's just a bunch of nested json objects.</p>\n\n<pre><code>package state\n\nimport (\n    \"encoding/json\"\n    \"io/ioutil\"\n    \"reflect\"\n    \"testing\"\n)\n\nconst (\n    dataPath = \"path/to/your/data.json\"\n)\n\nvar tests = []struct {\n    Input  string\n    Result interface{}\n}{\n    // your test fixtures here for table driven tests.\n}\n\ntype mydata struct {\n    One   map[string]interface{} `json:\"1\"`\n    Two   map[string]interface{} `json:\"2\"`\n    Three map[string]interface{} `json:\"3\"`\n}\n\nfunc TestConcurrentSearch(t *testing.T) {\n    data := &amp;mydata{\n        map[string]interface{}{},\n        map[string]interface{}{},\n        map[string]interface{}{},\n    }\n    bytes, err := ioutil.ReadFile(dataPath)\n    if err != nil {\n        t.Errorf(\"ioutil: problem loading test data, %v\", err)\n    }\n    jerr := json.Unmarshal(bytes, data)\n    if jerr != nil {\n        t.Errorf(\"json: problem unmarshalling test data, %s\", jerr)\n    }\n\n    // Setup finished\n\n    output := make(chan interface{})\n    for _, fixture := range tests {\n        go concurrentSearch(output, data, fixture.Input)\n        select {\n        case result := &lt;-output:\n            if !reflect.DeepEqual(fixture.Result, result) {\n                t.Errorf(\"Expected: %v, Actual %v\", fixture.Result, result)\n            }\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1474286798, "post_id": 39572469, "comment_id": 66455122, "body": "Related / possible duplicate of <a href=\"http://stackoverflow.com/questions/38390999/go-sql-prepared-statement-scope\">Go sql - prepared statement scope</a>."}, {"owner": {"reputation": 3244, "user_id": 687438, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/5cabf9d1f557d1ebb90dbe683981aca6?s=128&d=identicon&r=PG", "display_name": "Martin Gallagher", "link": "https://stackoverflow.com/users/687438/martin-gallagher"}, "edited": false, "score": 0, "creation_date": 1474289188, "post_id": 39572469, "comment_id": 66456769, "body": "<code>INSERT ... RETURNING ...</code> is supported if you use <code>tx.QueryRow()</code>"}], "answers": [{"tags": [], "owner": {"reputation": 662, "user_id": 5008952, "user_type": "registered", "accept_rate": 42, "profile_image": "https://graph.facebook.com/10152729711426706/picture?type=large", "display_name": "Nathan Hyland", "link": "https://stackoverflow.com/users/5008952/nathan-hyland"}, "is_accepted": true, "score": 1, "last_activity_date": 1474931935, "last_edit_date": 1474931935, "creation_date": 1474931472, "answer_id": 39713743, "question_id": 39572469, "link": "https://stackoverflow.com/questions/39572469/should-i-use-sql-stmt-or-string-in-database-query-in-go/39713743#39713743", "title": "Should I use Sql.Stmt or string in database query in GO?", "body": "<p>Using the Stmt helps you avoid sql injection from the user. </p>\n\n<p>From <a href=\"https://en.wikipedia.org/wiki/Prepared_statement\" rel=\"nofollow\">wikipedia</a>:</p>\n\n<blockquote>\n  <p>Prepared statements are resilient against SQL injection, because\n  parameter values, which are transmitted later using a different\n  protocol, need not be correctly escaped. If the original statement\n  template is not derived from external input, SQL injection cannot\n  occur.</p>\n</blockquote>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 66, "favorite_count": 0, "accepted_answer_id": 39713743, "answer_count": 1, "score": 0, "last_activity_date": 1474931935, "creation_date": 1474285764, "question_id": 39572469, "link": "https://stackoverflow.com/questions/39572469/should-i-use-sql-stmt-or-string-in-database-query-in-go", "title": "Should I use Sql.Stmt or string in database query in GO?", "body": "<p>Hi in database/sql package I can execute a query in two ways:</p>\n\n<ul>\n<li><p>First way: using Sql.Stmt</p>\n\n<pre><code>var DeletePermissionStmt *sql.Stmt\nDeletePermissionStmt, err = database.Prepare(`DELETE FROM permission WHERE permission_id=$1`)\n\nif err != nil {\n     log.Errorf(\"can't prepare delete permission statement: %s\", err.Error())\n}\n\ntransaction, err := database.Begin()  // assume postgres database is defined previously\n\nif err != nil {\n     log.WithFields(logFields).Errorf(\"can't start transaction: %s\", err.Error())\n\n\nreturn err\n}\n _, err := transaction.Stmt(DeletePermissionStmt).Exec(permission_id)\n</code></pre></li>\n<li><p>Second way: using string</p>\n\n<pre><code>var DeletePermissionStmt string\nDeletePermissionStmt = `DELETE FROM permission WHERE permission_id=$1`\n\ntransaction, err := database.Begin()  // assume postgres database is defined previously\n\nif err != nil {\nlog.WithFields(logFields).Errorf(\"can't start transaction: %s\", err.Error())\n\n\nreturn err\n}\n _, err := transaction.Exec(DeletePermissionStmt,permission_id)\n</code></pre></li>\n</ul>\n\n<p>The only difference That I know that its is not possible to use sql.Stmt when you are returning something for example <code>Insert Into FOO(f1,f2,f3) Values(v1,v2,v3) returning f_id</code>\nIs there any other differences? and when should I use each one?</p>\n"}, {"tags": ["go", "windows-services"], "comments": [{"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1474295469, "post_id": 39571285, "comment_id": 66461157, "body": "So, what happens if you use the benchmarking code from the <code>testing</code> standard package in your <code>Mul()</code> function and run your code there under benchmarking say 1000 times in a row (to get consistent weighted median result)?"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1474295521, "post_id": 39571285, "comment_id": 66461196, "body": "I mean, your approach to measuring is so low-tech you appear to rather measure the fluctuations of the world&#39;s Ether rather than your code."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1474295566, "post_id": 39571285, "comment_id": 66461228, "body": "You could start <a href=\"http://dave.cheney.net/2013/06/30/how-to-write-benchmarks-in-go\" rel=\"nofollow noreferrer\">here</a>. Keep in mind, that to make <code>testing</code> package work in &quot;normal&quot; code (that is, code which is run by means other than executing <code>go test</code>) you need to explicitly call out to that package: see the documentation on the <code>testing.M</code> type and its methods and accompanying functions."}, {"owner": {"reputation": 1, "user_id": 4422939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_sjaogehSdY/AAAAAAAAAAI/AAAAAAAAAhk/VyAmLvXKYkI/photo.jpg?sz=128", "display_name": "Bhuvana chinnadurai", "link": "https://stackoverflow.com/users/4422939/bhuvana-chinnadurai"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1474303491, "post_id": 39571285, "comment_id": 66466169, "body": "I will use the testing package to  benchmark the above function.Once it is done ,I will update the results.Thank you for the suggestion!"}, {"owner": {"reputation": 1, "user_id": 4422939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_sjaogehSdY/AAAAAAAAAAI/AAAAAAAAAhk/VyAmLvXKYkI/photo.jpg?sz=128", "display_name": "Bhuvana chinnadurai", "link": "https://stackoverflow.com/users/4422939/bhuvana-chinnadurai"}, "reply_to_user": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 0, "creation_date": 1474356544, "post_id": 39571285, "comment_id": 66485533, "body": "As you said ,I tried benchmarking as given below for Mul function as a normal function and as service ."}], "owner": {"reputation": 1, "user_id": 4422939, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-_sjaogehSdY/AAAAAAAAAAI/AAAAAAAAAhk/VyAmLvXKYkI/photo.jpg?sz=128", "display_name": "Bhuvana chinnadurai", "link": "https://stackoverflow.com/users/4422939/bhuvana-chinnadurai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 132, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474356875, "creation_date": 1474282025, "last_edit_date": 1474356875, "question_id": 39571285, "link": "https://stackoverflow.com/questions/39571285/windows-service-in-golang-takes-much-time-than-normal-exe", "title": "windows Service in Golang takes much time than normal exe", "body": "<p>I have a below code which performs multiplication .I have calculated the time it takes to do the same and logged it into a file .Time is always 3.0002ms on average .</p>\n\n<pre><code>func Mul() {\n\nt := time.Now()\nfor i := 0; i &lt; 10; i++ {\n\n    c := i * 2\n    fmt.Println(c)\n\n}\n\nl, err := logutil.GetLogger(\"replicateIT.main\")\nif err != nil {\n    log.Println(\"Error in getting current method\" + err.Error())\n\n}\n\nsub := time.Since(t)\nfmt.Println(\"The time difference\", sub.String())\nl.Log(logutil.INFO, \"time difference \"+sub.String())\n</code></pre>\n\n<p>}</p>\n\n<p>Then I have included the function call  in execute method of svc package to run this as service ,as given below .The time difference now is 294.0168ms .</p>\n\n<p>Why is it taking time this much ? Am i doing anything wrong in implementing service ?</p>\n\n<p>Please give some suggestions !</p>\n\n<pre><code>  func (m *myservice) Execute(args []string, r &lt;-chan svc.ChangeRequest,   changes chan&lt;- svc.Status) (ssec bool, errno uint32) {\nconst cmdsAccepted = svc.AcceptStop | svc.AcceptShutdown | svc.AcceptPauseAndContinue\nchanges &lt;- svc.Status{State: svc.StartPending}\nfasttick := time.Tick(500 * time.Minute)\nslowtick := time.Tick(10 * time.Minute)\ntick := fasttick\n\ngo Mul()\n\n//creates log instance\nl, err := logutil.GetLogger(\"replicateIT.main\")\nif err != nil {\n    log.Println(\"Error in getting current method\" + err.Error())\n\n}\nl.Log(logutil.INFO, \"-----------------STARTED OUR APP------------------------\")\n\nchanges &lt;- svc.Status{State: svc.Running, Accepts: cmdsAccepted}\n loop:\n   for {\n\n    select {\n    case &lt;-tick:\n    case c := &lt;-r:\n        switch c.Cmd {\n        case svc.Interrogate:\n            changes &lt;- c.CurrentStatus\n            // Testing deadlock from https://code.google.com/p/winsvc/issues/detail?id=4\n            //time.Sleep(100 * time.Millisecond)\n            //changes &lt;- c.CurrentStatus\n        case svc.Stop, svc.Shutdown:\n            break loop\n        case svc.Pause:\n            changes &lt;- svc.Status{State: svc.Paused, Accepts: cmdsAccepted}\n            tick = slowtick\n        case svc.Continue:\n            changes &lt;- svc.Status{State: svc.Running, Accepts: cmdsAccepted}\n            tick = fasttick\n        default:\n            elog.Error(1, fmt.Sprintf(\"unexpected control request #%d\", c))\n        }\n    }\n}\n\nchanges &lt;- svc.Status{State: svc.Running}\n\nreturn\n }\n</code></pre>\n\n<p>Benchmark has been added for Mul Function and the startService function which invokes Mul .</p>\n\n<pre><code>package testing\n\n// from fib_test.go \n import (\n \"strconv\"\n\n \"fmt\"\n \"service\"\n \"testing\"\n \"example\")\n\n func BenchmarkMul10(b *testing.B) {\n  // run the Fib function b.N times\n    for n := 0; n &lt; b.N; n++ {\n      example.Mul()\n     }\n}\n var i int\n\nfunc BenchmarkStartSer(b *testing.B) {\n   fmt.Println(\"START SERVICE\")\n    // run the Fib function b.N times\n\n   for n := 0; n &lt;b.N; n++ {\n        i++\n     err:=service.InstallService(\"PTS-EBDR-MULT\"+strconv.Itoa(i),\"PTS-EBDR-MULT\"+strconv.Itoa(i))\n    if err!=nil{\n        fmt.Println(err.Error())\n        break\n\n    }\n\n}\n</code></pre>\n\n<p>}</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 164108, "user_id": 714501, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2090a0ffd27b055c8fa22a8e59476d0?s=128&d=identicon&r=PG", "display_name": "cnicutar", "link": "https://stackoverflow.com/users/714501/cnicutar"}, "edited": false, "score": 0, "creation_date": 1474285583, "post_id": 39567531, "comment_id": 66454333, "body": "What&#39;s wrong with <code>if _, err := transaction.Stmt...; err != nil {...</code>"}], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 0, "last_activity_date": 1474286799, "creation_date": 1474286799, "answer_id": 39572782, "question_id": 39567531, "link": "https://stackoverflow.com/questions/39567531/can-i-log-the-final-query-when-using-transaction-stmtsqlstatement-execparamet/39572782#39572782", "title": "Can I log the final query when using transaction.Stmt(sqlstatement).Exec(parameter) in GO?", "body": "<p>Transaction uses standard SQL i.e. <code>BEGIN / START TRANSACTION, COMMIT, ROLLBACK</code>. However, prepared statements are specific to database server, e.g.</p>\n\n<ul>\n<li>MySQL, <a href=\"http://dev.mysql.com/doc/refman/5.7/en/sql-syntax-prepared-statements.html\" rel=\"nofollow\">http://dev.mysql.com/doc/refman/5.7/en/sql-syntax-prepared-statements.html</a></li>\n<li>PostgreSQL, <a href=\"https://www.postgresql.org/docs/9.3/static/sql-prepare.html\" rel=\"nofollow\">https://www.postgresql.org/docs/9.3/static/sql-prepare.html</a></li>\n</ul>\n\n<p>Taking log of exact query with <code>database/sql</code> will be difficult (or impossible). Query logging depends on implementation of the driver, for example <a href=\"https://github.com/jackc/pgx\" rel=\"nofollow\">https://github.com/jackc/pgx</a> supports logging, but <a href=\"https://github.com/lib/pq\" rel=\"nofollow\">https://github.com/lib/pq</a> doesn't support. </p>\n"}], "owner": {"reputation": 1308, "user_id": 5089153, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/cf636637f2f2f80acaa49e04082922cd?s=128&d=identicon&r=PG&f=1", "display_name": "Said  Saifi", "link": "https://stackoverflow.com/users/5089153/said-saifi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 39572782, "answer_count": 1, "score": 0, "last_activity_date": 1474286799, "creation_date": 1474269934, "question_id": 39567531, "link": "https://stackoverflow.com/questions/39567531/can-i-log-the-final-query-when-using-transaction-stmtsqlstatement-execparamet", "title": "Can I log the final query when using transaction.Stmt(sqlstatement).Exec(parameter) in GO?", "body": "<p>Hi I am using database/sql package, and for example I have this:</p>\n\n<pre><code>var DeletePermissionStmt *sql.Stmt\nDeletePermissionStmt, err = database.Prepare(`DELETE FROM permission WHERE permission_id=$1`)\nif err != nil {\n    log.Errorf(\"can't prepare delete permission statement: %s\", err.Error())\n}\ntransaction, err := database.Begin()  // assume postgres database is defined previously\nif err != nil {\n    log.WithFields(logFields).Errorf(\"can't start transaction: %s\", err.Error())\n\n\n    return err\n}\n_, err := transaction.Stmt(DeletePermissionStmt).Exec(permission_id)\n</code></pre>\n\n<p>I am succeeding in doing what I want to do except that I want to log the exact query that is used and that if I run it in postgres I will have the same result\nIs there anyway to do it?</p>\n"}, {"tags": ["go", "readfile"], "answers": [{"comments": [{"owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "edited": false, "score": 0, "creation_date": 1474272054, "post_id": 39567702, "comment_id": 66446246, "body": "There is no trailing <code>\\n</code> at the end of the file. Your solution with <code>bufio.Scanner</code> works fine indeed, but I just wondered if there were a option to prevent ioutil.ReadFile from adding a empty slice when it sees EOF. If there is none, I&#39;ll use bufio. Thanks."}, {"owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "reply_to_user": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "edited": false, "score": 0, "creation_date": 1474284562, "post_id": 39567702, "comment_id": 66453748, "body": "How did you verify that there&#39;s no trailing newline? Some editors don&#39;t actually show these as a blank line, but add them silently anyway. Try <code>od -tc &#47;path&#47;to&#47;file&#47;ad_iata</code> and see."}, {"owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "edited": false, "score": 0, "creation_date": 1474285247, "post_id": 39567702, "comment_id": 66454151, "body": "I stand corrected. There IS a trailing <code>\\n</code> at the end of the last line. That makes the behaviour of <code>ioutil.ReadFile</code> more logical to me. I learned something from you answer. Thanks again."}], "tags": [], "owner": {"reputation": 149903, "user_id": 14637, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/1904e7096278a10f1dfb3fdc0ceb53cc?s=128&d=identicon&r=PG", "display_name": "Thomas", "link": "https://stackoverflow.com/users/14637/thomas"}, "is_accepted": false, "score": 4, "last_activity_date": 1474270522, "creation_date": 1474270522, "answer_id": 39567702, "question_id": 39567179, "link": "https://stackoverflow.com/questions/39567179/prevent-readfile-or-readall-from-reading-eof/39567702#39567702", "title": "Prevent ReadFile or ReadAll from reading EOF", "body": "<p>There is no such thing as an \"EOF byte\" or \"EOF character\". What you are seeing is probably caused by a line break character (<code>'\\n'</code>) at the very end of the file.</p>\n\n<p>To read a file line by line, it's more idiomatic to use <code>bufio.Scanner</code> instead:</p>\n\n<pre><code>file, err := os.Open(airportsFile)\nif err != nil {\n    log.Fatal(err)\n}\ndefer file.Close()\n\nscanner := bufio.NewScanner(file)\nfor scanner.Scan() {\n    line := scanner.Text()\n    // ... use line as you please ...\n}\n\nif err := scanner.Err(); err != nil {\n    log.Fatal(err)\n}\n</code></pre>\n\n<p>And this actually addresses your problem, because <code>Scanner</code> will read the final newline without starting a new line, as evidenced by <a href=\"https://play.golang.org/p/Db99wO9dK_\" rel=\"nofollow\">this playground example</a>.</p>\n"}, {"tags": [], "owner": {"reputation": 10358, "user_id": 1211175, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/il5eC.jpg?s=128&g=1", "display_name": "Endre Simo", "link": "https://stackoverflow.com/users/1211175/endre-simo"}, "is_accepted": false, "score": 1, "last_activity_date": 1474271591, "creation_date": 1474271591, "answer_id": 39567982, "question_id": 39567179, "link": "https://stackoverflow.com/questions/39567179/prevent-readfile-or-readall-from-reading-eof/39567982#39567982", "title": "Prevent ReadFile or ReadAll from reading EOF", "body": "<p>You may use <a href=\"https://golang.org/src/bufio/scan.go?s=3814:3843#L80\" rel=\"nofollow\"><code>scanner.Err()</code></a> to check for errors on file read.</p>\n\n<pre><code>// Err returns the first non-EOF error that was encountered by the Scanner.\nfunc (s *Scanner) Err() error {\n    if s.err == io.EOF {\n        return nil\n    }\n    return s.err\n}\n</code></pre>\n\n<p>In general in go the idiomatic way to read and parse a file is to use <code>bufio.NewScanner</code> which accept as an input parameter the file to read and returns a new <code>Scanner</code>.</p>\n\n<p>Considering the above remarks here is a way you can read and parse a file:</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n)\n\nfunc main() {\n    input, err := os.Open(\"example.txt\")\n\n    if err != nil {\n        panic(\"Error happend during opening the file. Please check if file exists!\")\n        os.Exit(1)\n    }\n\n    defer input.Close()\n\n    scanner := bufio.NewScanner(input)\n    for scanner.Scan() {\n        line := scanner.Text()\n        fmt.Printf(\"%v\\n\", line)\n    }\n    if err := scanner.Err(); err != nil {\n        fmt.Fprintln(os.Stderr, \"reading input:\", err)\n    }    \n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 7284, "user_id": 4374109, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sHeIb.png?s=128&g=1", "display_name": "Uvelichitel", "link": "https://stackoverflow.com/users/4374109/uvelichitel"}, "is_accepted": false, "score": 2, "last_activity_date": 1474273165, "creation_date": 1474273165, "answer_id": 39568395, "question_id": 39567179, "link": "https://stackoverflow.com/questions/39567179/prevent-readfile-or-readall-from-reading-eof/39568395#39568395", "title": "Prevent ReadFile or ReadAll from reading EOF", "body": "<p>Your input File seeems to be CSV file, so you can use <code>encoding/csv</code></p>\n\n<pre><code>airportsFile := \"/path/to/file/ad_iata\"\ncontent, err := os.Open(airportsFile)\n    if err != nil {\n        log.Fatal(err)\n    }\nr := csv.NewReader(content)\nr.Comma = ';'\nrecords, err := r.ReadAll()  /* split line on field separator ; */\nif err != nil {\n    log.Fatal(err)\n}\nfmt.Println(records)\n</code></pre>\n\n<p>which looks terse enough for me and provide correct output</p>\n\n<p>[[CZG KCZG some text] [EKY KEKY some text] [A50 KA50 some text] [UKY UCFL some text] [MIC KMIC some text] [K2M K23M some text]]</p>\n"}], "owner": {"reputation": 2714, "user_id": 752297, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/lDqC1.jpg?s=128&g=1", "display_name": "ripat", "link": "https://stackoverflow.com/users/752297/ripat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1240, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1474273165, "creation_date": 1474268650, "last_edit_date": 1474269576, "question_id": 39567179, "link": "https://stackoverflow.com/questions/39567179/prevent-readfile-or-readall-from-reading-eof", "title": "Prevent ReadFile or ReadAll from reading EOF", "body": "<p>I start learning Go and I am a bit puzzled by the fact it includes the EOF when using the <a href=\"https://gowalker.org/io/ioutil#ReadFile\" rel=\"nofollow\">ioutil.ReadFile</a> function. I want, for example, to read a file and parse all its lines on a field separator.</p>\n\n<p>Sample input File:</p>\n\n<pre><code>CZG;KCZG;some text\nEKY;KEKY;some text\nA50;KA50;some text\nUKY;UCFL;some text\nMIC;KMIC;some text\nK2M;K23M;some text\n</code></pre>\n\n<p>This is what I do to read and parse that file:</p>\n\n<pre><code>import(\n    \"fmt\"\n    \"log\"\n    \"io/ioutil\"\n    \"strings\"\n    )\n\nfunc main() {  \n    /* Read file */\n    airportsFile := \"/path/to/file/ad_iata\"\n    content, err := ioutil.ReadFile(airportsFile)\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    /* split content on EOL */\n    lines := strings.Split(string(content), \"\\n\")\n\n    /* split line on field separator ; */\n    for _, line := range lines {\n        lineSplit := strings.Split(line, \";\")\n        fmt.Println(lineSplit)\n    }\n}\n</code></pre>\n\n<p>The <a href=\"https://golang.org/pkg/strings/#Split\" rel=\"nofollow\">string.Split</a> function adds a empty element at the end of the lineSplit slice when it sees the EOF (nothing to parse). Therefore, if I want to access the second index of that slice (<code>lineSplit[1]</code>) I run into a <code>panic: runtime error: index out of range</code>. I have to restrict the range by doing this</p>\n\n<pre><code>/* split line on field separator ; */\nlenLines := len(lines) -1\nfor _, line := range lines[:lenLines] {\n    lineSplit := strings.Split(line, \";\")\n    fmt.Println(lineSplit[1])\n}\n</code></pre>\n\n<p>Is there a better way if I want to keep using ReadFile for its terseness ?</p>\n\n<p>The same problem occurs when using <a href=\"https://golang.org/pkg/io/ioutil/#ReadAll\" rel=\"nofollow\">ioutil.ReadAll</a></p>\n"}, {"tags": ["go"], "comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "edited": false, "score": 2, "creation_date": 1474257536, "post_id": 39565055, "comment_id": 66440734, "body": "Why without using for loop?"}, {"owner": {"reputation": 21441, "user_id": 723693, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/18b2fe761a7aa211adfb466500210412?s=128&d=identicon&r=PG", "display_name": "ain", "link": "https://stackoverflow.com/users/723693/ain"}, "edited": false, "score": 0, "creation_date": 1474263891, "post_id": 39565055, "comment_id": 66442566, "body": "Sounds like a homework or interview question :)"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 6, "last_activity_date": 1474264449, "last_edit_date": 1495542254, "creation_date": 1474260714, "answer_id": 39565597, "question_id": 39565055, "link": "https://stackoverflow.com/questions/39565055/read-a-set-of-integers-separated-by-space-in-golang/39565597#39565597", "title": "Read a set of integers separated by space in Golang", "body": "<p>Anyway there is a loop, Here without <code>for</code> and <code>goto</code> loop ( try it on <a href=\"https://play.golang.org/p/LpL9TLuViW\" rel=\"noreferrer\">The Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    fmt.Println(`Enter the number of integers`)\n    var n int\n    if m, err := Scan(&amp;n); m != 1 {\n        panic(err)\n    }\n    fmt.Println(`Enter the integers`)\n    all := make([]int, n)\n    ReadN(all, 0, n)\n    fmt.Println(all)\n}\n\nfunc ReadN(all []int, i, n int) {\n    if n == 0 {\n        return\n    }\n    if m, err := Scan(&amp;all[i]); m != 1 {\n        panic(err)\n    }\n    ReadN(all, i+1, n-1)\n}\n\nfunc Scan(a *int) (int, error) {\n    return fmt.Scan(a)\n}\n</code></pre>\n\n<p>io:</p>\n\n<pre><code>Enter the number of integers\n3\nEnter the integers\n10 20 30\n[10 20 30]\n</code></pre>\n\n<hr>\n\n<p>For faster input scanning rewrite:  </p>\n\n<pre><code>func Scan(a *int) (int, error) {\n    return fmt.Scan(a)\n}\n</code></pre>\n\n<p>using:<br>\n <a href=\"https://stackoverflow.com/questions/31333353/faster-input-scanning\">Faster input scanning</a></p>\n"}, {"tags": [], "owner": {"reputation": 14451, "user_id": 1334561, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LhV7w.jpg?s=128&g=1", "display_name": "Muhammad Soliman", "link": "https://stackoverflow.com/users/1334561/muhammad-soliman"}, "is_accepted": false, "score": 3, "last_activity_date": 1510257482, "creation_date": 1510257482, "answer_id": 47210501, "question_id": 39565055, "link": "https://stackoverflow.com/questions/39565055/read-a-set-of-integers-separated-by-space-in-golang/47210501#47210501", "title": "Read a set of integers separated by space in Golang", "body": "<p>Simpler solution using loop without the need for using recursion function:</p>\n\n<pre><code>    var n int\n\n    if _, err := fmt.Scan(&amp;n); err != nil {\n        panic(err)\n    }\n\n    arr := make([]int, n)\n\n    for i := 0;i&lt;n;i++{\n\n        if _, err := fmt.Scan(&amp;arr[i]); err != nil {\n            panic(err)\n        }\n    }\n\n    fmt.Println(arr)\n</code></pre>\n"}], "owner": {"reputation": 3234, "user_id": 3288346, "user_type": "registered", "accept_rate": 34, "profile_image": "https://www.gravatar.com/avatar/99df306fb4819b1ef758097e20281d65?s=128&d=identicon&r=PG&f=1", "display_name": "kosta", "link": "https://stackoverflow.com/users/3288346/kosta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4162, "favorite_count": 0, "accepted_answer_id": 39565597, "answer_count": 2, "score": 5, "last_activity_date": 1510257482, "creation_date": 1474256828, "last_edit_date": 1474261364, "question_id": 39565055, "link": "https://stackoverflow.com/questions/39565055/read-a-set-of-integers-separated-by-space-in-golang", "title": "Read a set of integers separated by space in Golang", "body": "<p>I want to read a set of integer values from stdin and put it into integer slice. What is the fastest way to do that without using <code>for</code> loop.</p>\n\n<p>e.g.</p>\n\n<pre><code>Enter the number of integers\n3\nEnter the integers\n23 45 66\n</code></pre>\n\n<p>How can I put these values in an integer slice?</p>\n"}, {"tags": ["http", "testing", "go", "server"], "comments": [{"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474232888, "post_id": 39562489, "comment_id": 66435798, "body": "But requesting favicon by http.Get doesn&#39;t make sense right?"}, {"owner": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474233518, "post_id": 39562489, "comment_id": 66435989, "body": "Sorry. Missed it was executed during <code>go test</code>."}, {"owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "reply_to_user": {"reputation": 30951, "user_id": 1266756, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/52eb9d81540fd9e91b82435b194ec9df?s=128&d=identicon&r=PG", "display_name": "Volker", "link": "https://stackoverflow.com/users/1266756/volker"}, "edited": false, "score": 0, "creation_date": 1474233997, "post_id": 39562489, "comment_id": 66436147, "body": "Ok no problem, ps somebody marked this as off topic?"}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 7, "last_activity_date": 1474235217, "last_edit_date": 1474235217, "creation_date": 1474234694, "answer_id": 39562932, "question_id": 39562489, "link": "https://stackoverflow.com/questions/39562489/why-does-http-get-result-in-two-requests-instead-of-one/39562932#39562932", "title": "Why does http.Get result in two requests instead of one?", "body": "<p>That's just the way how <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow\"><code>http.FileServer()</code></a> is written. Quoting from its doc:</p>\n\n<blockquote>\n  <p>As a special case, the returned file server redirects any request ending in \"/index.html\" to the same path, without the final \"index.html\".</p>\n</blockquote>\n\n<p>This is what you experience: you were requesting <code>/bower_components/index.html</code>, so the handler returned by <code>http.FileServer()</code> sends a redirect:</p>\n\n<pre><code>HTTP/1.1 301 Moved Permanently\nLocation: ./\n</code></pre>\n\n<p>And <a href=\"https://golang.org/pkg/net/http/#Get\" rel=\"nofollow\"><code>http.Get()</code></a> being well-behaved, follows this redirect, and performs another <code>HTTP GET</code>, now without the <code>index.html</code>, and the <code>http.FileServer()</code> handler will try and serve the <code>index.html</code> in such case.</p>\n"}], "owner": {"reputation": 5905, "user_id": 172754, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/efa5682f70f80f7f60a1d0d0f406a042?s=128&d=identicon&r=PG", "display_name": "Gert Cuykens", "link": "https://stackoverflow.com/users/172754/gert-cuykens"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 141, "favorite_count": 0, "accepted_answer_id": 39562932, "answer_count": 1, "score": 1, "last_activity_date": 1474235303, "creation_date": 1474231334, "last_edit_date": 1474235303, "question_id": 39562489, "link": "https://stackoverflow.com/questions/39562489/why-does-http-get-result-in-two-requests-instead-of-one", "title": "Why does http.Get result in two requests instead of one?", "body": "<p>Create a test file <code>./bower_components/index.html</code> and run <code>go test</code> in <code>./</code>.</p>\n\n<p>Why does the following print two lines instead of just the first one?</p>\n\n<pre><code>./bower_components/index.html                                                  \n./bower_components/\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>=== RUN   TestRootHandler                                                      \n./bower_components/index.html                                                  \n./bower_components/             ???                                            \n--- PASS: TestRootHandler (0.00s)                                              \n        main_test.go:32: 200 - ./bower_components/Hello World.html             \nPASS                                                                           \nok\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>// RootHandler for HTTP\nfunc RootHandler(root string, h http.Handler) http.Handler {\n    return http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        _, err := os.Open(root + r.URL.Path)\n        if err != nil {\n            fmt.Println(err.Error())\n            h.ServeHTTP(w, r)\n            return\n        }\n        fmt.Println(root + r.URL.Path)\n        r.URL.Path = root + r.URL.Path\n        h.ServeHTTP(w, r)\n    })\n}\n\n// TestRootHandler\nfunc TestRootHandler(t *testing.T) {\n    ts := httptest.NewServer(RootHandler(\"./bower_components\", http.FileServer(http.Dir(\"./\"))))\n    defer ts.Close()\n    res, err := http.Get(ts.URL + \"/index.html\")\n    if err != nil {\n        t.Fatal(err)\n    }\n    body, err := ioutil.ReadAll(res.Body)\n    res.Body.Close()\n    if err != nil {\n        t.Fatal(err)\n    }\n    t.Logf(\"%d - %s\", res.StatusCode, body)\n}\n</code></pre>\n\n<p>Let me know if you don't understand the question then I will setup a github repository so you can just run the go test command to see what I mean.</p>\n"}, {"tags": ["arrays", "go", "slice"], "comments": [{"owner": {"reputation": 126499, "user_id": 1531124, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zw18i.png?s=128&g=1", "display_name": "GhostCat", "link": "https://stackoverflow.com/users/1531124/ghostcat"}, "edited": false, "score": 3, "creation_date": 1474223138, "post_id": 39561140, "comment_id": 66432919, "body": "And why put you java and c tags on your question, when it is solely about Go?"}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "reply_to_user": {"reputation": 126499, "user_id": 1531124, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/zw18i.png?s=128&g=1", "display_name": "GhostCat", "link": "https://stackoverflow.com/users/1531124/ghostcat"}, "edited": false, "score": 0, "creation_date": 1474223258, "post_id": 39561140, "comment_id": 66432957, "body": "Because I think my question has some information based on Java and C language. So I think it will suitable for putting those tags on my question. I&#39;m sorry if my thinking is wrong."}, {"owner": {"reputation": 5338, "user_id": 4594973, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/USV9e.jpg?s=128&g=1", "display_name": "code_dredd", "link": "https://stackoverflow.com/users/4594973/code-dredd"}, "edited": false, "score": 1, "creation_date": 1474227365, "post_id": 39561140, "comment_id": 66434210, "body": "@Tr\u1ea7nKimD\u1ef1 While the question is based on what you already know from C and Java, the question is not about C or Java themselves. I&#39;ve removed those tags."}], "answers": [{"comments": [{"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 1, "creation_date": 1474226853, "post_id": 39561477, "comment_id": 66434067, "body": "thanks for your dedicated answer. I have learned so much from your answer :D"}, {"owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "edited": false, "score": 0, "creation_date": 1474227066, "post_id": 39561477, "comment_id": 66434140, "body": "As the blog stated, I think Go designs good at this point, combine good part from both C and Java array."}, {"owner": {"reputation": 458, "user_id": 8539727, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb585c6a1591596b44e10948141291f2?s=128&d=identicon&r=PG&f=1", "display_name": "hafizhanindito", "link": "https://stackoverflow.com/users/8539727/hafizhanindito"}, "edited": false, "score": 0, "creation_date": 1541144865, "post_id": 39561477, "comment_id": 93123548, "body": "Just want to add that essentially, a slice with type <code>[][]string</code> is simply storing data that satisfies the type of <code>[]string</code>, which then holds the actual pointer, cap and len to the underlying array that actually store the string value."}, {"owner": {"reputation": 1072, "user_id": 11587667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3b5384cf5e4c690b34c5788d016f4e?s=128&d=identicon&r=PG", "display_name": "mohammad", "link": "https://stackoverflow.com/users/11587667/mohammad"}, "edited": false, "score": 0, "creation_date": 1612163210, "post_id": 39561477, "comment_id": 116670541, "body": "hi, awesome answer, I know that one dimensional array will be stored contiguous, but can you explain how multidimensional slice backing array will be stored on memory ? are inner slices backing array stored separately in memory ?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1072, "user_id": 11587667, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e3b5384cf5e4c690b34c5788d016f4e?s=128&d=identicon&r=PG", "display_name": "mohammad", "link": "https://stackoverflow.com/users/11587667/mohammad"}, "edited": false, "score": 1, "creation_date": 1612164472, "post_id": 39561477, "comment_id": 116670922, "body": "@mohammad Slice is just a header, referring to a backing array. So if you have a slice of slices, that just contains headers, which may point to anywhere. You can&#39;t even allocate backing arrays for a slice of slices in one step, only the slice of headers. You have to allocate and initialize the slices one-by-one, so it&#39;s most likely they won&#39;t end up continuous in memory. You may however allocate a big array (or slice), and reslice that to initialize a slice of slices, in which case you would have  the backing arrays allocated continuous."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 31, "last_activity_date": 1474228049, "last_edit_date": 1474228049, "creation_date": 1474225152, "answer_id": 39561477, "question_id": 39561140, "link": "https://stackoverflow.com/questions/39561140/what-is-two-dimensional-arrays-memory-representation/39561477#39561477", "title": "What is two dimensional array&#39;s memory representation?", "body": "<p>In Go, <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"noreferrer\">slices</a> are often mistaken for <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"noreferrer\">arrays</a>, so I answer regarding both.</p>\n\n<h3>Arrays</h3>\n\n<p>Quoting from the <a href=\"https://golang.org/ref/spec#Array_types\" rel=\"noreferrer\">spec: Array types:</a></p>\n\n<blockquote>\n  <p><strong>Array types are always one-dimensional</strong> but may be composed to form multi-dimensional types.</p>\n</blockquote>\n\n<p>There you have your answer plain and clear. But the answer is not just that as arrays are values in Go, they are not descriptors (headers) like slices.</p>\n\n<p>See this simple example:</p>\n\n<pre><code>x := [5][5]byte{}\nfmt.Println(&amp;x[0][3])\nfmt.Println(&amp;x[0][4])\nfmt.Println(&amp;x[1][0])\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/EafmCKT5cq\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>0x10432203\n0x10432204\n0x10432205\n</code></pre>\n\n<p>As you can see, the memory allocated and used for the array is contiguous: the second row starts at a memory address that is the subsequent to the address of the last element of the first row.</p>\n\n<p>Checking size of arrays:</p>\n\n<pre><code>fmt.Println(unsafe.Sizeof([4][6]int{})) // 96\nfmt.Println(unsafe.Sizeof([6][4]int{})) // 96\n</code></pre>\n\n<p>It doesn't matter if you switch rows and columns, its size is the same.</p>\n\n<h3>Slices</h3>\n\n<p>The same applies in case of slices: a multidimensional slice is a slice of slices. <a href=\"https://golang.org/ref/spec#Slice_types\" rel=\"noreferrer\">Spec: Slice types:</a></p>\n\n<blockquote>\n  <p>A slice is a descriptor for a contiguous segment of an <em>underlying array</em> and provides access to a numbered sequence of elements from that array.<br>\n  ...<br>\n  <strong>Like arrays, slices are always one-dimensional but may be composed to construct higher-dimensional objects.</strong></p>\n</blockquote>\n\n<p>Slices are descriptors, a slice header contains a pointer to an element of an underlying (backing) array, a length and a capacity. So the number of total slices matters in terms of memory usage.</p>\n\n<p>See this example:</p>\n\n<pre><code>x := make([][]byte, 2)\nfor i := range x {\n    x[i] = make([]byte, 1000)\n}\nfmt.Println(len(x), len(x)*len(x[0]))\n\ny := make([][]byte, 1000)\nfor i := range y {\n    y[i] = make([]byte, 2)\n}\nfmt.Println(len(y), len(y)*len(y[0]))\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/BKvGGK1wkg\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>2 2000\n1000 2000\n</code></pre>\n\n<p>Both <code>x</code> and <code>y</code> multidimensional slices have 2000 elements total (2000 bytes), but <code>x</code> stores <code>2</code> slices only, each having <code>1000</code> elements, while <code>y</code> stores <code>1000</code> slices, each having <code>2</code> elements.</p>\n\n<p>This means <code>x</code> requires <code>2</code> slice headers while <code>y</code> requires <code>1000</code> slice headers (for the elements, +1 for <code>x</code> and <code>y</code> themselves)!</p>\n\n<p>A slice header is represented by <a href=\"https://golang.org/pkg/reflect/#SliceHeader\" rel=\"noreferrer\"><code>reflect.SliceHeader</code></a>:</p>\n\n<pre><code>type SliceHeader struct {\n    Data uintptr\n    Len  int\n    Cap  int\n}\n</code></pre>\n\n<p>The size of a slice header on 32-bit architectures is 12 bytes, on 64 bit architectures its 24 bytes. So in case of 32-bit arch elements of <code>x</code> require 2,000 bytes plus 2x12 bytes in memory which is <strong>2,024 bytes</strong>, while elements of <code>y</code> require 2,000 bytes plus 1,000*12 which is <strong>14,000 bytes</strong>.</p>\n\n<p>Also note that elements of a multidimensional slice may contain slices with different lengths:</p>\n\n<blockquote>\n  <p>With arrays of arrays, the inner arrays are, by construction, always the same length; however with slices of slices (or arrays of slices), the inner lengths may vary dynamically. Moreover, the inner slices must be initialized individually.</p>\n</blockquote>\n\n<p>Like in this example:</p>\n\n<pre><code>x := make([][]byte, 2)\nx[0] = []byte{1, 2}\nx[1] = []byte{1, 2, 3, 4}\nfmt.Println(x[0])\nfmt.Println(x[1])\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/47sjMIAP2C\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>[1 2]\n[1 2 3 4]\n</code></pre>\n\n<hr>\n\n<p>If you haven't read, recommended: <a href=\"https://blog.golang.org/slices\" rel=\"noreferrer\">The Go Blog: Arrays, slices (and strings): The mechanics of 'append'</a></p>\n"}, {"tags": [], "owner": {"reputation": 23, "user_id": 6109336, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/dRelv.jpg?s=128&g=1", "display_name": "Martin Gao", "link": "https://stackoverflow.com/users/6109336/martin-gao"}, "is_accepted": false, "score": 0, "last_activity_date": 1615184344, "creation_date": 1615184344, "answer_id": 66525136, "question_id": 39561140, "link": "https://stackoverflow.com/questions/39561140/what-is-two-dimensional-arrays-memory-representation/66525136#66525136", "title": "What is two dimensional array&#39;s memory representation?", "body": "<p>For me, slice in Go seems like <code>vector</code> in C++. <code>Vector</code> also has 3 key data members : ptr to data, capacity and length. And if <code>vector</code> is 2d, the inner lengths of subvectors may vary dynamically as well.</p>\n<p>In comparsion, array in Go seems like array in C.</p>\n"}], "owner": {"reputation": 4842, "user_id": 1493868, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/7a84611ec325ce3125ec56149b2cfcb6?s=128&d=identicon&r=PG", "display_name": "Tr\u1ea7n Kim D\u1ef1", "link": "https://stackoverflow.com/users/1493868/tr%e1%ba%a7n-kim-d%e1%bb%b1"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7189, "favorite_count": 5, "accepted_answer_id": 39561477, "answer_count": 2, "score": 8, "last_activity_date": 1615184344, "creation_date": 1474223055, "last_edit_date": 1595415267, "question_id": 39561140, "link": "https://stackoverflow.com/questions/39561140/what-is-two-dimensional-arrays-memory-representation", "title": "What is two dimensional array&#39;s memory representation?", "body": "<p>In Java, two dimensional array is multi one-dimensional array. That means those one-dimensional arrays not consecutive on memory.</p>\n<p>In contrast, in C, two dimensional array in fact is one-dimensional array with size is <strong>total_row * total_column</strong>. Because Go language uses many concepts from C.</p>\n<p>So my question is: does two dimensional array's memory representation in Go look like C or Java?</p>\n"}, {"tags": ["c", "linux", "macos", "go", "bsd"], "comments": [{"owner": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 2, "creation_date": 1474219852, "post_id": 39560479, "comment_id": 66431830, "body": "try this library maybe: <a href=\"https://godoc.org/github.com/msteinert/pam\" rel=\"nofollow noreferrer\">godoc.org/github.com/msteinert/pam</a>"}, {"owner": {"reputation": 76, "user_id": 2014640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/231f12584c6c45ca62a176ba332eaca0?s=128&d=identicon&r=PG", "display_name": "John Murphy", "link": "https://stackoverflow.com/users/2014640/john-murphy"}, "edited": false, "score": 0, "creation_date": 1474224119, "post_id": 39560479, "comment_id": 66433255, "body": "Thank you, it looks promising.  I&#39;ll give it a try."}, {"owner": {"reputation": 76, "user_id": 2014640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/231f12584c6c45ca62a176ba332eaca0?s=128&d=identicon&r=PG", "display_name": "John Murphy", "link": "https://stackoverflow.com/users/2014640/john-murphy"}, "reply_to_user": {"reputation": 39512, "user_id": 1239701, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/95ca4e887354416993fd91e2e16c4380?s=128&d=identicon&r=PG", "display_name": "Not_a_Golfer", "link": "https://stackoverflow.com/users/1239701/not-a-golfer"}, "edited": false, "score": 0, "creation_date": 1474846248, "post_id": 39560479, "comment_id": 66684834, "body": "@Not_a_Golfer I tried  godoc.org/github.com/msteinert/pam on my Mac, doesn&#39;t work.  I ran test as root and they all fail with a system error."}], "answers": [{"comments": [{"owner": {"reputation": 76, "user_id": 2014640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/231f12584c6c45ca62a176ba332eaca0?s=128&d=identicon&r=PG", "display_name": "John Murphy", "link": "https://stackoverflow.com/users/2014640/john-murphy"}, "edited": false, "score": 0, "creation_date": 1474870559, "post_id": 39571341, "comment_id": 66690299, "body": "I ended up writing a cgo module that uses PAM. There are some differences between BSD (Mac) and Linux but it&#39;s not that big of a deal. <a href=\"https://github.com/murphybytes/ucp/tree/master/pam\" rel=\"nofollow noreferrer\">github.com/murphybytes/ucp/tree/master/pam</a>"}], "tags": [], "owner": {"reputation": 25560, "user_id": 2068642, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/DYTnZ.jpg?s=128&g=1", "display_name": "TheDarkKnight", "link": "https://stackoverflow.com/users/2068642/thedarkknight"}, "is_accepted": false, "score": 2, "last_activity_date": 1474282219, "creation_date": 1474282219, "answer_id": 39571341, "question_id": 39560479, "link": "https://stackoverflow.com/questions/39560479/is-there-a-way-to-find-out-if-a-supplied-password-matches-an-actual-password-for/39571341#39571341", "title": "Is there a way to find out if a supplied password matches an actual password for a particular user?", "body": "<p>You can use PAM Authentication for both linux and OS X.\nThe main function being <a href=\"https://linux.die.net/man/3/pam_authenticate\" rel=\"nofollow\">pam_authenticate</a>, though you'll need to start the pam service first and end it when you're finished.</p>\n\n<p><a href=\"http://www.linux-pam.org/Linux-PAM-html/adg-example.html\" rel=\"nofollow\">Here's an example</a> of its basic usage.</p>\n"}], "owner": {"reputation": 76, "user_id": 2014640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/231f12584c6c45ca62a176ba332eaca0?s=128&d=identicon&r=PG", "display_name": "John Murphy", "link": "https://stackoverflow.com/users/2014640/john-murphy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 109, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474282219, "creation_date": 1474218918, "question_id": 39560479, "link": "https://stackoverflow.com/questions/39560479/is-there-a-way-to-find-out-if-a-supplied-password-matches-an-actual-password-for", "title": "Is there a way to find out if a supplied password matches an actual password for a particular user?", "body": "<p>I have an application that reads a user's name and password over a socket.  I want to determine if the supplied password matches the password that the OS has for that user. If it does, I want to fork a process running as that user. Ideally, the code would be in Go, but I can do C if needed.  Ideally, it would work in Linux, OSX, and BSD.  </p>\n"}, {"tags": ["go", "redis"], "comments": [{"owner": {"reputation": 417, "user_id": 3049386, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/754afefdb87c446066459a9857d9a0cf?s=128&d=identicon&r=PG&f=1", "display_name": "Bestbug", "link": "https://stackoverflow.com/users/3049386/bestbug"}, "edited": false, "score": 0, "creation_date": 1474370878, "post_id": 39560072, "comment_id": 66494488, "body": "Do you have a real time application? I think a <a href=\"http://nesv.github.io/golang/2014/02/25/worker-queues-in-go.html\" rel=\"nofollow noreferrer\">working queue</a> can be a good solution, you have 2 queue in this case: one handle the &quot;update row&quot; and another handle the &quot;tree-row&quot;. The WQ will be a &quot;connector&quot; to 3 go-routine pool. The first one is the one who detect which row should be update and the others go-routine pool handle the update of the row (one for &quot;update row&quot; and another for &quot;tree-row&quot;. This can be usefull? I can explain more in an answear if you want."}], "owner": {"reputation": 313, "user_id": 1796995, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/42b7904db6760c72ab09ab7f92022e22?s=128&d=identicon&r=PG", "display_name": "user1796995", "link": "https://stackoverflow.com/users/1796995/user1796995"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 96, "favorite_count": 2, "answer_count": 0, "score": 1, "last_activity_date": 1474216516, "creation_date": 1474216516, "question_id": 39560072, "link": "https://stackoverflow.com/questions/39560072/how-to-queue-database-row-updates-to-occur-every-n-seconds-using-redis", "title": "How to queue database row updates to occur every n seconds using Redis", "body": "<p>I have a nosql database rows of two types:</p>\n\n<ul>\n<li>Rows that are essentially counters with a high number of updates per second. It doesn't matter if these updates are done in a batch once every n seconds (where n is say 2 seconds).</li>\n<li>Rows that contain tree-like structures, and each time the row is updated the tree structure has to be updated. Updating the tree structure each time is expensive, it would be better to do it as a batch job once every n seconds.</li>\n</ul>\n\n<p>This is my plan and then I will explain the part I am struggling to execute and whether I need to move to something like RabbitMQ.</p>\n\n<p>Each row has a unique id which I use as the key for redis. Redis can easily do loads of counter increments no problem. As for the tree structure, each update for the row can use the string append command to appen json instructions on how to modify the existing tree in the database.</p>\n\n<p><strong>This is the tricky part</strong></p>\n\n<p>I want to ensure each row gets updated every n seconds. There will be a large amount of redis keys getting updated.</p>\n\n<p>This was my plan. Have three queues: pre-processing, processing, dead</p>\n\n<p>By default every key is placed in the pre-processing queue when the command for a database update comes in. After exactly n seconds move each key/value which has been there for n seconds to the processing queue <strong>(don't know how to do this efficiently and concurrently)</strong>. Now n seconds have passed, it doesn't matter which order the processing queue is done in and I can have any consumers racing through them. And I will have a dead queue in case tasks keep failing for some reason.</p>\n\n<p>Is there a better way to do this? Is what I am thinking of possible?</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 3, "last_activity_date": 1474216519, "creation_date": 1474216519, "answer_id": 39560073, "question_id": 39560044, "link": "https://stackoverflow.com/questions/39560044/should-functions-constants-variables-be-exported-or-not-in-package-main/39560073#39560073", "title": "Should functions/constants/variables be exported or not in `package main`?", "body": "<p>Really it doesn't matter. <code>main</code> packages can't be imported so whether you export them or not doesn't matter in that regard.</p>\n\n<p>However if you do export them then tools like <code>golint</code> will encourage you to document them so maybe that's a good reason to go ahead an export them.</p>\n"}, {"tags": [], "owner": {"reputation": 76, "user_id": 2014640, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/231f12584c6c45ca62a176ba332eaca0?s=128&d=identicon&r=PG", "display_name": "John Murphy", "link": "https://stackoverflow.com/users/2014640/john-murphy"}, "is_accepted": false, "score": 3, "last_activity_date": 1474219663, "creation_date": 1474219663, "answer_id": 39560596, "question_id": 39560044, "link": "https://stackoverflow.com/questions/39560044/should-functions-constants-variables-be-exported-or-not-in-package-main/39560596#39560596", "title": "Should functions/constants/variables be exported or not in `package main`?", "body": "<p>The most important thing is to be consistent.  I prefer to name un-exported items in package main starting with lowercase even though they can't be exported. This is because it's an additional hint that these entities aren't used outside their containing package.  You don't need to know that the declaration is in main to know that the thing being declared is not used externally.  </p>\n"}], "owner": {"reputation": 11281, "user_id": 260805, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/34e031251528689dd8f8039fef24a65f?s=128&d=identicon&r=PG", "display_name": "Ztyx", "link": "https://stackoverflow.com/users/260805/ztyx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 97, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1474219663, "creation_date": 1474216317, "question_id": 39560044, "link": "https://stackoverflow.com/questions/39560044/should-functions-constants-variables-be-exported-or-not-in-package-main", "title": "Should functions/constants/variables be exported or not in `package main`?", "body": "<p>I'm developing <a href=\"https://github.com/JensRantil/geanstalkd\" rel=\"nofollow\">a tiny project</a> that has a single <code>package main</code>. AFAIK, best-practice for small Golang binary projects is to have all code <a href=\"http://peter.bourgon.org/go-in-production/\" rel=\"nofollow\">in a single (<code>main</code>) namespace</a>, so that's what I've done.</p>\n\n<p>Just curious, within a <code>package main</code>, is it best practice to keep functions/constants/variables exported (<code>MyFunction</code>) or unexported (<code>myFunction</code>)?</p>\n"}, {"tags": ["c++", "templates", "go"], "comments": [{"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 0, "creation_date": 1474212555, "post_id": 39559293, "comment_id": 66429173, "body": "the lack of generics/templates is a major criticism against golang. you can&#39;t do it, at least until google will add them"}, {"owner": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "reply_to_user": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "edited": false, "score": 1, "creation_date": 1474213068, "post_id": 39559293, "comment_id": 66429334, "body": "@DavidHaim: the lack of generics/templates is a major feature of golang. :-)"}, {"owner": {"reputation": 23009, "user_id": 3613500, "user_type": "registered", "accept_rate": 95, "profile_image": "https://i.stack.imgur.com/lIfov.png?s=128&g=1", "display_name": "David Haim", "link": "https://stackoverflow.com/users/3613500/david-haim"}, "reply_to_user": {"reputation": 426981, "user_id": 596781, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/a18405dd4b022837867d1f5453a05f41?s=128&d=identicon&r=PG", "display_name": "Kerrek SB", "link": "https://stackoverflow.com/users/596781/kerrek-sb"}, "edited": false, "score": 1, "creation_date": 1474213284, "post_id": 39559293, "comment_id": 66429411, "body": "@KerrekSB if re-implementing each mechanism 10 times is a feature, I agree"}], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 0, "last_activity_date": 1474219976, "last_edit_date": 1495542819, "creation_date": 1474217052, "answer_id": 39560164, "question_id": 39559293, "link": "https://stackoverflow.com/questions/39559293/c-template-like-behavior-in-go/39560164#39560164", "title": "C++ Template-like behavior in Go", "body": "<p>1- You may use </p>\n\n<pre><code>fooWithID := GetIdentifiedModel(\"foo id\", &amp;Foo{})\n</code></pre>\n\n<p>like this working sample ( try on <a href=\"https://play.golang.org/p/l2ffqi7V1W\" rel=\"nofollow noreferrer\">The Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Foo struct {\n    c byte\n}\n\nfunc (t *Foo) set(s string) { t.c = s[0] }\n\ntype Bar struct {\n    n int\n}\n\nfunc (t *Bar) set(s string) { t.n = len(s) }\n\ntype Identified struct {\n    model T\n    id    string\n}\n\nfunc GetIdentifiedModel(id string, t T) *Identified {\n    result := &amp;Identified{model: t}\n    result.id = id\n    result.model.set(id)\n    return result\n}\n\nfunc assert(b bool) {\n    if b {\n        fmt.Println(\"OK\")\n    } else {\n        fmt.Println(\"There is a problem !\")\n    }\n}\n\nfunc main() {\n    fooWithID := GetIdentifiedModel(\"foo id\", &amp;Foo{})\n    barWithID := GetIdentifiedModel(\"bar\", &amp;Bar{})\n\n    assert(fooWithID.model.(*Foo).c == 'f')\n    assert(barWithID.model.(*Bar).n == 3)\n}\n\ntype T interface {\n    set(string)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>OK\nOK\n</code></pre>\n\n<hr>\n\n<p>2- You may use (this is nice to read: <code>Identified model Foo</code>): </p>\n\n<pre><code>fooWithID := GetIdentifiedModel(\"foo id\", &amp;Identified{model: &amp;Foo{}})\n</code></pre>\n\n<p>like this working sample ( try on <a href=\"https://play.golang.org/p/BilGn2SoNJ\" rel=\"nofollow noreferrer\">The Go Playground</a>):</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\ntype Foo struct {\n    c byte\n}\n\nfunc (t *Foo) set(s string) { t.c = s[0] }\n\ntype Bar struct {\n    n int\n}\n\nfunc (t *Bar) set(s string) { t.n = len(s) }\n\ntype Identified struct {\n    model T\n    id    string\n}\n\nfunc GetIdentifiedModel(id string, result *Identified) *Identified {\n    result.id = id\n    result.model.set(id)\n    return result\n}\n\nfunc assert(b bool) {\n    if b {\n        fmt.Println(\"OK\")\n    } else {\n        fmt.Println(\"There is a problem !\")\n    }\n}\n\nfunc main() {\n    fooWithID := GetIdentifiedModel(\"foo id\", &amp;Identified{model: &amp;Foo{}})\n    barWithID := GetIdentifiedModel(\"bar\", &amp;Identified{model: &amp;Bar{}})    \n    assert(fooWithID.model.(*Foo).c == 'f')\n    assert(barWithID.model.(*Bar).n == 3)\n}\n\ntype T interface {\n    set(string)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>OK\nOK\n</code></pre>\n\n<hr>\n\n<p>See also: <a href=\"https://stackoverflow.com/questions/39131886/one-method-to-handle-all-the-struct-types-that-embed-one-common-struct-json-mar\">One method to handle all the struct types that embed one common struct (json marshalling)</a></p>\n"}], "owner": {"reputation": 35, "user_id": 3575507, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/926d416ee6aedd1b2a15c35ae15ac996?s=128&d=identicon&r=PG&f=1", "display_name": "Leeios", "link": "https://stackoverflow.com/users/3575507/leeios"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2432, "favorite_count": 0, "accepted_answer_id": 39560164, "answer_count": 1, "score": 1, "last_activity_date": 1474219976, "creation_date": 1474212181, "last_edit_date": 1474217694, "question_id": 39559293, "link": "https://stackoverflow.com/questions/39559293/c-template-like-behavior-in-go", "title": "C++ Template-like behavior in Go", "body": "<p>For example I have two different structs <code>Foo</code> and <code>Bar</code></p>\n\n<pre><code>struct Foo {...}\nstruct Bar {...}\n</code></pre>\n\n<p>and a lot of functions and other types built on them.</p>\n\n<p>C++ flavor:</p>\n\n<pre><code>template&lt;typename T&gt;\nstruct Identified {\n    T model;\n    std::string id;\n};\n\ntemplate&lt;typename T&gt;\nIdentified&lt;T&gt; GetIdentifiedModel(std::string id) {\n    Identified&lt;T&gt; result;\n    T.id = id;\n    T.model.set(getSomeData(id));  // Common method for T\n    return result;\n}\n</code></pre>\n\n<p>How to implement these examples in Go?</p>\n\n<p>For common methods, interfaces do the job but I don't see how to retrieve a specific type from an interface to declare it, return it or anything else and I can't handle copy/paste code anymore :)</p>\n\n<p>Thanks !</p>\n\n<p>Edit @Amd: <a href=\"https://ideone.com/rqpsQb\" rel=\"nofollow\">https://ideone.com/rqpsQb</a></p>\n\n<pre><code>#include &lt;string&gt;\n#include &lt;iostream&gt;\n\nstruct Foo {\n    char c;\n    void set(std::string s) {c = s[0];}; // We don't really care here\n};\nstruct Bar {\n    int n;\n    void set(std::string s) {n = s.size();}; // We don't really care here\n};\n\ntemplate&lt;typename T&gt;\nstruct Identified {\n    T model;\n    std::string id;\n};\n\ntemplate&lt;typename T&gt;\nIdentified&lt;T&gt; GetIdentifiedModel(std::string id) {\n    Identified&lt;T&gt; result;\n    result.id = id;\n    // Obviously shouldn't be ID but for the example\n    result.model.set(id);  // Common method for T\n    return result;\n}\n\nvoid assert(bool b) {\n    if (b) std::cout &lt;&lt; \"OK\" &lt;&lt; std::endl;\n    else std::cout &lt;&lt; \"There is a problem !\" &lt;&lt; std::endl;\n};\n\nint main() {\n    auto fooWithID = GetIdentifiedModel&lt;Foo&gt;(\"foo id\");\n    auto barWithID = GetIdentifiedModel&lt;Bar&gt;(\"bar\");\n    assert (fooWithID.model.c == 'f');\n    assert (barWithID.model.n == 3);\n    return (0);\n}\n</code></pre>\n"}, {"tags": ["c++", "go", "grpc"], "answers": [{"tags": [], "owner": {"reputation": 14359, "user_id": 5384363, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/975cbfcd1c4997cb9e85887a5271d48f?s=128&d=identicon&r=PG&f=1", "display_name": "for_stack", "link": "https://stackoverflow.com/users/5384363/for-stack"}, "is_accepted": false, "score": 5, "last_activity_date": 1474179485, "creation_date": 1474179485, "answer_id": 39554744, "question_id": 39554667, "link": "https://stackoverflow.com/questions/39554667/can-a-c-client-call-a-golang-grpc-server-stub-written-in-golang/39554744#39554744", "title": "Can a C++ client call a golang GRPC server stub written in golang?", "body": "<p>Of course, you can have a GRPC server written in golang, and have a client written in C++. The client code only need to depend on the protobuf definition. It doesn't matter whether the server is written in golang, java, c++ or whatever.</p>\n"}], "owner": {"reputation": 169, "user_id": 6221280, "user_type": "registered", "accept_rate": 40, "profile_image": "https://www.gravatar.com/avatar/62b05c078c911318507b89317a9b794f?s=128&d=identicon&r=PG&f=1", "display_name": "Rajesh", "link": "https://stackoverflow.com/users/6221280/rajesh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 416, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1474179485, "creation_date": 1474178820, "question_id": 39554667, "link": "https://stackoverflow.com/questions/39554667/can-a-c-client-call-a-golang-grpc-server-stub-written-in-golang", "title": "Can a C++ client call a golang GRPC server stub written in golang?", "body": "<p>Can I write a C++ client to call a GRPC routing written in golang? If possible does it need some kind of redirection, i.e, via a stub in C++ invoking golang function?\nor \nIs GRPC agnostic what languages the two end points are implemented in?</p>\n"}, {"tags": ["recursion", "go", "goroutine"], "comments": [{"owner": {"reputation": 1497, "user_id": 1672905, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/AfScD.png?s=128&g=1", "display_name": "coditori", "link": "https://stackoverflow.com/users/1672905/coditori"}, "edited": false, "score": 0, "creation_date": 1474189453, "post_id": 39554252, "comment_id": 66422853, "body": "You need a cycle of time when you use go routine."}], "answers": [{"comments": [{"owner": {"reputation": 1407, "user_id": 648298, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/eb915d0357ffbbb81361e7ad672cc13c?s=128&d=identicon&r=PG", "display_name": "Eran W", "link": "https://stackoverflow.com/users/648298/eran-w"}, "edited": false, "score": 3, "creation_date": 1509138734, "post_id": 39554289, "comment_id": 80914362, "body": "When traversing a graph you have an unknown amount of branches in each recursion. Possible refactor: call <code>Add(1)</code> before each <code>recur()</code>, including main. See example: <a href=\"https://play.golang.org/p/OuZVgowAbt\" rel=\"nofollow noreferrer\">play.golang.org/p/OuZVgowAbt</a>"}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": true, "score": 10, "last_activity_date": 1474175290, "last_edit_date": 1474175290, "creation_date": 1474174849, "answer_id": 39554289, "question_id": 39554252, "link": "https://stackoverflow.com/questions/39554252/golang-recursive-function-calling-itself-as-a-goroutine-doesnt-work-as-expected/39554289#39554289", "title": "golang recursive function calling itself as a goroutine doesn&#39;t work as expected", "body": "<p>If you make everything asynchronous, there is nothing in <code>main</code> to wait on. You have to explicitly wait on the go routines so your program does not exit before the recursive process finishes.</p>\n\n<p>Use <a href=\"https://golang.org/pkg/sync/#WaitGroup\" rel=\"noreferrer\"><code>sync.WaitGroup</code></a> or something similar for synchronization. Example (<a href=\"https://play.golang.org/p/OqWclTzNEJ\" rel=\"noreferrer\">On Play</a>):</p>\n\n<pre><code>func recur(iter int, g *sync.WaitGroup) {\n    defer g.Done()\n    if iter &lt;= 0 {\n        return\n    }\n    fmt.Println(iter)\n    go recur(iter-1, g)\n}\n\nfunc main() {\n    g := &amp;sync.WaitGroup{}\n    runs := 5\n    g.Add(runs)\n    recur(runs, g)\n    g.Wait()\n}\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 464, "user_id": 5537802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653423c62c0c3edb3842c836e1048a?s=128&d=identicon&r=PG&f=1", "display_name": "RSH", "link": "https://stackoverflow.com/users/5537802/rsh"}, "edited": false, "score": 0, "creation_date": 1474175293, "post_id": 39554297, "comment_id": 66419850, "body": "Thanks. Just realized that myself and added the same sleep line to confirm:)"}], "tags": [], "owner": {"reputation": 13635, "user_id": 1061413, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/0beb915463288cb6e8b50e8121860717?s=128&d=identicon&r=PG", "display_name": "Amit Kumar Gupta", "link": "https://stackoverflow.com/users/1061413/amit-kumar-gupta"}, "is_accepted": false, "score": 1, "last_activity_date": 1474174887, "creation_date": 1474174887, "answer_id": 39554297, "question_id": 39554252, "link": "https://stackoverflow.com/questions/39554252/golang-recursive-function-calling-itself-as-a-goroutine-doesnt-work-as-expected/39554297#39554297", "title": "golang recursive function calling itself as a goroutine doesn&#39;t work as expected", "body": "<p>Your programming is exiting before all the goroutines finish.  The simplest way to see this work is as follows.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc recur(iter int) {\n    if iter &lt;= 0 {\n        return\n    }\n    fmt.Println(iter)\n    go recur(iter - 1)\n}\nfunc main() {\n    recur(5)\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/XC3oplghBi\" rel=\"nofollow\">playground link</a></p>\n\n<p>Rather than sleeping, however, you may want to pass a <code>sync.WaitGroup</code> through to your function.</p>\n"}], "owner": {"reputation": 464, "user_id": 5537802, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a9653423c62c0c3edb3842c836e1048a?s=128&d=identicon&r=PG&f=1", "display_name": "RSH", "link": "https://stackoverflow.com/users/5537802/rsh"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3961, "favorite_count": 1, "closed_date": 1474178538, "accepted_answer_id": 39554289, "answer_count": 2, "score": 4, "last_activity_date": 1474175290, "creation_date": 1474174486, "question_id": 39554252, "link": "https://stackoverflow.com/questions/39554252/golang-recursive-function-calling-itself-as-a-goroutine-doesnt-work-as-expected", "closed_reason": "Duplicate", "title": "golang recursive function calling itself as a goroutine doesn&#39;t work as expected", "body": "<p>This recursive function works as expected (returns 5 lines with numbers 5 to 1):</p>\n\n<pre><code>package main\nimport (\n    \"fmt\"\n)\nfunc recur(iter int) {\n    if iter &lt;= 0 {\n        return\n    }\n    fmt.Println(iter)\n    recur(iter-1)\n}\nfunc main() {\n    recur(5)\n}\n</code></pre>\n\n<p>this one does not (returns only 1 line with number 5):</p>\n\n<pre><code>    package main\nimport (\n    \"fmt\"\n)\nfunc recur(iter int) {\n    if iter &lt;= 0 {\n        return\n    }\n    fmt.Println(iter)\n    go recur(iter-1)\n}\nfunc main() {\n    recur(5)\n}\n</code></pre>\n\n<p>The difference is that in the second implementation, function calls itself as a goroutine. (line <code>go recur(iter-1)</code> )</p>\n\n<p>So can someone explain this behaviour?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 1, "creation_date": 1474155572, "post_id": 39552663, "comment_id": 66416980, "body": "Possible duplicate of <a href=\"http://stackoverflow.com/questions/17260107/int16-to-byte-array\">int16 to byte array</a>"}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1474155610, "post_id": 39552663, "comment_id": 66416986, "body": "Check one of the answers here (not the accepted one) <a href=\"http://stackoverflow.com/questions/17260107/int16-to-byte-array\">stackoverflow.com/questions/17260107/int16-to-byte-array</a>"}, {"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1474156882, "post_id": 39552663, "comment_id": 66417200, "body": "<code>binary.BigEndian.PutUint16</code> is close to what i need, but the zeros are not left padded. How would I accomplish that?"}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1474157149, "post_id": 39552663, "comment_id": 66417241, "body": "Ok, check this one <a href=\"http://stackoverflow.com/questions/29836433/golang-add-int-to-end-of-byte-array\" title=\"golang add int to end of byte array\">stackoverflow.com/questions/29836433/&hellip;</a> -- somehow it looks to me that asking Google helps... Although I will admit that this is not ideal"}, {"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1474158205, "post_id": 39552663, "comment_id": 66417412, "body": "Unfortunately, much Google searching has not revealed any solutions to my problem."}, {"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1474199166, "post_id": 39552663, "comment_id": 66425269, "body": "It&#39;s useless to downvote my question without providing a reason why. I have no idea what&#39;s wrong with it."}], "answers": [{"comments": [{"owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "edited": false, "score": 0, "creation_date": 1474168699, "post_id": 39553388, "comment_id": 66418851, "body": "Thanks. This does exactly what I want. Is this the most simple way it can be done?"}, {"owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "reply_to_user": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "edited": false, "score": 0, "creation_date": 1474175145, "post_id": 39553388, "comment_id": 66419822, "body": "You can use one of the <code>binary.BigEndian.PutUint*</code>. You just need to pick a fixed size for the sequence number and write it to the appropriate place in the buffer. For example: <code>binary.BigEndian.PutUint64(buf[8:], uint64(seq))</code>"}], "tags": [], "owner": {"reputation": 5916, "user_id": 3068258, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d7ecfa82e529a576cbc6ef661b9c9815?s=128&d=identicon&r=PG", "display_name": "Andy Schweig", "link": "https://stackoverflow.com/users/3068258/andy-schweig"}, "is_accepted": true, "score": 1, "last_activity_date": 1474164338, "creation_date": 1474164338, "answer_id": 39553388, "question_id": 39552663, "link": "https://stackoverflow.com/questions/39552663/place-integer-in-buffer-and-left-pad-with-zeroes/39553388#39553388", "title": "Place integer in buffer and left pad with zeroes?", "body": "<p>It sounds like you want something like this:</p>\n\n<pre><code>func seqToBuffer(seq int) []byte {\n    buf := make([]byte, 16)\n    for i := len(buf) - 1; seq != 0; i-- {\n        buf[i] = byte(seq &amp; 0xff)\n        seq &gt;&gt;= 8\n    }\n    return buf\n}\n</code></pre>\n"}], "owner": {"reputation": 291, "user_id": 6637202, "user_type": "registered", "accept_rate": 79, "profile_image": "https://www.gravatar.com/avatar/252ead8b84f69ed7e89b11f50cd53d23?s=128&d=identicon&r=PG&f=1", "display_name": "John Smith", "link": "https://stackoverflow.com/users/6637202/john-smith"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 362, "favorite_count": 0, "accepted_answer_id": 39553388, "answer_count": 1, "score": -1, "last_activity_date": 1474164338, "creation_date": 1474154690, "question_id": 39552663, "link": "https://stackoverflow.com/questions/39552663/place-integer-in-buffer-and-left-pad-with-zeroes", "title": "Place integer in buffer and left pad with zeroes?", "body": "<p>I'm trying to implement a protocol and currently have problems with this step:</p>\n\n<pre><code>The big-endian binary representation of the sequence number SHALL be placed in a 16-octet buffer and padded (on the left) with zeros.\n</code></pre>\n\n<p>The sequence number is an <code>int</code>.</p>\n\n<p>I think the correct way to create the 16-octet buffer is like this:</p>\n\n<pre><code>buf := make([]byte, 16)\n</code></pre>\n\n<p>However, I'm not sure how to place the sequence number in the buffer so it follows the requirements above?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "reply_to_user": {"reputation": 107, "user_id": 6841997, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2085e3d3760393405ae00257b3f9c24b?s=128&d=identicon&r=PG&f=1", "display_name": "digiadit", "link": "https://stackoverflow.com/users/6841997/digiadit"}, "edited": false, "score": 1, "creation_date": 1474264935, "post_id": 39552402, "comment_id": 66442949, "body": "@digiadit the important thing to remember is you have to acknowledge all returned variables, if you want to not use a variable, you can use a <code>_</code> in place of the variable name. Typically, it&#39;s important to never avoid errors."}], "tags": [], "owner": {"reputation": 1304, "user_id": 5125201, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bff70a4545b368f2aca2a97de7b234b2?s=128&d=identicon&r=PG", "display_name": "Ammar Bandukwala", "link": "https://stackoverflow.com/users/5125201/ammar-bandukwala"}, "is_accepted": false, "score": 0, "last_activity_date": 1474152149, "creation_date": 1474152149, "answer_id": 39552402, "question_id": 39551985, "link": "https://stackoverflow.com/questions/39551985/weighted-random-in-golang/39552402#39552402", "title": "Weighted Random in Golang", "body": "<p><code>WeightedChoice</code> returns an error you aren't acknowledging in your code.</p>\n"}, {"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": false, "score": 6, "last_activity_date": 1474181126, "creation_date": 1474181126, "answer_id": 39554918, "question_id": 39551985, "link": "https://stackoverflow.com/questions/39551985/weighted-random-in-golang/39554918#39554918", "title": "Weighted Random in Golang", "body": "<p>The <code>func WeightedChoice(choices []Choice) (Choice, error)</code><br>\nreturns <code>Choice, error</code>, so use <code>result, err := randutil.WeightedChoice(choices)</code>, like this working code:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/jmcvetta/randutil\"\n)\n\nfunc main() {\n    choices := make([]randutil.Choice, 0, 2)\n    choices = append(choices, randutil.Choice{1, \"dg\"})\n    choices = append(choices, randutil.Choice{2, \"n\"})\n    fmt.Println(choices) // [{1 dg} {2 n}]\n\n    result, err := randutil.WeightedChoice(choices)\n    if err != nil {\n        panic(err)\n    }\n\n    fmt.Println(result) //{2 n}\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>[{1 dg} {2 n}]\n{2 n}\n</code></pre>\n"}], "owner": {"reputation": 107, "user_id": 6841997, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2085e3d3760393405ae00257b3f9c24b?s=128&d=identicon&r=PG&f=1", "display_name": "digiadit", "link": "https://stackoverflow.com/users/6841997/digiadit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2338, "favorite_count": 0, "answer_count": 2, "score": 0, "last_activity_date": 1474181247, "creation_date": 1474148244, "last_edit_date": 1474181247, "question_id": 39551985, "link": "https://stackoverflow.com/questions/39551985/weighted-random-in-golang", "title": "Weighted Random in Golang", "body": "<p>I have to do weighted Random in Golang but I'm getting an error:</p>\n\n<pre><code>multiple-value randutil.WeightedChoice() in single-value context\n</code></pre>\n\n<p>Code:</p>\n\n<pre><code>package main\n\nimport \"fmt\"\nimport \"github.com/jmcvetta/randutil\"\n\nfunc main() {    \n    choices := make([]randutil.Choice, 0, 2)    \n    choices = append(choices, randutil.Choice{1, \"dg\"})\n    choices = append(choices, randutil.Choice{2, \"n\"})    \n    result := randutil.WeightedChoice(choices)    \n    fmt.Println(choices)\n}\n</code></pre>\n\n<p>Any help will be deeply appreciated.</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1474148358, "post_id": 39551979, "comment_id": 66415534, "body": "You do not really need a temp variable, you just need a correct type: as the API docs say <a href=\"https://golang.org/pkg/encoding/base64/#Encoding.DecodeString\" rel=\"nofollow noreferrer\">golang.org/pkg/encoding/base64/#Encoding.DecodeString</a> <code>base64.StdEncoding.DecodeString</code> returns a <code>[]byte</code> slice and not a string."}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 1, "creation_date": 1474148479, "post_id": 39551979, "comment_id": 66415563, "body": "right, but I&#39;m trying to make it a pointer for later in the overall program if it&#39;s empty I change it."}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1474148724, "post_id": 39551979, "comment_id": 66415621, "body": "The standard value for a byte slice is nil AFAIK, which is exactly what you are talking about, aren&#39;t you?"}, {"owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1474149937, "post_id": 39551979, "comment_id": 66415861, "body": "I suppose I am confused, I am not understanding, I know it returns a byte but I need a pointer string."}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 1, "creation_date": 1474150265, "post_id": 39551979, "comment_id": 66415934, "body": "First, a string pointer is an antipattern in Go: the <code>string</code> class is lightweight even if it internally points to a massive chunk of data. Second, if you knew it returned a byte slice why did you give it a string pointer. And third, what you need is very subjective and not necessarily a good design: a <code>string</code> pointer is just as unnatural for a URL as is a byte slice -- you probably need a string in reality. Happy you found a solution though."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 1, "creation_date": 1474157637, "post_id": 39551979, "comment_id": 66417311, "body": "@OlegSklyar, a string pointer is the standard and idiomatic way to have a string that one can differentiate between and empty string and a zero value. It&#39;s heavily used in many APIs, I wouldn&#39;t start off calling it an anti-pattern."}, {"owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1474158455, "post_id": 39551979, "comment_id": 66417461, "body": "@JimB &quot;Slices, maps, channels, strings, function values, and interface values are implemented with pointers internally, and a pointer to them is often redundant.&quot; That sounds like a pattern to me and its opposite an anti-pattern. Now the fact that a pattern exists does not mean that there are no wide-spread exceptions. A good developer will consider what is best for the situation. Do you feel this was the case in the above example, is that field really optional to justify a nil pointer?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 2, "creation_date": 1474160242, "post_id": 39551979, "comment_id": 66417736, "body": "@OlegSklyar, if you need to differentiate between an empty string and an unset string, especially when dealing with APIs that require serialization, then yes, a <code>*string</code> is perfectly fine."}, {"owner": {"reputation": 3439, "user_id": 1887281, "user_type": "registered", "accept_rate": 69, "profile_image": "https://i.stack.imgur.com/xV9qF.jpg?s=128&g=1", "display_name": "devinbost", "link": "https://stackoverflow.com/users/1887281/devinbost"}, "reply_to_user": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "edited": false, "score": 0, "creation_date": 1568055532, "post_id": 39551979, "comment_id": 102145730, "body": "@OlegSklyar That&#39;s a big jump to accuse something of being an &quot;anti-pattern&quot; just because the practice is claimed as being &quot;often redundant.&quot; It might be a code-smell, but that&#39;s not enough to call it an anti-pattern."}], "tags": [], "owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "is_accepted": true, "score": 4, "last_activity_date": 1474148200, "creation_date": 1474148200, "answer_id": 39551979, "question_id": 39551687, "link": "https://stackoverflow.com/questions/39551687/cannot-use-dashurl-type-byte-as-type-string-in-assignment/39551979#39551979", "title": "Cannot use &amp;dashUrl (type *[]byte) as type *string in assignment", "body": "<p>Was helped in the gophers slack chat, need to make a temporary variable</p>\n\n<pre><code>blah := string(dashUrl)\nc.DashUrl = &amp;blah\n</code></pre>\n"}], "owner": {"reputation": 1986, "user_id": 4180276, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/f34129a97d735e6e19247c911626cb9a?s=128&d=identicon&r=PG&f=1", "display_name": "nadermx", "link": "https://stackoverflow.com/users/4180276/nadermx"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4221, "favorite_count": 0, "accepted_answer_id": 39551979, "answer_count": 1, "score": 1, "last_activity_date": 1474148200, "creation_date": 1474145978, "question_id": 39551687, "link": "https://stackoverflow.com/questions/39551687/cannot-use-dashurl-type-byte-as-type-string-in-assignment", "title": "Cannot use &amp;dashUrl (type *[]byte) as type *string in assignment", "body": "<p>I'm trying to parse a form post that may be empty and if it is I will change the variable.  Trying to use <code>*string</code> type.  The problem I'm having is it dosen't convert for the <code>dashUrl</code> but does for the <code>start_time</code></p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/base64\"\n    \"strconv\"\n    \"github.com/gocraft/web\"\n)\n\ntype YoutubeContext struct {\n    StartTime *float64 `json:\"start_time\"`\n    DashUrl   *string  `json:\"dash_url\"`\n}\n\nfunc (c *YoutubeContext) SetYoutubeContext(rw web.ResponseWriter, req *web.Request, next web.NextMiddlewareFunc) {\n    if f, err := strconv.ParseFloat(req.FormValue(\"start_time\"), 64); err == nil {\n        c.StartTime = &amp;f\n    }\n    if dashUrl, dashUrlDecodeErr := base64.StdEncoding.DecodeString(req.FormValue(\"dash_url\")); dashUrlDecodeErr == nil {\n        c.DashUrl = &amp;dashUrl\n\n    }\n\n}\nfunc main() {\n\n}\n</code></pre>\n\n<p>the error it shows is this </p>\n\n<p><code>./test.go:19: cannot use &amp;dashUrl (type *[]byte) as type *string in assignment\n</code></p>\n"}, {"tags": ["json", "go", "struct"], "answers": [{"tags": [], "owner": {"reputation": 1376, "user_id": 656610, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/3ef5e887ce37bf71c51bd882d245a7d1?s=128&d=identicon&r=PG", "display_name": "Aleksey Bakin", "link": "https://stackoverflow.com/users/656610/aleksey-bakin"}, "is_accepted": false, "score": 1, "last_activity_date": 1474145510, "last_edit_date": 1474145510, "creation_date": 1474145313, "answer_id": 39551592, "question_id": 39551498, "link": "https://stackoverflow.com/questions/39551498/how-to-deal-with-struct-having-different-json-key-than-json-response/39551592#39551592", "title": "How to deal with Struct having different json key than json response", "body": "<p>At first, struct's field must be start from capital letter to be public. So you need something like that:</p>\n\n<pre><code>type VideoInfo struct {\n    EmbedCode string `json:\"embed_code\"`\n}\n</code></pre>\n\n<p>And look at <a href=\"https://golang.org/pkg/encoding/json/#Marshal\" rel=\"nofollow\">documentation</a> for more info.</p>\n"}, {"comments": [{"owner": {"reputation": 569, "user_id": 5759262, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/10208150398865304/picture?type=large", "display_name": "Sammy Roberts", "link": "https://stackoverflow.com/users/5759262/sammy-roberts"}, "edited": false, "score": 0, "creation_date": 1474148225, "post_id": 39551702, "comment_id": 66415503, "body": "This is what I ended up doing, so im glad you confirmed this was the right way. Thanks so much!"}], "tags": [], "owner": {"reputation": 8303, "user_id": 3165602, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/8b194cca5dcf6906c0911564bfb4166c?s=128&d=identicon&r=PG", "display_name": "Oleg Sklyar", "link": "https://stackoverflow.com/users/3165602/oleg-sklyar"}, "is_accepted": true, "score": 1, "last_activity_date": 1474146078, "creation_date": 1474146078, "answer_id": 39551702, "question_id": 39551498, "link": "https://stackoverflow.com/questions/39551498/how-to-deal-with-struct-having-different-json-key-than-json-response/39551702#39551702", "title": "How to deal with Struct having different json key than json response", "body": "<p>With respect to remapping the field names use the corresponding annotation in the structure declaration:</p>\n\n<pre><code>type VideoInfo struct {\n    EmbedCode string `json:\"embed_code\"`\n}\n</code></pre>\n\n<p>The marshaller/un-marshaller will only process public field, so you need to capitalise the field name.</p>\n\n<p>With respect to converting the whole structure, yes it is easy. Declare an instance to un-marshal into and pass a reference to the <code>json.Unmarshal</code> method (from a test):</p>\n\n<pre><code>data, _ := json.Marshal(request)\n\nvar resp response.VideoInfo\nif err := json.Unmarshal(data, &amp;resp); err != nil {\n    t.Errorf(\"unexpected error, %v\", err)\n}\n</code></pre>\n"}], "owner": {"reputation": 569, "user_id": 5759262, "user_type": "registered", "accept_rate": 65, "profile_image": "https://graph.facebook.com/10208150398865304/picture?type=large", "display_name": "Sammy Roberts", "link": "https://stackoverflow.com/users/5759262/sammy-roberts"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 33, "favorite_count": 0, "accepted_answer_id": 39551702, "answer_count": 2, "score": 0, "last_activity_date": 1474146078, "creation_date": 1474144672, "last_edit_date": 1474145749, "question_id": 39551498, "link": "https://stackoverflow.com/questions/39551498/how-to-deal-with-struct-having-different-json-key-than-json-response", "title": "How to deal with Struct having different json key than json response", "body": "<p>I have a struct <code>VideoInfo</code> that has a key in it called <code>embedCode</code>. The API I am querying returns the embed code as <code>embed_code</code>. During unmarshalling the response how do I ensure <code>embed_code</code> goes into <code>embedCode</code>?</p>\n\n<p>Also is there an easy way to take a large json string and automatically turn it into a struct, or can one only use a map?</p>\n"}, {"tags": ["go", "go-gorm", "go-gin"], "answers": [{"comments": [{"owner": {"reputation": 260, "user_id": 4083771, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y1Vpo.jpg?s=128&g=1", "display_name": "Kendrick johnson", "link": "https://stackoverflow.com/users/4083771/kendrick-johnson"}, "edited": false, "score": 0, "creation_date": 1474209705, "post_id": 39550514, "comment_id": 66428271, "body": "Thank you for your reply.I changed the code but <code>has, _ := db.Raw(&quot;select * from users&quot;).Scan(&amp;users)</code>  returns <code>assignment count mismatch: 2 = 1</code> error."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user5627355"}, "is_accepted": false, "score": 1, "last_activity_date": 1474138077, "creation_date": 1474138077, "answer_id": 39550514, "question_id": 39550457, "link": "https://stackoverflow.com/questions/39550457/go-build-error-db-getusers-undefined-type-gorm-db-has-no-field-or-method-getu/39550514#39550514", "title": "go build error &quot;db.GetUsers undefined (type *gorm.DB has no field or method GetUsers)&quot;", "body": "<p>If I see in your code I don't see GetUsers function\ndb this *gorm.DB and not have GetUsers\nYou need like this\n<code>\n db..Raw(\"select * from users\").Scan(&amp;users)\n</code></p>\n"}, {"comments": [{"owner": {"reputation": 260, "user_id": 4083771, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y1Vpo.jpg?s=128&g=1", "display_name": "Kendrick johnson", "link": "https://stackoverflow.com/users/4083771/kendrick-johnson"}, "edited": false, "score": 0, "creation_date": 1474262446, "post_id": 39564010, "comment_id": 66442086, "body": "Thank you for the comment Jingchao.Sorry for the lack of explanation.I have <code>GetUsers</code> function in <code>controllers&#47;user.go</code>.I imported <code>models</code> package in controller."}, {"owner": {"reputation": 51, "user_id": 5429118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fedca6c45741c78545c57ec4d8b02eec?s=128&d=identicon&r=PG", "display_name": "Jingchao Chen", "link": "https://stackoverflow.com/users/5429118/jingchao-chen"}, "reply_to_user": {"reputation": 260, "user_id": 4083771, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y1Vpo.jpg?s=128&g=1", "display_name": "Kendrick johnson", "link": "https://stackoverflow.com/users/4083771/kendrick-johnson"}, "edited": false, "score": 0, "creation_date": 1474350028, "post_id": 39564010, "comment_id": 66482422, "body": "Ok, that&#39;s because you implemented <code>GetUsers</code> for the struct <code>User</code> in package <code>controller</code>, but in your code you are doing <code>db.GetUsers(&amp;users)</code>, where <code>db</code> is of type <code>*gorm.DB</code>. <code>*DB</code> in <code>github.com&#47;jinzhu&#47;gorm</code> itself does not implement function <code>GetUsers</code>."}], "tags": [], "owner": {"reputation": 51, "user_id": 5429118, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fedca6c45741c78545c57ec4d8b02eec?s=128&d=identicon&r=PG", "display_name": "Jingchao Chen", "link": "https://stackoverflow.com/users/5429118/jingchao-chen"}, "is_accepted": true, "score": 1, "last_activity_date": 1474352683, "last_edit_date": 1474352683, "creation_date": 1474246406, "answer_id": 39564010, "question_id": 39550457, "link": "https://stackoverflow.com/questions/39550457/go-build-error-db-getusers-undefined-type-gorm-db-has-no-field-or-method-getu/39564010#39564010", "title": "go build error &quot;db.GetUsers undefined (type *gorm.DB has no field or method GetUsers)&quot;", "body": "<p>Tried to comment back to your question under Sergey's answer above, but I don't have the privilege since I'm new here. </p>\n\n<p>As Sergey said, I cannot see GetUsers function in <code>gorm.DB</code> struct. If you do <code>db.Raw(\"select * from users\").Scan(&amp;users)</code>, you cannot (don't need to either) assign two variables to the statement. Instead, just:</p>\n\n<pre><code>db.Raw(\"select * from users\").Scan(&amp;users)\n</code></pre>\n\n<p>This is because DB.Scan() returns only one result variable in your DB implementation:</p>\n\n<pre><code>// Scan scan value to a struct\nfunc (s *DB) Scan(dest interface{}) *DB {\n    return s.clone().NewScope(s.Value).Set(\"gorm:query_destination\",dest).callCallbacks(s.parent.callbacks.queries).db\n}\n</code></pre>\n\n<h2>Updated answer after more context was added to the question:</h2>\n\n<p>That is because you didn't actually implement <code>GetUsers</code> for <code>gorm.DB</code>. What you did was - define a struct in <code>controllers</code> package named <code>User</code>, and attach a <code>GetUsers</code> method to that struct. Inside <code>controllers/User.GetUsers</code> you called <code>repo.GetUsers</code> which internally tries to call <code>db.GetUsers</code>. <code>db</code> is of type <code>*gorm.DB</code> which does not have <code>GetUsers</code> method defined.</p>\n\n<p>One way to fix is as Sergey suggested, just do <code>db.Raw(...).Scan(...)</code>.</p>\n\n<p>If you really want to encapsulate gorm.DB and makes <code>GetUsers</code> look more native from the db connection, one thing you can try is:</p>\n\n<pre><code>type MyDB struct {\n    gorm.DB\n}\nfunc (m *MyDB) GetUsers() []*Users {\n    // do things like m.Raw(...).Scan(...)\n}\n</code></pre>\n\n<p>And in your models, you declare <code>db</code> as type <code>*MyDB</code> instead of <code>*gorm.DB</code>.</p>\n\n<p>For more official docs about this embedding technique, checkout <a href=\"https://golang.org/doc/effective_go.html#embedding\" rel=\"nofollow\">https://golang.org/doc/effective_go.html#embedding</a></p>\n"}], "owner": {"reputation": 260, "user_id": 4083771, "user_type": "registered", "accept_rate": 71, "profile_image": "https://i.stack.imgur.com/y1Vpo.jpg?s=128&g=1", "display_name": "Kendrick johnson", "link": "https://stackoverflow.com/users/4083771/kendrick-johnson"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3858, "favorite_count": 0, "accepted_answer_id": 39564010, "answer_count": 2, "score": 0, "last_activity_date": 1489463166, "creation_date": 1474137759, "last_edit_date": 1489463166, "question_id": 39550457, "link": "https://stackoverflow.com/questions/39550457/go-build-error-db-getusers-undefined-type-gorm-db-has-no-field-or-method-getu", "title": "go build error &quot;db.GetUsers undefined (type *gorm.DB has no field or method GetUsers)&quot;", "body": "<p>I am new to golang and trying to make API server using gin + gorm.<br>\nI tried to build the code below but I am getting <code>type *gorm.DB has no field or method GetUsers</code> error.<br>\nThis is a very simple API server and only I want to do is get all users from <code>users</code> table.</p>\n\n<pre><code>package models\n\nimport (\n    \"github.com/jinzhu/gorm\"\n    _ \"github.com/jinzhu/gorm/dialects/postgres\"\n)\n\nvar db *gorm.DB\n\nfunc init() {\n    var err error\n    db, err = gorm.Open(\"postgres\", \"host=localhost dbname=test user=postgres password=test sslmode=disable\")\n    if err != nil {\n        return err\n    }\n}\n\ntype User struct {\n   ID           int    `json:\"id\"`\n   Username     string `json:\"name\"`\n}\n\nfunc NewUser(id int, name string) User {\n    return User{\n      ID:           id,\n      Username:     name,\n    }\n}\n\n// UserRepository\ntype UserRepository struct {\n}\n\nfunc NewUserRepository() UserRepository {\n    return UserRepository{}\n}\n\nfunc (m UserRepository) GetUsers() []*User {\n    var users []*User\n    has, _ := db.GetUsers(&amp;users)\n    if has {\n         return users\n    }\n    return nil\n}\n</code></pre>\n\n<p>I implemented <code>GetUsers()</code> in <code>controllers/user.go</code>and I also created <code>users</code> table.<br>I have no idea why it says <code>no field or method GetUsers</code>.Someone give me an advice to solve this.</p>\n\n<pre><code>package controllers\n\nimport (\n     \"api-server/models\"\n)\n\ntype User struct {\n}\n\nfunc NewUser() User {\n     return User{}\n}\n\nfunc (c User) GetUsers() interface{} {\n     repo := models.NewUserRepository()\n     user := repo.GetUsers()\n     return user\n}\n</code></pre>\n"}, {"tags": ["go", "bazaar"], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 4, "last_activity_date": 1474140853, "creation_date": 1474140853, "answer_id": 39550936, "question_id": 39550209, "link": "https://stackoverflow.com/questions/39550209/what-is-a-exe-extension/39550936#39550936", "title": "What is a .exe~ extension?", "body": "<p>In my experience with Go on Windows, the <code>go build</code> command will create an <code>.exe~</code> shadow file because of:</p>\n\n<ol>\n<li>You previously build the runtime and created an .exe.</li>\n<li>You already started/executed the binary.</li>\n<li>That previous execution <em>is still running</em> or some other stupid file lock by windows has occurred.</li>\n<li>You attempt to <code>go build</code> again, while the previous binary was still in use.</li>\n</ol>\n\n<p>What happens under the hood is the <code>go build</code> will rename the existing executed .exe to .exe~ while it is in use, and will place the new binary at .exe for the next execution.</p>\n\n<p>I have always been fascinated by how it does that to files in use, when 20+ years of all other Windows apps returns the dreaded \"File In Use\" error.</p>\n\n<p>My best guess is that when you execute a go binary, the execution does not place a file lock on the file.  So the next build can simply rename the in use one.</p>\n\n<p>During my tests (2014) that new .exe was the latest version and the .exe~ was the previous version that was running.</p>\n\n<p>I did a lot of testing around this as my use case purposely replaced the existing binary upon recompiling.</p>\n"}], "owner": {"reputation": 1531, "user_id": 4645236, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/QVYcq.jpg?s=128&g=1", "display_name": "hellyale", "link": "https://stackoverflow.com/users/4645236/hellyale"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 84, "favorite_count": 0, "accepted_answer_id": 39550936, "answer_count": 1, "score": 2, "last_activity_date": 1474140853, "creation_date": 1474136245, "question_id": 39550209, "link": "https://stackoverflow.com/questions/39550209/what-is-a-exe-extension", "title": "What is a .exe~ extension?", "body": "<p>I noticed that <code>go build</code> is now creating a <code>.exe</code> and a <code>.exe~</code> </p>\n\n<p>I've googled and found nothing, this only started happening after one of the bazaar libraries was used as a dependency to a package I am using. </p>\n\n<p>Do I need the <code>.exe~</code> for anything? Can I delete it? </p>\n"}, {"tags": ["mongodb", "go", "mgo"], "comments": [{"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1474213115, "post_id": 39549996, "comment_id": 66429356, "body": "Can you try replacing <code>All</code> with <a href=\"https://godoc.org/gopkg.in/mgo.v2#Query.Explain\" rel=\"nofollow noreferrer\">explain</a> to see exactly what mongo query is being executed."}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1474267036, "post_id": 39549996, "comment_id": 66443806, "body": "after a bit of indenting, if you look at <code>executionStats.nReturned</code> the value is 1, so I&#39;d consider cross checking this by using <a href=\"https://godoc.org/gopkg.in/mgo.v2#Query.Count\" rel=\"nofollow noreferrer\">Count</a> in place of <code>All</code> to check if it returned 3 or 1."}, {"owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "reply_to_user": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1474290700, "post_id": 39549996, "comment_id": 66457831, "body": "@algrebe Wow thank you! After thinking I had gone crazy because count was equal to 1 but when I was checking my api calls it had all the events I realized I had a bug somewhere in my code that ended up calling get all events and returning that"}, {"owner": {"reputation": 1426, "user_id": 1520594, "user_type": "registered", "accept_rate": 71, "profile_image": "https://www.gravatar.com/avatar/b1fcaa128750715b5631f1c2c109e4eb?s=128&d=identicon&r=PG", "display_name": "algrebe", "link": "https://stackoverflow.com/users/1520594/algrebe"}, "edited": false, "score": 0, "creation_date": 1474291031, "post_id": 39549996, "comment_id": 66458051, "body": "no problem. I&#39;m not sure how to frame an answer for this though. You probably know best."}], "owner": {"reputation": 2479, "user_id": 3666882, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/4d6c91065605fbddcd17db1556134b37?s=128&d=identicon&r=PG&f=1", "display_name": "Rodrigo", "link": "https://stackoverflow.com/users/3666882/rodrigo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 2542, "favorite_count": 0, "answer_count": 0, "score": 3, "last_activity_date": 1474271996, "creation_date": 1474134826, "last_edit_date": 1474271996, "question_id": 39549996, "link": "https://stackoverflow.com/questions/39549996/golang-mgo-getting-greater-than-and-less-than-timestamps", "title": "Golang mgo getting greater than and less than timestamps", "body": "<p>I'm trying to query a timestamp that is between two other timestamps. I've got this simple function:</p>\n\n<pre><code>func (e *EventService) GetEmployeeEventsBetween(employeeID string, start, end int64) ([]Event, error) {\n    var retrivedEvents []Event\n    if err := e.c().Find(bson.M{\n        \"employee\": employeeID,\n        \"start\":    bson.M{\"$gte\": start, \"$lte\": end},\n    }).All(&amp;retrivedEvents); err != nil {\n        return nil, err\n    }\n\n    return retrivedEvents, nil\n}\n</code></pre>\n\n<p>Now according to that function the query should only return <code>\"events\"</code> that start date timestamp is greater than the <code>start</code> timestamp passed in and less than the <code>end</code> timestamp passed in.</p>\n\n<p>However let's say the db has 3 events each with these start dates:</p>\n\n<p><code>1474290000</code> \n<code>1474389000</code>\n<code>1474463700</code></p>\n\n<p>Now lets say I pass in a <code>start</code> param of <code>1474462800</code> and <code>end</code> param of <code>1474491600</code> I would expect that function would only return 1 <code>\"event\"</code> which would be the one with the <code>1474463700</code> timestamp however it returns all of them. Pretty much no matter what I pass in as my <code>start</code> and <code>end</code> params it returns all the items in the db</p>\n\n<p><strong>UPDATE</strong>:</p>\n\n<p>If I log <code>.Explain()</code> this is what I get back</p>\n\n<pre><code>bson.M{\n    \"queryPlanner\": bson.M{\n    \"plannerVersion\":1, \n    \"namespace\":\"hairbuddy.events\", \n    \"indexFilterSet\":false, \n    \"parsedQuery\": bson.M{\n        \"$and\":[]interface {}{\n            bson.M{\n                \"employee\": bson.M{\"$eq\":\"57c36bdfe5b07e10ae5526ee\"}\n            }, \n            bson.M{\n                \"start\":bson.M{\"$lte\":1474491600}\n            }, \n            bson.M{\n                \"start\": bson.M{\"$gte\":1474462800}\n            }\n        }\n    }, \n    \"winningPlan\": bson.M{\n        \"inputStage\": bson.M{\n            \"stage\":\"COLLSCAN\", \n            \"filter\": bson.M{\n                \"$and\":[]interface {}{\n                    bson.M{\n                        \"employee\": bson.M{\"$eq\":\"57c36bdfe5b07e10ae5526ee\"}\n                    }, \n                    bson.M{\n                        \"start\": bson.M{\"$lte\":1474491600}\n                    }, \n                    bson.M{\n                        \"start\":bson.M{\"$gte\":1474462800}\n                    }\n                }\n            }, \n            \"direction\":\"forward\"\n        }, \n        \"stage\":\"LIMIT\", \n        \"limitAmount\":40\n    }, \n    \"rejectedPlans\":[]interface {}{}\n    }, \n    \"executionStats\": bson.M{\n        \"totalDocsExamined\":3, \n        \"executionStages\": bson.M{\n            \"restoreState\":0, \n            \"isEOF\":1, \n            \"invalidates\":0, \n            \"inputStage\": bson.M{\n                \"restoreState\":0,\n                \"direction\":\"forward\", \n                \"stage\":\"COLLSCAN\", \n                \"executionTimeMillisEstimate\":0, \n                \"works\":5, \n                \"needYield\":0, \n                \"nReturned\":1, \n                \"advanced\":1, \"isEOF\":1, \n                \"docsExamined\":3, \n                \"filter\": bson.M{\n                    \"$and\":[]interface {}{\n                        bson.M{\n                            \"employee\": bson.M{\"$eq\":\"57c36bdfe5b07e10ae5526ee\"}\n                        }, \n                        bson.M{\n                            \"start\": bson.M{\"$lte\":1474491600}\n                        }, \n                        bson.M{\n                            \"start\": bson.M{\"$gte\":1474462800}\n                        }\n                    }\n                }, \n                \"needTime\":3, \n                \"saveState\":0, \n                \"invalidates\":0\n            }, \n            \"stage\":\"LIMIT\", \n            \"advanced\":1, \n            \"needYield\":0, \n            \"saveState\":0, \n            \"limitAmount\":40, \n            \"nReturned\":1, \n            \"executionTimeMillisEstimate\":0, \n            \"works\":5, \n            \"needTime\":3\n        }, \n        \"allPlansExecution\":[]interface {}{}, \n        \"executionSuccess\":true, \n        \"nReturned\":1, \n        \"executionTimeMillis\":0, \n        \"totalKeysExamined\":0\n    }, \n    \"serverInfo\": bson.M{\n        \"version\":\"3.2.7\", \n        \"gitVersion\":\"4249c1d2b5999ebbf1fdf3bc0e0e3b3ff5c0aaf2\", \n        \"host\":\"rodrigos-MacBook-Pro.local\", \n        \"port\":27017\n    }, \n    \"ok\":1,\n}\n</code></pre>\n"}, {"tags": ["go", "package", "global-variables"], "answers": [{"comments": [{"owner": {"reputation": 163, "user_id": 5253536, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh6.googleusercontent.com/-1-_ML3iG1Yw/AAAAAAAAAAI/AAAAAAAAABI/G_t-YKqspMQ/photo.jpg?sz=128", "display_name": "Patryk Gtfo", "link": "https://stackoverflow.com/users/5253536/patryk-gtfo"}, "edited": false, "score": 1, "creation_date": 1474134036, "post_id": 39549825, "comment_id": 66411627, "body": "I wrote that wants a global variable in the controller? I Need in main package."}, {"owner": {"reputation": 622, "user_id": 8403046, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/231b786ac1af19c96f479c45bbae1712?s=128&d=identicon&r=PG&f=1", "display_name": "Morris", "link": "https://stackoverflow.com/users/8403046/morris"}, "reply_to_user": {"reputation": 163, "user_id": 5253536, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh6.googleusercontent.com/-1-_ML3iG1Yw/AAAAAAAAAAI/AAAAAAAAABI/G_t-YKqspMQ/photo.jpg?sz=128", "display_name": "Patryk Gtfo", "link": "https://stackoverflow.com/users/5253536/patryk-gtfo"}, "edited": false, "score": 0, "creation_date": 1565423169, "post_id": 39549825, "comment_id": 101357262, "body": "@PatrykGtfo You need to add another package (let&#39;s call it x here), and put some global variables in there to be exported. When other packages need these variables, just import this package x."}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": false, "score": 3, "last_activity_date": 1604686500, "last_edit_date": 1604686500, "creation_date": 1474133735, "answer_id": 39549825, "question_id": 39549775, "link": "https://stackoverflow.com/questions/39549775/how-to-access-variables-in-other-package/39549825#39549825", "title": "How to access variables in other package", "body": "<p>Like you want to have a globally accessible variable in your package <code>controllers</code>?:</p>\n<pre><code>package controllers\n\nvar Something string\nvar SomethingElse string = &quot;whatever&quot;\n\nfunc init(){ \n    Something = &quot;some text&quot; \n}\n</code></pre>\n<p>And then you can do</p>\n<pre><code>package main\nimport (\n    &quot;myapp/controllers&quot;\n    &quot;fmt&quot;\n)\n\nfunc main(){ \n    fmt.Println(controllers.Something, controllers.SomethingElse) //some text\n}\n</code></pre>\n"}], "owner": {"reputation": 163, "user_id": 5253536, "user_type": "registered", "accept_rate": 22, "profile_image": "https://lh6.googleusercontent.com/-1-_ML3iG1Yw/AAAAAAAAAAI/AAAAAAAAABI/G_t-YKqspMQ/photo.jpg?sz=128", "display_name": "Patryk Gtfo", "link": "https://stackoverflow.com/users/5253536/patryk-gtfo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4840, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1604686500, "creation_date": 1474133374, "last_edit_date": 1568963632, "question_id": 39549775, "link": "https://stackoverflow.com/questions/39549775/how-to-access-variables-in-other-package", "title": "How to access variables in other package", "body": "<p>How can I move my global variable to other package in Go?</p>\n\n<p>like </p>\n\n<pre><code>package main\nimport \"myapp/controllers\"\n\nvar something string\n\nfunc main(){ \n  something = \"some text\" \n}\n</code></pre>\n"}, {"tags": ["pointers", "dictionary", "methods", "go", "hashmap"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1474126351, "post_id": 39547968, "comment_id": 66409231, "body": "To put it succinctly, map values are not addressable."}, {"owner": {"reputation": 293, "user_id": 3679391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0bb33f16a5ef2a8865ba9eb80b29ce9d?s=128&d=identicon&r=PG&f=1", "display_name": "whitewalker", "link": "https://stackoverflow.com/users/3679391/whitewalker"}, "edited": false, "score": 0, "creation_date": 1474132531, "post_id": 39547968, "comment_id": 66411163, "body": "Yeah, read the link mentioned. Somehow didn&#39;t find the question before posting (don&#39;t know if i should delete it). Thanks though"}], "owner": {"reputation": 293, "user_id": 3679391, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/0bb33f16a5ef2a8865ba9eb80b29ce9d?s=128&d=identicon&r=PG&f=1", "display_name": "whitewalker", "link": "https://stackoverflow.com/users/3679391/whitewalker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1794, "favorite_count": 1, "closed_date": 1474146751, "answer_count": 0, "score": 0, "last_activity_date": 1474122782, "creation_date": 1474122782, "question_id": 39547968, "link": "https://stackoverflow.com/questions/39547968/cannot-call-pointer-method-on-and-cannot-take-address-of-maps-golang", "closed_reason": "Duplicate", "title": "Cannot Call pointer method on and Cannot take address of [maps golang]", "body": "<p>I have a function <code>GetMySqlConn(variable bool) (db gorm.DB) {..</code> which returns the <code>gorm.DB</code> for mySQL connection. </p>\n\n<p><em>Case 1</em> : My code looks like this:</p>\n\n<pre><code>var (\n    MysqlConn         gorm.DB\n)\n\nfunc main(){\n\n    MysqlConn = GetMySqlConn(false)\n\n    result := MysqlConn.Raw(sqlQuery).Row()\n    result.Scan(&amp;id)\n    fmt.Println(id)\n    :\n}\n</code></pre>\n\n<p><strong>Which works fine. BUT</strong> </p>\n\n<p><em>Case 2</em>: When i try to convert <code>MysqlConn</code> to a map :</p>\n\n<pre><code>var (\n        MysqlConn         map[int]gorm.DB\n    )\n\nfunc main(){\n\n    MysqlConn = make(map[int]gorm.DB)\n    MysqlConn[0] = GetMySqlConn(false)\n\n    // AND THEN DO THIS\n    result := MysqlConn[0].Raw(sqlQuery).Row()\n    result.Scan(&amp;id)\n    fmt.Println(id)\n    :\n}\n</code></pre>\n\n<p><strong>It throws me the error</strong></p>\n\n<pre><code>:\ncannot call pointer method on MysqlConn[0]\ncannot take the address of MysqlConn[0]\n:\n</code></pre>\n\n<p><strong>Now</strong></p>\n\n<p><em>Case 3</em> : Considering the error, I try to get its workaround and change my code to this:</p>\n\n<pre><code>var (\n        MysqlConn         map[int]*gorm.DB\n        tempMysqlConn     gorm.DB\n    )\n\nfunc main(){\n\n    MysqlConn = make(map[int]*gorm.DB)\n    tempMysqlConn = GetMySqlConn(false)\n    MysqlConn[0] = &amp;tempMysqlConn\n\n    // AND THEN DO THIS\n    result := MysqlConn[0].Raw(sqlQuery).Row()\n    result.Scan(&amp;id)\n    fmt.Println(id)\n    :\n}\n</code></pre>\n\n<p><strong>IT WORKS</strong></p>\n\n<p>Now since i'm new to Golang i'm not exactly getting what's the reason for the error even though i somehow got to the solution. </p>\n\n<p>So what i want to ask is when i access the <code>method</code> of <code>gorm.DB</code> structure through a simple <code>gorm.DB</code> type variable <code>MysqlConn</code> (in Case 1), it works.</p>\n\n<p>BUT when i DO THE SAME in Case 2 but now with a map ( again having the same <code>gorm.DB</code> type value) it DOESN'T WORK and throws me the error and i've to <code>convert</code> its value type to a <code>pointer</code> first (i.e <code>*gorm.DB</code>) (Case 3).</p>\n\n<p>So why with Map values do i have to create a pointer type to access the <code>method</code> where it's possible without the pointer type if you do it with a simple variable?</p>\n"}, {"tags": ["ssl", "go", "https", "http2", "sslhandshakeexception"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1474119635, "post_id": 39547459, "comment_id": 66407249, "body": "if these clients aren&#39;t yours, just ignore them. Poorly behaving clients, timeouts, and disconnects on the Internet are nothing new or unexpected."}], "answers": [{"comments": [{"owner": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "edited": false, "score": 0, "creation_date": 1474130730, "post_id": 39548866, "comment_id": 66410580, "body": "Frederik, thanks for your valuable explanation. Considering that all these requests are coming from mobile browsers (on Android and iOS devices), do you see some specific reasons for this? Many thanks"}, {"owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "reply_to_user": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "edited": false, "score": 0, "creation_date": 1474130808, "post_id": 39548866, "comment_id": 66410604, "body": "Yes, mobile connections tend to have higher RTTs, lower bandwidth and see more packet loss."}, {"owner": {"reputation": 181, "user_id": 8724219, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-6MiMyPWiyTw/AAAAAAAAAAI/AAAAAAAAAAc/5J-z99V9H8E/photo.jpg?sz=128", "display_name": "Karan", "link": "https://stackoverflow.com/users/8724219/karan"}, "edited": false, "score": 0, "creation_date": 1560302218, "post_id": 39548866, "comment_id": 99688229, "body": "Have seen these errors pop up more often when the user&#39;s internet connection is too slow and the app build is too big."}], "tags": [], "owner": {"reputation": 3753, "user_id": 451641, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/811b28e7b085e2e493fd32c5913a1ae8?s=128&d=identicon&r=PG", "display_name": "Frederik Deweerdt", "link": "https://stackoverflow.com/users/451641/frederik-deweerdt"}, "is_accepted": false, "score": 12, "last_activity_date": 1474128101, "creation_date": 1474128101, "answer_id": 39548866, "question_id": 39547459, "link": "https://stackoverflow.com/questions/39547459/golang-http2-and-tls-handshake-errors/39548866#39548866", "title": "Golang: http2 and TLS handshake errors", "body": "<pre><code>http2: server: error reading preface from client 79.49.31.60:37993: timeout waiting for client preface\n</code></pre>\n\n<p>This means that the client failed to send the http2 connection preface (<a href=\"https://tools.ietf.org/html/rfc7540#section-3.5\" rel=\"noreferrer\">https://tools.ietf.org/html/rfc7540#section-3.5</a>) before the server timed out.</p>\n\n<pre><code>http: TLS handshake error from 151.38.29.250:44235: EOF\n</code></pre>\n\n<p>This means that while the server and the client were performing the TLS handshake, the server saw the connection being closed, aka EOF.</p>\n\n<pre><code>http: TLS handshake error from 2.239.197.163:6742: read tcp x.xxx.xxx.xxx:443-&gt;2.239.197.163:6742: i/o timeout\n</code></pre>\n\n<p>This means that while the server was waiting to read from the client during the TLS handshake, the client didn't send anything before closing the connection.</p>\n\n<p>As @JimB pointed out, those are perfectly normal to see. If you think the timeouts are kicking in too soon, you can define custom ones by defining a custom <code>net.http.Transport</code>: <a href=\"https://golang.org/pkg/net/http/#Transport\" rel=\"noreferrer\">https://golang.org/pkg/net/http/#Transport</a>, and set higher values for timeouts.</p>\n"}], "owner": {"reputation": 16583, "user_id": 913867, "user_type": "registered", "accept_rate": 51, "profile_image": "https://i.stack.imgur.com/hUicX.jpg?s=128&g=1", "display_name": "Daniele B", "link": "https://stackoverflow.com/users/913867/daniele-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 8746, "favorite_count": 4, "answer_count": 1, "score": 16, "last_activity_date": 1474130414, "creation_date": 1474119449, "last_edit_date": 1474130414, "question_id": 39547459, "link": "https://stackoverflow.com/questions/39547459/golang-http2-and-tls-handshake-errors", "title": "Golang: http2 and TLS handshake errors", "body": "<p>I have a Go application with both http (on port 80) and https (on port 443) enabled.</p>\n\n<p>I keep getting lots of these 3 kinds of error:</p>\n\n<ul>\n<li><p><code>http2: server: error reading preface from client 79.49.31.60:37993: timeout waiting for client preface</code></p></li>\n<li><p><code>http: TLS handshake error from 151.38.29.250:44235: EOF</code></p></li>\n<li><p><code>http: TLS handshake error from 2.239.197.163:6742: read tcp x.xxx.xxx.xxx:443-&gt;2.239.197.163:6742: i/o timeout</code></p></li>\n</ul>\n\n<p>can anyone explain what these refer to?</p>\n\n<p>Note that: all these requests are coming from mobile browsers (on Android and iOS devices)</p>\n"}, {"tags": ["templates", "go", "pongo2"], "comments": [{"owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1474167943, "post_id": 39546834, "comment_id": 66418755, "body": "Your function needs to have the signature <code>func(in *pongo2.Value, param *pongo2.Value) (out *pongo2.Value, err *pongo2.Error)</code>"}, {"owner": {"reputation": 3409, "user_id": 2310989, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/034bf2e2ba137b4b6db19cea989150d1?s=128&d=identicon&r=PG", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/2310989/gaurav-pant"}, "reply_to_user": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "edited": false, "score": 0, "creation_date": 1474168487, "post_id": 39546834, "comment_id": 66418822, "body": "@jcdwlkr- I read the document but I am unable to make a usecase or real working code. If you could give a sample it will be of great help."}], "answers": [{"tags": [], "owner": {"reputation": 6501, "user_id": 859353, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/0ee0ed1d5c1b450c2c76651dd62f38c4?s=128&d=identicon&r=PG", "display_name": "jcbwlkr", "link": "https://stackoverflow.com/users/859353/jcbwlkr"}, "is_accepted": false, "score": 3, "last_activity_date": 1487176753, "last_edit_date": 1487176753, "creation_date": 1474169554, "answer_id": 39553802, "question_id": 39546834, "link": "https://stackoverflow.com/questions/39546834/how-to-call-go-function-from-pongo-template/39553802#39553802", "title": "How to call Go function from pongo template", "body": "<p>The problem is that your filter function does not accept or return the right types to match what pongo2 is requiring. Let's walk through the docs and see what they want.</p>\n\n<p>First, take a look at the godoc for <code>RegisterFilterFunction</code>. It says</p>\n\n<pre><code>func RegisterFilter(name string, fn FilterFunction)\n</code></pre>\n\n<p>This is in the <code>pongo2</code> package so you should read this as <code>RegisterFilter</code> is a function that accepts two arguments and returns no values. The first argument <code>name</code> is of the builtin type <code>string</code> and the second argument <code>fn</code> is of the type <code>pongo2.FilterFunction</code>. But what is a <code>pongo2.FilterFunction</code>? Well clicking on it we see further down in the doc</p>\n\n<pre><code>type FilterFunction func(in *Value, param *Value) (out *Value, err *Error)\n</code></pre>\n\n<p>In Go you can make your own types based on any other types including functions. So what pongo2 has done is to create a named type called <code>FilterFunction</code> that is any func which accepts two arguments (both of type <code>*pongo2.Value</code>) and returns two values (one of type <code>*pongo2.value</code> and one of type <code>*pongo2.Error</code>).</p>\n\n<p>To bring it all together we would do something like this:    </p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"strings\"\n\n    \"github.com/flosch/pongo2\"\n)\n\nfunc init() {\n    pongo2.RegisterFilter(\"scream\", Scream)\n}\n\n// Scream is a silly example of a filter function that upper cases strings\nfunc Scream(in *pongo2.Value, param *pongo2.Value) (out *pongo2.Value, err *pongo2.Error) {\n    if !in.IsString() {\n        return nil, &amp;pongo2.Error{\n            ErrorMsg: \"only strings should be sent to the scream filter\",\n        }\n    }\n\n    s := in.String()\n    s = strings.ToUpper(s)\n\n    return pongo2.AsValue(s), nil\n}\n\nfunc main() {\n    tpl, err := pongo2.FromString(\"Hello {{ name|scream }}!\")\n    if err != nil {\n        log.Fatal(err)\n    }\n    // Now you can render the template with the given\n    // pongo2.Context how often you want to.\n    out, err := tpl.Execute(pongo2.Context{\"name\": \"stack overflow\"})\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(out) // Output: Hello STACK OVERFLOW!\n}\n</code></pre>\n"}], "owner": {"reputation": 3409, "user_id": 2310989, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/034bf2e2ba137b4b6db19cea989150d1?s=128&d=identicon&r=PG", "display_name": "Gaurav Pant", "link": "https://stackoverflow.com/users/2310989/gaurav-pant"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1278, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1554132246, "creation_date": 1474115405, "last_edit_date": 1554132246, "question_id": 39546834, "link": "https://stackoverflow.com/questions/39546834/how-to-call-go-function-from-pongo-template", "title": "How to call Go function from pongo template", "body": "<p>I need to create JSON data using few keys of map and need to incorporate into html generated. I am using pongo2 library and want to write custom filter to achieve the same.</p>\n\n<pre><code>&lt;script&gt; {{ CategoryMapping|MycustomFilter }} &lt;/script&gt;\n</code></pre>\n\n<p>and coded custom filter like below.</p>\n\n<pre><code>func init() {\n\n    pongo2.RegisterFilter(\"superfilter\", GetCategoryJsonData)\n\n\n}\n\nfunc GetCategoryJsonData(CatAttributeMapping *map[string]interface{}, param *int) (*string, *error) {\n.....\n}\n</code></pre>\n\n<p>But I am getting below error.</p>\n\n<pre><code>src/util/TemplateFilters.go:10: cannot use GetCategoryJsonData (type func(*int, *int) (*string, *error)) as type pongo2.FilterFunction in argument to pongo2.RegisterFilter\n</code></pre>\n\n<p>I am following below documentation - <a href=\"https://godoc.org/github.com/flosch/pongo2#FilterFunction\" rel=\"nofollow\">https://godoc.org/github.com/flosch/pongo2#FilterFunction</a></p>\n\n<p>I am new to go and unable to understand what wrong I am doing here. Please guide me for the same.</p>\n"}, {"tags": ["pointers", "for-loop", "go", "goroutine"], "answers": [{"tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user6169399"}, "is_accepted": true, "score": 7, "last_activity_date": 1474130458, "last_edit_date": 1474130458, "creation_date": 1474116314, "answer_id": 39546972, "question_id": 39546804, "link": "https://stackoverflow.com/questions/39546804/differences-between-pointer-and-value-slice-in-for-range-loop/39546972#39546972", "title": "differences between pointer and value slice in for-range loop", "body": "<p>A: The parameters are evaluated before the function is called. After they are evaluated, the parameters of the call are passed by value to the function and the called function begins execution, so:</p>\n\n<p>The first <code>go v.print()</code> is syntactic sugar for <code>go (*field).print(&amp;v)</code> and<br>\nthe second <code>go v.print()</code> is syntactic sugar for <code>go (*field).print(v)</code>.</p>\n\n<p>If first <code>for</code> loop finishes before goroutines start, <code>&amp;v</code> is same for the calls and these three calls is all the same. See code 2 by adding <code>time.Sleep(100)</code> after <code>go v.print()</code> to first loop. or with <code>go func(v field) { v.print() }(v)</code> on <a href=\"https://play.golang.org/p/oyvswX1FWK\" rel=\"noreferrer\">The Go Playground (Code 3 with <code>sync.WaitGroup</code>)</a>.<br>\nAlso, you have <strong>data race</strong> here (see B).  </p>\n\n<p>And for the second <code>go (*field).print(v)</code> here <code>v</code> is pointer and three goroutines parameter's evaluated before calling <code>print</code> and <strong>have three different addresses</strong>.</p>\n\n<p>1- Try this on <a href=\"https://play.golang.org/p/gLghPjAji0\" rel=\"noreferrer\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype field struct {\n    name string\n}\n\nfunc (p *field) print() {\n    fmt.Println(p.name)\n}\n\nfunc main() {\n    fmt.Println(\"use values:\")\n\n    // use values in range loop and go rountines\n    values := []field{{\"one\"}, {\"two\"}, {\"three\"}}\n    for _, v := range values {\n        fmt.Println(&amp;v)\n        go (*field).print(&amp;v) //go v.print()\n    }\n\n    time.Sleep(time.Second)\n\n    fmt.Println()\n    fmt.Println(\"use pointers:\")\n\n    // use pointers in range loop and go rountines\n    poniters := []*field{{\"one\"}, {\"two\"}, {\"three\"}}\n    for _, v := range poniters {\n        fmt.Println(v)\n        go (*field).print(v) //go v.print()\n    }\n\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>use values:\n&amp;{one}\n&amp;{two}\n&amp;{three}\nthree\nthree\nthree\n\nuse pointers:\n&amp;{one}\n&amp;{two}\n&amp;{three}\ntwo\none\nthree\n</code></pre>\n\n<hr>\n\n<p>2- Try this on <a href=\"https://play.golang.org/p/sp1XHPP5A0\" rel=\"noreferrer\">The Go Playground</a>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype field struct {\n    name string\n}\n\nfunc (p *field) print() {\n    fmt.Println(p.name)\n}\n\nfunc main() {\n    fmt.Println(\"use values:\")\n\n    // use values in range loop and go rountines\n    values := []field{{\"one\"}, {\"two\"}, {\"three\"}}\n    for _, v := range values {\n        fmt.Println(&amp;v)\n        go v.print() //go (*field).print(&amp;v) //\n        time.Sleep(100)\n    }\n\n    time.Sleep(time.Second)\n\n    fmt.Println()\n    fmt.Println(\"use pointers:\")\n\n    // use pointers in range loop and go rountines\n    poniters := []*field{{\"one\"}, {\"two\"}, {\"three\"}}\n    for _, v := range poniters {\n        fmt.Println(v)\n        go v.print() //go (*field).print(v) //\n    }\n\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p>output:</p>\n\n<pre><code>use values:\n&amp;{one}\none\n&amp;{two}\ntwo\n&amp;{three}\nthree\n\nuse pointers:\n&amp;{one}\n&amp;{two}\n&amp;{three}\none\ntwo\nthree\n</code></pre>\n\n<hr>\n\n<p>B: You have data race, try <code>go build -race</code> <a href=\"https://play.golang.org/p/cdryPmyWt5\" rel=\"noreferrer\">your code</a>, then run generated file, <code>WARNING: DATA RACE</code>:</p>\n\n<p>output:</p>\n\n<pre><code>use values:\n==================\nWARNING: DATA RACE\nRead at 0x00c042030210 by goroutine 6:\n  runtime.convT2E()\n      Go/src/runtime/iface.go:155 +0x0\n  main.(*field).print()\n      .../m.go:14 +0x6c\n\nPrevious write at 0x00c042030210 by main goroutine:\n  main.main()\n      .../m.go:22 +0x1c3\n\nGoroutine 6 (running) created at:\n  main.main()\n      .../m.go:23 +0x204\n==================\ntwo\nthree\nthree\n\nuse pointers:\none\ntwo\nthree\nFound 1 data race(s)\n</code></pre>\n"}], "owner": {"reputation": 346, "user_id": 4476748, "user_type": "registered", "accept_rate": 33, "profile_image": "https://www.gravatar.com/avatar/9411f33f09008556e0b6b5323f78fc35?s=128&d=identicon&r=PG&f=1", "display_name": "fding", "link": "https://stackoverflow.com/users/4476748/fding"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 390, "favorite_count": 2, "accepted_answer_id": 39546972, "answer_count": 1, "score": 3, "last_activity_date": 1474130458, "creation_date": 1474115142, "last_edit_date": 1474119633, "question_id": 39546804, "link": "https://stackoverflow.com/questions/39546804/differences-between-pointer-and-value-slice-in-for-range-loop", "title": "differences between pointer and value slice in for-range loop", "body": "<p>Please check this code snippet:</p>\n\n<pre><code>package main\n\nimport (  \n    \"fmt\"\n    \"time\"\n)\n\ntype field struct {  \n    name string\n}\n\nfunc (p *field) print() {  \n    fmt.Println(p.name)\n}\n\nfunc main() {\n    fmt.Println(\"use values:\")\n\n    // use values in range loop and go rountines\n    values := []field{{\"one\"},{\"two\"},{\"three\"}}\n    for _, v := range values {\n        go v.print()\n    }\n\n    time.Sleep(time.Second)\n\n    fmt.Println()\n    fmt.Println(\"use pointers:\")\n\n    // use pointers in range loop and go rountines\n    poniters := []*field{{\"one\"},{\"two\"},{\"three\"}}\n    for _, v := range poniters {\n        go v.print()\n    }\n\n    time.Sleep(time.Second)\n}\n</code></pre>\n\n<p>Link here: <a href=\"https://play.golang.org/p/cdryPmyWt5\" rel=\"nofollow\">https://play.golang.org/p/cdryPmyWt5</a></p>\n\n<p>The code above is going to check the differences between pointers and values in a for loop, while go statement is also used at the same time. For code:</p>\n\n<pre><code>values := []field{{\"one\"},{\"two\"},{\"three\"}}\nfor _, v := range values {\n    go v.print()\n}\n</code></pre>\n\n<p>we know that the console will print <strong>three three three</strong> as result, because for loop runs into its end before goroutines start executing, which write v as the last element of the slice. But what about pointers? </p>\n\n<pre><code>poniters := []*field{{\"one\"},{\"two\"},{\"three\"}}\nfor _, v := range poniters {\n    go v.print()\n}\n</code></pre>\n\n<p>It seems to print <strong>one two three</strong>, why?</p>\n\n<p>Thanks.</p>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 12623, "user_id": 5985853, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/49VtI.jpg?s=128&g=1", "display_name": "Alexey Soshin", "link": "https://stackoverflow.com/users/5985853/alexey-soshin"}, "is_accepted": false, "score": 4, "last_activity_date": 1474112281, "creation_date": 1474112281, "answer_id": 39546386, "question_id": 39545736, "link": "https://stackoverflow.com/questions/39545736/golang-iris-web-get-http-referer-and-useragent/39546386#39546386", "title": "Golang iris-web. Get HTTP referer and useragent", "body": "<p>As in regular Go http:</p>\n\n<pre><code>request.Header.Get(\"User-Agent\")\nrequest.Header.Get(\"Referer\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 769, "user_id": 2647655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qGHOi.png?s=128&g=1", "display_name": "kataras", "link": "https://stackoverflow.com/users/2647655/kataras"}, "is_accepted": false, "score": 1, "last_activity_date": 1506351773, "last_edit_date": 1506351773, "creation_date": 1474620356, "answer_id": 39656489, "question_id": 39545736, "link": "https://stackoverflow.com/questions/39545736/golang-iris-web-get-http-referer-and-useragent/39656489#39656489", "title": "Golang iris-web. Get HTTP referer and useragent", "body": "<pre><code>import \"github.com/kataras/iris\"\n// [...]\n\nfunc(ctx iris.Context){\n  uag:= ctx.GetHeader(\"User-Agent\")\n  ref:= ctx.GetHeader(\"Referer\")\n}\n</code></pre>\n\n<p>Iris provides features that other frameworks doesn't have while in the same time it's faster. Iris ,as github project is more active than others. There is no reason to suggest other lower frameworks when the user asks for Iris answer. </p>\n\n<p>@Sergey Lanzman What's the problem with Iris? </p>\n"}], "owner": {"reputation": 107, "user_id": 6841997, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2085e3d3760393405ae00257b3f9c24b?s=128&d=identicon&r=PG&f=1", "display_name": "digiadit", "link": "https://stackoverflow.com/users/6841997/digiadit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3508, "favorite_count": 0, "answer_count": 2, "score": 2, "last_activity_date": 1506351773, "creation_date": 1474108076, "question_id": 39545736, "link": "https://stackoverflow.com/questions/39545736/golang-iris-web-get-http-referer-and-useragent", "title": "Golang iris-web. Get HTTP referer and useragent", "body": "<p>lang and trying to use a framework called iris-web.</p>\n\n<p>i wanted to know how to get the http referrer and user-agent properly..</p>\n\n<p>I've been through the documentation pdf. No clear explanation..</p>\n\n<p>Any help will be deeply appreciated.</p>\n"}, {"tags": ["json", "image", "templates", "variables", "go"], "answers": [{"tags": [], "owner": {"reputation": 5135, "user_id": 6207052, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SlsN4.jpg?s=128&g=1", "display_name": "putu", "link": "https://stackoverflow.com/users/6207052/putu"}, "is_accepted": true, "score": 1, "last_activity_date": 1474252501, "creation_date": 1474252501, "answer_id": 39564605, "question_id": 39544805, "link": "https://stackoverflow.com/questions/39544805/pass-images-to-template-in-a-variable/39564605#39564605", "title": "Pass images to template in a variable", "body": "<p>One simple solution is by changing the declaration of <code>product</code> to includes images URL, e.g.</p>\n\n<pre><code>type product struct {\n    Title       string\n    Description string\n    Price       int\n    Pieces      int\n    ImagesURL   []string\n}\nmyproducts := []product {\n    //initialisation\n}\n</code></pre>\n\n<p>or create new type by struct composition</p>\n\n<pre><code>type productWithImage struct {\n    product\n    ImagesURL  []string\n}\nmyproducts := []productWithImage {\n    {product: product {\"bracelet\", \"descr\", 10, 7}, ImagesURL: []string{...}},\n    //initialisation\n}\n</code></pre>\n\n<p>Now you can pass a single variable to template and using <code>{{range .ImagesURL}}</code> to access the image URL in your <code>product-card.html</code>.</p>\n"}], "owner": {"reputation": 109, "user_id": 6842216, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/2dbe90211da875502710a12216dbd8fe?s=128&d=identicon&r=PG&f=1", "display_name": "Andreea", "link": "https://stackoverflow.com/users/6842216/andreea"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 135, "favorite_count": 1, "accepted_answer_id": 39564605, "answer_count": 1, "score": 2, "last_activity_date": 1474252501, "creation_date": 1474102121, "question_id": 39544805, "link": "https://stackoverflow.com/questions/39544805/pass-images-to-template-in-a-variable", "title": "Pass images to template in a variable", "body": "<p>I have a problem in one of my projects for which I cannot find a solution.I have an array of products product that contains the title, the description, the price and how many pieces of this type of product there are in my shop.</p>\n\n<pre><code>type product struct {\nTitle       string\nDescription string\nPrice       int\nPieces      int\n}\n</code></pre>\n\n<p>The urls for the images of each product come from a json as strings, grouped by products. I have a main page in which I include some blocks(the header, the footer, the sidebar, a template for the product cards which I apply to all the products) to which I pass the content of the variable product.</p>\n\n<pre><code>&lt;div class=\"container col-lg-12 main\"&gt;\n{{render \"blocks/storefront-header.html\"}}\n&lt;div class=\"col-lg-12 padd_class\" style=\"padding-left:10px;padding-right:10px;padding-bottom:10px\"&gt;\n      &lt;div class=\"col-lg-12\" style=\"padding-right:70px;padding-left:70px\"&gt;\n        &lt;div class=\"row\"&gt;\n            {{range .myproducts}}\n                {{template \"blocks/product-card.html\" .}}\n            {{end}}\n        &lt;/div&gt;\n    &lt;/div&gt;\n&lt;/div&gt;\n</code></pre>\n\n<p>\nThe product card contains the title, the price, the description of the product and some divs in which images should be put.</p>\n\n<pre><code> &lt;div class=\"col-lg-12\" style=\"padding-bottom:5px\"&gt;\n  &lt;!-- images --&gt;\n &lt;/div&gt;\n &lt;div class=\"card-block\" style=\"width:100%\"&gt;\n   &lt;div class=\"pull-right\" style=\"margin-right:-15px\"&gt;\n     &lt;h3 class=\"pull-right  price\"&gt;{{.Price}}&lt;/h3&gt;\n   &lt;/div&gt;\n   &lt;h4 class=\"card-title\"&gt;{{.Title}}&lt;/h4&gt;\n   &lt;p class=\"card-text\"&gt;{{.Description}}&lt;/p&gt;\n   &lt;button  class=\"btn btn-primary col-lg-12 classBuy  classbtn \"&gt;View product&lt;/button&gt;&lt;/a&gt;\n &lt;/div&gt;\n</code></pre>\n\n<p>What I need to do is pass the product details with the corresponding images(because each product should have at least one image, but there is no specific number of images that the seller could upload) to the template for the cards so that my page will display both the details and the images of the each product, but together, in the same card. Basically, the card should contain the product details and the images for this specific item.\nThis is the go code that I use:</p>\n\n<pre><code>iris.UseTemplate(html.New(html.Config{Layout:    \"pages/_layout.html\"})).Directory(\"./views\", \".html\")\niris.Static(\"/img\", \"./img\", 1)\niris.Static(\"/css\", \"./css\", 1)\niris.Static(\"/js\", \"./js\", 1)\n\ntype ProductList []product\nvar myproducts = ProductList{\n{\"bracelet\", \"descr\", 10, 7},\n{\"hat\", \"descr\", 3, 5},\n{\"scarf\", \"descr\", 3, 0},\n}\n\niris.Get(\"/dashboard\", func(ctx *iris.Context) {\nctx.Render(\"pages/dashboard.html\", iris.Map{\"myproducts\": myproducts},  iris.RenderOptions{\"gzip\": true})\n  })\niris.Listen(\":8080\")\n</code></pre>\n\n<p>What I tried to do was to pass two variables, the one of products and the one of the images to the same template, the one for the cards, but it didn`t work.\nDoes anyone have an idea about the way I could achieve this?\nThank you for your time!</p>\n"}, {"tags": ["session", "go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1474101520, "post_id": 39544619, "comment_id": 66402030, "body": "What session library are you using? You might wanna try <a href=\"https://github.com/icza/session\" rel=\"nofollow noreferrer\"><code>github.com&#47;icza&#47;session</code></a> which is much easier to use than what you tried, it manages cookies automatically for you."}, {"owner": {"reputation": 141, "user_id": 6029027, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ac9c83841db833d09ea9bfaf8d72d42?s=128&d=identicon&r=PG&f=1", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/6029027/wyatt"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1474101783, "post_id": 39544619, "comment_id": 66402111, "body": "I used beego. Could you help me fix this problem?"}], "owner": {"reputation": 141, "user_id": 6029027, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/8ac9c83841db833d09ea9bfaf8d72d42?s=128&d=identicon&r=PG&f=1", "display_name": "Wyatt", "link": "https://stackoverflow.com/users/6029027/wyatt"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 115, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1474101110, "creation_date": 1474100798, "last_edit_date": 1474101110, "question_id": 39544619, "link": "https://stackoverflow.com/questions/39544619/golang-session-variable-not-working", "title": "golang session variable not working", "body": "<p>I tried the following code. The first time I opened the page, the <code>username</code> is <code>nil</code> and the next time, the value turned to be a real name.</p>\n\n<pre><code>func sayHello(w http.ResponseWriter, r *http.Request) {\n    sess, _ := globalSessions.SessionStart(w, r)\n    defer sess.SessionRelease(w)\n    username := sess.Get(r.FormValue(\"name\"))\n    fmt.Println(username)\n    sess.Set(r.FormValue(\"name\"), r.FormValue(\"name\"))\n}\n</code></pre>\n\n<p>However, when I am going to implement some complex function, the session does not work.</p>\n\n<pre><code>func loginHandler(w http.ResponseWriter, r *http.Request) {\n    var (\n            query      url.Values\n            err        error\n            userInfo   daomanage.User\n            statusInfo StatusInfo\n        )   \n\n    cookie, err := r.Cookie(\"gosessionid\")\n    sess, _ := globalSessions.SessionStart(w, r)\n    defer sess.SessionRelease(w)\n    sessionCache := sess.Get(cookie.Value)\n    log.Println(\"newcache\", sessionCache, cookie.Value)\n    sess.Set(cookie.Value, cookie.Value)\n\n    // symbol xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxx\n\n    if sessionCache != nil {\n        statusInfo.Status = 200 \n        statusInfo.Info = userInfo.Username\n        data, _ := json.Marshal(statusInfo)\n        fmt.Fprintf(w, string(data))\n        return\n    }   \n\n    query, err = url.ParseQuery(r.URL.RawQuery)\n    if err != nil {\n        log.Println(\"Parse Error\", err)\n        return\n    }   \n\n    // Get user info\n    if s, ok := query[\"username\"]; ok {\n        userInfo, err = daomanage.GetUserInfo(\"username\", s[0])\n        if err == nil {\n            if p, ok := query[\"password\"]; ok {\n                if p[0] == userInfo.Password {\n                    sess.Set(s[0], s[0])\n                    log.Println(sess.Get(s[0]))\n\n                    tNow := time.Now()\n                    cookie := http.Cookie{Name: \"gosessionid\", Value: s[0], Expires: tNow.AddDate(1, 0, 0)}\n                    http.SetCookie(w, &amp;cookie)\n\n                    statusInfo.Status = 200\n                    statusInfo.Info = userInfo.Username\n                    data, _ := json.Marshal(statusInfo)\n                    fmt.Fprintf(w, string(data))\n                    return\n                }\n            }\n        }\n    }\n    statusInfo.Status = 400\n    statusInfo.Info = InfoLoginFailed\n    data, _ := json.Marshal(statusInfo)\n    fmt.Fprintf(w, string(data))\n    return\n}\n</code></pre>\n\n<p>I send the query to the function again and again, but the function <code>sess.Get(cookie.Value)</code> returns nothing. I even tried to set the session right after the <code>get</code> function(because in the demo, it works), it still does not work.</p>\n\n<p>When I deleted the code below the symbol, it works again!</p>\n\n<p>Are there any problems? Please help!</p>\n"}, {"tags": ["math", "go", "rounding"], "comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "reply_to_user": {"reputation": 58770, "user_id": 4891738, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/kE2lh.jpg?s=128&g=1", "display_name": "\u674e\u54f2\u6e90", "link": "https://stackoverflow.com/users/4891738/%e6%9d%8e%e5%93%b2%e6%ba%90"}, "edited": false, "score": 0, "creation_date": 1474101113, "post_id": 39544571, "comment_id": 66401911, "body": "I&#39;ve found one online but it doesn&#39;t quite do what I asked in the question :/"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1474101833, "post_id": 39544571, "comment_id": 66402132, "body": "Related: <a href=\"http://stackoverflow.com/questions/33206059/go-converting-float64-to-int-with-multiplier\">Go: Converting float64 to int with multiplier</a>"}, {"owner": {"reputation": 6861, "user_id": 3129778, "user_type": "registered", "accept_rate": 58, "profile_image": "https://www.gravatar.com/avatar/e4fade10019c1735cd345bc335c58732?s=128&d=identicon&r=PG&f=1", "display_name": "abhink", "link": "https://stackoverflow.com/users/3129778/abhink"}, "edited": false, "score": 0, "creation_date": 1474102057, "post_id": 39544571, "comment_id": 66402195, "body": "If you have a rounding function that gives correct result, all you need to do is manage the result&#39;s precision by truncating it. A sort of ham-fisted approach for that would be <a href=\"https://play.golang.org/p/DRTTkQQI42\" rel=\"nofollow noreferrer\">play.golang.org/p/DRTTkQQI42</a> (not edge tested)"}, {"owner": {"reputation": 228853, "user_id": 827263, "user_type": "registered", "accept_rate": 54, "profile_image": "https://www.gravatar.com/avatar/216c1db53d752f87dd8176a6ba0c2190?s=128&d=identicon&r=PG", "display_name": "Keith Thompson", "link": "https://stackoverflow.com/users/827263/keith-thompson"}, "edited": false, "score": 1, "creation_date": 1514406268, "post_id": 39544571, "comment_id": 82964731, "body": "As the accepted answer says, rounding a binary floating-point value to some number (other than 0) of decimal places is not particularly useful. The value <code>0.05</code>, for example, cannot be represented exactly. In 64-bit IEEE floating-point, it will probably be stored as <code>0.05000000000000000277555756156289135105907917022705078125</code>. For most purposes, keep your floating-point values in full precision, and round them only when performing output or converting to a string."}], "answers": [{"comments": [{"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 6, "creation_date": 1474102916, "post_id": 39544897, "comment_id": 66402460, "body": "Nothing more than pure genius. Thank you icza."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1474103491, "post_id": 39544897, "comment_id": 66402629, "body": "@Acidic Please see edit regarding applying it on negative numbers."}, {"owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1474103880, "post_id": 39544897, "comment_id": 66402772, "body": "Yep, I see thank you. I&#39;ve edited your function to solve the problem of 0.363636 = 0.35000000000000003 which is available at <a href=\"https://play.golang.org/p/jxILFBYBEF\" rel=\"nofollow noreferrer\">play.golang.org/p/jxILFBYBEF</a> for anyone interested."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "edited": false, "score": 0, "creation_date": 1474107938, "post_id": 39544897, "comment_id": 66403914, "body": "@Acidic Formatting and re-parsing gives you nothing more that &quot;illusion&quot;. See edited answer. Unnecessary to do that."}, {"owner": {"reputation": 1124, "user_id": 1263312, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/698a447f866ea18b3b0c45cb7b0bf780?s=128&d=identicon&r=PG", "display_name": "PickBoy", "link": "https://stackoverflow.com/users/1263312/pickboy"}, "edited": false, "score": 0, "creation_date": 1508162995, "post_id": 39544897, "comment_id": 80490275, "body": "@icza What about check for overflow?"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 1124, "user_id": 1263312, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/698a447f866ea18b3b0c45cb7b0bf780?s=128&d=identicon&r=PG", "display_name": "PickBoy", "link": "https://stackoverflow.com/users/1263312/pickboy"}, "edited": false, "score": 0, "creation_date": 1508163109, "post_id": 39544897, "comment_id": 80490342, "body": "@PickBoy That is not covered by this answer as the question was about rounding (errors)."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 92, "last_activity_date": 1578992927, "last_edit_date": 1578992927, "creation_date": 1474102677, "answer_id": 39544897, "question_id": 39544571, "link": "https://stackoverflow.com/questions/39544571/golang-round-to-nearest-0-05/39544897#39544897", "title": "Golang Round to Nearest 0.05", "body": "<p><strong>Foreword:</strong> I released this utility in <a href=\"https://github.com/icza/gox\" rel=\"noreferrer\"><code>github.com/icza/gox</code></a>, see <a href=\"https://godoc.org/github.com/icza/gox/mathx#Round\" rel=\"noreferrer\"><code>mathx.Round()</code></a>.</p>\n\n<hr>\n\n<p>Go 1.10 has been released, and it adds a <a href=\"https://golang.org/pkg/math/#Round\" rel=\"noreferrer\"><code>math.Round()</code></a> function. This function rounds to the nearest integer (which is basically a <em>\"round to nearest 1.0\"</em> operation), and using that we can very easily construct a function that rounds to the unit of our choice:</p>\n\n<pre><code>func Round(x, unit float64) float64 {\n    return math.Round(x/unit) * unit\n}\n</code></pre>\n\n<p>Testing it:</p>\n\n<pre><code>fmt.Println(Round(0.363636, 0.05)) // 0.35\nfmt.Println(Round(3.232, 0.05))    // 3.25\nfmt.Println(Round(0.4888, 0.05))   // 0.5\n\nfmt.Println(Round(-0.363636, 0.05)) // -0.35\nfmt.Println(Round(-3.232, 0.05))    // -3.25\nfmt.Println(Round(-0.4888, 0.05))   // -0.5\n</code></pre>\n\n<p>Try it on the <a href=\"https://play.golang.org/p/z5KrxxAQesK\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>The original answer follows which was created before Go 1.10 when no <code>math.Round()</code> existed, and which also details the logic behind our custom <code>Round()</code> function. It's here for educational purposes.</p>\n\n<hr>\n\n<p>In the pre-Go1.10 era there was no <code>math.Round()</code>. But...</p>\n\n<p>Rounding tasks can easily be implemented by a <code>float64</code> => <code>int64</code> converison, but care must be taken as float to int conversion is <em>not rounding but keeping the integer part</em> (see details in <a href=\"https://stackoverflow.com/questions/33206059/go-converting-float64-to-int-with-multiplier\">Go: Converting float64 to int with multiplier</a>).</p>\n\n<p>For example:</p>\n\n<pre><code>var f float64\nf = 12.3\nfmt.Println(int64(f)) // 12\nf = 12.6\nfmt.Println(int64(f)) // 12\n</code></pre>\n\n<p>Result is <code>12</code> in both cases, the integer part. To get the rounding \"functionality\", simply add <code>0.5</code>:</p>\n\n<pre><code>f = 12.3\nfmt.Println(int64(f + 0.5)) // 12\nf = 12.6\nfmt.Println(int64(f + 0.5)) // 13\n</code></pre>\n\n<p>So far so good. But we don't want to round to integers. If we'd wanted to round to 1 fraction digit, we would multiply by 10 before adding <code>0.5</code> and converting:</p>\n\n<pre><code>f = 12.31\nfmt.Println(float64(int64(f*10+0.5)) / 10) // 12.3\nf = 12.66\nfmt.Println(float64(int64(f*10+0.5)) / 10) // 12.7\n</code></pre>\n\n<p>So basically you multiply by the reciprocal of the unit you want to round to. To round to <code>0.05</code> units, multiply by <code>1/0.05 = 20</code>:</p>\n\n<pre><code>f = 12.31\nfmt.Println(float64(int64(f*20+0.5)) / 20) // 12.3\nf = 12.66\nfmt.Println(float64(int64(f*20+0.5)) / 20) // 12.65\n</code></pre>\n\n<p>Wrapping this into a function:</p>\n\n<pre><code>func Round(x, unit float64) float64 {\n    return float64(int64(x/unit+0.5)) * unit\n}\n</code></pre>\n\n<p>Using it:</p>\n\n<pre><code>fmt.Println(Round(0.363636, 0.05)) // 0.35\nfmt.Println(Round(3.232, 0.05))    // 3.25\nfmt.Println(Round(0.4888, 0.05))   // 0.5\n</code></pre>\n\n<p>Try the examples on the <a href=\"https://play.golang.org/p/DHnn_SgdAm\" rel=\"noreferrer\">Go Playground</a>.</p>\n\n<p>Note that rounding <code>3.232</code> with <code>unit=0.05</code> will not print exactly <code>3.25</code> but <code>0.35000000000000003</code>. This is because <code>float64</code> numbers are stored using finite precision, called the <a href=\"https://en.wikipedia.org/wiki/IEEE_floating_point\" rel=\"noreferrer\">IEEE-754</a> standard. For details see <a href=\"https://stackoverflow.com/questions/36052922/golang-converting-float64-to-int-error\">Golang converting float64 to int error</a>.</p>\n\n<p>Also note that <code>unit</code> may be \"any\" number. If it's <code>1</code>, then <code>Round()</code> basically rounds to nearest integer number. If it's <code>10</code>, it rounds to tens, if it's <code>0.01</code>, it rounds to 2 fraction digits.</p>\n\n<p>Also note that when you call <code>Round()</code> with a negative number, you might get surprising result:</p>\n\n<pre><code>fmt.Println(Round(-0.363636, 0.05)) // -0.3\nfmt.Println(Round(-3.232, 0.05))    // -3.2\nfmt.Println(Round(-0.4888, 0.05))   // -0.45\n</code></pre>\n\n<p>This is because \u2013as said earlier\u2013 conversion is keeping the integer part, and for example integer part of <code>-1.6</code> is <code>-1</code> (which is greater than <code>-1.6</code>; while integer part of <code>1.6</code> is <code>1</code> which is less than <code>1.6</code>).</p>\n\n<p>If you want <code>-0.363636</code> to become <code>-0.35</code> instead of <code>-0.30</code>, then in case of negative numbers add <code>-0.5</code> instead of <code>0.5</code> inside the <code>Round()</code> function. See our improved <code>Round2()</code> function:</p>\n\n<pre><code>func Round2(x, unit float64) float64 {\n    if x &gt; 0 {\n        return float64(int64(x/unit+0.5)) * unit\n    }\n    return float64(int64(x/unit-0.5)) * unit\n}\n</code></pre>\n\n<p>And using it:</p>\n\n<pre><code>fmt.Println(Round2(-0.363636, 0.05)) // -0.35\nfmt.Println(Round2(-3.232, 0.05))    // -3.25\nfmt.Println(Round2(-0.4888, 0.05))   // -0.5\n</code></pre>\n\n<hr>\n\n<p><strong>EDIT:</strong></p>\n\n<p>To address your comment: because you don't \"like\" the non-exact <code>0.35000000000000003</code>, you proposed to format it and re-parse it like:</p>\n\n<pre><code>formatted, err := strconv.ParseFloat(fmt.Sprintf(\"%.2f\", rounded), 64)\n</code></pre>\n\n<p>And this \"seemingly\" results in the exact result as printing it gives <code>0.35</code> exactly.</p>\n\n<p>But this is just an \"illusion\". Since <code>0.35</code> cannot be represented with finite bits using IEEE-754 standard, doesn't matter what you do with the number, if you store it in a value of type <code>float64</code>, it won't be exactly <code>0.35</code> (but an IEEE-754 number being very close to it). What you see is <code>fmt.Println()</code> printing it as <code>0.35</code> because <code>fmt.Println()</code> already does some rounding.</p>\n\n<p>But if you attempt to print it with higher precision:</p>\n\n<pre><code>fmt.Printf(\"%.30f\\n\", Round(0.363636, 0.05))\nfmt.Printf(\"%.30f\\n\", Round(3.232, 0.05))\nfmt.Printf(\"%.30f\\n\", Round(0.4888, 0.05))\n</code></pre>\n\n<p>Output: it's not nicer (might be even uglier): try it on the <a href=\"https://play.golang.org/p/PnHrIw1ysw\" rel=\"noreferrer\">Go Playground</a>:</p>\n\n<pre><code>0.349999999999999977795539507497\n3.250000000000000000000000000000\n0.500000000000000000000000000000\n</code></pre>\n\n<p>Note that on the other hand <code>3.25</code> and <code>0.5</code> are exact because they can be represented with finite bits exactly, because representing in binary:</p>\n\n<pre><code>3.25 = 3 + 0.25 = 11.01binary\n0.5 = 0.1binary\n</code></pre>\n\n<p>What's the lesson? It's not worth formatting and re-parsing the result, as it won't be exact either (just a different <code>float64</code> value which \u2013according to default <code>fmt.Println()</code> formatting rules\u2013 might be nicer in printing). If you want nice printed format, just format with precision, like:</p>\n\n<pre><code>func main() {\n    fmt.Printf(\"%.3f\\n\", Round(0.363636, 0.05))\n    fmt.Printf(\"%.3f\\n\", Round(3.232, 0.05))\n    fmt.Printf(\"%.3f\\n\", Round(0.4888, 0.05))\n}\n\nfunc Round(x, unit float64) float64 {\n    return float64(int64(x/unit+0.5)) * unit\n}\n</code></pre>\n\n<p>And it will be exact (try it on the <a href=\"https://play.golang.org/p/11GbPjkDKq\" rel=\"noreferrer\">Go Playground</a>):</p>\n\n<pre><code>0.350\n3.250\n0.500\n</code></pre>\n\n<p>Or just multiply them by <code>100</code> and work with integer numbers, so that no representation or rounding error may occur.</p>\n"}], "owner": {"reputation": 8073, "user_id": 4988637, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/aXgMC.jpg?s=128&g=1", "display_name": "Acidic9", "link": "https://stackoverflow.com/users/4988637/acidic9"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 29335, "favorite_count": 10, "accepted_answer_id": 39544897, "answer_count": 1, "score": 30, "last_activity_date": 1578992927, "creation_date": 1474100394, "last_edit_date": 1474100733, "question_id": 39544571, "link": "https://stackoverflow.com/questions/39544571/golang-round-to-nearest-0-05", "title": "Golang Round to Nearest 0.05", "body": "<p><strong>I am looking for a function to round to the nearest 0.05 in Golang</strong>.\nThe end result of using the function must always be a factor of 0.05.</p>\n\n<hr>\n\n<p>Here are some examples of outputs for the function I am looking for:\n(The function Round doesn't exist yet, I am hoping it can be included in the answer)</p>\n\n<pre><code>Round(0.363636) // 0.35\nRound(3.232)    // 3.25\nRound(0.4888)   // 0.5\n</code></pre>\n\n<p><em>I have searched around for ages now and haven't found any answers.</em></p>\n"}, {"tags": ["for-loop", "go", "stack", "scanf"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 1, "last_activity_date": 1474099814, "last_edit_date": 1474099814, "creation_date": 1474097538, "answer_id": 39544142, "question_id": 39544022, "link": "https://stackoverflow.com/questions/39544022/why-is-this-the-output-of-the-following-code-wrong-in-go-language/39544142#39544142", "title": "Why is this the output of the following code wrong in GO language", "body": "<p>The problem is that you want it to work like you enter a value and press <kbd>Enter</kbd> which generates a newline character, and you  try to scan it using <a href=\"https://golang.org/pkg/fmt/#Scanf\" rel=\"nofollow\"><code>fmt.Scanf()</code></a>. Quoting from its doc:</p>\n\n<blockquote>\n  <p>Newlines in the input must match newlines in the format.</p>\n</blockquote>\n\n<p>So if you want to use <code>fmt.Scanf()</code>, the format string must include a newline <code>\\n</code>. But since yours doesn't, the newline is not consumed, so the next line to read the value will automatically proceed.</p>\n\n<p>Easy fix: add <code>\\n</code> to the format string:</p>\n\n<pre><code>fmt.Println(\"Enter you choice:\")\nfmt.Println(\"1. PUSH\\n2. POP\\n3. PRINT\\n4. EXIT\")\nfmt.Scanf(\"%d\\n\", &amp;ch)\n</code></pre>\n\n<p>And:</p>\n\n<pre><code>fmt.Println(\"Enter the value...\")\nfmt.Scanf(\"%d\\n\", &amp;temp)\n</code></pre>\n\n<p>An alternative is to simply use <a href=\"https://golang.org/pkg/fmt/#Scanln\" rel=\"nofollow\"><code>fmt.Scanln()</code></a> which automatically parses a whole line:</p>\n\n<pre><code>fmt.Println(\"1. PUSH\\n2. POP\\n3. PRINT\\n4. EXIT\")\nfmt.Scanln(&amp;ch)\n\n// ... \n\nfmt.Println(\"Enter the value...\")\nfmt.Scanln(&amp;temp)\n</code></pre>\n\n<p>Also, <code>fmt.Scanf()</code> and <code>fmt.Scanln()</code> return the number of successfully scanned values and an error. Be sure to check those to see if scanning succeeded.</p>\n\n<p>Another error you have in your code is the Exit functionality: you used <code>break</code> statement in the <code>case 4</code> branch. <code>break</code> will only break the <code>switch</code> and not the <code>for</code>! So use a <code>return</code> instead of <code>break</code>:</p>\n\n<pre><code>    case 4:\n        return\n</code></pre>\n\n<p>Another fix could be to use labels, also note that <code>for true { ... }</code> is equivalent with <code>for { ... }</code> (you can omit the <code>true</code>):</p>\n\n<pre><code>mainloop:\n    for {\n        // ...\n        switch ch {\n        // ...\n        case 4:\n            break mainloop\n        // ...\n        }\n    }\n</code></pre>\n"}], "owner": {"reputation": 49, "user_id": 4405490, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b9af95bb0a588ef29cbd73e9aec8296?s=128&d=identicon&r=PG&f=1", "display_name": "star", "link": "https://stackoverflow.com/users/4405490/star"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 127, "favorite_count": 0, "accepted_answer_id": 39544142, "answer_count": 1, "score": 2, "last_activity_date": 1474105435, "creation_date": 1474096834, "last_edit_date": 1474105435, "question_id": 39544022, "link": "https://stackoverflow.com/questions/39544022/why-is-this-the-output-of-the-following-code-wrong-in-go-language", "title": "Why is this the output of the following code wrong in GO language", "body": "<p>This is my code written to implement a Stack. When I execute this, it generates some different kind of output totally. A screenshot of output is attached. Why is the program generating such invalid output? Is there any mistake in the code? </p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nvar st [100]int\nvar top int\n\nfunc main() {\n    top = -1\n    ch := 0\n    temp := 0\n    for true {\n        fmt.Println(\"Enter you choice:\")\n        fmt.Println(\"1. PUSH\\n2. POP\\n3. PRINT\\n4. EXIT\")\n        fmt.Scanf(\"%d\", &amp;ch)\n        switch ch {\n        case 1:\n            fmt.Println(\"Enter the value...\")\n            fmt.Scanf(\"%d\", &amp;temp)\n            push(temp)\n        case 2:\n            temp = pop()\n            if temp != -1 {\n                fmt.Println(\"The popped value is \", temp)\n            }\n        case 3:\n            print()\n        case 4:\n            break\n        default:\n            fmt.Println(\"Please enter a valid choice\")\n        }\n    }\n}\n\nfunc print() {\n    i := 0\n    if top == -1 {\n        fmt.Println(\"First insert elements into the stack\")\n    } else {\n        fmt.Printf(\"The values are as follows\")\n        for i &lt;= top {\n            fmt.Println(st[i])\n            i++\n        }\n    }\n}\n\nfunc pop() int {\n    if top == -1 {\n        fmt.Println(\"Please push values before popping\")\n        return -1\n    }\n    temp := st[top]\n    top--\n    return temp\n}\n\nfunc push(n int) {\n    top++\n    st[top] = n\n}\n</code></pre>\n\n<p>Screen shot of the output:</p>\n\n<p><a href=\"https://i.stack.imgur.com/chhyF.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/chhyF.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": ["image", "go", "go-iris"], "answers": [{"tags": [], "owner": {"reputation": 1853, "user_id": 3186886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3336bbf9f0d7330e06dc19753106a322?s=128&d=identicon&r=PG", "display_name": "mraron", "link": "https://stackoverflow.com/users/3186886/mraron"}, "is_accepted": true, "score": 2, "last_activity_date": 1474099206, "creation_date": 1474099206, "answer_id": 39544407, "question_id": 39543845, "link": "https://stackoverflow.com/questions/39543845/golang-iris-web-serve-1x1-pixel/39544407#39544407", "title": "Golang Iris Web - Serve 1x1 pixel", "body": "<p>Attention: I'm not really familiar with iris so the solution maybe not idiomatic.</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/kataras/iris\"\n    \"image\"    \n    \"image/color\"\n    \"image/gif\"\n)\n\nfunc main() {\n\n    iris.Get(\"/\", func(ctx *iris.Context) {\n        img := image.NewRGBA(image.Rect(0, 0, 1, 1)) //We create a new image of size 1x1 pixels\n        img.Set(0, 0, color.RGBA{255, 0, 0, 255}) //set the first and only pixel to some color, in this case red\n\n        err := gif.Encode(ctx.Response.BodyWriter(), img, nil) //encode the rgba image to gif, using gif.encode and write it to the response\n        if err != nil {\n            panic(err) //if we encounter some problems panic\n        }\n        ctx.SetContentType(\"image/gif\") //set the content type so the browser can identify that our response is actually an gif image\n    })\n\n    iris.Listen(\":8080\")\n}\n</code></pre>\n\n<p>Links for better understanding:</p>\n\n<ul>\n<li><a href=\"https://golang.org/pkg/image/\" rel=\"nofollow\">https://golang.org/pkg/image/</a></li>\n<li><a href=\"https://golang.org/pkg/image/gif\" rel=\"nofollow\">https://golang.org/pkg/image/gif</a></li>\n<li><a href=\"https://golang.org/pkg/image/color\" rel=\"nofollow\">https://golang.org/pkg/image/color</a></li>\n<li><a href=\"https://golang.org/pkg/image/\" rel=\"nofollow\">https://golang.org/pkg/image/</a></li>\n<li><a href=\"https://godoc.org/github.com/valyala/fasthttp#Response\" rel=\"nofollow\">https://godoc.org/github.com/valyala/fasthttp#Response</a></li>\n</ul>\n"}], "owner": {"reputation": 107, "user_id": 6841997, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/2085e3d3760393405ae00257b3f9c24b?s=128&d=identicon&r=PG&f=1", "display_name": "digiadit", "link": "https://stackoverflow.com/users/6841997/digiadit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 576, "favorite_count": 0, "accepted_answer_id": 39544407, "answer_count": 1, "score": 1, "last_activity_date": 1487971798, "creation_date": 1474095696, "last_edit_date": 1487971798, "question_id": 39543845, "link": "https://stackoverflow.com/questions/39543845/golang-iris-web-serve-1x1-pixel", "title": "Golang Iris Web - Serve 1x1 pixel", "body": "<p>I'm new to Golang and trying to use a framework called <a href=\"https://github.com/kataras/iris\" rel=\"nofollow noreferrer\">iris</a>.</p>\n\n<p>My problem is how to serve 1x1 gif pixel, not using c.HTML context, but the way the browser title becomes <em>1x1 image gif</em>. The image will be used for tracking.</p>\n\n<p>Any help will be deeply appreciated.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 21, "user_id": 3321663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYZxS.png?s=128&g=1", "display_name": "Sonny AD", "link": "https://stackoverflow.com/users/3321663/sonny-ad"}, "edited": false, "score": 0, "creation_date": 1474094213, "post_id": 39543356, "comment_id": 66400370, "body": "I find out I could do $() instead of `` but hum...Actually my command is more complex than just that: <code>nginx=$(ps aux | grep -v grep | grep nginx | wc -l); dash=$(ps aux | grep -v grep | grep Dash | wc -l); if [ $nginx -gt 0 -a $dash -gt 0 ]; then echo OK; else echo Error; fi</code>"}], "answers": [{"tags": [], "owner": {"reputation": 1853, "user_id": 3186886, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3336bbf9f0d7330e06dc19753106a322?s=128&d=identicon&r=PG", "display_name": "mraron", "link": "https://stackoverflow.com/users/3186886/mraron"}, "is_accepted": true, "score": 1, "last_activity_date": 1474092979, "creation_date": 1474092979, "answer_id": 39543478, "question_id": 39543356, "link": "https://stackoverflow.com/questions/39543356/golang-exec-and-back-ticks-shell-command/39543478#39543478", "title": "Golang, exec and back ticks shell command", "body": "<p>Go executes these commands a way that you can't use shell things, because it creates a new process.\nSo you should create a new shell process, for example:</p>\n\n<pre><code>package main\n\nimport (\n    \"os\"\n    \"os/exec\"\n)\n\nfunc main() {\n    cmd := exec.Command(\"sh\", \"-c\", \"value=`ls`; echo $value\")\n    cmd.Stdout = os.Stdout\n    err := cmd.Run()\n    if err != nil {\n        panic(err)\n    }\n\n}\n</code></pre>\n\n<p>Let me know if it's not what you want!</p>\n"}], "owner": {"reputation": 21, "user_id": 3321663, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iYZxS.png?s=128&g=1", "display_name": "Sonny AD", "link": "https://stackoverflow.com/users/3321663/sonny-ad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 788, "favorite_count": 0, "accepted_answer_id": 39543478, "answer_count": 1, "score": -3, "last_activity_date": 1474092979, "creation_date": 1474091918, "question_id": 39543356, "link": "https://stackoverflow.com/questions/39543356/golang-exec-and-back-ticks-shell-command", "title": "Golang, exec and back ticks shell command", "body": "<p>I am trying to use os.exec (<a href=\"https://nathanleclaire.com/blog/2014/12/29/shelled-out-commands-in-golang/\" rel=\"nofollow\">https://nathanleclaire.com/blog/2014/12/29/shelled-out-commands-in-golang/</a>) with a command like: <pre>value=`something`; echo $value</pre></p>\n\n<p>But it appears to the back ticks are messing with the command of the strings.Split I do. </p>\n\n<p>If I use <pre>something</pre> it works</p>\n\n<p>How can I use the back ticks? Do I have to find out another way to write my command?</p>\n\n<p>Thanks</p>\n"}, {"tags": ["unit-testing", "http", "testing", "go", "httphandler"], "comments": [{"owner": {"reputation": 18008, "user_id": 241605, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01175ac61664b22485bc5b4e46169ccc?s=128&d=identicon&r=PG", "display_name": "Matthew Strawbridge", "link": "https://stackoverflow.com/users/241605/matthew-strawbridge"}, "edited": false, "score": 0, "creation_date": 1474099802, "post_id": 39543318, "comment_id": 66401606, "body": "Maybe it&#39;s a conflict between the package and variable names. Try changing the variable from <code>template</code> to <code>t</code>, e.g. <code>t, err := template.ParseFiles(&quot;templates&#47;about.html&quot;) ... t.Execute(w, nil)</code>."}, {"owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "reply_to_user": {"reputation": 18008, "user_id": 241605, "user_type": "registered", "accept_rate": 96, "profile_image": "https://www.gravatar.com/avatar/01175ac61664b22485bc5b4e46169ccc?s=128&d=identicon&r=PG", "display_name": "Matthew Strawbridge", "link": "https://stackoverflow.com/users/241605/matthew-strawbridge"}, "edited": false, "score": 0, "creation_date": 1474126279, "post_id": 39543318, "comment_id": 66409212, "body": "Same result. It has to do with the template.execute all definitely."}, {"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "edited": false, "score": 0, "creation_date": 1474184335, "post_id": 39543318, "comment_id": 66421660, "body": "Which version of Go are you using? I ran your code on go1.7.1 and everything worked fine."}, {"owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "reply_to_user": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "edited": false, "score": 0, "creation_date": 1474211920, "post_id": 39543318, "comment_id": 66428974, "body": "@danbondd I am on 1.7. Can you send the code you used to ran? And you ran it using &quot;go test&quot; ?"}], "answers": [{"comments": [{"owner": {"reputation": 841, "user_id": 4506781, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/73fa1afa3fc0fefc5c36f2df4ce8200a?s=128&d=identicon&r=PG", "display_name": "syscll", "link": "https://stackoverflow.com/users/4506781/syscll"}, "edited": false, "score": 0, "creation_date": 1474272751, "post_id": 39560739, "comment_id": 66446601, "body": "This was going to be my next question - I&#39;m glad you got it sorted!"}], "tags": [], "owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "is_accepted": true, "score": 2, "last_activity_date": 1474220447, "creation_date": 1474220447, "answer_id": 39560739, "question_id": 39543318, "link": "https://stackoverflow.com/questions/39543318/unittest-with-template-golang/39560739#39560739", "title": "Unittest with template golang", "body": "<p>Ok i think i figured it out, i'm using </p>\n\n<pre><code>_ \"github.com/mattn/go-sqlite3\"\n</code></pre>\n\n<p>as an import. I ran go install in that directory and now it runs...</p>\n"}, {"tags": [], "owner": {"reputation": 306, "user_id": 9993851, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-lN_nkSZvtuE/AAAAAAAAAAI/AAAAAAAAAAA/AB6qoq2lPYQvVpp_KL6ABn5tRJArw2u-YQ/mo/photo.jpg?sz=128", "display_name": "Nikta Jn", "link": "https://stackoverflow.com/users/9993851/nikta-jn"}, "is_accepted": false, "score": 1, "last_activity_date": 1530182948, "creation_date": 1530182948, "answer_id": 51080987, "question_id": 39543318, "link": "https://stackoverflow.com/questions/39543318/unittest-with-template-golang/51080987#51080987", "title": "Unittest with template golang", "body": "<p>It can be solved if you add absolute path in this line  template, err := template.ParseFiles(\"absolutePathOfTheFile\")</p>\n"}], "owner": {"reputation": 199, "user_id": 1167741, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/bf35c1cb67665b1d9cde2cf851716a3e?s=128&d=identicon&r=PG&f=1", "display_name": "stihl", "link": "https://stackoverflow.com/users/1167741/stihl"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1419, "favorite_count": 0, "accepted_answer_id": 39560739, "answer_count": 2, "score": 1, "last_activity_date": 1530182948, "creation_date": 1474091497, "question_id": 39543318, "link": "https://stackoverflow.com/questions/39543318/unittest-with-template-golang", "title": "Unittest with template golang", "body": "<p>I have a very simple http handler serving the template about.html</p>\n\n<pre><code>func AboutPage(w http.ResponseWriter, r *http.Request, ps httprouter.Params) {\n    template, err := template.ParseFiles(\"templates/about.html\")\n\n    if err != nil {\n            logfile.ErrorMsg(fmt.Sprint(err.Error()))\n            http.Error(w, err.Error(), http.StatusInternalServerError)\n            return\n        }\n\n\n    template.Execute(w, nil)\n}\n</code></pre>\n\n<p>It works fine, but when i want to run this unit test:</p>\n\n<pre><code>func getRequest(t testing.TB, url string) *http.Request {\n    req, err := http.NewRequest(\"GET\", url, nil)\n    if err != nil {\n        t.Fatal(err)\n    }\n    return req\n}\n\nfunc TestAboutPage(t *testing.T) {\n    r := getRequest(t, \"/about\")\n\n    rw := httptest.NewRecorder()\n\n    AboutPage(rw, r, httprouter.Params{})\n\n}\n</code></pre>\n\n<p>The program crashes with this:</p>\n\n<pre><code>go test\n--- FAIL: TestAboutPage (0.00s)\npanic: runtime error: invalid memory address or nil pointer dereference [recovered]\n    panic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x20 pc=0x41123b4]\n\ngoroutine 19 [running]:\npanic(0x4417520, 0xc42000c0b0)\n    /usr/local/go/src/runtime/panic.go:500 +0x1a1\ntesting.tRunner.func1(0xc42009e180)\n    /usr/local/go/src/testing/testing.go:579 +0x25d\npanic(0x4417520, 0xc42000c0b0)\n    /usr/local/go/src/runtime/panic.go:458 +0x243\nhtml/template.(*Template).escape(0x0, 0x0, 0x0)\n    /usr/local/go/src/html/template/template.go:79 +0x44\nhtml/template.(*Template).Execute(0x0, 0x52683b0, 0xc42007a7c0, 0x0, 0x0, 0xc420077290, 0x1)\n    /usr/local/go/src/html/template/template.go:101 +0x2f\ngithub.com/engineerbeard/engineerbeard.com/httpHandlers.AboutPage(0x45ee2e0, 0xc42007a7c0, 0xc4200ee0f0, 0xc42004bf38, 0x0, 0x0)\n    /Users/dbubel/gowork/src/github.com/engineerbeard/engineerbeard.com/httpHandlers/handler.go:122 +0xbd\ngithub.com/engineerbeard/engineerbeard.com/httpHandlers.TestAboutPage(0xc42009e180)\n    /Users/dbubel/gowork/src/github.com/engineerbeard/engineerbeard.com/httpHandlers/handlers_test.go:26 +0x15c\ntesting.tRunner(0xc42009e180, 0x449b320)\n    /usr/local/go/src/testing/testing.go:610 +0x81\ncreated by testing.(*T).Run\n    /usr/local/go/src/testing/testing.go:646 +0x2ec\nexit status 2\nFAIL    github.com/engineerbeard/engineerbeard.com/httpHandlers 0.012s\n</code></pre>\n\n<p>If i replace template.execute() with a simple Fprintf(w, \"foo\") the test runs fine. So how is unittesting done with a template?</p>\n"}, {"tags": ["go", "types", "interface"], "answers": [{"comments": [{"owner": {"reputation": 195, "user_id": 5778483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/530ecad826cab806010c68d4a5c7e605?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/5778483/marcos"}, "edited": false, "score": 0, "creation_date": 1474327360, "post_id": 39542881, "comment_id": 66476961, "body": "I had a types and pointers problem calling the All() method. Good example!"}], "tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1474086875, "last_edit_date": 1495541802, "creation_date": 1474086875, "answer_id": 39542881, "question_id": 39542731, "link": "https://stackoverflow.com/questions/39542731/go-interfaces-as-return-values/39542881#39542881", "title": "Go: interfaces as return values", "body": "<p>Generally, with MongoDB, you would <a href=\"https://stackoverflow.com/q/22930060/6309\">use bson struct</a> to quickly add or retrieve objects (which are <strong><a href=\"https://docs.mongodb.com/manual/core/data-modeling-introduction/\" rel=\"nofollow noreferrer\">embedded documents</a></strong>).</p>\n\n<p>You can see <a href=\"https://stackoverflow.com/a/28328244/6309\">this example</a></p>\n\n<pre><code>// Find the actors in the movie\nvar m Movie\ndb.C(\"movies\").Find(bson.M{\"name\": \"Fantastic Mr. Fox\"}).One(&amp;m)\n</code></pre>\n\n<p>That means one Lookup function per struct indeed.</p>\n"}, {"comments": [{"owner": {"reputation": 195, "user_id": 5778483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/530ecad826cab806010c68d4a5c7e605?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/5778483/marcos"}, "edited": false, "score": 0, "creation_date": 1474119036, "post_id": 39543188, "comment_id": 66407060, "body": "I tried this but i get: &quot;result argument must be a slice address&quot;. So I changed the argument <code>interface{}</code> =&gt; <code>[]interface{}</code>. But then I get  <code>cannot use &amp;dog (type *[]Dog] as type []interface {} in argument to LookUp</code>"}, {"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "reply_to_user": {"reputation": 195, "user_id": 5778483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/530ecad826cab806010c68d4a5c7e605?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/5778483/marcos"}, "edited": false, "score": 0, "creation_date": 1474121472, "post_id": 39543188, "comment_id": 66407768, "body": "@Marcos I suspect a typo. The call to all is <code>All(result)</code>,  not <code>All(&amp;result)</code>."}], "tags": [], "owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "is_accepted": true, "score": 0, "last_activity_date": 1474090292, "creation_date": 1474090292, "answer_id": 39543188, "question_id": 39542731, "link": "https://stackoverflow.com/questions/39542731/go-interfaces-as-return-values/39543188#39543188", "title": "Go: interfaces as return values", "body": "<p>Pass a pointer to the sice as an argument:</p>\n\n<pre><code>func LookUp(collection string, ids []string, result interface{}) error {\n     // Is in cache?\n     // if not get them from database\n     return db.C(collection).Find(bson.M{\"_id\": bson.M{\"$in\": ids}}).All(result)\n}\n</code></pre>\n\n<p>Call it like this:</p>\n\n<pre><code>var dogs []*Doc\nerr := Lookup(\"dog\", dogIds, &amp;dogs)\nif err != nil \n   // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 5778483, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/530ecad826cab806010c68d4a5c7e605?s=128&d=identicon&r=PG&f=1", "display_name": "Marcos", "link": "https://stackoverflow.com/users/5778483/marcos"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 73, "favorite_count": 1, "accepted_answer_id": 39543188, "answer_count": 2, "score": 1, "last_activity_date": 1474090292, "creation_date": 1474085007, "question_id": 39542731, "link": "https://stackoverflow.com/questions/39542731/go-interfaces-as-return-values", "title": "Go: interfaces as return values", "body": "<p>I have several structs which I fill with data from MongoDB.</p>\n\n<pre><code>type Dog struct {\n    Id string\n    Age int\n}\n\ntype Invoice struct {\n    Id int\n    Amount float\n}\n</code></pre>\n\n<p>I was trying to make a function like this:</p>\n\n<pre><code>func LookUp(collection string, ids []string) []interface{} {\n         // Is in cache?\n         // if not get them from database\n    }\n</code></pre>\n\n<p>This way i could do something like:</p>\n\n<pre><code> func GoodDogs() []string{\n             // Give the ids of good dogs\n        }\n\n dogsIds := GoodDogs()\n dogs := LookUp(\"Dogs\", namesToRetrieve)\n</code></pre>\n\n<p>I know i could write the same function over and over for each struct, setting the correct return type and id type (notice some are int, some strings) but... seems too anti DRY.</p>\n\n<p>Interfaces seem to work the other way, for the inputs.\nIs there a way to do what I'm trying? Or is this is just a wrong design pattern?</p>\n"}, {"tags": ["html", "heroku", "go"], "answers": [{"comments": [{"owner": {"reputation": 23, "user_id": 6841495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6355622529cff63c78daf36b00c4906b?s=128&d=identicon&r=PG&f=1", "display_name": "FareSoldi", "link": "https://stackoverflow.com/users/6841495/faresoldi"}, "edited": false, "score": 0, "creation_date": 1474114452, "post_id": 39542073, "comment_id": 66405744, "body": "How would I then block access to the pictures, the javascript files and the general source of the application?"}, {"owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "reply_to_user": {"reputation": 23, "user_id": 6841495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6355622529cff63c78daf36b00c4906b?s=128&d=identicon&r=PG&f=1", "display_name": "FareSoldi", "link": "https://stackoverflow.com/users/6841495/faresoldi"}, "edited": false, "score": 1, "creation_date": 1474117439, "post_id": 39542073, "comment_id": 66406639, "body": "You don&#39;t.  That&#39;s how the internet works - if you want javascript to run in the browser, you have to give them the javascript.  If you want a picture to show up in the browser, you have to give them the picture."}, {"owner": {"reputation": 23, "user_id": 6841495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6355622529cff63c78daf36b00c4906b?s=128&d=identicon&r=PG&f=1", "display_name": "FareSoldi", "link": "https://stackoverflow.com/users/6841495/faresoldi"}, "edited": false, "score": 0, "creation_date": 1474117593, "post_id": 39542073, "comment_id": 66406670, "body": "I surely don&#39;t mind that but, I don&#39;t want people to be able to access my files via / by just typing the filename, I want all calls to / to redirect to the index.html unless it&#39;s a call from the app itself"}], "tags": [], "owner": {"reputation": 49343, "user_id": 2082673, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/gmyMb.jpg?s=128&g=1", "display_name": "dave", "link": "https://stackoverflow.com/users/2082673/dave"}, "is_accepted": true, "score": 2, "last_activity_date": 1474076130, "creation_date": 1474076130, "answer_id": 39542073, "question_id": 39542025, "link": "https://stackoverflow.com/questions/39542025/serving-html5-application-via-golang/39542073#39542073", "title": "Serving HTML5 Application via Golang", "body": "<p>You've set up a handler to serve exactly one file, but you apparently don't have anything set up to serve anything other than the file at <code>html/index.html</code>.  You probably want to set up a file server for the entire directory:</p>\n\n<pre><code>http.Handle(\"/\", http.FileServer(http.Dir(\"./html\")))\n</code></pre>\n"}], "owner": {"reputation": 23, "user_id": 6841495, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6355622529cff63c78daf36b00c4906b?s=128&d=identicon&r=PG&f=1", "display_name": "FareSoldi", "link": "https://stackoverflow.com/users/6841495/faresoldi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 173, "favorite_count": 1, "accepted_answer_id": 39542073, "answer_count": 1, "score": 2, "last_activity_date": 1474076130, "creation_date": 1474075516, "question_id": 39542025, "link": "https://stackoverflow.com/questions/39542025/serving-html5-application-via-golang", "title": "Serving HTML5 Application via Golang", "body": "<p>I recently made a golang application and hosted it on Heroku, and I'd like to serve my HTML5 via the golang net/http router (at \"/serv\"), The server is working well, but when I type in:</p>\n\n<pre><code>http.ServeFile(w, r, \"html/index.html\")\n</code></pre>\n\n<p>The page loads and the name of my html app appears, but the app doesn't load and it basically stays as a black screen.</p>\n\n<p>My html5 application looks like this in (localhost)\n<a href=\"http://i.stack.imgur.com/EtmCw.png\" rel=\"nofollow\">Here...</a></p>\n\n<p>And my file directory for the html5 application is\n<a href=\"http://i.stack.imgur.com/P7Sbp.png\" rel=\"nofollow\">Here,,,</a></p>\n"}, {"tags": ["go", "graphics", "raytracing"], "owner": {"reputation": 1550, "user_id": 2731457, "user_type": "registered", "accept_rate": 81, "profile_image": "https://www.gravatar.com/avatar/211467698cabb34f3d73c1c5ea6a0f0a?s=128&d=identicon&r=PG&f=1", "display_name": "Kyranstar", "link": "https://stackoverflow.com/users/2731457/kyranstar"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 73, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1474077785, "creation_date": 1474068712, "last_edit_date": 1474077785, "question_id": 39541395, "link": "https://stackoverflow.com/questions/39541395/stripes-in-ray-tracer-transparency", "title": "Stripes in ray tracer transparency", "body": "<p>I'm writing a pathtracer in golang right now, and I have diffuse and specular materials working. However, my transparent materials look weird and ringed.</p>\n\n<p>What could be causing this?<a href=\"https://i.stack.imgur.com/s7iXb.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/s7iXb.png\" alt=\"refracting sphere\"></a></p>\n\n<p>This is the relevant code:</p>\n\n<p>Integrator:</p>\n\n<pre><code>func render(scene *Scene, cam *Camera, img *image.RGBA) {\n    random := rand.New(rand.NewSource(1))\n    for y := Height - 1; y &gt;= 0; y-- {\n        for x := 0; x &lt; Width; x++ {\n            col := RGB{0.0, 0.0, 0.0}\n\n            for i := 0; i &lt; SPP; i++ {\n                u := (float64(x) + random.Float64()) / float64(Width)\n                v := (float64(y) + random.Float64()) / float64(Height)\n\n                r := cam.RayAt(u, v, random)\n\n                c := getColor(r, scene, 0, random)\n                col.R += c.R\n                col.G += c.G\n                col.B += c.B\n            }\n            col.R *= 255.0 / SPP\n            col.G *= 255.0 / SPP\n            col.B *= 255.0 / SPP\n            img.Set(x, y, color.RGBA{uint8(col.R), uint8(col.G), uint8(col.B), uint8(255)})\n        }\n    }\n\n}\nfunc getColor(r Ray, scene *Scene, depth int, rnd *rand.Rand) RGB {\n    if depth &gt; MaxDepth {\n        return background(r)\n    }\n    b, hit := scene.Hit(r, tMin, tMax)\n\n    if b {\n        bounced, bouncedRay := hit.Bounce(r, rnd.Float64(), rnd.Float64(), hit, rnd)\n        if bounced {\n            bounceColor := getColor(bouncedRay, scene, depth+1, rnd)\n            return hit.Material.Color().Multiply(bounceColor)\n        }\n        return hit.Material.Color()\n    }\n    return background(r)\n}\n</code></pre>\n\n<p>Material:</p>\n\n<pre><code>type Material struct {\n    Col          RGB\n    Index        float64 // refractive index\n    Reflectivity float64\n    Transparency float64 // the amount of light to let through\n    Gloss        float64 // reflection cone angle in radians\n}\n\nfunc (m *Material) Color() RGB {\n    return m.Col\n}\n\nfunc (m *Material) Bounce(r Ray, fu, fv float64, hit Hit, rnd *rand.Rand) (bool, Ray) {\n\n    var direction Vector\n\n    if m.Reflectivity &gt; 0 &amp;&amp; rnd.Float64() &lt; m.Reflectivity {\n        // we should reflect\n        reflectDirection := r.Direction.Reflect(hit.Normal)\n        direction = Cone(reflectDirection, m.Gloss, fu, fv, rnd)\n\n    } else if m.Transparency &gt; 0 &amp;&amp; rnd.Float64() &lt; m.Transparency {\n        // we should refract\n        _, direction = r.Direction.Refract(hit.Normal, m.Index)\n    } else {\n        direction = hit.Normal.Add(VectorInUnitSphere(rnd))\n    }\n\n    return true, Ray{hit.Point, direction}\n}\n</code></pre>\n\n<p>Vector:</p>\n\n<pre><code>func (v Vector) Refract(ov Vector, n float64) (bool, Vector) {\n    uv := v.Normalize()\n    uo := ov.Normalize()\n    dt := uv.Dot(uo)\n    discriminant := 1.0 - (n * n * (1 - dt*dt))\n    if discriminant &gt; 0 {\n        a := uv.Subtract(ov.MultiplyScalar(dt)).MultiplyScalar(n)\n        b := ov.MultiplyScalar(math.Sqrt(discriminant))\n        return true, a.Subtract(b)\n    }\n    return false, Vector{}\n}\n</code></pre>\n"}, {"tags": ["go", "microservices"], "answers": [{"tags": [], "owner": {"reputation": 123, "user_id": 928451, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf2de06cc77365d66e93fb46ed79480e?s=128&d=identicon&r=PG", "display_name": "Marcus", "link": "https://stackoverflow.com/users/928451/marcus"}, "is_accepted": false, "score": 5, "last_activity_date": 1489059928, "creation_date": 1489059928, "answer_id": 42694564, "question_id": 39540366, "link": "https://stackoverflow.com/questions/39540366/go-kit-real-world-example-with-inter-microservice-data-transfers/42694564#42694564", "title": "Go-kit real world example with inter microservice data transfers", "body": "<p>I'm the author of the shipping example. Sorry for not seeing your question earlier.</p>\n\n<p>This particular example needs a bit of explanation. It is an example based on tactical patterns from Domain Driven Design, which means that we need to understand what we are talking about when we're referring to a <em>service</em>.</p>\n\n<p>There are <em>application services</em> that deal with the use cases offered by the application, e.g. <code>booking.Service</code>. There are <em>domain services</em> that reside in the domain layer and provides your domain with concepts that aren't necessarily bound to a domain object. In the shipping example, <code>routing.Service</code> is a domain service whose implementation actually queries another application, in this case it talks to <a href=\"https://github.com/marcusolsson/pathfinder\" rel=\"noreferrer\">this routing service</a>.</p>\n\n<p>Application and domain services are merely ways of organizing our code. Putting it differently, these services communicate within a process, while <em>microservices</em> typically communicate over a network using some form of common transport, e.g. JSON, gRPC and so on.</p>\n\n<p>Coming back to your question, what I believe you are looking for is the implementation of the <code>routing.Service</code> which you can find <a href=\"https://github.com/go-kit/kit/blob/master/examples/shipping/routing/proxying.go\" rel=\"noreferrer\">here</a>.</p>\n\n<p>The proxy service used here is explained under <strong>Client-side endpoints</strong> on <a href=\"http://gokit.io/examples/stringsvc.html\" rel=\"noreferrer\">this page</a>, and is used to make requests from your application to another.</p>\n\n<p>If you want more detail, I wrote a <a href=\"https://www.citerus.se/part-3-domain-driven-design-in-go\" rel=\"noreferrer\">blog post</a> on the subject a while ago.</p>\n"}], "owner": {"reputation": 51, "user_id": 6841141, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ce1d434130e6923aba6698c4fb90638e?s=128&d=identicon&r=PG&f=1", "display_name": "Serge B", "link": "https://stackoverflow.com/users/6841141/serge-b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1669, "favorite_count": 4, "answer_count": 1, "score": 5, "last_activity_date": 1489059928, "creation_date": 1474061496, "last_edit_date": 1474074347, "question_id": 39540366, "link": "https://stackoverflow.com/questions/39540366/go-kit-real-world-example-with-inter-microservice-data-transfers", "title": "Go-kit real world example with inter microservice data transfers", "body": "<p>I try to work with go-kit (gokit.io) and to build real-work application with it.\nI look through examples. These examples are great. But I do not understand how to do services to service communications / data transfers in go-kit framework. </p>\n\n<p>I can see \"real-world\" shipping app, but I do not understand how it could be \"real world\" micro-services. I can see in sources that, for example, they build the booking service just passing foreign repositories into service</p>\n\n<pre><code>type service struct {\n    cargoRepository         cargo.Repository\n    locationRepository      location.Repository\n    routingService          routing.Service\n    handlingEventRepository cargo.HandlingEventRepository\n}\n</code></pre>\n\n<p>and later they get data from repositories (this repository belongs to foreign micro-service) just calling the method:</p>\n\n<p><code>locationRepository.Find(...)</code></p>\n\n<p>Could someone please explain me:</p>\n\n<ul>\n<li>how to build micro-service to micro-service communications in go-kit framework? Just show me the way / pattern, please. I do not understand it at all.</li>\n</ul>\n\n<p>I see it as they just share direct access to data. But in real world micro-services, I expected that micro-services will communicate to each other to get needed data. And I do not understand how to do it in go-kit framework.</p>\n"}, {"tags": ["linux", "debugging", "intellij-idea", "go"], "answers": [{"tags": [], "owner": {"reputation": 459, "user_id": 3355599, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FD36Q.jpg?s=128&g=1", "display_name": "Flamine", "link": "https://stackoverflow.com/users/3355599/flamine"}, "is_accepted": false, "score": 0, "last_activity_date": 1479460766, "creation_date": 1479460766, "answer_id": 40673287, "question_id": 39539884, "link": "https://stackoverflow.com/questions/39539884/debugger-is-not-work-in-intellij-idea-with-go-plugin/40673287#40673287", "title": "Debugger is not work in IntelliJ IDEA with &quot;Go&quot; plugin", "body": "<p>I found not answear, but i have to reinstall my operation system and now all right</p>\n"}], "owner": {"reputation": 459, "user_id": 3355599, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/FD36Q.jpg?s=128&g=1", "display_name": "Flamine", "link": "https://stackoverflow.com/users/3355599/flamine"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 418, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1479460766, "creation_date": 1474058964, "last_edit_date": 1495542255, "question_id": 39539884, "link": "https://stackoverflow.com/questions/39539884/debugger-is-not-work-in-intellij-idea-with-go-plugin", "title": "Debugger is not work in IntelliJ IDEA with &quot;Go&quot; plugin", "body": "<p>I install IntelliJ IDEA, go1.4, go plugin for Idea. Now I can run GO code, but cant use debuger.<a href=\"https://i.stack.imgur.com/ZsMJ5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/ZsMJ5.png\" alt=\"enter image description here\"></a></p>\n\n<p>After debug, I see errors in console</p>\n\n<pre><code>panic: &lt;nil&gt; not an Int\n\ngoroutine 68 [running]:\ngo/constant.Int64Val(0x0, 0x0, 0x2, 0xc8200d5180)\n    /usr/local/go/src/go/constant/value.go:236 +0x338\ngithub.com/derekparker/delve/proc.(*Variable).parseG(0xc8200a6700, 0xc8200a6700, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/proc/variables.go:387 +0x734\ngithub.com/derekparker/delve/proc.(*Thread).GetG(0xc8200e4690, 0xc8200e4690, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/proc/threads.go:295 +0x69\ngithub.com/derekparker/delve/proc.(*Thread).SetCurrentBreakpoint(0xc8200e4690, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/proc/threads.go:352 +0x18e\ngithub.com/derekparker/delve/proc.(*Process).setCurrentBreakpoints(0xc820116100, 0xc8200e4690, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/proc/proc_linux.go:413 +0x9b\ngithub.com/derekparker/delve/proc.(*Process).Continue(0xc820116100, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/proc/proc.go:311 +0x214\ngithub.com/derekparker/delve/service/debugger.(*Debugger).Command(0xc82010a720, 0xc82010a8a0, 0x0, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/service/debugger/debugger.go:394 +0x847\ngithub.com/derekparker/delve/service/rpc1.(*RPCServer).Command(0xc82081c140, 0xc82010a8a0, 0x7f86a9daaa38, 0xc820114300)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/service/rpc1/server.go:52 +0x2f\nreflect.Value.call(0x945540, 0xa69c40, 0x13, 0xa84850, 0x4, 0xc820080280, 0x3, 0x3, 0x0, 0x0, ...)\n    /usr/local/go/src/reflect/value.go:432 +0x120a\nreflect.Value.Call(0x945540, 0xa69c40, 0x13, 0xc820080280, 0x3, 0x3, 0x0, 0x0, 0x0)\n    /usr/local/go/src/reflect/value.go:300 +0xb1\ncreated by github.com/derekparker/delve/service/rpccommon.(*ServerImpl).serveJSONCodec\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/service/rpccommon/server.go:298 +0xf70\n\ngoroutine 1 [chan receive]:\ngithub.com/derekparker/delve/cmd/dlv/cmds.execute(0x0, 0xc8201143c0, 0x1, 0x4, 0xc82010e038, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/cmd/dlv/cmds/commands.go:428 +0xad5\ngithub.com/derekparker/delve/cmd/dlv/cmds.New.func4(0xc820120c00, 0xc8201143c0, 0x1, 0x4)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/cmd/dlv/cmds/commands.go:154 +0x53\ngithub.com/derekparker/delve/vendor/github.com/spf13/cobra.(*Command).execute(0xc820120c00, 0xc8201142c0, 0x4, 0x4, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/vendor/github.com/spf13/cobra/command.go:569 +0x869\ngithub.com/derekparker/delve/vendor/github.com/spf13/cobra.(*Command).ExecuteC(0xc820120400, 0xc820120c00, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/vendor/github.com/spf13/cobra/command.go:656 +0x56b\ngithub.com/derekparker/delve/vendor/github.com/spf13/cobra.(*Command).Execute(0xc820120400, 0x0, 0x0)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/vendor/github.com/spf13/cobra/command.go:615 +0x2d\nmain.main()\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/cmd/dlv/main.go:13 +0x4a\n\ngoroutine 17 [syscall, locked to thread]:\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:1696 +0x1\n\ngoroutine 5 [syscall]:\nos/signal.loop()\n    /usr/local/go/src/os/signal/signal_unix.go:22 +0x18\ncreated by os/signal.init.1\n    /usr/local/go/src/os/signal/signal_unix.go:28 +0x37\n\ngoroutine 18 [chan receive, locked to thread]:\ngithub.com/derekparker/delve/proc.(*Process).handlePtraceFuncs(0xc820116100)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/proc/proc.go:774 +0xc3\ncreated by github.com/derekparker/delve/proc.New\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/proc/proc.go:82 +0x1d0\n\ngoroutine 67 [IO wait]:\nnet.runtime_pollWait(0x7f86b0656290, 0x72, 0xc8200181c0)\n    /usr/local/go/src/runtime/netpoll.go:157 +0x60\nnet.(*pollDesc).Wait(0xc82012a290, 0x72, 0x0, 0x0)\n    /usr/local/go/src/net/fd_poll_runtime.go:73 +0x3a\nnet.(*pollDesc).WaitRead(0xc82012a290, 0x0, 0x0)\n    /usr/local/go/src/net/fd_poll_runtime.go:78 +0x36\nnet.(*netFD).Read(0xc82012a230, 0xc82032c000, 0x200, 0x200, 0x0, 0x7f86b1e98050, 0xc8200181c0)\n    /usr/local/go/src/net/fd_unix.go:232 +0x23a\nnet.(*conn).Read(0xc82055a000, 0xc82032c000, 0x200, 0x200, 0x0, 0x0, 0x0)\n    /usr/local/go/src/net/net.go:172 +0xe4\nencoding/json.(*Decoder).refill(0xc820132000, 0x0, 0x0)\n    /usr/local/go/src/encoding/json/stream.go:152 +0x287\nencoding/json.(*Decoder).readValue(0xc820132000, 0x1, 0x0, 0x0)\n    /usr/local/go/src/encoding/json/stream.go:128 +0x41b\nencoding/json.(*Decoder).Decode(0xc820132000, 0x99b9a0, 0xc82012e080, 0x0, 0x0)\n    /usr/local/go/src/encoding/json/stream.go:57 +0x159\nnet/rpc/jsonrpc.(*serverCodec).ReadRequestHeader(0xc82012e060, 0xc82010a100, 0x0, 0x0)\n    /usr/local/go/src/net/rpc/jsonrpc/server.go:66 +0x7c\ngithub.com/derekparker/delve/service/rpccommon.(*ServerImpl).serveJSONCodec(0xc8201124b0, 0x7f86a9daa698, 0xc82055a000)\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/service/rpccommon/server.go:252 +0x3ec\ncreated by github.com/derekparker/delve/service/rpccommon.(*ServerImpl).Run.func1\n    /opt/buildAgent/work/b97f8195591f35ac/gopath/src/github.com/derekparker/delve/service/rpccommon/server.go:145 +0x185\n\ngoroutine 15 [select, locked to thread]:\nruntime.gopark(0xb97eb0, 0xc82051af28, 0xa8d4a0, 0x6, 0x42bf18, 0x2)\n    /usr/local/go/src/runtime/proc.go:185 +0x163\nruntime.selectgoImpl(0xc82051af28, 0x0, 0x18)\n    /usr/local/go/src/runtime/select.go:392 +0xa64\nruntime.selectgo(0xc82051af28)\n    /usr/local/go/src/runtime/select.go:212 +0x12\nruntime.ensureSigM.func1()\n    /usr/local/go/src/runtime/signal1_unix.go:227 +0x353\nruntime.goexit()\n    /usr/local/go/src/runtime/asm_amd64.s:1696 +0x1\n</code></pre>\n\n<p>I can run code, it work. Can debug without breakpoints (maybe its run mode) Bun on first breakpoint in code - error in console.\n<a href=\"https://stackoverflow.com/questions/27691782/intellij-idea-go-lang-idea-plugin-alpha-debugging-under-ubuntu\">This</a> question is not actuality now.</p>\n"}, {"tags": ["parsing", "go", "time", "timestamp-with-timezone"], "comments": [{"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 1, "creation_date": 1474056362, "post_id": 39539210, "comment_id": 66392633, "body": "It&#39;s even stranger for me. If I run is with time zone set in the shell (<code>TZ=MSK go run foo.go</code>) it gives me UTC. By the way, if you want your dates to be UTC you can replace <code>+00:00</code> with <code>Z</code>."}, {"owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "reply_to_user": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "edited": false, "score": 0, "creation_date": 1474057624, "post_id": 39539210, "comment_id": 66393184, "body": "I don&#39;t want to, that&#39;s a json output from postgresql (and it&#39;s valid) :)"}, {"owner": {"reputation": 651, "user_id": 621973, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/88f4ee43bc2722fdd9240db6da9c0b39?s=128&d=identicon&r=PG", "display_name": "foo", "link": "https://stackoverflow.com/users/621973/foo"}, "edited": false, "score": 0, "creation_date": 1474259789, "post_id": 39539210, "comment_id": 66441275, "body": "The time package is mocked in the playground, results may be different on the real runtime - <a href=\"https://blog.golang.org/playground\" rel=\"nofollow noreferrer\">blog.golang.org/playground</a>"}], "answers": [{"comments": [{"owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1474056752, "post_id": 39539352, "comment_id": 66392795, "body": "My english must be too poor, because that part of the doc is very unclear to me :("}, {"owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1474056843, "post_id": 39539352, "comment_id": 66392831, "body": "the problem is, I need to compare this timestamp. It&#39;s using a +00:00 offset, so I should compare it with <code>time.Date(2015, time.June, 01, 00, 0, 0, 0, time.UTC)</code> (my test shouldn&#39;t depend on my location). Here, the 2 times differ :("}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "reply_to_user": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1474068013, "post_id": 39539352, "comment_id": 66396470, "body": "Then use <a href=\"https://golang.org/pkg/time/#ParseInLocation\" rel=\"nofollow noreferrer\"><code>time.ParseInLocation</code></a> instead."}, {"owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1474228751, "post_id": 39539352, "comment_id": 66434622, "body": "I don&#39;t parse location directly, Unmarshall does, and I don&#39;t have control on this :("}, {"owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1474228984, "post_id": 39539352, "comment_id": 66434694, "body": "Looks like a go bug to me. Parsing timestamps with a specified offset should REALLY not depend on my location. UTC is UTC, not matter where I am"}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "reply_to_user": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1474242573, "post_id": 39539352, "comment_id": 66437841, "body": "@Gravis And it <i>is</i> UTC, only the location name is not looked up."}, {"owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1474371075, "post_id": 39539352, "comment_id": 66494619, "body": "I understand that, but this makes reflect.deepEqual failing when comparing structs. So again, <code>time.Date(2015, time.June, 01, 00, 0, 0, 0, time.UTC)</code> should return the exact same date, but they are still different. Do you think I should open an issue in the go repo?"}, {"owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "reply_to_user": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "edited": false, "score": 0, "creation_date": 1474382437, "post_id": 39539352, "comment_id": 66502705, "body": "I see. In that case it is probably best to open an issue and discuss it there, yes. When you do, please update your question with the link to the issue."}], "tags": [], "owner": {"reputation": 47141, "user_id": 1643939, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Mww2p.png?s=128&g=1", "display_name": "nemo", "link": "https://stackoverflow.com/users/1643939/nemo"}, "is_accepted": false, "score": 2, "last_activity_date": 1474056488, "creation_date": 1474056488, "answer_id": 39539352, "question_id": 39539210, "link": "https://stackoverflow.com/questions/39539210/why-go-is-parsing-my-timestamp-with-local-location-instead-of-utc/39539352#39539352", "title": "Why go is parsing my timestamp with Local location instead of UTC", "body": "<blockquote>\n  <p>When parsing a time with a zone offset like -0700, if the offset corresponds to a time zone used by the current location (Local), then Parse uses that location and zone in the returned time. Otherwise it records the time as being in a fabricated location with time fixed at the given zone offset. [<a href=\"https://golang.org/pkg/time/#Parse\" rel=\"nofollow\">time.Parse</a>]</p>\n</blockquote>\n\n<p><code>t.Location</code> (a name) is only set when the local offset matches the offset that is in the parsed date string. You probably have a different time zone set.</p>\n\n<p>So the offset is recorded but the location is not looked up.</p>\n"}], "owner": {"reputation": 25813, "user_id": 62612, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/886132d118e6db4b08dc816c2b7026f6?s=128&d=identicon&r=PG", "display_name": "Gravis", "link": "https://stackoverflow.com/users/62612/gravis"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 380, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1474056488, "creation_date": 1474055709, "question_id": 39539210, "link": "https://stackoverflow.com/questions/39539210/why-go-is-parsing-my-timestamp-with-local-location-instead-of-utc", "title": "Why go is parsing my timestamp with Local location instead of UTC", "body": "<p>I don't understand this behaviour (or the doc) of this: \n<a href=\"https://play.golang.org/p/vz2UTz-3Yy\" rel=\"nofollow\">https://play.golang.org/p/vz2UTz-3Yy</a></p>\n\n<p>On the playground, it return the expected results:</p>\n\n<pre><code>t = 2015-06-01 00:00:00 +0000 UTC\nt.Location() = UTC\nparsed = 2015-06-01 00:00:00 +0000 UTC\nparsed.Location() = UTC\n</code></pre>\n\n<p>On my mac, I get:</p>\n\n<pre><code>t = 2015-06-01 00:00:00 +0000 +0000\nt.Location() =\nparsed = 2015-06-01 00:00:00 +0000 +0000\nparsed.Location() =\n</code></pre>\n\n<p>The problem is, if I create a date with</p>\n\n<pre><code>time.Date(2015, time.June, 01, 00, 0, 0, 0, time.UTC)\n</code></pre>\n\n<p>the 2 times are different, because one has a location (\"UTC\"), and the other not (or \"Local\"). I'm bit lost here.</p>\n\n<p>Thanks</p>\n"}, {"tags": ["go", "hugo"], "comments": [{"owner": {"reputation": 249, "user_id": 1167061, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/bce63ad69c94c4193350ee4d3a25ef05?s=128&d=identicon&r=PG", "display_name": "k4rtik", "link": "https://stackoverflow.com/users/1167061/k4rtik"}, "edited": false, "score": 0, "creation_date": 1474161501, "post_id": 39537735, "comment_id": 66417919, "body": "Have you tried deleting <code>list.html</code>, Hugo should produce a default list for your custom type? I would also try <code>{{range .Data.Property }}</code> (ie, singular), just to be sure. Reference is at <a href=\"http://gohugo.io/templates/list/\" rel=\"nofollow noreferrer\">gohugo.io/templates/list</a>"}], "answers": [{"tags": [], "owner": {"reputation": 409, "user_id": 5761286, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/t8Nyd.png?s=128&g=1", "display_name": "Rafed Muhammad Yasir", "link": "https://stackoverflow.com/users/5761286/rafed-muhammad-yasir"}, "is_accepted": false, "score": 0, "last_activity_date": 1603896823, "last_edit_date": 1603896823, "creation_date": 1603895264, "answer_id": 64574921, "question_id": 39537735, "link": "https://stackoverflow.com/questions/39537735/hugo-rendering-list-view-for-a-custom-content-type/64574921#64574921", "title": "Hugo - rendering list view for a custom content type", "body": "<p>Modifying <strong>layouts/_default/single.html</strong> won't work. You need to customize the <strong>layout/_default/list.html</strong>. Try the following code in it.</p>\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-html lang-html prettyprint-override\"><code>{{ range .Site.RegularPages.ByDate.Reverse }}\n     &lt;h4&gt;{{ .Title }}&lt;/h4&gt;\n     &lt;p&gt;{{ .Summary }}&lt;/p&gt;\n     &lt;div&gt; {{ .otherVariables }} &lt;/div&gt;\n{{ end }}</code></pre>\r\n</div>\r\n</div>\r\n</p>\n<p>Since you are using a custom content-type called properties, you should put this in <strong>layouts/properties/list.html</strong>.</p>\n"}], "owner": {"reputation": 153, "user_id": 3036721, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/2febd2b9ad3c37091344c2592ee722f3?s=128&d=identicon&r=PG&f=1", "display_name": "asebold", "link": "https://stackoverflow.com/users/3036721/asebold"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1204, "favorite_count": 0, "answer_count": 1, "score": 4, "last_activity_date": 1603896823, "creation_date": 1474049606, "question_id": 39537735, "link": "https://stackoverflow.com/questions/39537735/hugo-rendering-list-view-for-a-custom-content-type", "title": "Hugo - rendering list view for a custom content type", "body": "<p>We created a custom content type called \"properties\". Our content directory looks as follows: content/property/. We then created a single and list layout for the properties in our theme: themes/theme_name/layouts/property/. </p>\n\n<p>Single works fine. We can't get the list layout to work at all. What template functions do we need to iterate over our properties in a list view? In single.html we use <code>{{range .Data.Properties }}</code> and <code>{{ range .Data.Page }}</code>, we also tried this in list.html. Basically, we just need to know how to iterate over data from markdown files for a specific content type on a page.  </p>\n"}, {"tags": ["go", "concurrency", "goroutine"], "comments": [{"owner": {"reputation": 28990, "user_id": 1114966, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/af8712b05e5cfb862323a07c83749054?s=128&d=identicon&r=PG", "display_name": "squiguy", "link": "https://stackoverflow.com/users/1114966/squiguy"}, "edited": false, "score": 0, "creation_date": 1474049911, "post_id": 39537728, "comment_id": 66389575, "body": "<code>dummyStruct</code> should also be thread-safe."}], "answers": [{"tags": [], "owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "is_accepted": true, "score": 11, "last_activity_date": 1474050550, "creation_date": 1474050550, "answer_id": 39537990, "question_id": 39537728, "link": "https://stackoverflow.com/questions/39537728/using-a-pointer-receiver-in-a-goroutine/39537990#39537990", "title": "Using a pointer receiver in a goroutine", "body": "<p>If you are modifying state of <code>m</code>, you'll need a mutex lock and careful locking patterns.</p>\n\n<p>Other than that, this will increase context switching across your thread boundries under most circumstances.</p>\n\n<p>This is why we have the Go idiom:</p>\n\n<blockquote>\n  <p>Do not communicate by sharing memory; \n  instead, share memory by communicating.</p>\n</blockquote>\n\n<p><a href=\"https://blog.golang.org/share-memory-by-communicating\" rel=\"noreferrer\">https://blog.golang.org/share-memory-by-communicating</a></p>\n"}, {"comments": [{"owner": {"reputation": 15991, "user_id": 56693, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/f8c3348c144b3d7c7d16264bb2adf7ee?s=128&d=identicon&r=PG", "display_name": "eduncan911", "link": "https://stackoverflow.com/users/56693/eduncan911"}, "edited": false, "score": 0, "creation_date": 1486385296, "post_id": 39538506, "comment_id": 71307592, "body": "on mobile isn&#39;t the best way to write code on stackoverflow.  ;)"}], "tags": [], "owner": {"reputation": 9768, "user_id": 1380669, "user_type": "registered", "accept_rate": 62, "profile_image": "https://i.stack.imgur.com/p3JDz.jpg?s=128&g=1", "display_name": "Plato", "link": "https://stackoverflow.com/users/1380669/plato"}, "is_accepted": false, "score": 1, "last_activity_date": 1474052549, "creation_date": 1474052549, "answer_id": 39538506, "question_id": 39537728, "link": "https://stackoverflow.com/questions/39537728/using-a-pointer-receiver-in-a-goroutine/39538506#39538506", "title": "Using a pointer receiver in a goroutine", "body": "<p>I'd seen the link @eduncan911 posted but never tried to apply it. Hopefully this example helps:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\ntype dummyStruct struct {\n    a int\n}\n\nfunc (m *dummyStruct) doSomethingElse() {\n    fmt.Println(m.a)\n}\n\nfunc doSomething(c chan int) {\n    for i := 0; i &lt; 5; i++ {\n        go func() {\n            x := time.Now().Unix()\n            c &lt;- int(x)\n        }()\n        time.Sleep(time.Second)\n    }\n}\n\nfunc main() {\n    outputs := make(chan int)\n    m := &amp;dummyStruct{}\n    doSomething(outputs)\n    for {\n        //block until we can read from channel:\n        x := &lt;-outputs\n        m.a = x\n        m.doSomethingElse()\n    }\n}\n\n//Output:\ngo run main.go\n1474052448\n1474052449\n1474052450\n1474052451\n1474052452\nfatal error: all goroutines are asleep - deadlock!\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 8230, "user_id": 204313, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/5d561f2de0f27818ee920dbc9e4a8a4d?s=128&d=identicon&r=PG", "display_name": "Rick-777", "link": "https://stackoverflow.com/users/204313/rick-777"}, "edited": false, "score": 0, "creation_date": 1486383922, "post_id": 39569070, "comment_id": 71306688, "body": "This is true - the reason is that sharing mutable data can easily lead to problems due to race conditions."}], "tags": [], "owner": {"reputation": 116, "user_id": 6559048, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fd934e39469f78fbf51808f698c75917?s=128&d=identicon&r=PG&f=1", "display_name": "ganesh kumar", "link": "https://stackoverflow.com/users/6559048/ganesh-kumar"}, "is_accepted": false, "score": 1, "last_activity_date": 1474275254, "creation_date": 1474275254, "answer_id": 39569070, "question_id": 39537728, "link": "https://stackoverflow.com/questions/39537728/using-a-pointer-receiver-in-a-goroutine/39569070#39569070", "title": "Using a pointer receiver in a goroutine", "body": "<p>I think Pointer is not the right way to share data with respect to goroutines, as it will decrease the performance. The best option is channels.</p>\n"}], "owner": {"reputation": 3584, "user_id": 743761, "user_type": "registered", "accept_rate": 65, "profile_image": "https://www.gravatar.com/avatar/abe8647a64a9d4220d601a4a32499493?s=128&d=identicon&r=PG&f=1", "display_name": "Keeto", "link": "https://stackoverflow.com/users/743761/keeto"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3511, "favorite_count": 0, "accepted_answer_id": 39537990, "answer_count": 3, "score": 9, "last_activity_date": 1474275254, "creation_date": 1474049576, "last_edit_date": 1474050175, "question_id": 39537728, "link": "https://stackoverflow.com/questions/39537728/using-a-pointer-receiver-in-a-goroutine", "title": "Using a pointer receiver in a goroutine", "body": "<p>I have a method with a pointer receiver, I was wondering if using this pointer receiver is safe to use inside a goroutine within this method? or should I pass this pointer receiver as a parameter?</p>\n\n<p>for example:</p>\n\n<pre><code>func (m *dummyStruct) doSomething {\n    /* do a bunch of stuff */\n    go func() {\n        m.a = x\n        m.doSomethingElse()\n    }()\n    return y\n}\n</code></pre>\n\n<p>I know that I can not go wrong by passing m as a parameter to the goroutine but I was wondering if it is extremely necessary</p>\n"}]