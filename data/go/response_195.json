[{"tags": ["firebase", "go", "google-cloud-firestore", "google-admin-sdk"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538633396, "post_id": 52636388, "comment_id": 92212514, "body": "Please post the output of doc.Data(dummy) to check its structure so that we can store it inside golang struct."}, {"owner": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538653669, "post_id": 52636388, "comment_id": 92223748, "body": "OK... I just added two documents from the output and explanation.  There has got to be a simpler way to marshal these maps into the struct than doing each field individually."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1538669731, "post_id": 52636388, "comment_id": 92234282, "body": "What to the structs look like? How many fields are there? Are the fields simple primitive types or complex, nested types?"}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 1, "last_activity_date": 1538672171, "last_edit_date": 1538672171, "creation_date": 1538671030, "answer_id": 52651659, "question_id": 52636388, "link": "https://stackoverflow.com/questions/52636388/golang-firebase-converting-a-map-to-a-struct-slice/52651659#52651659", "title": "Golang, Firebase... converting a MAP to a struct slice", "body": "<p>It looks like you're getting result data from Firebase with type <code>map[string]interface{}</code> and you need to convert it to type <code>map[string]*Foo</code> (where <code>Foo</code> is some struct defined elsewhere).</p>\n\n<p>If the <code>Foo</code> struct can easily be de/serialized into some intermediate format then you might be able to serialize the untyped values and then deserialize them into a variable of your desired type.</p>\n\n<p>For example, using JSON (<a href=\"https://play.golang.com/p/M8YC7ZtfKGP\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>docdata := getDocData()\nfor label, data := range docdata {\n    // Marshal the untyped data into a suitable format.\n    bs, err := json.Marshal(data)\n    check(err)\n    // Unmarshal the formatted data into a variable with desired type.\n    var foo *Foo\n    err = json.Unmarshal(bs, &amp;foo)\n    check(err)\n    fmt.Printf(\"OK: label=%q, foo=%#v\\n\", label, foo)\n}\n// OK: label=\"E01PCI\", foo=(*main.Foo)(nil)\n// OK: label=\"E06CPCI\", foo=(*main.Foo)(nil)\n// OK: label=\"DE03CABG\", foo=&amp;main.Foo{Name:\"Alpha\", SCOREGRAPHIC:\"Bravo\", SCORE:3.14159, INDICATION:true, SCOREDEFINITIONS:\"Echo\", Q01CAT:6, TermDescription:(*string)(nil)}\n// OK: label=\"DE06CCABG\", foo=&amp;main.Foo{Name:\"Hotel\", SCOREGRAPHIC:\"India\", SCORE:10.1, INDICATION:true, SCOREDEFINITIONS:\"Lima\", Q01CAT:13, TermDescription:(*string)(0x1050c3d0)}\n</code></pre>\n\n<p>It's unclear from your question whether the data in <code>doc.Data()</code> is the entire struct that you mention or some other sort of structured data which includes instances of your struct (my example assumes the latter); however, the general idea of serializing into an intermediate format and deserializing into a typed variable should work either way.</p>\n"}], "owner": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1871, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538672171, "creation_date": 1538604679, "last_edit_date": 1538653548, "question_id": 52636388, "link": "https://stackoverflow.com/questions/52636388/golang-firebase-converting-a-map-to-a-struct-slice", "title": "Golang, Firebase... converting a MAP to a struct slice", "body": "<p>how to convert a Document map Snapshot from firestore into a struct slice?  The struct is not displayed in this example, but the problem code is towards the end of the page.</p>\n\n<p>This code works except for the Marked Code at bottom. Code communicates with a FireStore DB and returns a complicated structure called COMPLEX_NONACS.  Bascially, I want to convert . firestore snapshot into a json golang object.</p>\n\n<pre><code>package main\n\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n\n    \"firebase.google.com/go\"\n    \"google.golang.org/api/iterator\"\n    \"google.golang.org/api/option\"\n)\n\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\nfunc main() {\n    ctx := context.Background()\n    sa := option.WithCredentialsFile(\"./scai-qit-fb-adminsdk.json\")\n    app, err := firebase.NewApp(ctx, nil, sa)\n    if err != nil {\n        log.Fatalf(\"error initializing app: %v\\n\", err)\n    }\n    client, err := app.Firestore(ctx)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer client.Close()\n\n    CompNACS := []string{}\n    var SCNACS COMPLEX_NONACS // single Complex NONACS\n    var MCNACS []COMPLEX_NONACS\n\n    iter := client.Collection(\"COMPLEX_NONACS\").Documents(ctx)\n    for {\n        doc, err := iter.Next()\n        if err == iterator.Done {\n            break\n        }\n        if err != nil {\n            log.Fatalf(\"Failed to iterate: %v\", err)\n        }\n        //This part works.  WIll return a Map of each Document\n        fmt.Println(\"--------------------------/n\")\n        fmt.Println(doc.Ref.ID)\n        fmt.Println(\"--/n\")\n        fmt.Println(doc.Data())\n\n        //  PUT ANSWER HERE...\n        // doc.Data() should return map[String] interface{} that is\n        // actually of a struct TYPE COMPLEX_NONACS.\n        // Question is there a simpler way to CAST doc.Data() as\n        // a type?  Docs say this...\n        // Data returns the DocumentSnapshot's fields as a map.\n        // It is equivalent to\n        //     var m map[string]interface{}\n        //     d.DataTo(&amp;m)\n        // except that it returns nil if the document does not exist.\n\n        //---   this is the error ---\n        //  The problem cannot convert to COMPLEX_NONACS  \n        SCNACS = COMPLEX_NONACS(doc.Data())\n        fmt.Println(SCNACS)\n\n        CompNACS = append(CompNACS, doc.Ref.ID)\n    }\n}\n</code></pre>\n\n<p>/==========================\nthe first two Documents...<br>\nThe structure is the same for all documents in the collection, but some Documents just have different combinations of fields.  I would list the struct, but it is huge.</p>\n\n<pre><code>--------------------------/n\nA01B01C01D01\n--/n\nmap[E01PCI: DE03CABG:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] E06CPCI: DE06CCABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DE01PCI:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] DE06CPCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DF03CABGPCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DE05CCABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DE04PCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DE07BPRIMARY:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] Q04PRIORCABG:No Previous CABG DF03PRIMARY:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] E06BPCI: E05BCABG: E06CCABG: DF04PRIMARY:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] DE05APCI:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] E03PCI: F03CABGPCI: DE06CABG:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] DE05CPCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] E04PRIMARY: DE05BPCI:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] DE04CABG:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] Q03:C01 E06APRIMARY:48-Asymptomatic DE06PCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] F03CABG: E05ACABG: DEADEND: DE04PRIMARY:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] E05CPCI: Q01IschemicSymptoms:Asymptomatic (No ischemic symptoms) DE02PCI:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] INDEX:A01B01C01D01 E05PRIMARY: F01PRIMARY: E01PRIMARY: Q03NonInvasiveTestResults:No non-invasive testing performed E03PRIMARY: DE03PRIMARY:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] Q02AntiIschemicMedicalTherapy:No Therapy DF04PCI:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] DF01PRIMARY:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] F04PCI: E05CCABG: DE07CCABG:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] E07CCABG: E07PRIMARY:49-Asymptomatic F03PRIMARY: E05CPRIMARY:23-Asymptomatic E07BPRIMARY: E07BCABG: DE06PRIMARY:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] DE07CABG:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] DF02PRIMARY:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] DE05PRIMARY:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] DE06APCI:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] DF03CABG:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] E06ACABG: E06BPRIMARY: E07APCI: DE06APRIMARY:map[SCOREGRAPHIC:08 SCORE:08 INDICATION:48 SCOREDEFINITIONS:48 Q01CAT:Asymptomatic TermDescription:[48. Three-vessel CAD (no left main) Abnormal LV systolic function -] Name:48-Asymptomatic] DF04CABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] E06APCI: E02PCI: E05PCI: DE07ACABG:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] E04CABG: DE05ACABG:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] DE07APRIMARY:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DE06BCABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] F04CABG: Q02:B01 DE07PRIMARY:map[TermDescription:[49. Left main stenosis  -] Name:49-Asymptomatic SCOREGRAPHIC:09 SCORE:09 INDICATION:49 SCOREDEFINITIONS:49 Q01CAT:Asymptomatic] DE07PCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] E06PCI: DE06BPRIMARY:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] E02PRIMARY:20-Asymptomatic DE06ACABG:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] DE05BCABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] E07CABG: DE07CPRIMARY:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DE05BPRIMARY:map[SCOREGRAPHIC:03 SCORE:03 INDICATION:22 SCOREDEFINITIONS:22 Q01CAT:Asymptomatic TermDescription:[22. One- or 2-vessel CAD with borderline stenosis 50% to 60% No noninvasive testing performed or equivocal test results present FFR less than or equal to 0.80* and/or IVUS with significant reduction in] Name:22-Asymptomatic] E02CABG: E04PCI: DE05APRIMARY:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] DE05CPRIMARY:map[SCORE:01 INDICATION:23 SCOREDEFINITIONS:23 Q01CAT:Asymptomatic TermDescription:[23. One- or 2-vessel CAD with borderline stenosis 50% to 60% No noninvasive testing performed or equivocal test results present FFR or IVUS findings do not meet criteria for significant stenosis] Name:23-Asymptomatic SCOREGRAPHIC:01] DE07BCABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] E01CABG: E05BPCI: E05BPRIMARY:22-Asymptomatic DE07CPCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DE02PRIMARY:map[Q01CAT:Asymptomatic TermDescription:[20. One- or 2-vessel CAD without involvement of proximal LAD No noninvasive testing performed -] Name:20-Asymptomatic SCOREGRAPHIC:03 SCORE:03 INDICATION:20 SCOREDEFINITIONS:201] DE01CABG:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] Q01:A01 E03CABG: E06PRIMARY: DE06CPRIMARY:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DE06BPCI:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] DE02CABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DF04CABGPCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] F02PRIMARY: E05APCI: E07APRIMARY: F04PRIMARY: E05CABG: E06CPRIMARY: E06CABG: DE07APCI:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] Q04:D01 DE01PRIMARY:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] E07CPRIMARY: F04CABGPCI: E07CPCI: E05APRIMARY: DE05PCI:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] DF03PCI:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] F03PCI: E07ACABG: DE05CABG:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] Title:NACS-100 DE03PCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] E07BPCI: E07PCI: DE07BPCI:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] E06BCABG:]\n--------------------------/n\nA01B01C01D02\n--/n\nmap[DF03PCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] F04PRIMARY: DEADEND:NR DE05CPRIMARY:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] DE05CPCI:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] DE07BPCI:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] F02PRIMARY: DE07CPRIMARY:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DE07CABG:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] E02PRIMARY: DE05BCABG:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] E01PCI: Q03NonInvasiveTestResults:No non-invasive testing performed E07BPRIMARY: E06CPCI: E03PRIMARY: E06CCABG: E06APRIMARY: E07PCI: DE05BPCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] E01CABG: DE05CCABG:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DF04CABGPCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DE07ACABG:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] E04CABG: DE05PCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DE07APCI:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] E05CABG: INDEX:A01B01C01D02 E04PCI: DE07CPCI:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] E06PCI: E05CCABG: F03PRIMARY: F04CABGPCI: E05APCI: E05BPRIMARY: DE06CPCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DF03CABGPCI:map[Q01CAT: TermDescription:[] Name:69 SCOREGRAPHIC: SCORE: INDICATION:69 SCOREDEFINITIONS:] E07CPCI: DE06APCI:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DE05ACABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DE05APRIMARY:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] DE06BPCI:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] DF04CABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DE03PCI:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DE07CCABG:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] DE06ACABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] F03PCI: DE06PRIMARY:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] E07CABG: E05BCABG: DE06BCABG:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] F03CABGPCI:69 DE06BPRIMARY:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] F04CABG: E05PRIMARY: Title:NACS-500 DE07APRIMARY:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] E06ACABG: E03PCI: DE02CABG:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DE06CPRIMARY:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] DE07BPRIMARY:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] F01PRIMARY: DE01PCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DE06APRIMARY:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] E07APCI: DE06CABG:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] DE07BCABG:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DF02PRIMARY:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] E04PRIMARY: DF04PRIMARY:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] DE05PRIMARY:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] E06CPRIMARY: Q02AntiIschemicMedicalTherapy:No Therapy E06PRIMARY: E01PRIMARY: Q04PRIORCABG:Previous CABG E05CPCI: DF01PRIMARY:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] E07APRIMARY: E06BPRIMARY: E05CPRIMARY: DE03PRIMARY:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] E06CABG: E03CABG: DE02PCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] F03CABG: E05APRIMARY: DF04PCI:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DE05CABG:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] DE05APCI:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] E02PCI: Q01IschemicSymptoms:Asymptomatic (No ischemic symptoms) E07PRIMARY: DE04CABG:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] E06APCI: E06BCABG: DE02PRIMARY:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] DE06PCI:map[INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE:] DF03CABG:map[SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC:] DE07PCI:map[SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION:] Q03:C01 E05PCI: DE06CCABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DE04PCI:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] E07BCABG: E07CPRIMARY: E02CABG: DE03CABG:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] F04PCI: E07ACABG: DE04PRIMARY:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] Q04:D02 E05BPCI: E07CCABG: DE05BPRIMARY:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] DF03PRIMARY:map[Q01CAT: TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS:] DE01PRIMARY:map[SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt; Name:] E05ACABG: Q01:A01 E07BPCI: DE01CABG:map[TermDescription:&lt;nil&gt; Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT:] Q02:B01 DE07PRIMARY:map[Name: SCOREGRAPHIC: SCORE: INDICATION: SCOREDEFINITIONS: Q01CAT: TermDescription:&lt;nil&gt;] E06BPCI:]\n</code></pre>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1538601779, "post_id": 52635748, "comment_id": 92204925, "body": "Did you compile it with CGO or any other flags/settings separate from plain old <code>go build</code>?"}, {"owner": {"reputation": 1, "user_id": 8576380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8LtgU.jpg?s=128&g=1", "display_name": "Rapid Code Lab", "link": "https://stackoverflow.com/users/8576380/rapid-code-lab"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1538601961, "post_id": 52635748, "comment_id": 92204985, "body": "No, just go build -o ./app ./app-folder"}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 3, "last_activity_date": 1538605364, "last_edit_date": 1538605364, "creation_date": 1538604363, "answer_id": 52636343, "question_id": 52635748, "link": "https://stackoverflow.com/questions/52635748/why-golang-binary-that-compiled-in-debian-9-cant-launch-in-centos-7/52636343#52636343", "title": "Why golang binary that compiled in Debian 9 , cant launch in Centos 7?", "body": "<p>Your program is likely using <a href=\"https://golang.org/cmd/cgo/\" rel=\"nofollow noreferrer\"><code>cgo</code></a> implicitly and generating an executable that depends on the <a href=\"https://gcc.gnu.org/onlinedocs/libstdc++/manual/abi.html\" rel=\"nofollow noreferrer\">C++ ABI versions</a> of the host machine that is doing the compiling (Debian 9). Unfortunately, it appears that your execution target (CentOS 7) has an incompatible ABI.</p>\n\n<p>You can verify by compiling with cgo disabled, e.g.:</p>\n\n<pre><code>$ CGO_ENABLED=0 go build -o ./app ./app-folder\n</code></pre>\n\n<p>That command will likely fail, so your options are likely to:</p>\n\n<ol>\n<li>refactor the parts of your go code which rely on cgo to use native go alternatives, OR...</li>\n<li>compile on a machine which has a compatible ABI as your execution target platform.</li>\n</ol>\n\n<p>See also <a href=\"https://en.wikipedia.org/wiki/Application_binary_interface\" rel=\"nofollow noreferrer\">Application binary interface \n(ABI)</a> and <a href=\"https://stackoverflow.com/questions/2801938/gcc-abi-compatibility\">GCC ABI Compatibility</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 8576380, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8LtgU.jpg?s=128&g=1", "display_name": "Rapid Code Lab", "link": "https://stackoverflow.com/users/8576380/rapid-code-lab"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 188, "favorite_count": 0, "accepted_answer_id": 52636343, "answer_count": 1, "score": 0, "last_activity_date": 1538605364, "creation_date": 1538601046, "question_id": 52635748, "link": "https://stackoverflow.com/questions/52635748/why-golang-binary-that-compiled-in-debian-9-cant-launch-in-centos-7", "title": "Why golang binary that compiled in Debian 9 , cant launch in Centos 7?", "body": "<p>Compiled an application on Debian 9, when I try to run on CentosOS, I get</p>\n\n<pre><code>./app: /lib64/libstdc++.so.6: version `CXXABI_1.3.8' not found (required by ./app)\n./app: /lib64/libstdc++.so.6: version `CXXABI_1.3.9' not found (required by ./app)\n./app: /lib64/libstdc++.so.6: version `GLIBCXX_3.4.21' not found (required by ./app)\n</code></pre>\n\n<p>ldd ./app show</p>\n\n<pre><code>bash-4.2$ ldd app \n./app: /lib64/libstdc++.so.6: version `CXXABI_1.3.8' not found (required by ./app)\n./app: /lib64/libstdc++.so.6: version `CXXABI_1.3.9' not found (required by ./app)\n./app: /lib64/libstdc++.so.6: version `GLIBCXX_3.4.21' not found (required by ./app)\n    linux-vdso.so.1 =&gt;  (0x00007fff24901000)\n    libpthread.so.0 =&gt; /lib64/libpthread.so.0 (0x00007f45a97ff000)\n    libstdc++.so.6 =&gt; /lib64/libstdc++.so.6 (0x00007f45a94f8000)\n    libm.so.6 =&gt; /lib64/libm.so.6 (0x00007f45a91f5000)\n    libgcc_s.so.1 =&gt; /lib64/libgcc_s.so.1 (0x00007f45a8fdf000)\n    libc.so.6 =&gt; /lib64/libc.so.6 (0x00007f45a8c12000)\n    /lib64/ld-linux-x86-64.so.2 (0x00007f45a9a25000)\n</code></pre>\n"}, {"tags": ["json", "dictionary", "go", "null"], "comments": [{"owner": {"reputation": 3419, "user_id": 4684539, "user_type": "registered", "accept_rate": 98, "profile_image": "https://graph.facebook.com/802633546458340/picture?type=large", "display_name": "AndreaM16", "link": "https://stackoverflow.com/users/4684539/andream16"}, "edited": false, "score": 1, "creation_date": 1538596866, "post_id": 52634800, "comment_id": 92202869, "body": "Post your <code>answers </code> or at leat some kind of mock."}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1538597009, "post_id": 52634800, "comment_id": 92202933, "body": "Because <code>&quot;bathrooms&quot;</code> does exist, and is <code>nil</code>. Please post a <a href=\"https://stackoverflow.com/help/minimal-reproducible-example\">minimal reproducible example</a> if you need assistance figuring out <i>why</i>."}, {"owner": {"reputation": 11, "user_id": 1230611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/218a4f5a23046e45eddfaea9966755bf?s=128&d=identicon&r=PG", "display_name": "user1230611", "link": "https://stackoverflow.com/users/1230611/user1230611"}, "edited": false, "score": 0, "creation_date": 1538597091, "post_id": 52634800, "comment_id": 92202972, "body": "Answers look something like <code>{&quot;bedrooms&quot;: 2, &quot;bathrooms&quot;: 1, ...}</code>, and they&#39;re unmarshalled via <code>answers := make(map[string]interface{})</code> and <code>err := json.Unmarshal(answersString, &amp;answers)</code>"}, {"owner": {"reputation": 11, "user_id": 1230611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/218a4f5a23046e45eddfaea9966755bf?s=128&d=identicon&r=PG", "display_name": "user1230611", "link": "https://stackoverflow.com/users/1230611/user1230611"}, "edited": false, "score": 0, "creation_date": 1538597182, "post_id": 52634800, "comment_id": 92203019, "body": "I guess my question is then: under what circumstances would a JSON field unmarshall into a nil value?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1538597271, "post_id": 52634800, "comment_id": 92203060, "body": "@user1230611: please don&#39;t put code in the comments, edit your question to reflect what you&#39;re doing. What you&#39;ve explained should work, so you need to provide an example that is failing."}], "answers": [{"comments": [{"owner": {"reputation": 11, "user_id": 1230611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/218a4f5a23046e45eddfaea9966755bf?s=128&d=identicon&r=PG", "display_name": "user1230611", "link": "https://stackoverflow.com/users/1230611/user1230611"}, "edited": false, "score": 0, "creation_date": 1538597287, "post_id": 52634891, "comment_id": 92203069, "body": "That makes sense, but then my question would be: under what circumstances would a JSON field unmarshall into a nil value? Would any zero value (0 for numbers, &quot;&quot; for strings) unmarshall into nil instead of the actual value?"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1538624752, "last_edit_date": 1538624752, "creation_date": 1538597163, "answer_id": 52634891, "question_id": 52634800, "link": "https://stackoverflow.com/questions/52634800/go-map-returns-nil-value-even-though-value-is-present/52634891#52634891", "title": "Go map returns nil value even though value is present", "body": "<p><code>ok</code> only tells if the key is in the map, whether the value associated with it is <code>nil</code> (or in general the zero value of he value type) or or not is another thing.</p>\n\n<p>See this example:</p>\n\n<pre><code>answers := map[string]interface{}{\n    \"isnil\":  nil,\n    \"notnil\": 1.15,\n}\n\nif v, ok := answers[\"isnil\"]; ok {\n    fmt.Printf(\"Value: %v, type: %T\\n\", v, v)\n}\nif v, ok := answers[\"notnil\"]; ok {\n    fmt.Printf(\"Value: %v, type: %T\\n\", v, v)\n}\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/euYvb9pC-u_X\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>Value: &lt;nil&gt;, type: &lt;nil&gt;\nValue: 1.15, type: float64\n</code></pre>\n\n<p>If <code>answers</code> is the result of a JSON unmarshaling, then the value associated with a key in it will be <code>nil</code> if the value in the source is JSON <code>null</code>.</p>\n\n<p>See this example:</p>\n\n<pre><code>var m map[string]interface{}\n\nerr := json.Unmarshal([]byte(`{\"isnil\":null,\"notnil\":1.15}`), &amp;m)\nif err != nil {\n    panic(err)\n}\nfmt.Println(m)\n</code></pre>\n\n<p>Output (try it on the <a href=\"https://play.golang.org/p/H3hzCUWdSs_y\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>map[notnil:1.15 isnil:&lt;nil&gt;]\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 1230611, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/218a4f5a23046e45eddfaea9966755bf?s=128&d=identicon&r=PG", "display_name": "user1230611", "link": "https://stackoverflow.com/users/1230611/user1230611"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1290, "favorite_count": 0, "accepted_answer_id": 52634891, "answer_count": 1, "score": -1, "last_activity_date": 1538624752, "creation_date": 1538596769, "last_edit_date": 1538597429, "question_id": 52634800, "link": "https://stackoverflow.com/questions/52634800/go-map-returns-nil-value-even-though-value-is-present", "title": "Go map returns nil value even though value is present", "body": "<p>Assume <code>answers</code> below is a <code>map[string]interface{}</code> unmarshalled from a JSON string.</p>\n\n<pre><code>if baths, ok := answers[\"bathrooms\"]; ok {\n  bathsFloat := baths.(float64)\n}\n</code></pre>\n\n<p>Somehow I'm getting a panic with <code>interface conversion: interface {} is nil, not float64</code>. How can this be possible when the presence check is true?</p>\n"}, {"tags": ["go", "assembly", "sse", "plan-9"], "comments": [{"owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538597329, "post_id": 52634648, "comment_id": 92203086, "body": "What does plan-9 have to do with this?"}, {"owner": {"reputation": 76134, "user_id": 417501, "user_type": "registered", "accept_rate": 92, "profile_image": "https://www.gravatar.com/avatar/703f62ead2e305b1dff62066065a0554?s=128&d=identicon&r=PG", "display_name": "fuz", "link": "https://stackoverflow.com/users/417501/fuz"}, "reply_to_user": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "edited": false, "score": 0, "creation_date": 1538602532, "post_id": 52634648, "comment_id": 92205202, "body": "@PeterCordes This is Plan 9&#39;s assembly dialect; it&#39;s what the Go reference implementation uses.  It&#39;s kinda funky."}], "answers": [{"comments": [{"owner": {"reputation": 1885, "user_id": 1536133, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b7d4d7ca49c05b83a6a296c27df27b0?s=128&d=identicon&r=PG", "display_name": "Gabriel Furstenheim", "link": "https://stackoverflow.com/users/1536133/gabriel-furstenheim"}, "edited": false, "score": 0, "creation_date": 1538812510, "post_id": 52634843, "comment_id": 92282818, "body": "I&#39;d say that it does not guarantee the memory alignment. Using memory operands generates segmentation fault with <code>unexpected fault address 0x0</code> which in another articles is mentioned as an error in alignment. As a side note, this was just a toy example. My function was too big to be aligned and in fact it improved using assembly."}], "tags": [], "owner": {"reputation": 240649, "user_id": 224132, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/N4ivW.png?s=128&g=1", "display_name": "Peter Cordes", "link": "https://stackoverflow.com/users/224132/peter-cordes"}, "is_accepted": true, "score": 1, "last_activity_date": 1538597314, "last_edit_date": 1538597314, "creation_date": 1538596975, "answer_id": 52634843, "question_id": 52634648, "link": "https://stackoverflow.com/questions/52634648/sse2-extract-float-from-packed-data-in-golang/52634843#52634843", "title": "SSE2 extract float from packed data in golang", "body": "<p>Does Go not guarantee stack alignment so you could use a memory source operand for <code>minpd</code>?</p>\n\n<p>Also, I'm not familiar with Go; is its <code>float</code> really IEEE binary64, which most languages (including x86 asm) call <code>double</code>?  It's weird to see <code>float</code> in the source and <code>pd</code> (packed double) instructions used in the asm.</p>\n\n<hr>\n\n<p>The overhead of calling a standalone hand-written-asm function for this is going to be higher than letting a compiler do it with scalar <code>minsd</code>, for a single pair.  Especially with Go's crappy calling convention, passing args in memory and storing the return value to memory.</p>\n\n<p>An optimizing Go compiler with an LLVM or gcc back-end should get the job done with inline code with lower latency and fewer uops of throughput cost than calling this function, even with the optimization given below.  Or if you're lucky, the compiler will use <code>minpd</code> for you.</p>\n\n<hr>\n\n<p>But for the actual problem, after <code>minpd   x0, x1</code>, what you need is a horizontal sum of <code>xmm1</code>.  <a href=\"https://stackoverflow.com/questions/6996764/fastest-way-to-do-horizontal-float-vector-sum-on-x86\">Fastest way to do horizontal float vector sum on x86</a>.</p>\n\n<p>You should use <code>movaps</code> to copy xmm registers, even if you only care about the low 64 bits.  <code>movsd x1, x2</code> merges into the low 64 bits of xmm2, creating a false dependency on the old value and costing a shuffle uop.</p>\n\n<pre><code>minpd   x0, x1\nmovhps  x1, x0        // high 64 bits of xmm1  =&gt; low 64 of xmm0\naddsd   x1, x0\n</code></pre>\n\n<p>You could <code>movaps x1, x2</code> and <code>unpckhpd x2,x2</code>, but that would cost an extra <code>movapd</code> or <code>movaps</code> which you can avoid by using <code>movhps</code>.</p>\n\n<p>(<code>movaps</code> / <code>movups</code> is shorter than <code>movapd</code>, smaller code-size, and otherwise exactly equivalent to <code>movapd</code> / <code>movupd</code> on all CPUs for loads, stores, and reg-reg copies.)</p>\n"}], "owner": {"reputation": 1885, "user_id": 1536133, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/8b7d4d7ca49c05b83a6a296c27df27b0?s=128&d=identicon&r=PG", "display_name": "Gabriel Furstenheim", "link": "https://stackoverflow.com/users/1536133/gabriel-furstenheim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 101, "favorite_count": 0, "accepted_answer_id": 52634843, "answer_count": 1, "score": 0, "last_activity_date": 1538630057, "creation_date": 1538596061, "last_edit_date": 1538630057, "question_id": 52634648, "link": "https://stackoverflow.com/questions/52634648/sse2-extract-float-from-packed-data-in-golang", "title": "SSE2 extract float from packed data in golang", "body": "<p>I'm writing an assembly function in Golang. To simplify let's suppose that I want to do the following function:</p>\n\n<pre><code>func sseSumOfMinimums (d1, d2 [2]float64) float64\n</code></pre>\n\n<p>It will compute the minimum of d1[0], d2[0] and the minimum of d1[1] and d2[1] and compute the sum</p>\n\n<p>In assembly I do:</p>\n\n<pre><code>TEXT \u00b7sseSum(SB), $0-40\nMOVUPD d1+0(FP), X0 // loading d1 to X0\nMOVUPD d2+16(FP), X1 // loading d1 to X1\nMINPD X0, X1 // compute pair minimums and store to X1\nMOVSD X1, X2 // move first min to X2\n// How do I move second float of X1 to X3?\nADDSD X2, X3\nMOVSD X3, ret+32(FP)\n</code></pre>\n\n<p>The part that I'm missing is how to extract the second scalar from X1 to X3</p>\n"}, {"tags": ["go", "openssl", "rsa", "sign"], "comments": [{"owner": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "edited": false, "score": 1, "creation_date": 1538596359, "post_id": 52634412, "comment_id": 92202649, "body": "<a href=\"https://golang.org/pkg/crypto/rsa/#SignPKCS1v15\" rel=\"nofollow noreferrer\"><code>rsa.SignPKCS1v15</code></a> and <a href=\"https://golang.org/pkg/crypto/rsa/#SignPSS\" rel=\"nofollow noreferrer\"><code>rsa.SignPSS</code></a> might be able to help you there."}, {"owner": {"reputation": 47, "user_id": 10452537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0V2Q.jpg?s=128&g=1", "display_name": "JohnPatel23", "link": "https://stackoverflow.com/users/10452537/johnpatel23"}, "reply_to_user": {"reputation": 2709, "user_id": 5189673, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c5a1a8d2328d31cdd52ed37dee8d91d4?s=128&d=identicon&r=PG&f=1", "display_name": "Leon", "link": "https://stackoverflow.com/users/5189673/leon"}, "edited": false, "score": 0, "creation_date": 1538738991, "post_id": 52634412, "comment_id": 92259040, "body": "Thanks Leon, I will look into those."}], "answers": [{"tags": [], "owner": {"reputation": 47, "user_id": 10452537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0V2Q.jpg?s=128&g=1", "display_name": "JohnPatel23", "link": "https://stackoverflow.com/users/10452537/johnpatel23"}, "is_accepted": true, "score": 0, "last_activity_date": 1539275602, "creation_date": 1539275602, "answer_id": 52764974, "question_id": 52634412, "link": "https://stackoverflow.com/questions/52634412/how-to-use-go-golang-to-sign-a-file/52764974#52764974", "title": "How to use Go Golang to sign a file", "body": "<p>To satisfy the requirements I needed to accomplish with Go &amp; OpenSSL, it's as straight forward as executing command line: </p>\n\n<pre><code>    c := \"openssl\"\n    a := []string{\"dgst\", \"-sha512\", \"-sign\", \"signature.key\", \"-out\", \"FileOut.signed\", \"FileToBeSigned.txt\"}   \n    cmd := exec.Command(c, a...)\n</code></pre>\n"}], "owner": {"reputation": 47, "user_id": 10452537, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/s0V2Q.jpg?s=128&g=1", "display_name": "JohnPatel23", "link": "https://stackoverflow.com/users/10452537/johnpatel23"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 468, "favorite_count": 0, "accepted_answer_id": 52764974, "answer_count": 1, "score": 0, "last_activity_date": 1539275602, "creation_date": 1538595073, "last_edit_date": 1538625238, "question_id": 52634412, "link": "https://stackoverflow.com/questions/52634412/how-to-use-go-golang-to-sign-a-file", "title": "How to use Go Golang to sign a file", "body": "<p>If I generate my key with openssl like this:</p>\n\n<pre><code>openssl req -x509 -sha256 -nodes -days 365 -newkey rsa:2048 -keyout testsign.key -out testsign.crt\n</code></pre>\n\n<p>What Go or Golang library or method or tool can I use to sign a file with that key?</p>\n"}, {"tags": ["macos", "go", "bin"], "comments": [{"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538594531, "post_id": 52634230, "comment_id": 92201826, "body": "<code>type fst</code> to check if cli sees the command. Then check that your <code>path</code> has <code>&#47;Users&#47;z0467676&#47;go&#47;bin</code>."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538594882, "post_id": 52634230, "comment_id": 92201998, "body": "@biosckon - still im getting the same error , any idea what it could be ?"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538595366, "post_id": 52634230, "comment_id": 92202210, "body": "what exactly does it say? <code>bash: fst: command not found</code> ? Or <code>Unknown command &#39;fst&#39;</code>?"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538595371, "post_id": 52634230, "comment_id": 92202212, "body": "@biosckon -  what do you mean <code>&#47;Users&#47;z0467676&#47;go&#47;bin</code> . ? when you write <code>Then check that your path</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538595390, "post_id": 52634230, "comment_id": 92202222, "body": "@biosckon - I got Unknown command"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538595794, "post_id": 52634230, "comment_id": 92202399, "body": "do you by any chance get this <code>go fst: unknown command Run &#39;go help&#39; for usage.</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538595895, "post_id": 52634230, "comment_id": 92202444, "body": "@biosckon - No , I dont get it. how can I add binary to the path for macbook ?"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538596187, "post_id": 52634230, "comment_id": 92202577, "body": "Check <code>echo $PATH</code> all binaries in general must sit in one of the folder that in <code>path</code>. If you copy your binary files into <code>&#47;Users&#47;z0467676&#47;go&#47;bin</code> than this needs to be added to the path. For example you can edit <code>~&#47;.profile</code> and add to it <code>export PATH=$PATH:&#47;Users&#47;z0467676&#47;go&#47;bin</code>. Then restart the Terminal."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538596255, "post_id": 52634230, "comment_id": 92202601, "body": "when I use the echo command I see this <code>&#47;usr&#47;local&#47;bin &#47;usr&#47;bin &#47;bin &#47;usr&#47;sbin &#47;sbin &#47;usr&#47;local&#47;go&#47;bin</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538596322, "post_id": 52634230, "comment_id": 92202630, "body": "the bin is not under <code>cd &#47;usr&#47;local&#47;go&#47;bin</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538596355, "post_id": 52634230, "comment_id": 92202646, "body": "its under <code>&#47;Users&#47;z0467676&#47;go&#47;bin</code>"}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538596371, "post_id": 52634230, "comment_id": 92202654, "body": "so some path is missing here ?"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538596466, "post_id": 52634230, "comment_id": 92202692, "body": "Yes: edit <code>~&#47;.profile</code> and add to it <code>export PATH=$PATH:&#47;Users&#47;z0467676&#47;go&#47;bin</code>. Then restart the Terminal. And try again."}, {"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "reply_to_user": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538596645, "post_id": 52634230, "comment_id": 92202771, "body": "I did  <code>vim ~&#47;.profile</code> and I see empty file and add the path as you mentioned restart and same issue"}, {"owner": {"reputation": 997, "user_id": 678491, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/uppbW.jpg?s=128&g=1", "display_name": "k1m190r", "link": "https://stackoverflow.com/users/678491/k1m190r"}, "edited": false, "score": 0, "creation_date": 1538597465, "post_id": 52634230, "comment_id": 92203160, "body": "Can you confirm that your <code>echo $PATH</code> has  <code>&#47;Users&#47;z0467676&#47;go&#47;bin</code>? And when you do <code>type -P fst</code> you see full path <code>&#47;Users&#47;z0467676&#47;go&#47;bin&#47;fst</code>?"}], "owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 34, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538594290, "creation_date": 1538594290, "question_id": 52634230, "link": "https://stackoverflow.com/questions/52634230/golang-bin-not-able-to-run-after-upgrade", "title": "Golang bin not able to run after upgrade", "body": "<p>I've upgrade the Golang version for 10.3 to 11 before the upgrade I've some bin which I build for MAC like following in <code>make file</code></p>\n\n<p>GOB=$(GOCMD) build</p>\n\n<pre><code>`CGO_ENABLED=0 GOOS=darwin GOARCH=amd64 $(GOB) -o build/$(BINARY_NAME) -v`\n</code></pre>\n\n<p>the bin is copied to <code>go/bin</code></p>\n\n<pre><code>/Users/z0467676/go/bin\n</code></pre>\n\n<p>The binary is a CLI and before when I run it I did something like this for example</p>\n\n<p><code>fst -h</code> and it works</p>\n\n<p>Now when I do it I got error </p>\n\n<p>Unknown command 'fst'</p>\n\n<p>Any idea what could be wrong and how to fix it ? </p>\n\n<p>I see the bin in the <code>go/bin/fst</code> </p>\n"}, {"tags": ["go", "grpc"], "answers": [{"comments": [{"owner": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1563327674, "post_id": 52635877, "comment_id": 100659435, "body": "How does this affect concurrency? For example lets say both <code>c1</code> and c2` have <code>stream</code> gRPCs - can both be called at the same time over the same single connection, and both will stream concurrently?"}, {"owner": {"reputation": 577, "user_id": 7891992, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CsP00wAm0dU/AAAAAAAAAAI/AAAAAAAAAfQ/oONOiaBIgXI/photo.jpg?sz=128", "display_name": "Doug Fawley", "link": "https://stackoverflow.com/users/7891992/doug-fawley"}, "reply_to_user": {"reputation": 7788, "user_id": 1218512, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/f40bbe64fcdaa806d999fe25dffc0690?s=128&d=identicon&r=PG", "display_name": "colm.anseo", "link": "https://stackoverflow.com/users/1218512/colm-anseo"}, "edited": false, "score": 0, "creation_date": 1563467622, "post_id": 52635877, "comment_id": 100719328, "body": "Yes, it is safe to make multiple concurrent RPCs with a single ClientConn."}, {"owner": {"reputation": 7393, "user_id": 247843, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/efb28219278d4fb05b46c7806fad2c76?s=128&d=identicon&r=PG", "display_name": "gp.", "link": "https://stackoverflow.com/users/247843/gp"}, "edited": false, "score": 0, "creation_date": 1565833335, "post_id": 52635877, "comment_id": 101476496, "body": "i believe that&#39;s the whole point of http2. multiplex multiple requests over single connection."}], "tags": [], "owner": {"reputation": 577, "user_id": 7891992, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-CsP00wAm0dU/AAAAAAAAAAI/AAAAAAAAAfQ/oONOiaBIgXI/photo.jpg?sz=128", "display_name": "Doug Fawley", "link": "https://stackoverflow.com/users/7891992/doug-fawley"}, "is_accepted": true, "score": 11, "last_activity_date": 1538601809, "creation_date": 1538601809, "answer_id": 52635877, "question_id": 52634217, "link": "https://stackoverflow.com/questions/52634217/access-multiple-grpc-services-over-the-same-connection/52635877#52635877", "title": "Access multiple gRPC services over the same connection", "body": "<blockquote>\n  <p>Why do I need to dial a different socket for each grpc service?</p>\n</blockquote>\n\n<p>You don't.  You can create one <code>grpc.ClientConn</code> and pass it to multiple <code>pb.New*Client()</code> functions, and they will share the same connection(s).</p>\n\n<pre><code>func main() {\n    cc, err := grpc.Dial(\"localhost:6000\", grpc.WithInsecure())\n    if err != nil {\n        log.Fatal(err)\n    }\n    c1 := pb.NewSubscriberServiceClient(cc)\n    c2 := pb.NewDropperServiceClient(cc)\n}\n</code></pre>\n\n<blockquote>\n  <p>And then use this Interface to implement the client side grpc functions for each service, instead of creating a new struct for each service</p>\n</blockquote>\n\n<p>The generated code in the <code>pb.go</code> file does everything you need to perform RPCs.  You shouldn't have to implement anything client-side unless you have special logic you want to happen automatically every time you perform a call.</p>\n\n<p>If the two services have unique method names, you could put them into the same struct so you don't have to use them separately, as a minor convenience:</p>\n\n<pre><code>type SubscriberDropper struct {\n    pb.SubscriberServiceClient\n    pb.DropperServiceClient\n}\n\nfunc main() {\n    // ... as above ...\n    sd := &amp;SubscriberDropper{c1, c2}\n}\n</code></pre>\n"}], "owner": {"reputation": 1501, "user_id": 6414477, "user_type": "registered", "accept_rate": 64, "profile_image": "https://www.gravatar.com/avatar/6a2c251e715864f098ebf4b4057848b1?s=128&d=identicon&r=PG&f=1", "display_name": "rhillhouse", "link": "https://stackoverflow.com/users/6414477/rhillhouse"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7014, "favorite_count": 1, "accepted_answer_id": 52635877, "answer_count": 1, "score": 7, "last_activity_date": 1538601809, "creation_date": 1538594217, "question_id": 52634217, "link": "https://stackoverflow.com/questions/52634217/access-multiple-grpc-services-over-the-same-connection", "title": "Access multiple gRPC services over the same connection", "body": "<p>I am running a <code>grpc</code> server listening on <code>localhost:6000</code>, exposing 2 <code>grpc</code> services: <code>RegisterSubscriberServiceServer</code> and <code>RegisterDropperServiceServer</code>. Since both of these services are reachable from <code>localhost:6000</code>, I'd like to only dial this address from the stub.</p>\n\n<p>The server looks like this:</p>\n\n<pre><code>func main() {\n    grpcServer := grpc.NewServer()\n    pb.RegisterSubscriberServiceServer(grpcServer, &amp;subscriberServer{})\n    pb.RegisterDropperServiceServer(grpcServer, &amp;dropperServer{})\n\n    l, err := net.Listen(\"tcp\", \":6000\")\n    if err != nil {\n        log.Fatalf(\"failed to listen: %v\", err)\n    }\n\n    log.Println(\"Listening on tcp://localhost:6000\")\n    grpcServer.Serve(l)\n}\n</code></pre>\n\n<p>Why do I need to dial a different socket for each <code>grpc</code> service?</p>\n\n<pre><code>type DropperRPC struct {\n    conn      *grpc.ClientConn\n    client pb.DropperServiceClient\n    chunkSize int\n}\n\ntype SubscriberRPC struct {\n    conn      *grpc.ClientConn\n    client pb.SubscriberServiceClient\n    chunkSize int\n}\n\nfunc NewSubscriber() (c SubscriberRPC, err error) {\n    c.conn, err = grpc.Dial(\"localhost:6000\", grpc.WithInsecure())\n    if err != nil {\n        log.Fatal(err)\n    }\n    c.client = pb.NewSubscriberServiceClient(c.conn)\n    return\n}\n\nfunc NewDropper() (c DropperRPC, err error) {\n    c.conn, err = grpc.Dial(\"localhost:6000\", grpc.WithInsecure())\n    if err != nil {\n        log.Fatal(err)\n    }\n    c.client = pb.NewDropperServiceClient(c.conn)\n    return\n}\n</code></pre>\n\n<p>And since the code is basically duplicated to accommodate each service, can't I just use an <code>Interface</code> to reduce the code?</p>\n\n<pre><code>func main() {\n    c1, err := NewSubscriber()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    c2, err := NewDropper()\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    cc1 := &amp;c1\n    cc2 := &amp;c2\n}\n</code></pre>\n\n<p>And then use this <code>Interface</code> to implement the client side <code>grpc</code> functions for each service, instead of creating a new <code>struct</code> for each service. I have found <a href=\"https://github.com/soheilhy/cmux\" rel=\"noreferrer\">cmux</a> , but there must be a way to do this without using external libraries.</p>\n"}, {"tags": ["amazon-web-services", "go", "aws-codepipeline", "aws-codecommit"], "comments": [{"owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "edited": false, "score": 0, "creation_date": 1538591312, "post_id": 52633357, "comment_id": 92200231, "body": "it looks like your are missing the dependency <code>gorilla&#47;mux</code> ... Any chance that you run something like <code>go get .&#47;...</code> before your build?"}, {"owner": {"reputation": 1303, "user_id": 1990524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1b7da006e44f2492030e9ad17d15d23?s=128&d=identicon&r=PG", "display_name": "jjuser19jj", "link": "https://stackoverflow.com/users/1990524/jjuser19jj"}, "reply_to_user": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "edited": false, "score": 0, "creation_date": 1538599451, "post_id": 52633357, "comment_id": 92204032, "body": "Yes I could, but is that not somewhat tedious when you have many dependencies ? Also it works fine on my local machine."}, {"owner": {"reputation": 8681, "user_id": 629493, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/44253c64ffb24f76f5917e48188ce6ab?s=128&d=identicon&r=PG", "display_name": "Unsigned", "link": "https://stackoverflow.com/users/629493/unsigned"}, "edited": false, "score": 0, "creation_date": 1538600578, "post_id": 52633357, "comment_id": 92204484, "body": "@user1990524 It&#39;s very likely your local machine already has all these dependencies downloaded from when you first added them. Have you tried silverfighter&#39;s suggestion?"}, {"owner": {"reputation": 1303, "user_id": 1990524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1b7da006e44f2492030e9ad17d15d23?s=128&d=identicon&r=PG", "display_name": "jjuser19jj", "link": "https://stackoverflow.com/users/1990524/jjuser19jj"}, "edited": false, "score": 0, "creation_date": 1538630588, "post_id": 52633357, "comment_id": 92211432, "body": "Yes I did, but I get new errors."}, {"owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "edited": false, "score": 0, "creation_date": 1538660673, "post_id": 52633357, "comment_id": 92228371, "body": "Right now I see no specific error. <code>go get</code> clones the sources from github which should be ok. after everything is local it should be ready to build. so don&#39;t forget to execute <code>go build </code> afterwards. And you do not want to cache packages its ok for a pipeline to download them on each build."}], "answers": [{"comments": [{"owner": {"reputation": 1303, "user_id": 1990524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1b7da006e44f2492030e9ad17d15d23?s=128&d=identicon&r=PG", "display_name": "jjuser19jj", "link": "https://stackoverflow.com/users/1990524/jjuser19jj"}, "edited": false, "score": 0, "creation_date": 1538667737, "post_id": 52648449, "comment_id": 92233220, "body": "I read the article and this is where I got the buildspec from. Sadly moving go get ./... to install does not help."}], "tags": [], "owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "is_accepted": false, "score": 0, "last_activity_date": 1538660985, "creation_date": 1538660985, "answer_id": 52648449, "question_id": 52633357, "link": "https://stackoverflow.com/questions/52633357/aws-codebuild-golang-build-fails/52648449#52648449", "title": "AWS CodeBuild golang build fails", "body": "<p>According to this article you need to add it to the <code>install</code> section of your <code>buildspec.yml</code> file.</p>\n\n<pre><code>install: \n    commands:\n      - go get github.com/gorilla/mux\n</code></pre>\n\n<p>maybe it does also work to include <code>go get ./...</code> this will resolve all dependencies... but if you do not have too many it is a good practise to list them explicitly.</p>\n\n<p>this is the source article: <a href=\"https://www.contributing.md/2017/06/30/golang-with-aws-codebuild/\" rel=\"nofollow noreferrer\">https://www.contributing.md/2017/06/30/golang-with-aws-codebuild/</a></p>\n"}], "owner": {"reputation": 1303, "user_id": 1990524, "user_type": "registered", "accept_rate": 56, "profile_image": "https://www.gravatar.com/avatar/d1b7da006e44f2492030e9ad17d15d23?s=128&d=identicon&r=PG", "display_name": "jjuser19jj", "link": "https://stackoverflow.com/users/1990524/jjuser19jj"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 879, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1546020478, "creation_date": 1538590610, "last_edit_date": 1546020478, "question_id": 52633357, "link": "https://stackoverflow.com/questions/52633357/aws-codebuild-golang-build-fails", "title": "AWS CodeBuild golang build fails", "body": "<p>When I run the following command: <code>- go build -o app</code> I get the following error (for multiple dependencies) : <code>main.go:21:2: cannot find package \"github.com/gorilla/mux\" in any of:\n    /usr/local/go/src/github.com/gorilla/mux (from $GOROOT)\n    /go/src/github.com/gorilla/mux (from $GOPATH)\n    /codebuild/output/src324986171/src/github.com/gorilla/mux</code></p>\n\n<p>Meaning the codebuild fails. Any idea how I can fix this, or in general where the problem is ?\nThanks for your help.</p>\n\n<p>EDIT:\nAfter adding <code>go get ./...</code> to the build I get the following error for all my local packages:<code># cd .; git clone https://github.com/aristotle/dbhelper /go/src/github.com/aristotle/dbhelper\nCloning into '/go/src/github.com/aristotle/dbhelper'...</code></p>\n\n<p>My buildspec.yml looks like this:</p>\n\n<p><div class=\"snippet\" data-lang=\"js\" data-hide=\"false\" data-console=\"true\" data-babel=\"false\">\r\n<div class=\"snippet-code\">\r\n<pre class=\"snippet-code-js lang-js prettyprint-override\"><code>version: 0.2\r\n\r\nphases:\r\n  install: \r\n    commands:\r\n      - echo CODEBUILD_SRC_DIR - $CODEBUILD_SRC_DIR\r\n      - echo GOPATH - $GOPATH\r\n      - echo GOROOT - $GOROOT\r\n  build:\r\n    commands:\r\n      - echo Build started on `date`\r\n      - echo Getting packages\r\n      - go get ./...\r\n      - echo Compiling the Go code...\r\n      - go build -o app main.go\r\n  post_build:\r\n    commands:\r\n      - echo Build completed on `date`\r\nartifacts:\r\n  files:\r\n    - app</code></pre>\r\n</div>\r\n</div>\r\n</p>\n"}, {"tags": ["go", "interface"], "answers": [{"tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": true, "score": 1, "last_activity_date": 1538591804, "creation_date": 1538591804, "answer_id": 52633667, "question_id": 52633291, "link": "https://stackoverflow.com/questions/52633291/go-interface-to-datastore-two-implementations/52633667#52633667", "title": "Go interface to datastore, two implementations", "body": "<p>The return type of <code>GetDatastore</code> is the concrete type <code>*DB</code>, and <code>*MockDB</code> is not <code>*DB</code> which is why you get that error. What you want instead is to return the <em>interface</em> type <code>Datastore</code>, which both <code>*DB</code> and <code>*MockDB</code> implement.</p>\n"}], "owner": {"reputation": 1757, "user_id": 1909569, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/0a02066c0046ce77af47b86c30cd720d?s=128&d=identicon&r=PG", "display_name": "Rogier Lommers", "link": "https://stackoverflow.com/users/1909569/rogier-lommers"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 38, "favorite_count": 0, "accepted_answer_id": 52633667, "answer_count": 1, "score": 0, "last_activity_date": 1538591804, "creation_date": 1538590330, "last_edit_date": 1538591008, "question_id": 52633291, "link": "https://stackoverflow.com/questions/52633291/go-interface-to-datastore-two-implementations", "title": "Go interface to datastore, two implementations", "body": "<p>Please see <a href=\"https://github.com/rogierlommers/bookstore\" rel=\"nofollow noreferrer\">this repo</a>. I'm trying to create an interface to a datastore. Reason: I don't want to be dependent on a real postgres db while developing, but I want to use an in-memory-implementation during dev.</p>\n\n<p>This works, as long as I create the instances in my main(). For example: <code>db := store.NewMemoryDB()</code> or <code>db := store.NewDB()</code>.</p>\n\n<p>But now I want to create an instance based on a boolean. So I created a function <a href=\"https://github.com/rogierlommers/bookstore/blob/master/store/interface.go#L16\" rel=\"nofollow noreferrer\">GetDatastore(bool)</a> in the store package. This works for the postgres implementation, but not for the in-memory. I get the following error: <code>cannot use NewMemoryDB() (type *MockDB) as type *DB in assignment</code>. Now I really don't know how to solve this. Can someone please give me a hint? How do I make the in-memory one *DB-compatible?</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 15305, "user_id": 147530, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb9f657e0b37fa483135635211e7d167?s=128&d=identicon&r=PG", "display_name": "morpheus", "link": "https://stackoverflow.com/users/147530/morpheus"}, "edited": false, "score": 0, "creation_date": 1538587957, "post_id": 52632555, "comment_id": 92198558, "body": "Ah nice! Yes when I add a buffer like <code>sizes := make(chan int64, 10)</code> then the code works. Thanks Mad!"}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "reply_to_user": {"reputation": 15305, "user_id": 147530, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb9f657e0b37fa483135635211e7d167?s=128&d=identicon&r=PG", "display_name": "morpheus", "link": "https://stackoverflow.com/users/147530/morpheus"}, "edited": false, "score": 0, "creation_date": 1538588045, "post_id": 52632555, "comment_id": 92198605, "body": "Eh... it will only work if your number of payloads is less than 10. This is fragile. I highly recommend you go with the non-blocking reads the way my posted code sample does."}, {"owner": {"reputation": 15305, "user_id": 147530, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb9f657e0b37fa483135635211e7d167?s=128&d=identicon&r=PG", "display_name": "morpheus", "link": "https://stackoverflow.com/users/147530/morpheus"}, "edited": false, "score": 1, "creation_date": 1538588276, "post_id": 52632555, "comment_id": 92198741, "body": "Yes I understand that but it helped me understand why there was a deadlock. Agree that in practice I would use the code you shared or the one in the book :)"}], "tags": [], "owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "is_accepted": true, "score": 1, "last_activity_date": 1538587525, "creation_date": 1538587525, "answer_id": 52632555, "question_id": 52632149, "link": "https://stackoverflow.com/questions/52632149/why-is-there-a-fatal-error-all-goroutines-are-asleep-deadlock-in-this-code/52632555#52632555", "title": "Why is there a fatal error: all goroutines are asleep - deadlock! in this code?", "body": "<p>Your channel is unbuffered (you didn't specify any buffer size when make()ing the channel). This means that a write to the channel blocks until the value written is read. And you read from the channel after your call to wg.Wait(), so nothing ever gets read and all your goroutines get stuck on the blocking write. </p>\n\n<p>That said, you do not need WaitGroup here. WaitGroups are good when you don't know when your goroutine is done, but you are sending results back, so you know. Here is a sample code that does a similar thing to what you are trying to do (with fake worker payload).</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n)\n\nfunc main() {\n    var procs int = 0\n    filenames := []string{\"file1\", \"file2\", \"file3\", \"file4\"}\n    mychan := make(chan string)\n    for _, f := range filenames {\n        procs += 1\n        // worker\n        go func(f string) {\n            fmt.Printf(\"Worker processing %v\\n\", f)\n            time.Sleep(time.Second)\n            mychan &lt;- f\n        }(f)\n    }\n\n    for i := 0; i &lt; procs; i++ {\n        select {\n        case msg := &lt;-mychan:\n            fmt.Printf(\"got %v from worker channel\\n\", msg)\n        }\n    }\n}\n</code></pre>\n\n<p>Test it in the playground here <a href=\"https://play.golang.org/p/RtMkYbAqtGO\" rel=\"nofollow noreferrer\">https://play.golang.org/p/RtMkYbAqtGO</a></p>\n"}, {"comments": [{"owner": {"reputation": 1044, "user_id": 786474, "user_type": "registered", "accept_rate": 70, "profile_image": "https://www.gravatar.com/avatar/2ad73e24e5f072cebb29a807b45a774e?s=128&d=identicon&r=PG", "display_name": "Carcamano", "link": "https://stackoverflow.com/users/786474/carcamano"}, "edited": false, "score": 0, "creation_date": 1597983581, "post_id": 58249369, "comment_id": 112315686, "body": "Thanks. Wasn&#39;t sure how to call the function."}], "tags": [], "owner": {"reputation": 21, "user_id": 10787075, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-kpELrCa1lao/AAAAAAAAAAI/AAAAAAAABY4/loHJkJhbkoY/photo.jpg?sz=128", "display_name": "Antonis Kouzoupis", "link": "https://stackoverflow.com/users/10787075/antonis-kouzoupis"}, "is_accepted": false, "score": 1, "last_activity_date": 1570286690, "creation_date": 1570286690, "answer_id": 58249369, "question_id": 52632149, "link": "https://stackoverflow.com/questions/52632149/why-is-there-a-fatal-error-all-goroutines-are-asleep-deadlock-in-this-code/58249369#58249369", "title": "Why is there a fatal error: all goroutines are asleep - deadlock! in this code?", "body": "<p>Although it's been a while since the question was raised, I encountered the same issue. Initially my main looked like the following:</p>\n\n<pre><code>func main() {\n   filenames := make(chan string, len(os.Args))\n   for _, f := range os.Args[1:] {\n       filenames &lt;- f\n   }\n   sizes := makeThumbnails6(filenames)\n   close(filenames)\n   log.Println(\"Total size: \", sizes)}\n</code></pre>\n\n<p>This version deadlocks as the call <code>range filenames</code> in <code>makeThumbnails6</code> is synchronous, thus <code>close(filenames)</code> in main was never called. The channel in <code>makeThumbnails6</code> is unbuffered so goroutines block when trying to send back the size.</p>\n\n<p>The solution was to move <code>close(filenames)</code> before making the function call in main.</p>\n"}, {"tags": [], "owner": {"reputation": 1, "user_id": 13870000, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/d3427c5f8af7c029b4e6d69648e6422d?s=128&d=identicon&r=PG&f=1", "display_name": "Shang Wu", "link": "https://stackoverflow.com/users/13870000/shang-wu"}, "is_accepted": false, "score": -1, "last_activity_date": 1593946357, "creation_date": 1593946357, "answer_id": 62739716, "question_id": 52632149, "link": "https://stackoverflow.com/questions/52632149/why-is-there-a-fatal-error-all-goroutines-are-asleep-deadlock-in-this-code/62739716#62739716", "title": "Why is there a fatal error: all goroutines are asleep - deadlock! in this code?", "body": "<p>The code is wrong. In short, the channel <code>sizes</code> is unbuffered. To fix it, we need to use a buffered channel with enough capacity when creating <code>sizes</code>. One-liner fix is enough, as shown. Here I just made a simple assumption that 1024 is big enough.</p>\n<pre><code>func makeThumbnails6(filenames chan string) int64 {\n    sizes := make(chan int64, 1024)    // CHANGE \n    var wg sync.WaitGroup // number of working goroutines\n    for f := range filenames {\n        wg.Add(1)\n        // worker\n        go func(f string) {\n            defer wg.Done()\n            thumb, err := thumbnail.ImageFile(f)\n            if err != nil {\n                log.Println(err)\n                return\n            }\n            info, _ := os.Stat(thumb) // OK to ignore error\n            fmt.Println(info.Size())\n            sizes &lt;- info.Size()\n        }(f)\n    }\n\n    // closer\n    go func() {\n        wg.Wait()\n        close(sizes)\n    }()\n\n    var total int64\n    for size := range sizes {\n        total += size\n    }\n    return total\n}\n</code></pre>\n"}], "owner": {"reputation": 15305, "user_id": 147530, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/fb9f657e0b37fa483135635211e7d167?s=128&d=identicon&r=PG", "display_name": "morpheus", "link": "https://stackoverflow.com/users/147530/morpheus"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 325, "favorite_count": 0, "accepted_answer_id": 52632555, "answer_count": 3, "score": 0, "last_activity_date": 1593946357, "creation_date": 1538585926, "question_id": 52632149, "link": "https://stackoverflow.com/questions/52632149/why-is-there-a-fatal-error-all-goroutines-are-asleep-deadlock-in-this-code", "title": "Why is there a fatal error: all goroutines are asleep - deadlock! in this code?", "body": "<p>This is in reference to following code in The Go Programming Language - Chapter 8 p.238 copied below from <a href=\"https://github.com/adonovan/gopl.io/blob/master/ch8/thumbnail/thumbnail_test.go\" rel=\"nofollow noreferrer\">this</a> link</p>\n\n<pre><code>// makeThumbnails6 makes thumbnails for each file received from the channel.\n// It returns the number of bytes occupied by the files it creates.\nfunc makeThumbnails6(filenames &lt;-chan string) int64 {\n    sizes := make(chan int64)\n    var wg sync.WaitGroup // number of working goroutines\n    for f := range filenames {\n        wg.Add(1)\n        // worker\n        go func(f string) {\n            defer wg.Done()\n            thumb, err := thumbnail.ImageFile(f)\n            if err != nil {\n                log.Println(err)\n                return\n            }\n            info, _ := os.Stat(thumb) // OK to ignore error\n            fmt.Println(info.Size())\n            sizes &lt;- info.Size()\n        }(f)\n    }\n\n    // closer\n    go func() {\n        wg.Wait()\n        close(sizes)\n    }()\n\n    var total int64\n    for size := range sizes {\n        total += size\n    }\n    return total\n}\n</code></pre>\n\n<p>Why do we need to put the closer in a goroutine? Why can't below work?</p>\n\n<pre><code>// closer\n        // go func() {\n        fmt.Println(\"waiting for reset\")\n                wg.Wait()\n        fmt.Println(\"closing sizes\")\n                close(sizes)\n        // }()\n</code></pre>\n\n<p>If I try running above code it gives:</p>\n\n<blockquote>\n  <p>waiting for reset<br>\n  3547<br>\n  2793<br>\n  fatal error: all goroutines are asleep - deadlock!</p>\n</blockquote>\n\n<p>Why is there a deadlock in above? fyi, In the method that calls <code>makeThumbnail6</code> I do close the <code>filenames</code> channel</p>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1538580895, "post_id": 52630708, "comment_id": 92194843, "body": "Show the code for &quot;make User as a slice&quot;."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538581496, "post_id": 52630708, "comment_id": 92195173, "body": "Show the code that is failing and also provide the error that you&#39;re getting."}, {"owner": {"reputation": 6375, "user_id": 84750, "user_type": "registered", "accept_rate": 63, "profile_image": "https://i.stack.imgur.com/jbFti.jpg?s=128&g=1", "display_name": "silverfighter", "link": "https://stackoverflow.com/users/84750/silverfighter"}, "edited": false, "score": 0, "creation_date": 1538581589, "post_id": 52630708, "comment_id": 92195223, "body": "I pasted it in goplayground and did not get any error: <a href=\"https://play.golang.org/p/VvuwHJShXBw\" rel=\"nofollow noreferrer\">play.golang.org/p/VvuwHJShXBw</a> What error do you see?"}, {"owner": {"reputation": 825, "user_id": 570200, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c1f1eb2f77f0fc96d61e5d2252b179dc?s=128&d=identicon&r=PG", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/570200/abhinav"}, "edited": false, "score": 0, "creation_date": 1538581813, "post_id": 52630708, "comment_id": 92195374, "body": "If you run with updated struct it will report error"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538583131, "post_id": 52630708, "comment_id": 92196130, "body": "@Abhinav you were not passing the slice of Users to the setter function which is why the error."}], "answers": [{"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1538582697, "last_edit_date": 1538582697, "creation_date": 1538582385, "answer_id": 52631249, "question_id": 52630708, "link": "https://stackoverflow.com/questions/52630708/setter-method-for-slice-struct-in-golang/52631249#52631249", "title": "Setter method for slice struct in golang", "body": "<p>It is showing an error because <code>ReqJSON</code> struct contains a field for <code>User</code> which is a slice of <code>User</code> struct but when you are setting the Value for <code>User</code> struct you are not passing slice of User struct inside setter function.</p>\n\n<pre><code>type ReqJSON struct {\n    Request struct {\n        Data struct {\n            Object struct {\n                User []User `json:\"user\"` // this is a slice of User struct\n            } `json:\"object\"`\n        } `json:\"data\"`\n    } `json:\"request\"`\n}\n</code></pre>\n\n<p>You need to pass a slice of User struct in Setter function if you want to initialize the field inside <code>ReqJSON</code> struct which contains slice of <code>User</code> not <code>User</code>. Pass slice of User struct inside main as:</p>\n\n<pre><code>var u []User\nu = append(u, User{\n    UserID:    \"_id\",\n    IPAddr:    \"1.1.1.1\",\n    Noofusers: \"100\",\n    Qos:       \"34\",\n    ID:        \"kldjflkdfjlkdjfkld\",\n    Domain:    \"xyz.com\",\n})\nj.SetUser(u)\n</code></pre>\n\n<p>Working Code on <a href=\"https://play.golang.org/p/kJ24CrJRNdk\" rel=\"nofollow noreferrer\">Go Playground</a></p>\n"}, {"comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538582782, "post_id": 52631334, "comment_id": 92195938, "body": "There is nothing related to Go is strongly typed or not in OP question. The issue is OP is not passing slice of user in the setter function."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538583216, "post_id": 52631334, "comment_id": 92196175, "body": "If this was python or any other dynamically typed language, passing a list of users instead of a single user to the same implementation would work just fine. But with go, you have to specify argument and return types for everything. Thats why I mentioned typing."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538583326, "post_id": 52631334, "comment_id": 92196236, "body": "Well there is a big difference between a struct and an array of struct in any language."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538583556, "post_id": 52631334, "comment_id": 92196350, "body": "Not true. As long as I am not trying to do something that is specific to the data structure (i.e. refer to an element by index on something that is not an array or referring to a member by name on something that is not a struct) a dynamic language doesn&#39;t care. If I were to turn a data structure into json in python, I would use <code>json.dumps(myobj)</code> and never have to specify what exactly myobj is, as long as it is something that is serializable. In go, you have to specify the type for everything."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538583675, "post_id": 52631334, "comment_id": 92196408, "body": "I do not know that much about python but you are wrong here you cannot assign a primary type value to a variable which takes an array."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538584479, "post_id": 52631334, "comment_id": 92196806, "body": "In a dynamically typed language you can. In a statically typed language you cannot. In python, ruby javascript you can do <code>x = 10</code> and in the next line <code>x = [10]</code> and it will work. In C++, Go, Java, Rust etc. you cannot."}], "tags": [], "owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "is_accepted": true, "score": 2, "last_activity_date": 1538582689, "creation_date": 1538582689, "answer_id": 52631334, "question_id": 52630708, "link": "https://stackoverflow.com/questions/52630708/setter-method-for-slice-struct-in-golang/52631334#52631334", "title": "Setter method for slice struct in golang", "body": "<p>If you change the single embedded user struct to a list of users you need to change it everywhere. Golang is strongly typed and a slice of users is a different type from a single user struct. The following code works</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n\ntype ReqJSON struct {\n    Request struct {\n        Data struct {\n            Object struct {\n                User []User `json:\"user\"`\n            } `json:\"object\"`\n        } `json:\"data\"`\n    } `json:\"request\"`\n}\n\ntype User struct {\n    UserID    string `json:\"userid\"`\n    IPAddr    string `json:\"ipaddr\"`\n    Noofusers string `json:\"noofusers\"`\n    Qos       string `json:\"qos\"`\n    ID        string `json:\"id\"`\n    Domain    string `json:\"domain\"`\n}\n\nfunc (j *ReqJSON) User() []User     { return j.Request.Data.Object.User } \nfunc (j *ReqJSON) SetUsers(u []User) { j.Request.Data.Object.User = u }\n\nfunc main() {\n\n    var j ReqJSON\n    j.SetUsers([]User{\n    User{\n        UserID:    \"_id\",\n        IPAddr:    \"1.1.1.1\",\n        Noofusers: \"100\",\n        Qos:       \"34\",\n        ID:        \"kldjflkdfjlkdjfkld\",\n        Domain:    \"xyz.com\",\n    },\n    })\n\n    b, err := json.MarshalIndent(j, \"\", \"  \")\n    fmt.Println(err, string(b))\n}\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 570200, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c1f1eb2f77f0fc96d61e5d2252b179dc?s=128&d=identicon&r=PG", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/570200/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 766, "favorite_count": 0, "accepted_answer_id": 52631334, "answer_count": 2, "score": 1, "last_activity_date": 1538583391, "creation_date": 1538580742, "last_edit_date": 1538583391, "question_id": 52630708, "link": "https://stackoverflow.com/questions/52630708/setter-method-for-slice-struct-in-golang", "title": "Setter method for slice struct in golang", "body": "<p>I have an strut defined as below</p>\n\n<pre><code>type ReqJSON struct {\n    Request struct {\n        Data struct {\n            Object struct {\n                User []User `json:\"user\"`\n            } `json:\"object\"`\n        } `json:\"data\"`\n    } `json:\"request\"`\n}\n\ntype User struct {\n    UserID string `json:\"userid\"`\n    IPAddr string `json:\"ipaddr\"`\n    Noofusers string `json:\"noofusers\"`\n    Qos string `json:\"qos\"`\n    ID string `json:\"id\"`\n    Domain string `json:\"domain\"`\n}\n</code></pre>\n\n<p>The setter function for this struct is as below</p>\n\n<pre><code>func (j *ReqJSON) User() User     { return j.Request.Data.Object.User } \nfunc (j *ReqJSON) SetUser(u User) { j.Request.Data.Object.User = u }\n</code></pre>\n\n<p>The main program is as follows</p>\n\n<pre><code>func main() {\n    var j ReqJSON\n    j.SetUser(User{\n            UserID:    \"_id\",\n            IPAddr:    \"1.1.1.1\",\n            Noofusers: \"100\",\n            Qos:       \"34\",\n            ID:        \"kldjflkdfjlkdjfkld\",\n            Domain:    \"xyz.com\",\n    })\n\n    b, err := json.MarshalIndent(j, \"\", \"  \")\n    fmt.Println(err, string(b))\n}\n</code></pre>\n\n<p>When I tried to make <code>User</code> as slice I am getting error for the above function.</p>\n\n<blockquote>\n  <p>prog.go:27:65: cannot use j.Request.Data.Object.User (type []User) as\n  type User in return argument prog.go:28:64: cannot use u (type User)\n  as type []User in assignment</p>\n</blockquote>\n\n<p>I am novice to Golang so not able to figure out how I can make Setter and Ctor to return slice object.</p>\n"}, {"tags": ["go", "couchbase"], "answers": [{"tags": [], "owner": {"reputation": 2207, "user_id": 453158, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/7ecbf760b7129f85ec8c8ba3ddf72b96?s=128&d=identicon&r=PG", "display_name": "deniswsrosa", "link": "https://stackoverflow.com/users/453158/deniswsrosa"}, "is_accepted": false, "score": 1, "last_activity_date": 1538640884, "creation_date": 1538640884, "answer_id": 52642056, "question_id": 52630271, "link": "https://stackoverflow.com/questions/52630271/where-not-equal-to-in-couchbase/52642056#52642056", "title": "\u201cwhere not equal to\u201d in Couchbase", "body": "<p>I am not familiar with the Go SDK, but have you tried to use the \"Required, Optional, and Exclusion\" operators (<a href=\"https://docs.couchbase.com/server/5.5/fts/fts-query-types.html\" rel=\"nofollow noreferrer\">https://docs.couchbase.com/server/5.5/fts/fts-query-types.html</a>)? They probably are exactly what you need.</p>\n"}], "owner": {"reputation": 181, "user_id": 8098544, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a49f5016b496a8e5eec53a38eac15e4f?s=128&d=identicon&r=PG", "display_name": "Ben Rolfe", "link": "https://stackoverflow.com/users/8098544/ben-rolfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 106, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538640884, "creation_date": 1538579545, "last_edit_date": 1538583915, "question_id": 52630271, "link": "https://stackoverflow.com/questions/52630271/where-not-equal-to-in-couchbase", "title": "\u201cwhere not equal to\u201d in Couchbase", "body": "<p>I want to be able to use a \u201cwhere not equal to\u201d WHERE clause in Couchbase.</p>\n\n<p>This code works to INCLUDE \u201cNot Available\u201d records <em>(once you set the Analyser to \u2018keyword\u2019)</em></p>\n\n<pre><code>cbft.NewMatchQuery(\"Not Available\").Field(\"Status\"),\n</code></pre>\n\n<p>But I want to be able to return all records where the Status is anything other than \u201cNot Available\u201d.</p>\n"}, {"tags": ["go", "paypal"], "comments": [{"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1538578815, "post_id": 52629949, "comment_id": 92193434, "body": "Note that <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.1\" rel=\"nofollow noreferrer\">500 means &quot;Internal Server Error&quot;</a>, that is, the remote web server had some error (not your client), and it likely won&#39;t tell you what happened (perhaps for security reasons) but mostly because it wasn&#39;t your fault and there&#39;s likely nothing you can do about it."}, {"owner": {"reputation": 1499, "user_id": 6487762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoPnL.jpg?s=128&g=1", "display_name": "Archana Sharma", "link": "https://stackoverflow.com/users/6487762/archana-sharma"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1538579471, "post_id": 52629949, "comment_id": 92193902, "body": "If I am doing this without golang app, using postman I created payment successfully, Can you suggest me how to get payment approval after creating a payment"}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1538583040, "post_id": 52629949, "comment_id": 92196087, "body": "I would contact the package developer and ask them to add more detailed error information. It appears to be available to them, in the response body, but they appear to be throwing it away."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "edited": false, "score": 0, "creation_date": 1538599200, "post_id": 52629949, "comment_id": 92203921, "body": "@MichaelHampton it&#39;s a best practice to not provide any debugging information in a 500 ISE response since it&#39;s a <i>server</i> error (i.e. it would be bad to report things like database connection failures, programming errors, etc to your clients). PayPal needs to get their house in order."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1538678897, "post_id": 52629949, "comment_id": 92238117, "body": "@maerics You&#39;re assuming (1) it actually is an internal server error and (2) it has no further information. I suspect neither is true. But without actually looking at the complete response, it&#39;s not possible to be sure."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 1, "last_activity_date": 1538599900, "creation_date": 1538599900, "answer_id": 52635519, "question_id": 52629949, "link": "https://stackoverflow.com/questions/52629949/how-to-make-credit-card-payment-using-logpacker-package-paypal/52635519#52635519", "title": "How to make credit card payment using logpacker package paypal?", "body": "<p>The HTTP response code <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.5.1\" rel=\"nofollow noreferrer\">500 means \"Internal Server Error\"</a>:</p>\n\n<blockquote>\n  <p>The server encountered an unexpected condition which prevented it from fulfilling the request.</p>\n</blockquote>\n\n<p>That means your client successfully sent the HTTP request but the server failed to generate an expected response because some problem happened on the server itself and it is the responsibility of the owner of that system to fix it. The root cause could be any number of things (programming error, database problem, networking issue, can of soda spilled on server motherboard, etc.); however, the debugging information exists on the server infrastructure and is generally not (<em>should not!</em>) be available to clients since it may contain sensitive information.</p>\n\n<p>It is <em>possible</em> that there was some problem in the request that your client issued and, in that case, the server should respond with some sort of <a href=\"https://www.w3.org/Protocols/rfc2616/rfc2616-sec10.html#sec10.4\" rel=\"nofollow noreferrer\">4xx \"Client Error\"</a> response. However, we cannot know if that was the case because the server failed to generate a meaningful response.</p>\n\n<p>Your only recourse is to contact the owner of that system, notify them of the error on their server, and hope that they resolve it so you can continue your work.</p>\n"}], "owner": {"reputation": 1499, "user_id": 6487762, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/qoPnL.jpg?s=128&g=1", "display_name": "Archana Sharma", "link": "https://stackoverflow.com/users/6487762/archana-sharma"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 123, "favorite_count": 1, "accepted_answer_id": 52635519, "answer_count": 1, "score": 0, "last_activity_date": 1538599900, "creation_date": 1538578603, "question_id": 52629949, "link": "https://stackoverflow.com/questions/52629949/how-to-make-credit-card-payment-using-logpacker-package-paypal", "title": "How to make credit card payment using logpacker package paypal?", "body": "<p>I am using logpacker package  in golang app to make credit card transaction using paypal, but it returns me <code>POST https://api.sandbox.paypal.com/v1/payments/payment: 500</code> error\nMy main.go file having this code::</p>\n\n<pre><code>package main \n\nimport (\n    paypalsdk \"github.com/logpacker/PayPal-Go-SDK\"\n    \"fmt\"\n)\n\nvar ClientID = \"my-client-id\"\nvar SecretID = \"my-secret-key\"\n\nfunc main() {\n    // Initialize client\n    c, err := paypalsdk.NewClient(ClientID, SecretID, paypalsdk.APIBaseSandBox)\n    if err != nil {\n       panic(err)\n    }\n\n    // Retrieve access token\n    _, err = c.GetAccessToken()\n    if err != nil {\n       panic(err)\n    }\n\n    // Create credit card payment\n    p := paypalsdk.Payment{\n       Intent: \"sale\",\n       Payer: &amp;paypalsdk.Payer{\n          PaymentMethod: \"credit_card\",\n          FundingInstruments: []paypalsdk.FundingInstrument{{\n            CreditCard: &amp;paypalsdk.CreditCard{\n                Number:      \"43118885805455\",\n                Type:        \"visa\",\n                ExpireMonth: \"11\",\n                ExpireYear:  \"2023\",\n                CVV2:        \"123\",\n                FirstName:   \"abc\",\n                LastName:    \"abc\",\n            },\n          }},\n       },\n       Transactions: []paypalsdk.Transaction{{\n            Amount: &amp;paypalsdk.Amount{\n                Currency: \"USD\",\n                Total:    \"7.00\",\n            },\n            Description: \"My Payment\",\n        }},\n        RedirectURLs: &amp;paypalsdk.RedirectURLs{\n            ReturnURL: \"http://...\",\n            CancelURL: \"http://...\",\n        },\n    }\n    _, err = c.CreatePayment(p)\n    if err != nil {\n       fmt.Println(err)\n    }\n    //fmt.Println(data)\n}\n</code></pre>\n\n<p>After this I am running main.go file and it generates following error\nerror: <code>POST https://api.sandbox.paypal.com/v1/payments/payment: 500</code></p>\n\n<p>This is a logpacker package github link: <a href=\"https://github.com/logpacker/PayPal-Go-SDK\" rel=\"nofollow noreferrer\">https://github.com/logpacker/PayPal-Go-SDK</a></p>\n"}, {"tags": ["go", "intellij-idea"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538574052, "post_id": 52628316, "comment_id": 92190261, "body": "<code>os.Getwd()</code>, gives you current working directory, <code>cwd</code> and <code>executable path</code> were different things, were you creating the config file in the first place."}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538575018, "post_id": 52628316, "comment_id": 92190905, "body": "@nilsocket - I can&#39;t use Getwd function because i don&#39;t want to use the working directory in case I execute the file from a different directory, and for some reason Getwd returns the root directory of my project and not the working directory I set in my run/debug profile"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538576145, "post_id": 52628316, "comment_id": 92191582, "body": "who is creating the config file, if it&#39;s you then you can consider having a fixed path, you are not calling <code>filepath.Dir()</code> in <code>InitConfig()</code>. It&#39;s confusing try to report your problem with minimal and complete example"}, {"owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538576571, "post_id": 52628316, "comment_id": 92191860, "body": "@nilsocket - thanks for all the valuable information. it appears I just needed to configure my run/debug profile better."}], "answers": [{"tags": [], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "is_accepted": true, "score": 0, "last_activity_date": 1538576526, "creation_date": 1538576526, "answer_id": 52629235, "question_id": 52628316, "link": "https://stackoverflow.com/questions/52628316/loading-config-file-when-running-a-go-application-with-intellij/52629235#52629235", "title": "loading config file when running a go application with intellij", "body": "<p>it seems that the solution is simple. all I needed is to set the \"Output Directory\" of my run/debug configuration to my project's directory. and then intellij executes the file in that same directory and it can find <code>/config/config.json</code>.</p>\n"}], "owner": {"reputation": 26308, "user_id": 80932, "user_type": "registered", "accept_rate": 85, "profile_image": "https://www.gravatar.com/avatar/c8df6a60fa19ec03cde467dad65c8f24?s=128&d=identicon&r=PG", "display_name": "ufk", "link": "https://stackoverflow.com/users/80932/ufk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 670, "favorite_count": 0, "accepted_answer_id": 52629235, "answer_count": 1, "score": 0, "last_activity_date": 1538576526, "creation_date": 1538573860, "question_id": 52628316, "link": "https://stackoverflow.com/questions/52628316/loading-config-file-when-running-a-go-application-with-intellij", "title": "loading config file when running a go application with intellij", "body": "<p>I use MacOS Mojave with IntelliJ Ultimate 2018.2.</p>\n\n<p>I wrote a go application that loads a config file from the directory of my project. I created an <code>InitConfig()</code> function to load the JSON file into a struct. this is thee code of my <code>Config.go</code> file</p>\n\n<pre><code>package main\n\nimport (\n    \"github.com/tkanos/gonfig\"\n    \"log\"\n)\n\ntype Configuration struct {\n    WebServerPort   int\n    DbName string\n    DbUser string\n    DbPassword string\n    DbPort int\n    CertFile string\n    KeyFile string\n    EnableHttps bool\n}\n\nvar AppConfiguration Configuration\n\nfunc InitConfig() {\n    AppConfiguration = Configuration{}\n    err := gonfig.GetConf(ExPath + \"/config/config.json\", &amp;AppConfiguration)\n    if err != nil {\n        log.Fatalf(\"could not parse configuration file: %v\",err)\n    }\n}\n</code></pre>\n\n<p>I use a variable called <code>ExPath</code> that contains the current directory of the running binary, I created it with the following code (Path.go):</p>\n\n<pre><code>package main\n\nimport (\n    \"log\"\n    \"os\"\n    \"path/filepath\"\n)\n\nvar ExPath string\n\nfunc InitPath() {\n    ex, err := os.Executable()\n    if err != nil {\n        log.Fatalf(\"could not get executable path: %v\",err)\n    }\n    ExPath = filepath.Dir(ex)\n}\n</code></pre>\n\n<p>when I try to run or debug the application, intellij is creating a directory where it compiles and runs the application, how can I tell it to also copy the json file?</p>\n\n<p>when I try to run/debug my App I get:</p>\n\n<pre><code>could not parse configuration file: open /private/var/folders/60/qzt2pgs173s4j_r6lby_mw1c0000gn/T/config/config.json: no such file or directory\n</code></pre>\n\n<p>I checked and that directory really doesn't contain my config directory. so.. is there a way to let intellij know it should copy it before executing my project?</p>\n\n<p>thanks!</p>\n"}, {"tags": ["go", "openapi", "glide-golang"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538571838, "post_id": 52627423, "comment_id": 92188805, "body": "which version of <code>go</code>?"}, {"owner": {"reputation": 2719, "user_id": 4177876, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/i7xAG.jpg?s=128&g=1", "display_name": "Seenu S", "link": "https://stackoverflow.com/users/4177876/seenu-s"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538575149, "post_id": 52627423, "comment_id": 92190985, "body": "Using go 1.11 version"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538575465, "post_id": 52627423, "comment_id": 92191165, "body": "how were you trying to install, I didn&#39;t find any problem, my installation was successfull"}, {"owner": {"reputation": 2719, "user_id": 4177876, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/i7xAG.jpg?s=128&g=1", "display_name": "Seenu S", "link": "https://stackoverflow.com/users/4177876/seenu-s"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538582617, "post_id": 52627423, "comment_id": 92195826, "body": "Added the glide.yaml file in the question."}], "owner": {"reputation": 2719, "user_id": 4177876, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/i7xAG.jpg?s=128&g=1", "display_name": "Seenu S", "link": "https://stackoverflow.com/users/4177876/seenu-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 53, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553436484, "creation_date": 1538570980, "last_edit_date": 1592644375, "question_id": 52627423, "link": "https://stackoverflow.com/questions/52627423/facing-an-issue-with-go-openapi-analysis-library-using-glide", "title": "Facing an issue with go-openapi/analysis library using glide", "body": "<p>I was trying to install the <code>go-openapi/analysis</code> using the <code>glide</code>. Using the <code>glide up -v</code> command for installing. Glide version v0.13.2 and go version 1.11</p>\n<h1>glide.yaml</h1>\n<pre><code>package: abc\nimport:\n- package: github.com/go-openapi/analysis\n  version: 0.16.0\n</code></pre>\n<p>Got this error during the installation process.</p>\n<pre><code>Keeping github.com/go-openapi/analysis 0.16.0 [INFO] \n--&gt; Setting version for github.com/mailru/easyjson to 2f5df55504ebc322e4d52d34df6a1f5b503bf26d. \n[ERROR] Error scanning path/filepath: cannot find package &quot;.&quot; in: \n.glide/cache/src/https-path-filepath\n</code></pre>\n"}, {"tags": ["unit-testing", "go"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 1, "creation_date": 1538571951, "post_id": 52626985, "comment_id": 92188879, "body": "don&#39;t use <code>fmt.Sprintf(...)</code> use <code>filepath.Join(...)</code> to join paths, it&#39;s cross-platform"}], "answers": [{"tags": [], "owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "is_accepted": false, "score": 0, "last_activity_date": 1538571347, "last_edit_date": 1538571347, "creation_date": 1538570935, "answer_id": 52627410, "question_id": 52626985, "link": "https://stackoverflow.com/questions/52626985/unit-test-method-which-need-a-file/52627410#52627410", "title": "Unit test method which need a file", "body": "<p>For writing unit test you need to create a file within same package with <code>fileName_test.go</code>\nSuppose your file name <code>read.go</code> so your test file name should be <code>read_test.go</code>.</p>\n\n<p><strong>read_test.go</strong></p>\n\n<pre><code>      package main\n\n      import (\n         \"testing\"\n         \"fmt\"\n      )\n\n    func TestReadOneFile(t *testing.T) {\n        var a Source\n        f, err := a.readOneFile()\n        if err != nil {\n           t.Errorf(\"incorrect\")\n        } else {\n            fmt.Println(\"passed\")\n        }\n    }\n</code></pre>\n\n<p>Here you have to named your test function name with <code>Test</code> as prefix and need to import package <code>testing</code>.</p>\n\n<p>After creating the unit test you can check the code coverage by running below two commands:</p>\n\n<pre><code>1. go test --coverprofile coverage.out\n2. go tool cover -html=coverage.out\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": true, "score": 1, "last_activity_date": 1538576810, "creation_date": 1538576810, "answer_id": 52629327, "question_id": 52626985, "link": "https://stackoverflow.com/questions/52626985/unit-test-method-which-need-a-file/52629327#52629327", "title": "Unit test method which need a file", "body": "<p>Tests will run in the directory that contains the tests</p>\n\n<p>So Getwd will give the path to that directory</p>\n\n<p>The filename for test data in files in test directories should begin with underscore <code>_</code></p>\n\n<p>However, your program needs a file called \"file.txt\" .  To support testing this filepath that does not start with <code>_</code> create the file file.txt in (for example) /tmp, do a chdir to /tmp immediately before running the test and let the test pick up the file that was just made</p>\n"}], "owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 52629327, "answer_count": 2, "score": 1, "last_activity_date": 1538581239, "creation_date": 1538569448, "last_edit_date": 1538581239, "question_id": 52626985, "link": "https://stackoverflow.com/questions/52626985/unit-test-method-which-need-a-file", "title": "Unit test method which need a file", "body": "<p>I've the following function and I need to create a unit test for it</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\ntype Source struct {\n    Path string\n}\n\ntype fileReader interface {\n    readOneFile() ([]byte, error)\n}\n\nfunc(s Source) readOneFile() ([]byte, error) {\n    cwd, err := os.Getwd()\n    file, err := ioutil.ReadFile(fmt.Sprintf(\"%s/file.txt\", cwd))\n    if err != nil {\n        return nil, fmt.Errorf(\"erro reading file : %s\", err.Error())\n    }\n    return file, err\n}\n</code></pre>\n\n<p>The problem is that I use path to file in the method, what it the best practice in go to create a unit test for this kind of functions ? </p>\n"}, {"tags": ["firebase", "go", "google-cloud-firestore", "google-admin-sdk"], "answers": [{"tags": [], "owner": {"reputation": 411025, "user_id": 209103, "user_type": "registered", "accept_rate": 73, "profile_image": "https://www.gravatar.com/avatar/12d378e6a9788ab9c94bbafe242b82b4?s=128&d=identicon&r=PG", "display_name": "Frank van Puffelen", "link": "https://stackoverflow.com/users/209103/frank-van-puffelen"}, "is_accepted": true, "score": 1, "last_activity_date": 1538573740, "creation_date": 1538573740, "answer_id": 52628288, "question_id": 52626974, "link": "https://stackoverflow.com/questions/52626974/how-to-return-document-index-name-value/52628288#52628288", "title": "How to return Document Index Name Value", "body": "<p>You can get the document ID from the <code>DocumentSnapshot</code>, by first looking up the <code>DocumentRef</code>:</p>\n\n<pre><code> fmt.Println(doc.Ref.ID)\n</code></pre>\n\n<p>See the reference docs for <a href=\"https://godoc.org/cloud.google.com/go/firestore#DocumentSnapshot\" rel=\"nofollow noreferrer\"><code>DocumentSnapshot</code></a> and <a href=\"https://godoc.org/cloud.google.com/go/firestore#DocumentRef\" rel=\"nofollow noreferrer\"><code>DocumentRef</code></a>.</p>\n"}], "owner": {"reputation": 2724, "user_id": 354007, "user_type": "registered", "accept_rate": 12, "profile_image": "https://www.gravatar.com/avatar/6c577241666b544e9fa19d9a013f964c?s=128&d=identicon&r=PG", "display_name": "IrishGringo", "link": "https://stackoverflow.com/users/354007/irishgringo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 183, "favorite_count": 0, "accepted_answer_id": 52628288, "answer_count": 1, "score": 0, "last_activity_date": 1538573740, "creation_date": 1538569415, "last_edit_date": 1538573318, "question_id": 52626974, "link": "https://stackoverflow.com/questions/52626974/how-to-return-document-index-name-value", "title": "How to return Document Index Name Value", "body": "<p>This is a GoLang, Firebase AdminSDK question.  </p>\n\n<p>This example works to iterate through all of the documents in a FireStore DB.  </p>\n\n<p>How can I get the Document Name?</p>\n\n<p>To put another way: If the collection name is <code>JohnyCollection</code>, and <code>JohnyCollection</code> has 20 Documents called (<code>Document1</code>, <code>Document2</code>....  <code>Document20</code>), how do I get the document name in golang Code?</p>\n\n<p>//========================================</p>\n\n<pre><code>package main\nimport (\n    \"context\"\n    \"fmt\"\n    \"log\"\n    \"firebase.google.com/go\"\n    \"google.golang.org/api/iterator\"\n    \"google.golang.org/api/option\"\n)\nfunc check(e error) {\n    if e != nil {\n        panic(e)\n    }\n}\nfunc main() {\n    ctx := context.Background()\n    sa := option.WithCredentialsFile(\"./scai-qit-fb-adminsdk.json\")\n    app, err := firebase.NewApp(ctx, nil, sa)\n    if err != nil {\n        log.Fatalf(\"error initializing app: %v\\n\", err)\n    }\n    client, err := app.Firestore(ctx)\n    if err != nil {\n        log.Fatal(err)\n    }\n    defer client.Close()\n    iter := client.Collection(\"COMPLEX_NONACS\").Documents(ctx)\n    for {\n        doc, err := iter.Next()\n        if err == iterator.Done {\n            break\n        }\n        if err != nil {\n            log.Fatalf(\"Failed to iterate: %v\", err)\n        }\n        //This part works.  WIll return a Map of each Document\n        fmt.Println(\"--------------------------/n\")\n        fmt.Println(doc.Data())\n\n        //  This is the question.  How do I get the INDEX name of the Document?\n        //  something like...\n        fmt.Println(doc.Index_value_or_something_that_returns_IndexName())\n\n        //  for example...\n        // {\n        // \"ABC\":{\"line1\":\"yabba dabba\",\"line2\":\"dingo dong\"},\n        // \"DEF\":{\"line1\":\"hooty tooty\",\"line2\":\"blah blah\"}\n        // }\n        // How to just get the \"ABC\"  and \"DEF\"\n\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "constructor", "interface"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 3, "last_activity_date": 1538559340, "last_edit_date": 1538559340, "creation_date": 1538557118, "answer_id": 52623309, "question_id": 52623052, "link": "https://stackoverflow.com/questions/52623052/how-can-i-enforce-correct-construction-whilst-respecting-the-golang-codereviewco/52623309#52623309", "title": "How can I enforce correct construction whilst respecting the golang CodeReviewComments rule on interfaces?", "body": "<p>You may expect developers to read the doc you provide, and you may rely on them following the rules you set. Yes, lazy developers will bump their head from time to time, but the process of developing isn't without having to learn. Everything cannot be made explicit or enforced, and that's all right.</p>\n\n<p>If you have an exported struct type <code>Example</code> and you provide a constructor function <code>NewExample()</code>, that's a clear indication that <code>NewExample()</code> should be used to construct values of <code>Example</code>. Anyone attempting to construct <code>Example</code> manually is expected to know what fields must be set for it to be \"operational\". The aim is always to make the zero value fully functional, but if that can't be achieved, the constructor function is the idiomatic way to go.</p>\n\n<p>This isn't uncommon, there are countless examples in the standard library, e.g. <a href=\"https://golang.org/pkg/net/http/#Request\" rel=\"nofollow noreferrer\"><code>http.Request</code></a>, <a href=\"https://golang.org/pkg/encoding/json/#Encoder\" rel=\"nofollow noreferrer\"><code>json.Encoder</code></a>, <a href=\"https://golang.org/pkg/encoding/json/#Decoder\" rel=\"nofollow noreferrer\"><code>json.Decoder</code></a>, <a href=\"https://golang.org/pkg/io/#SectionReader\" rel=\"nofollow noreferrer\"><code>io.SectionReader</code></a>, <a href=\"https://golang.org/pkg/text/template/#Template\" rel=\"nofollow noreferrer\"><code>template.Template</code></a>.</p>\n\n<p>What you must ensure is that if your package returns values of your structs, they must (should) be properly initialized. And also if others are expected to pass values of your structs created by them, you must provide an easy way for them to create valid values of your structs (constructor function). Whether the custom struct values other developers create themselves are \"valid\", that shouldn't be of your concern.</p>\n"}], "owner": {"reputation": 931, "user_id": 1111555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/34d4405d620371f5f7b600849c04a372?s=128&d=identicon&r=PG", "display_name": "nickform", "link": "https://stackoverflow.com/users/1111555/nickform"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 126, "favorite_count": 1, "accepted_answer_id": 52623309, "answer_count": 1, "score": 3, "last_activity_date": 1541444467, "creation_date": 1538556219, "last_edit_date": 1541444467, "question_id": 52623052, "link": "https://stackoverflow.com/questions/52623052/how-can-i-enforce-correct-construction-whilst-respecting-the-golang-codereviewco", "title": "How can I enforce correct construction whilst respecting the golang CodeReviewComments rule on interfaces?", "body": "<p>The <a href=\"https://github.com/golang/go/wiki/CodeReviewComments#interfaces\" rel=\"nofollow noreferrer\">Interfaces</a> rule in the official Go Code Review Comments document says that packages should return concrete types rather than interfaces. The motivation for this is so that:</p>\n\n<blockquote>\n  <p>...new methods can be added to implementations without requiring extensive refactoring.</p>\n</blockquote>\n\n<p>which I accept could be a good thing.</p>\n\n<p>But what if a type I'm writing has a dependency without which it cannot serve its purpose? If I export the concrete type, developers will be able to instantiate instances without that dependency. To code defensively for the missing dependency, I then have to check for it in every method implementation and return errors if it is absent. If the developer missed any hints not to do this in my documentation, she or he won't learn about the problem until run time.</p>\n\n<p>On the other hand, if I declare and return an interface with the methods the client needs, I can unexport the concrete type and enforce the use of a factory method which accepts the dependency as an argument and returns the interface plus an error. This seems like a better way to ensure correct use of the package.</p>\n\n<p>Am I somehow not properly getting into the go spirit by thinking like this? Is the ethic of the language that it's okay to have a less-than-perfect encapsulation to give more flexibility to developers?</p>\n"}, {"tags": ["mongodb", "go", "hashmap"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538552347, "post_id": 52621988, "comment_id": 92177681, "body": "Please post example documents from your collection, and an example input and desired output for that input."}, {"owner": {"reputation": 632, "user_id": 4377055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oFXnX.jpg?s=128&g=1", "display_name": "engrhussainahmad", "link": "https://stackoverflow.com/users/4377055/engrhussainahmad"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538553285, "post_id": 52621988, "comment_id": 92178115, "body": "I have updated the post with document example."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538553427, "post_id": 52621988, "comment_id": 92178179, "body": "What is the format of your input field names, the ones you want to select? Is it <code>map[int]string</code>? Please provide more info and example of it."}, {"owner": {"reputation": 632, "user_id": 4377055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oFXnX.jpg?s=128&g=1", "display_name": "engrhussainahmad", "link": "https://stackoverflow.com/users/4377055/engrhussainahmad"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538553570, "post_id": 52621988, "comment_id": 92178254, "body": "Yes, while the select accepts only bson.M interface like this: Select(bson.M{&quot;name&quot;: 1})"}], "answers": [{"comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 632, "user_id": 4377055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oFXnX.jpg?s=128&g=1", "display_name": "engrhussainahmad", "link": "https://stackoverflow.com/users/4377055/engrhussainahmad"}, "edited": false, "score": 0, "creation_date": 1538556432, "post_id": 52622505, "comment_id": 92179751, "body": "@engrhussainahmad I asked this explicit question in my comments, and you said it&#39;s <code>map[int]string</code>. Nonetheless, I updated my answer how it could look like with <code>map[interface{}]interface{}</code>."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 2, "last_activity_date": 1538556397, "last_edit_date": 1538556397, "creation_date": 1538553936, "answer_id": 52622505, "question_id": 52621988, "link": "https://stackoverflow.com/questions/52621988/fetch-specific-key-value-pairs-from-mongodb-collection-with-golang/52622505#52622505", "title": "Fetch Specific key value pairs from mongodb collection with golang", "body": "<p>Your desired fields are listed in a <code>map[interface{}]interface{}</code> as <em>values</em> which is not conform to the spec expected by <a href=\"https://godoc.org/github.com/globalsign/mgo#Query.Select\" rel=\"nofollow noreferrer\"><code>Query.Select()</code></a>. The most common type to describe the fields is <a href=\"https://godoc.org/github.com/globalsign/mgo/bson#M\" rel=\"nofollow noreferrer\"><code>bson.M</code></a>, where the keys should be the names of the fields to retrieve.</p>\n\n<p>So you have to construct e.g. a <code>bson.M</code> value from your keys, and use that with <code>Query.Select()</code>. For this we have to find a way to convert the values from <code>interface{}</code> type to <code>string</code>. Simplest and most convenient way is to use <a href=\"https://golang.org/pkg/fmt/#Sprint\" rel=\"nofollow noreferrer\"><code>fmt.Sprint()</code></a> for this.</p>\n\n<p>This is an example how you can do that:</p>\n\n<pre><code>// Example input:\nfields := map[interface{}]interface{}{\n    3: \"name\",\n    1: \"manufacturer\",\n    9: \"sku\",\n}\n\nfields2 := bson.M{}\nfor _, name := range fields {\n    fields2[fmt.Sprint(name)] = 1\n}\n\nerr := collection.Find(operations).Select(fields2).Limit(2).All(&amp;products)\n</code></pre>\n"}], "owner": {"reputation": 632, "user_id": 4377055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oFXnX.jpg?s=128&g=1", "display_name": "engrhussainahmad", "link": "https://stackoverflow.com/users/4377055/engrhussainahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 690, "favorite_count": 0, "accepted_answer_id": 52622505, "answer_count": 1, "score": 2, "last_activity_date": 1538556397, "creation_date": 1538552045, "last_edit_date": 1538553242, "question_id": 52621988, "link": "https://stackoverflow.com/questions/52621988/fetch-specific-key-value-pairs-from-mongodb-collection-with-golang", "title": "Fetch Specific key value pairs from mongodb collection with golang", "body": "<p>I want to fetch specific key value pairs from mongodb collection with golang dynamically.</p>\n\n<pre><code>err := collection.Find(operations).Limit(2).All(&amp;products)\n</code></pre>\n\n<p>How I can do it but it must be dynamically, because the select key value pairs are changing on my side:</p>\n\n<p>Collection document:</p>\n\n<pre><code>{\n    \"_id\" : 168,\n    \"entity_id\" : \"168\",\n    \"type_id\" : \"simple\",\n    \"attribute_set_id\" : \"24\",\n    \"entity_type_id\" : \"4\",\n    \"created_at\" : \"2013-10-31 14:51:18\",\n    \"has_options\" : \"0\",\n    \"required_options\" : \"0\",\n    \"sku\" : \"AIC-19000-16\",\n    \"updated_at\" : \"2016-11-22 21:04:46\",\n    \"base_type\" : 154,\n    \"table_shape\" : 164,\n    \"manufacturer\" : 15,\n    \"delivery\" : \"Free Delivery &amp; Setup\",\n    \"visibility\" : 4,\n    \"tax_class_id\" : 2,\n    \"status\" : 1,\n    \"enable_googlecheckout\" : 1,\n    \"discontinued\" : 0,\n    \"featured_fme\" : 0,\n    \"featured_product\" : 0,\n    \"amxnotif_hide_alert\" : 1,\n    \"is_recurring\" : 0,\n    \"condition\" : 3043,\n    \"ships\" : null,\n    \"ignore_wisepricer\" : 0,\n    \"fedexable\" : null,\n    \"dropshipped\" : 0,\n    \"verified_by\" : 3301,\n    \"reward_point_product\" : null,\n    \"mw_reward_point_sell_product\" : null,\n    \"ashley_sale\" : 0,\n    \"disable_amazonpayments\" : 0,\n    \"for_configurables\" : null,\n    \"rfm\" : 0,\n    \"mk_stockmessage\" : false,\n    \"mk_hideshipdate\" : 0,\n    \"reviews_counter\" : 0,\n    \"mpn\" : \"19000-16\",\n    \"name\" : \"After Eight Titanium Leg Rectangular Dining Table\",\n    \"style\" : \"73\",\n    \"furniture_type\" : \"76\",\n    \"meta_title\" : \"After Eight Titanium Leg Rectangular Dining Table, \n    19000-16, Aico Furniture\",\n    \"meta_description\" : \"After Eight Titanium Leg Rectangular Dining \n    Table from Aico Furniture, 19003-88\",\n    \"options_container\" : \"container2\",\n    \"url_key\" : \"after-eight-titanium-leg-rectangular-dining-table\",\n    \"url_path\" : \"after-eight-titanium-leg-rectangular-dining- \n    table.htm\",\n    \"gallery\" : \"/9/19000-16_d1.jpg, /9/19000-16_d2.jpg, /9/19000- \n    16_d3.jpg, /9/19000-16_d4.jpg, /9/19000-16_d5.jpg, /9/19000- \n    16_d6.jpg, /9/19000-16_d7.jpg,\",\n    \"image\" : \"/a/f/after8-silo-4legrecdin-sm-19000-16.jpg\",\n    \"small_image\" : \"/a/f/after8-silo-4legrecdin-sm-19000-16.jpg\",\n    \"thumbnail\" : \"/a/f/after8-silo-4legrecdin-sm-19000-16.jpg\",\n    \"image_label\" : null,\n    \"small_image_label\" : null,\n    \"thumbnail_label\" : null,\n    \"table_height\" : \"2640,2642\",\n    \"dining_type\" : \"2645\",\n    \"product_listing_ads\" : \"Aico Furniture\",\n    \"carton_dimensions\" : null,\n    \"msrp_enabled\" : \"2\",\n    \"msrp_display_actual_price_type\" : \"4\",\n    \"set_includes\" : null,\n    \"custom_design\" : null,\n    \"page_layout\" : null,\n    \"gift_message_available\" : null,\n    \"color\" : \"3553\",\n    \"clearance\" : null,\n    \"rfm_type\" : null,\n    \"mk_stocktext\" : null,\n    \"mk_ships_in\" : null,\n    \"mk_preordertext\" : null,\n    \"jet_product_status\" : \"not_uploaded\",\n    \"meta_keyword\" : \"After Eight Titanium Leg Rectangular Dining \n    Table, 19000-16, Aico Furniture, dining room, dining, dining room \n    furniture, Leg Rectangular Dining Table, After Eight Titanium, \n    Modern, Wood, Light Colors, amini furniture, michael amini, \n    amini,\",\n    \"description\" : \"\",\n    \"short_description\" : \"\",\n    \"features\" : \"Part of After Eight Collection &lt;br /&gt;Titanium Finish \n    &lt;br /&gt;Hollywood Regency Style &lt;br /&gt; Bold tonal contrasts and fun \n    geometric shapes &lt;br /&gt;Design that blends the best of many styles \n    &lt;br /&gt;Uniquely customizable look &lt;br /&gt;Bold splashes of color \n    &amp;amp; striking patterned accessories &lt;br /&gt;Includes 2- 24\\\" \n    Extension Leaves &lt;br /&gt;Table Extends from 74\\\" to 122\\\" &lt;br \n    /&gt;Mirrored glass inserts in the top &lt;br /&gt;Platinum accents &lt;br \n    /&gt;Also available in Pearl &lt;br /&gt; Optional Chairs&lt;br /&gt;Table Only, \n    Chairs Sold Separately&lt;br /&gt;\",\n    \"dimensions\" : \"4 Leg Rectangular Dining Table: 127.50\\\"W x 45\\\"D \n    x 31\\\"H - 290lbs. &lt;br /&gt;Optional Side Chair: 21.50\\\"W x 26\\\"D x \n    45.75\\\"H - 24lbs. &lt;br /&gt;Optional Arm Chair: 23.75\\\"W x 26\\\"D x \n    45.75\\\"H - 28lbs. &lt;br /&gt;\",\n    \"custom_layout_update\" : null,\n    \"upc\" : null,\n    \"cost\" : 999.0,\n    \"price\" : 2849.0,\n    \"tier_price_for_bundle\" : 2279.2,\n    \"weight\" : 290.0,\n    \"regularprice\" : 2629.0,\n    \"special_price\" : null,\n    \"msrp\" : null,\n    \"estimated_shipping\" : null,\n    \"estimated_set_shipping\" : null,\n    \"family_rating_summary\" : 0.0,\n    \"news_from_date\" : null,\n    \"news_to_date\" : null,\n    \"special_from_date\" : null,\n    \"special_to_date\" : null,\n    \"custom_design_from\" : null,\n    \"custom_design_to\" : null,\n    \"mk_expecdate\" : null,\n    \"mk_preorderdate\" : null,\n}\n</code></pre>\n\n<p>I want to select below key values:</p>\n\n<p>This is the format in which these keys come with me:</p>\n\n<pre><code>map[2: 3:manufacturer 8:upc 12:weight 15: 0:name 5:short_description \n6:sku 13:category 1: 4:manufacturer 9:image 10:url \n16:product_listing_ads 7:mpn 11:final_price 14:mapping:1]\n</code></pre>\n\n<p>Thanks for your help.</p>\n"}, {"tags": ["mysql", "go", "sqlx"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551369, "post_id": 52621745, "comment_id": 92177171, "body": "You cannot have multiple columns with the same name in the result set, it&#39;s just <code>mysql</code> cli feature that it handles it"}, {"owner": {"reputation": 150, "user_id": 10294987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSnKT.jpg?s=128&g=1", "display_name": "dakait", "link": "https://stackoverflow.com/users/10294987/dakait"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551794, "post_id": 52621745, "comment_id": 92177407, "body": "Okay, I don&#39;t know how to do it. I tried using <code>profile.id as profile_id</code> instead of <code>profile.id</code> but it didn&#39;t work. Can you provide me a little more help?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551955, "post_id": 52621745, "comment_id": 92177481, "body": "I googled for &quot;go sqlx join select&quot; and this is the first result: <a href=\"https://snippets.aktagon.com/snippets/757-how-to-join-two-tables-with-jmoiron-sqlx\" rel=\"nofollow noreferrer\">snippets.aktagon.com/snippets/&hellip;</a>"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1538552297, "post_id": 52621745, "comment_id": 92177654, "body": "There is absolutely nothing unique about left join (or any join) in sqlx. sqlx just handles the rows returned by your database--the logic behind that query is 100% irrelevant to sqlx."}], "answers": [{"comments": [{"owner": {"reputation": 150, "user_id": 10294987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSnKT.jpg?s=128&g=1", "display_name": "dakait", "link": "https://stackoverflow.com/users/10294987/dakait"}, "edited": false, "score": 0, "creation_date": 1538572579, "post_id": 52625763, "comment_id": 92189273, "body": "I can&#39;t change the db name as I&#39;m working with already existing database. I find the snippet provided by @zerkms closest to my query and it did in fact solved my problem."}, {"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "reply_to_user": {"reputation": 150, "user_id": 10294987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSnKT.jpg?s=128&g=1", "display_name": "dakait", "link": "https://stackoverflow.com/users/10294987/dakait"}, "edited": false, "score": 0, "creation_date": 1538573208, "post_id": 52625763, "comment_id": 92189697, "body": "you don&#39;t need to change anything inside database you have to just change struct <code>Person</code> like  here I&#39;m talking about <code>Id      int64   ``db:&quot;pId&quot;</code> ,  this <code>db</code> actually you need to change."}], "tags": [], "owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "is_accepted": false, "score": 0, "last_activity_date": 1538566097, "last_edit_date": 1538566097, "creation_date": 1538565018, "answer_id": 52625763, "question_id": 52621745, "link": "https://stackoverflow.com/questions/52621745/how-left-join-works-with-sqlx/52625763#52625763", "title": "How left join works with sqlx", "body": "<p>You need to change <code>db</code> name in <code>person</code> struct like below i'm describing because there would be two column with same name i.e. <code>id</code> so it scan only last one id which is in your <code>profile</code> table and not scan of <code>person</code> table, so follow the struct as mentioned below.</p>\n\n<pre><code>type Person struct {\n    Id      int64   `db:\"pId\"`\n    Name    string  `db:\"name\"`\n    Email   string  `db:\"email\"`\n}\n</code></pre>\n\n<p>And then write your query with <code>as</code> for <code>person.id</code> like</p>\n\n<pre><code>DB.Select(&amp;q, \"select (person.id) as pId, person.name, person.email, profile.id, profile.face, profile.hair from profile left join person on person.id = profile.person_id\")\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": false, "score": 0, "last_activity_date": 1538565462, "last_edit_date": 1538565462, "creation_date": 1538565062, "answer_id": 52625771, "question_id": 52621745, "link": "https://stackoverflow.com/questions/52621745/how-left-join-works-with-sqlx/52625771#52625771", "title": "How left join works with sqlx", "body": "<p>The error is due to returning two <code>id</code> columns from the result but storing the result in a struct with same field name id in both structs, whose instance you are passing to DB.Select. Try to capture single id column and pass it to struct.</p>\n\n<p>Pass multiple columns but different columns name which you can use as an alias. The column alias name will be the field in the Person struct in which you are scanning the data as:</p>\n\n<pre><code>type Person struct {\n    PersonId    int64   `db:\"personId\"`\n    Name        string  `db:\"name\"`\n    Email       string  `db:\"email\"`\n}\n\nvar q []Profile\nDB.Select(&amp;q, \"select person.id as personId, person.name, person.email, profile.id, profile.face, profile.hair from profile left join person on person.id = profile.person_id\")\nfmt.Println(q)\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 150, "user_id": 10294987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSnKT.jpg?s=128&g=1", "display_name": "dakait", "link": "https://stackoverflow.com/users/10294987/dakait"}, "is_accepted": false, "score": 1, "last_activity_date": 1538658177, "creation_date": 1538658177, "answer_id": 52647452, "question_id": 52621745, "link": "https://stackoverflow.com/questions/52621745/how-left-join-works-with-sqlx/52647452#52647452", "title": "How left join works with sqlx", "body": "<p>Following the snippet provided by <a href=\"https://stackoverflow.com/users/251311/zerkms\">@zerkms</a> I made a few changes which allowed me to run the program without errors and without renaming db tags.\nFirst, I added the below code in profile struct to let the query identify person struct</p>\n\n<pre><code>Person `db:\"person\"`\n</code></pre>\n\n<p>Following this I changed my SQL query string to the below code</p>\n\n<pre><code>DB.Select(&amp;q, `select person.id \"person.id\", person.name \"person.name\", person.email \"person.email\", profile.* from profile left join person on person.id = profile.person_id`)\n</code></pre>\n\n<p>to avoid duplicate column names as pointed out by <a href=\"https://stackoverflow.com/users/251311/zerkms\">@zerkms</a></p>\n"}], "owner": {"reputation": 150, "user_id": 10294987, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/sSnKT.jpg?s=128&g=1", "display_name": "dakait", "link": "https://stackoverflow.com/users/10294987/dakait"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2155, "favorite_count": 0, "answer_count": 3, "score": 1, "last_activity_date": 1538658177, "creation_date": 1538551170, "question_id": 52621745, "link": "https://stackoverflow.com/questions/52621745/how-left-join-works-with-sqlx", "title": "How left join works with sqlx", "body": "<p>I'm trying to inner join two tables <code>person</code> and <code>profile</code> with a simple query which seems to work fine with mysql but not with sqlx. \nHere's my go code:</p>\n\n<pre><code>package main \n\nimport (\n    \"fmt\"\n    \"github.com/jmoiron/sqlx\"\n    _ \"github.com/go-sql-driver/mysql\"\n)\n\ntype Person struct {\n    Id      int64   `db:\"id\"`\n    Name    string  `db:\"name\"`\n    Email   string  `db:\"email\"`\n}\n\ntype Profile struct {\n    Id          int64   `db:\"id\"`\n    Face        string  `db:\"face\"`\n    Hair        string  `db:\"hair\"`\n    Person\n}\n\nfunc main() {\n    DB, err := sqlx.Connect(\"mysql\", \"root:hackinitiator@/dusk\")\n    if err == nil {\n        fmt.Println(\"sucess!!\")\n    } \n    var q []Profile\n    DB.Select(&amp;q, \"select person.id, person.name, person.email, profile.id, profile.face, profile.hair from profile left join person on person.id = profile.person_id\")\n    fmt.Println(q)\n}\n</code></pre>\n\n<p>The mysql query produces the following output:</p>\n\n<pre><code>+------+------+---------+----+----------+--------+\n| id   | name | email   | id | face     | hair   |\n+------+------+---------+----+----------+--------+\n|    1 | yoda | nomail  |  1 | round    | brown  |\n|    5 | han  | nomail1 |  3 | circle   | red    |\n|    6 | yun  | nomail2 |  4 | triangle | yellow |\n|    7 | chi  | nomail3 |  5 | square   | green  |\n+------+------+---------+----+----------+--------+\n</code></pre>\n\n<p>which is perfectly fine but my go program is not responding as expected. The struct is unable to capture the profile id(empty in output) and person id is replaced with profile id. Below is the output(formatted):</p>\n\n<pre><code>[\n{0 round brown {1 yoda nomail}} \n{0 circle red {3 han nomail1}} \n{0 triangle yellow {4 yun nomail2}} \n{0 square green {5 chi nomail3}}\n]\n</code></pre>\n\n<p>I'm unable to figure out what went wrong.</p>\n"}, {"tags": ["go", "error-handling", "abstraction"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551109, "post_id": 52621681, "comment_id": 92177014, "body": "Or you could combine: return a single error type that wraps a particular <code>Computer</code>-specific error."}, {"owner": {"reputation": 375, "user_id": 6935236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hC8l2tY8XIY/AAAAAAAAAAI/AAAAAAAAABg/TZuFezYPtoc/photo.jpg?sz=128", "display_name": "Shivaprasad Bhat", "link": "https://stackoverflow.com/users/6935236/shivaprasad-bhat"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551175, "post_id": 52621681, "comment_id": 92177059, "body": "Like <code>errors.NewComputerFailure(err)</code> ?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551201, "post_id": 52621681, "comment_id": 92177077, "body": "Yep ..............."}, {"owner": {"reputation": 375, "user_id": 6935236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hC8l2tY8XIY/AAAAAAAAAAI/AAAAAAAAABg/TZuFezYPtoc/photo.jpg?sz=128", "display_name": "Shivaprasad Bhat", "link": "https://stackoverflow.com/users/6935236/shivaprasad-bhat"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551354, "post_id": 52621681, "comment_id": 92177162, "body": "Unfortunately, that is not possible since at the very least, my http handlers need to differentiate between client errors and internal errors.. For example, if a <code>Computer</code> implementation depends on a db/external service and that fails, it&#39;s a internal error.. But if client sends a compute request which requires dividing by zero, it&#39;s a client error. So mapping all <code>Compute</code> errors into one <code>ComputeFailure</code> wouldn&#39;t work."}, {"owner": {"reputation": 375, "user_id": 6935236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hC8l2tY8XIY/AAAAAAAAAAI/AAAAAAAAABg/TZuFezYPtoc/photo.jpg?sz=128", "display_name": "Shivaprasad Bhat", "link": "https://stackoverflow.com/users/6935236/shivaprasad-bhat"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551696, "post_id": 52621681, "comment_id": 92177353, "body": "I am not asking it to be automatically. My question was <b>where</b> should the domain error be generated. Should the <code>Compute</code> implementation return constant errors defined in <code>arith</code>, <code>algebra</code> etc. packages, and <code>ComputeService</code> maps it to its own error types or <code>Compute</code> implementation itself return appropriate domain errors?"}], "answers": [{"comments": [{"owner": {"reputation": 375, "user_id": 6935236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hC8l2tY8XIY/AAAAAAAAAAI/AAAAAAAAABg/TZuFezYPtoc/photo.jpg?sz=128", "display_name": "Shivaprasad Bhat", "link": "https://stackoverflow.com/users/6935236/shivaprasad-bhat"}, "edited": false, "score": 0, "creation_date": 1538594718, "post_id": 52633979, "comment_id": 92201921, "body": "Thanks for the answer. In addition to the original question, in your opinion does this apply to <code>Repository</code> objects as well ? For example, should the <code>UserRepository.FindUserByID(uid)</code> return <code>ErrNoRecordFound</code> (where <code>var ErrNoRecordFound = erros.New(&quot;no record&quot;)</code> or should it directly return <code>MyDomainError{&quot;no such user&quot;, uid} </code> ?"}, {"owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "reply_to_user": {"reputation": 375, "user_id": 6935236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hC8l2tY8XIY/AAAAAAAAAAI/AAAAAAAAABg/TZuFezYPtoc/photo.jpg?sz=128", "display_name": "Shivaprasad Bhat", "link": "https://stackoverflow.com/users/6935236/shivaprasad-bhat"}, "edited": false, "score": 0, "creation_date": 1538596161, "post_id": 52633979, "comment_id": 92202560, "body": "If you&#39;ve standardized on the ErrNoRecordFound for <i>all</i> implementors, then I would say that satisfies the interface and interpretation in the service is ok. I guess my answer would more simply be: if the wrapping service needs to understand it, then it needs to be of a known type, and that should be considered part of &quot;implementing&quot; the interface. Whether that is ErrNoRecordFound or a specific domain error isn&#39;t really material."}], "tags": [], "owner": {"reputation": 2186, "user_id": 1647656, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/0a27a80f0a9800a2fc5935ecf7071eca?s=128&d=identicon&r=PG", "display_name": "Alex Guerra", "link": "https://stackoverflow.com/users/1647656/alex-guerra"}, "is_accepted": true, "score": 1, "last_activity_date": 1538593155, "creation_date": 1538593155, "answer_id": 52633979, "question_id": 52621681, "link": "https://stackoverflow.com/questions/52621681/mapping-external-errors-to-domain-errors-in-golang/52633979#52633979", "title": "Mapping external errors to domain errors in golang", "body": "<p>Implementors of <code>Computer</code> should respond with the domain errors, since they're the closest ones to the action and best able to determine what an error is. Like you said, having that logic <em>in</em> <code>ComputeService</code> breaks the abstraction. If you need mapping code from specific <code>Computer</code> errors to domain errors, create wrapper structs that separate the main logic from that error wrapping code.</p>\n\n<p>To keep internal error context, just embed the original error in the domain error and make <code>IsSpecificDomainError</code> helpers.</p>\n\n<pre><code>type MyDomainError struct {\n    Err error\n}\n\nfunc NewMyDomainErr(err error) error {\n    return &amp;MyDomainError{err}\n}\n\nfunc IsMyDomainError(e error) bool {\n    _, ok := err.(*MyDomainError)\n    return ok\n}\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": false, "score": 0, "last_activity_date": 1561103551, "creation_date": 1561103551, "answer_id": 56699108, "question_id": 52621681, "link": "https://stackoverflow.com/questions/52621681/mapping-external-errors-to-domain-errors-in-golang/56699108#56699108", "title": "Mapping external errors to domain errors in golang", "body": "<blockquote>\n  <p>To keep internal error context, just embed the original error in the domain error </p>\n</blockquote>\n\n<p>This can use Wrapping errors, which are on their way for Go 1.13 (Q4 2019), from <a href=\"https://github.com/golang/go/issues/29934\" rel=\"nofollow noreferrer\">issue 29934</a>, as <a href=\"https://github.com/golang/go/issues/29934#issuecomment-489682919\" rel=\"nofollow noreferrer\">detailed here</a>.</p>\n\n<p><strong>err.Is()</strong>:</p>\n\n<p>As Russ Cox <a href=\"https://github.com/golang/go/issues/29934#issuecomment-490546708\" rel=\"nofollow noreferrer\">mentions</a>:</p>\n\n<blockquote>\n  <p>I think we all agree that <code>strings.Contains(err.Error(), \"not found\")</code> is fragile code. </p>\n  \n  <p>I hope we also agree that we'd prefer to see code like <code>errors.Is(err, os.ErrNotExist)</code>. </p>\n  \n  <p>But the point is that in many cases, it is essential to future evolution of a package to keep callers from depending on a particular error result satisfying <code>errors.Is(err, os.ErrNotExist)</code>, even if that is the underlying cause in <em>today</em>'s result.<br>\n  It's like looking at an unexported field or comparing error text - it's a detail that might change. </p>\n  \n  <p>And while <code>strings.Contains</code> looks and is fragile, <code>errors.Is</code> does not look nor should be considered fragile.<br>\n  If we are to avoid it being fragile, then we need to provide a way for packages to report detail without letting clients test for it. That way is errors that can't be unwrapped.</p>\n</blockquote>\n\n<p><strong>err.As()</strong>:</p>\n\n<pre><code>var pe *os.PathError\nif errors.As(err, &amp;pe) {\n     use(pe)\n}\n</code></pre>\n\n<p><a href=\"https://github.com/golang/go/issues/29934#issuecomment-458229227\" rel=\"nofollow noreferrer\"><strong>%w</strong></a>:</p>\n\n<pre><code>func inner() error { return errors.New(\"inner error\") }\nfunc outer() error { return fmt.Errorf(\"outer error: %w\", inner()) }\n\nfmt.Fprintf(\"%+v\", outer())\n// outer error:\n//     /path/to/file.go:123\n//   - inner error:\n//     /path/to/file.go:122\n</code></pre>\n\n<p>The <a href=\"https://github.com/golang/go/issues/29934#issuecomment-490456945\" rel=\"nofollow noreferrer\">current status for Go 1.13</a>:</p>\n\n<blockquote>\n  <p>Just stating what I see as the compromise solution offered by the team:</p>\n  \n  <ul>\n  <li><code>fmt.Errorf</code> is currently being used extensively to wrap errors and return a new (opaque) error (as in you cannot access the underlying error).<br>\n  '<code>%w</code>' can now be used to explicitly opt-in to return an error that can be unwrapped.</li>\n  <li>errors is designed as a base package with no dependencies so that every package can depend on it.</li>\n  <li>the team agrees to punt on the areas that there is broad disagreement, and want to release just enough (errors.Is, errors.As, extension to way most folks wrap errors) so folks can achieve things.</li>\n  <li>Generics is not here yet, and we do not know when it will come: the heated discussion on that will make this one on \"error 2 values\" look like child's play.<br>\n  <code>errors.Is</code> and <code>errors.As</code> are clean and concise enough to be comfortable for a long time.</li>\n  </ul>\n  \n  <p>Most of the contentious things have been punted to go 1.14.</p>\n  \n  <ul>\n  <li><code>Wrapf</code> cannot live in errors as it is a base package.</li>\n  <li><code>Wrapf</code> means team MUST decide on what happens when a <code>nil</code> error is passed: Punt on it.</li>\n  <li>Wrap may conflict with ideas being considered for localization, internationalization, etc.</li>\n  <li><code>ErrorFormatter</code> and <code>ErrorPrinter</code> have not yet gotten much deeper usage and have warts. Punt.</li>\n  </ul>\n</blockquote>\n"}], "owner": {"reputation": 375, "user_id": 6935236, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-hC8l2tY8XIY/AAAAAAAAAAI/AAAAAAAAABg/TZuFezYPtoc/photo.jpg?sz=128", "display_name": "Shivaprasad Bhat", "link": "https://stackoverflow.com/users/6935236/shivaprasad-bhat"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 543, "favorite_count": 1, "accepted_answer_id": 52633979, "answer_count": 2, "score": 1, "last_activity_date": 1561103551, "creation_date": 1538550941, "question_id": 52621681, "link": "https://stackoverflow.com/questions/52621681/mapping-external-errors-to-domain-errors-in-golang", "title": "Mapping external errors to domain errors in golang", "body": "<p>I have a service type called <code>ComputeService</code> which implements certain domain logic. The service itself depends on implementation of an interface called <code>Computer</code> which has a method <code>Computer.Compute(args...) (value, error)</code>.  As shown, <code>Compute</code> itself might return certain errors. </p>\n\n<p><code>ComputeService</code> needs to send appropriate errors from a set of domain-errors with proper domain-error code so that translations can be done and also clients can handle errors appropriately. </p>\n\n<p>My question is, should the <code>Computer</code> implementations be wrapping their failure in domain-errors or should <code>ComputeService</code> do this. If <code>ComputeService</code> is the one doing it, then it will have to know about different errors returned by different implementations of <code>Computer</code> interface which in my opinion breaks the abstraction. Both ways are demonstrated below:</p>\n\n<pre><code>package arithmetic\ntype Computer struct {\n}\nfunc (ac Computer) Compute(args ....) (value, error) {\n     // errors is a domain-errors package defined in compute service project\n     return errors.NewDivideByZero()\n}\n</code></pre>\n\n<p>OR </p>\n\n<pre><code>package compute\ntype Service struct {\n}\nfunc (svc Service) Process(args...) error {\n    computer := findComputerImplementation(args...)\n    val, err := computer.Compute(args...)\n    if err != nil {\n       if err == arith.ErrDivideByZero {\n          // converting an arithmetic computer implementation \n          // specific error to domain error\n          return errors.NewDivideByZero()\n       } else if err == algebra.ErrInvalidCoEfficient {\n          // converting an algebraic computer implementation \n          // specific error to domain error\n          return errors.NewBadInput()\n       }\n       // some new implementation was used and we have no idea\n       // what errors it could be returning. so we have to send\n       // a internal server error equivalent here\n       return errors.NewInternalError()\n    }\n\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "interface"], "comments": [{"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538550911, "post_id": 52621577, "comment_id": 92176923, "body": "What error?......"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551067, "post_id": 52621577, "comment_id": 92176990, "body": "@zerkms  - the error is: &quot;cannot use a as type source &quot;"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551180, "post_id": 52621577, "comment_id": 92177062, "body": "That&#39;s because <code>type source</code> in different packages are different non-assignable types"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551415, "post_id": 52621577, "comment_id": 92177202, "body": "@zerkms - can you please provide example how to make it work correctly ?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551569, "post_id": 52621577, "comment_id": 92177279, "body": "I&#39;m not sure I understand your intentions: your code is incomplete and you have not explained the original problem. One quick advice: you probably don&#39;t need to declare <code>source</code> type in both packages, but just in one. It&#39;s also not obvious how an interface could help with anything since you&#39;re not even using it."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551743, "post_id": 52621577, "comment_id": 92177378, "body": "@zerkms - my question is, assume that I&#39;ve the <code>interface &amp; func implementation and the struct</code>  in packageA/fileA and I want to use it in package B how should I do it ?"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551773, "post_id": 52621577, "comment_id": 92177392, "body": "@zerkms - can you please provide example ?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551788, "post_id": 52621577, "comment_id": 92177403, "body": "Nothing in your code implements that interface <a href=\"https://tour.golang.org/methods/9\" rel=\"nofollow noreferrer\">tour.golang.org/methods/9</a>"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551855, "post_id": 52621577, "comment_id": 92177438, "body": "The func <code>readFile</code> is implementing the interface , why not ?"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538551981, "post_id": 52621577, "comment_id": 92177494, "body": "functions themselves do not implement interfaces, method receivers do"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538552084, "post_id": 52621577, "comment_id": 92177553, "body": "@NinaS does fileA and fileB belong to same package?"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538554184, "post_id": 52621577, "comment_id": 92178601, "body": "@zerkms - can be or not but lets start with the same package"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538554612, "post_id": 52621577, "comment_id": 92178809, "body": "@NinaS you cannot declare type with the same name twice in the same package"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 0, "creation_date": 1538555437, "post_id": 52621577, "comment_id": 92179244, "body": "@zerkms - it will be great if you can take the <code>readFile</code> function  and put it as answer as it should be as implemented by interface . thanks :)"}], "answers": [{"comments": [{"owner": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "edited": false, "score": 0, "creation_date": 1538562279, "post_id": 52624813, "comment_id": 92183118, "body": "Actually @NinaS assume to be both file in same package as written in their comments like <code>can be or not but lets start with the same package</code>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 761, "user_id": 7849087, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/OZ7yQ.jpg?s=128&g=1", "display_name": "saddam", "link": "https://stackoverflow.com/users/7849087/saddam"}, "edited": false, "score": 1, "creation_date": 1538562380, "post_id": 52624813, "comment_id": 92183175, "body": "@saddam if they are in the same package then this error will not occur. Also, if the package is same you cannot create a struct with same name. It will panic before you run the program."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538562715, "post_id": 52624813, "comment_id": 92183364, "body": "Thanks 1+ but how should I adopt the function/method ?  can you please update this <a href=\"https://play.golang.org/p/qg_jN3DyWN3\" rel=\"nofollow noreferrer\">play.golang.org/p/qg_jN3DyWN3</a>"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538562885, "post_id": 52624813, "comment_id": 92183450, "body": "@NinaS ok let me implement on my system and get back to you."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538562975, "post_id": 52624813, "comment_id": 92183502, "body": "Thank you for helping :)"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538568165, "post_id": 52624813, "comment_id": 92186407, "body": "Thanks I&#39;ve checked it and its not working , one thing that it confusing is the <code>ReadFile</code> which is func and should be method , can you please change it to <code>readOneFile</code> and implement the interface and you will see that its not working..."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538568402, "post_id": 52624813, "comment_id": 92186545, "body": "@NinaS create a method receiver. I have updated the answer. Also it was working in my system. In case if it is not working please post the error too you are getting in your system."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538568783, "post_id": 52624813, "comment_id": 92186769, "body": "Thank you :) last question , in case I want to add value to the <code>struct</code> should I do it like this \t<code>s := Source{} \t\ts.path = myPath</code>"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538568795, "post_id": 52624813, "comment_id": 92186778, "body": "or there is a better way ?"}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538569014, "post_id": 52624813, "comment_id": 92186914, "body": "or using the <code>New</code> keyword is better ?"}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "reply_to_user": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538569101, "post_id": 52624813, "comment_id": 92186967, "body": "@NinaS initialize the field when creating an instance of struct as s := Source{path:&quot;filePath&quot;}. Using new keyword will create a pointer to struct. For that you need to create pointer type receivers."}, {"owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "edited": false, "score": 0, "creation_date": 1538569496, "post_id": 52624813, "comment_id": 92187211, "body": "Thanks you very much I put it as answered :) , I&#39;ve additional related question please see if you can help : )"}], "tags": [], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "is_accepted": true, "score": 1, "last_activity_date": 1538568331, "last_edit_date": 1538568331, "creation_date": 1538561877, "answer_id": 52624813, "question_id": 52621577, "link": "https://stackoverflow.com/questions/52621577/using-method-of-interface-in-golang-from-different-file/52624813#52624813", "title": "using method of interface in golang from different file", "body": "<p>Import the package containing the <code>source</code> struct in <code>File A</code> and then use that struct to initialize the variable after that pass the variable to the <code>readFile</code> function.</p>\n\n<p><strong>File B</strong></p>\n\n<pre><code>import A\na := A.Source{}\n</code></pre>\n\n<p>Because <code>source</code> struct in File A is different from <code>source</code> struct in File B. And <code>source</code> struct of File A is implementing the interface that's why you need to import the source struct and then pass it into the function.</p>\n\n<p>One this should be noticed that to make any struct or function exportable you should start the struct or fucntion name with upper case letter.</p>\n\n<p><strong>File A</strong></p>\n\n<pre><code>// make struct exportable\ntype Source struct{\n    path string\n}\n</code></pre>\n\n<p>implemented the interface which is different from</p>\n\n<p><strong>File B</strong></p>\n\n<pre><code>type source struct{\n    path string\n}\n</code></pre>\n\n<p>which does not implemented the interface.</p>\n\n<p><strong>Edited</strong></p>\n\n<p>File A</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"io/ioutil\"\n    \"os\"\n)\n\ntype Source struct {\n    Path string\n}\n\ntype fileReader interface {\n    readOneFile() ([]byte, error)\n}\n\nfunc(s Source) readOneFile() ([]byte, error) {\n    cwd, err := os.Getwd()\n    file, err := ioutil.ReadFile(fmt.Sprintf(\"%s/file.txt\", cwd))\n    if err != nil {\n        return nil, fmt.Errorf(\"erro reading file : %s\", err.Error())\n    }\n    return file, err\n}\n</code></pre>\n\n<p>File B</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    s := Source{}\n    data, err := s.readOneFile()\n    if err != nil {\n        fmt.Errorf(\"Error in reading the file\")\n    }\n    fmt.Println(string(data))\n}\n</code></pre>\n"}], "owner": {"reputation": 645, "user_id": 6192772, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/74209ab5f4b99c81cf444d87f85fcc36?s=128&d=identicon&r=PG&f=1", "display_name": "NSS", "link": "https://stackoverflow.com/users/6192772/nss"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1338, "favorite_count": 1, "accepted_answer_id": 52624813, "answer_count": 1, "score": 2, "last_activity_date": 1538568331, "creation_date": 1538550629, "last_edit_date": 1538561920, "question_id": 52621577, "link": "https://stackoverflow.com/questions/52621577/using-method-of-interface-in-golang-from-different-file", "title": "using method of interface in golang from different file", "body": "<p>I've <code>method</code> which I want to provide some interface to make it more easier to test</p>\n\n<p>This is the function</p>\n\n<p><strong>File A</strong></p>\n\n<pre><code>func readFile(s source) ([]byte, error) {\n        p := fs.GetPath()\n        file, err := ioutil.ReadFile(p + \"/\" + s.path + \"/\" + \"rts.yaml\")\n        if err != nil {\n            return yamlFile, fmt.Errorf(\"erro reading file : %s\", err.Error())\n        }\n        return file, err\n    }\n</code></pre>\n\n<p>Now I add for it struct</p>\n\n<pre><code>type source struct{\n    path string\n}\n</code></pre>\n\n<p>And the interface that the <code>readFile</code> is <code>implementing</code></p>\n\n<pre><code>type fileReader interface {\n    readFile(path string) ([]byte, error)\n}\n</code></pre>\n\n<p>And now I need to call this function from another file but Im getting error while doing this</p>\n\n<p><strong>File B</strong> </p>\n\n<pre><code>type source struct {\n    path string\n}\n\n\na := source{}\n\nyamlFile, err := readFile(a)\n</code></pre>\n\n<p>what am I missing here ? </p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 4, "creation_date": 1538549507, "post_id": 52621236, "comment_id": 92176215, "body": "<code>d0</code> has type <code>string</code>, the result of spliting it has type <code>[]string</code>. You cannot assign a slice to a string."}, {"owner": {"reputation": 1383, "user_id": 2503356, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/0988e8491e781bc82e3906ab8c43912f?s=128&d=identicon&r=PG&f=1", "display_name": "Dariel Pratama", "link": "https://stackoverflow.com/users/2503356/dariel-pratama"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538549648, "post_id": 52621236, "comment_id": 92176287, "body": "Yes that&#39;s what i expecting, but it seems <code>d0</code> is a <code>[]string</code> therefore it give me an error."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538549775, "post_id": 52621236, "comment_id": 92176349, "body": "No, you&#39;re getting the error because <code>d0</code> is a <code>string</code>, not a <code>[]string</code>. If it were a <code>[]string</code> you would get a different error for trying to pass it to <code>Split</code>. The return type of <code>Split</code> is different from its argument type, therefore you cannot pass <code>d0</code> to Split and also assign the result to it."}, {"owner": {"reputation": 1383, "user_id": 2503356, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/0988e8491e781bc82e3906ab8c43912f?s=128&d=identicon&r=PG&f=1", "display_name": "Dariel Pratama", "link": "https://stackoverflow.com/users/2503356/dariel-pratama"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 1, "creation_date": 1538549907, "post_id": 52621236, "comment_id": 92176421, "body": "ah I got it what you mean, so Go cannot reassign to a different type. in this case I have to assign the result to a new variable called <code>d1</code>, and the error is gone. thank you very much @mkopriva."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538550037, "post_id": 52621236, "comment_id": 92176487, "body": "Correct, in Go if a variable has a specific type you cannot assign a value of a different type to it."}], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 0, "last_activity_date": 1538578013, "creation_date": 1538578013, "answer_id": 52629740, "question_id": 52621236, "link": "https://stackoverflow.com/questions/52621236/cannot-use-as-type-string-in-assignment/52629740#52629740", "title": "&quot;cannot use as type string in assignment&quot;", "body": "<p>The answer to your question is in the error message you noted:</p>\n\n<blockquote>\n  <p>cannot use strings.Split(d0, \",\") (type []string) as type string in assignment</p>\n</blockquote>\n\n<p>The reason is that you declare <code>d0</code> as having type \"string\" and then you try to assign a <em>slice</em> of strings to it. Since those are different types the compiler generates the error you listed and refuses to compile your program.</p>\n\n<pre><code>d0 := data[0] // Here we declare d0 as a string and assign a value to it\nd0 = strings.Split(d0, \",\") // ERROR: \"Split\" returns a []string but d0 is a string!\n</code></pre>\n\n<p>To work around you should simply declare a new variable that is a slice of strings instead of trying to reuse the name <code>d0</code>:</p>\n\n<pre><code>d0 := data[0] // Define d0 as a string\nss := strings.Split(d0, \",\") // OK: Define ss as a []string\n</code></pre>\n"}], "owner": {"reputation": 1383, "user_id": 2503356, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/0988e8491e781bc82e3906ab8c43912f?s=128&d=identicon&r=PG&f=1", "display_name": "Dariel Pratama", "link": "https://stackoverflow.com/users/2503356/dariel-pratama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 3451, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538578013, "creation_date": 1538549415, "last_edit_date": 1538552369, "question_id": 52621236, "link": "https://stackoverflow.com/questions/52621236/cannot-use-as-type-string-in-assignment", "title": "&quot;cannot use as type string in assignment&quot;", "body": "<p>I have the following string:</p>\n\n<pre><code>-1,856,32,0,0,0.000000,0.000000\n0,0,0,137,0,0,0,140\n0,0,101,0,0,0,42,0\n0,0,0,0,0,0,0,0\n0,0,0,0,0,0,554,0\n-1,841,1,0,0,0.000000,0.000000\n0,0,0,163,0,0,0,182\n0,0,120,0,0,0,43,0\n0,0,0,0,0,0,0,0\n0,0,0,0,0,0,517,0\n</code></pre>\n\n<p>then I split it by using separator <code>-1</code> which mean there will be an array consisting of 2 elements (let's call it <code>array1</code>). now, let say on the first element of <code>array1</code> I want to split it again by <code>\\r\\n</code>, which will be an array (<code>array2</code>) consisting of 5 elements. next, I want to split the first element of <code>array2</code> by using <code>,</code> as the separator, but it give me a warning saying:</p>\n\n<pre><code>cannot use strings.Split(d0, \",\") (type []string) as type string in assignment\n</code></pre>\n\n<p>here is the code:</p>\n\n<pre><code>array1 := strings.Split(string(b), \"-1,\")\nfor k, chunk := range chunks{\n    // skip the first\n    // because it's blank\n    // duno why\n    if k == 0{\n        continue\n    }\n\n    array2 := strings.Split(chunk, \"\\r\\n\")\n\n    d0 := data[0]\n    d0 = strings.Split(d0, \",\") // this give me error: cannot use strings.Split(d0, \",\") (type []string) as type string in assignment\n    lat, lng := d0[4], d0[5]\n    // \n    //  TODO: match lat and lng againts lamp table in DB which is now in $coords\n    //  \n    fmt.Println(lat, lng)\n\n    data = data[1:]\n    for _, v := range data{\n        _ = v\n    }\n}\n</code></pre>\n"}, {"tags": ["go"], "answers": [{"tags": [], "owner": {"reputation": 1358, "user_id": 5275376, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/a8bbb1e2df58ceebc9bbb5596bf823f3?s=128&d=identicon&r=PG&f=1", "display_name": "Shiva Kishore", "link": "https://stackoverflow.com/users/5275376/shiva-kishore"}, "is_accepted": true, "score": 0, "last_activity_date": 1538549347, "last_edit_date": 1538549347, "creation_date": 1538548997, "answer_id": 52621143, "question_id": 52621055, "link": "https://stackoverflow.com/questions/52621055/goroutines-not-working-when-method-on-a-struct-is-called/52621143#52621143", "title": "Goroutines not working when method on a struct is called", "body": "<p>The Issue is that the program exits before the functions could execute and print out to stdout.<br>\nOne simple fix is to wait for both of the go routines to finish and then exit from main function. <br>\nHere is a link that you can refer : <a href=\"https://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/\" rel=\"nofollow noreferrer\">https://nathanleclaire.com/blog/2014/02/15/how-to-wait-for-all-goroutines-to-finish-executing-before-continuing/</a></p>\n\n<p>here is your program implemented with WaitGroups</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"sync\"\n)\n\ntype somestruct struct {\n    ID       int\n    ItemName string\n    wg       *sync.WaitGroup\n}\n\nfunc (s *somestruct) isAlive() (alive bool) {\n    defer s.wg.Done()\n    alive = true\n    fmt.Printf(\"%s was asked if it's alive \\n\", s.ItemName)\n    return\n}\n\nfunc main() {\n    var wg sync.WaitGroup\n    wg.Add(2)\n    struct1 := somestruct{\n        ID:       1,\n        ItemName: \"Item 1\",\n        wg:       &amp;wg,\n    }\n\n    struct2 := somestruct{\n        ID:       2,\n        ItemName: \"Item 2\",\n        wg:       &amp;wg,\n    }\n\n    go struct1.isAlive()\n    go struct2.isAlive()\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"reputation": 6405, "user_id": 959936, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/e97b823512add9d58a2f679407b2e666?s=128&d=identicon&r=PG", "display_name": "Jurudocs", "link": "https://stackoverflow.com/users/959936/jurudocs"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "closed_date": 1538549096, "accepted_answer_id": 52621143, "answer_count": 1, "score": 0, "last_activity_date": 1538549347, "creation_date": 1538548655, "question_id": 52621055, "link": "https://stackoverflow.com/questions/52621055/goroutines-not-working-when-method-on-a-struct-is-called", "closed_reason": "Duplicate", "title": "Goroutines not working when method on a struct is called", "body": "<p>I'm trying to get into go and I'm facing a problem which appears when using go routines on a method of a struct. What I was expecting is that the code prints the following output:</p>\n\n<blockquote>\n  <p>Item 1 was asked if it's alive</p>\n  \n  <p>Item 2 was asked if it's alive</p>\n</blockquote>\n\n<p>But it's not printing anything. When I leave out the \"go\"routines (at struct1.isAlive()) it's working fine. How can I make the goroutines work?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype somestruct struct {\n    ID              int\n    ItemName        string\n}\n\nfunc (s *somestruct) isAlive() (alive bool) {\n    alive = true\n    fmt.Printf(\"%s was asked if it's alive \\n\", s.ItemName)\n    return\n}\n\n\nfunc main() {\n    struct1 := somestruct{\n        ID:1,\n        ItemName:\"Item 1\"}\n\n    struct2 := somestruct{\n        ID:2,\n        ItemName:\"Item 2\"}\n\n\n    go struct1.isAlive()\n    go struct2.isAlive()\n</code></pre>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 0, "creation_date": 1538548673, "post_id": 52620711, "comment_id": 92175797, "body": "If the arrays are very large and you only want to read a part of the file you could read it character by character until you have the label you want and then stop. It&#39;s not particularly flexible if your JSON object format changes - that&#39;s where a parser is handy, but if all the files are like your examples it might be enough to get the job done."}, {"owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 1, "creation_date": 1538548891, "post_id": 52620711, "comment_id": 92175900, "body": "Alternatively, there&#39;s a streaming API for decoding JSON. This is a much nicer approach. It still might be too slower than my first suggestion, but it&#39;s more flexible and the next programmer that comes across your code won&#39;t hate you for following my advice lol. See this <a href=\"https://stackoverflow.com/questions/31794355/stream-large-json\">question</a>."}, {"owner": {"reputation": 73, "user_id": 6004683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b889f8adbb1169a263d40632ac908b8e?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Patel", "link": "https://stackoverflow.com/users/6004683/himanshu-patel"}, "reply_to_user": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 0, "creation_date": 1538550461, "post_id": 52620711, "comment_id": 92176684, "body": "I have edited the question to emphasise the complexity and largeness of the json file. That&#39;s exactly why I can&#39;t afford to use unmarshaling."}, {"owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 0, "creation_date": 1538552289, "post_id": 52620711, "comment_id": 92177650, "body": "Hence the use of a streaming decoder. The key point here is that it does not unmarshall the entire JSON, it only reads a field at a time and you can stop right after you read the key (i.e. before you read the large array value). See @zerkms answer, he reads the first <code>{</code> (manually) then he reads the next item in the JSON which is what you want, the key <code>ids</code>. If you follow my link, there is a nicer way of consuming the first bracket with the <code>Token()</code> method."}, {"owner": {"reputation": 73, "user_id": 6004683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b889f8adbb1169a263d40632ac908b8e?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Patel", "link": "https://stackoverflow.com/users/6004683/himanshu-patel"}, "reply_to_user": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 0, "creation_date": 1538557708, "post_id": 52620711, "comment_id": 92180413, "body": "Thanks Matt, that was really helpful :)"}, {"owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "reply_to_user": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "edited": false, "score": 0, "creation_date": 1538600779, "post_id": 52620711, "comment_id": 92204596, "body": "@Matt how would you decode only the key after <code>dec.Token()</code>? <a href=\"https://play.golang.org/p/r4PF9FLi8Aq\" rel=\"nofollow noreferrer\">play.golang.org/p/r4PF9FLi8Aq</a>"}, {"owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "reply_to_user": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "edited": false, "score": 1, "creation_date": 1538720824, "post_id": 52620711, "comment_id": 92249247, "body": "@zerkms I had a play around with it in my editor and included a new answer to demonstrate. This streaming parser is new to me too. :)"}], "answers": [{"comments": [{"owner": {"reputation": 73, "user_id": 6004683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b889f8adbb1169a263d40632ac908b8e?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Patel", "link": "https://stackoverflow.com/users/6004683/himanshu-patel"}, "edited": false, "score": 0, "creation_date": 1538556602, "post_id": 52621241, "comment_id": 92179819, "body": "<code>strings.NewReader()</code> takes a string argument. However JSON data is read as a <code>[]byte</code>. Is there a workaround to directly use <code>[]byte</code>? Because converting it into string is a linear operation."}, {"owner": {"reputation": 73, "user_id": 6004683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b889f8adbb1169a263d40632ac908b8e?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Patel", "link": "https://stackoverflow.com/users/6004683/himanshu-patel"}, "edited": false, "score": 0, "creation_date": 1538557305, "post_id": 52621241, "comment_id": 92180189, "body": "Never mind, found it! Do a <code>os.Open()</code> and pass the file pointer in <code>bufio.NewReader()</code> instead of <code>strings.NewReader()</code>. Thanks anyway :)"}], "tags": [], "owner": {"reputation": 229185, "user_id": 251311, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/b6b0ca5d4ef200ec8e3cd1fa2aefd836?s=128&d=identicon&r=PG", "display_name": "zerkms", "link": "https://stackoverflow.com/users/251311/zerkms"}, "is_accepted": true, "score": 1, "last_activity_date": 1538549742, "last_edit_date": 1538549742, "creation_date": 1538549435, "answer_id": 52621241, "question_id": 52620711, "link": "https://stackoverflow.com/questions/52620711/determine-a-json-tag-efficiently/52621241#52621241", "title": "Determine a JSON tag efficiently", "body": "<p>You can offset the reader right after the opening curly brace then use <a href=\"https://golang.org/pkg/encoding/json/#Decoder\" rel=\"nofollow noreferrer\"><code>json.Decoder</code></a> to decode only the first token from the reader</p>\n\n<p>Something along these lines</p>\n\n<pre><code>sr := strings.NewReader(`{\n    \"ids\": [1,2,3]\n}`)\n\nfor {\n    b, err := sr.ReadByte()\n    if err != nil {\n        fmt.Println(err)\n        return\n    }\n    if b == '{' {\n        break\n    }\n}\n\nd := json.NewDecoder(sr)\n\nvar key string\nerr := d.Decode(&amp;key)\nif err != nil {\n    fmt.Println(err)\n    return\n}\n\nfmt.Println(key)\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/xJJEqj0tFk9\" rel=\"nofollow noreferrer\">https://play.golang.org/p/xJJEqj0tFk9</a></p>\n\n<p>Additionally you may wrap your <code>io.Reader</code> you obtained from <code>open</code> with <a href=\"https://golang.org/pkg/bufio/#NewReader\" rel=\"nofollow noreferrer\"><code>bufio.Reader</code></a> to avoid multiple single-byte writes</p>\n\n<p>This solution assumes contents is a valid JSON object. Not that you could avoid that anyway.</p>\n"}, {"tags": [], "owner": {"reputation": 3322, "user_id": 966798, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9b52a10544df0260f8eab84b3bbea4bb?s=128&d=identicon&r=PG", "display_name": "Matt", "link": "https://stackoverflow.com/users/966798/matt"}, "is_accepted": false, "score": 1, "last_activity_date": 1538721706, "last_edit_date": 1538721706, "creation_date": 1538720765, "answer_id": 52659498, "question_id": 52620711, "link": "https://stackoverflow.com/questions/52620711/determine-a-json-tag-efficiently/52659498#52659498", "title": "Determine a JSON tag efficiently", "body": "<p>I had a play around with <code>Decoder.Token()</code> reading one token at a time (see this <a href=\"https://golang.org/src/encoding/json/example_test.go\" rel=\"nofollow noreferrer\">example</a>, line 87), and this works to extract your array label:</p>\n\n<pre><code>const jsonStream = `{\n    \"ids\": [1,2,3]\n}`\n\ndec := json.NewDecoder(strings.NewReader(jsonStream))\n\nt, err := dec.Token()\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"First token: %v\\n\", t)\n\nt, err = dec.Token()\nif err != nil {\n    log.Fatal(err)\n}\n\nfmt.Printf(\"Second token (array label): %v\\n\", t)\n</code></pre>\n"}], "owner": {"reputation": 73, "user_id": 6004683, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b889f8adbb1169a263d40632ac908b8e?s=128&d=identicon&r=PG&f=1", "display_name": "Himanshu Patel", "link": "https://stackoverflow.com/users/6004683/himanshu-patel"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 268, "favorite_count": 0, "accepted_answer_id": 52621241, "answer_count": 2, "score": 1, "last_activity_date": 1538721706, "creation_date": 1538547056, "last_edit_date": 1538552347, "question_id": 52620711, "link": "https://stackoverflow.com/questions/52620711/determine-a-json-tag-efficiently", "title": "Determine a JSON tag efficiently", "body": "<p>I have a bunch of JSON files, each containing a very large array of complex data. The JSON files look something like:</p>\n\n<p>ids.json</p>\n\n<pre><code>{\n    \"ids\": [1,2,3]\n}\n</code></pre>\n\n<p>names.json:</p>\n\n<pre><code>{\n    \"names\": [\"Tyrion\",\"Jaime\",\"Cersei\"]\n}\n</code></pre>\n\n<p>and so on. (In reality, the array elements are complex struct objects with 10s of fields)</p>\n\n<p>I want to extract <strong>just</strong> the tag that specifies what kind of array it contains. Currently I'm using <code>encoding/json</code> to unmarshal the whole file into a <code>map[string]interface{}</code> and iterate through the map but that is too costly an operation.</p>\n\n<p>Is there a faster way of doing this, preferably without the involvement of unmarshaling entire data?</p>\n"}, {"tags": ["amazon-web-services", "go", "server-side", "amazon-cognito"], "answers": [{"comments": [{"owner": {"reputation": 665, "user_id": 4411182, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6ywJeM9H7I/AAAAAAAAAAI/AAAAAAAAAHY/NY5Ggehfnxc/photo.jpg?sz=128", "display_name": "George Edward Shaw IV", "link": "https://stackoverflow.com/users/4411182/george-edward-shaw-iv"}, "edited": false, "score": 0, "creation_date": 1539872297, "post_id": 52755580, "comment_id": 92665680, "body": "Great answer, however right now passing an access token to the Go SDK isn&#39;t supported. Spent at least 2 hours digging through the source code, found promising things, but never found exactly what is outlined in the access token tradeoff that the JS SDK gives. I talked to a maintainer of the go sdk on aws on the Gophers slack and he confirmed this, so I submitted a comment on an already-opened issue regarding cognito features. I appreciate your time on this comment. I think the only answer right now is to use the JS client-side sdk :/"}, {"owner": {"reputation": 10025, "user_id": 4985580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea90ed1e325d0956cbcba499c43a0fd?s=128&d=identicon&r=PG&f=1", "display_name": "F_SO_K", "link": "https://stackoverflow.com/users/4985580/f-so-k"}, "reply_to_user": {"reputation": 665, "user_id": 4411182, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6ywJeM9H7I/AAAAAAAAAAI/AAAAAAAAAHY/NY5Ggehfnxc/photo.jpg?sz=128", "display_name": "George Edward Shaw IV", "link": "https://stackoverflow.com/users/4411182/george-edward-shaw-iv"}, "edited": false, "score": 1, "creation_date": 1539873178, "post_id": 52755580, "comment_id": 92666274, "body": "Ah, thats a shame. Thanks for coming back with those details - and good work on getting in touch with the SDK developer!"}], "tags": [], "owner": {"reputation": 10025, "user_id": 4985580, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/dea90ed1e325d0956cbcba499c43a0fd?s=128&d=identicon&r=PG&f=1", "display_name": "F_SO_K", "link": "https://stackoverflow.com/users/4985580/f-so-k"}, "is_accepted": false, "score": 4, "last_activity_date": 1539677498, "last_edit_date": 1539677498, "creation_date": 1539246543, "answer_id": 52755580, "question_id": 52618376, "link": "https://stackoverflow.com/questions/52618376/using-external-identity-providers-with-server-side-authentication/52755580#52755580", "title": "Using External Identity Providers with Server Side Authentication", "body": "<p>Lets take the Facebook example. When you use the Cognito UI, Facebook hands an OAuth token directly to Cognito for your user. Cognito does some stuff, like checking whether the user already exists, and creating a new one if required, then sends your application an AWS OAuth token.</p>\n\n<p>Now if you want the Facebook button on your own website the authentication happens in a different way. You have to negotiate with Facebook yourself, get an OAuth token back for the user, then hand the access token to Cognito. Cognito will do its stuff and give you back an AWS OAuth token.</p>\n\n<p>So, in short, you need to follow the Facebook SDK setup instructions:\n<a href=\"https://developers.facebook.com/docs/facebook-login/web\" rel=\"nofollow noreferrer\">https://developers.facebook.com/docs/facebook-login/web</a></p>\n\n<p>The Facebook SDK puts an access token in your session, which you send to Cognito.</p>\n\n<p>Full details are here:\n<a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/facebook.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/cognito/latest/developerguide/facebook.html</a>\n(See the javascript section)</p>\n\n<p>EDIT: I've just come across AWS Amplify. It has a client side JS library that includes an authentication component. If you are using React, it looks like there is a really simple way to connect Federated Identities (social media logins) with Cognito <a href=\"https://aws-amplify.github.io/amplify-js/media/authentication_guide.html\" rel=\"nofollow noreferrer\">https://aws-amplify.github.io/amplify-js/media/authentication_guide.html</a>. I've not used the service so can't say too much more about it at the moment.</p>\n"}, {"comments": [{"owner": {"reputation": 665, "user_id": 4411182, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6ywJeM9H7I/AAAAAAAAAAI/AAAAAAAAAHY/NY5Ggehfnxc/photo.jpg?sz=128", "display_name": "George Edward Shaw IV", "link": "https://stackoverflow.com/users/4411182/george-edward-shaw-iv"}, "edited": false, "score": 1, "creation_date": 1539872402, "post_id": 52808188, "comment_id": 92665760, "body": "I appreciate the answer, this is correct right now. I was going to add this answer if it wasn&#39;t commented. Go SDK for AWS simply doesn&#39;t have these features yet. See my comment on @Stu&#39;s post for more detail as to why this is the correct answer."}, {"owner": {"reputation": 1273, "user_id": 6434796, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ue95H.jpg?s=128&g=1", "display_name": "Ryan Breece", "link": "https://stackoverflow.com/users/6434796/ryan-breece"}, "reply_to_user": {"reputation": 665, "user_id": 4411182, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6ywJeM9H7I/AAAAAAAAAAI/AAAAAAAAAHY/NY5Ggehfnxc/photo.jpg?sz=128", "display_name": "George Edward Shaw IV", "link": "https://stackoverflow.com/users/4411182/george-edward-shaw-iv"}, "edited": false, "score": 0, "creation_date": 1539882514, "post_id": 52808188, "comment_id": 92671752, "body": "Your welcome. I added a link at the bottom of my answer on custom messages if you need it."}, {"owner": {"reputation": 1273, "user_id": 6434796, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ue95H.jpg?s=128&g=1", "display_name": "Ryan Breece", "link": "https://stackoverflow.com/users/6434796/ryan-breece"}, "reply_to_user": {"reputation": 665, "user_id": 4411182, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6ywJeM9H7I/AAAAAAAAAAI/AAAAAAAAAHY/NY5Ggehfnxc/photo.jpg?sz=128", "display_name": "George Edward Shaw IV", "link": "https://stackoverflow.com/users/4411182/george-edward-shaw-iv"}, "edited": false, "score": 0, "creation_date": 1539965222, "post_id": 52808188, "comment_id": 92704797, "body": "Coming back to this one more time.  <a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/cognitoidentityprovider/#CognitoIdentityProvider.AdminInitiateAuth\" rel=\"nofollow noreferrer\">docs.aws.amazon.com/sdk-for-go/api/service/&hellip;</a>       Here you can see a function called AdminInitiateAuth. There are also Functions for attaching users to identity providers. So while Using the JS SDK is probably the easiest, and in my opinion the solution for integrating a web app with cognito. You could clearly handle all your authentication flow, token management, create api&#39;s to signin, signout, etc.. server side with the GO SDK."}, {"owner": {"reputation": 665, "user_id": 4411182, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6ywJeM9H7I/AAAAAAAAAAI/AAAAAAAAAHY/NY5Ggehfnxc/photo.jpg?sz=128", "display_name": "George Edward Shaw IV", "link": "https://stackoverflow.com/users/4411182/george-edward-shaw-iv"}, "edited": false, "score": 0, "creation_date": 1540350842, "post_id": 52808188, "comment_id": 92828013, "body": "I use that right now for the username and password authentication. I look at every possible way I could possibly pass it an access token generated by an oauth provider and there is none that I can find. There is only a way to pass it a Cognito generated refresh token."}], "tags": [], "owner": {"reputation": 1273, "user_id": 6434796, "user_type": "registered", "accept_rate": 80, "profile_image": "https://i.stack.imgur.com/Ue95H.jpg?s=128&g=1", "display_name": "Ryan Breece", "link": "https://stackoverflow.com/users/6434796/ryan-breece"}, "is_accepted": true, "score": 4, "last_activity_date": 1539965586, "last_edit_date": 1539965586, "creation_date": 1539562163, "answer_id": 52808188, "question_id": 52618376, "link": "https://stackoverflow.com/questions/52618376/using-external-identity-providers-with-server-side-authentication/52808188#52808188", "title": "Using External Identity Providers with Server Side Authentication", "body": "<p>Your app requirements have grown passed a point of using the cookie cutter Cognito login flow.</p>\n\n<p>I suggest you just handle all your authentication to cognito yourself as seen here:\n<a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/using-amazon-cognito-user-identity-pools-javascript-examples.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/cognito/latest/developerguide/using-amazon-cognito-user-identity-pools-javascript-examples.html</a></p>\n\n<p>This way, you can throw a facebook login button on your site like this:\n<a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/facebook.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/cognito/latest/developerguide/facebook.html</a></p>\n\n<pre><code>FB.login(function (response) {\n\n  // Check if the user logged in successfully.\n  if (response.authResponse) {\n\n    console.log('You are now logged in.');\n\n    // Add the Facebook access token to the Cognito credentials login map.\n    AWS.config.credentials = new AWS.CognitoIdentityCredentials({\n      IdentityPoolId: 'IDENTITY_POOL_ID',\n      Logins: {\n        'graph.facebook.com': response.authResponse.accessToken\n      }\n    });\n\n    // Obtain AWS credentials\n    AWS.config.credentials.get(function(){\n        // Access AWS resources here.\n    });\n\n  } else {\n    console.log('There was a problem logging you in.');\n  }\n\n});\n</code></pre>\n\n<p>Then get the user like this:</p>\n\n<pre><code>    var data = { UserPoolId : 'us-east-1_Iqc12345',\n        ClientId : '12345du353sm7khjj1q'\n    };\n    var userPool = new AmazonCognitoIdentity.CognitoUserPool(data);\n    var cognitoUser = userPool.getCurrentUser();\n\n    if (cognitoUser != null) {\n        cognitoUser.getSession(function(err, session) {\n            if (err) {\n                alert(err);\n                return;\n            }\n            console.log('session validity: ' + session.isValid());\n        });\n    }\n</code></pre>\n\n<p>Additional Facebook SDK Info:\n<a href=\"https://developers.facebook.com/docs/facebook-login/web\" rel=\"nofollow noreferrer\">https://developers.facebook.com/docs/facebook-login/web</a></p>\n\n<p>Since your going to be going through the motions of setting up the Cognito flow in your application. An additional nugget, I highly recommend you go ahead and set up custom messages with a lambda trigger.\n<a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-custom-message.html\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/cognito/latest/developerguide/user-pool-lambda-custom-message.html</a></p>\n\n<p>Update:\nComing back to this one more time.</p>\n\n<p><a href=\"https://docs.aws.amazon.com/sdk-for-go/api/service/cognitoidentityprovider/#CognitoIdentityProvider.AdminInitiateAuth\" rel=\"nofollow noreferrer\">https://docs.aws.amazon.com/sdk-for-go/api/service/cognitoidentityprovider/#CognitoIdentityProvider.AdminInitiateAuth</a></p>\n\n<p>Here you can see a function called AdminInitiateAuth. There are also Functions for attaching users to identity providers. So while Using the JS SDK is probably the easiest, and in my opinion the solution for integrating a web app with cognito. You could clearly handle all your authentication flow, token management, create api's to signin, signout, etc.. server side with the GO SDK</p>\n"}, {"tags": [], "owner": {"reputation": 218, "user_id": 10941481, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/39aa51372eb8d11ca0fb05696a226357?s=128&d=identicon&r=PG&f=1", "display_name": "Piekarski D", "link": "https://stackoverflow.com/users/10941481/piekarski-d"}, "is_accepted": false, "score": 1, "last_activity_date": 1588883537, "creation_date": 1588883537, "answer_id": 61667216, "question_id": 52618376, "link": "https://stackoverflow.com/questions/52618376/using-external-identity-providers-with-server-side-authentication/61667216#61667216", "title": "Using External Identity Providers with Server Side Authentication", "body": "<p>It's now possible with <code>identity_provider</code> prop in <code>oauth2/authorize</code> request</p>\n\n<p>looks like that in my code</p>\n\n<pre><code>const query = stringify({\n    response_type: 'code',\n    redirect_uri: tokenRedirectUri,\n    state: stateEncoded,\n    client_id: clientId,\n    identity_provider: platform,\n})\n\n\nreturn `https://auth.${domainName}/oauth2/authorize?${query}`\n</code></pre>\n\n<p>where <code>platform</code> is <code>Google</code>/<code>Facebook</code>/other OIDC provider etc.</p>\n\n<p>That's only url, you'd need to make button by yourself, but it redirects directly to provider consent</p>\n"}], "owner": {"reputation": 665, "user_id": 4411182, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-y6ywJeM9H7I/AAAAAAAAAAI/AAAAAAAAAHY/NY5Ggehfnxc/photo.jpg?sz=128", "display_name": "George Edward Shaw IV", "link": "https://stackoverflow.com/users/4411182/george-edward-shaw-iv"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 874, "favorite_count": 1, "accepted_answer_id": 52808188, "answer_count": 3, "score": 8, "last_activity_date": 1588883537, "creation_date": 1538529158, "last_edit_date": 1539873557, "question_id": 52618376, "link": "https://stackoverflow.com/questions/52618376/using-external-identity-providers-with-server-side-authentication", "title": "Using External Identity Providers with Server Side Authentication", "body": "<p>I'm using the AWS SDK for Go to use Cognito to do server-side authentication. I have sign-up and sign-in done and working using a username and password. I have all three external identity providers configured based off of the <a href=\"https://docs.aws.amazon.com/cognito/latest/developerguide/cognito-user-pools-social-idp.html\" rel=\"nofollow noreferrer\">documentation</a> as well as redirect URLs and everything else the documentation calls for.</p>\n\n<p>I know how to get the URL for the built Sign Up/Sign In page that Cognito will build for you, and those have the Google/Facebook/Amazon login buttons, but I need to be able to put those buttons on the front end of my site. I don't know how to go about doing that.</p>\n\n<p><strong>Edit:</strong> See comment on @Stu's post for detailed reasoning on why the JS SDK answer is marked as the correct answer. This is subject to change, but not for awhile. (tldr; aws go sdk and cognito simply do not support this yet)</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 1, "last_activity_date": 1538521625, "last_edit_date": 1538521625, "creation_date": 1538518060, "answer_id": 52617110, "question_id": 52616855, "link": "https://stackoverflow.com/questions/52616855/why-can-this-data-not-be-properly-unmarshalled-into-my-object-model/52617110#52617110", "title": "Why can this data not be properly unmarshalled into my object model?", "body": "<p>It looks like you are trying to access the \"conditions\" property nested under the root \"Settings\" property. As such, you need to define that root-level type and enough fields to tell the unmarshaler how to find your target property. As such, you would just need to create a new \"AlertData\" type with the necessary \"Settings/conditions\" fields.</p>\n\n<p>For example (<a href=\"https://play.golang.org/p/-BYisI09TiE\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>type AlertData struct {\n  Settings struct {\n    Conditions []Condition `json:\"conditions\"`\n  }\n}\n\nfunc main() {\n  alert := AlertData{}\n  err := json.Unmarshal([]byte(alertData), &amp;alert)\n\n  if err != nil {\n    panic(err)\n  }\n\n  fmt.Printf(\"OK: conditions=%#v\\n\", alert.Settings.Conditions)\n  // OK: conditions=[]main.Condition{main.Condition{Evaluator:struct { Params []int \"json:\\\"params\\\"\"; Type string \"json:\\\"type\\\"\" }{Params:[]int{10000}, Type:\"gt\"}, Operator:struct { Type string \"json:\\\"type\\\"\" }{Type:\"and\"}, Query:struct { Params []string \"json:\\\"params\\\"\" }{Params:[]string{\"C\", \"5m\", \"now\"}}, Reducer:struct { Params []interface {} \"json:\\\"params\\\"\"; Type string \"json:\\\"type\\\"\" }{Params:[]interface {}{}, Type:\"avg\"}, Type:\"query\"}}\n}\n</code></pre>\n\n<p>Note that the printed listing includes so much type information because the \"Condition\" type uses anonymous structs as field types. If you were to extract them into named structs it will be easier to work with the data, e.g.:</p>\n\n<pre><code>type Condition struct {\n  Evaluator Evaluator `json:\"evaluator\"`\n  Operator  Operator  `json:\"operator\"`\n  // ...\n}\n\ntype Evaluator struct {\n  Params []int  `json:\"params\"`\n  Type   string `json:\"type\"`\n}\n\ntype Operator struct {\n  Type string `json:\"type\"`\n}\n\n//...\n// OK: conditions=[]main.Condition{\n//   main.Condition{\n//     Evaluator:main.Evaluator{Params:[]int{10000}, Type:\"gt\"},\n//     Operator:main.Operator{Type:\"and\"},\n//     Query:main.Query{Params:[]string{\"C\", \"5m\", \"now\"}},\n//     Reducer:main.Reducer{Params:[]interface {}{}, Type:\"avg\"},\n//     Type:\"query\",\n//   },\n// }\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/Co2sKqIEWn-\" rel=\"nofollow noreferrer\">Go Playground example here...</a></p>\n"}, {"tags": [], "owner": {"reputation": 3174, "user_id": 4639336, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/GvbJg.png?s=128&g=1", "display_name": "reticentroot", "link": "https://stackoverflow.com/users/4639336/reticentroot"}, "is_accepted": false, "score": 0, "last_activity_date": 1538537211, "creation_date": 1538537211, "answer_id": 52619285, "question_id": 52616855, "link": "https://stackoverflow.com/questions/52616855/why-can-this-data-not-be-properly-unmarshalled-into-my-object-model/52619285#52619285", "title": "Why can this data not be properly unmarshalled into my object model?", "body": "<p>Maerics explanation is correct, here is an alternative approach which wraps access around struct methods, the data structure is also fully defined. If you're new to Go it's good to get handle on creating the data structures yourself, but here is a handy utility for helping create structs from valid JSON\n<a href=\"https://mholt.github.io/json-to-go/\" rel=\"nofollow noreferrer\">https://mholt.github.io/json-to-go/</a> </p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"log\"\n    \"time\"\n)\n\ntype Data struct {\n    ID             int         `json:\"Id\"`\n    Version        int         `json:\"Version\"`\n    OrgID          int         `json:\"OrgId\"`\n    DashboardID    int         `json:\"DashboardId\"`\n    PanelID        int         `json:\"PanelId\"`\n    Name           string      `json:\"Name\"`\n    Message        string      `json:\"Message\"`\n    Severity       string      `json:\"Severity\"`\n    State          string      `json:\"State\"`\n    Handler        int         `json:\"Handler\"`\n    Silenced       bool        `json:\"Silenced\"`\n    ExecutionError string      `json:\"ExecutionError\"`\n    Frequency      int         `json:\"Frequency\"`\n    EvalData       interface{} `json:\"EvalData\"`\n    NewStateDate   time.Time   `json:\"NewStateDate\"`\n    PrevStateDate  time.Time   `json:\"PrevStateDate\"`\n    StateChanges   int         `json:\"StateChanges\"`\n    Created        time.Time   `json:\"Created\"`\n    Updated        time.Time   `json:\"Updated\"`\n    Settings       struct {\n        Conditions          []Condition   `json:\"conditions\"`\n        ExecutionErrorState string        `json:\"executionErrorState\"`\n        Frequency           string        `json:\"frequency\"`\n        Handler             int           `json:\"handler\"`\n        Name                string        `json:\"name\"`\n        NoDataState         string        `json:\"noDataState\"`\n        Notifications       []interface{} `json:\"notifications\"`\n    } `json:\"Settings\"`\n}\n\ntype Condition struct {\n    Evaluator struct {\n        Params []int  `json:\"params\"`\n        Type   string `json:\"type\"`\n    } `json:\"evaluator\"`\n    Operator struct {\n        Type string `json:\"type\"`\n    } `json:\"operator\"`\n    Query struct {\n        DatasourceID int `json:\"datasourceId\"`\n        Model        struct {\n            Hide       bool   `json:\"hide\"`\n            RefCount   int    `json:\"refCount\"`\n            RefID      string `json:\"refId\"`\n            TextEditor bool   `json:\"textEditor\"`\n        } `json:\"model\"`\n        Params []string `json:\"params\"`\n    } `json:\"query\"`\n    Reducer struct {\n        Params []interface{} `json:\"params\"`\n        Type   string        `json:\"type\"`\n    } `json:\"reducer\"`\n    Type string `json:\"type\"`\n}\n\nfunc (d Data) GetFirstCondition() (Condition, error) {\n    if len(d.Settings.Conditions) &gt; 0 {\n        return d.Settings.Conditions[0], nil\n    }\n    return Condition{}, fmt.Errorf(\"no conditions found\")\n}\n\nfunc (d Data) GetConditionByIndex(index uint) (Condition, error) {\n    if len(d.Settings.Conditions) == 0 {\n        return Condition{}, fmt.Errorf(\"no conditions found\")\n    }\n\n    if int(index) &gt; len(d.Settings.Conditions)-1 {\n        return Condition{}, fmt.Errorf(\"index out of bounds\")\n    }\n\n    return d.Settings.Conditions[index], nil\n}\n\nvar alertData = `{\n    \"Id\": 0,\n    \"Version\": 0,\n    \"OrgId\": 1,\n    \"DashboardId\": 61,\n    \"PanelId\": 84,\n    \"Name\": \"{qa-dev}{stats-pipeline} Topology Message Age (aggregator) alert\",\n    \"Message\": \"\",\n    \"Severity\": \"\",\n    \"State\": \"\",\n    \"Handler\": 1,\n    \"Silenced\": false,\n    \"ExecutionError\": \"\",\n    \"Frequency\": 10,\n    \"EvalData\": null,\n    \"NewStateDate\": \"0001-01-01T00:00:00Z\",\n    \"PrevStateDate\": \"0001-01-01T00:00:00Z\",\n    \"StateChanges\": 0,\n    \"Created\": \"0001-01-01T00:00:00Z\",\n    \"Updated\": \"0001-01-01T00:00:00Z\",\n    \"Settings\": {\n        \"conditions\": [\n            {\n                \"evaluator\": {\n                    \"params\": [\n                        10000\n                    ],\n                    \"type\": \"gt\"\n                },\n                \"operator\": {\n                    \"type\": \"and\"\n                },\n                \"query\": {\n                    \"datasourceId\": 2,\n                    \"model\": {\n                        \"hide\": true,\n                        \"refCount\": 0,\n                        \"refId\": \"C\",\n                        \"textEditor\": false\n                    },\n                    \"params\": [\n                        \"C\",\n                        \"5m\",\n                        \"now\"\n                    ]\n                },\n                \"reducer\": {\n                    \"params\": [],\n                    \"type\": \"avg\"\n                },\n                \"type\": \"query\"\n            }\n        ],\n        \"executionErrorState\": \"keep_state\",\n        \"frequency\": \"10s\",\n        \"handler\": 1,\n        \"name\": \"{qa-dev}{stats-pipeline} Topology Message Age (aggregator) alert\",\n        \"noDataState\": \"keep_state\",\n        \"notifications\": []\n    }\n}`\n\nfunc main() {\n    var res Data\n    err := json.Unmarshal([]byte(alertData), &amp;res)\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(res.GetFirstCondition())\n    fmt.Println(res.GetConditionByIndex(0))\n    // should fail :-)\n    fmt.Println(res.GetConditionByIndex(1))\n\n}\n</code></pre>\n"}], "owner": {"reputation": 12150, "user_id": 1143724, "user_type": "registered", "accept_rate": 66, "profile_image": "https://www.gravatar.com/avatar/47fa5f1bc077c8158fe5ad1287105381?s=128&d=identicon&r=PG", "display_name": "MrDuk", "link": "https://stackoverflow.com/users/1143724/mrduk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "accepted_answer_id": 52617110, "answer_count": 2, "score": 0, "last_activity_date": 1538537211, "creation_date": 1538516654, "question_id": 52616855, "link": "https://stackoverflow.com/questions/52616855/why-can-this-data-not-be-properly-unmarshalled-into-my-object-model", "title": "Why can this data not be properly unmarshalled into my object model?", "body": "<p>I have a (non)working example here: <a href=\"https://play.golang.org/p/qaYhKvJ65J3\" rel=\"nofollow noreferrer\">https://play.golang.org/p/qaYhKvJ65J3</a></p>\n\n<p>I'm not sure why the following data:</p>\n\n<pre><code>alertData := `{\n    \"Id\": 0,\n    \"Version\": 0,\n    \"OrgId\": 1,\n    \"DashboardId\": 61,\n    \"PanelId\": 84,\n    \"Name\": \"{qa-dev}{stats-pipeline} Topology Message Age (aggregator) alert\",\n    \"Message\": \"\",\n    \"Severity\": \"\",\n    \"State\": \"\",\n    \"Handler\": 1,\n    \"Silenced\": false,\n    \"ExecutionError\": \"\",\n    \"Frequency\": 10,\n    \"EvalData\": null,\n    \"NewStateDate\": \"0001-01-01T00:00:00Z\",\n    \"PrevStateDate\": \"0001-01-01T00:00:00Z\",\n    \"StateChanges\": 0,\n    \"Created\": \"0001-01-01T00:00:00Z\",\n    \"Updated\": \"0001-01-01T00:00:00Z\",\n    \"Settings\": {\n        \"conditions\": [\n            {\n                \"evaluator\": {\n                    \"params\": [\n                        10000\n                    ],\n                    \"type\": \"gt\"\n                },\n                \"operator\": {\n                    \"type\": \"and\"\n                },\n                \"query\": {\n                    \"datasourceId\": 2,\n                    \"model\": {\n                        \"hide\": true,\n                        \"refCount\": 0,\n                        \"refId\": \"C\",\n                        \"textEditor\": false\n                    },\n                    \"params\": [\n                        \"C\",\n                        \"5m\",\n                        \"now\"\n                    ]\n                },\n                \"reducer\": {\n                    \"params\": [],\n                    \"type\": \"avg\"\n                },\n                \"type\": \"query\"\n            }\n        ],\n        \"executionErrorState\": \"keep_state\",\n        \"frequency\": \"10s\",\n        \"handler\": 1,\n        \"name\": \"{qa-dev}{stats-pipeline} Topology Message Age (aggregator) alert\",\n        \"noDataState\": \"keep_state\",\n        \"notifications\": []\n    }\n}`\n</code></pre>\n\n<p>Can't be unmarshalled into the following object model:</p>\n\n<pre><code>type Condition struct {\n    Evaluator struct {\n        Params []int  `json:\"params\"`\n        Type   string `json:\"type\"`\n    } `json:\"evaluator\"`\n    Operator struct {\n        Type string `json:\"type\"`\n    } `json:\"operator\"`\n    Query struct {\n        Params []string `json:\"params\"`\n    } `json:\"query\"`\n    Reducer struct {\n        Params []interface{} `json:\"params\"`\n        Type   string        `json:\"type\"`\n    } `json:\"reducer\"`\n    Type string `json:\"type\"`\n}\n</code></pre>\n\n<p>When I do the following:</p>\n\n<pre><code>condition := Condition{}\nerr := json.Unmarshal([]byte(alertData), &amp;condition)\n\nif err != nil {\n    panic(err)\n}\n\nfmt.Printf(\"\\n\\n json object:::: %+v\", condition)\n</code></pre>\n\n<p>I just get: <code>json object:::: {Evaluator:{Params:[] Type:} Operator:{Type:} Query:{Params:[]} Reducer:{Params:[] Type:} Type:}</code></p>\n\n<p>Ideally I'd be able to parse it into something like <code>type Conditions []struct{ }</code> but I'm not sure if you can define models as lists?</p>\n"}, {"tags": ["go", "gcc", "cross-compiling", "solaris"], "comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1538516911, "post_id": 52616433, "comment_id": 92167959, "body": "Given you&#39;re getting <code>gccgo: error: may not use both -m32 and -m64</code> for an error message, I suspect you&#39;re somehow still getting <code>-m64</code> as a command-line argument from somewhere."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 0, "creation_date": 1538517637, "post_id": 52616433, "comment_id": 92168168, "body": "It seems likely that the <code>go build</code> command is including the <code>-m64</code> flag since go only supports that architecture on Solaris."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "reply_to_user": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "edited": false, "score": 1, "creation_date": 1538518078, "post_id": 52616433, "comment_id": 92168291, "body": "@maerics Thinking about this, I&#39;m at the point where I&#39;m wondering at the <i>why</i> behind this customer request.  Given the posted target must be 64-bit - Solaris 10 SPARC - the reason for the request is probably, umm, <i>interesting</i>.  And if that <code>-m64</code> is coming from the <code>go build</code> command somewhere, trying to override it is really getting into unsupported hacks.  It should work if forced and the source is clean and portable - highly likely given the plethora of platforms supported - but there&#39;s still a chance for a significant bug. I wouldn&#39;t want to be on the hook for supporting that."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1538518253, "post_id": 52616433, "comment_id": 92168343, "body": "@AndrewHenle heh, <i>interesting</i> indeed =P"}], "answers": [{"comments": [{"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1538516850, "post_id": 52616869, "comment_id": 92167929, "body": "64-bit Solaris can still run 32-bit executables.  In fact, many if not most of the system utilities such as <code>mv</code> and <code>cp</code> are still 32-bit on a 64-bit installation."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 1, "creation_date": 1538516893, "post_id": 52616869, "comment_id": 92167953, "body": "My point is that the official go documentation explicitly includes solaris/64 but not solaris/32."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1538517231, "post_id": 52616869, "comment_id": 92168043, "body": "Given the error message the OP posted, that point hasn&#39;t been reached yet.  Although I will admit I&#39;m at a loss to come up with a reason a 32-bit Solaris build is even necessary given the platform is Solaris 10. Solaris 10 always supported 64-bit and by now still-alive 32-bit hardware is just about unheard of."}, {"owner": {"reputation": 27420, "user_id": 4756299, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e38adc5559df095cfe10c664916e8ffa?s=128&d=identicon&r=PG&f=1", "display_name": "Andrew Henle", "link": "https://stackoverflow.com/users/4756299/andrew-henle"}, "edited": false, "score": 0, "creation_date": 1538517575, "post_id": 52616869, "comment_id": 92168145, "body": "And I just noticed the target is SPARC.  I&#39;m all but certain that Solaris 10 can&#39;t even run on 32-bit SPARC CPUs."}, {"owner": {"reputation": 3921, "user_id": 46220, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fc77d5a13726cfd5528da0f809153956?s=128&d=identicon&r=PG", "display_name": "alanc", "link": "https://stackoverflow.com/users/46220/alanc"}, "edited": false, "score": 2, "creation_date": 1538523654, "post_id": 52616869, "comment_id": 92169764, "body": "Correct, Solaris 10 only includes a 64-bit kernel for SPARC, not 32-bit.  (Solaris 10 still included a 32-bit kernel for x86 alongside the then-new 64-bit x86 kernel,  Solaris 11 dropped the 32-bit x86 kernel to go 64-bit only as well.)"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": false, "score": 4, "last_activity_date": 1538522083, "last_edit_date": 1538522083, "creation_date": 1538516721, "answer_id": 52616869, "question_id": 52616433, "link": "https://stackoverflow.com/questions/52616433/how-to-cross-compile-solaris-32-bit/52616869#52616869", "title": "How to cross compile solaris 32-bit", "body": "<p>Solaris 32-bit does not appear to be supported, according to <a href=\"https://golang.org/doc/install/source#environment\" rel=\"nofollow noreferrer\">the list of supported OS/arch targets</a>:</p>\n\n<blockquote>\n  <p>The valid combinations of $GOOS and $GOARCH are:</p>\n\n<pre><code>$GOOS     $GOARCH\n...\nsolaris   amd64\n...\n</code></pre>\n</blockquote>\n\n<p>That is, Solaris 64-bit is explicitly listed as a supported platform but Solaris 32-bit is <em>not</em> listed.</p>\n\n<p>As such, there is good reason to believe that go programs will <em>not</em> run reliably on Solaris 32-bit systems and you probably should not agree to support that platform (if you do happen to get that cross compilation working) mainly because the go team itself does not support it!</p>\n"}], "owner": {"reputation": 1043, "user_id": 939464, "user_type": "registered", "accept_rate": 38, "profile_image": "https://www.gravatar.com/avatar/c6dd54acdcd91c0038c91a22047c41f3?s=128&d=identicon&r=PG", "display_name": "psparago", "link": "https://stackoverflow.com/users/939464/psparago"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 723, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1538552380, "creation_date": 1538514576, "last_edit_date": 1538552380, "question_id": 52616433, "link": "https://stackoverflow.com/questions/52616433/how-to-cross-compile-solaris-32-bit", "title": "How to cross compile solaris 32-bit", "body": "<p>We are currently building our Go executables for several platforms including Solaris 64-bit. We have requests for a 32-bit Solaris executable version as well and I am unable to get this to work (the person who setup the Solaris 64-bit cross compiler is gone and unreachable).</p>\n\n<p>I tried just setting -m32 flag on <em>go build</em> using our existing solaris cross compilation, but that didn't work, so I am attempting to build a Solaris 32-bit specific cross compiler. </p>\n\n<p>I googled and found some vague examples, so I am following this process:</p>\n\n<ol>\n<li>Copy headers and libraries from a 32-bit Solaris machine to my Linux build machine.</li>\n<li>D/L and build binutils and gcc pointing SYSROOT to the downloaded 32-bit Solaris headers and libraries where:</li>\n</ol>\n\n<p>$TARGET=sparc-sun-solaris2.10</p>\n\n<p>$SYSROOT=<em>/path/to/solaris32/includes</em> </p>\n\n<p>$PREFIX=<em>/path/to/gcc-output</em></p>\n\n<p><code>binutils-2.31/configure -target=$TARGET --prefix=$PREFIX -with-sysroot=$SYSROOT -v</code></p>\n\n<pre><code>gcc-8.2.0/configure --target=$TARGET --with-gnu-as --with-gnu-ld  --prefix=$PREFIX -with-sysroot=$SYSROOT --disable-libgcj --enable-languages=c,c++,go -v\n</code></pre>\n\n<ol start=\"3\">\n<li>Create a symlink to gogcc and put GCC on the path</li>\n<li><p>Compile a trivial test go program like this:</p>\n\n<p><code>go build --compiler gccgo --gccgoflags \"-m32 -O3 -static-libgo -Wl,-dy -lnsl -lsocket -lrt -lsendfile\" -o ${GOTOOLS}/${BINARIES}/${PROJECT_NAME}/test/solaris_sparc32 test/main.go</code></p></li>\n</ol>\n\n<p>This fails as follows:</p>\n\n<p>go build: when using gccgo toolchain, please pass compiler flags using -gccgoflags, not -gcflags</p>\n\n<p>command-line-arguments</p>\n\n<p><strong>gccgo: error: may not use both -m32 and -m64</strong></p>\n\n<p>Clearly I don't know what I'm doing. Can anyone point me in the right direction?</p>\n"}, {"tags": ["docker", "go", "docker-api", "moby"], "answers": [{"tags": [], "owner": {"reputation": 97, "user_id": 2556216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ff698005815ae6b27596c2ce915dff?s=128&d=identicon&r=PG", "display_name": "wannamit", "link": "https://stackoverflow.com/users/2556216/wannamit"}, "is_accepted": false, "score": 0, "last_activity_date": 1538539167, "creation_date": 1538539167, "answer_id": 52619508, "question_id": 52615135, "link": "https://stackoverflow.com/questions/52615135/how-to-use-tasklogs-endpoint-of-docker-go-lang-api/52619508#52619508", "title": "How to use TaskLogs endpoint of docker go-lang API?", "body": "<p><strong>SOLVED</strong></p>\n\n<p>It was really simple:</p>\n\n<p>In Gopkg.toml add:</p>\n\n<pre><code>[[constraint]]\n  name = \"github.com/docker/docker\"\n  branch = \"master\"\n\n[[override]]\n  name = \"github.com/docker/distribution\"\n  branch = \"master\"\n</code></pre>\n\n<p>To use any version create the client with the specific version:</p>\n\n<pre><code>import (\n    dockerClient \"github.com/docker/docker/client\"\n    dockerTypes \"github.com/docker/docker/api/types\"\n    )\nvar dockerClientInst *dockerClient.Client\ndockerClient.NewClientWithOpts(dockerClient.WithVersion(\"1.37\"))\nresponseBody, err := dockerClientInst.TaskLogs(ctx, taskID, dockerTypes.ContainerLogsOptions{})\n</code></pre>\n\n<p>That's it.</p>\n"}], "owner": {"reputation": 97, "user_id": 2556216, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/10ff698005815ae6b27596c2ce915dff?s=128&d=identicon&r=PG", "display_name": "wannamit", "link": "https://stackoverflow.com/users/2556216/wannamit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 71, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538539167, "creation_date": 1538508474, "question_id": 52615135, "link": "https://stackoverflow.com/questions/52615135/how-to-use-tasklogs-endpoint-of-docker-go-lang-api", "title": "How to use TaskLogs endpoint of docker go-lang API?", "body": "<p>My actual question is, how to get specific version of go-lang docker client? The latest version I can find is v17.03.2-ce which is a year or older. I want to use docker 1.37 which has TaskLogs. But could not find one with this specific version. If I choose the master branch, this will give me v1.39 but my installed docker client API is v1.38 which throws error \"Error response from daemon: client version 1.39 is too new. Maximum supported API version is 1.38\".</p>\n\n<p>Why I need v1.37?\nI was using v1.13.1, which was working fine. Now I need to implement TaskLogs grabber and this is not available in v1.13.1.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 3269, "user_id": 429555, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/3e970e0e5d130ae179f5cfa9b3079b76?s=128&d=identicon&r=PG", "display_name": "ferhat", "link": "https://stackoverflow.com/users/429555/ferhat"}, "edited": false, "score": 0, "creation_date": 1538507504, "post_id": 52614844, "comment_id": 92164136, "body": "As far as I am aware, compiler doesn&#39;t keep track of types in compiled code so no way for reflection. Struct should be registered at some well known point."}, {"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1538510499, "post_id": 52614844, "comment_id": 92165409, "body": "The DI system dargo (<a href=\"https://github.com/jwells131313/dargo\" rel=\"nofollow noreferrer\">github.com/jwells131313/dargo</a>) allows you to bind structures to names.  But you do have to give the binding the structure to create, so it can&#39;t work &quot;cold&quot; as you seem to be asking for  You can then have dargo create the service with a call to ioc.GetDService(&quot;ServiceName&quot;)"}], "owner": {"reputation": 106, "user_id": 1478835, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/1090a7b8bd9c0d2883635dd66e2a911a?s=128&d=identicon&r=PG", "display_name": "Curtis2", "link": "https://stackoverflow.com/users/1478835/curtis2"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 56, "favorite_count": 0, "closed_date": 1538507862, "answer_count": 0, "score": 0, "last_activity_date": 1538508057, "creation_date": 1538507116, "question_id": 52614844, "link": "https://stackoverflow.com/questions/52614844/can-i-construct-a-typed-object-from-the-name-of-a-type-in-go", "closed_reason": "Duplicate", "title": "Can I construct a typed object from the name of a type in Go", "body": "<p>For example, I have a type called <code>Foo</code>, and I'd like to know if I am able to do things like this in Golang:</p>\n\n<pre><code>type Foo struct { /* some fields */ }\n\nfunc GetObj(myType string) interface{} {\n    // code that will return an object with type myType\n}\n\nfooObj := GetObj(\"Foo\")\n</code></pre>\n"}, {"tags": ["go", "vgo"], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 2, "last_activity_date": 1538503845, "creation_date": 1538503845, "answer_id": 52614039, "question_id": 52612037, "link": "https://stackoverflow.com/questions/52612037/go-modules-are-not-found-using-vgo-and-go-mod/52614039#52614039", "title": "Go modules are not found using VGO and go.mod", "body": "<p>I assume your local packages imported are wrong, follow my example. </p>\n\n<p>There is my <code>go.mod</code> (outside of <code>GOPATH</code>, I've imported <code>mux</code> for example):</p>\n\n<pre><code>module example\n\nrequire github.com/gorilla/mux v1.6.2 // indirect\n</code></pre>\n\n<p><em>BTW you can create an empty <code>go.mod</code>, <code>go</code> will find and update your <code>go.mod</code> for you.</em></p>\n\n<p>The <code>main.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    _ \"example/src/foo\" // local package\n    \"fmt\"\n    _ \"github.com/gorilla/mux\" // example import\n)\n\nfunc main() {\n    fmt.Println(\"foo\")\n}\n</code></pre>\n\n<p>The <code>foo</code> local package:</p>\n\n<pre><code>package foo\n\nimport \"fmt\"\n\nfunc bar() {\n    fmt.Println(\"foo\")\n}\n</code></pre>\n\n<p>The module tree:</p>\n\n<pre><code>\u251c\u2500\u2500 go.mod\n\u251c\u2500\u2500 go.sum\n\u251c\u2500\u2500 main.go\n\u2514\u2500\u2500 src\n    \u2514\u2500\u2500 foo\n        \u2514\u2500\u2500 foo.go\n</code></pre>\n\n<p>You can find more explanation here <a href=\"https://github.com/golang/go/wiki/Modules#go-111-modules\" rel=\"nofollow noreferrer\"><code>Modules</code></a></p>\n"}], "owner": {"reputation": 1674, "user_id": 4487542, "user_type": "registered", "accept_rate": 68, "profile_image": "https://i.stack.imgur.com/f5Hr6.png?s=128&g=1", "display_name": "J&#233;r&#244;me", "link": "https://stackoverflow.com/users/4487542/j%c3%a9r%c3%b4me"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4707, "favorite_count": 1, "accepted_answer_id": 52614039, "answer_count": 1, "score": 1, "last_activity_date": 1538503845, "creation_date": 1538495596, "question_id": 52612037, "link": "https://stackoverflow.com/questions/52612037/go-modules-are-not-found-using-vgo-and-go-mod", "title": "Go modules are not found using VGO and go.mod", "body": "<p>I'm using versioned Go command to manage my vendors, everything is working but when I run <code>go build</code> it doesn't find my local packages</p>\n\n<p>I have set the module root inside my <code>go.mod</code> with I still get an error</p>\n\n<blockquote>\n  <p>build foo: cannot find module for path </p>\n</blockquote>\n\n<p>The project arch is like</p>\n\n<pre><code>foo/\n|__src/github.com/username/package1/package1.go\n|__src/github.com/username/package2/package2.go\n|__src/github.com/username/package3/package3.go\n|__main.go\n|__go.mod\n|__go.sum\n</code></pre>\n\n<p>So my <code>go.mod</code> look like</p>\n\n<pre><code>module foo\n\nrequire (\n    ...\n)\n</code></pre>\n\n<p>I followed <a href=\"https://research.swtch.com/vgo-tour\" rel=\"nofollow noreferrer\">https://research.swtch.com/vgo-tour</a> but I don't understand why this is not working.</p>\n\n<p>My Go version is <code>1.11</code> and the <code>foo</code> folder is inside my <code>GOPATH</code> when I try outside the <code>GOPATH</code> this is not even working.</p>\n\n<p>The only time I made it work is doing</p>\n\n<pre><code>module github.com/username/package1\n\nrequire (\n    ...\n)\n</code></pre>\n\n<p>but the 2 other packages are not found and I get the same error as above.</p>\n\n<p>Did I miss something or do the module path I provide must be changed ?</p>\n"}, {"tags": ["go", "optimization", "hashmap"], "comments": [{"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 1, "creation_date": 1538493490, "post_id": 52611168, "comment_id": 92157106, "body": "why dont you keep your sites ordered by population so you can randomly choose one in O(log n)?"}, {"owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "reply_to_user": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1538494568, "post_id": 52611168, "comment_id": 92157756, "body": "Can you elaborate on how you&#39;re imagining this?"}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1538494949, "post_id": 52611168, "comment_id": 92157991, "body": "Well its unclear what you do in UpdateFunction, but you need a structure that supports both update and query by ith item in O(log n). You can then search the index of the first site with population at least x and then randomly pick one between that and n. A structure that probably supports this is <a href=\"https://en.wikipedia.org/wiki/Order_statistic_tree\" rel=\"nofollow noreferrer\">order static tree</a>."}, {"owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "reply_to_user": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1538495606, "post_id": 52611168, "comment_id": 92158437, "body": "Oh yes, so I think I wanted to try something like this but I found the bottle neck here to be rearrangement of my sorted slice. When I update, the population at the chosen site and perhaps near-by sites changes. In order to update the sorted slice, I need to move an element to a new location. The solutions to this in go are copying parts of the slice onto itself (slow, will reproduce memmove bottleneck) or figuring out a nice swapping algorithm (I haven&#39;t given much thought to this, maybe I&#39;ll give it a shot, but my worry is that it will quickly accumulate processes/complexity)"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538496386, "post_id": 52611168, "comment_id": 92158934, "body": "Instead of posting a new question after being told that your original question was too vague, please <b>edit</b> the initial question here <a href=\"https://stackoverflow.com/q/52599876/1230836\">stackoverflow.com/q/52599876/1230836</a>"}, {"owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "edited": false, "score": 0, "creation_date": 1538496415, "post_id": 52611168, "comment_id": 92158949, "body": "This has nothing to do with my previous question. I changed my method and rewrote my code. Thanks"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538496508, "post_id": 52611168, "comment_id": 92159016, "body": "It does have something to do with this one, too: <a href=\"https://stackoverflow.com/q/52442838/1230836\">stackoverflow.com/q/52442838/1230836</a>  Also either answering your own question, or accepting an answer to mark it as &quot;done&quot; is recommended"}, {"owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "edited": false, "score": 0, "creation_date": 1538496630, "post_id": 52611168, "comment_id": 92159084, "body": "This is a specific question about accessing the elements of a map efficiently? I haven&#39;t found a great algorithm for my first post yet. I now have specific questions about utilizing built in hash tables, that if I can work out I&#39;ll push my project to git and answer my own question.."}, {"owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "edited": false, "score": 0, "creation_date": 1538497099, "post_id": 52611168, "comment_id": 92159315, "body": "Also, sorry didn&#39;t see your other response until just now."}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1538498052, "post_id": 52611168, "comment_id": 92159803, "body": "@kapaw I dont understand what are your slices, but updating population number on order statistic tree is O(log n)"}, {"owner": {"reputation": 15181, "user_id": 3308055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/mIjeo.png?s=128&g=1", "display_name": "juvian", "link": "https://stackoverflow.com/users/3308055/juvian"}, "edited": false, "score": 0, "creation_date": 1538576156, "post_id": 52611168, "comment_id": 92191587, "body": "Could you add UpdateFunction code ?"}], "answers": [{"comments": [{"owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "edited": false, "score": 0, "creation_date": 1538573396, "post_id": 52617146, "comment_id": 92189813, "body": "Some comments. Correct me if I&#39;m wrong, but I don&#39;t believe this properly assigns weights to the slices indicated by <code>myMap[i]</code>. After determining <code>randPopSize</code>, the chance of a slice with population i being chosen should be ~ len(myMap[i])/(sum j= randPopSize to range len(myMap[j])) = (# of sites in slice)/(# of sites with population &gt;= randPopSize). Here it seems like all slices are being weighted based solely on their population size? In an extreme case, say <code>myMap[1000]={site1}</code> and <code>myMap[999]</code>={sites 2 through 2002}, both would have a nearly identical chance of being chosen"}, {"owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "edited": false, "score": 0, "creation_date": 1538573575, "post_id": 52617146, "comment_id": 92189958, "body": "In the end, I think changing what you&#39;ve written to properly weight the slices becomes equivalent to rejection sampling, which due the nature of my data averages something slightly less than O(n) speed before accounting for random number generation time (which unfortunately matters as I&#39;d like this to run &gt;10^8 steps)"}, {"owner": {"reputation": 3294, "user_id": 4848859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Slzu.jpg?s=128&g=1", "display_name": "mayo", "link": "https://stackoverflow.com/users/4848859/mayo"}, "reply_to_user": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "edited": false, "score": 0, "creation_date": 1538586109, "post_id": 52617146, "comment_id": 92197626, "body": "oh, you are completely right. My bad. Yes, the right chance to select an element can be fixed, I missed the part that you have more than one site per population value.  And yes, this will be an O(n) algorithm :( but at least you can avoid the append operation :) which is making the previous code O(n^2). I will try to think about something else! If you find a solution pls post it, it would be interesting to see a good approach :)"}], "tags": [], "owner": {"reputation": 3294, "user_id": 4848859, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8Slzu.jpg?s=128&g=1", "display_name": "mayo", "link": "https://stackoverflow.com/users/4848859/mayo"}, "is_accepted": false, "score": 0, "last_activity_date": 1538522004, "last_edit_date": 1538522004, "creation_date": 1538518277, "answer_id": 52617146, "question_id": 52611168, "link": "https://stackoverflow.com/questions/52611168/randomly-selecting-elements-from-slices-produced-by-a-map-in-restricted-key-rang/52617146#52617146", "title": "Randomly selecting elements from slices produced by a map in restricted key range in golang. Is there an O(1) shortcut?", "body": "<p>I was looking at your code and I have a question.\nWhy do you have to copy values from the map to the slice? I mean, I think that I am following the logic behind... but I wonder if there is a way to skip that step.</p>\n\n<p>So we have:</p>\n\n<pre><code>func Evolve( ..., myMap map[int][]int ,...){\n\n    RandomPop = rand.Intn(rangeofpopulation)+1\n\n    for i:=RandPop,; i&lt;rangeofpopulation;i++{\n        // slice of preselected `sites`. one of this will be 'siteChosen'\n        // we expect to have `n sites` on `preAllocatedSlice`\n        // where `n` is the amount of iterations, \n        // ie; n = rangeofpopulation - RandPop\n        preallocatedslice=append(preallocatedslice,myMap[i]...) \n    }\n\n    // Once we have a list of sites, we select `one`\n    // under a normal distribution every site ha a chance of 1/n to be selected.\n    randomindex:= rand.Intn(len(preallocatedslice))\n    sitechosen= preallocatedslice[randomindex]\n\n    UpdateFunction(site)\n    ...\n\n}\n</code></pre>\n\n<p>But what if we change that to:</p>\n\n<pre><code>func Evolve( ..., myMap map[int][]int ,...){\n\n    if len(myMap) == 0 {\n        // Nothing to do, print a log! \n        return\n    }\n\n    // This variable will hold our site chosen!\n    var siteChosen []int\n\n    // Our random population size is a value from 1 to rangeOfPopulation \n    randPopSize := rand.Intn(rangeOfPopulation) + 1\n\n    for i := randPopSize; i &lt; rangeOfPopulation; i++ {\n        // We are going to pretend that the current candidate is the siteChosen \n        siteChosen = myMap[i]\n\n        // Now, instead of copying `myMap[i]` to preAllocatedSlice\n        // We will test if the current candidate is actually the 'siteChosen` here:\n\n        // We know that the chances for an specific site to be the chosen is 1/n,\n        // where n = rangeOfPopulation - randPopSize\n        n := float64(rangeOfPopulation - randPopSize)\n        // we roll the dice...\n        isTheChosenOne := rand.Float64() &gt; 1/n\n\n        if isTheChosenOne {\n            // If the candidate is the Chosen site, \n            // then we don't need to iterate over all the other elements.\n            break\n        }\n\n    }\n\n    // here we know that `siteChosen` is a.- a selected candidate, or \n    // b.- the last element assigned in the loop \n    // (in the case that `isTheChosenOne` was always false [which is a probable scenario])\n    UpdateFunction(siteChosen)\n    ...\n}\n</code></pre>\n\n<p>Also if you want to can calculate <code>n</code>, or <code>1/n</code> outside the loop. \nSo the idea is testing inside the loop if the candidate is the siteChosen, and avoid copying the candidates to this preselection pool.</p>\n"}], "owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 533, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538522004, "creation_date": 1538492753, "last_edit_date": 1538496388, "question_id": 52611168, "link": "https://stackoverflow.com/questions/52611168/randomly-selecting-elements-from-slices-produced-by-a-map-in-restricted-key-rang", "title": "Randomly selecting elements from slices produced by a map in restricted key range in golang. Is there an O(1) shortcut?", "body": "<p>In my program to simulate many-particle evolution, I have a map that takes a key value <code>pop</code> (the population size) and returns a slice containing the sites that have this population: <code>myMap[pop][]int</code>. These slices are generically quite large. </p>\n\n<p>At each evolution step I choose a random population size <code>RandomPop</code>. I would then like to randomly choose a site that has a population of at least <code>RandomPop</code>. The <code>sitechosen</code> is used to update my population structures and I utilize a second map to efficiently update myMap keys. My current (slow) implementation looks like </p>\n\n<pre><code>func Evolve( ..., myMap map[int][]int ,...){\n\n    RandomPop = rand.Intn(rangeofpopulation)+1\n\n    for i:=RandPop,; i&lt;rangeofpopulation;i++{\n        preallocatedslice=append(preallocatedslice,myMap[i]...)\n    }\n\n    randomindex:= rand.Intn(len(preallocatedslice))\n    sitechosen= preallocatedslice[randomindex]\n\n    UpdateFunction(site)\n\n    //reset preallocated slice \n    preallocatedslice=preallocatedslice[0:0]\n\n}\n</code></pre>\n\n<p>This code (obviously) hits a huge bottle-neck when copying values from the map to preallocatedslice, with runtime.memmove eating 87% of my CPU usage. I'm wondering if there is an O(1) way to randomly choose an entry contained in the union of slices indicated by myMap with key values between <code>0</code> and <code>RandomPop</code> ? I am open to packages that allow you to manipulate custom hashtables if anyone is aware of them. Suggestions don't need to be safe for concurrency  </p>\n\n<p>Other things tried: I previously had my maps record all sites with values of at least <code>pop</code> but that took up >10GB of memory and was stupid. I tried stashing pointers to the relevant slices to make a look-up slice, but go forbids this. I could sum up the lengths of each slice and generate a random number based on this and then iterate through the slices in myMap by length, but this is going to be much slower than just keeping an updated cdf of my population and doing a binary search on it. The binary search is fast, but updating the cdf, even if done manually, is O(n). I was really hoping to abuse hashtables to speed up random selection and update if possible</p>\n\n<p>A vague thought I have is concocting some sort of nested structure of maps pointing to their contents and also to the map with a key one less than theirs or something.  </p>\n"}, {"tags": ["go", "compilation", "garbage-collection"], "comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 2, "creation_date": 1538493432, "post_id": 52611145, "comment_id": 92157065, "body": "Go applications have a runtime that&#39;s compiled in. A &quot;Virtual Machine&quot; and &quot;Garbage Collection&quot; are not related."}], "answers": [{"tags": [], "owner": {"reputation": 428, "user_id": 8092543, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/BOOdr.png?s=128&g=1", "display_name": "sebito91", "link": "https://stackoverflow.com/users/8092543/sebito91"}, "is_accepted": false, "score": 0, "last_activity_date": 1538494362, "creation_date": 1538494362, "answer_id": 52611673, "question_id": 52611145, "link": "https://stackoverflow.com/questions/52611145/how-does-gc-work-without-a-separate-runtime-or-vm/52611673#52611673", "title": "How does GC work without a separate runtime or VM?", "body": "<p>Binaries in golang have no external dependencies as they are directly compiled in. Unlike a C/C++ binary which typically requires dynamic linking, golang binaries do not require this by default. </p>\n\n<p><a href=\"https://golang.org/doc/faq#runtime\" rel=\"nofollow noreferrer\">https://golang.org/doc/faq#runtime</a></p>\n\n<p>This allows you to copy, scp , rsync, etc your binary across to any machine of the <em>same</em> architecture type. For example, if you have a compiled binary on Ubuntu then you can copy that binary across to any other Ubuntu machine. You would have to cross-compile your binary for MacOS in order to do that, but again you can build on any operating system.</p>\n\n<p><a href=\"https://golang.org/doc/install/source#environment\" rel=\"nofollow noreferrer\">https://golang.org/doc/install/source#environment</a></p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 9, "last_activity_date": 1565705326, "last_edit_date": 1565705326, "creation_date": 1538509019, "answer_id": 52615237, "question_id": 52611145, "link": "https://stackoverflow.com/questions/52611145/how-does-gc-work-without-a-separate-runtime-or-vm/52615237#52615237", "title": "How does GC work without a separate runtime or VM?", "body": "<blockquote>\n  <p>my understanding is that the GC (Garbage Collection) is handled by a VM.</p>\n</blockquote>\n\n<p>In the case of a typical VM supporting programming language\nfeaturing GC, (the compiled form of) a program written in that\nlanguage is literally managed by the VM: the VM runs the code of the program and intervenes periodically to perform the GC tasks.</p>\n\n<p>The crucial point is that each program running in such a VM\nmay consider its VM as a part of its execution environment.</p>\n\n<p>Another crucial point is that such VM represents the so-called\n<a href=\"https://en.wikipedia.org/wiki/Runtime_system\" rel=\"noreferrer\">runtime system</a>\nfor the so-called <em>execution model</em> of that programming language.</p>\n\n<blockquote>\n  <p>In this case, if the application is running independently without such a runtime how is GC handled?</p>\n</blockquote>\n\n<p>Quite similar to the VM case.</p>\n\n<p>Each Go program compiled by the stock toolchain (which can be downloaded from <a href=\"https://golang.org\" rel=\"noreferrer\">the official site</a>\ncontains <em>the Go runtime <strong>linked with</strong> the program itself.</em>\nEach compiled Go program is created in a way that when the program runs, the program's entry point executes the runtime first\nwhich is responsible for initializing itself, then the program, and once this is finished, the execution is transferred to the program's <code>main()</code>.</p>\n\n<p>Among other things, the initialized Go runtime continuously\nruns one or more pieces of code of its own, which includes the\ngoroutine scheduler and the GC (they are tightly coupled FWIW).</p>\n\n<p>As you can see, the difference from the VM is that in that case\nthe runtime is \"external\" to the running program while in the\n(typical) case of Go programs it's \"along\" the running program.</p>\n\n<hr>\n\n<p>Nothing in the Go language specification mandates the\nprecise way the runtime must be made available to the\nrunning program.</p>\n\n<p>For instance, Go 1.11 can be compiled to\n<a href=\"https://webassembly.org/\" rel=\"noreferrer\">WASM</a>, and the runtime is partially\nprovided by the linked-in code of the Go runtime\nand partially\u2014by the WASM host (typically a browser).</p>\n\n<p>As another example, <a href=\"https://www.gnu.org/software/gcc/\" rel=\"noreferrer\">GCC</a>\nfeatures a Go frontend, and contrary to the \"stock\"\nGo toolchan, and on those platforms where it's possible,\nGCC supports building Go in a way where their compiled forms\n<em>dynamically</em> link against a shared library containing most\nof the Go runtime code (and the code of the standard library).\nIn this case, a compiled Go program does not contain the runtime\ncode but it gets linked in when the program is being loaded\nand then it also works in-process with the program itself.</p>\n\n<p>It's perfectly possible to implement an execution model for\nGo programs which would use a VM.</p>\n"}], "owner": {"reputation": 1999, "user_id": 4431422, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/c443c3ff19187910aca1a5b7e0511f84?s=128&d=identicon&r=PG&f=1", "display_name": "Vipin Menon", "link": "https://stackoverflow.com/users/4431422/vipin-menon"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1197, "favorite_count": 1, "answer_count": 2, "score": 6, "last_activity_date": 1565705326, "creation_date": 1538492666, "last_edit_date": 1538552411, "question_id": 52611145, "link": "https://stackoverflow.com/questions/52611145/how-does-gc-work-without-a-separate-runtime-or-vm", "title": "How does GC work without a separate runtime or VM?", "body": "<p>My understanding is that executables of applications written in Go can stand alone without the need of Go installed in the machine. </p>\n\n<p>Normally my understanding is that the GC (Garbage Collection) is handled by a VM. In this case, if the application is running independently without such a runtime how is GC handled?</p>\n\n<p>A help on this and the documentation on the same would be nice.</p>\n"}, {"tags": ["go", "couchbase"], "comments": [{"owner": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 2, "creation_date": 1538493930, "post_id": 52610544, "comment_id": 92157375, "body": "If you&#39;re doing exact matches, why not use a N1QL query instead?"}, {"owner": {"reputation": 185, "user_id": 4483618, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-KXEYm-nHT3E/AAAAAAAAAAI/AAAAAAAAASc/GPvuEsCyQ5E/photo.jpg?sz=128", "display_name": "Ben Rolfe", "link": "https://stackoverflow.com/users/4483618/ben-rolfe"}, "reply_to_user": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 1, "creation_date": 1538568953, "post_id": 52610544, "comment_id": 92186885, "body": "@MatthewGroves What&#39;s an example of that?"}, {"owner": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 0, "creation_date": 1538589108, "post_id": 52610544, "comment_id": 92199134, "body": "A simple example is: <code>SELECT d.* FROM myDocuments d WHERE status = &#39;Available&#39;</code>"}], "answers": [{"tags": [], "owner": {"reputation": 176, "user_id": 4539379, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/756939c85bb47de9fa5a8a3e7e801a4c?s=128&d=identicon&r=PG", "display_name": "1tylermitchell", "link": "https://stackoverflow.com/users/4539379/1tylermitchell"}, "is_accepted": false, "score": 2, "last_activity_date": 1538554119, "creation_date": 1538554119, "answer_id": 52622551, "question_id": 52610544, "link": "https://stackoverflow.com/questions/52610544/couchbase-exact-value-match/52622551#52622551", "title": "Couchbase exact value match", "body": "<p>It will depend on how you analyze the input field, it would help to know what analyzer you are using, but I'll assume the default, \"standard\", analyzer for now.</p>\n\n<p>Don't use the default analyzer for this case. As Matt asked in his comment, you are trying to do a direct match of exact text in a phrase, which is a little different than most text search users. So you don't really want the text to be tokenized into smaller pieces.</p>\n\n<p>Create a custom analyzer with the Couchbase search GUI that uses the \"single\" <a href=\"https://docs.couchbase.com/server/5.5/fts/fts-using-analyzers.html#tokenizers\" rel=\"nofollow noreferrer\">tokenizer</a> so that all the text in the field will be kept together. Or you could just <strong>use the \"keyword\" analyzer</strong> which is probably close enough for you.  Set that as your default analyzer and your query should work as expected.</p>\n\n<p>If you are looking for another approach, then a <a href=\"https://docs.couchbase.com/server/5.5/fts/fts-query-types.html#non-analytic-queries\" rel=\"nofollow noreferrer\">term or term phrase query</a> may be more what you are after, but you'll still have to be conscious of how analyzers are working.</p>\n\n<p><a href=\"https://i.stack.imgur.com/vU3FJ.gif\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/vU3FJ.gif\" alt=\"Set default analyzer for Couchbase full-text search analyzer to use &quot;keyword&quot;\"></a></p>\n"}], "owner": {"reputation": 185, "user_id": 4483618, "user_type": "registered", "accept_rate": 40, "profile_image": "https://lh5.googleusercontent.com/-KXEYm-nHT3E/AAAAAAAAAAI/AAAAAAAAASc/GPvuEsCyQ5E/photo.jpg?sz=128", "display_name": "Ben Rolfe", "link": "https://stackoverflow.com/users/4483618/ben-rolfe"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1538554119, "creation_date": 1538490661, "question_id": 52610544, "link": "https://stackoverflow.com/questions/52610544/couchbase-exact-value-match", "title": "Couchbase exact value match", "body": "<p>I am using <strong>Couchbase 5</strong> and <strong>Go Lang 1.11</strong>, trying to query results based on an exact value.</p>\n\n<p>The code below is finding rows with a status of \"Available\" and \"Not Available\". How can I make it only return \"Available\" rows?</p>\n\n<pre><code>qp.And(cbft.NewConjunctionQuery( cbft.NewMatchQuery(\"Available\").Field(\"status\") ))\n</code></pre>\n"}, {"tags": ["go", "couchbase", "go-gin"], "comments": [{"owner": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 0, "creation_date": 1538493881, "post_id": 52610318, "comment_id": 92157339, "body": "If you&#39;re doing exact matches, why not use a N1QL query instead?"}, {"owner": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "reply_to_user": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 0, "creation_date": 1538553926, "post_id": 52610318, "comment_id": 92178443, "body": "There are a number of GET string inputs all setup to filter this data. This option has to be added to these queries. Can I mix a N1QL and FTS search?"}, {"owner": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 0, "creation_date": 1538573501, "post_id": 52610318, "comment_id": 92189894, "body": "&quot;There are a number of GET string inputs all setup to filter this data&quot; - I don&#39;t know what that means, maybe it&#39;s a Go thing. &quot;Can I mix a N1QL and FTS search?&quot; Maybe with CURL inside of N1QL, or you can match results up in your code using document keys. But before going down that route, I guess I&#39;d need more detail as to why you must use FTS for an exact match."}, {"owner": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "reply_to_user": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 0, "creation_date": 1538573820, "post_id": 52610318, "comment_id": 92190119, "body": "The API is setup to take a users request via GET strings to filter the data, e.g. maxPrice or minPrice. There are a number of these options all added to query each from different users / clients which will all request different types of data. This is all setup to use a FTS. I just need the final output of these data to remove all data based on the status I want to set."}, {"owner": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "reply_to_user": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 0, "creation_date": 1538573993, "post_id": 52610318, "comment_id": 92190229, "body": "I have asked another question, which is like this but reserves the logic. I want to add all the data based on what I want to set, if it was not set then dont include it. I have asked at, <a href=\"https://stackoverflow.com/questions/52627237/how-to-exclude-data\">stackoverflow.com/questions/52627237/how-to-exclude-data</a> if I can do a sort of where not type query on an FTS index. So it would return all the data apart from the &#39;not available&#39;"}, {"owner": {"reputation": 22757, "user_id": 40015, "user_type": "registered", "accept_rate": 84, "profile_image": "https://www.gravatar.com/avatar/4b0eb78ea5852ee0f54bfd6a2252c99e?s=128&d=identicon&r=PG", "display_name": "Matthew Groves", "link": "https://stackoverflow.com/users/40015/matthew-groves"}, "edited": false, "score": 0, "creation_date": 1538589193, "post_id": 52610318, "comment_id": 92199183, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/52610544/couchbase-exact-value-match\">Couchbase exact value match</a>"}], "owner": {"reputation": 59, "user_id": 9395733, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78a369b7ebaf486b65d834821e0f11c8?s=128&d=identicon&r=PG&f=1", "display_name": "Coder99", "link": "https://stackoverflow.com/users/9395733/coder99"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 111, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538490500, "creation_date": 1538489897, "last_edit_date": 1538490500, "question_id": 52610318, "link": "https://stackoverflow.com/questions/52610318/building-an-exact-match-based-on-string", "title": "Building an exact match based on string", "body": "<p>I am using Couchbase 5.1.1 with Go Lang 1.11 and trying to remove results based on is value, its exact value.</p>\n\n<p>Now I have this working with another field, which is an ID and that matches up fine and is all working but the data being returns has a status of \"Available\" and \"Not Available\". I am trying to remove all the data has is set to \"Not Available\" status.</p>\n\n<p>So this is what I have setup and added the ID check to,</p>\n\n<pre><code>qp := cbft.NewConjunctionQuery()\n\nqp.And(cbft.NewConjunctionQuery( cbft.NewMatchQuery(ID).Field(\"ID\") ))\n</code></pre>\n\n<p>This is what I have done to return only the available data, </p>\n\n<pre><code>qp.And(cbft.NewConjunctionQuery( cbft.NewMatchQuery(\"Available\").Field(\"status\") ))\n</code></pre>\n\n<p>However, its not doing an exact match, it removes other data (there is like 6 or so statuses) but not anything with the word \"Available\" in it, so its still returning \"Not Available\" data.</p>\n\n<p>I have tried using, <code>NewMatchPhraseQuery</code>, as well as adding a <code>.Fuzziness(0)</code> to the <code>NewMatchQuery</code>. But nothing is working.</p>\n\n<p>So what am I doing wrong?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538487904, "post_id": 52609566, "comment_id": 92153595, "body": "a slice and an array are different types, use copy and as target use <code>arrayTarget[:]</code>"}], "answers": [{"comments": [{"owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "edited": false, "score": 0, "creation_date": 1538488089, "post_id": 52609664, "comment_id": 92153714, "body": "Its a lowlevel API for CANbus communication which wants exactly 8 bytes..."}, {"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "reply_to_user": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "edited": false, "score": 0, "creation_date": 1538488139, "post_id": 52609664, "comment_id": 92153753, "body": "Alright, that&#39;s a shame. Let me know if this fixes it though :)"}], "tags": [], "owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "is_accepted": false, "score": 2, "last_activity_date": 1538487845, "creation_date": 1538487845, "answer_id": 52609664, "question_id": 52609566, "link": "https://stackoverflow.com/questions/52609566/how-can-i-cast-byte-to-8uint8/52609664#52609664", "title": "How can I cast []byte to [8]uint8", "body": "<p>You can copy the contents of your <code>byte</code> slice into your <code>uint8</code> array very simply by using <code>copy</code>, like this:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\nfunc main() {\n    slice := []byte{1, 2, 3, 4, 5, 6, 7, 8}\n\n    array := [8]uint8{}\n\n    copy(array[:], slice)\n\n    fmt.Println(array)\n}\n</code></pre>\n\n<p>Outputs</p>\n\n<pre><code>[1 2 3 4 5 6 7 8]\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/tjw_SDz7Pt4\" rel=\"nofollow noreferrer\">Try it out on the playground</a>.</p>\n\n<p>But may I ask why you are using an array? It's usually better to just use slices, unless you have a really good reason.</p>\n"}, {"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 2, "last_activity_date": 1538492051, "creation_date": 1538492051, "answer_id": 52610975, "question_id": 52609566, "link": "https://stackoverflow.com/questions/52609566/how-can-i-cast-byte-to-8uint8/52610975#52610975", "title": "How can I cast []byte to [8]uint8", "body": "<h2>Background</h2>\n\n<p>The problem with your \"simplistic approach\" is that a slice\n(of any type) is a <code>struct</code>-typed consisting of a pointer\nand two integers; the pointer contains the address of the\nunderlying (backing) data array, and the integers contain\nwhat <code>len()</code> and <code>cap()</code> builtins return for that slice.</p>\n\n<p>In other words, a slice is sort of <em>a view into</em> an array.</p>\n\n<p>Then, in Go, there is no concept of a type cast; there are only\ntype conversions, and these conversions may only happen between\ntypes with the same <em>underlying representation\u00b9.</em></p>\n\n<p>Since a slice and an array may not have the same underlying\nrepresentation (array is literally a contiguous block of memory\nof the size just enough to contain all the array's elements),\nyour alleged type conversion may not be legal.</p>\n\n<h2>Possible solutions</h2>\n\n<p>There are two possible solutions.</p>\n\n<p>The simplest is to just copy the data from the slice's\nbacking array into a newly-allocated array:</p>\n\n<pre><code>var (\n    src = []byte{1, 2, 3, 4, 5, 6, 7, 8}\n    dst [8]uint8\n)\ncopy(dst[:], src[:8])\n</code></pre>\n\n<p>Note that there exists an inherent disparity between slice an\narray types: an array type encodes both the type of its elements\nand its length (that is, the length is a part of the type),\nwhile a slice type only encodes the type of its elements\n(and may be of any length at runtime).</p>\n\n<p>This means that you might need to have a check before such\ncopying that makes sure the source slice has exactly 8\nelements, that is, <code>len(src) == len(dst)</code>.</p>\n\n<p>This invariant may be enforced by some other code, but I think\nI'd warn you up front about this: if <code>src</code> has less than 8\nelements, the <code>src[:8]</code> expression will panic at runtime,\nand if it contains more, then there's the question of whether\ncopying just the first 8 of them is exactly what's needed.</p>\n\n<p>The second approach (admittedly messier) is to just re-use\nthe underlying array of the slice:</p>\n\n<pre><code>import \"unsafe\"\n\nvar (\n    src    = []byte{1, 2, 3, 4, 5, 6, 7, 8}\n    dstPtr *[8]uint8\n)\n\nif len(src) != len(*dstPtr) {\n    panic(\"boom\")\n}\ndstPtr = (*[8]uint8)(unsafe.Pointer(&amp;src[0]))\n</code></pre>\n\n<p>Here, we've just taken the address of the first element\ncontained in the slice's underlying array and peformed\na \"dirty\" two-phase type-conversion to make the obtained\npointer to be of type <code>*[8]uint8</code>\u2014that is, \"an address of\nan array of 8 <code>uint8</code>s\".</p>\n\n<p>Note two caveats:</p>\n\n<ul>\n<li><p>The resulting pointer now points to\nthe same memory block the original slice does.\nIt means it's now possible to mutate that memory both through the\nslice and the pointer we obtained.</p></li>\n<li><p>As soon as you'll decide to assign the array's data\nto a variable of type <code>[8]uint8</code> (and passing it as an argument\nto a function's parameter of that type), you will dereference\nthat pointer (like with <code>*dstPtr</code>), and at that moment\n<em>the array's data will be <strong>copied.</strong></em></p>\n\n<p>I'm specifically mentioning this as often people resort\nto hacks like this one to pull the backing array out of\na slice precisely in an attempt to not copy the memory.</p></li>\n</ul>\n\n<h3>TL;DR</h3>\n\n<p>Copy the data (after supposedly verifying the\n<code>len(src) == len(dst)</code> invariant holds).</p>\n\n<p>Copying 8 bytes is fast (on a typical 64-bit CPU this will be\na single <code>MOV</code> instruction, or two at most), and the code will\nbe straightforward.</p>\n\n<p>Only resort to hacks from the second solution when you really\nneed to optimize on some critical hot path.\nIn that case, comment the solution extensively and watch for\nnot accidentally dereferencing your pointer.</p>\n\n<hr>\n\n<p>\u00b9 There is a single but notable exception to this rule:\na <code>[]byte</code> is type-convertible to <code>string</code>, and vice-versa.</p>\n"}], "owner": {"reputation": 11904, "user_id": 608395, "user_type": "registered", "accept_rate": 69, "profile_image": "https://www.gravatar.com/avatar/624618628f058b51b353c2e0d4735733?s=128&d=identicon&r=PG", "display_name": "andig", "link": "https://stackoverflow.com/users/608395/andig"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 266, "favorite_count": 0, "accepted_answer_id": 52610975, "answer_count": 2, "score": 1, "last_activity_date": 1538492051, "creation_date": 1538487528, "question_id": 52609566, "link": "https://stackoverflow.com/questions/52609566/how-can-i-cast-byte-to-8uint8", "title": "How can I cast []byte to [8]uint8", "body": "<p>I need to populate a struct that has a member of type <code>[8]uint8</code>. This needs be populated with a byte array of type <code>[]byte</code> initialized to length 8. The simplistic approach does not work:</p>\n\n<pre><code>Data:   [8]uint8(RequestFrame(0x180, r)),\n</code></pre>\n\n<p>gives</p>\n\n<pre><code>cannot convert .. (type []byte) to type [8]uint8\n</code></pre>\n\n<p>Since both arrays are structurally identical it would be nice if this could be done with casting/assignment rather than copying?</p>\n"}, {"tags": ["git", "go", "jenkins", "jenkins-plugins"], "comments": [{"owner": {"reputation": 5688, "user_id": 1287864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nU0Ti.png?s=128&g=1", "display_name": "S.Spieker", "link": "https://stackoverflow.com/users/1287864/s-spieker"}, "edited": false, "score": 1, "creation_date": 1538479527, "post_id": 52607355, "comment_id": 92148744, "body": "I think the Jenkins  does not have administartive rights, so it is not allowed to create the temp files."}, {"owner": {"reputation": 43, "user_id": 6381811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cce2a6798dbed955bfe47e33746d74e?s=128&d=identicon&r=PG&f=1", "display_name": "lucian24", "link": "https://stackoverflow.com/users/6381811/lucian24"}, "reply_to_user": {"reputation": 5688, "user_id": 1287864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nU0Ti.png?s=128&g=1", "display_name": "S.Spieker", "link": "https://stackoverflow.com/users/1287864/s-spieker"}, "edited": false, "score": 0, "creation_date": 1538480445, "post_id": 52607355, "comment_id": 92149194, "body": "@S.Spieker is there any way to give Jenkins rights instead of modifying <code>systemprofile\\go\\src</code> directory with permissions?"}, {"owner": {"reputation": 43, "user_id": 6381811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cce2a6798dbed955bfe47e33746d74e?s=128&d=identicon&r=PG&f=1", "display_name": "lucian24", "link": "https://stackoverflow.com/users/6381811/lucian24"}, "reply_to_user": {"reputation": 5688, "user_id": 1287864, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/nU0Ti.png?s=128&g=1", "display_name": "S.Spieker", "link": "https://stackoverflow.com/users/1287864/s-spieker"}, "edited": false, "score": 0, "creation_date": 1538482088, "post_id": 52607355, "comment_id": 92150038, "body": "System and all users have all permissions for the <code>systemprofile\\go\\src</code>, so this shouldn&#39;t be the problem unless there is some special restriction for Jenkins about which I don&#39;t know."}], "owner": {"reputation": 43, "user_id": 6381811, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/8cce2a6798dbed955bfe47e33746d74e?s=128&d=identicon&r=PG&f=1", "display_name": "lucian24", "link": "https://stackoverflow.com/users/6381811/lucian24"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 255, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538479373, "creation_date": 1538479373, "question_id": 52607355, "link": "https://stackoverflow.com/questions/52607355/git-checkout-to-sub-directory-in-jenkins-fails-job", "title": "Git checkout to sub-directory in Jenkins fails job", "body": "<p>Working on CI for our Golang project.</p>\n\n<p>After I installed Jenkins on Windows master, I configured first Freestyle project.\nFor the sake of building golang project, the project code must be in the GOPATH under <code>src</code>. This is in my case inside <code>C:\\Windows\\System32\\config\\systemprofile\\go\\</code>.</p>\n\n<p>I made some modifications to Git Repository options inside <code>Source code management</code> in Jenkins. I set <code>Check out to sub-directory</code>  to <code>C:\\Windows\\System32\\config\\systemprofile\\go\\src\\nhm</code> so the go project would et pulled inside GOPATH. After I did that, the <code>git-fetch</code> step starts to fail.</p>\n\n<p>The error is:</p>\n\n<pre><code>ERROR: Error cloning remote repo 'origin'\nstderr: error: cannot spawn C:\\Windows\\System32\\config\\systemprofile\\go\\src\\nhm@tmp\\ssh3120648910683130753.bat: No such file or directory\n</code></pre>\n\n<p>Jenkins directories weren't changed (this includes workspaceDir <code>${JENKINS_HOME}/workspace/${ITEM_FULL_NAME}</code> and buildsDir <code>${ITEM_ROOTDIR}/builds</code> )</p>\n\n<p>What am I missing here? When gets this .bat file generated so it can be used afterwards for the sake of git-clone?</p>\n"}, {"tags": ["go", "post", "multipartform-data"], "comments": [{"owner": {"reputation": 87059, "user_id": 5728991, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/4kTj8.png?s=128&g=1", "display_name": "Cerise Lim&#243;n", "link": "https://stackoverflow.com/users/5728991/cerise-lim%c3%b3n"}, "edited": false, "score": 0, "creation_date": 1538480273, "post_id": 52607188, "comment_id": 92149120, "body": "Use <a href=\"https://godoc.org/mime/multipart\" rel=\"nofollow noreferrer\">godoc.org/mime/multipart</a> to create a multipart/form-data body."}, {"owner": {"reputation": 89578, "user_id": 3081018, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Z2NYm.png?s=128&g=1", "display_name": "Steffen Ullrich", "link": "https://stackoverflow.com/users/3081018/steffen-ullrich"}, "edited": false, "score": 2, "creation_date": 1538480530, "post_id": 52607188, "comment_id": 92149230, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20205796/golang-post-data-using-the-content-type-multipart-form-data\">golang POST data using the Content-Type multipart/form-data</a>"}], "owner": {"reputation": 31, "user_id": 7362078, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9f1e0e69f3615fa73e3742dbded013ce?s=128&d=identicon&r=PG&f=1", "display_name": "0xTanvir", "link": "https://stackoverflow.com/users/7362078/0xtanvir"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 352, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538488343, "creation_date": 1538478759, "last_edit_date": 1538488343, "question_id": 52607188, "link": "https://stackoverflow.com/questions/52607188/how-to-send-boundary-string-with-binary-data-in-golang-request", "title": "How to send --boundary_string with Binary data in golang request", "body": "<p>I wanted to upload a <code>csv</code> file in my salesforce instance via golang request from my server, now in salesforce's documentation, they gives an example like </p>\n\n<pre><code>curl https://yourInstance.salesforce.com/services/data/v23.0/sobjects/Document/ -H \"Authorization: Bearer token\" -H \"Content-Type: multipart/form-data; boundary=\\\"boundary_string\\\"\" --data-binary @newdocument.json\n</code></pre>\n\n<p>and </p>\n\n<pre><code>--boundary_string\nContent-Disposition: form-data; name=\"entity_document\";\nContent-Type: application/json\n\n{\n   \"Description\" : \"Marketing brochure for Q1 2011\",\n   \"Keywords\" : \"marketing,sales,update\",\n   \"FolderId\" : \"005D0000001GiU7\",\n   \"Name\" : \"Marketing Brochure Q1\",\n   \"Type\" : \"pdf\"\n}\n\n--boundary_string\nContent-Type: application/pdf\nContent-Disposition: form-data; name=\"Body\"; filename=\"2011Q1MktgBrochure.pdf\"\n\nBinary data goes here.\n\n--boundary_string--\n</code></pre>\n\n<p>So how can I convert this request in golang?</p>\n"}, {"tags": ["go", "goroutine"], "comments": [{"owner": {"reputation": 1263, "user_id": 7099984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb73d10a9ce4b91379b514722601f9ee?s=128&d=identicon&r=PG&f=1", "display_name": "myxaxa", "link": "https://stackoverflow.com/users/7099984/myxaxa"}, "edited": false, "score": 0, "creation_date": 1538482393, "post_id": 52606863, "comment_id": 92150197, "body": "don&#39;t understand u. just run your code and it&#39;s okay:  go test -v === RUN   Test_printdot .--- PASS: Test_printdot (1.00s) PASS ok    1.002s"}], "answers": [{"comments": [{"owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "edited": false, "score": 0, "creation_date": 1538595326, "post_id": 52611705, "comment_id": 92202193, "body": "Thanks, I&#39;ve tryied it and still the test doesnt ends up..., any idea why ?"}], "tags": [], "owner": {"reputation": 116, "user_id": 6782816, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9fafcf8852a5144602fff8dca2bb93bc?s=128&d=identicon&r=PG&f=1", "display_name": "Magiq", "link": "https://stackoverflow.com/users/6782816/magiq"}, "is_accepted": false, "score": 2, "last_activity_date": 1538559378, "last_edit_date": 1538559378, "creation_date": 1538494494, "answer_id": 52611705, "question_id": 52606863, "link": "https://stackoverflow.com/questions/52606863/golang-test-for-go-routine-with-channel/52611705#52611705", "title": "Golang test for go-routine with channel", "body": "<p>Closing a channel doesn't send data, so code will never reach the <code>return</code> in the goroutine. This trick working with range operator. You can do something like this</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"time\"\n    \"sync\"\n)\n\nfunc printdot(finish &lt;-chan struct{}, wg sync.WaitGroup) {\n    t := time.NewTicker(time.Second)\n    defer t.Stop()\n    defer wg.Done()\n    for {\n        select {\n        case &lt;-t.C:\n            fmt.Print(\".\")\n        case &lt;-finish:\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>Notice that I added sync.WaitGroup for \"waiting\" while goroutine will end</p>\n\n<pre><code>package main\n\n\nimport (\n        \"fmt\"\n        \"time\"\n        \"sync\"\n        \"testing\"\n\n    )\n\nfunc Test_printdot(t *testing.T) {\n    var wg sync.WaitGroup\n    wg.Add(1)\n    finish := make(chan struct{})\n    start := time.Now()\n    go printdot(finish, wg)\n    time.Sleep(3 * time.Second)\n\n    sec := time.Since(start).Seconds()\n    switch int(sec) {\n    case 0:\n        // Output:\n    case 1:\n        // Output: .\n    case 2:\n        // Output: ..\n    case 3:\n        // Output: ...\n    default:\n        t.Error(\"Too much time\u2026\")\n    }\n\n    finish &lt;- struct{}{}\n    wg.Wait()\n}\n</code></pre>\n"}], "owner": {"user_type": "does_not_exist", "display_name": "user6171746"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2194, "favorite_count": 2, "answer_count": 1, "score": 1, "last_activity_date": 1538559378, "creation_date": 1538477351, "last_edit_date": 1538527137, "question_id": 52606863, "link": "https://stackoverflow.com/questions/52606863/golang-test-for-go-routine-with-channel", "title": "Golang test for go-routine with channel", "body": "<p>I\u2019ve the following function which prints dots to the terminal while executing \nSome process, the code is <strong>working as expected</strong> but now I want to test it.\nHow should I do that</p>\n\n<pre><code>func printdot(finish &lt;-chan struct{}) {\n    t := time.NewTicker(time.Second)\n    defer t.Stop()\n    for {\n        select {\n        case &lt;-t.C:\n            fmt.Print(\".\")\n        case &lt;-finish:\n            return\n        }\n    }\n}\n</code></pre>\n\n<p>This is the test </p>\n\n<pre><code>func Test_printdot(t *testing.T) {\n\n    finish := make(chan struct{})\n    start := time.Now()\n    go printdot(finish)\n    time.Sleep(1 * time.Second)\n\n    sec := time.Since(start).Seconds()\n    switch int(sec) {\n    case 0:\n        // Output:\n    case 1:\n        // Output: .\n    case 2:\n        // Output: ..\n    case 3:\n        // Output: ...\n    default:\n        t.Error(\u201cToo much time\u2026\u201d)\n    }\n\n     close(finish)\n}\n</code></pre>\n\n<p>Now the test is continue running without stop even that Im using the finish code , any idea how to improve it ? </p>\n"}, {"tags": ["http", "go"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538477517, "post_id": 52606641, "comment_id": 92147749, "body": "Use <a href=\"https://golang.org/pkg/net/http/#FileServer\" rel=\"nofollow noreferrer\"><code>http.FileServer</code></a> for assets, in the docs there&#39;s also an example."}, {"owner": {"reputation": 1114, "user_id": 6143407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/i61ma.jpg?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6143407/julian"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538477747, "post_id": 52606641, "comment_id": 92147850, "body": "@mkopriva I tried that, but it returns nothing to the browser: <code>http.FileServer(http.Dir(rootHtml))</code>"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538477798, "post_id": 52606641, "comment_id": 92147874, "body": "rootHtml is not a directory, it points to a file, so your FileServer will serve only that file, hence the mime being always text/html."}, {"owner": {"reputation": 1114, "user_id": 6143407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/i61ma.jpg?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6143407/julian"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538477990, "post_id": 52606641, "comment_id": 92147961, "body": "Still not working. I set <code>const rootHtml = &quot;.&#47;assets&quot;</code> and <code>http.FileServer(http.Dir(rootHtml))</code> at the else branch."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538478094, "post_id": 52606641, "comment_id": 92148003, "body": "What else branch, take a look at the docs&#39; example. Don&#39;t invoke the FileServe inside a handler for each request. You should instantiate it once and register it like in the example."}, {"owner": {"reputation": 1114, "user_id": 6143407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/i61ma.jpg?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6143407/julian"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538478331, "post_id": 52606641, "comment_id": 92148133, "body": "This is the exact problem I have. I don&#39;t want a global registration. It could be possible that there is a redirect before serving the static resources (the if branch in my code). The example just shows how to register a single handler for all request at <code>&quot;&#47;&quot;</code>, which is not the case here."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538479344, "post_id": 52606641, "comment_id": 92148645, "body": "Use either a middleware wrapper around the FileServer that does the branching, or use your initial approach but instead of passing a constant to ServeFile, construct the filepath from the request path. Or create yourself a FileServer without registering it, make it global or accessible only to the interested handlers, and then the root handler would invoke the FileServer via its ServeHTTP."}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538479729, "post_id": 52606641, "comment_id": 92148862, "body": "Have you tried <code>http.ServeFile(w, r, &quot;.&#47;assets&#47;&quot;)</code> in your else branch?"}], "owner": {"reputation": 1114, "user_id": 6143407, "user_type": "registered", "accept_rate": 86, "profile_image": "https://i.stack.imgur.com/i61ma.jpg?s=128&g=1", "display_name": "Julian", "link": "https://stackoverflow.com/users/6143407/julian"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 33, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538485733, "creation_date": 1538476538, "last_edit_date": 1538485733, "question_id": 52606641, "link": "https://stackoverflow.com/questions/52606641/how-to-conditionally-redirect-and-serve-html-with-assets-at-the-same-time", "title": "How to conditionally redirect and serve HTML with assets at the same time", "body": "<h2>Problem</h2>\n\n<p>When I want to serve static HTML, the assets (CSS, JavaScript) MIME-type is also <code>text/html</code>, which leads to an error.</p>\n\n<h2>Approach</h2>\n\n<p>Inside <code>./assets/</code> is an <code>index.html</code>, CSS and JavaScript files.</p>\n\n<pre><code>const rootHtml = \"./assets/index.html\"\n\nfunc main() {\n    http.HandleFunc(\"/\", root)\n\n    log.Fatal(http.ListenAndServe(\":3000\", nil))\n}\n\nfunc root(w http.ResponseWriter, r *http.Request) {\n    if false {\n        http.Redirect(w, r, \"/other-route/, http.StatusTemporaryRedirect)\n    } else {\n        http.ServeFile(w, r, rootHtml) // This should handle the index.html and all other resources\n    }\n}\n</code></pre>\n\n<p>Assets directory:</p>\n\n<pre><code>assets/\n|-- js/\n|-- css/\n|-- index.html\n</code></pre>\n"}, {"tags": ["go", "struct"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538476300, "post_id": 52606222, "comment_id": 92147132, "body": "The recommended solution may depend on factors not mentioned in the question, e.g. how many of these structs you intend to store, may they be read into memory, may there be any limits to length of strings and the depth of the tree?"}, {"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538476896, "post_id": 52606222, "comment_id": 92147427, "body": "@icza those factors aren&#39;t really relevant for my use-case, but I&#39;d like to have an efficient solution which is able to store 10 but also 100k structs. The strings can be limited (1024 characters), but it should be configurable. The same applies for the depth of the tree, a maximum depth of 10 is a good example in my use-case."}, {"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538477792, "post_id": 52606222, "comment_id": 92147871, "body": "@icza after some reflections I noticed that it would be interesting to see what type of different solutions exist depending on those factors."}, {"owner": {"reputation": 12516, "user_id": 302268, "user_type": "registered", "accept_rate": 77, "profile_image": "https://www.gravatar.com/avatar/c3985dffcdc646b67ed0699a364639e2?s=128&d=identicon&r=PG", "display_name": "Mad Wombat", "link": "https://stackoverflow.com/users/302268/mad-wombat"}, "edited": false, "score": 0, "creation_date": 1538500246, "post_id": 52606222, "comment_id": 92160782, "body": "Well, SQLite is a good option when you need a database without the database server. It is probably the easiest way to do atomic updates on a set of records. You can also use Gorm relation manager if you want to avoid writing SQL by hand."}], "answers": [{"comments": [{"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1538488049, "post_id": 52609546, "comment_id": 92153684, "body": "Thank you for your answer. Unfortunately, this way I will only be able to get/update the whole contents of <code>posts</code>, rather than being able to get/update a single struct."}, {"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "reply_to_user": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1538490607, "post_id": 52609546, "comment_id": 92155306, "body": "You can update a single struct.  But you&#39;ll have to load them all, update and then write them all again.  If (for example) you put each of the Post structs in a single file then probably updating would be a little quicker but reading would be slower.  There are half way houses like using sharding (splitting the Post struct list in half or quarter) . All of this sounds like reinventing the database however.  Why not try timing the approach above with 100k records and seeing how it does?"}, {"owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "edited": false, "score": 0, "creation_date": 1538492244, "post_id": 52609546, "comment_id": 92156346, "body": "I will definitively have to do a benchmark on this. I&#39;m just a little bit surprised that there isn&#39;t a library for that use-case. But I guess it is that common to store struct trees on disk."}], "tags": [], "owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "is_accepted": false, "score": 1, "last_activity_date": 1538487448, "creation_date": 1538487448, "answer_id": 52609546, "question_id": 52606222, "link": "https://stackoverflow.com/questions/52606222/storing-struct-trees-on-disk/52609546#52609546", "title": "Storing struct trees on disk", "body": "<p>Use the encoding/gob put the binary data in a file or get it out again</p>\n\n<pre><code>import (\n    \"bufio\"\n    \"encoding/gob\"\n    \"fmt\"\n    \"os\"\n)\n\ntype Post struct {\n    Id    int\n    Name  string\n    Text  string\n    Posts []Post\n}\n\nfunc main() {\n\n    var posts []Post\n\n    posts = append(posts, Post{Id: 0, Name: \"a\", Text: \"b\"})\n    posts[0].Posts = append(posts[0].Posts, Post{Id: 1, Name: \"c\", Text: \"d\"})\n\n    posts = append(posts, Post{Id: 2, Name: \"e\", Text: \"f\"})\n    posts[0].Posts = append(posts[0].Posts, Post{Id: 3, Name: \"h\", Text: \"d\"})\n    fmt.Printf(\"%v\\n\", posts)\n\n    path := \"post.gob\"\n\n    // write\n    out, err1 := os.Create(path)\n    if err1 != nil {\n        fmt.Printf(\"File write error: %v\\n\", err1)\n        os.Exit(1)\n    }\n    w := bufio.NewWriter(out)\n    enc := gob.NewEncoder(w)\n    enc.Encode(posts)\n    w.Flush()\n    out.Close()\n\n    // read\n    b := make([]Post, 10)\n    in, err2 := os.Open(path)\n    if err2 != nil {\n        fmt.Printf(\"File read error: %v\\n\", err2)\n        os.Exit(1)\n    }\n    r := bufio.NewReader(in)\n    dec := gob.NewDecoder(r)\n    dec.Decode(&amp;b)\n\n    fmt.Printf(\"%v\\n\", b)\n\n}\n</code></pre>\n"}], "owner": {"reputation": 4014, "user_id": 239117, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/f6WTW.jpg?s=128&g=1", "display_name": "watain", "link": "https://stackoverflow.com/users/239117/watain"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 104, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538487448, "creation_date": 1538474952, "last_edit_date": 1538485745, "question_id": 52606222, "link": "https://stackoverflow.com/questions/52606222/storing-struct-trees-on-disk", "title": "Storing struct trees on disk", "body": "<p>I have the following struct:</p>\n\n<pre><code>type Post struct {\n  Id    int\n  Name  string\n  Text  string\n  Posts []Post\n}\n</code></pre>\n\n<p>To add some data, I do the following:</p>\n\n<pre><code>var posts []Post\n\nposts = append(posts, Post{Id: 0, Name: \"a\", Text: \"b\"})\nposts[0].Posts = append(posts[0].Posts, Post{Id: 1, Name: \"c\", Text: \"d\"})\n\nposts = append(posts, Post{Id: 2, Name: \"e\", Text: \"f\"})\nposts[0].Posts = append(posts[0].Posts, Post{Id: 3, Name: \"h\", Text: \"d\"})\n</code></pre>\n\n<p>How can I efficiently store this struct tree on disk? I'm looking for something which can be used without a server (like SQLite). I would like to be able to search for <code>Id</code> 2 or 3, returning the entire struct with the <code>Id</code> 2 or 3, respectively. Also, I would like to be able to update a single struct, f.e. the one with <code>Id</code> 2.</p>\n\n<p>Also, would it be better to use a map, using <code>Id</code> as the map's key?</p>\n"}, {"tags": ["go", "struct", "composition"], "comments": [{"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 0, "creation_date": 1538470897, "post_id": 52604895, "comment_id": 92144427, "body": "Implementing <code>PauseUntil</code> on your <code>Mystruct</code> type, otherwise no it won&#39;t be able to access the fields/methods of a structure that is composed of it."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1538471781, "post_id": 52604895, "comment_id": 92144924, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/20167935/can-embedded-methods-access-parent-fields\">Can embedded methods access &quot;parent&quot; fields?</a>"}], "answers": [{"comments": [{"owner": {"reputation": 1548, "user_id": 2841607, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjWu8.jpg?s=128&g=1", "display_name": "minitauros", "link": "https://stackoverflow.com/users/2841607/minitauros"}, "edited": false, "score": 0, "creation_date": 1538478798, "post_id": 52607092, "comment_id": 92148353, "body": "I like your solution, although I don&#39;t like that I&#39;ll end up with a function that is not part of any struct/interface. Only alternative I can think of is giving the <code>PauseUntil</code> method a <code>Pauser</code> receiver, but then a call like <code>pauser.PauseUntil(pauser, dur)</code> would be weird (the pauser calling <code>PauseUntil</code> on itself, passing itself as first argument).."}], "tags": [], "owner": {"reputation": 1174, "user_id": 4201661, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-9GrGWDH8rOs/AAAAAAAAAAI/AAAAAAAAAEw/IwJ4rsVy0e0/photo.jpg?sz=128", "display_name": "Peter Stace", "link": "https://stackoverflow.com/users/4201661/peter-stace"}, "is_accepted": true, "score": 1, "last_activity_date": 1538478345, "creation_date": 1538478345, "answer_id": 52607092, "question_id": 52604895, "link": "https://stackoverflow.com/questions/52604895/golang-struct-composition-composed-with-struct-cannot-access-its-parent/52607092#52607092", "title": "Golang struct composition - composed with struct cannot access its &quot;parent&quot;", "body": "<p>You could make <code>PauseUntil</code> a function that operates on a <code>Pauser</code> interface.</p>\n\n<p>E.g.</p>\n\n<pre><code>type Pauser interface {\n    Pause()\n    Unpause()\n}\n\nfunc PauseUntil(p Pauser) {\n    p.Pause()\n\n    go func() {\n        time.Sleep(dur)\n        p.Unpause()\n    }()\n}\n</code></pre>\n\n<p>Then you should be able to pass your <code>myStruct</code> to that function:</p>\n\n<pre><code>ms := new(myStruct)\nPauseUntil(ms)\n</code></pre>\n"}], "owner": {"reputation": 1548, "user_id": 2841607, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/JjWu8.jpg?s=128&g=1", "display_name": "minitauros", "link": "https://stackoverflow.com/users/2841607/minitauros"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 320, "favorite_count": 0, "accepted_answer_id": 52607092, "answer_count": 1, "score": 1, "last_activity_date": 1538478608, "creation_date": 1538469863, "last_edit_date": 1538478608, "question_id": 52604895, "link": "https://stackoverflow.com/questions/52604895/golang-struct-composition-composed-with-struct-cannot-access-its-parent", "title": "Golang struct composition - composed with struct cannot access its &quot;parent&quot;", "body": "<p>This question appears to be a duplicate of <a href=\"https://stackoverflow.com/questions/20167935/can-embedded-methods-access-parent-fields\">Can embedded methods access &quot;parent&quot; fields?</a>, but it is not in the sense that I know that there is no way to access the \"parent\" fields; I am just looking for suggestions on another way to do this, because I like the idea of the <code>Pausable</code> struct.</p>\n\n<hr>\n\n<p>I am trying to make a convenience struct that enables other structs to receive some pausing/unpausing methods.</p>\n\n<p>Imagine the following:</p>\n\n<p><strong>Pausable struct</strong></p>\n\n<pre><code>type Pausable struct {\n    isPaused bool\n}\n\nfunc (p *Pausable) Pause() {\n    p.isPaused = true\n}\n\nfunc (p *Pausable) Unpause() {\n    p.isPaused = false\n}\n</code></pre>\n\n<p><strong>Struct that composes with Pausable</strong></p>\n\n<p>Now on my other struct I want to overwrite the <code>Unpause()</code> method, so that besides changing the value of <code>p.isPaused</code> some other stuff happens as well.</p>\n\n<pre><code>type Mystruct struct {\n    Pausable // Composition\n}\n\nfunc (s *Mystruct) Unpause() {\n    s.Unpause()\n\n    // Do other stuff\n}\n</code></pre>\n\n<p><strong>Problem</strong></p>\n\n<p>The problem becomes this. I want to add an <code>PauseUntil()</code> method to the <code>Pausable</code> struct, so that it becomes</p>\n\n<pre><code>type Pausable struct {\n    isPaused bool\n}\n\nfunc (p *Pausable) Pause() {\n    p.isPaused = true\n}\n\nfunc (p *Pausable) Unpause() {\n    p.isPaused = false\n}\n\nfunc (p *Pausable) PauseUntil(dur time.Duration) {\n    p.Pause()\n\n    go func() {\n        time.Sleep(dur)\n        p.Unpause()\n    }()\n}\n</code></pre>\n\n<p>When the timeout runs out, however, <code>Unpause()</code> is called on <code>Pausable</code>, and not on <code>Mystruct</code>. What would be a clever way around this?</p>\n"}, {"tags": ["sql-server", "go"], "answers": [{"comments": [{"owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "edited": false, "score": 0, "creation_date": 1538550802, "post_id": 52617676, "comment_id": 92176860, "body": "Thank you so much for your help. So here we have a for loop for 21 columns . So can you please elaborate on how to add the &quot;stmt,Exec()&quot; . I am quite new to golang so can you please walk me through the for loop ."}, {"owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "reply_to_user": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "edited": false, "score": 0, "creation_date": 1538575692, "post_id": 52617676, "comment_id": 92191314, "body": "You can find plenty of online documentation about <a href=\"https://gobyexample.com/for\" rel=\"nofollow noreferrer\">for-loops</a> and <a href=\"https://golang.org/pkg/database/sql/#Stmt.Exec\" rel=\"nofollow noreferrer\"><code>sql.Stmt.Exec</code></a>. Good luck!"}], "tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 2, "last_activity_date": 1538523090, "last_edit_date": 1538523090, "creation_date": 1538522371, "answer_id": 52617676, "question_id": 52604432, "link": "https://stackoverflow.com/questions/52604432/how-to-import-csv-and-save-in-mssql-database-using-golang/52617676#52617676", "title": "How to import csv and save in MSSQL database using golang?", "body": "<p>It looks like you're half way there!</p>\n\n<p>Your sample code looks like it will read CSV data from a named file. The next step would be to connect to the MSSQL database instance and insert the rows from the CSV data.</p>\n\n<p>To do so, you'll need to find a golang driver for that database (<a href=\"https://github.com/denisenkom/go-mssqldb\" rel=\"nofollow noreferrer\"><code>denisenkom/go-mssqldb</code></a> looks worth trying, there's even a <a href=\"https://github.com/denisenkom/go-mssqldb/blob/master/examples/simple/simple.go\" rel=\"nofollow noreferrer\">simple example</a>) and follow the patterns established by the <a href=\"https://golang.org/pkg/database/sql/\" rel=\"nofollow noreferrer\">go <code>database/sql</code> package</a> (especially the <a href=\"https://golang.org/pkg/database/sql/#pkg-examples\" rel=\"nofollow noreferrer\">package examples</a>).</p>\n\n<p>A working solution might look something like this (not working but demonstrative):</p>\n\n<pre><code>import (\n  \"database/sql\"\n  _ \"github.com/denisenkom/go-mssqldb\"\n  // ...\n)\n\nfunc main() {\n  rows := readOrders(\"Ec2Instances.csv\")\n  insertRowsToDatabase(rows)\n}\n\nfunc insertRowsToDatabase(rows [][]string) {\n  // Connect to the database.\n  connString := \"server=myserver;user id=123;password=secret;port=234\"\n  db, err := sql.Open(\"mssql\", connString)\n  if err != nil {\n    log.Fatal(\"Open connection failed:\", err.Error())\n  }\n  defer db.Close()\n\n  // Insert the rows, omitting the first header row from the CSV.\n  stmt, err := db.Prepare(\"INSERT INTO Ec2Instances(id, name) VALUES(?, ?)\")\n  if err != nil {\n    log.Fatal(err)\n  }\n  for _, row := range rows[1:] {\n    _, err := stmt.Exec(row[0], row[1])\n    if err != nil {\n      log.Fatal(err)\n    }\n  }\n}\n</code></pre>\n"}], "owner": {"reputation": 158, "user_id": 10444937, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/SXf4F.png?s=128&g=1", "display_name": "Prashanth", "link": "https://stackoverflow.com/users/10444937/prashanth"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1747, "favorite_count": 0, "accepted_answer_id": 52617676, "answer_count": 1, "score": 1, "last_activity_date": 1538536309, "creation_date": 1538468079, "last_edit_date": 1538536309, "question_id": 52604432, "link": "https://stackoverflow.com/questions/52604432/how-to-import-csv-and-save-in-mssql-database-using-golang", "title": "How to import csv and save in MSSQL database using golang?", "body": "<p>This is my code. Currently, I just read the contents of the CSV file. I need to migrate this CSV file to MSSQL using Go Language Application</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"log\"\n    \"os\"\n)\n\nfunc main() {\n    rows := readOrders(\"Ec2Instances.csv\")\n}\n\nfunc readOrders(name string) [][]string {\n    f, err := os.Open(name)\n    if err != nil {\n        log.Fatalf(\"Cannot open '%s': %s\\n\", name, err.Error())\n    }\n    defer f.Close()\n    r := csv.NewReader(f)\n    r.Comma = ';'\n    rows, err := r.ReadAll()\n    if err != nil {\n        log.Fatalln(\"Cannot read CSV data:\", err.Error())\n    }\n    return rows\n}\n</code></pre>\n\n<p>I want the CSV file to be written specifically into the \"MSSQL Database\". I have installed MSSQL and SSMS Softwares. How do I access these and write data into it?</p>\n"}, {"tags": ["json", "go"], "comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 1, "creation_date": 1538467896, "post_id": 52604156, "comment_id": 92142873, "body": "If the wrapping types aren&#39;t used anywhere else, they can be defined anonymously for brevity: <a href=\"https://play.golang.org/p/DfCku3AYbKw\" rel=\"nofollow noreferrer\">play.golang.org/p/DfCku3AYbKw</a>"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1538468119, "post_id": 52604156, "comment_id": 92142985, "body": "@Peter Right, post it as an answer."}], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1538468159, "last_edit_date": 1538468159, "creation_date": 1538467610, "answer_id": 52604317, "question_id": 52604156, "link": "https://stackoverflow.com/questions/52604156/how-to-simplify-marshaling-of-deeply-nested-json/52604317#52604317", "title": "How to simplify marshaling of deeply-nested JSON", "body": "<p>That sounds about right. The solution is a little verbose / redundant, but so is the data format you have to deal with.</p>\n\n<p>To work with that easily, you may create helper functions and use them:</p>\n\n<pre><code>func wrap(u User) *ReqJSON {\n    return &amp;ReqJSON{Request: Request{Data: Data{Object: Object{User: u}}}}\n}\n\nfunc unwrap(r *ReqJSON) User {\n    return r.Request.Data.Object.User\n}\n</code></pre>\n\n<p>But other than that, you can't really simplify other things.</p>\n\n<p>So marshaling a <code>User</code> is like:</p>\n\n<pre><code>var u User\ndata, err := json.Marshal(wrap(u))\n</code></pre>\n\n<p>Unmarshaling is:</p>\n\n<pre><code>var r *ReqJSON\nerr := json.Unmarshal(data, &amp;r)\n// Check error\n\nu := unwrap(r) // Here we have the user\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "is_accepted": false, "score": 1, "last_activity_date": 1538469110, "last_edit_date": 1538469110, "creation_date": 1538468723, "answer_id": 52604611, "question_id": 52604156, "link": "https://stackoverflow.com/questions/52604156/how-to-simplify-marshaling-of-deeply-nested-json/52604611#52604611", "title": "How to simplify marshaling of deeply-nested JSON", "body": "<p>You can't eliminate the complexity, but you could potentially hide some of it inside of a custom Marshaler:</p>\n\n<pre><code>type Request struct {\n    UserID    string `json:\"userid\"`\n    IPAddr    string `json:\"ipaddr\"`\n    Noofusers string `json:\"noofusers\"`\n    Qos       string `json:\"qos\"`\n    ID        string `json:\"id\"`\n    Domain    string `json:\"domain\"`\n}\n\nfunc (r *Request) MarshalJSON() ([]byte, error) {\n    type request struct {\n        Data struct {\n            Object struct {\n                User struct {\n                    Request\n                } `json:\"user\"`\n            } `json:\"object\"`\n        } `json:\"data\"`\n    }\n    structure := request{Data: data{Object: object{User: user{r}}}}\n    return json.Marshal(structure)    \n}\n</code></pre>\n\n<p>The same approach can be employed in reverse for <code>UnmarshalJSON</code>, if desired.</p>\n"}, {"tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 2, "last_activity_date": 1538468870, "creation_date": 1538468870, "answer_id": 52604655, "question_id": 52604156, "link": "https://stackoverflow.com/questions/52604156/how-to-simplify-marshaling-of-deeply-nested-json/52604655#52604655", "title": "How to simplify marshaling of deeply-nested JSON", "body": "<p>If you don't need the wrapping types for anything besides marshaling/unmarshaling, you can define them anonymously:</p>\n\n<pre><code>type ReqJSON struct {\n    Request struct {\n        Data struct {\n            Object struct {\n                User User `json:\"user\"`\n            } `json:\"object\"`\n        } `json:\"data\"`\n    } `json:\"request\"`\n}\n\ntype User struct {\n    UserID string `json:\"userid\"`\n    IPAddr string `json:\"ipaddr\"`\n    Noofusers string `json:\"noofusers\"`\n    Qos string `json:\"qos\"`\n    ID string `json:\"id\"`\n    Domain string `json:\"domain\"`\n}\n</code></pre>\n\n<p>And, borowing from icza's answer, you can add accessor methods to <code>ReqJSON</code>:</p>\n\n<pre><code>func (j *ReqJSON) User() User     { return j.Request.Data.Object.User }\nfunc (j *ReqJSON) SetUser(u User) { j.Request.Data.Object.User = u }\n\nfunc main() {\n    var j ReqJSON\n    j.SetUser(User{\n            UserID:    \"_id\",\n            IPAddr:    \"1.1.1.1\",\n            Noofusers: \"100\",\n            Qos:       \"34\",\n            ID:        \"kldjflkdfjlkdjfkld\",\n            Domain:    \"xyz.com\",\n    })\n\n    b, err := json.MarshalIndent(j, \"\", \"  \")\n    fmt.Println(err, string(b))\n}\n</code></pre>\n"}], "owner": {"reputation": 825, "user_id": 570200, "user_type": "registered", "accept_rate": 45, "profile_image": "https://www.gravatar.com/avatar/c1f1eb2f77f0fc96d61e5d2252b179dc?s=128&d=identicon&r=PG", "display_name": "Abhinav", "link": "https://stackoverflow.com/users/570200/abhinav"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 140, "favorite_count": 0, "accepted_answer_id": 52604655, "answer_count": 3, "score": 2, "last_activity_date": 1538472546, "creation_date": 1538467036, "last_edit_date": 1538472546, "question_id": 52604156, "link": "https://stackoverflow.com/questions/52604156/how-to-simplify-marshaling-of-deeply-nested-json", "title": "How to simplify marshaling of deeply-nested JSON", "body": "<p>I have a JSON which contain some static and dynamic data. Below is a sample of JSON</p>\n\n<pre><code>{\n  \"request\": {  /*Static data start */\n    \"data\": {\n      \"object\": { /*Static data ends here*/\n        \"user\": { /*Dynamic data start here */\n          \"userid\": \"andmmdn\",\n          \"ipaddr\": \"1.1.1.1\",\n          \"noofusers\": \"100\",\n          \"qos\": \"34\",\n          \"id\": \"kldjflkdfjlkdjfkld\",\n          \"domain\": \"xyz.com\" /*Dynamic data ends here */\n        } \n      }\n    }\n  }\n}\n</code></pre>\n\n<p>Below is the code which can create this JSON</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"encoding/json\"\n)\n//ReqJSON struct\ntype ReqJSON struct {\n    Request Request `json:\"request\"`\n}\n//Request struct\ntype Request struct {\n    Data Data `json:\"data\"` \n}\n//Data struct\ntype Data struct {\n    Object Object `json:\"object\"`\n}\n//Object struct\ntype Object struct {\n    User User `json:\"user\"`\n}\n//User struct\ntype User struct {\n    UserID string `json:\"userid\"`\n    IPAddr string `json:\"ipaddr\"`\n    Noofusers string `json:\"noofusers\"`\n    Qos string `json:\"qos\"`\n    ID string `json:\"id\"`\n    Domain string `json:\"domain\"`\n}\nfunc main() {\n    test := ReqJSON {\n        Request{\n            Data: Data{\n                Object: Object{\n                    User: User{\n                        UserID: \"andmmdn\",\n                        IPAddr: \"1.1.1.1\",\n                        Noofusers: \"100\",\n                        Qos: \"34\",\n                        ID: \"kldjflkdfjlkdjfkld\",\n                        Domain: \"xyz.com\",\n                    },  \n                },  \n            },\n        },\n    }\n    jsonEncode, _ := json.Marshal(test)\n    jsonIdent, _ := json.MarshalIndent(&amp;test, \"\", \"\\t\")\n    fmt.Println(string(jsonEncode))\n    fmt.Println(string(jsonIdent))\n}\n</code></pre>\n\n<p>As you can see from above it contain struct which doesn't make much sense as they act more like placeholder for nesting the data. So how we make it more optimized. As all the data is being taken care in the last struct. What approach for unmarshaling of the data should be applied as the response will be in same format and want to use the last struct for the same.\nAny thoughts on the approach.\nAlso how to make a generic struct as I multiple API which uses same struct below is an example</p>\n\n<pre><code>//ReqJSON for populating data\ntype ReqJSON struct {\n    Request struct {\n        Data struct {\n            Object struct {\n                Auth Auth `json:\"auth\"`\n            } `json:\"object\"`\n        } `json:\"data\"`\n    } `json:\"request\"`\n}\n//ReqJSON for populating data\ntype ReqJSON struct {\n    Request struct {\n        Data struct {\n            Object struct {\n                Error Error `json:\"error\"`\n            } `json:\"object\"`\n        } `json:\"data\"`\n    } `json:\"request\"`\n}\n</code></pre>\n"}, {"tags": ["go", "apache-kafka", "kafka-consumer-api", "confluent-platform"], "answers": [{"comments": [{"owner": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "edited": false, "score": 0, "creation_date": 1538463108, "post_id": 52602952, "comment_id": 92140683, "body": "I have set offsets.retention.minutes=10080 (7 days) in the configuration, and restart kafka, but after running about 3 to 5 hours, the current-offset and lag still change to unknown. I don&#39;t think that my consumer group is inactive, because the current-offset and lag were showed for some partitions, it proves my consumer group is active"}, {"owner": {"reputation": 23213, "user_id": 7131757, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wvEUE.jpg?s=128&g=1", "display_name": "Giorgos Myrianthous", "link": "https://stackoverflow.com/users/7131757/giorgos-myrianthous"}, "reply_to_user": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "edited": false, "score": 0, "creation_date": 1538464408, "post_id": 52602952, "comment_id": 92141235, "body": "@hongnguyenhuu96 an you confirm that the offset topic is using compaction and the broker is set to enable compaction?"}, {"owner": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "edited": false, "score": 0, "creation_date": 1538465807, "post_id": 52602952, "comment_id": 92141809, "body": "yes. In the server.properties.      <code>log.cleanup.policy=compact</code>     <code>offsets.retention.minutes=10080</code>  I also used a python consumer that does the same function (I want to convert code of this python consumer to golang for better performance). There are no partition with unknown offset and lag for python consumer. I think the problem is about the library.  Now, I am trying to using poll api instead of using go chanel event."}, {"owner": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "edited": false, "score": 0, "creation_date": 1538475676, "post_id": 52602952, "comment_id": 92146770, "body": "I have tried to use consumer.poll api, but after 2 hours, it still happens. The current-offset  and lag now is unknown for some partitions."}, {"owner": {"reputation": 23213, "user_id": 7131757, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wvEUE.jpg?s=128&g=1", "display_name": "Giorgos Myrianthous", "link": "https://stackoverflow.com/users/7131757/giorgos-myrianthous"}, "reply_to_user": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "edited": false, "score": 0, "creation_date": 1538475797, "post_id": 52602952, "comment_id": 92146836, "body": "@hongnguyenhuu96 Does this happen with your Python consumer too?"}, {"owner": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "edited": false, "score": 0, "creation_date": 1538476758, "post_id": 52602952, "comment_id": 92147366, "body": "No, for python consumer, current-offset and lag of all partitions are clear."}, {"owner": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "edited": false, "score": 0, "creation_date": 1538477092, "post_id": 52602952, "comment_id": 92147531, "body": "go consumer: <a href=\"https://user-images.githubusercontent.com/12449250/46344253-c0e70a00-c66a-11e8-9b4c-542021cfbe8c.png\" rel=\"nofollow noreferrer\">image</a>  python consumer: <a href=\"https://user-images.githubusercontent.com/12449250/46344271-cf352600-c66a-11e8-9a23-4a66863cb89f.png\" rel=\"nofollow noreferrer\">image</a>"}], "tags": [], "owner": {"reputation": 23213, "user_id": 7131757, "user_type": "registered", "accept_rate": 77, "profile_image": "https://i.stack.imgur.com/wvEUE.jpg?s=128&g=1", "display_name": "Giorgos Myrianthous", "link": "https://stackoverflow.com/users/7131757/giorgos-myrianthous"}, "is_accepted": false, "score": 1, "last_activity_date": 1538462094, "last_edit_date": 1538462094, "creation_date": 1538461190, "answer_id": 52602952, "question_id": 52602334, "link": "https://stackoverflow.com/questions/52602334/kafka-offset-and-lag-is-unknown-for-some-partitions-of-a-topic/52602952#52602952", "title": "kafka offset and lag is unknown for some partitions of a topic", "body": "<p><code>offsets.retention.minutes</code> is used for clean up inactive consumer groups. If a consumer group does not commit any offset for <code>offsets.retention.minutes</code> (defaults to 24h), kafka will clean up its offset. This is why offset and log are set to <code>unknown</code>.</p>\n\n<p>You can increase offset retention period however, be aware that old consumers will reserve space in <code>__consumer_offsets</code> topic. </p>\n"}, {"tags": [], "owner": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "is_accepted": false, "score": 0, "last_activity_date": 1539143743, "creation_date": 1539143743, "answer_id": 52732391, "question_id": 52602334, "link": "https://stackoverflow.com/questions/52602334/kafka-offset-and-lag-is-unknown-for-some-partitions-of-a-topic/52732391#52732391", "title": "kafka offset and lag is unknown for some partitions of a topic", "body": "<p>I use the command bellow to see whether the offset of my consumer group id is commited periodically or not.</p>\n\n<pre><code>echo exclude.internal.topics=false &gt; consumer.properties\n\nkafka-console-consumer --consumer.config consumer.properties --from-beginning --topic __consumer_offsets --zookeeper localhost:2181 --formatter \"kafka.coordinator.GroupMetadataManager\\$OffsetsMessageFormatter\"\n</code></pre>\n\n<p>Although I set the value of <code>enable.auto.commit</code> to <code>true</code>, it does not commit periodically for partitions which its <code>lag = 0</code>. The current offset for those partitions is removed after 2 to 3 hours even the consumer group is still active.</p>\n\n<p>To solve this issue, I set <code>enable.auto.commit</code> to <code>false</code> and write my own function to commit offset after every 5 seconds.</p>\n\n<p>Here is the ideal:\nWhen a consumer get a new <code>Message</code> event or reach end of partition (<code>PartitionEOF</code>) event, from the data of the event, I keep the latest current offset in a commit map (key:<code>topic_partition</code> value:\n<code>kafka.TopicPartition{ Topic, Partition, Offset }</code>) and there is a function to commit this map periodically (may be after every 5 seconds). When the consumer get <code>RevokedPartitions</code> event, I remove the corresponding key <code>topic_partition</code> from the commit map.</p>\n"}], "owner": {"reputation": 55, "user_id": 4525272, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/78e314645a7626e976fb736d840d4d1d?s=128&d=identicon&r=PG&f=1", "display_name": "hongnguyenhuu96", "link": "https://stackoverflow.com/users/4525272/hongnguyenhuu96"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2457, "favorite_count": 1, "answer_count": 2, "score": 2, "last_activity_date": 1539143743, "creation_date": 1538456919, "last_edit_date": 1538458895, "question_id": 52602334, "link": "https://stackoverflow.com/questions/52602334/kafka-offset-and-lag-is-unknown-for-some-partitions-of-a-topic", "title": "kafka offset and lag is unknown for some partitions of a topic", "body": "<p><a href=\"https://i.stack.imgur.com/is65b.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/is65b.png\" alt=\"enter image description here\"></a></p>\n\n<p>I am using consumer from <a href=\"https://github.com/confluentinc/confluent-kafka-go\" rel=\"nofollow noreferrer\">https://github.com/confluentinc/confluent-kafka-go</a>. The kafka version is 0.10.1.0.</p>\n\n<p>Here is the configuration of my consumer:</p>\n\n<pre><code>kafkaClient, err := kafka.NewConsumer(&amp;kafka.ConfigMap{\n    \"bootstrap.servers\":               broker,\n    \"group.id\":                       \"udwg20\",\n    \"session.timeout.ms\":              60000,\n    \"go.events.channel.enable\":        true,\n    \"go.application.rebalance.enable\": true,\n    \"default.topic.config\": kafka.ConfigMap{\n        \"auto.offset.reset\":      \"earliest\",\n        \"enable.auto.commit\":      true,\n        \"auto.commit.interval.ms\": 10000}})\n</code></pre>\n\n<p>At the beginning, all current-offset and lag was showed, but after running several hours, the offset and lag of some partitions (which are not received any new message) become unknown. If there is a message come to a partition which its offset and lag are unknown, the offset and lag will be visible again, and the message will be consumed.</p>\n\n<p>When there are some partitions with unknown current-offset and lag, I restart the consumer, at this time, all current partitions with unknown current-offset and lag status will be consumed again from beginning, but other partitions seem to run normally.</p>\n\n<p>I also used a python consumer that consumes message from this topic with a different consumer group id. the python consumer seem to work well without any partition which has unknown current-offset and lag.</p>\n"}, {"tags": ["amazon-web-services", "go", "amazon-ses"], "comments": [{"owner": {"reputation": 28754, "user_id": 1153938, "user_type": "registered", "accept_rate": 73, "profile_image": "https://i.stack.imgur.com/deBjQ.jpg?s=128&g=1", "display_name": "Vorsprung", "link": "https://stackoverflow.com/users/1153938/vorsprung"}, "edited": false, "score": 0, "creation_date": 1538459525, "post_id": 52601404, "comment_id": 92139409, "body": "Need more detail in your question.  Maybe show part of your program?  Do you think the error comes from the client or the server?  Can you provoke similar errors with tools like openssl s_client?"}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 4, "creation_date": 1538460413, "post_id": 52601404, "comment_id": 92139684, "body": "Make sure the <code>ca-certificates</code> package is installed on your instance. After installing restart your Go programs."}, {"owner": {"reputation": 339, "user_id": 597546, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CPxsU.jpg?s=128&g=1", "display_name": "Shane Da Silva", "link": "https://stackoverflow.com/users/597546/shane-da-silva"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1538492859, "post_id": 52601404, "comment_id": 92156748, "body": "@Peter Thanks Peter, that&#39;s all I was missing!"}, {"owner": {"reputation": 43265, "user_id": 8016720, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/bXsod.png?s=128&g=1", "display_name": "John Hanley", "link": "https://stackoverflow.com/users/8016720/john-hanley"}, "reply_to_user": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1538501697, "post_id": 52601404, "comment_id": 92161426, "body": "@Peter - Post your comment with more details as an answer. This will help others understand what this error means."}], "answers": [{"comments": [{"owner": {"reputation": 347, "user_id": 1676883, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/69188146d02c70bc8656911ca27b9fc6?s=128&d=identicon&r=PG", "display_name": "Crazometer", "link": "https://stackoverflow.com/users/1676883/crazometer"}, "edited": false, "score": 0, "creation_date": 1549600897, "post_id": 53590802, "comment_id": 95968780, "body": "Thanks, this helped me. If you&#39;re not using a multi stage docker file you can just add <code>RUN apk add -U --no-cache ca-certificates</code>"}, {"owner": {"reputation": 663, "user_id": 1736000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bKynP.jpg?s=128&g=1", "display_name": "KorbenDallas", "link": "https://stackoverflow.com/users/1736000/korbendallas"}, "reply_to_user": {"reputation": 1185, "user_id": 1520421, "user_type": "registered", "accept_rate": 15, "profile_image": "https://www.gravatar.com/avatar/5a4e98bb784ee939598e7b93705f3eaf?s=128&d=identicon&r=PG", "display_name": "Dattatray", "link": "https://stackoverflow.com/users/1520421/dattatray"}, "edited": false, "score": 0, "creation_date": 1575823965, "post_id": 53590802, "comment_id": 104686776, "body": "@Dattatray sudo apt-get install ca-certificates -y"}, {"owner": {"reputation": 3806, "user_id": 1335793, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/jnl3V.png?s=128&g=1", "display_name": "Davos", "link": "https://stackoverflow.com/users/1335793/davos"}, "edited": false, "score": 1, "creation_date": 1586830982, "post_id": 53590802, "comment_id": 108266434, "body": "Debian/Ubuntu: <code>apt-get update &amp;&amp; apt-get install -y --no-install-recommends ca-certificates</code> and if using a multi-stage then copy to the same location. This answer on serverfault has a good list of expected locations for other linux distros <a href=\"https://serverfault.com/a/722646/443669\">serverfault.com/a/722646/443669</a>"}], "tags": [], "owner": {"reputation": 663, "user_id": 1736000, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bKynP.jpg?s=128&g=1", "display_name": "KorbenDallas", "link": "https://stackoverflow.com/users/1736000/korbendallas"}, "is_accepted": false, "score": 8, "last_activity_date": 1543829344, "creation_date": 1543829344, "answer_id": 53590802, "question_id": 52601404, "link": "https://stackoverflow.com/questions/52601404/aws-ses-error-x509-certificate-signed-by-unknown-authority/53590802#53590802", "title": "AWS SES Error: x509: certificate signed by unknown authority", "body": "<p>If you are using <code>alpine docker image</code> for example:</p>\n\n<pre><code>FROM alpine:3.6 as alpine\n\nRUN apk add -U --no-cache ca-certificates\n\nFROM scratch\nCOPY --from=alpine /etc/ssl/certs/ca-certificates.crt /etc/ssl/certs/\n</code></pre>\n\n<p>After adding root certificates <code>ca-certificates</code>, it will be working fine.</p>\n"}], "owner": {"reputation": 339, "user_id": 597546, "user_type": "registered", "accept_rate": 43, "profile_image": "https://i.stack.imgur.com/CPxsU.jpg?s=128&g=1", "display_name": "Shane Da Silva", "link": "https://stackoverflow.com/users/597546/shane-da-silva"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 3982, "favorite_count": 0, "answer_count": 1, "score": 2, "last_activity_date": 1543829344, "creation_date": 1538448996, "last_edit_date": 1538532982, "question_id": 52601404, "link": "https://stackoverflow.com/questions/52601404/aws-ses-error-x509-certificate-signed-by-unknown-authority", "title": "AWS SES Error: x509: certificate signed by unknown authority", "body": "<p>I've been banging my head against the table with this one for a while now. I'm. I've successfully sent emails locally using an AWS access key and secret that has full access. Once I deploy to my staging environment I get an error using the same access key and secret.</p>\n\n<p><code>RequestError: send request failed\\ncaused by: Post https://email.us-east-1.amazonaws.com/: x509: certificate signed by unknown authority</code></p>\n\n<p>Please help!</p>\n"}, {"tags": ["go"], "answers": [{"comments": [{"owner": {"reputation": 1027, "user_id": 737172, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9c600702dddd78163b73952749b0240a?s=128&d=identicon&r=PG", "display_name": "pvd", "link": "https://stackoverflow.com/users/737172/pvd"}, "edited": false, "score": 0, "creation_date": 1538449001, "post_id": 52601234, "comment_id": 92137133, "body": "Thanks, any detail to use it as global config?"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "reply_to_user": {"reputation": 1027, "user_id": 737172, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9c600702dddd78163b73952749b0240a?s=128&d=identicon&r=PG", "display_name": "pvd", "link": "https://stackoverflow.com/users/737172/pvd"}, "edited": false, "score": 1, "creation_date": 1538467094, "post_id": 52601234, "comment_id": 92142403, "body": "@pvd: Don&#39;t use global config. Use dependency injection as described in this answer."}, {"owner": {"reputation": 1027, "user_id": 737172, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9c600702dddd78163b73952749b0240a?s=128&d=identicon&r=PG", "display_name": "pvd", "link": "https://stackoverflow.com/users/737172/pvd"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1538634917, "post_id": 52601234, "comment_id": 92213232, "body": "@Flimzy Why not global config? If it&#39;s a large project with more than 1000 functions, we would not to want every function has a parameter to pass the log handler."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1538720474, "post_id": 52601234, "comment_id": 92249089, "body": "1. Because globals are dangerous. 2. Passing an argument isn&#39;t the only way to do dependency injection. Make your config part of a struct, and call methods on that struct instead."}, {"owner": {"reputation": 1027, "user_id": 737172, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9c600702dddd78163b73952749b0240a?s=128&d=identicon&r=PG", "display_name": "pvd", "link": "https://stackoverflow.com/users/737172/pvd"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1539247823, "post_id": 52601234, "comment_id": 92435063, "body": "@Flimzy Any example or tutorial link? I just google and find that other guys doesn&#39;t support the context solution. <a href=\"https://www.reddit.com/r/golang/comments/5ovkut/sharing_loggers_across_contexts_and_packages/dcmkxj3/\" rel=\"nofollow noreferrer\">reddit.com/r/golang/comments/5ovkut/&hellip;</a> ,"}, {"owner": {"reputation": 1748, "user_id": 4106031, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NM3jO.jpg?s=128&g=1", "display_name": "Alok Kumar Singh", "link": "https://stackoverflow.com/users/4106031/alok-kumar-singh"}, "edited": false, "score": 0, "creation_date": 1592561470, "post_id": 52601234, "comment_id": 110475747, "body": "I think adding a solution like <a href=\"https://github.com/practo/k8s-worker-pod-autoscaler/blob/master/cmd/workerpodautoscaler/main.go#L31\" rel=\"nofollow noreferrer\">github.com/practo/k8s-worker-pod-autoscaler/blob/master/cmd/&zwnj;&#8203;&hellip;</a> could be more helpful, passing to all functions will make the code very bad."}], "tags": [], "owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "is_accepted": false, "score": 1, "last_activity_date": 1538447206, "creation_date": 1538447206, "answer_id": 52601234, "question_id": 52601156, "link": "https://stackoverflow.com/questions/52601156/how-to-make-golangs-logrus-share-the-same-config-through-several-files/52601234#52601234", "title": "How to make golang&#39;s Logrus share the same config through several files?", "body": "<p>You can do so by passing your logger to your structs / functions.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"github.com/sirupsen/logrus\"\n    \"logrusdemo/mylib\"\n)\n\nfunc main() {\n    log = logrus.New()\n\n    var filename string = \"logfile.log\"\n    f, err := os.OpenFile(filename, os.O_WRONLY|os.O_APPEND|os.O_CREATE, 0644)\n\n    Formatter := new(log.TextFormatter)\n    Formatter.TimestampFormat = \"02-01-2006 15:04:05\"\n    Formatter.FullTimestamp = true\n    log.SetFormatter(Formatter)\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        log.SetOutput(f)\n    }\n\n    log.Info(\"Some info. Earth is not flat\")\n    log.Warning(\"This is a warning\")\n    log.Error(\"Not fatal. An error. Won't stop execution\")\n\n    fmt.Printf(\"%v\", mylib.GetTestA(log))\n    fmt.Printf(\"%v\", mylib.GetTestB(log))\n}\n</code></pre>\n\n<p>And</p>\n\n<pre><code>package mylib\n\nimport (\n    \"github.com/sirupsen/logrus\"\n)\n\n// GetTestA testing\nfunc GetTestA(log *logrus.Logger) string {\n    log.Info(\"entering aa.go\")\n    return \"001\"\n}\n</code></pre>\n\n<p>If you don't want to pass it as an argument, you can also pass your logger in a context, or use it as a global.</p>\n"}], "owner": {"reputation": 1027, "user_id": 737172, "user_type": "registered", "accept_rate": 93, "profile_image": "https://www.gravatar.com/avatar/9c600702dddd78163b73952749b0240a?s=128&d=identicon&r=PG", "display_name": "pvd", "link": "https://stackoverflow.com/users/737172/pvd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 891, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538447206, "creation_date": 1538446517, "question_id": 52601156, "link": "https://stackoverflow.com/questions/52601156/how-to-make-golangs-logrus-share-the-same-config-through-several-files", "title": "How to make golang&#39;s Logrus share the same config through several files?", "body": "<p>The plain demo code works as they integrated the Logrus's config and the logic of <code>main</code>, as follows</p>\n\n<pre><code>func main() {\n    var filename string = \"logfile.log\"\n    f, err := os.OpenFile(filename, os.O_WRONLY|os.O_APPEND|os.O_CREATE, 0644)\n    Formatter := new(log.TextFormatter)\n    Formatter.TimestampFormat = \"02-01-2006 15:04:05\"\n    Formatter.FullTimestamp = true\n    log.SetFormatter(Formatter)\n    if err != nil {\n        fmt.Println(err)\n    } else {\n        log.SetOutput(f)\n    }\n\n    log.Info(\"Some info. Earth is not flat\")\n    log.Warning(\"This is a warning\")\n    log.Error(\"Not fatal. An error. Won't stop execution\")\n}\n</code></pre>\n\n<p>But in real world, the config of logrus should be seperated into individual file, consider the file structure as :</p>\n\n<pre><code>logrusdemo/\n\u251c\u2500\u2500 main.go\n\u2514\u2500\u2500 mylib\n    \u251c\u2500\u2500 aa.go\n    \u2514\u2500\u2500 bb.go\n</code></pre>\n\n<p>And I want to share the same config in these files:</p>\n\n<p>The source code of <code>aa.go</code>:</p>\n\n<pre><code>package mylib\n\n// GetTestA testing\nfunc GetTestA() string {\n    //log.info(\"entering aa.go\")\n    return \"001\"\n}\n</code></pre>\n\n<p>The source code of <code>bb.go</code>:</p>\n\n<pre><code>package mylib\n\n// GetTestB testing\nfunc GetTestB() string {\n    //log.info(\"entering bb.go\")\n    return \"001\"\n}\n</code></pre>\n\n<p>The source code of <code>main.go</code>:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"logrusdemo/mylib\"\n)\n\nfunc main() {\n    //log.info(\"entering main\")\n    fmt.Printf(\"%v\", mylib.GetTestA())\n    fmt.Printf(\"%v\", mylib.GetTestB())\n}\n</code></pre>\n\n<p>I was wondering how to make logrus works in this situation?</p>\n"}, {"tags": ["elasticsearch", "go"], "answers": [{"comments": [{"owner": {"reputation": 365, "user_id": 3164768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/72da7503fc5fb7e6cb91e0f4668798a2?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy", "link": "https://stackoverflow.com/users/3164768/jimmy"}, "edited": false, "score": 1, "creation_date": 1538453937, "post_id": 52601266, "comment_id": 92138083, "body": "I tried but I got the following error on compile.  <code>cannot use ihids (type []int) as type []interface {} in argument to elastic.NewTermsQuery</code>  I found somehow a way to fix it by looking at this blog, though I don&#39;t really understand what it does... <a href=\"https://www.cnblogs.com/xdao/p/9262293.html\" rel=\"nofollow noreferrer\">cnblogs.com/xdao/p/9262293.html</a>"}, {"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "reply_to_user": {"reputation": 365, "user_id": 3164768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/72da7503fc5fb7e6cb91e0f4668798a2?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy", "link": "https://stackoverflow.com/users/3164768/jimmy"}, "edited": false, "score": 0, "creation_date": 1538465388, "post_id": 52601266, "comment_id": 92141638, "body": "Well they&#39;re doing exactly what I said: <code>status := ToInterfaceSlice([]int{1,2}) query = query.Filter(elastic.NewTermsQuery(&quot;status&quot;,status... )</code>, adding <code>...</code> after the slice that is passed to split it into variadic parameters."}], "tags": [], "owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "is_accepted": false, "score": 0, "last_activity_date": 1538447479, "creation_date": 1538447479, "answer_id": 52601266, "question_id": 52601123, "link": "https://stackoverflow.com/questions/52601123/how-to-pass-array-to-elasticsearchs-newtermsquery-in-golang/52601266#52601266", "title": "How to pass array to Elasticsearch&#39;s NewTermsQuery in Golang?", "body": "<p>You can simply fix it by adding <code>...</code> after your <code>ihids</code> argument like this:</p>\n\n<pre><code>query := elastic.NewBoolQuery()\nquery = query.Must(elastic.NewRangeQuery(\"sales_start_date\").Gte(date).TimeZone(\"+09:00\"))\nquery = query.Filter(elastic.NewTermsQuery(\"item_holder_id\", ihids...))\n</code></pre>\n\n<p>And for an explanation on how that works, this is from the <a href=\"http://golang.org/ref/spec\" rel=\"nofollow noreferrer\">golang spec</a>:</p>\n\n<blockquote>\n  <p>If f is variadic with final parameter type ...T, then within the\n  function the argument is equivalent to a parameter of type []T. At\n  each call of f, the argument passed to the final parameter is a new\n  slice of type []T whose successive elements are the actual arguments,\n  which all must be assignable to the type T.</p>\n</blockquote>\n"}, {"tags": [], "owner": {"reputation": 1288, "user_id": 7225929, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/fa26a9a36b086d9872cbe4c70355dfd3?s=128&d=identicon&r=PG&f=1", "display_name": "omotto", "link": "https://stackoverflow.com/users/7225929/omotto"}, "is_accepted": false, "score": 7, "last_activity_date": 1551956144, "creation_date": 1551956144, "answer_id": 55042111, "question_id": 52601123, "link": "https://stackoverflow.com/questions/52601123/how-to-pass-array-to-elasticsearchs-newtermsquery-in-golang/55042111#55042111", "title": "How to pass array to Elasticsearch&#39;s NewTermsQuery in Golang?", "body": "<p>in order to complete the @Ullaakut answer:</p>\n\n<pre><code>// Convert type []int to type []interface{}\n\nstatus := make([]interface{}, len(ihids))\nfor index, value := range ihids {\n    status[index] = value\n}\n\n// Ullaakut aswer\n\nquery := elastic.NewBoolQuery()\nquery = query.Must(elastic.NewRangeQuery(\"sales_start_date\").Gte(date).TimeZone(\"+09:00\"))\nquery = query.Filter(elastic.NewTermsQuery(\"item_holder_id\", status...))\n</code></pre>\n\n<p>I had the same issue and I solved on this way.</p>\n"}, {"comments": [{"owner": {"reputation": 1289, "user_id": 8333554, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/MvQ83.jpg?s=128&g=1", "display_name": "DCCoder", "link": "https://stackoverflow.com/users/8333554/dccoder"}, "edited": false, "score": 2, "creation_date": 1601656743, "post_id": 64173747, "comment_id": 113483353, "body": "Generally, answers are much more helpful if they include an explanation of what the code is intended to do, and why that solves the problem without introducing others."}], "tags": [], "owner": {"reputation": 11, "user_id": 14380449, "user_type": "unregistered", "profile_image": "https://www.gravatar.com/avatar/fede889f39b339cd1a710b1ee7fa1661?s=128&d=identicon&r=PG", "display_name": "Claire", "link": "https://stackoverflow.com/users/14380449/claire"}, "is_accepted": false, "score": 1, "last_activity_date": 1601650590, "creation_date": 1601650590, "answer_id": 64173747, "question_id": 52601123, "link": "https://stackoverflow.com/questions/52601123/how-to-pass-array-to-elasticsearchs-newtermsquery-in-golang/64173747#64173747", "title": "How to pass array to Elasticsearch&#39;s NewTermsQuery in Golang?", "body": "<pre><code>    values := make([]interface{}, len(status))\n    for i, v := range status {\n        values[i] = v\n    }\n    query = query.Filter(elastic.NewTermsQuery(&quot;item_holder_id&quot;, values...))\n</code></pre>\n"}], "owner": {"reputation": 365, "user_id": 3164768, "user_type": "registered", "accept_rate": 50, "profile_image": "https://www.gravatar.com/avatar/72da7503fc5fb7e6cb91e0f4668798a2?s=128&d=identicon&r=PG&f=1", "display_name": "jimmy", "link": "https://stackoverflow.com/users/3164768/jimmy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2388, "favorite_count": 1, "answer_count": 3, "score": 7, "last_activity_date": 1601650590, "creation_date": 1538446149, "last_edit_date": 1538447318, "question_id": 52601123, "link": "https://stackoverflow.com/questions/52601123/how-to-pass-array-to-elasticsearchs-newtermsquery-in-golang", "title": "How to pass array to Elasticsearch&#39;s NewTermsQuery in Golang?", "body": "<p>I want to implement the following Elasticsearch query using Golang.</p>\n\n<pre><code>{\n  \"query\": {\n    \"bool\": {\n      \"must\": {\n        \"range\": { \"sales_start_date\": { \"gte\": \"2018-07-01T00:00:00.000Z\" } }\n      },\n      \"filter\": {\n        \"terms\": { \"item_holder_id\": [2, 7, 9] }\n      }\n    }\n  }\n}\n'\n</code></pre>\n\n<p>My current code is the following (I am using <a href=\"http://github.com/olivere/elastic\" rel=\"noreferrer\">http://github.com/olivere/elastic</a> library).</p>\n\n<pre><code>query := elastic.NewBoolQuery()\nquery = query.Must(elastic.NewRangeQuery(\"sales_start_date\").Gte(date).TimeZone(\"+09:00\"))\nquery = query.Filter(elastic.NewTermsQuery(\"item_holder_id\", ihids))\n</code></pre>\n\n<p>with ihids being an <code>[]int</code>. \nWhen I execute this code I got the error</p>\n\n<pre><code>elastic: Error 400 (Bad Request): [terms] unknown token [END_ARRAY] after [item_holder_id] [type=parsing_exception]\n</code></pre>\n\n<p>After some research I found out that I need to write this like this</p>\n\n<pre><code>elastic.NewTermsQuery(\"item_holder_id\", \"1\", \"2\")\n</code></pre>\n\n<p>but being new to Golang I guess I am missing some of the basic concepts. How can I pass an array of values like this?</p>\n\n<p>Thank you for any information that can help me!</p>\n"}, {"tags": ["go", "amazon-elastic-beanstalk"], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4520325, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-G_Jb964IV7M/AAAAAAAAAAI/AAAAAAAAAK8/pNwlHr6zlkg/photo.jpg?sz=128", "display_name": "4lbertyson", "link": "https://stackoverflow.com/users/4520325/4lbertyson"}, "is_accepted": false, "score": 3, "last_activity_date": 1545179889, "last_edit_date": 1545179889, "creation_date": 1545171462, "answer_id": 53841924, "question_id": 52600975, "link": "https://stackoverflow.com/questions/52600975/cant-deploy-go-lang-app-to-aws-elastic-beanstalk/53841924#53841924", "title": "Can&#39;t deploy go lang app to AWS Elastic Beanstalk", "body": "<p>As you can see in your error message:</p>\n\n<p>Unable to launch application as the source bundle does not contain a Buildfile, Procfile or an executable.</p>\n\n<p>Your Procfile, Buildfile and build.sh should be in the root of the project, like this:</p>\n\n<pre><code>\u251c\u2500\u2500 app\n\u2502   \u251c\u2500\u2500 main.go\n\u2502   Procfile\n\u2502   Buildfile\n\u2502   build.sh\n</code></pre>\n"}], "owner": {"reputation": 844, "user_id": 1086315, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/14a3c7a16a306c022186f7336de00b85?s=128&d=identicon&r=PG", "display_name": "Tyler Zika", "link": "https://stackoverflow.com/users/1086315/tyler-zika"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1188, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1545179889, "creation_date": 1538444554, "last_edit_date": 1538444872, "question_id": 52600975, "link": "https://stackoverflow.com/questions/52600975/cant-deploy-go-lang-app-to-aws-elastic-beanstalk", "title": "Can&#39;t deploy go lang app to AWS Elastic Beanstalk", "body": "<p>Here is how my files are organized before I zip the file.</p>\n\n<pre><code>\u251c\u2500\u2500 app\n\u2502   \u251c\u2500\u2500 main.go\n\u2502   \u251c\u2500\u2500 Procfile\n\u2502   \u251c\u2500\u2500 Buildfile\n\u2502   \u251c\u2500\u2500 build.sh\n</code></pre>\n\n<p>Buildfile</p>\n\n<pre><code>make: ./build.sh\n</code></pre>\n\n<p>build.sh</p>\n\n<pre><code>#!/usr/bin/env bash\n\n# Install dependencies.\ngo get ./...\n\n# Build app\ngo build ./ -o bin/application\n</code></pre>\n\n<p>Procfile</p>\n\n<pre><code>web: bin/application\n</code></pre>\n\n<p>The error I get</p>\n\n<blockquote>\n  <p>[Instance: i-03f3c230e7b575431] Command failed on instance. Return code: 1 Output: (TRUNCATED)... inflating: /var/app/staging/app/main.go Unable to launch application as the source bundle does not contain a Buildfile, Procfile or an executable. Unable to launch application as the source bundle does not contain a Buildfile, Procfile or an executable. Hook /opt/elasticbeanstalk/hooks/appdeploy/pre/01_configure_application.sh failed. For more detail, check /var/log/eb-activity.log using console or EB CLI.</p>\n</blockquote>\n\n<p>More error logs</p>\n\n<pre><code>Application update failed at 2018-10-02T01:33:44Z with exit status 1 and error: Hook /opt/elasticbeanstalk/hooks/appdeploy/pre/01_configure_application.sh failed.\n\nExecuting: /usr/bin/unzip -o -d /var/app/staging /opt/elasticbeanstalk/deploy/appsource/source_bundle\nArchive: /opt/elasticbeanstalk/deploy/appsource/source_bundle\ncreating: /var/app/staging/app/\ninflating: /var/app/staging/app/Buildfile\ninflating: /var/app/staging/app/build.sh\ninflating: /var/app/staging/app/Procfile\ninflating: /var/app/staging/app/main.go\nUnable to launch application as the source bundle does not contain a Buildfile, Procfile or an executable.\nUnable to launch application as the source bundle does not contain a Buildfile, Procfile or an executable.\nIncorrect application version \".01\" (deployment 29). Expected version \".01\" (deployment 18).\n</code></pre>\n\n<p>My main.go file has third-party packages. I'm using</p>\n\n<pre><code>port := os.Getenv(\"PORT\")\nif port == \"\" {\n    port = \"5000\"\n    log.Println(\"[-] No PORT environment variable detected. Setting to \", port)\n}\n</code></pre>\n\n<p>like the docs say in the example app. It compiles and runes locally no problem.</p>\n"}, {"tags": ["go", "go-modules"], "answers": [{"comments": [{"owner": {"reputation": 82600, "user_id": 496445, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/db00d7b4388686c6d280e8f0578c7e39?s=128&d=identicon&r=PG", "display_name": "jdi", "link": "https://stackoverflow.com/users/496445/jdi"}, "edited": false, "score": 0, "creation_date": 1538943596, "post_id": 52677171, "comment_id": 92311882, "body": "I suppose this is the best and most official position available. Thanks for that."}], "tags": [], "owner": {"reputation": 1866, "user_id": 5405453, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Me0YP.jpg?s=128&g=1", "display_name": "nijm", "link": "https://stackoverflow.com/users/5405453/nijm"}, "is_accepted": true, "score": 1, "last_activity_date": 1538815047, "last_edit_date": 1538815047, "creation_date": 1538814535, "answer_id": 52677171, "question_id": 52600915, "link": "https://stackoverflow.com/questions/52600915/flatten-vendored-transitive-dependencies-of-primary-dependency/52677171#52677171", "title": "Flatten vendored transitive dependencies of primary dependency", "body": "<p>It just currently doesn't work that way, only the top level vendor directory is used. From the <a href=\"https://golang.org/cmd/go/#hdr-Modules_and_vendoring\" rel=\"nofollow noreferrer\">modules help</a>:</p>\n\n<blockquote>\n  <p>To build using the main module's top-level vendor directory to satisfy\n  dependencies (disabling use of the usual network sources and local\n  caches), use 'go build -mod=vendor'. Note that only the main module's\n  top-level vendor directory is used; vendor directories in other\n  locations are still ignored.</p>\n</blockquote>\n\n<p>For this specific use case I would recommend waiting until <code>go modules</code> matures.</p>\n"}], "owner": {"reputation": 82600, "user_id": 496445, "user_type": "registered", "accept_rate": 97, "profile_image": "https://www.gravatar.com/avatar/db00d7b4388686c6d280e8f0578c7e39?s=128&d=identicon&r=PG", "display_name": "jdi", "link": "https://stackoverflow.com/users/496445/jdi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 422, "favorite_count": 2, "accepted_answer_id": 52677171, "answer_count": 1, "score": 6, "last_activity_date": 1538815047, "creation_date": 1538443853, "last_edit_date": 1538683093, "question_id": 52600915, "link": "https://stackoverflow.com/questions/52600915/flatten-vendored-transitive-dependencies-of-primary-dependency", "title": "Flatten vendored transitive dependencies of primary dependency", "body": "<p>I have been converting existing projects from using vendored dependencies via <a href=\"https://glide.sh/\" rel=\"noreferrer\">Glide</a>, to using the Go 1.11.x <a href=\"https://github.com/golang/go/wiki/Modules\" rel=\"noreferrer\">module support</a>. But I am hitting a particular case in one project using modules that I cannot solve.</p>\n\n<p>Internal project 'foo' has its dependencies vendored via \"go mod vendor\":</p>\n\n<pre><code>projects/src/foo/\n    main.go\n    vendor/\n        ...\n</code></pre>\n\n<p>This works great when building that project internally since a non-go developer can clone the project to any location and build it, with no external proxy access needed to download dependencies. </p>\n\n<p>Now I am trying to allow project 'bar' to build a tool using library 'foo'.</p>\n\n<pre><code>package bar\n\nimport \"internal.com/project/foo\"\n</code></pre>\n\n<p>The \"go.mod\" file only contains:</p>\n\n<pre><code>module internal.com/project/bar\n\nrequire internal.com/project/foo v0.0.0-...\n</code></pre>\n\n<p>I would vendor via:</p>\n\n<pre><code>go module vendor\n</code></pre>\n\n<p>And I build via:</p>\n\n<pre><code>go build -mod=vendor\n</code></pre>\n\n<p>What I am seeing is that 'foo' will be cloned from the internal git repo, and all of its dependencies will be downloaded from their remote git origins, and my 'go.sum' file is updated with all of the transient dependencies. But what I <em>really</em> want is to only fetch 'foo' from my internal network and to have it flatten the vendored dependencies. Ideally, there should be no external http requests.</p>\n\n<p>Is this even possible? The \"-mod=vendor\" flag was very useful when building project \"foo\" directly. But it doesn't seem to apply here because project \"bar\" doesn't want to vendor. It wants to get the one primary dependency and that is it. It would seem that Go module support doesn't care about flattening vendored transient dependencies.</p>\n\n<p>Previous when using <code>glide</code> as the package manager, it would fetch 'foo' from the internal git repo and then flatten all of its dependencies into my vendor directory.</p>\n\n<p><em>Originally posted as a <a href=\"https://groups.google.com/d/topic/golang-nuts/W8M4nOl54KQ/discussion\" rel=\"noreferrer\">question to golang-nuts</a>, without reply.</em></p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1538444624, "post_id": 52600873, "comment_id": 92136286, "body": "Could you show the code you&#39;re using to create and receive these values?"}, {"owner": {"reputation": 167, "user_id": 5697145, "user_type": "registered", "profile_image": "https://graph.facebook.com/736343576496500/picture?type=large", "display_name": "Minh Thu\u1eadn", "link": "https://stackoverflow.com/users/5697145/minh-thu%e1%ba%adn"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1538447422, "post_id": 52600873, "comment_id": 92136837, "body": "I&#39;m using mgo, Ex: ``` userCol.FindId(userID).One(&amp;result) ```"}, {"owner": {"reputation": 167, "user_id": 5697145, "user_type": "registered", "profile_image": "https://graph.facebook.com/736343576496500/picture?type=large", "display_name": "Minh Thu\u1eadn", "link": "https://stackoverflow.com/users/5697145/minh-thu%e1%ba%adn"}, "reply_to_user": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 0, "creation_date": 1538447503, "post_id": 52600873, "comment_id": 92136851, "body": "I think it&#39;s depend the way go lang marshal json time.Time"}, {"owner": {"reputation": 126343, "user_id": 14660, "user_type": "registered", "accept_rate": 62, "profile_image": "https://www.gravatar.com/avatar/e55e0ec3c00f834d78fbdddeaa36e308?s=128&d=identicon&r=PG", "display_name": "Schwern", "link": "https://stackoverflow.com/users/14660/schwern"}, "edited": false, "score": 1, "creation_date": 1538448800, "post_id": 52600873, "comment_id": 92137102, "body": "Can you create a <a href=\"https://stackoverflow.com/help/mcve\">Minimal, Complete, and Verifiable example</a> that demonstrates the problem and <a href=\"https://stackoverflow.com/posts/52600873/edit\">edit the question</a> to include it?"}], "answers": [{"comments": [{"owner": {"reputation": 167, "user_id": 5697145, "user_type": "registered", "profile_image": "https://graph.facebook.com/736343576496500/picture?type=large", "display_name": "Minh Thu\u1eadn", "link": "https://stackoverflow.com/users/5697145/minh-thu%e1%ba%adn"}, "edited": false, "score": 0, "creation_date": 1538487753, "post_id": 52603256, "comment_id": 92153497, "body": "Thank you, this answer is so clear. You just saved my life =))"}], "tags": [], "owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "is_accepted": true, "score": 0, "last_activity_date": 1538463021, "creation_date": 1538463021, "answer_id": 52603256, "question_id": 52600873, "link": "https://stackoverflow.com/questions/52600873/how-can-i-response-time-milisecond-zero-in-json/52603256#52603256", "title": "How can I response time milisecond zero in json", "body": "<p>From golang.org/pkg/time/#Time.MarshalJSON: </p>\n\n<blockquote>\n  <p>The time is a quoted string in RFC 3339 format, with sub-second precision added if present.</p>\n</blockquote>\n\n<p>The zeros are insignificant, so they are omitted. If that doesn't work for you, implement your own MarshalJSON method:</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/json\"\n    \"fmt\"\n    \"time\"\n)\n\ntype MyType struct {\n    Foo       string\n    CreatedAt time.Time `json:\"-\" bson:\"createdAt\"`\n}\n\nfunc (t MyType) MarshalJSON() ([]byte, error) {\n    type MyType_ MyType // prevent recursion\n\n    return json.Marshal(struct {\n        MyType_\n        CreatedAt string `json:\"createdAt\"` // Override time field\n    }{\n        MyType_(t),\n        t.CreatedAt.Format(\"2006-01-02T15:04:05.000Z07:00\"),\n    })\n}\n\nfunc main() {\n    t := MyType{\n        Foo:       \"bar\",\n        CreatedAt: time.Date(2018, 10, 2, 12, 13, 14, 0, time.UTC),\n    }\n\n    b, err := json.MarshalIndent(t, \"\", \"  \")\n    fmt.Println(err, string(b))\n\n    t.CreatedAt = t.CreatedAt.Add(123456 * time.Microsecond)\n\n    b, err = json.MarshalIndent(t, \"\", \"  \")\n    fmt.Println(err, string(b))\n}\n\n// Output:\n// &lt;nil&gt; {\n//   \"Foo\": \"bar\",\n//   \"T\": \"2018-10-02T12:13:14.000Z\"\n// }\n// &lt;nil&gt; {\n//   \"Foo\": \"bar\",\n//   \"T\": \"2018-10-02T12:13:14.123Z\"\n// }\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/bmDk1pejGPS\" rel=\"nofollow noreferrer\">https://play.golang.org/p/bmDk1pejGPS</a></p>\n\n<p>If you have to do this in many places, it may be worthwhile to create your own time type (that will be inconvenient if you have to do date math, though):</p>\n\n<pre><code>type MyType struct {\n        Foo       string\n        CreatedAt MyTime `json:\"createdAt\" bson:\"createdAt\"`\n}\n\ntype MyTime struct {\n        time.Time\n}\n\nfunc (t MyTime) MarshalJSON() ([]byte, error) {\n        return json.Marshal(t.Format(\"2006-01-02T15:04:05.000Z07:00\"))\n}\n</code></pre>\n"}], "owner": {"reputation": 167, "user_id": 5697145, "user_type": "registered", "profile_image": "https://graph.facebook.com/736343576496500/picture?type=large", "display_name": "Minh Thu\u1eadn", "link": "https://stackoverflow.com/users/5697145/minh-thu%e1%ba%adn"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 70, "favorite_count": 0, "accepted_answer_id": 52603256, "answer_count": 1, "score": 0, "last_activity_date": 1538465275, "creation_date": 1538443393, "last_edit_date": 1538465275, "question_id": 52600873, "link": "https://stackoverflow.com/questions/52600873/how-can-i-response-time-milisecond-zero-in-json", "title": "How can I response time milisecond zero in json", "body": "<p>In my mongodb, I have field</p>\n\n<pre><code>\"createdAt\" : ISODate(\"2018-10-02T01:17:58.000Z\")\n</code></pre>\n\n<p>and I have struct have field </p>\n\n<pre><code>CreatedAt      time.Time       `json:\"createdAt\" bson:\"createdAt\"`\n</code></pre>\n\n<p>But when I response by json, it's missing zero milisecond\nI expected</p>\n\n<pre><code>\"createdAt\": \"2018-10-02T01:17:58.000Z\"\n</code></pre>\n\n<p>But received</p>\n\n<pre><code>\"createdAt\": \"2018-10-02T01:17:58Z\"\n</code></pre>\n"}, {"tags": ["go", "channel"], "answers": [{"tags": [], "owner": {"reputation": 12097, "user_id": 1080064, "user_type": "registered", "accept_rate": 43, "profile_image": "https://graph.facebook.com/100000753306178/picture?type=large", "display_name": "tkausl", "link": "https://stackoverflow.com/users/1080064/tkausl"}, "is_accepted": true, "score": 3, "last_activity_date": 1538443344, "creation_date": 1538443344, "answer_id": 52600868, "question_id": 52600835, "link": "https://stackoverflow.com/questions/52600835/how-to-iterate-over-channel-and-assign-as-reference/52600868#52600868", "title": "How to iterate over channel and assign as reference", "body": "<p>This has nothing to do with channels. Check this code which has the same result:</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype myType struct {\n    myString string\n}\n\nfunc main() {\n    in := [2]myType{\n        myType{myString: \"string1\"},\n        myType{myString: \"string2\"},\n    }\n\n    var types []*myType\n\n    for _, element := range in {\n        types = append(types, &amp;element)\n    }\n\n    for _, element := range types {\n        fmt.Println(element.myString)\n    }\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/uf0r4yWmmHD\" rel=\"nofollow noreferrer\">Play</a></p>\n\n<p>The problem is that you're taking a pointer to <code>element</code>, a variable which will get a new value each time through the loop, <em>but the variable itself stays the same</em>, so all pointers you append to the slice point to the same value. To fix this, append values instead of pointers or create a temorary in your loop and push a pointer to the temporary instead</p>\n\n<pre><code>var types []myType\n\nfor element := range queue {\n    types = append(types, element)\n}\n</code></pre>\n\n<p>or</p>\n\n<pre><code>var types []*myType\n\nfor element := range queue {\n    tmp := element\n    types = append(types, &amp;tmp)\n}\n</code></pre>\n"}], "owner": {"reputation": 127, "user_id": 892960, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/1e84fb88c367cef82ae127b8c164750e?s=128&d=identicon&r=PG", "display_name": "user892960", "link": "https://stackoverflow.com/users/892960/user892960"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 152, "favorite_count": 0, "accepted_answer_id": 52600868, "answer_count": 1, "score": 0, "last_activity_date": 1538465285, "creation_date": 1538443003, "last_edit_date": 1538465285, "question_id": 52600835, "link": "https://stackoverflow.com/questions/52600835/how-to-iterate-over-channel-and-assign-as-reference", "title": "How to iterate over channel and assign as reference", "body": "<p>It seems assigning channel output to an array of pointers will always assign the last one sent to the channel <code>string2</code>. can anyone explain this behavior?</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n)\n\ntype myType struct {\n    myString string\n}\n\nfunc main() {\n    queue := make(chan myType, 2)\n    queue &lt;- myType{myString: \"string1\"}\n    queue &lt;- myType{myString: \"string2\"}\n    close(queue)\n\n    var types []*myType\n\n    for element := range queue {\n        types = append(types, &amp;element)\n    }\n\n    for _, element := range types {\n        fmt.Println(element.myString)\n    }\n}\n</code></pre>\n\n<p>results in:</p>\n\n<pre><code>result2\nresult2\n</code></pre>\n"}, {"tags": ["php", "go", "encryption", "openssl"], "comments": [{"owner": {"reputation": 1263, "user_id": 7099984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb73d10a9ce4b91379b514722601f9ee?s=128&d=identicon&r=PG&f=1", "display_name": "myxaxa", "link": "https://stackoverflow.com/users/7099984/myxaxa"}, "edited": false, "score": 0, "creation_date": 1538484110, "post_id": 52599885, "comment_id": 92151118, "body": "this one will help u - <a href=\"https://gist.github.com/cannium/c167a19030f2a3c6adbb5a5174bea3ff\" rel=\"nofollow noreferrer\">gist.github.com/cannium/c167a19030f2a3c6adbb5a5174bea3ff</a>"}, {"owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "reply_to_user": {"reputation": 1263, "user_id": 7099984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb73d10a9ce4b91379b514722601f9ee?s=128&d=identicon&r=PG&f=1", "display_name": "myxaxa", "link": "https://stackoverflow.com/users/7099984/myxaxa"}, "edited": false, "score": 0, "creation_date": 1538484355, "post_id": 52599885, "comment_id": 92151281, "body": "@myxaxa Lol that&#39;s literally what I have above, in fact, it&#39;s where I got my example from"}, {"owner": {"reputation": 1263, "user_id": 7099984, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cb73d10a9ce4b91379b514722601f9ee?s=128&d=identicon&r=PG&f=1", "display_name": "myxaxa", "link": "https://stackoverflow.com/users/7099984/myxaxa"}, "edited": false, "score": 0, "creation_date": 1538484517, "post_id": 52599885, "comment_id": 92151381, "body": "I know ^_^ but I wanted to point u on the key and the ciphertext length"}, {"owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "reply_to_user": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "edited": false, "score": 0, "creation_date": 1538485438, "post_id": 52599885, "comment_id": 92151895, "body": "@rustyx I&#39;ve added a literal example of actual code that doesn&#39;t work as I&#39;m expecting"}], "answers": [{"comments": [{"owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "edited": false, "score": 0, "creation_date": 1538488783, "post_id": 52609639, "comment_id": 92154195, "body": "I assure you I didn&#39;t write the entirety of the PHP implementation myself :) But I&#39;ll be damned, it totally works now. I&#39;ll admit I was quite under the assumption that <code>append</code> was returning a new slice pointing to a new array, but I guess it only does that if it needs to grow the array, and in this case, it wouldn&#39;t need to. Thank you for your amazing help :)!"}], "tags": [], "owner": {"reputation": 61409, "user_id": 485343, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/e18b024a122df74275dd2c4486e8a2b4?s=128&d=identicon&r=PG", "display_name": "rustyx", "link": "https://stackoverflow.com/users/485343/rustyx"}, "is_accepted": true, "score": 1, "last_activity_date": 1538487769, "creation_date": 1538487769, "answer_id": 52609639, "question_id": 52599885, "link": "https://stackoverflow.com/questions/52599885/aes-256-gcm-decryption-from-php-to-golang/52609639#52609639", "title": "aes-256-gcm decryption from PHP to Golang", "body": "<p>Normally an encrypted message looks like <code>IV+ciphertext+tag</code>, not <code>ciphertext+IV+tag</code>. When one deviates from the convention one runs into all kinds of issues :-)</p>\n\n<p>Have you seen what happens to the <code>iv</code> <em>slice</em> after the call <code>append(ciphertext, tag...)</code>?\nYou essentially overwrite the <code>iv</code> with the <code>tag</code>:</p>\n\n<pre><code>Before:\n924b3ba4 18f49edc1757f3fe88adcaa7ec4c1e7d 15811fd0b712b0b091433073f6a38d7b\nAfter:\n924b3ba4 15811fd0b712b0b091433073f6a38d7b 15811fd0b712b0b091433073f6a38d7b\n</code></pre>\n\n<p>As a quick fix, make a copy of the <code>iv</code> before calling <code>append()</code>:</p>\n\n<pre><code>iv := make([]byte, 16)\ncopy(iv, c[len(c)-32 : len(c)-16])\n</code></pre>\n\n<p>More info on slices can be found <a href=\"https://blog.golang.org/go-slices-usage-and-internals\" rel=\"nofollow noreferrer\">here</a>.</p>\n"}], "owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1111, "favorite_count": 0, "accepted_answer_id": 52609639, "answer_count": 1, "score": 1, "last_activity_date": 1538487769, "creation_date": 1538433924, "last_edit_date": 1538485417, "question_id": 52599885, "link": "https://stackoverflow.com/questions/52599885/aes-256-gcm-decryption-from-php-to-golang", "title": "aes-256-gcm decryption from PHP to Golang", "body": "<p>I have an encryption function that I use in PHP</p>\n\n<pre><code>function Encrypt(?string $Content, string $Key): string {\n    return openssl_encrypt($Content, 'aes-256-gcm', $Key, OPENSSL_RAW_DATA, $IV = random_bytes(16), $Tag, '', 16) . $IV . $Tag;\n}\n</code></pre>\n\n<p>Paired with a decryption function</p>\n\n<pre><code>function Decrypt(?string $Ciphertext, string $Key): ?string {\n    if (strlen($Ciphertext) &lt; 32)\n        return null;\n\n    $Content = substr($Ciphertext, 0, -32);\n    $IV = substr($Ciphertext, -32, -16);\n    $Tag = substr($Ciphertext, -16);\n\n    try {\n        return openssl_decrypt($Content, 'aes-256-gcm', $Key, OPENSSL_RAW_DATA, $IV, $Tag);\n    } catch (Exception $e) {\n        return null;\n    }\n}\n</code></pre>\n\n<p>I store data encrypted from the encryption function into my db, and now I'm trying to decrypt those same values in Go, but I'm getting <code>cipher: message authentication failed</code> and I can't figure out what I'm missing.</p>\n\n<pre><code>c := []byte(`encrypted bytes of sorts`) // the bytes from the db\n\ncontent := c[:len(c)-32]\niv := c[len(c)-32 : len(c)-16]\ntag := c[len(c)-16:]\n\nblock, err := aes.NewCipher(key[:32])\nif err != nil {\n    panic(err.Error())\n}\n\naesgcm, err := cipher.NewGCMWithNonceSize(block, 16)\nif err != nil {\n    panic(err.Error())\n}\n\nfmt.Println(aesgcm.NonceSize(), aesgcm.Overhead()) // making sure iv and tag are both 16 bytes\n\nplaintext, err := aesgcm.Open(nil, iv, append(content, tag...), nil)\nif err != nil {\n    panic(err.Error())\n}\n</code></pre>\n\n<p>It's worth noting that the key I'm using isn't 32 bytes (it's way bigger), as I didn't know the key needed/should be 32 bytes, so I'm not entirely sure what PHP is doing with it (as in truncating it to 32 vs hashing it with something having 32 bytes of output vs some other thing).</p>\n\n<p>Looking at the <code>Open</code> function from the Go source, it looks like the tag should be the last \"tag size\" bytes of the text, so that's why I'm appending the tag to the ciphertext after parsing the pieces.</p>\n\n<pre><code>// copied from C:\\Go\\src\\crypto\\cipher\\gcm.go, Go version 1.11\nfunc (g *gcm) Open(dst, nonce, ciphertext, data []byte) ([]byte, error) {\n    if len(nonce) != g.nonceSize {\n        panic(\"cipher: incorrect nonce length given to GCM\")\n    }\n\n    if len(ciphertext) &lt; gcmTagSize {\n        return nil, errOpen\n    }\n    if uint64(len(ciphertext)) &gt; ((1&lt;&lt;32)-2)*uint64(g.cipher.BlockSize())+gcmTagSize {\n        return nil, errOpen\n    }\n\n    tag := ciphertext[len(ciphertext)-gcmTagSize:]\n    ciphertext = ciphertext[:len(ciphertext)-gcmTagSize]\n\n    var counter, tagMask [gcmBlockSize]byte\n    g.deriveCounter(&amp;counter, nonce)\n\n    g.cipher.Encrypt(tagMask[:], counter[:])\n    gcmInc32(&amp;counter)\n\n    var expectedTag [gcmTagSize]byte\n    g.auth(expectedTag[:], ciphertext, data, &amp;tagMask)\n\n    ret, out := sliceForAppend(dst, len(ciphertext))\n\n    if subtle.ConstantTimeCompare(expectedTag[:], tag) != 1 {\n        // The AESNI code decrypts and authenticates concurrently, and\n        // so overwrites dst in the event of a tag mismatch. That\n        // behavior is mimicked here in order to be consistent across\n        // platforms.\n        for i := range out {\n            out[i] = 0\n        }\n        return nil, errOpen\n    }\n\n    g.counterCrypt(out, ciphertext, &amp;counter)\n\n    return ret, nil\n}\n</code></pre>\n\n<hr>\n\n<p>PHP example using the functions above</p>\n\n<pre><code>$Key = 'outspoken outburst treading cramp cringing';\n\necho bin2hex($Enc = Encrypt('yeet', $Key)), '&lt;br&gt;'; // 924b3ba418f49edc1757f3fe88adcaa7ec4c1e7d15811fd0b712b0b091433073f6a38d7b\nvar_export(Decrypt($Enc, $Key)); // 'yeet'\n</code></pre>\n\n<p>Go</p>\n\n<pre><code>c, err := hex.DecodeString(`924b3ba418f49edc1757f3fe88adcaa7ec4c1e7d15811fd0b712b0b091433073f6a38d7b`)\nif err != nil {\n    panic(err.Error())\n}\nkey := []byte(`outspoken outburst treading cramp cringing`)\n\ncontent := c[:len(c)-32]\niv := c[len(c)-32 : len(c)-16]\ntag := c[len(c)-16:]\n\nblock, err := aes.NewCipher(key[:32])\nif err != nil {\n    panic(err.Error())\n}\n\naesgcm, err := cipher.NewGCMWithNonceSize(block, 16)\nif err != nil {\n    panic(err.Error())\n}\n\nciphertext := append(content, tag...) // or `ciphertext := content`, same error\n\nplaintext, err := aesgcm.Open(nil, iv, ciphertext, nil)\nif err != nil {\n    panic(err.Error()) // panic: cipher: message authentication failed\n}\n</code></pre>\n"}, {"tags": ["go", "optimization", "memory-management"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538434312, "post_id": 52599876, "comment_id": 92134320, "body": "You mean like slices of a set length, like basically <code>make(map[int][Nmax]int)</code> ie an array of a given length? You can pre--allocate a map of a certain size, too using <code>make(map[int][]int, Nmax)</code>"}, {"owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538434545, "post_id": 52599876, "comment_id": 92134375, "body": "I don&#39;t know if this particular solution works for me because I need to count how many sites have a population <code>N</code> quickly. Checking the length of a slice is O(1) and checking how many non-zero values are in an array is O(n)."}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538486406, "post_id": 52599876, "comment_id": 92152541, "body": "I&#39;m getting an X-Y problem vibe here... why would there be a non-zero in the slice in the first place? Perhaps not exporting the field, and using an interface to get/set values allows you to defend against that. Just do a nil-value check in the setter and only append actual values, so you can rely on a <code>foo.Len()</code> call to just return <code>len(f.slice)</code>"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538487140, "post_id": 52599876, "comment_id": 92153065, "body": "Anyway, I posted an answer that, I think, solves the <code>len</code> problem, and cuts down on allocation calls without using an array (which is of a given length)"}], "answers": [{"tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1538462195, "last_edit_date": 1538462195, "creation_date": 1538461691, "answer_id": 52603024, "question_id": 52599876, "link": "https://stackoverflow.com/questions/52599876/how-to-allocate-memory-to-map-pointing-to-slice-in-golang/52603024#52603024", "title": "How to allocate memory to map pointing to slice in golang", "body": "<p>Your description of your problen is vague and you have not provided code to illustrate your problem.</p>\n\n<p>If the map slice capacity is equal to zero then set it to <code>Nmax</code>. For example,</p>\n\n<pre><code>package main\n\nimport \"fmt\"\n\nfunc main() {\n    Nmax := 42\n\n    m := make(map[int][]int, Nmax)\n\n    k, e := 7, 11\n    v := m[k]\n    if cap(v) == 0 {\n        v = make([]int, 0, Nmax)\n    }\n    m[k] = append(v, e)\n\n    v = m[k]\n    fmt.Println(k, len(v), cap(v), v)\n\n    fmt.Println(m)\n}\n</code></pre>\n\n<p>Playground: <a href=\"https://play.golang.org/p/csoUCUvVDAp\" rel=\"nofollow noreferrer\">https://play.golang.org/p/csoUCUvVDAp</a></p>\n\n<p>Output:</p>\n\n<pre><code>7 1 42 [11]\nmap[7:[11]]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "is_accepted": true, "score": 1, "last_activity_date": 1538487571, "last_edit_date": 1538487571, "creation_date": 1538487112, "answer_id": 52609441, "question_id": 52599876, "link": "https://stackoverflow.com/questions/52599876/how-to-allocate-memory-to-map-pointing-to-slice-in-golang/52609441#52609441", "title": "How to allocate memory to map pointing to slice in golang", "body": "<p>So given that your description of the problem is really rather vague, I'll just start by saying how I'd go about \"managing\" the map. To keep things simple, I'm going to wrap all the logic up in receiver functions, so wrapping the map up in a custom type:</p>\n\n<pre><code>type dataMap struct {\n    data map[int][]int\n    nmax int\n}\n\nfunc New(Nmax int) *dataMap {\n    return &amp;dataMap{\n        data: make(map[int][]int, Nmax),\n        nmax: Nmax,\n    }\n}\n\n// Get - return slice for given key\nfunc (d dataMap) Get(k int) []int {\n    s, ok := d.data[k]\n    if !ok {\n        return nil // optionally return error\n    }\n    return s\n}\n\n// Set - set/append values to a given key - this is not safe for concurrent use\n// if that's needed, add a RWMutex to the type\nfunc (d *dataMap) Set(k int, vals ...int) error {\n    s, ok := d.data[k]\n    if !ok {\n        s = make([]int, 0, d.nmax) // allocate slice of given length\n    }\n    // optionally check for nil-values + ensure we're not exceeding the nmax\n    checked := make([]int, 0, len(vals))\n    for i := range vals {\n        if vals[i] != 0 {\n            checked = append(checked, vals[i])\n        }\n    }\n    if len(s) + len(checked) &gt; d.nmax {\n        return errors.New(\"max capacity exceeded\")\n    }\n    s = append(s, checked...) // append values\n    d.data[k] = s // update map\n    return nil\n}\n</code></pre>\n\n<p>This cuts down on needless memory (re-)allocation calls. It also ensures that I can get the length of any slice in the map in an O(1) operation, without having to worry about nil values:</p>\n\n<pre><code>myData := New(10)\nfmt.Println(myData.Set(4, 1, 2, 3, 4))\nfmt.Println(len(myData.Get(4))) // 4\nfmt.Println(cap(myData.Get(4))) // 10\n// nil-values are filtered out\nmyData.Set(4, 5, 6, 7, 0, 0, 0, 0)\nfmt.Println(len(myData.Get(4))) // 7\nfmt.Println(cap(myData.Get(4))) // 10\n// exceeding capacity of 10\nfmt.Println(myData.Set(4, 8, 9, 10, 11)) // max capacity exceeded\n</code></pre>\n\n<h1>working <a href=\"https://play.golang.org/p/QJunbA3TP9S\" rel=\"nofollow noreferrer\">demo</a></h1>\n\n<hr>\n\n<p>You <em>could</em> manage the capacity by using an array instead of a slice, but that does require you to manually keep track of the index/offset at which you want to start appending values. Generally speaking, you don't use arrays in golang lest in very, very specific cases. In this case, I'd just opt for a slice with a set cap. The advantage of this is that you could, for example have slices of different lengths. The result is very easy to test, too, because a type like this lends itself quite well to replacing it with an interface type</p>\n\n<pre><code>type DataContainer interface {\n    Get(k int) []int\n    Set(k int, vals ...int) error\n    Declare(k, capacity int) error // error if k is already in use?\n}\n</code></pre>\n"}], "owner": {"reputation": 255, "user_id": 10347465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cf6002c0020b219420a37e125d167238?s=128&d=identicon&r=PG", "display_name": "kapaw", "link": "https://stackoverflow.com/users/10347465/kapaw"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 999, "favorite_count": 0, "accepted_answer_id": 52609441, "answer_count": 2, "score": 0, "last_activity_date": 1538487571, "creation_date": 1538433873, "question_id": 52599876, "link": "https://stackoverflow.com/questions/52599876/how-to-allocate-memory-to-map-pointing-to-slice-in-golang", "title": "How to allocate memory to map pointing to slice in golang", "body": "<p>Is there a way to allocate the memory of a map, which has at most <code>Nmax</code> keys, that points to a slice of maximum length <code>Nmax</code>? </p>\n\n<p>I'm currently just specifying the max number of keys via <code>make(map[int][]int,Nmax)</code>, but I'm not sure how to tell Go that each slice will be of maximum length <code>Nmax</code> because I don't know what the keys will be apriori.</p>\n\n<p>I essentially have a bunch of sites with an integer population. I use the map to keep track of how many sites have a given population <code>N</code>. The bottleneck in my program appears to be runtime.memmove, which I'm guessing comes from constant resizing of the slice the map points to. </p>\n"}, {"tags": ["nginx", "go", "fastcgi", "nginx-reverse-proxy"], "comments": [{"owner": {"reputation": 493, "user_id": 6111465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72fJG.png?s=128&g=1", "display_name": "gammazero", "link": "https://stackoverflow.com/users/6111465/gammazero"}, "edited": false, "score": 0, "creation_date": 1538443949, "post_id": 52599863, "comment_id": 92136168, "body": "Same situation discussed here: <a href=\"https://stackoverflow.com/questions/20251224/nginx-php-stop-process-at-canceled-request\" title=\"nginx php stop process at canceled request\">stackoverflow.com/questions/20251224/&hellip;</a>"}, {"owner": {"reputation": 362, "user_id": 1981862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/833cb9bf20c75da1dbee23965c6c3194?s=128&d=identicon&r=PG", "display_name": "Tony Bathgate", "link": "https://stackoverflow.com/users/1981862/tony-bathgate"}, "reply_to_user": {"reputation": 493, "user_id": 6111465, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/72fJG.png?s=128&g=1", "display_name": "gammazero", "link": "https://stackoverflow.com/users/6111465/gammazero"}, "edited": false, "score": 0, "creation_date": 1538494866, "post_id": 52599863, "comment_id": 92157930, "body": "@gammazero, Thanks that is useful information. But I think that answer is discussing the communication between the FCGI or FPM and the application code (or child process).  I think the break-down in our system is between NGINX and the Golang application which, in turn runs FCGI. I&#39;ll update my question to more accurately reflect our architecture."}], "owner": {"reputation": 362, "user_id": 1981862, "user_type": "registered", "accept_rate": 25, "profile_image": "https://www.gravatar.com/avatar/833cb9bf20c75da1dbee23965c6c3194?s=128&d=identicon&r=PG", "display_name": "Tony Bathgate", "link": "https://stackoverflow.com/users/1981862/tony-bathgate"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 1292, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538495418, "creation_date": 1538433753, "last_edit_date": 1538495418, "question_id": 52599863, "link": "https://stackoverflow.com/questions/52599863/are-requests-canceled-by-a-client-passed-through-nginx-to-the-fastcgi", "title": "Are requests canceled by a client passed through nginx to the fastcgi", "body": "<p>I'm using NGINX as a reverse proxy in conjunction with the <code>ngx_http_fastcgi_module</code>. It is proxying requests to a custom Golang FastCGI that executes a PHP-CGI process.</p>\n\n<p>There are requests that take an excessive amount of time because of some complex code that our customers are using. If the User clicks a different link while waiting for the request the browser cancels the previous request and NGINX sees it:</p>\n\n<pre><code>[info] 24#24: *1516 client 1.2.3.4 closed keepalive connection\n</code></pre>\n\n<p>which is great! But my upstream PHP-CGI process continues to run until it times out. This can consume a lot of resources if the user continues to click more links. I suspect my problem might be that NGINX isn't explicitly cancelling the upstream request. I've found the setting <a href=\"http://nginx.org/en/docs/http/ngx_http_fastcgi_module.html#fastcgi_ignore_client_abort\" rel=\"nofollow noreferrer\">fastcgi_ignore_client_abort</a> and it seems that by default it would <em>not</em> be ignored (which is good). It says:</p>\n\n<blockquote>\n  <p>Determines whether the connection with a proxied server should be closed when a client closes the connection without waiting for a response.</p>\n</blockquote>\n\n<p>Does that mean it's actually terminating the upstream request as well, or just ignoring the upstream request/response?</p>\n\n<p>And if it <em>should</em> be sending a signal upstream, is there a way in NGINX that I can verify it is working as expected?</p>\n\n<p>On the Fast-CGI side of things the Golang server is listening for a <code>Done()</code> from the <code>http.Request.Context()</code> while it executes the request. If NGINX is explicitly terminating the upstream request we think that should detect it. Does anyone know if that's incorrect?</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1538434734, "post_id": 52599619, "comment_id": 92134421, "body": "Values stored in a map are not addressable, you can&#39;t change them. You can only reassign them."}, {"owner": {"reputation": 151, "user_id": 10270450, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UYR2kT7HFoU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPIVWeQQkqVpKofwndUMNmCvzwwPg/mo/photo.jpg?sz=128", "display_name": "Alexander Anufriev", "link": "https://stackoverflow.com/users/10270450/alexander-anufriev"}, "edited": false, "score": 0, "creation_date": 1538478263, "post_id": 52599619, "comment_id": 92148093, "body": "Both hash / associative arrays has realize only three operations: add key-value, delete key-value and get key-value. It hasn&#39;t reassign operation. Such concept."}], "answers": [{"comments": [{"owner": {"reputation": 681, "user_id": 1894292, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/24bbb0e9731796478c7307061bfd1a84?s=128&d=identicon&r=PG", "display_name": "user1894292", "link": "https://stackoverflow.com/users/1894292/user1894292"}, "edited": false, "score": 1, "creation_date": 1538434695, "post_id": 52599899, "comment_id": 92134408, "body": "Thank you so much for the answer and especially the explanation.  I feel like I understand it a lot more now.  Didn&#39;t realise structs were immutable."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1538434771, "post_id": 52599899, "comment_id": 92134430, "body": "<i>&quot;The default value for struct is <code>nil</code>.&quot;</i> Wrong. <code>nil</code> is not even a valid value for struts."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1538434818, "post_id": 52599899, "comment_id": 92134441, "body": "<i>&quot;Structs are not modifiable thing&quot;</i> Wrong. Structs are modifiable. It&#39;s values stored in map that are not modifiable, because values stored in a map are not addressable."}, {"owner": {"reputation": 151, "user_id": 10270450, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UYR2kT7HFoU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPIVWeQQkqVpKofwndUMNmCvzwwPg/mo/photo.jpg?sz=128", "display_name": "Alexander Anufriev", "link": "https://stackoverflow.com/users/10270450/alexander-anufriev"}, "edited": false, "score": 0, "creation_date": 1538435017, "post_id": 52599899, "comment_id": 92134479, "body": "icza thanks a lot. You a right!"}], "tags": [], "owner": {"reputation": 151, "user_id": 10270450, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-UYR2kT7HFoU/AAAAAAAAAAI/AAAAAAAAAAA/APUIFaPIVWeQQkqVpKofwndUMNmCvzwwPg/mo/photo.jpg?sz=128", "display_name": "Alexander Anufriev", "link": "https://stackoverflow.com/users/10270450/alexander-anufriev"}, "is_accepted": true, "score": 2, "last_activity_date": 1538436067, "last_edit_date": 1538436067, "creation_date": 1538434125, "answer_id": 52599899, "question_id": 52599619, "link": "https://stackoverflow.com/questions/52599619/cannot-assign-to-struct-field-assignment-to-entry-in-nil-map/52599899#52599899", "title": "cannot assign to struct field / assignment to entry in nil map", "body": "<p>The default value for map is <code>nil</code> (before or without make(map))</p>\n\n<p>You set a default value for <code>Runners</code> in this code:</p>\n\n\n\n<pre><code>Bet.Events[\"one\"] = Event{\n    Name: \"first\",\n}\n</code></pre>\n\n<p>So, <code>Runners</code> wasn't defined clearly and was setting to <code>nil</code>.</p>\n\n<p>Structs are mutable expect map elements.\nYou cannot reinitialize map element <code>Bet.Events[\"one\"]</code> because is not addressable.</p>\n\n<p>You need to do:</p>\n\n\n\n<pre><code>Bet.Events[\"one\"] = Event{\n    Name: \"first\",\n    Runners: make(map[int]Runner),\n}\n</code></pre>\n\n<p>Thanks @icza for marking errors in the text</p>\n"}], "owner": {"reputation": 681, "user_id": 1894292, "user_type": "registered", "accept_rate": 87, "profile_image": "https://www.gravatar.com/avatar/24bbb0e9731796478c7307061bfd1a84?s=128&d=identicon&r=PG", "display_name": "user1894292", "link": "https://stackoverflow.com/users/1894292/user1894292"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 439, "favorite_count": 0, "closed_date": 1538434692, "accepted_answer_id": 52599899, "answer_count": 1, "score": 0, "last_activity_date": 1538436067, "creation_date": 1538432172, "question_id": 52599619, "link": "https://stackoverflow.com/questions/52599619/cannot-assign-to-struct-field-assignment-to-entry-in-nil-map", "closed_reason": "Duplicate", "title": "cannot assign to struct field / assignment to entry in nil map", "body": "<p>Does anyone have any idea why this doesn't work?</p>\n\n<p>I've been racking my brain for about 4 hours now.  I cannot make it work.</p>\n\n<p>In my opinion, I'm trying to do the same thing twice.  I'm making a map of a field in a struct, and then I'm doing it again on another field in a different struct.</p>\n\n<p>If I try to make the map. It fails with: \"cannot assign to struct field. Bet.Events[\"one\"].Runners in map\".</p>\n\n<p>So if I remove the make, and just try to assign it, I get: \"assignment to entry in nil map\"</p>\n\n<p><a href=\"https://play.golang.org/p/kRcXoyO-8FN\" rel=\"nofollow noreferrer\">https://play.golang.org/p/kRcXoyO-8FN</a></p>\n\n<pre><code>var Bet BetStruct\n\ntype BetStruct struct {\n    Events     map[string]Event\n}\n\ntype Event struct {\n    Name       string\n    Runners    map[int]Runner\n}\n\ntype Runner struct {\n    Name       string\n}\n\nfunc main(){\n\n    // == THIS WORKS FINE ==\n    Bet.Events = make(map[string]Event)\n\n    Bet.Events[\"one\"] = Event{\n        Name: \"first\",\n    }\n    Bet.Events[\"two\"] = Event{\n        Name: \"second\",\n    }\n\n    // == THIS DOES NOT WORK ==\n    Bet.Events[\"one\"].Runners = make(map[int]Runner)\n\n    Bet.Events[\"one\"].Runners[0] = Runner{\n         Name:  \"Jeff\",\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "buffalo"], "comments": [{"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538436728, "post_id": 52599203, "comment_id": 92134841, "body": "You need to include which package the type is defined in e.g. <code>v2.UploadSessionResource{}</code>."}, {"owner": {"reputation": 22618, "user_id": 1555312, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/12c03a0fc2ac25d234882cf93f1d3052?s=128&d=identicon&r=PG", "display_name": "bigpotato", "link": "https://stackoverflow.com/users/1555312/bigpotato"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538492143, "post_id": 52599203, "comment_id": 92156282, "body": "I tried buy goimports was deleting it. What would the import look like?"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538536133, "post_id": 52599203, "comment_id": 92172349, "body": "It&#39;s deleting it because you&#39;re not preceding the package&#39;s type with the package name. Notice the <code>v2.</code> before <code>UploadSessionResource{}</code>."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538536209, "post_id": 52599203, "comment_id": 92172368, "body": "Though, you may be having problems because of the package&#39;s name. You can also try aliasing the package when importing e.g. <code>import &quot;actions&#47;v2&quot; actions</code> and then use <code>actions.UploadSessionResource{}</code>."}], "owner": {"reputation": 22618, "user_id": 1555312, "user_type": "registered", "accept_rate": 72, "profile_image": "https://www.gravatar.com/avatar/12c03a0fc2ac25d234882cf93f1d3052?s=128&d=identicon&r=PG", "display_name": "bigpotato", "link": "https://stackoverflow.com/users/1555312/bigpotato"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538465301, "creation_date": 1538429702, "last_edit_date": 1538465301, "question_id": 52599203, "link": "https://stackoverflow.com/questions/52599203/how-to-import-nested-local-file", "title": "How to import nested local file", "body": "<p>Before:</p>\n\n<pre><code>actions\n\u251c\u2500\u2500 app.go\n\u251c\u2500\u2500 upload_sessions.go\n\u251c\u2500\u2500 upload_sessions_test.go\n</code></pre>\n\n<p>What I want to change it to:</p>\n\n<pre><code>actions\n\u251c\u2500\u2500 app.go\n\u251c\u2500\u2500 v2\n\u2502\u00a0\u00a0 \u251c\u2500\u2500 upload_sessions.go\n\u2502\u00a0\u00a0 \u2514\u2500\u2500 upload_sessions_test.go\n</code></pre>\n\n<p>When I try nesting the upload_sessions.go file in the <code>v2/</code> folder and adding this import:</p>\n\n<pre><code>import (\"actions/v2\")\n</code></pre>\n\n<p>1) my go formatter in VIM deletes it (since it is unused), and 2) the compiler errors in <code>app.go</code> with:</p>\n\n<pre><code>uploadSessionResource := UploadSessionResource{} // this causes a compiler error: actions/app.go:80:28: undefined: UploadSessionResource\n</code></pre>\n\n<p>What do I need to do to import a local file in Go / Buffalo?</p>\n"}, {"tags": ["docker", "go", "go-modules"], "answers": [{"tags": [], "owner": {"reputation": 84923, "user_id": 1920232, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/iUA8y.jpg?s=128&g=1", "display_name": "peterm", "link": "https://stackoverflow.com/users/1920232/peterm"}, "is_accepted": true, "score": 3, "last_activity_date": 1538430105, "creation_date": 1538430105, "answer_id": 52599280, "question_id": 52597880, "link": "https://stackoverflow.com/questions/52597880/go-1-11-unknown-import-path-for-own-package-in-docker-build/52599280#52599280", "title": "Go 1.11 unknown import path for own package in Docker build", "body": "<p>Make sure that you initialized modules properly for your project</p>\n\n<pre><code>go mod init github.com/triplestrange/StrangeScout/goscout\n</code></pre>\n\n<p>so that the content of your <code>go.mod</code> is </p>\n\n<pre><code>module github.com/triplestrange/StrangeScout/goscout\n</code></pre>\n\n<p>And then you can use your current Dockerfile <strong>without any changes</strong>.</p>\n\n<p>There is no need to set <code>GO111MODULE=on</code> since you're running <code>go</code> commands outside of the <code>$GOPATH</code></p>\n\n<pre>\n\u279c docker build -t goscout .\nSending build context to Docker daemon   47.1kB\nStep 1/11 : FROM golang:latest AS builder\n ---> fb7a47d8605b\nStep 2/11 : WORKDIR /goscout\n ---> Running in e9786fe5ab53\nRemoving intermediate container e9786fe5ab53\n ---> 6d101e346175\nStep 3/11 : COPY ./ ./\n ---> 7081c0b47dc9\nStep 4/11 : RUN go get -d -v ./...\n ---> Running in 3ce69359ae88\ngo: finding github.com/go-sql-driver/mysql v1.4.0\ngo: finding github.com/gorilla/mux v1.6.2\ngo: downloading github.com/gorilla/mux v1.6.2\ngo: downloading github.com/go-sql-driver/mysql v1.4.0\nRemoving intermediate container 3ce69359ae88\n\n...\n\n\n ---> 3df0dbca80e5\nSuccessfully built 3df0dbca80e5\nSuccessfully tagged goscout:latest\n</pre>\n"}], "owner": {"reputation": 204, "user_id": 6934478, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/4e496ab2361d3362c6b8195a8bac935a?s=128&d=identicon&r=PG", "display_name": "aidanh010", "link": "https://stackoverflow.com/users/6934478/aidanh010"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4908, "favorite_count": 0, "accepted_answer_id": 52599280, "answer_count": 1, "score": 5, "last_activity_date": 1538430105, "creation_date": 1538423153, "question_id": 52597880, "link": "https://stackoverflow.com/questions/52597880/go-1-11-unknown-import-path-for-own-package-in-docker-build", "title": "Go 1.11 unknown import path for own package in Docker build", "body": "<p>I am migrating some code to work with Go 1.11 modules, and I am able to build it from the shell but not in Docker.</p>\n\n<p>Relevant Dockerfile sections:</p>\n\n<pre><code>WORKDIR /goscout\nCOPY [\"go.mod\", \"go.sum\", \"./\"]\nRUN GO111MODULE=on go get -u=patch\nCOPY *.go ./\nRUN GO111MODULE=on go build -v -ldflags \"-linkmode external -extldflags -static\" -o GoScout -a .\n</code></pre>\n\n<p>When Docker is running the last command in the above excerpt, I get this error:</p>\n\n<pre><code>can't load package: package github.com/triplestrange/StrangeScout/goscout: unknown import path \"github.com/triplestrange/StrangeScout/goscout\": ambiguous import: found github.com/triplestrange/StrangeScout/goscout in multiple modules:\n    github.com/triplestrange/StrangeScout/goscout (/goscout)\n    github.com/triplestrange/StrangeScout v0.3.0 (/go/pkg/mod/github.com/triplestrange/!strange!scout@v0.3.0/goscout)\n</code></pre>\n\n<p>I don't get this in the shell, so I'm guessing I am not copying some files correctly. But before this command runs I have copied <code>go.mod</code>, <code>go.sum</code>, and <code>*.go</code>, so I don't know what could be missing.</p>\n"}, {"tags": ["go", "architecture"], "answers": [{"comments": [{"owner": {"reputation": 1935, "user_id": 4707978, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-bDQajnLNVEY/AAAAAAAAAAI/AAAAAAAAABE/FMwcfyWA9dg/photo.jpg?sz=128", "display_name": "Theo Bouwman", "link": "https://stackoverflow.com/users/4707978/theo-bouwman"}, "edited": false, "score": 0, "creation_date": 1538487464, "post_id": 52598760, "comment_id": 92153315, "body": "Well I thought that there are some architectures which really work."}, {"owner": {"reputation": 1053, "user_id": 1929115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de952c14fb5c61eecd681320b887757?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar Ganesh Jayaraman", "link": "https://stackoverflow.com/users/1929115/shankar-ganesh-jayaraman"}, "reply_to_user": {"reputation": 1935, "user_id": 4707978, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-bDQajnLNVEY/AAAAAAAAAAI/AAAAAAAAABE/FMwcfyWA9dg/photo.jpg?sz=128", "display_name": "Theo Bouwman", "link": "https://stackoverflow.com/users/4707978/theo-bouwman"}, "edited": false, "score": 0, "creation_date": 1538517070, "post_id": 52598760, "comment_id": 92168008, "body": "Well it depends on your goal and objectives of the project. What\u2019s your goal(performance, concurrency ... etc)  and which domain?"}, {"owner": {"reputation": 1935, "user_id": 4707978, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-bDQajnLNVEY/AAAAAAAAAAI/AAAAAAAAABE/FMwcfyWA9dg/photo.jpg?sz=128", "display_name": "Theo Bouwman", "link": "https://stackoverflow.com/users/4707978/theo-bouwman"}, "edited": false, "score": 0, "creation_date": 1538579289, "post_id": 52598760, "comment_id": 92193776, "body": "The goal is to make a platform for residents to manage their contracts and payments. Later on we want to add social/community features. So it needs to be very flexible"}, {"owner": {"reputation": 1053, "user_id": 1929115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de952c14fb5c61eecd681320b887757?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar Ganesh Jayaraman", "link": "https://stackoverflow.com/users/1929115/shankar-ganesh-jayaraman"}, "reply_to_user": {"reputation": 1935, "user_id": 4707978, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-bDQajnLNVEY/AAAAAAAAAAI/AAAAAAAAABE/FMwcfyWA9dg/photo.jpg?sz=128", "display_name": "Theo Bouwman", "link": "https://stackoverflow.com/users/4707978/theo-bouwman"}, "edited": false, "score": 0, "creation_date": 1538989630, "post_id": 52598760, "comment_id": 92324118, "body": "Is it something like a real estate classified app for posting, renting and buying/selling property?"}, {"owner": {"reputation": 1935, "user_id": 4707978, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-bDQajnLNVEY/AAAAAAAAAAI/AAAAAAAAABE/FMwcfyWA9dg/photo.jpg?sz=128", "display_name": "Theo Bouwman", "link": "https://stackoverflow.com/users/4707978/theo-bouwman"}, "edited": false, "score": 0, "creation_date": 1539111824, "post_id": 52598760, "comment_id": 92380646, "body": "Mostly for renting"}, {"owner": {"reputation": 1053, "user_id": 1929115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de952c14fb5c61eecd681320b887757?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar Ganesh Jayaraman", "link": "https://stackoverflow.com/users/1929115/shankar-ganesh-jayaraman"}, "reply_to_user": {"reputation": 1935, "user_id": 4707978, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-bDQajnLNVEY/AAAAAAAAAAI/AAAAAAAAABE/FMwcfyWA9dg/photo.jpg?sz=128", "display_name": "Theo Bouwman", "link": "https://stackoverflow.com/users/4707978/theo-bouwman"}, "edited": false, "score": 0, "creation_date": 1539132264, "post_id": 52598760, "comment_id": 92387238, "body": "Ok. I am not seeing any challenge in picking the architecture the need is quite straightforward I would suggest choosing any framework to save time and money. Django, Drupal, Wordpress, Openhippo ... etc"}], "tags": [], "owner": {"reputation": 1053, "user_id": 1929115, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6de952c14fb5c61eecd681320b887757?s=128&d=identicon&r=PG&f=1", "display_name": "Shankar Ganesh Jayaraman", "link": "https://stackoverflow.com/users/1929115/shankar-ganesh-jayaraman"}, "is_accepted": false, "score": 0, "last_activity_date": 1538427258, "creation_date": 1538427258, "answer_id": 52598760, "question_id": 52597542, "link": "https://stackoverflow.com/questions/52597542/golang-architecture-questions-for-new-project/52598760#52598760", "title": "Golang Architecture questions for new project", "body": "<ul>\n<li><p>What do you want to cache, the database queries or files or requests?</p></li>\n<li><p>Authentication/Authorization can be in the middleware layer and also\nbefore the view/model layer.</p></li>\n</ul>\n\n<p>You can pick and choose your architecture based on your need and objectives. There is no hard and fast rule for choosing the architecture. The right architecture comes out from trying POC on different architecture for the same objective.</p>\n"}], "owner": {"reputation": 1935, "user_id": 4707978, "user_type": "registered", "accept_rate": 38, "profile_image": "https://lh6.googleusercontent.com/-bDQajnLNVEY/AAAAAAAAAAI/AAAAAAAAABE/FMwcfyWA9dg/photo.jpg?sz=128", "display_name": "Theo Bouwman", "link": "https://stackoverflow.com/users/4707978/theo-bouwman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 103, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538427258, "creation_date": 1538421618, "last_edit_date": 1538425115, "question_id": 52597542, "link": "https://stackoverflow.com/questions/52597542/golang-architecture-questions-for-new-project", "title": "Golang Architecture questions for new project", "body": "<p>I'm using this <a href=\"https://medium.com/@eminetto/clean-architecture-using-golang-b63587aa5e3f\" rel=\"nofollow noreferrer\">https://medium.com/@eminetto/clean-architecture-using-golang-b63587aa5e3f</a> architecture for my next project.</p>\n\n<p>But I have a few questions:</p>\n\n<ul>\n<li>In which layer should caching go?</li>\n<li>In which layer should authentication/authorization go?</li>\n</ul>\n\n<p>And is this a good architecture to use with Go?</p>\n"}, {"tags": ["go", "data-structures", "struct", "iteration"], "comments": [{"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538424352, "post_id": 52597207, "comment_id": 92130916, "body": "Nothing wrong with the loop as such, but you could perhaps create a custom type that is essentially a map, using the Bundle.ID value as key. You might need to write a custom <code>GetBSON</code> and <code>SetBSON</code> functions so you can marshal it into a slice if you want."}, {"owner": {"reputation": 1686, "user_id": 1310740, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4e09b49b817d88d050bee0dd6f602e24?s=128&d=identicon&r=PG&f=1", "display_name": "dev-jim", "link": "https://stackoverflow.com/users/1310740/dev-jim"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538536698, "post_id": 52597207, "comment_id": 92172485, "body": "@EliasVanOotegem, I didn&#39;t know we can write custom unmarshal, thanks for the info!"}, {"owner": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538662658, "post_id": 52597207, "comment_id": 92229832, "body": "Wait, was that the answer you&#39;re looking for?"}, {"owner": {"reputation": 1686, "user_id": 1310740, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4e09b49b817d88d050bee0dd6f602e24?s=128&d=identicon&r=PG&f=1", "display_name": "dev-jim", "link": "https://stackoverflow.com/users/1310740/dev-jim"}, "reply_to_user": {"reputation": 67504, "user_id": 1230836, "user_type": "registered", "accept_rate": 96, "profile_image": "https://i.stack.imgur.com/38PFC.jpg?s=128&g=1", "display_name": "Elias Van Ootegem", "link": "https://stackoverflow.com/users/1230836/elias-van-ootegem"}, "edited": false, "score": 0, "creation_date": 1538673345, "post_id": 52597207, "comment_id": 92236134, "body": "Not exactly, but it is very useful info for me. I might need this in the future."}], "owner": {"reputation": 1686, "user_id": 1310740, "user_type": "registered", "accept_rate": 61, "profile_image": "https://www.gravatar.com/avatar/4e09b49b817d88d050bee0dd6f602e24?s=128&d=identicon&r=PG&f=1", "display_name": "dev-jim", "link": "https://stackoverflow.com/users/1310740/dev-jim"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 102, "favorite_count": 0, "answer_count": 0, "score": 1, "last_activity_date": 1538419984, "creation_date": 1538419984, "question_id": 52597207, "link": "https://stackoverflow.com/questions/52597207/how-to-check-if-a-struct-field-value-exists-in-another-struct-field", "title": "How to check if a struct field value exists in another struct field", "body": "<pre><code>type Bundle struct {\n    Name    string   `bson:\"name\" json:\"name\"`\n    Choices []string `bson:\"choices\" json:\"choices\"`\n}\n\ntype Event struct {\n    ID          bson.ObjectId   `bson:\"_id,omitempty\" json:\"_id,omitempty\"` \n    Bundle      []Bundle        `bson:\"bundle\" json:\"bundle\"`\n}\n\ntype AttendeeBundle struct {\n    Name    string `bson:\"name\" json:\"name\"`\n    Details string `bson:\"details\" json:\"details\"`\n}\n\ntype Attendees struct {\n    ID          bson.ObjectId `bson:\"_id,omitempty\" json:\"_id,omitempty\"`\n    Bundle      []AttendeeBundle      `bson:\"bundle\" json:\"bundle\"`\n}\n</code></pre>\n\n<p>I am building an event registration platform. The Event contains a Bundle field where the Attendee can choose from.  Eg. T-shirt with various of size or color. </p>\n\n<p>So upon registration, I want to make sure the attendee choice the correct bundle from the corresponding event. </p>\n\n<p>I know can iterate for both attendee and event, something like this:</p>\n\n<pre><code>for _ , attendeebundle := range Attendees.Bundle {      \n            for _, eventbundle := range Event.Bundle{\n                //comparing attendee bundle and event bundle\n            }\n        }\n    }\n</code></pre>\n\n<p>However, I think this too redundant, is there any other more elegant/effective ways to do this? </p>\n"}, {"tags": ["json", "go", "unmarshalling"], "answers": [{"tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": true, "score": 2, "last_activity_date": 1538418431, "creation_date": 1538418431, "answer_id": 52596835, "question_id": 52596403, "link": "https://stackoverflow.com/questions/52596403/unmarshal-json-null-into-pointer-of-nullstring/52596835#52596835", "title": "Unmarshal json null into Pointer of NullString", "body": "<p>Yes, this is because of the following unmarshaling rule:</p>\n\n<blockquote>\n  <p>To unmarshal JSON into a pointer, Unmarshal first handles the case of the JSON being the JSON literal null. In that case, Unmarshal sets the pointer to nil. Otherwise, Unmarshal unmarshals the JSON into the value pointed at by the pointer.</p>\n</blockquote>\n\n<p>(<a href=\"https://golang.org/pkg/encoding/json/#Unmarshal\" rel=\"nofollow noreferrer\">Documentation for <code>encoding/json</code></a>).</p>\n\n<p>What I suggest to do is to add a <code>Set</code> field which is changed to true when UnmarshalJSON is fired (which if there is any value, is guaranteed to be fired), and then to change the <code>*NullString</code> to a simple <code>NullString</code>, like so:</p>\n\n<pre><code>package main\n\nimport (\n    \"database/sql\"\n    \"encoding/json\"\n    \"log\"\n)\n\n// NullString\ntype NullString struct {\n    Set bool\n    sql.NullString\n}\n\nfunc (n *NullString) UnmarshalJSON(b []byte) error {\n    n.Set = true\n    n.Valid = string(b) != \"null\"\n    e := json.Unmarshal(b, &amp;n.String)\n    return e\n}\n\ntype Person struct {\n    Name NullString `json:\"name\"`\n}\n\nfunc BuildUpdateSQL(jsonString string) string {\n    p := Person{}\n    e := json.Unmarshal([]byte(jsonString), &amp;p)\n    if e != nil {\n        log.Println(e)\n    }\n\n    log.Printf(\"%#v\", p)\n    return \"\"\n}\n\nfunc main() {\n    BuildUpdateSQL(`{\"field_not_exist\":\"samantha\"}`)\n    BuildUpdateSQL(`{\"name\":\"samantha\"}`)\n    BuildUpdateSQL(`{\"name\":null}`)\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/R3lCk8gJGqe\" rel=\"nofollow noreferrer\">Playground</a></p>\n"}], "owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 888, "favorite_count": 0, "accepted_answer_id": 52596835, "answer_count": 1, "score": 2, "last_activity_date": 1538418431, "creation_date": 1538416580, "question_id": 52596403, "link": "https://stackoverflow.com/questions/52596403/unmarshal-json-null-into-pointer-of-nullstring", "title": "Unmarshal json null into Pointer of NullString", "body": "<p>I am unable to <code>json.Unmarshal</code> a null value into a <code>*NullString</code> field within a struct.  Here is a simplified example of what I mean:</p>\n\n<pre><code>package main\n\nimport (\n  \"database/sql\"\n  \"encoding/json\"\n  \"log\"\n)\n\n// NullString\ntype NullString struct {\n  sql.NullString\n}\n\nfunc (n *NullString) UnmarshalJSON(b []byte) error {\n\n  n.Valid = string(b) != \"null\"\n  e := json.Unmarshal(b, &amp;n.String)\n  return e\n}\n\ntype Person struct {\n  Name *NullString `json:\"name\"`\n}\n\nfunc BuildUpdateSQL(jsonString string) string {\n\n  p := Person{}\n  e := json.Unmarshal([]byte(jsonString),&amp;p)\n  if e != nil {\n    log.Println(e)\n  }\n\n  if p.Name != nil {\n    log.Println(p,p.Name)\n  } else {\n    log.Println(p)\n  }\n  return \"\"\n}\nfunc main() {\n  // Correctly leaves p.Name unset\n  BuildUpdateSQL(`{\"field_not_exist\":\"samantha\"}`)\n\n  // Correctly sets p.Name\n  BuildUpdateSQL(`{\"name\":\"samantha\"}`)\n\n  // Incorrectly leaves p.Name as nil when I really want p.Name to have a NullString with .Valid == false\n  BuildUpdateSQL(`{\"name\":null}`)\n}\n</code></pre>\n\n<p>As you can see, unmarshalling works for non-null json values.  But when I pass in a null json value, the NullString unmarshaller doesn't seem to even fire.</p>\n\n<p><strong>Anyone know what I'm doing wrong?</strong></p>\n\n<p><strong>Background</strong></p>\n\n<p>The reason I'm trying to do this is because I plan to get JSON value from a REST API.  Not all fields in the API are required fields.  Hence I use pointers for my struct fields to help me build my SQL Update statement because:</p>\n\n<ul>\n<li>field with nil means not populated (do not include a <code>SET name = ?</code>)</li>\n<li>non-nil NullString.Valid == false means actual null value (include a <code>SET name = NULL</code>)</li>\n<li>and non-nil NullString.Valid == true means a real string value exists (include a <code>SET name = ?</code>)</li>\n</ul>\n"}, {"tags": ["go", "google-cloud-platform", "google-api", "google-api-client", "google-api-go-client"], "answers": [{"comments": [{"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1539255886, "post_id": 52730794, "comment_id": 92440062, "body": "Question is, how to get the HTTP requests out of the go client library. I could only find the <code>.Do()</code> functions like <code>client.Zones.List(&quot;project&quot;).Do()</code> which assemble the HTTP request, send it, wait for a response, decode it, etc. Maybe you can write a custom <code>http.Client</code> and hand it over to the client lib; you&#39;d have to run each request of the batch asynchronously in its own goroutine..."}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1539255992, "post_id": 52730794, "comment_id": 92440128, "body": "To clarify this a bit: My question is <i>not</i> how to perform batch requests to the GCP APIs. That is documented. My question is how to perform batch requests using the <i>Google API Client Library for Go</i>."}, {"owner": {"reputation": 1323, "user_id": 9743418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRhlh.jpg?s=128&g=1", "display_name": "Alioua", "link": "https://stackoverflow.com/users/9743418/alioua"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1539273165, "post_id": 52730794, "comment_id": 92451394, "body": "did you try using <a href=\"https://github.com/dghubble/sling\" rel=\"nofollow noreferrer\">sling</a> or <a href=\"https://github.com/go-resty/resty\" rel=\"nofollow noreferrer\">resty</a> library?"}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1539276521, "post_id": 52730794, "comment_id": 92453081, "body": "Nope, but as far as I can see they only get me there part of the way. The main work is to define the structs (e.g. which fields are required/expected) and the protocol (e.g. the request returns an operation ID which I need to use in another request to get the status). That&#39;s what the <i>Google API Client Library for Go</i> does for me: it gives me static types for the messages and implements large parts of the protocol. I&#39;d like to avoid having to reimplement that."}, {"owner": {"reputation": 1323, "user_id": 9743418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRhlh.jpg?s=128&g=1", "display_name": "Alioua", "link": "https://stackoverflow.com/users/9743418/alioua"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1539282127, "post_id": 52730794, "comment_id": 92456026, "body": "I did add the func (DisksDeleteCall) by GO, something that you may be interested"}, {"owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1539332904, "post_id": 52730794, "comment_id": 92472515, "body": "Well yes, that&#39;s part of the Google API Client Library for Go. But despite its name <code>DisksDeleteCall</code>, it only allows the deletion of <i>one</i> disk at a time. As you can see, the <code>Do</code> function (or rather, the <code>doRequest</code> function) assembles the request message, but it also sends the request and handles the response. For a batch call, I&#39;d have to either separate those phases (get the request message, glue it to create a batch call, repeat, and finally send the batch request) or hack into the <code>http.Context</code> used to send the request in the <code>Do</code> function."}, {"owner": {"reputation": 1323, "user_id": 9743418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRhlh.jpg?s=128&g=1", "display_name": "Alioua", "link": "https://stackoverflow.com/users/9743418/alioua"}, "reply_to_user": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "edited": false, "score": 0, "creation_date": 1539698126, "post_id": 52730794, "comment_id": 92590359, "body": "to be honest I used one request call for one disk at time, it&#39;s a good approach, looking for your finding."}], "tags": [], "owner": {"reputation": 1323, "user_id": 9743418, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/aRhlh.jpg?s=128&g=1", "display_name": "Alioua", "link": "https://stackoverflow.com/users/9743418/alioua"}, "is_accepted": false, "score": 0, "last_activity_date": 1539282065, "last_edit_date": 1539282065, "creation_date": 1539129322, "answer_id": 52730794, "question_id": 52595851, "link": "https://stackoverflow.com/questions/52595851/batch-requests-to-gcp-compute-using-golang-client-library/52730794#52730794", "title": "Batch requests to GCP Compute using Golang client library", "body": "<p>I'm not sure but i think it can be done since we can dlete a disk using API call.\nA batch request consists of multiple API calls combined into one HTTP request, which can be sent to the batchPath specified in the <a href=\"https://developers.google.com/discovery/v1/reference/apis\" rel=\"nofollow noreferrer\">API discovery document</a>. The default path is /batch/api_name/api_version. </p>\n\n<p><a href=\"https://developers.google.com/drive/api/v3/batch#example\" rel=\"nofollow noreferrer\">Example</a> take a look on the Format of a batch request <a href=\"https://developers.google.com/drive/api/v3/batch#format-of-a-batch-request\" rel=\"nofollow noreferrer\">Here</a></p>\n\n<pre><code>// method id \"compute.disks.delete\":\n\ntype DisksDeleteCall struct {\n    s          *Service\n    project    string\n    zone       string\n    disk       string\n    urlParams_ gensupport.URLParams\n    ctx_       context.Context\n    header_    http.Header\n}\n\n// Delete: Deletes the specified persistent disk. Deleting a disk\n// removes its data permanently and is irreversible. However, deleting a\n// disk does not delete any snapshots previously made from the disk. You\n// must separately delete snapshots.\n// For details, see https://cloud.google.com/compute/docs/reference/latest/disks/delete\nfunc (r *DisksService) Delete(project string, zone string, disk string) *DisksDeleteCall {\n    c := &amp;DisksDeleteCall{s: r.s, urlParams_: make(gensupport.URLParams)}\n    c.project = project\n    c.zone = zone\n    c.disk = disk\n    return c\n}\n\n// RequestId sets the optional parameter \"requestId\": An optional\n// request ID to identify requests. Specify a unique request ID so that\n// if you must retry your request, the server will know to ignore the\n// request if it has already been completed.\n//\n// For example, consider a situation where you make an initial request\n// and the request times out. If you make the request again with the\n// same request ID, the server can check if original operation with the\n// same request ID was received, and if so, will ignore the second\n// request. This prevents clients from accidentally creating duplicate\n// commitments.\n//\n// The request ID must be a valid UUID with the exception that zero UUID\n// is not supported (00000000-0000-0000-0000-000000000000).\nfunc (c *DisksDeleteCall) RequestId(requestId string) *DisksDeleteCall {\n    c.urlParams_.Set(\"requestId\", requestId)\n    return c\n}\n\n// Fields allows partial responses to be retrieved. See\n// https://developers.google.com/gdata/docs/2.0/basics#PartialResponse\n// for more information.\nfunc (c *DisksDeleteCall) Fields(s ...googleapi.Field) *DisksDeleteCall {\n    c.urlParams_.Set(\"fields\", googleapi.CombineFields(s))\n    return c\n}\n\n// Context sets the context to be used in this call's Do method. Any\n// pending HTTP request will be aborted if the provided context is\n// canceled.\nfunc (c *DisksDeleteCall) Context(ctx context.Context) *DisksDeleteCall {\n    c.ctx_ = ctx\n    return c\n}\n\n// Header returns an http.Header that can be modified by the caller to\n// add HTTP headers to the request.\nfunc (c *DisksDeleteCall) Header() http.Header {\n    if c.header_ == nil {\n        c.header_ = make(http.Header)\n    }\n    return c.header_\n}\n\nfunc (c *DisksDeleteCall) doRequest(alt string) (*http.Response, error) {\n    reqHeaders := make(http.Header)\n    for k, v := range c.header_ {\n        reqHeaders[k] = v\n    }\n    reqHeaders.Set(\"User-Agent\", c.s.userAgent())\n    var body io.Reader = nil\n    c.urlParams_.Set(\"alt\", alt)\n    c.urlParams_.Set(\"prettyPrint\", \"false\")\n    urls := googleapi.ResolveRelative(c.s.BasePath, \"{project}/zones/{zone}/disks/{disk}\")\n    urls += \"?\" + c.urlParams_.Encode()\n    req, _ := http.NewRequest(\"DELETE\", urls, body)\n    req.Header = reqHeaders\n    googleapi.Expand(req.URL, map[string]string{\n        \"project\": c.project,\n        \"zone\":    c.zone,\n        \"disk\":    c.disk,\n    })\n    return gensupport.SendRequest(c.ctx_, c.s.client, req)\n}\n\n// Do executes the \"compute.disks.delete\" call.\n// Exactly one of *Operation or error will be non-nil. Any non-2xx\n// status code is an error. Response headers are in either\n// *Operation.ServerResponse.Header or (if a response was returned at\n// all) in error.(*googleapi.Error).Header. Use googleapi.IsNotModified\n// to check whether the returned error was because\n// http.StatusNotModified was returned.\nfunc (c *DisksDeleteCall) Do(opts ...googleapi.CallOption) (*Operation, error) {\n    gensupport.SetOptions(c.urlParams_, opts...)\n    res, err := c.doRequest(\"json\")\n    if res != nil &amp;&amp; res.StatusCode == http.StatusNotModified {\n        if res.Body != nil {\n            res.Body.Close()\n        }\n        return nil, &amp;googleapi.Error{\n            Code:   res.StatusCode,\n            Header: res.Header,\n        }\n    }\n    if err != nil {\n        return nil, err\n    }\n    defer googleapi.CloseBody(res)\n    if err := googleapi.CheckResponse(res); err != nil {\n        return nil, err\n    }\n    ret := &amp;Operation{\n        ServerResponse: googleapi.ServerResponse{\n            Header:         res.Header,\n            HTTPStatusCode: res.StatusCode,\n        },\n    }\n    target := &amp;ret\n    if err := gensupport.DecodeResponse(target, res); err != nil {\n        return nil, err\n    }\n    return ret, nil\n    // {\n    //   \"description\": \"Deletes the specified persistent disk. Deleting a disk removes its data permanently and is irreversible. However, deleting a disk does not delete any snapshots previously made from the disk. You must separately delete snapshots.\",\n    //   \"httpMethod\": \"DELETE\",\n    //   \"id\": \"compute.disks.delete\",\n    //   \"parameterOrder\": [\n    //     \"project\",\n    //     \"zone\",\n    //     \"disk\"\n    //   ],\n    //   \"parameters\": {\n    //     \"disk\": {\n    //       \"description\": \"Name of the persistent disk to delete.\",\n    //       \"location\": \"path\",\n    //       \"required\": true,\n    //       \"type\": \"string\"\n    //     },\n    //     \"project\": {\n    //       \"description\": \"Project ID for this request.\",\n    //       \"location\": \"path\",\n    //       \"pattern\": \"(?:(?:[-a-z0-9]{1,63}\\\\.)*(?:[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?):)?(?:[0-9]{1,19}|(?:[a-z0-9](?:[-a-z0-9]{0,61}[a-z0-9])?))\",\n    //       \"required\": true,\n    //       \"type\": \"string\"\n    //     },\n    //     \"requestId\": {\n    //       \"description\": \"An optional request ID to identify requests. Specify a unique request ID so that if you must retry your request, the server will know to ignore the request if it has already been completed.\\n\\nFor example, consider a situation where you make an initial request and the request times out. If you make the request again with the same request ID, the server can check if original operation with the same request ID was received, and if so, will ignore the second request. This prevents clients from accidentally creating duplicate commitments.\\n\\nThe request ID must be a valid UUID with the exception that zero UUID is not supported (00000000-0000-0000-0000-000000000000).\",\n    //       \"location\": \"query\",\n    //       \"type\": \"string\"\n    //     },\n    //     \"zone\": {\n    //       \"description\": \"The name of the zone for this request.\",\n    //       \"location\": \"path\",\n    //       \"pattern\": \"[a-z](?:[-a-z0-9]{0,61}[a-z0-9])?\",\n    //       \"required\": true,\n    //       \"type\": \"string\"\n    //     }\n    //   },\n    //   \"path\": \"{project}/zones/{zone}/disks/{disk}\",\n    //   \"response\": {\n    //     \"$ref\": \"Operation\"\n    //   },\n    //   \"scopes\": [\n    //     \"https://www.googleapis.com/auth/cloud-platform\",\n    //     \"https://www.googleapis.com/auth/compute\"\n    //   ]\n    // }\n\n}\n</code></pre>\n"}], "owner": {"reputation": 35670, "user_id": 420683, "user_type": "registered", "accept_rate": 57, "profile_image": "https://www.gravatar.com/avatar/68b74cb21e360e5601ce6c812f59a136?s=128&d=identicon&r=PG", "display_name": "dyp", "link": "https://stackoverflow.com/users/420683/dyp"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 627, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1575361654, "creation_date": 1538414120, "last_edit_date": 1575361654, "question_id": 52595851, "link": "https://stackoverflow.com/questions/52595851/batch-requests-to-gcp-compute-using-golang-client-library", "title": "Batch requests to GCP Compute using Golang client library", "body": "<p>Is it possible to perform batch requests using the Google API Client Library for Go?</p>\n\n<p>More precisely, I'd like to delete some disks; it would be great if I could avoid a request for each disk.</p>\n\n<p>The batch request feature I'm referring to:\n<a href=\"https://cloud.google.com/compute/docs/api/how-tos/batch\" rel=\"nofollow noreferrer\">https://cloud.google.com/compute/docs/api/how-tos/batch</a></p>\n\n<p>The client library I'm using:\n<a href=\"https://github.com/googleapis/google-api-go-client\" rel=\"nofollow noreferrer\">https://github.com/googleapis/google-api-go-client</a></p>\n\n<p>It seems there's also another client library, but without support for the Compute Engine, only metadata (?):\n<a href=\"https://github.com/GoogleCloudPlatform/google-cloud-go\" rel=\"nofollow noreferrer\">https://github.com/GoogleCloudPlatform/google-cloud-go</a></p>\n"}, {"tags": ["mongodb", "go"], "comments": [{"owner": {"reputation": 36192, "user_id": 7510657, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/jsd77.jpg?s=128&g=1", "display_name": "Ashh", "link": "https://stackoverflow.com/users/7510657/ashh"}, "edited": false, "score": 2, "creation_date": 1538414545, "post_id": 52595810, "comment_id": 92126565, "body": "Your <code>$match</code> condition should be at the start of the pipeline to limit the number of document."}, {"owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "reply_to_user": {"reputation": 36192, "user_id": 7510657, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/jsd77.jpg?s=128&g=1", "display_name": "Ashh", "link": "https://stackoverflow.com/users/7510657/ashh"}, "edited": false, "score": 0, "creation_date": 1538414839, "post_id": 52595810, "comment_id": 92126690, "body": "@AnthonyWinzlet My match filter depend upon the lookup that&#39;s why I have added this in the bottom. Or should it be different ? can you suggest with example ?"}, {"owner": {"reputation": 36192, "user_id": 7510657, "user_type": "registered", "accept_rate": 56, "profile_image": "https://i.stack.imgur.com/jsd77.jpg?s=128&g=1", "display_name": "Ashh", "link": "https://stackoverflow.com/users/7510657/ashh"}, "edited": false, "score": 1, "creation_date": 1538415132, "post_id": 52595810, "comment_id": 92126802, "body": "Actually <code>$lookup</code> stage has been applied to all 25000 document which makes query slow. So to limit the number of document pass through the <code>$lookup</code> stage you should use <code>$match</code> as soon as possible. Add this at start of the pipeline <code>{ $match:{   purchased_on: { $gt:1538392491 },    status: { $in: [1, 2, 3, 4] },  }}</code>...  <a href=\"https://stackoverflow.com/questions/49750465/query-performance-issue-for-large-nested-data-in-mongodb/49755301#49755301\">Query performance issue for large nested data in mongodb</a>"}, {"owner": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1538439699, "post_id": 52595810, "comment_id": 92135396, "body": "@Swati could you also post an example document structure and the output that you&#39;re trying to get ?"}, {"owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "reply_to_user": {"reputation": 15461, "user_id": 2934579, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/eT1BM.png?s=128&g=1", "display_name": "Wan Bachtiar", "link": "https://stackoverflow.com/users/2934579/wan-bachtiar"}, "edited": false, "score": 0, "creation_date": 1538458278, "post_id": 52595810, "comment_id": 92139078, "body": "@WanBachtiar Please check the document structure here. <a href=\"https://drive.google.com/file/d/1hM-lPwvE45_213rQDYaYuYYbt3LRTgF0/view?usp=sharing\" rel=\"nofollow noreferrer\">drive.google.com/file/d/1hM-lPwvE45_213rQDYaYuYYbt3LRTgF0/&hellip;</a>"}], "answers": [{"comments": [{"owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "edited": false, "score": 0, "creation_date": 1538553891, "post_id": 52604628, "comment_id": 92178427, "body": "Thanks for your detailed answer. I will implement changes according to your answer."}], "tags": [], "owner": {"reputation": 3713, "user_id": 2276898, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9820bd3aabac7f4b8df37078f6a9813f?s=128&d=identicon&r=PG", "display_name": "matthPen", "link": "https://stackoverflow.com/users/2276898/matthpen"}, "is_accepted": false, "score": 2, "last_activity_date": 1538468774, "last_edit_date": 1592644375, "creation_date": 1538468774, "answer_id": 52604628, "question_id": 52595810, "link": "https://stackoverflow.com/questions/52595810/mongodb-query-execution-take-too-much-time/52604628#52604628", "title": "Mongodb query execution take too much time", "body": "<p>There are many things to do to optimize your query. What I would try :</p>\n<ul>\n<li><p>As Anthony Winzlet said in comments, use as possible $match stage as first stage. This way, you can reduce number of documents passed to the following stages, and use indexes.</p>\n</li>\n<li><p>Assuming you use at least 3.6 mongo version, change your lookup stages using the 'let/pipeline' syntax (<a href=\"https://docs.mongodb.com/manual/reference/operator/aggregation/lookup/#join-conditions-and-uncorrelated-sub-queries\" rel=\"nofollow noreferrer\">see here</a>). This way, you can integrate your 'external filters' (  &quot;customer_info.status&quot;:{$ne:9}, &quot;model_info.status&quot;:{$ne:9} ) in a $match stage in your lookups pipeline. With indexes on right fields / collections, you will gain some time / memory in your $lookup stages.</p>\n</li>\n<li><p>Do your unwind stages as late as possible, to restrict number of documents passed to the following stages.</p>\n</li>\n</ul>\n<p>It's important to understand how works aggregation pipeline : each stage receive data, do its stuff, and pass data to next stage. So the less data is passed to the pipeline, the faster will be your query.</p>\n"}], "owner": {"reputation": 63, "user_id": 4971613, "user_type": "registered", "accept_rate": 29, "profile_image": "https://www.gravatar.com/avatar/c16e556a4e543395322dd15157db49b8?s=128&d=identicon&r=PG&f=1", "display_name": "Swati", "link": "https://stackoverflow.com/users/4971613/swati"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 161, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538468774, "creation_date": 1538413948, "last_edit_date": 1538458695, "question_id": 52595810, "link": "https://stackoverflow.com/questions/52595810/mongodb-query-execution-take-too-much-time", "title": "Mongodb query execution take too much time", "body": "<p>Iam working on the Go project and I am using mongodb to store my data. But suddenly the mongodb query execution took too much time to get data.\nI have a collection named \"cars\" with around 25000 documents and each document containing around 200 fields (4.385KB). I have an aggregate query like this:</p>\n\n<pre><code>db.cars.aggregate([\n    {\n        $lookup:\n        {\n            from: \"users\",\n            localField: \"uid\",\n            foreignField: \"_id\",\n            as: \"customer_info\"\n        }\n    },{\n        $unwind: \"$customer_info\"\n    },{\n        $lookup:\n        {\n            from: \"user_addresses\",\n            localField: \"uid\",\n            foreignField: \"_id\",\n            as: \"address\"\n        }\n    },{\n        $unwind: \"$address\"\n    },{\n    $lookup:\n        {\n            from: \"models\",\n            localField: \"_id\",\n            foreignField: \"car_id\",\n            as: \"model_info\"\n        }\n    },{\n    $match:{\n        purchased_on:{$gt:1538392491}, \n        status:{$in:[1,2,3,4]}, \n        \"customer_info.status\":{$ne:9}, \n        \"model_info.status\":{$ne:9},\n        }\n    },{\n        $sort:{\n            arrival_time:1\n        }\n    },{\n        $skip:0\n    },{\n        $limit:5\n    }\n])\n</code></pre>\n\n<p>My document structure is like: <a href=\"https://drive.google.com/file/d/1hM-lPwvE45_213rQDYaYuYYbt3LRTgF0/view\" rel=\"nofollow noreferrer\">https://drive.google.com/file/d/1hM-lPwvE45_213rQDYaYuYYbt3LRTgF0/view</a>.</p>\n\n<p>Now, If run this query with out indexing then it take around 10 mins to load the data. Can anyone suggest me how can I reduce its execution time ?</p>\n"}, {"tags": ["go", "interface"], "comments": [{"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538410247, "post_id": 52594926, "comment_id": 92124680, "body": "When you call Logger&#39;s methods from ErrorDebugLogger the compiler has now way of knowing which Logger implementation you want, the one embedded in ErrorLogger or the one in DebugLogger."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538410320, "post_id": 52594926, "comment_id": 92124719, "body": "but when they are matching signatures it doesn&#39;t matter, since any implementation would satisfy both"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 2, "creation_date": 1538410481, "post_id": 52594926, "comment_id": 92124802, "body": "Sure you could say, hey let&#39;s have the runtime execute the first one that matches, but that seems, at least to me, against the explicit nature of Go."}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 2, "creation_date": 1538410516, "post_id": 52594926, "comment_id": 92124816, "body": "Just because the signatures match doesn&#39;t mean you would have the same implementation in both <code>ErrorLogger</code> and <code>DebugLogger</code>."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538410663, "post_id": 52594926, "comment_id": 92124887, "body": "so I would say the compiler should not just take the first but actively confirm that the signature match, @Gavin There is no implementation embedded in an interface though, in cases like this the implementation would be the same but that is always for consumer to determine surely"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538410853, "post_id": 52594926, "comment_id": 92124966, "body": "@SwiftD <code>that is always for consumer to determine surely</code> Right, and as mkopriva has pointed out, how is the compiler supposed to know which implementation to call at runtime? It can&#39;t ask the consumer. Personally, I feel like a better approach would be to remove the embedded <code>Logger</code> from the <code>DebugLogger</code> and <code>ErrorLogger</code>, and embed the aforementioned with <code>Logger</code> in your <code>ErrorDebugLogger</code>. That seems to align a little more with the stdlib in regards to interfaces like <code>io.Reader</code>, <code>io.ReadCloser</code>, etc. Although, the design decision is ultimately up to you."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1538411089, "post_id": 52594926, "comment_id": 92125065, "body": "im definitely missing something here: &quot;how is the compiler supposed to know which implementation to call at runtime&quot; which ever implementation is provided to satisfy the entire interface - there is only ever one implementation matching multiple interfaces, the compiler has no choice to make"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1538411244, "post_id": 52594926, "comment_id": 92125146, "body": "@Flimzy well thats a point but wouldn&#39;t that apply whenever you embed a third party interface - if they change it suddenly then things break yes, at that point i would expect compiler to complain signatures don&#39;t match or x no longer satisfies the interface"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538412787, "post_id": 52594926, "comment_id": 92125849, "body": "@SwiftD <code>ErrorDebugLogger</code> can have two different instances of <code>Logger</code>, one through each of its embedded interface types. Remember, this is composition, not inheritance."}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538414990, "post_id": 52594926, "comment_id": 92126749, "body": "@Gavin Still not getting it, an interface is not an implementation of anything, I have included a single implementation that satisfies all the interfaces to clarify. If the methods in the embedded interfaces are the  same I still do not see any confusion for the compiler - ErrorDebugLoggerImp should now satisfy any of the above interfaces and indeed if I remove the embedded Logger from either DebugLogger or ErrorLogger it does. But that makes one of those useless in my use case"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538415492, "post_id": 52594926, "comment_id": 92126949, "body": "@Gavin I kind of get your point that this is embedding not inheritance and perhaps that is what it comes down to but I just cant see why the compiler couldn&#39;t resolve that there is no conflict when embedding the same method signature twice, hopefully updated example illustrates the advantage"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 0, "creation_date": 1538415864, "post_id": 52594926, "comment_id": 92127100, "body": "Also re. removing Logger from DebugLogger and ErrorLogger - the idea is that methods that require those interfaces require the Print funcs in Logger as well. The only solution is to duplicate the Print funcs in both interfaces"}, {"owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538425123, "post_id": 52594926, "comment_id": 92131228, "body": "@SwiftD I&#39;ve missed the point completely initially and I see your issue now. Unfortunately for you that&#39;s how the compiler is implemented and a question about the reasons behind that implementation would be more suitable for the go-nuts mailing list. Also take a look at <a href=\"https://github.com/golang/go/issues/6977\" rel=\"nofollow noreferrer\">github.com/golang/go/issues/6977</a>"}, {"owner": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538429299, "post_id": 52594926, "comment_id": 92132910, "body": "Yes, you may be dealing with interfaces, but you ultimately need to have an implementation of that interface to use it. The example is nasty, but it may explain your problem here a little better. <a href=\"https://gist.github.com/gavinwade12/aa736b98434f0f585049e27d5e267b63\" rel=\"nofollow noreferrer\">gist.github.com/gavinwade12/aa736b98434f0f585049e27d5e267b63</a>"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "edited": false, "score": 0, "creation_date": 1538435108, "post_id": 52594926, "comment_id": 92134498, "body": "@mkopriva that issue seems to reference exactly the same issue and I think that answers my question - i would be happy to accept that issue reference as an answer as to the current state of affairs if you would present as an answer"}, {"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "reply_to_user": {"reputation": 3430, "user_id": 6069012, "user_type": "registered", "accept_rate": 83, "profile_image": "https://i.stack.imgur.com/bKlmM.png?s=128&g=1", "display_name": "Gavin", "link": "https://stackoverflow.com/users/6069012/gavin"}, "edited": false, "score": 0, "creation_date": 1538435684, "post_id": 52594926, "comment_id": 92134630, "body": "@Gavin that&#39;s not what I was attempting to describe - you have pointed out an issue with embedding types (e.g structs) with the same method, i have no issue with how things work there - i am talking about embedding interfaces only - I think they probably explain it better in the link mkopriva provided if you are interested (although similar confusion in that thread too)"}], "answers": [{"comments": [{"owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "edited": false, "score": 1, "creation_date": 1603805142, "post_id": 52600126, "comment_id": 114148050, "body": "If anyone is looking at this now - it appears that this is now allowed in the latest golang release. See referenced issue for details"}], "tags": [], "owner": {"reputation": 18601, "user_id": 965900, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/5KqAT.png?s=128&g=1", "display_name": "mkopriva", "link": "https://stackoverflow.com/users/965900/mkopriva"}, "is_accepted": true, "score": 2, "last_activity_date": 1538436037, "creation_date": 1538436037, "answer_id": 52600126, "question_id": 52594926, "link": "https://stackoverflow.com/questions/52594926/are-conflicting-matching-embedded-interface-methods-a-feature-bug-or-other/52600126#52600126", "title": "Are conflicting matching embedded interface methods a feature, bug or other?", "body": "<p>This issue has been discussed here: <a href=\"https://github.com/golang/go/issues/6977\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/6977</a></p>\n\n<p>There's also a question here on SO about <em>how to address</em> the issue, maybe you'll find the answer useful: <a href=\"https://stackoverflow.com/questions/43730255/how-to-deal-with-duplicate-methods-in-go-interface\">How to deal with duplicate methods in Go interface?</a></p>\n"}], "owner": {"reputation": 4913, "user_id": 1146094, "user_type": "registered", "accept_rate": 91, "profile_image": "https://www.gravatar.com/avatar/4b24c43824d179acb4c0dff101823534?s=128&d=identicon&r=PG", "display_name": "SwiftD", "link": "https://stackoverflow.com/users/1146094/swiftd"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 229, "favorite_count": 0, "accepted_answer_id": 52600126, "answer_count": 1, "score": 0, "last_activity_date": 1538436037, "creation_date": 1538409907, "last_edit_date": 1538415065, "question_id": 52594926, "link": "https://stackoverflow.com/questions/52594926/are-conflicting-matching-embedded-interface-methods-a-feature-bug-or-other", "title": "Are conflicting matching embedded interface methods a feature, bug or other?", "body": "<p>I've run into this a few times and its easy to work around but I'm just wondering if there are any advantages to the Go compiler complaining when interfaces embed interfaces with matching method signatures. </p>\n\n<p>For example, if I want a few variations on a logger going to different packages but ultimately I want to use the same logger I might try something like this:</p>\n\n<pre><code>type Logger interface {\n    Print(v ...interface{})\n    Printf(format string, v ...interface{})\n}\n\ntype DebugLogger interface {\n    Logger\n    Debug(v ...interface{})\n    Debugf(format string, v ...interface{})\n}\n\ntype ErrorLogger interface {\n    Logger\n    Error(v ...interface{})\n    Errorf(format string, v ...interface{})\n}\n\ntype ErrorDebugLogger interface {\n    ErrorLogger\n    DebugLogger\n}\n\ntype ErrorDebugLoggerImp struct{}\nfunc (l *ErrorDebugLoggerImp) Debug(v ...interface{})                 {}\nfunc (l *ErrorDebugLoggerImp) Debugf(format string, v ...interface{}) {}\nfunc (l *ErrorDebugLoggerImp) Error(v ...interface{})                 {}\nfunc (l *ErrorDebugLoggerImp) Errorf(format string, v ...interface{}) {}\nfunc (l *ErrorDebugLoggerImp) Print(v ...interface{})                 {}\nfunc (l *ErrorDebugLoggerImp) Printf(format string, v ...interface{}) {}\n</code></pre>\n\n<p>and this could be used as a param to the following methods:</p>\n\n<pre><code>func p1.RegisterLogger(l Logger){}\n\nfunc p2.RegisterLogger(l DebugLogger){}\n\nfunc p3.RegisterLogger(l ErrorLogger){}\n\nfunc p4.RegisterLogger(l DebugErrorLogger){}\n</code></pre>\n\n<p>But this won't work because the compiler will complain that ErrorDebugLogger has duplicate methods. It seems to me that this would be fairly trivial for the compiler to resolve the fact that these methods are identical and there is no conflict and this would make these kind of patterns simpler. </p>\n\n<p>Here the solution is trivial but results in some duplication which gets worse if trying to wrap interfaces from external packages.</p>\n\n<p>Is there any down side to allowing this kind of duplication when embedding interfaces, perhaps I am underestimating the complexity for the compiler?</p>\n\n<p><strong>UPDATE</strong>\nMost of the comments seemed to miss the fact that all I had provided were interfaces (maybe Im still missing something), implementation now included with example usage for clarity</p>\n"}, {"tags": ["regex", "string", "go"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1538406867, "post_id": 52594005, "comment_id": 92122986, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/34112382/golang-issues-replacing-newlines-in-a-string-from-a-text-file\">Golang: Issues replacing newlines in a string from a text file</a>"}, {"owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1538407299, "post_id": 52594005, "comment_id": 92123240, "body": "@ttomalak I saw that, and it&#39;s what I&#39;m using for now, but I&#39;m not sure if that&#39;s as all-encompassing as <code>\\R</code> would be, especially because of this answer on stripping all Unicode newlines includes quite a bit more codepoints <a href=\"https://stackoverflow.com/a/38309489/728236\">stackoverflow.com/a/38309489/728236</a>"}], "answers": [{"tags": [], "owner": {"reputation": 481647, "user_id": 3832970, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/64323e6cf08401474da3bf770ea13b58?s=128&d=identicon&r=PG&f=1", "display_name": "Wiktor Stribi\u017cew", "link": "https://stackoverflow.com/users/3832970/wiktor-stribi%c5%bcew"}, "is_accepted": true, "score": 3, "last_activity_date": 1538409753, "last_edit_date": 1538409753, "creation_date": 1538409122, "answer_id": 52594719, "question_id": 52594005, "link": "https://stackoverflow.com/questions/52594005/golang-replace-any-and-all-newline-characters/52594719#52594719", "title": "Golang replace any and all newline characters", "body": "<p>You may \"decode\" the <code>\\R</code> pattern as</p>\n\n<pre><code>U+000DU+000A|[U+000AU+000BU+000CU+000DU+0085U+2028U+2029]\n</code></pre>\n\n<p>See the <a href=\"https://docs.oracle.com/javase/8/docs/api/java/util/regex/Pattern.html#lineending\" rel=\"nofollow noreferrer\">Java regex docs</a> explaining the <code>\\R</code> shorthand:</p>\n\n<pre><b>Linebreak matcher</b>\n\\R  Any Unicode linebreak sequence, is equivalent to \\u000D\\u000A|[\\u000A\\u000B\\u000C\\u000D\\u0085\\u2028\\u2029]</pre>\n\n<p>In Go, you may use the following:</p>\n\n<pre><code>func removeLBR(text string) string {\n    re := regexp.MustCompile(`\\x{000D}\\x{000A}|[\\x{000A}\\x{000B}\\x{000C}\\x{000D}\\x{0085}\\x{2028}\\x{2029}]`)\n    return re.ReplaceAllString(text, ``)\n}\n</code></pre>\n\n<p>Here is a <a href=\"https://play.golang.org/p/5acCKHuSgDC\" rel=\"nofollow noreferrer\">Go demo</a>.</p>\n\n<p>Some of the Unicode codes can be replaced with regex escape sequences supported by <a href=\"https://golang.org/pkg/regexp/syntax/\" rel=\"nofollow noreferrer\">Go regexp</a>:</p>\n\n<pre><code>re := regexp.MustCompile(`\\r\\n|[\\r\\n\\v\\f\\x{0085}\\x{2028}\\x{2029}]`)\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "edited": false, "score": 0, "creation_date": 1538436694, "post_id": 52600147, "comment_id": 92134829, "body": "That&#39;s certainly an impressive performance improvement, it looks like the other answer could be more perfect after all"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "edited": false, "score": 0, "creation_date": 1538437420, "post_id": 52600147, "comment_id": 92134995, "body": "@BrianLeishman If you can write the result directly into an <code>io.Writer</code>, the difference will be even bigger. See the edit at the end of the answer."}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 5, "last_activity_date": 1538463394, "last_edit_date": 1538463394, "creation_date": 1538436241, "answer_id": 52600147, "question_id": 52594005, "link": "https://stackoverflow.com/questions/52594005/golang-replace-any-and-all-newline-characters/52600147#52600147", "title": "Golang replace any and all newline characters", "body": "<p>While using regexp usually yields an elegant and compact solution, often it's not the fastest.</p>\n\n<p>For tasks where you have to replace certain substrings with others, the standard library provides a really efficient solution in the form of <a href=\"https://golang.org/pkg/strings/#Replacer\" rel=\"nofollow noreferrer\"><code>strings.Replacer</code></a>:</p>\n\n<blockquote>\n  <p>Replacer replaces a list of strings with replacements. It is safe for concurrent use by multiple goroutines.</p>\n</blockquote>\n\n<p>You may create a reusable replacer with <a href=\"https://golang.org/pkg/strings/#NewReplacer\" rel=\"nofollow noreferrer\"><code>strings.NewReplacer()</code></a>, where you list the pairs containing the replaceable parts and their replacements. When you want to perform a replacing, you simply call <a href=\"https://golang.org/pkg/strings/#Replacer.Replace\" rel=\"nofollow noreferrer\"><code>Replacer.Replace()</code></a>.</p>\n\n<p>Here's how it would look like:</p>\n\n<pre><code>const replacement = \"&lt;br&gt;\\n\"\n\nvar replacer = strings.NewReplacer(\n    \"\\r\\n\", replacement,\n    \"\\r\", replacement,\n    \"\\n\", replacement,\n    \"\\v\", replacement,\n    \"\\f\", replacement,\n    \"\\u0085\", replacement,\n    \"\\u2028\", replacement,\n    \"\\u2029\", replacement,\n)\n\nfunc replaceReplacer(s string) string {\n    return replacer.Replace(s)\n}\n</code></pre>\n\n<p>Here's how the regexp solution from <a href=\"https://stackoverflow.com/a/52594719/3832970\">Wiktor's answer</a> looks like:</p>\n\n<pre><code>var re = regexp.MustCompile(`\\r\\n|[\\r\\n\\v\\f\\x{0085}\\x{2028}\\x{2029}]`)\n\nfunc replaceRegexp(s string) string {\n    return re.ReplaceAllString(s, \"&lt;br&gt;\\n\")\n}\n</code></pre>\n\n<p>The implementation is actually quite fast. Here's a simple benchmark comparing it to the above pre-compiled regexp solution:</p>\n\n<pre><code>const input = \"1st\\nsecond\\r\\nthird\\r4th\\u0085fifth\\u2028sixth\"\n\nfunc BenchmarkReplacer(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        replaceReplacer(input)\n    }\n}\n\nfunc BenchmarkRegexp(b *testing.B) {\n    for i := 0; i &lt; b.N; i++ {\n        replaceRegexp(input)\n    }\n}\n</code></pre>\n\n<p>And the benchmark results:</p>\n\n<pre><code>BenchmarkReplacer-4      3000000               495 ns/op\nBenchmarkRegexp-4         500000              2787 ns/op\n</code></pre>\n\n<p>For our test input, <code>strings.Replacer</code> was more than <strong>5 times</strong> faster.</p>\n\n<p>There's also another advantage. In the example above we obtain the result as a new <code>string</code> value (in both solutions). This requires a new <code>string</code> allocation. If we need to write the result to an <a href=\"https://golang.org/pkg/io/#Writer\" rel=\"nofollow noreferrer\"><code>io.Writer</code></a> (e.g. we're creating an HTTP response or writing the result to a file), we can avoid having to create the new <code>string</code> in case of <code>strings.Replacer</code> as it has a handy <a href=\"https://golang.org/pkg/strings/#Replacer.WriteString\" rel=\"nofollow noreferrer\"><code>Replacer.WriteString()</code></a> method which takes an <code>io.Writer</code> and writes the result into it without allocating and returning it as a <code>string</code>. This further significantly increases the performance gain compared to the regexp solution.</p>\n"}], "owner": {"reputation": 6456, "user_id": 728236, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/SOeHR.jpg?s=128&g=1", "display_name": "Brian Leishman", "link": "https://stackoverflow.com/users/728236/brian-leishman"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4581, "favorite_count": 1, "accepted_answer_id": 52594719, "answer_count": 2, "score": 2, "last_activity_date": 1538463394, "creation_date": 1538406497, "last_edit_date": 1538436425, "question_id": 52594005, "link": "https://stackoverflow.com/questions/52594005/golang-replace-any-and-all-newline-characters", "title": "Golang replace any and all newline characters", "body": "<p>Usually, when I'm replacing newlines I jump to Regexp, like in this PHP</p>\n\n<pre><code>preg_replace('/\\R/u', \"\\n\", $String);\n</code></pre>\n\n<p>Because I know that to be a very durable way to replace any kind of Unicode newline (be it \\n, \\r, \\r\\n, etc.)</p>\n\n<p>I was trying to something like this in Go as well, but I get </p>\n\n<blockquote>\n  <p>error parsing regexp: invalid escape sequence: <code>\\R</code></p>\n</blockquote>\n\n<p>On this line</p>\n\n<pre><code>msg = regexp.MustCompilePOSIX(\"\\\\R\").ReplaceAllString(html.EscapeString(msg), \"&lt;br&gt;\\n\")\n</code></pre>\n\n<p>I tried using <code>(?:(?&gt;\\r\\n)|\\v)</code> from <a href=\"https://stackoverflow.com/a/4389171/728236\">https://stackoverflow.com/a/4389171/728236</a>, but it looks like Go's regex implementation doesn't support that either, panicking with <code>invalid or unsupported Perl syntax: '(?&gt;'</code></p>\n\n<p>What's a good, safe way to replace newlines in Go, Regex or not?</p>\n\n<hr>\n\n<p>I see this answer here <a href=\"https://stackoverflow.com/questions/34112382/golang-issues-replacing-newlines-in-a-string-from-a-text-file\">Golang: Issues replacing newlines in a string from a text file</a> saying to use <code>\\r?\\n</code>, but I'm hesitant to believe that it would get <em>all</em> Unicode newlines, mainly because of this question that has answer listing many more newline codepoints than the 3 that <code>\\r?\\n</code> covers,</p>\n"}, {"tags": ["css", "go"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1538404883, "post_id": 52593170, "comment_id": 92121831, "body": "<a href=\"https://stackoverflow.com/a/43601392/9312230\">stackoverflow.com/a/43601392/9312230</a> this probably will help you. TL;DR; this code to serve file will resolve your issue <code>http.Handle(&quot;&#47;css&#47;&quot;, http.StripPrefix(&quot;&#47;css&#47;&quot;, http.FileServer(http.Dir(&quot;css&quot;))))</code>"}, {"owner": {"reputation": 1189, "user_id": 9288348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ug2H4.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/9288348/jeremy"}, "reply_to_user": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1538405250, "post_id": 52593170, "comment_id": 92122092, "body": "oh, I saw this post and copied that code ones. I just thought the stripPrefix and all that stuff was unnecessary code so deleted that part. O.o"}], "answers": [{"comments": [{"owner": {"reputation": 1189, "user_id": 9288348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ug2H4.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/9288348/jeremy"}, "edited": false, "score": 0, "creation_date": 1538405313, "post_id": 52593525, "comment_id": 92122139, "body": "This kinda goes above my knowledge that I have till now. <code>http.Handle(&quot;&#47;css&#47;&quot;, http.StripPrefix(&quot;&#47;css&#47;&quot;, http.FileServer(http.Dir(&quot;css&quot;))))</code>  from the answer from @ttomlak was the solution"}, {"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 0, "creation_date": 1538405474, "post_id": 52593525, "comment_id": 92122227, "body": "MIME-type wasn&#39;t the real issue in your code. It returned that because on <code>&#47;css&#47;style.css</code> something like <code>404 not found</code> was returned which is <code>plaintext</code>"}, {"owner": {"reputation": 673, "user_id": 5872733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NI2iu.jpg?s=128&g=1", "display_name": "epanalepsis", "link": "https://stackoverflow.com/users/5872733/epanalepsis"}, "edited": false, "score": 0, "creation_date": 1538406035, "post_id": 52593525, "comment_id": 92122538, "body": "Well, I don&#39;t see a 404 in that console. And you should <b>always</b> provide the mime type."}], "tags": [], "owner": {"reputation": 673, "user_id": 5872733, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/NI2iu.jpg?s=128&g=1", "display_name": "epanalepsis", "link": "https://stackoverflow.com/users/5872733/epanalepsis"}, "is_accepted": false, "score": -1, "last_activity_date": 1538404818, "creation_date": 1538404818, "answer_id": 52593525, "question_id": 52593170, "link": "https://stackoverflow.com/questions/52593170/style-css-imported-with-go-gives-a-mime-error/52593525#52593525", "title": "Style.css imported with GO gives a MIME error", "body": "<p>You have to add the mime type for css files in your response header. </p>\n\n<pre><code>    if strings.HasSuffix(path, \".css\") {\n        w.Header().Add(\"Content-Type\", \"text/css\")\n    } \n</code></pre>\n\n<p>Or something similar with a variable for multiple different mime types.</p>\n\n<p>EDIT: </p>\n\n<p>Please also check this go lang package to include for better mime type handling:</p>\n\n<p><a href=\"https://golang.org/pkg/mime/\" rel=\"nofollow noreferrer\">https://golang.org/pkg/mime/</a> </p>\n"}, {"tags": [], "owner": {"reputation": 46, "user_id": 1532153, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/1BkQR.jpg?s=128&g=1", "display_name": "Lafriakh", "link": "https://stackoverflow.com/users/1532153/lafriakh"}, "is_accepted": true, "score": 1, "last_activity_date": 1538405870, "creation_date": 1538405870, "answer_id": 52593839, "question_id": 52593170, "link": "https://stackoverflow.com/questions/52593170/style-css-imported-with-go-gives-a-mime-error/52593839#52593839", "title": "Style.css imported with GO gives a MIME error", "body": "<p>Your handle return 404 when you try to access css file from this url: <code>/css/*</code></p>\n\n<p>Change your css handle with this:</p>\n\n<pre><code>    http.Handle(\"/css/\", http.StripPrefix(\"/css/\", http.FileServer(http.Dir(\"./css\"))))\n</code></pre>\n\n<p>*You got 'text/plain' because the 404 is a plain text.</p>\n"}], "owner": {"reputation": 1189, "user_id": 9288348, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/ug2H4.jpg?s=128&g=1", "display_name": "Jeremy", "link": "https://stackoverflow.com/users/9288348/jeremy"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 72, "favorite_count": 0, "closed_date": 1538405977, "accepted_answer_id": 52593839, "answer_count": 2, "score": 0, "last_activity_date": 1538405870, "creation_date": 1538403570, "question_id": 52593170, "link": "https://stackoverflow.com/questions/52593170/style-css-imported-with-go-gives-a-mime-error", "closed_reason": "Duplicate", "title": "Style.css imported with GO gives a MIME error", "body": "<p>I just started learning go and 1 of the things I really wanna learn to do is making sites in go. I watched some tutorials for it and making sites worked, but I didn't know how to add styles.</p>\n\n<p>I searched for some examples on the internet and stackoverflow, but couldn't find one that actually worked for me (and stayed simple). </p>\n\n<p>Underneath is the code that I ended up with.\nBut I think I got a new problem now cause in the console it says: \n<a href=\"https://i.stack.imgur.com/eGtBs.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/eGtBs.png\" alt=\"error\"></a></p>\n\n<p>I tried a lot of solutions that I found on the internet for this but none of them worked so I am pretty sure it is because I imported the css wrongly in go.</p>\n\n<p><strong>Go (functions.go):</strong></p>\n\n<pre><code>package main\n\nimport (\n    \"html/template\"\n    \"net/http\"\n)\n\ntype IndexPage struct {\n    Title string\n    SubTitle string\n}\n\nfunc indexHandler(w http.ResponseWriter, r *http.Request){\n    p := IndexPage{Title: \"Pizza site\", SubTitle: \"everyone loves pizzas\"} \n    t, _ := template.ParseFiles(\"index.html\")\n    t.Execute(w,p)\n}\n\nfunc main() {\n\n    http.HandleFunc(\"/\", indexHandler)\n    http.Handle(\"/css/\", http.FileServer(http.Dir(\"css\")))\n    http.ListenAndServe(\":8080\", nil)\n}\n</code></pre>\n\n<p><strong>Html (index.html):</strong></p>\n\n<pre><code>&lt;html lang=\"nl\"&gt;\n&lt;head&gt;\n  &lt;meta charset=\"utf-8\"&gt;\n  &lt;title&gt;Pizzaaaaaaa&lt;/title&gt;\n  &lt;link rel=\"stylesheet\" href=\"css/style.css\" type=\"text/css\"&gt;\n&lt;/head&gt;\n&lt;body&gt;\n    &lt;article&gt;\n        &lt;h1&gt;\n            {{ .Title }}\n            &lt;span class=\"subtitle\"&gt;{{ .SubTitle }}&lt;/span&gt;\n        &lt;/h1&gt;\n        &lt;p&gt;Some text&lt;/p&gt;\n    &lt;/article&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre>\n\n<p><strong>CSS ( /css/style.css )</strong></p>\n\n<pre><code>*{\n    color: rgb(250, 157, 157);\n}\n</code></pre>\n\n<p><strong>FileTree</strong></p>\n\n<p><a href=\"https://i.stack.imgur.com/1ts5a.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/1ts5a.png\" alt=\"FileTree\"></a></p>\n"}, {"tags": ["go", "memory-management"], "comments": [{"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 1, "creation_date": 1538403652, "post_id": 52592951, "comment_id": 92121076, "body": "What is the problem you&#39;re trying to solve?  It sounds like your program just isn&#39;t using as much memory as you expect--but why is that problematic?"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1538403691, "post_id": 52592951, "comment_id": 92121106, "body": "Go will use the amount of memory it needs, what are you expected to take up the memory if the program doesn&#39;t need it?"}, {"owner": {"reputation": 105, "user_id": 2191415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z0kKm.jpg?s=128&g=1", "display_name": "sup", "link": "https://stackoverflow.com/users/2191415/sup"}, "reply_to_user": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1538404890, "post_id": 52592951, "comment_id": 92121842, "body": "@Flimzy issue i&#39;m trying to address is the performance of excel generation, i have optimised my PSQL (the RDBMS currently used by my go application) relation to the point that it returns 3.5million rows within few seconds, however when processing this dataset in go (basically into excel&#39;s Row/Column format) to generate excel out of it, takes huge amount of time. Like ~8mins or so for half a million rows and 7 columns"}, {"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1538405060, "post_id": 52592951, "comment_id": 92121942, "body": "@sup: the only trade-off you could make is to allow GC to use more memory, but you first need to determine if GC is your bottleneck in the first place"}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1538405062, "post_id": 52592951, "comment_id": 92121946, "body": "Have it piecemeal. Start with disabling Excel-everything first\u2014that is, just crunch the data and throw the results away (not literally\u2014make sure you, say, <code>fmt.Print()</code> them into <code>io&#47;ioutil.Discard</code> for the compiler to not optimize your code away completely), and measure how it goes. If it&#39;s slow, <i>profile,</i> or at least come up with a simple MCVE for us to squint at your code."}, {"owner": {"reputation": 105, "user_id": 2191415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z0kKm.jpg?s=128&g=1", "display_name": "sup", "link": "https://stackoverflow.com/users/2191415/sup"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 1, "creation_date": 1538405067, "post_id": 52592951, "comment_id": 92121952, "body": "@JimB As mentioned in my question, and i may be wrong about it, but i think that since go is not really using much memory and likely trying to work with limited (if there is a default memory consumption defined) memory and calling GC too often ."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "edited": false, "score": 1, "creation_date": 1538405204, "post_id": 52592951, "comment_id": 92122059, "body": "So, in the end, this question appears as a classical case of the <a href=\"https://meta.stackexchange.com/a/66378\">XY Problem</a>. @sup, please consider first breaking your problem down into logical pieces\u2014fetching data from the DBMS, processing it, making an Excel document of it,\u2014then profile, then try to come up with different question(s) with the concrete problems you will have identified by then."}], "answers": [{"comments": [{"owner": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1538404002, "post_id": 52593254, "comment_id": 92121290, "body": "<code>-Xmx</code> isn&#39;t really related to GC though, it&#39;s just the max heap size, which of course you can&#39;t really adjust in Go."}, {"owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "reply_to_user": {"reputation": 86274, "user_id": 32880, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/35b00dd652b316f6cd6bb5c12c5be999?s=128&d=identicon&r=PG", "display_name": "JimB", "link": "https://stackoverflow.com/users/32880/jimb"}, "edited": false, "score": 0, "creation_date": 1538404889, "post_id": 52593254, "comment_id": 92121840, "body": "@JimB, sure, but a more relevant knob is likely to appear\u2014see the <a href=\"https://blog.golang.org/ismmkeynote\" rel=\"nofollow noreferrer\">sort-of announce</a> and <a href=\"https://github.com/golang/go/issues/16843\" rel=\"nofollow noreferrer\">the relevant issue</a>. It won&#39;t be about limiting the heap usage (which is useless anyway\u2014as any seasoned Java developer knows from hard-won experience) but rather about providing feedback to the running program about reaching the memory limits."}, {"owner": {"reputation": 105, "user_id": 2191415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z0kKm.jpg?s=128&g=1", "display_name": "sup", "link": "https://stackoverflow.com/users/2191415/sup"}, "edited": false, "score": 0, "creation_date": 1538405272, "post_id": 52593254, "comment_id": 92122108, "body": "@kostix thank you for the explanation, this defintely helps in furthering my understanding. Will be working on what you suggested / commented above."}], "tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": true, "score": 4, "last_activity_date": 1538406471, "last_edit_date": 1538406471, "creation_date": 1538403864, "answer_id": 52593254, "question_id": 52592951, "link": "https://stackoverflow.com/questions/52592951/how-could-i-make-a-go-program-use-more-memory-is-that-recommended/52593254#52593254", "title": "How could I make a Go program use more memory? Is that recommended?", "body": "<p>The current stable Go (1.10) has only a single knob which may be used to trade memory for lower CPU usage by the garbage collection the Go runtime performs.\nThis knob is called <code>GOGC</code>, and its description reads</p>\n\n<blockquote>\n  <p>The <code>GOGC</code> variable sets the initial garbage collection target percentage. A collection is triggered when the ratio of freshly allocated data to live data remaining after the previous collection reaches this percentage. The default is <code>GOGC=100</code>. Setting <code>GOGC=off</code> disables the garbage collector entirely. The <code>runtime/debug</code> package's <code>SetGCPercent</code> function allows changing this percentage at run time. See <a href=\"https://golang.org/pkg/runtime/debug/#SetGCPercent\" rel=\"nofollow noreferrer\">https://golang.org/pkg/runtime/debug/#SetGCPercent</a>.</p>\n</blockquote>\n\n<p>So basically setting it to <code>200</code> would supposedly double the amount of memory the Go runtime of your running process may use.</p>\n\n<p>Having said that I'd note that the Go runtime actually tries to adjust the behaviour of its garbage collector to the workload of your running program and the CPU processing power at hand.\nI mean, that normally there's nothing wrong with your program not consuming lots of RAM\u2014if the collector happens to sweep the garbage fast enough without hampering the performance in a significant way, I see no reason to worry about: the Go's GC is\none of the points of the most intense fine-tuning in the runtime,\nand works <em>very</em> good in fact.</p>\n\n<p>Hence you may try to take another route:</p>\n\n<ul>\n<li><p>Profile memory allocations of your program.\nAnalyze the profile and try to figure out where the hot spots\nare, and whether (and how) they can be optimized.</p>\n\n<p>You might start <a href=\"https://blog.golang.org/profiling-go-programs\" rel=\"nofollow noreferrer\">here</a>\nand continue with the gazillion other\n<a href=\"https://www.google.com/search?q=profiling+go+programs\" rel=\"nofollow noreferrer\">intros</a> to this stuff.</p></li>\n<li><p>Optimize. Typically this amounts to making certain buffers\nreusable across different calls to the same function(s)\nconsuming them, preallocating slices instead of growing them\ngradually, using <code>sync.Pool</code> where deemed useful etc.</p>\n\n<p>Such measures may actually increase the memory\ntruly used (that is, by live objects\u2014as opposed to\ngarbage) but it may lower the pressure on the GC.</p></li>\n</ul>\n"}], "owner": {"reputation": 105, "user_id": 2191415, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/Z0kKm.jpg?s=128&g=1", "display_name": "sup", "link": "https://stackoverflow.com/users/2191415/sup"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2039, "favorite_count": 1, "accepted_answer_id": 52593254, "answer_count": 1, "score": 2, "last_activity_date": 1538406471, "creation_date": 1538402828, "last_edit_date": 1538403236, "question_id": 52592951, "link": "https://stackoverflow.com/questions/52592951/how-could-i-make-a-go-program-use-more-memory-is-that-recommended", "title": "How could I make a Go program use more memory? Is that recommended?", "body": "<p>I'm looking for option something similar to <code>-Xmx</code> in Java, that is to assign maximum runtime memory that my Go application can utilise. Was checking the <a href=\"https://golang.org/pkg/runtime/#MemStatsType\" rel=\"nofollow noreferrer\">runtime</a> , but not entirely if that is the way to go.</p>\n\n<p>I tried setting something like this with func SetMaxStack(), (likely very stupid)</p>\n\n<pre><code>debug.SetMaxStack(5000000000) // bytes\nmodel.ExcelCreator()\n</code></pre>\n\n<p>The reason why I am looking to do this is because currently there is ample amount of RAM available but the application won't consume more than 4-6% , I might be wrong here but it could be forcing GC to happen much faster than needed leading to performance issue.</p>\n\n<p>What I'm doing</p>\n\n<p>Getting large dataset from RDBMS system , processing it to write out in excel.</p>\n\n<p>Another reason why I am looking for such an option is to limit the maximum usage of RAM on the server where it will be ultimately deployed.</p>\n\n<p>Any hints on this would greatly appreciated.</p>\n"}, {"tags": ["go", "ginkgo"], "comments": [{"owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "edited": false, "score": 1, "creation_date": 1538405789, "post_id": 52592947, "comment_id": 92122407, "body": "I&#39;m not familiar with ginkgo but if you run <code>ginkgo -r</code> in your root catalog it should run all tests. <code>-r</code> option is described in documentation as <code>will recursively find and run all spec suites in the current directory</code>"}], "answers": [{"tags": [], "owner": {"reputation": 253, "user_id": 1398500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf7b332b8ec80a4eaf7b06ad2525af6?s=128&d=identicon&r=PG", "display_name": "Artem", "link": "https://stackoverflow.com/users/1398500/artem"}, "is_accepted": false, "score": 0, "last_activity_date": 1538406051, "creation_date": 1538406051, "answer_id": 52593891, "question_id": 52592947, "link": "https://stackoverflow.com/questions/52592947/ginkgo-package-testing/52593891#52593891", "title": "Ginkgo package testing", "body": "<p>@ttomalak thank you! It's exactly what I wanted</p>\n\n<p><code>$ ginkgo -r</code><br>\n<a href=\"https://i.stack.imgur.com/wJn8C.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/wJn8C.png\" alt=\"enter image description here\"></a></p>\n"}, {"tags": [], "owner": {"reputation": 1557, "user_id": 9312230, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e9b3dcc612cd8349643900e1ca2b860?s=128&d=identicon&r=PG&f=1", "display_name": "ttomalak", "link": "https://stackoverflow.com/users/9312230/ttomalak"}, "is_accepted": true, "score": 3, "last_activity_date": 1538406520, "creation_date": 1538406520, "answer_id": 52594015, "question_id": 52592947, "link": "https://stackoverflow.com/questions/52592947/ginkgo-package-testing/52594015#52594015", "title": "Ginkgo package testing", "body": "<p>To run all test suits you should run this in command in your root catalog</p>\n\n<p><code>ginkgo -r</code> </p>\n\n<p>Also is good practice as in normal test suits to run all test with race detector, also you could shuffle some test. You can run all this option by using</p>\n\n<p><code>ginkgo -r --race --randomizeAllSpecs --randomizeSuites</code></p>\n"}], "owner": {"reputation": 253, "user_id": 1398500, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/aaf7b332b8ec80a4eaf7b06ad2525af6?s=128&d=identicon&r=PG", "display_name": "Artem", "link": "https://stackoverflow.com/users/1398500/artem"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 373, "favorite_count": 0, "accepted_answer_id": 52594015, "answer_count": 2, "score": 0, "last_activity_date": 1538406520, "creation_date": 1538402820, "question_id": 52592947, "link": "https://stackoverflow.com/questions/52592947/ginkgo-package-testing", "title": "Ginkgo package testing", "body": "<p>I'm implementing test suite for brand new go app and decided to use <a href=\"http://onsi.github.io/ginkgo/%20ginkgo\" rel=\"nofollow noreferrer\">ginkgo</a>. The app has main function and several packages  </p>\n\n<pre><code>.\n|- main.go\n|- types\n|  |-- user.go\n|  |-- post.go\n|- server_pkg \n|  |-- users_controller.go\n|  |-- posts_controller.go\n|- worker_pkg\n|  |-- users_worker.go\n|  |-- posts_worker.go\n</code></pre>\n\n<p>I ran <code>ginkgo bootstrap</code> in each package folder and added test files using <code>ginkgo generate</code>. Now I'm able to run tests for each package separately i.e.<br>\n<code>cd server_pkg; ginkgo</code> </p>\n\n<p>The question is that: how to configure my application to run all tests for main function and packages using single command?  </p>\n\n<p>I can chain commands like <code>ginkgo; cd server_pkg; ginkgo ...</code>, but it does not look like good solution.</p>\n"}, {"tags": ["go", "dependency-management", "godeps"], "comments": [{"owner": {"reputation": 2178, "user_id": 3067964, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/CvonS.jpg?s=128&g=1", "display_name": "jwells131313", "link": "https://stackoverflow.com/users/3067964/jwells131313"}, "edited": false, "score": 0, "creation_date": 1538402240, "post_id": 52592438, "comment_id": 92120173, "body": "Run &quot;echo $GOPATH&quot; and lets make sure that is correct"}, {"owner": {"reputation": 22623, "user_id": 147175, "user_type": "registered", "accept_rate": 93, "profile_image": "https://i.stack.imgur.com/PyWe3.jpg?s=128&g=1", "display_name": "Scott Stensland", "link": "https://stackoverflow.com/users/147175/scott-stensland"}, "edited": false, "score": 0, "creation_date": 1538406440, "post_id": 52592438, "comment_id": 92122759, "body": "why do you have an underbar in front of that package path ?"}, {"owner": {"reputation": 1574, "user_id": 1461499, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bOMwp.jpg?s=128&g=1", "display_name": "Alex Tbk", "link": "https://stackoverflow.com/users/1461499/alex-tbk"}, "edited": false, "score": 0, "creation_date": 1538407355, "post_id": 52592438, "comment_id": 92123272, "body": "I added the answers to the first posting. I have no idea why there is a underscore."}, {"owner": {"reputation": 1639, "user_id": 7187655, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/hvz9T.png?s=128&g=1", "display_name": "Motakjuq", "link": "https://stackoverflow.com/users/7187655/motakjuq"}, "edited": false, "score": 0, "creation_date": 1538448926, "post_id": 52592438, "comment_id": 92137123, "body": "What are the imports for the file <code>scsApiGateway.go</code>. The error shows a problem with that."}], "answers": [{"tags": [], "owner": {"reputation": 1574, "user_id": 1461499, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bOMwp.jpg?s=128&g=1", "display_name": "Alex Tbk", "link": "https://stackoverflow.com/users/1461499/alex-tbk"}, "is_accepted": true, "score": 0, "last_activity_date": 1538410257, "creation_date": 1538410257, "answer_id": 52595010, "question_id": 52592438, "link": "https://stackoverflow.com/questions/52592438/problems-with-dependencies-after-setting-up-go-dep/52595010#52595010", "title": "Problems with dependencies after setting up go dep", "body": "<p>I think this is resolved now. I was running into this problem:\n<a href=\"https://github.com/Masterminds/glide/issues/602\" rel=\"nofollow noreferrer\">https://github.com/Masterminds/glide/issues/602</a></p>\n\n<p>After reading this:\n<a href=\"https://thenewstack.io/understanding-golang-packages/\" rel=\"nofollow noreferrer\">https://thenewstack.io/understanding-golang-packages/</a></p>\n\n<p>I setup my project structure as follows:</p>\n\n<pre><code>/home/dev/go/src/smp-cloudupload\n    pkg \n    src\n        main\n        somepackage\n        vendor\n</code></pre>\n\n<p>And it seems to work</p>\n"}], "owner": {"reputation": 1574, "user_id": 1461499, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/bOMwp.jpg?s=128&g=1", "display_name": "Alex Tbk", "link": "https://stackoverflow.com/users/1461499/alex-tbk"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 107, "favorite_count": 0, "accepted_answer_id": 52595010, "answer_count": 1, "score": 0, "last_activity_date": 1538410257, "creation_date": 1538401127, "last_edit_date": 1538407330, "question_id": 52592438, "link": "https://stackoverflow.com/questions/52592438/problems-with-dependencies-after-setting-up-go-dep", "title": "Problems with dependencies after setting up go dep", "body": "<p>My project is located in <code>$GOPATH/src/smp-cloudupload</code> </p>\n\n<p>I can run <code>dep init</code> without errors.\nAfter that I cant compile the project anymore. One of the errors:</p>\n\n<pre><code>main/scs/scsApiGateway.go:5:2: cannot find package \"_/home/dev/go/src/smp-cloudupload/vendor/github.com/dgrijalva/jwt-go\" in any of:\n/usr/lib/go-1.10/src/_/home/dev/go/src/smp-cloudupload/vendor/github.com/dgrijalva/jwt-go (from $GOROOT)\n/home/dev/go/src/_/home/dev/go/src/smp-cloudupload/vendor/github.com/dgrijalva/jwt-go (from $GOPATH)\n</code></pre>\n\n<p>I am new to GO and I have a feeling, that there are either issues with my project structure or the GOPATH. The shown path is wrong. The correct path is: <code>/home/dev/go/src/smp-cloudupload/vendor/github.com/dgrijalva/jwt-go</code></p>\n\n<p>What am I doing wrong?</p>\n\n<p><strong>EDIT:</strong></p>\n\n<p>Output of <code>echo $GOPATH</code>:\ndev@dev-VirtualBox:~/go/src/smp-cloudupload/main$ echo $GOPATH</p>\n\n<pre><code>/home/dev/go\n</code></pre>\n\n<p>I have no idea why there is a underscore in the path. The actual path of my project contains no underscores</p>\n"}, {"tags": ["go", "revel"], "comments": [{"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1538401276, "post_id": 52591806, "comment_id": 92119575, "body": "Can you tell us your version of go?"}, {"owner": {"reputation": 117, "user_id": 9179796, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/37bda3c7c5f88fadbac7a3cd7a8568e8?s=128&d=identicon&r=PG&f=1", "display_name": "hfbachri_", "link": "https://stackoverflow.com/users/9179796/hfbachri"}, "reply_to_user": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1538401483, "post_id": 52591806, "comment_id": 92119696, "body": "go1.11 windows/amd64 @yorodm"}, {"owner": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1538401912, "post_id": 52591806, "comment_id": 92119958, "body": "Yeah, this seems to be an unresolved issue <a href=\"https://github.com/revel/revel/issues/747\" rel=\"nofollow noreferrer\">github.com/revel/revel/issues/747</a>"}, {"owner": {"reputation": 117, "user_id": 9179796, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/37bda3c7c5f88fadbac7a3cd7a8568e8?s=128&d=identicon&r=PG&f=1", "display_name": "hfbachri_", "link": "https://stackoverflow.com/users/9179796/hfbachri"}, "reply_to_user": {"reputation": 3467, "user_id": 3393308, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/9a3f30f7c191e8d556c70c951fe3d9af?s=128&d=identicon&r=PG", "display_name": "yorodm", "link": "https://stackoverflow.com/users/3393308/yorodm"}, "edited": false, "score": 0, "creation_date": 1538403759, "post_id": 52591806, "comment_id": 92121161, "body": "help to vote up pls @yorodm"}], "owner": {"reputation": 117, "user_id": 9179796, "user_type": "registered", "accept_rate": 0, "profile_image": "https://www.gravatar.com/avatar/37bda3c7c5f88fadbac7a3cd7a8568e8?s=128&d=identicon&r=PG&f=1", "display_name": "hfbachri_", "link": "https://stackoverflow.com/users/9179796/hfbachri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 189, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538399012, "creation_date": 1538399012, "last_edit_date": 1592644375, "question_id": 52591806, "link": "https://stackoverflow.com/questions/52591806/error-while-get-revel-framework-with-go-get", "title": "Error while get revel framework with go get", "body": "<p>I want to install Revel framework with</p>\n<blockquote>\n<p>go get github.com/revel/revel</p>\n</blockquote>\n<p>I run it and I got error:</p>\n<blockquote>\n<p>C:/Users/User/go&gt;go get github.com/revel/revel</p>\n<p>github.com revel/revel</p>\n<p>src\\github.com\\revel\\revel\\server_adapter_go.go:135:79: undefined:\nsyscall.SIGUSR2</p>\n</blockquote>\n<p>My GOPATH var is <code>C:/Users/User/go</code></p>\n<p>The bin folder was created inside my GOPATH folder. But when I tried to run sample app, it produced similar error</p>\n<blockquote>\n<p>The Go code src\\github.com\\revel\\revel\\server_adapter_go.go does not\ncompile: undefined: syscall.SIGUSR2</p>\n</blockquote>\n<p>Please help. Thanks</p>\n"}, {"tags": ["go", "formatting"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538400177, "post_id": 52591678, "comment_id": 92118887, "body": "Isn&#39;t obtaining its value as <code>float64</code> and formatting that sufficient? <code>x, _ := rat.Float64(); prEn.Printf(&quot;%20.6f\\n&quot;, x)</code> yields your desired output."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538400462, "post_id": 52591678, "comment_id": 92119099, "body": "In this particular case, yes. But when I need more precision or I need the precision to be guaranteed this won&#39;t cut it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1538402935, "post_id": 52591678, "comment_id": 92120599, "body": "It looks this is currently not supported but &quot;planned&quot;. See <code>text&#47;internal&#47;number&#47;decimal.go</code> <a href=\"https://github.com/golang/text/blob/master/internal/number/decimal.go#L308\" rel=\"nofollow noreferrer\">currently line #308</a>."}, {"owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538403317, "post_id": 52591678, "comment_id": 92120865, "body": "I see. Thanks for investigating. I&#39;ll see what can be done with that."}], "owner": {"reputation": 27854, "user_id": 1892060, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e50f7bd50bf166113e2fbcf94eb9ab76?s=128&d=identicon&r=PG", "display_name": "Ainar-G", "link": "https://stackoverflow.com/users/1892060/ainar-g"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 133, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538398602, "creation_date": 1538398602, "question_id": 52591678, "link": "https://stackoverflow.com/questions/52591678/formatting-big-rat-using-golang-org-x-text-message", "title": "Formatting big.Rat using golang.org/x/text/message", "body": "<p>The package <a href=\"https://godoc.org/golang.org/x/text/message\" rel=\"nofollow noreferrer\"><code>golang.org/x/text/message</code></a> allows us to format numbers using national formats:</p>\n\n<pre class=\"lang-golang prettyprint-override\"><code>const n = 1222333.444555\n\nprEn := message.NewPrinter(language.English)\nprEn.Printf(\"%20.6f\\n\", n)\n// Prints:\n//     1,222,333.444555\n\nprRu := message.NewPrinter(language.Russian)\nprRu.Printf(\"%20.6f\\n\", n)\n// Prints:\n//     1 222 333,444555\n</code></pre>\n\n<p>Can I use it with <code>math/big.Rat</code>? That is, something like (doesn't work):</p>\n\n<pre><code>rat := big.NewRat(1222333444555, 1000000)\nprEn.Printf(\"%20.6f\\n\", rat.FloatString(6))\n// Should print:\n//     1,222,333.444555\n</code></pre>\n\n<p>I know that I can wrap <code>Rat</code> in my own type and implement <a href=\"https://golang.org/pkg/fmt/#Formatter\" rel=\"nofollow noreferrer\"><code>fmt.Formatter</code></a>, but maybe there is a built-in way already?</p>\n"}, {"tags": ["docker", "go", "kubernetes", "openshift", "glide-golang"], "comments": [{"owner": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "edited": false, "score": 1, "creation_date": 1538455939, "post_id": 52590669, "comment_id": 92138531, "body": "It really looks like a <code>glide</code> bug. What glide version are you using?"}, {"owner": {"reputation": 2719, "user_id": 4177876, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/i7xAG.jpg?s=128&g=1", "display_name": "Seenu S", "link": "https://stackoverflow.com/users/4177876/seenu-s"}, "reply_to_user": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "edited": false, "score": 0, "creation_date": 1538459031, "post_id": 52590669, "comment_id": 92139274, "body": "I was using the glide version 0.13.1-3"}, {"owner": {"reputation": 2719, "user_id": 4177876, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/i7xAG.jpg?s=128&g=1", "display_name": "Seenu S", "link": "https://stackoverflow.com/users/4177876/seenu-s"}, "reply_to_user": {"reputation": 48205, "user_id": 2989261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b03110b84c83464a58832d4d55ff4542?s=128&d=identicon&r=PG", "display_name": "Rico", "link": "https://stackoverflow.com/users/2989261/rico"}, "edited": false, "score": 1, "creation_date": 1538571035, "post_id": 52590669, "comment_id": 92188275, "body": "The issue is fixed by updating the go to 1.11 and glide to 13.2 versions."}], "owner": {"reputation": 2719, "user_id": 4177876, "user_type": "registered", "accept_rate": 38, "profile_image": "https://i.stack.imgur.com/i7xAG.jpg?s=128&g=1", "display_name": "Seenu S", "link": "https://stackoverflow.com/users/4177876/seenu-s"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 46, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1553436494, "creation_date": 1538395306, "last_edit_date": 1592644375, "question_id": 52590669, "link": "https://stackoverflow.com/questions/52590669/facing-an-issue-in-setup-docker-distribution-library-using-glide", "title": "Facing an issue in setup docker distribution library using glide", "body": "<p>I have been trying to set up the <code>github.com/docker/distribution/</code> library in my local machine using the <code>glide up -v</code>. I have other dependent libraries kubernetes, openshift with docker. Installing setup if failing.</p>\n<h1>I was getting the following errors:</h1>\n<pre><code>[INFO]  Project relies on 54 dependencies.\n[INFO]  Removing nested vendor and Godeps/_workspace directories...\n[INFO]  Removing: /vendor/github.com/docker/distribution/vendor\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal SIGSEGV: segmentation violation code=0x1 addr=0x30 pc=0x6fdc82]\n\ngoroutine 1 [running]: github.com/Masterminds/glide/path.StripVendor.func1(0xc42054a420, 0x60, 0x0, 0x0, 0x8f3160, 0xc4202d70e0, 0x0, 0x0)\n/home/vagrant/go/src/github.com/Masterminds/glide/path/strip.go:28 +0x42 path/filepath.walk(0xc4205e8900, 0x55, 0x8fa0e0, 0xc420555520, 0xc4203be880, 0x0, 0x0)\n/usr/lib/go-1.10/src/path/filepath/path.go:377 +0x20d path/filepath.walk(0xc4204f8f50, 0x4e, 0x8fa0e0, 0xc4201c41a0, 0xc4203be880, 0x0, 0x0)\n/usr/lib/go-1.10/src/path/filepath/path.go:381 +0x2c2 path/filepath.walk(0xc4204f8e60, 0x41, 0x8fa0e0, 0xc4201c40d0, 0xc4203be880, 0x0, 0x0)\n/usr/lib/go-1.10/src/path/filepath/path.go:381 +0x2c2 path/filepath.walk(0xc420342580, 0x3a, 0x8fa0e0, 0xc4205dc5b0, 0xc4203be880, 0x0, 0x0)\n/usr/lib/go-1.10/src/path/filepath/path.go:381 +0x2c2 path/filepath.walk(0xc4203edf50, 0x2f, 0x8fa0e0, 0xc4205dc410, 0xc4203be880, 0x0, 0x20)\n/usr/lib/go-1.10/src/path/filepath/path.go:381 +0x2c2 path/filepath.Walk(0xc4203edf50, 0x2f, 0xc4203be880, 0xc4205dc340, 0x0)\n/usr/lib/go-1.10/src/path/filepath/path.go:403 +0x106 \ngithub.com/Masterminds/glide/path.StripVendor(0x8b0354, 0x3b)\n/home/vagrant/go/src/github.com/Masterminds/glide/path/strip.go:22 +0x10a\ngithub.com/Masterminds/glide/action.Update(0xc4201b4680, 0x890100)\n/home/vagrant/go/src/github.com/Masterminds/glide/action/update.go:108 +0x291 main.commands.func13(0xc4200d6f20, 0x0, 0xc4200d6f20)\n/home/vagrant/go/src/github.com/Masterminds/glide/glide.go:634 +0x354\ngithub.com/Masterminds/glide/vendor/github.com/codegangsta\n/cli.HandleAction(0x811280, 0x8ba958, 0xc4200d6f20, 0xc42006d200, 0x0)\n/home/vagrant/go/src/github.com/Masterminds/glide/vendor/github.com/codegangsta/cli/app.go:490 +0xc8\n github.com/Masterminds/glide/vendor/github.com/codegangsta/cli.Command.Run(0x8999f4, 0x6, 0x898661, 0x2, 0x0, 0x0, 0x0, 0x8a5188, 0x1f, 0x0, ...)\n/home/vagrant/go/src/github.com/Masterminds/glide/vendor/github.com/codegangsta/cli/command.go:210 +0xa36\ngithub.com/Masterminds/glide/vendor/github.com/codegangsta/cli.(*App).Run(0xc42008b1e0, 0xc42001e090, 0x3, 0x3, 0x0, 0x0)\n/home/vagrant/go/src/github.com/Masterminds/glide/vendor/github.com/codegangsta/cli/app.go:255 +0x6a0 main.main()\n/home/vagrant/go/src/github.com/Masterminds/glide/glide.go:104 +0x5a9\n</code></pre>\n"}, {"tags": ["http", "go", "httprequest", "httpcontext", "revel"], "answers": [{"tags": [], "owner": {"reputation": 2957, "user_id": 1248436, "user_type": "registered", "accept_rate": 76, "profile_image": "https://www.gravatar.com/avatar/120a039571e907a64bcfbafda75d472b?s=128&d=identicon&r=PG", "display_name": "mtyurt", "link": "https://stackoverflow.com/users/1248436/mtyurt"}, "is_accepted": false, "score": 1, "last_activity_date": 1538395290, "creation_date": 1538395290, "answer_id": 52590664, "question_id": 52590159, "link": "https://stackoverflow.com/questions/52590159/how-to-get-initial-timestamp-of-a-http-request-in-golang/52590664#52590664", "title": "How to get initial timestamp of a http request in golang?", "body": "<p>HttpContext class in .Net framework <a href=\"https://referencesource.microsoft.com/#System.Web/HttpContext.cs,476\" rel=\"nofollow noreferrer\">sets the timestamp when a request arrives at the server</a>. You might as well store the timestamp in the first line of your request handler function.</p>\n"}, {"tags": [], "owner": {"reputation": 3800, "user_id": 1037465, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6b68d0fdfc74f6a893936d043d2f545b?s=128&d=identicon&r=PG", "display_name": "a-h", "link": "https://stackoverflow.com/users/1037465/a-h"}, "is_accepted": false, "score": 0, "last_activity_date": 1538417157, "creation_date": 1538417157, "answer_id": 52596531, "question_id": 52590159, "link": "https://stackoverflow.com/questions/52590159/how-to-get-initial-timestamp-of-a-http-request-in-golang/52596531#52596531", "title": "How to get initial timestamp of a http request in golang?", "body": "<p>The simplest thing to do is grab the current time within your handler.</p>\n\n<pre><code>type Handler struct {\n}\n\nfunc (h Handler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n  rs := time.Now().UTC()\n\n  //TODO: Use the time.\n}\n</code></pre>\n\n<p>If you want to measure the time taken by all middleware preceding your handler, then you can update the Go context and place your middleware at the start of your middleware chain.</p>\n\n<p>Here's an example of what that middleware might look like:</p>\n\n<pre><code>package timemiddleware\n\nimport (\n    \"context\"\n    \"net/http\"\n    \"time\"\n)\n\n// New returns new middleware which tracks the time that a request started.\nfunc New(next http.Handler) http.Handler {\n    return handler{\n        next: next,\n    }\n}\n\ntype key int\n\nconst id = key(1)\n\ntype handler struct {\n    next http.Handler\n}\n\nfunc (h handler) ServeHTTP(w http.ResponseWriter, r *http.Request) {\n    ctx := context.WithValue(r.Context(), id, time.Now().UTC())\n    h.next.ServeHTTP(w, r.WithContext(ctx))\n}\n\n// GetTime returns time from the current request, where it has previously been added by the middleware.\nfunc GetTime(r *http.Request) (t time.Time, ok bool) {\n    v := r.Context().Value(id)\n    t, ok = v.(time.Time)\n    return\n}\n</code></pre>\n\n<p>You'd use this as per this example:</p>\n\n<p>package main</p>\n\n<pre><code>import (\n    \"fmt\"\n    \"net/http\"\n    \"time\"\n\n    \"github.com/xxxxx/timemiddleware\"\n)\n\nfunc main() {\n    next := http.HandlerFunc(func(w http.ResponseWriter, r *http.Request) {\n        time.Sleep(time.Second * 5)\n        w.Write([]byte(\"Hello\"))\n        if t, ok := timemiddleware.GetTime(r); ok {\n            fmt.Println(t)\n            fmt.Println(time.Now().UTC())\n        }\n    })\n\n    h := timemiddleware.New(next)\n    fmt.Println(http.ListenAndServe(\"0.0.0.0:8080\", h))\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10440589, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e93bb08f941f33930daa42367a7c554a?s=128&d=identicon&r=PG&f=1", "display_name": "Shashank Gupta", "link": "https://stackoverflow.com/users/10440589/shashank-gupta"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1626, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1538417157, "creation_date": 1538393512, "last_edit_date": 1538398942, "question_id": 52590159, "link": "https://stackoverflow.com/questions/52590159/how-to-get-initial-timestamp-of-a-http-request-in-golang", "title": "How to get initial timestamp of a http request in golang?", "body": "<p>I am writing a golang program using revel framework, in which i need to check the initial timestamp of a http request.</p>\n\n<p>I know how to do it in C# :</p>\n\n<pre><code> HttpContextWrapper context = Request.Properties[\"MS_HttpContext\"] as HttpContextWrapper;\n\nDateTime t2 = context.Timestamp.ToUniversalTime();\n</code></pre>\n\n<p>Didn't get much how to do it in Go.</p>\n"}, {"tags": ["go", "winapi", "system-calls"], "answers": [{"tags": [], "owner": {"reputation": 42799, "user_id": 720999, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/04ee78e90161fa1c4dce14d615315160?s=128&d=identicon&r=PG", "display_name": "kostix", "link": "https://stackoverflow.com/users/720999/kostix"}, "is_accepted": false, "score": 2, "last_activity_date": 1538394958, "creation_date": 1538394958, "answer_id": 52590560, "question_id": 52589949, "link": "https://stackoverflow.com/questions/52589949/undefined-syscall-mmap-on-windows-10/52590560#52590560", "title": "Undefined: syscall.Mmap on Windows 10", "body": "<h2>The problem</h2>\n\n<p>Windows does not have the <code>mmap(2)</code> syscall\u2014<a href=\"http://pubs.opengroup.org/onlinepubs/9699919799/functions/mmap.html\" rel=\"nofollow noreferrer\">it's POSIX-specific</a> (just in case: <a href=\"https://en.wikipedia.org/wiki/POSIX\" rel=\"nofollow noreferrer\">what \"POSIX\" is</a>).</p>\n\n<p>Windows has <a href=\"https://msdn.microsoft.com/en-us/library/windows/desktop/aa366761\" rel=\"nofollow noreferrer\"><code>MapViewOfFile()</code></a> and friends.</p>\n\n<h2>Solutions</h2>\n\n<p>There are two approaches, I reckon:</p>\n\n<ul>\n<li><p>Use a \"wrapper\" package such as\n<a href=\"https://godoc.org/golang.org/x/exp/mmap\" rel=\"nofollow noreferrer\"><code>golang.org/x/exp/mmap</code></a>\nwhich tries to provide a generic memory-mapping API which\nis cross-platform (that is, on POSIX platforms it will use\n<code>mmap(2)</code> and on Windows is will use Windows-specific API).</p></li>\n<li><p>Use the appropriate Win32 API functions directly instead of\n<code>syscall.Mmap</code>.</p>\n\n<p>Should you take this route, the\n<a href=\"https://godoc.org/golang.org/x/sys/windows\" rel=\"nofollow noreferrer\">golang.org/x/sys/windows</a> package has\nthe relevant functions readily available.</p></li>\n</ul>\n\n<p>A third approach is to have your own custom implementation\nworking with memory-mapped data which calls either\n<code>syscall.Mmap</code> and friends of Windows-specific API.\nSuch implementation should supposedly involve using\nso-called <a href=\"https://golang.org/pkg/go/build/#hdr-Build_Constraints\" rel=\"nofollow noreferrer\">build constraints</a>\nto conditionally compile a particular target platform-specific\nimplementation\u2014just like <code>golang.org/x/exp/mmap</code> does.</p>\n"}], "owner": {"reputation": 11, "user_id": 10318878, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6e810b07ad7c48c345127ceb4ae243fd?s=128&d=identicon&r=PG&f=1", "display_name": "Savitri", "link": "https://stackoverflow.com/users/10318878/savitri"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1239, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1571735213, "creation_date": 1538392698, "last_edit_date": 1538394333, "question_id": 52589949, "link": "https://stackoverflow.com/questions/52589949/undefined-syscall-mmap-on-windows-10", "title": "Undefined: syscall.Mmap on Windows 10", "body": "<p>I have this function in my Go project and I am getting the error as:</p>\n\n<blockquote>\n  <p>undefined syscall.Mmap</p>\n</blockquote>\n\n<pre><code>func memMap(fd uintptr, base int64) (mem []uint32, mem8 []byte, err error) {\n    mem8, err = syscall.Mmap(\n        int(fd),\n        base,\n        memLength,\n        syscall.PROT_READ|syscall.PROT_WRITE,\n        syscall.MAP_SHARED,\n    )\n    if err != nil {\n        return\n    }\n    // Convert mapped byte memory to unsafe []uint32 pointer, adjust length as needed\n    header := *(*reflect.SliceHeader)(unsafe.Pointer(&amp;mem8))\n    header.Len /= (32 / 8) // (32 bit = 4 bytes)\n    header.Cap /= (32 / 8)\n    mem = *(*[]uint32)(unsafe.Pointer(&amp;header))\n    return\n}\n</code></pre>\n"}, {"tags": ["go", "struct", "scope"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538392590, "post_id": 52589857, "comment_id": 92114499, "body": "Some of your questions are addressed here: <a href=\"https://stackoverflow.com/questions/37385007/golang-creating-a-constant-type-and-restricting-the-types-values/37386119#37386119\">Golang: Creating a Constant Type and Restricting the Type&#39;s Values</a>."}, {"owner": {"reputation": 989, "user_id": 5016244, "user_type": "registered", "accept_rate": 40, "profile_image": "https://i.stack.imgur.com/bdZPE.jpg?s=128&g=1", "display_name": "Theophile Dano", "link": "https://stackoverflow.com/users/5016244/theophile-dano"}, "edited": false, "score": 0, "creation_date": 1538397555, "post_id": 52589857, "comment_id": 92117287, "body": "Plus, if your type isn&#39;t exported, one cannot possibly create a new type of fruit and register it in the original package."}], "answers": [{"comments": [{"owner": {"reputation": 759, "user_id": 7917147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IEhVgxTNVW0/AAAAAAAAAAI/AAAAAAAAArM/R1H3kp3Znbc/photo.jpg?sz=128", "display_name": "Jose", "link": "https://stackoverflow.com/users/7917147/jose"}, "edited": false, "score": 0, "creation_date": 1538400987, "post_id": 52590467, "comment_id": 92119400, "body": "Hej, thank&#39;s man. This code is certainly shorter. It also needs to declare every thing 3 times, however. I am wondering if can declare everything at once, or only twice."}, {"owner": {"reputation": 8724, "user_id": 1068283, "user_type": "registered", "accept_rate": 100, "profile_image": "https://i.stack.imgur.com/XZLfw.jpg?s=128&g=1", "display_name": "Michael Hampton", "link": "https://stackoverflow.com/users/1068283/michael-hampton"}, "reply_to_user": {"reputation": 759, "user_id": 7917147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IEhVgxTNVW0/AAAAAAAAAAI/AAAAAAAAArM/R1H3kp3Znbc/photo.jpg?sz=128", "display_name": "Jose", "link": "https://stackoverflow.com/users/7917147/jose"}, "edited": false, "score": 0, "creation_date": 1538404953, "post_id": 52590467, "comment_id": 92121880, "body": "@Jose Do you need to do any of this at all? Would not the list of constants suffice?"}, {"owner": {"reputation": 759, "user_id": 7917147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IEhVgxTNVW0/AAAAAAAAAAI/AAAAAAAAArM/R1H3kp3Znbc/photo.jpg?sz=128", "display_name": "Jose", "link": "https://stackoverflow.com/users/7917147/jose"}, "edited": false, "score": 0, "creation_date": 1538407294, "post_id": 52590467, "comment_id": 92123237, "body": "Because if we just define the constants, one coukd say <code>basketball fruitType = 48</code> but first, Basketball is an sport, not a fruit. And second, I do not have an implementation to peel Basketball, only know how to peel the fruits of my list"}], "tags": [], "owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "is_accepted": false, "score": 1, "last_activity_date": 1538394891, "last_edit_date": 1538394891, "creation_date": 1538394564, "answer_id": 52590467, "question_id": 52589857, "link": "https://stackoverflow.com/questions/52589857/how-to-reduce-verbosity-when-defining-restricted-values-of-structs-that-are-inte/52590467#52590467", "title": "How to reduce verbosity when defining restricted values of structs that are intentended to be constant in golang?", "body": "<p>This is the shortest:</p>\n\n<pre><code>//FruitTypes has a field for every fruit type\ntype FruitTypes struct {\n    Banana, Apple, Strawberry uint8\n}\n\n//Fruits returns a list with all the possible fruit types\nfunc Fruits() *FruitTypes {\n    return &amp;FruitTypes{0, 1, 2}\n}\n</code></pre>\n\n<p>If you need constants</p>\n\n<pre><code>const (\n    banana uint8 = iota\n    apple\n    strawberry\n)\n\n//FruitTypes has a field for every fruit type\ntype FruitTypes struct {\n    Banana, Apple, Strawberry uint8\n}\n\n//Fruits returns a list with all the possible fruit types\nfunc Fruits() *FruitTypes {\n    return &amp;FruitTypes{banana, apple, strawberry}\n}\n</code></pre>\n"}], "owner": {"reputation": 759, "user_id": 7917147, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-IEhVgxTNVW0/AAAAAAAAAAI/AAAAAAAAArM/R1H3kp3Znbc/photo.jpg?sz=128", "display_name": "Jose", "link": "https://stackoverflow.com/users/7917147/jose"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 55, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538394891, "creation_date": 1538392287, "question_id": 52589857, "link": "https://stackoverflow.com/questions/52589857/how-to-reduce-verbosity-when-defining-restricted-values-of-structs-that-are-inte", "title": "How to reduce verbosity when defining restricted values of structs that are intentended to be constant in golang?", "body": "<p>Suppose I have the following snippet in my package:</p>\n\n<pre><code>package fruits\n\ntype fruitType uint8\n\nconst(\n    banana fruitType = iota\n    apple fruitType = iota\n    strawberry fruitType = iota\n)\n\ntype allFruitTypes struct {\n       Banana fruitType\n       Apple fruitType\n       Strawberry fruitType\n}\n\nvar allFruitTypesImpl = allFruitTypes {\n    Banana: banana,\n    Apple: apple,\n    Strawberry: strawberry,\n}\n\n//GetAllFruitTypes returns a list with all the possible fruit types\nfunc GetAllFruitTypes() *allFruitTypes {\n return &amp;allFruitTypesImpl \n}\n</code></pre>\n\n<p>In this way, I can avoid that outside my package new types of fruits are created. And still it allows to read my list of possible fruit types. Is that correct?</p>\n\n<p>So my main problem in here is that I find really annoying to define 3 things that mean the same:</p>\n\n<ol>\n<li>the consts using iota</li>\n<li>the declaration of the struct type</li>\n<li>defining the struct implementation and typing in the values for each member.</li>\n</ol>\n\n<p>For me, semantically the three of them mean the same. However, because of the way go works (or my lack of knowledge on how to type this better in go) I have to retype the same thing 3 times.</p>\n\n<p>Is there any way to cause the same effect without having to type down the very same semantics 3 times?</p>\n"}, {"tags": ["docker", "go"], "answers": [{"tags": [], "owner": {"reputation": 4481, "user_id": 1264974, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/6558cf06df3ccf1c49329f38fd843b7d?s=128&d=identicon&r=PG", "display_name": "justinas", "link": "https://stackoverflow.com/users/1264974/justinas"}, "is_accepted": false, "score": 8, "last_activity_date": 1538388437, "creation_date": 1538388437, "answer_id": 52588798, "question_id": 52588365, "link": "https://stackoverflow.com/questions/52588365/how-to-solve-the-issue-of-undefined-math-round-while-installing-app-of-go-usi/52588798#52588798", "title": "How to solve the issue of &quot;undefined: math.Round&quot; while installing app of go using docker", "body": "<p>The function <code>Round()</code> from the <code>math</code> package was only introduced in Go 1.10 (<a href=\"https://golang.org/doc/go1.10#math\" rel=\"noreferrer\">see the release notes</a>). Your Dockerfile uses an older 1.9.6 version, so you will have to upgrade.</p>\n"}], "owner": {"reputation": 79, "user_id": 10031581, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/686926de56fb3840ee7a53bc269fdc21?s=128&d=identicon&r=PG&f=1", "display_name": "misha", "link": "https://stackoverflow.com/users/10031581/misha"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1804, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538388437, "creation_date": 1538387025, "question_id": 52588365, "link": "https://stackoverflow.com/questions/52588365/how-to-solve-the-issue-of-undefined-math-round-while-installing-app-of-go-usi", "title": "How to solve the issue of &quot;undefined: math.Round&quot; while installing app of go using docker", "body": "<p>I make golang api's code and I have imported some packages in it like <code>math</code>. But while building an image by running the <code>sudo docker build -t users/micro .</code> Then at one step it will give me the error.</p>\n\n<p>Error</p>\n\n<pre><code> Step 6/8 : RUN go install\n ---&gt; Running in 454784b3ceef\n # bkapiv/users/utils\n utils/CommonFunctions.go:189:9: undefined: math.Round\n</code></pre>\n\n<p>Dockerfile</p>\n\n<pre><code># Start from a Debian image with the latest version of Go installed\n# and a workspace (GOPATH) configured at /go.\nFROM golang:1.9.6\n\n\nWORKDIR /go/src/bkapiv/users\n\n# Copy the local package files to the container's workspace.\nADD . /go/src/bkapiv/users\n\n# Build the outyet command inside the container.\n# (You may fetch or manage dependencies here,\n# either manually or with a tool like \"godep\".)\nRUN cd /go/src\nRUN go-wrapper download   # \"go get -d -v ./...\"\nRUN go install\n\n# Run the outyet command by default when the container starts.\nENTRYPOINT /go/bin/users\n\n# Document that the service listens on port 8080.\nEXPOSE 8080\n</code></pre>\n\n<p>Imported packages are</p>\n\n<pre><code>package utils\n\nimport (\n \"bytes\"\n \"fmt\"\n \"math\"\n \"math/rand\"\n \"os/exec\"\n \"reflect\"\n \"sort\"\n \"strconv\"\n \"time\"\n)\n\n 187 func Round(x, unit float64) float64 {\n 188        // for this line it will giving me the error \n 189    return math.Round(x/unit) * unit\n 190 }\n</code></pre>\n\n<p>How I will resolve my error </p>\n"}, {"tags": ["go", "nonblocking", "channel", "goroutine"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538384767, "post_id": 52587537, "comment_id": 92110500, "body": "why were you using channel, why can&#39;t use a boolean variable or something? If you are sending something through channel, once the receiver receives it, it will not exist anymore, are you sure you want it this way, because then a normal boolean would suffice."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 2, "creation_date": 1538384950, "post_id": 52587537, "comment_id": 92110591, "body": "While this is possible with buffered channels, there is an inherent race involved doing that. This is a design smell, most likely an <a href=\"https://meta.stackexchange.com/questions/66377/what-is-the-xy-problem\">XY problem</a>. You shouldn&#39;t use channels like this, most likely you shouldn&#39;t use channels at all for what you want to do. What is it you want to achieve?"}, {"owner": {"reputation": 1209, "user_id": 5573241, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fcf51c0a3fa3212b2f9729935ff23a30?s=128&d=identicon&r=PG&f=1", "display_name": "Pratik Gandhi", "link": "https://stackoverflow.com/users/5573241/pratik-gandhi"}, "edited": false, "score": 0, "creation_date": 1538385367, "post_id": 52587537, "comment_id": 92110797, "body": "I want to make a quiz program with a timer. When timer expires or user answers every question the program should stop and print the score. While I was at it, I tried channels for learning."}, {"owner": {"reputation": 179, "user_id": 5074437, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/6dfc9d3110fd3ed30d1cdd4e59cabd4a?s=128&d=identicon&r=PG", "display_name": "PaulDennetiere", "link": "https://stackoverflow.com/users/5074437/pauldennetiere"}, "edited": false, "score": 0, "creation_date": 1538388842, "post_id": 52587537, "comment_id": 92112574, "body": "A select statement would do the trick. Use the channel on one case, the other is a condition on the quizz (all questions answered). This inside a (infinite) for loop, will stop the program only if the timer is done, or all the questions are answered."}], "answers": [{"tags": [], "owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "is_accepted": true, "score": 3, "last_activity_date": 1538389170, "creation_date": 1538389170, "answer_id": 52589013, "question_id": 52587537, "link": "https://stackoverflow.com/questions/52587537/non-blocking-channel-in-go/52589013#52589013", "title": "Non-blocking channel in go", "body": "<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"log\"\n    \"math/rand\"\n    \"time\"\n)\n\nfunc main() {\n\n    // user score, no.of questions asked so far\n    var score, num int\n    var correct bool // temporary variable to decide if the answer is right\n    // questions\n    var questions = make([]string, 13)\n\n    t1 := time.Tick(time.Second * 7) // timer\nloop:\n    for {\n        select {\n        case &lt;-t1:\n            log.Println(\"ran out of time\")\n            break loop\n        default:\n            // have any questions further questions to ask\n            if num &lt; len(questions) {\n\n                // simulate typing\n                time.Sleep(time.Millisecond * 777)\n\n                // correct or wrong answer\n                correct = (rand.Intn(777)%2 == 0)\n\n                if correct {\n                    fmt.Println(\"you did it\")\n                    score++ //increase score\n                } else {\n                    fmt.Println(\"try again\")\n                }\n\n            } else {\n                // no questions, state and break\n                log.Println(\"all questions were finished\")\n                break loop //break loop, all questions were finished\n            }\n            num++\n        }\n    }\n\n    //print final score\n    fmt.Println(\"your score is:\", score)\n}\n</code></pre>\n"}], "owner": {"reputation": 1209, "user_id": 5573241, "user_type": "registered", "accept_rate": 86, "profile_image": "https://www.gravatar.com/avatar/fcf51c0a3fa3212b2f9729935ff23a30?s=128&d=identicon&r=PG&f=1", "display_name": "Pratik Gandhi", "link": "https://stackoverflow.com/users/5573241/pratik-gandhi"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 5276, "favorite_count": 1, "accepted_answer_id": 52589013, "answer_count": 1, "score": 2, "last_activity_date": 1538389170, "creation_date": 1538383993, "question_id": 52587537, "link": "https://stackoverflow.com/questions/52587537/non-blocking-channel-in-go", "title": "Non-blocking channel in go", "body": "<p>I have some code like this:</p>\n\n<pre><code>go func(ch chan bool) chan bool {\n\n    // some processing\n    ch &lt;- true\n    return ch\n}(ch)\n\nfor i := 0; i &lt; TotalQuestions; i++ {\n    // check if channel ch has some value\n    // If it has then execute below statements, else break out of the loop\n\n\n    fmt.Println(questions[i])\n    answer, _ := InputReader.ReadString('\\n')\n\n    // some processing\n\n}\nfmt.Println(\"Your Total score is \" + strconv.Itoa(TotalScore) + \" out of \" + strconv.Itoa(TotalQuestions))\n</code></pre>\n\n<p>Now what I want to do is to check if channel ch has a value (in for loop). If it has a value then I want to break out of the for loop to print the last statement. otherwise, I want to continue my loop. I tried to insert select block but that didn't work (The channel got blocked and code didn't print questions). How to do that?</p>\n"}, {"tags": ["google-app-engine", "go", "struct", "google-cloud-datastore"], "answers": [{"tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": true, "score": 0, "last_activity_date": 1538380598, "creation_date": 1538380598, "answer_id": 52586757, "question_id": 52586657, "link": "https://stackoverflow.com/questions/52586657/how-to-define-a-key-type-in-datastore/52586757#52586757", "title": "How to define a Key type in datastore?", "body": "<p>Since your <code>Post</code> entities contain complete <code>Key</code>s, use <a href=\"https://godoc.org/cloud.google.com/go/datastore#Key\" rel=\"nofollow noreferrer\"><code>datastore.Key</code></a> as the field type:</p>\n\n<pre><code>type Post struct {\n    User    *datastore.Key\n    Title   string\n    Content string\n}\n</code></pre>\n"}], "owner": {"reputation": 474, "user_id": 10178858, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/8DOGg.jpg?s=128&g=1", "display_name": "gacopu", "link": "https://stackoverflow.com/users/10178858/gacopu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 75, "favorite_count": 0, "accepted_answer_id": 52586757, "answer_count": 1, "score": 2, "last_activity_date": 1538477005, "creation_date": 1538380168, "last_edit_date": 1538477005, "question_id": 52586657, "link": "https://stackoverflow.com/questions/52586657/how-to-define-a-key-type-in-datastore", "title": "How to define a Key type in datastore?", "body": "<p>I have a user kind:</p>\n\n<pre><code>type User struct {\n  Username     string\n  Email        string\n  Password     string\n}\n</code></pre>\n\n<p>And a post kind:</p>\n\n<pre><code>type Post struct {\n  User               // how to define here?\n  Title        string\n  Content      string\n}\n</code></pre>\n\n<p>Post entity looks like:</p>\n\n<p>User: Key(User, '10000')</p>\n\n<p>Title: \"some tilte\"</p>\n\n<p>Content: \"some content\"</p>\n\n<p>How can define <code>Post.User</code>?</p>\n"}, {"tags": ["go", "google-sheets", "google-sheets-api"], "comments": [{"owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "edited": false, "score": 0, "creation_date": 1538380602, "post_id": 52586320, "comment_id": 92108444, "body": "Can I ask you about &quot;location 0&quot;?"}, {"owner": {"reputation": 31, "user_id": 4466238, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jh9LbBEkhok/AAAAAAAAAAI/AAAAAAAAMoI/M9ggrgGSejg/photo.jpg?sz=128", "display_name": "Hai", "link": "https://stackoverflow.com/users/4466238/hai"}, "reply_to_user": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "edited": false, "score": 0, "creation_date": 1538397556, "post_id": 52586320, "comment_id": 92117289, "body": "Location 0 as in the first sheet inside a spreadsheet that has at least two sheets."}, {"owner": {"reputation": 8677, "user_id": 9337071, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/e52afdb783a619060eb2b0c0cb5766d3?s=128&d=identicon&r=PG&f=1", "display_name": "tehhowch", "link": "https://stackoverflow.com/users/9337071/tehhowch"}, "edited": false, "score": 0, "creation_date": 1538398337, "post_id": 52586320, "comment_id": 92117799, "body": "Isn&#39;t it supposed to be <code>sheets.DeleteSheetRequest</code> and not <code>sheets.DeleteSheet</code>? <code>.DeleteSheet</code> is under <code>Request</code> not <code>sheets</code>"}, {"owner": {"reputation": 100534, "user_id": 7108653, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/LH2EI.png?s=128&g=1", "display_name": "Tanaike", "link": "https://stackoverflow.com/users/7108653/tanaike"}, "edited": false, "score": 0, "creation_date": 1538438044, "post_id": 52586320, "comment_id": 92135115, "body": "@Hai Thank you for replying. If you have already known the sheet ID you want to remove, you can remove the sheet using it. If you don&#39;t have the sheet ID, at first, please retrieve the sheet ID of the first index in the Spreadsheet using <a href=\"https://developers.google.com/sheets/api/reference/rest/v4/spreadsheets/get\" rel=\"nofollow noreferrer\">spreadsheets.get</a>."}], "answers": [{"tags": [], "owner": {"reputation": 31, "user_id": 4466238, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jh9LbBEkhok/AAAAAAAAAAI/AAAAAAAAMoI/M9ggrgGSejg/photo.jpg?sz=128", "display_name": "Hai", "link": "https://stackoverflow.com/users/4466238/hai"}, "is_accepted": false, "score": 0, "last_activity_date": 1538462311, "creation_date": 1538462311, "answer_id": 52603133, "question_id": 52586320, "link": "https://stackoverflow.com/questions/52586320/getting-undefined-sheets-deletesheet-when-trying-to-do-a-batchupdate-request/52603133#52603133", "title": "Getting &#39;Undefined: sheets.DeleteSheet&#39; when trying to do a BatchUpdate request on Spreadsheets", "body": "<p>The fix:</p>\n\n<pre><code>    deleteSheetRequest := &amp;sheets.DeleteSheetRequest{\n        SheetId: 0,\n    }\n\n    requests := []*sheets.Request{\n        {DeleteSheet: deleteSheetRequest},\n    }\n\n    rb3 := &amp;sheets.BatchUpdateSpreadsheetRequest{\n            Requests: requests,\n\n            // TODO: Add desired fields of the request body.\n    }\n\n    resp2, err := srv.Spreadsheets.BatchUpdate(destinationSpreadsheetId, rb3).Do()\n    if err != nil {\n        log.Fatal(err)\n    }\n    fmt.Println(resp2)\n</code></pre>\n\n<p>@tehhowch, thanks for the help. I fixed that and then I eventually realized after looking at the code that the []*sheets.Request was missing array brackets. Duh. </p>\n"}], "owner": {"reputation": 31, "user_id": 4466238, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-Jh9LbBEkhok/AAAAAAAAAAI/AAAAAAAAMoI/M9ggrgGSejg/photo.jpg?sz=128", "display_name": "Hai", "link": "https://stackoverflow.com/users/4466238/hai"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 125, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538462311, "creation_date": 1538378576, "last_edit_date": 1538398696, "question_id": 52586320, "link": "https://stackoverflow.com/questions/52586320/getting-undefined-sheets-deletesheet-when-trying-to-do-a-batchupdate-request", "title": "Getting &#39;Undefined: sheets.DeleteSheet&#39; when trying to do a BatchUpdate request on Spreadsheets", "body": "<p>I'm not quite understanding how the google sheets api for go works.</p>\n\n<p>What I want to do is delete sheet at location 0 from a spreadsheet. Here is the code snippit for the request that doesn't work right now.</p>\n\n<pre><code>    rb2 := &amp;sheets.BatchUpdateSpreadsheetRequest{\n            Requests: requests,\n    }\n\n    resp2, err := srv.Spreadsheets.BatchUpdate(destinationSpreadsheetId, rb3).Do()\n</code></pre>\n\n<p>What I thought I'd do is create <code>request</code> before making the request body on line 1 above.</p>\n\n<pre><code>    ds := &amp;sheets.DeleteSheetRequest{\n            SheetId: int64(0),\n    }\n    deleteSheet := &amp;sheets.DeleteSheet{\n        DeleteSheetRequest: ds,\n    }    \n    requests := []*sheets.Request{\n        DeleteSheet: deleteSheet,\n    }\n</code></pre>\n\n<p>If I try to build it, the compiler will error,</p>\n\n<pre><code>sheets\\sheets.go:118:19: undefined: sheets.DeleteSheet\nsheets\\sheets.go:123:4: undefined: DeleteSheet\n</code></pre>\n\n<p>I was trying to follow the sheets manual, <a href=\"https://godoc.org/google.golang.org/api/sheets/v4#BatchUpdateSpreadsheetRequest\" rel=\"nofollow noreferrer\">https://godoc.org/google.golang.org/api/sheets/v4#BatchUpdateSpreadsheetRequest</a></p>\n"}, {"tags": ["go", "abstract-syntax-tree", "go-templates"], "comments": [{"owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "edited": false, "score": 0, "creation_date": 1538378430, "post_id": 52585977, "comment_id": 92107404, "body": "Thank you very much icza! This is what I want. However, how about &quot;{{range $i, $v := .arr}}{{$v}}{{end}}&quot;? I&#39;d like to get string[]{&quot;.arr&quot;} but I could not get it by the provided source in the duplicate question."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1538378769, "post_id": 52585977, "comment_id": 92107561, "body": "Quoting from my answer there: <i>&quot;This solution is just a demonstration, a proof of concept, it does not handle all cases.&quot;</i> If you want to handle all cases, you have to &quot;dig deeper&quot; into into the AST. But also note: <i>&quot;...the <code>Template.Tree</code> field is &#39;exported only for use by html/template and should be treated as unexported by all other clients.&#39;&quot;</i> So you shouldn&#39;t rely on this either."}, {"owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538379373, "post_id": 52585977, "comment_id": 92107847, "body": "Thank you very much!  I&#39;ll dig deeper and implement to achieve my goal on my own. Thank you very much for your perfect demonstration."}], "owner": {"reputation": 1481, "user_id": 2885946, "user_type": "registered", "accept_rate": 67, "profile_image": "https://i.stack.imgur.com/8CNNA.png?s=128&g=1", "display_name": "ryo", "link": "https://stackoverflow.com/users/2885946/ryo"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 23, "favorite_count": 0, "closed_date": 1538377890, "answer_count": 0, "score": 0, "last_activity_date": 1538376972, "creation_date": 1538376972, "question_id": 52585977, "link": "https://stackoverflow.com/questions/52585977/how-to-get-embedded-variables-in-template-in-go-language", "closed_reason": "Duplicate", "title": "How to get embedded variables in template in Go language", "body": "<p>I'd like to get all embedded variables in a template in Go language.</p>\n\n<p>For example, in a template, <code>template.New(\"test\").Parse(\"{{.Count}} items are made of {{.Material}}\")</code>, <code>\".Count\"</code> and <code>\".Material\"</code> are variables. I tried to find ways to get variables in document, source code and in web, but I could not find it.</p>\n\n<p>Here is my expectation.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"text/template\"\n)\n\nfunc getVariables(t *template.Template) []string {\n  // ... How to implement?\n}\n\nfunc main() {\n    t, _ := template.New(\"test\").Parse(\"{{.Count}} items are made of {{.Material}}\")\n\n    fmt.Println(getVariables(t))\n    // My expectation is [.Count .Material]\n}\n</code></pre>\n\n<p>Could you tell me how to get these variables?</p>\n"}, {"tags": ["string", "go", "string-formatting"], "comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1538431248, "post_id": 52585774, "comment_id": 92133496, "body": "Thanks, everyone.  I just forgot Sprintf.  :/"}], "answers": [{"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1538414316, "post_id": 52586112, "comment_id": 92126459, "body": "I would like to store the string, not print it."}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "reply_to_user": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 0, "creation_date": 1538415585, "post_id": 52586112, "comment_id": 92126990, "body": "@Mittenchops You didn&#39;t mention that in your question, and the example you provided also prints to the console. Everything I wrote in the answer still applies, you just have to use <code>fmt.Sprintf()</code> instead of <code>fmt.Printf()</code>. For more details, see <a href=\"https://stackoverflow.com/questions/11123865/format-a-go-string-without-printing/31742265#31742265\">Format a Go string without printing?</a>"}], "tags": [], "owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "is_accepted": false, "score": 1, "last_activity_date": 1538399603, "last_edit_date": 1538399603, "creation_date": 1538377524, "answer_id": 52586112, "question_id": 52585774, "link": "https://stackoverflow.com/questions/52585774/usage-example-for-format-method-with-leading-zero-padding-for-big-ints-in-golang/52586112#52586112", "title": "Usage example for Format method with leading zero padding for Big Ints in Golang", "body": "<p>The <a href=\"https://golang.org/pkg/math/big/#Int.Format\" rel=\"nofollow noreferrer\"><code>Int.Format()</code></a> is not for you to call manually (although you could), but it is to implement <a href=\"https://golang.org/pkg/fmt/#Formatter\" rel=\"nofollow noreferrer\"><code>fmt.Formatter</code></a> so the <a href=\"https://golang.org/pkg/fmt/\" rel=\"nofollow noreferrer\"><code>fmt</code></a> package will support formatting <a href=\"https://golang.org/pkg/math/big/#Int\" rel=\"nofollow noreferrer\"><code>big.Int</code></a> values out-of-the box.</p>\n\n<p>See this example:</p>\n\n<pre><code>m := big.NewInt(99)\nfmt.Printf(\"%06d\\n\", m)\n\nif _, ok := m.SetString(\"1234567890123456789012345678901234567890\", 10); !ok {\n    panic(\"big\")\n}\nfmt.Printf(\"%060d\\n\", m)\n</code></pre>\n\n<p>Outputs (try it on the <a href=\"https://play.golang.org/p/6bg7Y1uZ6-X\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>000099\n000000000000000000001234567890123456789012345678901234567890\n</code></pre>\n\n<p>This is the simplest, so use this. Manually creating an <code>fmt.Formatter</code> gives you more control, but is also harder to do it. Unless this is a performance critical part of your app, just use the above solution.</p>\n"}, {"tags": [], "owner": {"reputation": 132392, "user_id": 244128, "user_type": "registered", "accept_rate": 80, "profile_image": "https://www.gravatar.com/avatar/300502d6109af88a009074c42ff56c73?s=128&d=identicon&r=PG", "display_name": "maerics", "link": "https://stackoverflow.com/users/244128/maerics"}, "is_accepted": true, "score": 2, "last_activity_date": 1538414958, "creation_date": 1538414958, "answer_id": 52596050, "question_id": 52585774, "link": "https://stackoverflow.com/questions/52585774/usage-example-for-format-method-with-leading-zero-padding-for-big-ints-in-golang/52596050#52596050", "title": "Usage example for Format method with leading zero padding for Big Ints in Golang", "body": "<p>You can simply use <a href=\"https://golang.org/pkg/fmt/#Sprintf\" rel=\"nofollow noreferrer\"><code>fmt.Sprintf(...)</code></a> with the <code>\"%020s\"</code> directive (where 20 is whatever total length you want). The <code>s</code> verb will use the natural string format of the big int and the <code>020</code> modifier will create a string with total length of (at least) 20 with zero padding (instead of whitespace).</p>\n\n<p>For example (<a href=\"https://play.golang.com/p/nnCWsePPvTT\" rel=\"nofollow noreferrer\">Go Playground</a>):</p>\n\n<pre><code>m := big.NewInt(99999999999999)\ns := fmt.Sprintf(\"%020s\", m)\nfmt.Println(s)\n// 00000099999999999999\n</code></pre>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1623, "favorite_count": 0, "accepted_answer_id": 52596050, "answer_count": 2, "score": 2, "last_activity_date": 1538476985, "creation_date": 1538376104, "last_edit_date": 1538476985, "question_id": 52585774, "link": "https://stackoverflow.com/questions/52585774/usage-example-for-format-method-with-leading-zero-padding-for-big-ints-in-golang", "title": "Usage example for Format method with leading zero padding for Big Ints in Golang", "body": "<p>I would like to format a big int as a string with leading zeros.  I'm looking for an example similar to <a href=\"https://stackoverflow.com/questions/25637440/how-to-pad-a-number-with-zeros-when-printing\">this</a>, but with Big:</p>\n\n<p>I'm looking at source <a href=\"https://golang.org/pkg/math/big/#Int.Format\" rel=\"nofollow noreferrer\">here</a>.</p>\n\n<p>But when I call:</p>\n\n<pre><code>m := big.NewInt(99999999999999)\nfmt.Println(m.Format(\"%010000000000000000000\",\"d\"))\n</code></pre>\n\n<p>I see:</p>\n\n<pre><code>prog.go:10:22: m.Format(\"%010000000000000000000\", \"d\") used as value\nprog.go:10:23: cannot use \"%010000000000000000000\" (type string) as type fmt.State in argument to m.Format:\n    string does not implement fmt.State (missing Flag method)\nprog.go:10:48: cannot use \"d\" (type string) as type rune in argument to m.Format\n</code></pre>\n\n<p>(I understand normally I can use m.String(), but zero padding seems to complicate this, so I'm looking specifically for some help on the Format method.)</p>\n\n<p>Here's <a href=\"https://play.golang.org/p/7Uz2trkM8Fo\" rel=\"nofollow noreferrer\">my playground link</a>.</p>\n"}, {"tags": ["go"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538376209, "post_id": 52585675, "comment_id": 92106397, "body": "send a quit signal from the function which will be captured by the go routine and it will stop."}], "answers": [{"comments": [{"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 0, "creation_date": 1538390662, "post_id": 52586120, "comment_id": 92113562, "body": "Tickers have resources associated with them and must be stopped to release them."}, {"owner": {"reputation": 1383, "user_id": 2503356, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/0988e8491e781bc82e3906ab8c43912f?s=128&d=identicon&r=PG&f=1", "display_name": "Dariel Pratama", "link": "https://stackoverflow.com/users/2503356/dariel-pratama"}, "edited": false, "score": 0, "creation_date": 1538454446, "post_id": 52586120, "comment_id": 92138202, "body": "thanks a lot @danicheeta. I have to initialize, <code>ExportedFunction</code> with <code>var ExportedFunction context.CancelFunc</code> before it can be call inside <code>abortingMission</code> body function."}], "tags": [], "owner": {"reputation": 1152, "user_id": 4786944, "user_type": "registered", "accept_rate": 83, "profile_image": "https://www.gravatar.com/avatar/eb18930f3400e1851acfe1239c113816?s=128&d=identicon&r=PG", "display_name": "CallMeLoki", "link": "https://stackoverflow.com/users/4786944/callmeloki"}, "is_accepted": true, "score": 1, "last_activity_date": 1538391255, "last_edit_date": 1538391255, "creation_date": 1538377565, "answer_id": 52586120, "question_id": 52585675, "link": "https://stackoverflow.com/questions/52585675/terminate-go-routine-when-accessing-url/52586120#52586120", "title": "terminate go routine when accessing URL", "body": "<p>you can make it by using time ticker and context</p>\n\n<pre><code>func read_serial_port(c context.Context){\n    c := &amp;serial.Config{Name:\"/dev/ttyACM0\", Baud:9600}\n    s, err := serial.OpenPort(c)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    filename:= randSeq(10)+\".txt\"\n    file, _ := os.Create(\"output/\"+filename)\n\n    defer file.Close();\n\n    ticker := time.NewTicker(100 * time.Millisecond)\n    defer ticker.Stop()\n\n    for{\n        select {\n        case &lt;-c.Done():\n            break\n        case &lt;-ticker.C:\n            buf := make([]byte, 128)\n            n, err := s.Read(buf)\n\n            if err != nil {\n                log.Fatal(err)\n            }\n\n            log.Printf(\"%s\", string(buf[:n]))\n\n            fmt.Fprintf(file, string(buf[:n]))\n\n            time.Sleep(100 * time.Millisecond)\n        }\n    }\n}\n</code></pre>\n\n<p>then you need to add another route to call the cancel function</p>\n\n<pre><code>if r.FormValue(\"action\") == \"add\"{\n    c, cnl := context.WithCancel(context.Background())\n    // need to access this cancel function to use it in another route\n    ExportedFunction = cnl\n    go read_serial_port()\n}\n</code></pre>\n\n<p>then cancel it by:</p>\n\n<pre><code>func abortingMission(w http.ResponseWriter, r *http.Request) {\n    ExportedFunction()\n}\n</code></pre>\n\n<p>and also DON'T use underscore in your function name</p>\n"}], "owner": {"reputation": 1383, "user_id": 2503356, "user_type": "registered", "accept_rate": 41, "profile_image": "https://www.gravatar.com/avatar/0988e8491e781bc82e3906ab8c43912f?s=128&d=identicon&r=PG&f=1", "display_name": "Dariel Pratama", "link": "https://stackoverflow.com/users/2503356/dariel-pratama"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 44, "favorite_count": 0, "accepted_answer_id": 52586120, "answer_count": 1, "score": 0, "last_activity_date": 1538391255, "creation_date": 1538375622, "question_id": 52585675, "link": "https://stackoverflow.com/questions/52585675/terminate-go-routine-when-accessing-url", "title": "terminate go routine when accessing URL", "body": "<p>I made a simple web app using Go. there is a <code>goroutine</code> which is executed when user access a URL, let say <code>/inspection/start/</code>. how to stop that <code>goroutine</code> when user access URL <code>/inspection/stop/</code>?</p>\n\n<p>I heard about <code>channel</code> but I am not sure how to do it in my case.</p>\n\n<p>here is the code:</p>\n\n<pre><code>func inspection_form_handler(w http.ResponseWriter, r *http.Request) {\n    if r.FormValue(\"save\") != \"\" {\n        airport_id := getCurrentAirportId(r)\n\n        r.ParseForm()\n        if airport_id != nil {\n            if r.FormValue(\"action\") == \"add\"{\n                go read_serial_port()\n            }\n\n            // redirect back to the list\n            http.Redirect(w, r, \"/airport#inspect\", http.StatusSeeOther)\n        }\n    }\n}\n</code></pre>\n\n<p>the routine function</p>\n\n<pre><code>func read_serial_port(){\n    c := &amp;serial.Config{Name:\"/dev/ttyACM0\", Baud:9600}\n    s, err := serial.OpenPort(c)\n\n    if err != nil {\n        log.Fatal(err)\n    }\n\n    filename:= randSeq(10)+\".txt\"\n    file, _ := os.Create(\"output/\"+filename)\n\n    defer file.Close();\n\n    for{\n        buf := make([]byte, 128)\n        n, err := s.Read(buf)\n\n        if err != nil {\n            log.Fatal(err)\n        }\n\n        log.Printf(\"%s\", string(buf[:n]))\n\n        fmt.Fprintf(file, string(buf[:n]))\n\n        time.Sleep(100 * time.Millisecond)\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "viper", "viper-go"], "answers": [{"tags": [], "owner": {"reputation": 371, "user_id": 8371320, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/51a960d78c618a2e95795f9115259a21?s=128&d=identicon&r=PG&f=1", "display_name": "Deepak Singh", "link": "https://stackoverflow.com/users/8371320/deepak-singh"}, "is_accepted": false, "score": 4, "last_activity_date": 1538379531, "last_edit_date": 1538379531, "creation_date": 1538378476, "answer_id": 52586301, "question_id": 52585309, "link": "https://stackoverflow.com/questions/52585309/how-do-i-use-viper-to-get-a-value-from-a-nested-yaml-structure/52586301#52586301", "title": "How do I use Viper to get a value from a nested YAML structure?", "body": "<p>There are different Get methods available in viper library and your YML structure is of type <code>[]map[string]string</code>, so to parse your YML configuration file you have to use <code>viper.Get</code> method. So you have to parse your file something like this..</p>\n\n<p><strong>Note:</strong> You can use struct as well to un-marshal the data. Please refer this post <a href=\"https://stackoverflow.com/questions/41631008/mapping-nested-config-yaml-to-struct\">mapping-nested-config-yaml-to-struct</a></p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n\n    \"github.com/spf13/viper\"\n)\n\nfunc main() {\n    viper.SetConfigName(\"config\")\n    viper.AddConfigPath(\".\")\n    err := viper.ReadInConfig()\n    if err != nil {\n        panic(err)\n    }\n    testvar := viper.Get(\"element\")\n    fmt.Println(testvar)\n    elementsMap := testvar.([]interface{})\n    for k, vmap := range elementsMap {\n        fmt.Print(\"Key: \", k) \n        fmt.Println(\" Value: \", vmap)\n        eachElementsMap := vmap.(map[interface{}]interface{})\n\n        for k, vEachValMap := range eachElementsMap {\n            fmt.Printf(\"%v: %v \\n\", k, vEachValMap)\n            vEachValDataMap := vEachValMap.(map[interface{}]interface{})\n\n            for k, v := range vEachValDataMap {\n                fmt.Printf(\"%v: %v \\n\", k, v)\n            }\n        }\n    }\n}\n\n// Output:\n/*\nKey: 0 Value:  map[one:map[url:http://test nested:123]]\none: map[url:http://test nested:123]\nurl: http://test\nnested: 123\nKey: 1 Value:  map[two:map[url:http://test nested:123]]\ntwo: map[url:http://test nested:123]\nurl: http://test\nnested: 123\n*/\n</code></pre>\n"}], "owner": {"reputation": 195, "user_id": 8518106, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/afbc3ace43ed0fb62862dd06e95c5592?s=128&d=identicon&r=PG&f=1", "display_name": "Defenestrator6", "link": "https://stackoverflow.com/users/8518106/defenestrator6"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 7016, "favorite_count": 0, "answer_count": 1, "score": 5, "last_activity_date": 1538379531, "creation_date": 1538373615, "question_id": 52585309, "link": "https://stackoverflow.com/questions/52585309/how-do-i-use-viper-to-get-a-value-from-a-nested-yaml-structure", "title": "How do I use Viper to get a value from a nested YAML structure?", "body": "<p>My question: </p>\n\n<p>How do I write the code below to get a string from my nested yaml struct?</p>\n\n<p>Here is my yaml:</p>\n\n<pre><code>    element:\n      - one:\n          url: http://test\n          nested: 123\n      - two:\n          url: http://test\n          nested: 123\n\n    weather:\n      - test:\n          zipcode: 12345\n      - ca:\n          zipcode: 90210\n</code></pre>\n\n<p>Here is example code</p>\n\n<pre><code>    viper.SetConfigName(\"main_config\")\n      viper.AddConfigPath(\".\")\n      err := viper.ReadInConfig()\n      if err != nil {\n        panic(err)\n      }\n    testvar := viper.GetString(\"element.one.url\")\n</code></pre>\n\n<p>My problem:</p>\n\n<p>I get a blank string when I print this. According to the docs, this is how you get a nested element. I suspect its not working because the elements are lists. Do I need to do a struct? I am new to go so not sure how to make one, especially if it needs to be nested.</p>\n"}, {"tags": ["docker", "go", "docker-compose", "dockerfile"], "comments": [{"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538357203, "post_id": 52583531, "comment_id": 92102131, "body": "Add <code>GOPATH</code> to your Dockerfile using <code>ENV GOPATH</code>"}, {"owner": {"reputation": 477, "user_id": 1710154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QzQL2.jpg?s=128&g=1", "display_name": "Rajesh Rajendran", "link": "https://stackoverflow.com/users/1710154/rajesh-rajendran"}, "edited": false, "score": 0, "creation_date": 1538357296, "post_id": 52583531, "comment_id": 92102141, "body": "check <code>docker run --rm golanng:latest printenv</code> and check the output for GOPATH"}, {"owner": {"reputation": 444, "user_id": 9442592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVEaV.jpg?s=128&g=1", "display_name": "dmc94", "link": "https://stackoverflow.com/users/9442592/dmc94"}, "reply_to_user": {"reputation": 477, "user_id": 1710154, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/QzQL2.jpg?s=128&g=1", "display_name": "Rajesh Rajendran", "link": "https://stackoverflow.com/users/1710154/rajesh-rajendran"}, "edited": false, "score": 0, "creation_date": 1538357427, "post_id": 52583531, "comment_id": 92102164, "body": "@RajeshRajendran  it says my  is GOPATH=/go do I just place ENV GOPATH at the top of my dockerfile? Sorry I am brand new to docker like an hour into it haha"}, {"owner": {"reputation": 444, "user_id": 9442592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVEaV.jpg?s=128&g=1", "display_name": "dmc94", "link": "https://stackoverflow.com/users/9442592/dmc94"}, "reply_to_user": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538357454, "post_id": 52583531, "comment_id": 92102169, "body": "@dmitryro  it says my  is GOPATH=/go, shouldn&#39;t it be /go/src?"}, {"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538357541, "post_id": 52583531, "comment_id": 92102178, "body": "Depending on where your <i>go</i> is installed, for example if your <code>which go</code> will tell you <code>&#47;usr&#47;local&#47;go&#47;bin&#47;go</code>, then <code>GOPATH</code> should be <code>&#47;usr&#47;local&#47;go</code>."}, {"owner": {"reputation": 444, "user_id": 9442592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVEaV.jpg?s=128&g=1", "display_name": "dmc94", "link": "https://stackoverflow.com/users/9442592/dmc94"}, "reply_to_user": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538357594, "post_id": 52583531, "comment_id": 92102186, "body": "@dmitryro so its /c/Go/bin/go so would I just add ENV GOPATH=/go to my dockerfile?"}, {"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538357689, "post_id": 52583531, "comment_id": 92102198, "body": "So it&#39;s whatever is prior to <code>&#47;bin&#47;go</code>."}, {"owner": {"reputation": 444, "user_id": 9442592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVEaV.jpg?s=128&g=1", "display_name": "dmc94", "link": "https://stackoverflow.com/users/9442592/dmc94"}, "reply_to_user": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538357813, "post_id": 52583531, "comment_id": 92102214, "body": "@dmitryro I set ENV GOPATH=/Go and I still get the same error"}, {"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538358626, "post_id": 52583531, "comment_id": 92102375, "body": "In your Dockerfile remove <code>RUN mkdir -p &#47;go&#47;src&#47;app</code>, add <code>COPY . &#47;go&#47;src&#47;app</code> then next line <code>WORKDIR &#47;go&#47;src&#47;app</code> - then somewhere later  in Dockerfile <code>RUN go run main.go</code> - It&#39;s your <code>docker-compose</code>  <code>command: [&quot;go&quot;, &quot;run&quot;, &quot;main.go&quot;]</code> command that fails. Don&#39;t forget to rebuild your Docker image."}, {"owner": {"reputation": 444, "user_id": 9442592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVEaV.jpg?s=128&g=1", "display_name": "dmc94", "link": "https://stackoverflow.com/users/9442592/dmc94"}, "reply_to_user": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538358761, "post_id": 52583531, "comment_id": 92102387, "body": "@dmitryro Now I am getting an error from my code that says I cant connect to the database. (is that because I have hardcoded database credentials?) I am only getting that error within docker"}, {"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538358846, "post_id": 52583531, "comment_id": 92102400, "body": "That&#39;s already a different error - verify you specified valid credentials for Postgres"}, {"owner": {"reputation": 444, "user_id": 9442592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVEaV.jpg?s=128&g=1", "display_name": "dmc94", "link": "https://stackoverflow.com/users/9442592/dmc94"}, "reply_to_user": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538359064, "post_id": 52583531, "comment_id": 92102442, "body": "@dmitryro I did in the compose file. I removed `command: [&quot;go&quot;, &quot;run&quot;, &quot;main.go&quot;] and then I received no error but app_app_1 exited with code 0. It also just says that database system was shut down at a specific time"}, {"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538359150, "post_id": 52583531, "comment_id": 92102458, "body": "Watch your terminal and logs that relate to database service in docker-compose - it&#39;s already not a go issue."}, {"owner": {"reputation": 3202, "user_id": 3358074, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/vnKYD.png?s=128&g=1", "display_name": "dmitryro", "link": "https://stackoverflow.com/users/3358074/dmitryro"}, "edited": false, "score": 0, "creation_date": 1538361103, "post_id": 52583531, "comment_id": 92102755, "body": "I&#39;d suggest to create a separate Dockerfile that sets up all the necessary things for your database connection - see here some more <a href=\"https://stackoverflow.com/questions/34751814/build-postgres-docker-container-with-initial-schema\" title=\"build postgres docker container with initial schema\">stackoverflow.com/questions/34751814/&hellip;</a>"}], "owner": {"reputation": 444, "user_id": 9442592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVEaV.jpg?s=128&g=1", "display_name": "dmc94", "link": "https://stackoverflow.com/users/9442592/dmc94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 960, "favorite_count": 0, "answer_count": 0, "score": 2, "last_activity_date": 1538358663, "creation_date": 1538356836, "last_edit_date": 1538358663, "question_id": 52583531, "link": "https://stackoverflow.com/questions/52583531/docker-not-finding-main-go", "title": "Docker Not Finding main.go", "body": "<p>I am trying to run my simple golang API in a docker container so that it can be run across all machines, when I use docker tool box to navigate to the directory and run <code>docker-compose up</code> I get an error saying that <code>stat main.go: no such file or directory</code> I think it may have to do with the paths on my dockerfile/docker compose? Could anyone take a look and help me out please?</p>\n\n<p>Dockerfile</p>\n\n<pre><code>FROM golang:latest\n\nRUN mkdir -p /go/src/app\nWORKDIR /go/src/app\n\nADD . /go/src/app\n\nRUN go get -v\n</code></pre>\n\n<p>docker-compose.yml</p>\n\n<pre><code>version: '3'\nservices:\n     db:\n         image: postgres\n     environment:\n         POSTGRES_DB: Shoes\n         POSTGRES_USER: postgres\n         POSTGRES_PASSWORD: root\n     ports:\n         - 5432:5432\n     app:\n       build: .\n       command: [\"go\", \"run\", \"main.go\"]\n       volumes:\n         - .:/go/src/app\n     ports:\n         - \"8080:8080\"\n     depends_on:\n         - db\n     links:\n         - db\n</code></pre>\n\n<p>Edit: New error after rearranging some files and getting my GOPATH working properly. I am having a problem connecting to the Database in docker I get my error message for when I cant connect.</p>\n"}, {"tags": ["csv", "go"], "comments": [{"owner": {"reputation": 778, "user_id": 5687769, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OGS_dHjyp7s/AAAAAAAAAAI/AAAAAAAAACI/tHJG2NuXit4/photo.jpg?sz=128", "display_name": "Ankur  Jyoti Phukan", "link": "https://stackoverflow.com/users/5687769/ankur-jyoti-phukan"}, "edited": false, "score": 0, "creation_date": 1538358383, "post_id": 52583515, "comment_id": 92102342, "body": "you need  to add ip address as list to the , but you are directly appending it to result variable"}, {"owner": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "reply_to_user": {"reputation": 778, "user_id": 5687769, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-OGS_dHjyp7s/AAAAAAAAAAI/AAAAAAAAACI/tHJG2NuXit4/photo.jpg?sz=128", "display_name": "Ankur  Jyoti Phukan", "link": "https://stackoverflow.com/users/5687769/ankur-jyoti-phukan"}, "edited": false, "score": 0, "creation_date": 1538359033, "post_id": 52583515, "comment_id": 92102436, "body": "Can you explain a little further on this? What can i do other than appending it directly to result?"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538359253, "post_id": 52583515, "comment_id": 92102474, "body": "why were you using reflection?"}, {"owner": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "edited": false, "score": 0, "creation_date": 1538359641, "post_id": 52583515, "comment_id": 92102524, "body": "Because i&#39;m a total novice with Go, sadly. This is my first foray into compiled programming languages. I usually stick with powershell/python, and even then i&#39;m pretty terrible"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538361212, "post_id": 52583515, "comment_id": 92102769, "body": "It&#39;s not suggested to use reflection, though."}, {"owner": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "edited": false, "score": 0, "creation_date": 1538361876, "post_id": 52583515, "comment_id": 92102875, "body": "Can you elaborate on that? You say it&#39;s not suggested, but what would i use in it&#39;s place?"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538367189, "post_id": 52583515, "comment_id": 92103796, "body": "why can&#39;t you pass type <code>[]string</code> data in the first place, by converting type <code>x</code> into <code>string</code> type where ever necessary."}], "answers": [{"comments": [{"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1538360582, "post_id": 52583855, "comment_id": 92102668, "body": "Please provide some explanation for your answer.  As it stands, this answer barely educates the asker, let alone future visitors."}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "reply_to_user": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1538360693, "post_id": 52583855, "comment_id": 92102677, "body": "@LukeJoshuaPark there is nothing to explain, code speaks for itself and comments do that too, but I will add some more information."}, {"owner": {"reputation": 8643, "user_id": 1718554, "user_type": "registered", "accept_rate": 85, "profile_image": "https://i.stack.imgur.com/n3jD1.jpg?s=128&g=1", "display_name": "Luke Joshua Park", "link": "https://stackoverflow.com/users/1718554/luke-joshua-park"}, "edited": false, "score": 0, "creation_date": 1538360916, "post_id": 52583855, "comment_id": 92102725, "body": "Sorry - I didn&#39;t immediately notice the comments in your code.  Nonetheless, it&#39;s always nice to include a brief overview of what the issue was with the original code at the top!"}, {"owner": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "edited": false, "score": 0, "creation_date": 1538409027, "post_id": 52583855, "comment_id": 92124103, "body": "Would&#39;nt setting the comma variable add a comma everywhere a space exists? Some of the data for the other fields have spaces. Or is this completely wrong thinking? I will try working on this tonight"}, {"owner": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "edited": false, "score": 0, "creation_date": 1538447447, "post_id": 52583855, "comment_id": 92136840, "body": "@nilsocket this didn&#39;t work. now all of my data is in the first column"}, {"owner": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "edited": false, "score": 0, "creation_date": 1538447486, "post_id": 52583855, "comment_id": 92136847, "body": "@nilsocket I need each value under it&#39;s proper header, and under the <code>included</code> header i need all the ip addresses under it, separated by a space"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "reply_to_user": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "edited": false, "score": 0, "creation_date": 1538449871, "post_id": 52583855, "comment_id": 92137303, "body": "@JamesonParker are your fields all in one line, are you reading input from file or you are the one who generates it."}, {"owner": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "edited": false, "score": 0, "creation_date": 1538616429, "post_id": 52583855, "comment_id": 92208398, "body": "I&#39;m the one generated the data i&#39;m throwing in the CSV using a swagger-codegen client. The individual values get appended to the result variable"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538634383, "post_id": 52583855, "comment_id": 92212958, "body": "@instead of appending everything to result, make result as <code>[][]string</code>, and append <code>[]string</code> to result, then you can simply pass it to csv writer."}], "tags": [], "owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "is_accepted": false, "score": 0, "last_activity_date": 1538376331, "last_edit_date": 1538376331, "creation_date": 1538360430, "answer_id": 52583855, "question_id": 52583515, "link": "https://stackoverflow.com/questions/52583515/need-to-add-data-to-csv-without-adding-comma-to-data/52583855#52583855", "title": "Need to add data to CSV without adding comma to data", "body": "<p>In-order to get the output of data without comma,\ncsv reader has a variable known as, <code>Comma</code>, which sets the byte which separates values in csv.</p>\n\n<p>The same goes for both csv reader and writer.</p>\n\n<p>For csv data with other than comma, you need to set <code>Comma</code> variable of reader or writer respectively.</p>\n\n<pre><code>package main\n\nimport (\n    \"encoding/csv\"\n    \"os\"\n    \"strings\"\n)\n\nfunc main() {\n\n    // temporary csv\n    sr := strings.NewReader(\n        `\"name\" \"value\"\n\"nilsocket\" \"7\"\n\"nil\" \"77\"\n`)\n\n    // set your src of csv\n    r := csv.NewReader(sr)\n\n    r.Comma = ' '         // set this if your values were seperated\n    // with anything other than ','(comma)\n\n    res, _ := r.ReadAll() // read csv, res is going to be [][]string type\n    // you can fetch one record with r.Read()\n    // don't forget to check for errors\n\n    w := csv.NewWriter(os.Stdout) // set your dst for csv\n\n    w.Comma = ' '                // set the Comma byte to space\n\n    w.WriteAll(res) // write csv\n\n    w.Flush()       // don't forget to flush\n}\n</code></pre>\n"}], "owner": {"reputation": 11, "user_id": 10438769, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/31de46dd3ea1951f63425cd684523d16?s=128&d=identicon&r=PG&f=1", "display_name": "Jameson Parker", "link": "https://stackoverflow.com/users/10438769/jameson-parker"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 62, "favorite_count": 0, "answer_count": 1, "score": 0, "last_activity_date": 1538376331, "creation_date": 1538356722, "last_edit_date": 1538371715, "question_id": 52583515, "link": "https://stackoverflow.com/questions/52583515/need-to-add-data-to-csv-without-adding-comma-to-data", "title": "Need to add data to CSV without adding comma to data", "body": "<p>I have a bunch of either IP ranges or single addresses. I figured out how to loop through them, I can successfully print them to the console. However, when i write the same data to CSV, it magically adds a comma after every value (instead of adding them all under the same header separated by a space). I'm following all the rules (well, seemingly, anyway) to appending data in Go, but i just can't figure out why this isn't working. I'm assuming the CSV function in Go just see's a space and thinks it should be separated by a comma.</p>\n\n<p>The <code>input</code> part of this is looping through addresses that are <code>[]string</code> types. So one value could be <code>127.0.0.1 - 127.0.0.255</code> or just <code>127.0.0.1</code>. I just want them to look like this in the csv column <code>Included</code>: <code>127.0.0.1 - 127.0.0.255 127.0.0.1</code></p>\n\n<p>Screenshot of how the data appears in the console (correct): \n<a href=\"https://i.stack.imgur.com/NLVEg.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/NLVEg.png\" alt=\"enter image description here\"></a></p>\n\n<p>Screenshot of the CSV (not correct): \n<a href=\"https://i.stack.imgur.com/u2V1I.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/u2V1I.png\" alt=\"enter image description here\"></a></p>\n\n<p>I want the example CSV to look like this: </p>\n\n<p><a href=\"https://i.stack.imgur.com/8rhZ5.png\" rel=\"nofollow noreferrer\"><img src=\"https://i.stack.imgur.com/8rhZ5.png\" alt=\"enter image description here\"></a></p>\n\n<p>Here is the code i'm working with right now. If more is needed, let me know, but this is how i'm writing the data to CSV.</p>\n\n<pre><code>func ToCsv(inputs []interface{}, output io.Writer) {\n    w := csv.NewWriter(output)\n    defer w.Flush()\n\n    if len(inputs) == 0 {\n        return\n    } else {\n        // Get Header\n        r := reflect.ValueOf(inputs[0])\n        val := reflect.Indirect(reflect.ValueOf(inputs[0]))\n        var headers []string\n        for i := 0; i &lt; r.NumField(); i++ {\n            headers = append(headers, val.Type().Field(i).Name)\n        }\n        w.Write(headers)\n\n\n        // Get Content\n        for _, input := range inputs {\n            ri := reflect.ValueOf(input)\n            var result []string\n            for i := 0; i &lt; ri.NumField(); i++ {\n                switch ri.Field(i).Interface().(type) {\n                case []string:\n                    //this is the part that's looping through all the ip addresses and is causing me a headache\n                    stringArray := ri.Field(i).Interface().([]string)\n                    for ii := 0; ii &lt; len(stringArray); ii++ {\n                        stringArray[ii] = strings.Replace(stringArray[ii], \" \", \":\", -1)\n                        result = append(result,stringArray[ii])\n                    }\n                case bool:\n                    result = append(result, strconv.FormatBool(ri.Field(i).Interface().(bool)))\n                case int32:\n                    result = append(result, strconv.FormatInt(int64(ri.Field(i).Interface().(int32)), 10))\n                case []int32:\n                    intArray := ri.Field(i).Interface().([]int32)\n                    for ii := 0; ii &lt; len(intArray); ii++ {\n                        result = append(result, strconv.FormatInt(int64(intArray[ii]),10))\n                    }\n                case string:\n                    result = append(result, ri.Field(i).Interface().(string))\n                default:\n                    result = append(result, \"\")\n                }\n            }\n            w.Write(result)\n        }\n    }\n}\n</code></pre>\n"}, {"tags": ["go", "slice"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538358948, "post_id": 52583495, "comment_id": 92102420, "body": "you are having <code>!</code>(not operator) for <code>isAlpha()</code>, you also have one equivalent regular expression."}], "answers": [{"comments": [{"owner": {"reputation": 135, "user_id": 5892013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BpIz_wZA__Y/AAAAAAAAAAI/AAAAAAAAAHI/7F3QzbvKQCA/photo.jpg?sz=128", "display_name": "SYZYGY-DEV 333", "link": "https://stackoverflow.com/users/5892013/syzygy-dev-333"}, "edited": false, "score": 0, "creation_date": 1538361768, "post_id": 52583733, "comment_id": 92102856, "body": "That&#39;s exactly what I needed! Thanks"}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": true, "score": 0, "last_activity_date": 1538360401, "last_edit_date": 1538360401, "creation_date": 1538359273, "answer_id": 52583733, "question_id": 52583495, "link": "https://stackoverflow.com/questions/52583495/for-loop-iteration-over-string-slice-doesnt-work/52583733#52583733", "title": "For Loop iteration over string slice doesn&#39;t work", "body": "<blockquote>\n  <p><a href=\"https://golang.org/pkg/bufio/\" rel=\"nofollow noreferrer\">Package bufio</a></p>\n  \n  <p><a href=\"https://golang.org/pkg/bufio/#Reader.ReadString\" rel=\"nofollow noreferrer\">func (*Reader) ReadString</a></p>\n\n<pre><code>func (b *Reader) ReadString(delim byte) (string, error)\n</code></pre>\n  \n  <p>ReadString reads until the first occurrence of delim in the input,\n  returning a string containing the data up to and including the\n  delimiter. If ReadString encounters an error before finding a\n  delimiter, it returns the data read before the error and the error\n  itself (often io.EOF). ReadString returns err != nil if and only if\n  the returned data does not end in delim.</p>\n</blockquote>\n\n<hr>\n\n<blockquote>\n  <p>returning a string containing the data up to and including the\n  delimiter.</p>\n</blockquote>\n\n<p>Get rid of any trailing newlines: <code>\"\\n\"</code> or <code>\"\\r\\n\"</code>. For a quick fix, write:</p>\n\n<pre><code>sentence := strings.Split(strings.TrimSpace(sentenceraw), \" \")\n</code></pre>\n\n<p>For example,</p>\n\n<pre><code>package main\n\nimport (\n    \"bufio\"\n    \"fmt\"\n    \"os\"\n    \"regexp\"\n    \"strings\"\n\n    \"github.com/stretchr/stew/slice\"\n)\n\nfunc main() {\n    lst := []string{\"sh\", \"gl\", \"ch\", \"ph\", \"tr\", \"br\", \"fr\", \"bl\", \"gr\", \"st\", \"sl\", \"cl\", \"pl\", \"fl\", \"th\"}\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Type what you would like translated into pig-latin and press ENTER: \")\n    sentenceraw, _ := reader.ReadString('\\n')\n    sentence := strings.Split(strings.TrimSpace(sentenceraw), \" \")\n    isAlpha := regexp.MustCompile(`^[A-Za-z]+$`).MatchString\n    newsentence := make([]string, 0)\n    for _, i := range sentence {\n        if slice.Contains([]byte{'a', 'e', 'i', 'o', 'u'}, i[0]) {\n            newsentence = append(newsentence, strings.Join([]string{string(i), \"ay\"}, \"\"))\n        } else if slice.Contains(lst, string(i[0])+string(i[1])) {\n            newsentence = append(newsentence, strings.Join([]string{string(i[2:]), string(i[:2]), \"ay\"}, \"\"))\n        } else if !isAlpha(string(i)) {\n            newsentence = append(newsentence, strings.Join([]string{string(i)}, \"\"))\n        } else {\n            newsentence = append(newsentence, strings.Join([]string{string(i[1:]), string(i[0]), \"ay\"}, \"\"))\n        }\n    }\n    fmt.Println(strings.Join(newsentence, \" \"))\n}\n</code></pre>\n\n<p>Output:</p>\n\n<pre><code>Type what you would like translated into pig-latin and press ENTER: hello world\nellohay orldway\n</code></pre>\n"}], "owner": {"reputation": 135, "user_id": 5892013, "user_type": "registered", "profile_image": "https://lh6.googleusercontent.com/-BpIz_wZA__Y/AAAAAAAAAAI/AAAAAAAAAHI/7F3QzbvKQCA/photo.jpg?sz=128", "display_name": "SYZYGY-DEV 333", "link": "https://stackoverflow.com/users/5892013/syzygy-dev-333"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 63, "favorite_count": 1, "accepted_answer_id": 52583733, "answer_count": 1, "score": 1, "last_activity_date": 1538371704, "creation_date": 1538356443, "last_edit_date": 1538371704, "question_id": 52583495, "link": "https://stackoverflow.com/questions/52583495/for-loop-iteration-over-string-slice-doesnt-work", "title": "For Loop iteration over string slice doesn&#39;t work", "body": "<p>I wrote this code, which should translate a lower case english phrase into pig latin.</p>\n\n<pre><code>package main\n\nimport (\n    \"fmt\"\n    \"strings\"\n    \"bufio\"\n    \"github.com/stretchr/stew/slice\"\n    \"regexp\"\n    \"os\"\n)\n\nfunc main() {\n    lst := []string{\"sh\", \"gl\", \"ch\", \"ph\", \"tr\", \"br\", \"fr\", \"bl\", \"gr\", \"st\", \"sl\", \"cl\", \"pl\", \"fl\", \"th\"}\n    reader := bufio.NewReader(os.Stdin)\n    fmt.Print(\"Type what you would like translated into pig-latin and press ENTER: \")\n    sentenceraw, _ := reader.ReadString('\\n')\n    sentence := strings.Split(sentenceraw, \" \")\n    isAlpha := regexp.MustCompile(`^[A-Za-z]+$`).MatchString\n    newsentence := make([]string, 0)\n    for _, i := range sentence {\n        if slice.Contains([]byte{'a', 'e', 'i', 'o', 'u'}, i[0]) {\n            newsentence = append(newsentence, strings.Join([]string{string(i), \"ay\"}, \"\"))\n        } else if slice.Contains(lst, string(i[0])+string(i[1])) {\n            newsentence = append(newsentence, strings.Join([]string{string(i[2:]), string(i[:2]), \"ay\"}, \"\"))\n        } else if !isAlpha(string(i)) {\n            newsentence = append(newsentence, strings.Join([]string{string(i)}, \"\"))\n        } else {\n            newsentence = append(newsentence, strings.Join([]string{string(i[1:]), string(i[0]), \"ay\"}, \"\"))\n        }\n    }\n    fmt.Println(strings.Join(newsentence, \" \"))\n}\n</code></pre>\n\n<p>However, it fails to do anything to the last word in the phrase. </p>\n\n<p>If I use the sentence \"the quick brown fox jumped over the lazy dog\"\nI get \"ethay uickqay ownbray oxfay umpedjay overay ethay azylay dog\"</p>\n\n<p>Everything here is right, except the last word! why doesn't it work?\nThe same thing happens if I use \"hello world\" as my phrase.</p>\n"}, {"tags": ["unit-testing", "go", "testing", "import"], "comments": [{"owner": {"reputation": 979, "user_id": 806261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be401772aab83e8c0d7fd8bbdcbc7e7a?s=128&d=identicon&r=PG", "display_name": "Mustafa Simav", "link": "https://stackoverflow.com/users/806261/mustafa-simav"}, "edited": false, "score": 1, "creation_date": 1538375472, "post_id": 52583197, "comment_id": 92106088, "body": "Just try <code>go test .&#47;cmd&#47;app&#47;</code>. Running <code>go build</code>, <code>go test</code> and <code>go run</code> commands with the package name, instead of the filename, means including all files in the package."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 979, "user_id": 806261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be401772aab83e8c0d7fd8bbdcbc7e7a?s=128&d=identicon&r=PG", "display_name": "Mustafa Simav", "link": "https://stackoverflow.com/users/806261/mustafa-simav"}, "edited": false, "score": 0, "creation_date": 1538376386, "post_id": 52583197, "comment_id": 92106450, "body": "Thanks.  <code>go test .&#47;cmd&#47;app&#47;</code>  <code>..&#47;..&#47;..&#47;go&#47;src&#47;myapp&#47;cmd&#47;app&#47;main.go:10:2: local import &quot;..&#47;..&#47;somelibrary&quot; in non-local package Makefile:19: recipe for target &#39;test&#39; failed make: *** [test] Error 1</code>  I do have a library at <code>&#47;myapp&#47;somelibrary&#47;somelibrary.go</code>  I am importing in: <code>myapp&#47;cmd&#47;app&#47;main.go</code>"}, {"owner": {"reputation": 979, "user_id": 806261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be401772aab83e8c0d7fd8bbdcbc7e7a?s=128&d=identicon&r=PG", "display_name": "Mustafa Simav", "link": "https://stackoverflow.com/users/806261/mustafa-simav"}, "edited": false, "score": 1, "creation_date": 1538491820, "post_id": 52583197, "comment_id": 92156061, "body": "Local imports are highly discouraged. Set up <code>$GOPATH</code> and import with the full path."}, {"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "reply_to_user": {"reputation": 979, "user_id": 806261, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/be401772aab83e8c0d7fd8bbdcbc7e7a?s=128&d=identicon&r=PG", "display_name": "Mustafa Simav", "link": "https://stackoverflow.com/users/806261/mustafa-simav"}, "edited": false, "score": 0, "creation_date": 1538518406, "post_id": 52583197, "comment_id": 92168389, "body": "Thanks, this worked."}], "answers": [{"comments": [{"owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "edited": false, "score": 1, "creation_date": 1538843051, "post_id": 52617276, "comment_id": 92290441, "body": "For future reference, the other reason this works just fine is both packages are declared &quot;package main.&quot;  So long as you build them all, go won&#39;t see a difference and all the functions are treated as being in the same place, even if they are defined across files."}], "tags": [], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "is_accepted": true, "score": 3, "last_activity_date": 1538519191, "creation_date": 1538519191, "answer_id": 52617276, "question_id": 52583197, "link": "https://stackoverflow.com/questions/52583197/how-to-structure-imports-in-golang-test-files/52617276#52617276", "title": "How to structure imports in Golang test files", "body": "<p>If @Mustafa Simav wants to post that answer, I'll accept, but if not, to close this out:</p>\n\n<p>The solution was to use non-local imports with the full path below <code>$GOPATH</code>.  The whatever_test.go does get automagic imports correctly, even of non-exported, lowercase functions, which is exactly what I wanted to unit test.  This was just hard to see owing to the imports.</p>\n"}], "owner": {"reputation": 15339, "user_id": 1052117, "user_type": "registered", "accept_rate": 82, "profile_image": "https://www.gravatar.com/avatar/e087c44c53d1214db5fb37e4c345f533?s=128&d=identicon&r=PG", "display_name": "Mittenchops", "link": "https://stackoverflow.com/users/1052117/mittenchops"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1924, "favorite_count": 0, "accepted_answer_id": 52617276, "answer_count": 1, "score": 3, "last_activity_date": 1538519191, "creation_date": 1538352779, "last_edit_date": 1538461241, "question_id": 52583197, "link": "https://stackoverflow.com/questions/52583197/how-to-structure-imports-in-golang-test-files", "title": "How to structure imports in Golang test files", "body": "<p>I have functions defined in <code>main.go</code> that aren't accessible in <code>main_test.go</code>.  However, in some online tutorials, I see that functions are accessible: I would like to understand the difference, as well as how to structure these in a go-idiomatic way .</p>\n\n<p>Specifically, I have an application with multiple binaries:</p>\n\n<pre><code>myapp/cmd/app/main.go\nmyapp/cmd/cli/main.go\n</code></pre>\n\n<p>I currently have a lot of simple unit test logic I run in the <code>func main</code> of the <code>main.go</code> files. I'm just testing individual functions and having them print their output, I'm not trying to invoke the whole power of the \"testing\" suite, if I can avoid it.</p>\n\n<p>Since my tests in the top of my main.go are so long at this point, I would like to move them to specific test files, in for example:</p>\n\n<pre><code>myapp/cmd/app/main_test.go\nmyapp/cmd/cli/main_test.go\n</code></pre>\n\n<p>This works well enough with my makefile:</p>\n\n<pre><code># Makefile\n\nall: test build\nbuild:\n    go build -o cmd/app/main cmd/app/main.go\n    go build -o cmd/cli/main cmd/cli/main.go\ntest:\n    go test ./cmd/app/main_test.go\n    go test ./cmd/cli/main_test.go\n</code></pre>\n\n<p>If I just want to run my testfiles, I'd like to take the item in my <code>app/main.go</code></p>\n\n<pre><code>// cmd/app/main.go\npackage main\n\nfunc definedInMain(m string) string {\n  // \n}\n\nfunc main() {\n  m := definedInMain(\"1\")\n  fmt.Println(m)\n  // all the rest of my app's logic...\n}\n</code></pre>\n\n<p>And run it in my <code>main_test.go</code></p>\n\n<pre><code>// cmd/app/main_test.go\n\npackage main\n\n// no imports, I hope?\n\nfunc testDefinedInMain() {\n  m := definedInMain(\"1\")\n  fmt.Println(m)  \n}\n</code></pre>\n\n<p>However, this fails with:</p>\n\n<pre><code>undefined: definedInMain\nFAIL\n</code></pre>\n\n<p>I am confused that I have to import all these functions into my <code>main_test.go</code> files (and even when I try, it suggests <code>\"can't load package: ... myapp/cmd/app/main\" in any of: ...\"</code>)</p>\n\n<p>Is there a clean and go-idiomatic way for me to test my very simple unit tests in test files  and run my functions in main files without a lot of rewriting imports or other substantial re-architecting?  </p>\n\n<p>From some links, I had the impression if I made a <code>main_test.go</code>, the imports would follow on their own (as they seem to in these examples).</p>\n\n<ul>\n<li><a href=\"https://medium.com/@thejasbabu/testing-in-golang-c378b351002d\" rel=\"nofollow noreferrer\">https://medium.com/@thejasbabu/testing-in-golang-c378b351002d</a>\n(where the Reverse function is not explicitly imported in reverse_test.go)</li>\n<li><a href=\"https://tutorialedge.net/golang/intro-testing-in-go/\" rel=\"nofollow noreferrer\">https://tutorialedge.net/golang/intro-testing-in-go/</a>\n(where the Calculate function is not explicitly imported in main_test.go)</li>\n<li><a href=\"https://blog.alexellis.io/golang-writing-unit-tests/\" rel=\"nofollow noreferrer\">https://blog.alexellis.io/golang-writing-unit-tests/</a>\n(where the Sum function is not explicitly imported in main_test.go)</li>\n</ul>\n\n<p>So, you can see I am a bit confused tutorials get their functions imported for free, and I do not, and I just want to understand the magic better.  </p>\n\n<p>Is it just the case my function, definedInMain, is private because it's lowercased?  I do actually want this function to be private, but I'd expect it to be exported to the main_test.go file the same way it is usable in main.go.  Do I have to make it fully public to have tests in another file?  That doesn't seem correct, eg, \"it is only possible to unit test public methods in go?\"</p>\n"}, {"tags": ["go", "hashmap"], "answers": [{"comments": [{"owner": {"reputation": 1, "user_id": 10438549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab8baa604512f245cba20ea78cf3b628?s=128&d=identicon&r=PG&f=1", "display_name": "C. Sal", "link": "https://stackoverflow.com/users/10438549/c-sal"}, "edited": false, "score": 0, "creation_date": 1538397673, "post_id": 52583118, "comment_id": 92117376, "body": "Thanks @peterso. Any link to a resource where it says that a map becomes a hmap pointer and not just hmap? I looked at the go/map.go but couldn&#39;t find any mention to that."}], "tags": [], "owner": {"reputation": 133115, "user_id": 221700, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ad32856042eea9fd2db5210ac033787d?s=128&d=identicon&r=PG", "display_name": "peterSO", "link": "https://stackoverflow.com/users/221700/peterso"}, "is_accepted": false, "score": 1, "last_activity_date": 1538402884, "last_edit_date": 1538402884, "creation_date": 1538351827, "answer_id": 52583118, "question_id": 52582844, "link": "https://stackoverflow.com/questions/52582844/how-large-is-the-struct-underlying-a-map-in-golang/52583118#52583118", "title": "How large is the struct underlying a map in golang?", "body": "<p>The zero value for a Go <code>map</code> variable is a <code>nil</code> pointer.</p>\n\n<pre><code>var m map[string]int\n</code></pre>\n\n<p><code>make</code> intializes a <code>map</code> and sets the <code>map</code> variable to point to a package <code>runtime</code> <code>hmap</code> <code>struct</code>.</p>\n\n<pre><code>m = make(map[string]int)\n</code></pre>\n\n<p>In Go, all arguments are passed by value. In the case of a <code>map</code> value, a reference type, a <code>map</code> value is a pointer. Therefore, passing a <code>map</code> value as a function or method argument is fast, you are passing a pointer.</p>\n\n<p>The Go <code>map</code> <code>runtime</code> <code>struct</code>s are currently located in the <code>src/runtime/map.go</code> Go source file. Since you only see a <code>hmap</code> pointer, their size is unlikely to be relevant.</p>\n\n<p>See <a href=\"https://www.youtube.com/watch?v=Tl7mi9QmLns\" rel=\"nofollow noreferrer\">GopherCon 2016: Keith Randall - Inside the Map Implementation</a>.</p>\n"}], "owner": {"reputation": 1, "user_id": 10438549, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/ab8baa604512f245cba20ea78cf3b628?s=128&d=identicon&r=PG&f=1", "display_name": "C. Sal", "link": "https://stackoverflow.com/users/10438549/c-sal"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 545, "favorite_count": 1, "answer_count": 1, "score": 0, "last_activity_date": 1538402884, "creation_date": 1538348426, "question_id": 52582844, "link": "https://stackoverflow.com/questions/52582844/how-large-is-the-struct-underlying-a-map-in-golang", "title": "How large is the struct underlying a map in golang?", "body": "<p>I know that map is a reference type in Go (it has a pointer to the map entries memory region in its underlying struct). However, I would like to know what is the size of the underlying struct of the map because I want to know if using a pointer to a map as a function argument would be faster than not using a pointer.</p>\n\n<p>Looking at this <a href=\"https://dave.cheney.net/2018/05/29/how-the-go-runtime-implements-maps-efficiently-without-generics\" rel=\"nofollow noreferrer\">blog post</a> it seems that the maptype struct has a lot of fields and that it would take a long time to copy (relative to a pointer).</p>\n\n<p>Looking through the golang standard libraries I have found almost no use of *map[x]x so I guess using just map[x]x should be efficient as a function argument. So this leads me to think that maybe the compiler actually replaces map[x]x by a pointer to the maptype struct. Is that the case? If not what actually is happening that may avoid the copying of the maptype struct with its many fields?</p>\n"}, {"tags": ["json", "go", "unmarshalling"], "comments": [{"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538341882, "post_id": 52582123, "comment_id": 92099433, "body": "If the zero value is a valid / useful value, use a pointer to the type. <code>nil</code> pointer value will denote the missing case, and a non-<code>nil</code> value pointing to the zero value will denote the &quot;present&quot; zero value. Using a non-pointer type, you can&#39;t differentiate a missing value from a present zero value (see <a href=\"https://stackoverflow.com/questions/40970422/default-struct-values/40970490#40970490\">Default struct values</a>)."}, {"owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "reply_to_user": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 0, "creation_date": 1538341999, "post_id": 52582123, "comment_id": 92099459, "body": "ok thanks, that&#39;s the hack i mentioned in my question, was really hoping to avoid it"}, {"owner": {"reputation": 284620, "user_id": 1705598, "user_type": "registered", "accept_rate": 92, "profile_image": "https://i.stack.imgur.com/aTFoe.jpg?s=128&g=1", "display_name": "icza", "link": "https://stackoverflow.com/users/1705598/icza"}, "edited": false, "score": 1, "creation_date": 1538342041, "post_id": 52582123, "comment_id": 92099472, "body": "There is no easier way, see my edited comment. You could create your own <code>NullString</code> type and implement custom marshaling / unmarshaling on it, but that wouldn&#39;t be easier to read or use imo."}], "owner": {"reputation": 28441, "user_id": 27305, "user_type": "registered", "accept_rate": 88, "profile_image": "https://www.gravatar.com/avatar/174ac998689321daaa7cfecf910522e4?s=128&d=identicon&r=PG", "display_name": "John", "link": "https://stackoverflow.com/users/27305/john"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 31, "favorite_count": 0, "closed_date": 1538341824, "answer_count": 0, "score": 0, "last_activity_date": 1538341967, "creation_date": 1538341183, "last_edit_date": 1538341810, "question_id": 52582123, "link": "https://stackoverflow.com/questions/52582123/determine-if-value-was-provided-in-json-string-while-unmarshal", "closed_reason": "Duplicate", "title": "Determine if value was provided in json string while unmarshal", "body": "<p>When unmarshalling json into a struct, I'd like to look at the struct (or any other meta data vehicle) to know the whether a json value was provided in the json input or if a json value was omitted from the json input.  Consider this code as an example:</p>\n\n<pre><code>package main\nimport (\n  \"encoding/json\"\n  \"log\"\n)\n\ntype Person struct {\n  Name string `json:\"name\"`\n  Grades []Grade `json:\"grades\"`\n}\n\ntype Grade struct {\n  Year int `json:\"year\"`\n  Grade int `json:\"grade\"`\n}\n\nfunc main() {\n  jsonString := `{\"name\":\"john\",\"grades\":[{\"year\":1998,\"grade\":0},{\"year\":1999}]}`\n\n  person := Person{}\n  _ = json.Unmarshal([]byte(jsonString),&amp;person)\n\n  log.Println(person)\n}\n</code></pre>\n\n<p>The log prints <code>{john [{1998 0} {1999 0}]}</code>.  What is idiomatic way in Go to know that the zero of <code>1998 0</code> was explicitly declared in the JSON string while the zero of <code>1999 0</code> was the default zero when initializing the <code>struct Grade</code>?</p>\n\n<p>The reason I want to know this difference is because I want to use this struct to create an SQL statement that updates the table field <code>t_grade.grade = ?</code> if and only if the zero was explicitly provided by the json string.  Also note that <code>t_grade.grade</code> in the database is not-nullable. </p>\n\n<p>I am currently using a hack where my grade struct looks like this:</p>\n\n<pre><code>type Grade struct {\n  Year *int `json:\"year\"`\n  Grade *int `json:\"grade\"`\n}\n</code></pre>\n\n<p>So if the JSON string does not provide a value, then the grade field will be null.  Otherwise, the grade field will hold a pointer to a value.</p>\n\n<p>But I'm sure there's a better and idiomatic way to do this?</p>\n"}, {"tags": ["go", "hashmap"], "comments": [{"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 1, "creation_date": 1538340871, "post_id": 52582040, "comment_id": 92099198, "body": "you need to loop over both maps and compare the values one by one to check if values are equal."}, {"owner": {"reputation": 632, "user_id": 4377055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oFXnX.jpg?s=128&g=1", "display_name": "engrhussainahmad", "link": "https://stackoverflow.com/users/4377055/engrhussainahmad"}, "reply_to_user": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538341945, "post_id": 52582040, "comment_id": 92099448, "body": "Thanks for your help. I was just want to avoid loops, but I think this is the only solution for such a case."}, {"owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "edited": false, "score": 0, "creation_date": 1538342547, "post_id": 52582040, "comment_id": 92099590, "body": "In golang there are no work around which can provide a function to compare and return matching value. But you can use binary search for efficient solution."}], "answers": [{"tags": [], "owner": {"reputation": 67160, "user_id": 1078084, "user_type": "registered", "accept_rate": 81, "profile_image": "https://i.stack.imgur.com/wApmM.jpg?s=128&g=1", "display_name": "Akavall", "link": "https://stackoverflow.com/users/1078084/akavall"}, "is_accepted": false, "score": 0, "last_activity_date": 1538370759, "creation_date": 1538370759, "answer_id": 52584891, "question_id": 52582040, "link": "https://stackoverflow.com/questions/52582040/compare-two-maps-in-golang/52584891#52584891", "title": "Compare two maps in Golang", "body": "<p>If I understand your question correctly, the following should work:</p>\n\n<p>Step I. Reverse keys and values in your 2nd map: <code>reversed_map_2</code>. This assumes that the values are unique.</p>\n\n<p>Step II. Loop over values in your 1st map, now you can look up the values in <code>reversed_map_2</code></p>\n"}, {"tags": [], "owner": {"reputation": 109, "user_id": 8807669, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/b6a0c06065758f0a6808250af10bc323?s=128&d=identicon&r=PG&f=1", "display_name": "Bharath Kuppala", "link": "https://stackoverflow.com/users/8807669/bharath-kuppala"}, "is_accepted": false, "score": 1, "last_activity_date": 1538646042, "creation_date": 1538646042, "answer_id": 52643588, "question_id": 52582040, "link": "https://stackoverflow.com/questions/52582040/compare-two-maps-in-golang/52643588#52643588", "title": "Compare two maps in Golang", "body": "<p>I did not understand much of your second maps. But my understanding of your question is that you want to extract the unique elements from the maps.</p>\n\n<p>The result which I extracted is based on the value but not the key. It shows you how to compare 2 maps and have the result in the form of (key, value).</p>\n\n<pre><code>func unique(w http.ResponseWriter, r *http.Request) {\n    m1 := map[int]string{\n        11: \"manufacturer\",\n        2:  \"upc\",\n        5:  \"short_description\",\n        10: \"\",\n        4:  \"category\",\n        6:  \" \",\n        7:  \"url\",\n        8:  \"image\",\n        9:  \"\",\n        0:  \"name\",\n        1:  \"mpn\",\n        3:  \"sku\",\n    }\n    m2 := map[int]string{\n        3:  \"manufacturer\",\n        5:  \"mpn\",\n        8:  \"category_path\",\n        10: \"is_in_stock\",\n        2:  \"final_price\",\n        1:  \"name\",\n        4:  \"short_description\",\n        6:  \"thumbnail\",\n        7:  \"url\",\n        9:  \"furniture_type\",\n        0:  \"sku\",\n    }\n\n    for key, val := range m1 {\n        found := false\n        for key1, val1 := range m2 {\n            if val == val1 {\n                found = true\n                fmt.Println(\"second map\")\n                fmt.Println(\"key:\", key1, \"val:\", val1)\n                break\n            }\n        }\n        if found {\n            fmt.Println(\"first map\")\n            fmt.Println(\"key:\", key, \"val:\", val)\n        }\n    }\n}\n</code></pre>\n\n<p>The output will be :</p>\n\n<pre><code>second map\nkey: 5 val: mpn\nfirst map\nkey: 1 val: mpn\nsecond map\nkey: 0 val: sku\nfirst map\nkey: 3 val: sku\nsecond map\nkey: 3 val: manufacturer\nfirst map\nkey: 11 val: manufacturer\nsecond map\nkey: 1 val: name\nfirst map\nkey: 0 val: name\nsecond map\nkey: 4 val: short_description\nfirst map\nkey: 5 val: short_description\nsecond map\nkey: 7 val: url\nfirst map\nkey: 7 val: url\n</code></pre>\n\n<p>In order to show the clear difference between matched elements based on the value I used if found.</p>\n"}], "owner": {"reputation": 632, "user_id": 4377055, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/oFXnX.jpg?s=128&g=1", "display_name": "engrhussainahmad", "link": "https://stackoverflow.com/users/4377055/engrhussainahmad"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4048, "favorite_count": 0, "answer_count": 2, "score": -1, "last_activity_date": 1538646042, "creation_date": 1538340578, "last_edit_date": 1538342563, "question_id": 52582040, "link": "https://stackoverflow.com/questions/52582040/compare-two-maps-in-golang", "title": "Compare two maps in Golang", "body": "<p>I have two Maps:</p>\n\n<p>First one:    </p>\n\n<pre><code>map[11:manufacturer 2:upc 5:short_description 10: 4:category 6: 7:url \n8:image 9: 0:name 1:mpn 3:sku]\n</code></pre>\n\n<p>Second one:</p>\n\n<pre><code>map[3:manufacturer 5:mpn 8:category_path 10:is_in_stock 2:final_price \n1:name 4:short_description 6:thumbnail 7:url 9:furniture_type 0:sku]\nmap[news_to_date:2014-10-20 00:00:00 url_key:zanbury-panel-storage- \nbedroom-set price:0 media_gallery:[map[value_id:507779 file:/b/2/b217- \n31-36-46-57-54s-95-92.jpg label:&lt;nil&gt; disabled:0 position:1] \nmap[label:&lt;nil&gt; disabled:0 position:2 value_id:507777 file:/b/2/b217- \n57-54s-95_1.jpg] map[value_id:507778 file:/b/2/b217-57-detail_3.jpg \nlabel:&lt;nil&gt; disabled:0 position:3] map[value_id:507780 file:/b/2/b217- \n54s-detail_1.jpg label:&lt;nil&gt; disabled:0 position:4] \nmap[file:/b/2/b217-handle_1.jpg label:&lt;nil&gt; disabled:0 position:5 \nvalue_id:507781] map[value_id:507782 file:/b/2/b217-92-sw_1.jpg label: \n&lt;nil&gt; disabled:0 position:6] map[value_id:507783 file:/b/2/b217-31-36- \nsw_-_copy_2_.jpg label:&lt;nil&gt; disabled:0 position:7] \nmap[value_id:507784 file:/b/2/b217-46-sw_1.jpg label:&lt;nil&gt; disabled:0 \nposition:8]] sku_8:&lt;nil&gt; sku_1:&lt;nil&gt; shipment_type:0 url_path:zanbury- \npanel-storage-bedroom-set.htm custom_design:&lt;nil&gt; sku_5:&lt;nil&gt; upc: \n&lt;nil&gt; special_from_date:&lt;nil&gt; mk_expecdate:&lt;nil&gt; sku_type:1 \nhas_options:1 price_view:0 jet_price:&lt;nil&gt; categories:[11 10809]\n</code></pre>\n\n<p>How I can compare both and select those values from the second one which matches the first one.</p>\n"}, {"tags": ["postgresql", "go"], "answers": [{"tags": [], "owner": {"reputation": 14633, "user_id": 5069957, "user_type": "registered", "accept_rate": 78, "profile_image": "https://www.gravatar.com/avatar/597577c2765adaa190e4524d3a3860fe?s=128&d=identicon&r=PG&f=1", "display_name": "edkeveked", "link": "https://stackoverflow.com/users/5069957/edkeveked"}, "is_accepted": true, "score": 2, "last_activity_date": 1538336216, "creation_date": 1538336216, "answer_id": 52581467, "question_id": 52580392, "link": "https://stackoverflow.com/questions/52580392/how-do-i-place-the-avg-of-a-row-into-a-new-column/52581467#52581467", "title": "How do I place the AVG of a row into a new column?", "body": "<p>Since the json of the post request already contains the <code>tts_data</code>, you can get the average before setting it in the database</p>\n\n<pre><code>sum := 0\nfor _, i := range tts_data {\n sum += i\n}\navg := sum / len(tts_data)\n// save the data in your db\nrs := Ressource{Name: \"name\", TTS: tts_data, ttc: avg}\nb := db.Create(&amp;rs)\nif b {\n  // send all the resource\n  json.NewEncoder(w).Encode(&amp;rs)\n  // or send only the avg\n  json.NewEncoder(w).Encode(struct{avg: int}{avg: avg})\n} else {\n  // handle error\n}\n</code></pre>\n"}], "owner": {"reputation": 444, "user_id": 9442592, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/XVEaV.jpg?s=128&g=1", "display_name": "dmc94", "link": "https://stackoverflow.com/users/9442592/dmc94"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 134, "favorite_count": 1, "accepted_answer_id": 52581467, "answer_count": 1, "score": 3, "last_activity_date": 1538336216, "creation_date": 1538328636, "last_edit_date": 1538329122, "question_id": 52580392, "link": "https://stackoverflow.com/questions/52580392/how-do-i-place-the-avg-of-a-row-into-a-new-column", "title": "How do I place the AVG of a row into a new column?", "body": "<p>Hey everyone I am using golang to build a super simple API. I have this json data being passed from a POST request and being stored in my DB. I would like to take the tts data which is an integer array and average that array and place it in the ttc column and return that number on the json response. I am having a hard time doing that any help would be greatly appreciated. My source code is below as well as my DB Model. I know I would have to use the AVG() function somehow in postgres but I am brand new to postgres so I am super confused.</p>\n\n<p>main.go</p>\n\n<pre><code>package main\n\nimport (\n\"encoding/json\"\n\"github.com/gorilla/mux\"\n\"github.com/jinzhu/gorm\"\n\"github.com/lib/pq\"\n\"github.com/rs/cors\"\n\"log\"\n\"net/http\"\n\n_ \"github.com/jinzhu/gorm/dialects/postgres\"\n)\n\ntype Resource struct {\n    gorm.Model\n\n    Name        string\n    TTS     pq.Int64Array `gorm:\"type:integer[]\"`\n    TTC int\n}\n\nvar db *gorm.DB\nvar err error\n\nfunc main() {\n    router := mux.NewRouter()\n\n    db, err = gorm.Open(\n        \"postgres\",\n        \"host=localhost\"+\" user=postgres\"+\n        \" dbname=Shoes\"+\" sslmode=disable password=root\")\n\n    if err != nil {\n        panic(\"failed to connect database\")\n    }\n\n    defer db.Close()\n\n    db.AutoMigrate(&amp;Resource{})\n\n    router.HandleFunc(\"/resources\", GetResources).Methods(\"GET\")\n    router.HandleFunc(\"/resources/{id}\", GetResource).Methods(\"GET\")\n    router.HandleFunc(\"/resources\", CreateResource).Methods(\"POST\")\n    router.HandleFunc(\"/resources/{id}\", DeleteResource).Methods(\"DELETE\")\n\n    handler := cors.Default().Handler(router)\n\n    log.Fatal(http.ListenAndServe(\":8080\", handler))\n}\n\nfunc GetResources(w http.ResponseWriter, r *http.Request) {\n    var resources []Resource\n    db.Find(&amp;resources)\n    json.NewEncoder(w).Encode(&amp;resources)\n}\n\nfunc GetResource(w http.ResponseWriter, r *http.Request) {\n    params := mux.Vars(r)\n    var resource Resource\n    db.First(&amp;resource, params[\"id\"])\n    json.NewEncoder(w).Encode(&amp;resource)\n}\n\nfunc CreateResource(w http.ResponseWriter, r *http.Request) {\n    var resource Resource\n    json.NewDecoder(r.Body).Decode(&amp;resource)\n    db.Create(&amp;resource)\n    json.NewEncoder(w).Encode(&amp;resource)\n}\n\nfunc DeleteResource(w http.ResponseWriter, r *http.Request) {\n    params := mux.Vars(r)\n    var resource Resource\n    db.First(&amp;resource, params[\"id\"])\n    db.Delete(&amp;resource)\n\n    var resources []Resource\n    db.Find(&amp;resources)\n    json.NewEncoder(w).Encode(&amp;resources)\n}\n</code></pre>\n\n<p>I am thinking I could do something like </p>\n\n<pre><code>db.Select(\"AVG(tts)\")\n</code></pre>\n\n<p>I am just not sure how to put that result in the column ttc</p>\n"}, {"tags": ["docker", "go", "dependencies", "dockerfile"], "answers": [{"tags": [], "owner": {"reputation": 38307, "user_id": 2057388, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/ceef8c04f66cd0e2bd360ef6abc14a81?s=128&d=identicon&r=PG", "display_name": "\u0417\u0435\u043b\u0451\u043d\u044b\u0439", "link": "https://stackoverflow.com/users/2057388/%d0%97%d0%b5%d0%bb%d1%91%d0%bd%d1%8b%d0%b9"}, "is_accepted": true, "score": 8, "last_activity_date": 1538316959, "creation_date": 1538316959, "answer_id": 52578691, "question_id": 52578581, "link": "https://stackoverflow.com/questions/52578581/trying-to-install-dependencies-using-dep-in-docker/52578691#52578691", "title": "Trying to install dependencies using dep in docker", "body": "<p>Here is an example of Dockerfile with dep:</p>\n\n<pre><code>FROM golang:latest \n\nLABEL version=\"1.0\"\n\nRUN mkdir /go/src/app\n\nRUN go get -u github.com/golang/dep/cmd/dep\n\nADD ./main.go /go/src/app\nCOPY ./Gopkg.toml /go/src/app\n\nWORKDIR /go/src/app \n\nRUN dep ensure \nRUN go test -v \nRUN go build\n\nCMD [\"./app\"]\n</code></pre>\n"}, {"tags": [], "owner": {"reputation": 2208, "user_id": 5328069, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/21DZ0.jpg?s=128&g=1", "display_name": "morganbaz", "link": "https://stackoverflow.com/users/5328069/morganbaz"}, "is_accepted": false, "score": 1, "last_activity_date": 1538327543, "creation_date": 1538327543, "answer_id": 52580239, "question_id": 52578581, "link": "https://stackoverflow.com/questions/52578581/trying-to-install-dependencies-using-dep-in-docker/52580239#52580239", "title": "Trying to install dependencies using dep in docker", "body": "<p>You need to change the directory to that of your project. Also, in order to get dependencies, you will usually already have a <code>Gopkg.toml</code> and <code>Gopkg.lock</code> - <code>dep init</code> is ONLY used when you're moving from a project which was using another vendoring tool, no vendoring at all or you're starting a project from scratch.</p>\n\n<p>To sum up, I'd do something like this:</p>\n\n<pre><code>FROM golang:latest\nRUN go get -u github.com/golang/dep/cmd/dep \\\n&amp;&amp;  mkdir /go/src/github.com/you \\\n&amp;&amp;  git clone https://github.com/you/yourproject /go/src/github.com/you/yourproject\n\nWORKDIR /go/src/github.com/you/yourproject\n\nRUN dep ensure -v\n&amp;&amp;  go build\n\nCMD [\"./yourproject\"]\n</code></pre>\n"}], "owner": {"reputation": 8884, "user_id": 5821354, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/Qc8o0.jpg?s=128&g=1", "display_name": "Himanshu", "link": "https://stackoverflow.com/users/5821354/himanshu"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 4174, "favorite_count": 1, "accepted_answer_id": 52578691, "answer_count": 2, "score": 4, "last_activity_date": 1538327543, "creation_date": 1538316150, "question_id": 52578581, "link": "https://stackoverflow.com/questions/52578581/trying-to-install-dependencies-using-dep-in-docker", "title": "Trying to install dependencies using dep in docker", "body": "<p>I have created a docker file in which I have installed golang dep tool which will be used to install the dependencies required by golang project. I have been able to install the tool. But unable to install the dependencies using that tool. I am not sure how to configure dep tool to be able to run dep command in docker image which will install all the dependencies required by golang project</p>\n\n<p>I am using below command to run dep tool and it works in local machine</p>\n\n<pre><code># initialize the project and install dependencies\nRUN dep init\n</code></pre>\n\n<p>I am always getting an error:</p>\n\n<blockquote>\n  <p>init failed: unable to determine the import path for the root project\n  /go: /go is not within any GOPATH/src</p>\n</blockquote>\n\n<p>Now I do not know if I need to set path to o binary files or how I can achieve that. There are tutorials to build a docker file to build golang project but nothing is there on internet to install dependencies using golang dep tool.</p>\n"}, {"tags": ["go", "runtime"], "answers": [{"tags": [], "owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "is_accepted": false, "score": 1, "last_activity_date": 1538310658, "creation_date": 1538310658, "answer_id": 52577889, "question_id": 52576971, "link": "https://stackoverflow.com/questions/52576971/why-atomic-load-not-called-to-load-gcphase-in-runtime-gc/52577889#52577889", "title": "Why atomic.Load not called to load gcphase in runtime.GC?", "body": "<p>Code excerpt:</p>\n\n<pre><code>func setGCPhase(x uint32) {\n    atomic.Store(&amp;gcphase, x)\n    writeBarrier.needed = gcphase == _GCmark || gcphase == _GCmarktermination\n    writeBarrier.enabled = writeBarrier.needed || writeBarrier.cgo\n}\n</code></pre>\n\n<p>while <code>gcphase</code> is a global variable, but all writes to <code>gcphase</code> are done through the above function.</p>\n\n<p>There were several variables in runtime which aren't paired properly, but seems they have reason for it and were sure they were having the exclusive access to it.</p>\n\n<blockquote>\n  <p>Here is the issue <a href=\"https://github.com/golang/go/issues/21931\" rel=\"nofollow noreferrer\">https://github.com/golang/go/issues/21931</a> filed about the same and here <a href=\"https://go-review.googlesource.com/c/go/+/65210\" rel=\"nofollow noreferrer\">https://go-review.googlesource.com/c/go/+/65210</a> GC developers had some discussions on changing the same. </p>\n</blockquote>\n"}], "owner": {"reputation": 25, "user_id": 10428270, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2540eeaf271bf56d3ce33dd96abf0a3f?s=128&d=identicon&r=PG&f=1", "display_name": "gopher", "link": "https://stackoverflow.com/users/10428270/gopher"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 46, "favorite_count": 2, "answer_count": 1, "score": 0, "last_activity_date": 1538310658, "creation_date": 1538302760, "question_id": 52576971, "link": "https://stackoverflow.com/questions/52576971/why-atomic-load-not-called-to-load-gcphase-in-runtime-gc", "title": "Why atomic.Load not called to load gcphase in runtime.GC?", "body": "<p>I wonder why <code>gcphase</code> is not protected with <code>atomic.Load</code>:</p>\n\n<pre><code>n := atomic.Load(&amp;work.cycles)\nif gcphase == _GCmark {\n    // Wait until sweep termination, mark, and mark\n    // termination of cycle N complete.\n    gp.schedlink = work.sweepWaiters.head\n    work.sweepWaiters.head.set(gp)\n    goparkunlock(&amp;work.sweepWaiters.lock, \"wait for GC cycle\", traceEvGoBlock, 1)\n} else {\n    // We're in sweep N already.\n    unlock(&amp;work.sweepWaiters.lock)\n}\n</code></pre>\n\n<p>Anyone knows?</p>\n"}, {"tags": ["json", "go", "post", "go-echo"], "comments": [{"owner": {"reputation": 10878, "user_id": 303254, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5WEYC.jpg?s=128&g=1", "display_name": "Orel Eraki", "link": "https://stackoverflow.com/users/303254/orel-eraki"}, "edited": false, "score": 0, "creation_date": 1538299366, "post_id": 52576499, "comment_id": 92088372, "body": "I don&#39;t much about Go, but does &amp; really needed on <code>&amp;creds</code> ?"}, {"owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "reply_to_user": {"reputation": 10878, "user_id": 303254, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5WEYC.jpg?s=128&g=1", "display_name": "Orel Eraki", "link": "https://stackoverflow.com/users/303254/orel-eraki"}, "edited": false, "score": 0, "creation_date": 1538299468, "post_id": 52576499, "comment_id": 92088399, "body": "Yes, this is because the bind function doesn&#39;t return the result, but parse it right onto the argument. Hence must be a pointer and not a copy"}, {"owner": {"reputation": 10878, "user_id": 303254, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5WEYC.jpg?s=128&g=1", "display_name": "Orel Eraki", "link": "https://stackoverflow.com/users/303254/orel-eraki"}, "edited": false, "score": 0, "creation_date": 1538299577, "post_id": 52576499, "comment_id": 92088430, "body": "You probably already seen it, but look on to this example, to see if you forgot something <a href=\"https://echo.labstack.com/guide/request\" rel=\"nofollow noreferrer\">echo.labstack.com/guide/request</a>"}, {"owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "reply_to_user": {"reputation": 10878, "user_id": 303254, "user_type": "registered", "accept_rate": 60, "profile_image": "https://i.stack.imgur.com/5WEYC.jpg?s=128&g=1", "display_name": "Orel Eraki", "link": "https://stackoverflow.com/users/303254/orel-eraki"}, "edited": false, "score": 0, "creation_date": 1538299888, "post_id": 52576499, "comment_id": 92088491, "body": "yup. checked. looks fine, but still doesn&#39;t work. thanks :/ @OrelEraki"}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 0, "creation_date": 1538308190, "post_id": 52576499, "comment_id": 92090417, "body": "Possible duplicate of <a href=\"https://stackoverflow.com/questions/11126793/json-and-dealing-with-unexported-fields\">JSON and dealing with unexported fields</a>"}], "answers": [{"tags": [], "owner": {"reputation": 452, "user_id": 4334369, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/164mz.jpg?s=128&g=1", "display_name": "sieberts", "link": "https://stackoverflow.com/users/4334369/sieberts"}, "is_accepted": true, "score": 4, "last_activity_date": 1538299866, "creation_date": 1538299866, "answer_id": 52576604, "question_id": 52576499, "link": "https://stackoverflow.com/questions/52576499/cant-parse-json-from-a-post-requests/52576604#52576604", "title": "can&#39;t parse JSON from a post requests", "body": "<p>You should export the fields of your credentials-struct by capitalizing each first letter, otherwise the json-package doesn't know what fields you have:</p>\n\n<pre><code>type credentials struct {\n    Email string `json:\"email\"`\n    Pass string `json:\"pass\"`\n}\n</code></pre>\n\n<p>for more information: <a href=\"https://stackoverflow.com/questions/11126793/json-and-dealing-with-unexported-fields\">JSON and dealing with unexported fields</a></p>\n"}], "owner": {"reputation": 449, "user_id": 9024502, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/6acRO.jpg?s=128&g=1", "display_name": "Nitzan Cohen", "link": "https://stackoverflow.com/users/9024502/nitzan-cohen"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 2039, "favorite_count": 0, "accepted_answer_id": 52576604, "answer_count": 1, "score": 0, "last_activity_date": 1538308159, "creation_date": 1538299058, "last_edit_date": 1538308159, "question_id": 52576499, "link": "https://stackoverflow.com/questions/52576499/cant-parse-json-from-a-post-requests", "title": "can&#39;t parse JSON from a post requests", "body": "<p>I built an echo microservice api, with two routings: post and get.</p>\n\n<p>The get method works fine, but the get method can't parse the JSON, meaning the struct is empty after the Bind() func.</p>\n\n<p>It must be a very stupid and tiny thing I am missing... any help?</p>\n\n<pre><code>// main.go\n//--------------------------------------------------------------------\nfunc main() {\n    e := echo.New()\n\n    e.GET(\"/getmethod\", func(c echo.Context) error { return c.JSON(200, \"good\")})\n    e.POST(\"/login\", handlers.HandleLogin)\n\n    e.Start(\"localhost:8000\")\n\n}\n\n\n// handlers/login.go\n//--------------------------------------------------------------------\ntype credentials struct {\n    email string `json:\"email\"`\n    pass string `json:\"pass\"`\n}\n\n//--------------------------------------------------------------------\nfunc HandleLogin(c echo.Context) error {\n    var creds credentials\n    err := c.Bind(&amp;creds)\n\n    if err != nil {\n        return c.JSON(http.StatusBadRequest, err) // 400\n    }\n\n    return c.JSON(http.StatusOK, creds.email) // 200\n}\n</code></pre>\n\n<p>When running a post request with postman (to make sure: post method, url is to the correct route, in the body> under raw> JSON format, I send the JSON as expected ) I receive back status 200 ok, but empty json, whereas I would expect to receive the email attribute.</p>\n\n<p>Any idea why the Bind() didn't extract the fields correctly?</p>\n"}, {"tags": ["go", "go-gorm"], "comments": [{"owner": {"reputation": 2783, "user_id": 4145098, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/41Miz.jpg?s=128&g=1", "display_name": "Ullaakut", "link": "https://stackoverflow.com/users/4145098/ullaakut"}, "edited": false, "score": 0, "creation_date": 1538294369, "post_id": 52575750, "comment_id": 92087174, "body": "Pretty sure that if you use pointers for your time fields they will be returned nil if they aren&#39;t set, and returned properly if they are :)"}], "answers": [{"comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538299589, "post_id": 52576167, "comment_id": 92088432, "body": "that&#39;s not the way you handle errors, gorm provides a method call to look if record is not found."}], "tags": [], "owner": {"user_type": "does_not_exist", "display_name": "user10390028"}, "is_accepted": false, "score": -1, "last_activity_date": 1538296403, "creation_date": 1538296403, "answer_id": 52576167, "question_id": 52575750, "link": "https://stackoverflow.com/questions/52575750/return-nil-struct-instead-of-empty-struct-go-gorm/52576167#52576167", "title": "Return nil struct instead of empty struct go-gorm", "body": "<p>Add a Pointer function</p>\n\n<pre><code>func (user User) Pointer() *User {\n    var t time.Time\n    if user.UUID == \"\" &amp;&amp; user.Name == \"\" &amp;&amp; user.CreatedAt == t &amp;&amp; user.UpdatedAt == t {\n        return nil\n    }\n    return &amp;user\n}\n</code></pre>\n\n<p>and pass it</p>\n\n<pre><code>var user User\ndb.First(user.Pointer())\n</code></pre>\n"}, {"comments": [{"owner": {"reputation": 2656, "user_id": 1186243, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZeMe1.jpg?s=128&g=1", "display_name": "sbarow", "link": "https://stackoverflow.com/users/1186243/sbarow"}, "edited": false, "score": 0, "creation_date": 1538304644, "post_id": 52576406, "comment_id": 92089603, "body": "Ah yes, thought I was going about this the wrong way. Thank you."}], "tags": [], "owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "is_accepted": true, "score": 4, "last_activity_date": 1538298313, "creation_date": 1538298313, "answer_id": 52576406, "question_id": 52575750, "link": "https://stackoverflow.com/questions/52575750/return-nil-struct-instead-of-empty-struct-go-gorm/52576406#52576406", "title": "Return nil struct instead of empty struct go-gorm", "body": "<p>In gorm you are supposed to check if the record is empty, with a method call:</p>\n\n<pre><code>if db.First(&amp;user, 77).RecordNotFound() {\n    log.Println(\"UUID:\", 77, err)\n}\n</code></pre>\n"}], "owner": {"reputation": 2656, "user_id": 1186243, "user_type": "registered", "accept_rate": 88, "profile_image": "https://i.stack.imgur.com/ZeMe1.jpg?s=128&g=1", "display_name": "sbarow", "link": "https://stackoverflow.com/users/1186243/sbarow"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 1053, "favorite_count": 0, "accepted_answer_id": 52576406, "answer_count": 2, "score": 0, "last_activity_date": 1538298313, "creation_date": 1538293302, "question_id": 52575750, "link": "https://stackoverflow.com/questions/52575750/return-nil-struct-instead-of-empty-struct-go-gorm", "title": "Return nil struct instead of empty struct go-gorm", "body": "<p>With the following model:</p>\n\n<pre><code>type User struct {\n    UUID string         `gorm:\"primary_key\"`\n    Name string         `gorm:\"NOT NULL\"`\n    CreatedAt time.Time\n    UpdatedAt time.Time\n}\n</code></pre>\n\n<p>If you do the following query with go-gorm for a user that does <strong>NOT</strong> exist:</p>\n\n<pre><code>var user User\ndb.First(&amp;user)\n</code></pre>\n\n<p>You end up receiving an empty struct with the date fields populated. Is there a way to instead just receive a <code>nil</code> struct back or am I thinking about this in the wrong way?</p>\n"}, {"tags": ["tensorflow", "go", "deep-learning"], "comments": [{"owner": {"reputation": 6698, "user_id": 1758853, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/cdbacfa38ad2771753630807afda86a8?s=128&d=identicon&r=PG", "display_name": "Jonathan Muller", "link": "https://stackoverflow.com/users/1758853/jonathan-muller"}, "edited": false, "score": 0, "creation_date": 1550043833, "post_id": 52575558, "comment_id": 96120232, "body": "I have the same error. Did you find the answer by any chance ?"}], "owner": {"reputation": 732, "user_id": 1442435, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/01c2824c79133dd9014ed6c5652ebfe4?s=128&d=identicon&r=PG", "display_name": "eclaude", "link": "https://stackoverflow.com/users/1442435/eclaude"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 68, "favorite_count": 1, "answer_count": 0, "score": 2, "last_activity_date": 1538291750, "creation_date": 1538291750, "question_id": 52575558, "link": "https://stackoverflow.com/questions/52575558/tensorflow-retrain-an-image-classifier", "title": "Tensorflow Retrain an Image Classifier", "body": "<p>I just followed the documentation <a href=\"https://www.tensorflow.org/hub/tutorials/image_retraining\" rel=\"nofollow noreferrer\">here Image Retraining</a></p>\n\n<p>In step <strong>Using the Retrained Model</strong> I have a very correct estimate</p>\n\n<pre><code>python label_image.py --graph=graph.pb --labels=labels.pb --input_layer=Placeholder --output_layer=final_result --image=../color/blue/blue25.jpg\n2018-09-30 10:57:53.153552: I tensorflow/core/platform/cpu_feature_guard.cc:141] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA\nblue 0.9326643\nred 0.06733578  \n</code></pre>\n\n<p>But if i try to use in this code :</p>\n\n<p><a href=\"https://github.com/hybridgroup/gocv/blob/3f4d73bc6a6e20e4880c0ea208f3e80880e1c725/cmd/tf-classifier/main.go\" rel=\"nofollow noreferrer\">tf-classifier by hybridgroup/gocv</a></p>\n\n<p>i have a error :</p>\n\n<pre><code>libc++abi.dylib: terminating with uncaught exception of type cv::Exception: OpenCV(3.4.2) /tmp/opencv-20180704-99354-1kt9ska/opencv-3.4.2/modules/dnn/src/dnn.cpp:2270: error: (-204:Requested object was not found) Requested blob \"input\" not found in function 'setInput'\n</code></pre>\n\n<p>But if I use Tensorflow \"Inception\" model it works.</p>\n\n<p>Do you have an idea ?</p>\n"}, {"tags": ["go", "cgo"], "comments": [{"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538291956, "post_id": 52575500, "comment_id": 92086665, "body": "defer function runs even if your program exits abnormally, so yes."}, {"owner": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 3, "creation_date": 1538292901, "post_id": 52575500, "comment_id": 92086862, "body": "@nilsocket Not <i>always</i>: <a href=\"https://play.golang.org/p/uxxpN6HZYed\" rel=\"nofollow noreferrer\">play.golang.org/p/uxxpN6HZYed</a>"}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "reply_to_user": {"reputation": 2960, "user_id": 3521243, "user_type": "registered", "accept_rate": 50, "profile_image": "https://i.stack.imgur.com/EJDD8.jpg?s=128&g=1", "display_name": "Emile Pels", "link": "https://stackoverflow.com/users/3521243/emile-pels"}, "edited": false, "score": 2, "creation_date": 1538294197, "post_id": 52575500, "comment_id": 92087136, "body": "@EmilePels you were explicitly mentioning to exit the program with <code>os.Exit()</code> , once this function is executed it exits, if user didn&#39;t mention to exit but due to some err or program panic then defer does run."}, {"owner": {"reputation": 3896, "user_id": 1113760, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/a2305795c77659396611129c962beb8a?s=128&d=identicon&r=PG", "display_name": "Cosmic Ossifrage", "link": "https://stackoverflow.com/users/1113760/cosmic-ossifrage"}, "reply_to_user": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538306417, "post_id": 52575500, "comment_id": 92090036, "body": "@nilsocket This rests on some ambiguous definitions. If we define an &quot;abnormal exit&quot; as one in which <code>os.Exit</code> is called (rather than control flow naturally reaching the end of the <code>main</code> function), then Emile is correct. The point being made, which is an important one, is that there are conditions in Go in which deferred calls may <i>not</i> be run, and it is important to represent this possibility for completeness whenever exit conditions are discussed."}], "owner": {"reputation": 791, "user_id": 1622305, "user_type": "registered", "profile_image": "https://www.gravatar.com/avatar/2544f661448e8b67db1aac8c2cec23a2?s=128&d=identicon&r=PG", "display_name": "MoonFruit", "link": "https://stackoverflow.com/users/1622305/moonfruit"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 171, "favorite_count": 0, "answer_count": 0, "score": 0, "last_activity_date": 1538291331, "creation_date": 1538291331, "question_id": 52575500, "link": "https://stackoverflow.com/questions/52575500/does-go-run-defer-function-after-called-c-function-that-longjmp-to-somewhere", "title": "Does Go run defer function after called C function that longjmp to somewhere?", "body": "<p>I'm stuck in this question.</p>\n\n<p>A go function like this:</p>\n\n<pre><code>func GoFunction(str string) {\n    cstr := C.CString(str)\n    defer C.free(unsafe.Pointer(cstr))\n    C.CFunction(cstr)\n}\n</code></pre>\n\n<p>And <code>C.CFunction()</code> use <code>longjmp</code> to jump to somewhere.</p>\n\n<p>My question is that if <code>C.CFunction()</code> <code>longjmp</code>, does defer function run? Does <code>cstr</code> be freed?</p>\n"}, {"tags": ["go", "traefik"], "answers": [{"tags": [], "owner": {"reputation": 427, "user_id": 6090666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kkkr9rwFFjA/AAAAAAAAAAI/AAAAAAAAAU0/e5aH273wQCI/photo.jpg?sz=128", "display_name": "Vadim Kozak", "link": "https://stackoverflow.com/users/6090666/vadim-kozak"}, "is_accepted": false, "score": 0, "last_activity_date": 1538421135, "creation_date": 1538421135, "answer_id": 52597432, "question_id": 52575409, "link": "https://stackoverflow.com/questions/52575409/traefik-forward-auth-per-frontend/52597432#52597432", "title": "Traefik forward auth per frontend", "body": "<p>Thanks to <a href=\"https://github.com/dniel\" rel=\"nofollow noreferrer\">Daniel</a> he helped me.</p>\n\n<p>So, it's really easy to do:</p>\n\n<ol>\n<li>Check your traefik version its should be at least 1.7 (i am not sure in which version this feature was added but its working in 1.7 and 1.7.1).</li>\n<li><p>Make your config like this:</p>\n\n<p><code>[frontends.service]\n backend = \"service\"\n  passHostHeader = true\n  [frontends.ordersWorker.auth.forward]\n     address = \"http://127.0.0.1:8090\"</code></p></li>\n</ol>\n"}], "owner": {"reputation": 427, "user_id": 6090666, "user_type": "registered", "profile_image": "https://lh4.googleusercontent.com/-kkkr9rwFFjA/AAAAAAAAAAI/AAAAAAAAAU0/e5aH273wQCI/photo.jpg?sz=128", "display_name": "Vadim Kozak", "link": "https://stackoverflow.com/users/6090666/vadim-kozak"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": false, "view_count": 372, "favorite_count": 0, "answer_count": 1, "score": 1, "last_activity_date": 1538421135, "creation_date": 1538290542, "question_id": 52575409, "link": "https://stackoverflow.com/questions/52575409/traefik-forward-auth-per-frontend", "title": "Traefik forward auth per frontend", "body": "<p>I am trying to divide microservices and their auth.</p>\n\n<p>Demo config is looks like:</p>\n\n<pre><code> [frontends]\n  [frontends.frontend1]\n  entryPoints = [\"http\"]\n  backend = \"rancher1\"\n  passHostHeader = true\n  forwardAuth = \"http://127.0.0.1:8090\"\n   [frontends.frontend1.routes.test_1]\n    rule = \"PathPrefixStrip:/order\"\n\n\n [frontends.rancher2]\n  backend = \"rancher2\"\n  passHostHeader = true\n  [frontends.rancher2.routes.test_1]\n   rule = \"PathPrefixStrip:/test\"\n</code></pre>\n\n<p>How to apply forwardAuth to <code>frontends.frontend1</code> </p>\n"}, {"tags": ["algorithm", "go"], "comments": [{"owner": {"reputation": 213464, "user_id": 2357112, "user_type": "registered", "accept_rate": 26, "profile_image": "https://www.gravatar.com/avatar/3f80897d57525afe9eac4fb8c8318052?s=128&d=identicon&r=PG", "display_name": "user2357112 supports Monica", "link": "https://stackoverflow.com/users/2357112/user2357112-supports-monica"}, "edited": false, "score": 0, "creation_date": 1538289968, "post_id": 52575282, "comment_id": 92086283, "body": "For what it&#39;s worth, <code>split</code> was originally a <a href=\"https://docs.python.org/2/library/string.html#string.split\" rel=\"nofollow noreferrer\">library routine</a> in Python as well."}, {"owner": {"reputation": 1209, "user_id": 8256506, "user_type": "registered", "profile_image": "https://i.stack.imgur.com/PlvCt.png?s=128&g=1", "display_name": "nilsocket", "link": "https://stackoverflow.com/users/8256506/nilsocket"}, "edited": false, "score": 0, "creation_date": 1538290549, "post_id": 52575282, "comment_id": 92086376, "body": "go authors don&#39;t want to clutter the programming language with things which weren&#39;t absolutely necessary, so if there is some need for something you will get them through stdlib."}, {"owner": {"reputation": 24447, "user_id": 603316, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/4db0c2cbf2d5c9c196902dfc9db8218d?s=128&d=identicon&r=PG", "display_name": "Peter", "link": "https://stackoverflow.com/users/603316/peter"}, "edited": false, "score": 2, "creation_date": 1538292692, "post_id": 52575282, "comment_id": 92086818, "body": "The more general question is &quot;Why don&#39;t the basic Go types have any methods?&quot; That&#39;s likely for consistency. If Split was a method, you&#39;d expect Join to be a method of <code>[]string</code>, but that would require string slices to be special instead of just another slice type."}, {"owner": {"reputation": 60130, "user_id": 13860, "user_type": "registered", "accept_rate": 63, "profile_image": "https://www.gravatar.com/avatar/6bdc06836b7bcec9fce2c5c6e5242192?s=128&d=identicon&r=PG", "display_name": "Flimzy", "link": "https://stackoverflow.com/users/13860/flimzy"}, "edited": false, "score": 3, "creation_date": 1538298664, "post_id": 52575282, "comment_id": 92088210, "body": "Because Go doesn&#39;t buy into the &quot;everything is an object&quot; mentality.  Thankfully."}], "answers": [{"tags": [], "owner": {"reputation": 1034911, "user_id": 6309, "user_type": "registered", "accept_rate": 100, "profile_image": "https://www.gravatar.com/avatar/7aa22372b695ed2b26052c340f9097eb?s=128&d=identicon&r=PG", "display_name": "VonC", "link": "https://stackoverflow.com/users/6309/vonc"}, "is_accepted": true, "score": 5, "last_activity_date": 1538292615, "last_edit_date": 1538292615, "creation_date": 1538290869, "answer_id": 52575451, "question_id": 52575282, "link": "https://stackoverflow.com/questions/52575282/why-split-is-not-a-member-function-of-type-string-in-go/52575451#52575451", "title": "Why &quot;Split&quot; is not a member function of type &quot;string&quot; in Go?", "body": "<blockquote>\n  <p>As you can see, \"split\" is a member function of type string in python and javascript, but not in golang. </p>\n</blockquote>\n\n<p>That seems to have been so from the very beginning: <a href=\"https://github.com/golang/go/blob/729bc5c0c78d91435dd44bfcf40a8a2c631e14d2/src/lib/strings.go#L65-L85\" rel=\"nofollow noreferrer\">commit 729bc5c, Sept 2008, for Go1</a> is the first commit with any mention of a <code>string Split()</code> function.  </p>\n\n<blockquote>\n  <p>rudimentary string utilities. </p>\n</blockquote>\n\n<p>Those functions were considered \"utilities\", and not part of the <a href=\"https://golang.org/ref/spec#String_types\" rel=\"nofollow noreferrer\">predeclared string type '<code>string</code>' itself</a>.</p>\n\n<p>It was documented soon after in <a href=\"https://github.com/golang/go/commit/0f7306b78ca278a88be1f131a446a2aceb68d73d\" rel=\"nofollow noreferrer\">commit 0f7306b, March 2009, still Go1</a></p>\n\n<pre><code>// Split returns the array representing the substrings of s separated by string sep. Adjacent\n// occurrences of sep produce empty substrings.  If sep is empty, it is the same as Explode.\nfunc Split(s, sep string) []string {\n</code></pre>\n\n<p>You can see it used for the first time in <a href=\"https://github.com/golang/go/commit/5eae3b21025169bfa39fc42d0dfcc997acab8e9d\" rel=\"nofollow noreferrer\">commit 5eae3b2, April 2009</a> in  <a href=\"https://github.com/golang/go/blob/5eae3b21025169bfa39fc42d0dfcc997acab8e9d/src/lib/exec.go#L195-L217\" rel=\"nofollow noreferrer\"><code>func LookPath(file string) (string, *os.Error) {</code></a></p>\n\n<p>The same approach was use for byte with bytes: <a href=\"https://github.com/golang/go/commit/78933226f114c5c9e6de5addd693d86a7724f2f4\" rel=\"nofollow noreferrer\">commit 7893322, June 2009; Go1</a>, with a <a href=\"https://github.com/golang/go/blob/78933226f114c5c9e6de5addd693d86a7724f2f4/src/lib/bytes/bytes.go#L90-L111\" rel=\"nofollow noreferrer\">similar Split() function</a>.</p>\n\n<blockquote>\n  <p>add a bytes package analogous to the strings package. </p>\n</blockquote>\n\n<p>The general idea is: you can change that utility function without changing the value type itself.<br>\nSee <a href=\"https://github.com/golang/go/commit/30533d607a3e10ae1a688ea88ee5976115681cba\" rel=\"nofollow noreferrer\">commit 30533d6, June 2009</a>:</p>\n\n<blockquote>\n  <p>Change <code>strings.Split</code>, <code>bytes.Split</code> to take a maximum substring <code>count</code> argument.</p>\n\n<pre><code>func Split(s, sep []byte, n int) [][]byte\n</code></pre>\n</blockquote>\n\n<p>An even more drastic evolution:<a href=\"http://ebb1566a46f2f5b2c06ef0f7ad5f7084dce0aed9\" rel=\"nofollow noreferrer\">commit ebb1566, June 2011</a></p>\n\n<blockquote>\n  <p><code>strings.Split</code>: make the default to split all.<br>\n  Change the signature of Split to have no count, assuming a full split, and rename the existing <code>Split</code> with a count to <code>SplitN</code>.</p>\n</blockquote>\n\n<p>The other idea is to keep using <code>string</code>, while possibly removing dependencies to those utility functions when you don't need them (as in <a href=\"https://github.com/golang/go/commit/35ace1d1f51e86d3f021d49e61431d39ecee9f6f\" rel=\"nofollow noreferrer\">commit 35ace1d, Nov. 2009</a>: \"remove dependencies on <code>strconv</code> and <code>strings</code>\")</p>\n\n<p>It also allows to <em>add</em> more related function, without touching string itself.<br>\nSee <a href=\"https://github.com/golang/go/commit/5d436b9defd0d36436bc22f9852b3e5e7446f5eb\" rel=\"nofollow noreferrer\">commit 5d436b9, Nov. 2009</a>: lines := <code>strings.SplitAfter(text, \"\\n\", 0)</code>, which uses <code>Split()</code>.</p>\n\n<p>Another advantage: you can optimize those functions independently of <code>string</code> itself, allowing for duplicate 'Split' function to be replaced by <code>strings.Split()</code>.<br>\nSee <a href=\"https://github.com/golang/go/commit/f38811979cefe7cd61b34c5580e2d10f65f243db\" rel=\"nofollow noreferrer\">commit f388119, March 2013, Go 1.1</a></p>\n\n<blockquote>\n  <h2><code>go/printer</code>: use <code>strings.Split</code> instead of specialized code</h2>\n  \n  <p>With the faster strings package, the difference between the specialized code and strings.Split is in the noise:</p>\n\n<pre><code>benchmark         old ns/op    new ns/op    delta\nBenchmarkPrint     16724291     16686729   -0.22%\n</code></pre>\n</blockquote>\n\n<p>The opposite case is also true: replacing strings.Split by a simpler code, as in <a href=\"https://github.com/golang/go/commit/d0c9b40964f1951d2684545f1a6df64be899d26d\" rel=\"nofollow noreferrer\">commit d0c9b40, Sept. 2015, Go 1.6</a></p>\n\n<blockquote>\n  <h2>mime: Remove an allocation in word decoding.</h2>\n  \n  <p>This fixes a <code>TODO</code> in <code>(*WordDecoder).Decode</code> by replacing a call to <code>strings.Split</code> with simple prefix/suffix checking and some custom slicing.</p>\n  \n  <p>Benchmark results:</p>\n\n<pre><code>benchmark                    old ns/op     new ns/op     delta\nBenchmarkQEncodeWord-8       740           693           -6.35%\nBenchmarkQDecodeWord-8       1291          727           -43.69%\nBenchmarkQDecodeHeader-8     1194          767           -35.76%\n</code></pre>\n</blockquote>\n\n<p>(same idea in <a href=\"https://github.com/golang/go/commit/ecff94311d793dcb4c590690473aa1421f549f03\" rel=\"nofollow noreferrer\">commit ecff943, Sept. 2017, Go 1.11</a>)</p>\n"}], "owner": {"reputation": 147, "user_id": 4072649, "user_type": "registered", "profile_image": "https://lh5.googleusercontent.com/-NhOnKIzI-xs/AAAAAAAAAAI/AAAAAAAAAB8/QP8Oa0FdevI/photo.jpg?sz=128", "display_name": "lisnb", "link": "https://stackoverflow.com/users/4072649/lisnb"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 689, "favorite_count": 1, "closed_date": 1538335050, "accepted_answer_id": 52575451, "answer_count": 1, "score": 1, "last_activity_date": 1538305603, "creation_date": 1538289232, "last_edit_date": 1538305603, "question_id": 52575282, "link": "https://stackoverflow.com/questions/52575282/why-split-is-not-a-member-function-of-type-string-in-go", "closed_reason": "Duplicate", "title": "Why &quot;Split&quot; is not a member function of type &quot;string&quot; in Go?", "body": "<p>Here are some snippets when you want to split a string with some specific delimiter in different languages:</p>\n\n<pre><code># python\ns = 'a,b,c,d,e'\ntokens = s.split(',')\n\n// javascript\nlet s = 'a,b,c,d,e'\nlet tokens = s.split(',')\n\n// go\ns := \"a,b,c,d,e\"\ntokens := strings.Split(s, \",\")\n</code></pre>\n\n<p>As you can see, \"split\" is a member function of type string in Python and Javascript, but not in Go.\nI am wondering why is that, it seems like STL in CPP, why the functions to manipulate an instance of a type are not member functions of that type, it seems easy to implement them in Go, like:</p>\n\n<pre><code>// go\nfunc (s *string) Split(d string) []string {\n  // here goes the code to split s with d given\n}\n</code></pre>\n\n<p>what is the reason it is designed this way?</p>\n"}, {"tags": ["multithreading", "go", "subroutine"], "answers": [{"tags": [], "owner": {"reputation": 394580, "user_id": 479863, "user_type": "registered", "accept_rate": 75, "profile_image": "https://i.stack.imgur.com/ArUCE.jpg?s=128&g=1", "display_name": "mu is too short", "link": "https://stackoverflow.com/users/479863/mu-is-too-short"}, "is_accepted": true, "score": 3, "last_activity_date": 1538280230, "creation_date": 1538280230, "answer_id": 52574506, "question_id": 52574401, "link": "https://stackoverflow.com/questions/52574401/updated-value-not-being-returned-after-update-in-a-go-routine/52574506#52574506", "title": "Updated value not being returned after update in a go routine", "body": "<p>The function that launches the goroutine returns a <code>HostUptimeReporter</code>:</p>\n\n<pre><code>func NewHostUpTimeReporter(updateIntervalInSeconds int) HostUptimeReporter {\n</code></pre>\n\n<p>Returning a whole struct like that returns a copy of the struct so the goroutine and the <code>NewHostUpTimeReporter</code> caller are looking at different things. You want to return a pointer so they're sharing data:</p>\n\n<pre><code>// -----------------------------------------------------v\nfunc NewHostUpTimeReporter(updateIntervalInSeconds int) *HostUptimeReporter {\n    instance := &amp;HostUptimeReporter{updateInterval: updateIntervalInSeconds, shutdownSignal: make(chan bool), uptime:59}\n    // ---------^\n    ...\n</code></pre>\n"}], "owner": {"reputation": 65, "user_id": 721326, "user_type": "registered", "accept_rate": 75, "profile_image": "https://www.gravatar.com/avatar/2971f2cd024ac20a57c35ab387bcea8a?s=128&d=identicon&r=PG", "display_name": "DotNet n00b", "link": "https://stackoverflow.com/users/721326/dotnet-n00b"}, "delete_vote_count": 0, "reopen_vote_count": 0, "close_vote_count": 0, "is_answered": true, "view_count": 32, "favorite_count": 0, "accepted_answer_id": 52574506, "answer_count": 1, "score": 0, "last_activity_date": 1538281253, "creation_date": 1538278550, "last_edit_date": 1538280268, "question_id": 52574401, "link": "https://stackoverflow.com/questions/52574401/updated-value-not-being-returned-after-update-in-a-go-routine", "title": "Updated value not being returned after update in a go routine", "body": "<p>I am running into a problem where integer value being returned is same as the one set, even after the value is updated in a go subroutine. I cannot seem to figure out whats wrong.</p>\n\n<pre><code>//HostUptimeReporter - struct\ntype HostUptimeReporter struct {\n    updateInterval int\n    uptime int\n    shutdownSignal chan bool\n\n}\n\n//NewHostUpTimeReporter - create reporter instance\nfunc NewHostUpTimeReporter(updateIntervalInSeconds int) HostUptimeReporter {\n    instance := HostUptimeReporter{updateInterval: updateIntervalInSeconds, shutdownSignal: make(chan bool), uptime:59}\n    ticker := time.NewTicker(time.Duration(updateIntervalInSeconds) * time.Second)\n    go func() {\n        for {\n            select {\n            case &lt;-ticker.C:\n                instance.uptime += updateIntervalInSeconds          \n                fmt.Printf(\"updated uptime:%v\\n\", instance.uptime)\n            case &lt;-instance.shutdownSignal:\n                ticker.Stop()\n                return\n            }\n        }\n    }()\n\n    return instance\n}\n\n//Shutdown - shuts down the go routine\nfunc (hupr *HostUptimeReporter) Shutdown(){\n    hupr.shutdownSignal &lt;- true\n}\n\nfunc main() {\n\n    hurp := NewHostUpTimeReporter(2)\n    defer hurp.Shutdown()\n    fmt.Printf(\"current uptime:%v\\n\", hurp.uptime)\n    time.Sleep(3*time.Second)\n    fmt.Printf(\"new uptime:%v\\n\", hurp.uptime)\n\n}\n</code></pre>\n\n<p><a href=\"https://play.golang.org/p/ODjSBb0YugK\" rel=\"nofollow noreferrer\">https://play.golang.org/p/ODjSBb0YugK</a></p>\n\n<p>Any pointers are appreciated.</p>\n\n<p>Thanks!</p>\n"}]